---
title: Открытие и закрытие сеанса WinSNMP
description: Чтобы открыть сеанс, приложение вызывает функцию Снмпкреатесессион.
ms.assetid: 76650231-509b-45be-b156-09752b817854
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 41871c9adc2f7fcefc04b5816b29685ad6b1516a6238c1855ed41e878d5b2736
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119009202"
---
# <a name="opening-and-closing-a-winsnmp-session"></a>Открытие и закрытие сеанса WinSNMP

Чтобы открыть сеанс, приложение вызывает функцию [**снмпкреатесессион**](/windows/desktop/api/Winsnmp/nf-winsnmp-snmpcreatesession) . Если функция завершается успешно, реализация Microsoft WinSNMP открывает сеанс, а функция возвращает идентификатор сеанса в виде **хснмп \_ сеанса** . Все функции WinSNMP, которые возвращают переменные обработчика, включают идентификатор сеанса в качестве входного параметра. Это позволяет реализации использовать этот обработчик для эффективного управления ресурсами на уровне сеанса.

В приложении может быть открыто несколько сеансов одновременно. Несколько сеансов в приложении могут совместно использовать переменные управления.

Если реализация не может открыть сеанс из-за ограничений ресурсов, она возвращает СНМПАПИ \_ ошибку, когда приложение вызывает [**снмпкреатесессион**](/windows/desktop/api/Winsnmp/nf-winsnmp-snmpcreatesession). Если приложение вызывает функцию [**снмпжетластеррор**](/windows/desktop/api/Winsnmp/nf-winsnmp-snmpgetlasterror) , возвращается \_ Ошибка выделения снмпапи \_ .

Вызов функции [**снмпклосе**](/windows/desktop/api/Winsnmp/nf-winsnmp-snmpclose) позволяет реализации освободить все оставшиеся ресурсы и закрыть сеанс.

Дополнительные сведения см. в разделе [объекты обработчика ресурсов](resource-handle-objects.md) и [WinSNMP Sessions](winsnmp-sessions.md).

 

 




