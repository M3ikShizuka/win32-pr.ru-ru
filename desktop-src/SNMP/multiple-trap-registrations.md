---
title: Множественные регистрации ловушек
description: При регистрации WinSNMP сеанса для ловушек или уведомлений в приложении WinSNMP доступны несколько параметров.
ms.assetid: 76a4095f-ab5c-4f7a-9b60-a383a632fd65
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4e2149e4ac1e9880601ae64718cd78991718d54a6228488a03e593376d9a7937
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119009331"
---
# <a name="multiple-trap-registrations"></a>Множественные регистрации ловушек

При регистрации WinSNMP сеанса для ловушек или уведомлений в приложении WinSNMP доступны несколько параметров. Из-за этого приложение может вызывать функцию [**снмпрегистер**](/windows/desktop/api/Winsnmp/nf-winsnmp-snmpregister) несколько раз, в силу чего определяет настраиваемый фильтр для приема ловушек и уведомлений. Например, можно зарегистрироваться для получения одного типа ловушек или уведомлений, а также для всех ловушек и уведомлений в зависимости от значения параметра *уведомления* . Кроме того, приложение может указать значения в других параметрах функции **снмпрегистер** , чтобы дополнительно определить ловушки и уведомления, которые должны достигать приложения. Дополнительные сведения см. в разделе [Управление ловушками и уведомлениями](managing-traps-and-notifications.md).

Ниже приведены экземпляры, в которых несколько вызовов **снмпрегистер** являются избыточными. В этих экземплярах **снмпрегистер** возвращает снмпапи \_ Success, если функция успешно завершается, но избыточная регистрация неэффективна.

1.  Вызов функции [**снмпрегистер**](/windows/desktop/api/Winsnmp/nf-winsnmp-snmpregister) , запрашивающей фильтрованную доставку ловушек и уведомлений в сеанс, после предыдущего вызова **снмпрегистер** , запрашивающего доставку всех ловушек и уведомлений (нефильтрованная доставка). Этот вызов является избыточным, так как сеанс уже получает все ловушки и уведомления, включая один тип, определенный фильтром.
2.  Повторный вызов **снмпрегистер** или один, в котором список параметров идентичен списку параметров в предыдущем вызове **снмпрегистер** для сеанса.
3.  Вызов функции [**снмпрегистер**](/windows/desktop/api/Winsnmp/nf-winsnmp-snmpregister) , запрашивающей фильтрованную доставку ловушек и уведомлений на основе идентификатора объекта (OID), чей префикс является ИДЕНТИФИКАТОРом OID, указанным в предыдущем вызове метода **снмпрегистер**. Например, можно указать "1.3.6.1.4.1.311" в параметре *уведомления* для получения уведомлений, исходящих от любой сущности агента Microsoft SNMP. Если вызвать **снмпрегистер** еще раз и указать "1.3.6.1.4.1.311.1", второй вызов будет избыточным, так как сеанс уже получает все ловушки и уведомления, содержащие префикс OID "1.3.6.1.4.1.311".

Чтобы отменить регистрацию сеанса, необходимо сопоставить каждый уникальный вызов регистрации функции [**снмпрегистер**](/windows/desktop/api/Winsnmp/nf-winsnmp-snmpregister) . Вызовите **снмпрегистер** , чтобы отменить регистрацию сеанса, и убедитесь, что первые пять параметров для **снмпрегистер** идентичны параметрам в первоначальном вызове регистрации. Единственное различие между начальным вызовом и отменой регистрации заключается в том, что при регистрации необходимо указать значение СНМПАПИ \_ On в параметре *Status* , а при вызове функции для отмены регистрации необходимо указать снмпапи \_ Off. Не нужно сопоставлять избыточные вызовы регистрации функции **снмпрегистер** . Необходимо совпадение только с первым уникальным вызовом регистрации.

Для изменения условий фильтрации может потребоваться, чтобы приложение могло сначала отменить регистрацию и отключение доставки определенных ловушек или уведомлений. Затем приложение может создать новый фильтр, вызвав [**снмпрегистер**](/windows/desktop/api/Winsnmp/nf-winsnmp-snmpregister), передав соответствующие значения.

 

 




