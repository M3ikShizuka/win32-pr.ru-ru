---
description: Для рисования в клиентской области окна используется общий контекст устройства.
ms.assetid: 63c4f775-b1a3-4f7c-808b-81c596f26353
title: Общие контексты отображаемых устройств
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 506d9de2d9908be735d959a85ca6bdfe99abf7f33489c74175ab2882551393cf
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119105693"
---
# <a name="common-display-device-contexts"></a>Общие контексты отображаемых устройств

Для рисования в клиентской области окна используется *общий контекст устройства* . По умолчанию система предоставляет общий контекст устройства для любого окна, в котором класс Window не указывает стиль контекста устройства вывода. Общие контексты устройств обычно используются с Windows, которые могут быть выведены без внесения значительных изменений в атрибуты контекста устройства. Общие контексты устройств удобны, поскольку они не нуждаются в дополнительной памяти или системных ресурсах, но они могут оказаться неудобными, если приложение должно настроить множество атрибутов перед их использованием.

Система извлекает все общие контексты устройств из кэша контекста устройства вывода. Приложение может получить общий контекст устройства сразу после создания окна. Так как общий контекст устройства находится в кэше, приложение всегда должно освобождать контекст устройства как можно скорее после рисования. После выпуска общего контекста устройства он становится недействительным, и приложение не должно пытаться его рисовать. Для повторного рисования приложение должно получить новый общий контекст устройства и продолжать извлекать и освобождать общий контекст устройства каждый раз при его прорисовке в окне. Если приложение получает обработчик контекста устройства с помощью функции [**GetDC**](/windows/desktop/api/Winuser/nf-winuser-getdc) , оно должно использовать функцию [**релеаседк**](/windows/desktop/api/Winuser/nf-winuser-releasedc) для освобождения этого маркера. Аналогичным образом для каждой функции [**бегинпаинт**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) приложение должно использовать соответствующую функцию [**ендпаинт**](/windows/desktop/api/Winuser/nf-winuser-endpaint) .

Когда приложение получает контекст устройства, система корректирует источник так, чтобы он совпадал с верхним левым углом клиентской области. Он также задает область отсечения таким образом, чтобы выходные данные в контексте устройства обрезались в клиентской области. Все выходные данные, которые в противном случае будут отображаться вне области клиента, будут обрезаны. Если приложение получает общий контекст устройства с помощью [**бегинпаинт**](/windows/desktop/api/Winuser/nf-winuser-beginpaint), система также включает область обновления в область обрезки для дальнейшего ограничения выходных данных.

Когда приложение освобождает общий контекст устройства, система восстанавливает значения по умолчанию для атрибутов контекста устройства. Приложение, изменяющее значения атрибутов, должно выполнять эти действия каждый раз, когда он получает общий контекст устройства. Освобождение контекста устройства освобождает все объекты рисования, которые приложение может выбрать в нем, поэтому приложению не нужно освобождать эти объекты перед освобождением контекста устройства. Во всех случаях приложение не должно рассчитывать на то, что общий контекст устройства оставляет нестандартные параметры после освобождения.

 

 



