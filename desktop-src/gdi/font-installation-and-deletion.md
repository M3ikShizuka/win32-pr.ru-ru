---
description: Приложение может использовать шрифт для рисования текста только в том случае, если этот шрифт либо является резидентным на указанном устройстве, либо установлен в таблице системных шрифтов.
ms.assetid: b422b981-8760-4484-9965-f212287c421e
title: Установка и удаление шрифтов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0184054973c769462ed8c1620e5534ff909576ca
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127570706"
---
# <a name="font-installation-and-deletion"></a>Установка и удаление шрифтов

Приложение может использовать шрифт для рисования текста только в том случае, если этот шрифт либо является резидентным на указанном устройстве, либо установлен в таблице системных шрифтов. Таблица Font является внутренним массивом, который определяет все шрифты, не являющиеся устройствами, доступные для приложения. Приложение может извлекать имена шрифтов, установленных на устройстве или хранящихся во внутренней таблице шрифтов, вызывая функции [**EnumFontFamilies**](/windows/desktop/api/Wingdi/nf-wingdi-enumfontfamiliesa) или [**ChooseFont**](/previous-versions/windows/desktop/legacy/ms646914(v=vs.85)) .

Чтобы временно установить шрифт, вызовите [**аддфонтресаурце**](/windows/desktop/api/Wingdi/nf-wingdi-addfontresourcea) или [**аддфонтресаурцеекс**](/windows/desktop/api/Wingdi/nf-wingdi-addfontresourceexa). Эти функции загружают шрифт, хранящийся в файле ресурсов шрифта. Однако это временная установка, так как после перезагрузки шрифт не будет присутствовать.

Чтобы установить шрифт, который останется после перезагрузки системы, используйте один из следующих методов.

-   Перейдите на панель управления, щелкните значок " **шрифты** " и выберите в меню " **файл** " пункт " **установить новые шрифты** ". Шрифт доступен для приложения даже перед перезагрузкой. Однако в случае сервера терминалов шрифт доступен для текущего сеанса, но недоступен для других сеансов до перезагрузки.
-   Скопируйте шрифт в папку% WINDIR% \\ Fonts. Затем перейдите на панель управления и щелкните значок **шрифты** или вызовите [**аддфонтресаурце**](/windows/win32/api/wingdi/nf-wingdi-addfontresourcea) или [**аддфонтресаурцеекс**](/windows/win32/api/wingdi/nf-wingdi-addfontresourceexa). Шрифт доступен для приложения даже перед перезагрузкой. Однако в случае сервера терминалов шрифт доступен для текущего сеанса, но недоступен для других сеансов до перезагрузки. Если скопировать шрифт в папку% WINDIR% \\ Fonts, шрифт будет доступен только после перезагрузки системы.

Когда приложение заканчивает использовать установленный шрифт, оно должно удалить этот шрифт, вызвав функцию [**ремовефонтресаурце**](/windows/desktop/api/Wingdi/nf-wingdi-removefontresourcea) .

Шрифт, установленный из расположения, отличного от папки% WINDIR% \\ Fonts, нельзя изменить при загрузке в любом активном сеансе, включая сеанс 0. Любая попытка изменить, заменить или удалить, таким образом, будет заблокирована. Если требуется изменение шрифта:

-   *Временные шрифты* загружаются только в текущем сеансе. Прежде чем пытаться внести изменения в шрифт, вызовите [**ремовефонтресаурце**](/windows/desktop/api/Wingdi/nf-wingdi-removefontresourcea) , чтобы принудительно выгрузить его в текущем сеансе.
-   *Постоянные шрифты* остаются установленными после перезагрузки и загружаются всеми созданными сеансами. Вызовите [**ремовефонтресаурце**](/windows/desktop/api/Wingdi/nf-wingdi-removefontresourcea) , чтобы принудительно выгрузить шрифт в текущем сеансе. затем в разделе реестра шрифтов (**HKEY \_ LOCAL \_ MACHINE \\ SOFTWARE \\ Microsoft \\ Windows NT \\ CurrentVersion \\ шрифты**) найдите и удалите значение реестра, связанное со шрифтом. Наконец, перезагрузите компьютер, чтобы шрифт не загружался ни в одном сеансе. После перезагрузки продолжите изменение или удаление шрифта.

Всякий раз, когда приложение вызывает функции, которые добавляют и удаляют ресурсы шрифта, оно должно также вызывать функцию [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) и передавать сообщение [**WM \_ фонтчанже**](wm-fontchange.md) всем окнам верхнего уровня в системе. Это сообщение уведомляет другие приложения о том, что внутренняя таблица шрифтов была изменена приложением, которое добавило или удалило шрифт.

 

 
