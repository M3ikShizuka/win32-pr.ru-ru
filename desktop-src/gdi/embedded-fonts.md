---
description: Внедрение шрифта — это способ объединения документа и содержащихся в нем шрифтов в файл для передачи на другой компьютер.
ms.assetid: ded409f1-5bd9-411b-b905-fc49c484786a
title: Внедренные шрифты
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 83fb8ab821afa5f44ded05a4a61a53439b8db9fc
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127469410"
---
# <a name="embedded-fonts"></a>Внедренные шрифты

Внедрение шрифта — это способ объединения документа и содержащихся в нем шрифтов в файл для передачи на другой компьютер. Внедрение шрифта гарантирует, что шрифт, указанный в переданном файле, будет присутствовать на компьютере, получающем файл. Не все шрифты можно перемещать с компьютера на компьютер, так как большинство шрифтов лицензируется только на один компьютер за раз. Внедрять можно только шрифты TrueType и OpenType.

Приложения должны внедрять шрифт в документ только по запросу пользователя. Приложение не может распространяться вместе с документами, содержащими внедренные шрифты, а само приложение не может содержать внедренный шрифт. Каждый раз, когда приложение распространяет шрифт в любом формате, права владельца шрифта должны быть подтверждены.

Это может быть нарушение прав собственности поставщика шрифтов или лицензионного соглашения для внедрения любых шрифтов, в которых внедрение не разрешено, или не может следовать приведенным ниже рекомендациям по внедрению шрифтов. Лицензия шрифта может предоставлять только разрешение на чтение и запись для установки и использования шрифта на конечном компьютере. Или лицензия может предоставить разрешение только для чтения. Разрешение только для чтения позволяет конечному компьютеру просматривать и печатать документ (но не изменять его); документы с внедренными шрифтами только для чтения доступны только для чтения. Внедренные шрифты, предназначенные только для чтения, не могут быть извлечены из документа и установлены на конечном компьютере.

Приложение может определить состояние лицензии, вызвав функцию [**жетаутлинетекстметрикс**](/windows/desktop/api/Wingdi/nf-wingdi-getoutlinetextmetricsa) и изучив элемент **отмфстипе** структуры [**аутлинетекстметрик**](/windows/desktop/api/Wingdi/ns-wingdi-outlinetextmetrica) . Если задан бит 1 из **отмфстипе** , встраивание для шрифта не разрешено. Если бит 1 снят, шрифт может быть внедрен. Если задан бит 2, то внедрение будет доступно только для чтения.

Чтобы внедрить шрифт TrueType, приложение может использовать функцию [**жетфонтдата**](/windows/desktop/api/Wingdi/nf-wingdi-getfontdata) для чтения файла шрифта. Установка параметров *двтабле* и *двоффсет* для [**жетфонтдата**](/windows/win32/api/wingdi/nf-wingdi-getfontdata) в 0L, а параметр *cbData* — 1L гарантирует, что приложение считывает весь файл шрифта с самого начала.

Для внедрения шрифтов OpenType можно использовать несколько функций в зависимости от ширины символов и расположения данных шрифтов. Чтобы внедрить шрифт OpenType Юникода, находящийся в контексте устройства, приложение может использовать [**ттембедфонт**](/windows/desktop/api/T2embapi/nf-t2embapi-ttembedfont). Чтобы внедрить шрифт OpenType UCS-4, находящийся в контексте устройства, приложение может использовать [**ттембедфонтекс**](/windows/desktop/api/T2embapi/nf-t2embapi-ttembedfontex). Чтобы внедрить шрифт OpenType Юникода, находящийся в файле шрифта, приложение может использовать [**ттембедфонтфромфиле**](/windows/desktop/api/T2embapi/nf-t2embapi-ttembedfontfromfilea). Дополнительные сведения о внедрении шрифтов OpenType см. в разделе [Справочник по внедрению шрифтов](font-embedding-reference.md).

После того как приложение извлекает данные шрифтов, оно может сохранить данные в документе с помощью любого применимого формата. Большинство приложений создают в документе каталог шрифтов, выводит список внедренных шрифтов и указывает, доступен ли внедренный объект для чтения и записи или только для чтения. Приложение может использовать члены **отмпстиленаме** и **отмфамилинаме** структуры [**аутлинетекстметрик**](/windows/win32/api/wingdi/ns-wingdi-outlinetextmetrica) для распознавания шрифта.

Если для внедренного шрифта установлен бит только для чтения, приложения должны зашифровать данные шрифта, прежде чем сохранять их вместе с документом. Метод шифрования не должен быть сложным; Например, использование оператора XOR для объединения данных шрифта с константой, определяемой приложением, является достаточной и быстрой.

 

 
