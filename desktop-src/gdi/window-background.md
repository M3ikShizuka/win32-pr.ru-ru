---
description: Фон окна — это цвет или шаблон, используемый для заполнения клиентской области перед началом рисования окна.
ms.assetid: d0613f9b-e65b-4de2-887d-2b642d36b22d
title: Фон окна
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 32d567b0bdc38866cd9332ff8ed399bfb23f53c8
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103908939"
---
# <a name="window-background"></a>Фон окна

Фон окна — это цвет или шаблон, используемый для заполнения клиентской области перед началом рисования окна. Фон окна охватывает все, что было на экране до перемещения окна, стирание существующих изображений и предотвращение смешивания новых выходных данных приложения с несвязанными данными.

Система рисует фон окна или дает окну возможность сделать это, отправив ему сообщение [**WM \_ ерасебкгнд**](../winmsg/wm-erasebkgnd.md) , когда приложение вызовет [**бегинпаинт**](/windows/desktop/api/Winuser/nf-winuser-beginpaint). Если приложение не обрабатывает сообщение, но передает его в [**дефвиндовпрок**](/windows/desktop/api/winuser/nf-winuser-defwindowproca), система удаляет фон, заполняя его шаблоном в фоновой кисти, заданной классом окна. Если кисть недопустима или класс не имеет фоновой кисти, система устанавливает элемент **ферасе** в структуре [**PAINTSTRUCT**](/windows/win32/api/winuser/ns-winuser-paintstruct) , которую **бегинпаинт** возвращает, но не выполняет никаких других действий. При необходимости приложение имеет вторую возможность рисования фона окна.

Если он обрабатывает [**WM \_ ерасебкгнд**](../winmsg/wm-erasebkgnd.md), приложение должно использовать параметр *wParam* сообщения для рисования фона. Этот параметр содержит маркер контекста устройства просмотра для окна. После рисования фона приложение должно вернуть ненулевое значение. Это гарантирует, что [**бегинпаинт**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) не будет ошибочно присвоить элементу **ферасе** структуры [**PAINTSTRUCT**](/windows/win32/api/winuser/ns-winuser-paintstruct) ненулевое значение (что означает, что фон должен быть стерт), когда приложение обрабатывает последующее сообщение [**WM \_ Paint**](wm-paint.md) .

Приложение может определить кисть фона класса, назначив маркер кисти или значение системного цвета элементу **хбрбаккграунд** структуры [**вндкласс**](/windows/win32/api/winuser/ns-winuser-wndclassa) при регистрации класса с помощью функции [**registerClass**](/windows/win32/api/winuser/nf-winuser-registerclassa) . Для создания маркера кисти можно использовать функцию [**жетстоккобжект**](/windows/desktop/api/Wingdi/nf-wingdi-getstockobject) или [**креатесолидбруш**](/windows/desktop/api/Wingdi/nf-wingdi-createsolidbrush) . Значение системного цвета может быть одним из значений, определенных для функции [**сетсисколорс**](/windows/win32/api/winuser/nf-winuser-setsyscolors) . (Значение должно быть увеличено на единицу до того, как оно будет назначено элементу.)

Приложение может обработать сообщение [**WM \_ ерасебкгнд**](../winmsg/wm-erasebkgnd.md) , даже если определена кисть фона класса. Это типично в приложениях, которые позволяют пользователю изменять цвет фона окна или узор для указанного окна, не затрагивая другие окна в классе. В таких случаях приложение не должно передавать сообщение в [**дефвиндовпрок**](/windows/desktop/api/winuser/nf-winuser-defwindowproca).

В приложении нет необходимости выстроить кисти, так как система рисует кисть с помощью исходного окна в качестве точки ссылки. Учитывая это, пользователь может перемещать окно, не влияя на выравнивание узорных кистей.

 

 
