---
description: С помощью контекста устройства класса приложение может использовать контекст одного устройства вывода для каждого окна, принадлежащего указанному классу.
ms.assetid: fc76abbf-68da-47f2-8145-4fad806297b4
title: Отображение контекстов устройств в классе
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6b8e4ca7f7d51f3dd50f50a07ab44496d56e4a78effb78f33e9eed6f5ffc3745
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "120062484"
---
# <a name="class-display-device-contexts"></a>Отображение контекстов устройств в классе

С помощью *контекста устройства класса* приложение может использовать контекст одного устройства вывода для каждого окна, принадлежащего указанному классу. Контексты устройств класса часто используются с окнами управления, которые рисуются с использованием одинаковых значений атрибутов. Как и в частных контекстах устройств, контексты устройств класса сокращают время, необходимое для подготовки контекста устройства к рисованию.

Система предоставляет контекст устройства класса для окна, если он принадлежит классу окна, имеющему \_ стиль CS классдк. Система создает контекст устройства при создании первого окна, принадлежащего классу, а затем использует тот же контекст устройства для всех последовательно созданных окон в классе. Изначально контекст устройства класса имеет те же значения по умолчанию для атрибутов, что и общий контекст устройства, но приложение может изменить их в любое время. Система сохраняет все изменения, за исключением области обрезки и источника устройства, пока не будет уничтожено Последнее окно в классе. Изменение, выполненное для одного окна, применяется ко всем окнам в этом классе.

Приложение может получить маркер контекста устройства класса с помощью функции [**GetDC**](/windows/desktop/api/Winuser/nf-winuser-getdc) в любое время после создания первого окна. Приложение может держать и использовать этот обработчик, не освобождая его, так как контекст устройства класса не является частью кэша контекста устройства вывода. Если приложение создает другое окно в том же классе окна, приложение должно снова получить контекст устройства класса. При извлечении контекста устройства устанавливается правильное исходное положение устройства и область отсечения для нового окна. После того как приложение извлекает контекст устройства класса для нового окна в классе, контекст устройства больше не может использоваться для рисования в исходном окне без повторного получения этого окна. В общем случае каждый раз, когда она должна рисоваться в окне, приложение должно явно получить контекст устройства класса для окна.

Приложения, использующие контексты устройств класса, должны всегда вызывать [**бегинпаинт**](/windows/desktop/api/Winuser/nf-winuser-beginpaint) при обработке сообщения [**WM \_ Paint**](wm-paint.md) . Функция задает правильный источник устройства и область отсечения для окна, а также включает регион обновления. Приложение также должно вызывать [**ендпаинт**](/windows/desktop/api/Winuser/nf-winuser-endpaint) для восстановления курсора, если **бегинпаинт** его HID. **Ендпаинт** никак не влияет на контекст устройства класса.

Система передает контекст устройства класса при отправке в приложение сообщения [**WM \_ ерасебкгнд**](../winmsg/wm-erasebkgnd.md) , что позволяет текущим значениям атрибутов влиять на любые прорисовки, выполняемые приложением или системой при обработке этого сообщения. Как и в случае с окном частного контекста устройства, приложение может использовать [**жетдцекс**](/windows/desktop/api/Winuser/nf-winuser-getdcex) , чтобы заставить систему вернуть общий контекст устройства для окна с контекстом устройства класса.

Использовать контексты устройств класса не рекомендуется.

 

 
