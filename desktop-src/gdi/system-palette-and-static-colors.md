---
description: Обычно записи палитры системы, которые система резервирует для статических цветов, не могут быть изменены.
ms.assetid: be258151-36cc-42ba-8005-ff9d8e59b894
title: Системная палитра и статические цвета
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3ffc555331ea7ad14675b4155a76d14cc61f3bef3fa7e92b331ad89449b97884
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119613384"
---
# <a name="system-palette-and-static-colors"></a>Системная палитра и статические цвета

Обычно записи палитры системы, которые система резервирует для статических цветов, не могут быть изменены. Приложение может переопределить это поведение по умолчанию с помощью функции [**сетсистемпалеттеусе**](/windows/desktop/api/Wingdi/nf-wingdi-setsystempaletteuse) , чтобы уменьшить число записей статического цвета и, таким образом, увеличить число неиспользуемых записей в системной палитре. Однако, поскольку изменение статических цветов может иметь немедленный и незначительное воздействие на все окна на экране, приложение не должно вызывать **сетсистемпалеттеусе**, если оно не имеет развернутого окна и фокуса ввода.

Когда приложение вызывает [**сетсистемпалеттеусе**](/windows/desktop/api/Wingdi/nf-wingdi-setsystempaletteuse) с \_ нестатическим значением сиспал, система освобождает все, кроме двух зарезервированных записей, позволяя этим записям получить новые значения цвета, когда приложение в дальнейшем поймет логическую палитру. Остальные две записи статического цвета остаются зарезервированными и устанавливаются в белый и черный цвет. Приложение может восстановить зарезервированные записи путем вызова **сетсистемпалеттеусе** со \_ статическим значением сиспал. Она может обнаружить использование текущей системной палитры с помощью функции [**жетсистемпалеттеусе**](/windows/desktop/api/Wingdi/nf-wingdi-getsystempaletteuse) .

Кроме того, после настройки использования палитры «СИСПАЛ \_ static» приложение должно сразу же понять логическую палитру, вызвать функцию [**жетсисколор**](/windows/win32/api/winuser/nf-winuser-getsyscolor) , чтобы сохранить текущие параметры системного цвета, вызвать функцию [**сетсисколорс**](/windows/win32/api/winuser/nf-winuser-setsyscolors) , чтобы задать для системных цветов разумные значения с помощью черного и белого, и, наконец, отправить сообщение [**WM \_ сисколорчанже**](wm-syscolorchange.md) в другие окна верхнего уровня, чтобы разрешить их перерисовку новыми системными цветами. При задании системных цветов с помощью черного и белого приложение должно убедиться, что соседние или перекрывающиеся элементы, такие как фреймы и границы окна, установлены как черные и белые соответственно.

Прежде чем приложение теряет фокус ввода, закрывает его окно или завершается, оно должно немедленно вызвать [**сетсистемпалеттеусе**](/windows/desktop/api/Wingdi/nf-wingdi-setsystempaletteuse) со \_ статическим значением сиспал, реализовать его логическую палитру, восстановить системные цвета до их предыдущих значений и отправить сообщение [**WM \_ сисколорчанже**](wm-syscolorchange.md) . Система отправляет сообщение [**WM \_ Paint**](wm-paint.md) в любое окно, на которое влияет изменение цвета системы. Приложения, имеющие кисти, использующие существующие системные цвета, должны удалить эти кисти и создать их повторно с помощью новых системных цветов.

 

 
