---
description: Аппаратно-независимый точечный рисунок (DIB) содержит таблицу цветов.
ms.assetid: 56b39a3d-48a4-4620-9652-ec41ea4d6423
title: Device-Independent растровые изображения
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1aa35201a9a27c2d16a5a18b0125d25a3938890c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104155646"
---
# <a name="device-independent-bitmaps"></a>Device-Independent растровые изображения

Аппаратно-независимый точечный рисунок (DIB) содержит *таблицу цветов*. Таблица цветов описывает, как значения пикселя соответствуют значениям цвета *RGB* , которые описывают цвета, создаваемые источником освещения. Таким образом, рисунок DIB может обеспечить правильную цветовую схему на любом устройстве. DIB содержит следующие сведения о цвете и измерении:

-   Формат цвета устройства, на котором было создано прямоугольное изображение.
-   Разрешение устройства, на котором было создано прямоугольное изображение.
-   Палитра для устройства, на котором было создано изображение.
-   Массив битов, который сопоставляет красный, зеленый, синий ( [**RGB**](/windows/desktop/api/Wingdi/nf-wingdi-rgb) ) триады с пикселями прямоугольного изображения.
-   Идентификатор сжатия данных, который указывает схему сжатия данных (при ее наличии), используемую для уменьшения размера массива битов.

Сведения о цвете и измерении хранятся в структуре [**битмапинфо**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfo) , состоящей из структуры [**битмапинфохеадер**](/previous-versions//dd183376(v=vs.85)) , за которой следуют две или более структуры [**ргбкуад**](/windows/win32/api/wingdi/ns-wingdi-rgbquad) . Структура **битмапинфохеадер** задает размеры пиксельного прямоугольника, описывает цветовую технологию устройства и определяет схемы сжатия, используемые для уменьшения размера точечного рисунка. Структуры **ргбкуад** указывают цвета, которые отображаются в прямоугольнике.

Существует два вида DIB:

-   Элемент DIB снизу вверх, в котором начало координат находится в левом нижнем углу.
-   Значение DIB сверху вниз, в котором начало координат находится в левом верхнем углу.

Если высота DIB, как указано элементом **Height** структуры заголовка сведений о точечных рисунках, является положительным значением, это будет элемент DIB с именем «снизу вверх». Если высота является отрицательным значением, то это элемент списка DIB. Не удается сжать файлы DIB, расположенные сверху вниз.

Цветовой формат задается в виде числа цветовых плоскостей и цветовых битов. Число цветовых плоскостей всегда равно 1; число цветовых битов равно 1 для монохромных точечных рисунков, 4 для точечных рисунков VGA и 8, 16, 24 или 32 для точечных рисунков на других цветовых устройствах. Приложение получает количество цветовых бит, используемых определенным дисплеем (или принтером), вызывая функцию [**жетдевицекапс**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) , указывая битспиксел в качестве второго аргумента.

Разрешение отображаемого устройства задается в пикселях на единицу измерения. Приложение может получить разрешение экрана или принтера по горизонтали, выполнив этот процесс в три этапа.

1.  Вызовите функцию [**жетдевицекапс**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) , указав хорзрес в качестве второго аргумента.
2.  Вызовите [**жетдевицекапс**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) во второй раз, указав хорзсизе в качестве второго аргумента.
3.  Разделить первое возвращаемое значение на второе возвращаемое значение.

Приложение может получить разрешение по вертикали, используя один и тот же процесс из трех шагов с различными параметрами: вместо ВЕРТРЕС вместо ХОРЗРЕС и ВЕРТСИЗЕ вместо ХОРЗСИЗЕ.

Палитра представляется массивом структур [**ргбкуад**](/windows/win32/api/wingdi/ns-wingdi-rgbquad) , определяющих компоненты интенсивности красного, зеленого и синего для каждого цвета в цветовой палитре устройства показа. Каждый цветовой индекс в массиве палитры сопоставляется с конкретным пикселем в прямоугольной области, связанной с точечным рисунком. Размер этого массива в битах эквивалентен ширине прямоугольника в пикселях, умноженной на высоту прямоугольника (в пикселях), умноженную на число цветовых битов для устройства. Приложение может получить размер палитры устройства, вызвав функцию [**жетдевицекапс**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) , указав нумколорс в качестве второго аргумента.

Windows поддерживает сжатие массива палитры для 8-битовых и 4-битных рисунков DIB. Эти массивы можно сжимать с помощью схемы кодирования длины выполнения (RLE). Схема RLE использует 2-байтовые значения, первый байт, указывающий количество последовательных пикселов, использующих индекс цвета, и второй байт, указывающий индекс. Дополнительные сведения о сжатии растровых изображений см. в описании структур [**битмапинфохеадер**](/previous-versions//dd183376(v=vs.85)), [**битмапфилехеадер**](/windows/win32/api/wingdi/ns-wingdi-bitmapfileheader), [**BITMAPV4HEADER**](/windows/desktop/api/Wingdi/ns-wingdi-bitmapv4header)и [**BITMAPV5HEADER**](/windows/desktop/api/Wingdi/ns-wingdi-bitmapv5header) .

Приложение может создать DIB из DDB, инициализируя необходимые структуры и вызывая функцию [**жетдибитс**](/windows/desktop/api/Wingdi/nf-wingdi-getdibits) . Чтобы определить, поддерживает ли устройство эту функцию, вызовите функцию [**жетдевицекапс**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) , указав \_ битовую карту RC di в \_ качестве флага растеркапс.

Приложение, которому требуется скопировать растровое изображение, может использовать [**транспарентблт**](/windows/desktop/api/WinGdi/nf-wingdi-transparentblt) для копирования всех пикселов исходного растрового изображения в целевое растровое изображение, за исключением тех точек, которые соответствуют прозрачному цвету.

Приложение может использовать DIB для установки пикселов на устройстве вывода путем вызова функции [**сетдибитстодевице**](/windows/desktop/api/Wingdi/nf-wingdi-setdibitstodevice) или [**стретчдибитс**](/windows/desktop/api/Wingdi/nf-wingdi-stretchdibits) . Чтобы определить, поддерживает ли устройство функцию **сетдибитстодевице** , вызовите функцию [**ЖЕТДЕВИЦЕКАПС**](/windows/desktop/api/Wingdi/nf-wingdi-getdevicecaps) , указав RC \_ ДИБТОДЕВ в качестве флага растеркапс. Укажите RC \_ стретчдиб в качестве флага растеркапс, чтобы определить, поддерживает ли устройство **стретчдибитс**.

Приложение, которое просто должно отобразить существующий DIB, может использовать функцию [**сетдибитстодевице**](/windows/desktop/api/Wingdi/nf-wingdi-setdibitstodevice) . Например, приложение электронной таблицы может открывать существующие диаграммы и отображать их в окне с помощью функции **сетдибитстодевице** . Однако для многократного перерисовки растрового изображения в окне приложение должно использовать функцию [**BitBlt**](/windows/desktop/api/Wingdi/nf-wingdi-bitblt) . Например, приложение для мультимедиа, объединяющее анимированную графику со звуком, получит преимущество от вызова функции **BitBlt** , так как она выполняется быстрее, чем **сетдибитстодевице**.

 

 
