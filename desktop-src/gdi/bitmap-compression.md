---
description: Windows поддерживает форматы для сжатия точечных рисунков, которые определяют их цвета с 8 или 4 битами на пиксель. Сжатие сокращает объем дискового пространства и хранилища памяти, необходимого для точечного рисунка.
ms.assetid: 14d14662-910a-4f3f-914e-6ccfc602c822
title: Сжатие растрового изображения
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 38739f0e33f095b8eff567fc63b57db96b8cdc66
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104155699"
---
# <a name="bitmap-compression"></a>Сжатие растрового изображения

Windows поддерживает форматы для сжатия точечных рисунков, которые определяют их цвета с 8 или 4 битами на пиксель. Сжатие сокращает объем дискового пространства и хранилища памяти, необходимого для точечного рисунка.

Если элементу **Compression** структуры заголовка данных Bitmap является BI \_ RLE8, для сжатия 8-разрядного точечного рисунка используется формат кодирования длины выполнения (RLE). Этот формат можно сжать в закодированных или абсолютных режимах. Оба режима могут находиться в одном и том же битовом рисунке:

-   *Режим кодирования* состоит из двух байтов: первый байт определяет число последовательных пикселей, которое должно быть выведено с использованием индекса цвета, содержащегося во втором байте. Кроме того, первый байт пары может быть установлен в ноль, чтобы указать escape-символ, обозначающий конец строки, конец точечного рисунка или разностный текст, в зависимости от значения второго байта. Интерпретация escape-последовательности зависит от значения второго байта пары, которое может принимать одно из следующих значений.



| Значение | Значение                                                                                                                                                     |
|-------|-------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 0     | Конец строки.                                                                                                                                                |
| 1     | Конец точечного рисунка.                                                                                                                                              |
| 2     | Изменений. 2 байта после escape-последовательности содержат значения без знака, указывающие горизонтальное и вертикальное смещение следующего пикселя от текущей позиции. |



 

-   В *абсолютном режиме* первый байт равен нулю, а второй байт — значению в диапазоне от 03H до ФФХ. Второй байт представляет число следующих байтов, каждое из которых содержит индекс цвета для одного пикселя. Если второй байт равен двум или меньшим, то escape-последовательность имеет то же значение, что и закодированный режим. В абсолютном режиме каждый запуск должен быть согласован по границе слова.

В следующем примере показаны шестнадцатеричные значения 8-разрядного сжатого растрового изображения.


```C++
[03 04] [05 06] [00 03 45 56 67] [02 78] [00 02 05 01] 
[02 78] [00 00] [09 1E] [00 01] 
```



Точечный рисунок разворачивается следующим образом (значения из двух цифр представляют цветовой индекс для одного пикселя):


```C++
04 04 04 
06 06 06 06 06 
45 56 67 
78 78 
move current position 5 right and 1 down 
78 78 
end of line 
1E 1E 1E 1E 1E 1E 1E 1E 1E 
end of RLE bitmap 
```



Если элемент **Compression** — BI \_ RLE4, точечный рисунок сжимается с использованием формата кодирования длины выполнения для 4-разрядного точечного рисунка, который также использует закодированные и абсолютные режимы.

-   В закодированном режиме первый байт пары содержит число пикселей, которые должны быть выведены с использованием цветовых индексов во втором байте. Второй байт содержит два цветовых индекса: один — в его старших битах, а второй — в младших старших битах. Первая из пикселов рисуется с помощью цвета, заданного старшим размером 4 бита, второй — с помощью цвета в младших 4 битах, третий — с помощью цвета в 4 битах и так далее, пока не будут выведены все пикселы, заданные первым байтом.
-   В абсолютном режиме первый байт равен нулю. Второй байт содержит количество цветных индексов, которые следуют за. Последующие байты содержат индексы цветов в высоком и низком порядке 4 бит, один цветовой индекс для каждого пикселя. В абсолютном режиме каждый запуск должен быть согласован по границе слова. Символы конца строки, конца растрового изображения и последовательности изменений, описанные для бизнес-аналитики RLE8, \_ также применяются к \_ сжатию RLE4 BI.

В следующем примере показаны шестнадцатеричные значения 4-битового сжатого битового рисунка:


```C++
03 04 05 06 00 06 45 56 67 00 04 78 00 02 05 01 
04 78 00 00 09 1E 00 01 
```



Точечный рисунок разворачивается следующим образом (однозначные значения представляют собой цветовой индекс для одного пикселя):


```C++
0 4 0 
0 6 0 6 0 
4 5 5 6 6 7 
7 8 7 8 
move current position 5 right and 1 down 
7 8 7 8 
end of line 
1 E 1 E 1 E 1 E 1 
end of RLE bitmap 
```



 

 



