---
description: Несмотря на то, что приложения выполняют большинство операций рисования во время \_ обработки сообщения WM Paint, иногда более эффективно нарисовать приложение непосредственно в окне, не полагаясь на \_ сообщение WM Paint.
ms.assetid: 2d015879-58d2-4cbe-b1cc-445f2e8fd316
title: Прорисовка без сообщения WM_PAINT
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 66695e85b700de6f62366dedb6fe082f410d4385
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103898414"
---
# <a name="drawing-without-the-wm_paint-message"></a>Рисование без сообщения WM \_ Paint

Несмотря на то, что приложения выполняют большинство операций рисования во время обработки сообщения [**WM \_ Paint**](wm-paint.md) , иногда более эффективно нарисовать приложение непосредственно в окне, не полагаясь на сообщение **WM \_ Paint** . Это может быть полезно, когда пользователю требуется немедленный отзыв, например при выборе текста и перетаскивании или изменении размера объекта. В таких случаях приложение обычно рисуется при обработке сообщений клавиатуры или мыши.

Для рисования в окне без использования сообщения [**WM \_ Paint**](wm-paint.md) приложение использует функцию [**GetDC**](/windows/desktop/api/Winuser/nf-winuser-getdc) или [**жетдцекс**](/windows/desktop/api/Winuser/nf-winuser-getdcex) , чтобы получить контекст устройства отображения для окна. В контексте устройства отображения приложение может нарисоваться в окне и избежать атак на другие окна. Когда приложение завершит рисование, оно вызывает функцию [**релеаседк**](/windows/desktop/api/Winuser/nf-winuser-releasedc) , чтобы освободить контекст устройства отображения для использования другими приложениями.

При рисовании без использования сообщения [**WM \_ Paint**](wm-paint.md) приложение обычно не делает это окно недействительным. Вместо этого он рисуется таким образом, что он может легко восстановить окно и удалить рисунок. Например, когда пользователь выбирает текст или объект, приложение обычно выводит выделение путем инвертирования того, что уже есть в окне. Приложение может удалить выборку и восстановить исходное содержимое окна, просто переменив его.

Приложение отвечает за тщательное управление любыми изменениями, которые он делает в окне. В частности, если приложение рисует выделение и возникает промежуточное сообщение [**WM \_ Paint**](wm-paint.md) , приложение должно убедиться, что любой рисунок, сделанный во время сообщения, не повреждает выбор. Чтобы избежать этого, многие приложения удаляют выбор, выполняют обычные операции рисования, а затем восстанавливают выбор после завершения рисования.

 

 



