---
description: Оценивает риск выполнения неизвестного кода при вызове обработчика для данного файла. Этот риск основан на понимании обработчика и содержимого кода файла.
title: Функция Естиматефилерисклевел
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- EstimateFileRiskLevel
api_type:
- DllExport
api_location:
- Winshfhc.dll
ms.assetid: 33a5589a-201b-4d94-afbf-5965a39e2748
ms.openlocfilehash: 8cf7514be0d784085acd74536036c159c9f8e9217287e86bea2f75defbb94801
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "120090614"
---
# <a name="estimatefilerisklevel-function"></a>Функция Естиматефилерисклевел

\[эта функция доступна в Windows XP с пакетом обновления 2 (SP2) и Windows Vista. Он может быть изменен или недоступен в последующих версиях Windows. Вместо этого клиентские приложения должны использовать [**иаттачментексекуте**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iattachmentexecute) для предоставления среды пользователя, которая обеспечивает безопасность загрузки и обмена файлами по электронной почте и вложениям в сообщения.\]

Оценивает риск выполнения неизвестного кода при вызове обработчика для данного файла. Этот риск основан на понимании обработчика и содержимого кода файла.

## <a name="syntax"></a>Синтаксис


```C++
HRESULT EstimateFileRiskLevel(
  _In_  LPCWSTR         pszFilePath,
  _In_  LPCWSTR         pszExt,
  _In_  LPCWSTR         pszHandler,
  _Out_ FILE_RISK_LEVEL *pfrlEstimate
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*псзфилепас* \[ окне\]
</dt> <dd>

Тип: **лпквстр**

Указатель на строку, завершающуюся нулем, которая содержит путь к файлу, проверяемому на соответствие обработчику.

</dd> <dt>

*псзекст* \[ окне\]
</dt> <dd>

Тип: **лпквстр**

Указатель на строку, завершающуюся нулем, которая содержит расширение проверяемого файла либо с предшествующей точкой, так и без нее. Например, ".txt" или "txt".

</dd> <dt>

*псзандлер* \[ окне\]
</dt> <dd>

Тип: **лпквстр**

Указатель на строку, завершающуюся нулем, которая содержит путь к обработчику для файла.

</dd> <dt>

*пфрлестимате* \[ заполняет\]
</dt> <dd>

Тип: **\_ \_ уровень \* риска файла**

При успешном возврате этой функции содержит указатель на одно из следующих значений, которые заменяют предполагаемый риск.

<dt>

<span id="FRL_NO_OPINION"></span><span id="frl_no_opinion"></span>

<span id="FRL_NO_OPINION"></span><span id="frl_no_opinion"></span>**ФРЛ \_ НЕТ \_ мнения** (0)


</dt> <dd>

Формат файла не определен, или обработчик не определен. Недостаточно сведений для осмысленного ответа.

</dd> <dt>

<span id="FRL_LOW"></span><span id="frl_low"></span>

<span id="FRL_LOW"></span><span id="frl_low"></span>**ФРЛ \_ НИЗКАЯ** (1)


</dt> <dd>

Формат файла полностью понятен, обработчик известен, и существует высокая уверенность в том, что лишний код не будет выполняться.

</dd> <dt>

<span id="FRL_MODERATE"></span><span id="frl_moderate"></span>

<span id="FRL_MODERATE"></span><span id="frl_moderate"></span>**ФРЛ \_ УМЕРЕНное** (2)


</dt> <dd>

Формат файла определен, но он не может быть понятен метке как высокий или низкий риск.

</dd> <dt>

<span id="FRL_HIGH"></span><span id="frl_high"></span>

<span id="FRL_HIGH"></span><span id="frl_high"></span>**ФРЛ \_ ВЫСОКИЙ** (3)


</dt> <dd>

Формат файла понятен, и были обнаружены повышенные факторы риска.

</dd> <dt>

<span id="FRL_BLOCK"></span><span id="frl_block"></span>

<span id="FRL_BLOCK"></span><span id="frl_block"></span>**ФРЛ \_ BLOCK** (4)


</dt> <dd>

Формат файла специально заблокирован для этого обработчика.

</dd> </dl> </dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Тип: **HRESULT**

Если эта функция завершается успешно, возвращается значение **S \_ ОК**. В противном случае возвращается код ошибки **HRESULT** .

## <a name="remarks"></a>Remarks

Эта функция не объявлена в общедоступном заголовке или включена в файл библиотеки. Чтобы использовать его, необходимо загрузить его непосредственно из Winshfhc.dll с порядковым номером 101.

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|----------------------------------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows XP с пакетом обновления 2 (SP2) \[ только классические приложения\]<br/>                                                           |
| Минимальная версия сервера<br/> | Windows Только для \[ настольных приложений сервера 2003\]<br/>                                                           |
| DLL<br/>                      | <dl> <dt>Winshfhc.dll (версия 5,1 или более поздняя)</dt> </dl> |



 

 




