---
description: Windows Обозреватель предоставляет графическое представление пространства имен оболочки в сочетании с инструментами, которые позволяют пользователям взаимодействовать с объектами оболочки.
ms.assetid: cc387338-15fa-4350-b039-61a0f1c5030a
title: Основные сведения о расширениях пространства имен оболочки
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d972239320c633a12d4d162ec1593b82b9b02fb9d15a1a0bc9ee908abc8ac64d
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119820954"
---
# <a name="understanding-shell-namespace-extensions"></a>Основные сведения о расширениях пространства имен оболочки

Windows Обозреватель предоставляет графическое представление пространства имен оболочки в сочетании с инструментами, которые позволяют пользователям взаимодействовать с объектами оболочки. с помощью расширения пространства имен можно получить любой текст данных, чтобы Windows обозреватель представлю его пользователю в качестве виртуальной папки. Когда пользователь переходит в эту папку, данные представляются в виде древовидной иерархии папок и файлов, подобно остальной части пространства имен оболочки. Пользователи и приложения могут взаимодействовать с содержимым этой виртуальной папки практически так же, как и с любым другим объектом пространства имен. В этом документе описывается создание расширения пространства имен.

-   [Как работает расширение пространства имен](#how-a-namespace-extension-works)
-   [Объект представления системной папки по умолчанию (Дефвиев)](#the-default-system-folder-view-object-defview)
-   [взаимодействие Windows Explorer с расширением пространства имен](#how-windows-explorer-interacts-with-a-namespace-extension)
    -   [Вид дерева](#tree-view)
    -   [Представление папки](#folder-view)
    -   [Строка меню и панели инструментов](#menu-bar-and-toolbars)
    -   [Строка состояния](#status-bar)

## <a name="how-a-namespace-extension-works"></a>Как работает расширение пространства имен

в фоновом режиме каждая папка, отображаемая Windows Explorer, представлена объектом модели COM, называемым *объектом folder*. Каждый раз, когда пользователь взаимодействует с папкой или ее содержимым, оболочка взаимодействует со связанным объектом Folder через один из нескольких стандартных интерфейсов. затем объект folder выполняет все необходимое для реагирования на действие пользователя, и оболочка обновляет отображение Windows Explorer.

Большинство файлов и папок, с которыми взаимодействуют пользователи, являются частью файловой системы или системной виртуальной папкой, например корзиной. В другой документации обсуждалось, как можно настроить поведение этих стандартных папок в соответствии с требованиями приложения путем изменения реестра или реализации [обработчиков расширений оболочки](handlers.md). Тем не менее, расширение оболочки в таких случаях наиболее полезно, когда данные можно упаковать в виде обычных файлов или папок файловой системы.

Существует несколько ситуаций, когда хранение данных в виде коллекции папок файловой системы и файлов может оказаться нежелательным или даже невозможным. Ниже приведены некоторые примеры этих типов данных.

-   Коллекция элементов, которая наиболее эффективно упакована в один файл, например в базу данных.
-   коллекция элементов, хранящихся на удаленном компьютере без стандартной Windows файловой системы. Примером таких данных являются сведения, хранящиеся в личном цифровом помощнике (PDA) или цифровой камере.
-   Коллекция элементов, которые не представляют сохраненные данные. Примером таких данных являются ссылки на принтеры, содержащиеся в папке Стандартные принтеры.

Одним из способов представления данных такого рода пользователю является написание приложения, позволяющее пользователям просматривать различные элементы и взаимодействовать с ними. однако, если данные могут быть представлены в виде иерархии папок или файлов, многие из функций, которые необходимо реализовать, могут быть службами пользовательского интерфейса, которые уже предоставляются обозревателем Windows. гораздо более эффективный подход — написать расширение пространства имен и позволить Windows Explorer стать графическим интерфейсом пользователя.

Для реализации расширения пространства имен ваша информация должна быть организована как пространство имен, структурированное деревом. *Корень пространства имен* представлен в виде виртуальной папки в пространстве имен оболочки. корневая папка и все ее вложенные папки и элементы данных становятся частью пространства имен Shell, а Windows Explorer превращается в пользовательский интерфейс. Таким образом, вы можете предоставить сведения пользователю в привычном и удобном для вас виде, не применяя для пользовательского приложения гораздо меньше программирования.

Расширение пространства имен состоит из двух основных компонентов:

-   Диспетчер данных
-   интерфейс между диспетчером данных и обозревателем Windows

Первый компонент в списке полностью предназначен для вас. Вы можете хранить данные и управлять ими любым способом, наиболее эффективным. второй компонент — это код, необходимый для упаковки данных в качестве объектов папок и управления взаимодействием с Windows Explorer. Windows Обозреватель может затем вызывать эти объекты, чтобы пользователи могли просматривать данные и взаимодействовать с ними так, как если бы они были коллекцией папок и файлов. объекты папки расширения пространства имен должны взаимодействовать с Windows Explorer, как если бы они были обычными папками. прежде чем пытаться реализовать расширение пространства имен, необходимо понять, как Windows Explorer обрабатывает объект folder.

## <a name="the-default-system-folder-view-object-defview"></a>Объект представления системной папки по умолчанию (Дефвиев)

Оболочка предоставляет реализацию представления папки по умолчанию разговорной речи, известную как Дефвиев, что позволяет избежать большей части работы по реализации расширения пространства имен. Поскольку некоторые функции представления не могут быть реализованы с помощью пользовательских представлений, часто рекомендуется использовать объект представления системной папки по умолчанию вместо пользовательского представления. Дополнительные сведения см. в разделе [**шкреатешеллфолдервиев**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shcreateshellfolderview).

## <a name="how-windows-explorer-interacts-with-a-namespace-extension"></a>взаимодействие Windows Explorer с расширением пространства имен

Windows Обозреватель предоставляет пользователям графический интерфейс, позволяющий выполнять различные задачи, в том числе:

-   [Навигация](navigate.md) по иерархии пространств имен и просмотру содержимого папок.
-   [Управление](manage.md) содержимым пространства имен путем перемещения, удаления и копирования объектов.
-   [Получение](folder-info.md) различных сведений об объектах.
-   [Запуск](launch.md) приложений.

графический пользовательский интерфейс обозревателя Windows имеет пять основных компонентов. на следующем рисунке показаны названия компонентов и показано, где они обычно отображаются в обозревателе Windows Explorer.

![Иллюстрация, демонстрирующая компоненты пользовательского интерфейса проводника Windows ](images/nse1.png)

когда пользователь отображает папку, принадлежащую к расширению пространства имен в Windows Explorer, объект folder имеет по крайней мере частичный контроль над содержимым всех пяти областей.

### <a name="tree-view"></a>Вид дерева

Представление в виде дерева предоставляет общее представление пространства имен. В этой области размещается [элемент управления представлением в виде дерева](../controls/tree-view-controls.md) , который может отображать все папки пространств имен и их расположение в иерархии пространства имен. Пользователь может выполнять несколько операций с областью представления в виде дерева, в том числе:

-   Отображение или скрытие следующего уровня в пространстве имен.
-   Копирование, перемещение или удаление папок.
-   Щелкнув правой кнопкой мыши папку для вывода контекстного меню.
-   Выбор папки и просмотр ее содержимого в представлении папки.

Представление в виде дерева обменивается данными с объектами папок в основном через интерфейс [**ишеллфолдер**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) . например, когда пользователь щелкает значок «плюс» (+) рядом со значком папки, Windows Explorer разворачивает отображение для отображения вложенных папок папки. Чтобы получить сведения, необходимые для обновления древовидного представления, оболочка выполняет несколько вызовов интерфейса **ишеллфолдер** объекта Folder:

-   Запросите атрибуты папки.
-   Перечисление содержимого папки.
-   Запросите отображаемые имена для каждой вложенной папки.
-   Запрос значка, отображаемого рядом с каждой папкой.

Windows Затем обозреватель обновляет представление в виде дерева, отображая вложенные папки выбранной папки. Если вложенные папки имеют вложенные папки, рядом со значком папки отображается символ "+". Существует ряд более сложных задач, которые пользователь может также выполнять с представлением в виде дерева, в том числе:

-   С помощью буфера обмена вырежьте или скопируйте папку и вставьте ее в другую папку.
-   Используйте перетаскивание, чтобы вырезать или скопировать папку и поместить ее в другую папку.
-   Использование поисковой системы для поиска элементов в папке или ее вложенных папках.
-   Изменение свойств папки.

Более подробное описание того, как расширение пространства имен обрабатывает эти действия пользователя, см. [в разделе Реализация базовых интерфейсов объекта папки](nse-implement.md).

### <a name="folder-view"></a>Представление папки

Когда пользователь выбирает папку, содержимое папки отображается в представлении папки. В некоторой степени нормальная функциональность представления папок пересекается с древовидным представлением. Пользователи могут перемещать или копировать папки, изменять свойства папок, просматривать содержимое вложенной папки, отображать контекстное меню для папки и т. д. Однако между представлением в виде дерева и папкой существует ряд различий.

-   В представлении папок отображается только содержимое одной папки, а не части или всей иерархии пространства имен.
-   В представлении папок отображаются объекты файлов, а также объекты папок.
-   Представление папок может отображать гораздо больше сведений об объектах, чем представление в виде дерева.
-   Представление папок позволяет расширениям пространства имен иметь практически полный контроль над отображаемой информацией и тем, как. Изменять можно только небольшие аспекты представления в виде дерева, такие как значки папок.

в отличие от древовидного представления, Windows Explorer не контролирует непосредственно содержимое представления папки. представление папки — это область, которую Windows обозреватель предоставляет объектам папки. За отображением и управлением содержимым папки в представлении папок отвечает объект Folder. Хотя большинство представлений папок имеют довольно стандартный формат, на самом деле есть несколько ограничений на то, что может быть отображено или как. Крайний случай — это Интернет-папка, которая является полнофункциональным браузером.

когда пользователь выбирает папку, принадлежащую расширению пространства имен, вы создаете окно и передаете его обработчик в Windows Explorer. Это окно станет дочерним по отношению к окну представления папок. Windows Обозреватель предоставляет размеры окна представления папок, но не накладывает ограничений на содержимое своего дочернего окна. Затем можно использовать дочернее окно, чтобы отобразить представление папки папки.

Расширения пространства имен используют один из двух способов создания представления папок.

-   Используйте дочернее окно для размещения элемента управления " [представление списка](../controls/list-view-control-reference.md) ". этот элемент управления позволяет отображать содержимое папки практически так же, как [классический вид](../lwef/web-view.md)обозревателя Windows.
-   Используйте дочернее окно для размещения [элемента управления WebBrowser](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa752044(v=vs.85)) и воспользуйтесь ДИНАМИЧЕСКИм HTML-документом (DHTML) для вывода содержимого папки.

В обоих подходах отображается представление папок, которое выглядит примерно так же, как и для системных папок. Тем не менее, если вы хотите использовать другую схему вывода, это можно сделать без каких-либо действий.

### <a name="menu-bar-and-toolbars"></a>Строка меню и панели инструментов

как и большинство Windows приложений, обозреватель Windows предоставляет пользователю набор средств. Полный набор инструментов доступен в строке меню. Наиболее часто используемые инструменты также представлены кнопками или полями ввода на панели инструментов. в отличие от многих Windows приложений, панель меню обозревателя Windows — это [элемент управления toolbar](../controls/toolbar-control-reference.md) , настроенный таким образом, что он работает как обычное меню. И строка меню, и панель инструментов включены в [элемент управления главной панели](../controls/rebar-control-reference.md) , чтобы пользователи могли упорядочивать отдельные элементы управления в соответствии с их потребностями.

по умолчанию Windows Explorer поддерживает стандартный набор кнопок и пунктов меню, таких как копирование и свойства. Расширение пространства имен может настраивать панель меню и панели инструментов, удаляя стандартные средства и добавляя пользовательские инструменты. при инициализации объекта представления папки Windows обозреватель передает указатель на его интерфейс [**ишеллбровсер**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellbrowser) . Этот интерфейс поддерживает несколько методов, которые можно вызывать для настройки строки меню и панели инструментов. когда пользователь выбирает один из настраиваемых элементов меню или кнопок на панели инструментов, Windows Explorer пересылает \_ командные сообщения WM для пользовательских меню и элементов панели инструментов в процедуру окна дочернего окна.

### <a name="status-bar"></a>Status Bar

в строке состояния обозревателя Windows отображаются сведения о выбранном в данный момент объекте. Расширение пространства имен может использовать строку состояния для вывода сведений о состоянии, например текстовой строки. Строку состояния можно настроить, вызвав [**ишеллбровсер**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellbrowser).

 

 
