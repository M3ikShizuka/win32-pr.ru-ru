---
description: Выполняет указанную операцию с указанным файлом.
ms.assetid: 62E59A1C-51BD-4864-AF09-35FFD49FAB9D
title: Метод Shell.ShellExecute (Shldisp.h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- Shell.ShellExecute
api_type:
- COM
api_location:
- Shell32.dll
ms.openlocfilehash: 83ab9741199bff675245f15dc2ad1ffb20592a35
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104985604"
---
# <a name="shellshellexecute-method"></a>Shell. ShellExecute, метод

Выполняет указанную операцию с указанным файлом.

## <a name="syntax"></a>Синтаксис

Присутствовал

```js
iRetVal = Shell.ShellExecute(
  sFile,
  [ vArguments ],
  [ vDirectory ],
  [ vOperation ],
  [ vShow ]
);
```

Сценариев

```vb
iRetVal = Shell.ShellExecute( _
  sFile, _
  [ ByVal vArguments ], _
  [ ByVal vDirectory ], _
  [ ByVal vOperation ], _
  [ ByVal vShow ] _
)
```

VB:

```vb
Shell.ShellExecute( _
  ByVal sFile As BSTR, _
  [ ByVal vArguments As Variant ], _
  [ ByVal vDirectory As Variant ], _
  [ ByVal vOperation As Variant ], _
  [ ByVal vShow As Variant ] _
) As Integer
```

## <a name="parameters"></a>Параметры

<dl> <dt>

*сфиле* \[ окне\]
</dt> <dd>

Тип: **[ **BSTR**](/previous-versions/windows/desktop/automat/bstr)**

**Строка** , содержащая имя файла, в котором **ShellExecute** будет выполнять действие, заданное параметром *воператион*.

</dd> <dt>

*варгументс* \[ в необязательное\]
</dt> <dd>

Тип: **Variant**

Строка, содержащая значения параметров для операции.

</dd> <dt>

*вдиректори* \[ в необязательное\]
</dt> <dd>

Тип: **Variant**

Полный путь к каталогу, содержащему файл, указанный параметром *сфиле*. Если этот параметр не указан, используется текущий рабочий каталог.

</dd> <dt>

*воператион* \[ в необязательное\]
</dt> <dd>

Тип: **Variant**

Операция, которая выполняется. Это значение устанавливается равным одной из строк команд, поддерживаемых файлом. Описание команд см. в разделе "Примечания". Если этот параметр не указан, выполняется операция по умолчанию.

</dd> <dt>

*вшов* \[ в необязательное\]
</dt> <dd>

Тип: **Variant**

Рекомендации относительно того, как окно приложения должно отображаться изначально. Приложение может игнорировать эту рекомендацию. Этот параметр может принимать одно из указанных ниже значений. Если этот параметр не указан, приложение использует значение по умолчанию.



| Значение                                                                                                                               | Значение                                                                                                                                                  |
|-------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------|
| <dl> <dt></dt> <dt>0</dt> </dl>  | Откройте приложение с помощью скрытого окна.<br/>                                                                                                    |
| <dl> <dt></dt> <dt>1</dt> </dl>  | Откройте приложение в нормальном окне. Если окно является сведенным или развернутым, система восстанавливает его исходный размер и расположение.<br/> |
| <dl> <dt></dt> <dt>2</dt> </dl>  | Откройте приложение с помощью сворачивания окна.<br/>                                                                                                 |
| <dl> <dt></dt><dt>3</dt> </dl>  | Откройте приложение с развернутым окном.<br/>                                                                                                 |
| <dl> <dt></dt><dt>4</dt> </dl>  | Откройте приложение со своим окном в последнем размере и позиции. Активное окно остается активным.<br/>                                  |
| <dl> <dt></dt><dt>5</dt> </dl>  | Откройте приложение с его текущим размером и положением в своем окне.<br/>                                                                        |
| <dl> <dt></dt><dt>7</dt> </dl>  | Откройте приложение с помощью сворачивания окна. Активное окно остается активным.<br/>                                                               |
| <dl> <dt></dt><dt>10</dt> </dl> | Откройте приложение со своим окном в состоянии по умолчанию, заданном приложением.<br/>                                                       |



 

</dd> </dl>

## <a name="remarks"></a>Примечания

Этот метод эквивалентен запуску одной из команд, связанных с контекстным меню файла. Каждая команда представляется строкой команды. Набор поддерживаемых команд отличается от файла к файлу. Наиболее часто поддерживаемая команда — "Open", которая также обычно является глаголом по умолчанию. Другие команды могут поддерживаться только определенными типами файлов. Дополнительные сведения о командах оболочки см. в статье [Запуск приложений](launch.md) или [расширение контекстных меню](context.md).

Этот метод в настоящее время недоступен в Microsoft Visual Basic.

## <a name="examples"></a>Примеры

В следующих примерах показано использование **ShellExecute** для открытия блокнота. Для JScript и VBScript отображается использование.

Присутствовал


```JScript
function ShellExecuteJS()
{
    var objShell = new ActiveXObject("Shell.Application");
    objShell.ShellExecute("notepad.exe", "", "", "open", 1);
}
```

Сценариев

```vb
Function ShellExecuteVB()
    Dim objShell
    Set objShell = CreateObject("Shell.Application")
    Call objShell.ShellExecute("notepad.exe", "", "", "open", 1)
End Function
```



## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|---------------------------------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows 2000 Professional, только для \[ классических приложений Windows XP\]<br/>                                        |
| Минимальная версия сервера<br/> | \[Только для настольных приложений Windows Server 2003\]<br/>                                                          |
| Header<br/>                   | <dl> <dt>Шлдисп. h</dt> </dl>                          |
| IDL<br/>                      | <dl> <dt>Шлдисп. idl</dt> </dl>                        |
| DLL<br/>                      | <dl> <dt>Shell32.dll (версия 5,0 или более поздняя)</dt> </dl> |



 

 
