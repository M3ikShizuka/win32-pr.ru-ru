---
description: Меню Пуск в Windows XP и Windows Vista содержит зарезервированные слоты для клиентов Интернета (браузер) и электронной почты (почты), которые обычно называются Интернет-приложениями «Пуск».
ms.assetid: a3d7416f-0dbd-4af2-ab38-758f9cc8aec5
title: Как зарегистрировать Интернет браузер или почтовый клиент в меню "Пуск" Windows
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: eccdd8fb8efe32522947b30ab2ce1a50b7058e97
ms.sourcegitcommit: de72a1294df274b0a71dc0fdc42d757e5f6df0f3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/05/2021
ms.locfileid: "104273314"
---
# <a name="how-to-register-an-internet-browser-or-email-client-with-the-windows-start-menu"></a>Как зарегистрировать Интернет браузер или почтовый клиент в меню "Пуск" Windows

> [!Note]  
> Этот раздел относится к Windows XP, Windows Vista и Windows 7.

 

Меню Пуск в Windows XP и Windows Vista содержит зарезервированные слоты для клиентов **Интернета** (браузер) и **электронной почты** (почты), которые обычно называются *Интернет-приложениями «Пуск*». Приложения, которые регистрируются как меню "Пуск", Интернет-приложения выполняют все это во всей системе (на компьютере). В Windows Vista пользователь может использовать функцию **по умолчанию** для настройки параметров по умолчанию для каждого пользователя.

Когда приложения регистрируются как меню "Пуск" в Интернете, Windows XP и Windows Vista создают значки " **Интернет** " и " **Электронная почта** " в меню "Пуск". Если щелкнуть эти значки, в меню "Пуск" будет проверяться поддерево реестра для каждого пользователя (**hKey \_ текущий \_ пользователь**). Если параметр по умолчанию для каждого пользователя не найден, меню "Пуск" выполняет поиск подраздела по умолчанию на компьютере в поддереве " **\_ локальный \_ компьютер" hKey** .

> [!Note]  
> Установка Windows по умолчанию не регистрирует программу Интернет или электронную почту по умолчанию для каждого пользователя, а только для всей системы по умолчанию. Это обеспечивает плавный переход от предыдущих версий операционной системы, в которых \_ поддерживается только поддерево "локальный компьютер" hKey \_ для регистрации клиентов.

 

В этом разделе обсуждаются следующие элементы:

-   [Регистрация для подключения к Интернету в меню "Пуск"](#registering-for-the-start-menu-internet-link)
    -   [Как зарегистрироваться в качестве Интернет клиента по умолчанию](#how-to-register-as-the-default-internet-client)
-   [Регистрация для ссылки на электронную почту меню "Пуск"](#registering-for-the-start-menu-email-link)
    -   [Как в меню «Пуск» отображается почтовый клиент по умолчанию](#how-the-start-menu-displays-the-default-email-client)
    -   [Как зарегистрироваться в качестве почтового клиента по умолчанию](#how-to-register-as-the-default-email-client)
-   [Настройка контекстного меню](#customizing-the-context-menu)

## <a name="registering-for-the-start-menu-internet-link"></a>Регистрация для подключения к Интернету в меню "Пуск"

> [!Note]  
> Эта регистрация является устаревшей по отношению к Windows 7, которая больше не предоставляет Интернет-ссылку меню "Пуск". Существующие регистрации игнорируются в Windows 7 и более поздних версиях. Регистрация в качестве Интернет-приложения по умолчанию в меню "Пуск" не аналогична регистрации в качестве браузера по умолчанию. Веб-браузер по умолчанию используется для запуска произвольных URL-адресов из любого места в системе. Интернет-приложение "Пуск" просто управляет программой, которая запускается, когда пользователь щелкает значок Интернета в меню "Пуск".

 

Любое приложение браузера может зарегистрироваться в качестве Интернет-клиента в меню "Пуск". Эта видимость, связанная с правильной регистрацией [файлов](fa-intro.md) и типов [протоколов](/previous-versions//aa767743(v=vs.85)) приложения, предоставляет состояние браузера по умолчанию для приложения.

Регистрации, сделанные в поддереве **hKey \_ Current \_ User** , имеют более высокий приоритет, чем соответствующие регистрации, сделанные на **\_ локальном \_ компьютере hKey**. Для новых пользователей в системе используются параметры, хранящиеся на **\_ локальном \_ компьютере hKey** . Начиная с Windows XP, в меню "Пуск" параметры Internet сохраняются в записях по умолчанию в двух расположениях реестра:

-   **HKey \_ Клиенты текущего \_ пользовательского** \\ **программного обеспечения** \\  \\ **стартменуинтернет**
-   **HKey \_ Клиенты по для локального \_ компьютера** \\  \\  \\ **стартменуинтернет**

В подразделе **hKey \_ Current \_ User** \\ **Software** \\ **Clients** \\ **стартменуинтернет** описывается Интернет-браузер, который запускается, когда пользователь щелкает значок **Интернета** в меню "Пуск". Если этот подраздел пуст или отсутствует, значок **Интернета** в меню "Пуск" будет иметь значение по умолчанию, которое хранится во втором расположении в разделе **hKey \_ Local \_ Machine** \\ **Software** \\ **Clients** \\ **стартменуинтернет** , где описаны все приложения браузера, установленные в системе.

Когда новый пользователь входит в систему, в меню "Пуск" используется значение по умолчанию в подразделе раздела **hKey \_ Local \_ Machine** \\ **Software** \\ **Clients** \\ **стартменуинтернет** to отображать Интернет-клиент по умолчанию и запускать зарегистрированное приложение при нажатии на этот значок.

### <a name="how-to-register-as-the-default-internet-client"></a>Как зарегистрироваться в качестве Интернет клиента по умолчанию

Под подразделом **hKey Software \_ Local \_ Machine** \\  \\ **Clients** \\ **стартменуинтернет** может быть ноль или более подразделов, по одному для каждого зарегистрированного приложения браузера Интернета. Например, гипотетическая система может иметь следующее расположение:

```
HKEY_LOCAL_MACHINE
   SOFTWARE
      Clients
         StartMenuInternet
            IEXPLORE.EXE
            BROWSER2.EXE
            BROWSER3.EXE
```

Мы покажем записи реестра с гипотетическым браузером под названием «освещенное представление» от вымышленной компании с именем Litware Inc. Предположим, что имя исполняемого файла для представления «освещенность» Litview.exe. Регистрация светового представления выполняется, как показано ниже:

```
HKEY_LOCAL_MACHINE
   SOFTWARE
      Clients
         StartMenuInternet
            LITVIEW.EXE
               LocalizedString = @C:\Program Files\LitwareInc\ResourceDLL.dll,-123
```

Данные Локализедстринг имеют тип REG \_ SZ или REG \_ expand \_ SZ, если используются переменные пути, такие как `%programfiles%` . Локализедстринг предоставляет путь к исполняемому файлу (exe) или библиотеке (DLL). Обратите внимание, что строка пути начинается со знака «at» (@) и не требует ввода кавычек для пути, независимо от пробелов в нем. Десятичное целое число — это идентификатор строкового ресурса, содержащийся в указанной библиотеке DLL, значение которого должно отображаться для пользователя. Это позволяет использовать одну и ту же регистрацию для нескольких языков. Каждый язык предоставляет разные ResourceDLL.dll. Это позволяет системе отображать правильную строку на основе текущего выбранного языка.

Следующее значение REG \_ SZ или REG \_ expand \_ SZ информирует меню "Пуск" значка по умолчанию, которое отображается, когда пользователь выбирает представление "освещенность" в браузере в меню "Пуск" в Интернете.

```
HKEY_LOCAL_MACHINE
   SOFTWARE
      Clients
         StartMenuInternet
            LITVIEW.EXE
               DefaultIcon
                  (Default) = C:\Program Files\LitwareInc\LitView.exe,1
```

В следующем подразделе реестра указана Командная строка, которая будет запускаться при нажатии пользователем команды меню "Интернет" в меню "Пуск" при условии, что режим освещенности является выбранным веб-браузером меню "Пуск". Например, команда может открыть браузер с помощью домашней страницы пользователя, или команда может запустить вводный пользовательский интерфейс, подходящий для независимого поставщика программного обеспечения (ISV). Данные имеют тип REG \_ SZ или REG \_ expand \_ SZ, но обратите внимание, что, поскольку в пути командной строки имеется пробел, путь к исполняемому файлу заключается в кавычки.

```
HKEY_LOCAL_MACHINE
   SOFTWARE
      Clients
         StartMenuInternet
            LITVIEW.EXE
               shell
                  open
                     (Default) = "C:\Program Files\LitwareInc\LitView.exe" -welcome
```

Если пользователь указывает, что в качестве веб-браузера по умолчанию на уровне компьютера следует использовать режим [доступа к программам и параметры по умолчанию (SPAD)](cpl-setprogramaccess.md) , приложение должно задать следующую \_ запись reg SZ. Обратите внимание, что, поскольку SPAD работает с правами администратора, доступ к этому подразделу разрешен.

```
HKEY_LOCAL_MACHINE
   SOFTWARE
      Clients
         StartMenuInternet
            (Default) = LITVIEW.EXE
```

> [!Note]
> В Windows Vista веб-браузер по умолчанию на уровне пользователя должен быть установлен с помощью средства **программы по умолчанию** , а не [SPAD](cpl-setprogramaccess.md).
> 
> **Приведенные ниже сведения относятся только к Windows XP.**
> 
> Если регистрация веб-браузера по умолчанию на уровне компьютера в разделе HKEY \_ локальный \_ компьютер, как показано выше, выполняется успешно, приложение должно удалить запись по умолчанию в следующем подразделе:
> 
> ```
> HKEY_CURRENT_USER
>    SOFTWARE
>       Clients
>          StartMenuInternet
> ```
> 
> Если при регистрации веб-браузера по умолчанию на уровне компьютера в разделе HKEY \_ \_ на локальном компьютере происходит сбой, приложение должно задать \_ данные reg SZ, как показано в следующем примере для приложения с представлением "освещенность":
> 
> ```
> HKEY_CURRENT_USER
>    SOFTWARE
>       Clients
>          (Default) = LITVIEW.EXE
> ```

 

После обновления соответствующих подразделов приложение передает сообщение [**WM \_ сеттингчанже**](../winmsg/wm-settingchange.md) с его параметром *wParam* , имеющим значение 0, и параметр *lParam* , указывающий на строку, завершающуюся нулем `"Software\Clients\StartMenuInternet"` . Это уведомление операционной системы о том, что клиент по умолчанию изменился.

Установка этих подразделов для веб-браузера по умолчанию в меню "Пуск" необходима для сохранения обратной совместимости со старыми браузерами, которые не поддерживают регистрацию для каждого пользователя.

## <a name="registering-for-the-start-menu-email-link"></a>Регистрация для ссылки на электронную почту меню "Пуск"

> [!Note]  
> Ссылка на электронную почту меню "Пуск" была удалена в Windows 7. Однако эта регистрация, обсуждаемая в этом разделе, по-прежнему должна выполняться при назначении клиента MAPI по умолчанию.

 

### <a name="how-the-start-menu-displays-the-default-email-client"></a>Как в меню «Пуск» отображается почтовый клиент по умолчанию

Любое приложение электронной почты может зарегистрироваться, чтобы оно отображалось как почтовый клиент в меню "Пуск". Эта видимость, связанная с правильной регистрацией [файлов](fa-intro.md) и типов [протоколов](/previous-versions//aa767743(v=vs.85)) приложения, предоставляет состояние почты приложения по умолчанию.

Регистрации, сделанные в поддереве **hKey \_ Current \_ User** , имеют более высокий приоритет, чем соответствующие регистрации, сделанные на **\_ локальном \_ компьютере hKey**. Для новых пользователей в системе используются параметры, хранящиеся на **\_ локальном \_ компьютере hKey** . Начиная с Windows XP параметры электронной почты в меню "Пуск" хранятся в записях по умолчанию в двух расположениях реестра:

-   **HKey \_ Почта клиентов текущего \_ пользовательского** \\ **программного обеспечения** \\  \\ 
-   **HKey \_ \_** Почта для \\  \\ **клиентов** \\  по локальному компьютеру

В подразделе **hKey \_ Current \_ User** \\ **Software** \\ **Clients** \\ **mail описывается почтовый** клиент, который запускается, когда пользователь щелкает значок **электронной почты** в меню "Пуск".

В подразделе **hKey \_ Local \_ Machine** \\ **Software** \\ **Clients** \\ **mail** описываются приложения электронной почты, установленные в системе, а также приложение электронной почты по умолчанию.

Если почта " **hKey \_ Current \_ User** \\ **Software** \\ **Clients**" \\  пуста или отсутствует, значение по умолчанию, определенное в списке "программное обеспечение на **\_ локальном \_ компьютере**", \\  \\  \\  используется для выбора почтового приложения, отображаемого в меню "Пуск".

При входе нового пользователя в систему в меню "Пуск" используется значение по умолчанию в подразделе раздела **hKey \_ Local \_ Machine** \\ **Software** \\ **Clients** \\ **mail** , чтобы отобразить почтовый клиент по умолчанию и запустить зарегистрированное приложение при нажатии этого значка.

### <a name="how-to-register-as-the-default-email-client"></a>Как зарегистрироваться в качестве почтового клиента по умолчанию

**HKey \_ \_** \\ **По** электронной почте клиенты локального компьютера \\  \\  могут содержать ноль или более подразделов, по одному для каждого зарегистрированного приложения электронной почты. Например, гипотетическая система может определять следующие подразделы:

```
HKEY_LOCAL_MACHINE
   SOFTWARE
      Clients
         Mail
            Eudora
            Windows Mail
```

Мы покажем записи реестра с гипотетическим почтовым клиентом, именуемым «освещенная почта», из вымышленной компании с именем Litware Inc. Litware Inc. решает зарегистрировать почтовый клиент по внутреннему имени «Литмаил». Как и в случае с браузером, внутреннее имя — это уникальная строка, используемая в качестве имени подраздела, но она никогда не отображается для пользователя.

Чтобы установить клиент электронной почты освещенности по умолчанию, он использует следующий подраздел и его записи:

```
HKEY_LOCAL_MACHINE
   SOFTWARE
      Clients
         Mail
            LitMail
               (Default) = Lit Mail
               LocalizedString = @C:\Program Files\LitwareInc\ResourceDLL.dll,-456
```

Данные Локализедстринг имеют тип REG \_ SZ или REG \_ expand \_ SZ, если используются переменные пути, такие как `%programfiles%` . Локализедстринг предоставляет путь к исполняемому файлу (exe) или библиотеке (DLL). Обратите внимание, что строка пути начинается со знака «at» (@) и не требует ввода кавычек для пути, независимо от пробелов в нем. Десятичное целое число — это идентификатор строкового ресурса, содержащийся в указанной библиотеке DLL, значение которого должно отображаться для пользователя. Это позволяет использовать одну и ту же регистрацию для нескольких языков. Каждый язык предоставляет разные ResourceDLL.dll. Это позволяет системе отображать правильную строку на основе текущего выбранного языка.

После обновления соответствующих подразделов приложение передает сообщение [**WM \_ сеттингчанже**](../winmsg/wm-settingchange.md) с его параметром *wParam* , имеющим значение 0, и параметр *lParam* , указывающий на строку, завершающуюся нулем `"Software\Clients\Mail"` . Это уведомление операционной системы о том, что клиент по умолчанию изменился.

Для обеспечения обратной совместимости с приложениями, которые не поддерживают локализованные строки, имя приложения на установленном языке также должно быть задано в качестве значения по умолчанию для подраздела.

Следующее значение **reg \_ SZ** или **reg \_ expand \_ SZ** информирует меню "Пуск" значка по умолчанию, которое отображается, когда пользователь выбирает в меню "Пуск" пункт "Освещенная почта":

```
HKEY_LOCAL_MACHINE
   SOFTWARE
      Clients
         Mail
            LitMail
               DefaultIcon
                  (Default) = C:\Program Files\LitwareInc\LitMail.exe,1
```

Следующая запись указывает командную строку, которая будет запускаться, когда пользователь щелкает пункт меню " **Электронная почта** " в меню "Пуск", предполагая, что в меню "Пуск" выбрана программа электронной почты "горит". Эта командная строка также выполняется, если пользователь выбирает пункт **Чтение электронной почты** из меню **Сервис** Windows Internet Explorer. Данные имеют тип **reg \_ SZ** или **reg \_ expand \_ SZ**, но обратите внимание, что, поскольку в пути командной строки имеется пробел, путь к исполняемому файлу заключается в кавычки.

```
HKEY_LOCAL_MACHINE
   SOFTWARE
      Clients
         Mail
            shell
               open
                  command
                     (Default) = "C:\Program Files\LitwareInc\LitMail.exe" -inbox
```

Если (и только в том случае, если) *пользователь* указывает, что в меню "Пуск" по умолчанию задано освещенное сообщение электронной почты, оно может записать свое внутреннее имя в следующее значение **reg \_ SZ** :

```
HKEY_CURRENT_USER
   SOFTWARE
      Clients
         Mail
            (Default) = LitMail
```

Если (и только в том случае, если) *пользователь* указал свою почтовые сообщения как приложение электронной почты по умолчанию, оно может записать свое внутреннее имя в значение **reg \_ SZ** , указанное ниже. Обратите внимание, что доступ к этому подразделу может быть ограничен. В приложениях не следует рассчитывать, что все пользователи имеют разрешение на изменение приложения электронной почты по умолчанию в масштабе всей системы.

```
HKEY_LOCAL_MACHINE
   SOFTWARE
      Clients
         Mail
            (Default) = LitMail
```

Регистрация в качестве приложения электронной почты в меню "Пуск" по умолчанию не эквивалентна регистрации в качестве почтового клиента по умолчанию для системы или зарегистрированного обработчика *mailto* .

-   Почтовый клиент по умолчанию запускается, когда пользователь щелкает пункт **Чтение электронной почты** из меню **Сервис** Internet Explorer.
-   Зарегистрированный обработчик *mailto* запускается, когда пользователь щелкает URL-адрес формы `mailto:someone@example.com` .
-   Приложение электронной почты меню "Пуск" запускается, когда пользователь щелкает значок **электронной почты** в меню "Пуск".

Если не указано почтовое приложение по умолчанию меню "Пуск", значок электронной почты в меню "Пуск" запускает почтовый клиент по умолчанию.

В этом разделе не рассматривается регистрация приложения в качестве обработчика протокола *mailto* по умолчанию. Приложения, которые требуется зарегистрировать таким образом, должны продолжать следовать существующим спецификациям в этой теме.

## <a name="customizing-the-context-menu"></a>Настройка контекстного меню

Приложение может настраивать страницы свойств, отображаемые, когда пользователь выбирает **Свойства** из контекстного меню значка **электронной почты** (или **Интернета**). Например, приложение электронной почты Litware добавляет следующие данные **reg \_ SZ** или **reg \_ expand \_ SZ** , чтобы отобразить настраиваемую страницу свойств для значка **электронной почты** , а не страницу свойств по умолчанию.

```
HKEY_LOCAL_MACHINE
   SOFTWARE
      Clients
         Mail
            LitMail
               shell
                  properties
                     MUIVerb = @C:\Program Files\LitwareInc\ResourceDLL.dll,-789
                     command
                        (Default) = "C:\Program Files\LitwareInc\LitMail.exe" -properties
```

Элемент данных Муиверб создается, начиная с знака «at» (@), за которым следует полный путь к библиотеке DLL ресурсов, запятая, знак минуса (-), а затем отображаемый десятичный строковый идентификатор ресурса. Обратите внимание, что путь к программе LitMail.exe содержит пробелы, поэтому строка пути помещается в кавычки.

Приложение также может добавлять в контекстное меню дополнительные команды. Например, приложение электронной почты Litware добавляет команду **Find** со следующими данными **реестра \_ SZ** :

```
HKEY_LOCAL_MACHINE
   SOFTWARE
      Clients
         Mail
            LitMail
               shell
                  find
                     MUIVerb = @C:\Program File\LitwareInc\ResourceDLL.dll,-790
                     command
                        (Default) = "C:\Program Files\LitwareInc\LitMail.exe" -contacts
```

Имя подраздела под **оболочкой** (в данном случае "Find") является произвольным нелокализованным именем. Опять же, данные Муиверб содержат знак "at" (@) в качестве первого элемента, за которым следует путь к DLL-файлу ресурсов, разделитель запятой, а затем знак "минус" перед идентификатором десятичной строки. Например, строковый ресурс может иметь значение "открыть адресную книгу". Наконец, обратите внимание, что строка командной строки содержит пробелы, поэтому она заключается в кавычки.

 

 
