---
description: Когда пользователь щелкает правой кнопкой мыши объект оболочки, например файл, оболочка отображает контекстное меню (контекст).
ms.assetid: 4f46b8c3-1e12-447c-87f4-bbe2c305f77a
title: Команды и сопоставления файлов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a144051b04ef2d9a2c9877b53e1680d4274afc92d3fc87fbcb531b02a0f94946
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "117860797"
---
# <a name="verbs-and-file-associations"></a>Команды и сопоставления файлов

Когда пользователь щелкает правой кнопкой мыши объект оболочки, например файл, оболочка отображает контекстное меню (контекст). Это меню содержит список команд, которые пользователь может выбрать для выполнения различных действий с элементом. Эти команды также называются пунктами контекстного меню или командами. Контекстные меню можно настраивать.

Этот раздел организован следующим образом:

-   [Общие сведения о контекстных меню для объектов файловой системы](#introduction-to-shortcut-menus-for-file-system-objects)
    -   [Добавление команд в контекстное меню](#add-commands-to-a-shortcut-menu)
-   [Команды контекстного меню](#shortcut-menu-verbs)
-   [потоковая передача нефайловых элементов системы и OpenSearch результатов.](#stream-non-file-system-items-and-opensearch-results)
-   [Регистрация приложения для управления произвольными типами файлов](#register-an-application-to-handle-arbitrary-file-types)
-   [Дополнительные ресурсы](#additional-resources)
-   [Связанные темы](#related-topics)

## <a name="introduction-to-shortcut-menus-for-file-system-objects"></a>Общие сведения о контекстных меню для объектов файловой системы

Так как контекстные меню часто используются для управления файлами, оболочка предоставляет набор команд по умолчанию, таких как **вырезание** и **копирование**, которые отображаются в контекстном меню любого объекта файловой системы, например файла или папки.

В следующем примере показано контекстное меню по умолчанию, отображаемое при щелчке правой кнопкой мыши **MyFile.XYZ-MS**.

![снимок экрана контекстного меню по умолчанию](images/context-menu/context-filesystemobjects.png)

Причина, по которой контекстное меню по умолчанию отображается для **MyFile.XYZ-MS** , связано с тем, что **. XYZ-MS** не является членом зарегистрированного типа файла. Напротив, **.txt** является зарегистрированным типом файла. Если щелкнуть правой кнопкой мыши файл **.txt** , в его верхнем разделе появится контекстное меню с тремя дополнительными командами: **Печать**, **Редактирование** и **Открытие с помощью**.

![снимок экрана с контекстным меню для файла с зарегистрированным типом файла](images/context-menu/context-registeredfiletype.png)

Чтобы расширить контекстное меню для типа файла, необходимо создать запись реестра для каждой команды. Более сложный подход заключается в реализации обработчика контекстного меню (глагола), который позволяет расширять контекстное меню для типа файла по отдельности для каждого файла. Дополнительные сведения см. в разделе [Создание обработчиков контекстного меню](context-menu-handlers.md)и [Справочник по контекстному меню](context-menu-reference.md).

### <a name="add-commands-to-a-shortcut-menu"></a>Добавление команд в контекстное меню

Обработчик контекстного меню — это обработчик типа файлов, который добавляет команды в существующее контекстное меню. Обработчики контекстного меню связаны с типом файла и вызываются при отображении контекстного меню для члена класса. Оболочка проверяет реестр, чтобы убедиться, что тип файла связан с любыми обработчиками контекстного меню. Если это так, оболочка запрашивает обработчики для дополнительных пунктов контекстного меню.

## <a name="shortcut-menu-verbs"></a>Команды контекстного меню

Каждая команда контекстного меню определяется в реестре командой. Эти команды аналогичны тем, которые используются [**ShellExecuteEx**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecuteexa) при запуске приложений программным способом.

Глагол — это простая текстовая строка, которая используется оболочкой для обнаружения связанной команды. Каждая команда соответствует строке команды, используемой для запуска команды в окне консоли или в пакетном файле (.bat).

Например, команда Open обычно запускает программу, чтобы открыть файл. Командная строка обычно выглядит следующим образом:


```
"My Program.exe" "%1"
```



Если любой из элементов командной строки содержит или может содержать пробелы, его необходимо заключить в кавычки. В противном случае, если элемент содержит пробел, он будет проанализирован неправильно. Например, **"My Program.exe"** запускает приложение правильно. Если используется **Program.exe** без кавычек, система пытается запустить **My** с **Program.exe** в качестве первого аргумента командной строки. Следует всегда использовать кавычки с аргументами, такими как **"%1**", которые разворачиваются оболочкой, так как нельзя уверенно, что строка не будет содержать пробелов.

С командами также может быть связано отображаемое имя, которое отображается в контекстном меню вместо самой строки команды. Например, отображаемая строка для опенас **открыта с помощью**. Как и в обычных строках меню, включая символ амперсанда в отображаемой строке, можно выбрать команду с клавиатуры.

## <a name="stream-non-file-system-items-and-opensearch-results"></a>потоковая передача нефайловых элементов системы и OpenSearch результатов.

в Windows 7 и более поздних версий существует поддержка подключения внешних источников к клиенту Windows через протокол [OpenSearch](http://www.opensearch.org/) . это позволяет пользователям выполнять поиск в удаленном хранилище данных и просматривать результаты в обозревателе Windows. стандарт OpenSearch v 1.1 определяет простые форматы файлов, которые можно использовать для описания того, как клиент должен запрашивать веб-службу для хранилища данных и как служба должна возвращать результаты, отображаемые клиентом.

может потребоваться потоковая передача нефайловых элементов системы, чтобы избежать необходимости загружать элементы в случае [OpenSearch](http://www.opensearch.org/) результатов. функция федеративного поиска позволяет выполнять поиск элементов из нефайловых систем, которые поддерживают OpenSearch, например SharePoint и другие веб-службы с поддержкой web services, например. При вызове команд для этих элементов система скачивает временную версию элемента и передает ее в реализацию команды. Разработчикам команд рекомендуется избегать загрузки файла путем регистрации набора схем URL-адресов, поддерживаемых командой для потоковой передачи элементов. Команды делают это с помощью раздела реестра **суппортедпротоколс** .

## <a name="register-an-application-to-handle-arbitrary-file-types"></a>Регистрация приложения для управления произвольными типами файлов

Определение пунктов контекстного меню для определенного типа файлов позволяет указать, каким образом связанное приложение открывает элемент типа файла. Однако приложения также могут зарегистрировать отдельную процедуру по умолчанию, которая будет использоваться, когда пользователь пытается использовать приложение для открытия типа файла, не связанного с приложением. Процедура по умолчанию регистрируется практически так же, как при регистрации пунктов контекстного меню. Более подробные сведения об определении пунктов контекстного меню см. в разделе [Создание обработчиков контекстного меню](context-menu.md).

Процедура по умолчанию служит двум основным целям. Одним из них является указание способа вызова приложения для открытия произвольного типа файла. Например, можно использовать флаг командной строки, чтобы указать, что открывается неизвестный тип файла. Другой целью является определение различных характеристик типа файла, например пунктов контекстного меню и значка. Если пользователь связывает приложение с дополнительным типом файла, этот класс будет иметь эти характеристики. Если дополнительный тип файла был ранее связан с другим приложением, эти характеристики заменят оригиналы.

Чтобы зарегистрировать процедуру по умолчанию, поместите те же разделы реестра, которые были созданы для ProgID приложения, в подраздел приложения **\_ \_ корневые \\ приложения классов hKey**. Можно также включить значение **фриендляппнаме** , чтобы предоставить системе понятное имя приложения. Понятное имя приложения также может быть извлечено из исполняемого файла, но только в том случае, если значение Фриендляппнаме отсутствует.

Следующий пример записи реестра иллюстрирует процедуру по умолчанию для **MyProgram.exe** , которая определяет понятное имя и несколько пунктов контекстного меню. Командные строки включают флаг **/a** , чтобы уведомить приложение о том, что он открывает произвольный тип файла. При включении подраздела **дефаултикон** следует использовать универсальный значок.

```
HKEY_CLASSES_ROOT
   MyProgram.exe
      shell
         open
            command
               (Default) = C:\MyDir\MyProgram.exe /a "%1"
         print
            command
               (Default) = C:\MyDir\MyProgram.exe /a /p "%1"
         printto
            command
               (Default) = C:\MyDir\MyProgram.exe /a /p "%1" "%2"
```

## <a name="additional-resources"></a>Дополнительные ресурсы

-   Дополнительные сведения см. [в разделе Общие сведения о сопоставлениях файлов](fa-intro.md).
-   Основные сведения о расширении оболочки с помощью обработчиков типов файлов см. в разделе [Создание обработчиков расширений оболочки](handlers.md).

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Рекомендации по работе с обработчиками контекстного меню и несколькими командами выбора](verbs-best-practices.md)
</dt> <dt>

[Выбор статической или динамической команды для контекстного меню](shortcut-choose-method.md)
</dt> <dt>

[Создание обработчиков контекстного меню](context-menu-handlers.md)
</dt> <dt>

[Настройка контекстного меню с помощью динамических команд](shortcut-menu-using-dynamic-verbs.md)
</dt> <dt>

[Контекстное меню (контекст) и обработчики контекстного меню](context-menu.md)
</dt> <dt>

[Справочник по контекстному меню](context-menu-reference.md)
</dt> </dl>

 

 



