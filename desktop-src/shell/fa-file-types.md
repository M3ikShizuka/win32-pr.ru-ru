---
description: В этом разделе описывается создание новых типов файлов и связывание приложения с типом файлов и другими хорошо определенными типами файлов.
ms.assetid: 055648cd-46ce-4e61-80b2-bcf1d1823e20
title: Типы файлов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 541e6068237b504ea8c9faf06e2083986ed5bb48a7c16dabb82e5096569d9f17
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119094209"
---
# <a name="file-types"></a>Типы файлов

В этом разделе описывается создание новых типов файлов и связывание приложения с типом файлов и другими хорошо определенными типами файлов. Файлы с общим расширением общего имени файла (.doc, .html и т. д.) имеют один и тот же *тип*. Например, при создании нового текстового редактора можно использовать существующий тип файла .txt. В других случаях может потребоваться создать новый тип файлов.

Этот раздел организован следующим образом:

-   [Открытые и закрытые типы файлов](#public-and-private-file-types)
-   [Регистрация типа файла](#registering-a-file-type)
    -   [Задание дополнительных подразделов и атрибутов расширения типа файла](#setting-optional-subkeys-and-file-type-extension-attributes)
    -   [Удаление данных реестра во время удаления](#deleting-registry-information-during-uninstallation)
-   [Типы файлов, поддерживающие открытые метаданные](#file-types-that-support-open-metadata)
-   [Связанные темы](#related-topics)

Дополнительные сведения можно найти в следующих разделах:

-   [Выбор расширения типа файлов](how-to-choose-a-file-type-extension.md)
-   [Определение атрибутов типа файла](./how-to-define-file-type-attributes.md)
-   [Включение приложения в диалоговое окно «Открыть с помощью»](how-to-include-an-application-on-the-open-with-dialog-box.md)
-   [Исключение приложения из диалогового окна "Открыть с помощью" для несвязанных типов файлов](how-to-exclude-an-application-from-the-open-with-dialog-box-for-unassociated-file-types.md)

## <a name="public-and-private-file-types"></a>Открытые и закрытые типы файлов

Типы общедоступных файлов также называются популярными или спорными типами, так как конкурирующие приложения могут быть связаны с этими типами файлов. К общим типам файлов относятся следующие характеристики.

-   Обычно они определяются стандартами стандартов и/или передаются в соответствии с их определением организациями в форматах обмена.
-   Они часто обмениваются данными между компьютерами и пользователями в различных целях.
-   Они должны поддерживаться на многих разных платформах.
-   Приложения от нескольких поставщиков, скорее всего, будут работать с ними.

Некоторые примеры типов файлов, которые считаются открытыми, — это типы файлов изображений .png, .gif, .jpg и .bmp, а также типы аудио. wav, .mp3 и Au.

В отличие от общедоступных типов файлов, закрытые или частные типы файлов обычно имеют формат, который реализуется и понимается только одним приложением или поставщиком. В результате типы частных файлов обычно не подвержены конфликтам между приложениями. Некоторые типы файлов могут запускаться как закрытые типы файлов, но в дальнейшем они становятся общедоступными типами файлов.

> [!Note]  
> Windows не различает открытые и закрытые типы файлов. Это различие уместно только в принятии решений о выборе типа файлов для регистрации.

 

## <a name="registering-a-file-type"></a>Регистрация типа файла

Чтобы связать тип файла с существующим приложением, укажите идентификатор ProgID приложения в реестре. Чтобы связать тип файла с новым приложением, определите идентификатор ProgID для приложения. Дополнительные сведения об определении нового идентификатора ProgID см. в разделе [программные идентификаторы](fa-progids.md).

Подразделы расширения имени файла имеют следующую общую форму: *расширение* = *ProgID*. Подразделы расширения имени файла хранятся в **\_ \_ корневом поддереве классов hKey** .

При создании подразделов типа файла в реестре важно включить в нее точку (.). Например, если нужен тип файла с коротким расширением. МИП и длинное расширение. МИП-File, открываемое с помощью приложения MyProgram, используйте следующий синтаксис:

```
HKEY_CLASSES_ROOT
   .myp
      (Default) = ApplicationVendor.MyProgram
   .myp-file
      (Default) = ApplicationVendor.MyProgram
   ApplicationVendor.MyProgram
      (Default) = MyProgram Application
```

Как показано в предыдущем примере, при регистрации короткого расширения имени файла (. МИП) следует также создать подраздел для длинного расширения (. МИП-File). Дополнительные сведения см. в разделе [обработчики типов файлов](fa-file-extensions.md).

### <a name="setting-optional-subkeys-and-file-type-extension-attributes"></a>Задание дополнительных подразделов и атрибутов расширения типа файла

Записи расширения типа файлов в реестре содержат несколько необязательных подразделов и атрибутов.

В следующей таблице описаны записи расширения типа файлов, используемые для сопоставления файлов. Все значения имеют тип **reg \_ SZ** .



| Запись реестра  | Действие                                                                                                                                                                                                                                                                                                                             |
|-----------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| По умолчанию         | В качестве значения по умолчанию для подраздела расширения укажите идентификатор ProgID, с которым он связан.                                                                                                                                                                                                                                                 |
| Тип содержимого    | Установите значение типа содержимого в тип содержимого MIME типа файла.                                                                                                                                                                                                                                                                   |
| OpenWithList    | Не используйте. этот подраздел содержит один или несколько подразделов приложения для приложений, которые отображаются в записи диалогового окна " **открыть с помощью** " для типа файлов и предназначены только для .exe приложений в операционных системах до Windows XP. Вместо этого используйте Опенвиспрогидс.                                                            |
| OpenWithProgIds | Этот подраздел содержит список альтернативных идентификаторов ProgID для этого типа файлов. программы для этих идентификаторов progid отображаются в меню **открыть с помощью** и доступны по умолчанию Windows приложения магазина для типа файлов. Каждый раз, когда приложение принимает этот тип файла, изменяя значение по умолчанию, оно также должно добавлять запись в этот список. |
| PerceivedType   | Установите значение PerceivedType для PerceivedType, которому принадлежит файл, если он есть. эта строка не используется Windows версиями до Windows Vista. Дополнительные сведения см. в разделе [наблюдаемые типы и регистрация приложений](fa-perceivedtypes.md).                                                                           |



 

Ниже приведена общая форма подраздела расширения имени файла. Все типы записей имеют тип **reg \_ SZ** .

```
HKEY_CLASSES_ROOT
   .ext
      (Default) = ProgID.ext.1
      Content Type = MIME content type
      PerceivedType = PerceivedType
      OpenWithProgids
         ProgID2.ext.1
         ProgID3.ext.1
      ProgID.ext.1
         shellnew
```

Ниже приведены важные моменты, связанные с типами файлов.

-   **\_ \_ Корневым** поддеревом классов hKey является представление, сформированное путем слияния **\_ \_** \\  \\ **классов** и программного обеспечения **\_ локального \_ компьютера** hKey \\  \\  .
-   Как правило, **\_ \_ корневой класс hKey classes** предназначен для чтения, но не для написания. Дополнительные сведения см. в [ \_ \_ корневой статье о классах hKey](../sysinfo/hkey-classes-root-key.md) .
-   Чтобы глобально зарегистрировать тип файла на определенном компьютере, создайте запись для этого типа файлов в подразделе классы программного обеспечения файла **hKey \_ локального \_ компьютера** \\  \\  .
-   Чтобы регистрация типа файла стала видимой только для текущего пользователя, создайте запись для типа файла в подразделе «классы **\_ текущего \_ пользовательского** \\ **программного обеспечения**» раздела hKey \\  .
-   Приложение может предоставить собственную реализацию глагола, например Open или Play, как показано в следующем примере реестра.

    ```
    HKEY_CLASSES_ROOT
       Applications
          ApplicationName.exe
             shell
                verb
    ```

    Подразделы подраздела команды включают в себя командную строку и целевой метод перетаскивания: **Command** и **дроптаржет**.

-   При создании или изменении сопоставления файлов важно уведомить систему, что вы внесли изменения. Для этого вызовите [**шчанженотифи**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shchangenotify) и укажите событие **шкне \_ ассокчанжед** . Если не вызвать **шчанженотифи**, изменение может быть не распознано до тех пор, пока система не будет перезагружена.
-   Чтобы получить сведения о реестре, касающиеся сопоставления файлов, используйте интерфейс [**икуеряссоЦиатионс**](/windows/win32/api/shlwapi/nn-shlwapi-iqueryassociations) . Сценарий, демонстрирующий эту процедуру, см. в разделе [Пример сценария сопоставления файлов](fa-sample-scenarios.md).

> [!Note]  
> Подразделы реестра " **пути приложений** " и " **приложения** " используются для регистрации и управления поведением системы от имени приложений. Более подробные сведения об этих функциях см. в разделе [Регистрация приложения](app-registration.md).

 

### <a name="deleting-registry-information-during-uninstallation"></a>Удаление данных реестра во время удаления

При удалении приложения идентификаторы ProgID и большинство других данных реестра, связанных с этим приложением, должны быть удалены в процессе удаления. Тем не менее, приложения, которые владеют типом файла (путем установки значения по умолчанию для подраздела **\_ \_ root** \\ *. extension* в файле типа файла с идентификатором ProgID приложения), не должны пытаться удалить это значение при удалении. Если не вводить данные в качестве значения по умолчанию, это позволяет избежать трудностей определить, является ли другое приложение владельцем файла и перезаписало значение по умолчанию после установки исходного приложения. значение по умолчанию Windows учитывается только в том случае, если обнаружен идентификатор progid. Если идентификатор ProgID не зарегистрирован, он игнорируется.

Обратите внимание, что другие сведения о владении типами файлов хранятся в поддереве **hKey \_ Current \_ User**, а также используются только при регистрации приложения, на которое он ссылается. Поэтому эти данные не нужно удалять при удалении приложения.

В качестве примера ниже показано состояние реестра перед удалением приложения.

```
HKEY_CLASSES_ROOT
   .mp3
      (Default) = YourProgID
   YourProgID
      shell
         open
            command
               (Default) = yourapp.exe %1
```

Ниже показано состояние тех же записей реестра после удаления приложения.

```
HKEY_CLASSES_ROOT
   .mp3
      (Default) = YourProgID
   YourProgID subkey removed
```

## <a name="file-types-that-support-open-metadata"></a>Типы файлов, поддерживающие открытые метаданные

в Windows 7 и более поздних версиях следующие типы файлов поддерживают открытые метаданные.



| Тип файла                                                               | Расширения имен файлов                                          |
|-------------------------------------------------------------------------|---------------------------------------------------------------|
| документы Office 2007                                                   | .docx, .xlsx .pptx                                           |
| документы Office 97-2003                                                | .doc, .xls .ppt                                              |
| Сохраненные поисковые запросы                                                            | . Search — MS                                                    |
| Windows Форматы на основе мультимедиа (контейнер ASF) | . WMV,. WMA                                                    |
| MP4 (обработчик свойств)                                                  | .mp4,. m4a,. m4v,. MP4V,. M4P,. m4b,. 3GP,. 3GPP,. 3GP2,. mov |



 

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Регистрация приложения](app-registration.md)
</dt> <dt>

[Как работают сопоставления файлов](fa-how-work.md)
</dt> <dt>

[Представление содержимого по типу или виду файла](prophand-content-view.md)
</dt> <dt>

[Средство проверки типов файлов](file-type-verifier.md)
</dt> <dt>

[Обработчики типов файлов](fa-file-extensions.md)
</dt> <dt>

[Программные идентификаторы](fa-progids.md)
</dt> <dt>

[Наблюдаемые типы](fa-perceivedtypes.md)
</dt> <dt>

[Массивы ассоциаций](fa-associationarray.md)
</dt> </dl>

 

 
