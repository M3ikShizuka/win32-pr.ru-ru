---
description: Создает массив дескрипторов для значков, извлеченных из указанного файла.
title: Функция Шекстрактиконсв
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- SHExtractIconsW
- SHExtractIconsW
api_type:
- DllExport
api_location:
- Shell32.dll
ms.assetid: 9f138b4e-6a84-4c7e-9521-5f8ffe0eaebf
ms.openlocfilehash: 699b6d5473d97548a22e220372b9f53633cb2346
ms.sourcegitcommit: 3caaa3c92dcb1ef12f84464d14ce6262e65e988e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/12/2021
ms.locfileid: "109840915"
---
# <a name="shextracticonsw-function"></a>Функция Шекстрактиконсв

\[**Шекстрактиконсв** доступен в Windows XP с пакетом обновления 2 (SP2). Он может быть изменен или недоступен в последующих версиях.\]

Создает массив дескрипторов для значков, извлеченных из указанного файла.

## <a name="syntax"></a>Синтаксис


```C++
UINT SHExtractIconsW(
  _In_  LPCWSTR pszFileName,
  _In_  int     nIconIndex,
  _In_  int     cxIcon,
  _In_  int     cyIcon,
  _Out_ HICON   *phIcon,
  _Out_ UINT    *pIconId,
  _In_  UINT    nIcons,
  _In_  UINT    flags
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*pszFileName* \[ окне\]
</dt> <dd>

Тип: **лпквстр**

Указатель на имя файла, из которого извлекаются значки.

</dd> <dt>

*никониндекс* \[ окне\]
</dt> <dd>

Тип: **int**

Индекс первого значка, извлекаемого из ресурса с именем в *pszFileName*.

</dd> <dt>

*кксикон* \[ окне\]
</dt> <dd>

Тип: **int**

Требуемая ширина значка. См. заметки.

</dd> <dt>

*циикон* \[ окне\]
</dt> <dd>

Тип: **int**

Желаемая высота значка. См. заметки.

</dd> <dt>

*фикон* \[ заполняет\]
</dt> <dd>

Тип: **Хикон \***

При возврате этой функции содержит указатель на массив дескрипторов значков.

</dd> <dt>

*пиконид* \[ заполняет\]
</dt> <dd>

Тип: **uint \***

При возврате этой функции содержит указатель на идентификатор ресурса извлеченного значка, который лучше подходит для текущего устройства вывода. Если для этого формата нет доступных идентификаторов, он содержит значение 0xFFFFFFFF. Если идентификатор не может быть получен по какой либо другой причине, возвращает нуль.

</dd> <dt>

*никонс* \[ окне\]
</dt> <dd>

Тип: **uint**

Число значков, извлекаемых из ресурса с именем в *pszFileName*. Этот параметр допустим только в том случае, если ресурс является файлом EXE или DLL.

</dd> <dt>

*Флаги* \[ окне\]
</dt> <dd>

Тип: **uint**

Флаги, управляющие этой функцией. Возможные значения см. в описании параметра *фулоад* функции [**лоадимаже**](/windows/win32/api/winuser/nf-winuser-loadimagea) .

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Тип: **uint**

Ненулевое значение в случае успеха; в противном случае — нуль.

## <a name="remarks"></a>Remarks

**Шекстрактиконсв** извлекает из следующих типов файлов.

-   Исполняемый файл (.EXE)
-   DLL (DLL)
-   Значок (ICO)
-   Курсор (CUR)
-   Анимированный курсор (. ANI)
-   Растровое изображение (.bmp)

Извлечения из Windows 3. также поддерживаются *16-* разрядные исполняемые файлы (exe или DLL).

Параметры *кксикон* и *циикон* определяют размер извлекаемых значков. Два размера можно извлечь с помощью каждого параметра, разделив значение между его ЛОВОРД и HIWORD. Установите первый требуемый размер в ЛОВОРД параметра и второй размер в HIWORD. Например, [**макелонг**](/previous-versions/windows/desktop/legacy/ms632660(v=vs.85))(24, 48) для *кксикон* и *циикон* извлекает значки размером 24 и 48.

Вызывающий процесс отвечает за уничтожение всех значков, извлеченных с помощью этой функции, путем вызова функции [**дестройикон**](/windows/win32/api/winuser/nf-winuser-destroyicon) .

**Шекстрактиконсв** не экспортируется по имени или объявлено в общедоступном файле заголовка. Чтобы использовать его, необходимо объявить соответствующий прототип и использовать [**GetProcAddress**](/windows/win32/api/libloaderapi/nf-libloaderapi-getprocaddress) для запроса указателя на функцию от Shell32.dll, который можно использовать для вызова этой функции.

## <a name="requirements"></a>Requirements (Требования)



| Требование | Значение |
|-------------------------------------|---------------------------------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows 2000 Professional, только для \[ классических приложений Windows XP\]<br/>                                        |
| Минимальная версия сервера<br/> | \[Только для настольных приложений Windows Server 2003\]<br/>                                                          |
| DLL<br/>                      | <dl> <dt>Shell32.dll (версия 5,0 или более поздняя)</dt> </dl> |
| Имя в кодировке Юникод и ANSI<br/>   | **Шекстрактиконсв** (Юникод)<br/>                                                                      |



 

 
