---
description: Выполняет операцию с указанным файлом.
ms.assetid: ce652565-40b6-4f69-bd2a-9e05e3f360ac
title: Функция Вовшеллексекуте
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- WOWShellExecute
api_type:
- DllExport
api_location:
- Shell32.dll
ms.openlocfilehash: 4389c348a06b7c54dc899da8114eee09e740681f043084bb0c32ab9f7163772e
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119591834"
---
# <a name="wowshellexecute-function"></a>Функция Вовшеллексекуте

\[эта функция доступна в Windows XP с пакетом обновления 2 (sp2) и Windows Server 2003. Он может быть изменен или недоступен в последующих версиях Windows.\]

Выполняет операцию с указанным файлом. **вовшеллексекуте** существует только для использования с виртуальным компьютером Microsoft Windows NT DOS (Ntvdm.exe), который позволяет запускать дисковую операционную систему (DOS) и 16-разрядное программное обеспечение на Windows системе и не должно использоваться другими пользователями. Вместо этого используйте [**ShellExecute**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecutea) .

## <a name="syntax"></a>Синтаксис


```C++
HINSTANCE WOWShellExecute(
  _In_ HWND    hwnd,
  _In_ LPCTSTR lpOperation,
  _In_ LPCTSTR lpFile,
  _In_ LPCTSTR lpParameters,
  _In_ LPCTSTR lpDirectory,
  _In_ INT     nShowCmd,
       void    *lpfnCBWinExec
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*HWND* \[ окне\]
</dt> <dd>

Тип: **HWND**

Маркер окна владельца, используемый для отображения пользовательского интерфейса или сообщений об ошибках. Это значение может быть **равно NULL** , если операция не связана с окном.

</dd> <dt>

*лпоператион* \[ окне\]
</dt> <dd>

Тип: **LPCTSTR**

Указатель на строку, **завершающуюся нулем,** которая в данном случае называется *глаголом*, которая указывает выполняемое действие. Набор доступных команд зависит от конкретного файла или папки. Как правило, действия, доступные в контекстном меню объекта, являются доступными командами. Дополнительные сведения о командах и их доступности см. в разделе " *команды объектов* " раздела [Запуск приложений](launch.md). Дополнительные сведения о контекстных меню см. в разделе [расширение контекстных меню](context.md) . Обычно используются следующие команды.

<dt>

<span id="edit"></span><span id="EDIT"></span>

<span id="edit"></span><span id="EDIT"></span>**Редактор**


</dt> <dd>

Запускает редактор и открывает документ для редактирования. Если *лпфиле* не является файлом документа, функция завершится ошибкой.

</dd> <dt>

<span id="explore"></span><span id="EXPLORE"></span>

<span id="explore"></span><span id="EXPLORE"></span>**просматриваем**


</dt> <dd>

Изучает папку, указанную параметром *лпфиле*.

</dd> <dt>

<span id="find"></span><span id="FIND"></span>

<span id="find"></span><span id="FIND"></span>**Найдено**


</dt> <dd>

Инициирует поиск, начиная с указанного каталога.

</dd> <dt>

<span id="open"></span><span id="OPEN"></span>

<span id="open"></span><span id="OPEN"></span>**открыт**


</dt> <dd>

Открывает файл, указанный параметром *лпфиле* . Файл может быть исполняемым файлом, файлом документа или папкой.

</dd> <dt>

<span id="print"></span><span id="PRINT"></span>

<span id="print"></span><span id="PRINT"></span>**печатал**


</dt> <dd>

Выводит файл документа, указанный параметром *лпфиле*. Если *лпфиле* не является файлом документа, функция завершится ошибкой.

</dd> <dt>

<span id="NULL"></span><span id="null"></span>

<span id="NULL"></span><span id="null"></span>**ЗАКАНЧИВАЮЩ**


</dt> <dd>

для систем до Windows 2000 используется команда по умолчанию, если она является допустимой и доступна в реестре. В противном случае используется команда "Открыть".

для Windows 2000 и более поздних систем используется команда по умолчанию, если она доступна. В противном случае используется команда "Открыть". Если ни один из этих команд недоступен, система использует первую команду, указанную в реестре.

</dd> </dl> </dd> <dt>

*лпфиле* \[ окне\]
</dt> <dd>

Тип: **LPCTSTR**

Указатель на строку, **завершающуюся нулем,** которая указывает файл или объект, для которого необходимо выполнить указанную команду. Чтобы указать объект пространства имен оболочки, передайте полное имя синтаксического анализа. Обратите внимание, что не все команды поддерживаются для всех объектов. Например, не все типы документов поддерживают команду Print.

</dd> <dt>

*лппараметерс* \[ окне\]
</dt> <dd>

Тип: **LPCTSTR**

Если параметр *лпфиле* Задает исполняемый файл, *лппараметерс* является указателем на строку, **завершающуюся нулем,** которая указывает параметры, передаваемые в приложение. Формат этой строки определяется вызываемой командой. Если *лпфиле* указывает файл документа, *Лппараметерс* должен иметь **значение NULL**.

</dd> <dt>

*лпдиректори* \[ окне\]
</dt> <dd>

Тип: **LPCTSTR**

Указатель на строку, **завершающуюся нулем,** которая указывает каталог по умолчанию.

</dd> <dt>

*ншовкмд* \[ окне\]
</dt> <dd>

Тип: **int**

Флаги, определяющие способ отображения приложения при его открытии. Если *лпфиле* указывает файл документа, флаг просто передается связанному приложению. Приложение может решить, как его справиться. Это может быть любое из значений, которое можно указать в параметре *нкмдшов* для функции [ShowWindow](/windows/desktop/api/winuser/nf-winuser-showwindow) .

</dd> <dt>

*лпфнкбвинексек* 
</dt> <dd>

Тип: **void \***

Функция обратного вызова, используемая для вызова функции [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) в 16-разрядном ядре.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Тип: **HINSTANCE**

Возвращает значение, превышающее 32 в случае успеха, или значение ошибки, которое меньше или равно 32 в противном случае. В следующей таблице перечислены значения ошибок. возвращаемое значение приводится как HINSTANCE для обратной совместимости с 16-разрядными Windows приложениями. Однако это не является истинным значением HINSTANCE. Единственное, что можно сделать с помощью возвращенного объекта HINSTANCE, — привести его к типу **int** и сравнить с значением 32 или одним из кодов ошибок, приведенных ниже.



| Код возврата                                                                                             | Описание                                                                                                                                                              |
|---------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <dl> <dt>**0**</dt> </dl>                        | Операционной системе не хватает памяти или ресурсов.<br/>                                                                                                           |
| <dl> <dt>**\_файл ошибок \_ не \_ найден**</dt> </dl>  | Указанный файл не найден.<br/>                                                                                                                             |
| <dl> <dt>**\_путь к ошибке \_ не \_ найден**</dt> </dl>  | Указанный путь не найден.<br/>                                                                                                                             |
| <dl> <dt>**\_неправильный \_ Формат ошибки**</dt> </dl>       | Недопустимый файл .exe (не Win32 .exe или ошибка в образе .exe).<br/>                                                                                             |
| <dl> <dt>**SE \_ ERR \_ ACCESSDENIED**</dt> </dl>    | Операционная система отклонила доступ к указанному файлу.<br/>                                                                                                     |
| <dl> <dt>**SE \_ ERR \_ ассоЦинкомплете**</dt> </dl> | Неполное или недопустимое сопоставление имени файла.<br/>                                                                                                           |
| <dl> <dt>**SE \_ ERR \_ ддебуси**</dt> </dl>         | Не удалось завершить транзакцию DDE, так как были обработаны другие транзакции DDE.<br/>                                                               |
| <dl> <dt>**SE \_ ERR \_ ддефаил**</dt> </dl>         | Сбой транзакции DDE.<br/>                                                                                                                                   |
| <dl> <dt>**SE \_ ERR \_ ддетимеаут**</dt> </dl>      | Не удалось завершить транзакцию DDE, так как истекло время ожидания запроса.<br/>                                                                                     |
| <dl> <dt>**SE \_ ERR \_ дллнотфаунд**</dt> </dl>     | Указанная библиотека DLL не найдена.<br/>                                                                                                                              |
| <dl> <dt>**SE \_ ERR \_ фнф**</dt> </dl>             | Указанный файл не найден.<br/>                                                                                                                             |
| <dl> <dt>**SE \_ Ошибка \ \_ Assoc**</dt> </dl>         | Отсутствует приложение, связанное с указанным расширением имени файла. Эта ошибка также будет возвращена при попытке распечатать непечатаемый файл.<br/> |
| <dl> <dt>**SE \_ Ошибка \_ памяти**</dt> </dl>             | Недостаточно памяти для завершения операции.<br/>                                                                                                        |
| <dl> <dt>**SE \_ ERR \_ ПНФ**</dt> </dl>             | Указанный путь не найден.<br/>                                                                                                                             |
| <dl> <dt>**SE \_ \_Общая папка Err**</dt> </dl>           | Произошло нарушение совместного доступа.<br/>                                                                                                                                 |



 

## <a name="remarks"></a>Remarks

**Вовшеллексекуте** не включается в заголовок или LIB-файл. Он экспортируется из Shell32.dll по имени.

Этот метод позволяет выполнять любые команды в контекстном меню папки или храниться в реестре.

Если *лпоператион* имеет **значение NULL**, функция открывает файл, заданный параметром *лпфиле*. Если *лпоператион* имеет значение "Open" или "исследовать", функция пытается открыть или просмотреть папку.

Чтобы получить сведения о приложении, которое запускается в результате вызова **вовшеллексекуте**, используйте [**ShellExecuteEx**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecuteexa).

> [!Note]  
> **Окна запуска папки в отдельном** параметре процесса в свойствах папки влияют на **вовшеллексекуте**. Если этот параметр отключен (значение по умолчанию), **вовшеллексекуте** использует открытое окно проводника вместо запуска нового. Если окно проводника не открыто, **вовшеллексекуте** запускает новый.

 

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|----------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows 2000 Professional \[только классические приложения\]<br/>                             |
| Минимальная версия сервера<br/> | Windows 2000 Server \[только классические приложения\]<br/>                                   |
| DLL<br/>                      | <dl> <dt>Shell32.dll</dt> </dl> |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**ShellExecute**](/windows/desktop/api/Shellapi/nf-shellapi-shellexecutea)
</dt> </dl>

 

 
