---
description: Определяет, будет ли оболочка разрешать перемещение, копирование, удаление или переименование папки в корне синхронизации поставщика облачных служб.
title: IStorageProviderCopyHook::CopyCallback
ms.topic: reference
ms.date: 11/11/2020
topic_type:
- APIRef
- kbSyntax
api_name:
- IStorageProviderCopyHook::CopyCallback
api_type:
- COM
api_location:
- shobjidl.h
ms.openlocfilehash: c7df9296f2261e3907702067ca36265095102f34
ms.sourcegitcommit: 3bdf30edb314e0fcd17dc4ddbc70e4ec7d3596e6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/10/2021
ms.locfileid: "104997986"
---
# <a name="istorageprovidercopyhookcopycallback-method"></a>Метод Исторажепровидеркопихук:: Копикаллбакк

Определяет, будет ли оболочка разрешать перемещение, копирование, удаление или переименование папки в корне синхронизации поставщика облачных служб.

## <a name="syntax"></a>Синтаксис

```C++
HRESULT CopyCallback( 
    HWND hwnd,
    UINT operation,
    UINT flags,
    LPCWSTR srcFile,
    DWORD srcAttribs,
    LPCWSTR destFile,
    DWORD destAttribs,
    UINT* result
);
```

## <a name="parameters"></a>Параметры

<dl> <dt>

*HWND* \[ окне\]
</dt> <dd>

Дескриптор окна, который должен использоваться обработчиком ловушки копирования в качестве родителя для любых элементов пользовательского интерфейса, которые может потребоваться отобразить обработчику. Если в *операции* указан **FOF_SILENT** , метод должен игнорировать этот параметр.

</dd> </dl>

<dl> <dt>

*Операция* \[ окне\]
</dt> <dd>

Выполняемая операция. Этот параметр может быть одним из значений, перечисленных под элементом **вфунк** структуры [шфилеопструкт](/windows/win32/api/shellapi/ns-shellapi-shfileopstructa) .

</dd> </dl>

<dl> <dt>

*Флаги* \[ окне\]
</dt> <dd>

Флаги, управляющие операцией. Этот параметр может быть одним или несколькими значениями, перечисленными в элементе *ффлагс* структуры [шфилеопструкт](/windows/desktop/api/shellapi/ns-shellapi-shfileopstructa) .

Для обработчиков копий принтера это значение является одним из следующих значений, определенных в шеллапи. h.

| Значение       | Описание |
|-------------|------------|
|  **PO_DELETE**      | Идет удаление принтера. Параметр *srcFile* указывает на полный путь к указанному принтеру.           |
|  **PO_RENAME**       | Выполняется переименование принтера. Параметр *srcFile* указывает на новое имя принтера. Параметр *дестфиле* указывает на старое имя.           |
| **PO_PORTCHANGE**    | Не поддерживается. Не используйте.          |
| **PO_REN_PORT**    | Не поддерживается. Не используйте.           |

</dd> </dl>

<dl> <dt>

*srcFile* \[ окне\]
</dt> <dd>

Указатель на строку, содержащую имя исходной папки.

</dd> </dl>

*сркаттрибс* \[ окне\]
</dt> <dd>

Атрибуты исходной папки. Этот параметр может быть сочетанием любого из флагов файлового атрибута (FILE_ATTRIBUTE_ *), определенных в файлах заголовков. См. раздел [константы атрибутов файлов](../fileio/file-attribute-constants.md).

</dd> </dl>

*дестфиле* \[ окне\]
</dt> <dd>

Указатель на строку, содержащую имя папки назначения.

</dd> </dl>

*дестаттрибс* \[ окне\]
</dt> <dd>

Атрибуты конечной папки. Этот параметр может быть сочетанием любого из флагов файлового атрибута (FILE_ATTRIBUTE_ *), определенных в файлах заголовков. См. раздел [константы атрибутов файлов](../fileio/file-attribute-constants.md).

</dd> </dl>

*результат* \[ заполняет\]
</dt> <dd>

Целочисленное значение, указывающее, должна ли оболочка выполнить операцию. Это может быть:

| Значение       | Описание |
|-------------|------------|
| **IDYES**       | Разрешает операцию.           |
| **IDNO**        | Предотвращает операцию в этой папке, но продолжит работу с другими утвержденными операциями (например, операцией пакетного копирования).           |
| **IDCANCEL**    | Предотвращает текущую операцию и отменяет все ожидающие операции.           |


</dd> </dl>


## <a name="return-value"></a>Возвращаемое значение

Возвращает **S_OK** в случае успеха или код ошибки в противном случае.

## <a name="remarks"></a>Примечания

Оболочка вызывает обработчик ловушки копирования поставщика облачных служб для каждой папки в зарегистрированном корне синхронизации. Чтобы зарегистрировать обработчик события копирования для облачных папок, установите значение **копихук** в разделе **HKEY_LOCAL_MACHINE/Софтваре/Микрософт/Виндовс/куррентверсион/Експлорер/синкрутманажер/{синкрутид}** в качестве значения идентификатора CLSID объекта-ловушки копирования.

При вызове метода **Копикаллбакк** оболочка инициализирует интерфейс [исторажепровидеркопихук](nn-shobjidl-istorageprovidercopyhook.md) напрямую без использования интерфейса [ишеллекстинит](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) First.

## <a name="requirements"></a>Требования

| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------------|
| Минимальная версия клиента | Windows 10 Insider Preview Build 19624                                |
| Header                   | shobjidl. h   |

## <a name="see-also"></a>См. также раздел

[Создание облачного модуля синхронизации, поддерживающего файлы заполнителей](../cfapi/build-a-cloud-file-sync-engine.md)