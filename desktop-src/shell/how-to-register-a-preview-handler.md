---
description: В этом разделе объясняется, как зарегистрировать обработчик просмотра, связанный с данным типом данных.
ms.assetid: 5f194d29-d09f-4426-a63e-911db65ce700
title: Регистрация обработчика просмотра
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e5af9610de1822678521557fc20aa53f4e556e0e
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127257041"
---
# <a name="how-to-register-a-preview-handler"></a>Регистрация обработчика просмотра

В этом разделе объясняется, как зарегистрировать обработчик просмотра, связанный с данным типом данных. В примерах, приведенных в этом разделе, используется тип файла. xyz. Регистрация обработчика просмотра — это Стандартная регистрация на основе сопоставления файлов.

## <a name="instructions"></a>Instructions

### <a name="step-1"></a>Шаг 1.

Во-первых, расширение имени файла связано с ProgID. Следующая запись связывает подраздел ProgID **ксизфиле** с расширением имени файла. xyz.

```
HKEY_CLASSES_ROOT
   .xyz
      (Default) = [REG_SZ] xyzfile
```

Подраздел ProgID **ксизфиле** хранится вместе с другими идентификаторами ProgID, как показано ниже:

```
HKEY_CLASSES_ROOT
   xyzfile
```

Каждый подраздел ProgID обработчика просмотра содержит подраздел с именем **шеллекс** , *содержащий подраздел с* именем **{8895b1c6-b41f-4c1c-A562-0d564250836f}**. Наличие этого подраздела сообщает системе, что обработчик является обработчиком просмотра.

Значение по умолчанию для подраздела **{8895b1c6-b41f-4c1c-A562-0d564250836f}** — это идентификатор класса (CLSID) обработчика. Ниже показан пример подраздела ProgID **ксизфиле** , связывающего обработчик CLSID {ec3a629a-a47c-4245-bc78-b4b63d0e3154}.

```
HKEY_CLASSES_ROOT
   xyzfile
      shellex
         {8895b1c6-b41f-4c1c-a562-0d564250836f}
            (Default) = [REG_SZ] {ec3a629a-a47c-4245-bc78-b4b63d0e3154}
```

### <a name="step-2"></a>Шаг 2.

Затем добавьте подраздел в **идентификатор CLSID** для обработчика просмотра. Пример показан здесь. Ниже приведено описание отдельных записей.

```
HKEY_CLASSES_ROOT
   CLSID
      {ec3a629a-a47c-4245-bc78-b4b63d0e3154}
         (Default) = [REG_SZ] Fabricam XYZ Preview Handler
         DisplayName = [REG_SZ] @myhandler.dll,-101
         Icon = [REG_SZ] myhandler.dll,201
         AppID = [REG_SZ] {6d2b5079-2f0b-48dd-ab7f-97cec514d30b}
         InprocServer32
            (Default) = [REG_EXPAND_SZ] %ProgramFiles%\Fabricam\myhandler.dll
            ThreadingModel = [REG_SZ] Apartment
            ProgID = [REG_SZ] xyzfile
            VersionIndependentProgID = [REG_SZ] Version IndependentProgID
```

Значение по умолчанию для подраздела (здесь **{ec3a629a-a47c-4245-bc78-b4b63d0e3154}**) не является обязательным или не используется. Однако нелокализованная строка может помочь при отладке проблем с регистрацией.

Знак "минус" (-101) в ресурсе .dll в записи DisplayName существует по причинам, устаревшим. В записи значка, с другой стороны, не требуется знак "минус".

Значение AppID дает ссылку на идентификатор приложения, связанный с расширением имени файла (хранится в **\_ \_ каталоге hKey root** \\ **AppID**. Используемое здесь значение — {6d2b5079-2f0b-48dd-ab7f-97cec514d30b} — это идентификатор узла суррогата Prevhost.exe. 32-разрядные обработчики просмотра должны использовать **AppID** {534A1E02-D58F-44f0-B58B-36CBED287C7C} при установке в 64-разрядных операционных системах.

Записи в подразделе **InprocServer32** содержат ссылку на подраздел ProgID для расширения имени файла, а также запись для [версиониндепендентпрогид](../com/versionindependentprogid.md).

### <a name="step-3"></a>Шаг 3.

Наконец, обработчик просмотра должен быть добавлен в список всех обработчиков просмотра. Этот список используется в качестве оптимизации системой для перечисления всех зарегистрированных обработчиков просмотра в целях показа. Опять же, значение по умолчанию не является обязательным, оно просто помогает в процессе отладки.

> [!Note]  
> в Windows 7, если приложение установлено для всех пользователей компьютера, используйте параметр " \_ локальный компьютер" hkey \_ . если только для одного пользователя используется параметр hkey \_ текущий \_ пользователь.

 

```
HKEY_LOCAL_MACHINE or HKEY_CURRENT_USER
   SOFTWARE
      Microsoft
         Windows
            CurrentVersion
               PreviewHandlers
                  {ec3a629a-a47c-4245-bc78-b4b63d0e3154}
                     (Default) = [REG_SZ] Fabricam XYZ Preview Handler
```

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Обработчик предварительной версии и узел предварительной версии оболочки](preview-handlers.md)
</dt> <dt>

[Создание обработчиков предварительного просмотра](building-preview-handlers.md)
</dt> <dt>

[Рекомендации по обработчику предварительной версии](preview-handler-guidelines.md)
</dt> </dl>

 

 
