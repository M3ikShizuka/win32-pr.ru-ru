---
description: выберите статический или динамический метод контекстного меню при реализации пользовательского формата файла в оболочке Windows.
title: Выбор метода статического или динамического контекстного меню
ms.topic: article
ms.date: 05/31/2018
ms.assetid: 44227BCF-D35E-4a9e-B4E6-D50E6AFBAEDF
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: c910407dbd9de9f12853973f9891fe092a0603ca50a03e59183697b0f92b07e0
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118968323"
---
# <a name="choosing-a-static-or-dynamic-shortcut-menu-method"></a>Выбор метода статического или динамического контекстного меню

Этот раздел организован следующим образом:

-   [Выбор метода глагола](#choose-a-verb-method)
    -   [Статические методы глагола](#static-verb-methods)
    -   [Предпочтительные динамические методы команд](#preferred-dynamic-verb-methods)
    -   [Нерекомендованные динамические методы команд](#discouraged-dynamic-verb-methods)
-   [Расширение контекстного меню](#extend-a-shortcut-menu)
-   [Поддержка методов команд операционной системой](#support-for-verb-methods-by-operating-system)
-   [Связанные темы](#related-topics)

## <a name="choose-a-verb-method"></a>Выбор метода глагола

Настоятельно рекомендуется реализовать контекстное меню с помощью одного из статических методов глагола.

### <a name="static-verb-methods"></a>Статические методы глагола

Статические глаголы являются простейшими глаголами для реализации, но они по-прежнему предоставляют широкие функциональные возможности. Всегда выберете простейший метод контекстного меню, соответствующий вашим потребностям.



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Статическая команда</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa"><strong>CreateProcess</strong></a> с параметрами командной строки</td>
<td>Это самый простой и привычный способ реализации статической команды. Процесс вызывается через вызов функции <a href="/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa"><strong>CreateProcess</strong></a> с выбранными файлами и любыми необязательными параметрами, передаваемыми в командной строке. Откроется файл или папка.<br/> Этот метод имеет следующие ограничения.
<ul>
<li>Длина командной строки ограничена 2000 символами, что ограничивает число элементов, которое может быть обработано командой.</li>
<li>Может использоваться только с элементами файловой системы.</li>
<li>Не включает повторное использование уже запущенного процесса.</li>
<li>Требует установки исполняемого файла для выполнения команды.</li>
</ul>
<br/></td>
</tr>
<tr class="even">
<td><strong>Дроптаржет</strong> / <a href="/windows/desktop/api/oleidl/nn-oleidl-idroptarget"> <strong>Интерфейс IDropTarget</strong></a></td>
<td>Активация глагола на основе COM означает, что поддерживает in-proc или внепроцессные активация. <strong>Дроптаржет</strong> / <a href="/windows/desktop/api/oleidl/nn-oleidl-idroptarget"><strong>Интерфейс IDropTarget</strong></a> также поддерживает повторное использование уже запущенного обработчика, когда интерфейс <strong>интерфейс IDropTarget</strong> реализуется локальным сервером. Он также полностью выражает элементы через упакованный объект данных и предоставляет ссылку на вызывающую цепочку сайтов, чтобы можно было взаимодействовать с вызывающим объектом через <a href="/previous-versions/windows/internet-explorer/ie-developer/platform-apis/cc678966(v=vs.85)"><strong>QueryService</strong></a>.</td>
</tr>
<tr class="odd">
<td>Windows 7 и более поздних версий: <a href="/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iexecutecommand"> <strong>иексекутекомманд</strong></a></td>
<td>Наиболее прямой метод реализации. Поскольку это метод вызова на основе COM (например, Дроптаржет), этот интерфейс поддерживает внутрипроцессную и внепроцессных активации. Команда реализует <a href="/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iexecutecommand"><strong>иексекутекомманд</strong></a> и <a href="/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iobjectwithselection"><strong>иобжектвисселектион</strong></a>и, при необходимости, <a href="/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iinitializecommand"><strong>иинитиализекомманд</strong></a>. Элементы передаются непосредственно в качестве массива элементов оболочки, а другие параметры из вызывающего объекта доступны для реализации глагола, включая точку вызова, состояние клавиатуры и т. д.</td>
</tr>
<tr class="even">
<td>Windows 7 и более поздних версий:<strong>експлореркомманд</strong> /  <a href="/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iexplorercommand"><strong>иексплореркомманд</strong></a></td>
<td>Включает источники данных, предоставляющие команды командного модуля через <a href="/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iexplorercommandprovider"><strong>иексплореркоммандпровидер</strong></a> для использования этих команд в контекстном меню в качестве команд. Поскольку этот интерфейс поддерживает только внутрипроцессный процесс, рекомендуется использовать его в качестве источников данных оболочки, которые должны совместно использовать реализацию команд и контекстных меню.</td>
</tr>
</tbody>
</table>



 

> [!Note]  
> [**Иексплореркомманд**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iexplorercommand) — это гибрид между статической и динамической глаголами. **иексплореркомманд** был объявлен в Windows Vista, но его способность реализовать глагол в контекстном меню — это новая возможность для Windows 7.

 

Дополнительные сведения о [**интерфейс IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget) и оболочке запросов для атрибутов сопоставления файлов см. в разделе [наблюдаемые типы и регистрация приложений](fa-perceivedtypes.md).

### <a name="preferred-dynamic-verb-methods"></a>Предпочтительные динамические методы команд

Следующие динамические методы являются предпочтительными:



| Тип команды                                                                                 | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|-------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Статическая команда (указанная в предыдущей таблице) + расширенный синтаксис запросов (АКС)                  | Этот вариант возвращает видимость динамической команды.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Windows 7 и более поздних версий: [ **иексплореркомманд**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iexplorercommand)                         | этот вариант позволяет реализовать общую реализацию команд и команд обозревателя, отображаемых в командном модуле в обозревателе Windows.                                                                                                                                                                                                                                                                                                                                                                                               |
| Windows 7 и более поздних версий: статическая команда [**иексплореркоммандстате**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iexplorercommandstate) + | Этот вариант также возвращает видимость динамической команды. Это гибридная модель, где простой внутрипроцессный обработчик используется для вычислений, если заданная статическая команда должна быть приведена. Это можно применить ко всем методам реализации статических команд, чтобы обеспечить динамическое поведение и снизить вероятность раскрытия логики внутри процесса. [**Иексплореркоммандстате**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iexplorercommandstate) имеет преимущество выполнения в фоновом потоке и тем самым предотвращает ЗАВИСАНИЕ пользовательского интерфейса. Это значительно проще, чем [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu). |



 

### <a name="discouraged-dynamic-verb-methods"></a>Нерекомендованные динамические методы команд

[**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu) является самым мощным, но и самым сложным методом для реализации. он основан на внутрипроцессного COM-объектах, которые выполняются в потоке вызывающего, который обычно Windows Explorer, но может быть любым приложением, в котором размещены элементы. **IContextMenu** поддерживает видимость команд, упорядочение и пользовательское рисование. Некоторые из этих функций были добавлены в функции статической команды, такие как значок, связываемый с командой, и [**иексплореркомманд**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-iexplorercommand) для работы с видимостью.

Если необходимо расширить контекстное меню для типа файла, зарегистрировав динамическую команду для типа файла, следуйте инструкциям, приведенным в разделе [Настройка контекстного меню с помощью динамических команд](shortcut-menu-using-dynamic-verbs.md).

## <a name="extend-a-shortcut-menu"></a>Расширение контекстного меню

После выбора метода команда можно расширить контекстное меню для типа файла, зарегистрировав статическую команду для типа файла. Дополнительные сведения см. в разделе [Создание обработчиков контекстного меню](context-menu-handlers.md).

## <a name="support-for-verb-methods-by-operating-system"></a>Поддержка методов команд операционной системой

Поддержка методов вызова команд по операционной системе указана в следующей таблице.



| Метод verb          | Windows XP | Windows Vista | Windows 7 и больше |
|----------------------|------------|---------------|----------------------|
| CreateProcess        | X          | X             | X                    |
| DDE                  | X          | X             | X                    |
| DropTarget           | X          | X             | X                    |
| ExecuteCommand       |            | X             | X                    |
| експлореркомманд      |            |               | X                    |
| експлореркоммандстате |            |               | X                    |



 

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Рекомендации по работе с обработчиками контекстного меню и несколькими командами выбора](verbs-best-practices.md)
</dt> <dt>

[Создание обработчиков контекстного меню](context-menu-handlers.md)
</dt> <dt>

[Настройка контекстного меню с помощью динамических команд](shortcut-menu-using-dynamic-verbs.md)
</dt> <dt>

[Контекстное меню (контекст) и обработчики контекстного меню](context-menu.md)
</dt> <dt>

[Справочник по контекстному меню](context-menu-reference.md)
</dt> <dt>

[Команды и сопоставления файлов](fa-verbs.md)
</dt> </dl>

 

 
