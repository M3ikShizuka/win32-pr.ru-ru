---
description: 'Поиск: протокол приложения — это расширяемое соглашение для вызова приложения для поиска настольных систем в Windows Vista с пакетом обновления 1 (SP1) и более поздними версиями.'
title: Использование протокола поиска
ms.topic: article
ms.date: 05/31/2018
ms.assetid: 91a1ec25-f6ab-4377-8478-20bc51a1d5df
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: a9223a2a30cab85f8e1b0dac0d0df2dc4fe8f80c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104997882"
---
# <a name="using-the-search-protocol"></a>Использование протокола поиска

**Поиск:** [протокол приложения](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa767916(v=vs.85)) — это расширяемое соглашение для вызова приложения для поиска настольных систем в Windows Vista с пакетом обновления 1 (SP1) и более поздними версиями. Протокол был создан в Windows Vista с пакетом обновления 1 (SP1) (Дополнительные сведения см. в статье базы знаний [Обзор изменений Windows Vista Desktop Search в Windows Vista с пакетом обновления](https://support.microsoft.com/kb/941946)SP1), чтобы Windows смогла определить и вызвать приложение для поиска настольных систем по умолчанию.

Синтаксис протокола предоставляет ряд параметров, полезных для выполнения стандартных операций поиска рабочего стола, таких как пользовательские условия поиска или расположение, в котором был начат поиск. Когда пользователи выполняют поиск из одной из двух доступных точек входа (в меню " **Пуск** " или в проводнике Windows), операционная система использует протокол поиска для запуска приложения для поиска настольных систем по умолчанию. Это достигается путем добавления вводимых пользователем условий поиска в стандартный синтаксис протокола поиска и передачи этих сведений приложению, зарегистрированному в качестве приложения поиска по умолчанию.

Если другие приложения для поиска настольных систем не установлены, поиск, введенный в эти точки входа, запускает проводник Windows Search. Однако сторонние разработчики могут создавать, устанавливать и регистрировать свои приложения для работы с протоколом поиска, а также как приложение поиска по умолчанию. Такие приложения должны поддерживать синтаксис протокола поиска и регистрироваться в компоненте « [программы по умолчанию](default-programs.md) », чтобы обеспечить удобство работы с Windows.

При разработке приложения, предназначенного для использования или построения на определенном приложении для поиска на рабочем столе, не следует зависеть от протокола **поиска:** протокол. Так как многие приложения могут владеть **поиском:** протоколом, нет никакой гарантии, что целевое приложение для поиска настольных систем будет иметь его в любой момент времени. Вместо этого следует использовать частный протокол поиска, определенный в целевом приложении поиска на рабочем столе. Это означает, что приложения для поиска на рабочем столе, предназначенные для платформы приложений сторонних разработчиков, должны поддерживать протокол **поиска:** Protocol и собственный собственный протокол поиска.

> [!Note]  
> В поле **Поиск:** протокол не заменяет собственный поиск по протоколу [MS:](../search/-search-3x-wds-qryidx-searchms.md) . Приложения по-прежнему могут использовать протокол **Search-MS:** для запуска обозревателя поиска окна или для автоматического запроса индексатора поиска Windows.

 

В этой статье рассматриваются следующие вопросы:

-   [Синтаксис](#syntax)
-   [Windows Vista с пакетом обновления 1 (SP1) использование поиска: протокол](#windows-vista-with-sp1-use-of-the-search-protocol)
-   [Примеры](#examples)
-   [Регистрация приложения, обрабатывающего протокол](#registering-the-application-that-handles-the-protocol)
    -   [Записи реестра](#registry-entries)
-   [См. также](#related-topics)

## <a name="syntax"></a>Синтаксис

Протокол поиска использует следующий стандартный синтаксис в кодировке URL:


```C++
search:parameter=value[&parameter=value]&
```



Синтаксис начинается с определения самого протокола (**Поиск:**). Пары "параметр-значение" — это аргументы, передаваемые в поисковую систему, как описано в следующей таблице, в которой показаны все возможные параметры синтаксиса протокола поиска.



| Параметр                                              | Значение                                                         | Описание                                                                                                                                                                                                                                                                                    |
|--------------------------------------------------------|---------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| query                                                  | Текст в кодировке URL                                              | Текст запроса, указанный пользователем.                                                                                                                                                                                                                                                            |
| [инпутлокале](search-protocol-localeidentifiers.md)   | Любой допустимый идентификатор кода языка (LCID)                     | КОД языка, определяющий язык ввода для запроса.                                                                                                                                                                                                                                     |
| [кэйвордлокале](search-protocol-localeidentifiers.md) | Любой допустимый код языка                                                | КОД языка, определяющий язык международной версии индексатора. Значение по умолчанию — 1033 (EN-US).                                                                                                                                                                                |
| [иерархической](search-protocol-crumb.md)                     | АКС, инструкция                                                 | Этот аргумент ограничивает область поиска. В Windows Vista протокол поиска поддерживает полную АКС, а также специальную реализацию для `location` аргумента. В Windows XP протокол Search также поддерживает полную АКС, за исключением специальной реализации `kind` и `store` . |
| [Syntax](search-protocol-syntaxargument.md)           | НКС, АКС (без учета регистра)                                 | Синтаксис запроса, используемый для поиска в индексе: естественный синтаксис запроса или синтаксис расширенных запросов (АКС). АКС является значением по умолчанию и всегда считается проанализированным и поддерживаемым.                                                                                                                        |
| [стаккедби](search-protocol-stackedby.md)             | Любое допустимое свойство из системы свойств                   | Свойство, указывающее столбец, по которому должны быть упорядочены результаты.                                                                                                                                                                                                                                      |
| [subquery](search-protocol-subquery.md)               | Полностью указанный путь к сохраненному файлу поиска ( \* . Search-MS) | Результаты вложенного запроса используются в качестве источника запроса. То есть термины запроса ищутся по результатам вложенного запроса.                                                                                                                                               |
| displayname                                            | Строка в кодировке URL                                            | Имя текущего поиска.                                                                                                                                                                                                                                                                |



 

## <a name="windows-vista-with-sp1-use-of-the-search-protocol"></a>Windows Vista с пакетом обновления 1 (SP1) использование поиска: протокол

В Windows Vista с пакетом обновления 1 (SP1) есть несколько точек входа, из которых вызывается протокол **Search:** . Эти точки входа описаны ниже, а также общий синтаксис, связанный с каждой из них.



| Точка входа протокола поиска | Расположение         | Запрос вызван                                                         |
|-----------------------------|------------------|----------------------------------------------------------------------|
| **Поиск везде**       | Меню " **Пуск** "   | Поиск: Query =<*условие поиска*>                                   |
| **Поиск везде**       | Проводник | Поиск: запрос =<*термин поиска*>&путь = расположение: <*Расположение*> |
| Клавиша Windows+F          | В любом месте         | осуществлять                                                              |
| CTRL+F                      | Проводник | Поиск: запрос =<*термин поиска*>&путь = расположение: <*Расположение*> |
| F3                          | Меню " **Пуск** "   | осуществлять                                                              |
| F3                          | Проводник | Поиск: запрос =<*термин поиска*>&путь = расположение: <*Расположение*> |



 

Точки входа протокола поиска с пакетом обновления 1 (SP1) для Windows Vista не используют все возможные параметры в протоколе поиска. Приложения, которые связаны только с обработкой вызовов протокола поиска из Windows Vista с пакетом обновления 1 (SP1), могут использовать приведенную ниже таблицу в качестве рекомендации по минимальным требованиям, которые необходимо реализовать.



| Параметр                                              | Используется Windows? | Как Windows Vista с пакетом обновления 1 (SP1) использует ее при вызове поиска:                                                                                                                                                                                                                     |
|--------------------------------------------------------|------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| query                                                  | Да              | Текст запроса, указанный пользователем.                                                                                                                                                                                                                                         |
| [иерархической](search-protocol-crumb.md)                     | Да              | [](search-protocol-crumb.md) в этом `location` случае аргумент используется для указания места, откуда поступил запрос.                                                                                                                                                                       |
| [subquery](search-protocol-subquery.md)               | Да              | Результаты аргумента [вложенного запроса](search-protocol-subquery.md) используются в качестве области элементов для поиска. Обычно это можно использовать, если пользователь использовал для поиска файл. Search-MS, а затем назвать приложение поиска рабочего стола по умолчанию в этом поиске. |
| [инпутлокале](search-protocol-localeidentifiers.md)   | Нет               | В настоящий момент не используется.                                                                                                                                                                                                                                                         |
| [кэйвордлокале](search-protocol-localeidentifiers.md) | Нет               | В настоящий момент не используется.                                                                                                                                                                                                                                                         |
| [Syntax](search-protocol-syntaxargument.md)           | Нет               | В настоящий момент не используется.                                                                                                                                                                                                                                                         |
| [стаккедби](search-protocol-stackedby.md)             | Нет               | В настоящий момент не используется.                                                                                                                                                                                                                                                         |
| displayname                                            | Нет               | В настоящий момент не используется.                                                                                                                                                                                                                                                         |



 

## <a name="examples"></a>Примеры

Если пользователь вводит "Microsoft" в меню " **Пуск** " и нажимает кнопку " **Поиск везде**", полученный запрос протокола поиска будет выполнен:


```C++
search:query=microsoft&
```



Если пользователь вводит "Сиэтл" в проводнике Windows в C: \\ MyFolder, а затем нажимает кнопку " **Поиск везде**", выполняется следующий вызов с использованием escape-символов для ":" и " \\ ":


```C++
search:query=seattle&crumb=location:C%3A%5CMyFolder
```



## <a name="registering-the-application-that-handles-the-protocol"></a>Регистрация приложения, обрабатывающего протокол

Так как несколько приложений могут конкурировать за протокол поиска, необходимо зарегистрировать приложение в программе [по умолчанию](default-programs.md) во время установки, чтобы пользователь мог легко настроить по умолчанию. В дополнение к обычным процедурам установки в Windows XP, приложение на основе Windows Vista должно быть зарегистрировано в компоненте "программы по умолчанию", чтобы приложение и пользователи могли легко настраивать значения по умолчанию.

После установки необходимых двоичных файлов на компьютере пользователя подпрограммы установки должны выполнить следующие общие задачи:

1.  Запишите идентификаторы ProgID на **\_ локальный \_ компьютер hKey**, как описано ниже. Обратите внимание, что приложения должны создавать идентификаторы ProgID для конкретного приложения для протокола поиска.
2.  Утверждение сопоставления протокола поиска на уровне компьютера.
3.  Зарегистрируйте приложение в [программах по умолчанию](default-programs.md), как описано в разделах [Регистрация приложения для использования с программами по умолчанию](default-programs.md)в качестве средства для протокола поиска.

### <a name="registry-entries"></a>Записи реестра

Ниже приведены примеры необходимых записей реестра для вымышленного приложения поиска на рабочем столе, Поиск contoso.

```
HKEY_LOCAL_MACHINE
   SOFTWARE
      Classes
         contoso-search
            URL Protocol = ""
```

```
HKEY_LOCAL_MACHINE
   SOFTWARE
      Classes
         contoso-search
            DefaultIcon
               (Default) = %ProgramFiles%\Contoso\Search\contososearch.exe,-7
```

```
HKEY_LOCAL_MACHINE
   SOFTWARE
      Classes
         contoso-search
            shell
               open
                  command
                     (Default) = %ProgramFiles%\Contoso\Search\contososearch.exe %1
```

```
HKEY_LOCAL_MACHINE
   SOFTWARE
      RegisteredApplications
         Contoso Search = "Software\\Contoso\\Search\\Capabilities"
```

```
HKEY_LOCAL_MACHINE
   SOFTWARE
      Contoso
         Search
            Capabilities
               ApplicationName = "Contoso Search Test App"
               ApplicationDescription = "Contoso search is a great new desktop search application"
```

```
HKEY_LOCAL_MACHINE
   SOFTWARE
      Contoso
         Search
            Capabilities
               UrlAssociations
                  search = "contoso-search"
```

## <a name="related-topics"></a>См. также

<dl> <dt>

[Синтаксис расширенных запросов](../search/-search-3x-advancedquerysyntax.md)
</dt> <dt>

[Программы по умолчанию](default-programs.md)
</dt> </dl>

 

 
