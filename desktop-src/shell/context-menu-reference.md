---
description: В этом разделе перечислены основные элементы программирования, используемые в контекстных меню (контекстном), и обработчики контекстного меню. Обработчики контекстного меню, также известные как обработчики контекстного меню или обработчиков команд, являются типом обработчика типов файлов.
ms.assetid: efd96a52-6455-40bc-9c21-65f89728e771
title: Справочник по контекстному меню
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8cb1552c8f2f383b08984e9142e464b6831a3c8e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104262917"
---
# <a name="shortcut-menu-reference"></a>Справочник по контекстному меню

В этом разделе перечислены основные элементы программирования, используемые в контекстных меню (контекстном), и обработчики контекстного меню. Обработчики контекстного меню, также известные как обработчики контекстного меню или обработчиков команд, являются типом обработчика типов файлов.

## <a name="about-shortcut-menu-implemetation"></a>О контекстном меню Имплеметатион

Настоятельно рекомендуется реализовать контекстное меню с помощью одного из статических методов глагола. Ознакомьтесь со следующими инструкциями:

-   Чтобы использовать статический метод Verb для реализации контекстного меню, см. раздел "Настройка контекстного меню с использованием статических глаголов" раздела [Создание обработчиков контекстного меню](context-menu-handlers.md).
-   Чтобы получить динамическое поведение для статических глаголов в Windows 7 и более поздних версиях, см. раздел «получение динамического поведения для статических глаголов» раздела [Создание обработчиков контекстного меню](context-menu-handlers.md).
-   Дополнительные сведения о реализации статических команд и о том, какие динамические команды следует избегать, см. в разделе [Выбор статической или динамической команды для контекстного меню](shortcut-choose-method.md).
-   Если необходимо расширить контекстное меню для типа файла, зарегистрировав динамическую команду для типа файла, следуйте инструкциям, приведенным в разделе [Настройка контекстного меню с помощью динамических команд](shortcut-menu-using-dynamic-verbs.md).

### <a name="interfaces"></a>Интерфейсы



| Раздел                                        | Содержимое                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|----------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu)         | Предоставляет методы, которые либо создают, либо объединяют контекстное меню, связанное с объектом Shell.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                    |
| [**IContextMenu2**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenu2)       | Предоставляет методы, которые либо создают, либо объединяют контекстное меню (контекст), связанное с объектом Shell. Расширяет [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu) , добавляя метод, который позволяет клиентским объектам работать с сообщениями, связанными с элементами меню, рисуемыми владельцем.<br/>                                                                                                                                                                                                                                                    |
| [**IContextMenu3**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenu3)       | Предоставляет методы, которые либо создают, либо объединяют контекстное меню, связанное с объектом Shell. Позволяет клиентским объектам обрабатывать сообщения, связанные с элементами меню, рисуемыми владельцем, и расширяет [**IContextMenu2**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenu2) , принимая возвращаемое значение из этой обработки сообщений.<br/>                                                                                                                                                                                                                         |
| [**иконтекстменукб**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenucb)     | Предоставляет метод, который обеспечивает обратный вызов контекстного меню. Например, чтобы добавить значок щита к элементу **menuItem** , требующему повышения прав.<br/>                                                                                                                                                                                                                                                                                                                                                                     |
| [**иконтекстменусите**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenusite) | Реализуется в представлении папок по умолчанию, созданном с помощью [**шкреатешеллфолдервиев**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shcreateshellfolderview). Реализация [**иконтекстменусите**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-icontextmenusite) поддерживает [**IContextMenu:: куериконтекстмену**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-querycontextmenu), [**IContextMenu:: инвокекомманд**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand)и [**метод TrackPopupMenu**](/windows/win32/api/winuser/nf-winuser-trackpopupmenu) , а также любую пересылку сообщений, необходимую для этой функции. Как правило, **иконтекстменусите** также обновляет строку состояния.<br/> |



 

### <a name="functions"></a>Функции



| Раздел                                                            | Содержимое                                                                                                                                |
|------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------|
| [**Кдеффолдермену \_ Create2**](/windows/desktop/api/shlobj_core/nf-shlobj_core-cdeffoldermenu_create2)        | Создает контекстное меню для выбранной группы объектов папки с файлами.<br/>                                                          |
| [**лпфндфмкаллбакк**](/windows/win32/api/shlobj_core/nc-shlobj_core-lpfndfmcallback)                       | Определяет прототип функции обратного вызова, который получает сообщения от реализации контекстного меню по умолчанию в оболочке.<br/> |
| [**шкреатедефаултконтекстмену**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shcreatedefaultcontextmenu) | Создает объект, представляющий реализацию контекстного меню по умолчанию для оболочки.<br/>                                           |



 

### <a name="structures"></a>Структуры



| Раздел                                                  | Содержимое                                                                                                                                                                                                   |
|--------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**кминвокекоммандинфо**](/windows/desktop/api/Shobjidl_core/ns-shobjidl_core-cminvokecommandinfo)     | Содержит сведения, необходимые [**IContextMenu:: инвокекомманд**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-icontextmenu-invokecommand) для вызова команды контекстного меню.<br/>                                                             |
| [**кминвокекоммандинфоекс**](/windows/desktop/api/Shobjidl_core/ns-shobjidl_core-cminvokecommandinfoex) | Содержит расширенные сведения о команде контекстного меню. Эта структура является расширенной версией [**кминвокекоммандинфо**](/windows/desktop/api/Shobjidl_core/ns-shobjidl_core-cminvokecommandinfo) , которая позволяет использовать значения Юникода.<br/> |
| [**дефконтекстмену**](/windows/desktop/api/shlobj_core/ns-shlobj_core-defcontextmenu)               | Содержит сведения о контекстном меню, используемом [**шкреатедефаултконтекстмену**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shcreatedefaultcontextmenu).<br/>                                                                                     |



 

## <a name="related-topics"></a>См. также

<dl> <dt>

[Контекстное меню (контекст) и обработчики контекстного меню](context-menu.md)
</dt> <dt>

[Выбор статической или динамической команды для контекстного меню](shortcut-choose-method.md)
</dt> <dt>

[Команды и сопоставления файлов](fa-verbs.md)
</dt> <dt>

[Рекомендации по работе с обработчиками контекстного меню и несколькими командами выбора](verbs-best-practices.md)
</dt> <dt>

[Создание обработчиков контекстного меню](context-menu-handlers.md)
</dt> <dt>

[Настройка контекстного меню с помощью динамических команд](shortcut-menu-using-dynamic-verbs.md)
</dt> </dl>

 

 
