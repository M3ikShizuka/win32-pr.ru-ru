---
description: Во многих приложениях панели управления отображается страница свойств, позволяющая пользователям просматривать и изменять различные параметры устройства и системы.
title: Регистрация и реализация обработчика страницы свойств для приложения панели управления
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c6865e8e50aefdea3e3d25c29c9abd3bbbabf5c6af3b770537ed187f8b055bdc
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "117859593"
---
# <a name="how-to-register-and-implement-a-property-sheet-handler-for-a-control-panel-application"></a>Регистрация и реализация обработчика страницы свойств для приложения панели управления

Во многих приложениях панели управления отображается страница свойств, позволяющая пользователям просматривать и изменять различные параметры устройства и системы. Два из этих приложений — мышь и экран — позволяют обработчикам страниц свойств заменять одну или несколько страниц на настраиваемую страницу. На следующем снимке экрана показана вкладка свойств **мыши** .

![Страница свойств свойств мыши](images/propsheethandler3.jpg)

Обработчики страниц свойств для приложений панели управления похожи на те, которые относятся к типам файлов, с двумя основными исключениями:

-   Они вызываются приложением панели управления, а не оболочкой.
-   Они регистрируются по-разному.

## <a name="what-you-need-to-know"></a>Это важно знать

### <a name="technologies"></a>Технологии

-   Shell

### <a name="prerequisites"></a>Предварительные требования

-   Знакомство с панелью управления
-   Общие сведения о контекстных меню

## <a name="instructions"></a>Инструкции

### <a name="step-1-registering-a-property-sheet-handler-for-a-control-panel-application"></a>Шаг 1. регистрация обработчика страницы свойств для приложения панели управления

Обработчик страницы свойств приложения панели управления должен быть зарегистрирован в подразделе панели управления. Этот ключ может находиться в одном из двух расположений в зависимости от того, будет ли обработчик выполняться отдельно для каждого пользователя или компьютера. Для регистрации "на пользователя" в разделе "Панель управления" находится **\_ Текущая \_ Пользовательская** \\ **Панель управления**: hKey. Макрос РЕГСТР \_ path \_ контролпанел, как определено в регстр. h, может использоваться в коде вместо "Панель управления". Для регистрации на компьютере расположение:

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            Current Version
               Controls Folder
```

Этот путь можно называть в коде как \_ путь к локальному \_ компьютеру \\ регстр \_ \_ контролсфолдер, используя \_ макрос Регстр Path \_ контролсфолдер, определенный в регстр. h.

Приложения панели управления, которые позволяют обработчикам страниц свойств заменять страницы, имеют подраздел в подразделе панели управления с именем для приложения, например мышь и экран. Подраздел приложения должен иметь подраздел **шеллекс** с подразделом **пропертишисандлерс** . Чтобы зарегистрировать обработчик страницы свойств, добавьте его идентификатор GUID в подраздел **пропертишисандлерс** , связанный с приложением панели управления. Для этого создайте подраздел подраздела **пропертишисандлерс** с именем для обработчика страницы свойств и присвойте его значение по умолчанию строковому формату GUID обработчика.

В следующем примере обработчик страницы свойств для приложения панели управления мыши регистрируется отдельно для каждого компьютера. Чтобы зарегистрировать его отдельно для каждого пользователя, замените путь к **\_ локальному \_ компьютеру** \\ **регстр \_ path \_ контролсфолдер** с **hKey \_ текущий \_ пользователь** \\ **регстр \_ path \_ контролпанел**.

```
HKEY_LOCAL_MACHINE
   REGSTR_PATH_CONTROLSFOLDER
      Mouse
         shellex
            PropertySheetHandlers
               MyPropHandler
                  (Default) = {MyPropHandler CLSID GUID}
```

### <a name="step-2-implementing-a-property-sheet-handler-for-a-control-panel-application"></a>Шаг 2. Реализация обработчика страницы свойств для приложения панели управления

Процедура реализации обработчика страницы свойств панели управления очень похожа на описанную в разделе [Регистрация и реализация обработчика страницы свойств для типа файла](how-to-register-and-implement-a-property-sheet-handler-for-a-file-type.md). Основное отличие заключается в том, что теперь [**ишеллпропшитекст:: реплацепаже**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-replacepage) требуется реализация без маркера вместо [**Ишеллпропшитекст:: аддпажес**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages).

Когда приложение панели управления собирается отобразить свою страницу свойств, оно вызывает метод [**ишеллпропшитекст:: реплацепаже**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-replacepage) обработчика страницы свойств один раз для каждой заменяющих страниц. Для параметра *упажеид* задается идентификатор страницы. Идентификаторы для доступных страниц определяются в Кплекст. h. Доступные в настоящее время идентификаторы перечислены в следующей таблице. 

| Идентификатор страницы                      | Описание         | Приложение панели управления |
|------------------------------|---------------------|---------------------------|
| \_кнопки мыши \_ кплпаже      | Страница "кнопки"    | Мышь                     |
| КПЛПАЖЕ \_ мышь \_ птрмотион    | Страница «Перемещение»     | Мышь                     |
| КПЛПАЖЕ \_ \_ колесика мыши        | Страница колесика      | Мышь                     |
| \_скорость клавиатуры \_ кплпаже     | Страница «скорость»      | Клавиатура                  |
| \_фон экрана \_ кплпаже | Фоновая страница | Отображение                   |



 

## <a name="remarks"></a>Remarks

Процедура создания и замены страницы идентична процедуре добавления страницы. Дополнительные сведения см. [в разделе Регистрация и реализация обработчика страницы свойств для типа файла](how-to-register-and-implement-a-property-sheet-handler-for-a-file-type.md).

 

 



