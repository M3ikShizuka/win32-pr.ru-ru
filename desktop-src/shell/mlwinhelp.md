---
description: Запускает справку Windows (Winhelp.exe) и передает дополнительные данные, указывающие характер справки, запрашиваемой приложением.
ms.assetid: e7466832-f236-4567-b05d-37d25fe88ba2
title: Функция Млвинхелп
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- MLWinHelp
- MLWinHelpA
- MLWinHelpW
api_type:
- DllExport
api_location:
- Shlwapi.dll
ms.openlocfilehash: badfeb599fd24fd255eb064bbaf6d99a3b758bd8
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104984604"
---
# <a name="mlwinhelp-function"></a>Функция Млвинхелп

\[Эта функция доступна в Windows XP и Windows Server 2003. Он может быть изменен или недоступен в последующих версиях Windows.\]

Запускает справку Windows (Winhelp.exe) и передает дополнительные данные, указывающие характер справки, запрашиваемой приложением.

## <a name="syntax"></a>Синтаксис


```C++
BOOL MLWinHelp(
  _In_ HWND      hWndMain,
  _In_ LPCTSTR   lpszHelp,
  _In_ UINT      uCommand,
  _In_ DWORD_PTR dwData
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*хвндмаин* \[ окне\]
</dt> <dd>

Тип: **HWND**

Маркер окна, запрашивающего справку. Функция **млвинхелп** использует этот описатель для наблюдения за тем, какие приложения запросили помощь. Если параметр *укомманд* задает Help \_ CONTEXTMENU или Help \_ WM \_ Help, *хвндмаин* определяет элемент управления, запрашивающий справку.

</dd> <dt>

*лпсзелп* \[ окне\]
</dt> <dd>

Тип: **LPCTSTR**

Адрес строки, завершающейся нулем, которая содержит путь (при необходимости), и имя файла справки, который **млвинхелп** должен отобразить.

За именем файла может следовать угловая скобка (>) и имя дополнительного окна, если раздел должен отображаться во вторичном окне, а не в основном окне. Необходимо определить имя дополнительного окна в \[ \] разделе Windows файла проекта справки (hpj).

</dd> <dt>

*укомманд* \[ окне\]
</dt> <dd>

Тип: **uint**

Тип запрашиваемой справки. Список возможных значений и их влияние на значение, помещаемое в параметр *двдата* , см. в разделе "Примечания".

</dd> <dt>

*двдата* \[ окне\]
</dt> <dd>

Тип: **DWORD \_ ptr**

Дополнительные данные. Используемое значение зависит от значения параметра *укомманд* . Список возможных значений *двдата* см. в разделе "Примечания".

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Тип: **bool** .

Возвращает ненулевое значение при успешном выполнении или ноль в противном случае. Дополнительные сведения об ошибке можно получить, вызвав [**GetLastError**](/windows/win32/api/errhandlingapi/nf-errhandlingapi-getlasterror).

## <a name="remarks"></a>Комментарии

Эта функция не включена в заголовочный файл и должна вызываться порядковым номером 395 для **млвинхелпа** и 397 для **млвинхелпв**.

**Млвинхелп** — это по сути оболочка для [**WinHelp**](/windows/desktop/api/Winuser/nf-winuser-winhelpa). Он пытается получить путь к файлу справки, соответствующему текущему языку пользовательского интерфейса, перед вызовом **WinHelp**. В случае успешного завершения он передает этот путь. В случае сбоя он передает путь, на который указывает *лпсзелп*.

Эта функция завершается ошибкой, если она вызывается из любого контекста, но с текущим пользователем.

Перед закрытием окна, которое запросило помощь, приложение должно вызвать **млвинхелп** с параметром *укомманд* , для которого задано значение Help \_ Quit. Пока все приложения не сделали этого, Справка Windows не будет завершена. Обратите внимание, что вызов справки Windows с помощью \_ команды Help Quit не требуется, если вы использовали \_ команду Help контекстпопуп для запуска справки Windows.

В следующей таблице приведены возможные значения для параметра *укомманд* и соответствующие форматы параметра *двдата* .



| *укомманд*          | Действие                                                                                                                                                                                                                                                               | *двдата*                                                                                                                                                                                                                                                                                                     |
|---------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| \_команда справки       | Выполняет макрос справки или строку макроса.                                                                                                                                                                                                                               | Адрес строки, указывающей имя выполняемых макросов справки. Если в строке указано несколько имен макросов, имена должны быть разделены точкой с запятой. Для некоторых макросов необходимо использовать краткую форму имени макроса, так как Справка Windows не поддерживает длинное имя.                         |
| \_содержание справки      | Отображает раздел, заданный параметром содержимое в \[ разделе Параметры \] файла hpj. Эта команда предназначена для обеспечения обратной совместимости. Новые приложения должны предоставить CNT-файл и использовать \_ команду Help Finder.                                           | Игнорируют Задайте значение 0.                                                                                                                                                                                                                                                                                           |
| \_контекст справки       | Отображает раздел, определяемый указанным идентификатором контекста, определенным в \[ \] разделе Map файла hpj.                                                                                                                                                   | Содержит идентификатор контекста для раздела.                                                                                                                                                                                                                                                               |
| Справка по \_ CONTEXTMENU   | Отображает меню **Справка** для выбранного окна, а затем отображает раздел для выбранного элемента управления во всплывающем окне.                                                                                                                                             | Адрес массива пар **DWORD** . Первым **DWORD** в каждой паре является идентификатор элемента управления, а вторым — идентификатор контекста для раздела. Массив должен заканчиваться парой нулей {0,0} . Если вы не хотите добавлять справку к конкретному элементу управления, задайте для его идентификатора контекста значение-1. |
| Справка \_ контекстпопуп  | Отображает раздел, определяемый указанным идентификатором контекста, определенным в \[ \] разделе Map файла hpj во всплывающем окне.                                                                                                                                | Содержит идентификатор контекста для раздела.                                                                                                                                                                                                                                                                 |
| \_Поиск справки        | Отображает диалоговое окно **разделы справки** .                                                                                                                                                                                                                             | Игнорируют Задайте значение 0.                                                                                                                                                                                                                                                                                           |
| Справка \_ форцефиле     | Обеспечивает отображение правильного файла справки в справке Windows. Если отображается неверный файл справки, откроется окно справки Windows. в противном случае никаких действий не будет.                                                                                     | Игнорируют Задайте значение 0.                                                                                                                                                                                                                                                                                           |
| Справка \_ хелпонхелп    | Отображает справку по использованию справки Windows, если доступен файл Winhlp32. hlp.                                                                                                                                                                                     | Игнорируют Задайте значение 0.                                                                                                                                                                                                                                                                                           |
| \_указатель справки         | Отображает раздел, заданный параметром содержимое в \[ разделе Параметры \] файла hpj. Эта команда предназначена для обеспечения обратной совместимости. Новые приложения должны использовать команду HELP \_ Finder.                                                                   | Игнорируют Задайте значение 0.                                                                                                                                                                                                                                                                                           |
| \_ключ справки           | Отображает раздел в таблице ключевых слов, соответствующий указанному ключевому слову, если имеется точное совпадение. Если найдено несколько совпадений, отображает индекс в разделах, перечисленных в списке **найденных разделов** .                                                 | Адрес строки ключевого слова. Несколько ключевых слов следует разделять точкой с запятой.                                                                                                                                                                                                                              |
| Справка \_ многоключевые      | Отображает раздел, заданный ключевым словом в альтернативной таблице ключевых слов.                                                                                                                                                                                           | Адрес структуры [**мултикэйхелп**](/windows/win32/api/winuser/ns-winuser-multikeyhelpa) , указывающей символ сноски таблицы и ключевое слово.                                                                                                                                                                                     |
| Справка \_ партиалкэй    | Отображает раздел в таблице ключевых слов, соответствующий указанному ключевому слову, если имеется точное совпадение. При наличии нескольких совпадений отображает диалоговое окно **найденные темы** . Чтобы отобразить индекс без передачи ключевого слова, используйте указатель на пустую строку. | Адрес строки ключевого слова. Несколько ключевых слов следует разделять точкой с запятой.                                                                                                                                                                                                                              |
| \_завершить работу          | Информирует Windows о том, что она больше не нужна. Если другие приложения не запросили помощь, Windows закрывает справку Windows.                                                                                                                                         | Игнорируют Задайте значение 0.                                                                                                                                                                                                                                                                                           |
| Справка \_ сетконтентс   | Указывает раздел содержимого. Справка Windows отображает этот раздел, когда пользователь нажимает кнопку " **содержимое** ", если файл справки не имеет связанного файла. cnt.                                                                                                  | Содержит идентификатор контекста для раздела содержимого.                                                                                                                                                                                                                                                      |
| Справка \_ сетпопуп \_ POS | Задает расположение последующего всплывающего окна.                                                                                                                                                                                                                   | Содержит данные о положении. Используйте макрос [**макелонг**](/previous-versions/windows/desktop/legacy/ms632660(v=vs.85)) для сцепления горизонтальных и вертикальных координат в одно значение. Всплывающее окно позиционируется, как если бы курсор мыши находился в указанной точке во время вызова всплывающего окна.                                 |
| Справка \_ сетвинпос     | Отображает окно справки Windows, если оно является сведенным или находится в памяти, и задает для него размер и расположение.                                                                                                                                                      | Адрес структуры [**хелпвининфо**](/windows/win32/api/winuser/ns-winuser-helpwininfoa) , указывающей размер и расположение основного или дополнительного окна справки.                                                                                                                                                             |
| Справка \_ ткард         | Указывает, что команда предназначена для экземпляра карточки обучения Windows. Объедините эту команду с другими командами с помощью побитового оператора или.                                                                                                                    | Зависит от команды, с которой была объединена эта команда.                                                                                                                                                                                                                                                  |
| Справка по справке \_ WM \_      | Отображает раздел для элемента управления, определяемого параметром *хвндмаин* во всплывающем окне.                                                                                                                                                                        | Адрес массива пар **DWORD** . Первым **DWORD** в каждой паре является идентификатор элемента управления, а второй — идентификатор контекста для раздела. Массив должен заканчиваться парой нулей {0,0} . Если вы не хотите добавлять справку к конкретному элементу управления, задайте для его идентификатора контекста значение-1.       |



 

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|---------------------------------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows 2000 Professional, только для \[ классических приложений Windows XP\]<br/>                                        |
| Минимальная версия сервера<br/> | \[Только для настольных приложений Windows Server 2003\]<br/>                                                          |
| Header<br/>                   | <dl> <dt>Нет</dt> </dl>                               |
| DLL<br/>                      | <dl> <dt>Shlwapi.dll (версия 5,0 или более поздняя)</dt> </dl> |
| Имя в кодировке Юникод и ANSI<br/>   | **Млвинхелпв** (Юникод) и **млвинхелпа** (ANSI)<br/>                                                 |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**хелпвининфо**](/windows/win32/api/winuser/ns-winuser-helpwininfoa)
</dt> <dt>

[**мултикэйхелп**](/windows/win32/api/winuser/ns-winuser-multikeyhelpa)
</dt> </dl>

 

 
