---
description: В этом наборе разделов обсуждается реализация обработчиков расширений, позволяющих изменять разнообразные действия оболочки.
ms.assetid: 794b6369-665f-49a9-a263-7c736c5ce8ac
title: Работа с расширениями оболочки
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 804b121ccf633b44574ae956b367143eebdaf7a2a3a8a9cc8400995522b4cbef
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118452860"
---
# <a name="working-with-shell-extensions"></a>Работа с расширениями оболочки

Возможности оболочки можно расширить с помощью записей реестра и файлов .ini. Хотя этот подход к расширению оболочки прост и подходит для многих целей, он ограничен. Например, если вы используете реестр для задания пользовательского значка для типа файла, для каждого файла этого типа будет отображаться один и тот же значок. Расширение оболочки с помощью реестра не позволяет изменять значок для различных элементов типа файла. Другие аспекты оболочки, такие как страница свойств « **Свойства** », которая может отображаться при щелчке правой кнопкой мыши, не может быть изменена в реестре.

Более мощный и гибкий подход к расширению оболочки заключается в реализации *обработчиков расширения оболочки*. Эти обработчики могут быть реализованы для различных действий, которые может выполнять оболочка. Перед выполнением действия оболочка запрашивает обработчик расширения, предоставляя ему возможность изменить действие. Распространенным примером является обработчик расширения контекстного меню. Если один из файлов реализуется для типа файла, он запрашивается каждый раз при щелчке правой кнопкой мыши. Затем обработчик может указать дополнительные пункты меню для каждого файла, вместо того чтобы иметь одинаковый набор для всех файлов этого типа.

В этом наборе разделов обсуждается реализация обработчиков расширений, позволяющих изменять разнообразные действия оболочки. Следующие обработчики связаны с определенным типом файла и позволяют указать отдельно для каждого файла.



| Обработчик                                               | Описание                                                                                                                                                                |
|-------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [Обработчик контекстного меню](context-menu-handlers.md)    | Вызывается перед отображением контекстного меню файла. Он позволяет добавлять элементы в контекстное меню для каждого файла.                                               |
| [Обработчик данных](how-to-create-data-handlers.md)       | Вызывается при выполнении операции перетаскивания объектов оболочки. Он позволяет предоставлять дополнительные форматы буфера обмена для целевого объекта перетаскивания.                            |
| [Удалить обработчик](how-to-create-drop-handlers.md)       | Вызывается, когда объект данных перетаскивается или удаляется в файле. Он позволяет преобразовать файл в цель перетаскивания.                                                          |
| [Обработчик значков](how-to-create-icon-handlers.md)       | Вызывается перед отображением значка файла. Он позволяет заменить значок файла по умолчанию на пользовательский значок для каждого файла.                                    |
| [Обработчик страницы свойств](propsheet-handlers.md)      | Вызывается перед отображением страницы свойств **Свойства** объекта. Он позволяет добавлять или заменять страницы.                                                              |
| [**Обработчик изображений эскиза**](/windows/desktop/api/Thumbcache/nn-thumbcache-ithumbnailprovider) | Предоставляет изображение для представления элемента.                                                                                                                                   |
| [**Обработчик подсказок**](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo)                 | Предоставляет всплывающий текст, когда пользователь наводит указатель мыши на объект.                                                                                               |
| [**Обработчик метаданных**](/windows/win32/api/propidl/nn-propidl-ipropertysetstorage)       | Предоставляет доступ на чтение и запись к метаданным (свойствам), хранящимся в файле. Это можно использовать для расширения подробного представления, инфотипс, страницы свойств и функций группирования. |



 

Другие не связаны с определенным типом файлов, но вызываются перед некоторыми операциями оболочки.



| Обработчик                                                            | Описание                                                                                                                                  |
|--------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------|
| [Обработчик столбцов](../lwef/column-handlers.md)                             | вызывается обозревателем Windows Explorer перед отображением подробного представления папки. Он позволяет добавлять пользовательские столбцы в представление Details.        |
| [Копирование обработчика перехватчика](how-to-create-copy-hook-handlers.md)          | Вызывается, когда объект папки или принтера собирается перемещаться, копироваться, удаляться или переименовываться. Она позволяет утвердить или отклонить операцию.   |
| [Обработчик действия перетаскивания](context-menu-handlers.md)                 | Вызывается при перетаскивании файла с помощью правой кнопки мыши. Это позволяет изменить отображаемое контекстное меню.                     |
| [Обработчик наложения значков](how-to-implement-icon-overlay-handlers.md) | Вызывается перед отображением значка файла. Он позволяет указать наложение для значка файла.                                          |
| [Поисковый обработчик](../lwef/search-handlers.md)                             | Вызывается для запуска поисковой системы. она позволяет реализовать пользовательскую подсистему поиска, доступную в меню " **пуск** " или в обозревателе Windows. |



 

Сведения о реализации конкретных обработчиков расширений описаны в разделах, перечисленных выше. Обсуждения проблем реализации, общих для всех обработчиков расширений оболочки, см. в следующих разделах:

-   [Инициализация обработчиков расширений оболочки](int-shell-exts.md)
-   [Регистрация обработчиков расширений оболочки](reg-shell-exts.md)

 

 
