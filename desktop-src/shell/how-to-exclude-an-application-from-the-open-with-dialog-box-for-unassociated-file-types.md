---
description: Исключение приложения из диалогового окна "Открыть с помощью" для несвязанного типа файла.
title: Исключение приложения из диалогового окна "Открыть с помощью" для несвязанных типов файлов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9443416e95fca112623d487bf58f4fce1d51d13d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104557496"
---
# <a name="how-to-exclude-an-application-from-the-open-with-dialog-box-for-unassociated-file-types"></a>Исключение приложения из диалогового окна "Открыть с помощью" для несвязанных типов файлов

Когда пользователь пытается открыть файл, который не является членом какого-либо зарегистрированного типа файла (то есть неизвестного типа файла), или когда пользователь выбирает пункт **Открыть с** помощью или **открыть с использованием > выбрать программу по умолчанию** в контекстном меню файла, оболочка представляет подменю или диалоговое окно, позволяющее пользователю указать программу, используемую для открытия файла.

По умолчанию любое приложение, зарегистрированное в качестве подраздела для **\_ \_ корневых приложений классов hKey**, \\  представлено в диалоговом окне **Открыть с помощью** . Эти приложения представлены в **открытом** виде независимо от того, зарегистрировано ли приложение для работы с типом файлов.

Чтобы приложение не отображалось в диалоговом окне **Открыть с помощью** , если приложение не должно быть открыто или не может использоваться для открытия определенных типов файлов, используйте один из двух методов, описанных в этом разделе.

## <a name="instructions"></a>Инструкции

### <a name="step-1"></a>Шаг 1.

Добавьте запись Нупенвис в подраздел приложения. Если приложение использует тип файла, Windows записывает эти сведения для создания списка **рекомендуемых программ** . Этот список представлен в подменю **Открыть с помощью** , как показано на следующем снимке экрана.

![снимок экрана контекстного меню с отображаемым подменю «открыть с помощью»](images/file-assoc/openwithsubmenu.png)

Эти Рекомендуемые приложения также отображаются в разделе **Рекомендуемые программы** диалогового окна **Открыть с помощью** , как показано на следующем снимке экрана.

![снимок экрана с диалоговым окном "Открыть с помощью" с рекомендуемыми программами](images/file-assoc/openwithdialog.png)

> [!Note]  
> Если приложение зарегистрировано в [опенвислист](fa-file-types.md) или опенвиспрогидс для типа файла, оно появится в списке **рекомендуемых программ** , даже если задана запись нупенвис. Кроме того, помните, что независимо от того, предлагается ли приложение в списке рекомендуемых программ, пользователь может вручную перейти к любому исполняемому файлу.

 

Приложения могут отключить это отслеживание, указав значение Нупенвис в подразделе приложения.

Запись Нупенвис представляет собой пустое значение **reg \_ SZ** , как показано в следующем примере.

```
HKEY_CLASSES_ROOT
   Applications
      MyProgram.exe
         NoOpenWith
```

Настройка записи Нупенвис также включает следующие эффекты:

-   Предотвращает закрепление файла в списке переходов приложения с помощью перетаскивания, если только приложение не зарегистрировано для работы с этим типом файлов.
-   Запрещает диалоговое окно Common File и любой вызов функции [**шаддторецентдокс**](/windows/desktop/api/shlobj_core/nf-shlobj_core-shaddtorecentdocs) для добавления любого файла в список переходов приложения, если только приложение не зарегистрировано для работы с этим типом файлов.

### <a name="step-2"></a>Шаг 2.

Второй способ предотвратить появление приложения в диалоговом окне **Открыть с помощью** заключается в использовании подраздела **суппортедтипес** для явного перечисления расширений типов файлов, которые может открыть приложение. Это предотвращает отображение приложения в диалоговом окне **Открыть с помощью** для типов файлов, которые не удается открыть. Это также приводит к тому, что приложение отображается в списке **рекомендуемых программ** , как описано выше.

Этот метод особенно полезен, если приложение может сохранить файл в файле определенного типа, но не может открыть этот тип файла. Приложение также должно установить \_ флаг Фос донтаддторецент с помощью [**ифиледиалог:: сетоптионс**](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ifiledialog-setoptions) при вызове диалогового окна **сохранить** . Это предотвращает добавление элемента к **последним** или **частым** частям списка переходов. Он также блокирует отслеживание приложения в разделе [опенвислист](fa-file-types.md).

Каждое поддерживаемое расширение добавляется в качестве записи в подраздел **суппортедтипес** , как показано в следующем примере. Записи имеют тип **reg \_ SZ** или **reg \_ null** без связанных значений.

```
HKEY_CLASSES_ROOT
   Applications
      ApplicationName
         SupportedTypes
            .ext1
            .ext2
            .ext3
```

Если указан подраздел **суппортедтипес** , то только файлы с этими расширениями могут закрепляться в списке переходов приложения или в списке **недавних** или **часто** используемых приложений.

Запись Нупенвис переопределяет подраздел **суппортедтипес** и скрывает приложение в диалоговом окне " **Открыть с помощью** ".

 

 
