---
description: Когда пользователь щелкает правой кнопкой мыши объект оболочки, контекстное меню, которое отображается, обычно содержит элемент свойства.
title: Обработчики страницы свойств
ms.topic: article
ms.date: 05/31/2018
ms.assetid: 72233ab5-212d-498c-8df1-1a96c8eda892
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: 40ccb8d1cee0fffb993aef417b979816597cf707
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "103910768"
---
# <a name="property-sheet-handlers"></a>Обработчики страницы свойств

Когда пользователь щелкает правой кнопкой мыши объект оболочки, контекстное меню, которое отображается, обычно содержит элемент **Свойства** . При выборе этого элемента открывается страница свойств, позволяющая пользователю просматривать и в некоторых случаях изменять свойства объекта. Эту вкладку свойств можно настроить, реализовав и зарегистрировав *обработчик страницы свойств*.

Общие процедуры для реализации и регистрации обработчика расширений оболочки обсуждаются в разделе [Создание обработчиков расширений оболочки](handlers.md). В этом документе рассматриваются аспекты реализации, характерные для обработчиков страниц свойств.

-   [Как работают обработчики страниц свойств](#how-property-sheet-handlers-work)
-   [Регистрация и реализация обработчика страницы свойств для подключенного диска](#registering-and-implementing-a-property-sheet-handler-for-a-mounted-drive)
-   [См. также](#related-topics)

## <a name="how-property-sheet-handlers-work"></a>Как работают обработчики страниц свойств

На следующем рисунке показана страница свойств текстового файла Windows XP.

![Страница свойств](images/propsheethandler1.jpg)

На этом рисунке показана страница свойств по умолчанию, которая отображается для любого файла. Для многих таких вкладок свойств можно добавить одну или несколько страниц в страницу свойств путем реализации и регистрации обработчика страницы свойств.

Обработчики страниц свойств чаще всего регистрируются для [типа файлов](fa-file-types.md). Каждый обработчик может добавить одну пользовательскую страницу в страницу свойств свойств для класса. Обычно эти страницы предоставляют пользователям доступ к свойствам конкретного типа файлов. Например, тип файла, состоящий из текстовых документов, может отображать страницу, в которой указаны заголовок и автор, и выдержку документа. Особый случай такого типа обработчика страницы свойств используется для добавления страницы в страницу свойств для подключенного диска.

Другой способ использования обработчиков страниц свойств — заменить страницы в страницах свойств, отображаемых приложениями панели управления. Производитель, например, может использовать обработчик страницы свойств для замены страницы **кнопок** в окне свойств **мыши** панели управления на страницу, настроенную для характеристик ее мыши.

Как и все обработчики расширений оболочки, обработчики страниц свойств — это объекты модели COM, реализованные в виде библиотек DLL. Помимо [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown): [**ишеллекстинит**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) и [**ишеллпропшитекст**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext), они должны экспортировать два интерфейса.

Интерфейс [**ишеллекстинит**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) используется оболочкой для инициализации обработчика. Когда оболочка вызывает [**ишеллекстинит:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize), она передает объект данных с именем объекта и указатель на список идентификаторов элементов (Пидл) папки, содержащей файл. Параметр *хрегкэй* не используется с обработчиками страниц свойств. Метод **ишеллекстинит:: Initialize** должен извлечь имя файла из объекта данных и сохранить имя и Пидл папки для последующего использования. Дополнительные сведения см. в разделе *Реализация ишеллекстинит* для [создания обработчиков расширений оболочки](handlers.md).

Оставшаяся часть операции выполняется через интерфейс [**ишеллпропшитекст**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext) обработчика. Если страница свойств связана с типом файла, оболочка вызывает [**ишеллпропшитекст:: аддпажес**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-addpages) , чтобы разрешить обработчику добавить страницу на лист свойств. Если страница свойств связана с приложением панели управления, оболочка вызывает [**ишеллпропшитекст:: реплацепаже**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellpropsheetext-replacepage) , чтобы разрешить обработчику заменить страницу.

## <a name="registering-and-implementing-a-property-sheet-handler-for-a-mounted-drive"></a>Регистрация и реализация обработчика страницы свойств для подключенного диска

У каждого подключенного диска есть страница свойств, которую может отобразить пользователь. На следующем рисунке показана страница свойств для устройства чтения компакт-дисков.

![Страница свойств "свойства компакт-диска"](images/propsheethandler2.jpg)

Существует множество устройств, которые можно подключить как диски. Поскольку страница свойств по умолчанию, предназначенная для дисков, может быть недостаточно для некоторых устройств, можно реализовать обработчик страницы свойств, чтобы добавить страницу, относящуюся к подключенному устройству. Базовая реализация этого типа обработчика страницы свойств идентична описанной в разделе [Регистрация и реализация обработчика страницы свойств для типа файла](how-to-register-and-implement-a-property-sheet-handler-for-a-file-type.md)с двумя исключениями.

-   Объект данных, передаваемый методу [**ишеллекстинит:: Initialize**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellextinit-initialize) обработчика, может содержать путь к диску в формате [кфстр \_ маунтедволуме](clipboard.md) вместо формата [CF \_ HDROP](clipboard.md) . Формат CF \_ HDROP используется, когда устройство подключено к букве диска. Формат КФСТР \_ маунтедволуме используется с файловыми системами NTFS, если удаленное устройство подключено к папке, а не к букве диска.
-   Идентификатор GUID обработчика регистрируется в разделе **\_ \_ корневой** \\ **диск** \\ **шеллекс** \\ **пропертишисандлерс** раздела hKey classes.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Регистрация и реализация обработчика страницы свойств для типа файла](how-to-register-and-implement-a-property-sheet-handler-for-a-file-type.md)
</dt> <dt>

[Регистрация и реализация обработчика страницы свойств для приложения панели управления](how-to-register-and-implement-a-property-sheet-handler-for-a-control-panel-application.md)
</dt> </dl>

 

 
