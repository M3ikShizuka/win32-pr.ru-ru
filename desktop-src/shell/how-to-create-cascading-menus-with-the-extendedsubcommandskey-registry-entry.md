---
description: В Windows 7 и более поздних версиях можно использовать подраздел Екстендедсубкоммандскэй для создания расширенных каскадных меню.
ms.assetid: 6E8B4FB7-D4DB-4DBC-AF6F-59D02CB6AB13
title: Создание каскадных меню с помощью записи реестра Екстендедсубкоммандскэй
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 220a38825ae250a0d58d30bc7de93f290f819eb8
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103813712"
---
# <a name="how-to-create-cascading-menus-with-the-extendedsubcommandskey-registry-entry"></a>Создание каскадных меню с помощью записи реестра Екстендедсубкоммандскэй

В Windows 7 и более поздних версиях можно использовать подраздел **екстендедсубкоммандскэй** для создания расширенных каскадных меню.

На следующем снимке экрана показан пример расширенного каскадного меню.

![снимок экрана с расширенным каскадным меню для устройств](images/file-assoc/extendedsubcommandskey.png)

Так **как \_ \_ корневые классы классов hKey** являются сочетанием **\_ текущего \_ пользователя hKey** и раздела **hKey \_ \_**, можно зарегистрировать подкоманды в подразделе " **классы \_ текущего \_ пользовательского** \\ **программного обеспечения** hKey" \\  . Преимущество этого подхода в том, что повышенное разрешение не требуется. Другие ассоциации файлов могут повторно использовать весь набор команд, указав тот же подраздел **екстендедсубкоммандскэй** . Если не нужно повторно использовать этот набор команд, можно вывести список команд в родительском элементе. В этом случае убедитесь, что значение по умолчанию родительского элемента пустое, как показано в примере записи реестра в этом разделе.

## <a name="instructions"></a>Инструкции

### <a name="step-1"></a>Шаг 1.

Создайте подраздел в разделе **\_ Classes \_ root** \\ *ProgID* \\ **Shell** \\ *каскадеменукэй* и присвойте каскадеменукэй имя, например *каскадетест*, например. Затем добавьте запись Муиверб типа **reg \_ SZ** и присвойте ей имя, такое как проверка каскадного меню 2, как показано в следующем примере реестра.

```
HKEY_CLASSES_ROOT
   txtfile
      shell
         CascadeTest
            MUIVerb = Test Cascade Menu 2
```

### <a name="step-2"></a>Шаг 2.

В созданном вами подразделе *каскадетест* добавьте подраздел **екстендедсубкоммандскэй** , а затем добавьте подкоманды Document (из типа **reg \_ SZ**), например:

```
HKEY_CLASSES_ROOT
   txtfile
      Shell
         Test Cascade Menu 2
            (Default)
            ExtendedSubCommandsKey
               Layout
               Properties
               Select all
```

Убедитесь, что значение по умолчанию для подраздела *тест Cascade меню 2* пусто и отображается как **(значение не задано)**.

### <a name="step-3"></a>Шаг 3.

Заполните подкоманды с помощью любой из следующих статических реализаций глаголов. Обратите внимание, что подраздел Коммандфлагс представляет значения ЕКСПКМДФЛАГС. Если вы хотите добавить разделитель до или после пункта меню Cascade, используйте ЕКФ \_ сепараторбефоре (0x20) или ЕКФ \_ сепараторафтер (0x40). Описание этих флагов Windows 7 и более поздних версий см. в разделе [**иексплореркомманд::-flags**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-iexplorercommand-getflags). ЕКФ \_ сепараторбефоре работает только для пунктов меню верхнего уровня. Муиверб имеет тип **reg \_ SZ**, а Коммандфлагс имеет тип **reg \_ DWORD**.

```
HKEY_CLASSES_ROOT
   txtile
      Shell
         Test Cascade Menu 2
            (Default)
            ExtendedSubCommandsKey
               Shell
                  cmd1
                     MUIVerb = Notepad
                     command
                        (Default) = %SystemRoot%\system32\notepad.exe %1
                  cmd2
                     MUIVerb = Wordpad
                     CommandFlags = 0x20
                     command
                        (Default) = C:\Program Files\Windows NT\Accessories\wordpad.exe %1
```

## <a name="remarks"></a>Примечания

На следующем снимке экрана показан пример записи предыдущего раздела реестра.

![снимок экрана, показывающий пример каскадного меню, в котором отображаются параметры блокнота и WordPad](images/file-assoc/testcascademenu2.png)

 

 



