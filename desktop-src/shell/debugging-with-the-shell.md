---
description: В этом разделе описывается отладка библиотек DLL расширения оболочки и пространства имен.
title: Отладка с помощью оболочки
ms.topic: article
ms.date: 05/31/2018
ms.assetid: 2fcaf633-9a6d-4fda-a690-28445b10a6d6
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: 3ca6e30809565408454976e1b07ff37dcc8f8f8a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104540530"
---
# <a name="debugging-with-the-shell"></a>Отладка с помощью оболочки

В этом разделе описывается отладка библиотек DLL расширения оболочки и пространства имен.

-   [Запуск оболочки в отладчике](#running-the-shell-under-a-debugger)
-   [Выполнение и тестирование расширений оболочки](#running-and-testing-shell-extensions)
-   [Выгрузка библиотеки DLL](#unloading-the-dll)

## <a name="running-the-shell-under-a-debugger"></a>Запуск оболочки в отладчике

Чтобы выполнить отладку расширения, необходимо запустить оболочку из отладчика. Выполните указанные ниже действия.

1.  Загрузите проект расширения в отладчик, но не запускайте его.
2.  Завершите работу оболочки.

    -   Для Windows Vista и более поздних версий:
        1.  Отображение меню " **Пуск** ".
        2.  Нажмите клавиши CTRL + SHIFT и щелкните правой кнопкой мыши фон правой половины меню **Пуск** .
        3.  В появившемся меню выберите **выход из проводника**.
    -   Для Windows XP:
        1.  В меню **Пуск** выберите команду **Завершение работы**.
        2.  Нажмите клавиши CTRL + ALT + SHIFT и выберите **нет** в диалоговом окне **Завершение работы Windows** .

    Теперь оболочка завершает работу, но все остальные приложения по-прежнему выполняются, включая отладчик.

3.  Настройте отладчик для запуска библиотеки DLL расширения с Explorer.exe из каталога **Windows** .
4.  Запустите проект из отладчика. Оболочка запустится как обычно, но отладчик будет присоединен к процессу оболочки.

## <a name="running-and-testing-shell-extensions"></a>Выполнение и тестирование расширений оболочки

Вы можете запускать и тестировать расширения в отдельном процессе проводника Windows, чтобы избежать остановки и перезапуска рабочего стола и панели задач. Рабочий стол и панель задач по-прежнему можно использовать при запуске и тестировании расширений.

Чтобы включить эту функцию, добавьте в реестр следующий параметр REG \_ DWORD.

```
HKEY_CURRENT_USER
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  DesktopProcess = 1
```

Чтобы эта запись вступила в силу, необходимо выйти из системы и снова войти в нее. Этот параметр приводит к тому, что окна рабочего стола и панели задач создаются в одном Explorer.exe процессе, а все остальные окна проводника и папок открываются в другом процессе Explorer.exe.

Кроме того, чтобы сделать работу и тестирование расширений более удобным, этот параметр также делает Рабочий стол более надежным по мере того, как он связан с расширениями оболочки. Многие такие расширения (например, расширения контекстного меню) будут загружены в рабочий процесс Explorer.exe. Если этот процесс завершится, Рабочий стол и панель задач не будут затронуты, а в следующем окне проводника или папки будет создан повторно завершенный процесс.

## <a name="unloading-the-dll"></a>Выгрузка библиотеки DLL

Оболочка автоматически выгружает любую библиотеку DLL, если ее значение счетчика использования равно нулю, но только после того, как библиотека DLL не использовалась в течение определенного времени. Этот неактивный период может быть неприемлемым, особенно при отладке библиотеки DLL расширения оболочки. Вы можете сократить неактивный период, добавив в реестр следующие сведения.

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows
            CurrentVersion
               Explorer
                  AlwaysUnloadDll
```

 

 



