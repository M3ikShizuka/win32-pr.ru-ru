---
description: узнайте, как расширить ленту обозревателя Windows.
title: Расширение ленты
ms.topic: article
ms.date: 05/31/2018
ms.assetid: 0C043FF8-3862-4F02-8700-BB556C4F35B8
api_name: ''
api_type: ''
api_location: ''
topic_type:
- kbArticle
ms.openlocfilehash: 6a0a3af3ac21e0bac0471bc9a987849536303556
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127460497"
---
# <a name="extending-the-ribbon"></a>Расширение ленты

в Windows Explorer лента помогает сделать распространенные действия по управлению файлами конечными пользователями более простыми и более обнаруживаемыми, но изменения занимающимся для разработчиков приложений. Например, Старая панель команд была свободно расширяемой, но в настоящее время лента в ней больше ограничена. Кроме того, лента не отображается по умолчанию для всех расширений пространства имен, поэтому необходимо принять участие в получении ленты. в противном случае вы получаете более раннюю панель команд.

Действия, доступные пользователям на ленте, делятся на три категории расширяемости:

-   Расширяемость не требуется. Примеры: копирование, вставка, удаление. Windows обрабатывает эти команды.
-   В настоящее время расширяемость не разрешена: примеры: ZIP, закрыть сеанс и другие настраиваемые действия. Используйте контекстное меню, чтобы охватить эти сценарии.
-   Расширяемость встроена в само действие. Примеры: Поиск, электронная почта, печать, новый элемент. Чтобы включить приложение или формат файла на ленту, необходимо зарегистрироваться для получения этих команд.

В этом документе описывается, как можно принять участие в ленте и как зарегистрироваться для работы с конкретными командами ленты.

## <a name="opting-in-to-the-ribbon"></a>Включение на ленту

Чтобы принять участие в ленте, ваша реализация [**IShellFolder2**](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ishellfolder2) должна указать **\_ ленту EP** в [**иексплорерпаневисибилити:: жетпанестате**](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-iexplorerpanevisibility-getpanestate) и вернуть **EPS \_ Force** \| **EPS \_ по умолчанию \_ в**.

## <a name="extending-the-ribbon-for-file-extensions"></a>Расширение ленты для расширений файлов

Эти кнопки на ленте расширяются на основе расширений файлов:

-   Извлечь все
-   Подключить \| запись (ISO-образ)
-   Воспроизвести \| все \| Добавление в список воспроизведения (команда: поставить в очередь)
-   Открыть
-   Изменить
-   Элемент Property

При регистрации для статической обработки соответствующих команд для новых типов файлов лента обрабатывает команды соответствующим образом. Вы регистрируетесь точно так же, как для команд контекстного меню. Дополнительные сведения о сопоставлении файлов и регистрации для команд см. в разделе [глаголы и сопоставления файлов](fa-verbs.md) и [Создание обработчиков контекстного меню](context-menu-handlers.md).

## <a name="registering-as-a-default-handler-for-actionids"></a>Регистрация в качестве обработчика по умолчанию для Актионидс

Сначала Зарегистрируйте идентификатор ProgId в соответствующем подразделе Ассокактионид. Каждый подраздел Ассокактионид представляет команду или действие, которые пользователи могут вызывать из ленты. В этом примере приложение регистрируется для Зипселектион ActionID, чтобы расширить кнопку "извлечь все" на ленте.

```
HKEY_LOCAL_MACHINE
   SOFTWARE
      Classes
         Explorer.AssocActionId.ZipSelection
            shell
               open
                  command
                     (Default) = %SystemRoot%\[Your App].exe
      Microsoft
         Windows
            CurrentVersion
               Your App Name
                  Capabilities
                     URL Protocol
                     FriendlyTypeName = @%SystemRoot%\explorer.exe,-1234
```

После завершения регистрации необходимо зарегистрироваться для работы с протоколами так же, как обычно, как описано в разделе [программы по умолчанию](default-programs.md).

 

 



