---
description: Оболочка использует подраздел реестра программного идентификатора (ProgID), чтобы связать тип файла с приложением и управлять поведением ассоциации.
ms.assetid: f2b666d6-bf22-47b5-87e1-8de5ff51c152
title: Программные идентификаторы
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bf982f865fa8b856bc29c00a9b2371b88b34615b
ms.sourcegitcommit: 9b5faa61c38b2d0c432b7f2dbee8c127b0e28a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2021
ms.locfileid: "122467291"
---
# <a name="programmatic-identifiers"></a>Программные идентификаторы

Оболочка использует подраздел реестра программного идентификатора (ProgID), чтобы связать тип файла с приложением и управлять поведением ассоциации. Записи ProgID, используемые для сопоставления файлов, находятся в **разделе \_ \_ корневые классы hKey** в реестре.

Этот раздел организован следующим образом:

-   [Программные элементы идентификаторов, используемые при сопоставлении файлов](#programmatic-identifier-elements-used-by-file-associations)
-   [Использование программных идентификаторов с управлением версиями](#using-versioned-programmatic-identifiers)
-   [Связанные темы](#related-topics)

Дополнительные сведения см. [в статье регистрация типа файла для нового приложения](how-to-register-a-file-type-for-a-new-application.md) .

## <a name="programmatic-identifier-elements-used-by-file-associations"></a>Программные элементы идентификаторов, используемые при сопоставлении файлов

Правильный формат имени ключа ProgID — « \[ *поставщик» или «приложение* \] ». \[ *Компонент* \] . \[ *Версии* \] , разделенные точками и без пробелов, как в Word.Docумент. 6. Часть *версии* является необязательной, но настоятельно рекомендуется. Дополнительные сведения см. [в разделе Использование программных идентификаторов с управлением версиями](#using-versioned-programmatic-identifiers).

Подраздел ProgID должен содержать следующие элементы. Обратите внимание, что для некоторых строковых данных в этом ключе требуется определенное форматирование.




| Элемент | Описание | 
|---------|-------------|
| <strong>Параметры</strong> | Задайте в качестве записи по умолчанию подраздела ProgID понятное имя для этого ProgID, которое будет отображаться для пользователя. использование этой записи для хранения понятного имени не рекомендуется для записи фриендлитипенаме в системах под управлением Windows 2000 или более поздней версии. Однако это значение следует задавать для обратной совместимости.<br /> | 
| <strong>Алловсилентдефаулттакеовер</strong> (введено в Windows 8) | установите эту необязательную запись, чтобы сообщить, что Windows должен игнорировать этот идентификатор ProgID при определении обработчика по умолчанию для типа общедоступного файла. Независимо от того, задано ли это значение, идентификатор ProgID по-видимому отображается в контекстном меню Опенвис и диалоговом окне. Это REG_NONE значение. | 
| <strong>AppUserModelID</strong> (вводится в Windows 7) | Установите эту необязательную запись в явном ИДЕНТИФИКАТОРе пользовательской модели приложения (AppUserModelID), если приложение использует явный AppUserModelID и использует автоматически созданные <strong>последние</strong> или <strong>частые</strong> списки переходов или пользовательский список переходов. Если приложение использует явный AppUserModelID и не устанавливает это значение, элементы не будут отображаться в списках переходов этого приложения. Это REG_SZ строка. Дополнительные сведения см. в разделе <a href="appids.md">идентификаторы моделей пользователей приложения (аппусермоделидс)</a>.<br /> | 
| <strong>EditFlags</strong> | Установите эту необязательную запись с помощью флагов из перечисления <a href="/windows/desktop/api/Shlwapi/ne-shlwapi-filetypeattributeflags"><strong>филетипеаттрибутефлагс</strong></a> . Запись Едитфлагс управляет некоторыми аспектами обработки типов файлов, связанных с этим ProgID, в оболочке. Кроме того, можно использовать запись Едитфлагс для ограничения объема, который пользователь может изменять в определенных аспектах этих типов файлов, с помощью страницы свойств файла. Значения <strong>филетипеаттрибутефлагс</strong> , используемые для едитфлагс, — это двоичные значения, разработанные таким образом, что можно объединить несколько атрибутов в одно значение в битовой операции OR. Это REG_DWORD или REG_BINARY значение.<br /> | 
| <strong>фриендлитипенаме</strong> | Задайте для этой записи понятное имя ProgID, которое будет отображаться для пользователя. Для обеспечения согласованности эта строка должна содержать те же данные, что и запись по умолчанию для этого ключа ProgID. Эта запись может быть либо REG_SZ, либо REG_EXPAND_SZ строкой, но ее необходимо отформатировать как косвенную строку (полное имя файла и значение ресурса, предшествующее символу @), например, для экземпляра <em>@% systemroot% \shell32.dll,-154</em>.<br /> | 
| <strong>InfoTip</strong> | Задайте для этой записи краткое справочное сообщение, отображаемое оболочкой для этого ProgID. Запись подсказки отображается в диалоговом окне, наведении указателя мыши. Это значение может быть либо REG_SZ, либо REG_EXPAND_SZ строкой, но, как Фриендлитипенаме, оно должно быть отформатировано как непрямая строка.<br /> | 
| <strong>CurVer</strong> | Задайте в качестве записи (по умолчанию) этого подраздела самую последнюю версию этого ProgID.<br /><blockquote>[!Note]<br />Если у вас нет параллельных версий приложений, то есть несколько версий, установленных в одной системе, следует избегать использования <strong>CurVer</strong>.</blockquote><br /> | 
| <strong>Дефаултикон</strong>. | Присвойте записи (по умолчанию) этого подраздела значок по умолчанию, который будет отображаться для типов файлов, связанных с этим ProgID. Это значение может быть либо REG_SZ, либо REG_EXPAND_SZ строкой, но оно должно быть указано как полное имя файла со значением ресурса помощника, например <em>% systemroot% \shell32.dll,-154</em>.<br /> | 




 

В следующем примере раздела реестра показан узел ключа ProgID для сопоставления файлов:

```
HKEY_CLASSES_ROOT
   Vendor.App.1
      (Default) = My Friendly Name
      AllowSilentDefaultTakeOver
      AppUserModelID = Vendor.Application
      EditFlags = 0x00000001
      FriendlyTypeName = @%SystemRoot%\shell32.dll,-154
      InfoTip = @%SystemRoot%\shell32.dll,-54
      CurVer
         (Default) = Vendor.App.1
      DefaultIcon
         (Default) = %SystemRoot%\shell32.dll,-1
```

## <a name="using-versioned-programmatic-identifiers"></a>Использование программных идентификаторов с управлением версиями

Версия ProgID, версия которой указывается в имени. Обычно это делается путем добавления точки и номера версии к имени. Пример:

-   Word.Docумент. 6
-   Word.Docумент. 8

Это идентификаторы ProgID с версиями 6 и 8 соответственно. Если у вас есть параллельное приложение, то есть одновременно поддерживает несколько версий приложения, используйте CurVer и независимые от версии идентификаторы ProgID. В противном случае CurVer и независимые от версии идентификаторы ProgID следует избегать, поскольку они приводят к неэффективному повышению эффективности.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Как зарегистрировать тип файла для нового приложения](how-to-register-a-file-type-for-a-new-application.md)
</dt> <dt>

[Регистрация приложения](app-registration.md)
</dt> <dt>

[Типы файлов](fa-file-types.md)
</dt> <dt>

[Как работают сопоставления файлов](fa-how-work.md)
</dt> <dt>

[Представление содержимого по типу или виду файла](prophand-content-view.md)
</dt> <dt>

[Средство проверки типов файлов](file-type-verifier.md)
</dt> <dt>

[Обработчики типов файлов](fa-file-extensions.md)
</dt> <dt>

[Наблюдаемые типы](fa-perceivedtypes.md)
</dt> <dt>

[Массивы ассоциаций](fa-associationarray.md)
</dt> </dl>

 

 




