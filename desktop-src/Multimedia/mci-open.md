---
title: Команда MCI_OPEN (Ммсистем. h)
description: Команда MCI \_ Open инициализирует устройство или файл. Все устройства распознают эту команду.
ms.assetid: e2ee92b5-b10b-4408-950e-3002fe775b25
keywords:
- MCI_OPEN команды мультимедиа Windows
topic_type:
- apiref
api_name:
- MCI_OPEN
api_location:
- Mmsystem.h
api_type:
- HeaderDef
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 14d8b33e70a2e061b54260aeffc6e69432c469f5
ms.sourcegitcommit: a1494c819bc5200050696e66057f1020f5b142cb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2020
ms.locfileid: "103891397"
---
# <a name="mci_open-command"></a>\_Команда MCI Open

Команда MCI \_ Open инициализирует устройство или файл. Все устройства распознают эту команду.

Чтобы отправить эту команду, вызовите функцию [**мЦисендкомманд**](/previous-versions//dd757160(v=vs.85)) со следующими параметрами.


```C++
MCIERROR mciSendCommand(
  MCIDEVICEID wDeviceID, 
  MCI_OPEN, 
  DWORD dwFlags, 
  (DWORD) (LPMCI_OPEN_PARMS) lpOpen
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

<span id="wDeviceID"></span><span id="wdeviceid"></span><span id="WDEVICEID"></span>*вдевицеид*
</dt> <dd>

Идентификатор устройства MCI, который должен получить командное сообщение.

</dd> <dt>

<span id="dwFlags"></span><span id="dwflags"></span><span id="DWFLAGS"></span>*dwFlags*
</dt> <dd>

\_Ожидание с уведомлением MCI или MCI \_ . Дополнительные сведения об этих флагах см. [в разделе Флаги ожидания, уведомления и проверки](the-wait-notify-and-test-flags.md).

</dd> <dt>

<span id="lpOpen"></span><span id="lpopen"></span><span id="LPOPEN"></span>*лпопен*
</dt> <dd>

Указатель на структуру [**\_ \_ пармс для MCI Open**](mci-open-parms.md) . (Устройства с расширенными наборами команд могут заменить эту структуру структурой, зависящей от устройства.)

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Возвращает нуль в случае успеха или ошибку в противном случае.

## <a name="remarks"></a>Комментарии

\_ \_ Флаг открытого типа MCI должен использоваться при указании устройства в функции [**мЦисендкомманд**](/previous-versions//dd757160(v=vs.85)) . Если вы открываете устройство, указав константу типа устройства, \_ \_ \_ в дополнение к типу открытия MCI необходимо указать флаг открытого идентификатора типа MCI \_ \_ . Список констант типа устройства см. в разделе [типы устройств MCI](mci-device-types.md).

Если флаг с \_ открытым \_ общим доступом MCI не указан при первоначальном открытии устройства или файла, все последующие \_ команды MCI Open для устройства или файла завершатся ошибкой. Если устройство или файл уже открыты и этот флаг не указан, вызов завершится ошибкой, даже если первая команда открытия, заданная командой MCI, \_ открыла \_ общий доступ. Файлы, открытые для МЦИСЕК. DRV и МЦИВАВЕ. Устройства DRV не додаются совместной работе.

Регистр игнорируется в имени устройства, но не может начинаться или заканчиваться пробелами.

Чтобы использовать автоматический выбор типа (с помощью записей в реестре), назначьте имя файла и расширение файла **лпстрелементнаме** члену структуры, идентифицируемой *лпопен*, установите для элемента **лпстрдевицетипе** **значение NULL** и установите \_ \_ флаг открытия элемента MCI.

Следующие дополнительные флаги применяются ко всем устройствам, поддерживающим MCI \_ .

<dl> <dt>

<span id="MCI_OPEN_ALIAS"></span><span id="mci_open_alias"></span>\_псевдоним для открытия MCI \_
</dt> <dd>

Псевдоним включается в элемент **лпстралиас** структуры, идентифицируемой *лпопен*.

</dd> <dt>

<span id="MCI_OPEN_SHAREABLE"></span><span id="mci_open_shareable"></span>\_доступ к MCI с открытым \_ общим доступом
</dt> <dd>

Устройство или файл должны быть открыты для совместного открытия.

</dd> <dt>

<span id="MCI_OPEN_TYPE"></span><span id="mci_open_type"></span>\_тип открытия \_ MCI
</dt> <dd>

Имя типа устройства или константа включается в элемент **лпстрдевицетипе** структуры, определяемой *лпопен*.

</dd> <dt>

<span id="MCI_OPEN_TYPE_ID"></span><span id="mci_open_type_id"></span>\_идентификатор открытого \_ типа \_ MCI
</dt> <dd>

Неупорядоченное слово элемента **лпстрдевицетипе** структуры, идентифицируемой *лпопен* , содержит стандартный идентификатор типа устройства MCI, а в верхнем и обязательном варианте — порядковый номер устройства. Используйте этот флаг с \_ \_ флагом открытого типа MCI.

</dd> </dl>

Следующие дополнительные флаги применяются к составным устройствам.

<dl> <dt>

<span id="MCI_OPEN_ELEMENT"></span><span id="mci_open_element"></span>\_элемент Open \_ MCI
</dt> <dd>

Имя файла включается в элемент **лпстрелементнаме** структуры, определенной параметром *лпопен*.

</dd> <dt>

<span id="MCI_OPEN_ELEMENT_ID"></span><span id="mci_open_element_id"></span>\_идентификатор открытого \_ элемента \_ MCI
</dt> <dd>

Элемент **лпстрелементнаме** структуры, идентифицируемой *лпопен* , интерпретируется как значение **типа DWORD** и является внутренним для устройства. Используйте этот флаг с \_ \_ флагом элемента MCI Open element.

</dd> </dl>

С типом устройства **дигиталвидео** используются следующие дополнительные флаги:

<dl> <dt>

<span id="MCI_DGV_OPEN_NOSTATIC"></span><span id="mci_dgv_open_nostatic"></span>\_ДГВ MCI \_ Open \_ static
</dt> <dd>

Устройство должно уменьшить число статических (системных) цветов в палитре. Это увеличивает количество цветов, доступных для отрисовки видеопотока. Этот флаг применяется только к устройствам, которые совместно используют палитру с Windows.

</dd> <dt>

<span id="MCI_DGV_OPEN_PARENT"></span><span id="mci_dgv_open_parent"></span>\_ \_ открыть \_ родительский элемент MCI ДГВ
</dt> <dd>

Маркер родительского окна указывается в элементе **хвндпарент** структуры, определенной параметром *лпопен*.

</dd> <dt>

<span id="MCI_DGV_OPEN_WS"></span><span id="mci_dgv_open_ws"></span>MCI \_ ДГВ \_ Open \_ WS
</dt> <dd>

Стиль окна указывается в элементе **двстиле** структуры, определенной параметром *лпопен*.

</dd> <dt>

<span id="MCI_DGV_OPEN_16BIT"></span><span id="mci_dgv_open_16bit"></span>MCI \_ ДГВ \_ открыть \_ 16-разрядный
</dt> <dd>

Указывает предпочитаемый параметр для поддержки 16-разрядных устройств MCI.

</dd> <dt>

<span id="MCI_DGV_OPEN_32BIT"></span><span id="mci_dgv_open_32bit"></span>\_ДГВ MCI \_ открыть \_ 32-разрядное
</dt> <dd>

Указывает параметры поддержки 32-разрядного устройства MCI.

</dd> </dl>

Для устройств с цифровыми видео параметр *лпопен* указывает на структуру [**MCI \_ ДГВ \_ Open \_ пармс**](/windows/desktop/api/Digitalv/ns-digitalv-mci_dgv_open_parmsa) Structure.

Для типа устройства **наложения** используются следующие дополнительные флаги:

<dl> <dt>

<span id="MCI_OVLY_OPEN_PARENT"></span><span id="mci_ovly_open_parent"></span>\_ \_ открыть \_ родительский элемент MCI овли
</dt> <dd>

Маркер родительского окна указывается в элементе **хвндпарент** структуры, определенной параметром *лпопен*.

</dd> <dt>

<span id="MCI_OVLY_OPEN_WS"></span><span id="mci_ovly_open_ws"></span>MCI \_ овли \_ Open \_ WS
</dt> <dd>

Стиль окна указывается в элементе **двстиле** структуры, определенной параметром *лпопен*. Значение **двстиле** задает стиль окна, который будет создан драйвером и отображаемый, если приложение не предоставляет его. Параметр Style принимает целое число, определяющее стиль окна. Эти константы совпадают со стандартными стилями окна (например \_ , вложенным меню WS, WS \_ ОВЕРЛАППЕДВИНДОВ или WS \_ ).

</dd> </dl>

Для устройств с наложением параметр *лпопен* указывает на структуру [**MCI \_ овли \_ Open \_ пармс**](mci-ovly-open-parms.md) Structure.

С типом устройства **вавеаудио** используется следующий дополнительный флаг:

<dl> <dt>

<span id="MCI_WAVE_OPEN_BUFFER"></span><span id="mci_wave_open_buffer"></span>\_ \_ Открытый буфер MCI \_ Wave
</dt> <dd>

Длина буфера указана в элементе **двбуфферсекондс** структуры, определенной параметром *лпопен*.

</dd> </dl>

Для устройств с аудио-волнами параметр *лпопен* указывает на структуру [**MCI \_ Wave \_ Open \_ пармс**](mci-wave-open-parms.md) . Драйвер МЦИВАВЕ требует наличия асинхронного устройства аудио-сигнала.

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows 2000 Professional \[только классические приложения\]<br/>                                                |
| Минимальная версия сервера<br/> | Windows 2000 Server \[только классические приложения\]<br/>                                                      |
| Заголовок<br/>                   | <dl> <dt>Ммсистем. h (включение Windows. h)</dt> </dl> |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[MCI](mci.md)
</dt> <dt>

[Команды MCI](mci-commands.md)
</dt> </dl>

 

