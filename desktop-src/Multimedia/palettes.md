---
title: Палитр
description: Палитр
ms.assetid: ee048f9a-3036-40dc-a6d7-f612b9ef767c
keywords:
- Дравдиб, палитры
- Функция Дравдибреализе
- Функция Дравдибдрав
- Функция Дравдибсетпалетте
- Функция Дравдибжетпалетте
- Функция Дравдибчанжепалетте
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3db474a9e983c442f21fd479342ac8b0786719f36f1494e307154c6cc0a0bd50
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119893024"
---
# <a name="palettes"></a>Палитр

Для функций Дравдиб требуется, чтобы приложение отвечало на два сообщения, ориентированные на палитру: [**WM \_ Куериневпалетте**](/windows/desktop/gdi/wm-querynewpalette) и [**WM \_ палеттечанжед**](/windows/desktop/gdi/wm-palettechanged). Если приложение не поддерживает палитру, необходимо добавить обработчик для каждого из этих сообщений. Дополнительные сведения об обработке сообщений **WM \_ Куериневпалетте** и **WM \_ Палеттечанжед** см. в разделе [Добавление обработчиков сообщений для палитры](adding-palette-message-handlers.md).

Вы можете реализовать текущую палитру Дравдиб для контроллера домена с помощью функции [**дравдибреализе**](/windows/desktop/api/Vfw/nf-vfw-drawdibrealize) . Необходимо реализовать палитру в ответ на сообщение [**WM \_ Куериневпалетте**](/windows/desktop/gdi/wm-querynewpalette) или [**WM \_ палеттечанжед**](/windows/desktop/gdi/wm-palettechanged) или при подготовке к отображению последовательности изображений с помощью функции [**дравдибдрав**](/windows/desktop/api/Vfw/nf-vfw-drawdibdraw) .

Изображение, сопоставленное с другой палитрой, можно нарисовать с помощью функции [**дравдибсетпалетте**](/windows/desktop/api/Vfw/nf-vfw-drawdibsetpalette) . Эта функция заставляет Дравдиб DC использовать указанную палитру, которая может повлиять на качество изображения. Например, приложение, которое поддерживает палитру, может быть реализовано в виде палитры и должно препятствовать реализации собственной палитры Дравдиб. Приложение может использовать **дравдибсетпалетте** для уведомления дравдиб используемой палитры.

Вы можете получить маркер текущей основной палитры с помощью функции [**дравдибжетпалетте**](/windows/desktop/api/Vfw/nf-vfw-drawdibgetpalette) . Если приложение использует текущую палитру переднего плана, оно не имеет монопольного использования палитры, а другое приложение может сделать недействительным маркер палитры. Приложение не должно освобождать палитру по завершении ее использования. Освобождение палитры может сделать недействительным маркер палитры для другого приложения.

Вы можете подготовить Дравдиб для получения новых значений цвета для палитры с помощью функции [**дравдибчанжепалетте**](/windows/desktop/api/Vfw/nf-vfw-drawdibchangepalette) . В коде, приведенном ниже **дравдибчанжепалетте**, вы назначаете новые значения для таблицы цветов палитры. Если флаг **\_ анимации DDF** не установлен в дравдиб DC при вызове **дравдибчанжепалетте**, можно применить изменения палитры с помощью [**дравдибреализе**](/windows/desktop/api/Vfw/nf-vfw-drawdibrealize) , чтобы реализовать палитру. Затем можно использовать [**дравдибдрав**](/windows/desktop/api/Vfw/nf-vfw-drawdibdraw) для перерисовки изображения. Если в Дравдиб DC установлен флаг **\_ анимации DDF** , можно анимировать палитру и цвета отображаемого растрового изображения с помощью **дравдибдрав** или **дравдибреализе**. Флаг **\_ анимации DDF** можно обновить с помощью функций [**дравдибенд**](/windows/desktop/api/Vfw/nf-vfw-drawdibend) и [**дравдиббегин**](/windows/desktop/api/Vfw/nf-vfw-drawdibbegin) .

> [!Note]  
> Если вы освободите палитру Дравдиб, пока она выбрана контроллером домена, то при использовании этой палитры контроллер домена может вызвать ошибку интерфейса графических устройств (GDI). Вместо этого приложение должно использовать [**дравдибсетпалетте**](/windows/desktop/api/Vfw/nf-vfw-drawdibsetpalette) , чтобы изменить дравдиб DC для использования палитры по умолчанию или другой палитры.

 

Функции [**дравдибенд**](/windows/desktop/api/Vfw/nf-vfw-drawdibend), [**дравдибклосе**](/windows/desktop/api/Vfw/nf-vfw-drawdibclose)и [**Дравдиббегин**](/windows/desktop/api/Vfw/nf-vfw-drawdibbegin) могут освободить палитру дравдиб. Однако эти функции следует использовать только в том случае, если эта палитра не была выбрана контроллером домена. Функция Дравдибдрав также может освободить палитру, если она использует тот же Дравдиб контроллер домена, но определяет различные параметры рисования (*лпби*, *дксдст*, *дидст*, *дкссрк* или *дисрк*) или другой формат.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Рендеринг изображений](image-rendering.md)
</dt> </dl>

 

 