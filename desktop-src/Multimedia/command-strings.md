---
title: Командные строки
description: Командные строки
ms.assetid: ca9ca153-f2bf-45ed-84e6-44e86e8efaed
keywords:
- Строки команд MCI, сведения
- Строки команд MCI, синтаксис
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8b62013abff091f668a3b045e9f3ca2e8745f0d9
ms.sourcegitcommit: 9eebab0ead09cecdbc24f5f84d56c8b6a7c22736
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/10/2021
ms.locfileid: "124371601"
---
# <a name="command-strings"></a>Командные строки

Чтобы отправить командную строку на устройство MCI, используйте функцию [**mciSendString**](/previous-versions//dd757161(v=vs.85)) , которая включает параметры для команды String и буфер для любых возвращаемых сведений.

Функция **mciSendString** возвращает нуль в случае успеха. Если функция завершается ошибкой, в слове с низким порядком возвращаемого значения содержится код ошибки. Этот код ошибки можно передать функции [**мЦижетеррорстринг**](/previous-versions//dd757158(v=vs.85)) , чтобы получить текстовое описание ошибки.

## <a name="syntax-of-command-strings"></a>Синтаксис командных строк

В строках команд MCI используется единообразный синтаксис модификатора глагола-Object. Каждая Командная строка содержит команду, идентификатор устройства и аргументы команды. Аргументы являются необязательными для некоторых команд и являются обязательными для других.

Командная строка имеет следующий вид:

*аргументы идентификатора устройства командной строки \_*

Эти компоненты содержат следующие сведения:

-   *Команда* ОТОБРАЖАЕТ команду MCI, например [**Open**](open.md), [**Close**](close.md)или [**Play**](play.md).
-   *\_ Идентификатор устройства* определяет экземпляр драйвера MCI. *\_ Идентификатор устройства* создается при открытии устройства.
-   *Аргументы* задают флаги и переменные, используемые командой. Флаги — это ключевые слова, распознаваемые командой MCI. Переменные — это числа или строки, которые применяются к команде или флагу MCI.

    Например, команда **Play** использует аргументы «от *позиции* » и «to *position* » для указания позиций, с которых начинается и заканчивается воспроизведение. Вы можете перечислить флаги, используемые командой, в любом порядке. При использовании флага, связанного с переменной, необходимо указать значение для переменной.

    Неуказанные (и необязательные) аргументы команды предполагают значение по умолчанию.

Следующий пример функции отправляет команду [**Play**](play.md) с флагами "from" и "to".


```C++
BOOL PlayFromTo(LPTSTR lpstrAlias, DWORD dwFrom, DWORD dwTo) 
{ 
    TCHAR achCommandBuff[128]; 
    int result;
    MCIERROR err;

    // Form the command string.
    result = _stprintf_s(
        achCommandBuff, 
        TEXT("play %s from %u to %u"), 
        lpstrAlias, dwFrom, dwTo); 

    if (result == -1)
    {
        return FALSE;
    }

    // Send the command string.
    err = mciSendString(achCommandBuff, NULL, 0, NULL); 
    if (err != 0)
    {
        return FALSE;
    }

    return TRUE;
} 
```



## <a name="data-types-for-command-variables"></a>Типы данных для переменных команд

В командной строке можно использовать следующие типы данных для переменных.



| **Data type**        | **Описание**                                                                                                                                                                                                                                                                                                                                                |
|----------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Строки              | Типы строковых данных разделяются начальными и конечными пробелами и кавычками. MCI удаляет одинарные кавычки из строки. Чтобы вставить кавычки в строку, используйте набор из двух кавычек, где нужно внедрить кавычки. Чтобы использовать пустую строку, используйте двойные кавычки, разделенные начальными и конечными пробелами. |
| Длинные целые числа со знаком | Типы данных, подписанные длинными целыми числами, разделяются начальными и конечными пробелами. Если не указано иное, целые числа могут быть положительными или отрицательными. Если используются отрицательные целые числа, не следует разделять знак "минус" и первую цифру пробелом.                                                                                                    |
| Прямоугольники           | Типы данных Rectangle представляют собой упорядоченный список из четырех коротких значений со знаком. Пробел отделяет этот тип данных и разделяет каждое целое число в списке.                                                                                                                                                                                                              |



 

 

 