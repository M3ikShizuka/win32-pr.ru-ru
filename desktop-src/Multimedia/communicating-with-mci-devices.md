---
title: Взаимодействие с устройствами MCI
description: Взаимодействие с устройствами MCI
ms.assetid: 2408f8e4-d040-40f5-a880-1ecb8025656c
keywords:
- Макрос МЦивндсендстринг
- Функция mciSendString
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8f7f5458cff0ef4c5c5f84e565fae06ade8796c4
ms.sourcegitcommit: 9eebab0ead09cecdbc24f5f84d56c8b6a7c22736
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/10/2021
ms.locfileid: "124372096"
---
# <a name="communicating-with-mci-devices"></a>Взаимодействие с устройствами MCI

Драйвер каждого устройства MCI поддерживает список текущих параметров и возможностей, поэтому он может выдавать точный ответ при запросе информации.

При необходимости взаимодействия с устройством MCI можно использовать макросы и функции МЦивнд. Многие из наиболее распространенных команд и запросов MCI определяются как макросы. Однако если задача, которую требуется выполнить, недоступна в качестве функции или макроса, команды MCI можно отправить непосредственно в драйвер устройства с помощью макроса [**мЦивндсендстринг**](/windows/desktop/api/Vfw/nf-vfw-mciwndsendstring) или формы сообщения или строки команд MCI. Использование макроса **мЦивндсендстринг** эквивалентно использованию функции [**mciSendString**](/previous-versions//dd757161(v=vs.85)) следующим образом:


```C++
mciSendString(sz, Null, 0, Null) 
```



Параметры [**мЦивндсендстринг**](/windows/desktop/api/Vfw/nf-vfw-mciwndsendstring) включают только обработчик окна и строковое форму команды. Чтобы получить сведения, возвращенные строковой командой, используйте макрос [**мЦивндретурнстринг**](/windows/desktop/api/Vfw/nf-vfw-mciwndreturnstring) .

Дополнительные сведения о MCI см. в разделе [MCI](mci.md).

> [!Note]  
> При использовании **мЦивндсендстринг** необходимо исключить псевдоним устройства из команды MCI. Библиотека МЦивнд добавляет этот псевдоним при отправке команды устройству MCI.

 

 

 