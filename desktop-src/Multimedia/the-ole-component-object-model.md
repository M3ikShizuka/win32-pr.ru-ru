---
title: Объектная модель OLE Component
description: Объектная модель OLE Component
ms.assetid: f3200d81-c2fa-4cc7-bf85-54f6c753a529
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 211c41de8c16eb1cabb1e62f475adbbf603e2c92
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127260672"
---
# <a name="the-ole-component-object-model"></a>Объектная модель OLE Component

Объекты, используемые библиотекой Авифиле, являются частью модели объектов OLE Component. В основном это означает, что они совместно используют определенные методы, упрощающие работу с, и возвращаемые ими значения являются общими для большинства методов интерфейса OLE.

Объектная модель компонента OLE обработчиков файлов и потоков использует интерфейс OLE **IClassFactory** для создания экземпляров класса объектов. Как объекты компонентов, они реализуют интерфейс [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) , который состоит из методов [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(refiid_void)), [**Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release)и [**AddRef**](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) . Интерфейс **IUnknown** позволяет приложению получать указатели на другие интерфейсы, поддерживаемые одним и тем же объектом.

Можно определить, поддерживает ли объект определенный интерфейс с помощью метода **QueryInterface** . Если объект поддерживает указанный интерфейс, **QueryInterface** возвращает указатель на этот интерфейс.

Счетчик ссылок, связанный с объектом, можно увеличить и уменьшить с помощью методов [**AddRef**](/previous-versions//dd757100(v=vs.85)) и [**Release**](/previous-versions//dd757102(v=vs.85)) . Счетчик ссылок позволяет нескольким клиентам обращаться к объекту. Если объект используется в первом приложении, его счетчик ссылок устанавливается в значение 1. В дальнейшем приложения используют метод **AddRef** для увеличения числа, что позволяет объекту отследить количество обращений к нему.

Когда приложение выполняется с помощью объекта, оно вызывает метод **Release** для уменьшения числа ссылок. Если счетчик ссылок равен нулю, объект больше не нужен и освобождает все используемые им **ресурсы и уничтожает** объект. Поскольку объект использует внутренние ресурсы, прозрачные для приложения, объект отвечает за их освобождение. Например, обработчику файла может потребоваться закрыть открытые файлы на диске и освободить буфер памяти при освобождении.

Большинство методов интерфейса OLE возвращают дескрипторы результатов, определенные с помощью типа данных **HRESULT** . Этот тип данных состоит из кода серьезности, контекстной информации, кода средства и кода состояния. Возвращаемый результат, который указывает, что Success имеет нулевое значение. Ненулевое значение указывает на сбой, а элемент кода состояния возвращаемого результата представляет собой базу для дополнительной интерпретации. Дополнительные сведения о возможностях возвращаемых дескрипторов OLE см. в *справочнике по программированию OLE*.

 

 