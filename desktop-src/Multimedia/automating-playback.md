---
title: Автоматизация воспроизведения
description: Автоматизация воспроизведения
ms.assetid: 3aa05a54-58d7-4d14-93ee-459aa860b20e
keywords:
- Макрос МЦивндкреате
- Макрос МЦивндплай
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ad1c05041bade08f47505a2cf1207739777c5af825ea9f5f300b343b87efe3c7
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119691974"
---
# <a name="automating-playback"></a>Автоматизация воспроизведения

Вы можете автоматизировать воспроизведение в приложении с помощью [**мЦивндкреате**](/windows/desktop/api/Vfw/nf-vfw-mciwndcreatea) и макроса [**мЦивндплай**](/windows/desktop/api/Vfw/nf-vfw-mciwndplay) , а также [**мЦивнддестрой**](/windows/desktop/api/Vfw/nf-vfw-mciwnddestroy) или макроса [**мЦивндклосе**](/windows/desktop/api/Vfw/nf-vfw-mciwndclose) . Чтобы автоматизировать воспроизведение, укажите стили МЦИВНДФ \_ ноплайбар и мЦивндф \_ нотифимоде в параметре **мЦивндкреате**_двстиле_ . Укажите стиль МЦИВНДФ \_ ноплайбар, чтобы скрыть панель инструментов, и стиль мЦивндф \_ нотифимоде, чтобы выдать соответствующее сообщение уведомления при прекращении воспроизведения устройства.

Устройство или файл, указанный в **мЦивндкреате** , можно воспроизвести с помощью **мЦивндплай**. Макрос МЦивндплай начинает воспроизводить содержимое из текущего расположения воспроизведения и переходит к его концу.

Можно уничтожить или закрыть окно МЦивнд с помощью макроса [**мЦивнддестрой**](/windows/desktop/api/Vfw/nf-vfw-mciwnddestroy) или [**мЦивндклосе**](/windows/desktop/api/Vfw/nf-vfw-mciwndclose) . Макрос **мЦивнддестрой** закрывает устройство или файл и уничтожает окно мЦивнд путем аннулирования его обработчика. Если приложение может повторно использовать окно МЦивнд, используйте **мЦивндклосе** , чтобы закрыть устройство, не уничтожая окно.

Приложение может определить, когда устройство перестает воспроизводиться, и автоматически закрывать окно. Для этого укажите \_ стиль мЦивндф нотифимоде для параметра *двстиле* [**мЦивндкреате**](/windows/desktop/api/Vfw/nf-vfw-mciwndcreatea). Это приводит к тому, что устройство отправляет сообщение [**мЦивндм \_ нотифимоде**](mciwndm-notifymode.md) при каждом изменении режима. Приложение может перехватить это сообщение, чтобы определить, завершилось ли воспроизведение устройства. Когда устройство перестает воспроизводиться, приложение закрывает окно.

 

 




