---
title: Чтение из потока
description: Чтение из потока
ms.assetid: be961f06-cf5f-4093-9b31-7d1d69e62fec
keywords:
- Функция Авистреаминфо
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3cc7ecd606a33503557e7c7209bff68015756523
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "103987507"
---
# <a name="reading-from-a-stream"></a>Чтение из потока

Сведения о открытом потоке можно получить с помощью функции [**авистреаминфо**](/windows/desktop/api/Vfw/nf-vfw-avistreaminfoa) . Эта функция заполняет структуру [**авистреаминфо**](/windows/desktop/api/Vfw/ns-vfw-avistreaminfoa) данными, такими как тип данных в потоке, метод сжатия, используемый при записи потоковых данных, рекомендуемый размер буфера, скорость воспроизведения и текстовое описание потока.

Некоторые элементы структуры [**авистреаминфо**](/windows/desktop/api/Vfw/ns-vfw-avistreaminfoa) также существуют в структуре [**авифилеинфо**](/windows/desktop/api/Vfw/ns-vfw-avifileinfoa) . Сведения в структуре **авифилеинфо** применяются ко всему файлу. Сведения в структуре **авистреаминфо** относятся к потоку, доступному для доступа, и имеют приоритет над сведениями в структуре **авифилеинфо** .

Если с потоком связаны дополнительные сведения, эти сведения можно получить с помощью функции [**авистреамреаддата**](/windows/desktop/api/Vfw/nf-vfw-avistreamreaddata) . Эта функция возвращает сведения в буфер, предоставляемый приложением. Дополнительные сведения о потоке могут включать параметры конфигурации для методов сжатия и распаковки, используемых в потоке. Требуемый размер буфера можно получить с помощью макроса [**авистреамдатасизе**](/windows/desktop/api/Vfw/nf-vfw-avistreamdatasize) .

Сведения о форматировании потока можно получить с помощью функции [**авистреамреадформат**](/windows/desktop/api/Vfw/nf-vfw-avistreamreadformat) . Эта функция возвращает структуру, относящуюся к потоку, в буфер, предоставляемый приложением. Для потока видео буфер содержит сведения о форматировании в структуре [**битмапинфо**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfo) . Для аудиопотока в буфере содержатся сведения о форматировании в структуре [**вавеформатекс**](/windows/win32/api/mmeapi/ns-mmeapi-waveformatex) или [**пкмвавеформат**](/windows/win32/api/mmreg/ns-mmreg-pcmwaveformat) . Для других типов потоков обработчик потока возвращает сведения, относящиеся к потоку. Требуемый размер буфера можно определить с помощью **авистреамреадформат** и указав **пустой** адрес буфера или с помощью макроса [**авистреамформатсизе**](/windows/desktop/api/Vfw/nf-vfw-avistreamformatsize) .

Содержимое мультимедиа можно получить в потоке с помощью функции [**авистреамреад**](/windows/desktop/api/Vfw/nf-vfw-avistreamread) . Эта функция копирует необработанные данные из потока в предоставляемый приложением буфер. Для видеопотоков эта функция получает растровые изображения, составляющие содержимое фрейма. Для звуковых потоков эта функция получает образцы аудио-звука, которые составляют звуковое содержимое. Требуемый размер буфера можно определить с помощью **авистреамреад** и указав **пустой** адрес буфера или с помощью макроса [**авистреамсамплесизе**](/windows/desktop/api/Vfw/nf-vfw-avistreamsamplesize) .

Некоторые обработчики потока AVI представляют задержки, связанные с инициализацией программного обеспечения и оборудованием или координацией. Эти обработчики можно сообщить, чтобы подготовиться к потоковой передаче данных с помощью функции [**авистреамбегинстреаминг**](/windows/desktop/api/Vfw/nf-vfw-avistreambeginstreaming) . Эта функция позволяет обработчику потока выделять и инициализировать необходимые ресурсы. Чтобы проинформировать эти обработчики о завершении потоковой передачи, используйте функцию [**авистреамендстреаминг**](/windows/desktop/api/Vfw/nf-vfw-avistreamendstreaming) . Эта функция позволяет обработчику потока освобождать ресурсы, выделенные для **авистреамбегинстреаминг**.

Функция [**авистреамреад**](/windows/desktop/api/Vfw/nf-vfw-avistreamread) не предоставляет службы распаковки. Сведения о сжатии и распаковке звуковых потоков см. в разделе [Диспетчер аудиосжатия](audio-compression-manager.md). Сведения о сжатии и распаковке видеопотоков см. в разделе [Диспетчер сжатия видео](video-compression-manager.md). Сведения о сжатии и распаковке отдельных кадров в видеопотоке см. в разделе [Работа с сжатыми видео-данными в потоке](working-with-compressed-video-data-in-a-stream.md).

## <a name="related-topics"></a>См. также

<dl> <dt>

[Потоковые операции](stream-operations.md)
</dt> </dl>

 

 