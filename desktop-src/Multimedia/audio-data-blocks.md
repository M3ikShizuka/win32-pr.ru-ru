---
title: Звуковые блоки данных
description: Звуковые блоки данных
ms.assetid: 9646e18c-294b-4532-bd5e-709d66ad31f4
keywords:
- мультимедийные аудио, блоки данных
- звук, блоки данных
- звуковая волна, блоки данных
- блоки звуковых данных, сведения
- Структура ВАВЕХДР
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d8a81a5a29ec9718e7c11306b6bafc1aa20369e5
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "103987396"
---
# <a name="audio-data-blocks"></a>Звуковые блоки данных

Функции [**вавеинаддбуффер**](/windows/win32/api/mmeapi/nf-mmeapi-waveinaddbuffer) и [**вавеаутврите**](/windows/win32/api/mmeapi/nf-mmeapi-waveoutwrite) нуждаются в том, чтобы приложения выделили блоки данных для передачи в драйверы устройств для записи или воспроизведения. Обе эти функции используют структуру [**вавехдр**](/windows/win32/api/mmeapi/ns-mmeapi-wavehdr) для описания своего блока данных.

Перед использованием одной из этих функций для передачи блока данных в драйвер устройства необходимо выделить память для блока данных и структуру заголовка, описывающую блок данных. Заголовки можно подготавливать и подготавливать с помощью следующих функций.



| Функция                                                 | Описание                                                      |
|----------------------------------------------------------|------------------------------------------------------------------|
| [**вавеинпрепарехеадер**](/windows/win32/api/mmeapi/nf-mmeapi-waveinprepareheader)       | Подготавливает блок входных данных звуковой волны.                      |
| [**вавеинунпрепарехеадер**](/windows/win32/api/mmeapi/nf-mmeapi-waveinunprepareheader)   | Очищает подготовку к блоку входных данных звуковой волны.  |
| [**вавеаутпрепарехеадер**](/windows/win32/api/mmeapi/nf-mmeapi-waveoutprepareheader)     | Подготавливает блок выходных данных волны-Audio.                     |
| [**вавеаутунпрепарехеадер**](/windows/win32/api/mmeapi/nf-mmeapi-waveoutunprepareheader) | Очищает подготовку к выходному блоку выходных данных звуковой волны. |



 

Перед передачей блока звуковых данных в драйвер устройства необходимо подготовить блок данных, передав его в [**вавеинпрепарехеадер**](/windows/win32/api/mmeapi/nf-mmeapi-waveinprepareheader) или [**вавеаутпрепарехеадер**](/windows/win32/api/mmeapi/nf-mmeapi-waveoutprepareheader). Когда драйвер устройства завершает работу с блоком данных и возвращает его, необходимо очистить эту подготовку, передав блок данных в [**вавеинунпрепарехеадер**](/windows/win32/api/mmeapi/nf-mmeapi-waveinunprepareheader) или [**вавеаутунпрепарехеадер**](/windows/win32/api/mmeapi/nf-mmeapi-waveoutunprepareheader) , прежде чем можно будет освободить выделенную память.

Если входные и выходные данные аудио-сигнала недостаточны для появления в одном блоке данных, приложения должны постоянно предоставлять драйверы устройств блоками данных до завершения воспроизведения или записи.

Даже если используется один блок данных, приложение должно иметь возможность определить, завершена ли работа драйвера устройства с блоком данных, чтобы приложение могло освободить память, связанную с блоком данных и структурой заголовков. Существует несколько способов определения завершения работы драйвера устройства с блоком данных.

-   Указание функции обратного вызова для получения сообщения, отправленного драйвером после завершения работы с блоком данных
-   С помощью обратного вызова события
-   Указание окна или потока для получения сообщения, отправленного драйвером после завершения работы с блоком данных
-   Путем опроса бита ВХДР \_ done в члене **DwFlags** структуры [**вавехдр**](/windows/win32/api/mmeapi/ns-mmeapi-wavehdr) , отправленной с каждым блоком данных

Если приложение не получает блок данных к драйверу устройства при необходимости, может воздержаться звуковой зазор при воспроизведении или потери входящей записанной информации. Для этого требуется по крайней мере один блок данных с двойной буферизацией, в котором впереди драйвер устройства.

В следующих разделах описаны способы определения завершения работы драйвера устройства с блоком данных.

Использование функции обратного вызова для обработки сообщений драйвера

-   [Использование функции обратного вызова для обработки сообщений драйвера](using-a-callback-function-to-process-driver-messages.md)
-   [Использование обратного вызова события для обработки сообщений драйвера](using-an-callback-to-process-driver-messages.md)
-   [Использование окна или потока для обработки сообщений драйвера](using-a-window-or-thread-to-process-driver-messages.md)
-   [Управление блоками данных путем опроса](managing-data-blocks-by-polling.md)

 

 