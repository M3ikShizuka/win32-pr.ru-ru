---
title: Службы ВИДЕОМАГНИТОФОНА
description: Службы ВИДЕОМАГНИТОФОНА
ms.assetid: 140220f7-df7b-46e2-8374-e1200d873f3b
keywords:
- Архитектура системы управления видео (ВИСКА)
- ВИСКА (архитектура управления видеоподсистемой)
- Драйвер MCI ВИСКА
- Драйвер ВИСКА
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 77d884c38d224182db7eef8db0f0cd80b14e3a08
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "103888787"
---
# <a name="vcr-services"></a>Службы ВИДЕОМАГНИТОФОНА

Windows предоставляет службы ВИДЕОМАГНИТОФОНА через драйвер устройства, основанный на наборе команд MCI для видеомагнитофонов. В этом разделе описывается драйвер ВИСКА (архитектура управления видеосистемой MCI) и объясняется, как использовать его для управления ВИДЕОМАГНИТОФОНА.

Тип устройства *видеомагнитофона* управляет видеомагнитофонами. Список команд MCI, распознаваемых устройствами ВИДЕОМАГНИТОФОНА, см. в разделе [набор команд видеомагнитофона](vcr-command-set.md).

## <a name="the-mci-visca-driver"></a>Драйвер MCI ВИСКА

Драйвер MCI ВИСКА управляет видеомагнитофоном, совместимым с ВИСКА, например КВД-1000 Вдекк. Драйвер ВИСКА управляет транспортировкой ленты, тюнерами каналов и входными и выходными каналами ВИДЕОМАГНИТОФОНА.

## <a name="searching-and-positioning-with-a-vcr"></a>Поиск и позиционирование с помощью ВИДЕОМАГНИТОФОНА

Драйвер ВИСКА использует два метода для мониторинга движения видеокассет в пределах ленты ВИДЕОМАГНИТОФОНА: *сведения о* времени и *счетчики ленты*. Сведения о времени выполнения — это сведения о синхронизации, записанные на видеокассете. Большинство видеомагнитофонов позволяют записывать коды времени без разрушения аудио и видеодорожек. Счетчики ленты оценивают объем видеокассеты, которая перемещается за пределы заголовка видеокассеты для получения позиции.

Сведения о времени и счетчиках ленты увеличиваются по мере перемещения ленты с начала до конца. Из-за его точности использование данных с кодом времени для размещения видеокассет практически всегда предпочтительнее использования счетчиков ленты.

Флаги команды MCI для указания сведений о размещении выражаются в виде зависимостей времени: "формат времени", "Длительность", "от", "до" и "Поиск". (Кроме того, команда [**Status**](status.md) "позиционировать" возвращает значение времени в текущем формате времени.)

Драйвер ВИСКА использует команду " [**задать**](set.md) режим времени" для выбора типа позиционирования, используемого с видеокассетой. Если для режима времени задано значение "Time", в командах **состояния** "расположение" и " **задать** формат времени" используется время на ленте. Если для режима времени задано значение "Counter", в командах **состояния** "расположение" и " **задать** формат времени" используются счетчики.

Приложение может задать для режима времени значение "обнаружить", если не имеет значения, что может быть два источника сведений о положении. В режиме обнаружения драйвер ВИСКА использует сведения о времени выполнения для позиционирования при выполнении любого из следующих условий.

-   При открытии драйвера выдается информация о времени.
-   Видеокассету можно изменить **с помощью команды "открыть** дверцу" и сведений о времени на ленте.
-   Команда [**установки**](set.md) режима времени выдается повторно.

Если не удается найти сведения о времени, драйвер использует счетчики ленты.

Чтобы определить текущий метод позиционирования, выдайте команду [**состояния**](status.md) "Time Type", которая возвращает значение "время начала" или "Счетчик". Можно также определить текущий режим позиционирования, используя команду **состояния** "Time Mode", которая возвращает "код времени", "Счетчик" или "Обнаружение".

Команда "Counter" **состояния** получает текущее значение счетчика ленты, независимо от текущего метода позиционирования. Однако этот счетчик можно использовать только с командой [**Set**](set.md) "Counter".

Драйвер ВИСКА может получить собственный формат времени в формате времени, записанный на видеокассете, используя **состояние** "тип кода времени" и команды **состояния** "частота кадров" вместе. Например, если тип кода времени — "SMPTE", а частота кадров — 25, собственный формат времени, записанный на ленте, — SMPTE 25.

Драйвер ВИСКА также может получить разрешение счетчиков с помощью команды **Status** "разрешение счетчика", которая возвращает "секунды" или "кадры". Формат счетчика может быть по-прежнему установлен равным SMPTE 30, но возвращаемое значение возвращает только кадр, равный 0. Если текущий тип времени — Counter, то это разрешение также применяется к значению, возвращенному **состоянием** "расположение".

## <a name="capturing-frames"></a>Запись кадров

Команды захвата кадров обеспечивают все еще изображения для *устройства записи кадров*. Устройство записи кадров — это отдельный компонент оборудования, который способен читать и сохранять видеоизображение. Драйвер ВИСКА поддерживает команду [**Freeze**](freeze.md) ([**\_ замораживание MCI**](mci-freeze.md)), чтобы стабилизировать все изображение для записи. Кроме того, для перезапуска ленточного транспорта с помощью команды **Freeze** можно использовать команду [**unfreeze**](unfreeze.md) ([**\_ незамораживания MCI**](mci-unfreeze.md)).

Команда **заморозить** высококачественное, исправленное, измененное по времени изображение для устройства записи кадров. Эта команда существует, так как устройство может не всегда доставлять свои выходные изображения максимального качества во время воспроизведения или при приостановке; такой образ видео не подходит для записи.

Команда **unfreeze** разблокирует транспорт ленты и возобновляет транспортный режим в силе перед выполнением команды **Freeze** .

Когда приложению необходимо записать видеоизображение на ВИДЕОМАГНИТОФОН, используйте команду **заморозить** входные данные или команду [**Cue**](cue.md) (элемент [**MCI \_ Cue**](mci-cue.md)) для записи изображения.

## <a name="selecting-inputs"></a>Выбор входных данных

Драйвер ВИСКА поддерживает три типа входных данных: видео, аудио и код времени. Входные видеозаписи включают два стандартных канала (строки 1 и 2), канал Свидео, вспомогательный канал и канал из внутреннего тюнера. Входные аудио-файлы включают два стандартных канала (линии 1 и 2) и канал из внутреннего тюнера. Ввод кода времени является внутренним для ВИДЕОМАГНИТОФОНА.

Обычные выходные данные содержат выбранные входные данные при записи ВИДЕОМАГНИТОФОНА или при остановке транспорта ленты, а также содержат содержимое видеокассеты при воспроизведении или приостановке транспорта ленты. Наблюдаемые выходные данные содержат те же сведения, что и обычные выходные данные, а также текущий код времени и сведения о канале.

При условии, что соответствующие внешние входные данные подключены к видеомагнитофону и вы решили, что хотите записать, можно выбрать входные данные для записи. Например, для записи или просмотра видео "свидео" и входных данных "Line 1" можно использовать команды [**сетвидео**](setvideo.md) ([**MCI \_ сетвидео**](mci-setvideo.md)) и [**сетаудио**](setaudio.md) ([**MCI \_ сетаудио**](mci-setaudio.md)) для выбора этих источников входных данных. Эти параметры можно проверить с помощью команды [**состояние**](status.md) ([**\_ состояние MCI**](mci-status.md)).

По умолчанию монитор отображает именно то, что отображается в качестве выходных данных. Однако иногда может потребоваться просмотреть один источник при записи из другого. Это распространенная практика использования тюнера. Например, при записи канала 7 может потребоваться просмотреть канал 4. В этом случае у вас есть два логических входа тюнера. Вы можете настроить ВИДЕОМАГНИТОФОН с помощью следующих команд:

## <a name="to-review-one-source-while-recording-from-another"></a>Проверка одного источника при записи из другого

1.  Используйте команду [**сеттунер**](settuner.md) ([**MCI \_ сеттунер**](mci-settuner.md)), чтобы выбрать каналы для просмотра и записи.
2.  Чтобы выбрать источник видеозаписи, используйте команду **сетвидео** .
3.  Чтобы выбрать источник звукозаписи, используйте команду [**сетаудио**](setaudio.md) .
4.  Используйте команду [**сетвидео**](setvideo.md) , чтобы направить входные видеоданные канала 4 в отслеживаемые выходные данные, чтобы отобразить его на экране.
5.  Используйте команду [**сетаудио**](setaudio.md) для направления входных данных канала 4 в отслеживаемые выходные данные для воспроизведения звука.
6.  Проверьте правильность выбора с помощью команды [**Status**](status.md) .

Драйвер ВИСКА также поддерживает Специальный тип ввода для аудио и видео с именем « *выкл*.». Отключить звук, что можно использовать при записи пустого сигнала.

## <a name="selecting-recording-tracks"></a>Выбор записи дорожек

На ленте существуют три типа дорожек: видео, аудио и временные метки. У вас есть только один видеофайл или временной код, но можно использовать несколько звуковых дорожек. При этом следует дорожку 1 основной звуковой дорожки.

Драйвер ВИСКА поддерживает два режима работы: сборка и вставка. В *режиме сборки* выбраны все дорожки для записи. В *режиме вставки* дорожки могут быть выбраны независимо для записи. По умолчанию большинство видеомагнитофонов находятся в режиме сборки. Чтобы изменить эти режимы, используйте команду [**Set**](set.md) ([**MCI \_ Set**](mci-set.md)).

## <a name="recording-and-editing"></a>Запись и редактирование

Команда [**записи**](record.md) ([**\_ запись MCI**](mci-record.md)) предоставляет простую запись и имеет точность приблизительно в 1 секунду от начального положения. Чтобы записать более точные данные или изменить содержимое видео при одновременном использовании нескольких колод, следует использовать команду [**Cue**](cue.md) (элемент [**MCI \_ Cue**](mci-cue.md)).

Команда **подсказки** подготавливает устройство к записи или воспроизведению. Чтобы подготовить устройство к записи, используйте команду **подсказки** "входные данные". Команда **подсказки** необходима, так как приложение должно быть известно, когда устройство готово к выполнению команды (и может занять несколько минут для подготовки к [**игре**](play.md) ([**MCI \_ Play**](mci-play.md)) или **записи** ).

ВИДЕОМАГНИТОФОН подготавливается к записи или воспроизведению путем поиска *в месте*, которое является текущей позицией или позицией, указанной с помощью команды "от" **подсказки** . Однако если в команде **подсказки** указан флаг "Предварительная установка", то видеомагнитофон располагает предварительно установленным расстоянием от точки. Флаг "превращение" также указывает, что ВИДЕОМАГНИТОФОН использует любой подходящий режим редактирования, поэтому важно использовать "предрулонную", особенно если требуется самая точная запись. (Используйте команду [**capability**](capability.md) ([**MCI \_ жетдевкапс**](mci-getdevcaps.md)) с флагом "можно выполнить предметку", чтобы проверить, поддерживается ли режим предустановки.)

> [!Note]  
> При записи с использованием позиций "от" и "до" положение "от" включается в поле "Изменить", а "в" — в позицию "в".

 

Дополнительные сведения о записи см. в разделе [запись](recording.md).

## <a name="using-the-clock-while-editing"></a>Использование часов при редактировании

При редактировании может потребоваться записать сегменты из одного ВИДЕОМАГНИТОФОНА в другой. Вы можете начать запись в определенное время и на одном видеомагнитофоне, а другой — в то же время и на месте, указав действие (воспроизведение или запись), расположение и время для каждого ВИДЕОМАГНИТОФОНА.

Оба видеомагнитофона должны использовать одни и те же часы для редактирования такого типа. Часы позволяют синхронизировать оба устройства. Вы можете определить, используют ли две видеомагнитофона одинаковые часы, используя команду [**состояние**](status.md) ([**\_ состояние MCI**](mci-status.md)) с флагом "Clock ID" для запроса каждого видеомагнитофона. Если идентификационные номера, возвращаемые командой **Status** , совпадают, устройства используют одинаковые часы. Как общий ресурс, часы могут быть подключены к нескольким видеомагнитофонам. Драйвер ВИСКА поддерживает только один общий таймер.

Можно также определить разрешение часов с помощью команды **состояние** "частота приращения часов". Эта команда возвращает число инкрементов, поддерживаемое часами, в секунду. Например, если часы обновляются каждую миллисекунду, команда возвращает 1000 в качестве частоты приращения часов. Преимуществом использования частоты приращения является то, что ставка выражается как целое число; в противном случае инкремент будет иметь значение (с одинарной или двойной точностью) с плавающей запятой. Как целое число, управление скоростью инкремента является простой операцией и не является уязвимой для округления ошибок. Вы можете сбросить часы с помощью команды [**Set**](set.md) ([**MCI \_ Set**](mci-set.md)) с флагом "Clock 0" (ноль).

При выдаче команды [**воспроизведения**](play.md) ([**MCI \_ Play**](mci-play.md)), [**записи**](record.md) ([**MCI \_ Record**](mci-record.md)) или [**Seek**](seek.md) (команда [**MCI \_ Seek**](mci-seek.md)) можно указать время выполнения команды. Характеристики используемой видеомагнитофона определяют, когда следует запускать каждый ВИДЕОМАГНИТОФОН. Время должно учитывать количество предпродажных данных для каждого устройства и время, необходимое для выполнения команд MCI, используемых для настройки сеанса редактирования. Для этого извлеките время и добавьте интервал ожидания от 5 до 10 секунд. (Интервал ожидания должен быть достаточно длинным, чтобы позволить выполнить преднастройку и выполнение всех необработанных команд MCI.)

Чтобы убедиться в том, что период ожидания достаточно длинный, разместите команду **записи** в приложении последними и проверьте время непосредственно перед ним. Если интервал слишком короткий, перезапустите команду **Play** . Кроме того, можно проверить время сразу после последней команды сценария, чтобы убедиться в наличии достаточного времени для отправки и выполнения всех команд.

 

 




