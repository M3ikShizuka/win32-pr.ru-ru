---
title: Разрешение пользователю указывать устройства и файлы
description: Разрешение пользователю указывать устройства и файлы
ms.assetid: cc542b56-c66e-4622-b2d1-505d31aab25b
keywords:
- Макрос МЦивндопендиалог
- Макрос МЦивндопен
- Макрос МЦивндопенинтерфаце
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ac4191f18409a1fb1f23ba3a2128b4aaed1b30e8
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "103776520"
---
# <a name="allowing-the-user-to-specify-devices-and-files"></a>Разрешение пользователю указывать устройства и файлы

Вы можете связать устройство или файл с существующим окном МЦивнд с помощью макросов [**мЦивндопендиалог**](/windows/desktop/api/Vfw/nf-vfw-mciwndopendialog), [**мЦивндопен**](/windows/desktop/api/Vfw/nf-vfw-mciwndopen)и [**мЦивндопенинтерфаце**](/windows/desktop/api/Vfw/nf-vfw-mciwndopeninterface) и функции [**жетопенфиленамепревиев**](/windows/desktop/api/Vfw/nf-vfw-getopenfilenamepreviewa) .

Чтобы пользователь приложения мог выбрать файл для воспроизведения, используйте **мЦивндопендиалог**. Этот макрос открывает диалоговое окно **Открыть** (как показано на следующем снимке экрана) для выбора файла и связывания выбранного файла с текущим окном мЦивнд.

![изображение окна мЦивнд](images/mciwnd3.gif)

Можно разрешить пользователю приложения выбрать файл для связывания с окном МЦивнд и просмотреть этот файл с помощью [**жетопенфиленамепревиев**](/windows/desktop/api/Vfw/nf-vfw-getopenfilenamepreviewa) и [**мЦивндопен**](/windows/desktop/api/Vfw/nf-vfw-mciwndopen). Функция **жетопенфиленамепревиев** отображает диалоговое окно **Открыть** для выбора файла и позволяет пользователю просмотреть его содержимое. Если имя существующего файла указано в диалоговом окне, **жетопенфиленамепревиев** предоставляет небольшой элемент управления, позволяющий пользователю просмотреть содержимое файла. Вы можете связать указанный файл, выбранный с **жетопенфиленамепревиев** или указанным другим способом, с окном мЦивнд с помощью **мЦивндопен**.

Можно также использовать **мЦивндопен** , чтобы указать устройство, связываемое с окном мЦивнд. Например, можно использовать имя устройства, например "Кдаудио".

Чтобы связать окно МЦивнд с файловым интерфейсом или интерфейсом потока данных для мультимедийных данных, используйте макрос [**мЦивндопенинтерфаце**](/windows/desktop/api/Vfw/nf-vfw-mciwndopeninterface) . Дополнительные сведения о интерфейсах файлов и потоков данных см. в разделе [Авифиле functions and Macros](avifile-functions-and-macros.md).

> [!Note]  
> Перед связыванием нового файла или устройства с окном МЦивнд [**мЦивндопендиалог**](/windows/desktop/api/Vfw/nf-vfw-mciwndopendialog) и [**мЦивндопен**](/windows/desktop/api/Vfw/nf-vfw-mciwndopen) закрывают все устройства, которые в настоящее время связаны с окном. Приложению не нужно закрывать открытые устройства перед использованием этих макросов.

 

 

 




