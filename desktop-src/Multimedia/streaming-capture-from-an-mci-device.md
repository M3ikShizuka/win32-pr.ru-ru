---
title: Потоковая передача данных с устройства MCI
description: Потоковая передача данных с устройства MCI
ms.assetid: 44cbf375-f97e-426a-a703-dfb1b1933138
keywords:
- MCI (интерфейс управления мультимедийными файлами), потоковая передача данных
- Сообщение WM_CAP_SET_MCI_DEVICE
- макрос КапсетмЦидевиценаме
- Сообщение WM_CAP_GET_MCI_DEVICE
- макрос КапжетмЦидевиценаме
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ab8cf358a87a812024328abf7fc1aae0509a126f
ms.sourcegitcommit: 9eebab0ead09cecdbc24f5f84d56c8b6a7c22736
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/10/2021
ms.locfileid: "124372084"
---
# <a name="streaming-capture-from-an-mci-device"></a>Потоковая передача данных с устройства MCI

Устройства MCI дополняют операцию записи в режиме записи в реальном времени и записи кадров. Вы можете указать устройство MCI, например видеодиск или видеокассету (ВИДЕОМАГНИТОФОН), действующее в качестве источника видео для операции записи, используя сообщение с [**\_ ограничением WM \_ Set \_ MCI \_**](wm-cap-set-mci-device.md) (или макрос [**капсетмЦидевиценаме**](/windows/desktop/api/Vfw/nf-vfw-capsetmcidevicename) ) и указав имя устройства. Вы также можете получить имя устройства, установленное в данный момент, с помощью сообщения с [**\_ ограничением WM \_ Получение \_ \_ Устройства MCI**](wm-cap-get-mci-device.md) (или макроса [**капжетмЦидевиценаме**](/windows/desktop/api/Vfw/nf-vfw-capgetmcidevicename) ).

В режиме записи в реальном времени окно записи синхронизирует операцию записи и компенсирует задержки, связанные с расположением источника видео MCI и инициализацией ресурсов (например, буферов записи), необходимых для записи данных. Окно Capture (захват) ожидает установки в системе допустимого видеоустройства MCI для записи данных таким способом.

Спецификации для управления устройством MCI хранятся в элементах структуры [**каптурепармс**](/windows/win32/api/vfw/ns-vfw-captureparms) . Источники видео, совместимые с MCI, включают видеомагнитофоны и ласердискс. Если элемент **фмЦиконтрол** этой структуры имеет значение **true**, окно отслеживания координирует операцию MCI. Окно Capture использует параметры, указанные в члене **двмЦистарттиме** и **двмЦистоптиме** , чтобы получить начальные и конечные позиции последовательности в миллисекундах. Если значение **фмЦиконтрол** равно **false**, источник видео не рассматривается как устройство MCI, а содержимое **двмЦистарттиме** и **двмЦистоптиме** игнорируется.

Проигрыватель мультимедиа можно использовать для быстрой проверки правильности подключения видеоустройства MCI к системе. Воспроизведение устройства с помощью проигрывателя мультимедиа проверяет правильность конфигурации MCI для устройства. Если изображение отображается на дисплее, то источник видео правильно подключен к оборудованию для записи.

На шаге запись кадров окно записи синхронизирует операцию записи и компенсирует задержки, связанные с расположением источника видео MCI и инициализацией ресурсов, необходимых для записи данных. Кроме того, окно Capture (захват) гарантирует, что никакие кадры не удаляются; Он проходит через видеоматериалы по отдельности, гарантируя, что кадр записывается и сохраняется перед записью следующего кадра в потоке видео.

Спецификации для управления записью промежуточных кадров хранятся в элементах структуры [**каптурепармс**](/windows/win32/api/vfw/ns-vfw-captureparms) . В дополнение к элементам, используемым для записи в режиме реального времени, в записи о кадрах используются следующие элементы: **фстепмЦидевице**, **fStepCaptureAt2x** и **встепкаптуреаверажефрамес**. Если для элемента **фстепмЦидевице** задано **значение true**, окно отслеживания координирует запись кадра. В окне отслеживания используются параметры, указанные в элементах **двмЦистарттиме** и **двмЦистоптиме** , для начальной и останавливаемой позиций последовательности в миллисекундах. В окне Capture (захват) используется **fStepCaptureAt2x** , чтобы определить, должно ли оборудование для записи записывать видеокадры в два раза больше обычного разрешения, и использовать **встепкаптуреаверажефрамес** для указания числа выборки каждого кадра в операции записи.

Если **фстепмЦидевице** имеет **значение false**, запись в режиме реального времени используется вместо записи кадра этапа, а содержимое **fStepCaptureAt2x** и **встепкаптуреаверажефрамес** игнорируется.

Если задано создание фрагмента шага, а для **fStepCaptureAt2x** задано **значение true**, запись данных о оборудовании будет записана в два раза больше указанного разрешения. (Разрешения как по высоте, так и к ширине являются двойными.) Программное обеспечение интерполирует пикселы изображения с более высоким разрешением для создания изображения с указанным разрешением. Такая форма усреднения может улучшить определение пограничных изображений в кадре. Этот параметр можно включить, если оборудование не поддерживает децимации на основе оборудования и выполняется запись в формате RGB.

> [!Note]  
> Если оборудование поддерживает децимации с аппаратным обеспечением, оно может захватывать выборки с более высокой скоростью, чем указано, и использовать эти дополнительные примеры для получения определений цветов, которые более согласуются с исходным изображением. Дополнительные образцы удаляются после их использования, а оборудование передает образцы в драйвер записи по указанной ставке.

 

Если задается запись шага-кадра, элемент **встепкаптуреаверажефрамес** указывает, сколько раз кадр выдается при создании кадра на основе среднего примера. Эта методика усреднения уменьшает шум случайной цифры, отображаемый в кадре. Стандартное значение для числа средних значений равно 5.

Дополнительные сведения о MCI см. в разделе [MCI](mci.md).

## <a name="related-topics"></a>Связанные разделы

<dl> <dt>

[Варианты захвата](capture-variations.md)
</dt> </dl>

 

 




