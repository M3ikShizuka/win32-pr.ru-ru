---
description: Операция, которая завершается асинхронно, выполняет часть своей обработки в вызове функции, сделанной приложением, и остаток от него в независимом потоке выполнения после того, как TAPI 2. x возвращался из вызова функции.
ms.assetid: 37b544e4-6413-4741-b8b6-ec676ce4ca97
title: Асинхронные функции
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 135e792a4b1d6a25a4f49fbb2abe2c19ce3071ad
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105674029"
---
# <a name="asynchronous-functions"></a>Асинхронные функции

Операция, которая завершается асинхронно, выполняет часть своей обработки в вызове функции, сделанной приложением, и остаток от него в независимом потоке выполнения после того, как TAPI 2. x возвращался из вызова функции. Чтобы обеспечить завершение обработки вызова, поставщик услуг применяет запрос к другой активной сущности в системе (например, к серверу локальной сети, оборудованию, коммутатору или сети), а затем возвращает в приложение. В настоящее время приложению возвращается отрицательный результат ошибки или положительный идентификатор запроса.

Во время асинхронного завершения (поставщик услуг получил прерывание от оборудования, что означает, что сообщение должно быть доставлено), поставщик услуг вызывает ТАПИСРВ и сообщает о том, что только что произошло событие *X* . Доставьте соответствующее сообщение всем заинтересованным приложениям». Когда ТАПИСРВ получает это сообщение, он пересылает сообщение в библиотеку динамической компоновки TAPI в процессе приложения, который, в свою очередь, отправляет сообщение окна, сигнализирует об обработке события или отправляет его в порт завершения ввода-вывода в соответствии со схемой уведомлений о сообщениях, выбранной приложением в [**линеинитиализикс**](/windows/win32/api/tapi/nf-tapi-lineinitializeexa) или [**фонеинитиализикс**](/windows/win32/api/tapi/nf-tapi-phoneinitializeexa).

По завершении асинхронной части операции в приложение отправляется [**сообщение \_ ответа строки**](./line-reply.md) (или [**телефонного \_ ответа**](./phone-reply.md)). Это сообщение содержит в качестве одного из параметров идентификатор запроса, возвращенный вызовом функции. Этот идентификатор запроса позволяет приложению определить, какой исходный запрос завершен. (Приложения должны запомнить идентификаторы всех выполняемых запросов, чтобы можно было правильно обработать ответные сообщения.) Вторым параметром для \_ сообщения ответа строки (или телефонного \_ ответа) является асинхронное возвращаемое значение. Это либо отрицательное значение (для ошибки), либо нуль, если операция завершилась успешно. Для асинхронных операций любое из возвращаемых значений может быть возвращено как часть возвращаемого значения функции или как параметр *dwParam2* в ответе на строку \_ или на \_ ответное сообщение. Значение 0, которое указывает на успешное выполнение, будет возвращаться только в ответ на строку \_ и никогда не в качестве возвращаемого значения функции.

Функции инициализации ( [**линеинитиализикс**](/windows/win32/api/tapi/nf-tapi-lineinitializeexa) и [**фонеинитиализикс**](/windows/win32/api/tapi/nf-tapi-phoneinitializeexa)) сообщают TAPI, как отправить эти сообщения в приложение.

> [!Note]  
> В некоторых случаях, если многопоточное приложение вызывает асинхронную функцию из потока, отличного от потока, из которого приложение инициализирует линию или телефонное устройство, приложение может получить [**\_ ответ строки**](./line-reply.md) или ответ на [**Телефон \_**](./phone-reply.md) перед возвратом асинхронной функции. В таких случаях приложение должно сохранить параметры сообщения и подождать, пока асинхронная функция не вернет значение, а идентификатор запроса будет известен перед обработкой сообщения.

 

 

 
