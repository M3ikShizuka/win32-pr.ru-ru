---
description: Основным фрагментом информации, предоставляемой приложением для инициации сеанса связи, является тип адреса, тип или типы носителя, а также адрес назначения.
ms.assetid: 65e53587-0e40-411b-8d6c-d6adfc9d1e6c
title: Инициация сеанса
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0226fc1b04ea5859bc4a96b6f5ca43e3749e7664a9ccf6810b586115171530b2
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119975854"
---
# <a name="initiate-a-session"></a>Инициация сеанса

Основным фрагментом информации, предоставляемой приложением для инициации сеанса связи, является [тип адреса](address-type-ovr.md), тип или типы [носителя](media-type-ovr.md) , а также [адрес](address-ovr.md)назначения.

Адресу назначения может потребоваться [Преобразование адреса](#address-translation) для размещения информации, введенной пользователем, в правильный формат для заданного типа адреса. Например, номер телефона, [находящегося](address-ovr.md) в электронной адресной книге в [каноническом](address-ovr.md) формате, потребует перевода в формат, поддерживаемый набором.

Некоторые сеансы могут требовать специальных параметров установки, если они поддерживаются поставщиком услуг. Например, TSP ISDN может передавать сведения о пользователях, а некоторым MSP требуются сведения о направлении потока мультимедиа. Ознакомьтесь с [информацией о сеансе](session-information-ovr.md) , чтобы просмотреть данные, которые могут быть заданы или получены в ходе сеанса.

После инициации сеанса TAPI уведомляет приложение о ходе вызова, используя механизм уведомления о событиях, настроенный во время инициализации.

**Интерфейс TAPI 2. x:** Приложения инициируют сеанс с помощью функции [**линемакекалл**](/windows/win32/api/tapi/nf-tapi-linemakecall) . Функция [**линетранслатеаддресс**](/windows/win32/api/tapi/nf-tapi-linetranslateaddress) используется для выполнения преобразования адресов, если это необходимо.

Параметры установки вызова могут храниться в структуре данных [**линекаллпарамс**](/windows/win32/api/tapi/ns-tapi-linecallparams) , а указатель на эту структуру используется в качестве параметра [**линемакекалл**](/windows/win32/api/tapi/nf-tapi-linemakecall). Если для **линемакекалл** не указана структура **линекаллпарамс** , запрашивается вызов по умолчанию POTS-класса с набором значений по умолчанию.

Если сеанс успешно настроен, то в приложение возвращается маркер вызова с  [правами](privilege-ovr.md) владельца, а TAPI отправляет [**\_ каллстате**](./line-callstate.md) сообщения в строке приложения с информацией о ходе выполнения вызова. Приложения обычно используют эти сообщения для вывода отчетов о состоянии пользователю.

**Интерфейс TAPI 3. x:** Приложения инициируют сеанс связи, вызывая метод [**итаддресс:: креатекалл**](/windows/desktop/api/tapi3if/nf-tapi3if-itaddress-createcall) для адреса, способного обрабатывать требуемый тип адреса и тип носителя. Если адрес предоставляет интерфейс [**иттерминалсуппорт**](/windows/win32/api/tapi3if/nn-tapi3if-itterminalsupport) , терминалы выбираются в потоках мультимедиа объекта Call. Иллюстрация этого процесса приведена в примере кода [вызова метода make](make-a-call.md) .

Параметры установки вызова можно сохранять или изменять с помощью методов, предоставляемых интерфейсом [**иткаллинфо**](/windows/desktop/api/tapi3if/nn-tapi3if-itcallinfo) .

Если сеанс настроен успешно, TAPI возвращает указатель интерфейса [**итбасиккаллконтрол**](/windows/desktop/api/tapi3if/nn-tapi3if-itbasiccallcontrol) , который может использоваться для дальнейших операций сеанса, или для получения указателя на интерфейс [**иткаллинфо**](/windows/desktop/api/tapi3if/nn-tapi3if-itcallinfo) , который можно использовать для получения дополнительных сведений о сеансе. Интерфейс [**иткаллстативент**](/windows/desktop/api/tapi3if/nn-tapi3if-itcallstateevent) обрабатывает события состояния вызова TAPI.

> [!Note]  
> TAPI не следует использовать для передачи факсов. вместо этого используйте функции, доступные через MAPI, Сообщения (Майкрософт) API.

 

## <a name="address-translation"></a>Преобразование адреса

Приложение для конечных пользователей или серверов может хранить адреса в формате, который не совместим с потребностями данного поставщика услуг. Например, номер телефона может храниться в электронной адресной книге в [каноническом формате](address-ovr.md), но большинству поставщиков услуг, которые обрабатывали номера телефонов, требуется [набор для набора](address-ovr.md).

TAPI предоставляет операции преобразования адресов, которые помогают приложению представлять правильный тип адреса для TSP. Поставщик услуг указывает TAPI, какие типы адресов он поддерживает, и не обязаны включать в себя никаких форм преобразования адресов.

**Интерфейс TAPI 2. x:** См. [**линетранслатеаддресс**](/windows/win32/api/tapi/nf-tapi-linetranslateaddress).

**TAPI 3:** См. раздел [**итаддресстранслатион**](/windows/desktop/api/tapi3if/nn-tapi3if-itaddresstranslation), [**итаддресстранслатионинфо**](/windows/desktop/api/tapi3if/nn-tapi3if-itaddresstranslationinfo).

## <a name="toll-lists"></a>Списки платного звонка

В некоторых местах Северная Америка все телефонные звонки, размещенные в локальном коде города, являются локальными вызовами. В других местах некоторые вызовы, помещенные в местный код города, являются длинными и требуют префикса "1" для набора. Первые три цифры адреса (префикс) определяют, является ли вызов в пределах местного кода города платным вызовом.

*Платный список* — это список префиксов в локальном коде города, адреса которых должны быть набраны в виде длинных адресов и которые оплачиваются по долгосрочной разнице.

Списки платных номеров не относятся к поставщикам услуг или к приложениям, которые не обращаются к телефонной сети.

**Интерфейс TAPI 2. x:** См. раздел [**линетранслатеаддресс**](/windows/win32/api/tapi/nf-tapi-linetranslateaddress) (линетранслатересулт \_ интолллист and линетранслатересулт \_ Нотинтолллист BITS в структуре [**LINETRANSLATEOUTPUT**](/windows/win32/api/tapi/ns-tapi-linetranslateoutput) ), [**lineSetTollList**](/windows/win32/api/tapi/nf-tapi-linesettolllist).

**TAPI 3:** См. раздел [**итаддресстранслатион:: транслатеаддресс**](/windows/desktop/api/tapi3if/nf-tapi3if-itaddresstranslation-translateaddress), [**итаддресстранслатионинфо:: Get \_ транслатионресултс**](/windows/desktop/api/tapi3if/nf-tapi3if-itaddresstranslationinfo-get_translationresults).

 

 
