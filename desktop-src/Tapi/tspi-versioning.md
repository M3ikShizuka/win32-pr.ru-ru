---
description: Дополнительные сведения об управлении версиями ТСПИ. Со временем могут быть созданы различные версии TAPI, приложений и поставщиков служб.
ms.assetid: 994fad0e-5958-4d93-8952-9db2bbe01f44
title: Управление версиями ТСПИ
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0e0a0663a1fcc685df8643c634ec627f669aafe8
ms.sourcegitcommit: 6fc8a7419bd01787cf6a1c52c355a4a2d1aec471
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/10/2021
ms.locfileid: "111989239"
---
# <a name="tspi-versioning"></a>Управление версиями ТСПИ

Со временем могут быть созданы различные версии TAPI, приложений и поставщиков служб. Эти новые версии могут создавать новые определения, например для новых функций, новых элементов в структурах данных и новых битовых полей. Следовательно, Номера версий необходимы для указания способа интерпретации различных структур данных.

Чтобы обеспечить оптимальное взаимодействие различных версий приложений, версий самой TAPI и версий поставщиков услуг разных поставщиков, Microsoft телефонии предоставляет простой механизм согласования версий для приложений. Существует две разные версии, которые необходимо согласовать с интерфейсом TAPI и поставщиком услуг телефонии для каждого устройства линии. Первый — номер версии для базового и дополнительного телефонного номера SPI, называемый *интерфейсом тспи*. Другой — для расширений, зависящих от поставщика, если таковые имеются, и называется *версией расширения*. Формат структур и типов данных, используемых базовыми и дополнительными функциями ТСПИ, определяется версией ТСПИ, а версия расширения определяет формат структур данных, определенных расширениями, определенными для поставщика.

Эти два типа согласования версий обрабатываются двумя различными процедурами: [**тспи \_ линенеготиатетспиверсион**](/windows/win32/api/tspi/nf-tspi-tspi_linenegotiatetspiversion) используется для согласования версии интерфейса Тспи, а [**тспи \_ линенеготиатикстверсион**](/windows/win32/api/tspi/nf-tspi-tspi_linenegotiateextversion) используется для согласования версии расширения. Если расширения не требуются, можно пропустить согласование версии расширения. Если эти диапазоны введены при наложении согласования, поставщик услуг должен вернуть значение в перекрывающейся части диапазона в результате согласования. Обычно это должно быть наибольшее возможное значение. Если диапазоны не пересекаются, эти две стороны несовместимы и функция возвращает ошибку.

Результаты согласования просто указывают, что поставщик службы готов к работе по определенному номеру версии, но не фиксирует поставщик услуг для этого. Например, TAPI может выполнить повторное согласование, чтобы определить идеальную версию после согласования возможной версии. Версия интерфейса ТСПИ фиксируется только при открытии строки с помощью [**тспи \_ линеопен**](/windows/win32/api/tspi/nf-tspi-tspi_lineopen) и остается недоступной до закрытия устройства. Версия расширения зафиксируется при вызове функции [**тспи \_ линеселектекстверсион**](/windows/win32/api/tspi/nf-tspi-tspi_lineselectextversion) и остается в неработоспособном виде до тех пор, пока выбор не будет отменен путем выбора версии расширения 0.

Выбор версии расширения может происходить много раз, включая, когда действует версия расширения. Так как поставщик услуг фиксируется в версии расширения, его диапазон поддерживаемых версий ограничивается точностью до этой версии расширения. Например, рассмотрим поставщик услуг, который обычно совместим с версиями расширений 1,0 – 5,5. Если версия 3,0 действует, пока вызывающий объект пытается согласовать версию в диапазоне от 1,0 до 5,5, согласование возвращает 3,0.

Так как TAPI согласовывает версию, поставщик услуг можно обновить до новых версий интерфейса, не требуя обновления TAPI. Аналогичным образом TAPI можно обновить, но по-прежнему использовать старый поставщик услуг.

 

 
