---
description: Расширенные службы линии (или специальные службы для конкретных устройств) включают все расширения, определенные поставщиком услуг, в ТСПИ.
ms.assetid: 23519d23-27bd-422e-b3c4-00e0d0d93f9e
title: Расширенные службы линии
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dbc1ce08d25633d33fd518d8686271c198ca5034
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105683417"
---
# <a name="extended-line-services"></a>Расширенные службы линии

Расширенные службы линии (или специальные службы для конкретных устройств) включают все расширения, определенные поставщиком услуг, в ТСПИ. ТСПИ определяет механизм, позволяющий поставщикам поставщиков услуг расширить индекс SPI телефонии с помощью расширений для конкретных устройств. ТСПИ определяет только механизм расширения, и это обеспечивает доступ к модулям, связанным с устройствами, но ТСПИ не определяет их поведение. Поведение полностью определяется поставщиком услуг.

SPI телефонии состоит из скалярных и битовых определений констант флагов, структур данных, функций и сообщений обратного вызова. Определяются процедуры, которые позволяют поставщику расширить большинство из них следующим образом.

Для расширяемых скалярных констант данных поставщик поставщика услуг может определять новые значения в указанном диапазоне. Так как большинство констант данных имеют значение **DWORD**, обычно диапазон от 0X00000000 до 0x7FFFFFFF зарезервирован для распространенных будущих расширений, а 0x80000000 — по 0xFFFFFFFF — для расширений, зависящих от поставщика. Предполагается, что поставщик определит значения, которые являются естественными расширениями типов данных, определенных ТСПИ.

Для переменных с расширенными битовыми флагами поставщик поставщика услуг может определять новые значения для указанных битов. Как большинство констант флагов имеют значение **DWORD**, обычно зарезервировано определенное число младших битов для распространенных расширений, а оставшиеся верхние доступны для расширений, зависящих от поставщика. Распространенным битовым флагам присваивается нулевой разряд. расширения, зависящие от поставщика, должны быть назначены с 31 бита. Это обеспечивает максимальную гибкость при назначении битовых позиций общим расширениям и расширениям, зависящим от поставщика. Предполагается, что поставщик определяет новые значения, которые являются естественными расширениями битовых флагов, определенных ТСПИ.

Расширяемые структуры данных имеют поле размера вариабли, зарезервированное для использования в конкретных устройствах. Вариабли размер, поставщик услуг определяет объем информации и интерпретацию. Поставщик, определяющий поле для конкретного устройства, должен сделать эти естественные расширения исходной структуры данных, определенной ТСПИ.

Две функции, [**тспи \_ ЛинедевспеЦифик**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecific) и [**тспи \_ линедевспеЦификфеатуре**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecificfeature)и четыре связанных сообщения, [**Line \_ ДевспеЦифик**](/previous-versions/windows/desktop/legacy/ms725225(v=vs.85)), [**Line \_ каллдевспеЦифик**](line-calldevspecific.md), [**Line \_ девспеЦификфеатуре**](/previous-versions/windows/desktop/legacy/ms725227(v=vs.85))и [**Line \_ CALLDEVSPECIFICFEATURE**](line-calldevspecificfeature.md), предлагают механизм расширения, зависящий от поставщика. Операция **\_ линедевспеЦифик тспи** и связанные строки \_ девспеЦифик и Line \_ каллдевспеЦифик позволяют клиентскому приложению Tapi32.dll доступ к строке, адресу или вызову функций, которые недоступны в базовых или дополнительных службах телефонии. Профиль параметров функции [**тспи \_ линедевспеЦифик**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecific) является универсальным в этой незначительной интерпретации параметров с помощью тспи. Параметры обработчика устройства имеют значения, определяемые ТСПИ, и переводятся соответствующим образом между приложением и поставщиком услуг. Универсальные параметры просто передаются без изменений. Интерпретация универсальных параметров определяется поставщиком услуг и должна быть понята любым приложениям, использующим их. Приложение, которое использует расширения для конкретных устройств, обычно не работает с другими поставщиками служб. Однако приложения, полностью написанные для базовых и дополнительных служб телефонии, должны работать с расширенным поставщиком услуг.

Реализация интерфейса TAPI для функций и сообщений конкретного устройства является сквозной. TAPI не проверяет и не изменяет универсальные параметры и буферы для конкретного устройства, но сопоставляет значения прозрачности на уровне приложения (используемые на уровне TAPI) со значениями непрозрачных обработчиков на уровне поставщика услуг (используемые на уровне ТСПИ).

В отношении преобразования маркеров транзитная природа универсальных частей расширений для конкретных устройств имеет важное следствие. Поставщик услуг не имеет возможности связывать дескрипторы, используемые на уровне ТСПИ, с ними на уровне TAPI, за исключением передачи их через предопределенные параметры и поля дескриптора. Все маркеры, помещаемые в область универсального расширения, не переводятся TAPI, так как он передается между приложением и поставщиком услуг. Разработчик расширения поставщика услуг обычно не должен определять расширения, которые передают дескрипторы таким образом.

При определении расширения для конкретного устройства, которое должно ссылаться на конкретные устройства без использования дескрипторов, следует ссылаться на них, используя абсолютную идентификацию устройства. Например, идентификатор устройства, используемый при открытии строки на уровне TAPI, является строго тем же значением, которое используется на уровне ТСПИ для открытия строки. Аналогичным образом, кортеж (идентификатор устройства линии, идентификатор адреса), однозначно определяющий адрес на уровне TAPI, использует те же значения для идентификации на уровне ТСПИ.

Для удобства также предоставляется более специализированная Escape-функция. Он похож на [**тспи \_ линедевспеЦифик**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecific), но раскладывает интерпретацию некоторых параметров. Функция [**тспи \_ линедевспеЦификфеатуре**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecificfeature) и связанные [**строки \_ девспеЦификфеатуре**](/previous-versions/windows/desktop/legacy/ms725227(v=vs.85)) и [**Line \_ каллдевспеЦификфеатуре**](line-calldevspecificfeature.md) messages позволяют TAPI имитировать нажатия кнопки в телефоне функции. По мере того, как телефоны функций и их кнопки относятся к конкретному поставщику, вызов функции с помощью **тспи \_ линедевспеЦификфеатуре** также зависит от поставщика.

Для суммирования функция [**тспи \_ линедевспеЦификфеатуре**](/windows/win32/api/tspi/nf-tspi-tspi_linedevspecificfeature) — это функция экранирования для конкретного устройства, позволяющая отправлять функции переключения в коммутатор. Сообщение [**Line \_ каллдевспеЦификфеатуре**](line-calldevspecificfeature.md) — это сообщение для конкретного устройства, отправляемое в ответный вызов приложения, как указание функций, относящихся к вызову, отправляемых в коммутатор. [**Строка \_ ДЕВСПЕЦИФИКФЕАТУРЕ**](/previous-versions/windows/desktop/legacy/ms725227(v=vs.85)) — это сообщение для конкретного устройства, отправляемое в ответный вызов приложения, в качестве обозначения функций, относящихся к строке, отправляемых в коммутатор.

Отсутствует центральный реестр для идентификаторов производителей. Вместо этого можно использовать уникальный генератор идентификаторов, именуемый Extidgen.exe, в составе ТСПИ. Поставщик, который разрабатывает набор расширений для конкретных устройств, использует эту служебную программу для получения уникальных идентификаторов для этих расширений.

 

 
