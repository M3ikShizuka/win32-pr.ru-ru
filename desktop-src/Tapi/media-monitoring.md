---
description: Когда вызов находится в состоянии Connected, данные можно переносить через вызов. Тип носителя вызова предоставляет указание типа данных (например, его тип данных или протокол более высокого уровня) для этого потока мультимедиа.
ms.assetid: 3281387e-3f72-4fda-8199-b3ce6e45e910
title: Мониторинг мультимедиа
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fb54989306fd80c48c0b99c9f8285a83b40bed25
ms.sourcegitcommit: c16214e53680dc71d1c07111b51f72b82a4512d8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/03/2021
ms.locfileid: "105674544"
---
# <a name="media-monitoring"></a>Мониторинг мультимедиа

Когда вызов находится в состоянии *Connected* , данные можно переносить через вызов. Тип носителя вызова предоставляет указание типа данных (например, его тип данных или протокол более высокого уровня) для этого потока мультимедиа.

TAPI позволяет предоставлять приложениям уведомления об изменениях в типе носителя вызова. Уведомление указывает на новый тип носителя вызова. Поставщик услуг принимает решение о том, как это определить. Например, поставщик услуг может использовать обработку сигнала потока мультимедиа для определения типа носителя или полагаться на характерные шаблоны звонков, назначенные различным потокам мультимедиа, или на информационные элементы, передаваемые в протоколе нестандартного сигнала. Независимо от того, как достигается определение типа носителя, приложение просто уведомляет об изменениях типа мультимедиа в существующем вызове.

Дополнительные сведения и список определенных в настоящее время типов или режимов носителей TAPI см. в [разделе \_ константы линемедиамоде](linemediamode--constants.md). Поставщики услуг могут реализовывать специфические для поставщика типы носителей для очень специализированных устройств. Сведения о них можно найти в документации по устройству.

Типы носителей, определенные TAPI, включают:

-   Неизвестно. Тип носителя вызова в настоящее время неизвестен — вызов не классифицирован.
-   Интерактивная речь. В вызове обнаружена радиоэнергия, и вызов обрабатывается как интерактивный голосовое обращение с пользователем в конце приложения.
-   Автоматическая речь. В вызове обнаружена радиоэнергия, и вызов обрабатывается как голосовое обращение, но не имеет человека в конце приложения, например, при помощи приложения, отвечающего компьютеру.
-   Модем данных. Сеанс модема при вызове. Для использования текущих модемных протоколов требуется вызванная станция для запуска подтверждения. Для вызова входящего модема, как правило, приложение может не выполнять никаких срабатываний. То, как поставщик услуг делает это определение, является его выбором. Например, период бездействия сразу после ответа на входящий вызов можно использовать в качестве эвристики для принятия решения о том, что это может быть вызов модема данных.
-   G3 Факс. Сеанс факса группы 3 по вызову.
-   Факс G4. Сеанс факса группы 4 по вызову.
-   TDD. Поток мультимедиа вызова использует устройства телефонии для протокола нарушения слуха.
-   Цифровые данные. Поток цифровых данных неопределенного формата.
-   Teletex, видеотекс, телекса, Mixed. Они соответствуют телематик службам с одинаковыми именами.
-   ADSI. Сеанс интерфейса аналогового дисплея для вызова. Интерфейсы ADSI улучшают голосовые вызовы с помощью буквенно-цифровых данных, загружаемых на телефон, и использования мягких кнопок на телефоне.

Приложение может включить или отключить наблюдение за носителями при указанном вызове с помощью [**линемонитормедиа**](/windows/desktop/api/Tapi/nf-tapi-linemonitormedia). Приложение указывает, какие типы носителей он заинтересован в наблюдении, и когда включен Мониторинг мультимедиа, обнаружение типа носителя приводит к тому, что приложение будет уведомлено с помощью [**строки \_ монитормедиа**](line-monitormedia.md) Message. Это сообщение предоставляет маркер вызова, на котором обнаружено изменение типа носителя, а также новый тип носителя.

Существует различие между типом носителя вызова, сообщаемым [**линежеткаллинфо**](/windows/desktop/api/Tapi/nf-tapi-linegetcallinfo) , и событием типа носителя, которое выводится \_ сообщениями монитормедиа. Тип носителя вызова определяется исключительно приложениями-владельцами вызова и не изменяется автоматически с помощью событий мониторинга мультимедиа. Единственным исключением является исходное определение типа носителя, которое может быть выполнено библиотекой динамической компоновки TAPI для выбора первого владельца вызова. Можно сказать, что в этом случае библиотека является владельцем вызова.

Мониторинг типа мультимедиа по умолчанию выполняется для типов мультимедиа, для которых было открыто устройство линии. Это позволяет определить тип носителя входящего вызова перед передачей вызова приложению в зависимости от требований приложения. Область наблюдения за носителями вызова ограничивается временем существования вызова. Наблюдение за носителями в вызове завершается, как только вызов *отключается* или переходит в режим *простоя*.

Приложение может получать идентификаторы устройств для различных классов устройств, связанных с открытой строкой, вызывая [**линежетид**](/windows/desktop/api/Tapi/nf-tapi-linegetid). Эта функция принимает маркер строки, адрес или маркер вызова и описание класса устройства. Он возвращает идентификатор устройства для данного класса устройств, связанного с устройством Open Line, адресом или вызовом. Если класс устройств имеет значение TAPI/Line, то возвращается идентификатор устройства линейного устройства. Если класс устройств имеет значение MCI/Wave, то возвращается идентификатор устройства mci вавеаудио (если поддерживается), что позволяет выполнять такие действия, как запись или воспроизведение звука через вызов в строке.

Приложение может использовать возвращенный идентификатор устройства с соответствующим API мультимедиа для запроса возможностей устройства и последующего открытия устройства мультимедиа. Например, если приложению требуется использовать строку в качестве устройства аудио, сначала необходимо вызвать [**вавеинжетдевкапс**](/windows/win32/api/mmeapi/nf-mmeapi-waveingetdevcaps) и/или [**вавеаутжетдевкапс**](/windows/win32/api/mmeapi/nf-mmeapi-waveoutgetdevcaps) , чтобы определить возможности аудио вывода устройства. Стандартный формат данных формата Wave, поддерживаемый телефонией в Северная Америка, — это 8-разрядный закон в 8000 выборок в секунду, хотя драйвер волнового устройства может преобразовать эту частоту дискретизации и компандинг к другим распространенным мультимедийным форматам мультимедиа.

Чтобы впоследствии открыть линейное устройство для воспроизведения звука с помощью API аудио, приложение вызывает [**вавеаутопен**](/windows/win32/api/mmeapi/nf-mmeapi-waveoutopen). Реализация **вавеаутопен** зависит от конкретного устройства, и для реализации этой функции существует множество параметров.

 

 
