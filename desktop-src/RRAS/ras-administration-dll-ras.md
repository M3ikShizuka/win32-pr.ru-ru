---
title: Библиотека DLL администрирования RAS
description: Библиотека DLL экспортирует функции, которые сервер удаленного доступа вызывает каждый раз, когда пользователь пытается подключиться или отключиться.
ms.assetid: 014ab85d-8924-4c7a-89ed-f83e75318ca6
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f0908032e0916f0937e964408b1551d3f1515dea
ms.sourcegitcommit: cba7f424a292fd7f3a8518947b9466439b455419
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/23/2019
ms.locfileid: "104335667"
---
# <a name="ras-administration-dll"></a>Библиотека DLL администрирования RAS

Библиотека DLL экспортирует функции, которые сервер удаленного доступа вызывает каждый раз, когда пользователь пытается подключиться или отключиться. Библиотеку DLL можно использовать для выполнения следующих административных функций:

-   Решите, следует ли разрешить пользователю подключаться к серверу. Это может обеспечить проверку безопасности в дополнение к стандартной проверке подлинности пользователя службы удаленного доступа.
-   Запишите время, когда каждый пользователь подключается к серверу и отключается от него. Это может быть полезно для выставления счетов или проведения аудита.
-   Назначьте IP-адрес каждому пользователю. Это может быть полезно в целях обеспечения безопасности при сопоставлении подключения пользователя к определенному компьютеру.

При разработке библиотеки DLL администрирования сервера удаленного доступа реализуйте следующие функции.

-   [**расадминакцептневконнектион**](rasadminacceptnewconnection.md)
-   [**расадминконнектионхангупнотификатион**](rasadminconnectionhangupnotification.md)
-   [**расадминжетипаддрессфорусер**](rasadmingetipaddressforuser.md)
-   [**расадминрелеасеипаддресс**](rasadminreleaseipaddress.md)

Библиотека DLL администрирования RAS должна реализовывать и экспортировать все описанные выше функции. Если какая бы то ни было функция не реализована, служба удаленного доступа не сможет запуститься.

Функции [**расадминакцептневконнектион**](rasadminacceptnewconnection.md) и [**расадминконнектионхангупнотификатион**](rasadminconnectionhangupnotification.md) позволяют библиотеке DLL выполнять аудит подключений пользователей к серверу. Сервер удаленного доступа Windows NT/Windows 2000 вызывает функцию **расадминакцептневконнектион** каждый раз, когда пользователь пытается подключиться. Функция может препятствовать подключению пользователя. Можно также использовать функцию, чтобы создать запись в журнале для выставления счетов или аудита. Когда пользователь отключается, сервер удаленного доступа вызывает функцию **расадминконнектионхангупнотификатион** , которая может регистрировать время отключения пользователя.

После того как сервер удаленного доступа пройдет проверку подлинности вызывающего объекта, он вызывает функцию [**расадминжетипаддрессфорусер**](rasadmingetipaddressforuser.md) для получения IP-адреса для удаленного клиента. Эта функция может использоваться библиотекой DLL для предоставления альтернативной схемы для сопоставления IP-адреса с пользователем удаленного доступа. Если **расадминжетипаддрессфорусер** не реализован, сервер удаленного доступа подключает удаленного пользователя к IP-адресу, выбранному из статического пула IP-адресов или по выбранному сервером протокола динамической настройки узлов (DHCP). Функция **расадминжетипаддрессфорусер** позволяет библиотеке DLL переопределить этот IP-адрес по умолчанию и указать конкретный IP-адрес для каждого пользователя. Функция **расадминжетипаддрессфорусер** может установить флаг, который заставляет службу RAS вызывать функцию [**расадминрелеасеипаддресс**](rasadminreleaseipaddress.md) при отключении пользователя. Библиотека DLL может использовать [**расадминрелеасеипаддресс**](rasadminreleaseipaddress.md) , чтобы обновить свою карту "пользователь-IP-адрес".

Служба RAS сериализует вызовы в библиотеку DLL администрирования. Вызов одной из функций DLL для данного клиента RAS никогда не будет зависеть от вызова этой функции для другого клиента RAS; Начальный вызов гарантированно завершится до того, как служба RAS вызовет функцию для другого клиента. Более того, сериализация распространяется на определенные группы функций. Функции IP-адреса сериализуются как группа. вызов либо в [**расадминжетипаддрессфорусер**](rasadmingetipaddressforuser.md) , либо в [**расадминрелеасеипаддресс**](rasadminreleaseipaddress.md) будет блокировать вызовы до тех пор, пока не завершится начальный вызов. [**Расадминакцептневконнектион**](rasadminacceptnewconnection.md) и [**расадминконнектионхангупнотификатион**](rasadminconnectionhangupnotification.md) также сериализуются как группа.

Служба RAS выполняет функции назначения IP-адресов в одном процессе и выполняет функции для подключения и отсоединения уведомлений в другом процессе. Следовательно, Библиотека DLL не должна зависеть от общих данных между двумя наборами функций.

Сервер RAS регистрирует ошибку в журнале системных событий, если возникает ошибка при попытке загрузить библиотеку DLL администрирования RAS или вызов одной из функций библиотеки DLL. Это может произойти, например, если в библиотеке DLL указано неверное имя экспортированной функции или если она не включала имя функции в DEF-файл. Запись в журнале событий указывает причину сбоя.

**Windows 2000 Server и более поздние версии:** Библиотеки администрирования RAS, реализующие этот интерфейс функции, больше не работают. Вместо этого используйте интерфейс функции Мпрадмин, предоставляемый в более поздних версиях Windows. Дополнительные сведения см. в [справочнике по администрированию службы RAS](remote-access-service-administration-reference.md) в документации по МАРШРУТИЗАЦИИ и RAS.

 

 




