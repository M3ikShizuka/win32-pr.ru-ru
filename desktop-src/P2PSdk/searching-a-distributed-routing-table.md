---
description: Прежде чем приложение сможет выполнять поиск в таблице распределенной маршрутизации (DRT), необходимо создать запрос поиска.
ms.assetid: b3403a64-128c-461e-9384-8e62c03322e1
title: Поиск в таблице распределенной маршрутизации
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1c9977ca395393cef09198182fb8790738d2b00c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105663964"
---
# <a name="searching-a-distributed-routing-table"></a>Поиск в таблице распределенной маршрутизации

Прежде чем приложение сможет выполнять поиск в таблице распределенной маршрутизации (DRT), необходимо создать запрос поиска. Требуемое значение ключа задается приложением при вызове функции [**дртстартсеарч**](/windows/desktop/api/drt/nf-drt-drtstartsearch) . Поведение поиска определяется сведениями, заданными приложением в структуре [**\_ \_ сведений о поиске DRT**](/windows/desktop/api/drt/ns-drt-drt_search_info) .

Как правило, событие приложения сигнализирует, когда поиск обнаруживает результаты, а другой — в конце поиска. Однако если **фитеративе** заданы в [**\_ \_ сведениях о поиске DRT**](/windows/desktop/api/drt/ns-drt-drt_search_info), то событие приложения может быть сигнальным при установлении связи с каждым узлом.

После получения сигнала о событии приложение вызывает функцию [**дртжетсеарчресулт**](/windows/desktop/api/drt/nf-drt-drtgetsearchresult) для получения результатов. Если возвращенный код имеет значение S, результаты указываются в структуре [**\_ \_ результатов поиска DRT**](/windows/desktop/api/drt/ns-drt-drt_search_result) , возвращенной API. **\_** Возвращаемые результаты попадают в диапазон значений, указанных в [**\_ \_ сведениях о поиске DRT**](/windows/desktop/api/drt/ns-drt-drt_search_info). Если поиск не находит совпадений, то при завершении возвращаемых результатов будет возвращено только значение **DRT \_ E \_ \_** .

Ниже приведены сведения о том, как члены, содержащиеся в [**\_ \_ сведениях о поиске DRT**](/windows/desktop/api/drt/ns-drt-drt_search_info) , позволяют приложению специально определять поведение поиска инфраструктуры DRT:

## <a name="fallowcurrentinstancematch"></a>фалловкуррентинстанцематч

По умолчанию результаты поиска DRT содержат только совпадения, найденные за пределами локального узла. Параметр **фалловкуррентинстанцематч** указывает, что результаты поиска также содержат совпадения, обнаруженные в локальном экземпляре DRT.

## <a name="cmaxendpoints"></a>кмаксендпоинтс

Количество и диапазон результатов, возвращаемых поиском, задаются приложением с использованием значений **кмаксендпоинтс** (Quantity) и **пминимумкэй** и **пмаксимумкэй** (Range), а также ссылками на [**\_ \_ сведения о поиске в DRT**](/windows/desktop/api/drt/ns-drt-drt_search_info).

Если **кмаксендпоинтс = 1**, инфраструктура DRT ищет ключ, возвращая одно совпадение в диапазоне, указанном значениями **пминимумкэй** и **пмаксимумкэй** в [**\_ \_ сведениях о поиске DRT**](/windows/desktop/api/drt/ns-drt-drt_search_info). Это может быть точное совпадение или ближайшее соответствие в пределах диапазона. Если совпадение не найдено, то не возвращается **DRT \_ E \_ \_** .

Если **кмаксендпоинтс > 1**, инфраструктура DRT вернет совпадения в диапазоне вплоть до значения **кмаксендпоинтс**. Возвращаемые совпадения могут содержать точное совпадение или ближайшие результаты соответствия в пределах диапазона. Кроме того, если для **пминимумкэй** и **пмаксимумкэй** задано одно и то же значение, поиск выполняется только для этого значения и возвращает **DRT \_ е \_ \_** , если он не найден.

## <a name="fanymatchinrange"></a>фаниматчинранже

Элемент **фаниматчинранже** указывает, будет ли поиск останавливаться после того, как первое совпадение находится в пределах указанного диапазона, или если поиск будет продолжаться в соответствии с ключом, указанным в API [**дртстартсеарч**](/windows/desktop/api/drt/nf-drt-drtstartsearch) . Если задан параметр **фаниматчинранже** , поиск выполняется с **кмаксендпоинтс = 1** независимо от указанного значения **Кмаксендпоинтс** в [**\_ \_ сведениях поиска DRT**](/windows/desktop/api/drt/ns-drt-drt_search_info).

## <a name="fiterative"></a>фитеративе

Член **фитеративе** указывает, будет ли каждый узел, к которому осуществляется обращение в инфраструктуре DRT во время поиска, иметь связанные с ним данные ключа или конечной точки, которые были доступны приложению через [**\_ \_ Результаты поиска DRT**](/windows/desktop/api/drt/ns-drt-drt_search_result). Если присвоить параметру **фитеративе** значение **true**, то для параметра **кмаксендпоинтс = 1** будет принудительно установлен. Если **фитеративе** имеет значение **true** в поисковом запросе для DRT, то приложение вызывается обратно после связи с каждым узлом или "прыжком". Каждый результат прыжка содержит ключ, указывающий на узел, который будет искать в DRT. Результат прыжка возвращается через [**дртжетсеарчресулт**](/windows/desktop/api/drt/nf-drt-drtgetsearchresult) в качестве **\_ \_ промежуточного результата сопоставления DRT** .

## <a name="pminimumkey-and-pmaximumkey"></a>Пминимумкэй и Пмаксимумкэй

Члены **пминимумкэй** и **пмаксимумкэй** можно использовать для поиска ключей, попадающих в диапазон. Если для элемента **фаниматчинранже** задано **значение false**, то DRT вернет ближайший ключ к целевому объекту поиска (указанный с помощью аргумента pKey, переданного в функцию [**дртстартсеарч**](/windows/desktop/api/drt/nf-drt-drtstartsearch) ), в пределах диапазона. Обратите внимание, что аргумент *pKey* , переданный в **дртстартсеарч** , должен попадать в диапазон, определенный **пминимумкэй** и **пмаксимумкэй**. Чтобы найти точный ключ, задайте для **пминимумкэй**, **пмаксимумкэй** и *pKey* одно и то же значение.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Регистрация и Отмена регистрации ключей](registering-and-deregistering-keys.md)
</dt> <dt>

[Сведения о таблицах распределенной маршрутизации](about-distributed-routing-tables.md)
</dt> <dt>

[Справочник по распределенной маршрутизации API таблиц](distributed-routing-table-api-reference.md)
</dt> </dl>

 

 



