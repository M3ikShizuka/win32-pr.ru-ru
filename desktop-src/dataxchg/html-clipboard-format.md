---
title: Формат буфера обмена HTML
description: В этом разделе описывается формат буфера обмена HTML.
ms.assetid: e891393f-234f-4c94-b581-c4e5f885d2ab
keywords:
- Пользовательский интерфейс Windows, буфер обмена
- буфер обмена, вырезание данных
- буфер обмена, копирование данных
- буфер обмена, вставленные данные
- буфер обмена, форматы
- буфер обмена, формат HTML
- буфер обмена, Вырезание текста HTML
- буфер обмена, вставленный HTML-текст
- Формат буфера обмена CF_HTML
- буфер обмена, формат CF_HTML
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 75cdcd9c2fc982a7cbde38bba4b7dec6738f1793
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104068147"
---
# <a name="html-clipboard-format"></a>Формат буфера обмена HTML

Требования к передаче HTML-текста с помощью буфера обмена зависят от сценария. В этой статье рассматриваются вырезанные и вставленные фрагменты HTML-документа. Возможны требования для передачи целых документов HTML через буфер обмена. Однако эта статья посвящена требованию для перемещения фрагментов выбранного текста HTML. Таким образом, метод, который требует скопировать весь HTML-документ в буфер обмена, считается слишком высокой плотностью.

\_Формат буфера обмена HTML CF позволяет хранить фрагмент необработанного HTML-текста и его контекста в буфере обмена как ASCII. Это позволяет приложению контекст фрагмента кода HTML, который состоит из всех тегов, предшествующих окружающим тегам, проанализировать с помощью приложения, чтобы можно было отметить окружающие Теги фрагмента HTML с их атрибутами. Несмотря на то, что вы решаете, как интерпретировать такие фрагменты, на основе реализаций IE4/MSHTML сюда входят некоторые основные рекомендации.

Официальное имя буфера обмена (строка, используемое Регистерклипбоардформат) имеет формат HTML.

-   [Описание](#description)
-   [Сценарии](#scenarios)

## <a name="description"></a>Описание

\_HTML-код в формате CF является текстовым форматом (и, помимо прочего, в формате HTML и использует UTF-8) и включает `description` , необязательный элемент `context` и, в контексте `fragment` .

Ниже приведен пример буфера обмена.


```
Version:0.9
    StartHTML:71
    EndHTML:170
    StartFragment:140
    EndFragment:160
    StartSelection:140
    EndSelection:160
    <!DOCTYPE>
    <HTML>
    <HEAD>
    <TITLE> The HTML Clipboard</TITLE>
    <BASE HREF="https://sample/specs">
    </HEAD>
    <BODY>
    <UL>
    <!--StartFragment -->
    <LI> The Fragment </LI>
    <!--EndFragment -->
    </UL>
    </BODY>
    </HTML>
```



Описание включает номер версии буфера обмена и смещение, указывающие, где начинается и завершается контекст и фрагмент. Описание представляет собой список ключевых слов текста ASCII (min/Shift не имеет смысла), за которым следует строка, разделенная двоеточием (:).

**Версия**: номер версии VV буфера обмена. Начальная версия — 0,9.

**Старстмл**: byteCount от начала буфера обмена до начала контекста или значение-1, если контекст отсутствует.

**Ендхтмл**: byteCount от начала буфера обмена до конца контекста или значение-1, если контекст отсутствует.

**Стартфрагмент**: byteCount от начала буфера обмена до начала фрагмента.

**Ендфрагмент**: byteCount от начала буфера обмена до конца фрагмента.

**Стартселектион**: byteCount от начала буфера обмена до начала выбора.

**Ендселектион**: byteCount от начала буфера обмена до конца выделенного фрагмента.

Ключевые слова Стартселектион и Ендселектион необязательны и должны быть опущены, если не нужно, чтобы приложение создавало эти сведения.

Другие сведения об этом типе можно добавить здесь позже, так как HTML-код начинается с Старстмлоффсет. Например, несколько пар Стартфрагмент/Ендфрагмент можно добавить позже для поддержки несмежных фрагментов.

Для удобства работы программ, создающих битекаунтс, битекаунтс можно оставлять пустыми. Например, программы, создающие битекаунтс, могут произвольно повлиять на десять (10) нулей на каждое ключевое слово (Старстмл: 0000000000), а затем, когда известно точное Старстмл byteCount (скажем, 71), программа может заменить соответствующее количество нулей на byteCount (Старстмл: 0000000071).

Единственным набором символов, поддерживаемым буфером обмена, является Юникод в кодировке UTF-8. Поскольку первые символы UTF-8 и ASCII совпадают, описание всегда равно ASCII, но байты контекста (начиная с Старстмл) могут использовать любые другие символы, закодированные в кодировке UTF-8.

Конец строк в заголовке формата буфера обмена может быть CR или CR/LF или LF.

Фрагмент содержит чистый, допустимый HTML, представляющий область, выбранную пользователем (например, для копирования). Он содержит выделенный текст, а также открывающие теги и атрибуты любого элемента, у которого есть закрывающий тег в выделенном тексте, и закрывающие теги в конце фрагмента для любого включенного открывающего тега. Это все сведения, необходимые для базового использования фрагмента HTML.

Перед фрагментом необходимо указать комментарии HTML. <!--StartFragment--> и <!--EndFragment--> (не допускаются пробелы между!--и текстом) для удобного указания места начала и окончания фрагмента. Таким результатом, начало и конец фрагмента обозначаются наличием этих комментариев и Стартфрагмент и Ендфрагмент количество байт в описании. Для их получения требуются средства. Эта избыточность была введена, чтобы быстро найти начало фрагмента (из числа байтов) и пометить расположение фрагмента непосредственно в дереве HTML.

Выбор указывает внутри фрагмента точную HTML-область, выбранную пользователем (например, для копирования). Это добавляет дополнительные сведения к фрагменту, указывая точный выделенный текст без открывающих тегов и закрывающих тегов, которые были добавлены, чтобы убедиться, что фрагмент имеет правильный формат HTML.

Выбор является необязательным, так как в фрагмент для базовых вставлений содержится достаточная информация. Если выделение не сохранено, то Стартселектион и Ендселектион не сохраняются в заголовке.

Контекст представляет собой допустимый полный HTML-документ. В этой статье содержатся фрагменты и все предшествующие Теги (открывающие и закрывающие теги). Эти теги представляют все родительские узлы фрагмента до HTML-узла. Статья также содержит полный заголовок и позволяет включать базовые элементы и названия, например, для получения дополнительных сведений. Приложение, которое копирует фрагмент HTML-кода в буфер обмена, может создать базовый элемент для включения в контекст, если такой элемент еще не существует, чтобы можно было разрешить частичные URL-адреса в фрагменте.

Контекст является необязательным, так как в фрагмент включается достаточная информация для базового размещения фрагмента кода HTML. Если контекст не сохранен, то сохраняется только фрагмент и Старстмл = Ендхтмл =-1.

## <a name="scenarios"></a>Сценарии

В следующих сценариях описывается, как редактор HTML IE4/MSHTML обрабатывает HTML-Вырезание и вставку. другие приложения могут и не следовать этим сценариям. Формат буфера обмена, описанный здесь, предназначен для обеспечения гибкости работы приложения. (В этих сценариях отображается только хороший код HTML, т. е. без перекрывающихся тегов.)

1.  Простой фрагмент кода HTML.
    -   -   Текст HTML:

            <BODY>Это обычный <B>шрифт полужирным </B>начертанием полужирный <I> <B> </B>курсив.</I></BODY>

        -   Отображается как:

            Это обычный **шрифт полужирным** шрифтом    * **полужирный** курсив   *

        -   Текст между \* \* выбранным и скопированным в буфер обмена:

            Это **обычный** \* \* **Шрифт. полужирный** полужирный    * **курсив** .   * \* \* *— курсив*

        -   Это то, что будет находиться в буфере обмена (Обратите внимание, что это IE4/MSHTML):

            Версия: 0.9

            Старстмл: 71

            Ендхтмл: 160

            Стартфрагмент: 130

            Ендфрагмент: 150

            **Стартселектион: 130**

            **Ендселектион: 150**

            <!DOCTYPE ...>

            <BODY>

            <!-- StartFragment -->>

            **<B>полужирный</B><I><B>курсив</B>.</I>**

            <!-- EndFragment -->

            </BODY>

            </HTML>

        -   В этом сценарии в контексте отображаются только тег BODY и HTML-тег, так как он предшествует выбранному фрагменту. Обратите внимание, что открывающие и закрывающие теги включены в контекст. Выделение, разделенное Стартселектион и Ендселектион, выделяется полужирным шрифтом.

2.  Фрагмент таблицы в формате HTML.
    -   -   Текст HTML:

            <BODY><TABLE BORDER><TR><TH ROWSPAN=2>Head1</TH><TD>Элемент 1</TD><TD>Элемент 2</TD><TD>Элемент 3</TD><TD>Элемент 4</TD></TR><TR><TD>Элемент 5</TD><TD>Элемент 6</TD><TD>Элемент 7</TD><TD>Элемент 8</TD></TR><TR><TH>Head2</TH><TD>Элемент 9</TD><TD>Элемент 10</TD><TD>Элемент 11</TD><TD>Элемент 12</TD></TR></TABLE></BODY>

        -   Отображается как: ><TABLE BORDER><TR><TH ROWSPAN=2>Head1</TH><TD>Элемент 1</TD><TD>Элемент 2</TD><TD>Элемент 3</TD><TD>Элемент 4</TD></TR><TR><TD>Элемент 5</TD><TD>Элемент 6</TD><TD>Элемент 7</TD><TD>Элемент 8</TD></TR><TR><TH>Head2</TH><TD>Элемент 9</TD><TD>Элемент 10</TD><TD>Элемент 11</TD><TD>Элемент 12</TD></TR></TABLE><! \[ Корпорация\[\]\]>
        -   Элементы таблицы 6, Item7, Item 10 и Item 11 выбираются в виде блока и копируются в буфер обмена.
        -   Это то, что будет находиться в буфере обмена (Обратите внимание, что это IE4/MSHTML):

            <!DOCTYPE ...>

            <HTML><BODY><TABLE BORDER>

            <!--StartFragment-->

            **<TR><TD>Элемент 6 Item 7, элемент 10, элемент </TD> <TD> </TD> </TR> <TR> <TD> </TD> <TD> 11</TD></TR>**

            <!--EndFragment-->

            </TABLE>

            </BODY></HTML>The selection, as delimited by StartSelection and EndSelection, is shown in bold.

3.  Вставлен фрагмент упорядоченного списка в обычный текст.
    -   -   Текст HTML:

            <BODY><OL TYPE = a><LI>Элемент 1<LI>Элемент 2<LI>Элемент 3<LI>Элемент 4<LI>Элемент 5<LI>Элемент 6</OL></BODY>

        -   Отображается как:
            1.  Элемент 1
            2.  Элемент 2
            3.  Элемент 3
            4.  Элемент 4
            5.  Элемент 5
            6.  Элемент 6
        -   Пользователь выбирает и копирует элементы с 3 по 5 в буфер обмена. Следующий HTML-код находится в буфере обмена:

            <DOCTYPE... ><HTML><BODY><OL TYPE = a>

            <!-- StartFragment-->

            **<LI>Элемент 3, элемент 4, элемент <LI> <LI> 5**

            <!-- EndFragment-->

            </OL></BODY></HTML>

            Выделение, разделенное Стартселектион и Ендселектион, выделяется полужирным шрифтом.

        -   Если теперь этот фрагмент вставлен в пустой документ, будет создан следующий HTML:

            <BODY><OL TYPE = a><LI>Элемент 3<LI>Элемент 4<LI>Элемент 5</OL></BODY>

        -   Отображается как:
            1.  Элемент 3
            2.  Элемент 4
            3.  Элемент 5

4.  Вставлена частично выделенная область.
    -   -   Текст HTML:

            <P> IE4/MSHTML — это редактор WYSIWYG, который поддерживает:<UL><LI>Вырезать<LI>Копировать<LI>Вставить</UL><P>Это отличный инструмент!

        -   Отображается как: IE4/MSHTML — это редактор WYSIWYG, который поддерживает:
            -   -   Вырезать
                -   Копировать
                -   Вставить

        -   Пользователь выбирает из "WYSIWYG" до "COP". Следующий HTML-код находится в буфере обмена:

            <DOCTYPE... ><HTML><BODY>

            <!-- StartFragment-->

            <P>

            **Редактор WYSIWYG, который поддерживает**

            **<UL><LI>Вырезать <LI> COP**

            </UL>

            <!-- EndFragment-->

            </BODY></HTML>The selection, as delimited by StartSelection and EndSelection, is shown in bold.

     
    -   -   Пользователь выбирает "opy" до "отличного".

            Следующий HTML-код находится в буфере обмена:

            <DOCTYPE... ><HTML><BODY>

            <!-- StartFragment-->

            <UL><LI>

            **OPY <LI> Вставить </UL> <P> это отличный**

            </P>

            <!-- EndFragment-->

            </BODY></HTML>

            Выделение, разделенное Стартселектион и Ендселектион, выделяется полужирным шрифтом.

 

 




