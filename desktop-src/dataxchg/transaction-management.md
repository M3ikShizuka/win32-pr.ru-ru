---
title: Управление транзакциями (Exchange данных)
description: В этом разделе обсуждается, как клиент может отсылать транзакции для получения данных и служб с сервера.
ms.assetid: 2d08ffa3-cbd7-4806-b94f-979938322c38
keywords:
- Windows пользовательский интерфейс, Exchange платформа динамических данных (DDE)
- платформа динамических данных Exchange (DDE), транзакции
- DDE (платформа динамических данных Exchange), транзакции
- обмен данными, Exchange платформа динамических данных (DDE)
- Windows пользовательский интерфейс платформа динамических данных библиотека управления Exchange (ддемл)
- библиотека управления платформа динамических данных Exchange (ддемл), транзакции
- ддемл (библиотека управления Exchangeми платформа динамических данных), транзакции
- обмен данными, платформа динамических данныхная библиотека управления Exchange (ддемл)
- платформа динамических данных Exchange (DDE), запросы транзакций
- DDE (платформа динамических данных Exchange), запрос транзакций
- библиотека управления платформа динамических данных Exchange (ддемл), запрос транзакций
- ддемл (библиотека управления Exchangeми платформа динамических данных), запросы транзакций
- платформа динамических данных Exchange (DDE), вставка транзакций
- DDE (платформа динамических данных Exchange), вставка транзакций
- платформа динамических данных библиотека управления Exchange (ддемл), вставка транзакций
- ддемл (платформа динамических данных Exchange библиотека управления), вставка транзакций
- платформа динамических данных Exchange (DDE), рекомендовать транзакции
- DDE (платформа динамических данных Exchange), рекомендовать транзакции
- платформа динамических данных библиотека управления Exchange (ддемл), advise
- ддемл (платформа динамических данных Exchange библиотека управления), advise
- платформа динамических данных Exchange (DDE), выполнение транзакций
- DDE (платформа динамических данных Exchange), выполнение транзакций
- библиотека управления платформа динамических данных Exchange (ддемл), выполнение транзакций
- ддемл (платформа динамических данных Exchange библиотека управления), выполнение транзакций
- платформа динамических данных Exchange (DDE), синхронные транзакции
- DDE (платформа динамических данных Exchange), синхронные транзакции
- платформа динамических данныхная библиотека управления Exchange (ддемл), синхронные транзакции
- ддемл (библиотека управления Exchangeми платформа динамических данных), синхронные транзакции
- платформа динамических данных Exchange (DDE), асинхронные транзакции
- DDE (платформа динамических данных Exchange), асинхронные транзакции
- библиотека управления платформа динамических данных Exchange (ддемл), асинхронные транзакции
- ддемл (библиотека управления Exchangeми платформа динамических данных), асинхронные транзакции
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 570aa48b4dcdbb31855b3e1b15a091908feb2ba4
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127056128"
---
# <a name="transaction-management-data-exchange"></a>Управление транзакциями (Exchange данных)

После установления диалога с сервером клиент может передавать транзакции для получения данных и служб с сервера.

В следующих разделах описываются типы транзакций, которые клиенты могут использовать для взаимодействия с сервером.

-   [Транзакция запроса](#request-transaction)
-   [Вставка транзакции](#poke-transaction)
-   [Рекомендовать транзакцию](#advise-transaction)
-   [Выполнить транзакцию](#execute-transaction)
-   [Синхронные и асинхронные транзакции](#synchronous-and-asynchronous-transactions)
-   [Управление транзакциями](#transaction-control)
-   [Классы транзакций](#transaction-classes)
-   [Типы транзакций](#transaction-types)

## <a name="request-transaction"></a>Транзакция запроса

Клиентское приложение может использовать транзакцию [**\_ запроса кстип**](xtyp-request.md) для запроса элемента данных из серверного приложения. Клиент вызывает функцию [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) , указывая **\_ запрос кстип** в качестве типа транзакции и указывая элемент данных, который требуется приложению.

платформа динамических данныхная библиотека управления Exchange (ддемл) передает на сервер транзакцию [**\_ запроса кстип**](xtyp-request.md) , указывая имя раздела, имя элемента и формат данных, запрошенный клиентом. Если сервер поддерживает запрошенный раздел, элемент и формат, сервер должен вернуть маркер данных, который определяет текущее значение элемента. ДДЕМЛ передает этот обработчик клиенту в качестве возвращаемого значения из [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction). Сервер должен вернуть **значение NULL** , если он не поддерживает запрошенный раздел, элемент или формат.

[**Ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) использует параметр *лпдвресулт* для возвращения клиенту флага состояния транзакции. Если сервер не обрабатывает транзакцию [**\_ запроса Кстип**](xtyp-request.md) , **ддеклиенттрансактион** возвращает **значение NULL**, а *лпдвресулт* указывает на \_ флаг DDE фнотпроцессед или DDE \_ фбуси. Если \_ возвращается флаг DDE фнотпроцессед, клиент не может определить, почему сервер не обработал транзакцию.

Если сервер не поддерживает транзакцию [**\_ запроса кстип**](xtyp-request.md) , он должен указать \_ флаг фильтра неудачных \_ запросов КБФ в функции [**ддеинитиализе**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) . Этот флаг предотвращает отправку ДДЕМЛ транзакции на сервер.

## <a name="poke-transaction"></a>Вставка транзакции

Клиент может отправить незапрошенные данные на сервер с помощью [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) , чтобы отправить транзакцию [**кстип \_**](xtyp-poke.md) в функцию обратного вызова сервера.

Клиентское приложение сначала создает буфер, содержащий данные для отправки на сервер, а затем передает указатель на буфер в качестве параметра [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction). Кроме того, клиент может использовать функцию [**ддекреатедатахандле**](/windows/desktop/api/Ddeml/nf-ddeml-ddecreatedatahandle) для получения маркера данных, определяющего данные, а затем передать его в **ддеклиенттрансактион**. В любом случае клиент также задает имя раздела, имя элемента и формат данных при вызове **ддеклиенттрансактион**.

ДДЕМЛ передает на сервер [**\_ транзакцию кстип**](xtyp-poke.md) , указывая имя раздела, имя элемента и формат данных, запрошенный клиентом. Чтобы принять элемент данных и формат, сервер должен вернуть DDE \_ факк. Чтобы отклонить данные, сервер должен вернуть DDE \_ фнотпроцессед. Если сервер слишком занят для приема данных, сервер должен вернуть DDE \_ фбуси.

Когда [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) возвращает, клиент может использовать параметр *лпдвресулт* для доступа к флагу Transaction-Status. Если флаг имеет значение DDE \_ фбуси, клиент должен отправить транзакцию позже.

Если сервер не поддерживает транзакцию [**кстип, \_**](xtyp-poke.md) он должен указать \_ флаг фильтра КБФ Failed \_ в [**ддеинитиализе**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea). Этот флаг предотвращает отправку этой транзакции сервером ДДЕМЛ.

## <a name="advise-transaction"></a>Рекомендовать транзакцию

Клиентское приложение может использовать ДДЕМЛ для установки одной или нескольких ссылок на элементы в серверном приложении. Если такая связь установлена, сервер отправляет периодические обновления связанного элемента клиенту (как правило, при каждом изменении значения элемента, связанного с серверным приложением). Связывание устанавливает цикл рекомендаций между двумя приложениями, которые остаются на месте, пока клиент не завершит его.

Существует два вида циклов рекомендаций: "горячий" и "тепло". В цикле onadvise сервер немедленно отправляет обработчик данных, который определяет измененное значение. В цикле горячий advise сервер уведомляет клиента о том, что значение элемента изменилось, но не отправляет его, пока клиент не запросит его.

Клиент может запросить цикл рекомендаций с сервером, указав тип транзакции [**кстип \_ адвстарт**](xtyp-advstart.md) в вызове [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction). Чтобы запросить цикл теплого получения рекомендаций, клиент должен объединить флаг КСТИПФ \_ NoData с типом транзакции **кстип \_ адвстарт** . в любом из этих событий ддемл передает транзакцию **\_ адвстарт кстип** в функцию обратного вызова DDE на сервере платформа динамических данных Exchange. Функция обратного вызова DDE сервера должна проверять параметры, сопровождающие транзакцию **кстип \_ адвстарт** (включая запрошенный формат, имя раздела и имя элемента), а затем возвращать **значение true** , чтобы разрешить цикл advise или **значение false** для его запрета.

После установки цикла рекомендаций серверное приложение должно вызывать функцию [**ддепостадвисе**](/windows/desktop/api/Ddeml/nf-ddeml-ddepostadvise) всякий раз, когда значение элемента, связанного с запрошенным именем элемента, изменяется. В результате этого вызова транзакция [**кстип \_ Адврек**](xtyp-advreq.md) отправляется в собственную функцию ОБРАТНОго вызова DDE на сервере. Функция обратного вызова DDE сервера должна возвращать маркер данных, который определяет новое значение элемента данных. Затем ДДЕМЛ уведомляет клиента о том, что указанный элемент изменился путем отправки транзакции [**кстип \_ адвдата**](xtyp-advdata.md) в функцию обратного вызова DDE клиента.

Если клиент запросил цикл onadvise, ДДЕМЛ передает этот обработчик в измененный элемент клиенту во время транзакции [**кстип \_ адвдата**](xtyp-advdata.md) . В противном случае клиент может отправить транзакцию [**\_ запроса кстип**](xtyp-request.md) для получения маркера данных.

Сервер может отсылать обновления быстрее, чем клиенты могут обрабатывать новые данные. Скорость обновления может быть проблемой для клиента, который должен выполнять длительные операции обработки данных. В этом случае клиент должен указать \_ флаг кстипф аккрек при запросе цикла рекомендаций. Этот флаг заставляет сервер ожидать, что клиент получил и обработал элемент данных до того, как сервер отправит следующий элемент данных. Циклы advise, установленные с \_ флагом кстипф аккрек, более надежны при работе с быстрыми серверами, но иногда могут пропускать обновления. Циклы advise, установленные без \_ флага кстипф аккрек, гарантированно не пропускают обновления при условии, что клиент поддерживает сервер.

Клиент может завершить цикл рекомендаций, указав тип транзакции [**кстип \_ адвстоп**](xtyp-advstop.md) в вызове [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).

Если сервер не поддерживает циклы advise, он должен указывать \_ флаг фильтра КБФ Failed \_ advise в функции [**ддеинитиализе**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) . Этот флаг предотвращает отправку ДДЕМЛ [**кстип \_ Адвстарт**](xtyp-advstart.md) и [**кстип \_ адвстоп**](xtyp-advstop.md) транзакций на сервер.

## <a name="execute-transaction"></a>Выполнить транзакцию

Клиент может использовать транзакцию [**кстип \_ EXECUTE**](xtyp-execute.md) , чтобы сервер мог выполнить команду или ряд команд.

Чтобы выполнить команду сервера, клиент сначала создает буфер, содержащий командную строку для выполнения сервера, а затем передает либо указатель на буфер, либо обработчик данных, идентифицирующий буфер при вызове [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction). Другие обязательные параметры включают в себя обработчик диалога, обработчик строки имени элемента, спецификацию формата и тип [**\_ выполнения транзакции кстип**](xtyp-execute.md) . Приложение, которое создает обработчик данных для передачи данных о выполнении, должно указывать **значение NULL** для параметра *хсзитем* функции [**Ддекреатедатахандле**](/windows/desktop/api/Ddeml/nf-ddeml-ddecreatedatahandle) и ноль для параметра *уфмт* .

ДДЕМЛ передает [**\_ исполняемую**](xtyp-execute.md) транзакцию кстип в функцию обратного вызова DDE сервера и задает имя формата, обработчик диалога, имя раздела и обработчик данных, идентифицирующие командную строку. Если сервер поддерживает команду, он должен использовать функцию [**ддеакцессдата**](/windows/desktop/api/Ddeml/nf-ddeml-ddeaccessdata) для получения указателя на командную строку, выполнения команды и возврата DDE \_ факк. Если сервер не поддерживает команду или не может завершить транзакцию, он должен вернуть DDE \_ фнотпроцессед. Сервер должен вернуть DDE \_ фбуси, если он слишком занят для завершения транзакции.

В общем случае функция обратного вызова сервера должна обработать транзакцию [**кстип \_ EXECUTE**](xtyp-execute.md) перед возвратом со следующими исключениями:

1.  Когда команда, передаваемая с помощью транзакции [**кстип \_ EXECUTE**](xtyp-execute.md) , запрашивает прекращение работы сервера, сервер не должен завершаться до тех пор, пока функция обратного вызова не вернется из обработки **кстип \_ EXECUTE**.
2.  Если сервер должен выполнить операцию, например обработку диалогового окна или транзакции DDE, которая может вызвать проблемы рекурсии ДДЕМЛ, то сервер должен вернуть \_ код возврата блока CBR для блокировки выполнения транзакции, выполнения операции и возобновления обработки выполнения транзакции.

Когда [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) возвращает, клиент может использовать параметр *лпдвресулт* для доступа к флагу состояния транзакции. Если флаг имеет значение DDE \_ фбуси, клиент должен отправить транзакцию позже.

Если сервер не поддерживает транзакцию [**кстип \_ EXECUTE**](xtyp-execute.md) , он должен указать \_ флаг фильтра Failed EXECUTEing (сбой КБФ) \_ в функции [**ддеинитиализе**](/windows/desktop/api/Ddeml/nf-ddeml-ddeinitializea) . Это предотвращает отправку ДДЕМЛ транзакции на сервер.

## <a name="synchronous-and-asynchronous-transactions"></a>Синхронные и асинхронные транзакции

Клиент может передавать как синхронные, так и асинхронные транзакции. В синхронной транзакции клиент указывает значение времени ожидания, указывающее на максимальное время ожидания сервером обработки транзакции. [**Ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) не возвращает значение, пока сервер не обработает транзакцию, транзакция завершается ошибкой или истекает время ожидания. Клиент задает значение времени ожидания при вызове **ддеклиенттрансактион**.

Во время синхронной транзакции клиент переходит в модальный цикл во время ожидания обработки транзакции. Клиент по-прежнему может обрабатывать введенные пользователем данные, но не может отправить еще одну синхронную транзакцию, пока [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) не вернет.

Клиент отправляет асинхронную транзакцию, указывая \_ флаг асинхронного времени ожидания в [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction). Функция возвращает значение после начала транзакции, передавая идентификатор транзакции клиенту. Когда сервер завершает обработку асинхронной транзакции, ДДЕМЛ отправляет клиенту транзакцию [**транзакции \_ кстип \_ Complete**](xtyp-xact-complete.md) . Один из параметров, переданный ДДЕМЛ в клиент во время транзакции **кстип транзакций \_ \_ Complete** , — это идентификатор транзакции. Сравнивая этот идентификатор транзакции с идентификатором, возвращенным **ддеклиенттрансактион**, клиент определяет, какая асинхронная транзакция завершается сервером.

Клиент может использовать функцию [**ддесетусерхандле**](/windows/desktop/api/Ddeml/nf-ddeml-ddesetuserhandle) в качестве вспомогательной функции обработки асинхронной транзакции. Эта функция позволяет клиенту связать определяемое приложением значение с маркером диалога и идентификатором транзакции. Клиент может использовать функцию [**ддекуериконвинфо**](/windows/desktop/api/Ddeml/nf-ddeml-ddequeryconvinfo) во время транзакции [**кстип транзакций \_ \_ Complete**](xtyp-xact-complete.md) для получения значения, определяемого приложением. Из-за этой функции приложению не требуется поддерживать список идентификаторов активных транзакций.

Когда клиент успешно завершает запрос данных с помощью синхронной транзакции, ДДЕМЛ не имеет возможности определить, когда клиент завершил использование полученных данных. Клиентское приложение должно передать полученный обработчик данных в функцию [**ддефридатахандле**](/windows/desktop/api/Ddeml/nf-ddeml-ddefreedatahandle) , УВЕДОМЛЯя ддемл о том, что этот маркер больше не используется. Дескрипторы данных, возвращаемые синхронными транзакциями, фактически принадлежат клиенту.

Если сервер своевременно не обрабатывает асинхронную транзакцию, клиент может отказаться от транзакции, вызвав функцию [**ддеабандонтрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeabandontransaction) . ДДЕМЛ освобождает все ресурсы, связанные с транзакцией, и отклоняет результаты транзакции, когда сервер завершает ее обработку. Время ожидания в синхронной транзакции фактически отменяет транзакцию.

Асинхронный метод транзакции предоставляется для приложений, которые должны отправить большое количество транзакций DDE, одновременно выполняя значительный объем обработки, например выполнение вычислений. Асинхронный метод также полезен в приложениях, которые должны временно остановить обработку транзакций DDE, чтобы они могли выполнять другие задачи без прерывания. В большинстве случаев приложение должно использовать синхронный метод.

Синхронные транзакции проще в обслуживании и выполняются быстрее, чем асинхронные транзакции. Однако в каждый момент времени может выполняться только одна синхронная транзакция, в то время как многие асинхронные транзакции могут выполняться одновременно. При использовании синхронных транзакций медленный сервер может привести к тому, что клиент будет оставаться неактивным, пока он ожидает ответа. Кроме того, синхронные транзакции приводят к тому, что клиент вводит модальный цикл, который может обходить фильтрацию сообщений в собственном цикле обработки сообщений приложения.

Если клиент установил процедуру-обработчик для фильтрации сообщений (то есть при указании \_ типа обработчика мсгфилтер в вызове функции [**сетвиндовшукекс**](/windows/desktop/api/winuser/nf-winuser-setwindowshookexa) ), синхронная транзакция не будет приводить к тому, что система обходит процедуру обработчика. При возникновении входного события, когда клиент ожидает завершения синхронной транзакции, процедура-обработчик получает \_ код обработчика мсгф ддемгр. Основной опасность использования модального цикла синхронных транзакций заключается в том, что модальный цикл, созданный с помощью диалогового окна, может повлиять на работу. Асинхронные транзакции всегда следует использовать, если ДДЕМЛ используется библиотекой DLL.

## <a name="transaction-control"></a>Управление транзакциями

Приложение может приостанавливать транзакции обратного вызова по протоколу DDE либо из транзакций, связанных с конкретным обработчиком диалога, либо для всех транзакций независимо от обработчика диалога. Эта возможность полезна, когда приложение получает транзакцию, требующую длительной обработки. В этом случае приложение может вернуть \_ код возврата блока CBR, чтобы приостановить будущие транзакции, связанные с маркером диалога транзакции, чтобы приложение было свободно обрабатывать другие диалоги.

После завершения обработки приложение вызывает функцию [**ддинаблекаллбакк**](/windows/desktop/api/Ddeml/nf-ddeml-ddeenablecallback) для возобновления транзакций, связанных с приостановленным диалогом. Вызов **ддинаблекаллбакк** приводит к повторной отправке ддемл транзакции, которая привела к приостановке диалога приложением. Поэтому приложение должно сохранить результат транзакции таким образом, чтобы он мог получить и вернуть результат без повторной обработки транзакции.

Приложение может приостановить все транзакции, связанные с конкретным обработчиком диалога, указав в \_ вызове [**ддинаблекаллбакк**](/windows/desktop/api/Ddeml/nf-ddeml-ddeenablecallback)маркер и флаг EC Disable. При указании маркера **null** приложение может приостановить все транзакции для всех диалогов.

При приостановке диалога ДДЕМЛ сохраняет транзакции для диалога в очереди транзакций. Когда приложение повторно включает диалог, ДДЕМЛ удаляет сохраненные транзакции из очереди и передает каждую транзакцию в соответствующую функцию обратного вызова. Емкость очереди транзакций велика, но приложение должно повторно включить отложенный диалог как можно скорее, чтобы избежать потери транзакций.

Приложение может возобновить нормальную обработку транзакций, указав \_ флаг EC енаблеалл в [**ддинаблекаллбакк**](/windows/desktop/api/Ddeml/nf-ddeml-ddeenablecallback). Для более контролируемого возобновления обработки транзакций в приложении можно указать \_ флаг EC енаблеоне. Этот флаг удаляет одну транзакцию из очереди транзакций и передает ее в соответствующую функцию обратного вызова. После обработки транзакции все диалоги снова отключаются.

Если флаг EC \_ енаблеоне и обработчик диалога указаны в вызове [**ддинаблекаллбакк**](/windows/desktop/api/Ddeml/nf-ddeml-ddeenablecallback), только этот диалог блокируется после обработки транзакции. Если задан **нулевой** обработчик диалога, все диалоги блокируются после обработки транзакции в любом диалоге.

## <a name="transaction-classes"></a>Классы транзакций

ДДЕМЛ имеет четыре класса транзакций. Каждый класс определяется константой, которая начинается с \_ префикса кскласс. Классы определяются в файле заголовка ДДЕМЛ. Значение класса объединяется со значением типа транзакции и передается функции обратного вызова DDE принимающего приложения.

Класс транзакции определяет возвращаемое значение, которое функция обратного вызова должна возвращать, если обрабатывает транзакцию. Следующие возвращаемые значения и типы транзакций связаны с каждым из четырех классов транзакций.



| Класс                | Возвращаемое значение                                                     | Транзакция                                                                                                                                                                                                                                                                                                                                                                                    |
|----------------------|------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| \_bool кскласс         | **True** или **false**                                            | [**КСТИП \_ адвстарт**](xtyp-advstart.md)<br/> [**КСТИП \_ подключение**](xtyp-connect.md)<br/>                                                                                                                                                                                                                                                                                            |
| \_данные кскласс         | Маркер данных, \_ код возврата блока CBR или **значение NULL** .           | [**КСТИП \_ Адврек**](xtyp-advreq.md)<br/> [**\_запрос кстип**](xtyp-request.md)<br/> [**КСТИП \_ вилдконнект**](xtyp-wildconnect.md)<br/>                                                                                                                                                                                                                                       |
| \_Флаги кскласс        | Флаг транзакции: DDE \_ факк, DDE \_ ФБУСИ или DDE \_ фнотпроцессед | [**КСТИП \_ адвдата**](xtyp-advdata.md)<br/> [**\_выполнение кстип**](xtyp-execute.md)<br/> [**КСТИП \_**](xtyp-poke.md)<br/>                                                                                                                                                                                                                                                   |
| \_уведомление кскласс | None                                                             | [**КСТИП \_ адвстоп**](xtyp-advstop.md)<br/> [**\_подтверждение подключения \_ кстип**](xtyp-connect-confirm.md)<br/> [**КСТИП \_ Отключение**](xtyp-disconnect.md)<br/> [**КСТИП, \_ Ошибка**](xtyp-error.md)<br/> [**КСТИП \_ регистр**](xtyp-register.md)<br/> [**\_Отмена регистрации кстип**](xtyp-unregister.md)<br/> [**\_ \_ Завершено транзакций кстип**](xtyp-xact-complete.md)<br/> |



 

## <a name="transaction-types"></a>Типы транзакций

Каждый тип транзакции DDE имеет приемник и связанное действие, которое приводит к тому, что ДДЕМЛ создает каждый тип.



| Тип транзакции                                       | Получатель                   | Причина                                                                                                                                                                         |
|--------------------------------------------------------|----------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**КСТИП \_ адвдата**](xtyp-advdata.md)                  | Клиент                     | Сервер ответил на транзакцию [**\_ Адврек кстип**](xtyp-advreq.md) , возвращая маркер данных.                                                                          |
| [**КСТИП \_ Адврек**](xtyp-advreq.md)                    | Сервер                     | Сервер, именуемый функцией [**ддепостадвисе**](/windows/desktop/api/Ddeml/nf-ddeml-ddepostadvise) , указывающий, что значение элемента данных в цикле рекомендаций было изменено.                                  |
| [**КСТИП \_ адвстарт**](xtyp-advstart.md)                | Сервер                     | Клиент указал тип транзакции [**кстип \_ адвстарт**](xtyp-advstart.md) в вызове функции [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction) .               |
| [**КСТИП \_ адвстоп**](xtyp-advstop.md)                  | Сервер                     | Клиент указал тип транзакции [**кстип \_ адвстоп**](xtyp-advstop.md) в вызове [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).                              |
| [**КСТИП \_ подключение**](xtyp-connect.md)                  | Сервер                     | Клиент вызывает функцию [**ддеконнект**](/windows/desktop/api/Ddeml/nf-ddeml-ddeconnect) и указал имя службы и имя раздела, поддерживаемые сервером.                                            |
| [**\_подтверждение подключения \_ кстип**](xtyp-connect-confirm.md) | Сервер                     | Сервер вернул **значение true** в ответ на транзакцию [**Кстип \_ Connect**](xtyp-connect.md) или [**кстип \_ вилдконнект**](xtyp-wildconnect.md) .                            |
| [**КСТИП \_ Отключение**](xtyp-disconnect.md)            | Клиентская/серверная библиотека              | Участник в диалоге, именуемый функцией [**ддедисконнект**](/windows/desktop/api/Ddeml/nf-ddeml-ddedisconnect) , в результате чего оба участника получают эту транзакцию.                                    |
| [**КСТИП, \_ Ошибка**](xtyp-error.md)                      | Клиентская/серверная библиотека              | Произошла критическая ошибка. Возможно, у ДДЕМЛ недостаточно ресурсов для продолжения.                                                                                       |
| [**\_выполнение кстип**](xtyp-execute.md)                  | Сервер                     | Клиент указал тип [**\_ выполнения транзакции кстип**](xtyp-execute.md) в вызове [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).                              |
| [**\_монитор кстип**](xtyp-monitor.md)                  | Приложение мониторинга DDE | В системе произошло событие DDE. Дополнительные сведения о приложениях мониторинга DDE см. в разделе [мониторинг приложений](monitoring-applications.md).                       |
| [**КСТИП \_**](xtyp-poke.md)                        | Сервер                     | Клиент указал тип транзакции [**кстип \_**](xtyp-poke.md) в вызове [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).                                    |
| [**КСТИП \_ регистр**](xtyp-register.md)                | Клиентская/серверная библиотека              | Серверное приложение использовало функцию [**дденамесервице**](/windows/desktop/api/Ddeml/nf-ddeml-ddenameservice) для регистрации имени службы.                                                                   |
| [**\_запрос кстип**](xtyp-request.md)                  | Сервер                     | Клиент указал тип транзакции [**\_ запроса кстип**](xtyp-request.md) в вызове [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction).                              |
| [**\_Отмена регистрации кстип**](xtyp-unregister.md)            | Клиентская/серверная библиотека              | Серверное приложение, использующее [**дденамесервице**](/windows/desktop/api/Ddeml/nf-ddeml-ddenameservice) для отмены регистрации имени службы.                                                                              |
| [**КСТИП \_ вилдконнект**](xtyp-wildconnect.md)          | Сервер                     | Клиент вызывает функцию [**ддеконнект**](/windows/desktop/api/Ddeml/nf-ddeml-ddeconnect) или [**Ддеконнектлист**](/windows/desktop/api/Ddeml/nf-ddeml-ddeconnectlist) , указывая **значение NULL** для имени службы, имени раздела или и того и другого. |
| [**\_ \_ Завершено транзакций кстип**](xtyp-xact-complete.md)     | Клиент                     | Асинхронная транзакция, отправленная, когда клиент указал \_ асинхронный флаг timeout в вызове [**ддеклиенттрансактион**](/windows/desktop/api/Ddeml/nf-ddeml-ddeclienttransaction), завершился.         |



 

 

