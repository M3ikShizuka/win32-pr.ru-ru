---
title: Сведения о буфере обмена
description: В этом разделе описывается буфер обмена.
ms.assetid: 14c91730-a668-495b-9ec6-b835234821a5
keywords:
- буфер обмена, сведения
- буфер обмена, форматы
- буфер обмена, команды
- буфер обмена, Windows
- буфер обмена, порядковые номера
- буфер обмена, средства просмотра
- буфер обмена, окна средства просмотра
- буфер обмена, форматы вывода
- буфер обмена, форматы вывода владельцем
- Отображение форматов буфера обмена
- Отображение форматов буфера обмена для владельца
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b94757a95fb8c40152a0018d04cef64e8efae624
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104338764"
---
# <a name="about-the-clipboard"></a>Сведения о буфере обмена

*Буфер обмена* — это набор функций и сообщений, которые позволяют приложениям передавать данные. Поскольку все приложения имеют доступ к буферу обмена, данные могут легко передаваться между приложениями или в приложении.

Буфер обмена управляется пользователем. Окно должно передавать данные в буфер обмена или из него только в ответ на команду от пользователя. Окно не должно использовать буфер обмена для перемещения данных без ведома пользователя.

Объект памяти в буфере обмена может иметь любой формат данных, называемый форматом буфера обмена. Каждый формат определяется целочисленным значением без знака. Для стандартных (предопределенных) форматов буфера обмена это значение является константой, определенной в WinUser. h; для зарегистрированных форматов буфера обмена это возвращаемое значение функции [**регистерклипбоардформат**](/windows/desktop/api/Winuser/nf-winuser-registerclipboardformata) .

За исключением регистрации форматов буфера обмена, отдельные окна выполняют большинство операций с буфером обмена. Как правило, процедура окна передает информацию в буфер обмена или из него в ответ на [**сообщение \_ команды WM**](/windows/desktop/menurc/wm-command) .

В этом разделе рассматриваются следующие вопросы:

-   [Команды буфера обмена](#clipboard-commands)
-   [Порядковый номер буфера обмена](#clipboard-sequence-number)
-   [Средства просмотра буфера обмена](#clipboard-viewers)
    -   [Окна средства просмотра буфера обмена](#clipboard-viewer-windows)
    -   [Форматы представления](#display-formats)
    -   [Формат просмотра владельца](#owner-display-format)
-   [См. также](#related-topics)

## <a name="clipboard-commands"></a>Команды буфера обмена

Пользователь обычно выполняет операции с буфером обмена, выбирая команды из меню " **Правка** " приложения. Ниже приведено краткое описание стандартных команд буфера обмена.



|            |                                                                                                                                                                                                                   |
|------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Вырезать**    | Помещает копию текущего выделенного фрагмента в буфер обмена и удаляет выделенный фрагмент из документа. Предыдущее содержимое буфера обмена уничтожается.                                                          |
| **Копировать**   | Помещает копию текущего выделенного фрагмента в буфер обмена. Документ остается без изменений. Предыдущее содержимое буфера обмена уничтожается.                                                                      |
| **Вставить**  | Заменяет текущий выделенный фрагмент содержимым буфера обмена. Содержимое буфера обмена не изменяется.                                                                                                    |
| **Удалить** | Удаляет текущий выделенный фрагмент из документа. Содержимое буфера обмена не изменяется. Эта команда не затрагивает буфер обмена, но она должна отображаться с командами буфера обмена в меню **Правка** . |



 

## <a name="clipboard-sequence-number"></a>Порядковый номер буфера обмена

Буфер обмена для каждой станции Windows имеет связанный порядковый номер буфера обмена. Это число увеличивается при каждом изменении содержимого буфера обмена. Чтобы получить порядковый номер буфера обмена, вызовите функцию [**жетклипбоардсекуенценумбер**](/windows/desktop/api/Winuser/nf-winuser-getclipboardsequencenumber) .

## <a name="clipboard-viewers"></a>Средства просмотра буфера обмена

Средство просмотра буфера обмена — это окно, в котором отображается текущее содержимое буфера обмена. Окно просмотра буфера обмена является удобным для пользователя и не влияет на функции транзакций с данными в буфере обмена.

Как правило, окно просмотра буфера обмена может отображать по крайней мере три наиболее распространенных формата: **\_ текст CF**, **\_ точечный рисунок CF** и **CF \_ метафилепикт**. Если окно не делает данные доступными ни в одном из этих трех форматов, они должны предоставлять данные в формате вывода или использовать формат, отображаемый владельцем.

*Цепочка средства просмотра буфера обмена* — это связь между двумя или более сущностями, чтобы они зависели друг от друга для операции. Эта зависимость (цепочка) позволяет всем работающим приложениям просмотра буфера обмена принимать сообщения, отправленные в текущий буфер обмена.

В этом разделе рассматриваются следующие темы.

-   [Окна средства просмотра буфера обмена](#clipboard-viewer-windows)
-   [Форматы представления](#display-formats)
-   [Формат просмотра владельца](#owner-display-format)

### <a name="clipboard-viewer-windows"></a>Окна средства просмотра буфера обмена

Окно добавляет себя в цепочку средства просмотра буфера обмена путем вызова функции [**сетклипбоардвиевер**](/windows/desktop/api/Winuser/nf-winuser-setclipboardviewer) . Возвращаемое значение — это обработчик следующего окна в цепочке. Чтобы получить маркер для первого окна в цепочке, вызовите функцию [**жетклипбоардвиевер**](/windows/desktop/api/Winuser/nf-winuser-getclipboardviewer) .

Каждое окно средства просмотра буфера обмена должно вести отслеживание следующего окна в цепочке окна просмотра буфера обмена. При изменении содержимого буфера обмена система отправляет сообщение [**WM \_ дравклипбоард**](wm-drawclipboard.md) в первое окно в цепочке. После обновления экрана каждое окно просмотра буфера обмена должно передать это сообщение в следующее окно в цепочке.

Перед закрытием окно средства просмотра буфера обмена должно удалить само себя из цепочки средства просмотра буфера обмена, вызвав функцию [**чанжеклипбоардчаин**](/windows/desktop/api/Winuser/nf-winuser-changeclipboardchain) . Затем система отправляет сообщение [**WM \_ чанжекбчаин**](wm-changecbchain.md) в первое окно в цепочке.

Дополнительные сведения об обработке сообщений [**WM \_ Дравклипбоард**](wm-drawclipboard.md) и [**WM \_ Чанжекбчаин**](wm-changecbchain.md) см. в разделе [Создание окна просмотра буфера обмена](using-the-clipboard.md).

### <a name="display-formats"></a>Форматы отображения

Формат представления — это формат буфера обмена, используемый для вывода сведений в окне средства просмотра буфера обмена. Владелец буфера обмена, использующий формат закрытого или зарегистрированного буфера обмена, и ни один из наиболее распространенных стандартных форматов, должен предоставить данные в формате отображения для просмотра в окне просмотра буфера обмена. Форматы отображения предназначены только для просмотра и не должны вставляться в документ.

Поддерживаются четыре формата вывода: **CF \_ дспбитмап**, **CF \_ Дспметафилепикт**, **CF \_ дсптекст** и **CF \_ дспенхметафиле**. Эти форматы отображения отображаются так же, как стандартные форматы: **\_ точечный рисунок CF**, **\_ текст CF**, **CF \_ метафилепикт** и **CF \_ енхметафиле**.

### <a name="owner-display-format"></a>Формат просмотра владельца

Для владельца буфера обмена, который не использует обычные стандартные форматы буфера обмена, альтернативой формату представления является использование формата буфера обмена Owner-дисплея (**CF \_ овнердисплай**).

Используя формат отображения «владелец», владелец буфера обмена может избежать издержек на отрисовку данных в дополнительном формате, используя прямое управление рисованием окна просмотра буфера обмена. Окно просмотра буфера обмена отправляет сообщения владельцу буфера обмена при необходимости перерисовки части окна или при прокрутке или изменении размера окна.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Стандартные форматы буфера обмена](standard-clipboard-formats.md)
</dt> </dl>

 

 