---
title: Буфер обмена
description: Буфер обмена — это набор функций и сообщений, которые позволяют приложениям передавать данные.
ms.assetid: vs|winui|~\winui\windowsuserinterface\dataexchange\clipboard.htm
keywords:
- буфер обмена, сведения
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f2196bfa0cc2d0ce7d4eb3aa994461e30e2df752
ms.sourcegitcommit: f0ca63c18dc52c357d3398af7be766d2bdd40be7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/17/2020
ms.locfileid: "104133610"
---
# <a name="clipboard"></a>Буфер обмена

*Буфер обмена* — это набор функций и сообщений, которые позволяют приложениям передавать данные. Поскольку все приложения имеют доступ к буферу обмена, данные могут легко передаваться между приложениями или в приложении.

В этом обзоре не описывается копирование и вставка связанных или внедренных объектов. Сведения об этих темах см. в документации по модели COM.

### <a name="in-this-section"></a>в этом разделе



| Имя                                                          | Описание                                                                                                                                                                                                                                                         |
|---------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [Сведения о буфере обмена](about-the-clipboard.md)<br/>     | Обсуждение буфера обмена.<br/>                                                                                                                                                                                                                                 |
| [Форматы буфера обмена](clipboard-formats.md)<br/>         | Описывает форматы буфера обмена. Окно может поместить в буфер обмена несколько объектов, каждый из которых представляет одни и те же данные в другом формате буфера обмена. Пользователям не нужно знать форматы буфера обмена, используемые для объекта в буфере обмена.<br/> |
| [Операции с буфером обмена](clipboard-operations.md)<br/>   | Описывает операции с буфером обмена. Окно должно использовать буфер обмена при вырезании, копировании или вставлении данных. Окно помещает данные в буфер обмена для операций вырезания и копирования и извлекает данные из буфера обмена для операций вставки.<br/>                  |
| [Формат буфера обмена HTML](html-clipboard-format.md)<br/> | Описывает формат буфера обмена HTML.<br/>                                                                                                                                                                                                                     |
| [Использование буфера обмена](using-the-clipboard.md)<br/>     | Окно просмотра буфера обмена отображает текущее содержимое буфера обмена и получает сообщения при изменении содержимого буфера обмена.<br/>                                                                                                                       |
| [Ссылка на буфер обмена](clipboard-reference.md)<br/>     | Содержит справочник по API.<br/>                                                                                                                                                                                                                              |



 

### <a name="clipboard-functions"></a>Функции буфера обмена



| Имя                                                                              | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|-----------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**аддклипбоардформатлистенер**](/windows/desktop/api/Winuser/nf-winuser-addclipboardformatlistener)<br/>       | Помещает заданное окно в список прослушивателей формата буфера обмена, поддерживаемый системой.<br/>                                                                                                                                                                                                                                                                                                                                                                                |
| [**чанжеклипбоардчаин**](/windows/desktop/api/Winuser/nf-winuser-changeclipboardchain)<br/>                   | Удаляет указанное окно из цепочки средств просмотра буфера обмена. <br/>                                                                                                                                                                                                                                                                                                                                                                                                |
| [**клосеклипбоард**](/windows/desktop/api/Winuser/nf-winuser-closeclipboard)<br/>                               | Закрывает буфер обмена. <br/>                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**каунтклипбоардформатс**](/windows/desktop/api/Winuser/nf-winuser-countclipboardformats)<br/>                 | Извлекает количество различных форматов данных, которые в данный момент находятся в буфере обмена. <br/>                                                                                                                                                                                                                                                                                                                                                                                     |
| [**емптиклипбоард**](/windows/desktop/api/Winuser/nf-winuser-emptyclipboard)<br/>                               | Очищает буфер обмена и освобождает дескрипторы данных в буфере обмена. Затем функция назначает владение буферу обмена окну, в котором в данный момент открыт буфер обмена. <br/>                                                                                                                                                                                                                                                                                    |
| [**енумклипбоардформатс**](/windows/desktop/api/Winuser/nf-winuser-enumclipboardformats)<br/>                   | Перечисляет форматы данных, доступные в данный момент в буфере обмена. <br/> Форматы данных в буфере обмена хранятся в упорядоченном списке. Чтобы выполнить перечисление форматов данных буфера обмена, необходимо выполнить ряд вызовов функции [**енумклипбоардформатс**](/windows/desktop/api/Winuser/nf-winuser-enumclipboardformats) . Для каждого вызова параметр *Format* указывает доступный формат буфера обмена, а функция возвращает следующий доступный формат буфера обмена. <br/>                         |
| [**жетклипбоарддата**](/windows/desktop/api/Winuser/nf-winuser-getclipboarddata)<br/>                           | Извлекает данные из буфера обмена в указанном формате. Буфер обмена должен быть открыт ранее. <br/>                                                                                                                                                                                                                                                                                                                                                       |
| [**жетклипбоардформатнаме**](/windows/desktop/api/Winuser/nf-winuser-getclipboardformatnamea)<br/>               | Извлекает из буфера обмена имя указанного зарегистрированного формата. Функция копирует имя в указанный буфер. <br/>                                                                                                                                                                                                                                                                                                                                |
| [**жетклипбоардовнер**](/windows/desktop/api/Winuser/nf-winuser-getclipboardowner)<br/>                         | Получает маркер окна текущего владельца буфера обмена. <br/>                                                                                                                                                                                                                                                                                                                                                                                             |
| [**жетклипбоардсекуенценумбер**](/windows/desktop/api/Winuser/nf-winuser-getclipboardsequencenumber)<br/>       | Извлекает порядковый номер буфера обмена для текущей станции окна. <br/>                                                                                                                                                                                                                                                                                                                                                                                        |
| [**жетклипбоардвиевер**](/windows/desktop/api/Winuser/nf-winuser-getclipboardviewer)<br/>                       | Получает маркер для первого окна в цепочке окна просмотра буфера обмена. <br/>                                                                                                                                                                                                                                                                                                                                                                                        |
| [**жетопенклипбоардвиндов**](/windows/desktop/api/Winuser/nf-winuser-getopenclipboardwindow)<br/>               | Получает маркер окна, в котором в данный момент открыт буфер обмена. <br/>                                                                                                                                                                                                                                                                                                                                                                                      |
| [**жетприоритиклипбоардформат**](/windows/desktop/api/Winuser/nf-winuser-getpriorityclipboardformat)<br/>       | Извлекает из указанного списка первый доступный формат буфера обмена. <br/>                                                                                                                                                                                                                                                                                                                                                                                          |
| [**жетупдатедклипбоардформатс**](/windows/desktop/api/Winuser/nf-winuser-getupdatedclipboardformats)<br/>       | Извлекает поддерживаемые в настоящее время форматы буфера обмена.<br/>                                                                                                                                                                                                                                                                                                                                                                                                            |
| [**исклипбоардформатаваилабле**](/windows/desktop/api/Winuser/nf-winuser-isclipboardformatavailable)<br/>       | Определяет, содержит ли буфер обмена данные в указанном формате. <br/>                                                                                                                                                                                                                                                                                                                                                                                        |
| [**опенклипбоард**](/windows/desktop/api/Winuser/nf-winuser-openclipboard)<br/>                                 | Открывает буфер обмена для проверки и предотвращает изменение содержимого буфера обмена другими приложениями. <br/>                                                                                                                                                                                                                                                                                                                                                      |
| [**регистерклипбоардформат**](/windows/desktop/api/Winuser/nf-winuser-registerclipboardformata)<br/>             | Регистрирует новый формат буфера обмена. Этот формат затем можно использовать в качестве допустимого формата буфера обмена. <br/>                                                                                                                                                                                                                                                                                                                                                                    |
| [**ремовеклипбоардформатлистенер**](/windows/desktop/api/Winuser/nf-winuser-removeclipboardformatlistener)<br/> | Удаляет заданное окно из списка прослушивателей формата буфера обмена, поддерживаемого системой.<br/>                                                                                                                                                                                                                                                                                                                                                                             |
| [**сетклипбоарддата**](/windows/win32/api/winuser/nf-winuser-setclipboarddata)<br/>                           | Помещает данные в буфер обмена в указанном формате буфера обмена. Окно должно быть владельцем текущего буфера обмена, а приложение должно вызывать функцию [**опенклипбоард**](/windows/win32/api/winuser/nf-winuser-openclipboard) . (При ответе на сообщение [**WM \_ RENDERFORMAT**](wm-renderformat.md) владелец буфера обмена не должен вызывать **Опенклипбоард** перед вызовом [**сетклипбоарддата**](/windows/win32/api/winuser/nf-winuser-setclipboarddata).)<br/> |
| [**сетклипбоардвиевер**](/windows/desktop/api/Winuser/nf-winuser-setclipboardviewer)<br/>                       | Добавляет указанное окно в цепочку средств просмотра буфера обмена. Окно буфера обмена Windows получает сообщение [**WM \_ дравклипбоард**](wm-drawclipboard.md) при каждом изменении содержимого буфера обмена. <br/>                                                                                                                                                                                                                                                           |



 

### <a name="clipboard-messages"></a>Сообщения в буфере обмена



| Имя                                     | Описание                                                                                                                                                                                                                                                             |
|------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**WM \_ clear**](wm-clear.md)<br/> | Отправляются в поле ввода или поля со списком, чтобы удалить (Очистить) текущее выделение (если оно имеется) из элемента управления "поле ввода". <br/>                                                                                                                                                |
| [**\_копия WM**](wm-copy.md)<br/>   | Отправляются в поле ввода или поля со списком для копирования текущего выделения в буфер обмена [**в \_ текстовом формате CF**](standard-clipboard-formats.md) . <br/>                                                                                                       |
| [**Вырезание WM \_**](wm-cut.md)<br/>     | Отправляются в поле ввода или поля со списком для удаления (вырезания) текущего выделения (если таковые имеются) в элементе управления "поле ввода" и копирования удаленного текста в буфер обмена в [**\_ текстовом формате CF**](standard-clipboard-formats.md) . <br/>                                        |
| [**\_Вставка WM**](wm-paste.md)<br/> | Отправляются в поле ввода или поля со списком для копирования текущего содержимого буфера обмена в элемент управления "поле ввода" в текущей позиции курсора. Данные вставляются только в том случае, если буфер обмена содержит данные в [**\_ текстовом формате CF**](standard-clipboard-formats.md) . <br/> |



 

### <a name="clipboard-notifications"></a>Уведомления в буфере обмена



| Имя                                                           | Описание                                                                                                                                                                                                                                                                                                                                                                                                            |
|----------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**WM \_ асккбформатнаме**](wm-askcbformatname.md)<br/>   | Отправляется в окно просмотра владельцу буфера обмена для запроса имени формата буфера обмена [**CF \_ овнердисплай**](standard-clipboard-formats.md) . <br/>                                                                                                                                                                                                                                 |
| [**WM \_ чанжекбчаин**](wm-changecbchain.md)<br/>       | Отправляется в первое окно в цепочке окна просмотра буфера обмена при удалении окна из цепочки. <br/>                                                                                                                                                                                                                                                                                                      |
| [**WM \_ клипбоардупдате**](wm-clipboardupdate.md)<br/>   | Посылается, когда содержимое буфера обмена изменилось.<br/>                                                                                                                                                                                                                                                                                                                                                       |
| [**WM \_ дестройклипбоард**](wm-destroyclipboard.md)<br/> | Отправляется владельцу буфера обмена, когда вызов функции [**емптиклипбоард**](/windows/desktop/api/Winuser/nf-winuser-emptyclipboard) очищает буфер обмена. <br/>                                                                                                                                                                                                                                                                                    |
| [**WM \_ дравклипбоард**](wm-drawclipboard.md)<br/>       | Отправляется в первое окно в цепочке окна просмотра буфера обмена при изменении содержимого буфера обмена. Это позволяет окну просмотра буфера обмена отображать новое содержимое буфера обмена. <br/>                                                                                                                                                                                                                      |
| [**WM \_ хскроллклипбоард**](wm-hscrollclipboard.md)<br/> | Отправляется в окно просмотра владельцу буфера обмена. Это происходит, когда буфер обмена содержит данные в формате [**CF \_ овнердисплай**](standard-clipboard-formats.md) и событие возникает в горизонтальной полосе прокрутки окна буфера просмотра. Владелец должен прокручивать изображение в буфере обмена и обновлять значения полосы прокрутки. <br/>                                                             |
| [**WM \_ паинтклипбоард**](wm-paintclipboard.md)<br/>     | Посылается владельцу буфера обмена в окне средства просмотра буфера обмена, если в буфере обмена содержатся данные в формате [**CF \_ овнердисплай**](standard-clipboard-formats.md) , а клиентская область окна просмотра буфера обмена нуждается в перерисовки. <br/>                                                                                                                                                                    |
| [**WM \_ рендераллформатс**](wm-renderallformats.md)<br/> | Отправляется владельцу буфера обмена до его уничтожения, если владелец буфера обмена откладывает отложенную отрисовку одного или нескольких форматов буфера обмена. Чтобы содержимое буфера обмена оставалось доступным для других приложений, владелец буфера обмена должен визуализировать данные во всех форматах, которые он способен создать, и поместить данные в буфер обмена, вызвав функцию [**сетклипбоарддата**](/windows/desktop/api/Winuser/nf-winuser-setclipboarddata) . <br/> |
| [**WM \_ RENDERFORMAT**](wm-renderformat.md)<br/>         | Отправляется владельцу буфера обмена, если он имеет отложенную визуализацию определенного формата буфера обмена и если приложение запрашивает данные в этом формате. Владелец буфера обмена должен визуализировать данные в указанном формате и поместить их в буфер обмена, вызвав функцию [**сетклипбоарддата**](/windows/desktop/api/Winuser/nf-winuser-setclipboarddata) . <br/>                                                                                              |
| [**WM \_ сизеклипбоард**](wm-sizeclipboard.md)<br/>       | Посылается в буфер обмена владельцем окном средства просмотра буфера обмена, когда буфер обмена содержит данные в формате [**CF \_ овнердисплай**](standard-clipboard-formats.md) , а размер клиентской области средства просмотра буфера обмена изменился. <br/>                                                                                                                                                                    |
| [**WM \_ вскроллклипбоард**](wm-vscrollclipboard.md)<br/> | Посылается владельцу буфера обмена в окне средства просмотра буфера обмена, когда в буфере обмена содержатся данные в формате [**CF \_ овнердисплай**](standard-clipboard-formats.md) , а в вертикальной полосе прокрутки появляется событие. Владелец должен прокручивать изображение в буфере обмена и обновлять значения полосы прокрутки. <br/>                                                                            |



 

### <a name="structures"></a>Структуры



| Имя                                            | Описание                                                                                              |
|-------------------------------------------------|----------------------------------------------------------------------------------------------------------|
| [**метафилепикт**](/windows/win32/api/wingdi/ns-wingdi-metafilepict)<br/> | Определяет формат рисунка метафайла, используемый для обмена данными метафайлов через буфер обмена. <br/> |



 

 

 





