---
title: Регистрация расширений вспомогательного класса NDF
description: С каждым расширением вспомогательного класса связано несколько разделов реестра. Для модели COM требуются некоторые ключи, а для NDF требуются некоторые ключи.
ms.assetid: 9ff3266d-5ffc-4a00-be24-2f85461c6ea6
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 166f07760dc8905f35c82c63d58fa2faa804aeb8
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127067668"
---
# <a name="registering-ndf-helper-class-extensions"></a>Регистрация расширений вспомогательного класса NDF

С каждым расширением вспомогательного класса связано несколько разделов реестра. Для модели COM требуются некоторые ключи, а для NDF требуются некоторые ключи.

## <a name="com-registry-keys"></a>Разделы реестра COM

Расширения вспомогательных классов должны быть реализованы как серверы COM. Регистрация COM должна быть выполнена для каждого расширения вспомогательного класса. Необходимо зарегистрировать CLSID объекта, интерфейс [**инетдиагхелперинфо**](/windows/desktop/api/ndhelper/nn-ndhelper-inetdiaghelperinfo) и интерфейс [**инетдиагхелпер**](/windows/desktop/api/ndhelper/nn-ndhelper-inetdiaghelper) . Регистрация создает ряд разделов реестра, связанных с COM, для расширения вспомогательного класса NDF.

## <a name="ndf-registry-keys"></a>Ключи реестра NDF

Расширения вспомогательных классов должны быть зарегистрированы до взаимодействия с инфраструктурой диагностики сети и с другими связанными вспомогательными классами. Это достигается путем заполнения реестра.

В следующей процедуре показано, как добавить расширения вспомогательных классов в реестр.

1.  Опубликуйте имена вспомогательных классов, реализованных библиотекой DLL, и их зависимости, создав ключ для библиотеки DLL в разделе

    **HKLM \\ System \\ CurrentControlSet \\ Control \\ нетдиагфкс** \\ *ИмяПоставщика* \\ **хостдллс** \\ *DLL Class вспомогательного класса* \\ **хелперклассес** \\ *имя вспомогательного класса*

    Замените *ИмяПоставщика*, *вспомогательный класс DLL* и *имя вспомогательного класса* на определяемые пользователем значения, как описано ниже.

    | Значение               | Тип    | Значение                                                                      |
    |---------------------|---------|------------------------------------------------------------------------------|
    | *VendorName*        | REG \_ SZ | Имя поставщика.                                                      |
    | *DLL-библиотека вспомогательного класса*  | REG \_ SZ | Имя библиотеки DLL без расширения.                                          |
    | *Имя вспомогательного класса* | REG \_ SZ | Имя вспомогательного класса, от которого зависит текущий вспомогательный класс. |

    

     

2.  В каждом ключе *имени вспомогательного класса* опубликуйте следующие сведения.

    

    | Значение         | Тип       | Значение                                                                                                                                                                 |
    |---------------|------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | **ЭТОМУ**     | REG \_ SZ    | Строка, содержащая идентификатор COM-класса вспомогательного класса.                                                                                                            |
    | **Версия**   | REG \_ SZ    | Строка, содержащая основную и дополнительную версии вспомогательного класса в формате &lt; основной &gt; &lt; дополнительный &gt; .                                                        |
    | **Опубликован** | REG \_ DWORD | Значение 1 означает, что этот вспомогательный класс должен вызываться напрямую из клиента диагностики. значение 0 означает, что его можно вызывать только из другого вспомогательного класса. |
    | **Родительский объект**    | REG \_ SZ    | Строка, названная расширяемым вспомогательным классом Майкрософт, который расширяется.                                                                                       |

    

     

3.  Для каждого вспомогательного класса опубликуйте список соответствующих атрибутов, создав ключ в разделе.

    **HKLM \\ System \\ CurrentControlSet \\ Control \\ нетдиагфкс** \\ *ИмяПоставщика* \\ **хостдллс** \\ *DLL классов вспомогательного класса* \\ **хелперклассес** \\ *имя вспомогательного класса* \\ **матчаттрибутес**

    Ключ должен содержать одно или несколько значений (по одному на каждый атрибут) следующего типа.

    | Значение             | Тип                             | Значение                                                                    |
    |-------------------|----------------------------------|----------------------------------------------------------------------------|
    | **AttributeName** | REG \_ SZ \| reg \_ \| \_ двоичный файл реестра | Значение, которое завершает пару "имя-значение" для конкретного атрибута. |

    

     

 

 




