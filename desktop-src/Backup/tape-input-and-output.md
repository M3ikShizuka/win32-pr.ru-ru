---
title: Входные и выходные данные на ленте
description: Существует несколько функций, которые могут использоваться приложениями для выполнения ввода-вывода на ленточном накопителе. Ввод-вывод на магнитную ленту аналогичен вводу-выводу, выполняемому на коммуникационном устройстве.
ms.assetid: 1862c267-0070-4fe8-bb77-40167913978a
keywords:
- Резервная копия входных и выходных данных на ленте
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5946659f1ad0246e37981201e4e08611b45b70b1
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104338492"
---
# <a name="tape-input-and-output"></a>Входные и выходные данные на ленте

Существует несколько функций, которые могут использоваться приложениями для выполнения ввода-вывода на ленточном накопителе. Ввод-вывод на магнитную ленту аналогичен вводу-выводу, выполняемому на коммуникационном устройстве.

При выполнении операций ввода-вывода на магнитной ленте некоторые ленточные накопители хранят сведения о встроенном по ленты в первых нескольких блоках на ленте, обычно используя некоторую часть первых 100 блоков. Приложения не должны использовать эти блоки. Более подробные сведения об этой теме можно найти у отдельных производителей ленточных накопителей. Как правило, приложение, которое пропускает первые 100 блоков на ленте, не позволяет использовать особенности ленточного накопителя.

Функции [**жеттапепоситион**](/windows/desktop/api/Winbase/nf-winbase-gettapeposition) и [**сеттапепоситион**](/windows/desktop/api/Winbase/nf-winbase-settapeposition) извлекают и перемещают текущую положение ленты. Функция [**вритетапемарк**](/windows/desktop/api/Winbase/nf-winbase-writetapemark) записывает заданное число сетмаркс, филемаркс, Short филемаркс и long филемаркс. Функция [**ерасетапе**](/windows/desktop/api/Winbase/nf-winbase-erasetape) стирает всю ленту или ее часть.

Функции [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) и [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) считывают и записывают файловые данные с ленты и на ленту. Данные считываются и записываются на полных блоках. Если размер блока ленты составляет 512 байт, все операции чтения и записи должны использовать буферы, которые являются простым целым числом, кратным этому размеру блока: 512, 1024, 1536, 2048 и т. д. Большинство, если не все, диски разрешают операцию записи только после перезапуска ленты или после того, как операция чтения выдаст сообщение об ошибке конца данных.

Для чтения или записи данных файлов на ленту или из нее в режиме блокировки с переменной длиной выполните следующие действия.

1.  Определите, поддерживает ли ленточный накопитель блочный режим переменной длины, вызвав функцию [**жеттапепараметерс**](/windows/desktop/api/Winbase/nf-winbase-gettapeparameters) и проверив \_ бит блокировки накопителя на магнитной ленте \_ \_ элемента **феатуреслов** в структуре возвращаемых [**\_ \_ \_ параметров накопителя ленты**](/windows/desktop/api/Winnt/ns-winnt-tape_get_drive_parameters) .
2.  Укажите режим размера блока переменной, вызвав функцию [**сеттапепараметерс**](/windows/desktop/api/Winbase/nf-winbase-settapeparameters) , установив **для элемента размерности в** структуре [**\_ \_ \_ параметров носителя набора лент**](/windows/desktop/api/Winnt/ns-winnt-tape_set_media_parameters) нулевое значение. Затем используйте [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) или [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) для чтения или записи данных файла.

Если в [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) обнаруживается метка файла, то считываются данные до метка файла и функция завершается ошибкой. (Функция [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) возвращает код ошибки, указывающий тип обнаруженной метка файла.) Операционная система перемещает ленту после метка файла, и приложение может снова вызвать программу **ReadFile** , чтобы продолжить чтение.

[**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) и [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile) считывают и записывают только поток данных. Функции [**баккупреад**](/windows/desktop/api/Winbase/nf-winbase-backupread) и [**баккупврите**](/windows/desktop/api/Winbase/nf-winbase-backupwrite) считывают и записывают все потоки, связанные с файлом. К ним относятся данные, расширенные атрибуты, безопасность и альтернативные потоки данных. Безопасность и альтернативные потоки данных относятся только к разделу файловой системы NTFS.

Функция [**баккупсик**](/windows/desktop/api/Winbase/nf-winbase-backupseek) ищет файл вперед в файле, изначально доступном с помощью [**баккупреад**](/windows/desktop/api/Winbase/nf-winbase-backupread) или [**баккупврите**](/windows/desktop/api/Winbase/nf-winbase-backupwrite). Эта функция позволяет приложению пропустить сведения, вызывающие ошибки доступа.

Если приложению требуется доступ только к файловым данным, следует использовать [**ReadFile**](/windows/desktop/api/fileapi/nf-fileapi-readfile) и [**WriteFile**](/windows/desktop/api/fileapi/nf-fileapi-writefile). Эти функции также могут считывать альтернативные потоки данных, если потоки были созданы с помощью функции [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) .

Приложение для резервного копирования на магнитной ленте должно использовать [**баккупреад**](/windows/desktop/api/Winbase/nf-winbase-backupread) и [**баккупврите**](/windows/desktop/api/Winbase/nf-winbase-backupwrite) для копирования всех данных, относящихся к файлу. Однако эти функции не считывают и не записывают такие характеристики файлов, как атрибуты, время создания файла и т. д. Приложения должны использовать входные и выходные функции, такие как [**GetFileAttributes**](/windows/desktop/api/fileapi/nf-fileapi-getfileattributesa) и [**сетфилеаттрибутес**](/windows/desktop/api/fileapi/nf-fileapi-setfileattributesa), для извлечения и установки этих значений.

 

 