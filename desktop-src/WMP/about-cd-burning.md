---
title: Сведения о записи компакт-дисков
description: Сведения о записи компакт-дисков
ms.assetid: 1ecc73ed-c49d-4190-baa9-93162f075a4c
keywords:
- проигрыватель Windows Media, запись компакт-дисков
- проигрыватель Windows Media объектной модели, запись компакт-диска
- Объектная модель, запись компакт-диска
- проигрыватель Windows Media ActiveX управления, запись компакт-дисков
- ActiveX управления, запись компакт-дисков
- проигрыватель Windows Media мобильный ActiveX элемент управления, запись компакт-дисков
- проигрыватель Windows Media Мобильные устройства, запись компакт-дисков
- Запись компакт-дисков, о программе
- запись компакт-дисков, сведения
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c784765a09b601da2f0ec75434a37f55a75ff7e6ab6d737f7912daab8f197c07
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119957144"
---
# <a name="about-cd-burning"></a>Сведения о записи компакт-дисков

в пакете SDK для проигрыватель Windows Media 11 появились новые функции для создания компакт-дисков. Этот процесс называется *записью*.

Чтобы перечислить дисководы компакт-дисков на компьютере пользователя, используйте интерфейс **ивмпкдромколлектион** . Чтобы получить указатель на этот интерфейс, вызовите [ивмпкоре:: Get \_ кдромколлектион](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpcore-get_cdromcollection). С помощью методов **Count** и **Item** можно выполнить итерацию коллекции, чтобы получить указатель интерфейса **ивмпкдром** для каждого компакт-дисковода на компьютере пользователя. Интерфейс **ивмпкдром** представляет отдельный компакт-диск.

Перед началом записи компакт-диска необходимо сначала вызвать **QueryInterface** через указатель **ивмпкдром** , чтобы получить указатель на интерфейс **ивмпкдромбурн** . С помощью метода, **доступного** для чтения, можно определить, может ли конкретный компакт-диск записывать компакт-диски, есть ли в дисководе диск и как можно использовать этот компакт-диск.

Чтобы указать элементы для записи на компакт-диск, необходимо создать список воспроизведения. проигрыватель Windows Media представляет списки воспроизведения с помощью интерфейса **ивмпплайлист** . Этот список воспроизведения можно создать любым способом. Например, вы можете просто извлечь список воспроизведения из библиотеки, вызвав [ивмпмедиаколлектион:: жетбялбум](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpmediacollection-getbyalbum). После создания списка воспроизведения, который необходимо записать на компакт-диск, необходимо вызвать метод [ивмпкдромбурн::p UT \_ бурнплайлист](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpcdromburn-put_burnplaylist) и передать указатель списка воспроизведения в качестве аргумента. этот параметр задает список воспроизведения, который проигрыватель Windows Media будет копироваться на компакт-диск.

При извлечении списка воспроизведения из библиотеки все изменения, внесенные в список воспроизведения, будут отражены в библиотеке пользователя. Чтобы избежать этого, вызовите метод [ивмпплайлист:: сетитеминфо](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpplaylist-setiteminfo), передав имя атрибута "Temporary" и значение "true". При этом экземпляр списка воспроизведения преобразуется во временный список воспроизведения, который можно изменить без изменения исходного списка воспроизведения.

Каждый раз, когда вы задаете новый список воспроизведения для записи или вносите изменения в существующий список воспроизведения, необходимо вызвать [ивмпкдромбурн:: рефрешстатус](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpcdromburn-refreshstatus) , чтобы обновить сведения о состоянии. это гарантирует, что проигрыватель Windows Media выполняет необходимую обработку, чтобы предоставить точные сведения о состоянии для операции записи компакт-дисков.

Чтобы указать тип записываемого компакт-диска, вызовите [ивмпкдромбурн::p UT \_ бурнформат](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpcdromburn-put_burnformat). проигрыватель Windows Media позволяет записывать два типа компакт-дисков: аудио компакт-диски и компакт-диски с данными. Перечисление [вмпбурнформат](/previous-versions/windows/desktop/api/wmp/ne-wmp-wmpburnformat) определяет типы компакт-дисков.

Вы можете указать метку тома для компакт-диска, вызвав [ивмпкдромбурн::p UT \_ Label](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpcdromburn-put_label).

Когда вы будете готовы начать запись компакт-диска, вызовите [ивмпкдромбурн:: стартбурн](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpcdromburn-startburn). Ход выполнения операции записи можно отслеживать, периодически вызывая [ивмпкдромбурн:: Get \_ бурнпрогресс](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpcdromburn-get_burnprogress). Этот метод получает значение хода выполнения для всей операции записи. Полученное значение является числом, представляющим процент завершенной записи. Состояние операции записи можно отслеживать, обрабатывая событие [IWMPEvents3:: кдромбурнстатечанже](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpevents3-cdromburnstatechange) , которое использует перечисление [вмпбурнстате](/previous-versions/windows/desktop/api/wmp/ne-wmp-wmpburnstate) для указания текущего состояния. Необходимо внимательно сравнить указатель **ивмпкдромбурн** (предоставленный событием) с указателем, который представляет операцию записи, чтобы убедиться, что событие было вызвано операцией. Можно прерывать операцию записи путем вызова [ивмпкдромбурн:: стопбурн](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpcdromburn-stopburn).

Существует два события, которые можно выполнять для получения уведомлений об ошибках операции записи. Событие [IWMPEvents3:: кдромбурнеррор](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpevents3-cdromburnerror) возникает при возникновении универсальной ошибки. [IWMPEvents3:: кдромбурнмедиаеррор](/previous-versions/windows/desktop/api/wmp/nf-wmp-iwmpevents3-cdromburnmediaerror) возникает, когда конкретный элемент мультимедиа вызывает ошибку во время записи. Как и событие **кдромбурнстатечанже** , каждое из этих событий предоставляет указатель **ивмпкдромбурн** , представляющий операцию записи, вызвавшую событие. Событие **кдромбурнмедиаеррор** предоставляет указатель **IDispatch** , представляющий элемент мультимедиа, вызвавший событие. С помощью этого указателя можно вызвать метод **QueryInterface** , чтобы получить указатель **ивмпмедиа** .

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[**Сведения об объектной модели проигрывателя**](about-the-player-object-model.md)
</dt> <dt>

[**Интерфейс Ивмпкдром**](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpcdrom)
</dt> <dt>

[**Интерфейс Ивмпкдромбурн**](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpcdromburn)
</dt> <dt>

[**Интерфейс Ивмпкдромколлектион**](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpcdromcollection)
</dt> <dt>

[**Интерфейс IWMPEvents3**](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpevents3)
</dt> <dt>

[**Интерфейс Ивмпмедиа**](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpmedia)
</dt> <dt>

[**Интерфейс Ивмпплайлист**](/previous-versions/windows/desktop/api/wmp/nn-wmp-iwmpplaylist)
</dt> <dt>

[**Временный атрибут**](temporary-attribute.md)
</dt> </dl>

 

 




