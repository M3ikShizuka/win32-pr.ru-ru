---
title: Предоставление пользовательского интерфейса
description: Предоставление пользовательского интерфейса
ms.assetid: 43a0cfea-4f35-4c4a-97f5-a3787b597dc5
keywords:
- Подключаемые модули проигрывателя Windows Media, страницы свойств
- подключаемые модули, страницы свойств
- подключаемые модули обработки цифровых сигналов, страницы свойств
- Подключаемые модули DSP, страницы свойств
- подключаемые модули обработки цифровых сигналов, Пользовательский интерфейс
- Подключаемые модули DSP, Пользовательский интерфейс
- страницы свойств
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 22d708d1256faf7096d15a7596a9635a33173d22
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104258823"
---
# <a name="providing-a-user-interface"></a>Предоставление пользовательского интерфейса

Подключаемые модули DSP могут предоставить страницу свойств для создания пользовательского интерфейса. Для этого подключаемый модуль должен содержать объект страницы свойств, предоставляющий реализацию интерфейса **ипропертипаже** . Подключаемый объект DSP должен реализовывать **испеЦифипропертипажес::** GetObject, что позволяет проигрывателю Windows Media находить и определять правильную страницу свойств для подключаемого модуля.

**Отображение изображения состояния**

Подключаемые модули DSP могут отображать небольшое изображение или ряд графических изображений в области состояния проигрывателя Windows Media, чтобы уведомить пользователя о том, что подключаемый модуль активен. Для поддержки этой функции подключаемый модуль должен реализовать интерфейс **ипропертибаг** . Проигрыватель Windows Media вызывает **ипропертибаг:: Read**, предоставляя указатель на имя запрошенного свойства "иконстреамс", которое учитывает регистр, и указатель на структуру **Variant** , которая получает данные для графика. Подключаемый модуль создает объект **IStream** (или SafeArray объектов **IStream** , если имеется несколько изображений), затем загружает графические данные, включая сведения о заголовке, в поток, а затем возвращает указатель на объект **IStream** , используя элемент **пунквал** структуры **Variant** . Если подключаемый модуль предоставляет только один рисунок, он указывает элемент **VT** в структуре **Variant** как VT \_ Unknown. Если подключаемый модуль предоставляет несколько графических объектов **IStream** , использующих SAFEARRAY, он задает элемент **VT** в структуре **Variant** в качестве \_ массива VT.

Графика может храниться в различных форматах файлов, включая:

**BMP**

Изображения точечных рисунков Microsoft Windows несжаты.

**JPEG**

Сжатый формат изображения, обычно используемый для веб-страниц. Файлы формата JPEG обычно имеют расширение JPG.

**GIF**

Сжатый формат изображения, обычно используемый для веб-страниц.

**ФАЙЛЕ**

Сжатый формат изображения, обычно используемый для веб-страниц.

Максимальное количество измерений для графических элементов DSP составляет 38 пикселей в ширину и 14 пикселей в высоком масштабе.

Байтовый поток **IStream** , содержащий изображение состояния, должен включать сведения о заголовке. Без сведений о заголовке проигрыватель Windows Media не может правильно определить тип графика, поэтому не будет загружать изображение.

## <a name="related-topics"></a>См. также

<dl> <dt>

[**Обзор подключаемого модуля DSP**](dsp-plug-in-developer-overview.md)
</dt> </dl>

 

 




