---
title: Предоставление пользовательского интерфейса
description: Предоставление пользовательского интерфейса
ms.assetid: 43a0cfea-4f35-4c4a-97f5-a3787b597dc5
keywords:
- подключаемые модули проигрыватель Windows Media, страницы свойств
- подключаемые модули, страницы свойств
- подключаемые модули обработки цифровых сигналов, страницы свойств
- Подключаемые модули DSP, страницы свойств
- подключаемые модули обработки цифровых сигналов, Пользовательский интерфейс
- Подключаемые модули DSP, Пользовательский интерфейс
- страницы свойств
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fb80525fa4b32845608eebb32752871a038aa6e01088baeebce5bc5f8c84b4bb
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "117746742"
---
# <a name="providing-a-user-interface"></a>Предоставление пользовательского интерфейса

Подключаемые модули DSP могут предоставить страницу свойств для создания пользовательского интерфейса. Для этого подключаемый модуль должен содержать объект страницы свойств, предоставляющий реализацию интерфейса **ипропертипаже** . подключаемый объект DSP должен реализовывать **испеЦифипропертипажес::** getobject, что позволяет проигрыватель Windows Media находить и определять правильную страницу свойств для подключаемого модуля.

**Отображение изображения состояния**

подключаемые модули DSP могут отображать небольшое изображение или ряд графических объектов в области состояния проигрыватель Windows Media, чтобы уведомить пользователя о том, что подключаемый модуль активен. Для поддержки этой функции подключаемый модуль должен реализовать интерфейс **ипропертибаг** . проигрыватель Windows Media вызывает **ипропертибаг:: Read**, предоставляя указатель на имя запрошенного свойства "иконстреамс", которое учитывает регистр, и указатель на структуру **VARIANT** , которая получает данные для графика. Подключаемый модуль создает объект **IStream** (или SafeArray объектов **IStream** , если имеется несколько изображений), затем загружает графические данные, включая сведения о заголовке, в поток, а затем возвращает указатель на объект **IStream** , используя элемент **пунквал** структуры **Variant** . Если подключаемый модуль предоставляет только один рисунок, он указывает элемент **VT** в структуре **Variant** как VT \_ Unknown. Если подключаемый модуль предоставляет несколько графических объектов **IStream** , использующих SAFEARRAY, он задает элемент **VT** в структуре **Variant** в качестве \_ массива VT.

Графика может храниться в различных форматах файлов, включая:

**BMP**

битовые изображения Microsoft Windows не сжаты.

**Рисунок**

Сжатый формат изображения, обычно используемый для веб-страниц. Файлы формата JPEG обычно имеют .jpg расширений имен файлов.

**ФАЙЛ**

Сжатый формат изображения, обычно используемый для веб-страниц.

**ФАЙЛЕ**

Сжатый формат изображения, обычно используемый для веб-страниц.

Максимальное количество измерений для графических элементов DSP составляет 38 пикселей в ширину и 14 пикселей в высоком масштабе.

Байтовый поток **IStream** , содержащий изображение состояния, должен включать сведения о заголовке. без сведений о заголовке проигрыватель Windows Media не может правильно определить тип графика и, следовательно, не будет загружать изображение.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[**Обзор подключаемого модуля DSP**](dsp-plug-in-developer-overview.md)
</dt> </dl>

 

 




