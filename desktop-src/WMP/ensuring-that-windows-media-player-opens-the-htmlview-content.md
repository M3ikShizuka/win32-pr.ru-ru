---
title: Обеспечение открытия проигрывателем Windows Media содержимого Хтмлвиев
description: Обеспечение открытия проигрывателем Windows Media содержимого Хтмлвиев
ms.assetid: 4ec4e027-4f9c-4a86-9f70-b4014971c070
keywords:
- Списки воспроизведения метафайлов Windows Media, проигрыватель Windows Media открытие содержимого Хтмлвиев
- списки воспроизведения, проигрыватель Windows Media открытие содержимого Хтмлвиев
- списки воспроизведения метафайлов, проигрыватель Windows Media открытие содержимого Хтмлвиев
- Списки воспроизведения метафайлов Windows Media, открытие содержимого Хтмлвиев
- списки воспроизведения, открытие содержимого Хтмлвиев
- списки воспроизведения метафайлов, открытие содержимого Хтмлвиев
- открытие содержимого Хтмлвиев
- Проигрыватель Windows Media, открытие содержимого Хтмлвиев
- Проигрыватель Windows Media, Хтмлвиев содержимое
- Хтмлвиев, открытие содержимого
ms.topic: article
ms.date: 05/31/2018
topic_type:
- kbArticle
api_name: ''
api_type: ''
api_location: ''
ms.openlocfilehash: 3d3220be44fcc33b3657fb115b0bb57d07d1b928
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "103776511"
---
# <a name="ensuring-that-windows-media-player-opens-the-htmlview-content"></a>Обеспечение открытия проигрывателем Windows Media содержимого Хтмлвиев

В настоящее время проигрыватель Windows Media 9 Series и проигрыватель Windows Media 10 являются единственными игроками, которые поддерживают параметр *хтмлвиев* в файлах ASX. Это означает, что необходимо предпринять шаги по обеспечению воспроизведения содержимого Хтмлвиев в этих версиях проигрывателя Windows Media.

Сначала необходимо определить, установлен ли на компьютере пользователя ряд проигрывателя Windows Media 9 или Windows Media Player 10. В состав пакета SDK для проигрывателя Windows Media входит полный пример, демонстрирующий обнаружение различных версий проигрывателя Windows Media в различных веб-браузерах. Несмотря на то, что полный анализ образца обнаружения выходит за рамки этого раздела, существует ряд основных шагов, которые можно предпринять, чтобы определить, какая версия проигрывателя Windows Media используется на компьютере пользователя.

В простейшей форме обнаружение проигрывателя Windows Media включает внедрение элемента управления проигрывателя в веб-страницу, ссылающуюся на содержимое Хтмлвиев, а затем проверку значения, полученного *проигрывателем*. Свойство **versionInfo** . Убедившись, что у пользователя установлен ряд Windows Media Player 9 или Windows Media Player 10, можно открыть содержимое в проигрывателе в полноэкранном режиме с помощью метода [Player. опенплайер](player-openplayer.md) . Метод **опенплайер** гарантирует, что содержимое будет отображаться в **воспроизводимой** функции проигрывателя в полноэкранном режиме, а не в обложке, в режиме мини-проигрывателя или в другом проигрывателе, который зарегистрировал себя как программа по умолчанию для файлов с расширением. ASX, но не поддерживает хтмлвиев. Однако после отображения содержимого пользователь получает полный контроль над проигрывателем Windows Media, что означает, что он может выбрать отображение функции, отличной от **воспроизводимого**, переключения в режим обложки или даже выход из проигрывателя.

В следующем примере кода создается веб-страница для Internet Explorer. На этой странице открывается ASX-файл, указывающий веб-страницу Хтмлвиев, которая отображается в полноэкранном режиме при установленном проигрывателе Windows Media 9 Series или более поздней версии.


```XML
<HTML>
<BODY>

<!-- This code embeds the Player object in invisible mode. -->
<OBJECT id = "Player" 
    CLASSID = "CLSID:6BF52A52-394A-11d3-B153-00C04F79FAA6" height = 0 width = 0> 
        <PARAM Name = "AutoStart"  Value = "True">
        <PARAM Name = "uiMode" Value = "invisible">
</OBJECT>

<!-- Create a button to open the content. -->
<INPUT Type = "Button"  ID = "btnPlay"  Value = "Play ASX"  onClick = "PlayASX();"/>

<SCRIPT Language = "JScript">

// This function tests the Player version. If it is Windows Media 
// Player 9 Series or later, the script opens the .asx file in the full-mode 
// Player. Otherwise, the script makes the embedded control visible to 
// the user and opens the .asx file in the webpage. 

function PlayASX()
{
    if(parseInt(Player.versionInfo) >= 9)
        {
            // Open the full-mode Player to show HTMLView.
            Player.openPlayer("https://www.proseware.com/MyHTMLView.asx");
        }
        else
        {
            // Open the .asx file in the embedded Player.
            Player.uiMode = "full";
            Player.height = 200;
            Player.width = 200;
            Player.URL = "https://www.proseware.com/MyHTMLView.asx";
        }
}
</SCRIPT>

</BODY>
</HTML>

```



Код в предыдущем примере внедряет элемент управления проигрывателя Windows Media со свойством **uiMode** , установленным в "Невидимый", а атрибуты Height и Width проигрывателя устанавливаются в ноль. Это связано с тем, что веб-страница не требует первоначального отображения пользовательского интерфейса управления проигрывателем — ему нужен только доступ к объектной модели проигрывателя. На странице также отображается кнопка ввода, позволяющая пользователю воспроизвести ASX-файл.

Когда пользователь нажимает кнопку Воспроизвести ASX, выполняется функция Microsoft JScript Плайаскс. Эта функция сначала извлекает значение для свойства Player **versionInfo** , используя метод JScript **parseInt** для проверки числового значения извлекаемой строки. Если числовое значение больше или равно 9 (то есть у пользователя установлен ряд Windows Media 9 Series), код скрипта вызывает метод **опенплайер** , передавая URL-адрес файла. ASX, содержащего параметр хтмлвиев. Этот метод открывает ASX-файл с помощью проигрывателя Windows Media в полноэкранном режиме, воспроизводит мультимедийное содержимое в файле списка ASX и отображает веб-содержимое Хтмлвиев в **воспроизводимой** функции.

Если числовое значение строки версии не больше или равно 9 (это означает, что на компьютере пользователя не установлен проигрыватель Windows Media 9 или более поздней версии), код скрипта изменяет **uiMode** элемента управления проигрывателя на «Full», устанавливает новую ширину и высоту для элемента управления, а затем открывает ASX-файл во внедренном проигрывателе, указывая значение свойства **URL** . В этом случае мультимедийное содержимое воспроизводится на веб-странице, но все значения Хтмлвиев, указанные в файле ASX, игнорируются.

Способ воспроизведения содержимого, когда у пользователя не установлен проигрыватель Windows Media 9 Series или проигрыватель Windows Media 10 не работает. В предыдущем примере показано, как указать, что содержимое воспроизводится на веб-странице, а не в полноэкранном проигрывателе, игнорируя содержимое Хтмлвиев в процессе. Есть и другие подходы, которые вы можете предпринять. Например, можно предложить пользователю установить более новую версию проигрывателя Windows Media, сделав эту версию проигрывателя требованием к воспроизведению цифрового мультимедийного содержимого.

## <a name="related-topics"></a>См. также

<dl> <dt>

[**Отображение веб-страниц в проигрывателе Windows Media**](displaying-web-pages-in-windows-media-player.md)
</dt> <dt>

[**Player. uiMode**](player-uimode.md)
</dt> <dt>

[**Player. URL**](player-url.md)
</dt> </dl>

 

 




