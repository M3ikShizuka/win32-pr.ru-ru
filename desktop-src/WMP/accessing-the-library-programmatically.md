---
title: Программный доступ к библиотеке
description: Программный доступ к библиотеке
ms.assetid: f48fbb49-5b79-4a78-af72-8509c460a149
keywords:
- Проигрыватель Windows Media, Библиотека
- Объектная модель проигрывателя Windows Media, Библиотека
- Объектная модель, Библиотека
- Элемент управления ActiveX проигрывателя Windows Media, Библиотека для объектной модели
- Элемент управления ActiveX, Библиотека для объектной модели
- Элемент управления ActiveX мобильных устройств Windows Media Player, Библиотека для объектной модели
- Проигрыватель Windows Media Mobile, Библиотека для объектной модели
- Библиотека проигрывателя Windows Media, доступ программным способом
- Библиотека, доступ
- программный доступ к библиотеке проигрывателя Windows Media
- Библиотека проигрывателя Windows Media, добавление элементов мультимедиа
- Библиотека, добавление элементов мультимедиа
- Библиотека проигрывателя Windows Media, получение элементов мультимедиа
- Библиотека, получение элементов мультимедиа
- Библиотека проигрывателя Windows Media, удаление элементов мультимедиа
- Библиотека, удаление элементов мультимедиа
- Добавление элементов мультимедиа в библиотеку проигрывателя Windows Media
- Извлечение элементов мультимедиа из библиотеки проигрывателя Windows Media
- Удаление элементов мультимедиа из библиотеки проигрывателя Windows Media
- получение метаданных
- Библиотека проигрывателя Windows Media, получение метаданных из элементов мультимедиа
- Библиотека, получение метаданных из элементов мультимедиа
- метаданные, извлечение
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d40e03e91b2a67a24cb49b0ac1810ceb7b9544c9
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104411154"
---
# <a name="accessing-the-library-programmatically"></a>Программный доступ к библиотеке

В коде библиотека представлена объектом **медиаколлектион** (или интерфейсом **ивмпмедиаколлектион** ). Элементы мультимедиа представлены как объекты **мультимедиа** (или интерфейс **ивмпмедиа** ). Элементы списка воспроизведения представляются как объекты **списков воспроизведения** (или интерфейс **ивмпплайлист** ). Для простоты этот раздел будет просто ссылаться на имена объектов, когда это возможно.

С помощью объекта **медиаколлектион** можно работать с элементами мультимедиа и списками воспроизведения. Библиотека также предоставляет объект **плайлистколлектион** (или интерфейс **ивмпплайлистколлектион** ), который предоставляет некоторые функциональные возможности, характерные для работы с списками воспроизведения. В большинстве случаев объект **медиаколлектион** предоставит вам необходимые вам функции даже при работе с списками воспроизведения. Дополнительные сведения о работе с элементами мультимедиа см. в разделе [Управление элементами мультимедиа](managing-media-items.md). Дополнительные сведения о работе с списками воспроизведения см. в разделе [Управление списками воспроизведения](managing-playlists.md).

## <a name="adding-media-items-to-the-library"></a>Добавление элементов мультимедиа в библиотеку

Добавление цифрового мультимедийного содержимого в библиотеку — это просто. Просто вызовите метод [медиаколлектион. Add](mediacollection-add.md) , указав путь к файлу мультимедиа в качестве аргумента.

## <a name="retrieving-media-items-from-the-library"></a>Получение элементов мультимедиа из библиотеки

При извлечении элементов мультимедиа из библиотеки вы действительно получаете список воспроизведения. Даже если предполагается получение только одного элемента мультимедиа, будет получен объект **списка воспроизведения** , содержащий один элемент, который будет связан с нулевым индексом. Например, если требуется получить объект **мультимедиа** , представляющий песню с именем «жеанне», можно использовать следующий код JScript:


```C++
// Retrieve media named Jeanne from the library.
var playlist = player.mediaCollection.getByName("Jeanne");

```



Приведенный выше код извлекает список воспроизведения, содержащий все элементы мультимедиа с именем «Жеанне» в качестве заголовка. В этом примере предположим, что имеется только одна песня с этим именем в библиотеке (Обратите внимание, что библиотека поддерживает несколько песен, имеющих одно и то же имя). Это означает, что количество элементов в списке воспроизведения, которое вы извлекли, можно считать равным одному, а элемент мультимедиа будет представлен нулевым индексом. Следующий пример кода продолжит предыдущий пример, чтобы продемонстрировать, как можно извлечь элемент мультимедиа из списка воспроизведения с помощью метода renесли [. Item](playlist-item.md) .


```C++
// Retrieve the individual media item from the playlist.
var media = playlist.item(0);

```



Дополнительные сведения о получении элементов мультимедиа из списков воспроизведения см. в разделе [списки воспроизведения и элементы мультимедиа статьи](playlists-and-media-items.md) [Управление проигрывателем](player-control-guide.md).

## <a name="retrieving-metadata-from-a-media-item"></a>Получение метаданных из элемента мультимедиа

После получения объекта **мультимедиа** можно считать значения атрибутов, связанные с содержимым. В самом простом случае может быть просто известно одно значение, например имя исполнителя, выполнившего музыкальную запись. В следующем примере JScript показано, как использовать метод [Media. getItemInfo](media-getiteminfo.md) для получения имени исполнителя из носителя, полученного в предыдущем примере:


```C++
// Retrieve the artist name string.
var author = media.getItemInfo("Artist");

```



Элемент мультимедиа может иметь множество различных атрибутов, и работа с метаданными не всегда так проста, как простой вариант, показанный в предыдущем примере. Например, некоторые атрибуты могут содержать несколько значений или иметь значения более чем на одном языке. Дополнительные сведения о работе с метаданными см. в разделе [атрибуты элементов мультимедиа](media-item-attributes.md). Дополнительные сведения о различных атрибутах, их значениях и поддержке типов файлов см. в [справочнике по атрибутам](attribute-reference.md).

## <a name="removing-media-items-from-the-library"></a>Удаление элементов мультимедиа из библиотеки

Удаление мультимедийного содержимого из библиотеки также упрощается. Просто вызовите **медиаколлектион. Remove**, указав объект **мультимедиа** , представляющий элемент в качестве первого аргумента, и значение **true** в качестве второго. В следующем примере JScript файл с именем Жеанне (полученный в предыдущем примере) удаляется из библиотеки:


```C++
// Remove Jeanne from the library.
playst.mediaCollection.remove(media, true);

```



## <a name="related-topics"></a>См. также

<dl> <dt>

[**Сведения о библиотеке**](about-the-library.md)
</dt> <dt>

[**Сведения об объектах Медиаколлектион и Media**](about-the-mediacollection-and-media-objects.md)
</dt> <dt>

[**Сведения об объектах списков воспроизведения, Плайлистколлектион и Плайлистаррай**](about-the-playlist--playlistcollection--and-playlistarray-objects.md)
</dt> <dt>

[**Работа с библиотекой**](working-with-the-library.md)
</dt> </dl>

 

 




