---
title: Простой пример создания сценариев на веб-странице
description: Простой пример создания сценариев на веб-странице
ms.assetid: c6d6954e-f684-4dc1-8b9c-c5fc3cab7421
keywords:
- Проигрыватель Windows Media, внедрение элемента управления ActiveX
- Объектная модель проигрывателя Windows Media, внедрение элемента управления ActiveX
- Объектная модель, внедрение элемента управления ActiveX
- Проигрыватель Windows Media Mobile, внедрение элемента управления ActiveX
- Элемент управления ActiveX проигрывателя Windows Media, внедрение
- Мобильный элемент управления ActiveX проигрывателя Windows Media, внедрение
- Элемент управления ActiveX, внедрение
- Элемент управления ActiveX проигрывателя Windows Media, веб-страницы
- Элемент управления мобильными устройствами ActiveX проигрывателя Windows Media, веб-страницы
- Элемент управления ActiveX, веб-страницы
- Элемент управления ActiveX проигрывателя Windows Media, пример сценария
- Элемент управления ActiveX проигрывателя Windows Media для мобильных устройств, пример сценария
- Элемент управления ActiveX, пример сценария
- внедрение, веб-страницы
- Внедрение веб-страниц, пример сценария
- Пример сценария для внедрения веб-страниц
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b9616bd4032a1b2d7e70916b545db30289995eb4
ms.sourcegitcommit: e22adfb0dd3bb989e59455baedb4d905a877a240
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/21/2019
ms.locfileid: "105700731"
---
# <a name="simple-example-of-scripting-in-a-web-page"></a>Простой пример создания сценариев на веб-странице

Вы можете легко внедрить элемент управления проигрывателя Windows Media в HTML-файл, используя любой язык сценариев, распознаваемый браузером. В следующем простом примере используется Microsoft JScript для создания страницы, которая будет воспроизводить файл при нажатии кнопки, и прекращает воспроизведение файла при нажатии на другую кнопку.

Элемент управления ActiveX проигрывателя Windows Media можно внедрить на веб-страницу, выполнив следующие четыре шага:

1.  Создайте веб-страницу.
2.  Добавьте тег объекта.
3.  Добавьте пользовательский интерфейс. В этом случае две кнопки.
4.  Добавьте несколько строк кода, чтобы ответить, когда пользователь щелкнет одну из созданных кнопок.

## <a name="creating-the-web-page"></a>Создание веб-страницы

Первым шагом является создание допустимой веб-страницы HTML. Следующий код является минимальным необходимым для создания пустой, но допустимой HTML-страницы:


```HTML
<HTML>
    <HEAD>
    </HEAD>
    <BODY>
    </BODY>
</HTML>

```



## <a name="adding-the-object-tag"></a>Добавление тега объекта

После создания веб-страницы необходимо добавить тег объекта. Он определяет элемент управления ActiveX для браузера и настраивает начальные определения. Тег объекта необходимо поместить в тело кода. Если поместить его в текст, будет отображаться пользовательский интерфейс по умолчанию проигрывателя Windows Media. Если вы хотите создать собственный пользовательский интерфейс, установите атрибуты Height и Width равными 0 (ноль). Можно также задать *проигрыватель*. **uiMode** свойство в «невидимый», если необходимо скрыть элемент управления, но на странице зарезервируется место для него. При предоставлении настраиваемого пользовательского интерфейса рекомендуется использовать следующий код:


```HTML
<OBJECT ID="Player" height="0" width="0"
  CLASSID="CLSID:6BF52A52-394A-11d3-B153-00C04F79FAA6">
</OBJECT>

```



Требуются следующие атрибуты тега объекта:

ID

Имя, которое будет использоваться другими частями кода для обнаружения и использования элемента управления ActiveX. Можно выбрать любое имя, если оно еще не используется HTML, HTML-расширениями или используемым языком сценариев. В этом примере используется имя Player, но можно также вызвать его «MyPlayer» или что-то другое. Просто выберите уникальное для этой веб-страницы имя.

КЛАССА

Очень большое шестнадцатеричное число, уникальное для элемента управления. Только один элемент управления имеет это число и является элементом управления ActiveX проигрывателя Windows Media. Чтобы предотвратить типографские ошибки, можно скопировать и вставить этот номер из документации. Версии элемента управления проигрывателя Windows Media до версии 7,0 имеют другой идентификатор CLASSID.

## <a name="adding-a-user-interface"></a>Добавление пользовательского интерфейса

HTML обеспечивает обширное множество элементов пользовательского интерфейса, позволяя пользователю взаимодействовать с веб-страницей, щелкая, нажимая клавиши и другие действия пользователя. Добавление нескольких кнопок ввода — самый простой способ предоставить быстрый пользовательский интерфейс. Следующий код создает две кнопки, которые могут отвечать пользователю. При нажатии одной кнопки запускается поток мультимедиа, а другая кнопка останавливается.


```HTML
<INPUT TYPE="BUTTON" NAME="BtnPlay" VALUE="Play" OnClick="StartMeUp()">
<INPUT TYPE="BUTTON" NAME="BtnStop" VALUE="Stop" OnClick="ShutMeDown()">

```



Имя кнопки используется для распознавания кнопки в коде. значение — это метка, которая будет отображаться на кнопке, а атрибут onclick определяет, какая часть кода скрипта будет вызываться при нажатии кнопки.

## <a name="adding-scripting-code"></a>Добавление кода скрипта

Код скрипта добавляет интерактивность на страницу. Код скрипта может реагировать на события, вызывать методы и изменять свойства времени выполнения. Расширенные скрипты заключаются в набор тегов СКРИПТа. Тег SCRIPT сообщает браузеру, где находится код скрипта, и определяет язык сценариев. Если язык не определен, языком по умолчанию будет Microsoft JScript.

Рекомендуется заключать сценарий в теги комментариев HTML, чтобы браузеры, не поддерживающие скрипты, не отображали код в виде текста. Поместите тег СКРИПТа в любом месте текста HTML-файла и внедрите код, заключенный в комментарий, в открывающий и закрывающий теги СКРИПТа.

Следующий пример кода Microsoft JScript вызывает элемент управления проигрывателя Windows Media и выполняет соответствующее действие в ответ на нажатие соответствующей кнопки.


```HTML
<SCRIPT>
<!--

function StartMeUp ()
{
    Player.URL = "laure.wma";
}

function ShutMeDown ()
{
    Player.controls.stop();
}

-->
</SCRIPT>

```



Пример функции Стартмеуп вызывается при нажатии кнопки Play, а функция Шутмедовн вызывается при нажатии кнопки "Закрыть".

Код внутри Стартмеуп использует свойство URL-адреса для определения пути к носителю. Воспроизведение носителя начнется немедленно.

Код Шутмедовн вызывает метод **останавливает** объекта **Controls** . Обратите внимание, что объект **Controls** вызывается через свойство **Controls** объекта **Player** , имеющего значение идентификатора "Player".

Ниже приведен полный пример кода.


```HTML
<HTML>
<HEAD>
</HEAD>
<BODY>
<OBJECT ID="Player" height="0" width="0"
  CLASSID="CLSID:6BF52A52-394A-11d3-B153-00C04F79FAA6">
</OBJECT>
<INPUT TYPE="BUTTON" NAME="BtnPlay" VALUE="Play" OnClick="StartMeUp()">
<INPUT TYPE="BUTTON" NAME="BtnStop" VALUE="Stop" OnClick="ShutMeDown()">
<SCRIPT>
<!--

function StartMeUp ()
{
    Player.URL = "laure.wma";
}

function ShutMeDown ()
{
    Player.controls.stop();
}

-->
</SCRIPT>
</BODY>
</HTML>

```



Обратите внимание, что необходимо указать допустимый URL-адрес в качестве допустимого имени файла в свойстве URL-адреса. В этом случае предполагается, что файл Лауре. WMA находится в том же каталоге, что и HTML-файл.

## <a name="related-topics"></a>См. также

<dl> <dt>

[**Использование элемента управления проигрывателя Windows Media на веб-странице**](using-the-windows-media-player-control-in-a-web-page.md)
</dt> </dl>

 

 




