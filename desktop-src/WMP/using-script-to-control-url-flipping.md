---
title: Использование сценария для управления перелистыванием URL-адресов
description: Использование сценария для управления перелистыванием URL-адресов
ms.assetid: ec504ecf-10ef-4b90-bee6-8d149c251ee5
keywords:
- проигрыватель Windows Media, веб-презентации
- проигрыватель Windows Media объектной модели, веб-презентации
- Объектная модель, веб-презентации
- проигрыватель Windows Media Мобильные веб-презентации
- проигрыватель Windows Media ActiveX элемент управления, веб-презентации
- проигрыватель Windows Media мобильные ActiveX управления, веб-презентации
- ActiveX элемент управления, веб-презентации
- проигрыватель Windows Media, перелистывание URL-адресов
- проигрыватель Windows Mediaая объектная модель, перелистывание URL-адресов
- Объектная модель, перелистывание URL-адресов
- проигрыватель Windows Media Мобильный, зеркальное отображение URL-адресов
- проигрыватель Windows Media элемент управления ActiveX, перелистывание URL-адресов
- проигрыватель Windows Media управление мобильными ActiveXми, перелистывание URL-адресов
- элемент управления ActiveX, перелистывание URL-адресов
- Веб-презентации, перелистывание URL-адресов
- Создание веб-презентаций, перелистывание URL-адресов
- Перелистывание URL-адресов
- проигрыватель Windows Media, мультимедийная потоковая передача мультимедиа
- объектная модель проигрыватель Windows Media, мультимедийная потоковая передача мультимедиа
- Объектная модель, многофункциональная потоковая передача мультимедиа
- проигрыватель Windows Media Мобильные устройства, мультимедийная потоковая передача
- проигрыватель Windows Media ActiveX элемент управления, мультимедийная потоковая передача мультимедиа
- проигрыватель Windows Media мобильный ActiveX элемент управления, мультимедийная потоковая передача мультимедиа
- ActiveX управления, мультимедийная потоковая передача мультимедиа
- Веб-презентации, многофункциональная потоковая передача мультимедиа
- Создание веб-презентаций, многофункциональная потоковая передача мультимедиа
- Мультимедийная потоковая передача мультимедиа
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9470bf2b812d36bceb6159ab089e3b08c49bc84515320872b125ed6519568141
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119507134"
---
# <a name="using-script-to-control-url-flipping"></a>Использование сценария для управления перелистыванием URL-адресов

когда пользователь подключается к многофункциональному потоку мультимедиа, пока поток уже выполняется, потоковая веб-страница может отображаться до того, как все элементы будут получены и кэшированы, если проигрыватель Windows Media автоматически вызывает URL-адрес. В этом случае пользователь видит пустую или неполную веб-страницу, пока следующий набор данных не поступит в кэш.

можно избежать отображения пустой или неполной веб-страницы, вызвав URL-адрес с помощью сценария вместо того, чтобы позволить проигрыватель Windows Media выполнять его автоматически. Таким образом, можно пропустить первый URL-адрес отражения, а затем вызвать последующие URL-адреса с помощью кода скрипта.

> [!Note]  
> в этом разделе предполагается, что вы используете потоковую передачу html с помощью пакета SDK для Windows Media Encoder 9, и что поток HTML был настроен для повторения.

 

Сначала необходимо создать веб-страницу набора фреймов, содержащую фрейм с внедренным проигрывателем, и фрейм, отображающий HTML-код потоковой передачи. Каждый из этих двух кадров изначально будет отображать отдельную веб-страницу, поэтому вы создадите всего три веб-страницы. В следующем примере кода показана веб-страница FRAMESET:


```HTML
<HTML>
<HEAD>
</HEAD>

<FRAMESET cols = "350, *">
  <FRAME  name = "player" src = "embed_player.htm">
  <FRAME  name = "content" src = "blank.htm">

  <NOFRAMES>
  <BODY>

  <P>This page uses frames, but your browser doesn't support them.</P>

  </BODY>
  </NOFRAMES>

</FRAMESET>
</HTML>

```



Предыдущий пример веб-страницы включает два кадра. Первый кадр отображается в левой половине окна браузера и отображает веб-страницу с именем embed \_player.htm. В следующем примере кода создается эта веб-страница:


```HTML
<HTML>
<HEAD>
</HEAD>
<BODY>

<!-- Embed Windows Media Player and disable the invokeURLs parameter -->
<OBJECT CLASSID = "CLSID:6BF52A52-394A-11D3-B153-00C04F79FAA6" ID = "Player">
  <PARAM name = "URL"  value = "https://www.proseware.com/Media/video.wmv">
  <PARAM name = "invokeURLs"  value = "false">
</OBJECT>

<SCRIPT LANGUAGE = "JScript">
  var bFirstURL = true; // Global flag for first URL flip.
</SCRIPT>

<!-- Create an event handler for script commands. -->
<SCRIPT LANGUAGE = "JScript"  FOR = "Player" EVENT = "ScriptCommand(scType, scParam)">

  if("URL" == scType)
  {
    if ( bFirstURL == false )
    {
      // Show the next URL flip.
      parent.content.location = scParam;
    }
    else
    {
      bFirstURL = false; // Set the flag.
    }
  }

</SCRIPT>

</BODY>
</HTML>

```



Второй кадр в наборе фреймов отображается в правой половине окна браузера и отображает веб-страницу с именем "blank.htm". В следующем примере кода создается эта веб-страница:


```HTML
<HTML>
<HEAD>
</HEAD>
<BODY>

Loading...
</BODY>
</HTML>

```



Когда страница набора фреймов загружается в браузере, в левом фрейме отображается встроенный проигрыватель, а в правой — текст "Загрузка...". для информирования пользователя о том, что повышены дополнительные данные. Когда команда сценария First URL поступает из потока HTML, обработчик событий просто изменяет значение **логического** флага. При появлении каждой последующей команды сценария URL-адреса из потока HTML скрипт в обработчике событий загружает новый URL-адрес в кадр с именем "содержимое", а вся веб-страница отображается в рамке, расположенной в правой половине окна браузера.

дополнительные сведения о потоковой передаче HTML с помощью Windows Media см. в разделе пакет SDK для Windows media Encoder.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[**Мультимедийная потоковая передача мультимедиа**](rich-media-streaming.md)
</dt> <dt>

[**Перелистывание URL-адресов**](url-flipping.md)
</dt> </dl>

 

 




