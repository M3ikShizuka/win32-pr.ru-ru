---
title: Переход между областями задач службы
description: Переход между областями задач службы
ms.assetid: cb26a26d-a80d-4af5-9c5f-fab01129d83c
keywords:
- Интернет-магазины проигрывателя Windows Media, Навигация
- Интернет-магазины, Навигация
- Тип 2 Интернет-магазинов, Навигация
- Интернет-магазины проигрывателя Windows Media, области задач службы
- Интернет-магазины, области задач службы
- Введите 2 Интернет-магазина, области задач службы
- Интернет-магазины проигрывателя Windows Media, области задач
- Интернет-магазины, области задач
- Введите 2 Интернет-магазина, области задач
- Навигация по типу 2 Интернет-магазинов
- Проигрыватель Windows Media, области задач службы
- Проигрыватель Windows Media, области задач
- области задач службы
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 86035215f822c67bb40c528f141422977efc8653
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104329979"
---
# <a name="navigating-between-service-task-panes"></a>Переход между областями задач службы

Для перехода между областями задач службы в проигрывателе Windows Media используется метод **навигатетаскпанеурл** , доступный с помощью объекта **Window. external** . При использовании этого метода необходимо указать значения для трех параметров:

-   *бстркэйнаме*. Это имя ключа Интернет-магазина. При переходе в Интернет-магазине используйте имя ключа текущего хранилища.
-   *бстртаскпане*. Эта строка содержит имя области задач службы, к которой необходимо выполнить переход.
-   *бстрпарамс*. Эта строка содержит параметры строки запроса, которые необходимо добавить к URL-адресу веб-страницы, размещенной в области задач службы, к которой необходимо выполнить переход.

Управление навигацией осуществляется с помощью создаваемой веб-страницы, которая называется «Навигация». URL-адрес страницы навигации задается элементом **navigate** в документе serviceInfo. При вызове **Навигатетаскпанеурл** проигрыватель Windows Media открывает страницу Навигация, а не веб-страницу, заданную элементами **ServiceTask1**, **ServiceTask2** или **ServiceTask3** . Это страница навигации, которая получает строку запроса, указанную параметром *бстрпарамс*. Страница Навигация должна содержать правила, определяющие, какое содержимое отображается в области задач службы после перемещения.

Например, предположим, что вы хотите, чтобы пользователи щелкнули ссылку для перехода с **ServiceTask1** на **ServiceTask2**. Для создания ссылки можно использовать следующий HTML-код:


```C++
<A HREF = "javascript:window.external.NavigateTaskPaneURL('MSSampleMusic', 'ServiceTask2', 'From=Music&To=2')">Video</A>

```



Когда пользователь щелкает ссылку на видео, проигрыватель Windows Media переключается на **ServiceTask2** и открывает страницу навигации, добавляя следующую строку запроса к URL-адресу.


```C++
?From=Music&To=2

```



Параметр From определяет страницу, с которой пользователь щелкнул ссылку, а параметр to определяет номер области задач службы, которой он хочет перейти. (Обратите внимание, что нет ничего особенного об этих параметрах. Вы можете использовать любые параметры для любой выбранной цели.)

Например, в следующем примере кода показан элемент **navigate** в документе serviceInfo:


```C++
<Navigate
        BaseURL = "https://www.proseware.com/service/html/navigate.asp">
```



Итоговый URL-адрес, полный запрос со строкой запроса, показан в следующем примере:


```C++
https://www.proseware.com/service/html/navigate.asp?From=Music&To=2

```



В следующем примере кода показана страница «Навигация»:


```C++
<%
    Dim sURL
    Dim sQS
    Dim sTo

    sURL = ""
    sQS = Request.ServerVariables("QUERY_STRING")
    sTo = "" & Request.QueryString("To")
 
    Select Case sTo
       Case "1" sURL = sURL & "Music_Music.asp"
       Case "2" sURL = sURL & "Music_Video.asp"
       Case "3" sURL = sURL & "Music_Radio.asp"
       Case Else sURL = sURL & "Music_Music.asp"
    End Select
     
    sURL = sURL & "?" & sQS

    Response.Redirect(sURL)    
%>

```



Приведенный выше код просто создает URL-адрес и перенаправляет в него браузер. Сначала код получает значения из строки запроса URL-адреса и самой строки запроса. Для определения отображаемой страницы используется значение параметра to. Затем в URL-адрес добавляется исходная строка запроса. И, наконец, он перейдет в браузер, используя URL-адрес следующего вида:


```C++
https://www.proseware.com/service/html/Video.asp?locale=409&geoid=f4&version=10.0.0.3600&userlocale=409&From=Music&To=2

```



При таком способе навигации не забудьте указать [External. селектедтаскпане](external-selectedtaskpane.md) , чтобы правильно выделить кнопку задачи.

-   **Предупреждение об ошибке** Будьте внимательны при использовании параметров строки запроса для навигации.

Веб-страницы Хтмлвиев могут предоставляться любым пользователем, который создает список воспроизведения ASX. Это означает, что вредоносные веб-сайты могут передавать значения строк запросов в Интернет-магазин с помощью **навигатетаскпанеурл**. Необходимо спланировать эту возможность, чтобы обеспечить безопасность Интернет-магазина. Например, если в Интернет-магазине просто отображается значение строки запроса для пользователя, вредоносный веб-сайт может отобразить непредвиденный текст.

## <a name="related-topics"></a>См. также

<dl> <dt>

[**Отображение веб-страниц в проигрывателе Windows Media**](displaying-web-pages-in-windows-media-player.md)
</dt> <dt>

[**Элемент Navigate**](navigate-element.md)
</dt> <dt>

[**Навигация для Интернет-магазинов типа 2**](navigation-for-type-2-online-stores.md)
</dt> </dl>

 

 




