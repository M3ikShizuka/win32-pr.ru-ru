---
title: Событие команду скрипта объекта Аксвиндовсмедиаплайер
description: Событие команду скрипта возникает при получении синхронизированной команды или URL-адреса. | Событие команду скрипта объекта Аксвиндовсмедиаплайер
ms.assetid: b6c613b2-f1b0-43d3-9992-c01d1e00e644
keywords:
- Событие команду скрипта в проигрывателе Windows Media объекта Аксвиндовсмедиаплайер
topic_type:
- apiref
api_name:
- ScriptCommand Event of the AxWindowsMediaPlayer Object
api_location:
- AxInterop.WMPLib.dll
api_type:
- Assembly
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 49d004fbfc265784ef77969258ff168670d9907f
ms.sourcegitcommit: c8ec1ded1ffffc364d3c4f560bb2171da0dc5040
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2021
ms.locfileid: "105695042"
---
# <a name="scriptcommand-event-of-the-axwindowsmediaplayer-object"></a>Событие команду скрипта объекта Аксвиндовсмедиаплайер

Событие команду скрипта возникает при получении синхронизированной команды или URL-адреса.

``` syntax
[C#]
private void player_ScriptCommand(
  object sender,
  _WMPOCXEvents_ScriptCommandEvent e
)

[Visual Basic]
Private Sub player_ScriptCommand(  
  sender As Object, 
  e As _WMPOCXEvents_ScriptCommandEvent
) Handles player.ScriptCommand
```

## <a name="event-data"></a>Данные о событиях

Обработчик, связанный с этим событием, имеет тип **аксвмплиб. \_ Вмпокксевентс \_ скрипткоммандевенсандлер**. Этот обработчик получает аргумент типа **аксвмплиб. \_ Вмпокксевентс \_ скрипткоммандевент**, который содержит следующие свойства, связанные с этим событием.



| Свойство | Описание                                                   |
|----------|---------------------------------------------------------------|
| сктипе   | System. СтрингспеЦифиес тип команды сценария.<br/> |
| param    | System. СтрингспеЦифиес. команда сценария.<br/>         |



 

## <a name="remarks"></a>Комментарии

Команды можно внедрять из звуков и изображений в файл или поток Windows Media. Команды представляют собой пару строк в Юникоде, связанных с назначенным временем в потоке. Когда поток достигнет времени, связанного с командой, элемент управления проигрывателя Windows Media отправляет событие **команду скрипта** с двумя параметрами. Один параметр указывает тип отправляемой команды, а другой параметр задает команду. Тип параметра используется для определения способа обработки параметра команды. Любой тип команды может быть внедрен в файл или поток для обработки событием **команду скрипта** .

В следующей таблице перечислены типы команд сценариев, которые автоматически обрабатываются проигрывателем Windows Media.



| Тип                   | Описание                                                                                                                                                         |
|------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| CAPTION                | Элемент управления отображает связанный текст в элементе HTML, указанном параметром Ивмпклоседкаптион. **каптионингид**.                                                       |
| ЖУРНАЛЕ                  | Элемент управления выполняет инструкции, определенные для указанного события.                                                                                                  |
| ФАЙЛОВ               | Элемент управления сбрасывает свойство **URL-адреса** , пытается открыть указанный файл и немедленно начинает воспроизведение нового потока.                                        |
| опеневент              | Помещает связанную команду типа события в буфер для своевременного выполнения скрипта события.                                                                                 |
| синчронизедлириклирик | Параметр *param* содержит синхронизированный текст лирик. Проигрыватель Windows Media отображает текст лирик в области скрытых субтитров в **воспроизводимой** функции. |
| TEXT                   | Элемент управления отображает связанный текст в элементе HTML, указанном параметром Ивмпклоседкаптион. **каптионингид**.                                                       |
| URL-адрес                    | Элемент управления автоматически открывает URL-адрес, указанный в браузере по умолчанию, если используется Ивмпсеттингс. Свойство **инвокеурлс** имеет значение true.                    |



 

Можно внедрить любой другой тип команды при условии, что код обрабатывает команду. Хотя неизвестные команды игнорируются элементом управления проигрывателем Windows Media, они по-прежнему передаются в событие **команду скрипта** .

Событие команду скрипта не вызывается, если файл сканируется в режиме перемотки вперед или назад.

Команды URL-адреса, получаемые элементом управления проигрывателем Windows Media, вызываются автоматически в веб-браузере по умолчанию, если Ивмпсеттингс. Свойство **инвокеурлс** имеет значение true. Можно использовать Ивмпсеттингс. Свойство **дефаултфраме** для указания целевого фрейма, в котором отображается веб-страница.

URL-адрес, отправляемый проигрывателю Windows Media, обрабатывается относительно базового URL-адреса, указанного параметром Ивмпсеттингс. Свойство **baseURL** . Базовый URL-адрес объединяется с относительным URL-адресом, что приводит к полному URL-адресу, который передается событием **команду скрипта** в качестве параметра команды.

Элемент управления проигрывателя Windows Media всегда обрабатывает команды входящих URL-адресов следующим образом:

1.  Получена команда типа URL-адреса.
2.  Ивмпсеттингс. **baseURL** используется для создания полного URL-адреса из относительного URL-адреса, указанного в команде скрипта.
3.  Вызывается **команду скрипта** .
4.  После **команду скрипта** возвращает ивмпсеттингс. **инвокеурлс** .
5.  Если Ивмпсеттингс. **инвокеурлс** имеет значение true, а команда является командой URL-адреса, вызывается указанный URL-адрес. Если Ивмпсеттингс. **инвокеурлс** имеет значение false или команда не является командой URL-адреса, команда игнорируется.

При создании файла Windows Media можно указать кадр, в котором будет отображаться новый URL-адрес, объединяя два амперсанда и имя кадра в поле параметра. В следующем примере показаны типичные параметры **команду скрипта** . Он указывает, что URL-адрес *MyPage* должен быть запущен в кадре *мифраме* .


```CSharp
scType = "URL"
Param = https://myweb/mypage.html&&myframe
```



Событие команду скрипта не вызывается, если файл сканируется (перемотка или перемотка вперед).

## <a name="requirements"></a>Требования



| Требование | Значение |
|----------------------|----------------------------------------------------------------------------------------------------------------------------|
| Версия<br/>   | Проигрыватель Windows Media 9 Series или более поздней версии<br/>                                                                          |
| Пространство имен<br/> | **аксвмплиб**<br/>                                                                                                    |
| Сборка<br/>  | <dl> <dt>AxInterop.WMPLib.dll (AxInterop.WMPLib.dll.dll)</dt> </dl> |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**Объект Аксвиндовсмедиаплайер (VB и C#)**](axwindowsmediaplayer-object--vb-and-c.md)
</dt> <dt>

[**Аксвиндовсмедиаплайер. URL (VB и C#)**](axwmplib-axwindowsmediaplayer-url--vb-and-c.md)
</dt> <dt>

[**Ивмпклоседкаптион. Каптионингид (VB и C#)**](wmplibiwmpclosedcaption-iwmpclosedcaption-captioningid--vb-and-c.md)
</dt> <dt>

[**Ивмпсеттингс. baseURL (VB и C#)**](wmplibiwmpsettings-iwmpsettings-baseurl--vb-and-c.md)
</dt> <dt>

[**Ивмпсеттингс. Дефаултфраме (VB и C#)**](wmplibiwmpsettings-iwmpsettings-defaultframe--vb-and-c.md)
</dt> <dt>

[**Ивмпсеттингс. Инвокеурлс (VB и C#)**](wmplibiwmpsettings-iwmpsettings-invokeurls--vb-and-c.md)
</dt> </dl>

 

 





