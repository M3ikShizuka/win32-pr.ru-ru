---
title: Списки воспроизведения и элементы мультимедиа
description: Списки воспроизведения и элементы мультимедиа
ms.assetid: 281c744d-380e-4200-8585-a3f378bc1c36
keywords:
- проигрыватель Windows Media, списки воспроизведения
- объектная модель проигрыватель Windows Media, списки воспроизведения
- Объектная модель, списки воспроизведения
- проигрыватель Windows Media Мобильные устройства, списки воспроизведения
- проигрыватель Windows Media ActiveX элемент управления, списки воспроизведения
- проигрыватель Windows Media управление мобильными ActiveXми, списки воспроизведения
- элемент управления ActiveX, списки воспроизведения
- списки воспроизведения, элементы мультимедиа
- списки воспроизведения метафайлов, элементы мультимедиа
- Windows Списки воспроизведения метафайлов мультимедиа, элементы мультимедиа
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 95ef42f4c79c8239af9278532c8bd09e320725a9d3bb36b361995e25fa905257
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119862084"
---
# <a name="playlists-and-media-items"></a>Списки воспроизведения и элементы мультимедиа

Список воспроизведения — это набор элементов мультимедиа. Объект **списка воспроизведения** может управлять объектами **мультимедиа** , представляющими эти элементы.

## <a name="retrieving-media-items"></a>Получение элементов мультимедиа

Для существующего списка воспроизведения можно прочитать *список воспроизведения*. **Count** свойство, чтобы определить, сколько элементов мультимедиа находится в списке воспроизведения, и вы можете получить ссылку на объект **мультимедиа** , соответствующий определенному элементу, с помощью *списка воспроизведения*. Свойство **элемента** .

Следующий пример на C# извлекает ссылку на объект для определенного элемента мультимедиа. (В этом разделе переменная *pList* является ссылкой на объект **списка воспроизведения** .)


```C++
currMedia = pList.Item(0);

```



Следующий пример на C# извлекает имена всех элементов мультимедиа в списке воспроизведения и помещает их в ListBox с именем Лстаутпут.


```C++
for (j=0; j < pList.count; j++)
{
    strItemName = pList.get_Item(j).name;
    lstOutput.Items.Add(strItemName);
}

```



## <a name="adding-items-to-a-playlist"></a>Добавление элементов в список воспроизведения

Элемент мультимедиа можно добавить в конец списка воспроизведения или в заданную позицию в списке воспроизведения с помощью *списка воспроизведения*. **аппендитем** и *список воспроизведения*. методы **insertItem** .

В этом разделе объект **Player** был определен следующим образом:


```C++
AxWMPLib.AxWindowsMediaPlayer Player;
using WMPLib;

```



В следующем примере C# показаны обе методики, добавляя текущий элемент мультимедиа в список воспроизведения с именем «Блуестест», сначала в конце, а затем в начале списка воспроизведения.


```C++
IWMPPlaylistCollection pListColl;
IWMPPlaylistArray pListArray;
IWMPPlaylist pList;

// Initialize the Media object
IWMPMedia currMedia = Player.currentMedia;

if(currMedia != null)
{
    // Retrieve the playlist collection
    pListColl = Player.playlistCollection;

    // Retrieve a playlist array containing
    // playlists named BluesTest
    pListArray = pListColl.getByName("BluesTest");

    // Retrieve the first element with this name from the
    // array.
    pList = pListArray.Item(0);

    // Add the current item to the end, and then, the beginning
    // of the specified playlist.
    pList.appendItem(currMedia);
    pList.insertItem(0, currMedia);
}

```



При создании нового пустого списка воспроизведения с помощью *плайлистколлектион*. метод **невплайлист** . к нему можно добавить элементы мультимедиа путем повторного вызова *списка воспроизведения*. метод **аппендитем** .

## <a name="manipulating-media-items-in-a-playlist"></a>Управление элементами мультимедиа в списке воспроизведения

Вы можете изменить расположение элемента мультимедиа в списке воспроизведения с помощью *списка воспроизведения*. метод **мовеитем** . Вы указываете элемент по его текущему индексу, а затем указываете новый индекс. В следующем примере C# элемент с индекса 5 перемещается в индекс 0 в списке воспроизведения.


```C++
// Move the 6th item to the beginning
// of the specified playlist.
pList.moveItem(5, 0);

```



Вы можете удалить элемент мультимедиа из списка воспроизведения с помощью **списка воспроизведения**. метод **RemoveItem** . Обратите внимание, что если удаленный элемент не был последним в списке воспроизведения, значения индекса последующих элементов изменяются. В следующем примере C# удаляется указанный элемент.


```C++
// Remove the currently playing item from the
// specified playlist.
pList.removeItem(currMedia);

```



> [!Note]  
> Пользователи могут изменять содержимое списка воспроизведения за пределами приложения. каждый раз, когда вы управляете элементами списка воспроизведения, следует отслеживать и обрабатывать связанные с ними события элемента управления проигрыватель Windows Media, чтобы обеспечить правильную работу кода. Эти события являются *проигрывателем*. **Куррентплайлистчанже** и *Player*. **Плайлистчанже**.

 

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[**Управление списками воспроизведения**](managing-playlists.md)
</dt> <dt>

[**Объект мультимедиа**](media-object.md)
</dt> <dt>

[**Объект списка воспроизведения**](playlist-object.md)
</dt> </dl>

 

 




