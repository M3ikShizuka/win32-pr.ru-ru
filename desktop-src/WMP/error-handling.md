---
title: Обработка ошибок (пакет SDK для проигрывателя Windows Media)
description: Обработка ошибок
ms.assetid: f0567c77-a855-4b93-9fb7-a36cde63859f
keywords:
- Проигрыватель Windows Media, обработка ошибок
- Объектная модель проигрывателя Windows Media, обработка ошибок
- Объектная модель, обработка ошибок
- Элемент управления ActiveX проигрывателя Windows Media, обработка ошибок
- Элемент управления ActiveX, обработка ошибок
- Элемент управления мобильными устройствами ActiveX проигрывателя Windows Media, обработка ошибок
- Проигрыватель Windows Media Mobile, обработка ошибок
- руководством по миграции, обработке ошибок
- Обработка ошибок в объектной модели
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8f3b96e04d24009ee4b7e5819fdb26dfd6effd63
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2020
ms.locfileid: "104134859"
---
# <a name="error-handling-windows-media-player-sdk"></a>Обработка ошибок (пакет SDK для проигрывателя Windows Media)

Элемент управления ActiveX проигрывателя Windows Media 6,4 обеспечивает обработку ошибок по умолчанию, отображая сообщения об ошибках в диалоговых окнах и в строке состояния. Можно также предоставить настраиваемую обработку ошибок, обрабатывая ошибки в скрипте. Обработка ошибок связана с событиями, что означает получение уведомления для каждой ошибки, и необходимо решить, как обрабатывать каждое событие ошибки при возникновении. Дополнительные сведения об обработке ошибок с помощью объектной модели версии 6,4 см. в разделе Обработка ошибок статьи объектная модель проигрывателя версии 6,4, которая является частью пакета SDK для проигрывателя Windows Media.

Объектная модель проигрывателя Windows Media 7 или более поздней версии предоставляет объект **Error** и объект **ерроритем** для обработки ошибок. Эти два объекта работают вместе, чтобы обеспечить механизм обработки ошибок, обеспечивающий полное и гибкое управление процессом обработки ошибок. Объект **Error** предоставляет доступ к коллекции объектов **ерроритем** ; Каждый объект **ерроритем** предоставляет сведения об отдельном сообщении об ошибке.

При возникновении ошибки сведения об ошибке помещаются в очередь ошибок. Очередь представляет собой коллекцию объектов **ерроритем** . При добавлении каждой ошибки в очередь она связывается с номером индекса (начиная с нуля), который можно использовать для обнаружения конкретного объекта **ерроритем** . *Ошибка*. Свойство **ерроркаунт** извлекает количество ошибок в очереди ошибок. Поскольку нумерация индексов отсчитывается от нуля, последняя ошибка, отправленная в очередь, всегда будет иметь значение индекса, равное *Error*. **ерроркаунт** минус один.

Можно создать обработчик событий ошибок для проигрывателя Windows Media с помощью скрипта. В следующем примере JScript показано, как получить последний ошибочный элемент из очереди ошибок и отобразить код ошибки и описание ошибки с помощью объектной модели проигрывателя Windows Media 7 или более поздней версии. Объект **Player** создан с идентификатором "WMP9".


```C++
<!-- Create an error event handler for Windows Media Player 7 or later errors. -->
<SCRIPT  LANGUAGE = "JScript"  FOR = WMP9  EVENT = error()>

// Store the number of errors in the error queue.
var max = WMP9.error.errorCount;

// Retrieve most recent ErrorItem object.
var err = WMP9.error.item(max-1)

// Store the error code number.
var errNum = err.errorCode;

// Store the error description string.
var errDesc = err.errorDescription;

// Build a message string to notify the user.
var msg = "Error number: " + errNum + "\n";
msg += "Error description: " + errDesc;

// Display the message box.
alert(msg);

</SCRIPT>

```



Объект **Error** имеет два дополнительных метода, которые можно использовать. *Ошибка*. метод **клеарерроркуеуе** позволяет удалить все ошибки из очереди ошибок и сбросить номер индекса до нуля. Вы полностью контролируете этот процесс; можно хранить ошибки в очереди до тех пор, пока они должны быть доступны, а затем очищать очередь по завершении обработки ошибок.

*Ошибка*. метод веб- **справки** позволяет отображать наиболее актуальные сведения об ошибках для пользователя через Интернет. При вызове этот метод передает все релевантные сведения о первой ошибке в очереди (с нулевым индексом) в веб-справку проигрывателя Windows Media, которая отображает дополнительные сведения об ошибке в текущем окне браузера.

## <a name="related-topics"></a>См. также

<dl> <dt>

[**Объект Error**](error-object.md)
</dt> <dt>

[**Объект Ерроритем**](erroritem-object.md)
</dt> <dt>

[**Руководством по миграции объектной модели**](object-model-migration-guide.md)
</dt> </dl>

 

 




