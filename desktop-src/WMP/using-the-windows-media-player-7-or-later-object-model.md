---
title: использование объектной модели проигрыватель Windows Media 7 или более поздней версии
description: использование объектной модели проигрыватель Windows Media 7 или более поздней версии
ms.assetid: e2dbe2c1-23be-499b-b754-b7e87486ecd6
keywords:
- проигрыватель Windows Media, объектная модель
- проигрыватель Windows Media объектной модели версии 7 или более поздней
- Объектная модель версии 7 или более поздней
- проигрыватель Windows Media ActiveX элемент управления, версия 7 или более поздняя
- ActiveX элемент управления, версия 7 или более поздняя
- проигрыватель Windows Media мобильный ActiveX элемент управления, версия 7 или более поздняя
- проигрыватель Windows Media Мобильные устройства, объектная модель
- инструкции по миграции, версия 7 или более поздняя
- версии проигрыватель Windows Media, объектная модель
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fa40dea2718c602bfae305703913b418d0f8a48b90278683aba099dfe0d703bb
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118117032"
---
# <a name="using-the-windows-media-player-7-or-later-object-model"></a>использование объектной модели проигрыватель Windows Media 7 или более поздней версии

большинство задач, которые вы могли выполнять с помощью объектной модели проигрыватель Windows Media 6,4 ActiveX, потребовали нового подхода. во многих случаях имена свойств, методов и событий изменились в объектной модели проигрыватель Windows Media 7 или более поздней версии. Например, чтобы указать путь к файлу в объектной модели версии 6,4, необходимо задать свойство **Player6. filename** :


```C++
WMP64.FileName = "https://www.microsoft.com/somefile.wmv";

```



при использовании объектной модели проигрыватель Windows Media 7 или более поздней версии необходимо задать свойство **Player. URL** :


```C++
WMP9.URL = "https://www.microsoft.com/somefile.wmv";

```



Кроме того, используя модель с 10 объектами, можно получить объект **мультимедиа** из библиотеки, а затем задать свойство **Player. куррентмедиа** :


```C++
// Get the first media object in the media collection.
var MyMediaItem = WMP9.mediaCollection.getAll().item(0)

// Make the MyMediaItem object the current media.
WMP9.currentMedia = MyMediaItem;

```



большая часть функциональности объектной модели проигрыватель Windows Media 7 или более поздней версии доступна через иерархию объектов. Как было показано в предыдущем примере, можно получить объект **списка воспроизведения** с помощью метода **жеталл** объекта **медиаколлектион** , доступ к которому осуществляется через объект корневого **проигрывателя** . Затем можно получить определенный объект **мультимедиа** из объекта **списка воспроизведения** с помощью метода **Item** объекта **списка воспроизведения** . Существует пять дополнительных методов, доступных через объект **медиаколлектион** , который возвращает объект **списка воспроизведения** . Каждый метод позволяет получить объект на основе конкретного критерия, например жанра или альбома.

иерархическая структура объектной модели управления ActiveX проигрыватель Windows Media 7 или более поздней версии предоставляет более логичный подход к организации свойств, методов и событий, доступных для использования. Все функции элементов управления проигрывателя содержатся в объекте **Controls** , все функциональные возможности сетевого подключения проигрывателя содержатся в объекте **Network** и т. д. Например, чтобы запустить воспроизведение содержимого с помощью объектной модели версии 6,4, используйте метод **Player6. Play** :


```C++
WMP64.Play();

```



при использовании объектной модели проигрыватель Windows Media 7 или более поздней версии необходимо получить доступ к методу **Play** с помощью объекта **controls** :


```C++
WMP9.controls.play();

```



Однако глубина объектной модели может привести к очень длинным инструкциям скрипта:


```C++
WMP9.currentPlaylist.appendItem(WMP9.mediaCollection.getByName("MySong").item(0));

```



Инструкции, подобные предыдущему, можно сделать намного проще и удобнее читать, работая с отдельными именованными объектами. В следующем примере приведенный выше оператор Code заменяет синтаксис с использованием отдельных переменных объекта:


```C++
// Store the current playlist object.
var pl = WMP9.currentPlaylist;

// Get a playlist from the media collection that contains
// one media item named "MySong".
var temp = WMP9.mediaCollection.getByName("MySong");

// Get the individual media item from the temp playlist.
var song = temp.item(0);

// Append the media item to the current playlist.
pl.appendItem(song);

```



Этот стиль написания кода требует больше строк сценария, но его гораздо проще выполнить, особенно с добавленными комментариями. Существует еще одно преимущество: объект **куррентплайлист** легко использовать повторно, так как он хранится в переменной PL.

многие свойства, методы и события в объектной модели проигрыватель Windows Media 7 или более поздней версии или получают различные значения или возвращают значения другого типа или числа по сравнению с соответствующими функциями в объектной модели версии 6,4. например, когда **Player6. опенстате** получает 2, это значение соответствует Visual Basic константной **нслоадингнск**, означающее, что проигрыватель загружает файл станции с расширением nsc. но когда проигрыватель Windows Media 7 или более поздней версии свойство объектной модели **Player. опенстате** получает 2, это значение соответствует состоянию плайлистлокатинг, что означает, что проигрыватель Windows Media пытается выполнить поиск списка воспроизведения. кроме того, свойство **Player6. опенстате** может извлекать семь различных значений, тогда как свойство **проигрывателя** проигрыватель Windows Media 7 или более поздней версии может получить 22 разных значения. при пересмотре кода для использования другой версии объектной модели обязательно ознакомьтесь со ссылкой на справочник по объектной модели для создания скриптов в разделе проигрыватель Windows Media пакета SDK.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[**Сведения об объектной модели проигрывателя**](about-the-player-object-model.md)
</dt> <dt>

[**Справочник по объектной модели для создания сценариев**](object-model-reference-for-scripting.md)
</dt> <dt>

[**Руководством по миграции объектной модели**](object-model-migration-guide.md)
</dt> </dl>

 

 




