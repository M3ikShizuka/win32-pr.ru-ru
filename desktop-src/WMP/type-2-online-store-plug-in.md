---
title: Подключаемый модуль интернет-магазина типа 2
description: Подключаемый модуль интернет-магазина типа 2
ms.assetid: 16e90a01-20be-49a6-96df-de81a7283f42
keywords:
- проигрыватель Windows Media интернет-магазинов, подключаемых модулей
- Интернет-магазины, подключаемые модули
- Тип 2 Интернет-магазинов, подключаемые модули
- проигрыватель Windows Media интернет-магазинов, интерфейс ивмпсубскриптионсервице
- Интернет-магазины, интерфейс Ивмпсубскриптионсервице
- Тип 2 Интернет-магазинов, интерфейс Ивмпсубскриптионсервице
- подключаемые модули, проигрыватель Windows Media интернет-магазины
- подключаемые модули, Интернет-магазины
- подключаемые модули, тип 2 Интернет-магазинов
- подключаемые модули, интерфейс Ивмпсубскриптионсервице
- проигрыватель Windows Media подключаемых модулей, введите два интернет-магазина
- подключаемые модули проигрыватель Windows Media, интернет-магазины
- подключаемые модули проигрыватель Windows Media проигрыватель Windows Media интернет-магазинов
- подключаемые модули проигрыватель Windows Media, интерфейс ивмпсубскриптионсервице
- ивмпсубскриптионсервице
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c6d2f3aeeaa7456c3452b498a1a728e24c96783c
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127458065"
---
# <a name="type-2-online-store-plug-in"></a>Подключаемый модуль интернет-магазина типа 2

Подключаемый модуль интернет-магазина типа 2 — это COM-компонент, реализующий интерфейс [ивмпсубскриптионсервице](/previous-versions/windows/desktop/api/subscriptionservices/nn-subscriptionservices-iwmpsubscriptionservice) и, при необходимости, интерфейс [IWMPSubscriptionService2](/previous-versions/windows/desktop/api/subscriptionservices/nn-subscriptionservices-iwmpsubscriptionservice2) . проигрыватель Windows Media 9 вызывает методы интерфейса **ивмпсубскриптионсервице** . проигрыватель Windows Media 10 или более поздней версии вызывает методы как интерфейсов **ивмпсубскриптионсервице** , так и **IWMPSubscriptionService2** .

Подключаемый модуль интернет-магазина типа 2 упакован как внутрипроцессный COM-сервер. то есть подключаемый модуль реализуется в файле .dll, который сопоставляется с проигрыватель Windows Media процессом.

проигрыватель Windows Media активирует подключаемые модули оперативного хранилища типа 2 по мере необходимости. Например, предположим, что пользователь пытается воспроизвести защищенную песню, а Текущая лицензия для ее воспроизведения отсутствует. в этом случае проигрыватель Windows Media проверяет атрибут **контентдистрибутор** либо в заголовке файла, либо в заголовке DRM. если существует значение, совпадающее с именем ключа интернет-магазина, проигрыватель Windows Media проверяет реестр, чтобы проверить, предоставил ли интернет-магазин подключаемый модуль типа 2. если подключаемый модуль существует, проигрыватель Windows Media загружает подключаемый модуль и вызывает его методы, чтобы определить, имеет ли пользователь права на воспроизведение песни.

в следующем списке описаны некоторые сценарии, в которых проигрыватель Windows Media вызывает подключаемый модуль интернет-магазина типа 2.

-   **Пользователь пытается воспроизвести содержимое Интернет-магазина.** в этом случае проигрыватель Windows Media вызывает метод [ивмпсубскриптионсервице:: алловплай](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice-allowplay) подключаемого модуля, передавая указатель на мультимедийный элемент, который пытается воспроизвести пользователь. Интернет-магазин может использовать эту возможность для обновления лицензии пользователя на воспроизведение содержимого или запрета воспроизведения. если подключаемый модуль возвращает **значение TRUE** в параметре *пфалловплай* , проигрыватель Windows Media пытается воспроизвести содержимое. Воспроизведение по-прежнему завершится ошибкой, если действительная лицензия не существует. Этот процесс не обходит управление цифровыми правами (DRM).
-   **Пользователь запрашивает разрешение на запись содержимого на компакт-диск или DVD-диск.** в этом случае проигрыватель Windows Media вызывает метод [ивмпсубскриптионсервице:: алловкдбурн](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice-allowcdburn) подключаемого модуля.
-   **пользователь пытается синхронизировать содержимое интернет-магазина с устройством или проигрыватель Windows Media готово к автоматической синхронизации содержимого интернет-магазина с устройством.** в этом случае проигрыватель Windows Media вызывает метод [IWMPSubscriptionService2::p репарефорсинк](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice2-prepareforsync) подключаемого модуля для оповещения интернет-магазина о том, что элемент мультимедиа будет синхронизирован с определенным устройством, которое определяется по каноническому имени. Это возможность Интернет-магазина определить, разрешено ли пользователю синхронизировать элемент мультимедиа с устройством. Кроме того, в Интернет-магазине можно подготовить устройство к синхронизации и обновить записи, такие как счетчики синхронизации, связанные с устройством или элементом мультимедиа. Подключаемый модуль должен передавать задачи разрешения, подготовки и сохранения записей в отдельный поток и сразу же возвращаться из **препарефорсинк**. когда отдельный поток завершит свою работу, он должен уведомить проигрыватель Windows Media, вызвав [ивмпсубскриптионсервицекаллбакк:: oncomplete](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservicecallback-oncomplete).
-   **Устройство станет доступным для фоновой обработки.** когда устройство подключено, проигрыватель Windows Media предупреждает интернет-магазин о доступности и бездействии устройства, вызывая [IWMPSubscriptionService2::d евицеаваилабле](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice2-deviceavailable).
-   **пользователь нажимает кнопку для активации интернет-магазина в проигрыватель Windows Media.** в этом случае проигрыватель Windows Media вызывает метод [IWMPSubscriptionService2:: сервицеевент](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice2-serviceevent) подключаемого модуля. проигрыватель Windows Media также вызывает этот метод, когда пользователь переключается на другую службу.
-   **проигрыватель Windows Media переходит в состояние низкая активность.** В этом случае проигрыватель вызывает метод [ивмпсубскриптионсервице:: стартбаккграундпроцессинг](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice-startbackgroundprocessing) подключаемого модуля. Интернет-магазин может использовать эту возможность для запуска или пробуждения любых потоков, выполняющих фоновые задачи, таких как обновление просроченных лицензий или компиляция данных счетчиков воспроизведения.
-   **проигрыватель Windows Media переходит в состояние высокой активности.** в этом случае проигрыватель Windows Media вызывает метод [IWMPSubscriptionService2:: стопбаккграундпроцессинг](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice2-stopbackgroundprocessing) подключаемого модуля. Это информирует подключаемый модуль о том, что он должен приостановить все потоки, выполняющие фоновые задачи.

проигрыватель Windows Media освобождает компонент интернет-магазина по завершении сеанса проигрывателя. После выпуска компонент должен прерывать выполнение любой фоновой обработки, а затем завершать его работу.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[**Интерфейс Ивмпсубскриптионсервице**](/previous-versions/windows/desktop/api/subscriptionservices/nn-subscriptionservices-iwmpsubscriptionservice)
</dt> <dt>

[**Интерфейс IWMPSubscriptionService2**](/previous-versions/windows/desktop/api/subscriptionservices/nn-subscriptionservices-iwmpsubscriptionservice2)
</dt> <dt>

[**Интерфейс Ивмпсубскриптионсервицекаллбакк**](/previous-versions/windows/desktop/api/subscriptionservices/nn-subscriptionservices-iwmpsubscriptionservicecallback)
</dt> <dt>

[**Тип 2 Примеры Интернет-магазина**](type-2-online-store-samples.md)
</dt> </dl>

 

 




