---
title: Подключаемый модуль интернет-магазина типа 2
description: Подключаемый модуль интернет-магазина типа 2
ms.assetid: 16e90a01-20be-49a6-96df-de81a7283f42
keywords:
- Интернет-магазины проигрывателя Windows Media, подключаемые модули
- Интернет-магазины, подключаемые модули
- Тип 2 Интернет-магазинов, подключаемые модули
- Интернет-магазины проигрывателя Windows Media, интерфейс Ивмпсубскриптионсервице
- Интернет-магазины, интерфейс Ивмпсубскриптионсервице
- Тип 2 Интернет-магазинов, интерфейс Ивмпсубскриптионсервице
- подключаемые модули, Интернет-магазины проигрывателя Windows Media
- подключаемые модули, Интернет-магазины
- подключаемые модули, тип 2 Интернет-магазинов
- подключаемые модули, интерфейс Ивмпсубскриптионсервице
- Подключаемые модули проигрывателя Windows Media, тип 2 Интернет-магазинов
- Подключаемые модули проигрывателя Windows Media, Интернет-магазины
- Подключаемые модули проигрывателя Windows Media, Интернет-магазины проигрывателя Windows Media
- Подключаемые модули проигрывателя Windows Media, интерфейс Ивмпсубскриптионсервице
- ивмпсубскриптионсервице
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c6d2f3aeeaa7456c3452b498a1a728e24c96783c
ms.sourcegitcommit: ad672d3a10192c5ccac619ad2524407109266e93
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/25/2020
ms.locfileid: "104133590"
---
# <a name="type-2-online-store-plug-in"></a>Подключаемый модуль интернет-магазина типа 2

Подключаемый модуль интернет-магазина типа 2 — это COM-компонент, реализующий интерфейс [ивмпсубскриптионсервице](/previous-versions/windows/desktop/api/subscriptionservices/nn-subscriptionservices-iwmpsubscriptionservice) и, при необходимости, интерфейс [IWMPSubscriptionService2](/previous-versions/windows/desktop/api/subscriptionservices/nn-subscriptionservices-iwmpsubscriptionservice2) . Проигрыватель Windows Media 9 вызывает методы интерфейса **ивмпсубскриптионсервице** . Проигрыватель Windows Media 10 или более поздней версии вызывает методы интерфейсов **ивмпсубскриптионсервице** и **IWMPSubscriptionService2** .

Подключаемый модуль интернет-магазина типа 2 упакован как внутрипроцессный COM-сервер. То есть подключаемый модуль реализуется в DLL-файле, сопоставленном с процессом проигрывателя Windows Media.

Проигрыватель Windows Media при необходимости активирует подключаемые модули оперативного хранилища типа 2. Например, предположим, что пользователь пытается воспроизвести защищенную песню, а Текущая лицензия для ее воспроизведения отсутствует. В этом случае проигрыватель Windows Media проверяет атрибут **контентдистрибутор** либо в заголовке файла, либо в заголовке DRM. Если существует значение, совпадающее с именем ключа Интернет-магазина, проигрыватель Windows Media проверяет реестр, чтобы проверить, предоставил ли Интернет-магазин подключаемый модуль типа 2. Если подключаемый модуль существует, проигрыватель Windows Media загружает подключаемый модуль и вызывает его методы, чтобы определить, имеет ли пользователь права на воспроизведение песни.

В следующем списке описаны некоторые сценарии, в которых проигрыватель Windows Media вызывает подключаемый модуль интернет-магазина типа 2.

-   **Пользователь пытается воспроизвести содержимое Интернет-магазина.** В этом случае проигрыватель Windows Media вызывает метод [ивмпсубскриптионсервице:: алловплай](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice-allowplay) подключаемого модуля, передавая указатель на мультимедийный элемент, который пытается воспроизвести пользователь. Интернет-магазин может использовать эту возможность для обновления лицензии пользователя на воспроизведение содержимого или запрета воспроизведения. Если подключаемый модуль возвращает **значение true** в параметре *Пфалловплай* , проигрыватель Windows Media пытается воспроизвести содержимое. Воспроизведение по-прежнему завершится ошибкой, если действительная лицензия не существует. Этот процесс не обходит управление цифровыми правами (DRM).
-   **Пользователь запрашивает разрешение на запись содержимого на компакт-диск или DVD-диск.** В этом случае проигрыватель Windows Media вызывает метод [ивмпсубскриптионсервице:: алловкдбурн](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice-allowcdburn) подключаемого модуля.
-   **Пользователь пытается синхронизировать содержимое Интернет-магазина с устройством, или проигрыватель Windows Media готов к автоматической синхронизации содержимого Интернет-магазина с устройством.** В этом случае проигрыватель Windows Media вызывает метод [IWMPSubscriptionService2::P репарефорсинк](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice2-prepareforsync) подключаемого модуля для оповещения Интернет-магазина о том, что элемент мультимедиа будет синхронизирован с определенным устройством, которое определяется по каноническому имени. Это возможность Интернет-магазина определить, разрешено ли пользователю синхронизировать элемент мультимедиа с устройством. Кроме того, в Интернет-магазине можно подготовить устройство к синхронизации и обновить записи, такие как счетчики синхронизации, связанные с устройством или элементом мультимедиа. Подключаемый модуль должен передавать задачи разрешения, подготовки и сохранения записей в отдельный поток и сразу же возвращаться из **препарефорсинк**. Когда отдельный поток завершит свою работу, он должен уведомить проигрыватель Windows Media, вызвав [ивмпсубскриптионсервицекаллбакк:: OnComplete](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservicecallback-oncomplete).
-   **Устройство станет доступным для фоновой обработки.** Когда устройство подключено, проигрыватель Windows Media оповещает Интернет-магазин о том, что устройство доступно и бездействует, вызывая [IWMPSubscriptionService2::D евицеаваилабле](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice2-deviceavailable).
-   **Пользователь нажимает кнопку для активации Интернет-магазина в проигрывателе Windows Media.** В этом случае проигрыватель Windows Media вызывает метод [IWMPSubscriptionService2:: сервицеевент](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice2-serviceevent) подключаемого модуля. Проигрыватель Windows Media также вызывает этот метод, когда пользователь переключается на другую службу.
-   **Проигрыватель Windows Media переходит в состояние нехватки активности.** В этом случае проигрыватель вызывает метод [ивмпсубскриптионсервице:: стартбаккграундпроцессинг](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice-startbackgroundprocessing) подключаемого модуля. Интернет-магазин может использовать эту возможность для запуска или пробуждения любых потоков, выполняющих фоновые задачи, таких как обновление просроченных лицензий или компиляция данных счетчиков воспроизведения.
-   **Проигрыватель Windows Media переходит в состояние высокой активности.** В этом случае проигрыватель Windows Media вызывает метод [IWMPSubscriptionService2:: стопбаккграундпроцессинг](/previous-versions/windows/desktop/api/subscriptionservices/nf-subscriptionservices-iwmpsubscriptionservice2-stopbackgroundprocessing) подключаемого модуля. Это информирует подключаемый модуль о том, что он должен приостановить все потоки, выполняющие фоновые задачи.

Проигрыватель Windows Media освобождает компонент Интернет-магазина по окончании сеанса проигрывателя. После выпуска компонент должен прерывать выполнение любой фоновой обработки, а затем завершать его работу.

## <a name="related-topics"></a>См. также

<dl> <dt>

[**Интерфейс Ивмпсубскриптионсервице**](/previous-versions/windows/desktop/api/subscriptionservices/nn-subscriptionservices-iwmpsubscriptionservice)
</dt> <dt>

[**Интерфейс IWMPSubscriptionService2**](/previous-versions/windows/desktop/api/subscriptionservices/nn-subscriptionservices-iwmpsubscriptionservice2)
</dt> <dt>

[**Интерфейс Ивмпсубскриптионсервицекаллбакк**](/previous-versions/windows/desktop/api/subscriptionservices/nn-subscriptionservices-iwmpsubscriptionservicecallback)
</dt> <dt>

[**Тип 2 Примеры Интернет-магазина**](type-2-online-store-samples.md)
</dt> </dl>

 

 




