---
title: Обслуживание сведений о сеансе
description: Обслуживание сведений о сеансе
ms.assetid: 2ab862dc-62e1-44d6-ac81-7d3c574a779f
keywords:
- Интернет-магазины проигрывателя Windows Media, диспетчер загрузки
- Интернет-магазины, диспетчер загрузки
- Тип 2 Интернет-магазинов, диспетчер загрузки
- Интернет-магазины проигрывателя Windows Media, сохранение сведений о сеансе
- Интернет-магазины, обслуживание сведений о сеансах
- Тип 2 Интернет-магазинов, обслуживание сведений о сеансе
- Интернет-магазины проигрывателя Windows Media, сведения о сеансе
- Интернет-магазины, сведения о сеансе
- Тип 2 Интернет-магазинов, сведения о сеансе
- Проигрыватель Windows Media, диспетчер загрузки
- Диспетчер загрузки проигрывателя Windows Media
- Диспетчер загрузки
- Обслуживание сведений о сеансе
- сведения о сеансе
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 786892afebb26f64a97b300bd1a4bd7c46d44883
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104332680"
---
# <a name="maintaining-session-information"></a>Обслуживание сведений о сеансе

## <a name="how-the-sample-stores-information"></a>Как в примере сохраняются сведения

Пример веб-страницы сохраняет данные с помощью файлов cookie. Файлы cookie — это просто постоянные пары "имя-значение", которые могут храниться в веб-браузере.

При закрытии веб-страницы запускается функция **Shutdown** . **Shutdown** вызывает функцию **сетпендингкукиес**. Эта функция выполняет перебор списка загрузки коллекции, хранящегося в раскрывающемся списке с именем Селдлк. Если коллекция загрузки содержит неполные элементы, функция вызывает метод **SetCookie**, передавая имя и значение. Строка имени определяется путем добавления целочисленного значения к значению константы **вмпдлк**, которое хранится в переменной с именем g \_ спрекукие. Например, для третьей ожидающей коллекции загрузки имя файла cookie будет «WMPDLC2», так как механизм подсчета отсчитывается от нуля. При создании каждого файла cookie функция увеличивает глобальную переменную g в \_ ожидании для сохранения числа незавершенных Скачиваний. Ниже приведен код, который можно воспроизвести для вашего удобства:


```C++
// Write cookies for pending downloads.
function SetPendingCookies()
{
    g_Pending = 0; // Init the pending count.
    
    for(var i = 0; i < selDLC.length; i++)
    {
        var sCookieName = g_sPreCookie + i.toString(10);
        var sCookieVal = selDLC.options[i].text;
    
        // Write a cookie for each pending download.    
        if(IsDLCComplete(sCookieVal.valueOf()) == false)
        {      
            SetCookie(sCookieName, sCookieVal);
            g_Pending++;
        }        
    }
}

```



**Исдлккомплете** — это вспомогательная функция, которая просто просматривает каждый элемент загрузки в коллекции загрузки, чтобы определить, ожидает ли какой-либо элемент. Если имеется ожидающий элемент, функция возвращает значение false.

**SetCookie** — это функция, которая создает файл cookie.

Когда **сетпендингкукиес** возвращает, **Завершение работы** создает файл cookie Count, который сохраняет значение из переменной g \_ в ожидании. Это значение важно, так как веб-странице требуется способ определить количество файлов cookie для извлечения при перезагрузке. Имя файла cookie счетчика хранится в переменной с именем g \_ скаунткукие.

## <a name="how-the-sample-retrieves-information"></a>Получение сведений в примере

При загрузке веб-страницы выполняется функция **init** . Во-первых, функция вызывает **жетпендингдлкаунт** для получения файла cookie счетчика. Затем оно сохраняет это значение в переменной с именем g \_ Pending. Затем вызывается функция **популатедллист** для получения каждого файла cookie сеанса загрузки и добавления его идентификатора в раскрывающийся список. Ниже приведен код для этой функции:


```C++
// Fill the drop-down list with pending download collection IDs.
function PopulateDlList(iCount)
{
    ClearList(selDLC);
     
    // For each cookie, add the value to the SELECT element.
    // The value represents a download collection ID.  
    for (var j = 0; j < iCount; j++)
    {
        var sCookieName = g_sPreCookie + j.toString(10);        
        var sCookieVal = GetCookie(sCookieName);
        DelCookie(sCookieName); // Don't leave the cookies lying around. 
  
        if(sCookieVal != null)
        {      
            var oOption = document.createElement("OPTION");
            oOption.text = sCookieVal;
            oOption.value = j;
            selDLC.add(oOption); 
        }          
    }
}

```



Функция **клеарлист** удаляет все элементы из списка.

Затем функция входит в цикл. Каждое имя файла cookie создается как строка, а затем файл cookie извлекается путем вызова вспомогательной **функции.** После извлечения файл cookie удаляется путем вызова **делкукие**. Если файл cookie имеет значение, значение добавляется в список. Это действие инициирует событие **onChange** для списка селдлк, который, в свою очередь, вызывает функцию обработчика с именем **онселектдлк**. Это та же функция, которая выполняется, когда пользователь выбирает коллекцию загрузки. Это код, который заполняет окно списка элементов загрузки.

## <a name="related-topics"></a>См. также

<dl> <dt>

[**Использование диспетчера загрузки**](using-the-download-manager.md)
</dt> </dl>

 

 




