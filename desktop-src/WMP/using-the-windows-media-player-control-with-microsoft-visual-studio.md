---
title: Использование элемента управления проигрывателя Windows Media с Microsoft Visual Studio
description: Использование элемента управления проигрывателя Windows Media с Microsoft Visual Studio
ms.assetid: e007876e-f215-4976-8a70-018fedc0e67d
keywords:
- Проигрыватель Windows Media, внедрение элемента управления ActiveX
- Объектная модель проигрывателя Windows Media, внедрение элемента управления ActiveX
- Объектная модель, внедрение элемента управления ActiveX
- Проигрыватель Windows Media Mobile, внедрение элемента управления ActiveX
- Элемент управления ActiveX проигрывателя Windows Media, внедрение
- Мобильный элемент управления ActiveX проигрывателя Windows Media, внедрение
- Элемент управления ActiveX, внедрение
- Проигрыватель Windows Media, .NET Framework
- Объектная модель проигрывателя Windows Media, NET Framework
- Объектная модель, .NET Framework
- Проигрыватель Windows Media Mobile, .NET Framework
- Элемент управления ActiveX проигрывателя Windows Media, .NET Framework
- Элемент управления ActiveX проигрывателя Windows Media Mobile, NET Framework
- Элемент управления ActiveX, NET Framework
- Элемент управления ActiveX проигрывателя Windows Media, Visual Studio
- Элемент управления ActiveX проигрывателя Windows Media Mobile, Visual Studio
- Элемент управления ActiveX, Visual Studio
- Платформа .NET Framework, внедрение программ Visual Studio
- внедрение, программы Visual Studio
- Visual Studio, внедрение программ
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 44b01fecd6acdfd5ccc9a7d823740ef3915bf9c6
ms.sourcegitcommit: e22adfb0dd3bb989e59455baedb4d905a877a240
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/21/2019
ms.locfileid: "104068677"
---
# <a name="using-the-windows-media-player-control-with-microsoft-visual-studio"></a>Использование элемента управления проигрывателя Windows Media с Microsoft Visual Studio

С помощью панели элементов в Visual Studio можно добавить элемент управления ActiveX серии 9 или более поздней версии в приложение платформа .NET Framework.

## <a name="adding-the-windows-media-player-control"></a>Добавление элемента управления проигрывателя Windows Media

Перед созданием нового проекта убедитесь, что на компьютере установлена последняя версия проигрывателя Windows Media и пакет SDK проигрывателя Windows Media.

Запустите Visual Studio, а затем создайте новый проект.

В Visual Studio откройте область элементов.

Если проигрыватель Windows Media не отображается в области **компонентов** панели элементов, выполните следующие действия.

1.  Щелкните правой кнопкой мыши в области элементов и выберите **пункт Выбрать элементы**. Откроется диалоговое окно **Настройка панели элементов** .
2.  На вкладке **COM-компоненты** выберите Windows Media Player.

    Если проигрыватель Windows Media не отображается в списке, нажмите кнопку **Обзор**, а затем откройте Wmp.dll, который должен находиться в \\ папке Windows System32.

3.  Нажмите кнопку **ОК**. Элемент управления проигрывателя Windows Media будет помещен на текущую вкладку панели элементов.

Теперь можно выбрать проигрыватель Windows Media на панели элементов и добавить его в форму.

Visual Studio предоставляет проигрывателю Windows Media имя по умолчанию, например "axWindowsMediaPlayer1". Может потребоваться изменить имя на что-нибудь более легкое, например "Player".

При добавлении элемента управления проигрывателя Windows Media из панели элементов также добавляются ссылки на две библиотеки, созданные Visual Studio, Аксвмплиб и Вмплиб. Их можно найти в обозреватель решений в разделе **ссылки**.

Чтобы упростить использование объектов в пространстве имен Player, следует включить пространство имен в директивы using или Import файлов следующим образом:


```Csharp
using WMPLib;
```




```VB
imports WMPLib

```



Директива гарантирует, что вы можете ссылаться на объекты **Player** , не указывая полные имена.

> [!Note]  
> Элемент управления проигрывателя Windows Media является объектом **аксвиндовсмедиаплайер** из пространства имен **аксвмплиб** . Однако класс **аксвиндовсмедиаплайер** использует типы данных, интерфейсы и другие элементы из пространства имен **вмплиб** .

 

## <a name="configuring-visibility-of-the-control"></a>Настройка видимости элемента управления

При первом добавлении элемента управления проигрывателя Windows Media в форму он будет виден. Если вы не хотите использовать видимое изображение проигрывателя в приложении, скройте проигрыватель по умолчанию, задав одно из следующих свойств:



| Свойство        | Значение                                                 |
|-----------------|-------------------------------------------------------|
| **uiMode**      | "Невидимый" (см. [Player. uiMode](player-uimode.md).) |
| **Visible**     | "false"                                               |
| **Размер. ширина**  | 0                                                     |
| **Размер. Высота** | 0                                                     |



 

Эти свойства можно задать либо в коде, либо в окне **Свойства** при выборе элемента управления проигрывателя Windows Media в конструкторе форм.

## <a name="object-model-compatibility-of-the-control"></a>Совместимость объектной модели с элементом управления

Объектная модель для элемента управления проигрывателя Windows Media практически одинакова в платформа .NET Framework, как в неуправляемом коде и сценарии. Однако существуют различия в предоставлении элементов:

-   Большинство объектов предоставляются под именем своего базового COM-интерфейса. Например, объект **списка воспроизведения** предоставляется как **ивмпплайлист**.
-   Некоторые интерфейсы имеют более поздние версии. Например, **ивмпмедиа** была предоставлена дополнительная функциональность в **IWMPMedia2** и **IWMPMedia3**. Если вы объявили объект как **ивмпмедиа**, у вас обычно есть доступ к функциональным возможностям всех версий интерфейса. Однако® IntelliSense не распознает методы или свойства интерфейсов более поздней версии, и Visual Basic редактор .NET не будет автоматически исправлять прописные буквы. Чтобы получить полное преимущество IntelliSense и других функций Visual Studio, объявите объект с помощью последней версии интерфейса, например **IWMPMedia3**.
-   Нет индексированных свойств (C#) или свойств по умолчанию (Visual Basic .NET). Например, чтобы получить **список воспроизведения. Item**, необходимо вызвать метод доступа **ивмплайлист. Get \_ Item** в C# или получить свойство **ивмплайист. Item** в Visual Basic .NET.
-   Из-за конфликта имен между свойством **Controls** проигрывателя Windows Media и свойством **Controls** , предоставляемым каждым элементом управления, версия проигрывателя этого свойства называется **Ктлконтролс** в контексте элемента управления ActiveX. (Однако это не так, когда вы создаете проигрыватель программным способом, а не как элемент управления ActiveX.)

Используйте обозреватель объектов в Visual Studio для нахождение правильных имен API для методов и объектов в пространствах имен **аксвмплиб** и **вмплиб** .

## <a name="distributing-your-application"></a>Распространение приложения

При распространении приложения не забудьте установить AxInterop.WMPLib.dll и Interop.WMPLib.dll в папке приложения. Также необходимо убедиться, что на компьютере пользователя установлена требуемая версия проигрывателя Windows Media.

## <a name="related-topics"></a>См. также

<dl> <dt>

[**Создание элемента управления проигрывателя Windows Media программным способом**](creating-the-windows-media-player-control-programmatically.md)
</dt> <dt>

[**Внедрение элемента управления проигрывателя Windows Media в решение C#**](embedding-the-windows-media-player-control-in-a-c--solution.md)
</dt> <dt>

[**Внедрение элемента управления проигрывателя Windows Media в решение Visual Basic .NET**](embedding-the-windows-media-player-control-in-a-visual-basic--net-solution.md)
</dt> </dl>

 

 




