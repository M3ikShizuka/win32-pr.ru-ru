---
title: использование элемента управления проигрыватель Windows Media с Microsoft Visual Studio
description: использование элемента управления проигрыватель Windows Media с Microsoft Visual Studio
ms.assetid: e007876e-f215-4976-8a70-018fedc0e67d
keywords:
- проигрыватель Windows Media, встраивание ActiveX элемента управления
- проигрыватель Windows Media объектная модель, встраивание ActiveX элемента управления
- объектная модель, встраивание элемента управления ActiveX
- проигрыватель Windows Media мобильный, внедренный элемент управления ActiveX
- проигрыватель Windows Media элемент управления ActiveX, внедрение
- проигрыватель Windows Media управление мобильными ActiveXми, внедрение
- элемент управления ActiveX, встраивание
- проигрыватель Windows Media, платформа .NET Framework
- проигрыватель Windows Media объектной модели платформа .NET Framework
- объектная модель, платформа .NET Framework
- проигрыватель Windows Media мобильный, платформа .NET Framework
- проигрыватель Windows Media ActiveX управления платформа .NET Framework
- проигрыватель Windows Media мобильный ActiveX элемент управления, платформа .NET Framework
- ActiveX элемент управления платформа .NET Framework
- проигрыватель Windows Media ActiveX управления Visual Studio
- проигрыватель Windows Media мобильный ActiveX элемент управления, Visual Studio
- ActiveX элемент управления Visual Studio
- платформа .NET Framework, Visual Studio внедрение программы
- внедрение, Visual Studio программы
- Visual Studio, внедрение программ
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 44b01fecd6acdfd5ccc9a7d823740ef3915bf9c6
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127344007"
---
# <a name="using-the-windows-media-player-control-with-microsoft-visual-studio"></a>использование элемента управления проигрыватель Windows Media с Microsoft Visual Studio

вы можете добавить элемент управления проигрыватель Windows Media 9 Series или более поздней ActiveX в приложение платформа .NET Framework через панель элементов Visual Studio.

## <a name="adding-the-windows-media-player-control"></a>добавление элемента управления проигрыватель Windows Media

перед созданием нового проекта убедитесь, что на компьютере установлена последняя версия проигрыватель Windows Media и пакета SDK для проигрыватель Windows Media.

запустите Visual Studio, а затем создайте новый проект.

в Visual Studio откройте область элементов.

если проигрыватель Windows Media не отображается в области **компоненты** панели элементов, выполните следующие действия.

1.  Щелкните правой кнопкой мыши в области элементов и выберите **пункт Выбрать элементы**. Откроется диалоговое окно **Настройка панели элементов** .
2.  на вкладке **COM-компоненты** выберите проигрыватель Windows Media.

    если проигрыватель Windows Media не отображается в списке, нажмите кнопку **обзор**, а затем откройте Wmp.dll, который должен находиться в \\ папке Windows System32.

3.  Нажмите кнопку **ОК**. элемент управления проигрыватель Windows Media будет помещен на текущую вкладку панели элементов.

теперь можно выбрать проигрыватель Windows Media на панели элементов и добавить ее в форму.

Visual Studio предоставляет проигрыватель Windows Media управления именем по умолчанию, например "axWindowsMediaPlayer1". Может потребоваться изменить имя на что-нибудь более легкое, например "Player".

добавление элемента управления проигрыватель Windows Media из панели элементов также добавляет ссылки на две библиотеки, созданные Visual Studio, аксвмплиб и вмплиб. Их можно найти в обозреватель решений в разделе **ссылки**.

Чтобы упростить использование объектов в пространстве имен Player, следует включить пространство имен в директивы using или Import файлов следующим образом:


```Csharp
using WMPLib;
```




```VB
imports WMPLib

```



Директива гарантирует, что вы можете ссылаться на объекты **Player** , не указывая полные имена.

> [!Note]  
> элемент управления проигрыватель Windows Media является объектом **аксвиндовсмедиаплайер** из пространства имен **аксвмплиб** . Однако класс **аксвиндовсмедиаплайер** использует типы данных, интерфейсы и другие элементы из пространства имен **вмплиб** .

 

## <a name="configuring-visibility-of-the-control"></a>Настройка видимости элемента управления

при первом добавлении элемента управления проигрыватель Windows Media в форму он будет видимым. Если вы не хотите использовать видимое изображение проигрывателя в приложении, скройте проигрыватель по умолчанию, задав одно из следующих свойств:



| Свойство        | Значение                                                 |
|-----------------|-------------------------------------------------------|
| **uiMode**      | "Невидимый" (см. [Player. uiMode](player-uimode.md).) |
| **Visible**     | "false"                                               |
| **Размер. ширина**  | 0                                                     |
| **Размер. Высота** | 0                                                     |



 

эти свойства можно задать либо в коде, либо в окне **свойства** при выборе элемента управления проигрыватель Windows Media в конструкторе форм.

## <a name="object-model-compatibility-of-the-control"></a>Совместимость объектной модели с элементом управления

объектная модель для элемента управления проигрыватель Windows Media по сути является одинаковой в платформа .NET Framework, как в неуправляемом коде и сценарии. Однако существуют различия в предоставлении элементов:

-   Большинство объектов предоставляются под именем своего базового COM-интерфейса. Например, объект **списка воспроизведения** предоставляется как **ивмпплайлист**.
-   Некоторые интерфейсы имеют более поздние версии. Например, **ивмпмедиа** была предоставлена дополнительная функциональность в **IWMPMedia2** и **IWMPMedia3**. Если вы объявили объект как **ивмпмедиа**, у вас обычно есть доступ к функциональным возможностям всех версий интерфейса. однако® IntelliSense не распознает методы или свойства интерфейсов более поздней версии, и Visual Basic редактор .net не будет автоматически исправлять прописные буквы. чтобы получить полное преимущество IntelliSense и других функций Visual Studio, объявите объект с помощью последней версии интерфейса, например **IWMPMedia3**.
-   нет индексированных свойств (C#) или свойств по умолчанию (Visual Basic .net). например, чтобы получить **список воспроизведения. item**, необходимо вызвать метод доступа **ивмплайлист. get \_ item** в C# или получить свойство **ивмплайист. item** в Visual Basic .net.
-   из-за конфликта имен между свойством проигрыватель Windows Media **controls** и свойством **controls** , предоставляемым каждым элементом управления, версия проигрывателя этого свойства называется **ктлконтролс** в контексте элемента управления ActiveX. (однако это не так при создании проигрывателя программным способом, а не в качестве элемента управления ActiveX.)

используйте обозреватель объектов в Visual Studio, чтобы указать правильные имена API для методов и объектов в пространствах имен **аксвмплиб** и **вмплиб** .

## <a name="distributing-your-application"></a>Распространение приложения

При распространении приложения не забудьте установить AxInterop.WMPLib.dll и Interop.WMPLib.dll в папке приложения. также необходимо убедиться, что на компьютере пользователя установлена требуемая версия проигрыватель Windows Media.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[**программное создание элемента управления проигрыватель Windows Media**](creating-the-windows-media-player-control-programmatically.md)
</dt> <dt>

[**внедрение элемента управления проигрыватель Windows Media в решение C#**](embedding-the-windows-media-player-control-in-a-c--solution.md)
</dt> <dt>

[**внедрение элемента управления проигрыватель Windows Media в решение Visual Basic .net**](embedding-the-windows-media-player-control-in-a-visual-basic--net-solution.md)
</dt> </dl>

 

 




