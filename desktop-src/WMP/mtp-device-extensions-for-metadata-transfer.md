---
title: Расширения устройств MTP для обмена метаданными
description: Расширения устройств MTP для обмена метаданными
ms.assetid: 9cf68373-e84f-4568-a9da-16ddee0fc4e9
keywords:
- Проигрыватель Windows Media, расширения для устройств MTP
- Проигрыватель Windows Media, расширения устройств
- Проигрыватель Windows Media, расширения
- Проигрыватель Windows Media, метаданные
- Проигрыватель Windows Media, протокол передачи мультимедиа (MTP)
- Протокол передачи мультимедиа (MTP)
- MTP (протокол передачи мультимедиа)
- метаданные, расширения для устройств MTP
- метаданные, расширения устройств
- метаданные, расширения
- расширения устройств, перенос метаданных
- расширения, перенос метаданных
- Расширения устройств MTP для обмена метаданными
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f64ff16fd97f135d7f8c902af823b967079408fb
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104067298"
---
# <a name="mtp-device-extensions-for-metadata-transfer"></a>Расширения устройств MTP для обмена метаданными

Протокол передачи мультимедиа (MTP) — это протокол, предназначенный для переносных устройств мультимедиа. Основной целью этого протокола является предоставление общего протокола для обмена данными между компьютером и портативным устройством мультимедиа. Это включает получение и отправку объектов мультимедиа и перечисление содержимого и возможностей устройства.

MTP использует постоянные уникальные идентификаторы объектов (Пуоидс) для уникальной идентификации цифровых мультимедийных объектов (и других объектов), хранящихся на устройстве. При обмене сведениями об изменениях, произошедших на устройстве, которое поддерживает MTP, устройство и проигрыватель Windows Media используют Пуоидс для указания объектов, которые были изменены.

Файл заголовка с именем вмпдевицес. h, который устанавливается как часть пакета SDK проигрывателя Windows Media, определяет структуры и константы, необходимые для поддержки расширений устройств проигрывателя Windows Media.

Чтобы устройство было распознано как поддерживающее передаваемые метаданные с помощью расширения Windows Media Player MTP, оно должно содержать следующие сведения в наборе данных DeviceInfo. (Дополнительные сведения об этом наборе данных см. в разделе 4.6.1 спецификации MTP.)



| Поле набора данных          | Порядок полей | Тип данных  | Значение                       |
|------------------------|-------------|------------|-----------------------------|
| вендорекстенсионид      | 2           | **UINT32** | 0x00000006                  |
| вендорекстенсионверсион | 3           | **UINT16** | 0x0064 (100)                |
| вендорекстенсиондеск    | 4           | **String** | "microsoft.com/WMPPD: 10,0" |



 

В следующей таблице приведены сведения об операции MTP для ускоренной пересылки метаданных.



| Элемент                  | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|-----------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Код операции        | 0x9201                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| Параметр операции 1 | Идентификатор транзакции, предоставленный устройством во время предыдущего сеанса. Для первого сеанса это значение равно нулю.                                                                                                                                                                                                                                                                                                                                                                                       |
| Параметр операции 2 | Начальный индекс. Это значение всегда равно нулю при первом вызове сеанса. При последующих вызовах в рамках одного сеанса синхронизации это значение увеличивается на сумму количества измененных и удаленных элементов из предыдущих данных ответа.                                                                                                                                                                                                                                             |
| Параметр операции 3 | 0x10000. Эта константа, определенная в вмпдевицес. h, является максимальным числом Пуоидс, которое может быть возвращено в ответе. Обратите внимание, что значение этой константы может быть пересмотрено в будущих выпусках этого файла заголовка.                                                                                                                                                                                                                                                                                     |
| Параметр операции 4 | 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| Параметр операции 5 | 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| Данные                  | Устройство возвращает два непрерывных массива MTP, содержащие Пуоидс. Каждый массив MTP начинается с значения **DWORD** , показывающего количество элементов в массиве, за которым следует массив элементов. Первый массив MTP содержит список добавленных или измененных Пуоидс. Второй массив MTP содержит список Пуоидс, удаленных с переносного устройства. Обратите внимание, что сумма числа ПУОИД в двух массивах не должна превышать значение, переданное в параметре операции 3.<br/> |
| Направление данных        | R->I                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| Параметры кода ответа | **MTP \_ ОТВЕТ \_ OK** (0x2001) или допустимый код ответа ошибки.                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Параметр ответа 1  | ИДЕНТИФИКАТОР текущей транзакции устройства.                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Параметр ответа 2  | Число Пуоидс, которые остаются для получения в будущих запросах.                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Параметр ответа 3  | **DWORD** , содержащий сведения о состоянии. Состояние указывается в побитовой последовательности. Дополнительные сведения об используемых флагах см. в разделе Примечания.                                                                                                                                                                                                                                                                                                                                                                     |
| Параметр ответа 4  | 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| Параметр ответа 5  | 0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |



 

## <a name="remarks"></a>Комментарии

Состояние указывается в ответном параметре 3 в побитовом режиме с помощью следующих флагов.



| Флаг                                             | Значение | Описание                                                                                                                                                                                                                          |
|--------------------------------------------------|-------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **WMP \_ мдрт \_ Флаги \_ \_ \_ неотправленные удаленные элементы** | 0x1   | Элементы были удалены до того, как будет сообщено первое имя пути к объекту. Это часто означает, что устройство было переформатировано.                                                                                                           |
| **WMP \_ мдрт \_ Флаги \_ \_ невключенных добавленных \_ элементов**   | 0x2   | Устройство содержит некоторые добавленные элементы, которые не могут быть возвращены в списке ПУОИДС. Обратите внимание, что этот флаг не является избыточным для параметра ответа 2. Установите этот флаг только в том случае, если запрошенные элементы не могут быть возвращены устройством. |



 

Биты с 2 по 31 зарезервированы для будущего использования. Эти биты должны иметь значение 0.

Проигрыватель Windows Media отправляет команду MTP на устройство в начале сеанса синхронизации до передачи файлов мультимедиа. Устройство должно вернуть свой ответ как можно быстрее, чтобы избежать задержек в операции синхронизации.

Проигрыватель Windows Media запрашивает значения для атрибутов, перечисленных в [сведениях о метаданных](about-the-metadata.md) для каждого измененного пауид, возвращенного в ответе. Проигрыватель Windows Media может отправить обновленные значения этих атрибутов устройству в последующих командах.

Файлы, которые были удалены с устройства, можно скопировать на устройство еще раз, если это требуется для параметров пользователя.

## <a name="related-topics"></a>См. также

<dl> <dt>

[**Расширения устройств для ускоренной пересылки метаданных**](device-extensions-for-accelerated-metadata-transfer.md)
</dt> </dl>

 

 





