---
title: Событие Player. команду скрипта
description: Событие команду скрипта возникает при получении синхронизированной команды или URL-адреса. | Событие Player. команду скрипта
ms.assetid: d3aec4e2-1b0e-414e-8113-0af4fcd37e3b
keywords:
- Проигрыватель Windows Media Event команду скрипта
- Проигрыватель Windows Media Event команду скрипта, класс Player
- Класс проигрывателя Windows Media Player, событие команду скрипта
topic_type:
- apiref
api_name:
- Player.ScriptCommand
api_location:
- wmp.dll
api_type:
- COM
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 3f9ca7ec22694956e1d91d055e8db057a91ecca4
ms.sourcegitcommit: c8ec1ded1ffffc364d3c4f560bb2171da0dc5040
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2021
ms.locfileid: "105708626"
---
# <a name="playerscriptcommand-event"></a>Событие Player. команду скрипта

Событие **команду скрипта** возникает при получении синхронизированной команды или URL-адреса.

## <a name="syntax"></a>Синтаксис


```JScript
Player.ScriptCommand(
  scType,
  Param
)
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*сктипе* 
</dt> <dd>

Строка, указывающая тип команды скрипта.

</dd> <dt>

*Байт* 
</dt> <dd>

**Строка** , указывающая команду скрипта.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Это событие не возвращает значение.

## <a name="remarks"></a>Комментарии

Команды можно внедрять из звуков и изображений в файл или поток Windows Media. Команды представляют собой пару строк в Юникоде, связанных с назначенным временем в потоке. Когда поток достигнет времени, связанного с командой, элемент управления проигрывателя Windows Media отправляет событие **команду скрипта** с двумя параметрами. Один параметр указывает тип отправляемой команды, а другой параметр задает команду. Тип параметра используется для определения способа обработки параметра команды. Любой тип команды может быть внедрен в файл или поток для обработки событием **команду скрипта** .

В следующей таблице перечислены типы команд сценариев, которые автоматически обрабатываются проигрывателем Windows Media.



| Тип                   | Описание                                                                                                                                                         |
|------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| CAPTION                | Элемент управления отображает связанный текст в DIV, заданном параметром *клоседкаптион*. **каптионингид**.                                                                  |
| ЖУРНАЛЕ                  | Указывает элементу управления на выполнение инструкций, определенных для указанного события.                                                                                          |
| ФАЙЛОВ               | Элемент управления сбрасывает свойство **URL-адреса** , пытается открыть указанный файл и немедленно начинает воспроизведение нового потока.                                        |
| опеневент              | Помещает связанную команду типа события в буфер для своевременного выполнения скрипта события.                                                                                 |
| синчронизедлириклирик | Параметр *param* содержит синхронизированный текст лирик. Проигрыватель Windows Media отображает текст лирик в области скрытых субтитров в **воспроизводимой** функции. |
| TEXT                   | Элемент управления отображает связанный текст в DIV, заданном параметром *клоседкаптион*. **каптионингид**.                                                                  |
| URL-адрес                    | Этот элемент управления автоматически открывает URL-адрес, указанный с помощью браузера по умолчанию, если *Параметры*. Свойство **инвокеурлс** имеет значение true.                      |



 

Можно внедрить любой другой тип команды при условии, что вы предоставляете для выполнения команды взаимный код. Хотя неизвестные команды игнорируются элементом управления проигрывателем Windows Media, они по-прежнему передаются в событие **команду скрипта** .

Команды URL-адреса, получаемые элементом управления проигрывателем Windows Media, вызываются автоматически в веб-браузере по умолчанию, если *Параметры*. Свойство **инвокеурлс** имеет значение true. Можно использовать *Параметры*. Свойство **дефаултфраме** для указания целевого фрейма, в котором отображается веб-страница.

URL-адрес, отправляемый проигрывателю Windows Media, обрабатывается относительно базового URL-адреса, указанного в *параметрах*. Свойство **baseURL** . Базовый URL-адрес объединяется с относительно указанным URL-адресом, что приводит к полному URL-адресу, который передается в качестве параметра команды событием **команду скрипта** .

Элемент управления проигрывателя Windows Media всегда обрабатывает входящие команды типа URL-адреса следующим образом:

1.  Получена команда типа URL-адреса.
2.  *Параметры*. **baseURL** используется для создания полного URL-адреса из относительного URL-адреса, указанного в команде скрипта.
3.  Вызывается *команду скрипта* .
4.  После *команду скрипта* возвращает *Параметры*. **инвокеурлс** .
5.  Если *Параметры*. **инвокеурлс** имеет значение true, а команда является URL-типом, вызывается указанный URL. Если *Параметры*. **инвокеурлс** имеет значение false или если команда не является типом URL-адреса, команда игнорируется.

При создании файла Windows Media можно указать кадр, в котором будет отображаться новый URL-адрес, объединяя два амперсанда и имя кадра в поле параметра. В приведенном ниже примере показаны стандартные параметры *команду скрипта* . Он указывает, что URL-адрес *MyPage* должен быть запущен в кадре *мифраме* .


```JScript
scType = "URL"
Param = https://myweb/mypage.html&&myframe

```



Событие команду скрипта не вызывается, если файл сканируется (перемотка вперед или быстро).

Значение параметров события указывается проигрывателем Windows Media, доступ к которому можно получить или передать в метод в импортированном файле JScript с использованием имени параметра. Имя этого параметра должно быть введено в точности так, как показано, включая прописные буквы.

## <a name="requirements"></a>Требования



| Требование | Значение |
|--------------------|------------------------------------------------------------------------------------|
| Версия<br/> | Проигрыватель Windows Media версии 7,0 или более поздней.<br/>                              |
| DLL<br/>     | <dl> <dt>Wmp.dll</dt> </dl> |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**Объект Player**](player-object.md)
</dt> <dt>

[**Player. URL**](player-url.md)
</dt> <dt>

[**Settings. baseURL**](settings-baseurl.md)
</dt> <dt>

[**Settings. Дефаултфраме**](settings-defaultframe.md)
</dt> <dt>

[**Settings. Инвокеурлс**](settings-invokeurls.md)
</dt> </dl>

 

 





