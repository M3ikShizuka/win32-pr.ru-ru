---
title: Регистрация подключаемых модулей DSP
description: Регистрация подключаемых модулей DSP
ms.assetid: af264ff7-702b-4a49-a14d-ab8563a40c4e
keywords:
- подключаемые модули проигрыватель Windows Media, записи реестра
- подключаемые модули, записи реестра
- подключаемые модули обработки цифровых сигналов, записи реестра
- Подключаемые модули DSP, записи реестра
- реестр, подключаемые модули DSP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7671c59dfe64094afbc5f0537bcae237b3812699f4db1a06519054b14ef295f2
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118570384"
---
# <a name="registering-dsp-plug-ins"></a>Регистрация подключаемых модулей DSP

чтобы сделать подключаемый модуль DSP доступным в проигрыватель Windows Media необходимо создать следующие подразделы и записи реестра на компьютере пользователя.


```C++
[HKEY_CLASSES_ROOT\CLSID\PluginClsid]
@=PluginClassFriendlyName

[HKEY_CLASSES_ROOT\CLSID\PluginClsid\InprocServer32]
@=PluginModuleName
"ThreadingModel"="Threading"
```



В предыдущем синтаксисе реестра символы курсивом являются заполнителями для имен и глобально уникальных идентификаторов (GUID), характерных для подключаемого модуля DSP. В следующей таблице описаны эти заполнители.



| Заполнитель               | Описание                                                                                                                                                                                                                                                                                                                                                                                                                  |
|---------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| *плугинклсид*             | Идентификатор GUID, который является идентификатором класса для основного класса подключаемого модуля DSP. Это класс, реализующий **имедиаобжект**, **иплугиненабле** и, возможно, **испеЦифипропертипажес**. В подключаемом модуле с двойным режимом этот класс также реализует **имфтрансформ** и **имфжетсервице**. Этот GUID должен быть в формате реестра, заполненном фигурными скобками.<br/> Формат: {XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX}<br/> |
| *плугинклассфриендлинаме* | Понятное имя для первичного класса подключаемого модуля DSP. Пример: "класс Просеваредсп"<br/>                                                                                                                                                                                                                                                                                                                                 |
| *плугинмодуленаме*        | Полный путь к библиотеке DLL, реализующей подключаемый модуль DSP. Пример: "C: \\ Program Files \\ Proseware \\ProsewareDsp.dll"<br/>                                                                                                                                                                                                                                                                                     |
| *Работа с потоками*               | Строка, указывающая потоковую модель для подключаемого модуля. если подключаемый модуль будет запущен с проигрыватель Windows Media 11 на Windows Vista, эта запись реестра должна быть равна "Both". если подключаемый модуль будет работать на Windows XP или более ранних операционных системах, эта запись реестра может быть равна "апартамент" или "Both".                                                                                           |



 

если подключаемый модуль DSP реализует пользовательский интерфейс, а подключаемый модуль будет работать в проигрыватель Windows Media 11 в Windows Vista, необходимо создать следующие разделы и записи реестра на компьютере пользователя.


```C++
[HKEY_CLASSES_ROOT\CLSID\ProxyStubClsid]
@=PSFactoryBuffer

[HKEY_CLASSES_ROOT\CLSID\ProxyStubClsid\InprocServer32]
@=ProxyStubModuleName
"ThreadingModel"="Apartment"

[HKEY_CLASSES_ROOT\Interfaces\CustomInterfaceId]
@=CustomInterfaceName

[HKEY_CLASSES_ROOT\Interfaces\CustomInterfaceId\NumMethods]
@=NumberOfMethods

[HKEY_CLASSES_ROOT\Interfaces\CustomInterfaceId\ProxyStubClsid32]
@=ProxyStubClsid
```



В предыдущем синтаксисе реестра символы в курсиве являются заполнителями для имен, числовых значений и глобально уникальных идентификаторов (GUID), характерных для подключаемого модуля DSP. В следующей таблице описаны эти заполнители.



| Заполнитель           | Описание                                                                                                                                                                                                                                                                |
|-----------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| *проксистубклсид*      | Идентификатор GUID, который является идентификатором класса для класса, реализующего прокси-серверы и заглушки для настраиваемых интерфейсов подключаемого модуля DSP. Этот GUID должен быть в формате реестра, заполненном фигурными скобками.<br/> Формат: {XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX}<br/> |
| *проксистубмодуленаме* | Полный путь к библиотеке DLL, которая реализует интерфейсы прокси-сервера и заглушки для подключаемого модуля DSP. Пример: "C: \\ Program Files \\ Proseware \\ProsewareDspPS.dll"<br/>                                                                                               |
| *кустоминтерфацеид*   | GUID, который является идентификатором интерфейса для пользовательского интерфейса, реализованного подключаемым модулем DSP. Этот GUID должен быть в формате реестра, заполненном фигурными скобками.<br/> Формат: {XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX}<br/>                           |
| *кустоминтерфаценаме* | Имя пользовательского интерфейса, реализуемого подключаемым модулем DSP. Пример: "Ипросеваредсп"<br/>                                                                                                                                                                  |
| *нумберофмесодс*     | Количество методов, включая наследуемые методы, определенные настраиваемым интерфейсом. Пример: "5"<br/>                                                                                                                                                                  |



 

Если подключаемый модуль DSP предоставляет страницу свойств, необходимо создать следующие подразделы и записи реестра на компьютере пользователя.


```C++
[HKEY_CLASSES_ROOT\CLSID\PropPageClsid]
@=PropPageClassFriendlyName

[HKEY_CLASSES_ROOT\CLSID\PropPageClsid\InprocServer32]
@=PluginModuleName
"ThreadingModel"="Apartment"
```



В предыдущем синтаксисе реестра символы курсивом являются заполнителями для имен и глобально уникальных идентификаторов (GUID), характерных для подключаемого модуля DSP. В следующей таблице описаны эти заполнители.



| Заполнитель                 | Описание                                                                                                                                                                                                                            |
|-----------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| *проппажеклсид*             | Идентификатор GUID, который является идентификатором класса для класса страницы свойств, предоставляемого подключаемым модулем DSP. Этот GUID должен быть в формате реестра, заполненном фигурными скобками.<br/> Формат: {XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX}<br/> |
| *проппажеклассфриендлинаме* | Понятное имя для класса страницы свойств. Пример: "класс страницы свойств Просеваредсп"<br/>                                                                                                                                     |
| *плугинмодуленаме*          | Полный путь к библиотеке DLL, реализующей подключаемый модуль DSP. Пример: "C: \\ Program Files \\ Proseware \\ProsewareDsp.dll"<br/>                                                                                               |



 

**Вызов Ивмпплугинрегистрар**

В дополнение к подразделам и записям реестра, описанным в предыдущих списках и таблицах, необходимо создать некоторые разделы и записи реестра, вызвав [ивмпмедиаплугинрегистрар:: вмпрегистерплайерплугин](/previous-versions/windows/desktop/api/wmpservices/nf-wmpservices-iwmpmediapluginregistrar-wmpregisterplayerplugin). этот метод выполняет необходимую регистрацию, чтобы позволить проигрыватель Windows Media распознать подключаемый модуль и предоставить его пользователю в качестве параметра.

Вызовите метод **ивмпмедиаплугинрегистрар:: вмпрегистерплайерплугин** в функции **DllRegisterServer** подключаемого модуля и вызовите [ивмпмедиаплугинрегистрар:: вмпунрегистерплайерплугин](/previous-versions/windows/desktop/api/wmpservices/nf-wmpservices-iwmpmediapluginregistrar-wmpunregisterplayerplugin) в функции **DllUnregisterServer** подключаемого модуля. Чтобы получить указатель на интерфейс **ивмпмедиаплугинрегистрар** , вызовите **COCREATEINSTANCE**, передав CLSID \_ вмпмедиаплугинрегистрар в качестве идентификатора класса. Константа CLSID \_ вмпмедиаплугинрегистрар определена в вмпсервицес. h.

**Регистрация в мастере подключаемых модулей DSP**

мастер подключаемых модулей DSP, включенный в Windows SDK, создает образец кода, основанный на библиотеке активных шаблонов (ATL). в примере функции **DllRegisterServer** подключаемого модуля вызывается функция **регистерсервер** библиотеки ATL, которая создает подразделы и записи реестра в соответствии с двумя файлами скриптов реестра в проекте Visual Studio. Файл *имяПроекта*. RGS содержит скрипт для регистрации основного класса подключаемого модуля, а свойство *имя_проекта файла ИмяПроекта* содержит скрипт для регистрации класса страницы свойств подключаемого модуля. Пример функции **DllRegisterServer** подключаемого модуля также вызывает **Ивмпплугинрегистрар:: вмпрегистерплайерплугин**.

Мастер подключаемых модулей DSP также создает код для компонента-заглушки прокси-сервера, который представляет собой самостоятельно регистрируемый файл .dll. Код регистрации для этого файла находится в DLLDATA. cpp. Подпрограммы макроса **dlldata \_** расширяются для включения реализации **DllRegisterServer**.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[**Обзор подключаемого модуля DSP**](dsp-plug-in-developer-overview.md)
</dt> <dt>

[**ивмпмедиаплугинрегистрар**](/previous-versions/windows/desktop/api/wmpservices/nn-wmpservices-iwmpmediapluginregistrar)
</dt> </dl>

 

 





