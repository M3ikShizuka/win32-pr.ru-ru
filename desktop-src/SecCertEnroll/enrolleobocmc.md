---
description: Создает запрос на сертификат CMC от имени другого пользователя и регистрирует пользователя в иерархии сертификатов.
ms.assetid: 14cc76c9-0e2b-498f-b058-244af6e9111e
title: енроллеобокмк
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ca888d949054d695056d42045335f17dfca2f4d3
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104542682"
---
# <a name="enrolleobocmc"></a>енроллеобокмк

Пример Енроллеобокмк создает запрос сертификата CMC от имени другого пользователя и регистрирует пользователя в иерархии сертификатов. Регистрация от имени другого пользователя требует, чтобы запрос сертификата был подписан с помощью сертификата агента регистрации.

## <a name="location"></a>Расположение

При установке пакета средств разработки программного обеспечения (SDK) для Microsoft Windows этот образец устанавливается по умолчанию в папке *% ProgramFiles%* \\ Microsoft SDK \\ Windows \\ v 7.0 \\ Samples \\ Security SSL \\ Certificate \\ \\ енроллеобокмк.

## <a name="discussion"></a>Разговор

Пример Енроллеобокмк:

1.  Обрабатывает следующие аргументы командной строки:
    -   Имя шаблона сертификата.
    -   Имя пользователя, запросившего сертификат.
    -   Имя файла обмена личной информацией (PFX), в котором необходимо сохранить запрос.
    -   Пароль для использования с PFX-файлом.
    -   Необязательное имя шаблона агента регистрации. Шаблон используется для создания сертификата агента регистрации, если он отсутствует в хранилище сертификатов.
2.  Создает объект [**IX509CertificateRequestCmc**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509certificaterequestcmc) и инициализирует его с помощью шаблона сертификата, указанного в командной строке.
3.  Добавляет имя запросившего в объект запроса CMC.
4.  Извлекает существующий сертификат агента регистрации или, если он не найден, создает запрос сертификата из шаблона агента регистрации, указанного в командной строке, и пытается его зарегистрировать.
5.  Проверяет цепочку сертификатов, содержащую сертификат агента регистрации.
6.  Создает объект [**исигнерцертификате**](/windows/desktop/api/CertEnroll/nn-certenroll-isignercertificate) , инициализирует его с помощью сертификата агента регистрации, получает коллекцию [**исигнерцертификатес**](/windows/desktop/api/CertEnroll/nn-certenroll-isignercertificates) из объекта запроса CMC и добавляет объект сертификата подписи агента регистрации в коллекцию. Объект [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) , который обсуждается на следующем шаге, использует сертификат для подписи запроса CMC.
7.  Создает объект [**IX509Enrollment**](/windows/desktop/api/CertEnroll/nn-certenroll-ix509enrollment) , инициализирует его с помощью запроса CMC, пытается зарегистрировать его и проверяет ход выполнения процесса регистрации.
8.  Экспортирует установленный сертификат в PFX-файл. Файл защищен с помощью пароля, указанного в командной строке. Функция Енкодетофилев определена в Енроллкоммон. cpp.
9.  Удаляет сертификат из хранилища сертификатов. Функции, используемые в следующем примере кода, можно найти в документации по CryptoAPI.
10. Удаляет закрытый ключ с компьютера.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Запрос ЕОБО CMC](cmc-eobo-request.md)
</dt> <dt>

[\#Запрос PKCS 10](pkcs--10-request.md)
</dt> <dt>

[Использование прилагаемых примеров](using-the-included-samples.md)
</dt> </dl>

 

 



