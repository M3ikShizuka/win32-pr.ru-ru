---
description: Служба (или любой процесс, выполняющийся в другом контексте безопасности), который должен получить доступ к удаленному ресурсу, должен использовать имя UNC для доступа к ресурсу.
ms.assetid: 2582259d-077c-4089-9a87-1a377994f0bd
title: Службы и перенаправленные диски
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a3b1435e69ded3bf13a0869a0b9ad2b90bb4682c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "103999388"
---
# <a name="services-and-redirected-drives"></a>Службы и перенаправленные диски

Служба (или любой процесс, выполняющийся в другом контексте безопасности), который должен получить доступ к удаленному ресурсу, должен использовать имя UNC для доступа к ресурсу. Служба должна иметь соответствующие привилегии для доступа к ресурсу. Если служба на стороне сервера использует RPC-подключение, на удаленном сервере должно быть включено делегирование.

Буквы дисков не являются глобальными для системы. Каждый сеанс входа в систему получает собственный набор букв диска от A до Z. Таким образом, перенаправляемые диски не могут совместно использоваться процессами под разными учетными записями пользователей. Более того, служба (или любой процесс, работающий в собственном сеансе) не может получить доступ к буквам дисков, которые были установлены в другом сеансе входа в систему.

Служба не должна напрямую обращаться к локальным или сетевым ресурсам через подключенные буквы дисков, а также не должна вызывать команду **net use** для сопоставления букв диска во время выполнения. Команда **net use** не рекомендуется по нескольким причинам:

-   Сопоставления дисков существуют во всех контекстах входа, поэтому если приложение выполняется в контексте [учетной записи LocalService](localservice-account.md), то любая другая служба, работающая в этом контексте, может иметь доступ к подключенному диску.
-   Если служба предоставляет явные учетные данные для команды **net use** , эти учетные данные могут быть случайно предоставлены за пределами границ службы. Вместо этого служба должна использовать [олицетворение клиента](/windows/desktop/SecAuthZ/client-impersonation) для олицетворения пользователя.
-   Несколько служб, работающих в одном контексте, могут помешать друг другу. Если обе службы выполняют явное **Использование net use** и одновременно предоставляют одни и те же учетные данные, одна служба завершится ошибкой с "уже подключенным".

Кроме того, служба не должна использовать [сетевые функции Windows](/windows/desktop/WNet/windows-networking-functions) для управления буквами подключенных дисков. Хотя функции Внет могут успешно возвращаться, результирующее поведение не так преднамеренно. Когда система устанавливает перенаправленный диск, она хранится отдельно для каждого пользователя. Только пользователь может управлять перенаправленным диском. Система отслеживает перенаправляемые диски на основе идентификатора безопасности входа пользователя (SID). Идентификатор безопасности входа — это уникальный идентификатор для сеанса входа пользователя. Один пользователь может иметь несколько одновременных сеансов входа в систему.

Если служба настроена для работы под учетной записью пользователя, система всегда создает новый сеанс входа для пользователя и запускает службу в этом новом сеансе входа. Таким образом, служба не может управлять сопоставлениями дисков, установленными в других сеансах пользователя.

**Windows Server 2003:** На компьютере с несколькими сетевыми интерфейсами (т. е. многосетевым компьютером) задержка до 60 секунд может возникнуть при использовании UNC-путей для доступа к файлам, хранящимся на удаленном сервере SMB. Дополнительные сведения см. в [статье 890553](https://support.microsoft.com/kb/890553) базы знаний справки и поддержки.

 

 
