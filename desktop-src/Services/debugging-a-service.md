---
description: Для отладки службы можно использовать один из следующих методов.
ms.assetid: 6f4ae117-2120-4c1e-b69f-641ce2e633fa
title: Debugging a Service (Отладка службы)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7ebd99acfc6ad0e436b7f726c96af9e5d1c58442
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127265067"
---
# <a name="debugging-a-service"></a>Debugging a Service (Отладка службы)

Для отладки службы можно использовать один из следующих методов.

-   Используйте отладчик для отладки службы во время ее работы. Сначала получите идентификатор процесса (PID) процесса службы. После получения идентификатора процесса присоединитесь к выполняющемуся процессу. Сведения о синтаксисе см. в документации, прилагаемой к отладчику.
-   Вызовите функцию [**DebugBreak**](/windows/desktop/api/debugapi/nf-debugapi-debugbreak) , чтобы вызвать отладчик для JIT-отладки.
-   Укажите отладчик, который будет использоваться при запуске программы. Для этого создайте ключ, называемый **выполнением файла изображения** , в следующем расположении реестра:

    **HKEY \_ \_ \\ программное обеспечение на локальном компьютере \\ Microsoft \\ Windows NT \\ CurrentVersion**

    Создайте подраздел с тем же именем, что и у службы (например, MYSERV.EXE). В этот подраздел добавьте значение типа **reg \_ SZ** с именем **Debugger**. Используйте полный путь к отладчику в качестве строкового значения. В приложении панели управления "службы" выберите службу, нажмите кнопку " **Запуск** " и установите флажок " **разрешить службе взаимодействовать с рабочим столом**". Служба должна быть интерактивной службой, иначе отладчик не сможет работать на рабочем столе по умолчанию. обратите внимание, что этот метод больше не поддерживается в Windows Vista, поскольку все службы выполняются в сеансе, который зарезервирован исключительно для служб и не поддерживает отображение пользовательского интерфейса.

-   Используйте [трассировку событий](/windows/desktop/ETW/event-tracing-portal) для записи данных в журнал.

Для отладки кода инициализации службы автозапуска необходимо временно установить и запустить службу в качестве службы запуска по требованию.

Иногда может потребоваться запустить службу в качестве консольного приложения для отладки. В этом сценарии функция [**сбой StartServiceCtrlDispatcher**](/windows/desktop/api/Winsvc/nf-winsvc-startservicectrldispatchera) будет возвращать **ошибку \_ Failed \_ Service \_ Controller \_ Connect**. Поэтому не забудьте структурировать код таким образом, чтобы код, зависящий от службы, не вызывался при возвращении этой ошибки.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Отладка приложения службы](https://msdn.microsoft.com/library/cc267835.aspx)
</dt> <dt>

[Средства отладки для Windows](https://msdn.microsoft.com/library/cc267445.aspx)
</dt> </dl>

 

 
