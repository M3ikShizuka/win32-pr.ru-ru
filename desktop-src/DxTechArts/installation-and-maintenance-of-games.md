---
title: Установка и обслуживание игр
description: В этой статье описывается набор рекомендаций, которые помогут сократить время, необходимое для установки игры, предотвращения ненужных обращений в службу поддержки и позволить пользователям быстро и просто начать играть в игру как можно быстрее.
ms.assetid: c953165d-2318-ca06-a895-abedcbcb594c
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: de171fd76654eb3b6edb8818ec073c4ef5ba8ca4
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104339129"
---
# <a name="installation-and-maintenance-of-games"></a>Установка и обслуживание игр

В этой статье описывается набор рекомендаций, которые помогут сократить время, необходимое для установки игры, предотвращения ненужных обращений в службу поддержки и позволить пользователям быстро и просто начать играть в игру как можно быстрее.

-   [Начальная установка](#initial-installation)
    -   [Упрощение пользовательского интерфейса установки](#streamlining-the-installation-ui)
    -   [Сокращение времени, необходимого для установки](#reducing-the-time-required-for-installation)
    -   [Минимальная установка](#minimal-installation)
    -   [Установка по запросу](#install-on-demand)
-   [Игра после установки](#post-installation-game-play)
    -   [Загрузка](#autorun)
    -   [Преобразование установки установки по запросу в полную установку](#converting-an-install-on-demand-installation-to-a-full-installation)
    -   [Обслуживание программного обеспечения и содержимого игр](#maintenance-of-game-software-and-content)
    -   [Проверка наличия обновлений автоматически](#checking-for-updates-automatically)
    -   [Автоматическая загрузка исправлений](#downloading-patches-automatically)
-   [Другие ресурсы](#other-resources)
-   [См. также](#related-topics)

## <a name="initial-installation"></a>Начальная установка

Пользователи приобретают игры, так как они пользуются их воспроизведением, а не потому, что они могут их установить. Для конечных пользователей установка игры должна быть быстрой, простой и понятной. В идеале конечные пользователи даже не должны видеть пользовательский интерфейс установки. они должны иметь возможность просто удалить игровой диск в лоток и начать играть.

### <a name="streamlining-the-installation-ui"></a>Упрощение пользовательского интерфейса установки

Общие аспекты существующих пользовательских интерфейсов установки игр мешают работе конечного пользователя.

-   Запросите ненужные вопросы пользователя.

    Например, многие игры запрашивают, хочет ли пользователь установить DirectX. Если для игры требуется запуск Microsoft DirectX, а правильная версия DirectX еще не установлена, игра должна просто установить DirectX.

-   Задавайте вопросы пользователей о том, что большинство пользователей ответит таким же образом.

    Для обычных пользователей параметры по умолчанию для пути установки, расположения меню "Пуск" и т. д. являются все правильно. Предлагают дополнительные параметры для пользователей, желающих изменить эти параметры.

Пользовательский интерфейс установки должен позволять обычным пользователям начать играть в игру как можно скорее. Если функция автозапуска включена на компьютере пользователя (по умолчанию), программа установки должна предположить, что пользователь хочет как можно быстрее воспроизвести игру, минуя все ненужные вопросы. Установка рограмма[Install by Demand](#install-on-demand)m должна начать установку игры в путь установки по умолчанию, предпочтительно с помощью программы установки, как описано в разделе. Можно дать пользователям возможность изменить параметры установки перед автоматическим запуском установки. Тем не менее, это следует сделать, запрашивая у пользователя нажатие клавиши для расширенных параметров установки, а затем продолжайте автоматически с параметрами по умолчанию, если пользователь не найдет на этот ключ в течение пяти – 10 секунд.

Если функция автозапуска не включена на компьютере пользователя, программа установки должна предположить, что пользователю не нужно, чтобы программа установки автоматически начинала установку игры. Если программа установки запускается другими способами, отличными от AutoRun, она должна запустить пользовательский интерфейс расширенной установки.

### <a name="reducing-the-time-required-for-installation"></a>Сокращение времени, необходимого для установки

Сегодня большинство игр Microsoft Windows занимает от пяти минут до половины часа, чтобы завершить процесс установки. В отличие от этого, большинство консолей консоли не требует более тридцати секунд с момента вставки пользователем игрового компактного диска на то время, когда пользователь сможет играть в игру. Это различие обусловлено тем, что большинство игр Windows рассчитаны на наиболее частое выполнение (если не все) их содержимого с жесткого диска компьютера; консоли, в которых отсутствует место для постоянного хранения больших объемов содержимого, необходимо, чтобы содержимое было запущено с исходного носителя. Хотя загрузка содержимого с локального жесткого диска обеспечивает более быструю загрузку в игру, недостатком является то, что все это содержимое должно быть скопировано с исходного носителя на жесткий диск в некоторый момент времени. В большинстве игр Windows все содержимое копируется на жесткий диск в рамках процесса установки. Это отменяет первоначальный опыт пользователя в игре, представляя пользователю смотреть индикатор выполнения в течение нескольких минут, прежде чем играть в игру.

Существует два подхода, которые можно использовать для минимизации времени, затраченного на первоначальное выполнение установки игры: [Минимальная установка](#minimal-installation) и [Установка по запросу](#install-on-demand).

### <a name="minimal-installation"></a>Минимальная установка

В случае минимальной установки игра устанавливает на жесткий диск только минимальный набор содержимого. Обычно это состоит только из исполняемых файлов и библиотек DLL. Доступ к остальной части содержимого осуществляется непосредственно с исходного носителя. Это радикально сокращает время, необходимое для установки, так как исполняемый файл игры редко превышает 10-20 МБ. Недостаток заключается в том, что игра занимает больше времени для загрузки содержимого во время игры, поскольку она должна загружаться с более медленного исходного носителя.

Чтобы создать минимальную конфигурацию установки в процессе установки на основе установщик Windows:

-   Сгруппируйте все компоненты, которые должны быть установлены на жестком диске, в компонент, помеченный для установки локально.

    Этот компонент будет называться функцией начальной загрузки.

-   Сгруппируйте все компоненты, которые должны быть запущены с исходного носителя, в функцию, помеченную как "запустить из источника".
-   При открытии файла, который может находиться на исходном носителе, используйте функцию [**мсижеткомпонентпас**](/windows/desktop/api/msi/nf-msi-msigetcomponentpatha) , чтобы определить путь к файлу, а не жестко закодировать путь.

    Это гарантирует, что файл можно будет найти, даже если буква диска на компакт-диске пользователя или DVD-диска была изменена.

-   Сжимать содержимое, которое остается на компакт-диске или DVD-диске.

    Объем времени ЦП, затраченный на распаковку содержимого, обычно скрыт скоростью передачи данных с CD-или DVD-диска.

-   Группирование содержимого в большие непрерывные файлы и доступ к ним в последовательном порядке.

    Время поиска дисководов компакт-и DVD-дисков абисмал по сравнению с жесткими дисками, а большинство дисководов компакт-и DVD-дисков не достигает пиковых скоростей передачи, если только они не считывают большой непрерывный файл.

-   Разметьте содержимое на компакт-диске или DVD-диске в том порядке, в котором он может быть доступен.

    Время поиска значительно сокращается, если доступ к файлам осуществляется в том же порядке, что и их структура на диске.

### <a name="install-on-demand"></a>Установка по запросу

В сценарии установки по запросу, как и для минимальной установки, игра изначально устанавливается на жесткий диск только для тех файлов, которые необходимы для запуска игры. Однако вместо доступа к остальному содержимому исходного носителя каждый раз, когда он необходим, игра фактически устанавливает каждый фрагмент содержимого на жесткий диск по мере необходимости в первый раз, а затем обращается к нему с локального жесткого диска при каждом последующем использовании. Время, необходимое для первоначальной установки, равно тому же, что и в случае минимальной установки, но после первого обращения к каждому фрагменту содержимого повышается время загрузки.

Чтобы создать конфигурацию по запросу в процессе установки на основе установщик Windows, выполните следующие действия.

-   Сгруппируйте все компоненты, которые должны быть изначально установлены на жесткий диск, в компонент, помеченный для установки локально.

    Обратите внимание, что это аналогично функции начальной загрузки для минимальной установки.

-   Сгруппируйте оставшееся содержимое в несколько компонентов на основе компонентов, которые, скорее всего, будут использоваться вместе.

    Например, в игре на основе уровня сгруппируйте все содержимое, используемое на определенном уровне, в одну функцию. Обратите внимание, что установщик Windows позволяет совместно использовать компонент несколькими компонентами, поэтому при наличии содержимого, используемого на нескольких уровнях, можно добавить это содержимое в функции для всех необходимых уровней без репликации содержимого. Все эти функции должны быть помечены как "объявленные", что означает, что они не будут устанавливаться изначально, но могут быть установлены позже по мере необходимости.

-   Если требуется файл, сначала проверьте, установлен ли этот файл с помощью функции [**мсикуерифеатурестате**](/windows/desktop/api/msi/nf-msi-msiqueryfeaturestatea).

    Если он еще не установлен (то есть INSTALLSTATE \_ объявляется), вызовите функцию [**мсиконфигурефеатуре**](/windows/desktop/api/msi/nf-msi-msiconfigurefeaturea) , чтобы установить компонент локально. При открытии файла после его установки вызовите [**мсижеткомпонентпас**](/windows/desktop/api/msi/nf-msi-msigetcomponentpatha) , чтобы определить путь к файлу. Хотя это и не является обязательным для этого сценария (поскольку содержимое всегда будет установлено на жесткий диск до его использования), это упрощает поддержку минимальной установки в дополнение к установке по запросу.

-   Если возможно, предвидите, какое содержимое скоро будет необходимо использовать, и установите его в фоновом режиме во время простоя.

    Установка в фоновом режиме наиболее уместна, если игра находится в точке, которая не требует от всех последних задолжений производительности компьютера. Например, при отображении вступительного фильма, вырезанного сцены, меню и т. д.

-   Создайте параметр в меню параметров игры, чтобы принудительно установить все остальное содержимое.

    Для реализации этой функции создайте функцию, которая является родителем всех функций установки по запросу, а затем вызовите [**мсиконфигурефеатуре**](/windows/desktop/api/msi/nf-msi-msiconfigurefeaturea) , чтобы установить этот главный компонент локально. Это приведет к тому, что также будут установлены и локальные компоненты.

-   Макет содержимого должен быть аналогичен для минимальной установки, за исключением того, что содержимое должно быть кластеризовано только с другим содержимым, которое, скорее всего, потребуется одновременно (например, все содержимое одного уровня должно быть вместе).

## <a name="post-installation-game-play"></a>Game-Play после установки

### <a name="autorun"></a>Загрузка

Чтобы воспроизвести уже установленную игру, пользователю нужно только удалить установочный диск в области дисков. Первое, что должно сделать исполняемый файл автозапуска на диске — проверить, установлена ли игра, и, если да, запустить игру. При условии, что игра была установлена с помощью установки на основе установщик Windows, проверка того, установлена ли игра, может быть выполнена с помощью одного вызова функции [**мсикуерипродуктстате**](/windows/desktop/api/msi/nf-msi-msiqueryproductstatea).

### <a name="converting-an-install-on-demand-installation-to-a-full-installation"></a>Преобразование установки установки по запросу в полную установку

Хотя установка по запросу позволяет пользователю начать играть игру намного раньше, чем полная установка, пользователю может потребоваться явно установить оставшуюся часть содержимого игры на локальный жесткий диск. Пользователь может захотеть иметь возможность играть в игру, не требуя наличия исходного носителя, или она может просто не допустить более длительного времени загрузки, полученного в результате установки содержимого по требованию. Если программа установки игры использует установщик Windows, игра может предоставить параметр в пользовательском интерфейсе вариантов в игре, чтобы завершить установку оставшегося содержимого. Когда пользователь выбирает этот параметр, игра может вызвать [**мсиконфигурефеатуре**](/windows/desktop/api/msi/nf-msi-msiconfigurefeaturea) для принудительной установки остальных компонентов. для этого не требуется порождение отдельного приложения установки.

### <a name="maintenance-of-game-software-and-content"></a>Обслуживание программного обеспечения и содержимого игр

Одним из преимуществ использования игр Windows в играх является относительная простота, с которой издатель может выпускать обновления для игры после первоначального выпуска. Если эти обновления познакомится с новым содержимым или просто исправляют ошибки, важно, чтобы процесс обновления был как можно более простым для конечного пользователя. Процесс обновления еще более важен для Интернет-игр, что обычно требует, чтобы все пользователи выполняли последнюю версию игры для подключения.

### <a name="checking-for-updates-automatically"></a>Проверка наличия обновлений автоматически

Пользователям не следует забывать о необходимости искать исправления. Если для игры доступно обновление, пользователь должен по крайней мере получать уведомления, и в идеале это исправление уже должно быть загружено.

Чтобы проверить наличие обновлений в игре, можно просто подключиться к веб-серверу, размещенному на издателе, с помощью определенного URL-адреса и скачать текстовый файл, указывающий номер версии последней доступной версии игры, а также URL-адрес для скачивания пакета, который будет обновлять игру до последней версии.

Проверка наличия обновлений каждый раз, когда пользователь воспроизводит игру, достаточно для того, чтобы убедиться, что у пользователя установлена последняя версия. Однако если наличие нового обновления обнаруживается непосредственно перед тем, как пользователь пытается воспроизвести игру, пользователь может принудительно отложить воспроизведение игры до завершения загрузки обновления. При больших обновлениях или медленных подключениях эта задержка может быть указана в течение часов. Чтобы не допустить принудительного ожидания пользователя перед воспроизведением игры, игра может использовать планировщик задач для планирования периодической проверки наличия новых обновлений. При обнаружении обновления игра может сразу же начать загрузку обновления, чтобы она была полностью скачана и готова к установке при следующем запуске игры.

### <a name="downloading-patches-automatically"></a>Автоматическая загрузка исправлений

После того как игра обнаружит, что доступно новое обновление, необходимо немедленно начать загрузку обновления. Так как задача, которая проверяет наличие обновлений, обычно выполняется в фоновом режиме без вмешательства пользователя, загрузка должна быть как можно более незаметной. Фоновая интеллектуальная служба передачи (BITS) — это функция операционной системы, которая позволяет приложениям скачивать файлы из Интернета, даже если само приложение не работает. Задания загрузки BITS выполняются только после входа пользователя в систему и только в том случае, если компьютер уже подключен к сети. Служба BITS не будет пытаться принудительно подключить компьютер к сети. Если пользователь отключится от сети или выйдет из системы, задание BITS приостанавливается и будет возобновлено при следующем входе пользователя в сеть и подключения к ней. Приложение может настроить задания BITS для использования только пропускной способности сети, которая в противном случае останется неиспользуемой, чтобы предотвратить влияние задания на производительность других приложений, которые могут использовать сеть (например, Интернет-игру). Служба BITS доступна в Windows XP и Windows 2000 с пакетом обновления 3 (SP3).

## <a name="other-resources"></a>Другие ресурсы

Дополнительные сведения о технологиях, упоминаемых в этой статье, см. в соответствующих разделах библиотеки MSDN:

-   [Установщик Windows](/windows/desktop/Msi/windows-installer-portal)
-   [Планировщик заданий](/windows/desktop/TaskSchd/task-scheduler-start-page)
-   [Фоновая интеллектуальная служба передачи](/windows/desktop/Bits/background-intelligent-transfer-service-portal) (бит)

Дополнительные сведения об использовании установщик Windows для игр см. в статье «Введение в установщик Windows для разработчиков игр» в следующий месяц.

## <a name="related-topics"></a>См. также

<dl> <dt>

[**мсиконфигурефеатуре**](/windows/desktop/api/msi/nf-msi-msiconfigurefeaturea)
</dt> <dt>

[**мсикуерипродуктстате**](/windows/desktop/api/msi/nf-msi-msiqueryproductstatea)
</dt> <dt>

[**мсикуерифеатурестате**](/windows/desktop/api/msi/nf-msi-msiqueryfeaturestatea)
</dt> <dt>

[**мсижеткомпонентпас**](/windows/desktop/api/msi/nf-msi-msigetcomponentpatha)
</dt> </dl>

 

 