---
title: Установка DirectX для разработчиков игр
description: Эта статья предназначена для решения некоторых распространенных вопросов о среде выполнения DirectX и использования Директсетуп для установки DirectX.
ms.assetid: 2ab439be-8d99-bcf8-89af-d4274e044c88
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a9c0faf346bd8793e61a89128ce573e29b7a8267
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104070482"
---
# <a name="directx-installation-for-game-developers"></a>Установка DirectX для разработчиков игр

Эта статья предназначена для решения некоторых распространенных вопросов о среде выполнения DirectX и использования Директсетуп для установки DirectX.

-   [Среда выполнения DirectX](#directx-runtime)
-   [Номер версии DirectX](#directx-version-number)
-   [Библиотеки DirectX](#directx-libraries)
-   [Установка DirectX с помощью установщика игры](#installation-of-directx-by-the-games-installer)
-   [Небольшие пакеты установки](#small-installation-packages)
-   [Внутреннее развертывание отладочной среды выполнения DirectX](#internal-deployment-of-the-debug-directx-runtime)

> [!IMPORTANT]
> Устаревший пакет SDK DirectX находится в конце жизни, но он по-прежнему доступен для поддержки старых игр, руководств и проектов. Новые проекты не должны использовать его. Для использования устаревшего пакета SDK DirectX необходимо использовать устаревшие Директсетуп для таких компонентов, как D3DX9, D3DX10, D3DX11, Ксаудио 2,7, Ксинпут 1,3 и транзакции. Дополнительные сведения о текущем состоянии пакета SDK для DirectX см. в разделе [где находится пакет SDK DirectX?](../directx-sdk--august-2009-.md), а в записи блога [нет такой непосредственной настройки](https://walbourn.github.io/not-so-direct-setup/).

## <a name="directx-runtime"></a>Среда выполнения DirectX

Среда выполнения DirectX состоит из основных компонентов и дополнительных компонентов.

Основные компоненты, такие как Direct3D и Директинпут, считаются частью операционной системы. Основные компоненты DirectX 9.0 c не изменились с момента обновления пакета SDK для DirectX (лето 2004) и соответствуют тем, что было выпущено в Microsoft Windows XP с пакетом обновления 2 (SP2), Windows XP Pro x64 Edition и Windows Server 2003 SP1. В состав Windows Vista входит DirectX 10, поддерживающий модель драйвера экрана Windows (WDDM) и Direct3D 10. x. Windows 7 и Windows Vista (см. [KB971644](https://support.microsoft.com/kb/971644)) поддерживают DirectX 11, поддерживающие Direct3D 11, Direct2D, DirectWrite, устройство отрисовки программного обеспечения WARP10 и уровни компонентов 10level9. Дополнительные сведения см. [в статье графические API в Windows](/windows/desktop/direct3darticles/graphics-apis-in-windows-vista) .

Дополнительные компоненты выпускаются в обновлениях пакета SDK DirectX и включают в себя D3DX, XAudio2, КСИНПУТ, управляемые DirectX и другие подобные компоненты. Многие из дополнительных компонентов регулярно обновляются для интеграции отзывов клиентов и предоставления новых функций.

## <a name="directx-version-number"></a>Номер версии DirectX

Номер версии DirectX, например 9.0 c, относится только к версии основных компонентов, например Direct3D, Директинпут или DirectSound. Это число не охватывает версии различных дополнительных компонентов, выпускаемых в пакете SDK DirectX, например D3DX, активной транзакции, КСИНПУТ и т. д.

В целом, номер версии DirectX не имеет смысла, за исключением краткого справочника по основным битам времени выполнения. Это число не должно использоваться для проверки того, установлена ли правильная среда выполнения DirectX, так как она не учитывает дополнительные компоненты DirectX.

## <a name="directx-libraries"></a>Библиотеки DirectX

В прошлом дополнительные компоненты пакета SDK DirectX, включая D3DX, были выпущены как статические библиотеки. Однако теперь они выпускаются в виде библиотек (DLL) с повышенными требованиями к безопасности. Библиотеки DLL позволяют обслуживать ранее выпущенный код. Если эти компоненты были развернуты как статические библиотеки, корпорация Майкрософт не сможет устранить проблемы безопасности, обнаруженные после выпуска.

По мере добавления или изменения компонентов для дополнительных компонентов имена соответствующих библиотек DLL также изменяются, чтобы гарантировать отсутствие регрессий в существующих играх, использующих выпущенные компоненты. Библиотеки DLL для каждого компонента находятся рядом друг с другом, и разработчики игр могут выбрать, какая именно версия DLL используется в игре, путем связывания с соответствующей библиотекой импорта.

Хотя обеспечение установки библиотек DLL в системе не так просто, как простое связывание со статическими библиотеками, в пакет SDK для DirectX внесены некоторые изменения, чтобы решить проблему с моделью DLL.

-   Распространяемый пакет DirectX можно настроить так, чтобы он содержал только те компоненты, которые требуются вашему приложению для снижения распространения и размеров носителей.
-   Папка распространяемые файлы с \\ пакетом SDK \\ для DirectX \\ , теперь содержит CAB-файл для каждого возможного дополнительного компонента, поэтому вам не нужно изучать более старый пакет SDK, чтобы найти их.
-   При установке пакета SDK устанавливаются все возможные дополнительные компоненты.
-   Распространяемый пакет DirectX, содержащий все дополнительные компоненты, доступен в виде веб-установщика и загружаемого пакета. Дополнительные сведения см. в центре разработчиков DirectX ([DirectX](/previous-versions/windows/apps/hh452744(v=win.10))).

## <a name="installation-of-directx-by-the-games-installer"></a>Установка DirectX с помощью установщика игры

> [!Note]  
> См. статью [развертывание Direct3D 11 для разработчиков игр](/windows/desktop/direct3darticles/direct3d11-deployment).

 

Ниже приведены рекомендации по добавлению установки DirectX в установщик игры.



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Термин</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span id="Install_the_redistributable_components_every_time.__"></span><span id="install_the_redistributable_components_every_time.__"></span><span id="INSTALL_THE_REDISTRIBUTABLE_COMPONENTS_EVERY_TIME.__"></span>Устанавливайте распространяемые компоненты каждый раз. <br/></td>
<td>В процессе установки необходимо установить распространяемые компоненты DirectX во время каждой отдельной установки, не позволяя пользователям отказаться от них. Если вы разрешаете раскрывающийся отказ, то некоторые пользователи полагают, что они не нужны, и если они действительно выполняются, игра не будет выполняться. <br/></td>
</tr>
<tr class="even">
<td><span id="Let_the_DirectX_installer_check_for_optional_components.__"></span><span id="let_the_directx_installer_check_for_optional_components.__"></span><span id="LET_THE_DIRECTX_INSTALLER_CHECK_FOR_OPTIONAL_COMPONENTS.__"></span>Разрешите установщику DirectX проверять наличие дополнительных компонентов. <br/></td>
<td>Не следует рассчитывать на то, что в системе уже установлены последние дополнительные компоненты, поскольку Центр обновления Windows и пакеты обновления не предоставляют никаких дополнительных компонентов DirectX. Необходимо установить среду выполнения DirectX, выполнив dxsetup.exe напрямую или вызвав Директсетуп. <br/></td>
</tr>
<tr class="odd">
<td><span id="Set_up_silently.__"></span><span id="set_up_silently.__"></span><span id="SET_UP_SILENTLY.__"></span>Автоматическая настройка. <br/></td>
<td>Запустите программу установки в автоматическом режиме, чтобы пользователи не могли случайно пропустить обновление среды выполнения DirectX. Это можно сделать, запустив dxsetup.exe с помощью следующей команды: <br/>
<pre class="syntax" data-space="preserve"><code>   path-to-redistributable\dxsetup.exe /silent</code></pre>
или путем вызова Директсетуп и отображения пользовательского интерфейса. <br/></td>
</tr>
<tr class="even">
<td><span id="Combine_EULA_acceptances.__"></span><span id="combine_eula_acceptances.__"></span><span id="COMBINE_EULA_ACCEPTANCES.__"></span>Объедините принятие условий лицензионного соглашения. <br/></td>
<td>Если вы запрашиваете пользователя принять условия лицензионного соглашения, объедините его с запросом на принятие лицензионного соглашения DirectX при установке в автоматическом режиме, чтобы запрос на принятие условий лицензионного соглашения происходил только один раз. Запрос должен быть выполнен до установки какого-либо действия, чтобы, если пользователь не принял условия, не завершился сбоем и частичной установкой. <br/></td>
</tr>
<tr class="odd">
<td><span id="Just_run_dxsetup_or_call_DirectSetup.__"></span><span id="just_run_dxsetup_or_call_directsetup.__"></span><span id="JUST_RUN_DXSETUP_OR_CALL_DIRECTSETUP.__"></span>Просто выполните дкссетуп или вызовите Директсетуп. <br/></td>
<td>Поскольку номер версии DirectX не относится ни к чему, кроме основных компонентов DirectX, не проверяйте установленную версию перед запуском dxsetup.exe или вызовом Директсетуп. Кроме того, не следует проверять существование файла для проверки существования необязательного компонента, так как обычно он неправильно определяет, когда компонент существует, но нуждается в обновлении. Однако пакет установки DirectX быстро определит это и выполнит нужное действие. <br/></td>
</tr>
</tbody>
</table>



 

## <a name="small-installation-packages"></a>Небольшие пакеты установки

Можно создать небольшие пакеты установки для DirectX, отменив содержимое папки распространяемого пакета DirectX до минимального набора файлов, необходимых для работы установщика, и оставив все дополнительные компоненты, используемые в игре.

В зависимости от минимальных спецификаций может быть даже не обязательно включать в папку распространяемого установочного носителя базовые CAB-файлы DirectX 9.0 c. Большая часть установок Windows XP имеет пакет обновления 2 (SP2), который включает основные компоненты DirectX 9.0 c, поэтому операция установки DirectX будет выполняться очень быстро, и перезагрузка не потребуется. Самый маленький пакет, который можно создать, составляет около 3 МБ, и его можно сжать до половины этого размера. Пакет, подобный этому, содержит одну версию библиотеки DLL D3DX и требует, чтобы DirectX 9.0 c уже существовал.

Минимальный набор файлов, необходимых для создания распространяемого пакета, — это следующие файлы, расположенные в папке Redist SDK для DirectX ( \\ распространяемые файлы с пакетом SDK для DirectX) \\ \) .

-   dxsetup.exe
-   dsetup32.dll
-   dsetup.dll
-   dxupdate.cab

Добавьте в эти CAB-файлы для компонентов, которые требуется установить. Если требуется, чтобы пользователи вашего приложения уже имели DirectX 9.0 c, не нужно включать DirectX.cab или dxnt.cab, которые составляют большую часть необходимого пространства. DirectX.cab требуется только для Windows 98 и Windows ME; dxnt.cab требуется только для Windows 2000, Windows XP и Windows XP с пакетом обновления 1 (SP1); и дксдллрег \_x86.cab требуются только для windows 2000, Windows XP RTM, Windows XP с пакетом обновления 1 (SP1) и Windows Server 2003 RTM. Кроме того, если вы не используете DirectShow или предполагается, что она уже установлена, можно опустить BDA.cab, BDANT.cab и BDAXP.cab.

> [!Note]  
> Вы можете предположить, что у пользователей вашего приложения уже есть DirectX 9.0 c, если он был установлен в предыдущей версии приложения, поэтому пользователи вынуждены вручную выполнять обновление через веб-установщик, или предполагается, что у них Windows XP с пакетом обновления 2 (SP2) или более поздней версии.

 

Если продолжить работу с этим примером, то при использовании только 32-разрядной версии D3DX в апреле 2006 можно добавить Apr2006 \_ d3dx9 \_ 30 \_x86.cab. Если вы используете 32-2006 32 разрядную версию КСИНПУТ, то вы добавляете Aug2006 \_ ксинпут \_x86.cab.

При наличии собственного 64-разрядного приложения необходимо добавить \_ версии x64. Однако при наличии 32-разрядного приложения, работающего в 64-разрядной ОС, будут работать 32-разрядные версии библиотек DLL.

Затем можно распространить этот пакет файлов и запустить Директсетуп в автоматическом режиме или запустить dxsetup.exe в командной оболочке в автоматическом режиме. Не забывайте защищать этот пакет с помощью проверки версий файлов, и убедитесь, что пользователи не могут отказаться от запуска программы установки DirectX. Одно из этих событий создает процесс установки фаллибле.

## <a name="internal-deployment-of-the-debug-directx-runtime"></a>Внутреннее развертывание отладочной среды выполнения DirectX

Отладочные среды выполнения компонентов DirectX устанавливаются при установке пакета SDK DirectX, но установка пакета SDK на каждый тестовый компьютер может быть нелегкой. Необходимо разработать процесс установки, чтобы скопировать библиотеки DLL среды выполнения отладки из программных файлов \\ \\ Архитектура среды выполнения разработчика Microsoft DirectX SDK \\ \\ в Windows \\ system32 \\ или в папку игры.

Однако настоятельно рекомендуется не просто копировать выпущенные библиотеки времени выполнения, так как это легко забывать, чтобы удалить их для окончательного продукта. Вместо этого вставьте файлы установки DirectX в общую папку и запустите программу установки без вмешательства пользователя из общей папки.

## <a name="desktop-bridge-applications"></a>Приложения для настольных мостов 

Приложения-мосты для настольных систем, использующие D3DX9, D3DX10, D3DX11, Ксаудио 2,7, Ксинпут 1,3 или транзакции, должны загрузить платформу [Microsoft. DirectX. x86](https://download.microsoft.com/download/c/c/2/cc291a37-2ebd-4ac2-ba5f-4c9124733bf1/UAPSignedBinary_Microsoft.DirectX.x86.appx) или [Microsoft. DirectX. x64](https://download.microsoft.com/download/c/c/2/cc291a37-2ebd-4ac2-ba5f-4c9124733bf1/UAPSignedBinary_Microsoft.DirectX.x64.appx) , чтобы развернуть эти устаревшие компоненты пакета SDK DirectX на стороне. Кроме того, можно удалить все такие зависимости &mdash; (см. раздел " [Guide для разработчиков" для распространяемой версии ксаудио 2,9](../xaudio2/xaudio2-redistributable.md), а также записи блога, [живущие без D3DX](https://walbourn.github.io/living-without-d3dx/) и [ксинпут и Windows 8](https://walbourn.github.io/xinput-and-windows-8/)).