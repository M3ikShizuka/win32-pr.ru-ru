---
description: Иногда требуется заменить библиотеку DLL новой версией.
ms.assetid: 82349a33-dc2c-4309-b0fc-890f230e3f2c
title: Обновления библиотеки Dynamic-Link
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f294e16efac60da843c14d200aaa768d4fc78ce8a922cb0aa6958756a9903be0
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "120075544"
---
# <a name="dynamic-link-library-updates"></a>Обновления библиотеки Dynamic-Link

Иногда требуется заменить библиотеку DLL новой версией. Прежде чем заменить библиотеку DLL, выполните проверку версии, чтобы убедиться, что вы заменяете более старую версию новой версией. Можно заменить используемую библиотеку DLL. Метод, используемый для замены используемых библиотек DLL, зависит от используемой операционной системы. в Windows XP и более поздних версиях приложения должны использовать [изолированные приложения и параллельные сборки](/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal).

Перезагружать компьютер не требуется, если выполнить следующие действия.

1.  Используйте функцию [**мовефиликс**](/windows/desktop/api/winbase/nf-winbase-movefileexa) , чтобы переименовать ЗАМЕНЯЕМУЮ библиотеку DLL. Не указывайте \_ \_ разрешенную копию MOVEFILE и убедитесь, что переименованный файл находится на том же томе, который содержит исходный файл. Можно также просто переименовать файл в том же каталоге, предоставив ему другое расширение.
2.  Скопируйте новую библиотеку DLL в каталог, содержащий переименованную библиотеку DLL. Все приложения теперь будут использовать новую библиотеку DLL.
3.  Используйте [**мовефиликс**](/windows/desktop/api/winbase/nf-winbase-movefileexa) с MOVEFILE \_ delay \_ до \_ перезагрузки, чтобы удалить переименованную библиотеку DLL.

Перед выполнением замены приложения будут использовать исходную библиотеку DLL, пока она не будет выгружена. После внесения замены приложения будут использовать новую библиотеку DLL. При написании библиотеки DLL необходимо внимательно следить за тем, чтобы она была подготовлена в этой ситуации, особенно если библиотека DLL хранит глобальные сведения о состоянии или взаимодействует с другими службами. Если библиотека DLL не подготовлена к изменению глобальных сведений о состоянии или протоколах связи, то для обновления библиотеки DLL потребуется перезагрузить компьютер, чтобы все приложения использовали ту же версию библиотеки DLL.

 

 
