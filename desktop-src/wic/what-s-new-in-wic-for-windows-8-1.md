---
description: Windows Компонент обработки изображений (WIC) был обновлен с учетом новых выпусков Windows. В этом разделе приведены краткие сведения о новых функциях.
ms.assetid: 710B71CE-6FCC-46DA-A65C-6E4FC6A04275
title: Новые возможности WIC
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 420d501dd495081764a7fba89f73d21077c04b05d92e7c2b47c3c2c2d51d7d10
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118204019"
---
# <a name="whats-new-in-wic"></a>Новые возможности WIC

Windows Компонент обработки изображений (WIC) был обновлен с учетом новых выпусков Windows. В этом разделе приведены краткие сведения о новых функциях.

## <a name="whats-new-for-windows-10-version-1507"></a>новые возможности для Windows 10, версия 1507

### <a name="access-to-low-level-jpeg-data-for-wic-decoding-and-encoding"></a>Доступ к данным низкого уровня JPEG для декодирования и кодирования WIC

начиная Windows 10 с версии 1507, компонент WIC предоставляет доступ к структурам данных с низким уровнем JPEG, включая таблицы хаффмана и дискретизация. Дополнительные сведения см. в следующих разделах:

-   Интерфейс [**ивикжпегфрамедекоде**](/windows/win32/api/Wincodec/nn-wincodec-iwicjpegframedecode)
-   Интерфейс [**ивикжпегфраминкоде**](/windows/win32/api/Wincodec/nn-wincodec-iwicjpegframeencode)

### <a name="jpeg-indexing"></a>Индексация JPEG

Индексирование JPEG — это методика, которая значительно повышает производительность случайного доступа к небольшим областям большого изображения JPEG за счет дополнительного использования памяти. Индексирование JPEG можно использовать любым вызывающим объектом WIC.

Интерфейс [**ID2D1ImageSourceFromWic**](/windows/win32/api/d2d1_3/nn-d2d1_3-id2d1imagesourcefromwic) предназначен для использования ИНДЕКСИРОВАНия JPEG, если он включен. Например, API ID2D1ImageSource будет запрашивать только необходимые разделы изображения в таком сценарии, как Pan и Zoom для изображения большого разрешения. Дополнительные сведения см. в следующих разделах:

-   Метод [**ивикжпегфрамедекоде:: сетиндексинг**](/windows/win32/api/Wincodec/nf-wincodec-iwicjpegframedecode-setindexing)
-   Интерфейс [**ID2D1ImageSourceFromWic**](/windows/win32/api/d2d1_3/nn-d2d1_3-id2d1imagesourcefromwic)

## <a name="whats-new-for-windows-81"></a>Новые возможности для Windows 8.1

### <a name="support-for-jpeg-ycbcr-images"></a>Поддержка изображений JPEG Икбкр

начиная с Windows 8.1, компонент WIC обеспечивает поддержку декодирования, преобразования и кодирования данных изображения в формате JPEG и'кбкр в собственном формате. Это позволяет приложениям значительно сократить время обработки и потребление памяти для определенных операций с образами при работе с JPEG с кодировкой И'кбкр. Дополнительные сведения см. в следующих разделах:

-   [Direct2D](-wic-sample-d2d-viewer.md)[икбкр](../direct2d/ycbcr-effect.md)
-   Интерфейс [**ивикпланарбитмапсаурцетрансформ**](/windows/win32/api/Wincodec/nn-wincodec-iwicplanarbitmapsourcetransform)
-   Интерфейс [**ивикпланарбитмапфраминкоде**](/windows/win32/api/Wincodec/nn-wincodec-iwicplanarbitmapframeencode)

### <a name="support-for-block-compressed-formats-dds-files"></a>Поддержка блочных сжатых форматов (файлы DDS)

начиная с Windows 8.1, WIC добавляет новый кодек, поддерживающий образы DDS, закодированные в следующих форматах: в \_ формате dxgi \_ BC1 \_ UNORM, в \_ формате dxgi \_ BC2 \_ UNORM и в \_ формате dxgi \_ BC3 \_ UNORM. Доступ к сжатым данным блока DDS может осуществляться в декодированной форме с помощью стандартных интерфейсов WIC или напрямую обращаться к ним с помощью новых интерфейсов DDS. Дополнительные сведения см. в следующих разделах:

-   Интерфейс [**ивикддсдекодер**](/windows/win32/api/Wincodec/nn-wincodec-iwicddsdecoder)
-   Интерфейс [**ивикддсенкодер**](/windows/win32/api/Wincodec/nn-wincodec-iwicddsencoder)

## <a name="whats-new-for-windows-8"></a>Новые возможности для Windows 8

в Windows 8 компонент WIC был обновлен с помощью нескольких новых функций. обновленная версия WIC также доступна на Windows 7 и Windows Server 2008 R2 через [обновление платформы для Windows 7](../direct3darticles/platform-update-for-windows-7.md), которое доступно в [обновлении платформы для Windows 7](https://support.microsoft.com/kb/2670838).

### <a name="improved-direct2d-integration"></a>Улучшенная интеграция Direct2D

wic в Windows 8 предоставляет эти api для улучшения интеграции Direct2D с WIC:

-   [**ИвиЦимажеенкодер**](/windows/win32/api/Wincodec/nn-wincodec-iwicimageencoder) — новый интерфейс, который может кодировать содержимое Direct2D [**ID2D1Image**](/windows/win32/api/d2d1/nn-d2d1-id2d1image) в [ивикбитмапфраминкоде](-wic-imp-iwicbitmapframeencode.md). Методы этого интерфейса принимают указатель на [**виЦимажепараметерс**](/windows/win32/api/Wincodec/ns-wincodec-wicimageparameters), который является параметрами для управления кодировкой.
-   [**IWICImagingFactory2**](/windows/win32/api/Wincodec/nn-wincodec-iwicimagingfactory2) — новая фабрика WIC с помощью метода [**креатеимажеенкодер**](/windows/win32/api/Wincodec/nf-wincodec-iwicimagingfactory2-createimageencoder) . Этот интерфейс наследуется от исходной фабрики WIC, [**IWICImagingFactory**](/windows/win32/api/Wincodec/nn-wincodec-iwicimagingfactory)и создается таким же образом.

### <a name="changes-to-bmp-codec-alpha-support"></a>Изменения в поддержке кодека BMP Alpha

компонент WIC в Windows 8 поддерживает загрузку файлов изображений [**BITMAPV5HEADER**](/windows/win32/api/wingdi/ns-wingdi-bitmapv5header) в виде изображений в формате [WICPixelFormat32bppBGRA](-wic-codec-native-pixel-formats.md). Кроме того, кодировщик BMP поддерживает новый логический параметр кодировщика «EnableV5Header32bppBGRA», который указывает кодировщику записать **BITMAPV5HEADER** с данными изображения 32bppBGRA.

Дополнительные сведения о форматах BMP см. в разделе [Общие сведения о формате BMP](bmp-format-overview.md).

### <a name="new-pixel-formats"></a>Новые форматы пикселей

WIC в Windows 8 определяет следующие новые форматы пикселей:

-   GUID \_ WICPixelFormat32bppRGB
-   GUID \_ WICPixelFormat64bppRGB
-   GUID \_ WICPixelFormat96bppRGBFloat
-   GUID \_ WICPixelFormat64bppPRGBAHalf

> [!Note]  
> Встроенный кодек TIFF возвратит \_ данные WICPIXELFORMAT96BPPRGBFLOAT GUID. Другие три формата не используются встроенными кодеками.

 

### <a name="restrictions-to-component-extensibility-in-appcontainer"></a>Ограничения для расширяемости компонентов в AppContainer

при выполнении в процессе AppContainer, который включает все приложения Windows Store, WIC будет использовать только предоставляемые Windows компоненты независимо от того, установлены ли в системе дополнительные компоненты. Приложение, которое не выполняется в AppContainer, не затрагивается.

Приложениям не нужно вносить изменения в код для выполнения в Аппконтаинжер, но параметры флага [**виккомпонентенумератеоптионс**](/windows/win32/api/Wincodec/ne-wincodec-wiccomponentenumerateoptions) и идентификатора GUID поставщика не будут действовать. компоненту WIC не удастся загрузить изображение, если его нельзя декодировать в коде, предоставленном Windows, и вызов метода [**креатекомпонентенумератор**](/windows/win32/api/Wincodec/nf-wincodec-iwicimagingfactory-createcomponentenumerator) будет возвращать только Windows предоставленные компоненты.

### <a name="changes-to-clsid_wicpngdecoder-and-png-decoder-color-context-support"></a>Изменения в \_ поддержке контекста цвета декодера викпнгдекодер и PNG

**Идентификатор CLSID \_ WICPngDecoder1** был добавлен с тем же GUID, что и **CLSID \_ викпнгдекодер**, и добавлен **CLSID \_ WICPngDecoder2** .

при компиляции с Windows 8 помощью пакета SDK **\_ викпнгдекодер clsid** \# определяется как **clsid \_ WICPngDecoder2** для продвижения новых скомпилированных приложений с использованием нового поведения декодера PNG. Приложения должны продолжать указывать **CLSID \_ викпнгдекодер**.

Указание **CLSID \_ WICPngDecoder2** создаст версию декодера PNG для WIC, который создаст [**Ивикколорконтекст**](/windows/win32/api/Wincodec/nn-wincodec-iwiccolorcontext) из фрагментов ЧРМ и Гама. это позволяет использовать эти метаданные цветового пространства с другими Windows api для цвета управления исходным изображением. **Ивикколорконтекст** не создается из фрагментов Гама и ЧРМ, если имеется блок иккп, если имеется фрагмент sRGB или если фрагменты Гама и ЧРМ указывают цветовое пространство sRGB.

Приложение может указать **CLSID \_ WICPngDecoder1** , чтобы создать версию декодера PNG для WIC, который не создает [**Ивикколорконтекст**](/windows/win32/api/Wincodec/nn-wincodec-iwiccolorcontext) из фрагментов Гама и ЧРМ. Это соответствует поведению декодера PNG в предыдущих версиях Windows.

### <a name="changes-to-wincodec_sdk_version"></a>Изменения в \_ версии пакета SDK для винкодек \_

при компиляции с помощью пакета sdk для **Windows 8 \_ \_ версия пакета sdk для винкодек** \# определяется как **винкодек \_ sdk \_ версия2** для продвижения новых скомпилированных приложений с помощью нового поведения декодера PNG. В противном случае он \# определяется как **винкодек \_ SDK \_ версии 1**. Приложения должны продолжать указывать **\_ \_ версию пакета SDK для винкодек**.

Указание **\_ \_ версии пакета SDK винкодек** при вызове [**\_ прокси-сервера виккреатеимагингфактори**](-wic-codec-wiccreateimagingfactory-proxy.md) для создания фабрики изображений вызывает создание **CLSID \_ WICPngDecoder2** вместо **CLSID \_ WICPngDecoder1** из метода [**креатедекодер**](/windows/win32/api/Wincodec/nf-wincodec-iwicimagingfactory-createdecoder) и его вариантов. Кроме того, перечислитель компонента декодера будет возвращать сведения о компоненте **\_ WICPngDecoder2 CLSID** , но не сведения о **\_ WICPngDecoder1 CLSID** .

Указание **винкодек \_ SDK \_ версии 1** приведет к тому, что вместо **CLSID \_ WICPngDecoder2** в указанных выше случаях будет использоваться **CLSID \_ WICPngDecoder1** .

### <a name="changes-to-clsid_wicimagingfactory"></a>Изменения в CLSID \_ виЦимагингфактори

**Идентификатор CLSID \_ WICImagingFactory1** был добавлен с тем же GUID, что и **CLSID \_ виЦимагингфактори**, и добавлен **CLSID \_ WICImagingFactory2** .

при компиляции с Windows 8 помощью пакета SDK **\_ виЦимагингфактори clsid** \# определяется как **clsid \_ WICImagingFactory2** для продвижения новых скомпилированных приложений с использованием нового поведения декодера PNG. Приложения должны продолжать указывать **CLSID \_ виЦимагингфактори**.

Указание **CLSID \_ WICImagingFactory2** при вызове [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) для создания фабрики изображений приводит к **созданию \_ WICPngDecoder2 CLSID** вместо **CLSID \_ WICPngDecoder1** из метода [**креатедекодер**](/windows/win32/api/Wincodec/nf-wincodec-iwicimagingfactory-createdecoder) и его вариантов. Кроме того, перечислитель компонента декодера будет возвращать сведения о компоненте **\_ WICPngDecoder2 CLSID** , но не сведения о **\_ WICPngDecoder1 CLSID** .

Указание **CLSID \_ WICImagingFactory1** приведет к тому, что в приведенных выше случаях будет использоваться **CLSID \_ WICPngDecoder1** , а не **\_ WICPngDecoder2 CLSID** .

## <a name="whats-new-for-windows-7"></a>новые возможности Windows 7

в Windows 7 компонент WIC обновлен с помощью нескольких новых функций. В этом разделе приведены краткие сведения о новых функциях.

### <a name="updates-to-the-tiff-codec"></a>Обновления для кодека TIFF

кодек WIC TIFF был обновлен для Windows 7 для поддержки нескольких функций, которые не поддерживаются в предыдущей версии WIC.

-   Поддержка больших TIFF-файлов.
-   Декодирование мозаичных изображений TIFF.
-   Декодирование плоских (плоских) изображений TIFF.
-   Декодирование изображений TIFF в кодировке JPEG.

### <a name="progressive-decoding"></a>Прогрессивное декодирование

Прогрессивное декодирование обеспечивает возможность постепенного декодирования и отрисовки фрагментов изображения до завершения загрузки всего изображения. Эта функция значительно улучшает взаимодействие с пользователем при просмотре изображений из Интернета, поскольку пользователю не нужно ждать загрузки всего образа перед началом декодирования. При прогрессивном декодировании пользователи могут видеть предварительный просмотр образа с доступными данными до загрузки всего образа. Эта функция необходима для любого приложения, используемого для просмотра изображений из Интернета или из источников данных с ограниченной пропускной способностью.

Дополнительные сведения см. в разделе [Обзор прогрессивного декодирования](-wic-progressive-decoding.md).

### <a name="extended-metadata-support-for-jpeg-png-and-gif"></a>Поддержка расширенных метаданных для JPEG, PNG и GIF

в Windows 7 компонент WIC расширил поддержку метаданных для изображений JPEG, PNG и GIF.

-   Добавлена поддержка анимированных свойств GIF и GIF.
-   Расширенные обработчики метаданных JPG для поддержки метаданных чроминанце, светимости и комментариев.
-   Расширенные обработчики метаданных PNG для поддержки метаданных tIME, sRGB, Иккп, Хист, ЧРМ, Иткст, Бкгд и Гама.
-   Добавлены новые обработчики метаданных 8BIM для метаданных Ресолутионинфо и метаданных хэша IPTC.
-   Добавлены новые обработчики метаданных для логического дескриптора экрана (LSD), дескриптора изображения (ИМД), расширений графического элемента управления (GCE) и метаданных расширений приложения (ФИГУРУ).
-   Поддержка метаданных, охватывающих блоки Аппн.

### <a name="multi-threaded-apartment-support"></a>Поддержка многопоточного апартамента

Объекты в многопоточном апартаменте (MTA) могут вызываться параллельно любым числом потоков в MTA, что позволяет повысить производительность многоядерных систем и определенных серверных сценариев. Кроме того, кодеки WIC, действующие в MTA, могут вызывать другие объекты, которые находятся в потоке MTA без затрат на упаковку, связанные с вызовом между потоками, которые находятся в разных апартаментах STA. в Windows 7 все встроенные кодеки WIC обновлены для поддержки MTA, включая JPEG, TIFF, PNG, GIF, ICO и BMP. Настоятельно рекомендуется написать кодеки для поддержки MTA. Кодеки, не поддерживающие MTA, приводят к значительному снижение производительности в многопоточных приложениях из-за упаковки. Для включения поддержки агента передачи сообщений необходимо, чтобы в коде был реализована правильная синхронизация. Точная реализация этих методов синхронизации выходит за рамки данного документа. Ниже приведен общий справочник по синхронизации объектов модели COM.

### <a name="metadata-working-group-implementations"></a>Реализации рабочих групп метаданных

В настоящее время существует множество форматов хранения метаданных, содержащих перекрывающиеся свойства, без каких-либо четкого отраслевых стандартов или рекомендаций по единообразным методам чтения и записи этих форматов метаданных. Чтобы помочь в использовании различных форматов и свойств, была сформирована Рабочая группа метаданных (МВГ). Цель МВГ — предоставить рекомендации, обеспечивающие взаимодействие между различными платформами, приложениями и устройствами. Рекомендации, установленные МВГ, применяются к полям метаданных XMP, EXIF и IPTC, а также к форматам изображений JPEG, TIFF и PSD.

в Windows 7 обработчик метаданных фотографий и уровень политики метаданных были обновлены для чтения и записи метаданных образа в соответствии с правилами, установленными мвг. Дополнительные сведения о рабочей группе Metadata (МВГ) см. в [руководстве по установленным метаданным](https://s3.amazonaws.com/software.tagthatphoto.com/docs/mwg_guidance.pdf).

### <a name="windows-7-features-supported-on-windows-vista-and-windows-server-2008"></a>функции Windows 7, поддерживаемые в Windows Vista и Windows Server 2008

[обновление платформы для Windows Vista](../win7ip/platform-update-for-windows-vista-portal.md) — это набор библиотек времени выполнения, позволяющий разработчикам ориентироваться на приложения как в Windows 7, так и в Windows Vista. обновление платформы для Windows Server 2008 — это набор библиотек времени выполнения, позволяющий разработчикам ориентироваться на приложения как Windows Server 2008 R2, так и Windows server 2008. обновление платформы для Windows vista и обновление платформы для Windows server 2008 будут доступны всем клиентам Windows Vista и Windows server 2008 с помощью Центр обновления Windows. сторонние приложения, требующие обновления платформы для Windows Vista или обновления платформы для Windows Server 2008, Центр обновления Windows могут определить, установлено ли необходимое обновление. если это не так, Центр обновления Windows будет скачивать и устанавливать его в фоновом режиме. дополнительные сведения об обновлениях см. в статье обновление платформы для Windows Vista.

 

 
