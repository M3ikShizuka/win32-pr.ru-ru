---
description: Этот пример приложения демонстрирует открытие и закрытие потоков связи и вызов событий дуккинг, которые приложение может получить для реализации затухания потока.
ms.assetid: 9a2131b2-ec4a-492a-a277-bd26ec8d67e5
title: дуккингкаптуресампле
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 76515f9d20e31bf4583b715e09da38c29bfdac34f6c975087f64bf2617696542
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119018462"
---
# <a name="duckingcapturesample"></a>дуккингкаптуресампле

Этот пример приложения демонстрирует открытие и закрытие потоков связи и вызов событий дуккинг, которые приложение может получить для реализации затухания потока. Это приложение реализует чат-клиент, который использует основные API-интерфейсы для чтения звуковых данных с коммуникационного устройства и воспроизведения на выходном устройстве.

В этом разделе содержатся следующие подразделы.

-   [Описание](#description)
-   [Требования](#requirements)
-   [Загрузка образца](#downloading-the-sample)
-   [Создание примера](#building-the-sample)
-   [Запуск примера](#running-the-sample)
-   [Связанные темы](#related-topics)

## <a name="description"></a>Описание

В этом образце демонстрируются следующие возможности.

-   [API ммдевице](mmdevice-api.md) для перечисления мультимедийных устройств и выбора.
-   [Васапи](wasapi.md) для доступа к устройству записи и отрисовки данных, операциям управления потоком и обработке событий дуккинг.
-   [API-интерфейсы Wave](/previous-versions//ms713499(v=vs.85)) для доступа к коммуникационному устройству и записи звукового ввода.

## <a name="requirements"></a>Requirements (Требования)



| Продукт                                                        | Version   |
|----------------------------------------------------------------|-----------|
| [Windows SDK](https://msdn.microsoft.com/windowsvista/bb980924.aspx) | Windows 7 |
| Visual Studio 2008                                             |           |



 

## <a name="downloading-the-sample"></a>Загрузка образца

Этот образец доступен в следующих расположениях.



| Расположение    | Путь или URL-адрес                                                                                              |
|-------------|-------------------------------------------------------------------------------------------------------|
| Пакет Windows SDK | \\Program files \\ Microsoft sdks \\ Windows \\ v 7.0 \\ samples \\ мультимедиа \\ Audio \\ дуккингкаптуресампле \\ ... |



 

## <a name="building-the-sample"></a>Построение образца

Чтобы создать пример Дуккингкаптуресампле, выполните следующие действия.

1.  откройте файл дуккингкаптуресампле. sln в Visual Studio 2008.
2.  В окне выберите конфигурацию решения для **отладки** или **выпуска** , выберите меню **Сборка** в строке меню и выберите параметр **Сборка** . если не открыть Visual Studio из интерпретатора команд для пакета sdk, Visual Studio не будет иметь доступа к среде сборки пакета sdk. В этом случае выборка не будет построена, если вы явно не настроили переменную среды Мссдк, которая используется в файле проекта Дуккингкаптуресампле. vcproj.

## <a name="running-the-sample"></a>Запуск примера

Если приложение успешно построено, создается исполняемый файл DuckingCaptureSample.exe. Чтобы запустить его, выберите команду **начать отладку** или **запустить без отладки** из меню **Отладка** или введите `DuckingCaptureSample` в командном окне.

Дуккингкаптуресампле предоставляет пользователю две реализации для записи звука из консольного устройства по умолчанию: ВАСАПИ и Wave API. Чтобы запустить сеанс записи, выберите режим и нажмите кнопку **запустить** в пользовательском интерфейсе приложения. Чтобы завершить сеанс, нажмите кнопку " **прекратить**". В зависимости от устройства, указанного пользователем (входные или выходные данные), приложение использует API Ммдевице для получения ссылки на устройство для передачи данных по умолчанию или для записи. После того как пользователь запустит сеанс разговора, приложение выполняет следующие задачи:

-   Создает и инициализирует аудио клиент в режиме, управляемом событиями.
-   Связывает клиент с обработчиком событий, который сигнализирует, что образцы готовы для записи или подготовки к просмотру.
-   Настраивает Клиент отслеживания и клиент отрисовки для транспорта.
-   Создает поток разговора и запускает обработчик аудио.

Для записи звуковых данных с каждым проходом обработки в примере используется клиент отслеживания для получения общего объема захваченных данных, доступных в буфере, считывания данных из устройства ввода по умолчанию и освобождения пакета и предоставления буфера для чтения следующего набора захваченных данных.

Для подготовки к просмотру приложение определяет объем данных, которые помещаются в очередь для воспроизведения в буфере конечной точки записи. Он соответствующим образом записывает данные в буфер и освобождает буфер в процессе подготовки к следующей обработке до тех пор, пока не будут записаны все сведения. Для подготовки к просмотру невыполненные кадры преобразуются в предустановки, чтобы предотвратить сбой обработчика звука при запуске. Дуккингкаптуресампле также показывает, как скрыть поток отрисовки из микшера тома.

Дополнительные сведения о функции затухания потока см. в разделе [Использование коммуникационного устройства](using-the-communication-device.md).

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Примеры пакетов SDK, использующих основные API аудио](sdk-samples-that-use-the-core-audio-apis.md)
</dt> </dl>

 

 
