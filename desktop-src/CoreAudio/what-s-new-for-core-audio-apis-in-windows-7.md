---
description: Основные API-интерфейсы аудиоподсистемы появились в Windows Vista, предоставили новый набор звуковых компонентов пользовательского режима, которые клиентское приложение может использовать для отображения или записи звуковых потоков с улучшенными возможностями аудио.
ms.assetid: eb99c266-16d2-4a14-bc1d-059a0a94db13
title: Новые возможности для основных API-интерфейсов аудиоподсистемы в Windows 7
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b3c87a4daa9e645587253239082475e59fd1563c
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105655870"
---
# <a name="whats-new-for-core-audio-apis-in-windows-7"></a>Новые возможности для основных API-интерфейсов аудиоподсистемы в Windows 7

Основные API-интерфейсы аудиоподсистемы появились в Windows Vista, предоставили новый набор звуковых компонентов пользовательского режима, которые клиентское приложение может использовать для отображения или записи звуковых потоков с улучшенными возможностями аудио. Общие сведения об этом наборе API см. в статье [о Windows Core Audio API](about-the-windows-core-audio-apis.md).

В Windows 7 были улучшены основные API аудио. В следующей таблице перечислены новые функции и усовершенствования основных API-интерфейсов аудио.



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Функция</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Универсальные усовершенствования</td>
<td>В Windows 7 были улучшены следующие возможности:
<ul>
<li>В потоках в режиме "общий доступ" Windows 7 выполняется в <em>режиме с низкой задержкой</em>. Обработчик аудио работает в режиме опроса с значительным снижением задержки. Это очень полезно для коммуникационных приложений, требующих низкой задержки аудиопотока для ускорения потоковой передачи.</li>
<li>Windows 7 обеспечивает лучшее обнаружение роли устройства при добавлении нового устройства в систему. Дополнительные сведения см. в разделе <a href="device-roles-in-windows-vista.md">Работа с ролями устройств</a>.</li>
<li>В Windows 7 вы можете слушать музыку из портативного проигрывателя мультимедиа через динамики компьютера. Эту функцию монитора записи можно использовать, подключив портативный проигрыватель мультимедиа к компьютеру с помощью аналогового звукового кабеля. В прошлом некоторые поставщики вычислительной техники предоставили эту функцию в аудио драйвер с помощью аппаратного замыкания на себя. В Windows 7 Эта функция добавлена в операционную систему. Так как он находится в системе, а не в драйвере, его можно использовать для любого другого устройства, подключенного к системе, например гарнитуры USB.</li>
<li>В Windows 7 улучшена аудиосистема HDMI, которая обеспечивает поддержку формата с высокой скоростью. С помощью этого улучшения вы можете поддерживать многоканальные аудио и сжатые звуковые форматы с помощью соединителя HDMI для звукового приемника.</li>
<li>В Windows Vista проигрыватель Windows Media воспроизводит музыку только через звуковое устройство по умолчанию, которое не может быть изменено пользователем. Чтобы проигрыватель Windows Media отображал звук на конкретном устройстве, необходимо изменить устройство по умолчанию на панели управления " <strong>звуки</strong> ". В Windows 7 проигрыватель Windows Media предоставляет интерфейсы API, позволяющие приложению визуализироваться на любое устройство, выбранное пользователем, а не только на устройство по умолчанию.</li>
<li>В Windows Vista, если компьютер, воспроизводящий звук, переключается в режим энергосбережения, компьютер блокируется, и если пользователь хочет прервать воспроизведение, пользователь должен войти в систему и нажать клавишу остановить, чтобы остановить воспроизведение. В Windows 7, если компьютер заблокирован, вы по-прежнему можете управлять воспроизведением с помощью элемента управления HID на клавиатуре.</li>
<li>Windows 7 сокращает энергопотребление любого приложения, использующего DirectSound и DirectShow для визуализации мультимедиа. Кроме того, служба планировщика классов мультимедиа позволяет использовать устойчивость к сбоях и уменьшает энергопотребление при создании звуковых образцов.</li>
</ul></td>
</tr>
<tr class="even">
<td>Коммуникационное устройство (новое)</td>
<td>В этом выпуске новый тип устройства добавлен в панель управления " <strong>звуки</strong> ": устройство <strong>связи</strong> . Это устройство используется в основном для обмена данными, то есть для размещения или приема телефонных звонков на компьютере. Приложение для обмена данными может использовать основные компоненты аудиоподсистемы для получения ссылки на конечную точку устройства связи по умолчанию и прорисовки звуковых потоков для обмена данными. Операционная система считает, что поток, Открытый на коммуникационном устройстве, является потоком связи. Операции ВАСАПИ в потоке связи похожи на любой другой аудиопоток. Дополнительные сведения см. в разделе <a href="device-roles-in-windows-vista.md">Работа с ролями устройств</a>.</td>
</tr>
<tr class="odd">
<td>Затухание потока или аудио дуккинг (новое)</td>
<td>Автоматическое дуккинг или <a href="stream-attenuation.md">затухание потока</a> — это новая функция Windows 7, предназначенная для VoIP и Объединенных коммуникационных приложений. По умолчанию операционная система сокращает интенсивность аудиопотока, когда поток обмена данными, например телефонный звонок, получается на коммуникационном устройстве через компьютер. Параметры тома задаются пользователем на панели управления <strong>звуком</strong> . В Windows SDK были добавлены новые API, позволяющие приложениям заменять поведение дуккинг по умолчанию. Дополнительные сведения о реализации пользовательской функции дуккинг см. в разделе <a href="providing-a-custom-ducking-experience.md">предоставление пользовательского поведения дуккинг</a>. <br/></td>
</tr>
<tr class="even">
<td>Потоковая маршрутизация (Новая)</td>
<td>В Windows 7 Основные API аудио были улучшены для беспрепятственного перенаправления звукового потока с существующего устройства на новую конечную точку звука по умолчанию. Высокоуровневые наборы API аудио, использующие основные API-интерфейсы, такие как Media Foundation, DirectSound и WAVE API, реализуют функцию маршрутизации потоков. Приложения мультимедиа, использующие эти наборы API для воспроизведения или записи потока, используют реализацию по умолчанию и не требуется изменять приложение. Однако если приложение мультимедиа использует API-интерфейсы Core Audio напрямую, приложение должно предоставить реализацию маршрутизации потоков. Для этого приложение должно выполнить обработку новых событий, которые были добавлены для уведомления клиента ВАСАПИ о том, что устройство по умолчанию подключено или удалено. Дополнительные сведения об этой функции см. в статье <a href="stream-routing.md">потоковая маршрутизация</a>.</td>
</tr>
<tr class="odd">
<td>Звук защищенного режима пользователя (PUMA) (улучшено)</td>
<td>PUMA был обновлен для Windows 7, чтобы предоставить следующие возможности:
<ul>
<li>Установка битов системы управления последовательного копирования (СКМС) в конечных точках S/PDIF и высокоскоростных цифровых Защита содержимого (HDCP) на конечных точках High-Definitionного интерфейса (HDMI).</li>
<li>Включение элементов управления защиты СКМС и HDMI за пределами защищенной среды (PE).</li>
</ul>
Дополнительные сведения об улучшениях см. в разделе <a href="protected-user-mode-audio--puma-.md">Защита звука в режиме защищенного пользователя (Puma)</a>.<br/></td>
</tr>
<tr class="even">
<td>Структура <strong>вавеформатекстенсибле</strong> была расширена до структуры <strong>WAVEFORMATEXTENSIBLE_IEC61937</strong> (Новая)</td>
<td>В Windows 7 добавлена новая структура для поддержки передачи данных IEC 61937. <strong>WAVEFORMATEXTENSIBLE_IEC61937</strong> расширяет структуру <strong>вавеформатекстенсибле</strong> для хранения двух наборов характеристик звукового потока: закодированный аудио формат перед передачей и характеристиками звукового потока после декодирования. Новая структура явно указывает фактическое количество каналов, размер выборки и скорость передачи данных в формате, не являющемся форматом PCM. С помощью этих сведений приложение может определить уровень качества потока, не являющегося потоком PCM, после его распаковки и воспроизведения. Дополнительные сведения см. в разделе <a href="representing-formats-for-iec-61937-transmissions.md">представление форматов для передач IEC 61937</a>.<br/></td>
</tr>
<tr class="odd">
<td><a href="/windows/desktop/api/Audioclient/nf-audioclient-iaudioclient-initialize"><strong>Иаудиоклиент:: Initialize</strong></a> (улучшено)</td>
<td>Метод <a href="/windows/desktop/api/Audioclient/nf-audioclient-iaudioclient-initialize"><strong>иаудиоклиент:: Initialize</strong></a> был улучшен для указания конкретных ошибок, которые могут возникнуть при открытии аудиопотока. Новые коды ошибок:
<ul>
<li>AUDCLNT_E_BUFFER_SIZE_NOT_ALIGNED</li>
<li>AUDCLNT_E_BUFFER_SIZE_ERROR</li>
<li>AUDCLNT_E_INVALID_DEVICE_PERIOD</li>
</ul>
Дополнительные сведения об этих ошибках см. в разделе "возвращаемое значение" в <a href="/windows/desktop/api/Audioclient/nf-audioclient-iaudioclient-initialize"><strong>иаудиоклиент:: Initialize</strong></a>.<br/></td>
</tr>
<tr class="even">
<td><a href="/windows/desktop/api/Audioclient/nf-audioclient-iaudiocaptureclient-getbuffer"><strong>Иаудиокаптуреклиент::-buffer</strong></a> и <a href="/windows/desktop/api/Audioclient/nf-audioclient-iaudiorenderclient-getbuffer"><strong>иаудиорендерклиент::-buffer</strong></a> (улучшено)</td>
<td>Методы <a href="/windows/desktop/api/Audioclient/nf-audioclient-iaudiocaptureclient-getbuffer"><strong>иаудиокаптуреклиент::</strong></a> Иаудиорендерклиент и <a href="/windows/desktop/api/Audioclient/nf-audioclient-iaudiorenderclient-getbuffer"><strong>::</strong></a> noreturn были улучшены, чтобы возвращался AUDCLNT_E_BUFFER_ERROR код ошибки, указывающий, что буфер конечной точки в монопольном режиме не был получен. Дополнительные сведения см. в разделе remarks in <a href="/windows/desktop/api/Audioclient/nf-audioclient-iaudiocaptureclient-getbuffer"><strong>иаудиокаптуреклиент::</strong></a> Иаудиорендерклиент и <a href="/windows/desktop/api/Audioclient/nf-audioclient-iaudiorenderclient-getbuffer"><strong>:: buffer</strong></a>.</td>
</tr>
<tr class="odd">
<td>Возможность обнаружения разъемов (улучшенная)</td>
<td>Новый интерфейс в Windows 7, <a href="/windows/desktop/api/Devicetopology/nn-devicetopology-iksjackdescription2"><strong>IKsJackDescription2</strong></a>, расширяет <a href="/windows/desktop/api/Devicetopology/nn-devicetopology-iksjackdescription"><strong>иксжаккдескриптион</strong></a>. С помощью нового интерфейса звуковой стек или приложение могут получить дополнительные сведения о гнезде. Сюда входит возможность обнаружения розетки и возможность динамического изменения формата устройства.</td>
</tr>
<tr class="even">
<td>Образцы Windows (новые)</td>
<td>В Windows SDK были добавлены новые примеры, демонстрирующие использование основных API аудио. Дополнительные сведения см. <a href="sdk-samples-that-use-the-core-audio-apis.md">в статье примеры пакетов SDK, в которых используются основные API аудио</a>.</td>
</tr>
</tbody>
</table>



 

## <a name="major-new-interfaces"></a>Основные новые интерфейсы

Следующие интерфейсы являются новыми для Windows 7:

-   [**IAudioClock2**](/windows/desktop/api/audioclient/nn-audioclient-iaudioclock2)
-   [**иаудиоклоккаджустмент**](/windows/desktop/api/audioclient/nn-audioclient-iaudioclockadjustment)
-   [**иаудиоендпоинтволумикс**](/windows/desktop/api/Endpointvolume/nn-endpointvolume-iaudioendpointvolumeex)
-   [**IAudioSessionManager2**](/windows/desktop/api/audiopolicy/nn-audiopolicy-iaudiosessionmanager2)
-   [**IAudioSessionControl2**](/windows/desktop/api/audiopolicy/nn-audiopolicy-iaudiosessioncontrol2)
-   [**иаудиосессионенумератор**](/windows/desktop/api/audiopolicy/nn-audiopolicy-iaudiosessionenumerator)
-   [**иаудиосессионнотификатион**](/windows/desktop/api/audiopolicy/nn-audiopolicy-iaudiosessionnotification)
-   [**иаудиоволумедуккнотификатион**](/windows/desktop/api/AudioPolicy/nn-audiopolicy-iaudiovolumeducknotification)
-   [**IKsJackDescription2**](/windows/desktop/api/Devicetopology/nn-devicetopology-iksjackdescription2)
-   [**иксжакксинкинформатион**](/windows/desktop/api/Devicetopology/nn-devicetopology-iksjacksinkinformation)

## <a name="related-topics"></a>См. также

<dl> <dt>

[Об API аудио Windows Core](about-the-windows-core-audio-apis.md)
</dt> </dl>

 

 




