---
description: Формат виртуального жесткого диска (VHD) представляет собой общедоступную спецификацию формата изображения, которая позволяет инкапсулировать жесткий диск в отдельный файл для использования операционной системой в качестве виртуального диска во всех тех же целях, где используются физические жесткие диски.
MS-HAID: vhd.about\_vhd
MSHAttr:
- PreferredSiteName:MSDN
- PreferredLib:/library/windows/desktop
title: О виртуальных жестких дисках
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a79bd7695144811a1ec98f79e736760bbaddc8ef4b7460e55c5a66353a0b2ad9
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119865963"
---
# <a name="span-idvhdabout_vhdspanabout-vhd"></a><span id="vhd.about_vhd"></span>О виртуальных жестких дисках

Формат виртуального жесткого диска (VHD) представляет собой общедоступную [спецификацию](https://download.microsoft.com/download/f/f/e/ffef50a5-07dd-4cf8-aaa3-442c0673a029/Virtual%20Hard%20Disk%20Format%20Spec_10_18_06.doc) формата изображения, которая позволяет инкапсулировать жесткий диск в отдельный файл для использования операционной системой в качестве *виртуального диска* во всех тех же целях, где используются физические жесткие диски. Эти виртуальные диски могут размещать собственные файловые системы (NTFS, FAT, exFAT и UDF), поддерживающие стандартные операции с дисками и файлами. Поддержка API VHD позволяет управлять виртуальными дисками. Виртуальные диски, созданные с помощью API виртуального жесткого диска, могут работать как загрузочные диски.

пример использования файлов VHD — компонент [Hyper-V](https://www.microsoft.com/windowsserver2008/en/us/hyperv.aspx) в Windows 7, Windows Server 2008, virtual Server и Windows virtual PC. в этих продуктах используется API виртуального жесткого диска, который содержит Windows образ операционной системы, используемый виртуальной машиной в качестве системного загрузочного диска.

пакет средств разработки Microsoft Windows Software Development Kit (SDK) интегрирует встроенную поддержку VHD для работы с виртуальными дисками, облегчая разработчикам и администраторам создание, администрирование и развертывание образов Windows в VHD-файлах с помощью API платформы или средства управления. Для включения этих операций не требуется устанавливать отдельные приложения или использовать средство синтаксического анализа формата VHD. Эти API-интерфейсы позволяют использовать универсальные виртуальные диски независимо от других технологий виртуализации.

## <a name="span-idterminologyspanspan-idterminologyspanspan-idterminologyspanterminology"></a><span id="Terminology"></span><span id="terminology"></span><span id="TERMINOLOGY"></span>Терминология

Термин *резервное хранилище* используется для ссылки на физический файл, существующий на фактическом жестком диске. Резервное хранилище представлено *файлом образа VHD*.

Термины *динамические*, *расширяемые* и *разреженные* часто взаимозаменяемы при обращении к динамически расширяемым виртуальным дискам. Для технологии виртуального жесткого диска эти термины идентичны.

## <a name="span-idvhd_system_features_overviewspanspan-idvhd_system_features_overviewspanspan-idvhd_system_features_overviewspanvhd-system-features-overview"></a><span id="VHD_System_Features_Overview"></span><span id="vhd_system_features_overview"></span><span id="VHD_SYSTEM_FEATURES_OVERVIEW"></span>Общие сведения о компонентах системы VHD

На следующей диаграмме представлен обзор возможностей виртуального жесткого диска и их связей.

![Схема блокировки виртуальных жестких дисков](images/vhd.png)

Ниже приведено краткое описание описанных выше функций.

интерфейсы api собственного Windows пользовательского режима:

-   Библиотека VirtDisk.dll-Common для интерфейсов API управления VHD.

Специальные оболочки управления для домена в пользовательском режиме:

-   [api-интерфейсы виртуальных жестких дисков vds](/windows/desktop/VDS/about-vds) — оболочки объектной модели vds для Windows интерфейсов api виртуального жесткого диска.

Драйверы режима ядра:

-   VDrvRoot.sys — перечислитель виртуального диска root.
-   FsDepends.sys Управление зависимостями томов.
-   Vhdmp.sys-средство синтаксического анализа VHD и поставщик свойств зависимостей.

в документации по пакету SDK в этом разделе рассматриваются интерфейсы api VHD собственного Windows пользовательского режима.

## <a name="span-idvirtual_disk_typesspanspan-idvirtual_disk_typesspanspan-idvirtual_disk_typesspanvirtual-disk-types"></a><span id="Virtual_Disk_Types"></span><span id="virtual_disk_types"></span><span id="VIRTUAL_DISK_TYPES"></span>Типы виртуальных дисков

Существуют рекомендации по использованию виртуальных дисков и доступных типов виртуальных дисков.

-   **Исправлено**— файл образа VHD предварительно выделяется в резервном хранилище с максимальным требуемым размером.
-   **Расширяемый**— также известен как динамический, динамически расширяемый и разреженный, файл образа VHD использует столько места резервного хранилища, сколько требуется для хранения фактических данных, которые в данный момент содержатся в виртуальном диске. При создании этого типа виртуального диска API виртуального жесткого диска не проверяет наличие свободного места на физическом диске в соответствии с требуемым максимальным размером, поэтому можно успешно создать динамический виртуальный диск с максимальным размером, превышающим объем свободного места на физическом диске. Дополнительные сведения см. в разделе [**експандвиртуалдиск**](/windows/win32/api/virtdisk/nf-virtdisk-expandvirtualdisk).
    **Примечание**  .  Максимальный размер динамического виртуального диска составляет 2 040 ГБ.

     

-   **Разностное**— родительский виртуальный диск используется в качестве основания для этого типа, при этом все последующие записи, записанные на виртуальный диск, записываются в качестве отличий к новому файлу образа разностного VHD, а родительский файл образа VHD не изменяется. Например, если в качестве родительского используется виртуальный диск операционной системы с начальной загрузкой и назначьте разностный виртуальный диск в качестве текущего виртуального диска, операционная система на родительском виртуальном диске остается в исходном состоянии для быстрого восстановления или для быстрого создания дополнительных образов загрузки на основе дополнительных разностных виртуальных дисков. Дополнительные сведения см. в разделе [**мержевиртуалдиск**](/windows/win32/api/virtdisk/nf-virtdisk-mergevirtualdisk).
    **Примечание**  .  Максимальный размер разностного виртуального диска составляет 2 040 ГБ.

     

Все типы виртуальных дисков имеют минимальный размер 3 МБ.

## <a name="span-idrelated_topicsspanrelated-topics"></a><span id="related_topics"></span>Связанные темы

[О службе VDS](/windows/desktop/VDS/about-vds)

[Ссылка на виртуальный жесткий диск](vhd-reference.md)

[Спецификация формата образа виртуального жесткого диска](https://download.microsoft.com/download/f/f/e/ffef50a5-07dd-4cf8-aaa3-442c0673a029/Virtual%20Hard%20Disk%20Format%20Spec_10_18_06.doc)

 

 
