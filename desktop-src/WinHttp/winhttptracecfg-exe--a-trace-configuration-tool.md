---
description: Средство настройки трассировки служб Microsoft Windows HTTP (WinHTTP), WinHttpTraceCfg.exe, используется для настройки возможностей трассировки для отладки и целей сканирования пакетов.
ms.assetid: 744cae92-9c64-459e-96eb-eb609e62183c
title: WinHttpTraceCfg.exe, средство настройки трассировки
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c6c6423c581a51f0cf6b55856f2e8cd0ea670515
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105711064"
---
# <a name="winhttptracecfgexe-a-trace-configuration-tool"></a>WinHttpTraceCfg.exe, средство настройки трассировки

Средство настройки трассировки [служб Microsoft Windows HTTP (WinHTTP)](about-winhttp.md) , WinHttpTraceCfg.exe, используется для настройки возможностей трассировки для отладки и целей сканирования пакетов. Важна возможность отслеживать функции WinHTTP и их соответствующий сетевой трафик. Отладка приложений, использующих зашифрованные протоколы передачи данных, такие как SSL (SSL), исключает перехват пакетов на транспортном уровне сети и требует возможность перехвата трафика между клиентом и сервером после его расшифровки. Службы Microsoft Windows HTTP Services (WinHTTP) предоставляют средство трассировки, имеющее ряд возможностей для перехвата потока трафика между клиентом и сервером.

Это средство трассировки может быть ценным инструментом для отладки. Его можно использовать, например, для просмотра параметров, передаваемых в различные вызовы функций, а также для просмотра фактических данных, отправляемых и получаемых приложением WinHTTP.

-   [Использование средства трассировки](#using-the-trace-facility)
-   [Анализ данных трассировки](#interpreting-trace-data)

## <a name="using-the-trace-facility"></a>Использование средства трассировки

WinHTTP получает параметры управления трассировкой из реестра. Эти параметры управления влияют на то, как WinHTTP создает выходные данные трассировки и как форматирует выходные данные. Все приложения, использующие WinHTTP, имеют одни и те же параметры.

Средство настройки средства трассировки, WinHttpTraceCfg.exe, доступно для загрузки на веб-сайте [средств комплекта ресурсов Windows Server 2003](https://www.microsoft.com/downloads/details.aspx?familyid=9d467a69-57ff-4ae7-96ee-b18c4790cffd) . Средство настройки конфигурации задает или получает параметры реестра средства трассировки на основе указанных параметров командной строки.

``` syntax
WinHttpTraceCfg [-e <0|1>] [-l [log-file]] [-d <0|1>] [-s <0|1|2>] 
                [-t <0|1>] [-?] [-m <file size>]
```

В следующей таблице перечислены возможные параметры для средства настройки.



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Параметр</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>-?</td>
<td>Отображает данные синтаксиса.<br/></td>
</tr>
<tr class="even">
<td>-E</td>
<td>Указывает, включено или отключено средство трассировки. <br/> 
<table>
<tbody>
<tr class="odd">
<td>0</td>
<td>Значение по умолчанию. Отключает трассировку.</td>
</tr>
<tr class="even">
<td>1</td>
<td>Включение трассировки.</td>
</tr>
</tbody>
</table>

<p> </p></td>
</tr>
<tr class="odd">
<td>-l</td>
<td><p>Задает префикс для файла журнала. Префикс может включать путь. Файл журнала записывается в текущий каталог или каталог, указанный в префиксе, и имеет следующий формат.</p>
<p><<em></em> > префикс -< <em>имя приложения</em> > . <<em>время</em> > . журнал</p>
<p>Если префикс не указан, используется пустая строка. Укажите &quot; * &quot; , чтобы удалить существующий префикс.</p></td>
</tr>
<tr class="even">
<td>-d</td>
<td><p>Указывает, отображаются ли выходные данные трассировки в отладчике или записываются в файл.</p>

<table>
<tbody>
<tr class="odd">
<td>0</td>
<td>Значение по умолчанию. Выполняет запись в файл журнала.</td>
</tr>
<tr class="even">
<td>1</td>
<td>Отображается в отладчике.</td>
</tr>
</tbody>
</table>

<p> </p></td>
</tr>
<tr class="odd">
<td>-S</td>
<td><p>Указывает способ отображения сетевого трафика (запросов и ответов).</p>

<table>
<tbody>
<tr class="odd">
<td>0</td>
<td>Отображаются только заголовки HTTP.</td>
</tr>
<tr class="even">
<td>1</td>
<td>Значение по умолчанию. Показывает сетевой трафик в формате Американский национальный институт стандартов (ANSI) (ANSI).</td>
</tr>
<tr class="odd">
<td>2</td>
<td>Показывает сетевой трафик в шестнадцатеричном формате.</td>
</tr>
</tbody>
</table>

<p> </p></td>
</tr>
<tr class="even">
<td>-T</td>
<td><p>Указывает, записываются ли в трассировке вызовы функций верхнего уровня.</p>

<table>
<tbody>
<tr class="odd">
<td>0</td>
<td>Значение по умолчанию. Вызовы функций не записываются.</td>
</tr>
<tr class="even">
<td>1</td>
<td>Записываются вызовы функций верхнего уровня.</td>
</tr>
</tbody>
</table>

<p> </p></td>
</tr>
<tr class="odd">
<td>-M</td>
<td><p>Указывает максимальный размер (в байтах) файла журнала, созданного средством трассировки. Если этот параметр указан без размера, минимальное значение — 65 535 байт. Если размер файла журнала достигает максимального значения, содержимое файла удаляется. Данные трассировки по мере продолжения записываются в файл журнала.</p></td>
</tr>
</tbody>
</table>



 

Запуск средства настройки средства трассировки и указание параметра без параметров извлекает и отображает текущие параметры реестра.

> [!Note]  
> Файлы журналов быстро увеличиваются и снижают производительность приложения. Перед включением средства трассировки убедитесь в наличии необходимого места на жестком диске.

 

## <a name="interpreting-trace-data"></a>Анализ данных трассировки

Поток данных средства трассировки отражает функции WinHTTP, вызываемые в приложении, и любые отправленные или полученные данные HTTP. В некоторых случаях также показаны функции, называемые внутренними WinHTTP.

На следующем рисунке показана часть файла журнала, созданного средством трассировки. Несколько элементов выделены и помечаются меткой.

![Пример трассировки](images/ss-tracer-wco.png)

Каждая строка выходных данных трассировки содержит сведения в трех столбцах. В первом столбце отображаются дата и время записи. Во втором столбце показан идентификатор запроса (ID), который можно использовать для различения нескольких запросов. Если запись журнала не соответствует определенному запросу, \* \* в этом столбце отображается "Session". Можно отсортировать файл журнала по этому ИДЕНТИФИКАТОРу, чтобы просмотреть только события, происходящие в одном запросе. В следующем примере показана команда, которую можно использовать для сортировки файла журнала.

**Findstr 00000001 файл_журнала. log**

В третьем столбце показан вызов функции, HTTP-трафик или сообщение о состоянии, добавленное для интерпретации трассировки.

Если запись журнала соответствует вызову функции, также записываются параметры функции. Адреса памяти отображаются в шестнадцатеричном виде, а все остальные значения отображаются в виде строки ASCII. Средство трассировки также записывает время и значение возврата для каждой функции.

Формат данных HTTP зависит от параметров реестра, заданных в средстве настройки средства трассировки. При шифровании данных HTTP расшифрованные данные также отображаются в выходных данных трассировки.

 

 




