---
title: Общие сведения о ресурсе в Direct3D 11
description: В этом разделе представлены ресурсы Direct3D, такие как буферы и текстуры.
ms.assetid: 9e991ab0-9648-484a-9a2c-5391ee5abf20
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cb466883991795a66eec0ba1b99f5c989fa33c1f
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104413291"
---
# <a name="introduction-to-a-resource-in-direct3d-11"></a>Общие сведения о ресурсе в Direct3D 11

Ресурсы являются стандартными блоками сцены. Они содержат большую часть данных, которые Direct3D использует для интерпретации и визуализации сцены. Ресурсы — это области памяти, к которым можно получить доступ с помощью конвейера Direct3D. Ресурсы содержат следующие типы данных: геометрию, текстуры, данные шейдера. В этом разделе представлены ресурсы Direct3D, такие как буферы и текстуры.

Можно создать строго типизированные или нетипизированные ресурсы. Вы можете контролировать, имеют ли ресурсы доступ на чтение и запись; ресурсы можно сделать доступными только для ЦП, GPU или и того, и другого. На каждом этапе конвейера может быть активно до 128 ресурсов.

Direct3D гарантирует возврат нуля для любого ресурса, доступ к которому осуществляется вне границ.

Жизненный цикл ресурса Direct3D:

-   Создайте ресурс с помощью одного из методов create интерфейса [**ID3D11Device**](/windows/desktop/api/D3D11/nn-d3d11-id3d11device) .
-   Привяжите ресурс к конвейеру, используя контекст и один из методов Set интерфейса [**ссылку ID3D11DeviceContext**](/windows/desktop/api/D3D11/nn-d3d11-id3d11devicecontext) .
-   Освобождение ресурса путем вызова метода [**Release**](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release) интерфейса ресурсов.

В этом разделе рассматриваются следующие вопросы.

-   [Строгая и слабая типизация](#strong-vs-weak-typing)
-   [Представления ресурсов](#resource-views)
-   [Необработанные представления буферов](#raw-views-of-buffers)
-   [См. также](#related-topics)

## <a name="strong-vs-weak-typing"></a>Строгая и слабая типизация

Указать макет ресурса (тип размещения в памяти) можно двумя способами.

-   Типизированный — полностью укажите тип при создании ресурса.
-   Без типа — полностью укажите тип, если ресурс привязан к конвейеру.

При создании полностью типизированного ресурса он может использовать только тот формат, с которым был создан. Это позволяет среде выполнения оптимизировать доступ, особенно если ресурс создается с флагами, указывающими, что приложение не может его сопоставить. Ресурсы, созданные с помощью определенного типа, не могут быть повторно интерпретированы с использованием механизма представления, если только этот ресурс не был создан с \_ \_ \_ флагом Present привязки DDI D3D10. Если установлена \_ Привязка DDI D3D10, \_ \_ то на этих ресурсах можно создать представления ресурсов рендеринга или целевого объекта, используя любой из полностью типизированных членов соответствующего семейства, даже если исходный ресурс был создан как полностью типизированный.

В ресурсе типа less тип данных неизвестен при первом создании ресурса. Приложение должно выбирать из доступных форматов меньшего числа (см. [**раздел \_ Формат DXGI**](/windows/desktop/api/dxgiformat/ne-dxgiformat-dxgi_format)). Вам следует указать размер выделяемой области памяти и то, потребуется ли среде выполнения создать подтекстуры в MIP-карте. Однако точный формат данных (если память будет интерпретироваться как целые числа, значения с плавающей запятой, целые числа без знака и т. д.) не определяется до тех пор, пока ресурс не будет привязан к конвейеру с [представлением ресурсов](#resource-views). Так как формат текстуры остается произвольным до привязки текстуры к конвейеру, ресурс называется хранилищем с нестрогой типизацией. Слабо типизированное хранилище имеет преимущество, что его можно повторно использовать или интерпретировать в другом формате, если количество компонентов и число бит каждого компонента одинаковы в обоих форматах.

Один ресурс можно привязать к нескольким этапам конвейера, если у каждой из них есть уникального представление, которое полностью квалифицирует форматы в каждом расположении. Например, ресурс, созданный с форматом \_ \_ R32G32B32A32 \_ типа "нетипизированный", можно использовать в качестве \_ формата DXGI \_ R32G32B32A32 \_ float и в \_ формате DXGI \_ R32G32B32A32 \_ uint в разных местах конвейера одновременно.

## <a name="resource-views"></a>Представления ресурсов

Ресурсы можно хранить в форматах памяти общего назначения, чтобы их можно было совместно использовать на нескольких стадиях конвейера. На этапе конвейера данные ресурсов обрабатываются с помощью представления. Представление ресурсов концептуально похоже на приведение данных ресурсов, чтобы их можно было использовать в определенном контексте.

Представление можно использовать с нетипизированным ресурсом. Это значит, что можно создать ресурс во время компиляции и объявить тип данных, если ресурс привязан к конвейеру. Представление, созданное для ресурса типа, всегда имеет одинаковое количество битов на каждый компонент; способ интерпретации данных зависит от указанного формата. Указанный формат должен быть из того же семейства, что и формат, используемый при создании ресурса. Например, ресурс, созданный с R8G8B8A8 без \_ типа, нельзя просмотреть как \_ ресурс с плавающей запятой R32, даже если оба формата могут иметь одинаковый размер в памяти.

Представление также предоставляет другие возможности, такие как возможность чтения поверхностей глубины или набора элементов в шейдере, создание динамического кубической карты в рамках одного прохода и одновременное отображение нескольких срезов тома.



| Интерфейс ресурсов                                             | Описание                                                                                   |
|----------------------------------------------------------------|-----------------------------------------------------------------------------------------------|
| [**ID3D11DepthStencilView**](/windows/desktop/api/D3D11/nn-d3d11-id3d11depthstencilview)       | Доступ к ресурсу текстуры во время тестирования шаблона глубины.                                       |
| [**ID3D11RenderTargetView**](/windows/desktop/api/D3D11/nn-d3d11-id3d11rendertargetview)       | Доступ к ресурсу текстуры, который используется в качестве целевого объекта рендеринга.                                    |
| [**ID3D11ShaderResourceView**](/windows/desktop/api/D3D11/nn-d3d11-id3d11shaderresourceview)   | Доступ к ресурсу шейдера, такому как буфер констант, буфер текстуры, текстуру или образец. |
| [**ID3D11UnorderedAccessView**](/windows/desktop/api/D3D11/nn-d3d11-id3d11unorderedaccessview) | Доступ к неупорядоченному ресурсу с помощью шейдера пикселей или шейдера вычислений.                        |



 

## <a name="raw-views-of-buffers"></a>Необработанные представления буферов

Можно представить необработанный буфер, который также может называться [буфером адресов байтов](direct3d-11-advanced-stages-cs-resources.md), как набор битов, к которому нужен доступ без использования, т. е. буфер, к которому можно получить удобный доступ через фрагменты, со4 32-разрядные значения адресов без типов. Вы указываете, что требуется необработанный доступ к буферу (или необработанному представлению буфера) при вызове одного из следующих методов для создания представления в буфере:

-   Чтобы создать представление ресурсов шейдера (SRV) для буфера, вызовите [**ID3D11Device:: креатешадерресаурцевиев**](/windows/desktop/api/D3D11/nf-d3d11-id3d11device-createshaderresourceview) с флагом [**D3D11 \_ буфферекс \_ SRV \_ флагом \_ RAW**](/windows/desktop/api/D3D11/ne-d3d11-d3d11_bufferex_srv_flag). Этот флаг задается в элементе **flags** структуры [**D3D11 \_ буфферекс \_ SRV**](/windows/desktop/api/D3D11/ns-d3d11-d3d11_bufferex_srv) . Вы настраиваете **D3D11 \_ буфферекс \_ SRV** в элементе **буфферекс** в [**\_ представлении ресурсов шейдера D3D11 \_ \_ \_ DESC**](/windows/desktop/api/d3d11/ns-d3d11-d3d11_shader_resource_view_desc) , к которому принадлежит параметр *пдеск* в **ID3D11Device:: креатешадерресаурцевиев** Points. Вы также задаете значение [**\_ \_ \_ буфферекс SRV Dimension D3D11**](/previous-versions/windows/desktop/legacy/ff476217(v=vs.85)) в элементе **Виевдименсион** в **\_ представлении ресурсов шейдера D3D11 \_ \_ \_ DESC** , чтобы указать, что SRV является необработанным представлением.
-   Чтобы создать неупорядоченное представление доступа (UAV) в буфере, вызовите [**ID3D11Device:: креатеунордередакцессвиев**](/windows/desktop/api/D3D11/nf-d3d11-id3d11device-createunorderedaccessview) с флагом [**D3D11 \_ buffer \_ UAV \_ флаг \_ RAW**](/windows/desktop/api/D3D11/ne-d3d11-d3d11_buffer_uav_flag). Этот флаг задается в элементе **flags** структуры [**\_ \_ UAV buffer D3D11**](/windows/desktop/api/D3D11/ns-d3d11-d3d11_buffer_uav) . Значение **\_ \_ UAV буфера D3D11** задается в элементе **buffer** в [**структуре \_ \_ \_ \_ представления неупорядоченного доступа D3D11**](/windows/desktop/api/D3D11/ns-d3d11-d3d11_unordered_access_view_desc) , в которую входит параметр *пдеск* **ID3D11Device:: креатеунордередакцессвиев** Points. Вы также задаете значение [**\_ \_ \_ буфера измерения D3D11 UAV**](/windows/desktop/api/D3D11/ne-d3d11-d3d11_uav_dimension) в элементе **виевдименсион** **D3D11 \_ неупорядоченного \_ представления доступа \_ \_ DESC** , чтобы указать, что UAV является необработанным представлением.

При работе с необработанными буферами можно использовать типы объектов HLSL [**битеаддрессбуффер**](/windows/desktop/direct3dhlsl/sm5-object-byteaddressbuffer) и [**рвбитеаддрессбуффер**](/windows/desktop/direct3dhlsl/sm5-object-rwbyteaddressbuffer) .

Чтобы создать необработанное представление для буфера, сначала необходимо вызвать метод [**ID3D11Device:: CreateBuffer**](/windows/desktop/api/D3D11/nf-d3d11-id3d11device-createbuffer) с флагом [**D3D11 \_ ресурс \_ Прочие \_ буферы \_ Разрешить \_ необработанные \_ представления**](/windows/desktop/api/D3D11/ne-d3d11-d3d11_resource_misc_flag) , чтобы создать базовый ресурс буфера. Этот флаг задается в элементе **мискфлагс** структуры [**буфера D3D11 \_ \_ DESC**](/windows/desktop/api/D3D11/ns-d3d11-d3d11_buffer_desc) , в которую входит параметр *пдеск* **ID3D11Device:: CreateBuffer** Points. Нельзя объединять флаг **\_ \_ \_ \_ \_ необработанных \_ представлений в буфер D3D11** для ресурсов [**D3D11 \_ , \_ \_ \_ структурированный**](/windows/desktop/api/D3D11/ne-d3d11-d3d11_resource_misc_flag)с помощью буфера. Кроме того, при указании [**\_ \_ \_ буфера константы D3D11 BIND**](/windows/desktop/api/D3D11/ne-d3d11-d3d11_bind_flag) в **биндфлагс** из **D3D11 \_ буфера \_ DESC** вы также не сможете указать **D3D11 \_ Resource \_ buffer, \_ \_ разрешающие \_ необработанные \_ представления** в **мискфлагс**. Это не ограничение только необработанных представлений, так как буферы констант уже имеют ограничение, которое невозможно объединить с любым другим представлением.

В отличие от предыдущих недопустимых вариантов, при создании буфера с [**D3D11 \_ ресурсов \_ в \_ буфере \_ разрешаются \_ необработанные \_ представления**](/windows/desktop/api/D3D11/ne-d3d11-d3d11_resource_misc_flag), но не ограничены функциональные возможности и не заданы **\_ \_ буферы D3D11 ресурсов \_ \_ разрешают \_ необработанные \_ представления**. Это значит, что можно использовать такой буфер для доступа без необработанных данных в любом ряде способов, которые возможны при использовании Direct3D. При указании флага **D3D11 для \_ ресурсов \_ \_ буфера \_ разрешать \_ необработанные \_ представления** увеличивается только доступная функциональность.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Ресурсы](overviews-direct3d-11-resources.md)
</dt> <dt>

[Новые типы ресурсов](direct3d-11-advanced-stages-cs-resources.md)
</dt> </dl>

 

 