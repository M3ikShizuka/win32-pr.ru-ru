---
title: Создание шейдера доменов
description: В этом разделе показано, как спроектировать Шейдер доменов.
ms.assetid: 329d4eb9-8886-401d-8fb4-39e06886998f
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 46733bc9147f67cf33a127d8254f16c5813d8ebc2f0cb96c2071ae15589e34bd
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119566184"
---
# <a name="how-to-design-a-domain-shader"></a>Руководство. Проектирование шейдера доменов

Шейдер доменов — это третий из трех этапов, которые работают вместе для реализации [тесселяции](direct3d-11-advanced-stages-tessellation.md). Шейдер домена создает геометрию поверхности из преобразованных контрольных точек из шейдера поверхности и UV-координат. В этом разделе показано, как спроектировать Шейдер доменов.

Шейдер домена вызывается один раз для каждой точки, созданной с помощью тесселяции предопределенных функций. Входные данные представляют собой \[ координаты UV W \] точки на данном исправлении, а также все выходных данных из шейдера поверхности, включая контрольные точки и константы исправлений. Выходные данные представляют собой вершину, определенную как угодно. Если выходные данные отправляются в шейдер пикселей, то выходные данные должны включать в себя расположение (обозначено \_ семантикой позиций SV).

**Разработка шейдера домена**

1.  Определите атрибут домена.

    ```
    [domain("quad")]
    ```

    

    Домен определен для установки четырех исправлений.

2.  Объявите расположение в поверхности с системным значением [расположения домена](/windows/desktop/direct3dhlsl/sv-domainlocation) .

    -   Для четырех исправлений используйте float2.
    -   Для более трехуровневого обновления используйте float3 (для координат барицентрик).
    -   Для исолине используйте float2.

    Таким образом, расположение в домене для четырехъядерного исправления выглядит следующим образом:

    ```
    float2 UV : SV_DomainLocation
    ```

    

3.  Определите другие входные данные.

    Другие входные данные поступают из шейдера поверхности и определяются пользователем. Сюда входят контрольные точки ввода для исправления, в котором может находиться от 1 до 32 точек, а также данные константы с исправлением ввода.

    Контрольные точки определяются пользователем, обычно со структурой, такой как this (определена в [процедуре конструирования шейдера поверхности](direct3d-11-advanced-stages-hull-shader-design.md)):

    ```
    const OutputPatch<BEZIER_CONTROL_POINT, 16> bezpatch
    ```

    

    Постоянные данные исправления также определяются пользователем и могут выглядеть следующим образом (определено в [процедуре конструирования шейдера поверхности](direct3d-11-advanced-stages-hull-shader-design.md)):

    ```
    HS_CONSTANT_DATA_OUTPUT input
    ```

    

4.  Добавьте пользовательский код для расчета выходных данных. в результате образуется основная часть шейдера домена.

    Эта структура содержит определяемые пользователем выходные данные шейдера домена.

    ```
    struct DS_OUTPUT
    {
        float3 vNormal    : NORMAL;
        float2 vUV        : TEXCOORD;
        float3 vTangent   : TANGENT;
        float3 vBiTangent : BITANGENT;
        
        float4 vPosition  : SV_POSITION;
    };
    ```

    

    Функция принимает каждый входной элемент UV (из тесселяции) и оценивает исправление Безье в этой позиции.

    ```
    [domain("quad")]
    DS_OUTPUT BezierEvalDS( HS_CONSTANT_DATA_OUTPUT input, 
                            float2 UV : SV_DomainLocation,
                            const OutputPatch<BEZIER_CONTROL_POINT, 16> bezpatch )
    {
        DS_OUTPUT Output;

        // Insert code to compute the output here.

        return Output;    
    }
    ```

    

    Функция вызывается один раз для каждой точки, созданной с помощью тесселяции предопределенных функций. Так как в этом примере используется четыре исправления, входное расположение домена ([SV \_ домаинлокатион](/windows/desktop/direct3dhlsl/sv-domainlocation)) — это float2 (UV); у него должно быть float3ое расположение входных данных (УВВ барицентрик), а исолине — расположение домена ввода float2.

    Другие входные данные для функции берутся из шейдера поверхности напрямую. В этом примере 16 контрольных точек, каждая из которых является **\_ контрольной \_ точкой Безье**, а также постоянные данные исправления (**\_ \_ \_ выходные данные константы HS**). Выходные данные — это вершина, содержащая любые данные, необходимые для **\_ вывода данных DS** в этом примере.

После разработки шейдера домена см. раздел [как создать Шейдер доменов](direct3d-11-advanced-stages-domain-shader-create.md).

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Использование Direct3D 11](how-to-use-direct3d-11.md)
</dt> <dt>

[Общие сведения об тесселяции](direct3d-11-advanced-stages-tessellation.md)
</dt> </dl>

 

 