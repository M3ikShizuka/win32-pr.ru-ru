---
title: Вычисление шейдеров на низкоуровневых устройствах
description: В этом разделе описывается использование шейдеров вычислений в приложении Direct3D 11 на оборудовании Direct3D 10.
ms.assetid: b864269f-c1f7-4253-888d-04d1ed3e6587
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e77214e917d4d74b0e1eebcc3de245d136157976
ms.sourcegitcommit: 73417d55867c804274a55abe5ca71bcba7006119
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/20/2020
ms.locfileid: "104070830"
---
# <a name="compute-shaders-on-downlevel-hardware"></a>Вычисление шейдеров на низкоуровневых устройствах

Direct3D 11 предоставляет возможность использования [шейдеров вычислений](direct3d-11-advanced-stages-compute-shader.md) , которые работают на оборудовании с большинством Direct3D 10. x, с некоторыми ограничениями на работу. Технология вычислений с шейдером также называется технологией DirectCompute. В этом разделе описывается использование [шейдеров вычислений](direct3d-11-advanced-stages-compute-shader.md) в приложении Direct3D 11 на оборудовании Direct3D 10.

Поддержка шейдеров вычислений на оборудовании нижнего уровня предназначена только для устройств, совместимых с Direct3D 10. x. Использование шейдеров вычислений на оборудовании Direct3D 9. x не допускается.

Чтобы проверить, поддерживает ли оборудование Direct3D 10. x аппаратные шейдеры вычислений, вызовите [**ID3D11Device:: чеккфеатуресуппорт**](/windows/desktop/api/D3D11/nf-d3d11-id3d11device-checkfeaturesupport). В вызове **чеккфеатуресуппорт** передайте значение параметра \_ \_ оборудования D3D10 \_ x \_ в \_ параметре *Feature* , передайте указатель в структуру [**\_ \_ \_ \_ \_ \_ параметров оборудования D3D11 Feature Data D3D10 x**](/windows/desktop/api/D3D11/ns-d3d11-d3d11_feature_data_d3d10_x_hardware_options) в параметр *пфеатуресуппортдата* и передайте размер структуры **\_ \_ \_ \_ \_ \_ параметров оборудования D3D11 компонентов D3D10 x** в параметр *феатуресуппортдатасизе* . **Чеккфеатуресуппорт** возвращает **значение true** в параметре **компутешадерс \_ Plus \_ равандструктуредбуфферс \_ через \_ шейдер \_ 4 \_ x** элемента **D3D11 \_ Feature \_ Data \_ D3D10 \_ x \_ \_ Параметры оборудования** , если оборудование Direct3D 10. x поддерживает шейдеры вычислений.

В разделе [справочника 10Level9](d3d11-graphics-reference-10level9.md) перечислены различия между различными методами [**ID3D11Device**](/windows/desktop/api/D3D11/nn-d3d11-id3d11device) и [**ссылку ID3D11DeviceContext**](/windows/desktop/api/D3D11/nn-d3d11-id3d11devicecontext) на различных уровнях функций 10Level9.

-   [Неупорядоченные представления доступа (Уавс)](#unordered-access-views-uavs)
-   [Представления ресурсов шейдера (СРВС)](#shader-resource-views-srvs)
-   [Группы потоков](#thread-groups)
    -   [Измерения группы потоков](#thread-group-dimensions)
    -   [Двухмерные индексы потоков](#two-dimensional-thread-indices)
    -   [Общая память группы потоков (ТГСМ)](#thread-group-shared-memory-tgsm)
-   [D3DCompile с \_ \_ оптимизацией D3DCompile Skip](/windows)
-   [См. также](#related-topics)

## <a name="unordered-access-views-uavs"></a>Неупорядоченные представления доступа (Уавс)

Неупорядоченные представления доступа RAW ([рвбитеаддрессбуффер](/windows/desktop/direct3dhlsl/sm5-object-rwbyteaddressbuffer)) и Structured ([рвструктуредбуффер](/windows/desktop/direct3dhlsl/sm5-object-rwstructuredbuffer)) поддерживаются на оборудовании нижнего уровня со следующими ограничениями.

-   Только одна UAV может быть привязана к конвейеру за раз через [**ссылку ID3D11DeviceContext:: кссетунордередакцессвиевс**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-cssetunorderedaccessviews).
-   Базовое смещение необработанного UAV должно быть выровнено по границе 256 байт (вместо 16-байтового выравнивания, необходимого для оборудования Direct3D 11).

Типизированные Уавс не поддерживаются на оборудовании нижнего уровня. Сюда входят [Texture1D](/windows/desktop/direct3dhlsl/sm5-object-rwtexture1d), [Texture2D](/windows/desktop/direct3dhlsl/sm5-object-rwtexture2d)и [Texture3D](/windows/desktop/direct3dhlsl/sm5-object-rwtexture3d) уавс.

Шейдеры пикселей на оборудовании нижнего уровня не поддерживают неупорядоченный доступ.

## <a name="shader-resource-views-srvs"></a>Представления ресурсов шейдера (СРВС)

Необработанные и структурированные буферы в качестве представлений ресурсов шейдеров поддерживаются на оборудовании нижнего уровня для доступа только для чтения, так как они находятся на оборудовании Direct3D 11. Эти типы ресурсов поддерживаются для шейдеров вершин, шейдеров Geometry, шейдеров пикселей и шейдеров вычислений.

## <a name="thread-groups"></a>Группы потоков

Шейдер вычислений может выполняться во многих потоках параллельно внутри группы потоков.

Группы потоков поддерживаются на оборудовании нижнего уровня со следующими ограничениями.

### <a name="thread-group-dimensions"></a>Измерения группы потоков

Группы потоков, определенные для аппаратного обеспечения нижнего уровня, ограничены измерениями X и Y, равными 768. Это значение меньше максимального значения 1024 для оборудования Direct3D 11. Максимальное значение Z-измерения 64 не изменяется.

Общее число потоков в группе (X × Y × Z) ограничено 768. Это значение меньше, чем ограничение 1024 для оборудования Direct3D 11.

Если эти числа превышены, компиляция шейдера завершится ошибкой.

### <a name="two-dimensional-thread-indices"></a>Индексы потоков Two-Dimensional

Определенный поток в группе потоков индексируется с помощью трехмерного вектора, заданного (x, y, z).

Для вычислений в виде шейдеров, работающих на устройствах нижнего уровня, группы потоков поддерживают только два измерения. Это означает, что значение Z в трехмерном векторе всегда должно быть равно 1.

Это ограничение относится к следующим параметрам:

-   [**Ссылку ID3D11DeviceContext::D Patch**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-dispatch)— аргумент *среадграупкаунтз* должен быть равен 1.
-   [**Ссылку ID3D11DeviceContext::D испатчиндирект**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-dispatchindirect)— эта функция не поддерживается на оборудовании нижнего уровня.
-   [numthreads](/windows/desktop/direct3dhlsl/sm5-attributes-numthreads)— значение Z должно быть равно 1.

### <a name="thread-group-shared-memory-tgsm"></a>Общая память группы потоков (ТГСМ)

Общая память группы потоков ограничена 16 КБ на оборудовании нижнего уровня. Это меньше, чем 32 КБ, доступное для оборудования Direct3D 11.

Поток шейдера вычислений может выполнять запись только в собственный регион ТГСМ. Размер этой области, доступной только для записи, не должен превышать 256 байт, а максимальное уменьшение количества потоков, объявленных для группы, увеличится.

В следующей таблице определяется максимальный размер каждого потока ТГСМ региона для числа потоков в группе.



| Число потоков в группе | Максимальный размер ТГСМ на поток |
|----------------------------|------------------------------|
| 0-64                       | 256                          |
| 65-68                      | 240                          |
| 69-72                      | 224                          |
| 73-76                      | 208                          |
| 77-84                      | 192                          |
| 85-92                      | 176                          |
| 93-100                     | 160                          |
| 101-112                    | 144                          |
| 113-128                    | 128                          |
| 129-144                    | 112                          |
| 145-168                    | 96                           |
| 169-204                    | 80                           |
| 205-256                    | 64                           |
| 257-340                    | 48                           |
| 341-512                    | 32                           |
| 513-768                    | 16                           |



 

Поток шейдера вычислений может считывать ТГСМ из любого расположения.

## <a name="d3dcompile-with-d3dcompile_skip_optimization"></a>D3DCompile с \_ \_ оптимизацией D3DCompile Skip

[**D3DCompile**](/windows/desktop/direct3dhlsl/d3dcompile) возвращает **E \_ нотимпл** при передаче CS \_ 4 \_ 0 в качестве целевого объекта шейдера вместе с параметром [**D3DCompile \_ пропустить \_ оптимизацию**](/windows/desktop/direct3dhlsl/d3dcompile-constants) . \_ \_ Целевой объект шейдера CS 5 0 работает с **\_ \_ оптимизацией D3DCOMPILE Skip**.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Direct3D 11 на оборудовании нижнего уровня](overviews-direct3d-11-devices-downlevel.md)
</dt> </dl>

 

 