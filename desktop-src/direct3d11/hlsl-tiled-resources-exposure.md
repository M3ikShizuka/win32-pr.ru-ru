---
title: Уязвимость мозаичных ресурсов HLSL
description: Новый синтаксис языка шейдера высокого уровня (Майкрософт) (HLSL) необходим для поддержки мозаичных ресурсов в модели шейдеров 5.
ms.assetid: B6CE51E6-1BA9-4D15-9654-86FE9BAAF585
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c66ded502bebefc1061028115a12026f67c26cad89ddc57f98a5ae6fee923591
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119633334"
---
# <a name="hlsl-tiled-resources-exposure"></a>Уязвимость мозаичных ресурсов HLSL

Новый синтаксис языка шейдера высокого уровня (Майкрософт) (HLSL) необходим для поддержки мозаичных ресурсов в [модели шейдеров 5](/windows/desktop/direct3dhlsl/d3d11-graphics-reference-sm5).

Новый синтаксис HLSL разрешен только на устройствах с поддержкой мозаичных ресурсов. Каждый соответствующий метод HLSL для мозаичных ресурсов в следующей таблице принимает один (отклик) или два (срез и обратную связь в этом порядке) дополнительные необязательные параметры. Например, метод **Sample** выглядит так:

**Образец (образец, расположение \[ , смещение \[ , срез \[ , обратная связь \] \] \] )**

Пример метода **Sample** — [**Texture2D.Sample(S,float,int,float,uint)**](/windows/desktop/direct3dhlsl/t2darray-sample-s-float-int-float-uint-).

Параметры offset, clamp и feedback необязательны. Необходимо указать все необязательные параметры вплоть до требуемого в соответствии с правилами C++ касательно аргументов функций по умолчанию. Например, если требуется состояние feedback, необходимо явным образом предоставить параметры offset и clamp методу **Sample**, даже если логически они не нужны.

Параметр clamp — скалярное значение с плавающей точкой. Литеральное значение clamp=0.0f указывает, что операция прикрепления не выполнена.

Параметр feedback — это переменная **uint**, которую можно передать встроенной функции опроса доступа к памяти [**CheckAccessFullyMapped**](/windows/desktop/direct3dhlsl/checkaccessfullymapped). Значение параметра feedback нельзя изменять или интерпретировать. Но компилятор не предоставляет средств расширенного анализа и диагностики для обнаружения изменений значения.

Вот синтаксис [**CheckAccessFullyMapped**](/windows/desktop/direct3dhlsl/checkaccessfullymapped):

**bool CheckAccessFullyMapped(in uint FeedbackVar);**

[**CheckAccessFullyMapped**](/windows/desktop/direct3dhlsl/checkaccessfullymapped) интерпретирует значение *FeedbackVar* и возвращает значение true, если все данные, к которым осуществляется доступ, сопоставлены в ресурсе. В противном случае **CheckAccessFullyMapped** возвращает значение false.

Если параметр clamp или feedback присутствует, компилятор выдает вариант базовой инструкции. Например, образец мозаичного ресурса создает `sample_cl_s` инструкцию. Если параметры clamp и feedback не указаны, компилятор выдает базовую инструкцию, чтобы исключить отклонение от текущего поведения. Если параметру clamp присвоено значение 0.0f, прикрепление не выполнено. Компилятор драйвера может дополнительно настроить инструкцию под целевое оборудование. Если значением параметра feedback является регистр NULL в инструкции, параметр feedback не используется. Таким образом, компилятор драйвера может дополнительно настроить инструкцию под целевую архитектуру.

Если компилятор HLSL делает логический вывод, что значение параметра clamp — 0.0f, а параметр feedback не используется, компилятор выдает соответствующую базовую инструкцию (например, `sample` вместо `sample_cl_s`).

Если доступ к мозаичному ресурсу состоит из нескольких составных инструкций по созданию байтового кода, например для структурированных ресурсов, компилятор выполняет статистическую обработку отдельных значений обратной связи с помощью операции или для получения окончательного значения обратной связи. Таким образом, для такого сложного доступа вы получаете одно значение параметра feedback.

Это сводная таблица методов HLSL, измененных для обеспечения поддержки параметров feedback и clamp. Все это работает с мозаичными и немозаичными ресурсами всех измерений. Ресурсы, не являющиеся мозаичными, всегда будут полностью сопоставлены.



| [Объекты HLSL](/windows/desktop/direct3dhlsl/d3d11-graphics-reference-sm5-objects)                                                                                                                                                                                                                                | Встроенные методы с параметром Feedback ( \* ) также имеют параметр среза                                                                                                                                                                  |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| \[RW \] Texture2D<br/> \[RW \] Texture2DArray<br/> TextureCUBE<br/> TextureCUBEArray<br/>                                                                                                                                                                                    | Gather<br/> GatherRed<br/> GatherGreen<br/> GatherBlue<br/> GatherAlpha<br/> GatherCmp<br/> GatherCmpRed<br/> GatherCmpGreen<br/> GatherCmpBlue<br/> GatherCmpAlpha<br/> |
| \[RW \] Texture1D<br/> \[RW \] Texture1DArray<br/> \[RW \] Texture2D<br/> \[RW \] Texture2DArray<br/> \[RW \] Texture3D<br/> TextureCUBE<br/> TextureCUBEArray<br/>                                                                                              | Следующий\*<br/> самплебиас\*<br/> самплекмп\*<br/> SampleCmpLevelZero<br/> самплеград\*<br/> SampleLevel<br/>                                                                                      |
| \[RW \] Texture1D<br/> \[RW \] Texture1DArray<br/> \[RW \] Texture2D<br/> Texture2DMS<br/> \[RW \] Texture2DArray<br/> Texture2DArrayMS<br/> \[RW \] Texture3D<br/> \[RW \] буфер<br/> \[RW \] битеаддрессбуффер<br/> \[RW \] структуредбуффер<br/> | Загрузить                                                                                                                                                                                                                                 |



 

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Доступ конвейера к мозаичным ресурсам](pipeline-access-to-tiled-resources.md)
</dt> </dl>

 

