---
title: Общие сведения о буферах в Direct3D 11
description: Буферный ресурс — это коллекция полностью типизированных данных, сгруппированных в элементы.
ms.assetid: e33ca01e-f13c-4f91-b0db-2b2bc6b4fd8f
keywords:
- буфер констант, что такое
- буфер вершин, что такое
- буфер индексов, что такое
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d51f7b0dbd60264b77f9d9dc83f39cbb4325464079d537c3ee741a942d26a139
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119752024"
---
# <a name="introduction-to-buffers-in-direct3d-11"></a>Общие сведения о буферах в Direct3D 11

Буферный ресурс — это коллекция полностью типизированных данных, сгруппированных в элементы. Буферы можно использовать для хранения самых разных данных, в том числе векторов положений, нормальных векторов, координат текстур (в буфере вершин), индексов (в буфере индексов) или состояния устройства. Элемент буфера состоит из компонентов числом от 1 до 4. Элементы буфера могут включать в себя упакованные значения данных (например, значения поверхности R8G8B8A8), единичные 8-разрядные целые числа или четыре 32-разрядных значения с плавающей запятой.

Буфер создается как неструктурированный ресурс. Поскольку он неструктурированный, буфер не может содержать какие-либо уровни MIP, не может использовать фильтрацию при чтении и не может подвергаться множественной дискретизации.

## <a name="buffer-types"></a>Типы буферов

Ниже приведены типы буферных ресурсов, поддерживаемые Direct3D 11. Все типы буферов инкапсулированы интерфейсом [**ID3D11Buffer**](/windows/desktop/api/D3D11/nn-d3d11-id3d11buffer) .

-   [Буфер вершин](#vertex-buffer)
-   [Буфер индексов](#index-buffer)
-   [Буфер констант](#constant-buffer)

### <a name="vertex-buffer"></a>Буфер вершин

Буфер вершин содержит данные вершин, используемые для определения геометрии. К данным вершин относятся координаты положения, данные цвета, данные координат текстуры, данные нормали и т. д.

Самый простой пример буфера вершин — это буфер, который содержит только данные положения. Его можно изобразить, как на следующем рисунке.

![иллюстрация буфера вершин, который содержит данные положения](images/d3d10-resources-single-element-vb2.png)

Чаще всего буфер вершин содержит все данные, необходимые для полного описания трехмерных вершин. Примером этого может быть буфер вершин, который содержит положение, нормаль и координаты текстуры для каждой вершины. Эти данные обычно упорядочены в виде наборов элементов для каждой вершины, как показано на следующем рисунке.

![иллюстрация буфера вершин, который содержит данные положения, нормали и текстуры](images/d3d10-vertex-buffer-element.png)

Этот буфер вершин содержит данные по каждой вершине; для каждой вершины сохраняются три элемента (положение, нормаль и координаты текстуры). Положения и нормали обычно задаются с помощью 3 32-битных плавающих чисел (в \_ формате DXGI \_ R32G32B32 \_ float) и координатах текстуры с использованием 2 32-разрядных чисел с плавающей запятой ( \_ Формат DXGI \_ R32G32 \_ float).

Для доступа к данным из буфера вершин необходимо знать, какая вершина нужна, а также следующие дополнительные параметры буфера.

-   Смещение — число байтов от начала буфера до данных для первой вершины. Смещение можно указать с помощью метода [**ссылку ID3D11DeviceContext:: иасетвертексбуфферс**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-iasetvertexbuffers) .
-   BaseVertexLocation — количество байтов от смещения до первой вершины, используемой с помощью соответствующего вызова рисования.

Перед созданием буфера вершин необходимо определить его макет, создав интерфейс [**ID3D11InputLayout**](/windows/win32/api/d3d11/nn-d3d11-id3d11inputlayout) . Это делается путем вызова метода [**ID3D11Device:: креатеинпутлайаут**](/windows/desktop/api/D3D11/nf-d3d11-id3d11device-createinputlayout) . После создания объекта макета ввода его можно привязать к этапу входного ассемблера, вызвав метод [**ссылку ID3D11DeviceContext:: иасетинпутлайаут**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-iasetinputlayout).

Чтобы создать буфер вершин, вызовите [**ID3D11Device:: CreateBuffer**](/windows/desktop/api/D3D11/nf-d3d11-id3d11device-createbuffer).

### <a name="index-buffer"></a>Буфер индексов

Буферы индексов содержат целочисленные указатели в буферы вершин и используются для более эффективной отрисовки примитивов. Буфер индексов содержит последовательный набор 16-разрядных или 32-разрядных индексов; каждый индекс используется для идентификации вершины в буфере вершин. Буфер индексов можно изобразить, как на следующем рисунке.

![иллюстрация буфера индексов](images/d3d10-index-buffer.png)

Последовательные индексы, хранящиеся в буфере индексов, обнаруживаются по следующим параметрам:

-   Смещение — число байтов от базового адреса буфера индексов. Смещение предоставляется методу [**ссылку ID3D11DeviceContext:: иасетиндексбуффер**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-iasetindexbuffer) .
-   Стартиндекслокатион — указывает первый элемент буфера индекса из базового адреса и смещение, предоставленное в [**иасетиндексбуффер**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-iasetindexbuffer). Начальное расположение указывается для метода [**ссылку ID3D11DeviceContext::D равиндексед**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-drawindexed) или [**ссылку ID3D11DeviceContext::D равиндексединстанцед**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-drawindexedinstanced) и представляет первый индекс для отображения.
-   IndexCount — число индексов для отрисовки. Номер предоставляется методу [**дравиндексед**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-drawindexed)

Начало буфера индекса = базовый адрес буфера индексов + смещение (в байтах) + Стартиндекслокатион \* ElementSize (байт);

В этом расчете ElementSize — это размер каждого элемента буфера индексов, представляющий собой два или четыре байта.

Чтобы создать буфер индекса, вызовите метод [**ID3D11Device:: CreateBuffer**](/windows/desktop/api/D3D11/nf-d3d11-id3d11device-createbuffer).

### <a name="constant-buffer"></a>Буфер констант

Буфер констант позволяет эффективно поставлять данные констант шейдера в конвейер. Буфер констант можно использовать для хранения результатов этапа вывода потока. Концептуально буфер констант аналогичен одноэлементному буферу вершин, что показано на следующем рисунке.

![иллюстрация буфера констант шейдера](images/d3d10-shader-resource-buffer.png)

Каждый элемент хранит определяемую форматом данных константу с числом компонентов от 1 до 4. Чтобы создать буфер шейдера, вызовите [**ID3D11Device:: CreateBuffer**](/windows/desktop/api/D3D11/nf-d3d11-id3d11device-createbuffer) и укажите элемент **\_ \_ \_ буфера константы D3D11 BIND** в перечислимом типе [**\_ \_ флага D3D11 BIND**](/windows/desktop/api/D3D11/ne-d3d11-d3d11_bind_flag) .

Буфер константы может использовать только один флаг привязки (**D3D11- \_ \_ \_ буфер константы привязки**), который нельзя сочетать с другими флагами привязки. Чтобы привязать буфер шейдера к конвейеру, вызовите один из следующих методов: [**ссылку ID3D11DeviceContext:: гссетконстантбуфферс**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-gssetconstantbuffers), [**ссылку ID3D11DeviceContext::P ссетконстантбуфферс**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-pssetconstantbuffers)или [**ссылку ID3D11DeviceContext:: вссетконстантбуфферс**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-vssetconstantbuffers).

Для считывания буфера констант шейдера из шейдера используйте функцию загрузки HLSL (например, [**Load**](/windows/desktop/direct3dhlsl/dx-graphics-hlsl-to-load)). На каждом этапе шейдера можно определить до 15 буферов констант шейдера, причем каждый буфер может содержать до 4096 констант.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Buffers](overviews-direct3d-11-resources-buffers.md)
</dt> </dl>

 

 