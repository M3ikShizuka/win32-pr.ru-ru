---
title: API-интерфейсы мозаичного ресурса
description: Интерфейсы API, описанные в этом разделе, работают с мозаичными ресурсами и пулом плиток.
ms.assetid: 02DCF9BA-F9EA-4176-AD6F-AA620CE968BA
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3f433b6c70d475d4da511b85fdcc2b1c273de1efa8e1186215b25ce6b9b95d0a
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119894394"
---
# <a name="tiled-resource-apis"></a>API-интерфейсы мозаичного ресурса

Интерфейсы API, описанные в этом разделе, работают с мозаичными ресурсами и пулом плиток.

-   [Назначение плиток из пула плиток ресурсу](#assigning-tiles-from-a-tile-pool-to-a-resource)
-   [Запрос заполнения и поддержки ресурсов](#querying-resource-tiling-and-support)
-   [Копирование мозаичных данных](#copying-tiled-data)
-   [Изменение размера пула плиток](#resizing-tile-pool)
-   [Барьер ресурсов мозаики](#tiled-resource-barrier)
-   [Связанные темы](#related-topics)

## <a name="assigning-tiles-from-a-tile-pool-to-a-resource"></a>Назначение плиток из пула плиток ресурсу

Интерфейсы API [**ID3D11DeviceContext2:: упдатетилемаппингс**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-updatetilemappings) и [**ID3D11DeviceContext2:: копитилемаппингс**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-copytilemappings) обрабатывают и сопоставлений плиток запросов. Вызовы Update влияют только на плитки, указанные в вызове, а другие остаются, как определено ранее.

Любую плитку из пула плиток можно сопоставить с несколькими расположениями в ресурсе и даже с несколькими ресурсами. Это сопоставление включает плитки в ресурсе с макетом, выбранным для реализации ([mipmap упаковка](mipmap-packing.md)), где несколько MIP-карты упаковываются в одну плитку. Catch заключается в том, что если данные записываются на плитку через одно сопоставление, но считываются с помощью другого настроенного сопоставления, результаты будут неопределенными. Внимательное использование этой гибкости может быть полезно для приложения, например для совместного использования плитки между ресурсами, которые не будут использоваться одновременно, где содержимое плитки всегда инициализируется с использованием того же сопоставления ресурсов, которое будет впоследствии считаться. Аналогично, плитка, сопоставленная с упакованной MIP-карты нескольких разных ресурсов с одинаковыми измерениями поверхности, будет работать хорошо. данные будут отображаться одинаково в обоих сопоставлениях.

Изменения в назначениях плиток для ресурса можно вносить в любое время в немедленном или отложенном контексте.

## <a name="querying-resource-tiling-and-support"></a>Запрос заполнения и поддержки ресурсов

Чтобы запросить разбиение ресурсов, используйте [**ID3D11Device2:: жетресаурцетилинг**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11device2-getresourcetiling).

Для поддержки разбиения ресурсов на другие ресурсы используйте [**ID3D11Device2:: CheckMultisampleQualityLevels1**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11device2-checkmultisamplequalitylevels1).

## <a name="copying-tiled-data"></a>Копирование мозаичных данных

Любые методы в Direct3D для перемещения данных по работе с мозаичными ресурсами точно так же, как если бы они не были мозаичными, за исключением того, что операции записи в несопоставленные области удаляются, а операции чтения из несопоставленных областей создают 0. Если операция копирования включает запись в одно и то же расположение в памяти несколько раз, так как несколько расположений в целевом ресурсе сопоставляются с одной и той же памятью плитки, то результирующие записи в многосопоставленные плитки не являются детерминированными и не повторяются. То есть, доступ выполняется в любом порядке, в котором происходит копирование.

В Direct3D 11,2 появились методы для следующих дополнительных способов копирования:

-   Копирование между плитками в мозаичном ресурсе (с гранулярностью в 64 КБ) и (to/from) буфер в памяти графического процессора (или промежуточного ресурса) — [ **ID3D11DeviceContext2:: копитилес**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-copytiles)
-   Копирование из памяти, предоставленной приложением, в плитки в мозаичном ресурсе — [ **ID3D11DeviceContext2:: упдатетилес**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-updatetiles)

При необходимости эти методы свиззле/десвиззле и разрешают D3D11 \_ плитку \_ Copy \_ без \_ флага перезаписи, когда вызывающий объект обещает, что на целевую память не ссылается работа GPU, которая находится в полете.

Плитки, участвующие в копии, не могут включать плитки, содержащие Упакованные MIP-карты или имеющие неопределенные результаты. Чтобы передавать данные в MIP-карты и обратно, чтобы пакеты оборудования были в одной плитке, необходимо использовать стандартные (не относящиеся к плитке) API копирования и обновления или [**ссылку ID3D11DeviceContext:: женератемипс**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-generatemips) для всей цепочки MIP.

**Примечание. в [**женератемипс**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-generatemips):** использование [**ссылку ID3D11DeviceContext:: женератемипс**](/windows/desktop/api/D3D11/nf-d3d11-id3d11devicecontext-generatemips) для ресурса с частично сопоставленными плитками приведет к получению результатов, которые просто следуют правилам чтения и записи **значений NULL** , примененных к любому алгоритму, который может использоваться для **женератемипс**. Таким образом, не особенно полезно, чтобы приложение применяет эту возможность, если не каким-либо областям с сопоставлениями **null** (и их влияния на другие MIPS на этапе создания) не повлияет на части поверхности, о которых позаботится приложение.

Копирование данных плитки из промежуточной поверхности или из памяти приложения — это способ передачи плиток, которые могут быть переработаны с диска, например. Вариант при потоковой передаче диска — передача некоторых сжатых данных в память GPU и последующее декодирование графического процессора. Целью декодирования может быть ресурс буфера в памяти GPU, из которого [**копитилес**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-copytiles) копируется в фактический мозаичный ресурс. Этот шаг копирования позволяет свиззле GPU, если шаблон свиззле неизвестен. Группирующие не требуется, если сам мозаичный ресурс является буферным ресурсом (например, в отличие от текстуры).

Макет памяти мозаичных элементов на стороне копии ресурсов, не являющихся мозаичным буфером, — это просто линейная память в блоках памяти объемом 64 КБ, которые должны свиззле/десвиззле на плитку при передаче в или из мозаичного ресурса. Для поверхностей многовыборочного сглаживания (MSAA) все выборки пикселов проходят в порядке выборки перед переходом к следующему пикселю. Для плиток, которые частично заполнены в правой части (для поверхности, ширина которой не кратна ширине плитки в пикселях), шаг/шаг для перемещения вниз по строке — это полный размер в байтах от числа пикселей, которые помещаются на плитке, если плитка заполнена. Таким образом, между каждой строкой пикселей в памяти может быть разрыв. Для простоты спецификации MIP-карты меньше, чем плитка, не упаковывается вместе в линейный макет. Вероятно, это непростое место в памяти, но, как упоминалось, копирование в MIPS, что пакеты оборудования вместе не разрешены через [**копитилес**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-copytiles) или [**упдатетилес**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-updatetiles). Приложение может просто использовать универсальные \* API упдатесубресаурце () или кописубресаурце \* () для копирования мелких MIPS по отдельности, хотя в случае кописубресаурце \* () это означает, что линейная память должна быть той же размерности, что и мозаичный ресурс-кописубресаурце \* (). не удается скопировать из буферного ресурса в Texture2D для экземпляра.

Если определена аппаратная стандартная свиззле, можно добавить флаги, чтобы указать, что данные в буфере должны интерпретироваться в этом формате (не требуется свиззле при передаче), хотя альтернативные подходы к отправке данных могут также иметь смысл в таком случае, например предоставить приложениям прямой доступ к памяти пула плиток.

Операции копирования можно выполнять в немедленном или отложенном контексте.

## <a name="resizing-tile-pool"></a>Изменение размера пула плиток

Чтобы изменить размер пула плиток, используйте [**ID3D11DeviceContext2:: ресизетилепул**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-resizetilepool).

## <a name="tiled-resource-barrier"></a>Барьер ресурсов мозаики

Чтобы указать ограничение упорядочения доступа к данным между несколькими мозаичными ресурсами, используйте [**ID3D11DeviceContext2:: тиледресаурцебарриер**](/windows/desktop/api/D3D11_2/nf-d3d11_2-id3d11devicecontext2-tiledresourcebarrier).

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Мозаичные ресурсы](tiled-resources.md)
</dt> </dl>

 

 




