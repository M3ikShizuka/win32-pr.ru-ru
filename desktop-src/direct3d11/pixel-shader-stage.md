---
title: Этап шейдера пикселей
description: Этап построителя текстуры (PS) обеспечивает широкие возможности заливки, такие как освещение на уровне пикселов и последующей обработку.
ms.assetid: 09831B10-4FD1-41E7-8D81-5AA63DC90020
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 57142e9c32919a6959a7fac14bf544cca1dacd79
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127566219"
---
# <a name="pixel-shader-stage"></a>Этап шейдера пикселей

Этап построителя текстуры (PS) обеспечивает широкие возможности заливки, такие как освещение на уровне пикселов и последующей обработку. Шейдер пикселей — это программа, объединяющая константные переменные, данные текстур, интерполированные значения вершин и другие данные для получения отдельных пикселей. Этап средства создания программной прорисовки вызывает шейдер пикселей один раз для каждого пикселя, охваченного примитивом, однако можно указать шейдер **null** , чтобы избежать запуска шейдера.

## <a name="the-pixel-shader"></a>Шейдер пикселей

При множественной дискретизации текстуры шейдер пикселей вызывается один раз для каждого охваченного пикселя, а тестирование глубины трафарета выполняется для каждого объекта множественной дискретизации. Образцы которые проходят проверку глубины трафарета, обновляются с использованием выходного цвета шейдера пикселей.

Встроенные функции шейдера пикселей создают или используют производные от количества относительно экранного пространства x и y. Самый распространенный способ использования производных — вычисления уровня детализации для дискретизации текстур, а в случае с анизотропной фильтрацией — выбор образцов по оси анизотропии. Как правило, аппаратная реализации запускает шейдер пикселей на нескольких пикселях (например, в сетке 2x2) одновременно, чтобы производные количества, вычисленные в шейдере, можно было аппроксимировать текстуры как дельты значений в той же точке выполнения в соседних пикселях.

### <a name="inputs"></a>Входные данные

Если конвейер настроен без шейдера геометрии, шейдер текстуры ограничивается 16 32-разрядными и 4-компонентными входными данными. В противном случае шейдер пикселей может принимать до 32 32-разрядных, 4-компонентных входных данных.

Входные данные шейдера пикселей включают атрибуты вершин (которые можно интерполировать с коррекцией перспективы или без нее) или могут рассматриваться как константы примитивов. Входные данные шейдера пикселей интерполируются на основе атрибутов вершин растеризуемого примитива в зависимости от объявленного режима интерполяции. Если примитив обрезается до растеризации, режим интерполяции также учитывается в процессе обрезки.

Атрибуты вершин интерполируются (или оцениваются) в центральных расположениях шейдера пикселей. Режимы интерполяции атрибутов шейдера пикселей указываются в объявлении регистрация входных данных отдельно для каждого элемента в [аргументе](/windows/desktop/direct3dhlsl/dx-graphics-hlsl-function-parameters) или [входной структуре](/windows/desktop/direct3dhlsl/dx-graphics-hlsl-struct). Атрибуты можно интерполяции линейно или с помощью [центроид выборки](https://msdn.microsoft.com/library/Ee415231(v=VS.85).aspx). Центроидная дискретизация учитывается только во время множественной дискретизации, чтобы охватить случаи, когда пиксель покрывается примитивом, а центр пикселя — нет. Центроидная оценка происходит максимально близко к центру пикселя (не охваченного примитивом).

Входные данные также можно объявить с помощью [семантики системного значения](/windows/desktop/direct3dhlsl/dx-graphics-hlsl-semantics), которая помечает параметр, используемый на других этапах конвейера. Например, пиксельное расположение должно быть отмечено семантикой «ОКП» \_ . На этапе IA можно создать один скаляр для построителя текстуры (с помощью SV \_ примитивеид); этап средства прорисовки также может создавать один скаляр для построителя текстуры (с помощью SV \_ исфронтфаце).

### <a name="outputs"></a>Выходные данные

Пиксельный шейдер может вывести до 8 32-разрядных 4-компонентных цветов (если пиксель отклоняется, цвет не предоставляется). Компоненты регистрация выходных данных шейдера пикселей следует объявить перед использованием. У каждого регистра может быть отдельная маска вывода записи.

Используйте состояние глубины-Write-Enable (на стадии слияния), чтобы определить, записываются ли данные глубины в буфер глубины (или используйте инструкцию отмены для удаления данных для этого пикселя). Шейдер пикселей также может выводить необязательный 32-разрядный, 1-компонент, параметр глубины с плавающей запятой для глубокого тестирования (с использованием \_ семантики глубины SV). Значение глубины выводится в регистре oDepth и заменяет интерполированное значение для тестирования глубины (если тестирование глубины включено). Не существует способа для динамического переключения между глубиной с фиксированной функцией и oDepth шейдера.

Шейдер пикселей не может выводить значение трафарета.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Графический конвейер](overviews-direct3d-11-graphics-pipeline.md)
</dt> <dt>

[Этапы конвейера (Direct3D 10)](/windows/desktop/direct3d10/d3d10-graphics-programming-guide-pipeline-stages)
</dt> </dl>

 

 