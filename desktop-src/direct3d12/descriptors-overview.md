---
title: Общие сведения о дескрипторах
description: Дескрипторы создаются вызовами API и определяют ресурсы.
ms.assetid: 64721226-5533-4816-865E-9429032FCC86
ms.localizationpriority: high
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 95cb5834c513b99e737ba8a106ea5303a978751573ffd2ca1a97fb59e385b5ad
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "117733850"
---
# <a name="descriptors-overview"></a>Общие сведения о дескрипторах

Дескрипторы создаются вызовами API и определяют ресурсы.

-   [Данные дескриптора](#descriptor-data)
-   [Дескрипторы дескрипторов](#descriptor-handles)
-   [Дескрипторы null](#null-descriptors)
-   [Дескрипторы по умолчанию](#default-descriptors)
-   [Связанные темы](#related-topics)

## <a name="descriptor-data"></a>Данные дескриптора

Дескриптор — это относительно небольшой блок данных, который полностью описывает объект для GPU в непрозрачном формате, характерном для GPU. Существует несколько различных типов дескрипторов &mdash; отрисовки целевых представлений (RTVs), представлений трафаретов глубины (DSV), представлений ресурсов шейдера (СРВС), неупорядоченных представлений доступа (уавс), представлений постоянного буфера (КБВС) и проб.

Дескрипторы имеют разный размер в зависимости от оборудования GPU. Можно запросить размер SRV, UAV или CBV, вызвав [**ID3D12Device:: жетдескрипторхандлеинкрементсизе**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-getdescriptorhandleincrementsize). Дескрипторы показаны в этой документации как неделимые единицы. Ниже приведен пример.

![SRV, cbv, UAV и образец](images/single-descriptor.png)

Дескрипторы создаются вызовами API и будут включать такие сведения, как ресурс и MIP-карты, которые должен содержать дескриптор.

Драйвер не следит за ссылками на дескрипторы и не хранит ссылки на них. это приложение позволяет убедиться в том, что используется правильный тип и что информация актуальна. Существует одно небольшое исключение для этого; драйвер проверяет привязки целевых объектов прорисовки, чтобы обеспечить правильную работу цепочек обмена.

Дескрипторы объектов не обязательно должны освобождаться или освобождаться. Драйверы не присоединяют выделения для создания дескриптора. Дескриптор, однако, может кодировать ссылки на другие выделения, для которых приложение владеет временем существования. Например, дескриптор для SRV должен содержать виртуальный адрес ресурса D3D (например, текстуру), на который ссылается SRV. Это обязанность приложения, чтобы убедиться, что он не использует дескриптор SRV, когда базовый ресурс D3D, от которого он зависит, был уничтожен или изменен (например, объявлен как нерезидентный).

Основной способ использования дескрипторов заключается в помещении их в кучу дескрипторов, которые являются резервными копиями памяти для дескрипторов.

## <a name="descriptor-handles"></a>Дескрипторы дескрипторов

Дескриптор дескриптора — это уникальный адрес дескриптора. Он похож на указатель, но является непрозрачным, так как его реализация зависит от оборудования. Дескриптор уникален для кучи дескрипторов, поэтому, например, массив дескрипторов может ссылаться на дескрипторы в нескольких кучах.

Дескрипторы ЦП предназначены для немедленного использования, например для копирования, где должны быть идентифицированы источник и назначение. Сразу после использования (например, вызов [**ID3D12GraphicsCommandList:: омсетрендертаржетс**](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-omsetrendertargets)) они могут быть использованы повторно, или их базовая куча может быть удалена.

Дескрипторы GPU не предназначены для немедленного использования &mdash; , они определяют расположения из списка команд для использования во время выполнения GPU. Они должны сохраняться до тех пор, пока все списки команд, ссылающиеся на них, не будут выполнены полностью.

Чтобы создать дескриптор дескриптора для запуска кучи, после создания самой кучи дескрипторов вызовите один из следующих методов.

-   [**ID3D12DescriptorHeap:: Жеткпудескрипторхандлефорхеапстарт**](/windows/desktop/api/d3d12/nf-d3d12-id3d12descriptorheap-getcpudescriptorhandleforheapstart)
-   [**ID3D12DescriptorHeap:: Жетгпудескрипторхандлефорхеапстарт**](/windows/desktop/api/d3d12/nf-d3d12-id3d12descriptorheap-getgpudescriptorhandleforheapstart)

Эти методы возвращают следующие структуры:

-   [**\_ \_ Дескриптор дескриптора ЦП D3D12 \_**](/windows/desktop/api/d3d12/ns-d3d12-d3d12_cpu_descriptor_handle)
-   [**\_Дескриптор D3D12 \_ GPU \_**](/windows/desktop/api/d3d12/ns-d3d12-d3d12_gpu_descriptor_handle)

Поскольку размер дескрипторов зависит от оборудования, для получения инкремента между каждым дескриптором в куче используется:

-   [**ID3D12Device:: Жетдескрипторхандлеинкрементсизе**](/windows/desktop/api/d3d12/nf-d3d12-id3d12device-getdescriptorhandleincrementsize)

Для копирования дескрипторов и передачи дескрипторов в вызовы API можно легко смещать начальное расположение с числом инкрементов. Разыменование маркера необязательно, как если бы он был допустимым указателем ЦП, а также для анализа битов в пределах маркера.

Некоторые вспомогательные структуры были добавлены с элементами инициализации, чтобы упростить управление дескрипторами.

-   [**\_ \_ Дескриптор дескриптора ЦП CD3DX12 \_**](cd3dx12-cpu-descriptor-handle.md)
-   [**\_Дескриптор CD3DX12 \_ GPU \_**](cd3dx12-gpu-descriptor-handle.md)

## <a name="null-descriptors"></a>Дескрипторы null

При создании дескрипторов с помощью вызовов API приложения передают значение NULL для указателя ресурса в определении дескриптора, чтобы при доступе к нему не приходилось обращаться к результату, связанному с шейдером.

Оставшаяся часть дескриптора должна быть заполнена как можно больше. Например, в случае с представлениями ресурсов шейдера (СРВС) дескриптор можно использовать для различения типа представления (Texture1D, Texture2D и т. д.). Числовые параметры в дескрипторе представления, например число MIP-карты, должны быть заданы для значений, допустимых для ресурса.

Во многих случаях существует определенное поведение для доступа к несвязанному ресурсу, например СРВС, возвращающего значения по умолчанию. Они будут учитываться при доступе к дескриптору NULL, если тип доступа шейдера совместим с типом дескриптора. Например, если шейдер ожидает Texture2D SRV и обращается к NULL SRV, определенному как Texture1D, поведение не определено и может привести к сбросу устройства.

В сводке, чтобы создать дескриптор null, передайте `null` параметр предварительного *источника* при создании представления с такими методами, как [**креатешадерресаурцевиев**](/windows/desktop/api/d3d12/nf-d3d12-id3d12device-createshaderresourceview). В параметре описания представления *пдеск* Задайте конфигурацию, которая будет работать, если ресурс не равен null (в противном случае может произойти сбой на определенном оборудовании).

Однако корневые дескрипторы не должны иметь значение null.

На 1 класса оборудовании (см. раздел [**уровни оборудования**](./hardware-support.md)), все дескрипторы, которые привязаны (посредством таблиц дескрипторов), должны быть инициализированы либо как реальные дескрипторы, либо как дескрипторы null, даже если нет доступа к оборудованию, в противном случае поведение не определено.

На партнеров оборудовании это относится к привязанным дескрипторам CBV и UAV, но не к дескрипторам SRV.

На Tier3 оборудовании нет ограничений на это, при условии, что неинициализированные дескрипторы никогда не обращаются.

## <a name="default-descriptors"></a>Дескрипторы по умолчанию

Чтобы создать дескриптор по умолчанию для конкретного представления, передайте в метод создания представления (например, [**креатешадерресаурцевиев**](/windows/win32/api/d3d12/nf-d3d12-id3d12device-createshaderresourceview)) допустимый параметр с предварительным *исходным кодом* , но передайте **значение NULL** для параметра *пдеск* . Например, если ресурс содержал 14 MIPS, то представление будет содержать 14 MIPS. Вариант по умолчанию охватывает наиболее очевидное сопоставление ресурса с представлением. Это требует, чтобы ресурс выделился полным именем формата (например, **DXGI_FORMAT_R8G8B8A8_UNORM_SRGB** , а не **DXGI_FORMAT_R8G8B8A8_TYPELESS**).

Дескрипторы по умолчанию нельзя использовать с представлением структуры ускорения райтраЦинг, так как предоставленный параметр предварительного *источника* должен иметь **значение NULL**, а расположение должно передаваться через [**D3D12_RAYTRACING_ACCELERATION_STRUCTURE_SRV**]/Windows/Win32/API/d3d12/NS-d3d12-d3d12_raytracing_acceleration_structure_srv).

## <a name="related-topics"></a>Связанные темы

[Дескрипторы](descriptors.md)