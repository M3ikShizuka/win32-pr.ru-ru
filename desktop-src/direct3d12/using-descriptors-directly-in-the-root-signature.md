---
title: Использование дескрипторов непосредственно в корневой подписи
description: Чтобы избежать необходимости проходить через кучу дескрипторов, можно разместить дескриптор непосредственно в корневой подписи.
ms.assetid: 033E3D8F-3003-42F7-BF77-68A7D62802E5
ms.localizationpriority: high
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ff9d459f3195a4cf722ea210edbe63e5c1bf3cc8
ms.sourcegitcommit: 170bc12e9724d00cecbb96d57c7226c51e135dee
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/07/2021
ms.locfileid: "113489164"
---
# <a name="using-descriptors-directly-in-the-root-signature"></a><span data-ttu-id="8b6f8-103">Использование дескрипторов непосредственно в корневой подписи</span><span class="sxs-lookup"><span data-stu-id="8b6f8-103">Using descriptors directly in the root signature</span></span>

<span data-ttu-id="8b6f8-104">Чтобы избежать необходимости проходить через кучу дескрипторов, можно разместить дескриптор непосредственно в корневой подписи.</span><span class="sxs-lookup"><span data-stu-id="8b6f8-104">To avoid the need to go through a descriptor heap, you can put a descriptor directly into the root signature.</span></span> <span data-ttu-id="8b6f8-105">Эти дескрипторы занимают много пространства в корневой подписи (см. раздел [ограничения корневых подписей](/windows/win32/direct3d12/root-signature-limits)), поэтому рекомендуется использовать их с осторожностью.</span><span class="sxs-lookup"><span data-stu-id="8b6f8-105">These descriptors take up a lot of space in the root signature (see [Root signature limits](/windows/win32/direct3d12/root-signature-limits)), so we recommend that you use them sparingly.</span></span>

<span data-ttu-id="8b6f8-106">В качестве примера использования можно поместить в корневой макет представление постоянного буфера (CBV), изменяющееся на рисование.</span><span class="sxs-lookup"><span data-stu-id="8b6f8-106">An example usage would be to place in the root layout a constant buffer view (CBV) that is changing per draw.</span></span> <span data-ttu-id="8b6f8-107">Таким образом, пространство кучи дескриптора не должно выделяться приложением на Draw (и сохраняет указатель на таблицу дескрипторов в новом месте в куче дескрипторов).</span><span class="sxs-lookup"><span data-stu-id="8b6f8-107">That's so that descriptor heap space doesn't have to be allocated by the application per draw (and saves pointing a descriptor table at the new location in the descriptor heap).</span></span> <span data-ttu-id="8b6f8-108">Поместив что-либо в корневую подпись, приложение просто переводит ответственность за управление версиями в драйвер; но это инфраструктура, которая уже есть у драйверов.</span><span class="sxs-lookup"><span data-stu-id="8b6f8-108">By putting something in the root signature, the application is merely handing the versioning responsibility to the driver; but that's infrastructure that drivers already have.</span></span>

<span data-ttu-id="8b6f8-109">Для отрисовки, использующей очень незначительное количество ресурсов, использование таблицы или кучи дескриптора может быть ненужным, если все необходимые дескрипторы можно поместить непосредственно в корневую подпись.</span><span class="sxs-lookup"><span data-stu-id="8b6f8-109">For rendering that uses extremely few resources, descriptor table/heap use may not be needed at all if all of the needed descriptors can be placed directly in the root signature.</span></span>

<span data-ttu-id="8b6f8-110">Это единственные Типы дескрипторов, поддерживаемые в корневой подписи.</span><span class="sxs-lookup"><span data-stu-id="8b6f8-110">These are the only types of descriptors supported in the root signature.</span></span>

- <span data-ttu-id="8b6f8-111">Представление буфера констант (КБВС).</span><span class="sxs-lookup"><span data-stu-id="8b6f8-111">Constant buffer view (CBVs).</span></span>
- <span data-ttu-id="8b6f8-112">Представления ресурсов шейдера (СРВС)/неупорядоченные представления доступа (Уавс) буферных ресурсов, в которых преобразование формата не требуется (нетипизированные буферы).</span><span class="sxs-lookup"><span data-stu-id="8b6f8-112">Shader resource views (SRVs) / unordered access views (UAVs) of buffer resources where format conversion is not required (untyped buffers).</span></span> <span data-ttu-id="8b6f8-113">Некоторые примеры нетипизированных буферов, которые можно привязать к корневым дескрипторам, `StructuredBuffer<type>` включают `RWStructuredBuffer<type>` , `ByteAddressBuffer` и `RWByteAddressBuffer` .</span><span class="sxs-lookup"><span data-stu-id="8b6f8-113">Some examples of untyped buffers that can be bound with root descriptors include `StructuredBuffer<type>`, `RWStructuredBuffer<type>`, `ByteAddressBuffer` and `RWByteAddressBuffer`.</span></span> <span data-ttu-id="8b6f8-114">Типизированные буферы, такие как `Buffer<uint>` и, `Buffer<float2>` не могут.</span><span class="sxs-lookup"><span data-stu-id="8b6f8-114">Typed buffers such as `Buffer<uint>` and `Buffer<float2>` can't.</span></span>
- <span data-ttu-id="8b6f8-115">СРВС структуры ускорения райтраЦинг в локальных и глобальных корневых сигнатурах.</span><span class="sxs-lookup"><span data-stu-id="8b6f8-115">SRVs of raytracing acceleration structures, in local or global root signatures.</span></span> 

<span data-ttu-id="8b6f8-116">С UAV в корне не могут сопоставлены счетчики.</span><span class="sxs-lookup"><span data-stu-id="8b6f8-116">A UAV in the root cannot have counters associated with it.</span></span> <span data-ttu-id="8b6f8-117">Дескрипторы в корневой подписи отображаются каждый как отдельные отдельные дескрипторы, &mdash; которые они не могут динамически индексировать.</span><span class="sxs-lookup"><span data-stu-id="8b6f8-117">Descriptors in the root signature appear each as individual separate descriptors&mdash;they cannot be dynamically indexed.</span></span>

``` syntax
struct SceneData
{
   uint foo;
   float bar[2];
   int moo;
};
ConstantBuffer<SceneData> mySceneData : register(b6);
```

<span data-ttu-id="8b6f8-118">В приведенном выше примере `mySceneData` не может быть объявлен как массив, как в `cbuffer mySceneData[2]` случае, если он будет сопоставлен с дескриптором в корневой сигнатуре.</span><span class="sxs-lookup"><span data-stu-id="8b6f8-118">In the above example, `mySceneData` can't be declared as an array, as in `cbuffer mySceneData[2]` if it is going to be mapped onto a descriptor in the root signature.</span></span> <span data-ttu-id="8b6f8-119">Это обусловлено тем, что индексирование в дескрипторах не поддерживается в корневой подписи.</span><span class="sxs-lookup"><span data-stu-id="8b6f8-119">That's because indexing across descriptors isn't supported in the root signature.</span></span> <span data-ttu-id="8b6f8-120">При необходимости можно определить отдельные отдельные буферы констант и определить их каждую как отдельную запись в корневой подписи.</span><span class="sxs-lookup"><span data-stu-id="8b6f8-120">If desired, you can define separate individual constant buffers, and define them each as a separate entry in the root signature.</span></span> <span data-ttu-id="8b6f8-121">Обратите внимание, что в `mySceneData` приведенном выше примере имеется массив `bar[2]` .</span><span class="sxs-lookup"><span data-stu-id="8b6f8-121">Note that within `mySceneData` above, there is an array `bar[2]`.</span></span> <span data-ttu-id="8b6f8-122">Динамическое индексирование в буфере константы является допустимым, &mdash; так как дескриптор в корневой подписи работает так же, как и тот же дескриптор, что и при доступе через кучу дескрипторов.</span><span class="sxs-lookup"><span data-stu-id="8b6f8-122">Dynamic indexing within the constant buffer is valid&mdash;a descriptor in the root signature behaves just like the same descriptor would behave if it were accessed through a descriptor heap.</span></span> <span data-ttu-id="8b6f8-123">Это отличается от констант встраивания непосредственно в корневую сигнатуру, которая также выглядит как буфер констант, за исключением того, что динамическое индексирование внутри встроенных констант не разрешено, поэтому `bar[2]` было бы запрещено.</span><span class="sxs-lookup"><span data-stu-id="8b6f8-123">This is in contrast with inlining constants directly in the root signature, which also appears like a constant buffer, except with the constraint that dynamic indexing within the inlined constants is not permitted, so `bar[2]` wouldn't be allowed there.</span></span>

<span data-ttu-id="8b6f8-124">Эти API-интерфейсы (из интерфейса [**ID3D12GraphicsCommandList**](/windows/win32/api/d3d12/nn-d3d12-id3d12graphicscommandlist) ) предназначены для установки дескрипторов непосредственно в корневой подписи.</span><span class="sxs-lookup"><span data-stu-id="8b6f8-124">These APIs (from the [**ID3D12GraphicsCommandList**](/windows/win32/api/d3d12/nn-d3d12-id3d12graphicscommandlist) interface) are for setting descriptors directly on the root signature.</span></span>

-   [<span data-ttu-id="8b6f8-125">**SetComputeRootConstantBufferView**</span><span class="sxs-lookup"><span data-stu-id="8b6f8-125">**SetComputeRootConstantBufferView**</span></span>](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-setcomputerootconstantbufferview)
-   [<span data-ttu-id="8b6f8-126">**SetGraphicsRootConstantBufferView**</span><span class="sxs-lookup"><span data-stu-id="8b6f8-126">**SetGraphicsRootConstantBufferView**</span></span>](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-setgraphicsrootconstantbufferview)
-   [<span data-ttu-id="8b6f8-127">**SetComputeRootShaderResourceView**</span><span class="sxs-lookup"><span data-stu-id="8b6f8-127">**SetComputeRootShaderResourceView**</span></span>](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-setcomputerootshaderresourceview)
-   [<span data-ttu-id="8b6f8-128">**SetGraphicsRootShaderResourceView**</span><span class="sxs-lookup"><span data-stu-id="8b6f8-128">**SetGraphicsRootShaderResourceView**</span></span>](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-setgraphicsrootshaderresourceview)
-   [<span data-ttu-id="8b6f8-129">**SetComputeRootUnorderedAccessView**</span><span class="sxs-lookup"><span data-stu-id="8b6f8-129">**SetComputeRootUnorderedAccessView**</span></span>](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-setcomputerootunorderedaccessview)
-   [<span data-ttu-id="8b6f8-130">**SetGraphicsRootUnorderedAccessView**</span><span class="sxs-lookup"><span data-stu-id="8b6f8-130">**SetGraphicsRootUnorderedAccessView**</span></span>](/windows/win32/api/d3d12/nf-d3d12-id3d12graphicscommandlist-setgraphicsrootunorderedaccessview)

> [!NOTE]  
> <span data-ttu-id="8b6f8-131">В Direct3D 12 нет концепции *корневого массива дескрипторов* .</span><span class="sxs-lookup"><span data-stu-id="8b6f8-131">There's no concept of a *root descriptor array* in Direct3D 12.</span></span> <span data-ttu-id="8b6f8-132">Массивы дескрипторов поддерживаются только в кучах дескрипторов.</span><span class="sxs-lookup"><span data-stu-id="8b6f8-132">Descriptor arrays are supported only in descriptor heaps.</span></span>

## <a name="related-topics"></a><span data-ttu-id="8b6f8-133">Связанные темы</span><span class="sxs-lookup"><span data-stu-id="8b6f8-133">Related topics</span></span>

* [<span data-ttu-id="8b6f8-134">Корневые подписи</span><span class="sxs-lookup"><span data-stu-id="8b6f8-134">Root signatures</span></span>](root-signatures.md)
