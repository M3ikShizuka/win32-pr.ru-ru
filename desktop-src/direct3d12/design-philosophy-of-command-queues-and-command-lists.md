---
title: Проектирование философии очередей команд и списков команд
description: Цели, позволяющие повторно использовать работу по отрисовке и многопоточное масштабирование, требуют фундаментальных изменений в том, как приложения Direct3D отправляют данные визуализации в GPU.
ms.assetid: C85C8C41-2306-4568-8FAE-F57EDA624298
keywords:
- Список команд
- bundle
ms.localizationpriority: high
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e08f996f3de54b63668d44122929feb4fdbef4380fb8b2f7bb1458f50fe274ef
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119124222"
---
# <a name="design-philosophy-of-command-queues-and-command-lists"></a>Проектирование философии очередей команд и списков команд

Цели, позволяющие повторно использовать работу по отрисовке и многопоточное масштабирование, требуют фундаментальных изменений в том, как приложения Direct3D отправляют данные визуализации в GPU. В Direct3D 12 процесс отправки работы по отрисовке отличается от более ранних версий тремя важными способами:

<dl> 1. Исключение непосредственных контекстов. Это позволяет создавать многопоточность.  
2. Теперь приложения владеют тем, как вызовы отрисовки группируются в рабочие элементы графического процессора. Это позволяет повторно использовать.  
3. Теперь приложения явно управляют отправкой работы в GPU. Это позволяет элементам 1 и 2.  
</dl>

-   [Удаление непосредственных контекстов](#removal-of-the-immediate-context)
-   [Группирование рабочих элементов GPU](#grouping-of-gpu-work-items)
-   [Отправка работы GPU](#gpu-work-submission)
-   [Связанные темы](#related-topics)

## <a name="removal-of-the-immediate-context"></a>Удаление непосредственных контекстов

Самым большим изменением с Microsoft Direct3D 11 до Microsoft Direct3D 12 является отсутствие единственного немедленного контекста, связанного с устройством. Вместо этого для подготовки к просмотру приложения создают списки команд, в которых можно вызывать традиционные API-интерфейсы отрисовки. Список команд выглядит аналогично методу Render приложения Direct3D 11, который использовал непосредственный контекст в том, что он содержит вызовы, которые рисуют примитивы или меняют состояние отрисовки. Как и в случае с непосредственными контекстами, каждый список команд не является потокобезопасным. Однако несколько списков команд можно записать одновременно, что позволяет использовать современные, многоядерные процессоры.

Списки команд обычно выполняются один раз. Однако список команд может быть выполнен несколько раз, если приложение гарантирует завершение предыдущих выполнений перед отправкой новых выполнений. Дополнительные сведения о синхронизации списка команд см. в разделе [исполнение и синхронизация списков команд](executing-and-synchronizing-command-lists.md).

## <a name="grouping-of-gpu-work-items"></a>Группирование рабочих элементов GPU

В дополнение к спискам команд Direct3D 12 использует преимущества функций, имеющихся на всех устройствах, за счет добавления второго уровня списков команд, называемых *пакетами*. Чтобы отличить эти два типа, списки команд первого уровня могут называться *прямыми списками команд*. Назначение пакетов состоит в том, чтобы разрешить приложениям группировать небольшое количество команд API для последующего повторного выполнения в списках прямых команд. Во время создания пакета драйвер выполняет как можно более предварительную обработку, чтобы повысить эффективность выполнения. Пакеты могут быть выполнены из нескольких списков команд и несколько раз в одном списке команд.

Повторное использование пакетов — это большой фактор повышения эффективности работы с одними потоками ЦП. Поскольку пакеты предварительно обрабатываются и могут быть отправлены несколько раз, существуют определенные ограничения на операции, которые могут быть выполнены в пакете. Дополнительные сведения см. в разделе [Создание и запись списков команд и пакетов](recording-command-lists-and-bundles.md).

## <a name="gpu-work-submission"></a>Отправка работы GPU

Для выполнения работы с GPU приложение должно явно отправить список команд в очередь команд, связанную с устройством Direct3D. Прямой список команд может быть отправлен для выполнения несколько раз, но приложение несет ответственность за проверку того, что список прямых команд завершил выполнение на GPU, прежде чем отправлять его снова. Пакеты не имеют ограничений на параллельное использование и могут выполняться несколько раз в нескольких списках команд, но пакеты не могут быть непосредственно переданы в очередь команд для выполнения.

Любой поток может отправить список команд в любую очередь команд в любое время, и среда выполнения будет автоматически выполнять сериализацию списка команд в очередь команд при сохранении порядка отправки.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Отправка работы в Direct3D 12](command-queues-and-command-lists.md)
</dt> </dl>

 

 




