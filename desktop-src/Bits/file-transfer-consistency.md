---
title: Согласованность при обмене файлами
description: Служба BITS гарантирует, что версия переданного файла будет согласована в зависимости от размера файла и метки времени, а не от содержимого (BITS не защищает от атак типа "злоумышленник в середине").
ms.assetid: ba82f172-a3ac-49d6-bccd-7d0b68ba66de
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 533bc0c0db9708528d4ae919572d6e4c1d251ac8
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "103887712"
---
# <a name="file-transfer-consistency"></a>Согласованность при обмене файлами

Служба BITS гарантирует, что версия переданного файла будет согласована в зависимости от размера файла и метки времени, а не от содержимого (BITS не защищает от атак типа "злоумышленник в середине"). Чтобы проверить содержимое самостоятельно, можно использовать метод [**IBackgroundCopyFile3:: жеттемпораринаме**](/windows/desktop/api/Bits3_0/nf-bits3_0-ibackgroundcopyfile3-gettemporaryname) , чтобы получить имя файла, содержащего скачанное содержимое, проверить содержимое с помощью собственного механизма, а затем вызвать метод [**IBackgroundCopyFile3:: сетвалидатионстате**](/windows/desktop/api/Bits3_0/nf-bits3_0-ibackgroundcopyfile3-setvalidationstate) , чтобы указать BITS, если содержимое файла является допустимым. Если для состояния проверки задано **значение false** и содержимое находится с сервера-источника, задание переходит в состояние ошибки. Если содержимое помещается из однорангового узла, BITS загружает его с сервера-источника.

При загрузке, если размер файла или отметка времени изменяется во время передачи файла службой BITS, BITS перезапускает передачу только этого файла. Например, если задание загрузки содержит два файла и файлы обновляются на сервере, а BITS перемещает второй файл, BITS перезапускает передачу только второго файла. Первый файл, который уже успешно передавался, не обновляется в соответствии с новыми изменениями.

Обратите внимание, что если вы владеете файлом, загружаемым с сервера, необходимо создать новый URL-адрес для каждой новой версии файла. Если для новых версий файла используется один и тот же URL-адрес, некоторые прокси-серверы могут обрабатывать устаревшие данные из кэша, так как они не проверяют исходный сервер, если он устарел.

Для отправки, если размер файла или отметка времени изменяется во время передачи файла, BITS выдает ошибку, а задание помещается в \_ состояние ошибки задания BG \_ \_ .

Служба BITS не синхронизирует запросы на передачу, когда один или несколько пользователей запрашивают передачу одного и того же файла в одно и то же расположение. BITS передает файл для каждого запроса отдельно.

 

 




