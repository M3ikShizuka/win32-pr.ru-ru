---
title: Настройка разрешений для виртуальных каталогов
description: По соображениям безопасности фоновая интеллектуальная служба передачи (BITS) не передает файлы в виртуальный каталог с включенными разрешениями сценариев и выполнения.
ms.assetid: cf5c8b50-066f-431e-8bdf-ed0692219b20
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 71b08f4dd7435c9afc28f1a4401f01ad196b1b8d2a1394d4998634f70b750434
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118173256"
---
# <a name="setting-permissions-on-virtual-directories"></a>Настройка разрешений для виртуальных каталогов

По соображениям безопасности фоновая интеллектуальная служба передачи (BITS) не передает файлы в виртуальный каталог с включенными разрешениями сценариев и выполнения. Если вы отправите файл в виртуальный каталог, в котором включены эти разрешения, задание завершится с кодом ошибки BG \_ E \_ Server \_ Executed \_ .

Для BITS не требуется, чтобы виртуальный каталог был разрешен записью, поэтому рекомендуется отключить доступ на запись к виртуальному каталогу.

Прошедший проверку подлинности пользователь (или анонимный пользователь IIS для анонимной проверки подлинности) должен иметь разрешения на изменение физического каталога, с которым сопоставлен виртуальный каталог; предоставление разрешений на запись не является достаточным.

## <a name="specifying-permissions-for-notifications"></a>Указание разрешений для уведомлений

Схема проверки подлинности, указанная для виртуального каталога и URL-адреса уведомления (см. свойство [битссервернотификатионурл](bits-iis-extension-properties.md) ), должна быть совместимой. Служба BITS использует схему проверки подлинности, указанную для виртуального каталога, для доступа к URL-адресу уведомления. Задание отправки завершается сбоем, если службе BITS не удается получить доступ к URL-адресу уведомления из-за ошибки проверки подлинности.

Если тип уведомления (см. свойство [битссервернотификатионтипе](bits-iis-extension-properties.md) ) указан [по ссылке](using-bits-notification-request-response-headers.md), приложение должно обеспечить доступ пользователя к файлу, на который указывает ссылка (см. заголовок [File-Request--Name](notification-protocol-for-server-applications.md) ). Служба BITS устанавливает списки ACL для упоминаемого файла в соответствии с физическим каталогом, с которым сопоставлен виртуальный каталог.

> [!Note]  
> Приложение с уведомлением должно иметь возможность сопоставлять и обращаться к удаленному файлу, даже если URL-адрес уведомления обслуживается веб-сервером, расположенным на компьютере, отличном от физического каталога передачи. Заголовок [BITS-Request-File-Name](notification-protocol-for-server-applications.md) всегда содержит спецификацию пути относительно компьютера, на котором размещен компонент расширений BITS. Приложению, выполняющемуся на другом компьютере, может потребоваться преобразовать путь в UNC-путь, прежде чем обращаться к нему.

 

Служба BITS поддерживает множество сочетаний схем проверки подлинности. Тем не менее следует использовать следующую схему проверки подлинности для виртуального каталога и URL-адреса уведомления сопоставления.

-   Для поддержки уведомлений по ссылке виртуальный каталог должен быть настроен на использование проверки подлинности NTLM (Negotiate), если физический каталог передачи (каталог, на который указывает виртуальный каталог) использует схему проверки подлинности, отличную от Anonymous. Если физический каталог отправки разрешает анонимные запросы (без проверки подлинности), виртуальный каталог должен включать анонимный режим (без проверки подлинности).

    Списки ACL в каталоге физической передачи должны быть установлены таким, чтобы прошедший проверку подлинности пользователь мог считывать файлы в каталоге, на который указывает URL-адрес уведомления. Служба BITS использует списки ACL для физического каталога передачи, чтобы задать списки управления доступом для временного файла отправки (заголовок [BITS-Request-File-Name](notification-protocol-for-server-applications.md) содержит путь к временному файлу).

-   Так как для уведомлений [по значению](using-bits-notification-request-response-headers.md) не требуется, чтобы приложение с уведомлением получало доступ к временному файлу, содержащему содержимое передачи, схема проверки подлинности может быть анонимной или согласованной (NTLM). Единственное требование заключается в том, что прошедший проверку подлинности пользователя для виртуального каталога также должен быть разрешен доступ к URL-адресу уведомления.

## <a name="specifying-permissions-for-remote-shares"></a>Указание разрешений для удаленных общих папок

Виртуальный каталог может указывать на сопоставленный диск на другом компьютере или в общей сетевой папке. Если он указывает на сопоставленный сетевой диск, учетные данные, используемые для сопоставления диска, должны иметь полный контроль над удаленной общей папкой.

если виртуальный каталог указывает на общую сетевую папку, служба BITS использует Подключение виртуального каталога в **качестве** учетных данных пользователя для доступа к удаленной общей папке. для доступа к удаленному общему ресурсу учетная запись **Подключение как** должна иметь привилегии, как описано в документации по функции [**LogonUser**](/windows/desktop/api/winbase/nf-winbase-logonusera) . Служба BITS выполняет вход в систему с использованием LOGON32 входа в систему \_ \_ или с LOGON32 \_ входом в \_ интерактивном режиме входа. **Подключение в качестве** учетной записи пользователя требуется Full-Access разрешения на удаленную общую папку; предоставление разрешений на запись не является достаточным.

когда физический каталог отправки сопоставляется с общей сетевой папкой, удостоверение вызывающего объекта, запрашивающего URL-адрес уведомления, — это либо **Подключение в качестве** пользователя, либо прошедший проверку подлинности пользователь в каталоге физической передачи (доступен только в IIS 6,0 и более поздних версиях, если флажок **всегда использовать учетные данные пользователя, прошедшего проверку подлинности при проверке доступа к сетевому Подключение ресурсу** 

 

 