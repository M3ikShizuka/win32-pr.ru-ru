---
title: Учетные записи служб и службы BITS
description: Для передачи файлов из службы можно использовать службу BITS. Служба должна использовать системную учетную запись LocalSystem, LocalService или NetworkService. Эти учетные записи всегда входят в систему. Поэтому всегда выполняются задания, отправленные службой с помощью этих учетных записей.
ms.assetid: 43fb58d6-3a99-488f-ab43-dbb4a794fc2f
keywords:
- БИТЫ учетных записей служб
- БИТЫ задания передачи, владение, учетная запись службы
- БИТЫ прокси-сервера, учетные записи служб
- учетные данные для передачи битов задания
ms.topic: article
ms.date: 10/04/2018
ms.openlocfilehash: a996471afefb00b0dea87b07f477f5cab2fd29352c567dc9182fcf28fa5b168a
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118679906"
---
# <a name="service-accounts-and-bits"></a>Учетные записи служб и службы BITS

Для передачи файлов из службы можно использовать службу BITS. Служба должна использовать системную учетную запись LocalSystem, LocalService или NetworkService. Эти учетные записи всегда входят в систему. Поэтому всегда выполняются задания, отправленные службой с помощью этих учетных записей.

Если служба, работающая под системной учетной записью, олицетворяет пользователя перед вызовом BITS, служба BITS реагирует так же, как для любой учетной записи пользователя (например, пользователь должен войти на компьютер для выполнения передачи). Служба должна также использовать динамическую маскировку с указателями интерфейса BITS при олицетворении пользователя. Маскировка не наследуется, поэтому необходимо вызвать функцию [**CoSetProxyBlanket**](/windows/win32/api/combaseapi/nf-combaseapi-cosetproxyblanket) для каждого указателя интерфейса, полученного из битов (например, указатель задания, возвращаемый из вызова метода [**Ибаккграундкопиманажер:: CreateJob**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopymanager-createjob) ); Установка маскировки на указатель интерфейса диспетчера недостаточна. Можно также вызвать функцию [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) для процесса вместо вызова функции **CoSetProxyBlanket** для каждого указателя интерфейса.

Однако если служба не олицетворяет пользователя, применяются следующие варианты поведения.

- Задания, созданные учетной записью службы, принадлежат этой учетной записи. Поскольку системные учетные записи всегда входят в систему, служба BITS передает файлы при условии, что компьютер работает и имеется сетевое подключение.
- Системные учетные записи не должны использовать сопоставленные буквы сетевого диска, так как буквы дисков относятся только к сеансу, а сопоставление может быть потеряно после перезагрузки компьютера.
- При отсутствии [вспомогательного токена](helper-tokens-for-bits-transfer-jobs.md)сетевая аутентификация использует учетные данные компьютера для учетных записей LocalSystem и NetworkService, а также анонимные учетные данные для учетной записи LocalService. Служба BITS возвращает значение "отказано в доступе", если список управления доступом (ACL) для исходного файла ограничивает доступ к учетной записи пользователя.
- Дополнительные сведения о работе проверки подлинности при наличии [вспомогательного токена](helper-tokens-for-bits-transfer-jobs.md)см. в разделе [Проверка подлинности](authentication.md).
- Параметры прокси-сервера Microsoft Internet Explorer хранятся для каждого пользователя и не задаются для системных учетных записей. Рассмотрите возможность настройки вспомогательного токена для заданий BITS или явное задание правильных параметров прокси-сервера путем вызова метода [**использованием метода ibackgroundcopyjob:: SetProxySettings**](/windows/desktop/api/Bits/nf-bits-ibackgroundcopyjob-setproxysettings) с **\_ \_ \_ \_ переопределением использования прокси-сервера задания BG**. Кроме того, для настройки параметров прокси-сервера Internet Explorer для системной учетной записи LocalSystem, LocalService или NetworkService можно использовать параметры BitsAdmin.exe **/Сетиепрокси/утил** . Дополнительные сведения см. в разделе [средство битсадмин](bitsadmin-tool.md).

Обратите внимание, что служба BITS не распознает параметры прокси-сервера, заданные с помощью файла Proxycfg.exe.