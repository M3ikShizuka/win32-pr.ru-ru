---
title: Компилятор сообщений (MC.exe)
description: Используется для компиляции манифестов инструментирования и текстовых файлов сообщений.
ms.assetid: f9de35f1-6d31-4f4b-b2c4-8474d6fce9e0
keywords:
- Журнал компилятора сообщений (MC.exe)
topic_type:
- apiref
api_name:
- Message Compiler (MC.exe)
api_type:
- NA
ms.topic: reference
ms.date: 06/03/2020
ms.openlocfilehash: 1ba213a1d7047b61ba7ba875adf9c281726eaae123ae018aea9920050b201644
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119470944"
---
# <a name="message-compiler-mcexe"></a>Компилятор сообщений (MC.exe)

Используется для компиляции манифестов инструментирования и текстовых файлов сообщений. Компилятор создает файлы ресурсов сообщений, на которые ссылается приложение.

``` syntax
MC [-?aAbcdnouUv] [-m <length>] [-h <path>] [-e <extension>] [-r <path>]
   [-x <path>] [-w <file>] [-W <file>] [-z <basename> ] [-cp <encoding>]
   [-km | -um | -generateProjections | -cs <namespace>]
   [-mof] [-p <prefix>] [-P <prefix>]
   [<filename.man>] [<filename.mc>]
```

-   [Аргументы, общие для текстовых файлов сообщений и файлов манифеста](#arguments-common-to-both-message-text-files-and-manifest-files)
-   [Аргументы, относящиеся к файлам манифеста](#arguments-specific-to-manifest-files)
-   [Аргументы, относящиеся к генерированию кода, который поставщик будет использовать для регистрации событий](#arguments-specific-to-generating-code-that-your-provider-would-use-to-log-events)
-   [Аргументы, относящиеся к текстовым файлам сообщений](#arguments-specific-to-message-text-files)

## <a name="arguments-common-to-both-message-text-files-and-manifest-files"></a>Аргументы, общие для текстовых файлов сообщений и файлов манифеста

<dl> <dt>

<span id="-_"></span>**-?**
</dt> <dd>

Отображает сведения об использовании компилятора сообщений.

</dd> <dt>

<span id="-c"></span><span id="-C"></span>**-c**
</dt> <dd>

Используйте этот аргумент, чтобы задать для компилятора бит клиента (бит 28) во всех идентификаторах сообщений. Сведения о разряде клиента см. в файле Winerror. h.

</dd> <dt>

<span id="-cp"></span><span id="-CP"></span>**-CP** *кодирование*
</dt> <dd>

Используйте этот аргумент, чтобы указать кодировку символов, используемую для всех созданных текстовых файлов. Допустимые имена: "ANSI" (по умолчанию), "UTF-8" и "UTF-16". В кодировках Юникода будет добавлена метка порядка байтов.

</dd> <dt>

<span id="-e_extension"></span><span id="-E_EXTENSION"></span>**-e** , *расширение*
</dt> <dd>

Используйте этот аргумент, чтобы указать расширение, используемое для файла заголовка. Можно указать до трех символов, не включая точку. Значение по умолчанию —. h.

</dd> <dt>

<span id="-h_path"></span><span id="-H_PATH"></span>**-h** *путь*
</dt> <dd>

Используйте этот аргумент, чтобы указать папку, в которую компилятор должен поместить созданный файл заголовка. Значением по умолчанию является текущий каталог.

</dd> <dt>

<span id="-m_length"></span><span id="-M_LENGTH"></span>**-m** *Длина*
</dt> <dd>

Используйте этот аргумент, чтобы компилятор создавал предупреждение, если длина любого сообщения превышает *длину* символов.

</dd> <dt>

<span id="-r_path"></span><span id="-R_PATH"></span>**-r** *путь*
</dt> <dd>

Используйте этот аргумент, чтобы указать папку, в которую компилятор должен поместить созданный скрипт компилятора ресурсов (RC-файл) и созданные файлы bin (двоичные ресурсы), включаемые в скрипт компилятора ресурсов. Значением по умолчанию является текущий каталог.

</dd> <dt>

<span id="-z_name"></span><span id="-Z_NAME"></span>**-z** *имя*
</dt> <dd>

Используйте этот аргумент, чтобы переопределить базовое имя по умолчанию, используемое компилятором для создаваемых им файлов. По умолчанию используется базовое имя входного файла *имени* файла.

</dd> <dt>

<span id="filename"></span><span id="FILENAME"></span>*файлов*
</dt> <dd>

Файл манифеста инструментирования или текстовый файл сообщения. Файл должен находиться в текущем каталоге. Можно указать файл манифеста, текстовый файл сообщения или и то, и другое. Имя файла должно включать расширение. Соглашение заключается в использовании расширения. Man для файлов манифеста и расширения MC для текстовых файлов сообщений.

</dd> </dl>

### <a name="arguments-specific-to-manifest-files"></a>Аргументы, относящиеся к файлам манифеста

<dl> <dt>

<span id="-s_path"></span><span id="-S_PATH"></span>**-s** *путь*
</dt> <dd>

Используйте этот аргумент для создания базового плана инструментирования. Укажите путь к папке, содержащей файлы базового манифеста. Для последующих выпусков следует использовать аргумент **-t** для проверки нового манифеста в соответствии с базовыми показателями проблем совместимости.

**До версии MC 1.12.7051:** Недоступно

</dd> <dt>

<span id="-t_path"></span><span id="-T_PATH"></span>**-t** *путь*
</dt> <dd>

Используйте этот аргумент при создании новой версии манифеста и необходимости его проверки на совместимость приложений с базовыми показателями, созданными с помощью аргумента **-s** . Путь должен указывать на папку, содержащую. Файлы BIN, созданные базовой операцией (см. параметр **-s** ).

**До версии MC 1.12.7051:** Недоступно

</dd> <dt>

<span id="-w_path"></span><span id="-W_PATH"></span>**-w** *путь*
</dt> <dd>

Компилятор игнорирует этот аргумент и автоматически проверяет манифест.

**До версии MC 1.12.7051:** Используйте этот аргумент, чтобы указать папку, содержащую файл схемы Events. xsd, который компилятор использует для проверки манифеста. Windows SDK включает файл схемы events. xsd в \\ папку Include. Если этот аргумент не указан, компилятор не проверяет манифест.

</dd> <dt>

<span id="-W_path"></span><span id="-w_path"></span><span id="-W_PATH"></span>**-W** *путь*
</dt> <dd>

Компилятор игнорирует этот аргумент.

**До версии MC 1.12.7051:** Используйте этот аргумент, чтобы указать папку, содержащую файл Winmeta.xml. Файл Winmeta.xml содержит распознаваемые типы входных и выходных данных, а также стандартные каналы, уровни и коды операций. Windows SDK включает файл Winmeta.xml в \\ папку Include.

</dd> </dl>

### <a name="arguments-specific-to-generating-code-that-your-provider-would-use-to-log-events"></a>Аргументы, относящиеся к генерированию кода, который поставщик будет использовать для регистрации событий

Следующие аргументы компилятора можно использовать для создания кода режима ядра или пользовательского режима, который можно использовать для записи событий в журнал. можно также запросить создание кода компилятором для поддержки записи событий на компьютерах до Windows Vista. Если приложение написано на C#, компилятор может создать класс C#, который можно использовать для регистрации событий. эти аргументы доступны начиная с версии MC 1.12.7051, которая поставляется с версией пакета SDK для windows Windows 7.

<dl> <dt>

<span id="-co"></span><span id="-CO"></span>**-Co**
</dt> <dd>

Используйте этот аргумент, чтобы служба ведения журнала вызывала определяемую пользователем функцию для каждого события, которое вы регистрируете (функция вызывается после регистрации события). Определяемая пользователем функция должна иметь следующую сигнатуру.


```C++
VOID
pFnUserFunction(
    __in REGHANDLE RegHandle,
    __in PCEVENT_DESCRIPTOR Descriptor,
    __in ULONG EventDataCount,
    __in_ecount(EventDataCount) PEVENT_DATA_DESCRIPTOR EventData
    );
```



В код необходимо также включить следующую директиву.

`#define MCGEN_CALLOUT pFnUserFunction`

Чтобы избежать проблем с ведением журнала, следует использовать максимально короткий способ реализации. служба больше не будет регистрировать события до тех пор, пока функция не вернет значение.

Этот аргумент можно использовать с аргументом **-км** или **-UM** .

</dd> <dt>

<span id="-cs_namespace"></span><span id="-CS_NAMESPACE"></span>**—** *пространство имен* CS
</dt> <dd>

Используйте этот аргумент, чтобы компилятор создавал класс C# на основе класса .NET 3,5 [EventProvider](/dotnet/api/system.diagnostics.eventing.eventprovider?view=netframework-3.5&preserve-view=true) .

</dd> <dt>

<span id="-css_namespace"></span><span id="-CSS_NAMESPACE"></span>**-** *пространство имен* CSS
</dt> <dd>

Используйте этот аргумент, чтобы компилятор создавал статический класс C# на основе класса .NET 3,5 [EventProvider](/dotnet/api/system.diagnostics.eventing.eventprovider?view=netframework-3.5&preserve-view=true) .

</dd> <dt>

<span id="-km"></span><span id="-KM"></span>**-км**
</dt> <dd>

Используйте этот аргумент, чтобы компилятор создавал код режима ядра, который будет использоваться для записи в журнал событий, определенных в манифесте.

</dd> <dt>

<span id="-mof"></span><span id="-MOF"></span>**-MOF**
</dt> <dd>

Не рекомендуется. используйте этот аргумент, чтобы компилятор создавал код, который можно использовать для регистрации событий на компьютерах до Windows Vista. Этот параметр также создает MOF-файл, содержащий классы MOF для каждого события, определенного в манифесте. Чтобы зарегистрировать классы в MOF-файле, чтобы потребители могли декодировать события, используйте компилятор MOF (Mofcomp.exe). Дополнительные сведения об использовании компилятора MOF см. в разделе [MOF-файл](/windows/desktop/WmiSdk/managed-object-format--mof-).

Чтобы использовать этот параметр, необходимо соблюдать следующие ограничения.

-   Каждое определение события должно включать атрибуты Task и opcode.
-   Каждая задача должна включать атрибут Евентгуид
-   Данные шаблона, на которые ссылается событие, не могут содержать:
    -   Элементы данных, указывающие типы ввода Win: binary или Win: SYSTEMTIME
    -   Структуры
    -   Массивы переменного размера; Однако можно указать массивы фиксированной длины.
    -   Строковые типы данных не могут задавать атрибут длины

Этот аргумент необходимо использовать с аргументом **-UM**, **-CS**, **-CSS** или **-км** .

</dd> <dt>

<span id="-p_prefix"></span><span id="-P_PREFIX"></span>**-p** , *префикс*
</dt> <dd>

Используйте этот аргумент, чтобы переопределить префикс по умолчанию, используемый компилятором для имен макросов и имен методов в журнале. Префикс по умолчанию — "EventWrite". Строка обрабатывается с учетом регистра.

Этот аргумент можно использовать с аргументом **-UM**, **-CS**, **-CSS** или **-км** .

</dd> <dt>

<span id="-P_prefix"></span><span id="-p_prefix"></span><span id="-P_PREFIX"></span>**-P** , *префикс*
</dt> <dd>

Используйте этот аргумент, чтобы удалить символы из начала символического имени, указанного для события. При сравнении регистр не учитывается. Компилятор использует символьное имя для формирования имен макросов и имен методов.

По умолчанию для макроса ведения журнала используется имя EventWrite *симболнаме*, где *симболнаме* — это символьное имя, указанное для события. Например, если задать для атрибута Symbol события значение Принтерконнектион, то имя макроса будет Евентвритепринтерконнектион. Чтобы удалить принтер из имени, используйте параметр **-P** **Printer**, который приводит к евентвритеконнектион.

Этот аргумент можно использовать с аргументом **-UM**, **-CS**, **-CSS** или **-км** .

</dd> <dt>

<span id="-um"></span><span id="-UM"></span>**-UM**
</dt> <dd>

Используйте этот аргумент, чтобы компилятор создавал код пользовательского режима, который будет использоваться для записи в журнал событий, определенных в манифесте.

</dd> </dl>

Чтобы компилятор создавал код ведения журнала, необходимо указать аргумент **-UM**, **-CS**, **-CSS** или **-км** . Эти аргументы являются взаимоисключающими.

Чтобы указать место размещения файлов. h,. cs и. mof, создаваемых компилятором, используйте аргумент **-h** . Если не указать аргумент **-h** , файлы помещаются в текущую папку.

Чтобы указать место размещения RC-файла и двоичных файлов (которые содержат ресурсы метаданных), создаваемых компилятором, используйте аргумент **-r** . Если не указать аргумент **-r** , файлы будут помещены в текущую папку.

Компилятор использует базовое имя входного файла в качестве базового имени создаваемых им файлов. Чтобы указать базовое имя, используйте аргумент **-z** .

### <a name="arguments-specific-to-message-text-files"></a>Аргументы, относящиеся к текстовым файлам сообщений

<dl> <dt>

<span id="-a"></span><span id="-A"></span>**-a**
</dt> <dd>

используйте этот аргумент, чтобы указать, что входной файл *filename* содержит содержимое в системной кодовой странице ANSI Windows по умолчанию (CP_ACP). Это значение по умолчанию. Используйте параметр **-u** для Юникода. Если входной файл содержит BOM, этот аргумент будет проигнорирован.

</dd> <dt>

<span id="-A"></span><span id="-a"></span>**-A**
</dt> <dd>

Не рекомендуется. Используйте этот аргумент, чтобы указать, что сообщения в файле Output. bin должны быть ANSI.

</dd> <dt>

<span id="-b"></span><span id="-B"></span>**-б**
</dt> <dd>

Используйте этот аргумент, чтобы компилятор использовал базовое имя входного файла *filename* для имен файлов. bin. По умолчанию используется сообщение.

</dd> <dt>

<span id="-d"></span><span id="-D"></span>**-d**
</dt> <dd>

Используйте этот аргумент, чтобы использовать десятичные значения для констант и средств серьезности в файле заголовка вместо шестнадцатеричных значений.

</dd> <dt>

<span id="-n"></span><span id="-N"></span>**-n**
</dt> <dd>

Используйте этот аргумент, чтобы указать, что сообщения завершаются сразу после текста сообщения. По умолчанию тело сообщения прерывается с помощью CR/LF.

</dd> <dt>

<span id="-o"></span><span id="-O"></span>**-o**
</dt> <dd>

Используйте этот аргумент, чтобы компилятор создавал файл заголовка OLE2, используя определения **HRESULT** вместо кодов состояния. По умолчанию используются коды состояния.

</dd> <dt>

<span id="-u"></span><span id="-U"></span>**-u**
</dt> <dd>

Используйте этот аргумент, чтобы указать, что входной файл *filename* содержит содержимое UTF-16LE. По умолчанию используется содержимое ANSI. Если входной файл содержит BOM, этот аргумент будет проигнорирован.

</dd> <dt>

<span id="-U"></span><span id="-u"></span>**-U**
</dt> <dd>

Используйте этот аргумент, чтобы указать, что сообщения в файле Output. bin должны быть в Юникоде. Это значение по умолчанию.

</dd> <dt>

<span id="-v"></span><span id="-V"></span>**-v**
</dt> <dd>

Используйте этот аргумент для создания подробных выходных данных.

</dd> <dt>

<span id="-x_path"></span><span id="-X_PATH"></span>**-x** *путь*
</dt> <dd>

Используйте этот аргумент, чтобы указать папку, в которую компилятор должен поместить файл. dbg C. Файл. dbg сопоставляет идентификаторы сообщений с их символическими именами.

</dd> </dl>

## <a name="remarks"></a>Remarks

Аргументы **-A** и **-MOF** являются устаревшими и будут удалены в будущем.

Компилятор принимает в качестве входных данных файл манифеста (. Man) или текст сообщения (. MC) и создает следующие файлы:

-   *filename*. h

    Заголовочный файл C/C++, который содержит дескрипторы событий, GUID поставщика и имена символов, на которые вы ссылаетесь в приложении.

-   *имя файла* TEMP. bin

    Двоичный файл ресурсов, содержащий метаданные поставщика и события. Это ресурс шаблона, который обозначается ВРЕМЕНным суффиксом базового имени файла.

-   Msg00001. bin

    Двоичный файл ресурсов для каждого указанного языка (например, если манифест содержит строки сообщений в EN-US и fr-FR, компилятор создаст Msg00001. bin и Msg00002. bin).

-   *имя файла*. RC

    Скрипт компилятора ресурсов, содержащий инструкции для включения каждого файла. bin в качестве ресурса.

Для аргументов, которые принимают путь, путь может быть абсолютным, относительным или UNC-путем и содержать переменные среды.

**До версии MC 1.12.7051:** Компилятор не разрешает относительные пути или переменные среды.

Windows SDK включает компилятор (mc.exe) в \\ папку Bin.

## <a name="examples"></a>Примеры

В следующем примере манифест компилируется с использованием параметров компилятора по умолчанию.

``` syntax
mc spooler.man
```

В следующем примере компилируется манифест и размещаются файлы заголовков и ресурсов в указанных папках.

``` syntax
mc -h <pathgoeshere> -r <pathgoeshere> spooler.man
```

## <a name="requirements"></a>Requirements (Требования)

| Требование | Значение |
|--------------------------|-------------------------------------------------|
| Минимальная версия клиента | Windows 2000 Professional \[только классические приложения\] |
| Минимальная версия сервера | Windows 2000 Server \[только классические приложения\]       |
