---
title: Уровень представления
description: Презентация — это заключительный этап процесса UPnP.
ms.assetid: e8d20ae6-2dd8-4de2-b07b-6cf4e725735e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c92f8457a881dc0414713e996d230261330c10911f2aea285a2e365ad0d59320
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119137197"
---
# <a name="presentation"></a>Уровень представления

Презентация — это заключительный этап процесса UPnP. Если у устройства есть URL-адрес для представления, контрольная точка может получить страницу с этого URL-адреса и загрузить страницу в браузер. В зависимости от возможностей страницы презентации и устройства контрольная точка может управлять устройством и просматривать состояние устройства.

Путь к ресурсу, который передается в [**иупнпрегистрар**](/windows/desktop/api/Upnphost/nn-upnphost-iupnpregistrar) во время регистрации, — это место, где находятся все файлы, относящиеся к презентации устройства. Разработчики устройств могут предоставлять отдельные страницы для каждого встраиваемого устройства. URL-адрес презентации в шаблоне описания устройства может быть абсолютным или относительным URL-адресом. Для относительных URL-адресов, которые относятся к пути ресурса, шаблон описания устройства должен содержать имя файла. **Иупнпрегистрар** преобразует это значение в URL-адрес с фактическим расположением. Для абсолютных URL-адресов расположение не изменяется.

Для поддержки клиентских сценариев на странице презентации дополнительные сведения обычно добавляются к URL-адресу в форме строки запроса. Дополнительные сведения, которые добавляются, — это URL-адрес документа описания устройства, а также УДН устройства или встроенного устройства. URL-адрес описания устройства можно использовать для загрузки документа описания в скрипт, а затем управлять устройством с помощью его служб. УДН используется для выбора встроенного устройства из корневого устройства.

Измененный URL-адрес презентации имеет следующий формат: фактический URL-адрес презентации, вопросительный знак ("?"), URL-адрес описания устройства, знак "плюс" ("+"), УДН устройства. Вопросительный знак обозначает начало строки запроса.

Если URL-адрес презентации в шаблоне описания устройства был абсолютным URL-адресом и уже содержал вопросительный знак ("?"), дополнительные сведения не добавляются в URL-адрес презентации.



| Описание                        | URL-адрес                                                                                                                                               |
|------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------|
| В шаблоне описания устройства | **пресентатионурл** MyDevice.html **/пресентатионурл**                                                                                              |
| Создано узлом устройства       | **пресентатионурл** https://machinename/deviceID/MyDevice.html/?https://machine/upnphost/udhisapi.dll?content=uuid:487394 ... + УДН **/пресентатионурл** |



 

Для загрузки объекта [**иупнпдескриптиондокумент**](/windows/desktop/api/Upnp/nn-upnp-iupnpdescriptiondocument) клиентскому сценарию может потребоваться извлечь URL-адрес описания устройства из URL-адреса презентации. Это делается путем получения строки запроса и ее завершения по знаку «плюс» («+»).


```VB
Dim QueryString
QueryString = window.location.search
Dim DescURLString
DescURLString = Trim(Mid(QueryString,2,Instr(QueryString,"+")-2))& vbCrLf

    Dim LightDesc
    Set LightDesc = CreateObject("UPnP.DescriptionDocument.1")
    LightDesc.Load(DescURLString)
```



В случае страницы презентации для встроенного устройства требуется дополнительная работа. После загрузки [**упнпдескриптиондокумент**](/windows/desktop/api/Upnp/nn-upnp-iupnpdescriptiondocument)сценарий должен получить коллекцию встраиваемых устройств, а затем выбрать устройство, соответствующее УДН в строке запроса. В следующем сценарии показано, как выбрать встроенное устройство для текущей страницы презентации. Предполагается, что Лигхтдеск уже загружен.


```VB
Dim LightDevice
Set LightDevice = LightDesc.RootDevice

Dim EmbeddedDevices 
set EmbeddedDevices = LightDevice.Children

Dim DeviceUdnString
DeviceUdnString = Trim(Mid(QueryString,Instr(QueryString,"+")+1,Len(QueryString)))

Dim Item
set Item = EmbeddedDevices.Item(DeviceUdnString)
```



 

 




