---
title: Регистрация размещенного устройства на узле устройства
description: Регистрация размещенного устройства означает предоставление узлу устройства описания устройства и его объекта управления устройствами.
ms.assetid: 1d85b412-9b1b-415d-8664-8d96a6644793
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c4a607af4f6ada359a9ee32e98e416d8271fd502
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104253195"
---
# <a name="registering-a-hosted-device-with-the-device-host"></a>Регистрация размещенного устройства на узле устройства

Регистрация размещенного устройства означает предоставление узлу устройства описания устройства и его объекта управления устройствами. Затем узел устройства формирует полное описание UPnP-устройства, публикует его и объявляет об устройстве в сети с помощью протокола обнаружения UPnP. После публикации устройство становится доступным для контрольных точек.

Устройства регистрируются двумя способами:

-   Приложение создает экземпляр объекта управления устройством и передает на него указатель на узел устройства.
-   Приложение передает идентификатор ProgID для зарегистрированного объекта управления устройством на узел устройства. Узел устройства создает его, когда узел устройства получает первый запрос для устройства.

Независимо от того, какой метод используется, узел устройства публикует и уведомляет устройство сразу после регистрации. Разница между двумя подходами связана с тем, что при загрузке кода устройства. Когда приложение передает указатель на объект управления устройством, код устройства загружается и выполняется во время регистрации. Когда приложение передает идентификатор ProgID, код устройства загружается только при вызове действия, запросе свойства или получении запроса на подписку на событие. Второй подход немного более эффективен. Однако он не подходит для устройств, которые должны быть установлены до появления любых запросов на управление или подписки на события, поскольку при таком подходе объекты управления устройствами создаются только тогда, когда они необходимы. Этот второй метод также может создавать проблемы с производительностью при получении первого запроса для типа устройства.

Если необходимо обеспечить автоматическое объявление устройства узлом устройства в сети при запуске компьютера, вызовите [**иупнпрегистрар:: RegisterDevice**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-registerdevice). **RegisterDevice** гарантирует, что код устройства будет загружен только при получении запроса на управление или на подписку на события.

Если устройства являются временными или мостами, вызовите [**иупнпрегистрар:: регистерруннингдевице**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-registerrunningdevice), и устройство не будет автоматически повторно объявлено при перезапуске компьютера.

## <a name="discovery-announcement-lifetime"></a>Время существования объявления обнаружения

Каждое устройство, зарегистрированное на узле устройства, связано со временем существования, которое задается устройством при регистрации. Время существования устройства — это период времени, в течение которого объявления для обнаружения устройства являются действительными. Время существования передается в контрольную точку в виде заголовка в объявлении первоначального обнаружения. Узел устройства автоматически обновляет объявление до истечения срока действия. Значения времени жизни объявления обнаружения должны составлять не более 15 минут (значение по умолчанию — 30 минут).

## <a name="device-identifiers-created-at-registration"></a>Идентификаторы устройств, созданные при регистрации

При создании шаблона описания устройства разработчик устройства должен указать путь к ресурсу для описания службы и связанных значков. Путь к ресурсу определяется приложением устройства.

Так как одно и то же устройство может быть зарегистрировано несколько раз на одном компьютере, УДН, указанный в шаблоне описания устройства, недостаточно для уникальной идентификации устройства. Поэтому при регистрации устройства узел устройства создает идентификатор устройства. Этот идентификатор устройства в связи с УДН в шаблоне описания устройства может использоваться для уникальной идентификации устройства.

Этот идентификатор также используется при временной отмене регистрации устройства и повторной регистрации. При временном отмене регистрации устройства узел устройства не удаляет УДН. Ниже перечислены причины, по которым не следует удалять УДН:

-   Выполняется обновление устройства.
-   Вы изменяете свойства устройства.
-   Служба временно недоступна.
-   Вы добавляете новую службу на устройство.
-   Вы обновляете библиотеку DLL.
-   Устройство находится в режиме ожидания.

Дополнительные сведения о регистрации см. в следующих разделах:

-   [Как зарегистрировать устройство с помощью узла устройства](how-to-register-a-device-with-the-device-host.md)
-   [Отмена регистрации устройства](unregistering-a-device.md)
-   [**Иупнпрегистрар:: Унрегистердевице**](/windows/desktop/api/Upnphost/nf-upnphost-iupnpregistrar-unregisterdevice)
-   [**иупнпререгистрар**](/windows/desktop/api/Upnphost/nn-upnphost-iupnpreregistrar)

 

 




