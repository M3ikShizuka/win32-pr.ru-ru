---
description: Функция Регопенусерклассесрут предоставляет объединенное представление для процессов, таких как службы, которые работают с клиентами, отличными от интерактивного пользователя.
ms.assetid: 3815d487-2d58-4ba8-85d2-cae6a642a791
title: Объединенное представление HKEY_CLASSES_ROOT
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b8597db976922db9ca348488b0092c41ba7c7489
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105664351"
---
# <a name="merged-view-of-hkey_classes_root"></a>Объединенное представление \_ корня классов \_ hKey

Функция [**регопенусерклассесрут**](/windows/desktop/api/Winreg/nf-winreg-regopenuserclassesroot) предоставляет объединенное представление для процессов, таких как службы, которые работают с клиентами, отличными от интерактивного пользователя. В этом случае **\_ \_ корневой ключ классов hKey** предоставляет представление реестра, которое объединяет информацию из **\_ \_ \\ \\ классов программного обеспечения локального компьютера hKey** с информацией из разделов **hKey \_ текущего \_ пользователя \\ \\**.

Система использует следующие правила для слияния данных из двух источников:

-   Объединенное представление включает все подразделы ключа **\_ \_ \\ \\ классов программного обеспечения hKey текущего пользователя** .
-   Объединенное представление включает в себя все непосредственные подразделы ключа **\_ \_ \\ \\ классов программного обеспечения файла hKey** , которые не дублируют подразделы программных **\_ \_ \\ \\ классов hKey текущего пользователя**.
-   В конце этого раздела вы найдете список подразделов, которые находятся в **\_ \_ \\ \\ классах программного обеспечения на локальном компьютере** и **разделе \_ hKey \_ текущих \\ пользовательских \\ классов программного обеспечения**. Непосредственные подразделы этих разделов из **дерева \_ локальных \_ компьютеров hKey** включаются в объединенное представление только в том случае, если они не дублируют непосредственные подразделы из дерева **\_ текущего \_ пользователя hKey** . Объединенное представление не включает содержимое файла **hKey на \_ локальном \_ компьютере** с повторяющимися подразделами.

Если приложение запускается с правами администратора, а Управление учетными записями пользователей отключено, среда выполнения COM игнорирует конфигурацию COM для каждого пользователя и обращается только к конфигурации COM на уровне компьютера. Приложения, для которых требуются права администратора, должны регистрировать зависимые COM-объекты во время установки в хранилище конфигураций COM для каждого компьютера (**hKey, \_ \_ \\ \\ классы программного обеспечения для локального компьютера**). Дополнительные сведения см. в разделе [AC: UAC: конфигурация Per-User com](/previous-versions/bb756926(v=msdn.10)).

**Windows Server 2003 и Windows XP/2000:** Приложения могут регистрировать зависимые COM-объекты в хранилище конфигураций COM на уровне компьютера или на уровне пользователя (в **\_ \_ \\ \\ классе "программное обеспечение локального компьютера** " или в **hKey \_ текущих \_ пользовательских \\ \\ классов**).

В следующем примере показан набор подразделов в разделе " **\_ локальный \_ компьютер" hKey** и разделы **\_ текущего \_ пользователя hKey** , а также объединенное **представление \_ \_ корня классов hKey**.

**HKey \_ \_ \\ \\ Классы программного обеспечения локального компьютера**    **CLSID**       *2*       *4*          **InprocServer32**          **LocalServer32**       *7*

**HKey \_ Классы с текущим \_ пользовательским \\ программным обеспечением \\**    **CLSID**       *1*       *4*          **локалсервер**       *6*       *10*          **локалсервер**

**HKey \_ \_Корневой****CLSID** классов *1**2**4***InprocServer32****локалсервер****LocalServer32***6**7**10***локалсервер**                                                                                      

Следующие подразделы находятся в **\_ \_ \\ \\ классах программного обеспечения локального компьютера hKey** и в **hKey \_ текущих \_ пользовательских \\ \\ классов программного обеспечения**. В дереве **\_ локальных \_ компьютеров hKey** непосредственные подразделы этих ключей включаются в объединенное представление только в том случае, если они не дублируют непосредственные подразделы из дерева **\_ текущего \_ пользователя hKey** . Объединенное представление не включает содержимое файла **hKey на \_ локальном \_ компьютере** с повторяющимися подразделами.

**\**_ _*\*\\ шеллекс**  
**\*\\шеллекс \\ контекстменухандлерс**  
**\*\\шеллекс \\ пропертишисандлерс**  
**AppID**  
**Этому**  
**Категории компонентов**  
**Накопитель**  
**\\Шеллекс диска**  
**Диск \\ шеллекс \\ контекстменухандлерс**  
**Диск \\ шеллекс \\ пропертишисандлерс**  
**FileType**  
**Папка**  
**Папка \\ шеллекс**  
**Папка \\ шеллекс \\ колумнхандлер**  
**Папка \\ шеллекс \\ контекстменухандлерс**  
**Папка \\ шеллекс \\ екстшеллфолдервиевс**  
**Папка \\ шеллекс \\ пропертишисандлерс**  
**\\Компоненты установщика**  
**\\Функции установщика**  
**\\Продукты установщика**  
**Интерфейс**  
**Формата**  
**\\База данных MIME**  
**\\CharSet базы данных MIME \\**  
**\\ \\ Кодовая страница базы данных MIME**  
**\\Тип содержимого базы данных MIME \\**  
**Экспорт Typelib**  


 

 
