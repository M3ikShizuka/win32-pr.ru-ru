---
description: Дескрипторы объектов ядра зависят от процесса.
ms.assetid: 3e3288dd-155a-41d0-9d43-5f49ed4c4a9d
title: Объекты ядра
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f115229d11485ec14d530d87fb0e26451aaa1059752ae8d52cea40849256802b
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "117958231"
---
# <a name="kernel-objects"></a>Объекты ядра

Дескрипторы объектов ядра зависят от процесса. То есть процесс должен либо создать объект, либо открыть существующий объект для получения обработчика объекта ядра. Ограничение по процессу для дескрипторов ядра составляет 2 ^ 24. Однако дескрипторы хранятся в выгружаемом пуле, поэтому фактическое количество создаваемых дескрипторов зависит от объема доступной памяти. количество дескрипторов, которые можно создать на 32-разрядной Windows, значительно ниже, чем 2 ^ 24.

Любой процесс может создать новый обработчик для существующего объекта ядра (даже созданный другим процессом) при условии, что процесс знает имя объекта и имеет доступ к нему в режиме безопасности. Дескрипторы объектов ядра включают права доступа, указывающие действия, которые могут быть предоставлены или запрещены процессу. Приложение задает права доступа при создании объекта или получении существующего обработчика объекта. Каждый тип объекта ядра поддерживает собственный набор прав доступа. Например, дескрипторы событий могут иметь установленный или ожидающий доступ (или оба), дескрипторы файлов могут иметь доступ на чтение или запись (или и то, и другое) и т. д. Дополнительные сведения см. в разделе [защищаемые объекты](/windows/desktop/SecAuthZ/securable-objects).

На следующем рисунке приложение создает объект события. Функция [**CreateEvent**](/windows/desktop/api/synchapi/nf-synchapi-createeventa) создает объект события и возвращает маркер объекта.

![приложение, создающее объект события](images/cshob-03.png)

После создания объекта события приложение может использовать обработчик событий для установки или ожидания события. Этот маркер остается действительным до тех пор, пока приложение не закроет обработчик или не завершит работу.

Большинство объектов ядра поддерживают несколько дескрипторов для одного объекта. Например, приложение на предыдущем рисунке может получить дополнительные дескрипторы объектов событий с помощью функции [**опеневент**](/windows/desktop/api/synchapi/nf-synchapi-openeventa) , как показано на следующем рисунке.

![приложение, создающее объект события с несколькими дескрипторами](images/cshob-04.png)

Этот метод позволяет приложению иметь дескрипторы с разными правами доступа. Например, у обработчика 1 может быть задано и ожидание доступа к событию, а у обработчика 2 может быть только ожидание доступа.

Если другой процесс знает имя события и имеет доступ к этому объекту, он может создать собственный обработчик объекта события с помощью [**опеневент**](/windows/desktop/api/synchapi/nf-synchapi-openeventa). Создание приложения также может дублировать один из его дескрипторов в один процесс или в другой процесс с помощью функции [**дупликатехандле**](/windows/win32/api/handleapi/nf-handleapi-duplicatehandle) .

Объект остается в памяти, пока существует хотя бы один обработчик объекта. На следующем рисунке приложения используют функцию [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle) для закрытия дескрипторов объектов событий. Если дескрипторы событий отсутствуют, система удаляет объект из памяти, как показано на следующем рисунке.

![дескрипторы объектов событий закрытия приложения для удаления объекта из памяти](images/cshob-08.png)

Система управляет объектами файлов несколько иначе, чем другие объекты ядра. Объект Files содержит указатель файла — указатель на следующий байт, который считывается или записывается в файл. Каждый раз, когда приложение создает новый файловый обработчик, система создает новый объект File. Поэтому несколько файловых объектов могут ссылаться на один файл на диске, как показано на следующем рисунке.

![несколько объектов File, ссылающихся на файл на диске](images/cshob-09.png)

Только при дублировании или наследовании несколько файлов могут ссылаться на один и тот же объект File, как показано на следующем рисунке.

![два дескриптора файлов ссылаются на один и тот же объект File](images/cshob-10.png)

В следующей таблице перечислены все объекты ядра, а также функции создателя и уничтожения каждого объекта. Функции Creator создают объект и обработчик объекта или создают новый существующий обработчик объекта. Функции уничтожения закрывают обработчик объекта. Когда приложение закрывает последний обработчик в объекте ядра, система удаляет объект из памяти.



| Объект ядра                | Функция Creator                                                                                                                                                                                                                                                  | Функция уничтожения                                                                      |
|------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------|
| Маркер доступа                 | [**CreateRestrictedToken**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-createrestrictedtoken), [**сбой duplicatetoken**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-duplicatetoken), [**дупликатетокенекс**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-duplicatetokenex), [**OpenProcessToken**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-openprocesstoken), [**опенсреадтокен**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-openthreadtoken) | [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle)                                                      |
| Уведомление об изменении          | [**финдфирстчанженотификатион**](/windows/desktop/api/fileapi/nf-fileapi-findfirstchangenotificationa)                                                                                                                                                                                                 | [**финдклосечанженотификатион**](/windows/desktop/api/fileapi/nf-fileapi-findclosechangenotification)                       |
| Коммуникационное устройство        | [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea)                                                                                                                                                                                                                                   | [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle)                                                      |
| Входные данные консоли                | [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea)с Конин $                                                                                                                                                                                                                      | [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle)                                                      |
| Буфер экрана консоли        | [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea)с конаут $                                                                                                                                                                                                                     | [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle)                                                      |
| Рабочий стол                      | [**жетсреаддесктоп**](/windows/desktop/api/winuser/nf-winuser-getthreaddesktop)                                                                                                                                                                                                                     | Приложения не могут удалить этот объект.                                                 |
| Событие                        | [**CreateEvent**](/windows/desktop/api/synchapi/nf-synchapi-createeventa), [**креативентекс**](/windows/desktop/api/synchapi/nf-synchapi-createeventexa), [**опеневент**](/windows/desktop/api/synchapi/nf-synchapi-openeventa)                                                                                                                                                     | [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle)                                                      |
| Журнал событий                    | [**Опеневентлог**](/windows/desktop/api/winbase/nf-winbase-openeventloga), [**регистеревентсаурце**](/windows/desktop/api/winbase/nf-winbase-registereventsourcea), [**опенбаккупевентлог**](/windows/desktop/api/winbase/nf-winbase-openbackupeventloga)                                                                                                                     | [**клосивентлог**](/windows/desktop/api/winbase/nf-winbase-closeeventlog)                                                 |
| File                         | [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea)                                                                                                                                                                                                                                 | [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle), [ **DeleteFile**](/windows/desktop/api/fileapi/nf-fileapi-deletefilea)                     |
| Сопоставление файлов                 | [**CreateFileMapping**](/windows/desktop/api/winbase/nf-winbase-createfilemappinga), [ **OpenFileMapping**](/windows/desktop/api/winbase/nf-winbase-openfilemappinga)                                                                                                                                                                          | [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle)                                                      |
| Найти файл                    | [**FindFirstFile**](/windows/desktop/api/fileapi/nf-fileapi-findfirstfilea)                                                                                                                                                                                                                             | [**финдклосе**](/windows/desktop/api/fileapi/nf-fileapi-findclose)                                                           |
| Куча                         | [**хеапкреате**](/windows/desktop/api/heapapi/nf-heapapi-heapcreate)                                                                                                                                                                                                                                 | [**хеапдестрой**](/windows/desktop/api/heapapi/nf-heapapi-heapdestroy)                                                     |
| Порт завершения ввода-вывода          | [**CreateIoCompletionPort**](/windows/desktop/FileIO/createiocompletionport)                                                                                                                                                                                                           | [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle)                                                      |
| Задание                          | [**креатежобобжект**](/windows/desktop/api/winbase/nf-winbase-createjobobjecta)                                                                                                                                                                                                                       | [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle)                                                      |
| Ящик                     | [**креатемаилслот**](/windows/desktop/api/winbase/nf-winbase-createmailslota)                                                                                                                                                                                                                         | [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle)                                                      |
| Уведомление о ресурсе памяти | [**креатемемориресаурценотификатион**](/windows/desktop/api/memoryapi/nf-memoryapi-creatememoryresourcenotification)                                                                                                                                                                                     | [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle)                                                      |
| Модуль                       | [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya), [ **Ошибка GetModuleHandle**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getmodulehandlea)                                                                                                                                                                                  | [**FreeLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-freelibrary)                                                     |
| Mutex                        | [**CreateMutex**](/windows/desktop/api/synchapi/nf-synchapi-createmutexa), [**креатемутексекс**](/windows/desktop/api/synchapi/nf-synchapi-createmutexexa), [**опенмутекс**](/windows/win32/api/synchapi/nf-synchapi-openmutexw)                                                                                                                                                     | [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle)                                                      |
| канал                         | [**Креатенамедпипе**](/windows/desktop/api/winbase/nf-winbase-createnamedpipea), [ **креатепипе**](/windows/desktop/api/namedpipeapi/nf-namedpipeapi-createpipe)                                                                                                                                                                                    | [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle), [ **дисконнектнамедпипе**](/windows/desktop/api/namedpipeapi/nf-namedpipeapi-disconnectnamedpipe) |
| Процесс                      | [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa), [**OpenProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-openprocess), [**жеткуррентпроцесс**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-getcurrentprocess)                                                                                                                                     | [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle), [ **терминатепроцесс**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-terminateprocess)       |
| Semaphore                    | [**Createsemaphore-**](/windows/desktop/api/winbase/nf-winbase-createsemaphorea), [**креатесемафорикс**](/windows/desktop/api/winbase/nf-winbase-createsemaphoreexa), [**опенсемафоре**](/windows/win32/api/synchapi/nf-synchapi-opensemaphorew)                                                                                                                             | [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle)                                                      |
| Розетка                       | [**сокет**](/windows/desktop/api/winsock2/nf-winsock2-socket), [ **принять**](/windows/desktop/api/winsock2/nf-winsock2-accept)                                                                                                                                                                                                    | [**функции closesocket**](/windows/desktop/api/winsock/nf-winsock-closesocket)                                                |
| Thread                       | [**CreateThread**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createthread), [**креатеремотесреад**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createremotethread), [**жеткуррентсреад**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-getcurrentthread)                                                                                                                           | [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle), [ **TerminateThread**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-terminatethread)         |
| Таймер                        | [**Сбой createwaitabletimer**](/windows/win32/api/synchapi/nf-synchapi-createwaitabletimerw), [**креатеваитаблетимерекс**](/windows/win32/api/synchapi/nf-synchapi-createwaitabletimerexw), [**опенваитаблетимер**](/windows/win32/api/synchapi/nf-synchapi-openwaitabletimerw)                                                                                                     | [**CloseHandle**](/windows/win32/api/handleapi/nf-handleapi-closehandle)                                                      |
| Обновление ресурса              | [**бегинупдатересаурце**](/windows/win32/api/winbase/nf-winbase-beginupdateresourcea)                                                                                                                                                                                                         | [**ендупдатересаурце**](/windows/win32/api/winbase/nf-winbase-endupdateresourcea)                                   |
| Оконная станция               | [**жетпроцессвиндовстатион**](/windows/desktop/api/winuser/nf-winuser-getprocesswindowstation)                                                                                                                                                                                                       | Приложения не могут удалить этот объект.                                                 |



 

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Пространства имен объектов ядра](/windows/desktop/TermServ/kernel-object-namespaces)
</dt> </dl>

 

 
