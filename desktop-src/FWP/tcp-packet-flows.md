---
title: Потоки TCP-пакетов
description: Порядок, в котором уровни обработчика фильтра платформы фильтрации Windows (WFP) проходят во время обычного сеанса TCP.
ms.assetid: 75319c91-f77b-4dec-b94f-36772f1f1d53
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e2203ccb4b2793983bd5b1052d53c2700d3033a4
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "103986647"
---
# <a name="tcp-packet-flows"></a>Потоки TCP-пакетов

В этом разделе описывается порядок, в котором уровни обработчика фильтра платформы фильтрации Windows (WFP) проходят во время типичного сеанса TCP.

> [!Note]  
> Пакеты TCP-пакетов для IPv6 следуют той же схеме, что и для IPv4.

 

> [!Note]  
> Потоки пакетов, не относящиеся к TCP, следуют тому же шаблону, что и [пакеты UDP](udp-packet-flows.md).

 

## <a name="tcp-connection-establishment"></a>Установка подключения TCP

<dl> Сервер (получатель) выполняет пассивное открытие

-   BIND: \_ \_ Перенаправление привязки ALE уровня фвпм для \_ \_ \_ версии 4 (только для windows 7 или Windows Server 2008 R2)
-   привязка: \_ \_ \_ назначение ресурса ALE уровня \_ фвпм \_ v4
-   прослушивание: \_ \_ \_ прослушивание проверки подлинности ALE уровня фвпм ( \_ \_ v4)

  
Клиент (отправитель) выполняет активное открытие

-   BIND: \_ \_ Перенаправление привязки ALE уровня фвпм для \_ \_ \_ версии 4 (только для windows 7 или Windows Server 2008 R2)
-   привязка: \_ \_ \_ назначение ресурса ALE уровня \_ фвпм \_ v4
-   Подключение: ФВПМ \_ \_ \_ \_ Перенаправление подключения ALE \_ версии 4 (только windows 7 или Windows Server 2008 R2)
-   Подключение: \_ \_ \_ Проверка подлинности фвпм уровня ALE для \_ подключения \_ v4
-   SYN: \_ \_ исходящий транспорт уровня фвпм \_ \_ v4
-   SYN: \_ \_ исходящий уровень фвпм \_ иппаккет \_ v4

  
Сервер

-   SYN: ФВПМ \_ Layer \_ Inbound \_ иппаккет \_ v4
-   SYN: \_ входящий транспорт с уровнем фвпм \_ \_ \_ v4
-   SYN: \_ \_ \_ Проверка подлинности recv для уровня фвпм, \_ \_ принимаемая до \_ v4
-   SYN-ACK: \_ \_ исходящий транспорт уровня фвпм \_ \_ v4
-   SYN-ACK: ФВПМ \_ уровень \_ исходящего трафика \_ иппаккет \_ v4

  
Клиент

-   SYN-ACK: ФВПМ \_ Layer \_ Inbound \_ иппаккет \_ v4
-   SYN-ACK: \_ входящий транспорт на уровне фвпм \_ \_ \_ версии 4
-   \_ \_ \_ Установленный поток ALE уровня фвпм \_ \_ v4
-   ACK: \_ \_ исходящий транспорт уровня фвпм \_ \_ v4
-   ПОДТВЕРЖДЕНИЕ: ФВПМ \_ уровня \_ исходящего трафика \_ иппаккет \_ v4

  
Сервер

-   ACK: ФВПМ \_ Layer \_ Inbound \_ иппаккет \_ v4
-   ACK: \_ входящий транспорт уровня фвпм для \_ \_ транспорта \_ v4
-   \_ \_ \_ Установленный поток ALE уровня фвпм \_ \_ v4
-   Прослушивание завершается. Сервер может выполнить принятие.

  
</dl>

## <a name="tcp-syn-received-with-no-one-listening-on-the-port-or-protocol"></a>Получен TCP SYN без одного прослушивания порта или протокола

Сервер (получатель)

-   SYN: ФВПМ \_ Layer \_ Inbound \_ иппаккет \_ v4
-   SYN: \_ \_ \_ удален транспорт входящего транспорта \_ версии 4 \_ (фвпм)
-   RST: \_ \_ исходящий транспорт уровня фвпм \_ \_ v4
-   RST: \_ \_ исходящий уровень фвпм \_ иппаккет \_ v4

> [!Note]  
> TCP SYN без конечной точки указывается при отклонениях от транспорта с определенной ошибкой. Блокировать этот пакет при отправке отказа, чтобы стек не отправлял соответствующее событие (RST). Пример фильтрации в скрытом режиме см. в разделе [запрет сканирования портов](preventing-port-scanning.md).

 

## <a name="data-transmitted-over-a-tcp-connection"></a>Данные, передаваемые через TCP-подключение

<dl> Клиент (отправитель)

-   Отправить
-   данные: \_ поток уровня \_ фвпм \_ v4
-   TCP-сегменты: \_ \_ исходящий \_ транспорт уровня фвпм \_ v4
-   IP-датаграммы: ФВПМ \_ уровень \_ исходящего трафика \_ иппаккет \_ v4

  
Сервер (получатель)

-   IP-датаграммы: ФВПМ \_ Layer \_ Inbound \_ иппаккет \_ v4
-   Сегменты TCP: \_ входящий транспорт уровня фвпм для \_ входящего \_ транспорта \_ v4
-   данные: \_ поток уровня \_ фвпм \_ v4
-   Данные доступны для чтения.

  
</dl>

## <a name="successful-reauthorization-of-a-tcp-packet"></a>Успешная повторная авторизация пакета TCP

Сервер (получатель)

-   IP-датаграммы: ФВПМ \_ Layer \_ Inbound \_ иппаккет \_ v4
-   Сегмент TCP: \_ \_ \_ транспорт входящего транспорта \_ версии 4 фвпм
-   Сегмент TCP: \_ \_ \_ Проверка подлинности фвпм уровня ALE \_ recv \_ Accept \_ v4
-   данные: \_ поток уровня \_ фвпм \_ v4 (входящий трафик)

## <a name="failed-reauthorization-of-a-tcp-packet"></a>Не удалось выполнить повторную авторизацию пакета TCP

Сервер (получатель)

-   IP-датаграммы: ФВПМ \_ Layer \_ Inbound \_ иппаккет \_ v4
-   Сегмент TCP: \_ \_ \_ транспорт входящего транспорта \_ версии 4 фвпм
-   Сегмент TCP: \_ \_ \_ Проверка подлинности фвпм уровня ALE \_ recv \_ Accept \_ v4
-   Сегмент TCP: \_ \_ \_ Проверка подлинности \_ recv \_ Accept \_ \_ для фвпм слоя

## <a name="tcp-connection-termination"></a>Завершение TCP-подключения

Завершение TCP-подключения не указано ни на одном уровне WFP.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Повторная авторизация ALE](ale-re-authorization.md)
</dt> <dt>

[**Фильтрация идентификаторов слоя**](management-filtering-layer-identifiers-.md)
</dt> </dl>

 

 




