---
title: Архитектура WFP
description: в этом разделе содержится краткий обзор архитектуры платформы фильтрации Windows.
ms.assetid: 17a90f5c-ef82-4b14-b7f1-dd025d5f7303
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 41989a11ff5412b3185f6987f9588f0309c3fde3ca386c71e4613ab6bc8237f8
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119766612"
---
# <a name="wfp-architecture"></a>Архитектура WFP

на следующем рисунке показана базовая архитектура платформы фильтрации Windows (WFP).

![Базовая архитектура схемы платформы фильтрации Windows](images/wfp-architecture.png)

## <a name="filter-engine"></a>Обработчик фильтров

Обработчик фильтров содержит компонент пользовательского режима и компонент режима ядра, которые вместе выполняют все операции фильтрации сетевых данных. Механизм фильтрации содержит несколько слоев фильтрации, которые неплотно сопоставляются с уровнями стека сети операционной системы. Уровни механизма фильтрации делятся на слои пользовательского режима и уровни ядра на основе компонента механизма фильтрации, который их владеет.

Компонент пользовательского режима выполняет фильтрацию RPC и IPsec. Механизм фильтрации содержит около 10 слоев фильтрации в пользовательском режиме.

Компонент режима ядра выполняет фильтрацию по сети и транспортным слоям в стеке TC/IP. Этот компонент также вызывает доступные функции выноски во время процесса [классификации](basic-operation.md) . Обработчик фильтров содержит приблизительно 50 уровней фильтрации в режиме ядра.

Описание каждого уровня механизма фильтрации см. в разделе [**Фильтрация идентификаторов слоев**](management-filtering-layer-identifiers-.md) .

## <a name="base-filtering-engine"></a>Базовый модуль фильтрации

Модуль базовой фильтрации (BFE) — это служба пользовательского режима (bfe.dll выполняется в процессе svchost.exe), которая координирует компоненты WFP. Основные задачи, выполняемые BFE, — это добавление и удаление фильтров из системы, Хранение конфигурации фильтра и обеспечение безопасности конфигурации WFP. Приложения взаимодействуют с BFE с помощью [функций управления WFP](fwp-mgmt-functions.md).

## <a name="callout-drivers"></a>Драйверы выноски

Драйверы выноски предоставляют дополнительные функции фильтрации, добавляя пользовательские функции выноски в механизм фильтрации на одном или нескольких слоях фильтрации в режиме ядра. Выноски поддерживают глубокую проверку и пакет, а также потоковую модификацию. После того как драйвер выноски добавил свои функции-выноски в механизм фильтрации, в процесс фильтрации можно добавить фильтры, указывающие функцию выноски данного драйвера. Такие фильтры могут быть добавлены как приложением управления пользовательским режимом, так и самим драйвером выноски. интерфейс режима ядра, поставляемый в комплекте Windows Development Kit, следует использовать только там, где это необходимо, а не в качестве замены для API пользовательского режима.

> [!Note]  
> дополнительные сведения о драйверах выноски см. в разделе Windows filtering Platform раздела [Windows Development Kit](/windows-hardware/drivers/network/windows-filtering-platform-callout-drivers2).

 

платформа фильтрации Windows включает ряд встроенных функций выноски, которые можно использовать для безопасного обмена данными IPsec, параметров фильтрации с отслеживанием состояния и фильтрации в скрытом режиме. Полный список встроенных функций выноски см. [**в разделе Встроенные идентификаторы выносок**](built-in-callout-identifiers.md) .

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Объектная модель](object-model.md)
</dt> <dt>

[Операция WFP](basic-operation.md)
</dt> <dt>

[Windows Драйверы для вызова платформы фильтрации — руководство по проектированию](/windows-hardware/drivers/network/windows-filtering-platform-callout-drivers2)
</dt> <dt>

[Windows Драйверы для вызова платформы фильтрации — Справочник](/windows-hardware/drivers/ddi/_netvista/)
</dt> </dl>

 

 