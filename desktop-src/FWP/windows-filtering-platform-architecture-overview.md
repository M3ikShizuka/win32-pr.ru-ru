---
title: Архитектура WFP
description: В этом разделе содержится краткий обзор архитектуры платформы фильтрации Windows.
ms.assetid: 17a90f5c-ef82-4b14-b7f1-dd025d5f7303
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8740fed254aca97ab77566e2a7f0ace9a6679d56
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "104260834"
---
# <a name="wfp-architecture"></a>Архитектура WFP

На следующем рисунке показана базовая архитектура платформы фильтрации Windows (WFP).

![Базовая архитектура схемы платформы фильтрации Windows](images/wfp-architecture.png)

## <a name="filter-engine"></a>Обработчик фильтров

Обработчик фильтров содержит компонент пользовательского режима и компонент режима ядра, которые вместе выполняют все операции фильтрации сетевых данных. Механизм фильтрации содержит несколько слоев фильтрации, которые неплотно сопоставляются с уровнями стека сети операционной системы. Уровни механизма фильтрации делятся на слои пользовательского режима и уровни ядра на основе компонента механизма фильтрации, который их владеет.

Компонент пользовательского режима выполняет фильтрацию RPC и IPsec. Механизм фильтрации содержит около 10 слоев фильтрации в пользовательском режиме.

Компонент режима ядра выполняет фильтрацию по сети и транспортным слоям в стеке TC/IP. Этот компонент также вызывает доступные функции выноски во время процесса [классификации](basic-operation.md) . Обработчик фильтров содержит приблизительно 50 уровней фильтрации в режиме ядра.

Описание каждого уровня механизма фильтрации см. в разделе [**Фильтрация идентификаторов слоев**](management-filtering-layer-identifiers-.md) .

## <a name="base-filtering-engine"></a>Базовый модуль фильтрации

Модуль базовой фильтрации (BFE) — это служба пользовательского режима (bfe.dll выполняется в процессе svchost.exe), которая координирует компоненты WFP. Основные задачи, выполняемые BFE, — это добавление и удаление фильтров из системы, Хранение конфигурации фильтра и обеспечение безопасности конфигурации WFP. Приложения взаимодействуют с BFE с помощью [функций управления WFP](fwp-mgmt-functions.md).

## <a name="callout-drivers"></a>Драйверы выноски

Драйверы выноски предоставляют дополнительные функции фильтрации, добавляя пользовательские функции выноски в механизм фильтрации на одном или нескольких слоях фильтрации в режиме ядра. Выноски поддерживают глубокую проверку и пакет, а также потоковую модификацию. После того как драйвер выноски добавил свои функции-выноски в механизм фильтрации, в процесс фильтрации можно добавить фильтры, указывающие функцию выноски данного драйвера. Такие фильтры могут быть добавлены как приложением управления пользовательским режимом, так и самим драйвером выноски. Интерфейс режима ядра, поставляемый в комплекте Windows Development Kit, должен использоваться только там, где это необходимо, а не как замена API пользовательского режима.

> [!Note]  
> Дополнительные сведения о драйверах выноски см. в разделе Windows Filtering Platform раздела [Windows Development Kit](/windows-hardware/drivers/network/windows-filtering-platform-callout-drivers2).

 

Платформа фильтрации Windows включает ряд встроенных функций выноски, которые можно использовать для безопасного обмена данными IPsec, параметров фильтрации с отслеживанием состояния и фильтрации в скрытом режиме. Полный список встроенных функций выноски см. [**в разделе Встроенные идентификаторы выносок**](built-in-callout-identifiers.md) .

## <a name="related-topics"></a>См. также

<dl> <dt>

[Объектная модель](object-model.md)
</dt> <dt>

[Операция WFP](basic-operation.md)
</dt> <dt>

[Драйверы для вызова платформы фильтрации Windows — руководство по проектированию](/windows-hardware/drivers/network/windows-filtering-platform-callout-drivers2)
</dt> <dt>

[Драйверы для вызова платформы фильтрации Windows — Справочник](/windows-hardware/drivers/ddi/_netvista/)
</dt> </dl>

 

 