---
title: Повторная авторизация ALE
description: сетевой трафик на уровнях уровня приложения (ALE) для платформы фильтрации Windows (WFP) фильтруется по потокам ALE.
ms.assetid: 3cc7f78e-3f9d-4a91-8ea0-9b64c299068a
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 850cd7f789c1fb1222a0d6820e84a42cf41763dac4e57b96667e7feda364374c
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119582694"
---
# <a name="ale-reauthorization"></a>Повторная авторизация ALE

сетевой трафик на уровнях уровня приложения (ALE) для платформы фильтрации Windows (WFP) фильтруется по [потокам ALE](ale-stateful-filtering.md). После разрешения потока ALE разрешен весь трафик, который является частью потока ALE. Повторная Авторизация — это запрос на проверку разрешений потока ALE, обычно из-за изменения политики сети.

Потокам ALE назначается направление, входящее или исходящее, в зависимости от направления первого пакета, который инициировал создание и авторизацию последовательности. Входящие потоки ALE создаются и продаются авторизацией на уровне [**фвпм \_ \_ \_ проверки подлинности \_ recv \_ Accept \_ V {4 \| 6}**](management-filtering-layer-identifiers-.md) уровня. Исходящие потоки ALE создаются и продаются авторизацией на уровне **\_ \_ \_ проверки подлинности \_ подключения ALE \_ V {4 \| 6} уровня фвпм** . Направление потока ALE не ограничивает направление пакетов, принадлежащих потоку. Потоки ALE содержат как входящие, так и исходящие пакеты независимо от направления самого потока ALE.

Повторная авторизация потока ALE активируется следующим образом:

-   Изменение политики на слое, где изначально был разрешен или создан поток ALE.
-   Интерфейс прибытия отличается от интерфейса, где изначально был разрешен или создан поток ALE.
-   Ожидающее подключение.

Повторная авторизация отличается от первоначальной авторизации на наличие [**\_ \_ флага \_ \_ условия FWP**](filtering-condition-flags-.md) .

Повторная авторизация может выполняться только на уровнях [**фвпм на уровне \_ \_ \_ проверки подлинности \_ recv \_ Accept \_ v {4 \| 6}**](management-filtering-layer-identifiers-.md) и **фвпм \_ Layer \_ ALE \_ \_ Connect \_ v {4 \| 6}** .

### <a name="policy-change-reauthorization"></a>Политика-изменение повторной разработки

Изменение политики реализовано в виде добавления или удаления фильтров на уровне ALE. После обнаружения изменения политики первый пакет, проходящий через поток ALE, созданный на затронутом слое, будет указан для переразработки слоя. Таким образом, для повторной разработки вполне возможно, что исходящий пакет классифицируется на уровне [**\_ \_ \_ проверки подлинности фвпм уровня " \_ recv \_ Accept \_ V {4 \| 6}**](management-filtering-layer-identifiers-.md) " и что входящий пакет классифицируется на уровне **\_ \_ \_ проверки подлинности \_ подключения ALE \_ v {4 \| 6} уровня фвпм** .

Одной из причин для этой классификации с двунаправленным направлением является то, что может не быть дополнительного сетевого трафика из исходного направления (например, входящего пакета для входящего потока ALE). Одним из таких примеров является односторонняя потоковая передача UDP после первоначального двустороннего подтверждения. В этом случае рекомендуется как можно быстрее уничтожить потоковую передачу.

### <a name="arrival-interface-reauthorization"></a>Повторная авторизация интерфейса прибытия

повторная авторизация интерфейса прибытия доступна начиная с Windows Server 2008 и Windows Vista с пакетом обновления 1 (SP1).

Пакеты, принадлежащие одной и той же последовательности ALE, могут поступать из нескольких интерфейсов. Первый пакет, поступающий через интерфейс, отличный от исходного интерфейса потока ALE, перерабатывается.

В модели сильного узла, которая является моделью безопасности по умолчанию для стека TCP/IP, подключение к сетевому интерфейсу принимает только пакеты, входящие в тот же интерфейс. Таким образом, повторная авторизация интерфейса прибытия не используется на сильном главном компьютере.

В модели слабого узла подключение к сетевому интерфейсу позволяет выполнять пакеты, входящие в любой другой сетевой интерфейс. Повторная авторизация интерфейса прибытия используется на слабом узловом компьютере для реализации политик для конкретного интерфейса. Дополнительные сведения см [. в разделе "модель беспроводных и слабых узлов".](/previous-versions/technet-magazine/cc137807(v=msdn.10))

Некоторые классифицированные [поля](filtering-conditions.md) могут быть неизвестны во время переразработки. Например, если исходящий пакет перерабатывается на уровне [**\_ \_ \_ проверки подлинности фвпм уровня " \_ recv \_ Accept \_ V {4 \| 6}**](management-filtering-layer-identifiers-.md) ", все поля, относящиеся к интерфейсу прибытия, неизвестны. В этом случае значения неизвестных полей указываются как [**FWP \_ Empty**](/windows/desktop/api/Fwptypes/ne-fwptypes-fwp_data_type).

Поля типа [**FWP \_ Empty**](/windows/desktop/api/Fwptypes/ne-fwptypes-fwp_data_type) могут сопоставляться со значением [**FWP \_ Match \_**](/windows/desktop/api/Fwptypes/ne-fwptypes-fwp_match_type). Таким образом, политика может быть настроена для блокировки повторных авторизаций и уничтожения потока ALE при получении запросов на переподготовку для потока ALE.

## <a name="pending-connection-reauthorization"></a>Ожидается повторная авторизация подключения

Драйвер выноски может отложить операцию классификации на уровнях ALE и выполнить ее позже, когда решение по фильтрации можно будет безопасно принять. Функции отсрочки и завершения ALE поддерживаются с помощью функций [FwpsPendOperation0](/windows-hardware/drivers/ddi/fwpsk/nf-fwpsk-fwpspendoperation0) и [FwpsCompleteOperation0](/windows-hardware/drivers/ddi/fwpsk/nf-fwpsk-fwpscompleteoperation0)в режиме ядра.

Повторная авторизация активируется сразу после вызова FwpsCompleteOperation0 и позволяет драйверу выноски разрешить или заблокировать поток.

Только начальная авторизация может быть отложена. Вызов FwpsPendOperation0 завершится ошибкой, если установлен флаг условия FWP с флагом повторной [**\_ \_ \_ \_ авторизации**](filtering-condition-flags-.md) .

дополнительные сведения см. в документации по [Windows Driver Kit](/windows-hardware/drivers/ddi/_netvista/) .

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Принудительное применение уровня приложения (ALE)](application-layer-enforcement--ale-.md)
</dt> <dt>

[Уровни ALE](ale-layers.md)
</dt> <dt>

[Фильтрация с отслеживанием состояния ALE](ale-stateful-filtering.md)
</dt> <dt>

[Многоадресный или широковещательный трафик ALE](ale-multicast-broadcast-traffic.md)
</dt> <dt>

[настройка Flow ALE](ale-flow-customization.md)
</dt> </dl>

 

 