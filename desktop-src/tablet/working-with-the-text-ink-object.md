---
description: Чтобы помочь в поддержке рукописного ввода в приложениях, существуют два объекта, которые могут быть внедрены и поддерживаются любыми контейнерами OLE, объектом рукописного ввода текста (Тинк) и объектом рукописного ввода эскиза (приемником).
ms.assetid: 0202e91c-c7a0-4e7b-a1c6-a2f58c11c0be
title: Работа с объектом рукописного ввода текста
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 938d7e68795147913b64cad399f70ac6c1d2fdb06edc19e6d0c0b6c64add6422
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118449267"
---
# <a name="working-with-the-text-ink-object"></a>Работа с объектом рукописного ввода текста

Чтобы помочь в поддержке рукописного ввода в приложениях, существуют два объекта, которые могут быть внедрены и поддерживаются любыми контейнерами OLE, объектом рукописного ввода текста (Тинк) и объектом рукописного ввода эскиза (приемником).

Объект рукописного ввода текста — это объект OLE, представляющий рукописный ввод, который должен образовывать слова. Объект рукописного ввода текста позволяет преобразовать рукописный ввод в текст путем выбора из списка вариантов. Цвет и размер объекта рукописного ввода текста могут быть заданы программно и могут основываться на атрибутах текста вокруг объекта. Объект рукописного ввода текста должен содержать одно слово.

Объект рукописного ввода текста поддерживает стандартный набор интерфейсов OLE, необходимых для внедрения и поддержки буфера обмена. Интерфейс [**IPersistStream**](/windows/win32/api/objidl/nn-objidl-ipersiststream) считывает данные из потока и выполняет запись в него в сериализованном формате (ISF). Объект рукописного ввода текста предоставляет интерфейс [**иинклинеинфо**](/windows/desktop/api/msinkaut/nn-msinkaut-iinklineinfo) для доступа к его свойствам экрана и списку результатов распознавания.

Объект рукописного ввода текста может использоваться для взаимодействия между приложениями путем помещения его в область объектов OLE в буфер обмена, путем его встраивания в формат RTF или сохранения в потоке ISF.

Объект рукописного ввода текста может быть создан следующими способами.

-   Элемент управления [InkEdit](inkedit-control-reference.md) использует объект рукописного ввода текста. Функциональные возможности элемента управления InkEdit — это супер-набор стандартных функциональных возможностей элемента управления RichEdit. Рукописный ввод вставляется в поток RTF элемента управления InkEdit как объект рукописного ввода текста.
-   Когда приложение копирует объект [инкстрокес](/previous-versions/windows/desktop/legacy/ms703293(v=vs.85)) или [InkEdit](inkedit-control-reference.md) в буфер обмена и задается формат [**перечисления инкклипбоардформатс**](/windows/desktop/api/msinkaut/ne-msinkaut-inkclipboardformats) , слот буфера обмена объекта OLE содержит объект рукописного ввода текста OLE.
-   Панель ввода Tablet PC может создавать объекты рукописного ввода текста.

Например, приложение может распознать рукописный ввод и добавить результат распознавания в штрихи. затем, если скопировать и вставить штрихи в Microsoft Word как объект рукописного ввода, варианты для этого слова будут доступны в word 2003 и более поздних версиях.

Чтобы успешно содержать текстовые объекты рукописного ввода, приложение должно реализовать поддержку контейнера OLE для внедренных объектов. Затем, чтобы сделать контейнер полностью поддерживаемым текстом, необходимо заинститутировать:

-   Изменения в приложении для поиска и замены. Вместо того чтобы пропускать внедренные объекты в поиске, эти объекты должны быть опрошены для типа. Если они являются объектом рукописного ввода текста, они должны быть созданы и запрошены для соответствующего текста.
-   Изменения в поведении выбора. Выбор объектов рукописного ввода текста никогда не должен появляться с маркерами изменения размера. Они должны быть выбраны точно так же, как текст выбирается в документе. Код выбора для объектов должен определять, является ли тип текстовым рукописным текстом, и отображать выбор соответствующим образом.
-   Использование внешних свойств. Свойства окружающей среды, такие как размер шрифта, цвет и полужирное начертание, необходимо передать в объект рукописного ввода текста. Приложение этих свойств изменяет ширину рукописных рукописных данных, поэтому требуется обновление размера путем вызова метода [**иинклинеинфо:: жетинкекстент**](/windows/desktop/api/msinkaut/nf-msinkaut-iinklineinfo-getinkextent) или [**иолеобжект::-экстента**](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) .

## <a name="in-this-section"></a>В этом разделе

-   [Преобразование объекта рукописного ввода текста в рукописный текст](converting-a-text-ink-object-to-ink.md)
-   [Интерфейсы API рукописного ввода текста](text-ink-apis.md)
-   [Приемники и объекты Тинк](sink-and-tink-objects.md)

 

 
