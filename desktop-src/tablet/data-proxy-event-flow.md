---
description: В этом разделе рассматриваются сведения о событиях при использовании функций прокси-сервера данных анализа рукописного ввода.
ms.assetid: 837867a4-7cda-41b0-b20d-eec9a3a7fb86
title: Flow событий прокси-сервера данных
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c1ae6eab209466094ec79c0ed96923a28751b86c585d9ef750f9d12ef892036c
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119092814"
---
# <a name="data-proxy-event-flow"></a>Flow событий прокси-сервера данных

В этом разделе рассматриваются сведения о событиях при использовании функций прокси-сервера данных анализа рукописного ввода.

## <a name="data-proxy-event-flow-overview"></a>общие сведения о Flow событий прокси-сервера данных

В использовании прокси-сервера данных [**InkAnalyzer**](inkanalyzer.md)предполагается, что приложение, в котором интегрируется InkAnalyzer, уже имеет существующую модель документов, в которой они хотят использовать для прокси результаты анализа. Также предполагается, что приложение будет иметь результаты любой предыдущей операции анализа, которую они хотят создать на основе их модели документов. Также может быть нерукописный текст, который можно добавить в **InkAnalyzer** в виде **имаженоде** или **текствордноде**[**контекстноде**](icontextnode.md) , чтобы можно было добавить заметки с помощью рукописного ввода.

Ключом к системе прокси-сервера данных является то, что приложение помечает [**контекстноде**](icontextnode.md) как "частично заполненное" с помощью [**партиаллипопулатед**](icontextnode-setpartiallypopulated.md). Если этот флаг имеет значение true, [**InkAnalyzer**](inkanalyzer.md) предполагает, что три вещи об этом **контекстноде**:

-   Указано правильное расположение [**контекстноде**](icontextnode.md) .
-   Тип [**контекстноде**](icontextnode.md) является правильным.
-   Все остальные сведения об этом [**контекстноде**](icontextnode.md) хранятся в другом расположении.

На основе этих трех правил, если и когда [**InkAnalyzer**](inkanalyzer.md) требуется дополнительная информация о [**контекстноде**](icontextnode.md) , он вызовет событие [**популатеконтекстноде**](-ianalysisproxyevents-populatecontextnode.md) и ссылку на **контекстноде** . Это дает приложению возможность установить всю известную информацию о **контекстноде** перед тем, как **InkAnalyzer** просматривает его более подробно. После обработки события **Популатеконтекстноде** **контекстноде** в вопросе должен иметь допустимое свойство Location, правильное количество подузлов, если оно является контейнером **контекстноде** или иметь правильные штрихи, с помощью [**Сетстрокес**](icontextnode-setstrokes.md), если это рукописный конечный **контекстноде**. Неправильное задание этого расположения и подузла или сведений о штрихах приведет к возникновению исключения **InvalidOperation** . Подузлы для **контекстноде** контейнера могут быть заданы как частично заполненные. в этом случае будут созданы более **популатеконтекстноде** события, если **InkAnalyzer** определит, что они понадобятся для текущей операции анализа.

Приведенные ниже таблицы описывают, когда будет вызвано событие [**популатеконтекстноде**](-ianalysisproxyevents-populatecontextnode.md) в течение использования [**InkAnalyzer**](inkanalyzer.md).

После того как [**InkAnalyzer**](inkanalyzer.md) вычислит некоторые результаты, он вернется в приложение, чтобы обновить результаты. Первое вызванное событие — это событие [**инканализерстатечангинг**](-ianalysisproxyevents-inkanalyzerstatechanging.md) . Это событие просто означает, что приложение, **InkAnalyzer** состояние дерева объекта, будет изменено. Это дает приложениям возможность установить для флага [**партиаллипопулатед**](icontextnode-setpartiallypopulated.md) значение true на любом [**контекстнодес**](icontextnodes.md) , где состояние хранится в других местах. Затем **InkAnalyzer** порождает ряд событий [**популатеконтекстноде**](-ianalysisproxyevents-populatecontextnode.md) , чтобы обменять текущее состояние данных. После этого детермиенд Операция сверки компелтед, чтобы определить, какие фоновые результаты все еще можно применить.

Чтобы применить результаты к [**InkAnalyzer**](inkanalyzer.md) , порождается ряд событий изменения дерева. События изменения дерева описывают, пошаговое и все изменения, необходимые для обновления результатов. Эти события предназначены для обработки в суцессион без интеруптион или отмены. Если операция анализа была отменена (через метод [**Abort**](iinkanalyzer-abort.md) ) во время обработки событий изменения дерева, то состояние **InkAnalyzer** будет недействительным, и может потребоваться повторное проанализировать весь документ.

Приведенные ниже таблицы описывают события изменения дерева, возникающие в течение всего использования InkAnalyzer. Таблицы ссылаются на метки времени, показанные на схеме потока событий.

![иимаже, показывающий последовательность между пользовательским интерфейсом приложения и анализатором фонового анализа](images/7a0a54af-889e-43ed-8689-7f2d685567bf.jpg)

### <a name="adding-a-stroke"></a>Добавление штриха



| Метка времени | Тип или цель события | Создано событие | Комментировать                          |
|--------------------------|-------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| T1, T5 и T9<br/> | \[Внутреннее \] событие просмотра дерева вызова аддстроке () \[\]<br/> | Вызвано событие [**популатеконтекстноде**](-ianalysisproxyevents-populatecontextnode.md)<br/> | В зависимости от того, сколько **неклассифицированных**[**контекстнодес**](icontextnodes.md) существует со значением [**партиаллипопулатед**](icontextnode-setpartiallypopulated.md) , установленным в true, может быть вызвано n количество событий [**популатеконтекстноде**](-ianalysisproxyevents-populatecontextnode.md) .<br/> |
| T1, T5 и T9<br/> | \[Событие изменения дерева\]<br/>                                  | Вызвано событие [**контекстнодекреатед**](-ianalysisproxyevents-contextnodecreated.md)<br/>   | В результате вызова метода [**аддстроке**](iinkanalyzer-addstroke.md) будет создано только одно событие [**контекстнодекреатед**](-ianalysisproxyevents-contextnodecreated.md) . Все штрихи добавляются в один и тот же неклассифицированный [**контекстноде**](icontextnode.md).<br/>                      |



 

### <a name="deleting-a-stroke"></a>Удаление штриха



| Метка времени | Тип или цель события | Создано событие | Комментировать                          |
|---------------------------|-----------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| T2, T6 и T10<br/> | \[Внутреннее событие просмотра дерева вызова [**ремовестроке**](iinkanalyzer-removestroke.md)() \] \[\]<br/> | [**Популатеконтекстноде**](-ianalysisproxyevents-populatecontextnode.md) Вызвано событие<br/> | В зависимости от числа [**контекстнодес**](icontextnodes.md) , связанных с удаляемыми штрихами, может быть создано несколько [**популатеконтекстноде**](-ianalysisproxyevents-populatecontextnode.md) событий, значение которых равно [**партиаллипопулатед**](icontextnode-setpartiallypopulated.md) true.<br/> |
| T2, T6 и T10<br/> | \[Событие изменения дерева\]<br/>                                                                          | [**Контекстнодеделетинг**](-ianalysisproxyevents-contextnodedeleting.md) Вызвано событие<br/> | В зависимости от удаляемого содержимого рукописного ввода и текущей структуры анализа может возникнуть любое количество событий [**контекстнодеделетинг**](-ianalysisproxyevents-contextnodedeleting.md) .<br/>                                                                                                       |



 

### <a name="calling-the-backgroundanalyze-method"></a>Вызов метода Баккграунданализе



| Метка времени | Тип или цель события | Создано событие | Комментировать                          |
|-----------------------|---------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| T3<br/>         | \[Внутреннее событие просмотра дерева вызова [**баккграунданализе**](iinkanalyzer-backgroundanalyze.md)() \] \[\]<br/> | [**Популатеконтекстноде**](-ianalysisproxyevents-populatecontextnode.md) Вызвано событие<br/> | Может возникнуть n [**популатеконтекстноде**](-ianalysisproxyevents-populatecontextnode.md) событий в зависимости от того, сколько [**контекстнодес**](icontextnodes.md) в дереве имеет значение [**партиаллипопулатед**](icontextnode-createpartiallypopulatedsubnode.md) true (по одному событию на [**Контекстноде**](icontextnode.md) , которое требуется в текущей операции анализа).<br/> |



 

### <a name="after-the-call-to-backgroundanalyze-returns"></a>После вызова Баккграунданализе () возвращает



| Метка времени | Тип или цель события | Создано событие | Комментировать                          |
|-----------------------|---------------------------------------------|----------------------------------|----------------------------------------------------------------------------------------------|
| T3 в T7<br/>   | \[События, вызванные из потока BG\]<br/> | Вызвано событие действия<br/> | В течение этого фонового периода анализа будут созданы несколько событий действий.<br/> |



 

### <a name="when-intermediateresults-are-ready"></a>Когда Интермедиатересултс будут готовы



| Метка времени | Тип или цель события | Создано событие | Комментировать                          |
|-----------------------|----------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| T7 T8<br/>   | \[События, вызываемые из потока BG, обозначающие начало первой операции выверки\]<br/> | [**Инканализерстатечангинг**](-ianalysisproxyevents-inkanalyzerstatechanging.md) Вызвано событие<br/>         | Вызвано только одно событие [**инканализерстатечангинг**](-ianalysisproxyevents-inkanalyzerstatechanging.md) . Это событие возникает перед изучением состояния [**InkAnalyzer**](inkanalyzer.md), давая приложению возможность задать значение [**партиаллипопулатед**](icontextnode-setpartiallypopulated.md) на всех узлах или выполнить необходимую блокировку локального документа.<br/> |
| T7 T8<br/>   | \[Событие исследования дерева\]<br/>                                                              | [**Популатеконтекстноде**](-ianalysisproxyevents-populatecontextnode.md) Вызвано событие<br/>                   | В зависимости от рукописного содержимого может возникнуть n [**популатеконтекстноде**](-ianalysisproxyevents-populatecontextnode.md) событий.<br/>                                                                                                                                                                                                                                               |
| T7 T8<br/>   | \[Событие изменения дерева\]<br/>                                                             | [**Контекстнодекреатед**](-ianalysisproxyevents-contextnodecreated.md) Вызвано событие<br/>                     | В зависимости от рукописного содержимого может возникнуть n [**контекстнодекреатед**](-ianalysisproxyevents-contextnodecreated.md) событий.<br/>                                                                                                                                                                                                                                                 |
| T7 T8<br/>   | \[Событие изменения дерева\]<br/>                                                             | [**Контекстнодеделетинг**](-ianalysisproxyevents-contextnodedeleting.md) Вызвано событие<br/>                   | В зависимости от рукописного содержимого может возникнуть n [**контекстнодеделетинг**](-ianalysisproxyevents-contextnodedeleting.md) событий.<br/>                                                                                                                                                                                                                                               |
| T7 T8<br/>   | \[Событие изменения дерева\]<br/>                                                             | [**контекстнодемовингтопоситион**](-ianalysisproxyevents-contextnodemovingtoposition.md)<br/>                | В зависимости от рукописного содержимого может возникнуть n [**контекстнодемовингтопоситион**](-ianalysisproxyevents-contextnodemovingtoposition.md) событий.<br/>                                                                                                                                                                                                                               |
| T7 T8<br/>   | \[Событие изменения дерева\]<br/>                                                             | [**контекстнодерепарентинг**](-ianalysisproxyevents-contextnodereparenting.md)<br/>                          | В зависимости от рукописного содержимого может возникнуть n [**контекстнодерепарентинг**](-ianalysisproxyevents-contextnodereparenting.md) событий.<br/>                                                                                                                                                                                                                                         |
| T7 T8<br/>   | \[Событие изменения дерева\]<br/>                                                             | [**строкерепарентед**](-ianalysisproxyevents-strokereparented.md)<br/>                                      | В зависимости от рукописного содержимого может возникнуть n [**строкерепарентед**](-ianalysisproxyevents-strokereparented.md) событий.<br/>                                                                                                                                                                                                                                                     |
| T7 T8<br/>   | \[Событие изменения дерева\]<br/>                                                             | [**контекстноделинкаддинг**](-ianalysisproxyevents-contextnodelinkadding.md)<br/>                            | В зависимости от рукописного содержимого может возникнуть n [**контекстноделинкаддинг**](-ianalysisproxyevents-contextnodelinkadding.md) событий.<br/>                                                                                                                                                                                                                                           |
| T7 T8<br/>   | \[Событие изменения дерева\]<br/>                                                             | [**контекстноделинкделетинг**](-ianalysisproxyevents-contextnodelinkdeleting.md)<br/>                        | В зависимости от рукописного содержимого может возникнуть n [**контекстноделинкделетинг**](-ianalysisproxyevents-contextnodelinkdeleting.md) событий.<br/>                                                                                                                                                                                                                                       |
| T7 T8<br/>   | \[Событие изменения дерева\]<br/>                                                             | [**Контекстнодепропертиесупдатед**](-ianalysisproxyevents-contextnodepropertiesupdated.md) Вызвано событие<br/> | В зависимости от рукописного содержимого может возникнуть n [**контекстнодепропертиесупдатед**](-ianalysisproxyevents-contextnodepropertiesupdated.md) событий. **Контекстнодепропертиесупдатед** планируется создаваемых после того, как все другие события изменения [**контекстноде**](icontextnode.md) будут вызваны в течение этого периода [**выверки**](iinkanalyzer-reconcile.md) .<br/>              |
| T7 T8<br/>   | \[Событие обозначает конец первой операции выверки\]<br/>                            | [**Интермедиатересултс**](-ianalysisevents-intermediateresults.md) Вызвано событие<br/>                        | Для каждой операции анализа будет создано только одно событие [**интермедиатересултс**](-ianalysisevents-intermediateresults.md) .<br/>                                                                                                                                                                                                                                                                  |



 

### <a name="after-intermediateresults-have-been-handled"></a>После обработки Интермедиатересултс



| Метка времени | Тип или цель события | Создано событие | Комментировать                          |
|-----------------------|---------------------------------------------|-----------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------|
| T8 T11<br/>  | \[События, вызванные из потока BG\]<br/> | [**Действие**](-ianalysisevents-activity.md) Вызвано событие<br/> | В течение этого фонового периода анализа будут созданы несколько событий [**действий**](-ianalysisevents-activity.md) .<br/> |



 

### <a name="when-final-results-are-ready"></a>Когда окончательные результаты будут готовы



| Метка времени | Тип или цель события | Создано событие | Комментировать                          |
|-----------------------|-----------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| T11 T12<br/> | \[События, вызываемые из потока BG, обозначающие начало второй операции выверки\]<br/> | [**Инканализерстатечангинг**](-ianalysisproxyevents-inkanalyzerstatechanging.md) Вызвано событие<br/>         | Вызвано только одно событие [**инканализерстатечангинг**](-ianalysisproxyevents-inkanalyzerstatechanging.md) . Это событие возникает перед изучением состояния [**InkAnalyzer**](inkanalyzer.md), давая приложению возможность задать значение [**партиаллипопулатед**](icontextnode-setpartiallypopulated.md) на всех узлах или выполнить необходимую блокировку локального документа.<br/> |
| T11 T12<br/> | \[Событие исследования дерева\]<br/>                                                               | [**Популатеконтекстноде**](-ianalysisproxyevents-populatecontextnode.md) Вызвано событие<br/>                   | В зависимости от рукописного содержимого может возникнуть любое количество событий [**популатеконтекстноде**](-ianalysisproxyevents-populatecontextnode.md) .<br/>                                                                                                                                                                                                                                             |
| T11 T12<br/> | \[Событие изменения дерева\]<br/>                                                              | [**Контекстнодекреатед**](-ianalysisproxyevents-contextnodecreated.md) Вызвано событие<br/>                     | В зависимости от рукописного содержимого может возникнуть любое количество событий [**контекстнодекреатед**](-ianalysisproxyevents-contextnodecreated.md) .<br/>                                                                                                                                                                                                                                               |
| T11 T12<br/> | \[Событие изменения дерева\]<br/>                                                              | [**Контекстнодеделетинг**](-ianalysisproxyevents-contextnodedeleting.md) Вызвано событие<br/>                   | В зависимости от рукописного содержимого может возникнуть любое количество событий [**контекстнодеделетинг**](-ianalysisproxyevents-contextnodedeleting.md) .<br/>                                                                                                                                                                                                                                             |
| T11 T12<br/> | \[Событие изменения дерева\]<br/>                                                              | [**контекстнодемовингтопоситион**](-ianalysisproxyevents-contextnodemovingtoposition.md)<br/>                | В зависимости от рукописного содержимого может возникнуть любое количество событий [**контекстнодемовингтопоситион**](-ianalysisproxyevents-contextnodemovingtoposition.md) .<br/>                                                                                                                                                                                                                             |
| T11 T12<br/> | \[Событие изменения дерева\]<br/>                                                              | [**контекстнодерепарентинг**](-ianalysisproxyevents-contextnodereparenting.md)<br/>                          | В зависимости от рукописного содержимого может возникнуть любое количество событий [**контекстнодерепарентинг**](-ianalysisproxyevents-contextnodereparenting.md) .<br/>                                                                                                                                                                                                                                       |
| T11 T12<br/> | \[Событие изменения дерева\]<br/>                                                              | [**строкерепарентед**](-ianalysisproxyevents-strokereparented.md)<br/>                                      | В зависимости от рукописного содержимого может возникнуть любое количество событий [**строкерепарентед**](-ianalysisproxyevents-strokereparented.md) .<br/>                                                                                                                                                                                                                                                   |
| T11 T12<br/> | \[Событие изменения дерева\]<br/>                                                              | [**контекстноделинкаддинг**](-ianalysisproxyevents-contextnodelinkadding.md)<br/>                            | В зависимости от рукописного содержимого может возникнуть любое количество событий [**контекстноделинкаддинг**](-ianalysisproxyevents-contextnodelinkadding.md) .<br/>                                                                                                                                                                                                                                         |
| T11 T12<br/> | \[Событие изменения дерева\]<br/>                                                              | [**контекстноделинкделетинг**](-ianalysisproxyevents-contextnodelinkdeleting.md)<br/>                        | В зависимости от рукописного содержимого может возникнуть любое количество событий [**контекстноделинкделетинг**](-ianalysisproxyevents-contextnodelinkdeleting.md) .<br/>                                                                                                                                                                                                                                     |
| T11 T12<br/> | \[Событие изменения дерева\]<br/>                                                              | [**Контекстнодепропертиесупдатед**](-ianalysisproxyevents-contextnodepropertiesupdated.md) Вызвано событие<br/> | В зависимости от рукописного содержимого может возникнуть любое количество событий [**контекстнодепропертиесупдатед**](-ianalysisproxyevents-contextnodepropertiesupdated.md) . **Контекстнодепропертиесупдатед** планируется создаваемых после того, как все другие события изменения [**контекстноде**](icontextnode.md) будут вызваны в течение этого периода [**выверки**](iinkanalyzer-reconcile.md) .<br/>            |
| T11 T12<br/> | \[Событие обозначает конец второй операции выверки\]<br/>                            | [**Результаты поиска**](-ianalysisevents-results.md) Вызвано событие<br/>                                                | Для каждой операции анализа будет создано только одно событие [**Results**](-ianalysisevents-results.md) .<br/>                                                                                                                                                                                                                                                                                          |



 

 

 




