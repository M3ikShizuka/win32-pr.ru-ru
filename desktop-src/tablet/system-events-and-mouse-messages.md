---
description: Приложение обеспечивает оптимальное проектирование и использование пера планшета, отправляя как сообщения мыши Microsoft Windows, так и системные события.
ms.assetid: ccd45b68-f037-43da-a7d0-1df9439afd11
title: Системные события и сообщения мыши
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 45c068e30db6ca1a85429667e2a8f1f93c505299
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105674394"
---
# <a name="system-events-and-mouse-messages"></a>Системные события и сообщения мыши

Приложение обеспечивает оптимальное проектирование и использование пера планшета, отправляя как сообщения мыши Microsoft Windows, так и системные события. Приложения получают оба набора событий для каждого движения или действия пером. Затем приложение выбирает соответствующее событие для использования в зависимости от контекста действия. Сообщения мыши Windows хорошо подходят для указания и выбора действий, и их следует использовать для действий, которые подразумевают взаимодействие с элементами пользовательского интерфейса. События пера хорошо подходят для приложений рукописного ввода в реальном времени, действий пером и рукописного ввода.

> [!Note]  
> События пера и сообщения мыши отправляются в приложение независимо от того, используется ли перо или мышь.

 

## <a name="distinguishing-pen-input-from-mouse-and-touch"></a>Различение перьевого ввода с помощью мыши и касания

Когда приложение получает сообщение мыши (например, WM \_ лбуттондовн), оно может вызвать функцию [**жетмессажеекстраинфо**](/windows/win32/api/winuser/nf-winuser-getmessageextrainfo) , чтобы определить, поступило ли сообщение от планшетного устройства или с помощью мыши.

Значение, возвращаемое из [**жетмессажеекстраинфо**](/windows/win32/api/winuser/nf-winuser-getmessageextrainfo) , должно быть проверено маской на 0xFFFFFF00, а затем сравниваться с 0xFF515700. Следующие определения могут сделать это более понятным:


```C++
#define MI_WP_SIGNATURE<entity type="nbsp"/> 0xFF515700
#define SIGNATURE_MASK<entity type="nbsp"/><entity type="nbsp"/> 0xFFFFFF00
#define IsPenEvent(dw)<entity type="nbsp"/><entity type="nbsp"/> (((dw) & SIGNATURE_MASK) == MI_WP_SIGNATURE
```



Если сравнение истинно, то это сообщение мыши было создано пером планшетного ПК или сенсорным экраном. Во всех остальных случаях можно предположить, что это сообщение создано устройством мыши.

Младшие 8 бит, возвращенные из [**жетмессажеекстраинфо**](/windows/win32/api/winuser/nf-winuser-getmessageextrainfo) , являются переменными. Из этих разрядов 7 (Нижняя 7, Маскированная на 0x7F) используется для представления идентификатора курсора, нуля для мыши или значения переменной для идентификатора пера. Кроме того, в Windows Vista восьмой бит, маскированный по 0x80, используется для различения сенсорного ввода с помощью перьевого ввода (0 = перо, 1 = сенсорный ввод).

## <a name="supported-system-gestures"></a>Поддерживаемые системные жесты

В следующей таблице перечислены системные жесты, которые в настоящее время входят в состав Windows XP Tablet PC Edition, подробно описаны соответствующие действия пера и системные события, а также показано, как они связаны с традиционными действиями мыши.



| Жест пера                                  | Действие мыши                                                    | Описание жеста пера                                                                                                                                                                                                             | Сообщения о событиях                                                                                                                       | Сообщения мыши                                                                                                                        | Поведение в приложениях на основе Windows                                                                                                                                          |
|----------------------------------------------|-----------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Касание<br/>                               | Щелчок левой кнопкой<br/>                                           | Коснитесь экрана один раз с помощью пера.<br/>                                                                                                                                                                                        | ISG \_ касание, отправленное при поднятии пера.<br/>                                                                                         | \_ЛБУТТОНДОВН WM и WM \_ лбуттонуп отправляются, когда перо ликвидируется.<br/>                                                                    | Выберите команду в меню или на панели инструментов, выполните действие, если выбрана команда, задать точку вставки (IP), и отобразится отзыв о выборе.<br/>                                                |
| Двойное касание<br/>                        | Двойной щелчок<br/>                                         | Нажмите дважды кнопку "экран", чтобы ускорить выполнение.<br/>                                                                                                                                                                                    | ISG \_ даублетап, отправленный вторым касанием (вниз). \_Событие касания ISG, отправленное при первом касании.<br/>                                           | \_ЛБУТТОНДБЛКЛК WM, отправленный вторым касанием (вниз). WM \_ лбуттондовн и WM \_ лбуттонуп посылаются по первому касанию (up) как для одного касания.<br/> | Выберите Word, откройте файл или папку.<br/>                                                                                                                                     |
| Нажатие и удерживание<br/>                    | Щелкните правой кнопкой мыши<br/>                                          | Коснитесь экрана и удерживайте, пока не появится значок мыши, а затем поднимите перо, чтобы отобразить контекстное меню. Приложение может выполнить действие, отличное от отображения контекстного меню, когда перо ликвидируется.<br/> | ISG \_ холдентер посылается, когда перо достаточно долго. ISG \_ ригхттап отправляется, когда перо ликвидируется и происходит щелчок правой кнопкой мыши.<br/> | WM \_ рбуттондовн и WM \_ рбуттонуп отправляются при щелчке правой кнопкой мыши (когда перо ликвидируется).<br/>                                       | Отображение контекстного меню.<br/>                                                                                                                                                   |
| С удержанием<br/>                      | Щелчок левой кнопкой<br/>                                           | Коснитесь экрана и удерживайте, пока значок мыши не появится и исчезнет. Пользователи, скорее всего, будут делать это при случайном нажатии и удержании и необходимости вернуться к простому касанию.<br/>                                                 | ISG \_ касание, отправленное при поднятии пера.<br/>                                                                                         | \_ЛБУТТОНДОВН WM и WM \_ лбуттонуп отправляются, когда перо ликвидируется.<br/>                                                                 | Щелкните левой кнопкой мыши в течение долгого времени. Эквиваленты мыши не существует. Это резервный вариант, когда пользователь выполняет нажатие клавиш и удерживает его в течение длительного времени. Событие возвращается к отводам.<br/> |
| Перетаскивание<br/>                              | Перетаскивание левой границы<br/>                                            | Коснитесь экрана, чтобы выбрать перемещаемый объект, а затем перетащите его после выбора объекта.<br/>                                                                                                                     | ISG \_ перетаскивание, когда начинается перетаскивание.<br/>                                                                                          | WM \_ лбуттондовн отправляется при запуске перетаскивания, за которым следуют ряд сообщений о перемещении мыши, за которыми следует \_ событие WM лбуттонуп.<br/> | При запуске с IP-адресом используйте перетаскивание, как в Microsoft Word. Выберите несколько слов; Перетащите объект, как при перетаскивании объекта в Windows. прокрутки.<br/>                            |
| Нажатие и удержание с последующим перетаскиванием<br/> | Перетаскивание правой кнопкой мыши<br/>                                           | Коснитесь экрана, чтобы выбрать перемещаемый объект. Удерживайте до тех пор, пока не появится значок мыши, а затем перетащите его, чтобы переместить объект. Поднимите перо, чтобы отобразить контекстное меню.<br/>                                                   | ISG \_ холдентер отправляется, когда перо некоторое время не работает. ISG \_ ригхтдраг, отправленный при запуске перетаскивания.<br/>                           | WM \_ рбуттондовн отправляется при запуске перетаскивания, за которым следуют ряд сообщений о перемещении мыши, за которыми следует \_ событие WM рбуттонуп.<br/>     | Перетащите объект, как при перетаскивании объекта или выделения, за которым следует контекстное меню.<br/>                                                                                             |
| Наведение пера<br/>                         | Наведение указателя мыши<br/>                                          | Держите перо на маленьком расстоянии от экрана.<br/>                                                                                                                                                                 | \_Первоначально отправлено событие ISG ховерентер. По завершении интервала наведения \_ направляется ISG ховерлеавеис.<br/>                           | Нет эквивалента сообщения от мыши.<br/>                                                                                               | Показывать подсказку, эффекты отката и другие поведения при наведении указателя мыши.<br/>                                                                                                     |
| In-Air встряхните<br/>                      | Отображение **панели ввода ПЛАНШЕТНОГО ПК**. Не эквивалент мыши.<br/> | Быстро передвиньте перо с боковой стороны на сторону, сохранив приведенную выше подсказку, но в пределах диапазона экрана.<br/>                                                                                                                          | Событие не передается в приложение.<br/>                                                                                   | Нет эквивалента сообщения от мыши.<br/>                                                                                               | Новые, только для планшетных ПК.<br/>                                                                                                                                           |



 

## <a name="specifying-stylus-and-touch-interactions"></a>Выбор пера и сенсорного взаимодействия

По умолчанию окно будет принимать все события системных жестов и использовать модель взаимодействия по умолчанию. Некоторые части этой модели могут повлиять на работу приложения, поэтому вы можете отключить их выборочно, выполнив ответ на [**\_ \_ сообщение куерисистемжестурестатус WM планшета**](wm-tablet-querysystemgesturestatus-message.md) в WndProc.

 

 
