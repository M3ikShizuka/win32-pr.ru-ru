---
description: Настраивает обмен данными с общей памятью для контекста планшета.
ms.assetid: 63e6b271-d89a-4c91-9a15-9e41dcdfa363
title: 'Метод Итаблетконтекстп:: Усенамедшаредмеморикоммуникатионс'
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- ITabletContextP.UseNamedSharedMemoryCommunications
api_type:
- COM
api_location:
- Wisptis.exe
- Wisptis.exe.dll
ms.openlocfilehash: a8ce5d4dde7f3fd678e4ac748a0f148750344a1e5e8da9f6481ad25eafa016a9
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119712234"
---
# <a name="itabletcontextpusenamedsharedmemorycommunications-method"></a>Метод Итаблетконтекстп:: Усенамедшаредмеморикоммуникатионс

Настраивает обмен данными с общей памятью для контекста планшета.

## <a name="syntax"></a>Синтаксис


```C++
HRESULT UseNamedSharedMemoryCommunications(
  [in]  DWORD  pid,
  [in]  LPCSTR pszCallerSid,
  [in]  LPCSTR pszCallerIntegritySid,
  [out] DWORD  *pdwEventMoreDataId,
  [out] DWORD  *pdwEventClientReadyId,
  [out] DWORD  *pdwMutexAccessId,
  [out] DWORD  *pdwFileMappingId
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*идентификатор процесса* \[ окне\]
</dt> <dd>

Идентификатор процесса клиента, обращающегося к общей памяти.

</dd> <dt>

*псзкаллерсид* \[ окне\]
</dt> <dd>

Идентификатор безопасности вызывающего объекта функции.

</dd> <dt>

*псзкаллеринтегритисид* \[ окне\]
</dt> <dd>

Идентификатор безопасности, который может проверять целостность вызывающей функции.

</dd> <dt>

*пдвевентморедатаид* \[ заполняет\]
</dt> <dd>

Целое число, используемое для создания имени события. Событие указывает, есть ли дополнительные данные.

</dd> <dt>

*пдвевентклиентреадид* \[ заполняет\]
</dt> <dd>

Целое число, используемое для создания имени события. Событие сигнализирует, что клиент готов к приему данных. Событие сообщается после обработки новых данных.

</dd> <dt>

*пдвмутексакцессид* \[ заполняет\]
</dt> <dd>

Указатель на идентификатор доступа общей памяти.

</dd> <dt>

*пдвфилемаппингид* \[ заполняет\]
</dt> <dd>

Целое число, определяющее общую память.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Если этот метод завершается успешно, возвращается значение **S \_ ОК**. В противном случае возвращается код ошибки **HRESULT** .

## <a name="remarks"></a>Remarks

Метод **усенамедшаредмеморикоммуникатионс** является частью протокола общей памяти Tablet PC. Клиент без повышенных привилегий передает идентификатор безопасности (SID) и идентификатор безопасности уровня целостности (IL-SID), чтобы служба планшета могла использовать списки управления доступом (ACL) для доступа к объектам общей памяти. Если клиент имеет повышенные привилегии, он должен использовать Усешаредмеморикоммуникатионс — API, который вызывается, если у службы уже есть привилегия с повышенными правами.

В [**структуре \_ заголовка шаредмемори**](sharedmemory-header.md) хранится заголовок общей памяти.

Структура [**\_ заголовка шаредмемори**](sharedmemory-header.md) приводится к данным, на которые ссылается сопоставление файлов. Необработанные данные пакета следуют **\_ заголовку шаредмемори**. Необработанные данные пакетов можно считывать из общей памяти при возникновении события, на которое ссылается *пдвевентклиентреадид* .

В следующем списке приводится последовательность событий для доступа к общей памяти и использования ее.

1.  Клиент вызывает событие Клиентреади.
2.  Клиент ожидает события moreData.
3.  Клиент получает мьютекс.
4.  Клиент считывает данные пакета из раздела общей памяти, который следует за заголовком. Серийные номера отображаются в общей памяти после данных пакета.
5.  Клиент обрабатывает данные в зависимости от значения **двевент**.
6.  Клиент записывает-1 (0xFFFFFFFF) в **двевент**.
7.  Клиент освобождает мьютекс.
8.  Клиент вызывает событие Клиентреади.

Имена событий создаются путем форматирования выходных данных этого метода. Следующие определения можно использовать в сочетании с sprintf или его эквивалентом для создания имен событий.


```C++
#define WISPTIS_SM_MORE_DATA_EVENT_NAME     _T("wisptis-1-%d-%u")
#define WISPTIS_SM_CLIENT_DONE_EVENT_NAME   _T("wisptis-2-%d-%u")
#define WISPTIS_SM_SECTION_NAME             _T("wisptis-3-%d-%u")
#define WISPTIS_SM_THREAD_EVENT_NAME        _T("wisptis-4-%u")
```



В каждом определении раздел% d заменяется ИДЕНТИФИКАТОРом процесса, а раздел% u заменяется целым числом, возвращенным в *пдвевентморедатаид* или *пдвевентклиентреадид*.

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|----------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows \[Только классические приложения Vista\]<br/>                                         |
| Минимальная версия сервера<br/> | Ни одна версия не поддерживается<br/>                                                              |
| Библиотека<br/>                  | <dl> <dt>Wisptis.exe</dt> </dl> |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**усешаредмеморикоммуникатионс**](itabletcontextp-usesharedmemorycommunications.md)
</dt> <dt>

[**итаблетконтекстп**](itabletcontextp.md)
</dt> </dl>

 

 




