---
description: Чтобы помочь в поддержке рукописного ввода в приложениях, существуют два объекта, оба из которых могут быть внедрены и поддерживаются любым контейнером OLE.
ms.assetid: fbd7bdf0-63b4-48d1-be91-eabbbb3f1618
title: Приемники и объекты Тинк
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4ef7ed1c06d256fe8eda9fad4bf15afa19fcb833
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105674403"
---
# <a name="sink-and-tink-objects"></a>Приемники и объекты Тинк

Чтобы помочь в поддержке рукописного ввода в приложениях, существуют два объекта, оба из которых могут быть внедрены и поддерживаются любым контейнером OLE. Они создаются путем вызова **метода Ink. клипбоардкопи (прямоугольника, инкклипбоардформатс, инкклипбоардмодес)** или **метода Ink. клипбоардкопи (штрихов, инкклипбоардформатс, InkClipboardModes)** .

-   Объект рукописного ввода текста (Тинк). Это объект OLE, представляющий рукописный ввод, который должен образовывать слова. Объект Тинк позволяет преобразовать рукописный ввод в текст в виде текста, возвращаемого распознавателем, или выбора, полученного из списка вариантов распознавания. Цвет и размер рукописного ввода могут быть заданы программно и могут основываться на атрибутах текста вокруг объекта. Объект Тинк должен содержать одно слово. Объект Тинк — это небольшой легковесный объект, который может выполнять простые операции вроде отрисовки (с заданными маркерами контекста устройства (HDC) и RECT) и сохранения самого себя (при наличии потока). Использование объекта Тинк обеспечивает удобство работы пользователя при работе в приложении, использующем входные и рукописные данные и текст.
-   Объект рукописного ввода эскиза (приемник). Это объект OLE, представляющий рукописный ввод, который не должен сообразовывать слова. Объект-приемник интерпретируется как рисунок. Объект-приемник также полезен для представления нескольких слов.

Эти объекты можно использовать для взаимодействия приложений либо путем их помещения в область объектов OLE в буфере обмена, либо путем их внедрения в формате RTF.

Объекты Тинк и sInk можно использовать следующими способами.

-   В Microsoft Word 2002 поддерживаются объекты Тинк и sInk. Пользователи могут вставлять рукописные данные в документ Word с помощью панелей рукописного ввода и вывода текста, представленных в Word 2002. Этот рукописный ввод внедряется в файл Word как объект OLE с идентификатором CLSID объекта приемника или Тинк.
-   Элемент управления [InkEdit](/previous-versions/ms552265(v=vs.100)) планшетного ПК использует объект Тинк. Элемент управления InkEdit является подклассом стандартного элемента управления [RichTextBox](/dotnet/api/system.windows.forms.richtextbox?view=netcore-3.1) . Рукописный ввод вставляется в поток RTF элемента управления InkEdit в виде объекта Тинк.
-   Когда приложение перемещает выбранный объект [рукописного ввода](/previous-versions/aa515768(v=msdn.10)) в буфер обмена, в слоте буфера обмена объектов OLE СОДЕРЖИТСЯ объект OLE Тинк или Sink.

Например, приложение может распознать рукописный ввод и пометить любой объект [рукописного](/previous-versions/aa515768(v=msdn.10)) ввода как объект Тинк. Если выбрать слово в рукописном вводе, скопировать и вставить его в Word, варианты для этого слова будут показаны в Word 2002.

> [!Note]  
> При помещении в буфер обмена объекта приемника или Тинк в качестве объекта OLE в буфере обмена для платформы Tablet PC поддерживается автоматический выбор флага расширенный метафайл (EMF). Сам объект хранится в буфере обмена в слотах источника и объекта внедрения.

 

В качестве другого примера с помощью объекта sInk можно нарисовать набросок в приложении, скопировать и вставить эскиз в Word 2002, а затем редактировать рисунок с помощью панели ввода Tablet PC в Word.

Чтобы успешно содержать объекты Тинк, приложение должно реализовать поддержку контейнера OLE для внедренных объектов. Затем, чтобы сделать контейнер полностью поддерживаемым Тинк, необходимо Институт:

-   Изменения в коде для поиска и замены. Вместо того чтобы пропускать внедренные объекты в поиске, эти объекты должны быть опрошены для типа. Если они являются объектом Тинк, они должны быть созданы и запрошены для соответствующего текста.
-   Изменения в поведении выбора. Выбор объектов Тинк никогда не должен появляться с маркерами изменения размера. Они должны быть выбраны точно так же, как текст выбирается в документе. Код выбора для объектов должен определять, является ли тип Тинк, и отображать выбор соответствующим образом.
-   Использование внешних свойств. Свойства окружающей среды, такие как размер шрифта, цвет и полужирное начертание, должны передаваться в объект Тинк. Приложение этих свойств изменяет ширину рукописных рукописных данных, поэтому требуется обновление размера путем вызова [**метода жетинкекстент**](/windows/desktop/api/msinkaut/nf-msinkaut-iinklineinfo-getinkextent) или метода [иолеобжект::-экстента](/windows/win32/api/oleidl/nf-oleidl-ioleobject-getextent) .
-   Переопределите метод обработки [иолеобжект::D оверб](/windows/win32/api/oleidl/nf-oleidl-ioleobject-doverb) по умолчанию. Это позволяет преобразовать в текст, чтобы передать в распознаватель пакет объектов Тинк, который затем может разбивать слова на сегменты распознавания.

Дополнительные сведения о разбиении слов на сегменты распознавания см. в разделе [сегменты распознавания](recognition-segments.md).

 

 
