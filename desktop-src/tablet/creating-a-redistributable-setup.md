---
description: Чтобы распространить приложение с поддержкой рукописного ввода на компьютеры, не работающие под управлением Windows Vista или Windows XP Tablet PC Edition 2005 (т. е. компьютеров под управлением Windows XP, Windows Server 2003 или Windows 2000), необходимо включить необходимые модули слияния в программу установки.
ms.assetid: 97515703-0bf4-4230-ae35-181b48b70c40
title: Создание распространяемой программы установки
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d1ad9b9ec8b10032d4a2bb44cca52e5c2f4178b6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104539440"
---
# <a name="creating-a-redistributable-setup"></a>Создание распространяемой программы установки

Чтобы распространить приложение с поддержкой рукописного ввода на компьютеры, не работающие под управлением Windows Vista или Windows XP Tablet PC Edition 2005 (т. е. компьютеров под управлением Windows XP, Windows Server 2003 или Windows 2000), необходимо включить необходимые модули слияния в программу установки.

Модуль Мстпкрт. MSM merge включает все файлы, ресурсы, записи реестра и логику установки, необходимые для установщик Windows установки общих файлов, которые требуются другим платформам для запуска неуправляемых приложений, разработанных для планшетных ПК. Мстпкрт. MSM использует файлы установщик Windows (. msi). Для приложений, использующих объект [**инкдивидер**](inkdivider-class.md) , необходимо также повторно распространить инкдив. msm. Для приложений, использующих управляемые компоненты, необходимо также включить файлы модулей слияния для этих управляемых компонентов.

В следующей таблице описаны файлы модулей слияния, поставляемые с пакетом SDK для Windows XP Tablet PC Edition.



| Распространяемый модуль слияния | Описание                                                                                                                    | Файлы                                                       |
|------------------------------|--------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------|
| Инкдив. MSM<br/>        | Устанавливает неуправляемую версию объекта [**инкдивидер**](inkdivider-class.md) .<br/>                                | InkDiv.dll<br/>                                       |
| Мстпкрт. MSM<br/>       | Устанавливает неуправляемые компоненты платформы Tablet PC версии 1,0.<br/>                                            | Gdiplus.dll, InkEd.dll, Tpcps.dll, Wisptis.exe<br/>   |
| Msvcp60. MSM<br/>       | Устанавливает компоненты среды выполнения Microsoft Visual C++.<br/>                                                            | Msvcp60.dll<br/>                                      |
| Msvcrt. MSM<br/>        | Устанавливает компоненты среды выполнения Microsoft Visual C.<br/>                                                              | Msvcrt.dll<br/>                                       |
| Tpcman17. MSM<br/>      | Устанавливает управляемые компоненты среды выполнения платформы Tablet PC. Требует, чтобы был установлен файл мстпкрт. msm.<br/> | Microsoft.Ink.dll, Microsoft.Ink.resources.dll<br/>   |
| Иаком. MSM<br/>         | Устанавливает компоненты автоматизации API Инканалисис.<br/>                                                          | IACom.dll<br/>                                        |
| IACore. MSM<br/>        | Устанавливает компоненты базового класса API Инканалисис.<br/>                                                          | IACore.dll<br/> IALoader.dll<br/>               |
| Иавинфрм. MSM<br/>      | Устанавливает компоненты управляемой библиотеки API Инканалисис.<br/>                                                     | Microsoft.Ink.Analysis.dll<br/>                       |
| IAWinFX. MSM<br/>       | Устанавливает Windows Presentation Foundation компонентов API Инканалисис.<br/>                                     | IAWinFX.dll<br/>                                      |
| журнал. MSM<br/>       | Устанавливает компоненты модуля чтения журнала.<br/>                                                                             | Journal.dll<br/> Microsoft.ink.journal.dll<br/> |
| ртском. MSM<br/>        | Устанавливает компоненты автоматизации пространства имен Стилусинпут.<br/>                                                    | Rtscom.dll<br/>                                       |



 

> [!Note]  
> Чтобы использовать функциональные возможности платформы Microsoft .NET, включенной в модули слияния для управляемых компонентов, необходимо установить пакет обновления 2 (SP2) для платформы на целевом компьютере.

 

## <a name="reduced-feature-set"></a>Сокращенный набор функций

Приложения с поддержкой рукописного ввода обрабатывают события мыши как движения пером для имитации работы с планшетным пером. Пользователи могут добавлять рукописный ввод, стирать рукописный ввод и сохранять документы с рукописным вводом. Однако распознавание и жесты недоступны для пользователей, не использующих Windows XP Tablet PC Edition.

Мстпкрт. MSM не включает в себя журнал Windows или панель ввода Tablet PC.

Объект [**пенинпутпанел**](peninputpanel-class.md) не работает ни в каких операционных системах, кроме Windows XP Tablet PC Edition.

## <a name="deployment"></a>Развертывание

> [!Note]  
> Если приложение использует управляемый код, необходимо также развернуть платформу. Платформа должна быть установлена до установки управляемых сборок для планшетных ПК.

 

Чтобы включить Мстпкрт. msm в проект установки Microsoft Visual Studio .NET, выполните следующие действия.

1.  В обозреватель решений выберите проект установки.
2.  В меню Проект выберите команду **Добавить**, а затем щелкните **модуль слияния**.
    > [!Note]  
    > Можно также открыть диалоговое окно **Добавление модулей** , щелкнув правой кнопкой мыши имя проекта установщика в Обозреватель решений, нажать кнопку **Добавить**, а затем выбрать **модуль слияния**.

     

3.  В диалоговом окне **Добавление модулей** перейдите к и выберите **мстпкрт. MSM**.
4.  Нажмите кнопку **Открыть**.

Мстпкрт. MSM добавляется в проект установки и отображается в окне обозреватель решений.

Установщик Windows добавляет файлы, содержащиеся в модуле слияния, в папку Program Files. Чтобы использовать эти файлы, конечные пользователи должны войти в систему с учетной записью, имеющей доступ к папке Program Files.

> [!Note]  
> В последовательность установки необходимо добавить действия [селфрегмодулес](../msi/selfregmodules-action.md) и действия [селфунрегмодулес](../msi/selfunregmodules-action.md) . Действия [мсипублишассемблиес](../msi/msipublishassemblies-action.md) и действия [мсиунпублишассемблиес](/windows/desktop/Msi/msiunpublishassemblies-action) получают их порядок в последовательности установки из этих действий.

 

 

