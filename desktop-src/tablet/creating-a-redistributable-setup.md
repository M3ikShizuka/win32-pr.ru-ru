---
description: чтобы распространить приложение с поддержкой рукописного ввода на компьютеры, которые не работают под управлением Windows Vista или Windows XP Tablet PC Edition 2005 (т. е. компьютеров под управлением Windows XP, Windows Server 2003 или Windows 2000), необходимо включить необходимые модули слияния в программу установки.
ms.assetid: 97515703-0bf4-4230-ae35-181b48b70c40
title: Создание распространяемой программы установки
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 80bdd63a00f1f4245ea83173e1a7e609094fe30e5357f5e1ebf3d6da63182cde
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119936874"
---
# <a name="creating-a-redistributable-setup"></a>Создание распространяемой программы установки

чтобы распространить приложение с поддержкой рукописного ввода на компьютеры, которые не работают под управлением Windows Vista или Windows XP Tablet PC Edition 2005 (т. е. компьютеров под управлением Windows XP, Windows Server 2003 или Windows 2000), необходимо включить необходимые модули слияния в программу установки.

модуль мстпкрт. msm merge включает все файлы, ресурсы, записи реестра и логику установки, необходимые для установщик Windows установки общих файлов, которые требуются другим платформам для запуска неуправляемых приложений, разработанных для планшетных пк. мстпкрт. msm потребляется файлами установщик Windows (.msi). Для приложений, использующих объект [**инкдивидер**](inkdivider-class.md) , необходимо также повторно распространить инкдив. msm. Для приложений, использующих управляемые компоненты, необходимо также включить файлы модулей слияния для этих управляемых компонентов.

в следующей таблице описаны файлы модулей слияния, поставляемые с пакетом sdk для Windows XP Tablet PC Edition (пакет средств разработки программного обеспечения).



| Распространяемый модуль слияния | Описание                                                                                                                    | Файлы                                                       |
|------------------------------|--------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------|
| Инкдив. MSM<br/>        | Устанавливает неуправляемую версию объекта [**инкдивидер**](inkdivider-class.md) .<br/>                                | InkDiv.dll<br/>                                       |
| Мстпкрт. MSM<br/>       | Устанавливает неуправляемые компоненты платформы Tablet PC версии 1,0.<br/>                                            | Gdiplus.dll, InkEd.dll, Tpcps.dll, Wisptis.exe<br/>   |
| Msvcp60. MSM<br/>       | устанавливает компоненты среды выполнения Microsoft Visual C++.<br/>                                                            | Msvcp60.dll<br/>                                      |
| Msvcrt. MSM<br/>        | Устанавливает компоненты среды выполнения Microsoft Visual C.<br/>                                                              | Msvcrt.dll<br/>                                       |
| Tpcman17. MSM<br/>      | Устанавливает управляемые компоненты среды выполнения платформы Tablet PC. Требует, чтобы был установлен файл мстпкрт. msm.<br/> | Microsoft.Ink.dll, Microsoft.Ink.resources.dll<br/>   |
| Иаком. MSM<br/>         | Устанавливает компоненты автоматизации API Инканалисис.<br/>                                                          | IACom.dll<br/>                                        |
| IACore. MSM<br/>        | Устанавливает компоненты базового класса API Инканалисис.<br/>                                                          | IACore.dll<br/> IALoader.dll<br/>               |
| Иавинфрм. MSM<br/>      | Устанавливает компоненты управляемой библиотеки API Инканалисис.<br/>                                                     | Microsoft.Ink.Analysis.dll<br/>                       |
| IAWinFX. MSM<br/>       | устанавливает Windows Presentation Foundation компонентов API инканалисис.<br/>                                     | IAWinFX.dll<br/>                                      |
| журнал. MSM<br/>       | Устанавливает компоненты модуля чтения журнала.<br/>                                                                             | Journal.dll<br/> Microsoft.ink.journal.dll<br/> |
| ртском. MSM<br/>        | Устанавливает компоненты автоматизации пространства имен Стилусинпут.<br/>                                                    | Rtscom.dll<br/>                                       |



 

> [!Note]  
> чтобы использовать функции Microsoft платформа .NET Framework, включенные в модули слияния для управляемых компонентов, необходимо установить пакет обновления 2 (sp2) для платформы на целевом компьютере.

 

## <a name="reduced-feature-set"></a>Сокращенный набор функций

Приложения с поддержкой рукописного ввода обрабатывают события мыши как движения пером для имитации работы с планшетным пером. Пользователи могут добавлять рукописный ввод, стирать рукописный ввод и сохранять документы с рукописным вводом. однако распознавание и жесты недоступны для пользователей, не работающих Windows XP Tablet PC Edition.

мстпкрт. msm не включает журнал Windows или панель ввода Tablet PC.

объект [**пенинпутпанел**](peninputpanel-class.md) не работает ни в одной операционной системе, кроме Windows XP Tablet PC Edition.

## <a name="deployment"></a>Развертывание

> [!Note]  
> Если приложение использует управляемый код, необходимо также развернуть платформу. Платформа должна быть установлена до установки управляемых сборок для планшетных ПК.

 

чтобы включить мстпкрт. msm в проект установки Microsoft Visual Studio .net, выполните следующие действия.

1.  В обозреватель решений выберите проект установки.
2.  в меню Project выберите команду **добавить**, а затем — **модуль слияния**.
    > [!Note]  
    > Можно также открыть диалоговое окно **Добавление модулей** , щелкнув правой кнопкой мыши имя проекта установщика в Обозреватель решений, нажать кнопку **Добавить**, а затем выбрать **модуль слияния**.

     

3.  В диалоговом окне **Добавление модулей** перейдите к и выберите **мстпкрт. MSM**.
4.  Нажмите кнопку **Открыть**.

Мстпкрт. MSM добавляется в проект установки и отображается в окне обозреватель решений.

Windows Установщик добавляет файлы, содержащиеся в модуле слияния, в папку Program Files. Чтобы использовать эти файлы, конечные пользователи должны войти в систему с учетной записью, имеющей доступ к папке Program Files.

> [!Note]  
> В последовательность установки необходимо добавить действия [селфрегмодулес](../msi/selfregmodules-action.md) и действия [селфунрегмодулес](../msi/selfunregmodules-action.md) . Действия [мсипублишассемблиес](../msi/msipublishassemblies-action.md) и действия [мсиунпублишассемблиес](/windows/desktop/Msi/msiunpublishassemblies-action) получают их порядок в последовательности установки из этих действий.

 

 

