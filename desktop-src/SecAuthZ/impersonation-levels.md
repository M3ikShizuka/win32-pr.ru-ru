---
description: '\_ \_ Перечисление уровня олицетворения определяет четыре уровня олицетворения, определяющие операции, которые сервер может выполнять в контексте клиентов.'
ms.assetid: ae152dbf-44f0-417f-a85e-09bf60dcfcb0
title: Уровни олицетворения (авторизация)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b91654f42a86e5c47069197bed084df56f5445dd
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105664307"
---
# <a name="impersonation-levels-authorization"></a>Уровни олицетворения (авторизация)

Перечисление [**\_ \_ уровня олицетворения**](/windows/desktop/api/Winnt/ne-winnt-security_impersonation_level) определяет четыре уровня олицетворения, определяющие операции, которые сервер может выполнять в контексте клиента.



| Уровень олицетворения    | Описание                                                                                      |
|------------------------|--------------------------------------------------------------------------------------------------|
| секуритянонимаус      | Серверу не удается олицетворить или опознать клиента.                                            |
| SecurityIdentification | Сервер может получить удостоверение и привилегии клиента, но не может олицетворять клиента. |
| секуритимперсонатион  | Сервер может олицетворять контекст безопасности клиента в локальной системе.                    |
| секуритиделегатион     | Сервер может олицетворять контекст безопасности клиента в удаленных системах.                      |



 

Клиент с именованным каналом, RPC или сеансом DDE может управлять уровнем олицетворения. Например, клиент именованного канала может вызвать функцию [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) , чтобы открыть маркер для именованного канала и указать уровень олицетворения сервера.

Если именованный канал, RPC или сеанс DDE является удаленным, флаги, передаваемые в [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) для установки уровня олицетворения, игнорируются. В этом случае уровень олицетворения клиента определяется уровнями олицетворения, включенными сервером, который задается флагом на учетной записи сервера в службе каталогов. Например, если на сервере разрешено делегирование, то уровень олицетворения клиента также будет настроен на делегирование, даже если флаги, передаваемые в **CreateFile** , указывают уровень олицетворения идентификации.

Клиенты DDE используют функцию [**ддесеткуалитйофсервице**](/windows/win32/api/dde/nf-dde-ddesetqualityofservice) со структурой [**\_ качества \_ \_ службы безопасности**](/windows/desktop/api/Winnt/ns-winnt-security_quality_of_service) для указания уровня олицетворения. По умолчанию для именованных каналов, RPC и серверов DDE используется уровень Секуритимперсонатион. Функции [**имперсонатеселф**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-impersonateself), [**сбой duplicatetoken**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-duplicatetoken)и [**дупликатетокенекс**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-duplicatetokenex) позволяют вызывающей стороне указать уровень олицетворения. Используйте функцию [**GetTokenInformation**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-gettokeninformation) для получения уровня олицетворения [*маркера доступа*](/windows/desktop/SecGloss/a-gly).

На уровне Секуритимперсонатион большая часть действий потока выполняется в контексте безопасности [*токена олицетворения*](/windows/desktop/SecGloss/i-gly) потока, а не в [*первичном маркере*](/windows/desktop/SecGloss/p-gly) [*процесса*](/windows/desktop/SecGloss/p-gly) , владеющего потоком. Например, если олицетворенный поток открывает [защищаемый объект](securable-objects.md), система использует токен олицетворения для проверки доступа к потоку. Аналогично, если олицетворенный поток создает новый объект, например путем вызова функции [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) , владельцем нового объекта является владелец по умолчанию от [*маркера доступа*](/windows/desktop/SecGloss/a-gly)клиента.

Однако система использует основной маркер процесса, а не маркер олицетворения вызывающего потока в следующих ситуациях:

-   Если олицетворенный поток вызывает функцию [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa) , новый процесс всегда наследует основной маркер процесса.
-   Для функций, которым требуется привилегия SE с \_ \_ именем TCB, например функция [**LogonUser**](/windows/desktop/api/winbase/nf-winbase-logonusera) , система всегда проверяет наличие привилегии в первичном маркере процесса.
-   Для функций, которым требуется \_ привилегия разрешения \_ имен аудита SE, например функция [**обжектопенаудиталарм**](/windows/desktop/api/Winbase/nf-winbase-objectopenauditalarma) , система всегда проверяет наличие привилегии в первичном маркере процесса.
-   При вызове функции [**опенсреадтокен**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-openthreadtoken) поток может указать, использует ли функция маркер олицетворения или первичный токен, чтобы определить, предоставлять ли запрошенный доступ.

 

 
