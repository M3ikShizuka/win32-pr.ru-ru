---
description: Запись управления условным доступом (ACE) позволяет оценивать условие доступа при выполнении проверки доступа. Язык определения дескрипторов безопасности (SDDL) предоставляет синтаксис для определения условных элементов ACE в строковом формате.
ms.assetid: cdc3629d-c4d8-4910-8838-3bdb601f7064
title: Язык определения дескрипторов безопасности для условных элементов ACE
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ee0a746460c7582d95e0c95e2a2c179aac2eb29456418234cb52e842c8c56738
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "117780529"
---
# <a name="security-descriptor-definition-language-for-conditional-aces"></a>Язык определения дескрипторов безопасности для условных элементов ACE

[*Запись управления*](/windows/desktop/SecGloss/a-gly) условным доступом (ACE) позволяет оценивать условие доступа при выполнении проверки доступа. Язык определения дескрипторов безопасности (SDDL) предоставляет синтаксис для определения условных элементов ACE в строковом формате.

SDDL для условной записи ACE такой же, как и для любого элемента ACE, с синтаксисом для условной инструкции, добавленной в конец строки ACE. Дополнительные сведения о SDDL см. в разделе [язык определения дескрипторов безопасности](security-descriptor-definition-language.md).

Знак " \# " является синонимом "0" в атрибутах ресурса. Например, Д:АИ (XA; ОИЦИ; FA;;; WD; (Октетстрингтипе = = \# 1 \# 2 \# 3 \# \# )) эквивалентен и интерпретируется как д:АИ (XA; оиЦи; FA;;; WD; (Октетстрингтипе = = \# 01020300)).

-   [Формат строки условной записи ACE](#conditional-ace-string-format)
-   [Условные выражения](#conditional-expressions)
-   [Атрибуты](#attributes)
-   [Операторы](#operators)
-   [Приоритет операторов](#operator-precedence)
-   [Неизвестные значения](#unknown-values)
-   [Условная оценка ACE](#conditional-ace-evaluation)
-   [Примеры](#examples)
-   [Связанные темы](#related-topics)

## <a name="conditional-ace-string-format"></a>Формат строки условной записи ACE

Каждый элемент ACE в строке [*дескриптора безопасности*](/windows/desktop/SecGloss/s-gly) заключен в круглые скобки. Поля ACE находятся в следующем порядке и разделены точкой с запятой (;).

*AceType ***;** _AceFlags_* _;_ *_Права_*_;_ *_ObjectGUID_*_;_ *_Инхеритобжектгуид_*_;_ *_AccountSid_*_;(_*_кондитионалекспрессион_*_)_*

Эти поля описаны в [строках ACE](ace-strings.md), за исключением следующих.

-   Поле *AceType* может быть одной из следующих строк.

    | Строка типа ACE | Константа в SDDL. h                         | Значение AceType                                   |
    |-----------------|--------------------------------------------|-------------------------------------------------|
    | СООБЩЕН<br/> | \_ \_ разрешен доступ к обратному ВЫЗОВу SDDL \_<br/> | ДОСТУП \_ к \_ \_ типу ACE разрешенного обратного вызова \_<br/> |
    | XD<br/> | \_доступ к обратному вызову SDDL \_ \_ запрещен<br/>  | \_ \_ Тип ACE обратного вызова с ЗАПРЕТом доступа \_ \_<br/>  |

    

     

-   Строка ACE содержит одно или несколько условных выражений, заключенных в круглые скобки в конце строки.

## <a name="conditional-expressions"></a>Условные выражения

Условное выражение может включать любой из следующих элементов.



| Элемент выражения                                                | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|-------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| *AttributeName*<br/>                                        | Проверяет, имеет ли указанный атрибут ненулевое значение.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **существует** *attributeName*<br/>                             | Проверяет, существует ли указанный атрибут в контексте клиента.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| *AttributeName* , *значение* *оператора*<br/>                     | Возвращает результат указанной операции.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| * Кондитионалекспрессион * **\|\|** _кондитионалекспрессион_<br/> | Проверяет, имеет ли любое из указанных условных выражений значение true.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| *Кондитионалекспрессион* **&&** *Кондитионалекспрессион*<br/> | Проверяет, имеет ли оба указанных условных выражений значение true.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **! (**_Кондитионалекспрессион_*_)_*<br/>                     | Обратная часть условного выражения.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **Член \_ {**_сидаррай_*_}_*<br/>                         | Проверяет, содержит ли массив [**SID \_ и \_ атрибуты**](/windows/desktop/api/Winnt/ns-winnt-sid_and_attributes) контекста клиента все [идентификаторы безопасности](security-identifiers.md) (SID) в списке с разделителями-запятыми, заданном параметром *сидаррай*.<br/> для параметра разрешить ace для контекста клиента необходимо, чтобы атрибут **SE \_ GROUP \_ ENABLED** был установлен как совпадающий.<br/> в случае запрета доступа ace для клиентского контекста клиента необходимо, **чтобы \_ группа \_ SE была включена** или группа **SE \_ \_ использовать для атрибута \_ \_ запретить \_ только** набор атрибутов.<br/> Массив *сидаррай* может содержать строки SID (например, "S-1-5-6") или псевдонимы SID (например, "BA"<br/> |



 

## <a name="attributes"></a>Атрибуты

Атрибут представляет элемент в массиве [**\_ \_ \_ сведений об атрибутах безопасности AUTHZ**](/windows/desktop/api/Authz/ns-authz-authz_security_attributes_information) в контексте клиента. Имя атрибута может содержать любые буквенно-цифровые символы и любые символы ":", "/", "." и " \_ ".

Значением атрибута может быть любой из следующих типов.



| Тип значения         | Описание                                                                                                                                                                                         |
|--------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Целочисленный тип<br/> | 64-разрядное целое число в десятичной или шестнадцатеричной нотации.<br/>                                                                                                                              |
| Строковый тип<br/>  | Строковое значение, разделенное кавычками.<br/>                                                                                                                                                      |
| SID<br/>     | SID (S-1-1-0) или SID (BA). Должен находиться в RHS участника \_ или устройства \_ \_ .<br/>                                                                                                           |
| BLOB<br/>    | \# с последующими шестнадцатеричными числами. Если длина чисел нечетна, то \# преобразуется в 0, чтобы сделать его четным. Кроме того, при \# появления в любом другое место в значении преобразуется в 0.<br/> |



 

## <a name="operators"></a>Операторы

Следующие операторы определяются для использования в условных выражениях для проверки значений атрибутов. Все они являются бинарными операторами и используются в виде   *значения* оператора AttributeName.



| Оператор            | Описание                                                                                                              |
|---------------------|--------------------------------------------------------------------------------------------------------------------------|
| ==<br/>       | Стандартное определение.<br/>                                                                                      |
| !=<br/>       | Стандартное определение.<br/>                                                                                      |
| <<br/>     | Стандартное определение.<br/>                                                                                      |
| <=<br/>    | Стандартное определение.<br/>                                                                                      |
| ><br/>     | Стандартное определение.<br/>                                                                                      |
| >=<br/>    | Стандартное определение.<br/>                                                                                      |
| Содержит<br/> | Значение **true** , если значение указанного атрибута является надмножеством указанного значения; в противном случае — **значение false**.<br/>  |
| Любой \_ из<br/>  | Значение **true** , если указанное значение является надмножеством значения указанного атрибута; в противном случае — **значение false**. <br/> |



 

Кроме того, унарные операторы EXISTS, Member \_ и отрицание (!) определяются, как описано в таблице условные выражения.

Оператору "Contains" перед ним должен предшествовать пробел, а \_ оператору "any of" должен предшествовать пробел.

## <a name="operator-precedence"></a>Приоритет операторов

Операторы оцениваются в следующем порядке приоритета, при этом операции с одинаковым приоритетом оцениваются слева направо.

1.  Существует \_ , член
2.  Содержит, любой \_ из
3.  = =,! =, <, <=, >, >=
4.  !
5.  &&
6.  \|\|

Кроме того, любая часть условного выражения может быть заключена в круглые скобки. Выражения в круглых скобках оцениваются первыми.

## <a name="unknown-values"></a>Неизвестные значения

Результаты условных выражений иногда возвращают значение **Unknown**. Например, любая из реляционных операций возвращает значение **Unknown** , если указанный атрибут не существует.

В следующей таблице описаны результаты логической операции **and** между двумя условными выражениями, *ConditionalExpression1* и *ConditionalExpression2*.



| *ConditionalExpression1* | *ConditionalExpression2* | *ConditionalExpression1* **&&** *ConditionalExpression2* |
|--------------------------|--------------------------|----------------------------------------------------------|
| **TRUE**<br/>      | **TRUE**<br/>      | **TRUE**<br/>                                      |
| **TRUE**<br/>      | **FALSE**<br/>     | **FALSE**<br/>                                     |
| **TRUE**<br/>      | **UNKNOWN**<br/>   | **UNKNOWN**<br/>                                   |
| **FALSE**<br/>     | **TRUE**<br/>      | **FALSE**<br/>                                     |
| **FALSE**<br/>     | **FALSE**<br/>     | **FALSE**<br/>                                     |
| **FALSE**<br/>     | **UNKNOWN**<br/>   | **FALSE**<br/>                                     |
| **UNKNOWN**<br/>   | **TRUE**<br/>      | **UNKNOWN**<br/>                                   |
| **UNKNOWN**<br/>   | **FALSE**<br/>     | **FALSE**<br/>                                     |
| **UNKNOWN**<br/>   | **UNKNOWN**<br/>   | **UNKNOWN**<br/>                                   |



 

В следующей таблице описаны результаты логической операции **or** между двумя условными выражениями, *ConditionalExpression1* и *ConditionalExpression2*.



| *ConditionalExpression1* | *ConditionalExpression2* | *ConditionalExpression1* **\|\|** *ConditionalExpression2* |
|--------------------------|--------------------------|------------------------------------------------------------|
| **TRUE**<br/>      | **TRUE**<br/>      | **TRUE**<br/>                                        |
| **TRUE**<br/>      | **FALSE**<br/>     | **TRUE**<br/>                                        |
| **TRUE**<br/>      | **UNKNOWN**<br/>   | **TRUE**<br/>                                        |
| **FALSE**<br/>     | **TRUE**<br/>      | **TRUE**<br/>                                        |
| **FALSE**<br/>     | **FALSE**<br/>     | **FALSE**<br/>                                       |
| **FALSE**<br/>     | **UNKNOWN**<br/>   | **UNKNOWN**<br/>                                     |
| **UNKNOWN**<br/>   | **TRUE**<br/>      | **TRUE**<br/>                                        |
| **UNKNOWN**<br/>   | **FALSE**<br/>     | **UNKNOWN**<br/>                                     |
| **UNKNOWN**<br/>   | **UNKNOWN**<br/>   | **UNKNOWN**<br/>                                     |



 

Отрицание условного выражения со значением **Unknown** также **неизвестно**.

## <a name="conditional-ace-evaluation"></a>Условная оценка ACE

В следующей таблице описывается результат проверки доступа условного элемента управления доступом в зависимости от окончательной оценки условного выражения.

| Тип ACE         | TRUE             | FALSE                 | UNKNOWN               |
|------------------|------------------|-----------------------|-----------------------|
| Allow<br/> | Allow<br/> | Игнорировать ACE<br/> | Игнорировать ACE<br/> |
| Запрет<br/>  | Запрет<br/>  | Игнорировать ACE<br/> | Запрет<br/>       |



 

## <a name="examples"></a>Примеры

В следующих примерах показано, как указанные политики доступа представлены условным элементом ACE, определенным с помощью SDDL.

<dl> <dt>

<span id="Policy"></span><span id="policy"></span><span id="POLICY"></span>Политик
</dt> <dd>

Разрешить выполнение всем, если выполняются оба следующих условия.

-   Title = PM
-   Деление = финансы или деление = продажи

</dd> <dt>

<span id="SDDL"></span><span id="sddl"></span>АВТОРИЗАЦИИ
</dt> <dd>

D: (XA;; FX;;; S-1-1-0; ( @User.Title = = "PM"  &&  ( @User.Division = = "Финансы" \| \| @User.Division = = "Sales")))

</dd> <dt>

 
</dt> <dd>

 

</dd> <dt>

<span id="Policy"></span><span id="policy"></span><span id="POLICY"></span>Политик
</dt> <dd>

Разрешить Execute, если любой из пользовательских проектов пересекается с проектами файлов.

</dd> <dt>

<span id="SDDL"></span><span id="sddl"></span>АВТОРИЗАЦИИ
</dt> <dd>

D: (XA;; FX;;; S-1-1-0; ( @User.Project Любой \_ из @Resource.Project )

</dd> <dt>

 
</dt> <dd>

 

</dd> <dt>

<span id="Policy"></span><span id="policy"></span><span id="POLICY"></span>Политик
</dt> <dd>

Разрешить доступ на чтение, если пользователь выполнил вход с помощью смарт-карты, является оператором резервного копирования и подключается к компьютеру с включенным BitLocker.

</dd> <dt>

<span id="SDDL"></span><span id="sddl"></span>АВТОРИЗАЦИИ
</dt> <dd>

D: (XA;; FR;;; S-1-1-0; (Член \_ {sid (ИД безопасности смарт-карты \_ ), SID (т. е.)}  && @Device.Bitlocker ))

</dd> <dt>

 
</dt> <dd>

 

</dd> </dl>

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[\[MS-ДТИП \] : язык описания дескрипторов безопасности](/openspecs/windows_protocols/ms-dtyp/4f4251cc-23b6-44b6-93ba-69688422cb06)
</dt> </dl>

