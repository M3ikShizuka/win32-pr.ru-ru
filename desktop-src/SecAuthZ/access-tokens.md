---
description: Маркер доступа — это объект, описывающий контекст безопасности процесса или потока.
ms.assetid: 350159c9-2399-427a-ba44-c897a9664299
title: Маркеры доступа
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7f9067df376006f7f7b61dedadc074c23674b2278fb5c311794bbddd12256277
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "117785394"
---
# <a name="access-tokens"></a>Маркеры доступа

[*Маркер доступа*](/windows/desktop/SecGloss/a-gly) — это объект, описывающий [*контекст безопасности*](/windows/desktop/SecGloss/s-gly) [*процесса*](/windows/desktop/SecGloss/p-gly) или потока. Сведения в маркере включают удостоверение и привилегии учетной записи пользователя, связанной с процессом или потоком. Когда пользователь входит в систему, система проверяет пароль пользователя, сравнивая его со сведениями, хранящимися в базе данных безопасности. Если пароль [*прошел проверку подлинности*](/windows/desktop/SecGloss/a-gly), система создает маркер доступа. Каждый процесс, выполняемый от имени этого пользователя, имеет копию этого маркера доступа.

Система использует маркер доступа для указания пользователя, когда поток взаимодействует с [защищаемым объектом](securable-objects.md) или пытается выполнить системную задачу, требующую привилегий. Маркеры доступа содержат следующие сведения:

-   [Идентификатор безопасности](security-identifiers.md) (SID) для учетной записи пользователя
-   Идентификаторы безопасности для групп, членом которых является пользователь
-   [*Идентификатор безопасности входа*](/windows/desktop/SecGloss/l-gly) , определяющий текущий [*сеанс входа в систему*](/windows/desktop/SecGloss/l-gly) .
-   Список [привилегий](privileges.md) , хранящихся у пользователя или в группах пользователя.
-   Идентификатор безопасности владельца
-   Идентификатор безопасности для основной группы
-   [Список DACL](access-control-lists.md) по умолчанию, используемый системой при создании пользователем защищаемого объекта без указания [*дескриптора безопасности*](/windows/desktop/SecGloss/s-gly)
-   Источник маркера доступа
-   Является ли маркер [*основным*](/windows/desktop/SecGloss/p-gly) маркером или токеном [олицетворения](client-impersonation.md)
-   Необязательный список с [максимальным идентификатором SID](restricted-tokens.md)
-   Текущие уровни олицетворения
-   Другая статистика

Каждый процесс имеет [*основной маркер*](/windows/desktop/SecGloss/p-gly) , описывающий [*контекст безопасности*](/windows/desktop/SecGloss/s-gly) учетной записи пользователя, связанной с процессом. По умолчанию система использует основной маркер, когда поток процесса взаимодействует с защищаемым объектом. Более того, поток может олицетворять учетную запись клиента. Олицетворение позволяет потоку взаимодействовать с защищаемыми объектами с помощью контекста безопасности клиента. Поток, выполняющий олицетворение клиента, имеет как основной, так и [*олицетворенный токен*](/windows/desktop/SecGloss/i-gly).

Используйте функцию [**OpenProcessToken**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-openprocesstoken) , чтобы получить маркер основного маркера процесса. Используйте функцию [**опенсреадтокен**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-openthreadtoken) для получения маркера для маркера олицетворения потока. Дополнительные сведения см. в разделе [олицетворение](client-impersonation.md).

Для управления маркерами доступа можно использовать следующие функции.



| Функция                                               | Описание                                                                                                                                                            |
|--------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**аджусттокенграупс**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-adjusttokengroups)         | Изменяет сведения о группе в маркере доступа.                                                                                                                      |
| [**AdjustTokenPrivileges**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-adjusttokenprivileges) | Включает или отключает привилегии в маркере доступа. Он не предоставляет новые права или не отзывает существующие.                                                       |
| [**чекктокенмембершип**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-checktokenmembership)   | Определяет, включен ли указанный идентификатор безопасности в указанном маркере доступа.                                                                                             |
| [**CreateRestrictedToken**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-createrestrictedtoken) | Создает новый токен, который является ограниченной версией существующего токена. Маркер ограниченного доступа может иметь отключенные SID, удаленные права и список ограниченных идентификаторов безопасности. |
| [**Сбой duplicatetoken**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-duplicatetoken)               | Создает новый токен олицетворения, который дублирует существующий токен.                                                                                                   |
| [**дупликатетокенекс**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-duplicatetokenex)           | Создает новый основной маркер или маркер олицетворения, который дублирует существующий токен.                                                                                  |
| [**GetTokenInformation**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-gettokeninformation)     | Извлекает сведения о токене.                                                                                                                                   |
| [**истокенрестриктед**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-istokenrestricted)         | Определяет, имеет ли маркер список идентификаторов SID.                                                                                                             |
| [**OpenProcessToken**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-openprocesstoken)           | Извлекает маркер основного маркера доступа для процесса.                                                                                                          |
| [**опенсреадтокен**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-openthreadtoken)             | Возвращает маркер для маркера доступа олицетворения для потока.                                                                                                     |
| [**сетсреадтокен**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-setthreadtoken)               | Назначает или удаляет маркер олицетворения для потока.                                                                                                                |
| [**сеттокенинформатион**](/windows/win32/api/securitybaseapi/nf-securitybaseapi-settokeninformation)     | Изменяет владельца маркера, основную группу или DACL по умолчанию.                                                                                                               |



 

Функции маркеров доступа используют следующие структуры для описания частей маркера доступа.



| Структура                                            | Описание                                                                                           |
|------------------------------------------------------|-------------------------------------------------------------------------------------------------------|
| [**\_элемент управления токеном**](/windows/desktop/api/Winnt/ns-winnt-token_control)              | Сведения, определяющие маркер доступа.                                                          |
| [**DACL МАРКЕРа \_ по умолчанию \_**](/windows/desktop/api/Winnt/ns-winnt-token_default_dacl)   | Список DACL по умолчанию, используемый системой в дескрипторах безопасности новых объектов, созданных потоком. |
| [**группы ТОКЕНов \_**](/windows/desktop/api/Winnt/ns-winnt-token_groups)                | Указывает идентификаторы безопасности и атрибуты групповых идентификаторов безопасности в маркере доступа.                               |
| [**Владелец ТОКЕНа \_**](/windows/desktop/api/Winnt/ns-winnt-token_owner)                  | Идентификатор безопасности владельца по умолчанию для дескрипторов безопасности новых объектов.                                    |
| [**\_Основная \_ Группа маркера**](/windows/desktop/api/Winnt/ns-winnt-token_primary_group) | Идентификатор безопасности основной группы по умолчанию для дескрипторов безопасности новых объектов.                            |
| [**\_права доступа маркера**](/windows/desktop/api/Winnt/ns-winnt-token_privileges)        | Привилегии, связанные с маркером доступа. Также определяет, включены ли привилегии.   |
| [**Источник ТОКЕНа \_**](/windows/desktop/api/Winnt/ns-winnt-token_source)                | Источник маркера доступа.                                                                        |
| [**\_Статистика маркеров**](/windows/desktop/api/Winnt/ns-winnt-token_statistics)        | Статистика, связанная с маркером доступа.                                                           |
| [**пользователь ТОКЕНа \_**](/windows/desktop/api/Winnt/ns-winnt-token_user)                    | Идентификатор безопасности пользователя, связанного с маркером доступа.                                                  |



 

Функции маркера доступа используют следующие типы перечислений.



| Тип перечисления                                             | Что определяет                                                                       |
|--------------------------------------------------------------|---------------------------------------------------------------------------------|
| [**\_класс сведений о токене \_**](/windows/desktop/api/Winnt/ne-winnt-token_information_class) | Определяет тип сведений, которые задаются или извлекаются из маркера доступа. |
| [**Тип ТОКЕНа \_**](/windows/desktop/api/Winnt/ne-winnt-token_type)                            | Определяет маркер доступа как основной токен или маркер олицетворения.                 |



 

 

 
