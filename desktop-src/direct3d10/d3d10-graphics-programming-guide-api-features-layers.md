---
description: Уровни API (Direct3D 10)
ms.assetid: 19c81383-6ac7-49ea-98a3-bf761a32ab40
title: Уровни API (Direct3D 10)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dd452032eda61c49edbf007b5ebaf0314f9054fe0b016cf07e3f4473ae3abee6
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "120119994"
---
# <a name="api-layers-direct3d-10"></a>Уровни API (Direct3D 10)

Среда выполнения Direct3D 10 создается с использованием слоев, начиная с базовой функциональности ядра и создавая необязательные функции и возможности для разработчиков во внешних слоях.

## <a name="core-layer"></a>Уровень ядра

Основной слой существует по умолчанию. обеспечение очень тонкого сопоставления между API и драйвером устройства, что сводит к минимуму затраты на вызовы с высокой частотой. Поскольку основной уровень является важным для производительности, он выполняет только критическую проверку.

Остальные слои являются необязательными. Как правило, слои добавляют функциональные возможности, но не изменяют существующее поведение. Например, основные функции будут иметь одинаковые возвращаемые значения независимо от создаваемого слоя отладки, хотя при создании экземпляра слоя отладки могут быть предоставлены дополнительные выходные данные отладки.

Создавайте слои при создании устройства, вызвав [**D3D10CreateDevice**](/windows/desktop/api/D3D10Misc/nf-d3d10misc-d3d10createdevice) и указав один или несколько [**D3D10 \_ создать значения \_ \_ флагов устройства**](/windows/desktop/api/D3D10/ne-d3d10-d3d10_create_device_flag) .

## <a name="debug-layer"></a>Отладочный слой

Слой отладки предоставляет широкие возможности проверки целостности и согласованности (например, проверка компоновки шейдера и привязки ресурсов, проверка согласованности параметров и сообщения об ошибках). Выходные данные, формируемые слоем отладки, состоят из очереди строк, доступ к которой можно получить с помощью [**интерфейса ID3D10InfoQueue**](/windows/desktop/api/D3D10SDKLayers/nn-d3d10sdklayers-id3d10infoqueue) (см. раздел [Настройка выходных данных отладки с использованием ID3D10InfoQueue (Direct3D 10)](d3d10-graphics-programming-guide-api-features-layers-info-queue.md)). Ошибки, создаваемые основным слоем, выделяются предупреждениями слоя отладки.

Чтобы создать устройство, поддерживающее уровень отладки, необходимо установить пакет SDK DirectX (для получения D3D10SDKLayers.DLL), а затем указать \_ флаг D3D10 Create \_ Device \_ Debug при вызове [**D3D10CreateDevice**](/windows/desktop/api/D3D10Misc/nf-d3d10misc-d3d10createdevice). Конечно, запуск приложения с отладочным слоем будет существенно медленнее. Чтобы включить или отключить сообщения отладки для API-интерфейсов D3DX10, вызовите [**D3DX10DebugMute**](d3dx10debugmute.md).

Когда уровень отладки перечисляет утечки памяти, он выводит список указателей на объектные интерфейсы и их понятные имена. Понятное имя по умолчанию — безымянное &lt; &gt; . Понятное имя можно задать с помощью метода [**ID3D10DeviceChild:: сетприватедата**](/windows/desktop/api/D3D10/nf-d3d10-id3d10devicechild-setprivatedata) и идентификатора GUID **вкпдид \_ D3DDebugObjectName** , который находится в D3Dcommon. h. Например, чтобы присвоить имя Птекстуре имя Сдклайер mytexture.jpg, используйте следующий код:


```
const char c_szName[] = "mytexture.jpg";
pTexture->SetPrivateData( WKPDID_D3DDebugObjectName, sizeof( c_szName ) - 1, c_szName );
```



Как правило, следует компилировать эти вызовы из рабочей версии.

## <a name="switch-to-reference-layer"></a>Уровень переключения на ссылку

Этот уровень позволяет приложению переходить между аппаратным устройством (HAL) и ссылкой или программным устройством (REF). Чтобы переключить устройство, необходимо сначала создать устройство, которое поддерживает уровень переключения на ссылку (см. [**D3D10CreateDevice**](/windows/desktop/api/D3D10Misc/nf-d3d10misc-d3d10createdevice)), а затем вызвать [**ID3D10SwitchToRef:: сетусереф**](/windows/desktop/api/D3D10SDKLayers/nf-d3d10sdklayers-id3d10switchtoref-setuseref).

Все состояния устройств, ресурсы и объекты поддерживаются в этом переходе на устройство. Однако иногда невозможно точно сопоставить данные ресурсов. Это связано с тем, что некоторые сведения доступны для устройства, которое недоступно для устройства-образца.

Практически все приложения в режиме реального времени используют реализацию HAL конвейера. Когда конвейер переключается с аппаратного устройства на эталонное устройство, операции отрисовки выполняются одновременно в аппаратном и программном обеспечении. При отрисовке программного обеспечения оно потребует загрузки ресурсов в системную память. Это может потребовать исключения других ресурсов, кэшированных в системной памяти, для освобождения места.

> [!Note]  
> Эта функция уровня "переключение на ссылку" поддерживается только в Direct3D 10 и Direct3D 10,1 и больше не поддерживается в Direct3D 11 и более поздних версиях.

 

## <a name="thread-safe-layer"></a>Уровень Thread-Safe

Этот уровень предназначен для предоставления многопоточным приложениям доступа к устройству из нескольких потоков.

Приложение Direct3D 10 может управлять синхронизацией устройства с помощью функций устройства. Это позволяет приложению включать и отключать критически важные разделы (временно включать и отключать защиту от многопоточности) и принимать/освобождать блокировку критических разделов на нескольких точках входа API Direct3D 10. Потокобезопасный уровень включен по умолчанию. Для однопотоковых приложений уровень, который является потокобезопасным, не влияет на производительность.




Различия между Direct3D 9 и Direct3D 10:

- В отличие от Direct3D 9, API Direct3D 10 по умолчанию имеет полностью потокобезопасную.



 

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Функции API (Direct3D 10)](d3d10-graphics-programming-guide-api-features.md)
</dt> </dl>

 

 




