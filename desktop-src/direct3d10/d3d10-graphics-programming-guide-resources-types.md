---
description: 'Все ресурсы, используемые конвейером Direct3D, основаны на двух базовых типах: буферах и текстурах. Буфер — это коллекция необработанных данных (элементов); текстуры — это коллекция текселей (элементов текстуры).'
ms.assetid: c5238a2f-d69d-4ce5-a5aa-66a6c18d5f69
title: Типы ресурсов (Direct3D 10)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8b0f757eac93fac8c0ffd49641441fa4570824670dfcca9c3d271f954054548b
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "120120172"
---
# <a name="resource-types-direct3d-10"></a>Типы ресурсов (Direct3D 10)

Все ресурсы, используемые конвейером Direct3D, основаны на двух базовых типах: [буферах](#buffer-resources) и [текстурах](#texture-resources). Буфер — это коллекция необработанных данных (элементов); текстуры — это коллекция текселей (элементов текстуры).

-   [Ресурсы буфера](#buffer-resources)
    -   [Типы буферов](#buffer-types)
-   [Ресурсы текстуры](#texture-resources)
    -   [Типы текстур](#texture-types)
    -   [Подресурсы](#subresources)
    -   [Строгая и нестрогая типизация](#strong-vs-weak-typing)
-   [Связанные темы](#related-topics)

Указать макет ресурса (тип размещения в памяти) можно двумя способами.



| Элемент                                                                                                 | Описание                                                                   |
|------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------|
| <span id="Typed"></span><span id="typed"></span><span id="TYPED"></span>Типизированный<br/>             | Полное указание типа при создании ресурса.<br/>               |
| <span id="Typeless"></span><span id="typeless"></span><span id="TYPELESS"></span>Бестиповыми<br/> | Тип указывается полностью, когда ресурс привязывается к конвейеру.<br/> |



 

## <a name="buffer-resources"></a>Ресурсы буфера

Буферный ресурс — это коллекция полностью типизированных данных. Сам буфер содержит элементы. Элемент состоит из 1–4 компонентов. Примеры типов элементов данных: упакованное значение данных (например, R8G8B8A8), 8-разрядное целое число, четыре 32-разрядных числа с плавающей точкой. Эти типы используются для хранения таких данных, как позиционный вектор, вектор нормали, координата текстуры в буфере вершин, индекс в буфере индексов или состояние устройства.

Буфер создается как неструктурированный ресурс. Поскольку он неструктурированный, буфер не может содержать какие-либо уровни MIP, не может использовать фильтрацию при чтении и не может подвергаться множественной дискретизации.

### <a name="buffer-types"></a>Типы буферов

-   [Буфер вершин](#vertex-buffer)
-   [Буфер индексов](#index-buffer)
-   [Буфер констант](#constant-buffer)

### <a name="vertex-buffer"></a>Буфер вершин

Буфер — это коллекция элементов, а буфер вершин содержит данные вершин. Самый простой пример — это буфер вершин, который содержит один тип данных, например данные о положении. Его можно изобразить, как на следующем рисунке.

![иллюстрация буфера вершин, который содержит данные положения](images/d3d10-resources-single-element-vb2.png)

Чаще всего буфер вершин содержит все данные, необходимые для полного описания трехмерных вершин. Примером этого может быть буфер вершин, который содержит положение, нормаль и координаты текстуры для каждой вершины. Эти данные обычно упорядочены в виде наборов элементов для каждой вершины, как показано на следующем рисунке.

![иллюстрация буфера вершин, который содержит данные положения, нормали и текстуры](images/d3d10-vertex-buffer-element.png)

Этот буфер вершин содержит данные для восьми вершин. Каждая вершина хранит три элемента (положение, нормаль и координаты текстуры). Положения и нормали обычно задаются с помощью 3 32-битных плавающих чисел (в \_ формате DXGI \_ R32G32B32 \_ float) и координатах текстуры с использованием 2 32-разрядных чисел с плавающей запятой ( \_ Формат DXGI \_ R32G32 \_ float).

Для доступа к данным из буфера вершин необходимо знать, к какой вершине требуется доступ, и следующие параметры буфера:

-   Смещение — число байтов от начала буфера до данных для первой вершины. Смещение указывается в [**иасетвертексбуфферс**](/windows/desktop/api/D3D10/nf-d3d10-id3d10device-iasetvertexbuffers).
-   Басевертекслокатион — число байтов от смещения до первой вершины, используемое соответствующим вызовом Draw (см. раздел [методы рисования](../direct3d11/d3d10-graphics-programming-guide-input-assembler-stage-getting-started.md)).

Перед созданием буфера вершин необходимо определить его макет, создав [**объект макета ввода**](/windows/win32/api/d3d10/nn-d3d10-id3d10inputlayout). Это делается путем вызова [**креатеинпутлайаут**](/windows/desktop/api/D3D10/nf-d3d10-id3d10device-createinputlayout). После создания объекта макета ввода привяжите его к этапу входного ассемблера, вызвав [**иасетинпутлайаут**](/windows/desktop/api/D3D10/nf-d3d10-id3d10device-iasetinputlayout).

Чтобы создать буфер вершин, вызовите [**CreateBuffer**](/windows/desktop/api/D3D10/nf-d3d10-id3d10device-createbuffer).

### <a name="index-buffer"></a>Буфер индексов

Буфер индексов содержит последовательный набор 16-разрядных или 32-разрядных индексов; каждый индекс используется для идентификации вершины в буфере вершин. Использование буфера индексов с одним или несколькими буферами вершин для передачи данных этапу IA называется индексированием. Буфер индексов можно изобразить, как на следующем рисунке.

![иллюстрация буфера индексов](images/d3d10-index-buffer.png)

Последовательные индексы, хранящиеся в буфере индексов, обнаруживаются по следующим параметрам:

-   Offset — количество байтов от начала буфера до первого индекса; Смещение указывается в [**иасетиндексбуффер**](/windows/desktop/api/D3D10/nf-d3d10-id3d10device-iasetindexbuffer).
-   Стартиндекслокатион — число байтов от смещения до первой вершины, используемое соответствующим вызовом Draw (см. раздел [методы рисования](../direct3d11/d3d10-graphics-programming-guide-input-assembler-stage-getting-started.md)).
-   IndexCount — число индексов для отрисовки.

Чтобы создать буфер индекса, вызовите [**CreateBuffer**](/windows/desktop/api/D3D10/nf-d3d10-id3d10device-createbuffer).

Буфер индексов можно объединить в несколько [линий или треугольников](../direct3d11/d3d10-graphics-programming-guide-primitive-topologies.md) , разделив их с помощью индекса полосковой вырезания. Индекс вырезания полосы позволяет нарисовать несколько линий или полос треугольников в одном вызове. Индекс полосковой вырезания — это просто максимально возможное значение индекса (0xFFFF для 16-разрядного индекса, 0xFFFFFFFF для 32-разрядного индекса). Индекс вырезания полос сбрасывает порядок поворота в индексированных примитивах и позволяет отказаться от вырожденных треугольников, которые в противном случае могут потребоваться для обеспечения правильной порядка поворота в полосе треугольников. Ниже представлен пример полоса индекса вырезания полосы.

![иллюстрация индекса вырезания полосы](images/d3d10-ia-strips-cut-value.png)

### <a name="constant-buffer"></a>Буфер констант

В Direct3D 10 появился новый буфер для предоставления констант шейдера, называемый буфером построителя текстуры, или просто буфер констант. По сути, он выглядит так же, как буфер вершин с одним элементом, как показано на следующем рисунке.

![иллюстрация буфера констант шейдера](images/d3d10-shader-resource-buffer.png)

Каждый элемент хранит определяемую форматом данных константу с числом компонентов от 1 до 4.

Буферы констант уменьшают пропускную способность, необходимую для обновления констант шейдера, позволяя сгруппировать и обработать их одновременно, без отдельных вызовов для обработки каждой константы.

Чтобы создать буфер шейдера, вызовите [**CreateBuffer**](/windows/desktop/api/D3D10/nf-d3d10-id3d10device-createbuffer) и укажите флаг привязки константного буфера D3D10 \_ Привязка \_ константного \_ буфера (см. [**\_ \_ флаг привязки D3D10**](/windows/desktop/api/D3D10/ne-d3d10-d3d10_bind_flag)).

Чтобы привязать буфер шейдера к конвейеру, вызовите один из следующих методов: [**гссетконстантбуфферс**](/windows/desktop/api/D3D10/nf-d3d10-id3d10device-gssetconstantbuffers), [**пссетконстантбуфферс**](/windows/desktop/api/D3D10/nf-d3d10-id3d10device-pssetconstantbuffers)или [**вссетконстантбуфферс**](/windows/desktop/api/D3D10/nf-d3d10-id3d10device-vssetconstantbuffers).

Обратите внимание, что при использовании интерфейса [**интерфейса ID3D10Effect**](/windows/desktop/api/D3D10Effect/nn-d3d10effect-id3d10effect) процесс создания, привязки и передачи постоянного буфера обрабатывается экземпляром **интерфейса ID3D10Effect** . В этом случае можно только получить переменную из воздействия с помощью одного из методов несцесари, таких как [**жетвариаблебинаме**](/windows/desktop/api/D3D10Effect/nf-d3d10effect-id3d10effect-getvariablebyname) , и обновить переменную с помощью одного из методов SetVariable, таких как [**сетматрикс**](/windows/desktop/api/D3D10Effect/nf-d3d10effect-id3d10effectmatrixvariable-setmatrix). Пример использования **интерфейса ID3D10Effect** для управления буфером констант см. в [руководстве 07](https://msdn.microsoft.com/library/Ee416442(v=VS.85).aspx).

Шейдер продолжает считывать переменные в буфере констант напрямую по имени переменной, как и переменные, которые не входят в буфера констант.

На каждом этапе шейдера можно определить до 15 буферов констант шейдера, причем каждый буфер может содержать до 4096 констант.

Буфер констант можно использовать для хранения результатов этапа вывода потока.

Пример объявления буфера констант в шейдере см. в разделе [Константы шейдера (DirectX HLSL)](../direct3dhlsl/dx-graphics-hlsl-constants.md).

## <a name="texture-resources"></a>Ресурсы текстуры

Текстурный ресурс — это структурированный набор данных, предназначенный для хранения текселей. В отличие от буферов текстуры можно фильтровать по дискретизаторам текстур во время их считывания блоками шейдера. Тип текстуры влияет на способ ее фильтрации. Тексель представляет собой наименьший элемент текстуры, который может использоваться конвейером для чтения или записи. Каждый шаг текселя содержит от 1 до 4 компонентов, расположенных в одном из форматов DXGI (см [**. \_ Формат DXGI**](/windows/win32/api/dxgiformat/ne-dxgiformat-dxgi_format)).

Текстуры создаются как структурированные ресурсы, чтобы их размер был известен. Тем не менее, каждая текстура может вводиться или вводиться меньше при создании ресурса, если тип полностью задан с помощью представления, когда текстура привязана к конвейеру.

-   [Типы текстур](#texture-types)
-   [Подресурсы](#subresources)
-   [Строгая и нестрогая типизация](#strong-vs-weak-typing)

### <a name="texture-types"></a>Типы текстур

Существует несколько типов текстур: одно-, двух-, и трехмерный; каждый из них может быть создан с использованием MIP-карт и без них. Direct3D 10 также поддерживает массивы текстур и Многовыборочные текстуры.

-   [Текстура 1D](#1d-texture)
-   [Массив одномерной текстуры](#1d-texture-array)
-   [Двухмерная текстура и массив двумерных текстур](#2d-texture-and-2d-texture-array)
-   [Трехмерная текстура](#3d-texture)

### <a name="1d-texture"></a>Одномерная текстура

Одномерная текстура в самом простом своем виде содержит данные текстуры, к которым можно обращаться по одной координате текстуры; ее можно отобразить как массив текселей, как показано на следующем рисунке.

![иллюстрация одномерной текстуры](images/d3d10-1d-texture.png)

Каждый тексель содержит несколько цветовых компонентов в зависимости от формата хранимых данных. Повышая сложность, можно создать одномерную текстуру с уровнями MIP-карт, как показано на следующем рисунке.

![иллюстрация одномерной текстуры с уровнями MIP-карт](images/d3d10-resource-texture1d.png)

Уровень MIP-карты — это текстура, которая меньше вышестоящего уровня на число, соответствующее степени двух. Самый верхний уровень содержит наиболее больше всего деталей, а для каждого последующего уровня детализация уменьшается. Для одномерной MIP-1карты наименьший уровень содержит один тексель. Различные уровни определяются с помощью индекса LOD (уровень детализации). Вы можете можно использовать LOD для доступа к более мелким текстурам при отрисовке геометрических фигур, которые далеко от камеры.

### <a name="1d-texture-array"></a>Массив одномерной текстуры

В Direct3D 10 также есть новая структура данных для массива текстур. Массив одномерных текстур концептуально выглядит как на следующем рисунке.

![иллюстрация массива одномерных текстур](images/d3d10-resource-texture1darray.png)

Этот массив текстур содержит три текстуры. Ширина всех трех текстур равна 5 (это число элементов на первом уровне). Каждая текстура также содержит трехслойную MIP-карту.

Все массивы текстур в Direct3D однородные, это означает, что у каждой текстуры в массиве должна быть одинаковый формат данных и размер (в том числе ширина текстуры и количество уровней MIP). Вы можете создавать массивы текстур различных размеров при условии, что все текстуры в отдельном массиве соответствуют друг другу по размеру.

### <a name="2d-texture-and-2d-texture-array"></a>Двухмерная текстура и массив двухмерных текстур

Ресурс Texture2D содержит двухмерную сетку текселей. На каждый тексель указывает вектор u, v. Поскольку это текстурный ресурс, он может содержать уровни MIP и подресурсы. Полностью заполненный ресурс двухмерных текстур соответствует изображению на следующем рисунке.

![иллюстрация ресурса двухмерной текстуры](images/d3d10-resource-texture2d.png)

Этот текстурный ресурс содержит одну текстуру 3 x 5 с тремя уровнями MIP.

Ресурс Texture2DArray — это однородный массив двухмерных текстур (формат данных и размер всех текстур, включая уровни MIP, совпадают). Макет этого ресурса похож на макет одномерной текстуры за исключением того, что текстуры теперь содержат двухмерные данные, поэтому ресурс выглядит, как на следующем рисунке.

![иллюстрация массива ресурсов двухмерных текстур](images/d3d10-resource-texture2darray.png)

Этот массив текстур содержит три текстуры; каждая текстура имеет размер 3 x 5 и два уровня MIP.

### <a name="using-a-texture2darray-as-a-texture-cube"></a>Использование Texture2DArray как куба текстур

Куб текстур — это массив двухмерных текстур, содержащий 6 текстур, по одной на каждую грань куба. Полностью заполненный куб текстур выглядит, как изображение на следующем рисунке.

![иллюстрация массива ресурсов двухмерных текстур, представляющих куб текстур](images/d3d10-resource-texturecube.png)

Чтение массива двухмерных текстур, содержащего 6 текстур, может производиться из шейдеров со встроенными функциями карт куба, после их привязки к конвейеру с представлением кубической текстуры. Обращение к кубам текстур производится из шейдера с трехмерным вектором, направленным от центра куба текстур.

### <a name="3d-texture"></a>Трехмерная текстура

Ресурс Texture3D (или объемная текстура) содержит трехмерный объем текселей. Поскольку это ресурс текстуры, он может содержать уровни MIP. Полностью заполненная [**трехмерная текстура**](/windows/desktop/api/D3D10/nn-d3d10-id3d10texture3d) выглядит как на следующем рисунке.

![иллюстрация ресурса трехмерной текстуры](images/d3d10-resource-texture3d.png)

При привязке фрагмента MIP-карты трехмерной текстуры в качестве целевых выходных данных отрисовки (с использованием представления целевого объекта отрисовки) трехмерная текстура ведет себя аналогично массиву двухмерных текстур с n фрагментами. Конкретный срез прорисовки выбирается на этапе геометрического шейдера путем объявления скалярного компонента выходных данных в качестве \_ системного значения SV рендертаржетаррайиндекс.

Понятие массива трехмерных текстур не существует, соответственно, подресурс трехмерной текстуры — это один уровень MIP-карты.

### <a name="subresources"></a>Подресурсы

API Direct3D 10 ссылается на все ресурсы или подмножества ресурсов. Чтобы указать часть ресурсов, Direct3D применяет термин "подресурсы", что означает подмножество ресурса.

Буфер определяется как один подресурс. Текстуры немного более сложны, так как существует несколько типов текстур (одномерные, двухмерные и т. д.), некоторые из которых поддерживают уровни MIP или массивы текстур. Самый простой случай — это одномерная текстура, которая определяется как один подресурс (см. следующий рисунок).

![иллюстрация одномерной текстуры](images/d3d10-1d-texture.png)

Это означает, что массив текселей, из которых состоит одномерная текстура, содержится в одном подресурсе.

Если развернуть одномерную текстуру с тремя уровнями MIP, ее можно показать следующим образом.

![иллюстрация одномерной текстуры с уровнями MIP-карт](images/d3d10-resource-texture1d.png)

Это можно представить как одну текстуру, которая состоит из трех подтекстур. Каждый подтекстура считается подресурсом, поэтому эта одномерная текстура содержит три подресурса. Подтекстура (или подресурс) может индексироваться с помощью уровня детализации (LOD) одной текстуры. При использовании массива текстур для доступа к определенной подтекстуре требуется LOD и конкретная текстура. Или же API объединяет эти два фрагмента информации в один начинающийся с нуля индекс подресурса, как показано здесь.

![иллюстрация начинающегося с нуля индекса подресурса](images/d3d10-resource-texture1darray-sub-indexing.png)

### <a name="selecting-subresources"></a>Выбор подресурсов

Некоторые API обращаются ко всему ресурсу (например, [**копиресаурце**](/windows/desktop/api/D3D10/nf-d3d10-id3d10device-copyresource)), другие получают доступ к части ресурса (например, [**упдатесубресаурце**](/windows/desktop/api/D3D10/nf-d3d10-id3d10device-updatesubresource) или [**кописубресаурцерегион**](/windows/desktop/api/D3D10/nf-d3d10-id3d10device-copysubresourceregion)). API-интерфейс, который обращается к части ресурса, обычно использует описание представления (например, [**D3D10 \_ TEX2D \_ array \_ DSV**](/windows/desktop/api/D3D10/ns-d3d10-d3d10_tex2d_array_dsv)), чтобы указать подресурсы для доступа.

На этих рисунках показаны термины, используемые в описание представления при доступе к массиву текстур.

### <a name="array-slice"></a>Срез массива

В массиве текстур, где у каждой текстуры есть MIP-карты, срез массива (представленный белым прямоугольником) содержит одну текстуру и все ее подтекстуры, как показано на следующем рисунке.

![иллюстрация среза массива](images/d3d10-resource-array-slice.png)

### <a name="mip-slice"></a>Срез MIP

Срез MIP (представленный белым прямоугольником) содержит один уровень MIP-карты для каждой текстуры в массиве, как показано на следующем рисунке.

![иллюстрация среза MIP](images/d3d10-resource-mip-slice.png)

### <a name="selecting-a-single-subresource"></a>Выбор одного подресурса

Эти два типа срезов можно использовать для выбора одного подресурса, как показано на следующем рисунке.

![иллюстрация выбора подресурса с помощью среза массива и среза MIP](images/d3d10-resource-subresources-1.png)

### <a name="selecting-multiple-subresources"></a>Выбор нескольких подресурсов

Или можно использовать эти два типа срезов с количеством уровней MIP-карты или числом текстур, чтобы выбрать несколько подресурсов.

![иллюстрация выбора нескольких подресурсов](images/d3d10-resource-subresources-2.png)

Независимо от типа текстуры, с MIP-карты или без него, с массивом текстур или без него можно использовать вспомогательную функцию [**D3D10CalcSubresource**](/windows/desktop/api/D3D10/nf-d3d10-d3d10calcsubresource), чтобы вычислить индекс определенного подресурса.

### <a name="strong-vs-weak-typing"></a>Строгая и нестрогая типизация

При создании полностью типизированного ресурса он может использовать только тот формат, с которым был создан. Это позволяет среде выполнения оптимизировать доступ, особенно если ресурс создается с флагами, указывающими, что приложение не может быть [сопоставлено](d3d10-graphics-programming-guide-resources-mapping.md) . Ресурсы, создаваемые с помощью определенного типа, не могут интерпретироваться с помощью механизма представления.

В ресурсе типа less тип данных неизвестен при первом создании ресурса. Приложение должно выбирать из доступных форматов меньшего числа (см. [**раздел \_ Формат DXGI**](/windows/win32/api/dxgiformat/ne-dxgiformat-dxgi_format)). Вам следует указать размер выделяемой области памяти и то, потребуется ли среде выполнения создать подтекстуры в MIP-карте. Однако формат данных, который определяет, будет ли память интерпретироваться как целые числа, значения с плавающей запятой, беззнаковые целые числа и т. д., не определен, пока ресурс не будет привязан к конвейеру с представлением. Так как формат текстуры остается произвольным до привязки текстуры к конвейеру, ресурс называется хранилищем с нестрогой типизацией. Преимущество такого типа хранилища заключается в том, что его можно повторно использовать или интерпретировать (в другом формате), пока компонентный бит формата соответствует разрядности старого формата.

Один ресурс можно привязать к нескольким этапам конвейера, если у каждой из них есть уникального представление, которое полностью квалифицирует форматы в каждом расположении. Например, ресурс, созданный с помощью формата DXGI \_ \_ R32G32B32A32 Type без \_ типа, можно использовать в качестве формата DXGI \_ \_ R32G32B32A32 \_ float и \_ формата DXGI \_ R32G32B32A32 \_ uint в разных местах конвейера одновременно.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Ресурсы (Direct3D 10)](d3d10-graphics-programming-guide-resources.md)
</dt> </dl>

 

 
