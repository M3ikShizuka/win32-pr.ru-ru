---
description: Ресурс — это коллекция данных, используемых трехмерным конвейером.
ms.assetid: 802400fa-a606-4d3d-a61d-1cdb5a9f0437
title: Выбор ресурса (Direct3D 10)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4be887fb94f04783b01f8873fb61812bca20faa5
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103807876"
---
# <a name="choosing-a-resource-direct3d-10"></a>Выбор ресурса (Direct3D 10)

Ресурс — это коллекция данных, используемых трехмерным конвейером. Создание ресурсов и определение их поведения — первый этап программирования вашего приложения. В этом руководстве рассматриваются основные темы по выбору ресурсов, необходимых для приложения.

-   [Выявление стадий конвейера, которым требуются ресурсы](#identify-pipeline-stages-that-need-resources)
-   [Определение того, как будет использоваться каждый ресурс](#identify-how-each-resource-will-be-used)
-   [Привязка ресурсов к этапам конвейера](#binding-resources-to-pipeline-stages)
-   [См. также](#related-topics)

## <a name="identify-pipeline-stages-that-need-resources"></a>Выявление стадий конвейера, которым требуются ресурсы

Первым шагом является выбор этапа (или этапов) [конвейера](d3d10-graphics-programming-guide-pipeline-stages.md) , который будет использовать ресурс. То есть необходимо определить каждый этап, который будет считывать данные из ресурса, а также этапы, которые будут записывать данные в ресурс. Знание этапов конвейера, на которых будут использоваться ресурсы, определяет API, которые будут вызываться, чтобы привязать ресурс к этапу.

В этой таблице перечислены типы ресурсов, которые могут быть привязаны к каждому этапу конвейера. Он включает возможность привязки ресурса в качестве входных или выходных данных, а также API привязки.



| Этап конвейера  | В/Из | Ресурс               | Тип ресурса                           | Привязка API                                                                                                                                                                                                |
|-----------------|--------|------------------------|-----------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Сборщик входных данных | В     | Буфер вершин          | Буфер                                  | [**IASetVertexBuffers**](/windows/desktop/api/D3D10/nf-d3d10-id3d10device-iasetvertexbuffers)                                                                                                                                           |
| Сборщик входных данных | В     | Буфер индексов           | Буфер                                  | [**IASetIndexBuffer**](/windows/desktop/api/D3D10/nf-d3d10-id3d10device-iasetindexbuffer)                                                                                                                                               |
| Этапы шейдера   | В     | Представление ресурсов шейдера    | Буфер, Texture1D, Texture2D, Texture3D | [**Вссетшадерресаурцес**](/windows/desktop/api/D3D10/nf-d3d10-id3d10device-vssetshaderresources), [**гссетшадерресаурцес**](/windows/desktop/api/D3D10/nf-d3d10-id3d10device-gssetshaderresources), [**пссетшадерресаурцес**](/windows/desktop/api/D3D10/nf-d3d10-id3d10device-pssetshaderresources) |
| Этапы шейдера   | В     | Буфер констант шейдера | Буфер                                  | [**Вссетконстантбуфферс**](/windows/desktop/api/D3D10/nf-d3d10-id3d10device-vssetconstantbuffers), [**гссетконстантбуфферс**](/windows/desktop/api/D3D10/nf-d3d10-id3d10device-gssetconstantbuffers), [**пссетконстантбуфферс**](/windows/desktop/api/D3D10/nf-d3d10-id3d10device-pssetconstantbuffers) |
| Выходной поток   | Исходящий    | Буфер                 | Буфер                                  | [**SOSetTargets**](/windows/desktop/api/D3D10/nf-d3d10-id3d10device-sosettargets)                                                                                                                                                       |
| Средство слияния выхода   | Исходящий    | Представление целевого объекта отрисовки     | Буфер, Texture1D, Texture2D, Texture3D | [**OMSetRenderTargets**](/windows/desktop/api/D3D10/nf-d3d10-id3d10device-omsetrendertargets)                                                                                                                                           |
| Средство слияния выхода   | Исходящий    | Представления глубины/трафарета     | Texture1D, Texture2D                    | [**OMSetRenderTargets**](/windows/desktop/api/D3D10/nf-d3d10-id3d10device-omsetrendertargets)                                                                                                                                           |



 

## <a name="identify-how-each-resource-will-be-used"></a>Определение того, как будет использоваться каждый ресурс

Выбрав этапы конвейера, которые будут использоваться приложением (и, следовательно, ресурсы, которые потребуются на каждом этапе), необходимо определить, как будет использоваться каждый ресурс, то есть будет ли к нему осуществляться доступ с ЦП или графического процессора.

Оборудование, на котором выполняется ваше приложение, будет иметь как минимум один ЦП и один графический процессор. Чтобы выбрать значение использования, определите, какой тип процессора необходимо считывать или записывать в ресурс из следующих вариантов (см. раздел [**\_ Использование D3D10**](/windows/desktop/api/D3D10/ne-d3d10-d3d10_usage)).



| Использование ресурсов | Возможность обновления                    | Частота обновления |
|----------------|--------------------------------------|---------------------|
| Значение по умолчанию        | Графический процессор                                  | редко        |
| Динамический        | ЦП                                  | часто          |
| Промежуточная        | Графический процессор                                  | Недоступно                 |
| Неизменяемые      | ЦП (только во время создания ресурсов) | Недоступно                 |



 

Использование по умолчанию следует использовать для ресурса, который, как ожидается, будет обновляться ЦП достаточно редко (реже, чем раз в кадр). В идеале ЦП никогда не будет выполнять прямую запись в ресурс с использованием по умолчанию, чтобы избежать возможного снижения производительности.

Динамическое использование следует использовать для ресурса, который ЦП обновляет достаточно часто (раз в кадр или чаще). Типичный сценарий для динамического ресурса заключается в создании динамических буферов вершин и индексов, которые во время выполнения будут заполняться данными о геометрии, видимой с точки обзора пользователя каждого кадра. Эти буферы будут использоваться исключительно для отрисовки геометрии, видимой пользователю этого кадра.

Промежуточное использование должно использоваться для копирования данных в другие ресурсы и из них. Типичный сценарий заключается в копировании данных из ресурса с использованием по умолчанию (недоступного для ЦП) в ресурс с промежуточным использованием (доступный для ЦП).

Неизменяемые ресурсы следует использовать, если данные в ресурсе не будут меняться никогда.

Ситуацию можно рассмотреть и с другой точки зрения — с точки зрения того, какие действия приложение будет выполнять с ресурсом.



| Использование ресурса приложением     | Использование ресурсов       |
|---------------------------------------|----------------------|
| Однократная загрузка, отсутствие обновлений            | Неизменяемое или по умолчанию |
| Приложение многократно заполняет ресурс | Динамический              |
| Отрисовка в текстуру                     | Значение по умолчанию              |
| Доступ ЦП к данным графического процессора                | Промежуточная              |



 

Если вы не уверены, какое использование выбрать, начните с использования по умолчанию, поскольку это самый распространенный сценарий. Буфер констант шейдера — это тип ресурса, который должен всегда иметь использование по умолчанию.

## <a name="binding-resources-to-pipeline-stages"></a>Привязка ресурсов к этапам конвейера

Ресурс может быть привязан к более чем одному этапу конвейера одновременно с ограничениями, заданными при создании ресурса ([**флаги использования**](/windows/desktop/api/D3D10/ne-d3d10-d3d10_usage), [**Флаги привязки**](/windows/desktop/api/D3D10/ne-d3d10-d3d10_bind_flag), [**флаги доступа к ЦП**](/windows/desktop/api/D3D10/ne-d3d10-d3d10_cpu_access_flag)). В частности, ресурс можно привязать как входной и выходной объект одновременно, при условии что запись и чтение ресурса не могут осуществляться одновременно.

При привязке ресурса подумайте о том, как ЦП и графический процессор будет осуществлять доступ к ресурсу. Ресурсы, которые предназначены для одной цели (без множественного использования, привязок и флагов доступа ЦП), в большинстве случаев обеспечивают более высокую производительность

Например, рассмотрим случай с однобуферной прорисовкой, используемой в качестве текстуры несколько раз. Возможно, работа пойдет быстрее с двумя ресурсами: однобуферной прорисовкой и текстурой, используемой в качестве ресурса шейдера. Каждый ресурс будет использовать только один флаг привязки ([**D3D10 \_ BIND \_ \_ целевой объект прорисовки**](/windows/desktop/api/D3D10/ne-d3d10-d3d10_bind_flag) или **\_ \_ \_ ресурс привязки D3D10 BIND**). Данные копируются из текстуры визуализации в текстуру шейдера с помощью [**копиресаурце**](/windows/desktop/api/D3D10/nf-d3d10-id3d10device-copyresource) или [**кописубресаурцерегион**](/windows/desktop/api/D3D10/nf-d3d10-id3d10device-copysubresourceregion). Это может повысить производительность путем изоляции записи целевого объекта рендеринга с помощью средства считывания текстурного шейдера. Конечно, единственным способом убедиться в том, чтобы реализовать оба подхода и оценить разницу в производительности в конкретном приложении.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Ресурсы (Direct3D 10)](d3d10-graphics-programming-guide-resources.md)
</dt> </dl>

 

 



