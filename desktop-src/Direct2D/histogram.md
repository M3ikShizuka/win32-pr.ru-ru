---
title: Гистограмма
description: Используйте эффекты гистограммы, чтобы создать гистограмму для входного точечного рисунка на основе указанного числа ячеек.
ms.assetid: 458E2334-F383-41DE-9479-601AC3007BF3
keywords:
- Гистограмма
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b654ffb2b830914b00a59490ceb429b5de9c51cb
ms.sourcegitcommit: a1494c819bc5200050696e66057f1020f5b142cb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2020
ms.locfileid: "104415368"
---
# <a name="histogram-effect"></a>Гистограмма

Используйте эффекты гистограммы, чтобы создать гистограмму для входного точечного рисунка на основе указанного числа ячеек.

Идентификатором CLSID для этого действия является CLSID \_ D2D1Histogram.

-   [Пример](#example)
-   [Свойства эффектов](#effect-properties)
-   [Селекторы каналов](#channel-selectors)
-   [Выходные данные](#data-output)
-   [Замечания](#remarks)
-   [Требования](#requirements)
-   [См. также](#related-topics)

## <a name="example"></a>Пример



| До                                                     |
|------------------------------------------------------------|
| ![изображение перед результатом.](images/default-before.jpg) |
| Диаграмма выходных данных гистограммы                         |
| ![изображение после преобразования.](images/33-histogram.png) |



 


```C++
ComPtr<ID2D1Effect> histogramEffect;
m_d2dContext->CreateEffect(CLSID_D2D1Histogram, &histogramEffect);

histogramEffect->SetInputEffect(0, m_2DAffineTransformEffectRight.Get());
histogramEffect->SetValue(D2D1_HISTOGRAM_PROP_CHANNEL_SELECT, D2D1_CHANNEL_SELECTOR_G);

m_d2dContext->BeginDraw();
m_d2dContext->DrawImage(histogramEffect.Get());
m_d2dContext->EndDraw();

// The histogram data is only available once the effect has been 'drawn'.
int histogramBinCount;

HRESULT hr = histogramEffect->GetValue(D2D1_HISTOGRAM_PROP_NUM_BINS, &histogramBinCount);

float *histogramData = new float[histogramBinCount];
hr = histogramEffect->GetValue(D2D1_HISTOGRAM_PROP_HISTOGRAM_OUTPUT, 
                               reinterpret_cast<BYTE*>(histogramData), 
                               histogramBinCount * sizeof(float));
```



## <a name="effect-properties"></a>Свойства эффектов

Вот уравнение для создания выходных данных.

![Уравнение для формирования выходных данных для гистограммы.](images/histogram-formula.png)

*i* вычисляется от 0 до количества ячеек. Этот результат создает гистограмму для значений пикселей от 0 до 1. Значения за пределами этого диапазона записываются в диапазон. Диапазон конкретного контейнера зависит от количества сегментов. Этот результат работает с прямыми растровыми пикселями. Цветовые каналы входного точечного рисунка делятся на альфа-канал, чтобы вычислить этот результат.



| Отображаемое имя и перечисление индекса                                             | Тип и значение по умолчанию                                                   | Описание                                                                                                                                                                                   |
|--------------------------------------------------------------------------------|--------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| нумбинс<br/> \_ \_ \_ Число ячеек в D2D1 гистограммы \_<br/>                 | ЗНАЧЕНИЕМ<br/> 256<br/>                                         | Указывает количество ячеек, используемых для гистограммы. Диапазон значений интенсивности, попавших в определенный контейнер, зависит от числа указанных контейнеров.                              |
| чаннелселект<br/> \_ \_ \_ Выбор канала Prop гистограммы D2D1 \_<br/>     | \_Выбор канала \_ D2D1<br/> \_Выбор канала \_ D2D1 \_ R<br/> | Указывает канал, используемый для создания гистограммы. Этот результат имеет один выход данных, соответствующий указанному каналу. Дополнительные сведения см. в разделе [Селекторы каналов](#channel-selectors) . |
| хистограмаутпут<br/> \_ \_ \_ Выходные данные гистограммы свойств D2D1 гистограммы \_<br/> | СДЕЛАТЬ\[\]<br/> Только свойство Output.<br/>                    | Выходной массив.                                                                                                                                                                             |



 

## <a name="channel-selectors"></a>Селекторы каналов



| Перечисление                | Описание                                                           |
|----------------------------|-----------------------------------------------------------------------|
| \_Выбор канала \_ D2D1 \_ R | Результат создает гистограмму на основе красного канала.   |
| \_Селектор канала \_ D2D1 \_ G | Результат создает гистограмму на основе зеленого канала. |
| \_Селектор каналов \_ D2D1 \_ B | Результат создает гистограмму на основе синего канала.  |
| \_Селектор каналов \_ D2D1 \_ | Результат создает гистограмму на основе альфа-канала. |



 

## <a name="data-output"></a>Выходные данные

Этот результат выводит число с плавающей запятой \[ \] с количеством элементов, соответствующим количеству указанных ячеек. Каждый элемент в FLOAT \[ \] имеет тип float. Значение элемента соответствует количеству элементов в этой ячейке.

## <a name="remarks"></a>Комментарии

> [!Note]  
> Метод [**креатиффект**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-createeffect) завершается ошибкой, если устройство не поддерживает DirectCompute и возвращает HRESULT = D2DERR \_ недостаточные \_ \_ возможности устройства. Все карточки DirectX11 и карты DirectX10, поддерживающие DirectCompute, могут использовать этот результат.

 

## <a name="requirements"></a>Требования



| Требование | Значение |
|--------------------------|------------------------------------------------------------------------------------|
| Минимальная версия клиента | Windows 8 и обновление платформы для \[ классических приложений Windows 7 \| приложения для Магазина Windows\] |
| Минимальная версия сервера | Windows 8 и обновление платформы для \[ классических приложений Windows 7 \| приложения для Магазина Windows\] |
| Header                   | d2d1effects. h                                                                      |
| Библиотека                  | D2D1. lib, дксгуид. lib                                                               |



 

## <a name="related-topics"></a>См. также

<dl> <dt>

[**ID2D1Effect**](/windows/win32/api/d2d1_1/nn-d2d1_1-id2d1effect)
</dt> </dl>

 

