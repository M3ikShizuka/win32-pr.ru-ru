---
title: Результат отображения белого сигнала
description: Этот результат позволяет линейно масштабировать белый уровень изображения. Это особенно полезно при преобразовании между пространством светимости, на которое ссылаются на сцены, или с пространством светимости, или наоборот.
ms.topic: article
ms.date: 02/01/2019
ms.openlocfilehash: 70a38f37f5a5461b968099bebe4be120a727c053
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127162508"
---
# <a name="white-level-adjustment-effect"></a>Корректировка белого уровня

Этот результат позволяет линейно масштабировать белый уровень изображения. Это особенно полезно при преобразовании между пространством светимости, на которое ссылаются на сцены, или с пространством светимости, или наоборот.

Свойства для этого действия определяются [**перечислением D2D1_WHITELEVELADJUSTMENT_PROP**](/windows/desktop/api/d2d1effects_2/ne-d2d1effects_2-d2d1_whiteleveladjustment_prop), а идентификатором CLSID является **CLSID_D2D1WhiteLevelAdjustment**.

## <a name="effect-properties"></a>Свойства эффектов

| Отображаемое имя и перечисление индекса | Тип и значение по умолчанию | Описание |
|-|-|-|
| Инпутвхителевел, D2D1_WHITELEVELADJUSTMENT_PROP_INPUT_WHITE_LEVEL | FLOAT | Белый уровень входного изображения в НИТС. |
| Аутпутвхителевел, D2D1_WHITELEVELADJUSTMENT_PROP_OUTPUT_WHITE_LEVEL | FLOAT | Белый уровень выходного изображения в НИТС. |

## <a name="remarks"></a>Комментарии
Этот результат предназначен для совмещения с [результатом карты тона HDR](hdr-tone-map-effect.md) , что позволяет визуализировать HDR-изображения в Direct2D с правильным управлением цветом и сопоставлением тонов. Дополнительные сведения см. в **комментариях** этого раздела. эти эффекты нацелены на любую платформу, которая хочет обеспечить лучшее в своем классе представление hdr-изображений, которое обрабатывает все форматы изображений Windows hdr и адаптируется к возможностям отображения (будь то HDR или вкг/SDR).

на Windows предполагается, что содержимое SDR/вкг находится в пространстве светимости, которое означает, что белый уровень содержимого должен масштабироваться до белого уровня отображения, прежде чем он будет представлен в конечном итоге. Однако это не всегда отвечает вашему приложению. В отличие от этого, содержимое HDR предполагается в пространстве светимости, которое, в свою очередь, не должно масштабироваться в соответствии с белым уровнем экрана. Таким образом, приложению может потребоваться выполнить масштабирование в некоторых обстоятельствах при отрисовке HDR-содержимого, чтобы убедиться в том, что это в итоге.

когда Windows desktop находится в режиме SDR или вкг, рабочий стол состоит из области светимости, на которой отображаются ссылки. но если Windows настольный компьютер находится в режиме HDR, то компоновка рабочего стола происходит в пространстве светимости. С другой стороны, диспетчер окон рабочего стола (DWM) выполняет корректировки светимости (часто именуемые Сдрбуст) для 8-разрядных поверхностей композиции, что упрощает приложение для этого случая. Несмотря на это, автоматическое повышение означает, что роль приложения при преобразовании из одного пространства светимости в другую зависит от формата композиции, используемого приложением для представления его содержимого.

В приведенной ниже таблице описаны случаи, когда приложение должно не выполнять коррекцию белого уровня, а также то, что должно быть скорректировано. Как правило, корректировка зависит от трех факторов.

1. Входное содержимое колорспаце. Содержит ли Ваше входное содержимое значения светимости высокой динамической области (HDR) или нет. Содержимое ВКГ работает так же, как и SDR для поведения светимости.
2. Формат композиции. Формат пикселей целевой поверхности, представленный в DWM, &mdash; например [цепочка](/windows/desktop/api/dxgi/nn-dxgi-idxgiswapchain) буферов или [область композиции](/uwp/api/Windows.UI.Composition.ICompositionSurface). При подготовке к просмотру с помощью Direct2D это значение **UINT8** или **FP16**.
3. Расширенный цветовой режим рабочего стола. Выполняется ли DWM в режиме SDR, ВКГ или HDR для текущего экрана. Получите эти сведения с помощью [**DXGI_OUTPUT_DESC1:: колорспаце**](/windows/desktop/api/dxgi1_6/ns-dxgi1_6-dxgi_output_desc1) или [**адванцедколоринфо. куррентадванцедколоркинд**](/uwp/api/windows.graphics.display.advancedcolorinfo.currentadvancedcolorkind).

На основе этих трех факторов необходимо задать соответствующие значения для `InputWhiteLevel` `OutputWhiteLevel` свойств и.

|Входное содержимое|Формат композиции|Расширенный цветовой режим|инпутвхителевел|аутпутвхителевел|
|-|-|-|-|-|
|SDR/ВКГ|**UINT8**|Любой|Н/Д|Недоступно|
|SDR/ВКГ|**FP16**|SDR/ВКГ|Недоступно|Недоступно|
|SDR/ВКГ|**FP16**|HDR|сдрвхите|80|
|HDR|Любой|SDR/ВКГ|80|[**DXGI_OUTPUT_DESC1:: Макслуминанце**](/windows/desktop/api/dxgi1_6/ns-dxgi1_6-dxgi_output_desc1)|
|HDR|**UINT8**|HDR|80|сдрвхите|
|HDR|**FP16**|HDR|Недоступно|Недоступно|

В таблице значением 80 является белый уровень ссылки в НИТС для содержимого sRGB или scRGB. Для этого можно использовать константную [**D2D1_SCENE_REFERRED_SDR_WHITE_LEVEL**](/windows/desktop/direct2d/direct2d-constants), которая определена в `d2d1effects_2.h` . Значение `SDRWhite` — это число НИТС, которое должно использоваться для вывода белого содержимого sRGB. Это значение можно получить, обратившись к свойству [**адванцедколоринфо. сдрвхителевелиннитс**](/uwp/api/windows.graphics.display.advancedcolorinfo.sdrwhitelevelinnits) . Значение N/A означает, что в этом сценарии корректировка белого уровня не используется. можно либо удалить результат из графа, либо задать значения для отсутствия операций.

Обратите внимание, что в случаях, когда для приложения не требуется корректировка белого уровня, DWM или дисплей могут обрабатывать преобразование из пространства светимости, на котором они ссылаются, в область светимости, на которую ссылается сцена.

- В режиме SDR/ВКГ преобразование происходит после композиции DWM и применяется ко всему содержимому, представленному для этого отображения. На экране неявным образом выполняется это преобразование.
- В режиме HDR преобразование выполняется автоматически с помощью DWM перед композицией, если область композиции приложения — SDR.

## <a name="requirements"></a>Требования

| Требование | Значение |
|-|-|
| Минимальная версия клиента | Windows 10, версия 1809 (10,0; Сборка 17763) \[ приложения UWP для классических приложений \|\] |
| Заголовок | d2d1effects \_ 2. h |
| Библиотека | D2D1. lib, дксгуид. lib |

## <a name="related-topics"></a>Связанные темы

* [Интерфейс ID2D1Effect](/windows/desktop/api/d2d1_1/nn-d2d1_1-id2d1effect)
* [Перечисление D2D1_WHITELEVELADJUSTMENT_PROP](/windows/desktop/api/d2d1effects_2/ne-d2d1effects_2-d2d1_whiteleveladjustment_prop)
