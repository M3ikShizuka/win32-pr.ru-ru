---
title: Эффект тени
description: Используйте эффект тени, чтобы создать тень из альфа-канала изображения.
ms.assetid: 53525584-10CF-46C2-9400-C4FB225D4693
keywords:
- эффект тени
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c42fd8755078dd79f2b01b623b1839785beb3c3e
ms.sourcegitcommit: a1494c819bc5200050696e66057f1020f5b142cb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2020
ms.locfileid: "104340410"
---
# <a name="shadow-effect"></a>Эффект тени

Используйте эффект тени, чтобы создать тень из альфа-канала изображения. Тень является более непрозрачной для больших альфа-значений и более прозрачной для меньших значений альфа. Можно задать степень размытия и цвет тени.

-   [Пример изображения](#example-image)
-   [Свойства эффектов](#effect-properties)
-   [Режимы оптимизации](#optimization-modes)
-   [Битовая карта вывода](#output-bitmap)
-   [Требования](#requirements)
-   [См. также](#related-topics)

Идентификатором CLSID для этого действия является CLSID \_ D2D1Shadow.

## <a name="example-image"></a>Пример изображения

В этом примере показаны выходные данные эффект тени, переведенный вниз и вправо, с исходным изображением, совмещенным над ним в исходном расположении. Эффект тени выводит только тень.



| До                                                  |
|---------------------------------------------------------|
| ![изображение перед результатом.](images/8-crop.png)      |
| После                                                   |
| ![изображение после преобразования.](images/25-shadow.png) |



 


```C++
ComPtr<ID2D1Effect> shadowEffect;
m_d2dContext->CreateEffect(CLSID_D2D1Shadow, &shadowEffect);

shadowEffect->SetInput(0, bitmap);

// Shadow is composited on top of a white surface to show opacity.
ComPtr<ID2D1Effect> floodEffect;
m_d2dContext->CreateEffect(CLSID_D2D1Flood, &floodEffect);

floodEffect->SetValue(D2D1_FLOOD_PROP_COLOR, D2D1::Vector4F(1.0f, 1.0f, 1.0f, 1.0f));

ComPtr<ID2D1Effect> affineTransformEffect;
m_d2dContext->CreateEffect(CLSID_D2D12DAffineTransform, &affineTransformEffect);

affineTransformEffect->SetInputEffect(0, shadowEffect.Get());

D2D1_MATRIX_3X2_F matrix = D2D1::Matrix3x2F::Translation(20, 20));

affineTransformEffect->SetValue(D2D1_2DAFFINETRANSFORM_PROP_TRANSFORM_MATRIX, matrix);

ComPtr<ID2D1Effect> compositeEffect;
m_d2dContext->CreateEffect(CLSID_D2D1Composite, &compositeEffect);

compositeEffect->SetInputEffect(0, floodEffect.Get());
compositeEffect->SetInputEffect(1, affineTransformEffect.Get());
compositeEffect->SetInput(2, bitmap);

m_d2dContext->BeginDraw();
m_d2dContext->DrawImage(compositeEffect.Get());
m_d2dContext->EndDraw();
```



## <a name="effect-properties"></a>Свойства эффектов



| Отображаемое имя и перечисление индекса                                                        | Описание                                                                                                                                                                                                                                                                                                                                                                                                                  |
|-------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| блурстандарддевиатион<br/> \_ \_ \_ \_ Стандартное отклонение размытия D2D1 Shadow Prop \_<br/> | Объем размытия, применяемый к альфа-каналу изображения. Можно вычислить Радиус размытия ядра, умножив стандартное отклонение на 3. Единицы как стандартного отклонения, так и размытого радиуса являются DIP.<br/> Это свойство аналогично свойству отклонение по стандартам [размытия по Гауссу](gaussian-blur.md) . <br/> Тип — FLOAT.<br/> Значение по умолчанию — 3.0 f.<br/> |
| Цвет<br/> \_Цвет D2D1 \_ shadow \_<br/>                                     | Цвет тени. Это свойство является D2D1 \_ вектором \_ 4F, определенным как: (R, G, B, a). Этот цвет необходимо указать в виде прямой альфа-составляющей.<br/> Тип — D2D1 \_ vector \_ 4F.<br/> Значение по умолчанию — {0.0 f, 0,0 f, 0,0 f, 1,0 f}.<br/>                                                                                                                                                                     |
| Optimization<br/> \_Оптимизация D2D1 Shadow \_ prop \_<br/>                       | Уровень оптимизации производительности.<br/> Тип — D2D1 с \_ \_ оптимизацией тени.<br/> Значение по умолчанию — D2D1 с \_ \_ балансировкой теневой оптимизации \_ .<br/>                                                                                                                                                                                                                                                   |



 

## <a name="optimization-modes"></a>Режимы оптимизации



| Имя                                          | Описание                                                                                                                           |
|-----------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------|
| \_ \_ Скорость оптимизации D2D1 \_ директионалблур    | Применяет внутренние оптимизации, такие как предварительное масштабирование относительно небольших радиусов. Использует линейную фильтрацию.                                  |
| \_ \_ Сбалансированная оптимизация D2D1 директионалблур \_ | Использует те же пороговые значения оптимизации, что и режим скорости, но использует фильтрацию трилинейной.                                                    |
| \_ \_ Качество оптимизации D2D1 \_ директионалблур  | В используются только внутренние оптимизации с большими радиусами, где приближение меньше вероятно должно быть видимым. Использует фильтрацию трилинейной. |



 

## <a name="output-bitmap"></a>Битовая карта вывода

Размер выходного растрового изображения — это размер выходных данных размытия. Сумма увеличения выходного растрового изображения относительно исходного точечного рисунка может быть рассчитана с помощью следующего уравнения:

Увеличение битовой карты вывода (X и Y) = Блурстандарддевиатион (аппаратно-независимые пиксели (DIP)) \* 6 \* (dpi для пользователей)/96

Выходные данные увеличиваются одинаково во всем направлении. Например, если размер увеличивается на 10 пикселей в каждом направлении, левый верхний угол точечного рисунка расположен в (-5,-5), а нижний правый — в (105, 105), как показано на диаграмме здесь.

![Схема роста размера выходных данных эффект тени.](images/drop-shadow-output-growth.png)

## <a name="requirements"></a>Требования



| Требование | Значение |
|--------------------------|------------------------------------------------------------------------------------|
| Минимальная версия клиента | Windows 8 и обновление платформы для \[ классических приложений Windows 7 \| приложения для Магазина Windows\] |
| Минимальная версия сервера | Windows 8 и обновление платформы для \[ классических приложений Windows 7 \| приложения для Магазина Windows\] |
| Header                   | d2d1effects. h                                                                      |
| Библиотека                  | D2D1. lib, дксгуид. lib                                                               |



 

## <a name="related-topics"></a>См. также

<dl> <dt>

[**ID2D1Effect**](/windows/win32/api/d2d1_1/nn-d2d1_1-id2d1effect)
</dt> </dl>

 

