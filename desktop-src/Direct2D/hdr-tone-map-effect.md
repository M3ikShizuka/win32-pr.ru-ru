---
title: Результат отображения тона HDR
description: Этот результат настраивает динамический диапазон изображения для лучшего соответствия его содержимому с возможностью вывода.
ms.topic: article
ms.date: 02/01/2019
ms.openlocfilehash: 4c9234e1b50e155173630a2ff7d94756c5be6130
ms.sourcegitcommit: a1494c819bc5200050696e66057f1020f5b142cb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2020
ms.locfileid: "103892113"
---
# <a name="hdr-tone-map-effect"></a>Результат отображения тона HDR

Этот результат настраивает динамический диапазон изображения для лучшего соответствия его содержимому с возможностью вывода.

Свойства для этого действия определяются [**перечислением D2D1_HDRTONEMAP_PROP**](/windows/desktop/api/d2d1effects_2/ne-d2d1effects_2-d2d1_hdrtonemap_prop), а идентификатором CLSID является **CLSID_D2D1HdrToneMap**.

## <a name="effect-properties"></a>Свойства эффектов

| Отображаемое имя и перечисление индекса | Тип и значение по умолчанию | Описание |
|-|-|-|
| Инпутмакслуминанце, D2D1_HDRTONEMAP_PROP_INPUT_MAX_LUMINANCE | FLOAT | Максимальный уровень яркости (или Максклл) изображения в НИТС. |
| Аутпутмакслуминанце, D2D1_HDRTONEMAP_PROP_OUTPUT_MAX_LUMINANCE | FLOAT | Максклл, поддерживаемый целью вывода, в НИТС &mdash; обычно имеет значение максклл для дисплея. |
| DisplayMode, D2D1_HDRTONEMAP_PROP_DISPLAY_MODE | [**D2D1_HDRTONEMAP_DISPLAY_MODE**](/windows/desktop/api/d2d1effects_2/ne-d2d1effects_2-d2d1_hdrtonemap_display_mode) | Если задано значение **_HDR**, кривая сопоставления тонов корректируется так, чтобы лучше соответствовать поведению общих HDR-отображений. |

## <a name="remarks"></a>Комментарии
Значение для `InputMaxLuminance` обычно является производным от метаданных изображения. Для случаев, когда метаданные отсутствуют, можно использовать функцию **D2DAdvancedColorImagesRenderer:: компутехдрметадата** (в [примере подготовки к просмотру изображения Direct2D](https://github.com/Microsoft/Windows-universal-samples/tree/master/Samples/D2DAdvancedColorImages)) для расчета максимального уровня яркости (максклл) изображения в НИТС.

Значение для `OutputMaxLuminance` является производным от дисплея с помощью [**DXGI_OUTPUT_DESC1:: макслуминанце**](/windows/desktop/api/dxgi1_6/ns-dxgi1_6-dxgi_output_desc1).

На карте тона HDR размещается разная кривая карт тонов в зависимости от того, является ли дисплей HDR-дисплеем или дисплеем SDR/ВКГ.

Этот результат предназначен для совместного [применения коррекции белого уровня](white-level-adjustment-effect.md) , что позволяет визуализировать HDR-изображения в Direct2D с правильным управлением цветом и сопоставлением тонов. Она нацелена на любую платформу, которая хочет предоставить лучшее в своем классе представление HDR-изображений, которое обрабатывает все форматы изображений Windows HDR, и адаптируется к возможностям отображения (будь то HDR или ВКГ/SDR). Эффекты должны быть объединены в цепочку последовательно, как описано ниже.

- Возьмем входной образ, цветное пространство которого определяется его кодеком. Метаданные могут указывать Вхитепоинт. Метаданные могут указывать уровень освещенности входных данных.
- Примените эффекты управления цветом. Преобразовать в пространство scRGB (КККС).
- Примените стильный результат HDR-карт. Уменьшите уровень яркости изображения до нужного уровня.
- Применение корректирующего действия уровня белого цвета. Масштабировать белый уровень изображения до белого уровня, необходимого для цепочки буферов обмена.
- Снова примените к нему эффекты управления цветом. При подготовке к просмотру в 8bpc, а затем преобразуйте в sRGB.

## <a name="requirements"></a>Требования

| Требование | Значение |
|-|-|
| Минимальная версия клиента | Windows 10, версия 1809 (10,0; Сборка 17763) \[ приложения UWP для классических приложений \|\] |
| Header | d2d1effects \_ 2. h |
| Библиотека | D2D1. lib, дксгуид. lib |

## <a name="related-topics"></a>См. также

* [Интерфейс ID2D1Effect](/windows/desktop/api/d2d1_1/nn-d2d1_1-id2d1effect)
* [Перечисление D2D1_HDRTONEMAP_PROP](/windows/desktop/api/d2d1effects_2/ne-d2d1effects_2-d2d1_hdrtonemap_prop)
