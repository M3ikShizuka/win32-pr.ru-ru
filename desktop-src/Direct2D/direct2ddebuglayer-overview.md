---
title: Общие сведения о слое отладки Direct2D
description: Общие сведения о слое отладки Direct2D
ms.assetid: 7c28e00b-ebb9-4b79-939c-64eade1351ad
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 833174e0d18b11e2384d838930d5508601cfceaf
ms.sourcegitcommit: 95685061d5b0333bbf9e6ebd208dde8190f97005
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2021
ms.locfileid: "108099992"
---
# <a name="direct2d-debug-layer-overview"></a>Общие сведения о слое отладки Direct2D

Уровень отладки Direct2D предоставляет отладочные сообщения времени разработки для снижения сбоев приложения среды выполнения. В этом обзоре описываются основы слоя отладки Direct2D. Предполагается, что вы знакомы с созданием базовых приложений Direct2D.

Этот обзор содержит следующие разделы.

-   [Что такое уровень отладки Direct2D](#what-is-the-direct2d-debug-layer)
-   [Установка слоя отладки Direct2D](#installing-the-direct2d-debug-layer)
-   [Включение слоя отладки](#enabling-the-debug-layer)
-   [Уровни отладки](#debug-levels)
-   [Связанные разделы](#related-topics)

## <a name="what-is-the-direct2d-debug-layer"></a>Что такое уровень отладки Direct2D

Слой отладки Direct2D, реализованный отдельно от Direct2D в собственной библиотеке DLL с именем d2d1debug.dll, предоставляет отладочные сообщения, позволяющие точно использовать функции Direct2D. Сообщения об отладке часто возникают из-за нарушений контракта API, например недопустимых параметров (может быть связано с Direct3D), недопустимых ресурсов, нарушений потоков и проблем с производительностью, таких как использование слоя при достаточном фрагменте. Чтобы указать объем данных, отслеживаемый слоем отладки, можно указать один из трех уровней отладки: сведения, предупреждение и ошибка. и сообщение об ошибке уровня активирует точку останова, которая поможет вам выполнить отладку.

## <a name="installing-the-direct2d-debug-layer"></a>Установка слоя отладки Direct2D

Инструкции по установке отладочного слоя см. в разделе [Установка отладочного слоя Direct2D](installing-the-direct2d-debug-layer.md).

## <a name="enabling-the-debug-layer"></a>Включение слоя отладки

Чтобы включить слой отладки в приложении, укажите значение [**\_ \_ уровня отладки D2D1**](/windows/desktop/api/d2d1/ne-d2d1-d2d1_debug_level) , отличное от **D2D1 \_ \_ уровень отладки \_ None** , при создании фабрики с помощью функции [**D2D1CreateFactory**](/windows/desktop/api/d2d1/nf-d2d1-d2d1createfactory) .

> [!Note]  
> Если включен слой отладки Direct2D, то \_ при задании контекста цвета может возникнуть нарушение прав доступа для управления цветом Direct2D (CLSID D2D1ColorManagement). Обходной путь заключается в отключении отладочного слоя при использовании эффекта управления цветом.

 

Включение слоя отладки для фабрики также включает отладочную информацию для любого объекта, созданного этой фабрикой.

В следующем примере включается уровень отладки для фабрики при компиляции приложения для конфигурации ОТЛАДОЧной сборки.


```C++
        // If you set the options.debugLevel to D2D1_DEBUG_LEVEL_NONE,
        // the debug layer is not enabled.
#if defined(DEBUG) || defined(_DEBUG)
        D2D1_FACTORY_OPTIONS options;
        options.debugLevel = D2D1_DEBUG_LEVEL_INFORMATION;

        hr = D2D1CreateFactory(
            D2D1_FACTORY_TYPE_SINGLE_THREADED,
            options,
            &m_pD2DFactory
            );
#else
        hr = D2D1CreateFactory(
            D2D1_FACTORY_TYPE_SINGLE_THREADED,
            &m_pD2DFactory
            );
#endif
```



> [!Note]  
> Если параметры фабрики не заданы или указан уровень отладки "нет", отладочный слой не вызывается. Отладочный слой никогда не должен быть активным в окончательной версии приложения.

 

В следующем разделе описаны различные уровни отладки, определяемые перечислением [**\_ \_ уровня отладки D2D1**](/windows/desktop/api/d2d1/ne-d2d1-d2d1_debug_level) .

## <a name="debug-levels"></a>Уровни отладки

В перечислении [**\_ \_ уровня отладки D2D1**](/windows/desktop/api/d2d1/ne-d2d1-d2d1_debug_level) заданы три уровня отладки: \_ Ошибка на \_ уровне отладки \_ (ошибка), D2D1 \_ \_ \_ warning (предупреждение) и D2D1 \_ \_ \_ (сведения) на уровне отладки. Эти уровни интерпретируется следующим образом:

-   **Ошибка:** Direct2D отправляет серьезные сообщения об ошибках на слой отладки. Например, при критическом ограничении потоков будет создаваться серьезная ошибка.

-   **Предупреждение:** Direct2D отправляет сообщения об ошибках и предупреждения на слой отладки, чтобы можно было обращаться к любому из этих сообщений.

-   **Сведения:** Direct2D отправляет сообщения об ошибках, предупреждения и дополнительные диагностические сведения на слой отладки. Например, сообщения улучшения производительности будут отправляться на этом уровне отладки.

Значение D2D1 \_ уровень отладки \_ \_ None (нет) указывает, что Direct2D не предоставляет никаких выходных данных отладки.

## <a name="related-topics"></a>Связанные разделы

<dl> <dt>

[Сообщения отладки](direct2ddebuglayer-debugmessages.md)
</dt> </dl>

 

 




