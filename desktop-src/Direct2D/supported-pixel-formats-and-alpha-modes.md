---
title: Поддерживаемые форматы пикселей и режимы альфа-канала
description: Описывает форматы пикселей и альфа-режимы, поддерживаемые каждым типом целевого объекта прорисовки.
ms.assetid: 09b1f9c6-1780-4733-ac22-9e8c21466b67
keywords:
- Direct2D, форматы пикселей
- Direct2D, режимы альфа-канала
ms.topic: article
ms.date: 05/31/2018
ms.custom: seodec18
ms.openlocfilehash: d5b260741cae6aebb447a11692f03dad6e35498a19f33221aa77ac8a8507144a
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119917164"
---
# <a name="supported-pixel-formats-and-alpha-modes"></a>Поддерживаемые форматы пикселей и режимы альфа-канала

В этом разделе описываются форматы пикселей и альфа-режимы, поддерживаемые различными частями Direct2D, включая тип целевого объекта прорисовки, [**ID2D1Bitmap**](/windows/win32/api/d2d1/nn-d2d1-id2d1bitmap)и [**ID2D1ImageSource**](/windows/win32/api/d2d1_3/nn-d2d1_3-id2d1imagesource). В него входят следующие разделы.

-   [Поддерживаемые форматы YUV для источника образа DXGI](#supported-yuv-formats-for-dxgi-image-source)
-   [Указание формата пикселей для целевого объекта прорисовки](#specifying-a-pixel-format-for-a-render-target)
-   [Поддерживаемые форматы для ID2D1HwndRenderTarget](#supported-formats-for-id2d1hwndrendertarget)
-   [Поддерживаемые форматы для ID2D1DeviceContext](#supported-formats-for-id2d1devicecontext)
-   [Поддерживаемые форматы для совместимого целевого объекта рендеринга](#supported-formats-for-compatible-render-target)
-   [Поддерживаемые форматы для целевого объекта прорисовки поверхности DXGI](#supported-formats-for-dxgi-surface-render-target)
-   [Поддерживаемые форматы для целевого объекта прорисовки для растрового изображения WIC](#supported-formats-for-wic-bitmap-render-target)
-   [Поддерживаемые форматы для ID2D1DCRenderTarget](#supported-formats-for-id2d1dcrendertarget)
-   [Указание формата пикселей для ID2D1Bitmap](#specifying-a-pixel-format-for-an-id2d1bitmap)
    -   [Поддерживаемые форматы WIC](#supported-wic-formats)
-   [Использование неподдерживаемого формата](#using-an-unsupported-format)
-   [Общие сведения о режимах альфа](#about-alpha-modes)
    -   [О предумноженных и прямых режимах альфа-канала](#about-premultiplied-and-straight-alpha-modes)
    -   [Различия между прямым и предварительно умноженным альфа-каналом](#the-differences-between-straight-and-premultiplied-alpha)
    -   [Режим альфа для целевых объектов прорисовки](#alpha-mode-for-render-targets)
    -   [Режимы ClearType и Alpha](#cleartype-and-alpha-modes)
-   [Связанные темы](#related-topics)

## <a name="supported-yuv-formats-for-dxgi-image-source"></a>Поддерживаемые форматы YUV для источника образа DXGI

[**ID2D1ImageSource**](/windows/win32/api/d2d1_3/nn-d2d1_3-id2d1imagesource) — это абстрактный поставщик пикселей. Его можно создать с помощью WIC ([**креатеимажесаурцефромвик**](/windows/desktop/api/d2d1_3/nf-d2d1_3-id2d1devicecontext2-createimagesourcefromwic(iwicbitmapsource_id2d1imagesourcefromwic)) или [**идксгисурфаце**](/windows/desktop/api/dxgi/nn-dxgi-idxgisurface) ([**креатеимажесаурцефромдксги**](/windows/win32/api/d2d1_3/nf-d2d1_3-id2d1devicecontext2-createimagesourcefromdxgi)).

[**ID2D1ImageSourceFromWic**](/windows/win32/api/d2d1_3/nn-d2d1_3-id2d1imagesourcefromwic) поддерживает тот же набор форматов пикселей и альфа-режимов, что и [**ID2D1Bitmap**](/windows/win32/api/d2d1/nn-d2d1-id2d1bitmap).

Помимо приведенного выше, [**ID2D1ImageSource**](/windows/win32/api/d2d1_3/nn-d2d1_3-id2d1imagesource) , создаваемый из [**идксгисурфаце**](/windows/desktop/api/dxgi/nn-dxgi-idxgisurface) , также поддерживает некоторые форматы пикселей YUV, включая плоскую разбивку данных на несколько поверхностей. Дополнительные сведения о требованиях для каждого формата пикселей см. в разделе [**креатеимажесаурцефромдксги**](/windows/win32/api/d2d1_3/nf-d2d1_3-id2d1devicecontext2-createimagesourcefromdxgi) .



| Формат                    |
|---------------------------|
| \_айув формата \_ DXGI        |
| \_NV12 формата \_ DXGI        |
| \_YUY2 формата \_ DXGI        |
| \_P208 формата \_ DXGI        |
| \_V208 формата \_ DXGI        |
| \_V408 формата \_ DXGI        |
| \_Формат DXGI \_ R8 \_ UNORM   |
| \_Формат DXGI \_ R8G8 \_ UNORM |



 

## <a name="specifying-a-pixel-format-for-a-render-target"></a>Указание формата пикселей для целевого объекта прорисовки

При создании целевого объекта рендеринга необходимо указать его формат пикселей. Чтобы указать формат пикселей, используйте структуру [**\_ \_ формата пикселей D2D1**](/windows/desktop/api/dcommon/ns-dcommon-d2d1_pixel_format) , чтобы задать элемент **PixelFormat** структуры [**\_ \_ \_ свойств целевого объекта прорисовки D2D1**](/windows/desktop/api/d2d1/ns-d2d1-d2d1_render_target_properties) . Затем вы передаете эту структуру в соответствующий метод Create, например [**ID2D1Factory:: креатехвндрендертаржет**](/previous-versions/windows/desktop/legacy/dd371275(v=vs.85)).

Структура [**\_ \_ формата пикселей D2D1**](/windows/desktop/api/dcommon/ns-dcommon-d2d1_pixel_format) имеет два поля:

-   **Формат**— значение [ \_ формата DXGI](/windows/win32/api/dxgiformat/ne-dxgiformat-dxgi_format) , описывающее размер и расположение каналов в каждом пикселе, и
-   **альфа**— значение [**\_ \_ режима альфа D2D1**](/windows/desktop/api/dcommon/ne-dcommon-d2d1_alpha_mode) , описывающее способ интерпретации данных альфа-канала.

В следующем примере создается структура [**\_ \_ формата пикселей D2D1**](/windows/desktop/api/dcommon/ns-dcommon-d2d1_pixel_format) , которая используется для указания формата пикселей и альфа-режима [**ID2D1HwndRenderTarget**](/windows/win32/api/d2d1/nn-d2d1-id2d1hwndrendertarget).


```C++
RECT rc;
GetClientRect(m_hwnd, &rc);

D2D1_SIZE_U size = D2D1::SizeU(
    rc.right - rc.left,
    rc.bottom - rc.top
    );

// Create a pixel format and initial its format
// and alphaMode fields.
D2D1_PIXEL_FORMAT pixelFormat = D2D1::PixelFormat(
    DXGI_FORMAT_B8G8R8A8_UNORM,
    D2D1_ALPHA_MODE_IGNORE
    );

D2D1_RENDER_TARGET_PROPERTIES props = D2D1::RenderTargetProperties();
props.pixelFormat = pixelFormat;

// Create a Direct2D render target.
hr = m_pD2DFactory->CreateHwndRenderTarget(
    props,
    D2D1::HwndRenderTargetProperties(m_hwnd, size),
    &m_pRT
    );

```



Разные целевые объекты отрисовки поддерживают разные сочетания формата и альфа-режима. В следующих разделах перечислены форматы и альфа-комбинации, поддерживаемые каждым из целевых объектов рендеринга.

## <a name="supported-formats-for-id2d1hwndrendertarget"></a>Поддерживаемые форматы для ID2D1HwndRenderTarget

Поддерживаемые форматы для [**ID2D1HwndRenderTarget**](/windows/win32/api/d2d1/nn-d2d1-id2d1hwndrendertarget) зависят от того, отображается ли он с помощью оборудования или программного обеспечения, или по умолчанию Direct2D автоматически обрабатывает режим отрисовки.

> [!Note]  
> Для лучшей производительности мы рекомендуем [**использовать \_ Формат DXGI \_ B8G8R8A8 \_ UNORM**](/windows/desktop/api/dxgiformat/ne-dxgiformat-dxgi_format) в качестве формата пикселей. Это особенно удобно для целевых объектов прорисовки программного обеспечения. Целевые объекты формата BGRA работают лучше, чем форматы RGBA.

 

При создании [**ID2D1HwndRenderTarget**](/windows/win32/api/d2d1/nn-d2d1-id2d1hwndrendertarget)используется структура [**\_ \_ \_ свойств целевого объекта прорисовки D2D1**](/windows/desktop/api/d2d1/ns-d2d1-d2d1_render_target_properties) для указания параметров подготовки к просмотру. Параметры включают формат пикселей, как указано в предыдущем разделе. Поле Type (тип) этой структуры позволяет указать, будет ли целевой объект прорисовки отображаться на оборудовании или программном обеспечении, или же Direct2D должен автоматически определять режим рендеринга.

Чтобы включить Direct2D для определения того, использует ли целевой объект отрисовки аппаратную или программную отрисовку, используйте параметр [**\_ \_ \_ \_ по умолчанию для типа прорисовки D2D1**](/windows/desktop/api/d2d1/ne-d2d1-d2d1_render_target_type) .

В следующей таблице перечислены поддерживаемые форматы для объектов [**ID2D1HwndRenderTarget**](/windows/win32/api/d2d1/nn-d2d1-id2d1hwndrendertarget) , которые создаются с помощью значения [**\_ \_ \_ \_ по умолчанию для типа целевого объекта визуализации D2D1**](/windows/desktop/api/d2d1/ne-d2d1-d2d1_render_target_type) .



| Формат                        | Альфа-режим                       |
|-------------------------------|----------------------------------|
| \_Формат DXGI \_ B8G8R8A8 \_ UNORM | Предварительное \_ \_ умножение режима альфа-канала D2D1 \_ |
| \_Формат DXGI \_ B8G8R8A8 \_ UNORM | \_Пропуск режима альфа-канала D2D1 \_ \_        |
| \_Формат DXGI \_ B8G8R8A8 \_ UNORM | \_Неизвестный режим альфа-канала D2D1 \_ \_       |
| \_неизвестный формат DXGI \_         | Предварительное \_ \_ умножение режима альфа-канала D2D1 \_ |
| \_неизвестный формат DXGI \_         | \_Пропуск режима альфа-канала D2D1 \_ \_        |
| \_неизвестный формат DXGI \_         | \_Неизвестный режим альфа-канала D2D1 \_ \_       |



 

Чтобы принудительно использовать аппаратную отрисовку для целевого объекта отрисовки, используйте параметр [**D2D1 \_ рендеринга \_ целевого \_ \_ устройства**](/windows/desktop/api/d2d1/ne-d2d1-d2d1_render_target_type) . В следующей таблице перечислены поддерживаемые форматы для объектов [**ID2D1HwndRenderTarget**](/windows/win32/api/d2d1/nn-d2d1-id2d1hwndrendertarget) , которые явно используют аппаратную отрисовку.



| Формат                        | Альфа-режим                       |
|-------------------------------|----------------------------------|
| \_Формат DXGI \_ B8G8R8A8 \_ UNORM | Предварительное \_ \_ умножение режима альфа-канала D2D1 \_ |
| \_Формат DXGI \_ B8G8R8A8 \_ UNORM | \_Пропуск режима альфа-канала D2D1 \_ \_        |
| \_Формат DXGI \_ B8G8R8A8 \_ UNORM | \_Неизвестный режим альфа-канала D2D1 \_ \_       |
| \_Формат DXGI \_ R8G8B8A8 \_ UNORM | Предварительное \_ \_ умножение режима альфа-канала D2D1 \_ |
| \_Формат DXGI \_ R8G8B8A8 \_ UNORM | \_Пропуск режима альфа-канала D2D1 \_ \_        |
| \_Формат DXGI \_ R8G8B8A8 \_ UNORM | \_Неизвестный режим альфа-канала D2D1 \_ \_       |
| \_неизвестный формат DXGI \_         | Предварительное \_ \_ умножение режима альфа-канала D2D1 \_ |
| \_неизвестный формат DXGI \_         | \_Пропуск режима альфа-канала D2D1 \_ \_        |
| \_неизвестный формат DXGI \_         | \_Неизвестный режим альфа-канала D2D1 \_ \_       |



 

Чтобы принудительно использовать программную отрисовку для целевого объекта прорисовки, используйте параметр [**\_ \_ \_ \_ программное обеспечение D2D1 render target Type**](/windows/desktop/api/d2d1/ne-d2d1-d2d1_render_target_type) . В следующей таблице перечислены поддерживаемые форматы для объектов [**ID2D1HwndRenderTarget**](/windows/win32/api/d2d1/nn-d2d1-id2d1hwndrendertarget) , которые явно используют программную отрисовку.



| Формат                        | Альфа-режим                       |
|-------------------------------|----------------------------------|
| \_Формат DXGI \_ B8G8R8A8 \_ UNORM | Предварительное \_ \_ умножение режима альфа-канала D2D1 \_ |
| \_Формат DXGI \_ B8G8R8A8 \_ UNORM | \_Пропуск режима альфа-канала D2D1 \_ \_        |
| \_Формат DXGI \_ B8G8R8A8 \_ UNORM | \_Неизвестный режим альфа-канала D2D1 \_ \_       |
| \_неизвестный формат DXGI \_         | Предварительное \_ \_ умножение режима альфа-канала D2D1 \_ |
| \_неизвестный формат DXGI \_         | \_Пропуск режима альфа-канала D2D1 \_ \_        |
| \_неизвестный формат DXGI \_         | \_Неизвестный режим альфа-канала D2D1 \_ \_       |



 

Независимо от того, является ли [**ID2D1HwndRenderTarget**](/windows/win32/api/d2d1/nn-d2d1-id2d1hwndrendertarget) аппаратным ускорением, [Формат \_ \_ неизвестного режима DXGI](/windows/win32/api/dxgiformat/ne-dxgiformat-dxgi_format) использует [ \_ Формат DXGI \_ B8G8R8A8](/windows/win32/api/dxgiformat/ne-dxgiformat-dxgi_format) по умолчанию, а в режиме альфа-канала [**D2D1 \_ \_ \_ Unknown**](/windows/desktop/api/dcommon/ne-dcommon-d2d1_alpha_mode) альфа Mode по умолчанию используется режим **D2D1 \_ Alpha \_ \_** .

## <a name="supported-formats-for-id2d1devicecontext"></a>Поддерживаемые форматы для ID2D1DeviceContext

начиная с Windows 8 [**контекст устройства**](/windows/win32/api/d2d1_1/nn-d2d1_1-id2d1devicecontext) использует преимущества большего числа [**форматов Direct3D высокого цвета**](/windows/desktop/api/dxgiformat/ne-dxgiformat-dxgi_format) , таких как:

-   \_Формат DXGI \_ B8G8R8A8 \_ UNORM \_ sRGB
-   \_Формат DXGI \_ R8G8B8A8 \_ UNORM \_ sRGB
-   \_Формат DXGI \_ R16G16B16A16 \_ UNORM
-   \_Формат DXGI \_ R16G16B16A16 \_ float
-   \_Формат DXGI \_ R32G32B32A32 \_ float

Используйте метод [**ID2D1DeviceContext:: исдксгиформатсуппортед**](/windows/win32/api/d2d1_1/nf-d2d1_1-id2d1devicecontext-isdxgiformatsupported) , чтобы узнать, работает ли формат в конкретном контексте устройства. Эти форматы также могут работать с [**ID2D1HwndRenderTarget**](/windows/win32/api/d2d1/nn-d2d1-id2d1hwndrendertarget).

эти форматы в дополнение к форматам, поддерживаемым интерфейсом [**ID2D1HwndRenderTarget**](/windows/win32/api/d2d1/nn-d2d1-id2d1hwndrendertarget) в Windows 7. Дополнительные сведения см. в разделе [устройства и контексты устройств](devices-and-device-contexts.md) .

## <a name="supported-formats-for-compatible-render-target"></a>Поддерживаемые форматы для совместимого целевого объекта рендеринга

Совместимый целевой объект отрисовки ( [**ID2D1BitmapRenderTarget**](/windows/win32/api/d2d1/nn-d2d1-id2d1bitmaprendertarget) , созданный одним из методов [**ID2D1RenderTarget:: креатекомпатиблерендертаржет**](/windows/desktop/api/d2d1/nf-d2d1-id2d1rendertarget-createcompatiblerendertarget(id2d1bitmaprendertarget)) ) наследует Поддерживаемые форматы и альфа-режимы целевого объекта рендеринга, который его создал. Совместимый целевой объект прорисовки также поддерживает следующие сочетания форматов и альфа-режима, независимо от того, какие из них поддерживает.



| Формат                  | Альфа-режим                       |
|-------------------------|----------------------------------|
| \_Формат DXGI \_ a8 \_ UNORM | Предварительное \_ \_ умножение режима альфа-канала D2D1 \_ |
| \_Формат DXGI \_ a8 \_ UNORM | \_Прямой режим альфа-канала D2D1 \_ \_      |
| \_неизвестный формат DXGI \_   | \_Неизвестный режим альфа-канала D2D1 \_ \_       |



 

Формат [ \_ \_ неизвестного формата DXGI](/windows/win32/api/dxgiformat/ne-dxgiformat-dxgi_format) использует родительский формат целевого объекта прорисовки по умолчанию, а режим альфа-канала [**D2D1 \_ Alpha \_ \_**](/windows/desktop/api/dcommon/ne-dcommon-d2d1_alpha_mode) по умолчанию использует **\_ \_ режим \_ альфа** -канала D2D1.

## <a name="supported-formats-for-dxgi-surface-render-target"></a>Поддерживаемые форматы для целевого объекта прорисовки поверхности DXGI

Целевой объект визуализации DXGI — это [**ID2D1RenderTarget**](/windows/win32/api/d2d1/nn-d2d1-id2d1rendertarget) , созданный одним из методов [**ID2D1Factory:: креатедксгисурфацерендертаржет**](/windows/win32/api/d2d1/nf-d2d1-id2d1factory-createdxgisurfacerendertarget(idxgisurface_constd2d1_render_target_properties__id2d1rendertarget)) . Он поддерживает следующие сочетания форматов и альфа-режима.



| Формат                        | Альфа-режим                       |
|-------------------------------|----------------------------------|
| \_Формат DXGI \_ B8G8R8A8 \_ UNORM | Предварительное \_ \_ умножение режима альфа-канала D2D1 \_ |
| \_Формат DXGI \_ B8G8R8A8 \_ UNORM | \_Пропуск режима альфа-канала D2D1 \_ \_        |
| \_Формат DXGI \_ R8G8B8A8 \_ UNORM | Предварительное \_ \_ умножение режима альфа-канала D2D1 \_ |
| \_Формат DXGI \_ R8G8B8A8 \_ UNORM | \_Пропуск режима альфа-канала D2D1 \_ \_        |
| \_Формат DXGI \_ a8 \_ UNORM       | Предварительное \_ \_ умножение режима альфа-канала D2D1 \_ |
| \_Формат DXGI \_ a8 \_ UNORM       | \_Прямой режим альфа-канала D2D1 \_ \_      |
| \_неизвестный формат DXGI \_         | Предварительное \_ \_ умножение режима альфа-канала D2D1 \_ |
| \_неизвестный формат DXGI \_         | \_Пропуск режима альфа-канала D2D1 \_ \_        |



 

> [!Note]  
> Формат должен соответствовать формату поверхности DXGI, в которую рисуется целевой объект отрисовки поверхности DXGI.

 

Формат [ \_ \_ неизвестного формата DXGI](/windows/win32/api/dxgiformat/ne-dxgiformat-dxgi_format) по умолчанию использует формат поверхности DXGI. Не используйте [**\_ режим альфа D2D1 Alpha \_ с \_ неизвестным**](/windows/desktop/api/dcommon/ne-dcommon-d2d1_alpha_mode) режимом альфа с целью отрисовки поверхности DXGI. Он не имеет значения по умолчанию и приведет к сбою создания целевого объекта отрисовки поверхности DXGI.

## <a name="supported-formats-for-wic-bitmap-render-target"></a>Поддерживаемые форматы для целевого объекта прорисовки для растрового изображения WIC

Целевой объект прорисовки растрового изображения WIC — это [**ID2D1RenderTarget**](/windows/win32/api/d2d1/nn-d2d1-id2d1rendertarget) , созданный одним из методов [**ID2D1Factory:: креатевикбитмапрендертаржет**](/windows/win32/api/d2d1/nf-d2d1-id2d1factory-createwicbitmaprendertarget(iwicbitmap_constd2d1_render_target_properties_id2d1rendertarget)) . Он поддерживает следующие сочетания форматов и альфа-режима.



| Формат                        | Альфа-режим                       |
|-------------------------------|----------------------------------|
| \_Формат DXGI \_ B8G8R8A8 \_ UNORM | Предварительное \_ \_ умножение режима альфа-канала D2D1 \_ |
| \_Формат DXGI \_ B8G8R8A8 \_ UNORM | \_Пропуск режима альфа-канала D2D1 \_ \_        |
| \_Формат DXGI \_ B8G8R8A8 \_ UNORM | \_Неизвестный режим альфа-канала D2D1 \_ \_       |
| \_Формат DXGI \_ a8 \_ UNORM       | Предварительное \_ \_ умножение режима альфа-канала D2D1 \_ |
| \_Формат DXGI \_ a8 \_ UNORM       | \_Прямой режим альфа-канала D2D1 \_ \_      |
| \_Формат DXGI \_ a8 \_ UNORM       | \_Неизвестный режим альфа-канала D2D1 \_ \_       |
| \_неизвестный формат DXGI \_         | Предварительное \_ \_ умножение режима альфа-канала D2D1 \_ |
| \_неизвестный формат DXGI \_         | \_Пропуск режима альфа-канала D2D1 \_ \_        |
| \_неизвестный формат DXGI \_         | \_Неизвестный режим альфа-канала D2D1 \_ \_       |



 

Формат пикселей цели битовой карты WIC должен соответствовать формату пикселей точечного рисунка WIC.

Формат [ \_ \_ неизвестного формата DXGI](/windows/win32/api/dxgiformat/ne-dxgiformat-dxgi_format) использует формат битовой карты WIC по умолчанию, а режим альфа-канала [**D2D1 \_ Alpha \_ \_**](/windows/desktop/api/dcommon/ne-dcommon-d2d1_alpha_mode) использует режим альфа-битовой архитектуры WIC по умолчанию.

## <a name="supported-formats-for-id2d1dcrendertarget"></a>Поддерживаемые форматы для ID2D1DCRenderTarget

[**ID2D1DCRenderTarget**](/windows/win32/api/d2d1/nn-d2d1-id2d1dcrendertarget) поддерживает следующие сочетания форматов и альфа-режима.



| Формат                        | Альфа-режим                       |
|-------------------------------|----------------------------------|
| \_Формат DXGI \_ B8G8R8A8 \_ UNORM | Предварительное \_ \_ умножение режима альфа-канала D2D1 \_ |
| \_Формат DXGI \_ B8G8R8A8 \_ UNORM | \_Пропуск режима альфа-канала D2D1 \_ \_        |



 

Не используйте формат [ \_ \_ неизвестного формата DXGI](/windows/win32/api/dxgiformat/ne-dxgiformat-dxgi_format) или альфа-режим [**D2D1 Alpha в качестве \_ \_ \_ неизвестного**](/windows/desktop/api/dcommon/ne-dcommon-d2d1_alpha_mode) режима альфа-канала с [**ID2D1DCRenderTarget**](/windows/win32/api/d2d1/nn-d2d1-id2d1dcrendertarget). Он не имеет значения по умолчанию и приведет к сбою создания **ID2D1DCRenderTarget** .

## <a name="specifying-a-pixel-format-for-an-id2d1bitmap"></a>Указание формата пикселей для ID2D1Bitmap

Как правило, объекты [**ID2D1Bitmap**](/windows/win32/api/d2d1/nn-d2d1-id2d1bitmap) поддерживают следующие форматы и альфа-режимы (с некоторыми ограничениями, описанными в следующих абзацах).



| Формат                                                      | Альфа-режим                       |
|-------------------------------------------------------------|----------------------------------|
| \_Формат DXGI \_ B8G8R8A8 \_ UNORM                               | Предварительное \_ \_ умножение режима альфа-канала D2D1 \_ |
| \_Формат DXGI \_ B8G8R8A8 \_ UNORM                               | \_Пропуск режима альфа-канала D2D1 \_ \_        |
| \_Формат DXGI \_ B8G8R8A8 \_ UNORM                               | \_Неизвестный режим альфа-канала D2D1 \_ \_       |
| \_Формат DXGI \_ a8 \_ UNORM                                     | Предварительное \_ \_ умножение режима альфа-канала D2D1 \_ |
| \_Формат DXGI \_ a8 \_ UNORM                                     | \_Прямой режим альфа-канала D2D1 \_ \_      |
| \_Формат DXGI \_ a8 \_ UNORM                                     | \_Неизвестный режим альфа-канала D2D1 \_ \_       |
| \_неизвестный формат DXGI \_                                       | Предварительное \_ \_ умножение режима альфа-канала D2D1 \_ |
| \_неизвестный формат DXGI \_                                       | \_Пропуск режима альфа-канала D2D1 \_ \_        |
| \_неизвестный формат DXGI \_                                       | \_Неизвестный режим альфа-канала D2D1 \_ \_       |
| \_формат DXGI \_ B8G8R8X8 \_ UNORM (Windows 8.1 и более поздние версии, только) | \_Пропуск режима альфа-канала D2D1 \_ \_        |
| \_формат DXGI \_ BC1 \_ UNORM (Windows 8.1 и более поздние версии, только)      | Предварительное \_ \_ умножение режима альфа-канала D2D1 \_ |
| \_формат DXGI \_ BC1 \_ UNORM (Windows 8.1 и более поздние версии, только)      | \_Пропуск режима альфа-канала D2D1 \_ \_        |
| \_формат DXGI \_ BC1 \_ UNORM (Windows 8.1 и более поздние версии, только)      | \_Неизвестный режим альфа-канала D2D1 \_ \_       |
| \_формат DXGI \_ BC2 \_ UNORM (Windows 8.1 и более поздние версии, только)      | Предварительное \_ \_ умножение режима альфа-канала D2D1 \_ |
| \_формат DXGI \_ BC2 \_ UNORM (Windows 8.1 и более поздние версии, только)      | \_Пропуск режима альфа-канала D2D1 \_ \_        |
| \_формат DXGI \_ BC2 \_ UNORM (Windows 8.1 и более поздние версии, только)      | \_Неизвестный режим альфа-канала D2D1 \_ \_       |
| \_формат DXGI \_ BC3 \_ UNORM (Windows 8.1 и более поздние версии, только)      | Предварительное \_ \_ умножение режима альфа-канала D2D1 \_ |
| \_формат DXGI \_ BC3 \_ UNORM (Windows 8.1 и более поздние версии, только)      | \_Пропуск режима альфа-канала D2D1 \_ \_        |
| \_формат DXGI \_ BC3 \_ UNORM (Windows 8.1 и более поздние версии, только)      | \_Неизвестный режим альфа-канала D2D1 \_ \_       |



 

При использовании метода [**ID2D1RenderTarget:: креатешаредбитмап**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-createsharedbitmap) используется поле **PixelFormat** структуры [**\_ \_ свойств D2D1 Bitmap**](/windows/desktop/api/d2d1/ns-d2d1-d2d1_bitmap_properties) для указания формата пикселей нового целевого объекта отрисовки. Он должен соответствовать формату пикселей источника [**ID2D1Bitmap**](/windows/win32/api/d2d1/nn-d2d1-id2d1bitmap) .

При использовании метода [**креатебитмапфромвикбитмап**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-createbitmapfromwicbitmap(iwicbitmapsource_constd2d1_bitmap_properties__id2d1bitmap)) используется поле **PixelFormat** структуры [**\_ \_ свойств битовой карты D2D1**](/windows/desktop/api/d2d1/ns-d2d1-d2d1_bitmap_properties) (вместо элемента **PixelFormat** структуры [**\_ \_ \_ свойств целевого объекта прорисовки D2D1**](/windows/desktop/api/d2d1/ns-d2d1-d2d1_render_target_properties) ) для указания формата пикселей нового целевого объекта прорисовки. Он должен соответствовать формату пикселей источника битовой карты WIC.

> [!Note]  
> Дополнительные сведения о поддержке блочных сжатых (BCn) форматов пикселей см. в разделе [блочное сжатие](block-compression.md).

 

### <a name="supported-wic-formats"></a>Поддерживаемые форматы WIC

При использовании метода [**креатебитмапфромвикбитмап**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-createbitmapfromwicbitmap(iwicbitmapsource_constd2d1_bitmap_properties__id2d1bitmap)) для создания точечного рисунка из растрового изображения WIC или при использовании метода [**креатешаредбитмап**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-createsharedbitmap) с [**ивикбитмаплокк**](/windows/win32/api/wincodec/nn-wincodec-iwicbitmaplock), источник WIC должен иметь формат, поддерживаемый Direct2D.



| Формат WIC                     | Соответствующий формат DXGI     | Соответствующий режим альфа                                        |
|--------------------------------|-------------------------------|-----------------------------------------------------------------|
| GUID \_ WICPixelFormat8bppAlpha  | \_Формат DXGI \_ a8 \_ UNORM       | \_Режим альфа D2D1 Alpha \_ \_ или режим альфа-канала D2D1 с предварительным \_ \_ \_ умножением |
| GUID \_ WICPixelFormat32bppPRGBA | \_Формат DXGI \_ R8G8B8A8 \_ UNORM | Пропуск предварительно \_ \_ \_ умноженного или неD2D1ого режима \_ \_ \_ альфа-канала D2D1   |
| GUID \_ WICPixelFormat32bppBGR   | \_Формат DXGI \_ B8G8R8A8 \_ UNORM | \_Пропуск режима альфа-канала D2D1 \_ \_                                       |
| GUID \_ WICPixelFormat32bppPBGRA | \_Формат DXGI \_ B8G8R8A8 \_ UNORM | Предварительное \_ \_ умножение режима альфа-канала D2D1 \_                                |



 

Пример преобразования битовой карты WIC в поддерживаемый формат см. в разделе [Загрузка растрового изображения из файла](how-to-load-a-direct2d-bitmap-from-a-file.md).

## <a name="using-an-unsupported-format"></a>Использование неподдерживаемого формата

Использование любого сочетания, кроме форматов пикселей и альфа-режимов, перечисленных в предыдущих таблицах, приводит к [**D2DERR \_ неподдерживаемому \_ \_ формату пикселей**](direct2d-error-codes.md) или ошибке **E \_ INVALIDARG** .

## <a name="about-alpha-modes"></a>Общие сведения о режимах альфа

### <a name="about-premultiplied-and-straight-alpha-modes"></a>О предумноженных и прямых режимах альфа-канала

Перечисление альфа-канального [**\_ \_ режима D2D1**](/windows/desktop/api/dcommon/ne-dcommon-d2d1_alpha_mode) указывает, использует ли альфа-канал предварительно умноженное альфа-значение, прямой альфа или должен игнорироваться и считаться непрозрачным. При использовании прямой альфа-канала альфа канал указывает значение, соответствующее прозрачности цвета.

Цвета всегда обрабатываются как прямые альфа-Direct2D команды рисования и кисти, независимо от формата назначения.

При использовании предварительно умноженного альфа-канала каждый цветовой канал масштабируется по значению альфа. Как правило, значение цветового канала не превышает значение альфа-канала. Если значение цветового канала в предварительно умноженном формате больше, чем альфа-канал, стандартные математические операции с исходным кодом создают Аддитивное смешение.

Значение альфа-канала само по себе является одинаковым как в прямом, так и в альфа-канале с предварительным умножением.

### <a name="the-differences-between-straight-and-premultiplied-alpha"></a>Различия между прямым и предварительно умноженным альфа-каналом

При описании цвета RGBA с помощью прямой альфа-составляющей цвет сохраняется в канале альфа. Например, чтобы описать красный цвет, который равен 60% непрозрачному, используйте следующие значения: (255, 0, 0, 255 \* 0,6) = (255, 0, 0, 153). Значение 255 указывает полный красный цвет, а 153 (т. е. 60% от 255) указывает, что цвет должен иметь непрозрачность в 60 процентов.

При описании цвета RGBA с помощью предварительно умноженного альфа-канала каждый цвет умножается на альфа-значение: (255 \* 0,6, 0 \* 0,6, 0 \* 0,6, 255 \* 0,6) = (153, 0, 0, 153).

Независимо от Альфа-режима целевого объекта рендеринга, значения [**D2D1 \_ Color \_ F**](d2d1-color-f.md) всегда обрабатываются как прямые альфа-каналы. Например, при указании цвета [**ID2D1SolidColorBrush**](/windows/win32/api/d2d1/nn-d2d1-id2d1solidcolorbrush) для использования с целевым объектом рендеринга, который использует режим с предварительным умножением альфа-канала, укажите цвет, точно так же, как если бы цель рендеринга использовала прямую альфа-канал. При рисовании с помощью кисти Direct2D преобразует цвет в формат назначения.

### <a name="alpha-mode-for-render-targets"></a>Режим альфа для целевых объектов прорисовки

Независимо от параметра режима альфа, содержимое целевого объекта рендеринга поддерживает прозрачность. Например, при рисовании частично прозрачного красного прямоугольника с целевым объектом отрисовки с режимом альфа-канала [**D2D1 \_ альфа \_ Mode \_ игнорируется**](/windows/desktop/api/dcommon/ne-dcommon-d2d1_alpha_mode), прямоугольник будет выглядеть розовым (если фон белый).

Если вы нарисуете частично прозрачный красный прямоугольник, когда альфа-режим [**D2D1 в \_ \_ режиме альфа \_**](/windows/desktop/api/dcommon/ne-dcommon-d2d1_alpha_mode), то прямоугольник будет выглядеть розовым (при условии, что фон является белым), и его можно увидеть в любом расположении позади целевого объекта прорисовки. Это полезно при использовании [**ID2D1DCRenderTarget**](/windows/win32/api/d2d1/nn-d2d1-id2d1dcrendertarget) для подготовки к просмотру в прозрачном окне или при использовании совместимого целевого объекта прорисовки (целевого рендеринга, созданного методом [**креатекомпатиблерендертаржет**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-createcompatiblerendertarget(id2d1bitmaprendertarget)) ) для создания точечного рисунка, поддерживающего прозрачность.

### <a name="cleartype-and-alpha-modes"></a>Режимы ClearType и Alpha

Если для целевого объекта прорисовки задан режим альфа-канала, отличный от [**\_ \_ \_ режима D2D1 Alpha**](/windows/desktop/api/dcommon/ne-dcommon-d2d1_alpha_mode) , то режим сглаживания текста автоматически меняется с [**D2D1 в \_ режиме сглаживания текста от \_ \_ CLEARTYPE**](/windows/desktop/api/d2d1/ne-d2d1-d2d1_text_antialias_mode) до **D2D1 \_ в \_ \_ режиме сглаживания текста**. (При указании альфа-режима **D2D1 \_ альфа \_ \_**, Direct2D устанавливает альфа-канал в зависимости от типа целевого объекта рендеринга.)

Вы можете использовать метод [**сеттекстантиалиасмоде**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-settextantialiasmode) , чтобы изменить режим сглаживания текста на [**D2D1 в \_ \_ \_ режиме сглаживания текста ClearType**](/windows/desktop/api/d2d1/ne-d2d1-d2d1_text_antialias_mode), но отрисовка текста CLEARTYPE на прозрачную поверхность может создать непредсказуемые результаты. Если требуется отобразить текст ClearType в прозрачном целевом объекте рендеринга, рекомендуется использовать один из следующих двух методов.

-   Используйте метод [**пушаксисалигнедклип**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-pushaxisalignedclip(constd2d1_rect_f_d2d1_antialias_mode)) для обрезки целевого объекта отрисовки в область, в которой будет визуализирован текст, затем вызовите метод [**clear**](id2d1rendertarget-clear.md) и укажите непрозрачный цвет, а затем отрисовываете текст.
-   Используйте [**DrawRectangle**](/windows/win32/api/d2d1/nf-d2d1-id2d1rendertarget-drawrectangle(constd2d1_rect_f_id2d1brush_float_id2d1strokestyle)) , чтобы нарисовать непрозрачный прямоугольник за областью, в которой будет визуализирован текст.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[**\_Формат ПИКСЕЛЕЙ \_ D2D1**](/windows/desktop/api/dcommon/ns-dcommon-d2d1_pixel_format)
</dt> <dt>

[**\_Режим альфа-канала D2D1 \_**](/windows/desktop/api/dcommon/ne-dcommon-d2d1_alpha_mode)
</dt> <dt>

[\_Формат DXGI](/windows/win32/api/dxgiformat/ne-dxgiformat-dxgi_format)
</dt> </dl>

 

 