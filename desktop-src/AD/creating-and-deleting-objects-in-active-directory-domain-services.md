---
title: Создание и удаление объектов в службах домен Active Directory Services
description: Процедура, используемая для программного создания и удаления объектов в домен Active Directory Services, зависит от используемой технологии программирования.
ms.assetid: 13f83aea-ad39-4737-af3c-24316a31046d
ms.tgt_platform: multiple
keywords:
- Создание и удаление Active Directory объектов Active Directory
- Active Directory домен Active Directory Services с помощью создания и удаления объектов
- объекты Active Directory, создание и удаление объектов домен Active Directory служб
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 11d3e85ef3c356978faeab059e3969bb657185bd
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "104487472"
---
# <a name="creating-and-deleting-objects-in-active-directory-domain-services"></a>Создание и удаление объектов в службах домен Active Directory Services

Процедура, используемая для программного создания и удаления объектов в домен Active Directory Services, зависит от используемой технологии программирования. Дополнительные сведения о создании и удалении объектов в службах домен Active Directory с помощью определенной технологии программирования см. в разделах, перечисленных в следующей таблице.



| Технология программирования                                                                       | Дополнительные сведения                                                            |
|----------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------|
| [Интерфейсы служб Active Directory](/windows/desktop/ADSI/active-directory-service-interfaces-adsi)         | [Создание и удаление объектов](/windows/desktop/ADSI/creating-and-deleting-objects)             |
| [протокол LDAP](/previous-versions/windows/desktop/ldap/lightweight-directory-access-protocol-ldap-api) | [Изменение записи каталога](/previous-versions/windows/desktop/ldap/modifying-a-directory-entry)                 |
| [System.DirectoryServices](/dotnet/api/system.directoryservices) | [Создание, удаление, переименование и перемещение объектов](https://msdn.microsoft.com/library/ms180850(v=VS.80).aspx) |



 

## <a name="creating-an-object"></a>Создание объекта

В целом, единственными атрибутами, необходимыми для создания объекта, являются атрибуты **CN** и **objectClass** . Однако только создание объекта не обязательно делает его функциональным объектом. Некоторые типы объектов, такие как пользователи и группы, имеют дополнительные необходимые атрибуты, чтобы сделать их функциональными. Дополнительные сведения о создании объектов определенного типа см. в разделе [Создание пользователя](creating-a-user.md) и [Создание групп в домене](creating-groups-in-a-domain.md).

**Windows Server 2003:** Когда объект класса [**User**](/windows/desktop/ADSchema/c-user), [**Group**](/windows/desktop/ADSchema/c-group)или [**Computer**](/windows/desktop/ADSchema/c-computer) создается на контроллере домена, работающем на сервере ввиндовс 2003 или более поздней версии, контроллер домена автоматически устанавливает атрибут [**SamAccountName**](/windows/desktop/ADSchema/a-samaccountname) для объекта в уникальную строку, если она не указана.

## <a name="deleting-an-object"></a>Удаление объекта

Сервер Active Directory выполняет следующие действия при удалении объекта:

-   Атрибут **IsDeleted** удаленного объекта установлен в **значение true**. Объекты с атрибутом **IsDeleted** , имеющим значение **true** , называются [*отметками полного удаления*](/previous-versions/windows/desktop/legacy/ms681941(v=vs.85)).
-   Удаленный объект перемещается в контейнер удаленных объектов для своего контекста именования. Если свойство объекта **systemFlags** содержит флаг 0x02000000, объект не перемещается в контейнер удаленные объекты. Дополнительные сведения о привязке и перечислении содержимого контейнера удаленных объектов см. в разделе [получение удаленных объектов](retrieving-deleted-objects.md).
-   Контейнер удаленных объектов является плоским, поэтому все объекты находятся на том же уровне в контейнере удаленных объектов. Таким словами, относительное различающееся имя удаленного объекта изменяется, чтобы гарантировать уникальность имени в контейнере удаленных объектов. Если исходное имя длиннее 75 символов, оно усекается до 75 символов. Затем к новому имени добавляются следующие имена:
    1.  Символ 0x0A
    2.  Строка "DEL:"
    3.  Форма строки уникального идентификатора GUID, например "947e3228-70c9-4311-8b7a-e5c9b5bd4432"

    Пример удаленного имени объекта:
    ```C++
    Jeff Smith\0ADEL:947e3228-70c9-4311-8b7a-e5c9b5bd4432
    ```

    

-   Большинство значений атрибутов удаленного объекта удаляются. Следующие атрибуты сохраняются автоматически:

    -   **attributeID**
    -   **attributeSyntax**
    -   **distinguishedName**
    -   **днреференцеупдате**
    -   **флатнаме**
    -   **governsID**
    -   **groupType**
    -   **instanceType**
    -   **lDAPDisplayName**
    -   **legacyExchangeDN**
    -   **mS-DS-Креаторсид**
    -   **мсмковнерид**
    -   **name**
    -   **Параметрами**
    -   **Атрибута**
    -   **objectGUID**
    -   **objectSid**
    -   **oMSyntax**
    -   **проксиедобжектнаме**
    -   **реплпропертиметадата**
    -   **sAMAccountName**
    -   **securityIdentifier**
    -   **subClassOf**
    -   **systemFlags**
    -   **трустаттрибутес**
    -   **трустдиректион**
    -   **трустпартнер**
    -   **трусттипе**
    -   **userAccountControl**
    -   **uSNChanged**
    -   **uSNCreated**
    -   **whenCreated**

    Также сохраняются другие атрибуты, имеющие значение атрибута **searchFlags** , которое содержит 0x00000008.

    Следующие значения атрибутов всегда удаляются из удаленного объекта:

    -   **objectCategory**
    -   **samAccountType**

-   Дескриптор безопасности удаленного объекта сохраняется, и наследуемые записи управления доступом не распространяются. Дескриптор безопасности сохраняется как есть на момент удаления объекта.
-   Ссылки на удаленный объект и из него очищаются. Это выполняется в фоновом режиме после удаления объекта. Если удаленный объект будет восстановлен до очистки всех ссылок, будет получено сообщение об ошибке.
-   Если объект удален на контроллере домена Windows Server 2003, атрибуту **lastKnownParent** удаленного объекта присваивается различающееся имя контейнера, в котором был удален объект.

Удаленный объект остается в контейнере удаленных объектов в течение времени, известного как время *существования захоронения*. По умолчанию время жизни захоронения составляет 60 дней, но это значение может быть изменено системным администратором. По истечении времени существования захоронения объект удаляется из службы каталогов без возможности восстановления. Чтобы избежать отсутствия операции удаления, приложение должно выполнять добавочную синхронизацию чаще, чем время существования захоронения.

В Windows Server 2003 добавлена возможность восстановления удаленных объектов. Дополнительные сведения об восстановлении удаленных объектов см. в разделе [Восстановление удаленных объектов](restoring-deleted-objects.md).

При удалении элемента ни один из атрибутов объекта изменить нельзя. В Windows Server 2003 можно изменить дескриптор безопасности (атрибут **нтсекуритидескриптор** ) на удаленном объекте. Это позволяет восстановить объекты, когда пользователь, выполняющий восстановление объекта, не имеет разрешений на запись в обязательные атрибуты. Для обновления дескриптора безопасности удаленного объекта вызывающий объект должен иметь право доступа "reanimate захоронения" в контексте именования в дополнение к обычной **записи \_ DAC** и доступу для **записи \_ владельца** . Даже если дескриптор безопасности является ограниченным, администратор может сначала стать владельцем объекта, предполагая, что администратор имеет привилегию **SE \_ Take \_ Ownership \_ Name** , а затем изменить дескриптор безопасности. Для этого используйте функцию [**LDAP \_ Modify \_ ext \_ s**](/previous-versions/windows/desktop/api/winldap/nf-winldap-ldap_modify_ext_s) с [**\_ сервером LDAP \_ отобразить \_ Удаленный \_**](/previous-versions/windows/desktop/ldap/ldap-server-show-deleted-oid) элемент управления OID. Список изменений должен содержать одну замену атрибута **нтсекуритидескриптор** .

 

 