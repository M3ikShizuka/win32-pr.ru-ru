---
title: Регистрация расширения создания объекта
description: При создании библиотеки DLL расширения создания объектов в домен Active Directory Services она должна быть зарегистрирована в реестре Windows и службах домен Active Directory для создания COM и оснасток Active Directory администрирования консоли MMC, осведомленных о расширении.
ms.assetid: 6e950c6c-1a4f-4de0-9be1-004c31d4734c
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c27d8e2a50c2340d678fd43e546d68525afbc8a7
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "103987314"
---
# <a name="registering-the-object-creation-extension"></a>Регистрация расширения создания объекта

При создании библиотеки DLL расширения создания объектов в домен Active Directory Services она должна быть зарегистрирована в реестре Windows и службах домен Active Directory для создания COM и оснасток Active Directory администрирования консоли MMC, осведомленных о расширении.

## <a name="registering-in-the-windows-registry"></a>Регистрация в реестре Windows

Как и все серверы COM, расширение создания объектов должно быть зарегистрировано в реестре Windows. Расширение регистрируется в следующем разделе:

```
HKEY_CLASSES_ROOT
   CLSID
      <extension CLSID>
         InProcServer32
            (Default) = <extension path>
            ThreadingModel = Apartment
```

" &lt; Extension CLSID &gt; " — это строковое представление идентификатора CLSID, созданное функцией [**стрингфромклсид**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) . " &lt; путь расширения &gt; " содержит путь и имя файла DLL расширения. Значение **ThreadingModel** для всех расширений создания объектов должно быть "апартаментом".

## <a name="registering-with-active-directory-domain-services"></a>Регистрация в домен Active Directory Services

Регистрация расширения для создания объектов относится только к одному языку. Если расширение создания объектов применяется ко всем языкам, оно должно быть зарегистрировано в объекте **дисплайспеЦифиер** класса Object во всех подконтейнерах языкового стандарта контейнера дисплайспеЦифиерс. Если расширение создания объекта локализовано для определенного языкового стандарта, зарегистрируйте его в объекте **дисплайспеЦифиер** в подконтейнере этого языкового стандарта. Дополнительные сведения о контейнере ДисплайспеЦифиерс и языковых стандартах см. в разделе [описатели экрана](display-specifiers.md) и [контейнеры дисплайспеЦифиерс](displayspecifiers-container.md).

Существует два атрибута ДисплайспеЦифиер, в которых можно зарегистрировать расширение создания объектов. Это **креатионвизард** и **креатевизардекст**.

Атрибут **креатионвизард** определяет расширения создания первичных объектов для замены существующего или собственного мастера создания объектов в Active Directory административных оснастках. Первичное расширение создания предоставляет первый набор страниц и размещается так же, как и собственные страницы. Этот атрибут является однозначным и требует следующего формата:


```C++
<CLSID>
```



" &lt; CLSID &gt; " — это строковое представление CLSID COM-объекта, созданное функцией [**стрингфромклсид**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) .

Атрибут **креатевизардекст** определяет расширения для создания дополнительного объекта. Вторичное расширение создания добавляет страницы мастера к собственным страницам или первичному расширению. Этот атрибут имеет несколько значений и требует следующего формата:


```C++
<order number>,<CLSID>
```



&lt;Порядковый номер &gt; — это число без знака, представляющее расположение страницы в мастере. При отображении мастера создания значения сортируются с помощью сравнения "номер заказа" каждого значения &lt; &gt; . Если несколько значений имеют одинаковый &lt; порядковый номер &gt; , эти страницы загружаются в том порядке, в котором они считываются с Active Directory сервера. По возможности следует использовать несуществующий " &lt; номер заказа &gt; " (то есть тот, который не использовался другими значениями в свойстве). Нет предписанной начальной должности, и в &lt; последовательности "номер заказа" могут пропуски &gt; .

" &lt; CLSID &gt; " — это строковое представление CLSID COM-объекта, созданное функцией [**стрингфромклсид**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) .

 

 