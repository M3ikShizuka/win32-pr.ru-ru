---
title: Указание области поиска
description: Область поиска можно указать как в базовом, на одном уровне, так и в поддереве.
ms.assetid: b02354c2-7b95-4911-8ae3-4a261d3ca2d3
ms.tgt_platform: multiple
keywords:
- Указание области поиска AD
- Active Directory, поиск, указание области поиска
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c7ff076e0410088c69eace25f204241c1c51c6fb
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "103789475"
---
# <a name="specifying-the-search-scope"></a>Указание области поиска

Область поиска можно указать как в базовом, на одном уровне, так и в поддереве. Используйте флаг **\_ \_ \_ области поиска ADS Сеарчпреф** со значениями перечисления [**ADS \_ скопинум**](/windows/win32/api/iads/ne-iads-ads_scopeenum) , чтобы указать область поиска. В следующем списке содержатся описания типов поиска:

-   **Базовый**. Базовый поиск ограничивает поиск базовым объектом. Максимальное число возвращаемых объектов всегда равно единице. Этот поиск полезен для проверки существования объекта для получения членства в группе. Например, если имеется различающееся имя объекта и необходимо проверить существование объекта на основе пути, можно использовать одноуровневый поиск. Если поиск завершается неудачно, можно предположить, что объект был переименован или перемещен в другое расположение, или вы получили неверные сведения об объекте. Имейте в виду, что вместо различающегося имени следует хранить глобальный уникальный идентификатор (GUID) объекта, если вы хотите повторно посетить объект. Идентификатор GUID всегда будет ссылаться на тот же объект, независимо от того, где находится объект в иерархии каталогов.
-   **Один уровень**. Одноуровневый поиск ограничивается непосредственными дочерними элементами базового объекта, но исключает сам базовый объект. Этот параметр может выполнять целевой поиск непосредственных дочерних объектов родительского объекта. Например, рассмотрим родительский объект P1 и его непосредственные дочерние элементы: C1, C2 и C3. Одноуровневый поиск вычисляет C1, C2 и C3 в соответствии с критериями поиска, но не вычисляет P1. Используйте одноуровневый поиск для перечисления всех дочерних элементов объекта. Перечисление [**иадсконтаинер**](/windows/desktop/api/iads/nn-iads-iadscontainer) преобразуется в одноуровневый поиск.
-   **Поддерево**. Поиск в поддереве (или глубоком поиске) включает все дочерние объекты, а также базовый объект. Вы можете запросить у поставщика LDAP отследить ссылки на другие службы каталогов LDAP, включая другие домены или леса каталога.

 

 