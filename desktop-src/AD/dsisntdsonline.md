---
title: Функция Дсиснтдсонлине (Нтдсбкли. h)
description: Определяет, находятся ли службы домен Active Directory на указанном сервере в сети.
ms.assetid: 8f46e4d8-6d05-402c-a5b4-291fd2d6609b
ms.tgt_platform: multiple
keywords:
- Active Directory функции Дсиснтдсонлине
topic_type:
- apiref
api_name:
- DsIsNTDSOnline
- DsIsNTDSOnlineA
- DsIsNTDSOnlineW
api_location:
- Ntdsbcli.dll
api_type:
- DllExport
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 0bf65109b4c72e1d403ece18d82b189039d74d58043271e0f5bf317f5272f84d
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118430026"
---
# <a name="dsisntdsonline-function"></a>Функция Дсиснтдсонлине

\[Эта функция доступна для использования в операционных системах, указанных в разделе требования. В последующих версиях он может быть изменен или недоступен. начиная с Windows Vista используйте вместо этого [служба теневого копирования томов (VSS)](../vss/volume-shadow-copy-service-overview.md) .\]

Функция **дсиснтдсонлине** определяет, подключены ли службы домен Active Directory к сети на указанном сервере.

## <a name="syntax"></a>Синтаксис


```C++
HRESULT DsIsNTDSOnline(
  _In_  LPCTSTR szServerName,
  _Out_ BOOL    *pfNTDSOnline
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*сзсервернаме* \[ окне\]
</dt> <dd>

Указатель на строку, завершающуюся нулем, которая содержит имя тестируемого сервера. Предыдущие обратные косые черты необязательны. Сервер должен быть тем же компьютером, из которого вызывается эта функция. Имя сервера не может содержать символы подчеркивания ( \_ ). Пример имени сервера — \\ \\ Server1.

</dd> <dt>

*пфнтдсонлине* \[ заполняет\]
</dt> <dd>

Указатель на **логическое** значение, получающее результат. Получает **значение true** , если служба каталогов находится в сети, или **значение false** , если служба каталогов находится в автономном режиме.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Возвращает **значение \_ ОК** , если функция выполнена успешно, или в противном случае — код ошибки. В следующем списке перечислены возможные коды ошибок.

<dl> <dt>

**Ошибка \_ отказа в доступе \_**
</dt> <dd>

Вызывающий объект не имеет необходимых прав доступа для вызова этой функции. Функцию [**дссетаусидентити**](dssetauthidentity.md) можно использовать для задания учетных данных, используемых для функций резервного копирования и восстановления.

</dd> <dt>

**хркаулднотконнект**
</dt> <dd>

Не удается найти сервер в *сзсервернаме* , не является контроллером домена, или *сзсервернаме* имеет неправильный формат. Это значение определено в Нтдсбмсг. h.

</dd> <dt>

**\_ \_ Недопустимая привязка RPC S \_**
</dt> <dd>

Функция [**дсиснтдсонлине**](dsisntdsonline.md) вызывается удаленно, или сервер в *сзсервернаме* не является контроллером домена.

</dd> </dl>

## <a name="remarks"></a>Remarks

Вызовите эту функцию перед вызовом любой из функций резервного копирования или восстановления каталога. Для выполнения резервного копирования каталог должен находиться в оперативном режиме. Для выполнения восстановления каталог должен находиться в автономном режиме.

Эту функцию можно вызвать только из контроллера домена, который также является целевым сервером, указанным в *сзсервернаме*. Эта функция не может быть вызвана удаленно.

## <a name="requirements"></a>Requirements (Требования)



| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows Vista<br/>                                                                |
| Минимальная версия сервера<br/> | Windows Server 2008<br/>                                                          |
| Header<br/>                   | <dl> <dt>Нтдсбкли. h</dt> </dl>   |
| Библиотека<br/>                  | <dl> <dt>Нтдсбкли. lib</dt> </dl> |
| DLL<br/>                      | <dl> <dt>Ntdsbcli.dll</dt> </dl> |
| Имя в кодировке Юникод и ANSI<br/>   | **Дсиснтдсонлинев** (Юникод) и **дсиснтдсонлинеа** (ANSI)<br/>                 |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**дссетаусидентити**](dssetauthidentity.md)
</dt> <dt>

[Функции резервного копирования каталога](directory-backup-functions.md)
</dt> <dt>

[Резервное копирование и восстановление сервера Active Directory](backing-up-and-restoring-an-active-directory-server.md)
</dt> </dl>

 

