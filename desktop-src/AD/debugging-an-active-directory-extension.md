---
title: Отладка расширения Active Directory
description: Вкладки свойств службы каталогов Microsoft Active Directory, контекстного меню и мастера создания объектов, описанные в этом разделе, реализуются как COM-серверы в процессе.
ms.assetid: 8c280084-fd2f-4d34-a119-d4e925a68a5c
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4fc8d9646f4ccc2e8c740a81ddb48422881744f5
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "104069790"
---
# <a name="debugging-an-active-directory-extension"></a>Отладка расширения Active Directory

Вкладки свойств службы каталогов Microsoft Active Directory, контекстного меню и мастера создания объектов, описанные в этом разделе, реализуются как COM-серверы в процессе. Это значит, что каждое расширение является библиотекой DLL, которая выполняется в контексте хост-процесса. Чтобы выполнить отладку расширения, необходимо связать расширение с приложением и запустить приложение в отладчике.

## <a name="debugging-active-directory-extensions-displayed-in-the-windows-shell"></a>Отладка расширений Active Directory, отображаемых в оболочке Windows

Расширения Active Directory, отображаемые в оболочке Windows, загружаются в контексте процесса Explorer.exe. Эти расширения можно отлаживать как стандартное расширение оболочки. Дополнительные сведения об отладке расширений оболочки см. [в разделе Отладка с помощью оболочки](/previous-versions/windows/desktop/legacy/cc144064(v=vs.85)).

## <a name="debugging-active-directory-extensions-displayed-in-the-active-directory-mmc-snap-ins"></a>Отладка расширений Active Directory, отображаемых в Active Directory MMC Snap-Ins

Расширения Active Directory, отображаемые в оснастке Active Directory администрирования консоли MMC, загружаются в контексте консоли управления (Майкрософт). Чтобы выполнить отладку расширения, выполните поиск Mmc.exe в локальной системе и настройте отладчик для использования его в качестве приложения для отладки. В большинстве систем Mmc.exe находится в системном каталоге Windows, например C: \\ WinNT \\ System32. В зависимости от отладчика также может быть необязательно задавать DLL расширения для загрузки отладчиком. Многие отладчики также позволяют подключать отладчик к выполняющемуся процессу MMC. Дополнительные сведения см. в разделе, посвященном пользователю отладчика.

Может быть удобно, чтобы MMC автоматически загружала определенную оснастку. Для этого задайте для аргументов приложения путь и имя файла MSC. Это может быть либо установленный системой MSC-файл, либо созданный вами. Файл MSC можно создать, выполнив следующие действия.

1.  Запустите Mmc.exe.
2.  Загрузите нужную оснастку, выбрав **файл**  -  **Добавить или удалить оснастку...** в меню MMC выберите нужную оснастку.
3.  Сохраните файл MSC, выбрав **файл**  -  **Сохранить как...** в меню MMC.

Если не задать файл автозапуска MSC, необходимо вручную загрузить нужную оснастку при запуске приложения в отладчике.

Когда ведущее приложение запускается в отладчике, отладчик может отобразить предупреждающее сообщение о том, что выполняемое приложение не содержит отладочных символов. Это ожидаемое значение, и его можно спокойно проигнорировать, так как на самом деле выполняется отладка библиотеки DLL, а не ведущего приложения.

В большинстве случаев расширение не будет вызываться до тех пор, пока пользователь не выполнит какое бы то ни было действие, которое вызывает загрузку и инициализацию расширения. Например, при отладке расширения контекстного меню, отображаемого для объектов пользователя, расширение не будет загружаться до тех пор, пока не отобразится контекстное меню для объекта пользователя.

Теперь вы можете задавать точки останова и просматривать выходные данные отладки. Если расширение не будет загружено, установите точку останова в функции [**DllGetClassObject**](/windows/win32/api/combaseapi/nf-combaseapi-dllgetclassobject) расширения. Если **DllGetClassObject** не вызван, возможно, расширение не зарегистрировано должным образом.

После завершения отладки выйдите из консоли MMC, и отладчик должен выгружаться обычным образом.

 

 