---
title: Регистрация статического элемента контекстного меню
description: В этом разделе описывается регистрация элемента статического контекстного меню, отображаемого для Active Directory объектов.
ms.assetid: ed945812-3adb-4058-bdb6-8d9d34468265
ms.tgt_platform: multiple
keywords:
- Регистрация элемента статического контекстного меню в Active Directory
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 89e3ee5336061ca296e2c94f8907ebd385610494
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "105654279"
---
# <a name="registering-a-static-context-menu-item"></a>Регистрация статического элемента контекстного меню

Административные оснастки MMC служб домен Active Directory и оболочка Windows предоставляют механизм для добавления элемента в контекстное меню, отображаемое для объектов в службах домен Active Directory Services. Контекстное меню может вызвать любой файл, который можно запустить с помощью API [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) , такого как URL-адрес приложения или веб-страницы.

## <a name="registering-with-active-directory-domain-services"></a>Регистрация в домен Active Directory Services

Регистрация расширения контекстного меню зависит от одного языкового стандарта. Если расширение контекстного меню применяется ко всем языкам, оно должно быть зарегистрировано в объекте [**дисплайспеЦифиер**](/windows/desktop/ADSchema/c-displayspecifier) класса объекта во всех вложенных компонентах языкового стандарта в контейнере описатели вывода. Если расширение контекстного меню локализовано для определенного языкового стандарта, оно должно быть зарегистрировано в объекте **дисплайспеЦифиер** в этом вложенном элементе locale. Дополнительные сведения о контейнерах и языковых стандартах для описателей вывода см. в разделе [описатели](display-specifiers.md) и [контейнеры дисплайспеЦифиерс](displayspecifiers-container.md).

Существует два атрибута спецификаторов вывода, которые можно зарегистрировать в элементе статического контекстного меню в, [**админконтекстмену**](/windows/desktop/ADSchema/a-admincontextmenu) и [**шеллконтекстмену**](/windows/desktop/ADSchema/a-shellcontextmenu).

Атрибут [**админконтекстмену**](/windows/desktop/ADSchema/a-admincontextmenu) определяет административные контекстные меню, отображаемые в административных оснастках служб домен Active Directory Services. Контекстное меню появляется, когда пользователь отображает контекстное меню для объектов соответствующего класса в одной из оснасток администрирования MMC.

Атрибут [**шеллконтекстмену**](/windows/desktop/ADSchema/a-shellcontextmenu) определяет контекстные меню конечных пользователей, отображаемых в оболочке Windows. Контекстное меню появляется, когда пользователь просматривает контекстное меню для объектов соответствующего класса в проводнике Windows. Начиная с Windows Server 2003, оболочка Windows больше не отображает объекты из домен Active Directory Services.

Все эти атрибуты являются многозначными.

При регистрации статического элемента контекстного меню значения для атрибутов [**админконтекстмену**](/windows/desktop/ADSchema/a-admincontextmenu) и [**шеллконтекстмену**](/windows/desktop/ADSchema/a-shellcontextmenu) должны иметь следующий формат.


```C++
<order number>,<menu text>,<command>
```



&lt;Порядковый номер &gt; — это число без знака, представляющее позицию элемента в контекстном меню. При отображении контекстного меню значения сортируются с помощью сравнения "номер заказа" каждого значения &lt; &gt; . Если несколько значений имеют одинаковый &lt; порядковый номер, то &gt; расширения контекстного меню загружаются в том порядке, в котором они считываются с Active Directory сервера. Если возможно, используйте несуществующий " &lt; номер заказа &gt; ", то есть тот, который не использовался другими значениями в свойстве. Нет предписанной начальной должности, и в &lt; последовательности "номер заказа" могут пропуски &gt; .

&lt;Текст меню &gt; — это строка, отображаемая в контекстном меню. &lt;Текст меню &gt; может содержать один символ «&», который предшествует сочетанию клавиш для пункта меню. Это вызовет подчеркивание предшествующего символа. Например, если " &lt; текст меню &gt; " имеет значение "&файл", то текст меню будет отображаться как "файл", а "f" будет подчеркнут, а "f" будет сочетанием клавиш для элемента меню.

" &lt; Команда &gt; " — это программа или файл, выполняемые оснасткой. Либо должен быть указан полный путь, либо файл должен существовать в переменной среды PATH компьютера. Файл вызывается с помощью функции [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) . " &lt; Команда &gt; " не может содержать дополнительные параметры, например Notepad.exe Myfile.txt. Поскольку используется **ShellExecute** , любой файл или адрес, который можно передать в **ShellExecute** , можно использовать для команды " &lt; Command &gt; ". Например, если " &lt; Command &gt; " содержит "d: \\file.txt", d: \\file.txt будет открыт с приложением, связанным с расширением txt. Аналогично, если " &lt; команда &gt; " содержит " https://www.fabrikam.com ", открывается веб-браузер по умолчанию и отображается указанная страница. Разрешены пути и имена приложений с пробелами. Если " &lt; команда &gt; " является приложением, то путь к выбранному объекту и класс передаются как аргументы командной строки, разделенные пробелом.

В оболочке Windows поддерживаются элементы контекстного меню с множественным выбором. В этом случае &lt; команда &gt; вызывается для каждого выбранного объекта. В оснастке "Администрирование" домен Active Directory Services не поддерживаются статические элементы контекстного меню с множественным выбором.

> [!IMPORTANT]
> Для оболочки Windows данные описателя экрана извлекаются при входе пользователя в систему и кэшируются для сеанса пользователя. Для административных оснасток данные описателя просмотра извлекаются при загрузке оснастки и кэшируются в течение этого процесса. Для оболочки Windows это означает, что изменения описателей экрана вступают в силу после выхода пользователя из системы и обратного входа. Для административных оснасток изменения вступают в силу при перезагрузке оснастки или файла консоли; Это значит, что при запуске нового экземпляра файла консоли или нового экземпляра Mmc.exe и добавлении оснастки извлекаются последние данные описателя вывода.

 

Дополнительные сведения и пример кода см. в разделе [пример кода для установки статического элемента контекстного меню](example-code-for-installing-a-static-context-menu-item.md).

 

 