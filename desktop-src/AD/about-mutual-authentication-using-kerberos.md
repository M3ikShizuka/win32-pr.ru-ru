---
title: О взаимной проверке подлинности с помощью Kerberos
description: При взаимной проверке подлинности клиент и служба перед выполнением функций приложения должны проверять свои идентификаторы друг на друга.
ms.assetid: 5ce923d6-bede-4acb-b297-e93f2f506ea9
ms.tgt_platform: multiple
keywords:
- О взаимной проверке подлинности с помощью Kerberos AD
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9685dad0bd20f233b8dcb0ecf12af338f318646f
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104067279"
---
# <a name="about-mutual-authentication-using-kerberos"></a>О взаимной проверке подлинности с помощью Kerberos

При взаимной проверке подлинности клиент и служба перед выполнением функций приложения должны проверять свои идентификаторы друг на друга. Ни одна из сторон не может выполнять операции с другими, пока не будет проверено удостоверение. то есть служба должна иметь возможность проверить клиент без запроса клиента, и клиент должен иметь возможность проверить службу без запроса к службе.

Значение службы, которая может проверить подлинность клиента, хорошо известно. Например, Файловая служба олицетворяет клиента, чтобы определить, к каким файлам имеет доступ клиент.

Значение клиента, которое может проверить подлинность службы, менее понятно. Проверка подлинности службы позволяет клиенту доверять данным, которые он получает от службы, и обеспечить безопасность при отправке конфиденциальных данных в службу. Способность клиента проверять подлинность службы особенно важна в клиентских и сервисных приложениях, поддерживающих делегирование контекста безопасности клиента; то есть клиент авторизует службу, чтобы она действовала в качестве своего делегата при доступе к дополнительным службам или сетевым ресурсам.

Служба выполняет проверку подлинности клиента следующим образом: клиент устанавливает локальный контекст безопасности, выполняя в ранее установленном контексте, например в сеансе пользователя, выполнившего вход в систему, или явно выполняя учетные данные для базового поставщика безопасности. Служба не может принимать подключения от любого клиента, не прошедшего проверку подлинности.

Механизм Kerberos, с помощью которого клиент проходит проверку подлинности службы, работает следующим образом: при установке службы установщик службы, выполняющий права администратора, регистрирует один или несколько уникальных имен участников-служб для каждого экземпляра службы. Имена регистрируются в контроллере домен Active Directory (DC) для объекта учетной записи пользователя или компьютера, который будет использоваться экземпляром службы для входа в систему. Когда клиент запрашивает соединение со службой, он формирует имя участника-службы для экземпляра службы, используя известные данные или данные, предоставленные пользователем. Затем клиент использует пакет SSPI Negotiate, чтобы предоставить имя участника-службы центр распространения ключей (KDC) для учетной записи домена клиента. KDC ищет в лесу учетную запись пользователя или компьютера, на котором зарегистрировано имя субъекта-службы. Если имя субъекта-службы зарегистрировано более чем в одной учетной записи, проверка подлинности завершается ошибкой. В противном случае KDC шифрует сообщение, используя пароль учетной записи, в которой зарегистрировано имя субъекта-службы. KDC передает это зашифрованное сообщение клиенту, который, в свою очередь, передает его в экземпляр службы. Служба использует пакет SSPI Negotiate для расшифровки сообщения, которое передается обратно клиенту и в KDC клиента. KDC проверяет подлинность службы, если расшифрованное сообщение соответствует его исходному сообщению.

-   Дополнительные сведения о создании и регистрации имен участников-служб см. в разделе. [Имена субъектов-служб](service-principal-names.md)
-   Дополнительные сведения и пример кода, в котором создается имя участника-службы для службы Windows Sockets, которая публикует себя с точкой подключения службы, см. в разделе Создание [имен участников-служб для службы с SCP](composing-the-spns-for-a-service-with-an-scp.md).
-   Дополнительные сведения и пример кода, в котором создается имя субъекта-службы для сервиса RPC, см. в разделе Создание [имен участников](composing-spns-for-an-rpcns-service.md)-служб для службы рпкнс.

 

 




