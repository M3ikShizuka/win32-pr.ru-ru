---
title: Создание раздела каталога приложений
description: Раздел каталога приложений представляется объектом Домаинднс с атрибутом instanceType, равным DS \_ instanceType \_ — \_ NC \_ head в сочетании с DS \_ instanceType \_ NC \_ является \_ записываемым.
ms.assetid: 5e90f316-9d67-484d-98b8-0632dd3c2c43
ms.tgt_platform: multiple
keywords:
- Создание раздела каталога приложений (AD)
- Разделы каталога приложений AD, создание
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c340bac215be62867dcddcda97326c33fc70c458ee242965258cc1ee24cf25f3
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118020543"
---
# <a name="creating-an-application-directory-partition"></a>Создание раздела каталога приложений

Раздел каталога приложений представляется объектом [**домаинднс**](/windows/desktop/ADSchema/c-domaindns) с атрибутом [**instanceType**](/windows/desktop/ADSchema/a-instancetype) , равным **DS \_ instanceType \_ — \_ NC \_ head** в сочетании с **DS \_ instanceType \_ NC \_ является \_ записываемым**. Этот объект **домаинднс** представляет корень раздела каталога приложений (заголовок NC) и имеет имя, аналогичное обычному разделу домена, например "DC = DYNAMICDATA, DC = Fabrikam, DC = com", который соответствует DNS-имени "DynamicData.fabrikam.com". Таким образом, можно создать экземпляр раздела каталога приложений в любом месте, где можно создать экземпляр раздела домена. Отсутствует имя NetBIOS, связанное с разделом каталога приложений.

Можно вкладывать разделы каталога приложений, т. е. раздел каталога приложений может иметь дочерние разделы каталога приложений. Поиск с областью поддерева с корнем в заголовке раздела каталога приложений приведет к созданию ссылок продолжения для разделов каталога дочерних приложений.

реплику раздела каталога приложений можно создать только на контроллере домена, который работает на Windows server 2003 и более поздних версиях и только в то время, когда роль FSMO Domain-Naming удерживается контроллером домена Windows Server 2003 и более поздних версий. в смешанном лесу, в котором одновременно используются контроллеры домена Windows Server 2003 и контроллеры домена нижнего уровня (Windows 2000 или контроллеры домена Windows NT 4,0), попытка создать реплику раздела каталога приложений на контроллере домена нижнего уровня завершится ошибкой.

Раздел каталога приложений также имеет соответствующий объект [**crossRef**](/windows/desktop/ADSchema/c-crossref) в контейнере разделов раздела конфигурации. Перед созданием объекта [**домаинднс**](/windows/desktop/ADSchema/c-domaindns) можно создать предварительно созданный параметр **crossRef** вручную. Предварительно созданный объект **crossRef** должен иметь значения атрибутов, приведенные в следующей таблице, иначе создание секции завершится ошибкой. Если объект **crossRef** не существует, сервер Active Directory создаст его при создании раздела каталога приложений.

| attribute                          | Описание                                                                                                                               |
|------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------|
| [**днсрут**](/windows/desktop/ADSchema/a-dnsroot) | Содержит путь DNS контроллера домена, на котором будет создан раздел каталога приложений.                               |
| [**Активировано**](/windows/desktop/ADSchema/a-enabled) | Содержит **значение false**.                                                                                                                       |
| [**Параметрами**](/windows/desktop/ADSchema/a-ncname)   | Содержит различающееся имя секции. В приведенном выше примере этот атрибут будет содержать "DC = DynamicData, DC = MyDomain, DC = com". |



 

**Чтобы создать новый раздел каталога приложений с первой репликой, выполните следующие действия.**

1.  Выполните привязку к пространству имен для новой секции, указав контроллер домена, на котором будет размещаться раздел каталога приложений в папке ADsPath. Например, чтобы создать секцию с параметром ADsPath "DC = DynamicData, DC = MyDomain, DC = com", значение ADsPath — "LDAP:// <domain controller> /DC = MyDomain, DC = com", где " &lt; контроллер домена &gt; " — это DNS-имя контроллера домена, на котором будет размещена секция.

    Операция привязки должна указывать параметры быстрого и делегирования. Быстрый параметр позволяет выполнить привязку, даже если пространство имен не существует. Параметр делегирования необходим, чтобы разрешить контроллеру домена обращаться к владельцу роли FSMO Domain-Naming, используя те же учетные данные.

    системная версия контроллера домена должна быть операционной системой сервера Windows Server 2003 и более поздними версиями.

2.  Создайте объект [**домаинднс**](/windows/desktop/ADSchema/c-domaindns) с соответствующим именем для секции, например "DC = DynamicData", чтобы представить заголовок контекста именования для новой секции. Объект **домаинднс** должен иметь атрибут [**instanceType**](/windows/desktop/ADSchema/a-instancetype) со значением 5 (**DS \_ instanceType \_ — \_ NC \_ head** \| **DS \_ instanceType \_ NC \_ , \_ доступный для записи**). Атрибут **instanceType** может быть задан только во время создания, так как он является системным атрибутом.

При создании объекта [**домаинднс**](/windows/desktop/ADSchema/c-domaindns) сервер Active Directory выполняет следующие действия:

1.  Выполняет поиск объекта [**crossRef**](/windows/desktop/ADSchema/c-crossref) в контейнере partitions, имеющего значение атрибута [**NCName**](/windows/desktop/ADSchema/a-ncname) , совпадающее с различающимся именем секции, а при обнаружении совпадения изменяет объект **crossRef** для представления раздела каталога приложения. Если соответствующий объект **crossRef** не найден, сервер Active Directory создает новый объект **crossRef** для представления раздела каталога приложений.

    В следующей таблице перечислены важные атрибуты объекта [**crossRef**](/windows/desktop/ADSchema/c-crossref) .

    | attribute                                                              | Описание                                                                                                                                        |
    |------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------|
    | [**Параметрами**](/windows/desktop/ADSchema/a-ncname)                                       | Содержит различающееся имя секции.                                                                                                  |
    | [**днсрут**](/windows/desktop/ADSchema/a-dnsroot)                                     | Содержит DNS-имя секции.                                                                                                            |
    | [**msDS-NC-Replica-Locations**](/windows/desktop/ADSchema/a-msds-nc-replica-locations) | Различающееся имя объекта [**нтдсдса**](/windows/desktop/ADSchema/c-ntdsdsa) контроллера домена для первой реплики добавляется к этому атрибуту. |

    

     

2.  Запустите синхронизацию секции конфигурации и дождитесь завершения. Это позволяет клиентскому приложению изменять параметры конфигурации для вновь созданного раздела каталога приложений, применяя тот же контроллер домена, который используется для создания раздела каталога приложений.
3.  Создайте объект [**домаинднс**](/windows/desktop/ADSchema/c-domaindns) с **\_ INSTANCETYPE DS \_ — \_ \_ head NC** , а **DS \_ INSTANCETYPE \_ NC \_ — это \_** флаги записи, заданные для свойства [**INSTANCETYPE**](/windows/desktop/ADSchema/a-instancetype) . Свойство **instanceType** может также содержать другие, закрытые флаги.
4.  Заполните атрибут [**MS-DS-с-Master-NC**](/windows/desktop/ADSchema/a-msds-hasmasterncs) объекта [**нтдсдса**](/windows/desktop/ADSchema/c-ntdsdsa) для целевого контроллера домена с различающимся именем только что созданного раздела каталога приложений.

При создании раздела каталога приложений или добавлении и полной синхронизации новой реплики раздела каталога приложений Active Directory сервер правильно регистрирует реплику с помощью NetLogon и DNS. Дополнительные сведения и список зарегистрированных записей SRV см. в разделе [Поиск сервера узла раздела каталога приложений](locating-an-application-directory-partition-host-server.md).

Дополнительные сведения о создании раздела каталога приложений см. в разделе [пример кода для создания раздела каталога приложений](example-code-for-creating-an-application-directory-partition.md).

## <a name="locating-the-partitions-container"></a>Поиск контейнера секций

Различающееся имя контейнера секций можно найти одним из двух способов. Первый из них более сложен, но всегда дает точный результат:

1.  Привяжите к RootDSE и получите атрибут **конфигуратионнамингконтекст** .
2.  Используйте атрибут **конфигуратионнамингконтекст** для привязки к контейнеру конфигурации.
3.  Найдите в контейнере конфигурации объект, имеющий тип [**кроссрефконтаинер**](/windows/desktop/ADSchema/c-crossrefcontainer) .
4.  Получите значение атрибута **distinguishedName** объекта [**кроссрефконтаинер**](/windows/desktop/ADSchema/c-crossrefcontainer) . Это будет различающееся имя контейнера секций.

Дополнительные сведения и пример кода, демонстрирующий этот метод для поиска контейнера секций, см. в описании функции **жетпартитионсднсеарч** в [примере кода для поиска контейнера секций](example-code-for-locating-the-partitions-container.md).

Второй метод проще реализовать, но использует контейнер секций с определенным относительном различающимся именем. Сейчас невозможно изменить имя контейнера секций, но если эта возможность будет добавлена в будущем, приведенная ниже процедура не будет работать правильно, если контейнер секций был переименован.

1.  Привяжите к RootDSE и получите атрибут **конфигуратионнамингконтекст** .
2.  Объедините строку "CN = Partitions", за которой следует атрибут **конфигуратионнамингконтекст** , чтобы сформировать различающееся имя контейнера секций. Различающееся имя будет иметь вид "CN = Partitions <configuration DN> ".

Дополнительные сведения и пример кода, демонстрирующий этот метод для поиска контейнера секций, см. в описании функции **жетпартитионсднмануал** в [примере кода для поиска контейнера секций](example-code-for-locating-the-partitions-container.md).

 

 