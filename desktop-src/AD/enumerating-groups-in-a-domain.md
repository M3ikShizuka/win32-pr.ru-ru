---
title: Перечисление групп в домене
description: Группы можно разместить в любом контейнере или подразделении (OU) в домене, а также в корне домена.
ms.assetid: 7f9d3c90-b6f4-4bfa-960f-58f380aa487c
ms.tgt_platform: multiple
keywords:
- Перечисление групп в доменных службах Active Directory
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3586b8c6d261c769cabe56def2aa9396a58fa3a5
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "103789571"
---
# <a name="enumerating-groups-in-a-domain"></a>Перечисление групп в домене

Группы можно разместить в любом контейнере или подразделении (OU) в домене, а также в корне домена. Это означает, что группы могут находиться в нескольких местах иерархии каталогов. Поэтому у вас есть два варианта перечисления групп:

1.  Перечислите группы, непосредственно содержащиеся в контейнере, подразделении или в корне домена.

    Явная привязка к объекту-контейнеру, содержащему группы для перечисления, установите фильтр, содержащий "groups", в качестве класса с помощью свойства [**иадсконтаинер. Filter**](/windows/desktop/api/iads/nn-iads-iadscontainer) и используйте метод [**иадсконтаинер:: Get \_ \_ NewEnum**](/windows/desktop/api/iads/nf-iads-iadscontainer-get__newenum) , чтобы перечислить объекты группы.

    Этот метод перечисляет группы, содержащиеся непосредственно в контейнере или объекте OU. Если контейнер содержит другие контейнеры, которые потенциально могут содержать другие группы, необходимо выполнить привязку к этим контейнерам и рекурсивно перечислить группы в этих контейнерах. Чтобы управлять объектами группы и только для чтения конкретными свойствами, используйте глубокий поиск, описанный в варианте 2.

    Поскольку перечисление Возвращает указатели на COM-объекты ADSI, представляющие каждый объект группы, можно вызвать метод [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) , чтобы получить указатели интерфейса [**iAds**](/windows/desktop/api/iads/nn-iads-iads), [**иадсграуп**](/windows/desktop/api/iads/nn-iads-iadsgroup)и [**иадспропертилист**](/windows/desktop/api/iads/nn-iads-iadspropertylist) для объекта Group. Таким образом, можно получить указатели интерфейса для каждого объекта перечисляемой группы в контейнере, не прибегая к явной привязке к каждому объекту группы. Для выполнения операций со всеми группами непосредственно в контейнере для вызова методов **iAds** или **иадсграуп** перечисление не требует привязки к каждой группе. Чтобы получить определенные свойства из групп, используйте [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) , как описано во втором варианте.

    Исключение в этом случае возникает при попытке перечисления группы, содержащей члены, которые являются wellKnown субъектами безопасности, такими как все пользователи, прошедшие проверку подлинности пользователей, пакетная обработка и т. д. Поскольку невозможно выполнить привязку к этим типам объектов, они не перечисляются при перечислении групп в области WinNT, даже если они могут привязываться, так как определенные методы IADs, такие как Class, ADsPath и Name, возвращают правильные результаты при вызове перечисленных членов.

2.  Выполните глубокий поиск по запросу "objectCategory = Group", чтобы найти все группы в дереве.

    Сначала выполните привязку к объекту контейнера, с которого начинается поиск. Например, чтобы найти все группы в домене, выполните привязку к корню домена. чтобы найти все группы в лесу, выполните привязку к глобальному каталогу и выполните поиск из корня GC.

    Затем используйте [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) для запроса с помощью фильтра поиска, содержащего (objectCategory = Group), и предпочтения поиска **в \_ \_ поддереве области объявлений**.

    > [!Note]  
    > Вы можете выполнить поиск с помощью предпочтения поиска **\_ области объявлений \_ одноуровневой** , чтобы ограничить поиск прямым содержимым объекта контейнера, к которому вы привязаны.

     

    [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) извлекает только значения конкретных свойств из групп. Чтобы получить значения, используйте **IDirectorySearch**. Для управления объектами Group, возвращаемыми из поиска, то есть для использования методов [**iAds**](/windows/desktop/api/iads/nn-iads-iads) или [**иадсграуп**](/windows/desktop/api/iads/nn-iads-iadsgroup) , следует явно привязать к ним. Для этого укажите **distinguishedName** в качестве одного из свойств, возвращаемых при поиске, и используйте возвращенные различающиеся имена для привязки к каждой группе, возвращаемой при поиске.

    Извлекаются только определенные свойства. Невозможно получить все атрибуты без явного указания всех возможных атрибутов класса Group.

 

 