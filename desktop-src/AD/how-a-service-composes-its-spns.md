---
title: Как служба формирует свои имена участников-служб
description: Служба может использовать две функции для составления своих имен субъектов-служб Дсжетспн — универсальная функция для составления имен субъектов-служб, а Дссерверрегистерспн — специализированная функция для составления и регистрации простых имен участников-служб для службы на основе узла.
ms.assetid: 8710409a-67b1-45e5-9cd7-5125443ab921
ms.tgt_platform: multiple
keywords:
- имя субъекта-службы AD, создание службы
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fdd4c0ac9c871c76e9e8771a688d203898674e477426ebd788ee34fe894011a0
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118188648"
---
# <a name="how-a-service-composes-its-spns"></a>Как служба формирует свои имена участников-служб

Служба может использовать две функции для создания своих имен участников-служб: [**дсжетспн**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsgetspna) — это функция общего назначения для составления имен субъектов-служб, а [**дссерверрегистерспн**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsserverregisterspna) — специализированная функция для составления и регистрации простых имен участников-служб для службы на основе узла.

Установщик службы обычно использует функцию [**дсжетспн**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsgetspna) для создания имен участников-служб, которые затем регистрируются в учетной записи входа службы с помощью функции [**дсвритеаккаунтспн**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dswriteaccountspna) . **Дсжетспн** может выполнять следующие функции.

-   Создайте простое имя субъекта-службы с <service class> / <host> форматом "" для службы на основе узла.
-   Создайте сложное имя субъекта-службы, которое включает &lt; компонент "имя службы &gt; ", используемый реплицируемыми службами или &lt; компонент "Port &gt; ", который различает несколько экземпляров службы на одном узле.
-   Создайте отдельное имя субъекта-службы с &lt; &gt; компонентом "узел", установленным в значение по умолчанию — либо название указанного узла, либо имя локального компьютера.
-   Создайте массив имен участников-служб для нескольких экземпляров службы, которые будут выполняться на нескольких узлах в пределах леса. В каждом имени субъекта-службы указывается имя узла для экземпляра службы.
-   Создайте массив имен участников-служб для нескольких экземпляров службы, которые будут выполняться на одном узле. В каждом имени субъекта-службы указывается имя узла и номер порта для экземпляра службы.

Массив имен, возвращаемых функцией [**дсжетспн**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsgetspna) , должен быть освобожден путем вызова функции [**дсфриспнаррай**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsfreespnarraya) .

Имейте в виду, что функции [**дсжетспн**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsgetspna), [**дсвритеаккаунтспн**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dswriteaccountspna)и [**дссерверрегистерспн**](/windows/desktop/api/Ntdsapi/nf-ntdsapi-dsserverregisterspna) не проверяют уникальность имен участников-служб. Так как взаимная проверка подлинности завершается неудачей, если клиент предоставляет имя SPN, которое не является уникальным, проверьте уникальность перед регистрацией имени участника-службы **Для этого выполните поиск атрибутов глобального** каталога (GC), соответствующих имени субъекта-службы. Дополнительные сведения о поиске в GC см. [в разделе Поиск в глобальном каталоге](searching-global-catalog-contents.md).

 

 




