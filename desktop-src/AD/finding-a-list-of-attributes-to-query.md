---
title: Поиск списка атрибутов для запроса
description: При поиске объектов определенного класса сравнения в фильтре поиска должны указывать атрибуты, которые фактически существуют в объектах этого класса.
ms.assetid: 19d52933-e4b0-414f-9785-871e624da07b
ms.tgt_platform: multiple
keywords:
- Поиск списка атрибутов для запроса AD
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5e0edfee59c42a8cf07be05ab31e58c0298f7285c8a02de659257e3b3cd14bfc
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118189194"
---
# <a name="finding-a-list-of-attributes-to-query"></a>Поиск списка атрибутов для запроса

При поиске объектов определенного класса сравнения в фильтре поиска должны указывать атрибуты, которые фактически существуют в объектах этого класса. Чтобы получить атрибуты списка для объекта определенного класса, выполните привязку к этому классу в абстрактной схеме и извлеките свойства [**иадскласс. мандаторипропертиес**](/windows/desktop/ADSI/iadsclass-property-methods) и **иадскласс. OptionalProperties** . Дополнительные сведения см. [в разделе чтение абстрактной схемы](reading-the-abstract-schema.md).

Кроме того, все объекты наследуются от самого верхнего абстрактного класса. Таким образом, любой атрибут **Top** может существовать, хотя он не может быть задан для любого объекта.

При поиске в глобальном каталоге убедитесь, что в глобальном каталоге указаны атрибуты. Атрибуты, включенные в глобальный каталог, имеют для **исмемберофпартиалаттрибутесет** в своих объектах **attributeSchema** значение **true** . Имейте в виду, что эти данные недоступны в абстрактной схеме. Прочтите его из объекта **attributeSchema** в контейнере схемы.

В глобальном каталоге атрибут ссылки назад можно запросить только в том случае, если выполняются оба следующих условия: во-первых, атрибут помечен для включения в глобальный каталог. Во-вторых, соответствующая прямая ссылка также помечена для включения в глобальный каталог. Это относится к фильтрам запросов, а также к результатам запросов. Дополнительные сведения см. в разделе [связанные атрибуты](linked-attributes.md).

Кроме того, создаются некоторые атрибуты, в основном основанные на пользовательском объекте. Фильтры запросов не могут содержать сконструированные атрибуты. Сконструированные атрибуты не могут вычисляться в фильтрах запросов; Однако они могут возвращаться в результатах запроса. Это относится ко всем контекстам именования и глобальному каталогу. Создаваемые атрибуты имеют **рекламу \_ системфлаг \_ attr \_ \_** (0x00000004) в свойстве **systemFlags** в своих объектах **attributeSchema** .

> [!Note]  
> Дополнительные сведения о предопределенных классах и атрибутах, входящих в систему, см. в разделе [Справочник по службам домен Active Directory](active-directory-domain-services-reference.md). На этих страницах перечислены обязательные и необязательные атрибуты каждого класса объектов. Для атрибутов эталонная страница указывает, является ли атрибут индексированным, сконструированным, связанным или в глобальном каталоге.

 

 

 