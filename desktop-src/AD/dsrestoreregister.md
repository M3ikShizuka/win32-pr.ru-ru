---
title: Функция Дсресторерегистер (Нтдсбкли. h)
description: Регистрирует операцию восстановления.
ms.assetid: 83a56985-89be-4a95-9a8d-7c6f78d61c9a
ms.tgt_platform: multiple
keywords:
- Active Directory функции Дсресторерегистер
topic_type:
- apiref
api_name:
- DsRestoreRegister
- DsRestoreRegisterA
- DsRestoreRegisterW
api_location:
- Ntdsbcli.dll
api_type:
- DllExport
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: f3e878a5d2b9567ae7a483344a2240d3480620ea00706db1ed0c834fd2c5553a
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118962463"
---
# <a name="dsrestoreregister-function"></a>Функция Дсресторерегистер

\[Эта функция доступна для использования в операционных системах, указанных в разделе требования. В последующих версиях он может быть изменен или недоступен. начиная с Windows Vista используйте вместо этого [служба теневого копирования томов (VSS)](../vss/volume-shadow-copy-service-overview.md) .\]

Функция **дсресторерегистер** регистрирует операцию восстановления. Эта функция блокирует все последующие операции восстановления и предотвращает запуск целевого объекта восстановления до тех пор, пока не будет вызвана функция [**дсресторерегистеркомплете**](dsrestoreregistercomplete.md) .

## <a name="syntax"></a>Синтаксис


```C++
HRESULT DsRestoreRegister(
  _In_ HBC        hbc,
  _In_ LPCTSTR    szCheckPointFilePath,
  _In_ LPCTSTR    szLogPath,
  _In_ EDB_RSTMAP rgrstmap[],
  _In_ LONG       crstmap,
  _In_ LPCTSTR    szBackupLogPath,
  _In_ ULONG      genLow,
  _In_ ULONG      genHigh
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*ХБК* \[ окне\]
</dt> <dd>

Содержит описатель контекста восстановления, полученный с помощью функции [**дсресторепрепаре**](dsrestoreprepare.md) .

</dd> <dt>

*сзчеккпоинтфилепас* \[ окне\]
</dt> <dd>

Указатель на строку, завершающуюся нулем, которая содержит путь к файлу контрольных точек. Этот путь предоставляется функцией [**дсресторежетдатабаселокатионс**](dsrestoregetdatabaselocations.md) и имеет значение **БФТ** в **БФТ \_ Checkpoint \_ dir**. Обычно это то же самое, что и путь к системной базе данных. Этот путь необходим для правильной функции Backup Restore. Этот параметр не может иметь **значение NULL**. Передача **значения NULL** в этом параметре приведет к ошибке в процессе восстановления.

</dd> <dt>

*сзлогпас* \[ окне\]
</dt> <dd>

Указатель на строку, завершающуюся нулем, которая содержит путь, по которому будут восстановлены файлы журнала. Этот путь предоставляется функцией [**дсресторежетдатабаселокатионс**](dsrestoregetdatabaselocations.md) и имеет значение **БФТ** в **БФТ \_ log \_ dir**. Если путь указывает на пустой каталог, в нем создаются новые файлы журнала. Этот параметр не может иметь **значение NULL**.

</dd> <dt>

*ргрстмап* \[ окне\]
</dt> <dd>

Массив структур [**EDB \_ рстмап**](edb-rstmap.md) , который содержит старый и новый пути для каждой базы данных. Для каждой базы данных существует одна структура. Для каталога существует структура системной базы данных и другая структура для базы данных каталога. Порядок элементов в массиве не имеет значения. Параметр *крстмап* содержит количество элементов в массиве.

</dd> <dt>

*крстмап* \[ окне\]
</dt> <dd>

Содержит количество элементов в массиве *ргрстмап* .

</dd> <dt>

*сзбаккуплогпас* \[ окне\]
</dt> <dd>

Указатель на строку, завершающуюся нулем, которая содержит путь, по которому в данный момент хранятся резервные копии файлов журналов. Этот параметр не может иметь **значение NULL**.

</dd> <dt>

*женлов* \[ окне\]
</dt> <dd>

Содержит минимальный номер журнала для восстановления в этом сеансе восстановления. Это шестнадцатеричное число в диапазоне от 0x00000 до 0xFFFFF.

</dd> <dt>

*женхигх* \[ окне\]
</dt> <dd>

Содержит максимальный номер журнала для восстановления в этом сеансе восстановления. Это шестнадцатеричное число в диапазоне от 0x00000 до 0xFFFFF.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Возвращает **значение \_ ОК** , если функция выполнена успешно, или код ошибки Win32 или RPC в противном случае. В следующем списке перечислены возможные коды ошибок.

<dl> <dt>

**Ошибка \_ отказа в доступе \_**
</dt> <dd>

Вызывающий объект не имеет необходимых прав доступа для вызова этой функции. Функцию [**дссетаусидентити**](dssetauthidentity.md) можно использовать для задания учетных данных, используемых для функций резервного копирования и восстановления.

</dd> <dt>

**Ошибка \_ недопустимого \_ параметра**
</dt> <dd>

Один или несколько параметров недопустимы.

</dd> <dt>

**хрмиссинжекспиритокен**
</dt> <dd>

Недопустимый токен срока действия, переданный в [**дсресторепрепаре**](dsrestoreprepare.md) . Это значение определено в Нтдсбмсг. h.

</dd> </dl>

## <a name="requirements"></a>Requirements (Требования)



| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows Vista<br/>                                                                |
| Минимальная версия сервера<br/> | Windows Server 2008<br/>                                                          |
| Заголовок<br/>                   | <dl> <dt>Нтдсбкли. h</dt> </dl>   |
| Библиотека<br/>                  | <dl> <dt>Нтдсбкли. lib</dt> </dl> |
| DLL<br/>                      | <dl> <dt>Ntdsbcli.dll</dt> </dl> |
| Имя в кодировке Юникод и ANSI<br/>   | **Дсресторерегистерв** (Юникод) и **дсресторерегистера** (ANSI)<br/>           |



## <a name="see-also"></a>См. также

<dl> <dt>

[**дсресторерегистеркомплете**](dsrestoreregistercomplete.md)
</dt> <dt>

[**дсресторепрепаре**](dsrestoreprepare.md)
</dt> <dt>

[**дсресторежетдатабаселокатионс**](dsrestoregetdatabaselocations.md)
</dt> <dt>

[**дсресторинд**](dsrestoreend.md)
</dt> <dt>

[**\_РСТМАП EDB**](edb-rstmap.md)
</dt> <dt>

[Восстановление Active Directory](restoring-an-active-directory-server.md)
</dt> <dt>

[Функции резервного копирования каталога](directory-backup-functions.md)
</dt> </dl>

 

