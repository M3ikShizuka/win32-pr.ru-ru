---
title: Административные обработчики уведомлений
description: Оснастка MMC "пользователи и компьютеры Microsoft Active Directory" предоставляет механизм, позволяющий компонентам получать уведомления, когда пользователь удаляет, переименовывает, перемещает или изменяет свойства объекта с помощью оснастки.
ms.assetid: 49dbb995-c760-4fac-a72f-d5d94afb63c7
ms.tgt_platform: multiple
keywords:
- Административные обработчики уведомлений Active Directory
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 08d89627cdb15cc7ea15f4b56e3a6ec90eafbe6a
ms.sourcegitcommit: 61a4c522182aa1cacbf5669683d9570a3bf043b2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/26/2021
ms.locfileid: "122879890"
---
# <a name="administrative-notification-handlers"></a>Административные обработчики уведомлений

Оснастка MMC "пользователи и компьютеры Microsoft Active Directory" предоставляет механизм, позволяющий компонентам получать уведомления, когда пользователь удаляет, переименовывает, перемещает или изменяет свойства объекта с помощью оснастки. Компонент, получающий уведомления, называется "обработчиком уведомлений".

Это полезно, когда несколько объектов связаны друг с другом и должны существовать в одном контейнере. При перемещении одного из связанных объектов в обработчик уведомлений передается уведомление, а обработчик уведомлений может переместить другие связанные объекты в ту же папку.

При выполнении одной из операций и установке одного или нескольких обработчиков уведомления оснастка "пользователи и компьютеры" отобразит диалоговое окно подтверждения, в котором перечислены обработчики уведомлений и флажки для каждого обработчика. Если установлен флажок для обработчика, будет уведомлен обработчик. Если флажок не установлен, обработчик не получает уведомления.

## <a name="implementing-a-notification-handler"></a>Реализация обработчика уведомлений

Обработчик уведомлений — это COM-объект, реализованный как внутрипроцессный сервер. Обработчик уведомлений должен реализовывать интерфейс [**идсадминнотифихандлер**](/windows/desktop/api/DSAdmin/nn-dsadmin-idsadminnotifyhandler) .

При возникновении события, которое вызовет уведомление, оснастка "пользователи и компьютеры" перечисляет зарегистрированные обработчики уведомлений и создает каждый из них с помощью идентификатора CLSID для обработчика. После того как обработчик создан, оснастка вызывает метод [**идсадминнотифихандлер:: Initialize**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-initialize) . Метод **Initialize** предоставляет оснастку события, которые должен получить обработчик.

Если событием является сообщение, которое должно быть отправлено обработчику уведомлений, то оснастка вызывает метод [**идсадминнотифихандлер:: Begin**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-begin) . Метод **Begin** предоставляет обработчик с событием, данные о объекте, на котором происходит событие, и, в зависимости от события, данные о том, что будет преобразовано в объект. Метод **Begin** также предоставляет оснастку с текстом, который должен отображаться для обработчика в диалоговом окне подтверждения.

Когда вызывается метод [**Begin**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-begin) для каждого обработчика, оснастка отображает диалоговое окно подтверждения. Появится диалоговое окно подтверждения, предлагающее пользователю выбрать обработчики, которые будут принимать уведомление. Если пользователь нажмет кнопку **без** отправки в диалоговом окне подтверждения, никакие обработчики не будут уведомлены. Если пользователь нажмет кнопку **"Да** ", все обработчики, выбранные в диалоговом окне подтверждения, получат уведомление. Оснастка отправляет уведомление обработчику, вызывая метод [**идсадминнотифихандлер:: notify**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-notify) .

После уведомления всех обработчиков оснастка вызывает метод [**идсадминнотифихандлер:: end**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-end) . Метод **End** вызывается всегда, даже если метод [**Notify**](/windows/desktop/api/DSAdmin/nf-dsadmin-idsadminnotifyhandler-notify) не вызывается.

## <a name="registering-a-notification-handler-in-the-windows-registry"></a>регистрация обработчика уведомлений в реестре Windows

как и все серверы COM, обработчик уведомлений должен быть зарегистрирован в реестре Windows. Обработчик регистрируется в следующем разделе:


```C++
HKEY_CLASSES_ROOT - CLSID - <CLSID>
```



**&lt; CLSID &gt;** — это строковое представление идентификатора CLSID, созданное функцией [**стрингфромклсид**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) . В ключе **&lt; &gt; CLSID** имеется ключ **InprocServer32** , который идентифицирует объект как 32-разрядный сервер in-proc. В ключе **InprocServer32** расположение библиотеки DLL указывается в значении по умолчанию, а модель потоков указывается в значении **ThreadingModel** . Все обработчики уведомлений должны использовать модель потоков **подразделений** .

## <a name="registering-a-notification-handler-with-an-active-directory-server"></a>Регистрация обработчика уведомлений с сервером Active Directory

В домен Active Directory Services регистрация обработчика уведомлений относится только к одному языку. Если обработчик уведомлений применяется ко всем языкам, он должен быть зарегистрирован в объекте **дисплайспеЦифиер** во всех подконтейнерах языкового стандарта контейнера дисплайспеЦифиерс. Если обработчик уведомлений локализован для определенного языкового стандарта, он регистрируется в объекте **дисплайспеЦифиер** в подконтейнере этого языкового стандарта. Дополнительные сведения о контейнере ДисплайспеЦифиерс и языковых стандартах см. в разделе [описатели экрана](display-specifiers.md) и [контейнеры дисплайспеЦифиерс](displayspecifiers-container.md).

обработчики уведомлений регистрируются в атрибуте **дсуиадминнотификатион** контейнера **DS-UI-Default-Параметры** . Это многозначное строковое значение Юникода, в котором каждому значению требуется следующий формат:


```C++
<order number>,<CLSID>
```



&lt;Порядковый номер &gt; — это число без знака, представляющее расположение обработчика в диалоговом окне подтверждения. При отображении диалогового окна подтверждения значения сортируются с помощью сравнения "номер заказа" каждого значения &lt; &gt; . Если несколько значений имеют одинаковый &lt; порядковый номер &gt; , эти обработчики отображаются в том порядке, в котором они считываются с Active Directory сервера. Несуществующий, то есть, не используется другими значениями в свойстве, по &lt; возможности следует использовать "номер заказа &gt; ". Нет предписанной начальной должности, и пропуски могут отображаться в последовательности " &lt; номер заказа &gt; ".

" &lt; CLSID &gt; " — это строковое представление идентификатора CLSID, созданное функцией [**стрингфромклсид**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromclsid) .

 

 
