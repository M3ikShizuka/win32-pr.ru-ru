---
title: Перечисление пользователей
description: В отличие от доменов Windows NT 4,0, пользователи Windows 2000 могут размещаться в любом контейнере или подразделении (OU) в домене, а также в корне домена.
ms.assetid: 4a35af7a-f43b-4cf9-a030-77f6c2518ae7
ms.tgt_platform: multiple
keywords:
- Перечисление пользователей AD
- Пользователи AD, перечисление пользователей
- Active Directory, использование, пользователи, перечисление пользователя
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e922d92f4313ed0238ff068f7ae1c0fbf693d497
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "105654303"
---
# <a name="enumerating-users"></a>Перечисление пользователей

В отличие от доменов Windows NT 4,0, пользователи Windows 2000 могут размещаться в любом контейнере или подразделении (OU) в домене, а также в корне домена. Это означает, что пользователи могут находиться в нескольких местах иерархии каталогов. Таким образом, у вас есть два варианта перечисления пользователей:

-   Перечисление пользователей, непосредственно содержащихся в контейнере, подразделении или в корне домена:

    Явно привяжите к объекту-контейнеру, содержащему пользователей, которых нужно перечислить, задайте фильтр, содержащий "User", в качестве класса с помощью свойства [**иадсконтаинер. Filter**](/windows/desktop/ADSI/iadscontainer-property-methods) и используйте метод [**иадсконтаинер:: Get \_ \_ NewEnum**](/windows/desktop/api/iads/nf-iads-iadscontainer-get__newenum) , чтобы перечислить объекты пользователя.

    Этот метод можно использовать для перечисления пользователей, которые непосредственно содержатся в контейнере или объекте OU. Если контейнер содержит другие контейнеры, которые потенциально могут содержать других пользователей, необходимо выполнить привязку к этим контейнерам и рекурсивно перечислить пользователей в этих контейнерах. Если не требуется манипулировать объектами пользователя и требуется только чтение конкретных свойств, используйте детальный поиск, описанный в варианте 2.

    Поскольку перечисление Возвращает указатели на COM-объекты ADSI, представляющие каждый объект пользователя, можно вызвать [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) , чтобы получить указатели интерфейса [**iAds**](/windows/desktop/api/iads/nn-iads-iads), [**IADsUser**](/windows/desktop/api/iads/nn-iads-iadsuser)и [**иадспропертилист**](/windows/desktop/api/iads/nn-iads-iadspropertylist) для объекта пользователя. Это означает, что вы можете получить указатели интерфейса для каждого перечислимого объекта-пользователя в контейнере, не прибегая к явной привязке к каждому объекту пользователя. Для выполнения операций со всеми пользователями непосредственно в контейнере перечисление позволяет избежать привязки к каждому пользователю для вызова методов **iAds** или **IADsUser** . Чтобы получить определенные свойства от пользователей, используйте [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) , как описано в варианте 2.

-   Выполните глубокий поиск (& (objectClass = User) (objectCategory = Person)), чтобы найти всех пользователей в дереве.

    Сначала выполните привязку к объекту контейнера, с которого начинается поиск. Например, чтобы найти всех пользователей в домене, выполните привязку к корню домена. чтобы найти всех пользователей в лесу, выполните привязку к глобальному каталогу и выполните поиск из корня GC.

    Затем используйте [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) для запроса с помощью фильтра поиска, содержащего (& (objectClass = пользователь) (objectCategory = Person)), и предпочтения поиска \_ в \_ поддереве области объявлений.

    Вы можете выполнить поиск с помощью предпочтения поиска \_ области объявлений \_ одноуровневой, чтобы ограничить поиск прямым содержимым объекта контейнера, к которому вы привязаны.

    [**IDirectorySearch**](/windows/desktop/api/iads/nn-iads-idirectorysearch) извлекает из пользователей только значения конкретных свойств. Чтобы получить значения, используйте **IDirectorySearch**. Для управления объектами пользователя, возвращаемыми из поиска, то есть необходимо использовать методы [**iAds**](/windows/desktop/api/iads/nn-iads-iads) или [**IADsUser**](/windows/desktop/api/iads/nn-iads-iadsuser) , необходимо явно выполнить привязку к ним. Для этого укажите **distinguishedName** в качестве одного из свойств, возвращаемых при поиске, и используйте возвращенные различающиеся имена для привязки к каждому пользователю, возвращенному при поиске.

    Извлекаются только определенные свойства. Невозможно получить все атрибуты без явного указания всех возможных атрибутов класса User.

 

 