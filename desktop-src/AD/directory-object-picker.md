---
title: Средство выбора объектов каталога
description: Диалоговое окно Выбор объектов каталога позволяет пользователю выбрать один или несколько объектов из глобального каталога, домена, компьютера или рабочей группы.
ms.assetid: 5b3e5d71-afd2-49db-b3a2-f9a49f0b2b3a
ms.tgt_platform: multiple
keywords:
- Средство выбора объектов каталога Active Directory
- средство выбора объектов Active Directory
- объекты Active Directory, средство выбора объектов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 24f6ba7fd053aa8ab3245bf72c693f0a887aa983
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "104069781"
---
# <a name="directory-object-picker"></a>Средство выбора объектов каталога

Диалоговое окно Выбор объектов каталога позволяет пользователю выбрать один или несколько объектов из глобального каталога, домена, компьютера или рабочей группы. Типы объектов, из которых пользователь может выбрать, включают объекты пользователя, контакта, группы и компьютера. Дополнительные сведения о службах домен Active Directory см. в разделе [домен Active Directory Services](active-directory-domain-services.md).

Для вывода диалогового окна Выбор объектов:

1.  Вызовите функцию [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) или [**кокреатеинстанцеекс**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstanceex) , чтобы создать экземпляр интерфейса [**идсобжектпиккер**](/windows/desktop/api/Objsel/nn-objsel-idsobjectpicker) .
2.  Вызовите метод [**идсобжектпиккер:: Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) , чтобы инициализировать диалоговое окно.
3.  Вызовите метод [**идсобжектпиккер:: инвокедиалог**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-invokedialog) , чтобы отобразить диалоговое окно.
4.  Вызовите метод [**IDataObject:: GetData**](/windows/win32/api/objidl/nf-objidl-idataobject-getdata) экземпляра [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject) , возвращенного диалоговым окном Выбор объектов, для получения [**данных \_ \_ \_ \_ списка выбора кфстр ДСОП DS**](cfstr-dsop-ds-selection-list.md) . Формат буфера обмена **\_ \_ \_ \_ списка выбора кфстр ДСОП DS** предоставляет **Хглобал** , который содержит структуру [**\_ \_ списка выбора DS**](/windows/desktop/api/Objsel/ns-objsel-ds_selection_list) . Структура **\_ \_ списка выбора DS** содержит данные об элементах, выбранных в диалоговом окне Выбор объектов.

Если для объекта требуется идентификатор безопасности (SID), он должен быть запрошен непосредственно из средства выбора объектов путем добавления атрибута **objectSid** в список извлекаемых атрибутов для выбранного объекта. Не рекомендуется передавать возвращенное имя объекта в функцию [**лсалукупнамес**](/windows/desktop/api/ntsecapi/nf-ntsecapi-lsalookupnames) или [**LookupAccountName**](/windows/desktop/api/winbase/nf-winbase-lookupaccountnamea) , так как поиск в имени будет избыточным и может завершиться ошибкой в некоторых случаях.

Если будет сохранена ссылка на какие-либо выбранные объекты, то различающееся имя не должно сохраняться, так как объект может перемещаться, переименовано или может изменяться из-за различий в языковых стандартах. Для субъектов безопасности **objectSid** должен быть запрошен для объекта и безопасно сохранен. Если имя субъекта безопасности потребуется позже, его можно получить с помощью функции [**LookupAccountSid**](/windows/desktop/api/winbase/nf-winbase-lookupaccountsida) . Для всех остальных объектов необходимо запросить и сохранить **objectGUID** .

## <a name="initialization"></a>Инициализация

При инициализации диалогового окна «Выбор объектов» задается набор типов и фильтров области. Указанные типы областей определяют расположения, домены или компьютеры, например, из которых пользователь может выбирать объекты. Фильтры определяют типы объектов, которые пользователь может выбрать из определенного типа области. Дополнительные сведения см. в разделе области и фильтры ниже.

По умолчанию пользователь может выбрать один объект в диалоговом окне Выбор объектов каталога. Чтобы включить несколько вариантов выбора, установите флаг **ДСОП \_ флага множественного \_ выбора** в элементе **флоптионс** структуры [**ДСОП \_ \_ info**](/windows/desktop/api/Objsel/ns-objsel-dsop_init_info) при инициализации этого диалогового окна.

## <a name="scopes-and-filters"></a>Области и фильтры

В раскрывающемся списке **Искать в** содержатся области, из которых пользователь может выбирать объекты. Областью действия является домен, компьютер, Рабочая группа или глобальный каталог, в котором хранятся данные и предоставляется доступ к набору доступных объектов. Записи в списке область зависят от типов области и целевого компьютера, указанного при последнем вызове метода [**идсобжектпиккер:: Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) для инициализации диалогового окна Выбор объектов.

Тип области — это универсальная Категория областей, например все домены в Организации, к которым принадлежит целевой компьютер, или глобальный каталог для предприятия целевого компьютера или сам конечный компьютер. Для каждого указанного типа области в диалоговом окне используется контекст целевого компьютера для определения записей списка областей.

Метод [**идсобжектпиккер:: Initialize**](/windows/desktop/api/Objsel/nf-objsel-idsobjectpicker-initialize) принимает указатель на структуру [**ДСОП \_ init \_ info**](/windows/desktop/api/Objsel/ns-objsel-dsop_init_info) , содержащую массив структур [**\_ \_ \_ сведений о области ДСОП**](/windows/desktop/api/Objsel/ns-objsel-dsop_scope_init_info) . Каждая запись в массиве **\_ \_ \_ сведений ДСОП Scope init** указывает один или несколько типов областей, а также применимые фильтры и другие атрибуты. Фильтры определяют типы объектов, таких как пользователи, группы, контакты и компьютеры, которые пользователь может выбрать из определенного типа области. Когда пользователь выбирает область из списка, диалоговое окно применяет фильтры для этого типа области для вывода списка объектов, из которых пользователь может выбрать.

Каждая [**Структура \_ \_ \_ сведений ДСОП Scope init**](/windows/desktop/api/Objsel/ns-objsel-dsop_scope_init_info) содержит структуру [**\_ \_ флагов фильтра ДСОП**](/windows/desktop/api/Objsel/ns-objsel-dsop_filter_flags) , которая задает фильтры для этого типа области. Структура **\_ \_ флагов фильтра ДСОП** различает области действия верхнего и нижнего уровней:

-   Область верхнего уровня — это глобальный каталог или домен, поддерживающий [поставщик LDAP](/windows/desktop/ADSI/adsi-ldap-provider)ADSI.
-   Область нижнего уровня включает рабочие группы и все индивидуальные компьютеры. В диалоговом окне для доступа к области нижнего уровня используется поставщик ADSI WinNT.

Существует два набора флагов фильтров, определенных для использования в структуре [**\_ \_ флагов фильтра ДСОП**](/windows/desktop/api/Objsel/ns-objsel-dsop_filter_flags) : один для областей верхнего уровня и один для областей нижнего уровня. Элемент **верхнего уровня** структуры **\_ \_ флагов фильтра ДСОП** является структурой [**\_ \_ \_ флагов фильтрации верхнего уровня ДСОП**](/windows/desktop/api/Objsel/ns-objsel-dsop_uplevel_filter_flags) , которая задает фильтры для областей верхнего уровня. Элемент **флдовнлевел** структуры **\_ \_ флагов фильтра ДСОП** представляет собой набор флагов, задающих фильтры для областей нижнего уровня.

 

 