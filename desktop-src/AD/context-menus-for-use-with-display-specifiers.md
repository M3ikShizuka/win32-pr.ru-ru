---
title: Контекстные меню для использования с описателем экрана
description: Оснастки администрирования MMC Active Directory и оболочка Windows 2000 предоставляют механизм для добавления элемента в контекстное меню, отображаемое для объектов в службах домен Active Directory Services.
ms.assetid: 0b0691f5-321d-4f22-b39c-bc528db9e707
ms.tgt_platform: multiple
keywords:
- Описатели экрана AD, контекстные меню для
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f28fbf703f17ea5c0fa7938365d485998be77e8d
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "103987349"
---
# <a name="context-menus-for-use-with-display-specifiers"></a>Контекстные меню для использования с описателем экрана

Оснастки администрирования MMC Active Directory и оболочка Windows 2000 предоставляют механизм для добавления элемента в контекстное меню, отображаемое для объектов в службах домен Active Directory Services. Элемент контекстного меню можно добавить, реализовав сервер COM in-proc, известный как *Расширение контекстного меню*. Также можно добавить элемент контекстного меню, который вызывает любой файл, запущенный с помощью API [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) , например, URL-адрес приложения или веб-страницы. Это называется *статическим пунктом контекстного меню*.

## <a name="developer-audience"></a>Аудитория разработчиков

В этой документации предполагается, что читатель знаком с разработкой COM-операций и компонентов с помощью C++. В настоящее время невозможно создать расширение контекстного меню служб домен Active Directory с помощью Visual Basic Майкрософт.

## <a name="extending-the-context-menu-with-a-context-menu-extension"></a>Расширение контекстного меню с помощью расширения контекстного меню

Расширение контекстного меню — это внутрипроцессный сервер COM, который реализует определенные интерфейсы и регистрируется в службах домен Active Directory.

**Создание и установка расширения контекстного меню**

1.  Создайте библиотеку DLL расширения контекстного меню. Расширение контекстного меню — это внутрипроцессный сервер COM, который, как минимум, реализует интерфейсы [**ишеллекстинит**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit) и [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu) . Дополнительные сведения см. [в разделе реализация COM-объекта контекстного меню](implementing-the-context-menu-com-object.md).
2.  Установите расширение таблицы контекстного меню на компьютерах, где используется расширение контекстного меню. Это достигается путем создания пакета Microsoft установщик Windows для библиотеки DLL расширения контекстного меню и надлежащего развертывания пакета с помощью групповой политики. Дополнительные сведения см. в разделе [распространение компонентов пользовательского интерфейса](distributing-user-interface-components.md).
3.  Зарегистрируйте расширение контекстного меню в реестре Windows и с домен Active Directory Services. Дополнительные сведения см. [в разделе Регистрация COM-объекта контекстного меню в описателе экрана](registering-the-context-menu-com-object-in-a-display-specifier.md).

## <a name="extending-the-context-menu-with-a-static-context-menu-item"></a>Расширение контекстного меню с помощью статического пункта контекстного меню

Статический элемент контекстного меню можно использовать для вызова любого файла, запущенного с помощью API [**ShellExecute**](/windows/win32/api/shellapi/nf-shellapi-shellexecutea) , например для приложения или URL-адреса веб-страницы. Для этого необходимо зарегистрировать статический элемент контекстного меню для конкретного класса объектов таким образом, чтобы в контекстное меню объектов этого класса добавлялся элемент статического контекстного меню. Дополнительные сведения см. [в разделе Регистрация статического элемента контекстного меню](registering-a-static-context-menu-item.md).

 

 