---
title: Создание права доступа к элементу управления
description: Чтобы добавить право управления доступом на сервер Active Directory, создайте объект Контролакцессригхт в контейнере Extended-Rights раздела конфигурации.
ms.assetid: dacd42c6-17d9-4dfe-8f51-e4a470766494
ms.tgt_platform: multiple
keywords:
- Создание элемента управления право доступа AD
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 11bdc764b09f0fe5bd165e87e23a89db7d368bfe
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "103789595"
---
# <a name="creating-a-control-access-right"></a>Создание права доступа к элементу управления

Чтобы добавить право управления доступом на сервер Active Directory, создайте объект [**контролакцессригхт**](/windows/desktop/ADSchema/c-controlaccessright) в контейнере Extended-Rights раздела конфигурации. Дополнительные сведения и пример кода см. в разделе [пример кода для создания права доступа к управлению](example-code-for-creating-a-control-access-right.md). Чтобы использовать право доступа Control, необходимо выполнить еще несколько действий в зависимости от того, является ли право доступа к элементу управления специальной операцией или набором свойств.

Если вы определяете право доступа к элементу управления для набора свойств, используйте **ригхтсгуид** объекта [**контролакцессригхт**](/windows/desktop/ADSchema/c-controlaccessright) для определения свойств в наборе. Каждое свойство определяется объектом [**attributeSchema**](/windows/desktop/ADSchema/c-attributeschema) в схеме Active Directory. Свойство [**аттрибутесекуритигуид**](/windows/desktop/ADSchema/a-attributesecurityguid) объекта **attributeSchema** идентифицирует набор свойств (если таковое имеется), которому принадлежит свойство. Имейте в виду, что свойство **аттрибутесекуритигуид** является однозначным и сохраняет GUID в двоичном формате (синтаксис строки октета).

Если вы определяете право доступа к элементу управления, чтобы ограничить доступ к определенной операции, приложение должно выполнить проверку доступа, когда пользователь попытается провести операцию.

**Настройка проверки доступа**

1.  Создайте право доступа к управлению, определяющее тип доступа к приложению или службе. Дополнительные сведения см. в следующем примере кода.
2.  Создайте объект домен Active Directory Services, представляющий приложение, службу или защищаемый ресурс.
3.  Добавьте ACE объекта в список DACL в дескрипторе безопасности объекта, чтобы предоставить или запретить пользователям или группам право доступа к этому объекту. Дополнительные сведения см. [в разделе Установка элемента управления право доступа ACE в ACL объекта](setting-a-control-access-right-ace-in-an-objectampaposs-acl.md).
4.  Когда пользователь пытается выполнить операцию, проверьте права пользователя, передав дескриптор безопасности объекта и маркер доступа пользователя в функцию [**акцессчеккбитипересултлист**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-accesscheckbytyperesultlist) . Дополнительные сведения см. [в разделе Проверка прав доступа к элементу управления в списке ACL объекта](checking-a-control-access-right-in-an-objectampaposs-acl.md).

В зависимости от результата проверки доступа к объекту приложение или служба могут разрешить или запретить пользователю доступ к приложению или службе.

При создании объекта [**контролакцессригхт**](/windows/desktop/ADSchema/c-controlaccessright) задайте атрибуты, перечисленные в следующей таблице, чтобы сделать объект допустимым правом доступа, распознаваемым службами домен Active Directory и системами безопасности Windows.



| attribute                                     | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|-----------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**cn**](/windows/desktop/ADSchema/a-cn)                       | Однозначное свойство, которое является относительным различающимся именем объекта (RDN) в контейнере Extended-Rights. **CN** — это имя права доступа в домен Active Directory Services.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [**appliesTo**](/windows/desktop/ADSchema/a-appliesto)         | Многозначное свойство, содержащее список классов объектов, к которым применяется право на управление доступом. Например, элемент управления доступом " [**Отправить как**](/windows/desktop/ADSchema/r-send-as) доступ" перечисляет классы [**пользовательских**](/windows/desktop/ADSchema/c-user) и [**компьютерных**](/windows/desktop/ADSchema/c-computer) объектов в свойстве **appliesTo** . В списке каждый класс объекта определяется [**schemaIDGUID**](/windows/desktop/ADSchema/a-schemaidguid) объекта [**classSchema**](/windows/desktop/ADSchema/c-classschema) . Идентификаторы GUID хранятся в виде строк в форме, созданной функцией [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) в библиотеке COM, но без начальной и завершающей фигурных скобок ({}). Например, следующий идентификатор GUID является **schemaIDGUID** для класса [**Computer**](/windows/desktop/ADSchema/c-computer) : bf967a86-0de6-11D0-a285-00aa003049e2.<br/> Имейте в виду, что свойство [**schemaIDGUID**](/windows/desktop/ADSchema/a-schemaidguid) объекта [**classSchema**](/windows/desktop/ADSchema/c-classschema) хранится в виде двоичного идентификатора GUID с помощью синтаксиса строки октета. Чтобы преобразовать этот формат строки октета в формат строки, используемый в свойстве [**appliesTo**](/windows/desktop/ADSchema/a-appliesto) , используйте функцию [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) и Удалите фигурные скобки из возвращаемой строки.<br/> Дополнительные сведения о свойстве [**schemaIDGUID**](/windows/desktop/ADSchema/a-schemaidguid) одного из предопределенных классов объектов, таких как [**пользователь**](/windows/desktop/ADSchema/c-user) или [**компьютер**](/windows/desktop/ADSchema/c-computer), см. на странице справочника по классам в справочнике по схеме Active Directory в [справочнике по службам домен Active Directory](active-directory-domain-services-reference.md). Дополнительные сведения и пример кода, который извлекает **schemaIDGUID** из объекта classSchema, см. в разделе [чтение объектов attributeSchema и classSchema](reading-attributeschema-and-classschema-objects.md).<br/> |
| [**displayName**](/windows/desktop/ADSchema/a-displayname)     | Строка, используемая для вывода прав на управление доступом в пользовательских интерфейсах, таких как страница свойств **Безопасность** и другие места в оснастке MMC "пользователи и компьютеры" Active Directory.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| [**ригхтсгуид**](/windows/desktop/ADSchema/a-rightsguid)       | Идентификатор GUID, определяющий право доступа к элементу управления в записи ACE. Идентификатор GUID хранится в виде строки формы, созданной функцией [**StringFromGUID2**](/windows/win32/api/combaseapi/nf-combaseapi-stringfromguid2) , но без начальной и завершающей фигурных скобок. Используйте Uuidgen.exe для другой служебной программы, чтобы создать идентификатор GUID для права доступа к элементу управления. При определении нового набора свойств используется [**ригхтсгуид**](/windows/desktop/ADSchema/a-rightsguid) объекта [**контролакцессригхт**](/windows/desktop/ADSchema/c-controlaccessright) для определения свойств в наборе. Для каждого свойства в наборе свойств задайте значение [**аттрибутесекуритигуид**](/windows/desktop/ADSchema/a-attributesecurityguid) свойства равным значению **ригхтсгуид** набора свойств. Значение свойства **аттрибутесекуритигуид** хранится в определении [**attributeSchema**](/windows/desktop/ADSchema/c-attributeschema) свойства в схеме Active Directory. Свойство **аттрибутесекуритигуид** является однозначным и сохраняет GUID в двоичном формате (синтаксис строки октета).<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [**Атрибута**](/windows/desktop/ADSchema/a-objectclass)     | Этот атрибут указывает [**контролакцессригхт**](/windows/desktop/ADSchema/c-controlaccessright) в качестве класса объекта.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| [**валидакцессес**](/windows/desktop/ADSchema/a-validaccesses) | Для наборов свойств присвойте этому атрибуту значение 0x30 (**ADS \_ справа \_ DS \_ Read \_ prop** Active Directory \| **\_ справа \_ DS \_ Write \_ prop**). Для прав доступа к управлению установите для этого атрибута значение 0x100 (**ADS \_ \_ Active Directory Rights \_ \_ Access Control**). Страница свойств Безопасность распознает права доступа Control, только если для атрибута [**валидакцессес**](/windows/desktop/ADSchema/a-validaccesses) задано соответствующее значение. Если значение равно нулю, право доступа к элементу управления игнорируется или не отображается на странице свойств безопасность.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |



 

Имейте в виду, что стандартные классы схемы используют атрибут **локализатиондисплайид** объекта [**контролакцессригхт**](/windows/desktop/ADSchema/c-controlaccessright) для указания идентификатора сообщения, используемого для получения локализованного отображаемого имени из Dssec.dll. Не устанавливайте атрибут **локализатиондисплайид** при определении нового объекта **контролакцессригхт** .

 

