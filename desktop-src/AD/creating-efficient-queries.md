---
title: Создание эффективных запросов
description: В следующей таблице приведены важные понятия, которые следует учитывать при создании эффективного запроса.
ms.assetid: 1eb92d74-0a17-43f9-b5bf-eed731a52551
ms.tgt_platform: multiple
keywords:
- Active Directory примеры Active Directory, создание эффективных запросов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c8902fd3d512b940890ebdfd4c2640786c88c82a
ms.sourcegitcommit: 803f3ccd65bdefe36bd851b9c6e7280be9489016
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/17/2020
ms.locfileid: "103789583"
---
# <a name="creating-efficient-queries"></a>Создание эффективных запросов

В следующей таблице приведены важные понятия, которые следует учитывать при создании эффективного запроса.



| Область                  | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|-----------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Индексация              | Убедитесь, что фильтр запроса содержит по крайней мере один индексированный атрибут.<br/> Дополнительные сведения см. в разделе [индексированные атрибуты](indexed-attributes.md).<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| Сравнение класса и категории    | Оператор "objectClass = XYZ" относится к объектам каталога, в которых "XYZ" представляет любой класс в иерархии классов объектов, а "objectCategory = XYZ", ссылается на объекты каталога, в которых "XYZ" определяет конкретный класс в иерархии классов объектов. Свойство [**objectClass**](/windows/desktop/ADSchema/a-objectclass) может принимать несколько значений, тогда как [**objectCategory**](/windows/desktop/ADSchema/a-objectcategory) принимает одно значение и, таким образом, лучше подходит для сопоставления типов объектов в поиске по каталогу.<br/>                                                                                                                                                                                          |
| Поиск текста        | Старайтесь не искать текст в середине и в конце строки.<br/> Например, "CN = \* Хилле \* " или "CN = \* лараусе".<br/> Использование более конкретных критериев сопоставления обычно повышает производительность поиска. Это связано с тем, что службы домен Active Directory будут оценивать все предикаты, определяет индексы, а затем выбирают один индекс, который, скорее всего, будет выдавать наименьший набор возвращаемых значений. Этот метод не подходит для поиска в середине и в конце строки. При отсутствии других параметров, кроме использования этих поисков, можно определить индекс кортежа для атрибута.<br/> Дополнительные сведения об индексах кортежей см. в статье [как работает индексирование кортежей](how-tuple-indexing-works.md).<br/> |
| Поиск поддеревьев     | Используйте глобальный каталог при поиске по поддереву. Отслеживание ссылок требует обширных ресурсов.<br/> Дополнительные сведения см. в разделе [Указание других параметров поиска](specifying-other-search-options.md).<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Использование разбиения на страницы         | Предположим, что поиск по поддереву вернет большой результирующий набор. Используйте разбиение по страницам при выполнении поиска по поддереву. Сервер будет передавать большой результирующий набор в блоки, уменьшая ресурсы памяти на стороне сервера. Это минимизирует использование сети и сокращает потребность в отправке больших блоков данных по сети.<br/> Дополнительные сведения см. в разделе [Указание других параметров поиска](specifying-other-search-options.md).<br/>                                                                                                                                                                                                                                                                                        |
| Объединение поисков      | Использование нескольких атрибутов для поиска. Один поиск объекта, считывающего два атрибута, более эффективен, чем два поиска одного и того же объекта, каждый из которых возвращает один атрибут.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Эффективное использование BIND | Выполните привязку к объекту один раз и удерживайте маркер привязки для оставшейся части сеанса. Не привязывать и не привязывать к каждому вызову. При использовании ADO или OLE DB не создавайте много объектов соединения.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| Кэширование Руддсе       | Прочтите rootDSE один раз и сохраните его содержимое для оставшейся части сеанса.<br/> Дополнительные сведения см. в статье [бессерверная привязка и RootDSE](serverless-binding-and-rootdse.md).<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Сохранение ссылок | Сохранять ссылки на объекты как идентификаторы GUID, а не различающиеся имена, чтобы их можно было переименовывать и удалять.<br/> Дополнительные сведения см. в разделе [Использование objectGUID для привязки к объекту](using-objectguid-to-bind-to-an-object.md).<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |



 

 

