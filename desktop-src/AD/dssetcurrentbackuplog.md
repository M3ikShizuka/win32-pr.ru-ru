---
title: Функция Дссеткуррентбаккуплог (Нтдсбкли. h)
description: Задает текущий номер журнала резервного копирования после успешного восстановления.
ms.assetid: 903bddea-c5a7-4b3f-819c-0467a9c5ae1b
ms.tgt_platform: multiple
keywords:
- Active Directory функции Дссеткуррентбаккуплог
topic_type:
- apiref
api_name:
- DsSetCurrentBackupLog
- DsSetCurrentBackupLogA
- DsSetCurrentBackupLogW
api_location:
- Ntdsbcli.dll
api_type:
- DllExport
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 9f50fc41317ae22ae89c47f63bb19f981563e5c4
ms.sourcegitcommit: a1494c819bc5200050696e66057f1020f5b142cb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2020
ms.locfileid: "103892181"
---
# <a name="dssetcurrentbackuplog-function"></a>Функция Дссеткуррентбаккуплог

\[Эта функция доступна для использования в операционных системах, указанных в разделе требования. В последующих версиях он может быть изменен или недоступен. Начиная с Windows Vista, вместо нее следует использовать [Служба теневого копирования томов (VSS)](../vss/volume-shadow-copy-service-overview.md) .\]

Функция **дссеткуррентбаккуплог** задает текущий номер журнала резервного копирования после успешного восстановления. Так как службы домен Active Directory поддерживают только циклическое ведение журнала, эта функция обычно не используется.

## <a name="syntax"></a>Синтаксис


```C++
HRESULT DsSetCurrentBackupLog(
  _In_ LPCWSTR szServerName,
  _In_ DWORD   dwCurrentLog
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*сзсервернаме* \[ окне\]
</dt> <dd>

Указатель на строку, завершающуюся нулем, которая содержит имя сервера, для которого задается номер журнала резервного копирования. Предыдущие обратные косые черты необязательны. Сервер должен быть тем же компьютером, из которого вызывается эта функция. Имя сервера не может содержать символы подчеркивания ( \_ ). Пример имени сервера — \\ \\ Server1.

</dd> <dt>

*двкуррентлог* \[ окне\]
</dt> <dd>

Содержит номер журнала резервного копирования, который необходимо задать.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Возвращает **значение \_ ОК** , если функция выполнена успешно, или код ошибки Win32 или RPC в противном случае. В следующем списке перечислены возможные коды ошибок.

<dl> <dt>

**Ошибка \_ недопустимого \_ параметра**
</dt> <dd>

Один или несколько параметров недопустимы.

</dd> <dt>

**Ошибка \_ не \_ хватает \_ памяти**
</dt> <dd>

Ошибка при выделении памяти.

</dd> </dl>

## <a name="remarks"></a>Комментарии

Обычно не требуется вызывать функцию **дссеткуррентбаккуплог** . Функции резервного копирования автоматически определяют и устанавливают последний номер журнала, резервная копия которого была создана. Используйте **дссеткуррентбаккуплог** , чтобы предотвратить выполнение другого добавочного резервного копирования до выполнения полного резервного копирования.

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows Vista<br/>                                                                |
| Минимальная версия сервера<br/> | Windows Server 2008<br/>                                                          |
| Header<br/>                   | <dl> <dt>Нтдсбкли. h</dt> </dl>   |
| Библиотека<br/>                  | <dl> <dt>Нтдсбкли. lib</dt> </dl> |
| DLL<br/>                      | <dl> <dt>Ntdsbcli.dll</dt> </dl> |
| Имя в кодировке Юникод и ANSI<br/>   | **Дссеткуррентбаккуплогв** (Юникод) и **дссеткуррентбаккуплога** (ANSI)<br/>   |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[Резервное копирование и восстановление сервера Active Directory](backing-up-and-restoring-an-active-directory-server.md)
</dt> <dt>

[Функции резервного копирования каталога](directory-backup-functions.md)
</dt> </dl>

 

