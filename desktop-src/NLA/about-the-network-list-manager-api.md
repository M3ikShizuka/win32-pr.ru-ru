---
title: Сведения об API диспетчера списка сетей
description: Сведения об API диспетчера списка сетей
ms.assetid: 675cf7ed-9f57-4d62-8091-1f4e8812f2ad
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6230251e627671b7fd33adbf50b3904703bc9847
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "103779124"
---
# <a name="about-the-network-list-manager-api"></a>Сведения об API диспетчера списка сетей

Сетевая среда Microsoft Windows позволяет многосетевым компьютерам одновременно подключаться к нескольким сетям. Можно использовать несколько беспроводных сетей вместе с локальной сетью и коммутируемыми подключениями. Диспетчер списка сетей определяет доступные сети и возвращает приложению данные атрибутов сети.

API диспетчера списка сетей взаимодействует со службой диспетчера списка сетей для определения и извлечения свойств каждой сети, к которой подключается компьютер. Каждая сеть уникально идентифицируется с помощью подписи сети на основе уникально идентифицируемых свойств этой сети. Когда приложение регистрируется для уведомлений диспетчера списка сетей, оно получает уведомления о доступности новых сетевых подключений или изменениях существующих сетевых подключений. Приложения могут настраивать свою логику в зависимости от того, к какой сети они подключены. к какому сетевому подключению они подключены; или свойства сети. С помощью этих информационных приложений можно настроить действия в соответствии с текущими условиями сети.

В Windows Vista появились новые интерфейсы, которые можно использовать для получения подробных сведений об этих характеристиках сети и многом другое. С помощью интерфейса [**инетворклистманажер**](/windows/desktop/api/Netlistmgr/nn-netlistmgr-inetworklistmanager) можно легко перечислить все сети ([**инетворк**](/windows/desktop/api/Netlistmgr/nn-netlistmgr-inetwork)), когда компьютер уже встречался или только подключенные сети, либо только отключенные сети. Интерфейс **инетворклистманажер** также упрощает перечисление сетевых интерфейсов на компьютере.

Интерфейс [**инетворк**](/windows/desktop/api/Netlistmgr/nn-netlistmgr-inetwork) используется для определения свойств сетевого подключения: имя, описание, идентификатор, управляемый, аутентифицированный, подключенный или отключенный, а также другие. Возможно, что одна сеть подключена к нескольким интерфейсам, поэтому через интерфейс **инетворк** можно также перечислить используемые экземпляры интерфейса **инетворк** .

Интерфейс [**инетворк**](/windows/desktop/api/Netlistmgr/nn-netlistmgr-inetwork) сообщает о соответствующих свойствах интерфейса: ID, GUID, тип (управляемый, аутентифицированный) и состояние (подключено, отключено, локально, v4 Интернета, IPv6, локальная версия, V6 Интернет). V4 local означает локальный доступ с помощью протокола IP версии 4 (IPv4). V4 Интернет означает IPv4 с доступом к Интернету. V6 Local и V6 Internet означают IPv6.

Корневым элементом дерева объектов для сетевого расположения является интерфейс [**инетворклистманажер**](/windows/desktop/api/Netlistmgr/nn-netlistmgr-inetworklistmanager) . Этот интерфейс реализован в компонентном классе **CLSID \_ нетворклистманажер** . Чтобы использовать этот интерфейс, необходимо создать COM-объект **\_ нетворклистманажер CLSID** , как показано ниже:


```C++
#include <windows.h>
#include <netlistmgr.h>

#pragma comment(lib, "ole32.lib")

void main()
{
    INetworkListManager *pNetworkListManager = NULL; 
    HRESULT hr = CoCreateInstance(CLSID_NetworkListManager, NULL,
            CLSCTX_ALL, IID_INetworkListManager,
            (LPVOID *)&pNetworkListManager);
}
```



 

 




