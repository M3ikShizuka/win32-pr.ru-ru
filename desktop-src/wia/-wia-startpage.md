---
description: Windows получение изображений (WIA) — это все еще платформа для получения изображений в семействе операционных систем Windows, начиная с Windows Millennium Edition (Windows Me) и Windows XP.
ms.assetid: 8f32422e-25ec-48bc-9d79-57dbb3b53e93
title: Служба загрузки изображений (WIA)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e467d76f054a8cccb4c309f69b211d0d3d6fbe949625324c871319028aa78ebc
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "120057020"
---
# <a name="windows-image-acquisition-wia"></a>Служба загрузки изображений (WIA)

Windows получение изображений (WIA) — это все еще платформа для получения изображений в семействе операционных систем Windows, начиная с Windows Millennium Edition (Windows Me) и Windows XP.

-   [Введение](#introduction)
-   [преимущества приобретения образа Windows 2,0](#benefits-of-windows-image-acquisition-20)
    -   [Для создателей приложений](#for-application-writers)
    -   [Для изготовителей устройств](#for-device-manufactures)
    -   [Для пользователей сканеров](#for-scanner-users)
-   [разработка Windows получения образа](#development-of-windows-image-acquisition)
-   [общие сведения о получении образа Windows](#overview-of-windows-image-acquisition)
-   [факты о приобретении образа Windows 2,0](#facts-about-windows-image-acquisition-20)
-   [Аудитория разработчика](#developer-audience)
-   [Требования к времени выполнения](#run-time-requirements)
-   [Темы WIA](#wia-topics)

## <a name="introduction"></a>Введение

Платформа WIA позволяет приложениям для работы с образами и графическими приложениями взаимодействовать с оборудованием для работы с образами и стандартизировать взаимодействие между различными приложениями и сканерами. Это позволяет различным приложениям взаимодействовать с различными сканерами, не требуя от разработчиков средств записи и сканеров настраивать свои приложения или драйверы для каждой комбинации приложений и устройств.

![Рисунок, демонстрирующий базовую архитектуру WIA в качестве двустороннего слоя между приложениями и устройствами создания образа. ](images/wia-diagram1.png)

## <a name="benefits-of-windows-image-acquisition-20"></a>преимущества приобретения образа Windows 2,0

WIA предоставляет преимущества разработчикам приложений, производителям устройств и пользователям сканеров, которым необходимо взаимодействовать с оборудованием для работы с образами.

### <a name="for-application-writers"></a>Для создателей приложений

-   Windows выполняет процесс сертификации для драйверов wia, поэтому приложения WIA гарантированно совместимы на уровне базового уровня со всеми сканерами, основанными на wia.
-   Драйверы WIA загружаются в процессе службы WIA, что обеспечивает более стабильную среду драйвера.
-   Приложения могут быть запущены с помощью кнопки сканирования сканера через события push-уведомления, поддерживаемые подсистемой WIA.
-   WIA включает фильтр сегментации по умолчанию, который может использовать все драйверы. Таким образом, приложениям не придется писать код для сканирования в нескольких регионах для таких целей, как разделение большого числа фотографий, распространяющихся на планшетный сканер.

### <a name="for-device-manufactures"></a>Для изготовителей устройств

-   Процесс сертификации WIA-драйвера помогает разработчикам драйверов установить, что их драйвер совместим с WIA.
-   Драйверы WIA могут воспользоваться встроенным фильтром сегментации, фильтром обработки изображений и обработчиком ошибок.
-   сканеры на основе WIA работают в Windows с Windows сканирования, например Windows факсов, сканирования и Paint.
-   драйверы WIA обеспечивают лучшую интеграцию с Windows, например с полным интерфейсом устройства.
-   Windows Выпуск Vista включает драйвер класса WSD-WIA, который позволяет всем устройствам, совместимым с протоколом веб-служб для сканера (WS-Scan), работать с приложениями WIA без дополнительного драйвера или программного обеспечения.

### <a name="for-scanner-users"></a>Для пользователей сканеров

-   сканеры на основе WIA можно использовать из Windows приложений, таких как Windows факсов и сканирования и Paint без необходимости дополнительного программного обеспечения.
-   Приложения и сканеры на основе WIA могут также использовать преимущества надстроек WIA, таких как фильтр сегментации, который позволяет выполнять такие функции, как обработка нескольких изображений на сканере и их просмотр в отдельных файлах без вмешательства пользователя.
-   устройства на основе WIA обеспечивают гораздо более лучшую интеграцию с другими Windowsными функциями, такими как функция Device Stage для Windows 7.
-   WIA обеспечивает более надежную, устойчивую и надежную проверку, изолируя драйвер и приложение.

## <a name="development-of-windows-image-acquisition"></a>разработка Windows получения образа

архитектура обработки изображений в Windows 2000 и Windows 95 или более поздней версии состояла из аппаратной абстракции низкого уровня, архитектуры образа (сти) и высокоуровневого набора интерфейсов api, известных как TWAIN. в Windows XP и Windows Me была представлена WIA. WIA представляет собой архитектуру создания образов, основанную на сти и не требующую использования TWAIN, хотя TWAIN по-прежнему поддерживается вместе с WIA.

WIA 1,0 появился в Windows Me и Windows XP и поддерживает сканеры, цифровые камеры и цифровое видео оборудование. WIA 2,0 был выпущен с Windows Vista. WIA 2,0 предназначен для сканеров, но по-своему поддерживает поддержку устаревших приложений и устройств WIA 1,0 с помощью WIA 1,0 на уровень совместимости WIA 2,0, предоставляемый службой WIA. однако поддержка содержимого видео была удалена из WIA для Windows Vista. в будущем мы рекомендуем Windows API для портативных устройств (WPD) для цифровых камер и цифрового видеооборудования. WIA 1,0, а также драйверы TWAIN сти по-прежнему поддерживаются непосредственно в Windows Vista и Windows 7 вместе с собственными драйверами устройств WIA 2,0 и приложениями для работы с образами.

## <a name="overview-of-windows-image-acquisition"></a>общие сведения о получении образа Windows

WIA предоставляет платформу, которая позволяет устройству предоставлять свои уникальные возможности операционной системе и позволяет приложениям для работы с образами вызывать эти уникальные возможности.

Платформа WIA включает протокол получения данных, модель драйвера устройства и интерфейс (DDI), API и выделенную службу WIA. Платформа также включает набор встроенных драйверов режима ядра, поддерживающих взаимодействие с устройствами обработки изображений, локально подключенных через интерфейсы USB, последовательных и параллельных интерфейсов SCSI и FireWire. Подсистема WIA также включает прозрачный слой совместимости, который позволяет приложениям, совместимым с TWAIN, применять и использовать устройства WIA-Driver.

подключенные к сети устройства с образами, поддерживающие протокол Web Services for devices (WSD), также можно использовать в приложениях для работы с образами, совместимых с WIA, в Windows Vista и Windows 7 из box через драйвер класса WSD-WIA, поставляемый в составе Windows Vista. Драйвер класса преобразует вызовы WIA в вызовы WSD и наоборот и делает уже существующие приложения WIA работать с сканерами на основе WSD без дополнительных драйверов.

WIA-драйверы состоят из компонента пользовательского интерфейса и основного компонента драйвера, который загружается в два различных пространства процесса: Пользовательский интерфейс в пространстве приложения и ядро драйвера в пространстве службы WIA. служба работает в контексте локальной системы в Windows XP и работает в контексте локальной службы, начиная с Windows Server 2003 и Windows Vista для усиления безопасности в отношении ошибками или вредоносных драйверов.

![график, показывающий архитектуру WIA и ее функционирование в качестве службы.](images/wia-arch.png)

Набор API-интерфейсов WIA предоставляет приложениям для работы с образами функцию получения аппаратных функций, обеспечивая поддержку следующих возможностей:

-   Перечисление доступных устройств получения изображений.
-   Одновременное создание подключений к нескольким устройствам.
-   Запрос свойств устройств в стандартном и расширяемом способе.
-   Получение данных устройства с помощью стандартных и высокопроизводительных механизмов перемещения.
-   Поддержание свойств изображения при передаче данных.
-   Уведомление о состоянии устройства и обработке событий сканирования.

Windows добавлена поддержка создания скриптов в wia путем освобождения библиотеки wia-автоматизации в 2002, которая была включена в Windows Vista как уровень автоматизации "Windowsное получение изображений" (WIA) и остается частью Windows 7. библиотека WIA Automation предоставляет сквозную возможность получения образа в средах разработки приложений с поддержкой автоматизации и языках программирования, таких как Microsoft Visual Basic 6,0, Active Server pages (ASP), VBScript и C \# .

для Windows 7 интерфейсы api WIA имеют дополнительную поддержку, дополняющую уже существующую поддержку push-уведомлений.

-   Автоматическая Настройка сканирования, инициированного устройством, с параметрами сканирования, настроенными на сканере на передней панели устройства.
-   Автоматический выбор источника для проверки, инициированной устройством.

## <a name="facts-about-windows-image-acquisition-20"></a>факты о приобретении образа Windows 2,0

-   Механизм передачи данных в WIA 2,0 основан на потоке. Абстракция потока устраняет различие между различными типами передачи, а также обеспечивает обмен взаимно согласованными метаданными между устройством и приложением.
-   Подсистема WIA 2,0 также включает в себя базовую надстройку фильтра обработки изображений, которая может быть заменена драйвером сканера, если драйвер решит предоставить настраиваемый фильтр обработки изображений. Встроенный фильтр позволяет выполнять обработку изображений, полученных с помощью сканера. Фильтр обработки изображений также позволяет выполнять интерактивный просмотр программного обеспечения, когда небольшие параметры, такие как яркость и контрастность, корректируются.
-   Фильтр сегментации — это еще один удобный компонент WIA, который можно заменить более настраиваемым фильтром для драйвера сканера. Фильтр сегментации можно использовать для сканирования в нескольких регионах. В качестве примера сканирование в нескольких регионах позволяет приложению автоматически обнаруживать разные регионы сканирования без вмешательства пользователя, например, выявляя несколько фотографий на планшете сканера случайным образом.
-   WIA 2,0 предоставляет заменяемый или расширяемый обработчик ошибок для корректной обработки и, возможно, устранения ошибок и задержек программного обеспечения, оборудования и конфигурации. Обработчик ошибок — это еще один компонент WIA, который можно заменить на более настраиваемую версию с помощью драйвера сканера. Это расширение предоставляет сообщения о состоянии и ошибках во время получения данных, таких как "прогрев лампы", "открытая обложка", "Застревание бумаги" и т. д. Это расширение также допускает поддержку очистки для операций отмены.

## <a name="developer-audience"></a>Аудитория разработчиков

API-интерфейс WIA предназначен для использования программистами C/C++. знание интерфейса пользователя Windows и интерфейсной объектной модели (COM) является обязательным.

для разработчиков, знакомых с Microsoft Visual Basic 6,0, Active Server pages (ASP) или сценариями, WIA предоставляет уровень автоматизации для Windows XP с пакетом обновления 1 (SP1) или более поздней версии, который строится на основе и упрощает доступ к фундаменту, предоставляемому C/C++. дополнительные сведения о слое автоматизации см. в разделе [Windowsного уровня службы "получение образа](/previous-versions/windows/desktop/wiaaut/-wiaaut-startpage)".

> [!Note]  
> слой автоматизации wia заменяет скрипты Windows получения изображений (wia) 1,0.

 

## <a name="run-time-requirements"></a>Требования к среде выполнения

для приложений, использующих API-интерфейс WIA, требуется Windows XP или более поздней версии.

## <a name="wia-topics"></a>Темы WIA

Темы WIA организованы, как показано в следующей таблице.



|  Раздел                                                                                                                            | Описание                                                                                                   |
|------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------|
| [сведения о получении образа Windows](-wia-about-windows-image-acquisition.md)                                                  | Общие сведения о WIA                                                                     |
| [Windows Драйверы получения образа](/windows-hardware/drivers/image/windows-image-acquisition-drivers)                  | Разработка драйвера WIA                                                                            |
| [Windows Уровень автоматизации загрузки изображений](/previous-versions/windows/desktop/wiaaut/-wiaaut-startpage) | Слой автоматизации WIA                                                                              |
| [Учебник по WIA](-wia-wia-tutorial.md)                                                                                        | Пошаговое руководство по коду, включенному в пакет средств разработки программного обеспечения (SDK), который посвящен конкретным задачам |
| [Ссылки](-wia-reference.md)                                                                                              | Сведения о интерфейсах WIA, методах, объектах и типах данных, используемых в C/C++ и сценариях.      |



 

 

 
