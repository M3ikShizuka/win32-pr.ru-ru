---
description: в Windows Vista существенно изменилось дерево элементов Windowsного получения изображений (WIA).
ms.assetid: dda87bcc-2315-4f0d-87a0-d5a33d5d929a
title: Сведения о дереве элементов IWiaItem2
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9ae342f5a85e61b6384604dae703881c6888e3e1cf8e61cc8a39a32ac77ad436
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119264437"
---
# <a name="about-the-iwiaitem2-item-tree"></a>Сведения о дереве элементов IWiaItem2

в Windows Vista существенно изменилось дерево элементов Windowsного получения изображений (WIA). Элементы [**IWiaItem2**](-wia-iwiaitem2.md) используются для представления атрибутов устройства и данных устройства. приложения для работы с образами видят устройство Windowsного получения изображений (WIA) 2,0 в виде иерархического дерева элементов с корневым элементом, представляющим само устройство, и дочерними элементами, представляющими такие элементы, как программируемые источники данных, изображения или папки, содержащие изображения.

-   [Элементы приложения](#application-items)
-   [Флаги элементов](#item-flags)
-   [Категории элементов](#item-categories)
-   [Корневой элемент](#root-item)
-   [Элемент данных](#data-item)
-   [Связанные темы](#related-topics)

## <a name="application-items"></a>Элементы приложения

Дерево элементов WIA 2,0, которое может видеть приложение, отличается от дерева, созданного и обслуживаемого WIA 2,0 минидривер. Когда минидривер создает дерево, служба WIA 2,0 использует это дерево элементов WIA 2,0 в качестве инструкции по созданию копии дерева, которую можно просматривать с помощью приложений для работы с образами. Элементы в скопированном дереве называются элементами *приложения* . Элементы в дереве, созданном минидривер, называются элементами *драйвера* .

Элемент WIA может представлять программируемый источник данных для устройства подачи документов сканера или данные, хранящиеся на этом устройстве. Устройство WIA должно быть разделено на отдельные элементы, описывающие различные данные, создаваемые этим устройством.

Например, сканер WIA, поддерживающий сканирование для планшетов и сканирования веб-каналов документов, может быть разделен на два дочерних элемента. Один представляет функцию сканирования на планшете, а другая — функцию сканирования устройства подачи документов.

Несколько образов, представленных на сканере для планшетов и сканированных одновременно, можно поместить в одну папку. С помощью фильтра сегментации ([**ивиасегментатионфилтер**](-wia-iwiasegmentationfilter.md)) каждое изображение или подобласть можно создать как дочерний элемент папки.

Дерево WIA для устройства камеры, в котором хранятся фотографии («пленка»), можно разделить на элементы, представляющие папки, вложенные папки и фотографии.

## <a name="item-flags"></a>Флаги элементов

Флаги элементов WIA помогают классифицировать содержимое или поддерживаемое поведение конкретного элемента WIA. Флаги элементов WIA делятся на две группы.

1.  Флаги состояния элемента сообщают о текущем состоянии элемента WIA, например [**виаитемтипедисконнектед**](-wia-wia-item-type-flags.md), **виаитемтипеделетед** и т. д.
2.  Флаги представления и использования данных элемента сообщают о данных, которые элемент WIA представляет или может создать при передаче. Например, [**виаитемтипеимаже**](-wia-wia-item-type-flags.md) является флагом представления данных, сообщающим приложению, что данные, связанные с текущим элементом WIA, являются данными изображения и должны иметь свойства данных изображения. **WIA \_ \_ \_ Флаги элементов IPA** — это флаг использования элемента, который сообщает приложению, что элемент WIA является настраиваемым и соответствует набору предварительно определенных правил конфигурации на [**основе \_ \_ \_ категории элемента WIA IPA**](-wia-wiaitempropcommonitem.md) и что конфигурация может изменить результат для каждой передачи данных. (Дополнительные сведения об определениях категорий см. в разделе категории элементов [категорий](#item-categories) товаров.)

На следующем рисунке показан пример дерева элементов WIA и различные флаги, которые могут быть связаны с каждым элементом.

![Примеры флагов элементов для элементов в дереве](images/scannertree1.jpg)

## <a name="item-categories"></a>Категории элементов

Элементы WIA группируются в категории с помощью значений [**свойств \_ \_ \_ категории элемента WIA IPA**](-wia-wiaitempropcommonitem.md) . Эти категории определяют способ обработки или использования элемента WIA. Например, если элемент представляет готовый файл ( \_ Файл «Категория WIA \_ завершена» \_ ), приложение WIA должно предположить, что данные статичны и расположены на устройстве. Если элемент представляет поток- \_ \_ контейнер (податчик категории WIA), приложение должно содержать необходимые свойства устройства подачи документов и действовать как устройство подачи документов.

Ниже перечислены категории, определяемые WIA.

-   \_Автоматическая категория \_ WIA
-   \_податчик категории WIA \_
-   \_пленка для категории WIA \_
-   файл, в котором \_ Категория WIA \_ завершена \_
-   \_стекло категории \_ WIA

Например, для элемента сканера WIA могут быть заданы [**\_ \_ \_ Флаги IPA элементов**](-wia-wiaitempropcommonitem.md) для [**виаитемтипеимаже**](-wia-wia-item-type-flags.md), **виаитемтипетрансфер** и **виаитемтипепрограммабледатасаурце**, а для свойства **WIA \_ IPA \_ элемента \_ Category** задано значение WIA категории "планшетный" \_ \_ .

В следующей таблице показано группирование категорий WIA с помощью флагов элементов и элементов WIA. Эта таблица не включает полный список флагов элементов WIA, определенных WIA.



<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="header">
<th>Категория WIA</th>
<th>Допустимые флаги элемента WIA</th>
<th>Набор свойств WIA</th>
<th>Элементы WIA</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>WIA_CATEGORY_AUTO</td>
<td><ul>
<li><a href="-wia-wia-item-type-flags.md"><strong>виаитемтипепрограммабледатасаурце</strong></a></li>
<li><a href="-wia-wia-item-type-flags.md"><strong>виаитемтипеимаже</strong></a></li>
<li><a href="-wia-wia-item-type-flags.md"><strong>виаитемтипетрансфер</strong></a></li>
<li><a href="-wia-wia-item-type-flags.md"><strong>виаитемтипефиле</strong></a></li>
</ul></td>
<td>Набор свойств включает автоматические настроенные свойства сканера.</td>
<td>Автоэлемент WIA, представляющий автоматическую настройку параметров сканирования сканера.</td>
</tr>
<tr class="even">
<td>WIA_CATEGORY_FEEDER</td>
<td><ul>
<li><a href="-wia-wia-item-type-flags.md"><strong>виаитемтипепрограммабледатасаурце</strong></a></li>
<li><a href="-wia-wia-item-type-flags.md"><strong>виаитемтипеимаже</strong></a></li>
<li><a href="-wia-wia-item-type-flags.md"><strong>виаитемтипедокумент</strong></a></li>
<li><a href="-wia-wia-item-type-flags.md"><strong>виаитемтипетрансфер</strong></a></li>
<li><a href="-wia-wia-item-type-flags.md"><strong>виаитемтипефолдер</strong></a></li>
</ul></td>
<td>Набор свойств включает свойства элемента управления сканера веб-канала (обычно это набор свойств, связанных с изображениями и документами).</td>
<td>Элементы податчика WIA, включая дочерние элементы, представляющие переднюю и заднюю страницы документа.</td>
</tr>
<tr class="odd">
<td>WIA_CATEGORY_FILM</td>
<td><ul>
<li><a href="-wia-wia-item-type-flags.md"><strong>виаитемтипепрограммабледатасаурце</strong></a></li>
<li><a href="-wia-wia-item-type-flags.md"><strong>виаитемтипеимаже</strong></a></li>
<li><a href="-wia-wia-item-type-flags.md"><strong>виаитемтипетрансфер</strong></a></li>
<li><a href="-wia-wia-item-type-flags.md"><strong>виаитемтипефолдер</strong></a></li>
</ul></td>
<td>Набор свойств включает свойства элемента управления "сканер пленки" (обычно это набор свойств Image и Document).</td>
<td>Элементы пленки WIA, включая дочерние элементы, представляющие отдельные кадры сканирования.</td>
</tr>
<tr class="even">
<td>WIA_CATEGORY_FINISHED_FILE</td>
<td><ul>
<li><a href="-wia-wia-item-type-flags.md"><strong>виаитемтипефолдер</strong></a></li>
<li><a href="-wia-wia-item-type-flags.md"><strong>виаитемтипеимаже</strong></a></li>
<li><a href="-wia-wia-item-type-flags.md"><strong>виаитемтипеаудио</strong></a></li>
<li><a href="-wia-wia-item-type-flags.md"><strong>виаитемтипевидео</strong></a></li>
<li><a href="-wia-wia-item-type-flags.md"><strong>виаитемтипедокумент</strong></a></li>
<li><a href="-wia-wia-item-type-flags.md"><strong>виаитемтипетрансфер</strong></a></li>
</ul></td>
<td>Свойство, заданное для этого элемента, зависит от сообщаемого типа элемента. Например, <a href="-wia-wia-item-type-flags.md"><strong>виаитемтипеимаже</strong></a> должен включать некоторые свойства элементов изображения, например бит на пиксель и т. д.</td>
<td>Элементы хранения WIA, включая дочерние элементы, представляющие завершенное содержимое файла (файлы данных, такие как JPEG, HTML, TXT и т. д.).</td>
</tr>
<tr class="odd">
<td>WIA_CATEGORY_FLATBED</td>
<td><ul>
<li><a href="-wia-wia-item-type-flags.md"><strong>виаитемтипепрограммабледатасаурце</strong></a></li>
<li><a href="-wia-wia-item-type-flags.md"><strong>виаитемтипеимаже</strong></a></li>
<li><a href="-wia-wia-item-type-flags.md"><strong>виаитемтипедокумент</strong></a></li>
<li><a href="-wia-wia-item-type-flags.md"><strong>виаитемтипетрансфер</strong></a></li>
<li><a href="-wia-wia-item-type-flags.md"><strong>Виаитемтипефолдер</strong></a>— может присутствовать, если сканер поддерживает сканирование нескольких элементов.</li>
<li><a href="-wia-wia-item-type-flags.md"><strong>Виаитемтипеженератед</strong></a>— может присутствовать, если приложение создает элемент WIA во время сеанса сканирования нескольких элементов.</li>
</ul></td>
<td>Набор свойств включает свойства элемента управления "планшетный сканер" (обычно это набор свойств, связанных с изображениями и документами).</td>
<td>Планшетные элементы WIA, включая дочерние элементы, которые представляют регионы, сканируемые на планшете сканера Платен.</td>
</tr>
</tbody>
</table>



 

На следующем рисунке показан пример дерева элементов WIA и различных категорий, которые могут быть связаны с каждым элементом.

![Примеры категорий элементов для элементов в дереве](images/scannertree2.jpg)

## <a name="root-item"></a>Корневой элемент

Корневой элемент WIA — это элемент папки, помеченный флагами [**виаитемтиперут**](-wia-wia-item-type-flags.md) и **виаитемтипедевице** , который представляет само устройство. Он содержит такие атрибуты устройства, как изготовитель, имя устройства и атрибуты драйвера, такие как версия драйвера и идентификатор класса пользовательского интерфейса (CLSID). Приложения для работы с образами получают корневой элемент дерева элементов WIA путем вызова метода [**IWiaDevMgr2:: креатедевице**](-wia-iwiadevmgr2-createdevice.md) . Приложение использует корневой элемент для получения доступа к отдельным дочерним элементам WIA путем перечисления дерева (см. [**IEnumWiaItem2**](-wia-ienumwiaitem2.md)).

## <a name="data-item"></a>Data Item

Любой элемент, который можно использовать для перемещения данных, считается элементом данных. Сюда входят элементы, помеченные флагом [**виаитемтипепрограммабледатасаурце**](-wia-wia-item-type-flags.md) .

Элементы папок и элементы, не являющиеся элементами папки, могут предоставлять возможность передачи данных с помощью флага [**виаитемтипетрансфер**](-wia-wia-item-type-flags.md) . Любой элемент с установленным флагом должен предоставлять следующие свойства элемента WIA:

-   [**\_ \_ права доступа WIA \_ IPA**](-wia-wiaitempropcommonitem.md)
-   [**\_ \_ размер элемента IPA \_ WIA**](-wia-wiaitempropcommonitem.md)
-   [**\_ \_ Размер буфера IPA \_ WIA**](-wia-wiaitempropcommonitem.md)
-   [**\_формат IPA \_ WIA**](-wia-wiaitempropcommonitem.md)
-   [**\_ \_ предпочтительный формат IPA WIA \_**](-wia-wiaitempropcommonitem.md)
-   [**WIA \_ IPA \_ тимед**](-wia-wiaitempropcommonitem.md)
-   [**\_ \_ расширение файла WIA \_ IPA**](-wia-wiaitempropcommonitem.md)

Программируемые элементы источника данных, помеченные флагом [**виаитемтипетрансфер**](-wia-wia-item-type-flags.md) , также должны указывать набор свойств, требуемых для элемента данных.

Элементы данных WIA могут иметь дополнительные свойства в зависимости от настроек флага элемента. Например, элементы WIA, помеченные флагом [**виаитемтипеимаже**](-wia-wia-item-type-flags.md) , должны иметь свойства сведений, специфичные для изображения, такие как [**WIA \_ IPA \_ Depth**](-wia-wiaitempropcommonitem.md) и **WIA \_ IPA \_ число \_ \_ строк**.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

**Reference**
</dt> <dt>

[**IWiaItem2**](-wia-iwiaitem2.md)
</dt> <dt>

[**IEnumWiaItem2**](-wia-ienumwiaitem2.md)
</dt> <dt>

[**IWiaDevMgr2**](-wia-iwiadevmgr2.md)
</dt> </dl>

 

 



