---
description: интерфейс ивиаимажефилтер — это интерфейс расширения, реализованный разработчиками фильтра обработки изображений и вызываемый Windows получения изображений (WIA) 2,0.
ms.assetid: 2abe913b-bb2b-486d-a3f4-d5932433fc82
title: Интерфейс Ивиаимажефилтер (WIA. h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- IWiaImageFilter
api_type:
- COM
api_location:
- Wia.h
ms.openlocfilehash: d7c85a25d7478e0ad51a1d427e74b69a743bc4203ed57b8929a3e4ec856d94b9
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119813984"
---
# <a name="iwiaimagefilter-interface"></a>Интерфейс Ивиаимажефилтер

интерфейс **ивиаимажефилтер** — это интерфейс расширения, реализованный разработчиками фильтра обработки изображений и вызываемый Windows получения изображений (WIA) 2,0.

## <a name="members"></a>Элементы

Интерфейс **ивиаимажефилтер** наследует от интерфейса [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) . **Ивиаимажефилтер** также имеет следующие типы членов:

-   [Методы](#methods)

### <a name="methods"></a>Методы

Интерфейс **ивиаимажефилтер** содержит следующие методы.



| Метод                                                                | Описание                                                                                             |
|:----------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------|
| [**апплипропертиес**](-wia-iwiaimagefilter-applyproperties.md)       | Включает фильтр обработки изображений для записи свойств обратно в драйвер (и на устройство).<br/>     |
| [**филтерпревиевимаже**](-wia-iwiaimagefilter-filterpreviewimage.md) | Фильтрует изображение предварительного просмотра.<br/>                                                                   |
| [**инитиализефилтер**](-wia-iwiaimagefilter-initializefilter.md)     | Инициализирует фильтр. Вызывается WIA 2,0 до загрузки каждого изображения. <br/>                       |
| [**сетневкаллбакк**](-wia-iwiaimagefilter-setnewcallback.md)         | Задает новый обратный вызов приложения для фильтра обработки изображений, используемого для переадресации вызовов.<br/> |



 

## <a name="remarks"></a>Remarks

Разработчики фильтра обработки изображений должны реализовать этот интерфейс и интерфейс [**ивиатрансферкаллбакк**](-wia-iwiatransfercallback.md) .

WIA 2,0 вызывает методы фильтрации. Они никогда не вызываются напрямую из приложения.

Корпорация Майкрософт предоставляет компонент WIA 2,0 Preview, который кэширует исходный, нефильтрованный образ предварительного просмотра, полученный от сканера. Приложение использует [CoCreateInstance](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) для совместного создания экземпляра компонента WIA 2,0 Preview (CLSID \_ виапревиев), который загружает фильтр с помощью [**IWiaItem2:: Extension**](-wia-iwiaitem2-getextension.md). Фильтр вызывается автоматически при вызове приложением [**ивиатрансфер::D гружать**](-wia-iwiatransfer-download.md).

Фильтр обработки изображений всегда выполняется при сканировании изображения. Приложение не может получить изображение от сканера, не применяя сначала фильтр по образам.

Фильтр должен реализовывать как минимум яркость и контрастность. Обычный пользовательский интерфейс, предоставляющий пользователю элементы управления яркостью и контрастностью, может отображать точные предварительные версии для пользователя.

Фильтр обработки изображений никогда не должен изменять элемент *лмессаже* структуры [**виатрансферпарамс**](-wia-wiatransferparams.md) .

Для чтения обязательных свойств фильтр обработки изображений должен вызвать [**ивиапропертистораже:: жетпропертистреам**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiapropertystorage-getpropertystream) в интерфейсе [**ивиапропертистораже**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiapropertystorage) , который он получает из элемента, вызвав [ивиаимажефилтер:: QueryInterface](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)). Затем фильтр может создать экземпляр экземпляра [ипропертистораже](/windows/win32/api/propidlbase/nn-propidlbase-ipropertystorage) в этом потоке для чтения свойств элементов. Фильтр обработки изображений не должен вызывать [ивиапропертистораже:: реадмултипле](/windows/win32/api/propidlbase/nf-propidlbase-ipropertystorage-readmultiple) напрямую, так как этот метод вызывает драйвер `drvReadItemProperties` , но служба WIA 2,0 уже заблокировала драйвер в `drvAcquireItemData` вызове, поэтому этот вызов истечет и завершится сбоем.

Свойства, которые заинтересованы в фильтре, могут быть, например, параметрами яркости и контрастности. Фильтр, как правило, также должен считывать формат изображения, а также свойство Preview, [**\_ \_ предварительную версию WIA DPS**](-wia-wiaitempropscannerdevice.md), из *pWiaItem2*. Все эти свойства используются в процессе фильтрации.

Компоненты WIA 2,0 всегда записывают нефильтрованные данные в фильтр обработки изображений. Алгоритм обработки изображений, реализованный потоком фильтра, может фильтровать данные более одного раза и не должен беспокоиться о том, чтобы получить те же результаты, что и при фильтрации данных.

Фильтр должен обратить внимание на свойство [**\_ \_ предварительной версии WIA DP**](-wia-wiaitempropscannerdevice.md) , особенно если некоторые задачи, связанные с фильтрами, обрабатываются оборудованием. Например, определенный драйвер может изменить яркость лампы в оборудовании сканера в зависимости от того, как приложение установило яркость в элемент WIA 2,0. Во время окончательного сканирования (когда приложение вызывает [**ивиатрансфер::D гружать**](-wia-iwiatransfer-download.md)) драйвер обычно изменяет физическую лампу сканера. В этом случае фильтру обработки изображений может не потребоваться выполнять какую либо обработку яркости. Однако во время предварительной проверки драйвер не должен изменять яркость лампы — вместо этого следует позаботиться только о фильтре обработки изображений. Важно, чтобы компонент WIA 2,0 Preview и фильтр обработки изображений возвращали точные изображения на основе свойств, заданных в элементе.

Фильтр обработки изображений должен поддерживать все форматы изображений, поддерживаемые драйвером.

Фильтру обработки изображений всегда присваивается изображение, соответствующее области выбора, заданному для элемента, для которого выполняется получение изображения. Однако обратите внимание, что изображение может быть повернуто драйвером в том случае, если он поддерживает свойство [**\_ \_ вращения IP-адресов**](-wia-wiaitempropscanneritem.md) .

Фильтр обработки изображений создается с помощью [**IWiaItem2:: Extension**](-wia-iwiaitem2-getextension.md), обычно не приложением, но компонентами WIA 2,0, когда приложение вызывает [**Ивиапревиев:: жетневпревиев**](-wia-iwiapreview-getnewpreview.md) или [**ивиатрансфер::D гружать**](-wia-iwiatransfer-download.md).

Интерфейс **ивиаимажефилтер** , как и все интерфейсы модели компонентных объектов (com), наследует методы интерфейса [IUnknown](/windows/win32/api/unknwn/nn-unknwn-iunknown) .



| Методы IUnknown                                        | Описание                               |
|---------------------------------------------------------|-------------------------------------------|
| [IUnknown:: QueryInterface](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) | Возвращает указатели на поддерживаемые интерфейсы. |
| [IUnknown:: AddRef](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref)                 | Увеличивает значение счетчика ссылок.               |
| [IUnknown:: Release](/windows/win32/api/unknwn/nf-unknwn-iunknown-release)               | Уменьшает значение счетчика ссылок.               |



 

## <a name="requirements"></a>Requirements (Требования)



| Требование | Значение |
|-------------------------------------|------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows \[Только классические приложения Vista\]<br/>                                     |
| Минимальная версия сервера<br/> | Windows Только для \[ настольных приложений сервера 2008\]<br/>                               |
| Заголовок<br/>                   | <dl> <dt>WIA. h</dt> </dl>   |
| IDL<br/>                      | <dl> <dt>WIA. idl</dt> </dl> |



 

 
