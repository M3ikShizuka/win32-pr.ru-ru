---
description: При использовании интерфейса для получения изображений Windows (WIA) в нескольких потоках в рамках одного процесса приложение должно обеспечивать маршалинг для этого интерфейса.
ms.assetid: b125b36e-1428-4aa6-b367-eac78291c88e
title: Использование нескольких потоков в приложении WIA
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ebb1dbfa552e72dc068aff63a0a316d9af680ed1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104145361"
---
# <a name="using-multiple-threads-in-a-wia-application"></a>Использование нескольких потоков в приложении WIA

При использовании интерфейса для получения изображений Windows (WIA) в нескольких потоках в рамках одного процесса приложение должно обеспечивать маршалинг для этого интерфейса. Если один поток создает указатель интерфейса, нельзя использовать этот указатель в другом потоке без маршалирования.

Например, если один поток в приложении получает указатель на интерфейс [**ивиаитем**](/windows/desktop/api/wia_xp/nn-wia_xp-iwiaitem) или [**IWiaItem2**](-wia-iwiaitem2.md) , отдельный поток не может использовать этот указатель интерфейса без маршалирования.

Распространенной методикой, используемой для выполнения этого маршалинга, является использование глобальной таблицы интерфейса. Глобальная таблица интерфейса — это таблица, которая сохраняется во всех потоках в рамках одного процесса. Все потоки, выполняющиеся в процессе, могут извлекать интерфейсы, зарегистрированные в глобальной таблице интерфейса. Этот метод позволяет избежать необходимости создавать потоки для передачи интерфейсов между потоками.

Сведения об использовании глобальной таблицы интерфейса см. в разделе [иглобалинтерфацетабле](/windows/win32/api/objidl/nn-objidl-iglobalinterfacetable).

Даже если вы не планируете использовать несколько потоков в приложении WIA, необходимо предположить, что все функции обмена данными или обратного вызова событий устройства выполняются в отдельных потоках.

 

 
