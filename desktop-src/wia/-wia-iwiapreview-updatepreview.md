---
description: 'Возвращает нефильтрованное изображение, кэшированное методом Ивиапревиев:: Жетневпревиев.'
ms.assetid: 121b6866-cca1-4170-9bdf-225491f942f5
title: 'Метод Ивиапревиев:: Упдатепревиев (WIA. h)'
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- IWiaPreview.UpdatePreview
api_type:
- COM
api_location:
- Wia.h
ms.openlocfilehash: 4a5d469179f341f3bad5d2b9b5ed25a5715be694
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104145403"
---
# <a name="iwiapreviewupdatepreview-method"></a>Метод Ивиапревиев:: Упдатепревиев

Возвращает нефильтрованное изображение, кэшированное методом [**ивиапревиев:: жетневпревиев**](-wia-iwiapreview-getnewpreview.md) .

## <a name="syntax"></a>Синтаксис


```C++
HRESULT UpdatePreview(
  [in] LONG      lOptions,
  [in] IWiaItem2 *pChildWiaItem
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*лоптионс* \[ окне\]
</dt> <dd>

Тип: **Long**

Указывает, требует ли приложение компонент предварительной версии WIA 2,0 для передачи подобласти кэшированного изображения или всего кэшированного изображения в фильтр обработки изображений.

<dt>

<span id="WiaPreviewReturnOriginalImage"></span><span id="wiapreviewreturnoriginalimage"></span><span id="WIAPREVIEWRETURNORIGINALIMAGE"></span>

<span id="WiaPreviewReturnOriginalImage"></span><span id="wiapreviewreturnoriginalimage"></span><span id="WIAPREVIEWRETURNORIGINALIMAGE"></span>**виапревиевретурноригиналимаже**


</dt> <dd>

Передайте весь кэшированный образ в фильтр обработки изображений.

</dd> </dl> </dd> <dt>

*пчилдвиаитем* \[ окне\]
</dt> <dd>

Тип: **[**IWiaItem2**](-wia-iwiaitem2.md) \** _

Задает указатель на элемент [_ *IWiaItem2* *](-wia-iwiaitem2.md) , который является дочерним элементом элемента **IWiaItem2** , указанного параметром *pWiaItem2* метода [**ивиапревиев:: жетневпревиев**](-wia-iwiapreview-getnewpreview.md) . Или, если приложению требуется предварительная версия всего планшета, указывает указатель на параметр *pWiaItem2* метода **Ивиапревиев:: жетневпревиев** . Если *пчилдвиаитем* является дочерним параметром **Ивиапревиев:: жетневпревиев** *pWiaItem2* , этот дочерний элемент обычно создается фильтром сегментации.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Тип: **HRESULT**

Если этот метод завершается успешно, возвращается значение **S \_ ОК**. В противном случае возвращается код ошибки **HRESULT** .

## <a name="remarks"></a>Комментарии

Этот метод передает кэшированное нефильтрованное изображение с помощью фильтра обработки изображений, который затем записывает отфильтрованные данные в поток, предоставленный приложением. Компонент WIA 2,0 Preview извлекает этот поток, вызывая метод [**жетнекстстреам**](-wia-iwiatransfercallback-getnextstream.md) фильтра обработки изображений, который затем вызывает реализацию **жетнекстстреам** обратного вызова приложения. Перед вызовом **ивиапревиев:: упдатепревиев** приложение должно сначала вызвать [**Ивиапревиев:: жетневпревиев**](-wia-iwiapreview-getnewpreview.md) , чтобы получить изображение из сканера. в противном случае метод возвращает ошибку.

Компонент WIA 2,0 Preview хранит нефильтрованное изображение, загруженное из драйвера. Возможно, элемент WIA 2,0, переданный в **ивиапревиев:: упдатепревиев** , представляет только небольшой регион изображения, скачанного из драйвера. Если это так, компонент предварительной версии WIA 2,0 фактически вырезает этот регион из кэшированного образа, прежде чем передать его в фильтр обработки изображений, который, в свою очередь, передает данные отфильтрованного изображения обратно в приложение.

Чтобы приложение передавало весь кэшированный образ в фильтр обработки изображений (который, в свою очередь, передает его в приложение), он должен установить для *лоптионс* значение **виапревиевретурноригиналимаже** при вызове **ивиапревиев:: упдатепревиев**. При установке *лоптионс* в **виапревиевретурноригиналимаже** приложение должно гарантировать, что параметры экстента ([**WIA- \_ адреса \_ ксекстент**](-wia-wiaitempropscanneritem.md) и **WIA-пакетов \_ \_ екстент**) элемента, переданного в **ивиапревиев:: упдатепревиев** , соответствует полному кэшированному изображению. В этом случае фильтр обработки изображений не должен выполнять никаких других действий. Он просто фильтрует изображение на основе свойств *пчилдвиаитем* (обычно в данном случае *пчилдвиаитем* — тот же элемент, который был передан в [**ивиапревиев:: жетневпревиев**](-wia-iwiapreview-getnewpreview.md)). Разные подобласти игнорируются, и весь образ фильтруется с использованием одних и тех же параметров. Существует несколько причин, по которым приложение сделает это.

1.  Приложение может не поддерживать изменение параметров (таких как [**\_ \_ яркость IP-адресов**](-wia-wiaitempropscanneritem.md) и **\_ \_ контрастные IP-адреса**) по отдельности для каждого региона, который обнаруживает фильтр сегментации (или может даже не использовать фильтр сегментации). Приложению проще вызывать **ивиапревиев:: упдатепревиев** с **виапревиевретурноригиналимаже** , чтобы он всегда получал полный образ из компонента предварительной версии WIA 2,0.
2.  Компонент предварительной версии WIA 2,0 не поддерживает формат изображения для предварительного просмотра изображения. в этом случае невозможно выполнить действия для вырезания нужного региона. Формат изображения компонента WIA 2,0 Preview ограничен форматами, для которых существуют кодировщики и декодеры Windows GDI+ 1,1. Эти форматы являются точечными рисунками (BMP) (точечный рисунок, включающий БИТМАПФИЛЕХЕАДЕР), формат GIF, JPEG, PNG и формат файла изображения с тегами (TIFF).

Обратите внимание, что если приложение передает **виапревиевретурноригиналимаже** в **Ивиапревиев:: УПДАТЕПРЕВИЕВ**, компонент WIA 2,0 Preview может поддерживать любое изображение или формат пикселей.

**Ивиапревиев:: упдатепревиев** задает свойство [**\_ \_ предварительной версии WIA DPS**](-wia-wiaitempropscannerdevice.md) (и сбрасывает его перед возвратом, если оно не было задано ранее). Это позволяет драйверу (и оборудованию), а также фильтру обработки изображений, известно, что элемент является предварительной проверкой.

Приложение должно гарантировать, что *пчилдвиаитем* имеет тот же формат изображения ([**\_ \_ Формат WIA IPA**](-wia-wiaitempropcommonitem.md)) и разрешение (с помощью пакетов [**WIA \_ \_ ксрес**](-wia-wiaitempropscanneritem.md) и **WIA- \_ адресов \_ ирес**), так как *пвиаитем* был передан в [**ивиапревиев:: жетневпревиев**](-wia-iwiapreview-getnewpreview.md). Формат дочернего элемента должен соответствовать формату кэшированного образа компонента WIA 2,0 Preview (компонент WIA 2,0 Preview не выполняет преобразование изображения).

## <a name="examples"></a>Примеры

Упдатерегион должен вызываться каждый раз, когда пользователь изменяет, например, яркость или контраст для дочернего элемента, представленного `dwRegionNumber` . Этот дочерний элемент ранее был создан фильтром сегментации ([**ивиасегментатионфилтер**](-wia-iwiasegmentationfilter.md). Образ, записанный в [IStream](/windows/win32/api/objidl/nn-objidl-istream) , возвращается методом [**жетнекстстреам**](-wia-iwiatransfercallback-getnextstream.md) интерфейса обратного вызова. В этом примере код для Жетсубрегионитем опущен.

После вызова этой функции приложение обычно перерисовывает область на экране.


```C++
HRESULT
UpdateRegion(
   IN  DWORD dwRegionNumber)
{
   IWiaItem2 *pSubRegion = GetSubRegionItem(dwRegionNumber);

   return m_pWiaPreview->UpdatePreview(0,pSubRegion);
}
```



## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Только для \[ классических приложений Windows Vista\]<br/>                                     |
| Минимальная версия сервера<br/> | \[Только для настольных приложений Windows Server 2008\]<br/>                               |
| Header<br/>                   | <dl> <dt>WIA. h</dt> </dl>   |
| IDL<br/>                      | <dl> <dt>WIA. idl</dt> </dl> |



 

 
