---
description: Когда поток активно взаимодействует с устройством для получения изображений (WIA) (например, передача данных или запись свойств устройства) WIA &\# 0034; locks&\# 0034; устройство.
ms.assetid: 59533937-284a-4732-a73b-d2e0b5a9a370
title: Взаимодействие с устройством WIA в нескольких потоках или приложениях
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1a7a4b518093c3a0fc09534d67e22e5349d44d09
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104264534"
---
# <a name="communicating-with-a-wia-device-in-multiple-threads-or-applications"></a>Взаимодействие с устройством WIA в нескольких потоках или приложениях

Когда поток активно взаимодействует с устройством для получения изображений (WIA) (например, передача данных или запись свойств устройства), WIA блокирует устройство. Если устройство заблокировано, другие потоки или процессы не могут активно взаимодействовать с этим устройством.

WIA не запрещает нескольким потокам или процессам поддерживать соединения с одним устройством. Это значит, что устройство блокируется только во время фактического взаимодействия, и в двух или нескольких приложениях одновременно может быть выбрано одно устройство.

WIA создает отдельное дерево элементов каждый раз, когда любой поток или приложение вызывает [**ивиадевмгр:: креатедевице**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadevmgr-createdevice) или [**IWiaDevMgr2:: креатедевице**](-wia-iwiadevmgr2-createdevice.md) для создания экземпляра этого устройства. WIA поддерживает отдельные сведения о состоянии для каждого дерева элементов. Например, если поток создает два экземпляра определенного сканера, он может задать различные разрешения сканирования для двух экземпляров. Когда метод [**ивиадататрансфер:: идтжетдата**](/windows/desktop/api/wia_xp/nf-wia_xp-iwiadatatransfer-idtgetdata) вызывается для конкретного экземпляра, WIA загружает свойства, связанные с этим экземпляром, на устройство, прежде чем будет выполняться фактическое сканирование. Это не влияет на состояние другого экземпляра устройства.

Если в потоке в настоящий момент устройство заблокировано (активно взаимодействует с этим устройством), а другой поток пытается вызвать метод, который активно взаимодействует с устройством, метод возвращает ошибку, \_ которая \_ занята WIA-ошибкой.

Как правило, чтение и запись свойств устройств занимает немного времени, что эти операции редко вызывают конфликт. Однако передача данных обычно занимает больше времени и, следовательно, скорее всего, создает конфликты доступа к устройствам. Это программирование позволяет избежать длительных операций с устройствами (передачи данных) в отдельных потоках в приложении.

Приложение никогда не должно считать, что это единственное приложение, взаимодействующее с устройством WIA при запуске.

 

 



