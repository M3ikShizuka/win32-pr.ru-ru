---
description: 'Метод IWiaDevMgr2:: Регистеревенткаллбаккпрограм регистрирует приложение для получения событий устройства. В основном он предоставляется для обеспечения обратной совместимости с приложениями, которые не были написаны для получения образа Windows (WIA) 2,0.'
ms.assetid: 6b427f19-719b-44ce-8e2c-3c44672345c8
title: 'Метод IWiaDevMgr2:: Регистеревенткаллбаккпрограм (WIA. h)'
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- IWiaDevMgr2.RegisterEventCallbackProgram
api_type:
- COM
api_location:
- Wia.h
ms.openlocfilehash: 9b18b5833b7616493c24f0128caa7c910b685e37
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105719368"
---
# <a name="iwiadevmgr2registereventcallbackprogram-method"></a>Метод IWiaDevMgr2:: Регистеревенткаллбаккпрограм

Метод **IWiaDevMgr2:: регистеревенткаллбаккпрограм** регистрирует приложение для получения событий устройства. В основном он предоставляется для обеспечения обратной совместимости с приложениями, которые не были написаны для получения образа Windows (WIA) 2,0.

## <a name="syntax"></a>Синтаксис


```C++
HRESULT RegisterEventCallbackProgram(
  [in]       LONG lFlags,
  [in]       BSTR bstrDeviceID,
  [in] const GUID *pEventGUID,
  [in]       BSTR bstrFullAppName,
  [in]       BSTR bstrCommandlineArg,
  [in]       BSTR bstrName,
  [in]       BSTR bstrDescription,
  [in]       BSTR bstrIcon
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*лфлагс* \[ окне\]
</dt> <dd>

Тип: **Long**

Флаги регистрации. Можно задать следующие значения.



| Значение                                                                                                                                                                                                           | Значение                                                      |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------|
| <span id="WIA_REGISTER_EVENT_CALLBACK"></span><span id="wia_register_event_callback"></span><dl> <dt>**\_ \_ обратный вызов события регистрации WIA \_**</dt> </dl>       | Зарегистрируйтесь для события.<br/>                           |
| <span id="WIA_UNREGISTER_EVENT_CALLBACK"></span><span id="wia_unregister_event_callback"></span><dl> <dt>**\_обратный вызов для отмены регистрации \_ события WIA \_**</dt> </dl> | Удалите регистрацию для события.<br/>            |
| <span id="WIA_SET_DEFAULT_HANDLER"></span><span id="wia_set_default_handler"></span><dl> <dt>**\_ \_ обработчик по умолчанию для WIA Set \_**</dt> </dl>                   | Задайте приложение в качестве обработчика событий по умолчанию.<br/> |



 

</dd> <dt>

*бстрдевицеид* \[ окне\]
</dt> <dd>

Тип: **BSTR**

Идентификатор устройства. Передайте **значение NULL** , чтобы зарегистрировать событие на всех устройствах WIA 2,0.

</dd> <dt>

*певентгуид* \[ окне\]
</dt> <dd>

Тип: **константа \* GUID* _

Событие, для которого регистрируется приложение. Список допустимых идентификаторов GUID событий см. в разделе [идентификаторы событий WIA](-wia-wia-event-identifiers.md).

</dd> <dt>

_bstrFullAppName * \[ в\]
</dt> <dd>

Тип: **BSTR**

Полное имя пути приложения.

</dd> <dt>

*бстркоммандлинеарг* \[ окне\]
</dt> <dd>

Тип: **BSTR**

Соответствующие аргументы командной строки для приложения.

</dd> <dt>

*bstrName* \[ окне\]
</dt> <dd>

Тип: **BSTR**

Имя приложения. Имя отображается пользователю, когда несколько приложений регистрируются для одного и того же события.

</dd> <dt>

*bstrDescription* \[ окне\]
</dt> <dd>

Тип: **BSTR**

Описание приложения. Описание отображается пользователю, когда несколько приложений регистрируются для одного и того же события.

</dd> <dt>

*бстрикон* \[ окне\]
</dt> <dd>

Тип: **BSTR**

Значок, представляющий приложение. Этот значок отображается пользователю, когда несколько приложений регистрируются для одного и того же события. Строка содержит имя приложения и Отсчитываемый от нуля индекс значка, разделенный запятыми, например MyApp, 0. Может быть несколько значков, представляющих приложение.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Тип: **HRESULT**

Если этот метод завершается успешно, возвращается значение **S \_ ОК**. В противном случае возвращается код ошибки **HRESULT** .

## <a name="remarks"></a>Комментарии

Используйте **IWiaDevMgr2:: регистеревенткаллбаккпрограм** для регистрации событий аппаратного устройства. При возникновении события, для которого зарегистрировано приложение, запускается приложение, а сведения о событии передаются в приложение.

Используйте метод [**енумрегистеревентинфо**](-wia-iwiaitem2-enumregistereventinfo.md) для получения указателя на объект перечислителя для свойств регистрации событий.

Используйте метод **IWiaDevMgr2:: регистеревенткаллбаккпрограм** для обеспечения обратной совместимости с приложениями, не написанными для архитектуры WIA 2,0. Используйте интерфейсы модели COM, предоставляемые архитектурой WIA 2,0 для новых приложений. В частности, вызовите [**IWiaDevMgr2:: регистеревенткаллбаккинтерфаце**](-wia-iwiadevmgr2-registereventcallbackinterface.md) или [**IWiaDevMgr2:: регистеревенткаллбаккклсид**](-wia-iwiadevmgr2-registereventcallbackclsid.md) , чтобы зарегистрировать новое приложение для событий устройства.

Как правило, этот метод вызывается программой установки или сценарием. Программа установки или сценарий регистрирует приложение для получения событий устройства WIA 2,0. Когда происходит это событие, приложение запускается с помощью системы времени выполнения WIA 2,0.

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|----------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Только для \[ классических приложений Windows Vista\]<br/>                                   |
| Минимальная версия сервера<br/> | \[Только для настольных приложений Windows Server 2008\]<br/>                             |
| Header<br/>                   | <dl> <dt>WIA. h</dt> </dl> |



 

 




