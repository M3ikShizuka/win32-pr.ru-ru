---
description: Потоки планируются для запуска на основе их приоритета планирования.
ms.assetid: 8710cd56-6bf3-4317-a1f6-1a159394ce2a
title: Приоритеты планирования
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 359f86e6ef78ffe1e549045eebbe435674b50f25f25bd30598fce8581c06092a
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "117793316"
---
# <a name="scheduling-priorities"></a>Приоритеты планирования

Потоки планируются для запуска на основе их *приоритета планирования*. Каждому потоку назначается приоритет планирования. Уровни приоритета находятся в диапазоне от нуля (самый низкий приоритет) до 31 (наивысший приоритет). Только поток нулевой страницы может иметь приоритет, равный нулю. (Поток нулевой страницы — это системный поток, ответственный за обнуление свободных страниц при отсутствии других потоков, которые необходимо выполнить.)

Система рассматривает все потоки с одинаковым приоритетом, равным. Система назначает временные срезы циклическим перебору для всех потоков с наивысшим приоритетом. Если ни один из этих потоков не готов к выполнению, система назначает временные срезы циклическим перебору для всех потоков со следующим высшим приоритетом. Если поток с более высоким приоритетом станет доступным для выполнения, система прекратит выполнение потока с низким приоритетом (не позволяя ему завершить работу с его временным срезом) и назначает полный временной срез для потока с более высоким приоритетом. Дополнительные сведения см. в разделе [контекстные переключения](context-switches.md).

Приоритет каждого потока определяется следующими критериями.

-   Класс приоритета его процесса
-   Уровень приоритета потока в классе приоритета его процесса

Класс приоритета и уровень приоритета объединяются для формирования *базового приоритета* потока. Сведения о динамическом приоритете потока см. в разделе [повышение приоритета](priority-boosts.md).

## <a name="priority-class"></a>Класс Priority

Каждый процесс принадлежит одному из следующих классов приоритета:<dl> \_класс приоритета простоя \_  
НИЖЕ \_ обычного \_ класса приоритета \_  
\_класс обычного приоритета \_  
ВЫШЕ \_ класса с нормальным \_ приоритетом \_  
класс с высоким \_ приоритетом \_  
\_класс приоритета в режиме реального времени \_  
</dl>

По умолчанию класс приоритета процесса — это класс с НОРМАЛЬным \_ приоритетом \_ . Используйте функцию [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) , чтобы указать класс приоритета дочернего процесса при его создании. Если вызывающий процесс является \_ классом приоритета простоя \_ или ниже \_ обычного \_ класса приоритета \_ , новый процесс будет наследовать этот класс. Используйте функцию [**жетприоритикласс**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getpriorityclass) для определения текущего класса приоритета процесса и функции [**сетприоритикласс**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-setpriorityclass) , чтобы изменить класс приоритета процесса.

Процессы, выполняющие мониторинг системы, такие как экранные заставки или приложения, которые периодически обновляют отображение, должны использовать \_ класс приоритета простоя \_ . Это препятствует потокам этого процесса, которые не имеют высокого приоритета, от влияния на потоки с более высоким приоритетом.

Используйте \_ класс с высоким приоритетом \_ с осторожностью. Если поток выполняется с наивысшим приоритетом для расширенных периодов, другие потоки в системе не будут получать процессорное время. Если несколько потоков одновременно устанавливаются с высоким приоритетом, потоки теряют свои эффективность. Класс с высоким приоритетом должен быть зарезервирован для потоков, которые должны отвечать на критические по времени события. Если приложение выполняет одну задачу, для которой требуется класс с высоким приоритетом, в то время как остальные задачи имеют нормальный приоритет, используйте [**сетприоритикласс**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-setpriorityclass) , чтобы временно вызвать класс приоритета приложения. затем сократите его после завершения задачи, критичной по времени. Другая стратегия состоит в том, чтобы создать высокоприоритетный процесс, в большинстве случаев блокирующий все его потоки, выводят потоки только при необходимости выполнения критических задач. Важно отметить, что поток с высоким приоритетом должен выполняться в течение короткого промежутка времени и только тогда, когда он имеет критическую для выполнения работу.

Почти никогда не следует использовать \_ класс приоритета реального времени \_ , так как это прерывает системные потоки, управляющие вводом мыши, вводом с клавиатуры и фоновым сбросом дисков. Этот класс может быть пригоден для приложений, которые «говорите» непосредственно на оборудование или выполняют короткие задачи, которые должны иметь ограниченные перерывы.

## <a name="priority-level"></a>Уровень приоритета

Ниже приведены уровни приоритета в каждом классе приоритета.<dl> приоритет потока — \_ \_ бездействие  
\_ \_ самый низкий приоритет потока  
\_приоритет потока \_ ниже \_ обычного  
приоритет потока — \_ \_ нормальный  
\_приоритет потока \_ выше \_ обычного  
приоритет потока — \_ \_ самый высокий  
\_ \_ критическое время ПРИОРИТЕТа потока \_  
</dl>

Все потоки создаются с использованием \_ обычного приоритета потока \_ . Это означает, что приоритет потока аналогичен классу приоритета процесса. После создания потока используйте функцию [**сетсреадприорити**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-setthreadpriority) , чтобы изменить ее приоритет относительно других потоков в процессе.

Типичной стратегией является использование \_ приоритета потока \_ выше \_ обычного или \_ приоритета потока \_ для входного потока процесса, чтобы обеспечить реагирование приложения на запросы пользователя. Фоновым потокам, в частности, которые являются ресурсоемкими, можно задать \_ приоритет потока \_ ниже \_ обычного или \_ приоритета потока \_ , чтобы гарантировать, что при необходимости они могут быть вытеснены. Однако при наличии потока, ожидающего другого потока с более низким приоритетом для выполнения некоторой задачи, не забудьте заблокировать выполнение ожидающего потока с высоким приоритетом. Для этого используйте [функцию Wait](../sync/wait-functions.md), [критическую секцию](../sync/critical-section-objects.md)или функцию [**Sleep**](/windows/win32/api/synchapi/nf-synchapi-sleep) , [**слипекс**](/windows/win32/api/synchapi/nf-synchapi-sleepex)или [**свитчтосреад**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-switchtothread) . Это предпочтительнее, чтобы поток выполнял цикл. В противном случае процесс может привести к взаимоблокировке, так как не запланировано выполнение потока с более низким приоритетом.

Чтобы определить текущий уровень приоритета потока, используйте функцию [**жетсреадприорити**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getthreadpriority) .

## <a name="base-priority"></a>Базовый приоритет

Класс приоритета процесса и уровень приоритета потока объединяются для формирования базового приоритета каждого потока.

В следующей таблице показан базовый приоритет для сочетания класса приоритета процесса и значения приоритета потока.


<table>
<tr>
<th colspan="2">Класс приоритета процесса</th>
<th>Уровень приоритета потока</th>
<th>Базовый приоритет</th>
</tr>
<tr>
<td rowspan="7" colspan="2">IDLE_PRIORITY_CLASS </td>
<td>THREAD_PRIORITY_IDLE</td>
<td>1</td>
</tr>
<tr>
<td>THREAD_PRIORITY_LOWEST</td>
<td>2</td>
</tr>
<tr>
<td>THREAD_PRIORITY_BELOW_NORMAL</td>
<td>3</td>
</tr>
<tr>
<td>THREAD_PRIORITY_NORMAL</td>
<td>4</td>
</tr>
<tr>
<td>THREAD_PRIORITY_ABOVE_NORMAL</td>
<td>5</td>
</tr>
<tr>
<td>THREAD_PRIORITY_HIGHEST</td>
<td>6</td>
</tr>
<tr>
<td>THREAD_PRIORITY_TIME_CRITICAL</td>
<td>15</td>
</tr>
<tr>
<td rowspan="7" colspan="2">BELOW_NORMAL_PRIORITY_CLASS </td>
<td>THREAD_PRIORITY_IDLE</td>
<td>1</td>
</tr>
<tr>
<td>THREAD_PRIORITY_LOWEST</td>
<td>4</td>
</tr>
<tr>
<td>THREAD_PRIORITY_BELOW_NORMAL</td>
<td>5</td>
</tr>
<tr>
<td>THREAD_PRIORITY_NORMAL</td>
<td>6</td>
</tr>
<tr>
<td>THREAD_PRIORITY_ABOVE_NORMAL</td>
<td>7</td>
</tr>
<tr>
<td>THREAD_PRIORITY_HIGHEST</td>
<td>8</td>
</tr>
<tr>
<td>THREAD_PRIORITY_TIME_CRITICAL</td>
<td>15</td>
</tr>
<tr>
<td rowspan="7" colspan="2">NORMAL_PRIORITY_CLASS </td>
<td>THREAD_PRIORITY_IDLE</td>
<td>1</td>
</tr>
<tr>
<td>THREAD_PRIORITY_LOWEST</td>
<td>6</td>
</tr>
<tr>
<td>THREAD_PRIORITY_BELOW_NORMAL</td>
<td>7</td>
</tr>
<tr>
<td>THREAD_PRIORITY_NORMAL</td>
<td>8</td>
</tr>
<tr>
<td>THREAD_PRIORITY_ABOVE_NORMAL</td>
<td>9</td>
</tr>
<tr>
<td>THREAD_PRIORITY_HIGHEST</td>
<td>10</td>
</tr>
<tr>
<td>THREAD_PRIORITY_TIME_CRITICAL</td>
<td>15</td>
</tr>
<tr>
<td rowspan="7" colspan="2">ABOVE_NORMAL_PRIORITY_CLASS </td>
<td>THREAD_PRIORITY_IDLE</td>
<td>1</td>
</tr>
<tr>
<td>THREAD_PRIORITY_LOWEST</td>
<td>8</td>
</tr>
<tr>
<td>THREAD_PRIORITY_BELOW_NORMAL</td>
<td>9</td>
</tr>
<tr>
<td>THREAD_PRIORITY_NORMAL</td>
<td>10</td>
</tr>
<tr>
<td>THREAD_PRIORITY_ABOVE_NORMAL</td>
<td>11</td>
</tr>
<tr>
<td>THREAD_PRIORITY_HIGHEST</td>
<td>12</td>
</tr>
<tr>
<td>THREAD_PRIORITY_TIME_CRITICAL</td>
<td>15</td>
</tr>
<tr>
<td rowspan="7" colspan="2">HIGH_PRIORITY_CLASS </td>
<td>THREAD_PRIORITY_IDLE</td>
<td>1</td>
</tr>
<tr>
<td>THREAD_PRIORITY_LOWEST</td>
<td>11</td>
</tr>
<tr>
<td>THREAD_PRIORITY_BELOW_NORMAL</td>
<td>12</td>
</tr>
<tr>
<td>THREAD_PRIORITY_NORMAL</td>
<td>13</td>
</tr>
<tr>
<td>THREAD_PRIORITY_ABOVE_NORMAL</td>
<td>14</td>
</tr>
<tr>
<td>THREAD_PRIORITY_HIGHEST</td>
<td>15</td>
</tr>
<tr>
<td>THREAD_PRIORITY_TIME_CRITICAL</td>
<td>15</td>
</tr>
<tr>
<td rowspan="7" colspan="2">REALTIME_PRIORITY_CLASS </td>
<td>THREAD_PRIORITY_IDLE</td>
<td>16</td>
</tr>
<tr>
<td>THREAD_PRIORITY_LOWEST</td>
<td>22</td>
</tr>
<tr>
<td>THREAD_PRIORITY_BELOW_NORMAL</td>
<td>23</td>
</tr>
<tr>
<td>THREAD_PRIORITY_NORMAL</td>
<td>24</td>
</tr>
<tr>
<td>THREAD_PRIORITY_ABOVE_NORMAL</td>
<td>25</td>
</tr>
<tr>
<td>THREAD_PRIORITY_HIGHEST</td>
<td>26</td>
</tr>
<tr>
<td>THREAD_PRIORITY_TIME_CRITICAL</td>
<td>31</td>
</tr>
</table>

 

 

 
