---
description: Модель безопасности Microsoft Windows позволяет управлять доступом к объектам процесса. Дополнительные сведения о безопасности см. в разделе Модель Access-Control.
ms.assetid: 508a17c4-88cd-431a-a102-00180a7f7ab5
title: Безопасность процессов и права доступа
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 93a5fb29599c5a769b9a7b63d653d24ec543e408
ms.sourcegitcommit: b01ad017c152c6756f3638623fe335877644d414
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/06/2021
ms.locfileid: "111549976"
---
# <a name="process-security-and-access-rights"></a>Безопасность процессов и права доступа

Модель безопасности Microsoft Windows позволяет управлять доступом к объектам процесса. Дополнительные сведения о безопасности см. в разделе [модель управления доступом](../secauthz/access-control-model.md).

Когда пользователь входит в систему, система собирает набор данных, которые уникально идентифицируют пользователя в процессе проверки подлинности, и сохраняет его в [маркере доступа](../secauthz/access-tokens.md). Этот маркер доступа описывает контекст безопасности всех процессов, связанных с пользователем. Контекст безопасности процесса — это набор учетных данных, предоставленных процессу или учетной записи пользователя, создавшего процесс.

Токен можно использовать для указания текущего контекста безопасности процесса с помощью функции [**креатепроцессвистокенв**](/windows/desktop/api/WinBase/nf-winbase-createprocesswithtokenw) . При вызове функции [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa), [**параметр CreateProcessAsUser**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessasusera)или [**креатепроцессвислогонв**](/windows/desktop/api/WinBase/nf-winbase-createprocesswithlogonw) можно указать [дескриптор безопасности](../secauthz/security-descriptors.md) для процесса. При указании **значения NULL** процесс получает дескриптор безопасности по умолчанию. Списки ACL в дескрипторе безопасности по умолчанию для процесса берутся из основного маркера или токена олицетворения создателя.

Чтобы получить дескриптор безопасности процесса, вызовите функцию [**жетсекуритинфо**](/windows/win32/api/aclapi/nf-aclapi-getsecurityinfo) . Чтобы изменить дескриптор безопасности процесса, вызовите функцию [**сетсекуритинфо**](/windows/win32/api/aclapi/nf-aclapi-setsecurityinfo) .

Допустимые права доступа для объектов процессов включают [стандартные права доступа](../secauthz/standard-access-rights.md) и некоторые права доступа, зависящие от процесса. В следующей таблице перечислены стандартные права доступа, используемые всеми объектами.

| Значение                           | Значение                                                                                                                                                                                                                                                                                  |
|---------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Delete** (0x00010000L)        | Требуется для удаления объекта.                                                                                                                                                                                                                                                           |
| **Чтение \_ Элемент управления** (0x00020000L) | Требуется для чтения сведений в дескрипторе безопасности объекта, не включая сведения из списка SACL. Для чтения или записи списка SACL необходимо запросить право доступа к **\_ системе \_ безопасности системы доступа** . Дополнительные сведения см. в статье [право доступа к SACL](../secauthz/sacl-access-right.md). |
| **Синхронизация** (0x00100000L)   | Право на использование данного объекта для синхронизации. Это позволяет потоку ожидать, пока объект находится в сигнальном состоянии.                                                                                                                                                                |
| **Запись \_ DAC** (0x00040000L)    | Требуется для изменения списка DACL в дескрипторе безопасности объекта.                                                                                                                                                                                                                   |
| **Запись \_ Владелец** (0x00080000L)  | Требуется для изменения владельца в дескрипторе безопасности объекта.                                                                                                                                                                                                                  |



 

В следующей таблице перечислены права доступа, зависящие от процесса.



| Значение                                             | Значение                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|---------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Обработка \_ всех \_ обращений**                          | Все возможные права доступа для объекта процесса. **Windows Server 2003 и Windows XP:** Размер флага " **обрабатывать \_ все \_ доступ** " увеличился в Windows Server 2008 и Windows Vista. Если приложение, скомпилированное для Windows Server 2008 и Windows Vista, работает под управлением Windows Server 2003 или Windows XP, флаг " **обрабатывать \_ все \_ права доступа** " слишком велик и функция, указывающая этот флаг, завершается с **ошибкой \_ \_ отказа в доступе**. Чтобы избежать этой проблемы, укажите минимальный набор прав доступа, необходимых для операции. Если требуется использовать **\_ весь \_ доступ** , задайте для \_ Win32 \_ WinNT минимальную операционную систему, для которой предназначено приложение (например, `#define _WIN32_WINNT _WIN32_WINNT_WINXP` ). Дополнительные сведения см. [в разделе Использование заголовков Windows](../winprog/using-the-windows-headers.md). <br/> |
| **Обработка \_ Создание \_ процесса** (0x0080)             | Требуется для создания процесса.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **Обработка \_ Создание \_ потока** (0x0002)              | Требуется для создания потока.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| **Обработка \_ \_Обработчик DUP** (0x0040)                 | Требуется для дублирования маркера с помощью [**дупликатехандле**](/windows/win32/api/handleapi/nf-handleapi-duplicatehandle).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **Обработка \_ \_Сведения о запросе** (0x0400)          | Требуется для получения определенных сведений о процессе, таких как его маркер, код выхода и класс приоритета (см. [**OpenProcessToken**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-openprocesstoken)).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **Обработка \_ ЗАПРОС \_ ограниченных \_ данных** (0x1000) | Требуется для получения определенных сведений о процессе (см. раздел [**жетекситкодепроцесс**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getexitcodeprocess), [**жетприоритикласс**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getpriorityclass), [**испроцессинжоб**](/windows/win32/api/jobapi/nf-jobapi-isprocessinjob), [**куерифуллпроцессимаженаме**](/windows/desktop/api/WinBase/nf-winbase-queryfullprocessimagenamea)). Для маркера, имеющего право доступа к **\_ \_ информации о запросах на обработку** , автоматически предоставляются **\_ \_ ограниченные \_ сведения о запросе**.**Windows Server 2003 и Windows XP:** это право доступа не поддерживается.<br/>                                                                                                                                                                                                                                                                                                                         |
| **Обработка \_ ЗАДАТЬ \_ сведения** (0x0200)            | Требуется для задания определенных сведений о процессе, например о его классе приоритета (см. [**сетприоритикласс**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-setpriorityclass)).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **Обработка \_ ЗАДАТЬ \_ квоту** (0x0100)                  | Требуется для установки ограничений памяти с помощью [**сетпроцессворкингсетсизе**](/windows/desktop/api/memoryapi/nf-memoryapi-setprocessworkingsetsize).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **Обработка \_ Приостановить \_ возобновление** (0x0800)             | Требуется для приостановки или возобновления процесса.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| **Обработка \_ ЗАВЕРШЕНИЕ** (0x0001)                   | Требуется для завершения процесса с помощью [**терминатепроцесс**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-terminateprocess).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| **Обработка \_ \_Операция виртуальной машины** (0x0008)               | Требуется для выполнения операции с адресным пространством процесса (см. раздел [**виртуалпротектекс**](/windows/win32/api/memoryapi/nf-memoryapi-virtualprotectex) and [**вритепроцессмемори**](/windows/win32/api/memoryapi/nf-memoryapi-writeprocessmemory)).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **Обработка \_ \_Чтение виртуальной машины** (0x0010)                    | Требуется для чтения памяти в процессе с помощью [**реадпроцессмемори**](/windows/win32/api/memoryapi/nf-memoryapi-readprocessmemory).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| **Обработка \_ \_Запись виртуальной машины** (0x0020)                   | Требуется для записи в память в процессе с помощью [**вритепроцессмемори**](/windows/win32/api/memoryapi/nf-memoryapi-writeprocessmemory).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| **Синхронизация** (0x00100000L)                     | Требуется для ожидания завершения процесса с помощью [функций Wait](../sync/wait-functions.md).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |



 

Чтобы открыть обработчик для другого процесса и получить права полного доступа, необходимо включить привилегию **SeDebugPrivilege** . Дополнительные сведения см. [в разделе изменение привилегий в токене](../secbp/changing-privileges-in-a-token.md).

Маркер, возвращаемый функцией [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) , **обрабатывает \_ все \_** доступ к объекту процесса. При вызове функции [**OpenProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-openprocess) система проверяет запрошенные [права доступа](../secauthz/access-rights-and-access-masks.md) к DACL в дескрипторе безопасности процесса. При вызове функции [**жеткуррентпроцесс**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getcurrentprocess) система возвращает псеудохандле с максимальным доступом, которое разрешено DACL для вызывающего.

Вы можете запросить право доступа к **\_ системе \_ безопасности системы доступа** к объекту процесса, если вы хотите прочитать или записать список SACL объекта. Дополнительные сведения см. в разделе [списки управления доступом (ACL)](../secauthz/access-control-lists.md) и [права доступа к спискам SACL](../secauthz/sacl-access-right.md).

> [!WARNING]
> Процесс, имеющий некоторые права доступа, указанные здесь, может использовать их для получения других прав доступа. Например, если процесс A имеет обработчик для обработки B с доступом **Process \_ DUP \_** , он может дублировать псевдо-обработчик для процесса B. При этом создается маркер с максимальным доступом к процессу б. Дополнительные сведения о псевдо Handles см. в разделе [**жеткуррентпроцесс**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getcurrentprocess).

 

## <a name="protected-processes"></a>Защищенные процессы

В Windows Vista введены *защищенные процессы* для улучшения поддержки цифровых Rights Management. Система ограничена доступом к защищенным процессам и потокам защищенных процессов.

Из процесса к защищенному процессу запрещены следующие стандартные права доступа:

- **DELETE**  
- **\_Контроль чтения**  
- **ЗАПИСЬ \_ DAC**  
- **\_владелец записи**  

От процесса к защищенному процессу запрещены следующие права доступа:

- **Обработка \_ всех \_ обращений**  
- **процесс \_ создания \_ процесса**  
- **ОБРАБОТАТЬ \_ \_ поток создания**  
- **Обработка \_ \_ обработчика DUP**  
- **Обработка \_ \_ сведений о запросе**  
- **\_сведения о наборе процессов \_**  
- **\_ \_ Квота набора процессов**  
- **\_операция обработки виртуальной машины \_**  
- **ПРОЦЕСС \_ чтения виртуальной машины \_**  
- **Обработка \_ записи виртуальной машины \_**  

Для предоставления доступа к подмножеству сведений, доступных через **\_ \_ сведения о запросе Process**, было введено право **обрабатывать \_ \_ ограниченные \_ сведения** .
