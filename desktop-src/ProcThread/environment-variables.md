---
description: 'Каждый процесс имеет блок среды, содержащий набор переменных среды и их значений. Существует два типа переменных среды: пользовательские переменные среды (устанавливаются для каждого пользователя) и системные переменные среды (задаются для всех).'
ms.assetid: 6732b12f-ced1-4769-b947-79da8fd2237a
title: Переменные среды
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6f50226d12286d01c77025d1cc38e33e2778392a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105673768"
---
# <a name="environment-variables"></a>Переменные среды

Каждый процесс имеет блок среды, содержащий набор переменных среды и их значений. Существует два типа переменных среды: пользовательские переменные среды (устанавливаются для каждого пользователя) и системные переменные среды (задаются для всех).

По умолчанию дочерний процесс наследует переменные среды своего родительского процесса. Программы, запущенные процессором командной строки, наследуют переменные среды обработчика команд. Чтобы указать другую среду для дочернего процесса, создайте новый блок среды и передайте указатель на него в качестве параметра функции [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) .

Обработчик команд предоставляет команду **Set** для вывода его блока среды или для создания новых переменных среды. Можно также просмотреть или изменить переменные среды, выбрав пункт **система** в **панели управления**, выбрав **Дополнительные параметры системы** и щелкнув **переменные среды**.

Каждый блок среды содержит переменные среды в следующем формате:<dl> *Var1* = *Значение1* \\ 0,0  
*Var2* = *Значение2* \\ 0,0  
*Var3* = *Значение3* \\ 0,0  
...  
*Варн* = *Контрольное* \\ 0 \\ 0  
</dl>

Имя переменной среды не может содержать знак равенства (=).

Функция [**жетенвиронментстрингс**](/windows/win32/api/processenv/nf-processenv-getenvironmentstrings) возвращает указатель на блок среды вызывающего процесса. Он должен рассматриваться как блок только для чтения. не изменяйте его напрямую. Вместо этого используйте функцию [**SetEnvironmentVariable**](/windows/desktop/api/WinBase/nf-winbase-setenvironmentvariable) для изменения переменной среды. По завершении работы с блоком среды, полученным из **жетенвиронментстрингс**, вызовите функцию [**фриенвиронментстрингс**](/windows/win32/api/processenv/nf-processenv-freeenvironmentstringsa) , чтобы освободить блок.

Вызов [**SetEnvironmentVariable**](/windows/desktop/api/WinBase/nf-winbase-setenvironmentvariable) не влияет на системные переменные среды. Чтобы программным путем добавить или изменить системные переменные среды, добавьте их в раздел реестра **\_ \_ \\ \\ \\ \\ \\ окружения CurrentControlSet Control System диспетчера сеансов** , а затем выполните широковещательную рассылку сообщения [**WM \_ сеттингчанже**](/windows/desktop/winmsg/wm-settingchange) с параметром *lParam* в строку "среда". Это позволяет приложениям, например оболочке, принимать обновления.

Максимальный размер определяемой пользователем переменной среды — 32 767 символов. Нет технического ограничения на размер блока среды. Однако существуют практические ограничения в зависимости от механизма, используемого для доступа к блоку. Например, пакетный файл не может установить переменную, длина которой превышает максимальную длину командной строки.

**Windows Server 2003 и Windows XP:** Максимальный размер блока среды для процесса составляет 32 767 символов. Начиная с Windows Vista и Windows Server 2008, нет технического ограничения на размер блока среды.

Функция [**GetEnvironmentVariable**](/windows/desktop/api/WinBase/nf-winbase-getenvironmentvariable) определяет, определена ли указанная переменная в среде вызывающего процесса, и, если да, то что ее значение равно.

Чтобы получить копию блока среды для данного пользователя, используйте функцию [**креатинвиронментблокк**](/windows/win32/api/userenv/nf-userenv-createenvironmentblock) .

Чтобы развернуть строки переменных среды, используйте функцию [**експанденвиронментстрингс**](/windows/desktop/api/processenv/nf-processenv-expandenvironmentstringsa) .

## <a name="related-topics"></a>См. также

<dl> <dt>

[Изменение переменных среды](changing-environment-variables.md)
</dt> <dt>

[Переменные среды пользователя](../shell/user-environment-variables.md)
</dt> </dl>

 

 
