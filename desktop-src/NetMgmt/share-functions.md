---
title: Функции общего доступа
description: Функции общего доступа к управлению сетью управляют общими ресурсами. Общий ресурс — это локальный ресурс на сервере (например, каталог на диске, устройство печати или именованный канал), к которому могут обращаться пользователи и приложения в сети.
ms.assetid: 3764c667-2290-48e6-ba3a-c74eee2c27f9
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5034d46e233ebb7ed4de691bd79942a3ecdf5263
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104413516"
---
# <a name="share-functions"></a>Функции общего доступа

Функции общего доступа к управлению сетью управляют общими ресурсами. Общий ресурс — это локальный ресурс на сервере (например, каталог на диске, устройство печати или именованный канал), к которому могут обращаться пользователи и приложения в сети.

Функции общего доступа перечислены ниже.



| Функция                                  | Описание                                                          |
|-------------------------------------------|----------------------------------------------------------------------|
| [**нетшареадд**](/windows/desktop/api/lmshare/nf-lmshare-netshareadd)         | Предоставляет общий доступ к ресурсу на сервере.                                       |
| [**нетшаречекк**](/windows/desktop/api/lmshare/nf-lmshare-netsharecheck)     | Запрашивает, является ли сервер общим для устройства.                        |
| [**нетшаредел**](/windows/desktop/api/lmshare/nf-lmshare-netsharedel)         | Удаляет имя общего ресурса из списка общих ресурсов сервера.       |
| [**нетшаринум**](/windows/desktop/api/lmshare/nf-lmshare-netshareenum)       | Возвращает общие сведения о каждом общем ресурсе на сервере.  |
| [**нетшарежетинфо**](/windows/desktop/api/lmshare/nf-lmshare-netsharegetinfo) | Извлекает сведения об указанном общем ресурсе на сервере. |
| [**нетшаресетинфо**](/windows/desktop/api/lmshare/nf-lmshare-netsharesetinfo) | Задает параметры общего ресурса.                                 |



 

Эти функции общего доступа применяются только к общим папкам на сервере Server Message Block (LAN Manager). Эти функции общего доступа не поддерживают общие папки распределенная файловая система (DFS). Например, функция [**нетшарежетинфо**](/windows/desktop/api/lmshare/nf-lmshare-netsharegetinfo) может получать сведения только об указанном ресурсе на SMB-сервере. Чтобы получить сведения для общего ресурса с помощью другого поставщика сети (например, WebDAV или общей папки DFS), используйте функцию [**внетжетконнектион**](/windows/desktop/api/winnetwk/nf-winnetwk-wnetgetconnectiona) .

Функция [**нетшареадд**](/windows/desktop/api/lmshare/nf-lmshare-netshareadd) позволяет пользователю или приложению совместно использовать ресурс определенного типа, используя указанное имя общего ресурса. Для предоставления общего доступа к ресурсу функции **нетшареадд** требуется имя общего ресурса и имя локального устройства. Для доступа к ресурсу пользователю или приложению должна быть назначена учетная запись на сервере.

Можно также указать дескриптор безопасности, который будет связан с общим ресурсом. Дескрипторы безопасности определяют, каким пользователям разрешен доступ к файлам через общую папку, а также к какому типу доступа. При вызове **нетшареадд** или [**Нетшаресетинфо**](/windows/desktop/api/lmshare/nf-lmshare-netsharesetinfo)укажите [**\_ дескриптор безопасности**](/windows/desktop/api/winnt/ns-winnt-security_descriptor) со сведениями об [**общей информации \_ \_ 502**](/windows/desktop/api/lmshare/ns-lmshare-share_info_502) . **Нетшаресетинфо** поддерживает информационный [**уровень \_ \_ 1501**](/windows/desktop/api/lmshare/ns-lmshare-share_info_1501) . Дополнительные сведения о дескрипторах безопасности см. в разделе [Управление доступом](/windows/desktop/SecAuthZ/access-control).

Функции управления сетью используют следующие специальные имена общих ресурсов для межпроцессного взаимодействия (IPC) и удаленного администрирования сервера.

-   IPC $, зарезервировано для межпроцессного взаимодействия
-   Администратор $, зарезервированный для удаленного администрирования
-   A $, B $, C $ (и другие имена локальных дисков, за которыми следует знак доллара), назначенный для локальных дисковых устройств

Чтобы получить список всех подключений к общему ресурсу на сервере или получить список всех соединений, установленных с определенного компьютера, вызовите функцию [**нетконнектионенум**](/windows/desktop/api/lmshare/nf-lmshare-netconnectionenum) . Вы можете вызвать **нетконнектионенум** в сведениях о [**соединении \_ \_ 0**](/windows/desktop/api/lmshare/ns-lmshare-connection_info_0) и на уровнях информации о [**подключении \_ \_ 1**](/windows/desktop/api/lmshare/ns-lmshare-connection_info_1) .

Функции общего доступа доступны на следующих уровнях информации, хотя некоторые уровни общего доступа применимы только к некоторым функциям общего доступа:

-   [**ПОДЕЛИТЬСЯ \_ информацией \_ 0**](/windows/desktop/api/lmshare/ns-lmshare-share_info_0)
-   [**Общие \_ сведения \_ 1**](/windows/desktop/api/lmshare/ns-lmshare-share_info_1)
-   [**Общие \_ сведения \_ 2**](/windows/desktop/api/lmshare/ns-lmshare-share_info_2)
-   [**Общие \_ сведения \_ 501**](/windows/desktop/api/lmshare/ns-lmshare-share_info_501)
-   [**Общие \_ сведения \_ 502**](/windows/desktop/api/lmshare/ns-lmshare-share_info_502)
-   [**Общие \_ сведения \_ 503**](/windows/desktop/api/lmshare/ns-lmshare-share_info_503)
-   [**Общие \_ сведения \_ 1004**](/windows/desktop/api/lmshare/ns-lmshare-share_info_1004)
-   [**Общие \_ сведения \_ 1005**](/windows/desktop/api/lmshare/ns-lmshare-share_info_1005)
-   [**Общие \_ сведения \_ 1006**](/windows/desktop/api/lmshare/ns-lmshare-share_info_1006)
-   [**Общие \_ сведения \_ 1501**](/windows/desktop/api/lmshare/ns-lmshare-share_info_1501)

Дополнительные сведения см. в документации по определенной функции общего доступа.

При программировании для Active Directory можно вызвать определенные методы интерфейса Active Directory (ADSI) для достижения тех же функций, которые можно достичь, вызвав функции общего доступа к управлению сетью. Дополнительные сведения см. в разделе [**иадсфилешаре**](/windows/desktop/api/iads/nn-iads-iadsfileshare).

 

 