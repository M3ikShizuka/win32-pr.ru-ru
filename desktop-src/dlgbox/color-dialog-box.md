---
title: Диалоговое окно "Цвет"
description: Отображает модальное диалоговое окно, позволяющее пользователю выбрать конкретное значение цвета.
ms.assetid: 248586b5-5068-4021-8407-56eb79243789
keywords:
- ввод пользователя, Библиотека общих диалоговых окон
- запись вводимых пользователем данных, Библиотека общих диалоговых окон
- Библиотека общих диалоговых окон
- Общие диалоговые окна
- Диалоговое окно "Цвет"
- диалоговое окно «частичный цвет»
- диалоговое окно «полный цвет»
- диалоговое окно «Настройка цвета»
- Цветовая модель RGB
- Цветовая модель HSL
- оттенок — яркость насыщенности (HSL)
- HSL (яркость насыщенности оттенок)
- RGB (красный зеленый цвет)
- красный зеленый цвет (RGB)
- обработчики, диалоговое окно "цвет"
- стандартные диалоговые окна
- диалоговые окна, цвет
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f2bdfb1543de80ac105d4a6012a0c95ff46cd8da1fef204ed573d14d05a6dfe9
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119726418"
---
# <a name="color-dialog-box"></a>Диалоговое окно "Цвет"

Отображает модальное диалоговое окно, позволяющее пользователю выбрать конкретное значение цвета. Пользователь может выбрать цвет из набора базовых или пользовательских цветовых палитр. Кроме того, пользователь может создать значение цвета, изменив значения цвета RGB или тона, насыщенности, яркости (HSL) пользовательского интерфейса диалогового окна. Диалоговое окно **Цвет** ВОЗВРАЩАЕТ значение RGB цвета, выбранного пользователем.

Создание и отображение диалогового окна **цвета** осуществляется путем инициализации структуры [**чусеколор**](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1) и передачи структуры в функцию [**чусеколор**](/previous-versions/windows/desktop/legacy/ms646912(v=vs.85)) . Устанавливая различные значения параметров для структуры **чусеколор** , можно повлиять на отображение диалогового окна «цвет». Например, можно отобразить полную или частичную версию пользовательского интерфейса диалогового окна. На следующем рисунке показана полная версия пользовательского интерфейса диалогового окна " **Цвет** ".

![Цвет - диалоговое окно](images/colordialogboxxp.png)

Если пользователь нажмет кнопку **ОК** , [**Чусеколор**](/previous-versions/windows/desktop/legacy/ms646912(v=vs.85)) возвращает **значение true**. Элемент **ргбресулт** структуры [**чусеколор**](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1) содержит значение цвета RGB цвета, выбранного пользователем. Значение цвета RGB определяет интенситиес для отдельных красного, зеленого и синего цветов, составляющих выбранный цвет. Отдельные значения находятся в диапазоне от 0 до 255. Используйте макросы [**rvalue**](/windows/desktop/api/wingdi/nf-wingdi-getrvalue), [**жетгвалуе**](/windows/desktop/api/wingdi/nf-wingdi-getgvalue)и [**жетбвалуе**](/windows/desktop/api/wingdi/nf-wingdi-getbvalue) для извлечения отдельных цветов из значения цвета RGB.

Если пользователь отменяет диалоговое окно « **Цвет** » или возникает ошибка, [**чусеколор**](/previous-versions/windows/desktop/legacy/ms646912(v=vs.85)) возвращает **значение «ложь** », а элемент **ргбресулт** не определен. Чтобы определить причину ошибки, вызовите функцию [**коммдлжекстендедеррор**](/windows/desktop/api/Commdlg/nf-commdlg-commdlgextendederror) , чтобы получить расширенное значение ошибки.

В этом разделе рассматриваются следующие темы.

-   [Диалоговые окна полного и частичного цвета](#full-and-partial-color-dialog-boxes)
-   [Настройка диалогового окна «цвет»](#customizing-the-color-dialog-box)
    -   [Предоставление пользовательского шаблона для диалогового окна «цвет»](#to-provide-a-custom-template-for-the-color-dialog-box)
    -   [Включение процедуры-обработчика для диалогового окна «цвет»](#to-enable-a-hook-procedure-for-the-color-dialog-box)
-   [Цветовые модели, используемые в диалоговом окне «цвет»](#color-models-used-by-the-color-dialog-box)
    -   [Цветовая модель RGB](#rgb-color-model)
    -   [Цветовая модель HSL](#hsl-color-model)
    -   [Преобразование значений HSL в значения RGB](#converting-hsl-values-to-rgb-values)

## <a name="full-and-partial-color-dialog-boxes"></a>Диалоговые окна полного и частичного цвета

Диалоговое окно «цвет» имеет полную версию и частичную версию пользовательского интерфейса. Полная версия включает основные элементы управления и содержит дополнительные элементы управления, позволяющие пользователю создавать собственные цвета. Частичная версия содержит элементы управления, отображающие базовые и пользовательские цветовые палитры, из которых пользователь может выбрать значение цвета.

Частичная версия диалогового окна Цвет включает кнопку **определить пользовательские цвета** . Пользователь может нажать эту кнопку, чтобы отобразить полную версию. Можно направить диалоговое окно цвет, чтобы всегда отображалась полная версия, установив флаг **CC \_ фуллопен** в элементе **flags** структуры [**чусеколор**](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1) . Чтобы запретить пользователю создавать пользовательские цвета, можно установить флаг **CC \_ превентфуллопен** , чтобы отключить кнопку **определить пользовательские цвета** .

Основные цвета представляют собой выбор цветов, доступных на указанном устройстве. Фактическое число отображаемых цветов определяется драйвером экрана. Например, драйвер VGA отображает 48 цветов, а монохромный драйвер экрана отображает только 16.

Пользовательские цвета задаются или создаются пользователем. При создании диалогового окна «цвет» необходимо использовать элемент **лпкустколорс** структуры [**чусеколор**](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1) для указания начальных значений для 16 пользовательских цветов. Если открыта полная версия диалогового окна цвет, пользователь может создать пользовательский цвет одним из следующих способов:

-   Перемещение курсора в элементе управления "спектр цветов" и элементе управления "яркость слайда"
-   Ввод значений RGB в элементы управления " **красный**", " **зеленый**" и " **синий** "
-   Ввод значений HSL в элементы управления " **оттенок**", " **Кот**" и " **яркость** "

Чтобы добавить новый пользовательский цвет к отображению пользовательских цветов, пользователь может нажать кнопку **Добавить в пользовательские цвета** . Это также приводит к тому, что диалоговое окно копирует значение RGB нового цвета в соответствующий элемент массива, на который указывает элемент **лпкустколорс** . Чтобы сохранить новые пользовательские цвета между вызовами [**чусеколор**](/previous-versions/windows/desktop/legacy/ms646912(v=vs.85)), необходимо выделить статическую память для массива. Дополнительные сведения о цветовых моделях RGB и HSL см. [в разделе цветовые модели, используемые в диалоговом окне "цвет"](#color-models-used-by-the-color-dialog-box).

## <a name="customizing-the-color-dialog-box"></a>Настройка диалогового окна «цвет»

Чтобы настроить диалоговое окно цвета, можно использовать любой из следующих методов.

-   Укажите значения в структуре [**чусеколор**](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1) при создании диалогового окна
-   Предоставление пользовательского шаблона
-   Предоставление процедуры-обработчика

Внешний вид и поведение диалогового окна «цвет» можно изменить, установив флаги в элементе **flags** структуры [**чусеколор**](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1) . Например, можно установить флаг **CC \_ солидколор** , чтобы задать для диалогового окна Отображение только сплошных цветов. Чтобы в диалоговом окне изначально был выбран цвет, отличный от черного, установите флаг **CC \_ ргбинит** и укажите цвет в элементе **ргбресулт** .

Можно указать пользовательский шаблон для диалогового окна цвет, например, если требуется включить дополнительные элементы управления, которые являются уникальными для приложения. Функция [**чусеколор**](/previous-versions/windows/desktop/legacy/ms646912(v=vs.85)) использует пользовательский шаблон вместо шаблона по умолчанию.

### <a name="to-provide-a-custom-template-for-the-color-dialog-box"></a>Предоставление пользовательского шаблона для диалогового окна «цвет»

1.  Создайте пользовательский шаблон, изменив шаблон по умолчанию, указанный в файле Color. DLG. Идентификаторы элементов управления, используемые в шаблоне диалогового окна цвета по умолчанию, определяются в файле Color. DLG.
2.  Используйте структуру [**чусеколор**](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1) , чтобы включить шаблон следующим образом:
    -   Если пользовательский шаблон является ресурсом в приложении или библиотеке динамической компоновки, установите флаг **CC \_ енаблетемплате** в элементе **flags** . Используйте элементы **HINSTANCE** и **лптемплатенаме** структуры для задания имени модуля и ресурса.

        -Или-

    -   Если пользовательский шаблон уже находится в памяти, установите флаг **CC \_ енаблетемплатехандле** . Используйте элемент **HINSTANCE** для задания объекта памяти, содержащего шаблон.

Для диалогового окна «цвет» можно предоставить процедуру обработчика [**кчукпрок**](/windows/win32/api/commdlg/nc-commdlg-lpcchookproc) . Процедура-обработчик может обрабатывать сообщения, отправленные в диалоговое окно. Кроме того, можно использовать зарегистрированные сообщения для управления поведением диалогового окна. При использовании пользовательского шаблона для определения дополнительных элементов управления необходимо предоставить процедуру-обработчик для обработки входных данных для элементов управления.

### <a name="to-enable-a-hook-procedure-for-the-color-dialog-box"></a>Включение процедуры-обработчика для диалогового окна «цвет»

1.  Установите флаг **CC \_ енаблехук** в элементе **flags** структуры [**чусеколор**](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1) .
2.  Укажите адрес процедуры-обработчика в элементе **лпфнхук** .

После обработки сообщения [**WM \_ инитдиалог**](wm-initdialog.md) процедура диалогового окна отправляет сообщение **WM \_ инитдиалог** в процедуру-обработчик. Параметр *lParam* этого сообщения является указателем на структуру [**чусеколор**](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1) , используемую для инициализации диалогового окна.

При нажатии пользователем кнопки " **ОК** " диалоговое окно отправляет зарегистрированное сообщение [**колорокстринг**](colorokstring.md) в процедуру-обработчик. Процедура-обработчик может отклонить выбранный цвет и принудительно оставить диалоговое окно открытым, возвращая ноль при получении этого сообщения. Процедура-обработчик может заставить диалоговое окно выбрать определенный цвет, отправив сообщение [**сетргбстринг**](setrgbstring.md) Registered в диалоговое окно. Чтобы использовать эти зарегистрированные сообщения, необходимо передать константы **колорокстринг** и **Сетргбстринг** в функцию [**регистервиндовмессаже**](/windows/desktop/api/winuser/nf-winuser-registerwindowmessagea) , чтобы получить идентификатор сообщения. Затем можно использовать идентификатор для обнаружения и обработки сообщений, отправленных из диалогового окна, или для отправки сообщений в диалоговое окно.

## <a name="color-models-used-by-the-color-dialog-box"></a>Цветовые модели, используемые в диалоговом окне «цвет»

Расширение "пользовательские цвета" диалогового окна "цвет" позволяет пользователю указать цвет с помощью значений RGB или HSL. Однако структура [**чусеколор**](/windows/win32/api/commdlg/ns-commdlg-choosecolora-r1) использует только значения RGB для сообщения цветов, созданных или выбранных пользователем.

-   [Цветовая модель RGB](#rgb-color-model)
-   [Цветовая модель HSL](#hsl-color-model)
-   [Преобразование значений HSL в значения RGB](#converting-hsl-values-to-rgb-values)

### <a name="rgb-color-model"></a>Цветовая модель RGB

Модель RGB используется для обозначения цветов для отображения и других устройств, которые порождают освещение. Допустимые значения красного, зеленого и синего в диапазоне от 0 до 255, значение 0 указывает на минимальную интенсивность и 255, указывающее на максимальную интенсивность. На следующем рисунке показано, как можно объединить основные цвета красного, зеленого и синего цветов, чтобы получить четыре дополнительных цвета. (Для устройств вывода цвет черный результат, когда значения красного, зеленого и синего равны 0. В технологии вывода «черный» — отсутствие всех цветов.)

![перекрывающиеся красные, зеленые и синие круги](images/rgbcolormodel.png)

В следующей таблице перечислены восемь цветов модели RGB и связанные с ними значения RGB.



| Color   | Значения RGB    |
|---------|---------------|
| Красный     | 255, 0, 0     |
| Зеленый   | 0, 255, 0     |
| Синий    | 0, 0, 255     |
| Цвет    | 0, 255, 255   |
| Пурпурный | 255, 0, 255   |
| Желтый  | 255, 255, 0   |
| Белый   | 255, 255, 255 |
| Черный   | 0, 0, 0       |



 

Система хранит внутренние цвета в виде 32-битных значений RGB, имеющих следующую шестнадцатеричную форму: 0x00BBGGRR.

Байт нижнего порядка содержит значение для относительной интенсивности красного цвета; второй байт содержит значение для зеленого цвета; третий байт содержит значение синего. Байт высокого порядка должен быть равен нулю.

Можно использовать макрос [**RGB**](/windows/desktop/api/wingdi/nf-wingdi-rgb) для получения значения RGB, основанного на заданном интенситиес, для красного, зеленого и синего компонентов. Используйте макросы [**rvalue**](/windows/desktop/api/wingdi/nf-wingdi-getrvalue), [**жетбвалуе**](/windows/desktop/api/wingdi/nf-wingdi-getbvalue)и [**жетгвалуе**](/windows/desktop/api/wingdi/nf-wingdi-getgvalue) для извлечения отдельных цветов из значения цвета RGB.

### <a name="hsl-color-model"></a>Цветовая модель HSL

Диалоговое окно цвет предоставляет элементы управления для указания значений HSL. На следующем рисунке показан элемент управления спектром цветов и элемент управления "яркость слайда", отображаемый в диалоговом окне "цвет". На рисунке также показаны диапазоны значений, которые пользователь может указать с помощью этих элементов управления.

![спектр цветов и шкала яркости](images/colordialogranges.png)

В диалоговом окне «цвет» значения насыщенности и яркости должны быть в диапазоне от 0 до 240, а значение оттенка должно находиться в диапазоне от 0 до 239.

### <a name="converting-hsl-values-to-rgb-values"></a>Преобразование значений HSL в значения RGB

Процедура диалогового окна, представленная в Comdlg32.dll для диалогового окна «цвет», содержит код, преобразующий значения HSL в соответствующие значения RGB. В следующей таблице перечислены восемь цветов модели RGB и соответствующие значения HSL и RGB.



| Color   | Значения HSL      | Значения RGB      |
|---------|-----------------|-----------------|
| Красный     | (0, 240, 120)   | (255, 0, 0)     |
| Желтый  | (40, 240, 120)  | (255, 255, 0)   |
| Зеленый   | (80, 240, 120)  | (0, 255, 0)     |
| Цвет    | (120, 240, 120) | (0, 255, 255)   |
| Синий    | (160, 240, 120) | (0, 0, 255)     |
| Пурпурный | (200, 240, 120) | (255, 0, 255)   |
| Белый   | (0, 0, 240)     | (255, 255, 255) |
| Черный   | (0, 0, 0)       | (0, 0, 0)       |



 

 

 
