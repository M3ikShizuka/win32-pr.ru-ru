---
title: Страница свойств печати
description: Страница свойств печать — это стандартный пользовательский интерфейс, позволяющий пользователю задавать свойства конкретного задания печати.
ms.assetid: b52b71cc-a583-4a21-8a53-501ab442e6f8
keywords:
- Windows Пользовательский интерфейс, ввод данных пользователем
- Windows Пользовательский интерфейс, Библиотека общих диалоговых окон
- ввод пользователя, Библиотека общих диалоговых окон
- запись вводимых пользователем данных, Библиотека общих диалоговых окон
- Библиотека общих диалоговых окон
- Общие диалоговые окна
- Диалоговое окно «Печать страницы свойств»
- диалоговое окно «Настройка страницы свойств печати»
- стандартные диалоговые окна
- диалоговые окна, страница свойств печати
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cc54bc8065ada207702755e8fc0a1586620f660db9f3acf2a67e32b56e393143
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118280516"
---
# <a name="print-property-sheet"></a>Страница свойств печати

Страница свойств **Печать** — это стандартный пользовательский интерфейс, позволяющий пользователю задавать свойства конкретного задания печати. Страница свойств состоит из набора страниц свойств, которые зависят от принтера или приложения. к подмножеству стандартных страниц свойств Windows некоторые принтеры могут добавлять страницы свойств, относящиеся к драйверу, а некоторые приложения могут добавлять страницы свойств, относящиеся к конкретному приложению.

Чтобы создать и отобразить страницу свойств **печати** , инициализируйте структуру [**принтдлжекс**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) и передайте эту структуру в функцию [**принтдлжекс**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) .

На следующем рисунке показана типичная страница свойств **печати** .

![Страница свойств принтера](images/printerpropertypagexp.png)

Большинство элементов структуры [**принтдлжекс**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) идентичны элементам структуры [**принтдлг**](/windows/win32/api/commdlg/ns-commdlg-printdlga) . Описание использования общих членов структуры для взаимодействия с элементами управления диалогового окна см. в разделе [диалоговое окно «Печать](print-dialog-box.md)». Оставшаяся часть этого раздела описывает функции страницы свойств **печати** , которые отличаются от диалогового окна « **Печать** ».

Страницу свойств **печати** можно настроить, указав настраиваемый шаблон диалогового окна для нижней части страницы **Общие** и указав дополнительные страницы свойств для перехода на страницу **Общие** . Дополнительные сведения см. [в разделе Настройка страницы свойств печати](#customizing-the-print-property-sheet).

Вы можете реализовать объект обратного вызова для получения уведомлений и сообщений от функции [**принтдлжекс**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) при отображении страницы свойств. Приложения, предоставляющие настраиваемые шаблоны или дополнительные страницы, используют объект обратного вызова для взаимодействия со страницей свойств. Дополнительные сведения см. [в разделе объект обратного вызова для страницы свойств печати](#callback-object-for-the-print-property-sheet).

Страница свойств **Печать** обеспечивает поддержку для указания нескольких несмежных диапазонов страниц для печати. Элемент **лппажеранжес** структуры [**принтдлжекс**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) задает массив структур [**принтпажеранже**](/windows/win32/api/commdlg/ns-commdlg-printpagerange) , в которых каждая структура задает диапазон страниц.

На странице свойств **Печать** отображается переключатель **Текущая страница** в составе группы **диапазонов страниц** переключателей. Для управления переключателем **Текущая страница** используйте флаги **PD \_ CURRENTPAGE** и **PD \_ нокуррентпаже** в элементе **flags** структуры [**принтдлжекс**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) .

В этом разделе рассматриваются следующие темы.

-   [Настройка страницы свойств печати](#customizing-the-print-property-sheet)
-   [Объект обратного вызова для страницы свойств печати](#callback-object-for-the-print-property-sheet)

## <a name="customizing-the-print-property-sheet"></a>Настройка страницы свойств печати

Страницу свойств **Печать** можно настроить следующими способами.

-   Предоставьте пользовательский шаблон для нижней части страницы **Общие** . Это позволяет включать дополнительные элементы управления, которые являются уникальными для приложения. Функция [**принтдлжекс**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) использует пользовательский шаблон вместо шаблона по умолчанию.
-   Укажите дополнительные страницы свойств для перехода на страницу **Общие** .
-   Предоставьте объект обратного вызова. Дополнительные сведения см. [в разделе объект обратного вызова для страницы свойств печати](#callback-object-for-the-print-property-sheet).

Нельзя изменить верхнюю часть страницы **Общие** . Нельзя изменять страницы свойств, предоставленные драйвером принтера.

Чтобы предоставить пользовательский шаблон для страницы "Общие", выполните следующие действия.

1.  Создайте пользовательский шаблон для нижней части страницы " **Общие** ", изменив шаблон принтдлжексорд, указанный в файле прнсетуп. DLG. Как правило, пользовательский шаблон должен иметь тот же размер, что и шаблон по умолчанию. Однако можно увеличить пользовательский шаблон, если указать флаг **PD \_ уселаржетемплате** , чтобы создать **общую страницу общего** размера. Идентификаторы элементов управления, используемые в шаблоне диалогового окна **печати** по умолчанию, определяются в файле длгс. h.
2.  Используйте структуру [**принтдлжекс**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) , чтобы включить шаблон следующим образом:
    -   Если пользовательский шаблон является ресурсом в приложении или библиотеке динамической компоновки, установите флаг **PD \_ енаблепринттемплате** в элементе **flags** . Используйте элементы **HINSTANCE** и **лппринттемплатенаме** структуры для задания имени модуля и ресурса.

        -Или-

    -   Если пользовательский шаблон уже находится в памяти, установите флаг **PD \_ енаблепринттемплатехандле** . Используйте элемент **HINSTANCE** для задания объекта памяти, содержащего шаблон.

3.  При использовании пользовательского шаблона для определения дополнительных элементов управления необходимо предоставить объект обратного вызова для обработки входных данных для элементов управления. Объект обратного вызова реализует метод [**ипринтдиалогкаллбакк:: хандлемессаже**](/windows/win32/api/commdlg/nf-commdlg-iprintdialogcallback-handlemessage) , который получает сообщения, отправленные в настраиваемое диалоговое окно.

Предоставление дополнительных страниц свойств

1.  Используйте функцию, чтобы создать дополнительные страницы.
2.  Используйте элемент **лфпропертипажес** структуры [**принтдлжекс**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) , чтобы указать массив дескрипторов для дополнительных страниц.

    Процедуры диалоговых окон, указанные при создании каждой страницы, обрабатывают сообщения, отправленные на страницы.

3.  Может потребоваться предоставить объект обратного вызова, который реализует интерфейс. Функция [**принтдлжекс**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) использует этот интерфейс, чтобы передать приложению указатель на интерфейс [**ипринтдиалогсервицес**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogservices) . В диалоговых окнах для дополнительных страниц свойств этот интерфейс можно использовать для получения сведений о текущем выбранном принтере.

## <a name="callback-object-for-the-print-property-sheet"></a>Объект обратного вызова для страницы свойств печати

Приложение, отображающее страницу свойств **печати** , может реализовать объект обратного вызова для получения уведомлений и сообщений от функции [**принтдлжекс**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) при отображении страницы свойств. Чтобы предоставить объект обратного вызова, укажите указатель на объект в элементе **лпкаллбакк** структуры [**принтдлжекс**](/windows/win32/api/commdlg/ns-commdlg-printdlgexa) .

Объект обратного вызова должен реализовывать интерфейс [**ипринтдиалогкаллбакк**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogcallback) . Функция [**принтдлжекс**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) вызывает методы **ипринтдиалогкаллбакк** в следующих ситуациях:

-   При инициализации диалогового окна
-   Когда пользователь выбирает другой принтер из списка установленных принтеров, отображаемых на странице свойств
-   При получении сообщений для дочернего диалогового окна в нижней части страницы " **Общие** " вкладки свойств

Объект обратного вызова также должен реализовывать интерфейс [**IObjectWithSite**](/windows/win32/api/ocidl/nn-ocidl-iobjectwithsite) . Функция [**принтдлжекс**](/previous-versions/windows/desktop/legacy/ms646942(v=vs.85)) вызывает метод, чтобы передать указатель на интерфейс [**ипринтдиалогсервицес**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogservices) в приложение. Методы [**ипринтдиалогкаллбакк**](/windows/win32/api/commdlg/nn-commdlg-iprintdialogcallback) могут использовать интерфейс **ипринтдиалогсервицес** для получения сведений о выбранном в данный момент принтере. Интерфейс **ипринтдиалогсервицес** также полезен для приложений, которые создают дополнительные страницы для перехода на страницу « **Общие** » страницы свойств **печати** . Процедуры диалоговых окон для дополнительных страниц могут вызывать методы **ипринтдиалогсервицес** .

 

 