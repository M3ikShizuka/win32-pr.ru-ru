---
title: Подключение потока к рабочему столу
description: Когда процесс подключается к Windows-станции, система назначает рабочий стол потоку, выполняющему подключение.
ms.assetid: 45016619-ed11-4b0c-84e3-f8662553c64d
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a503390468ea5ed1771ece7a942a2d615ac6f0a9
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104260906"
---
# <a name="thread-connection-to-a-desktop"></a>Подключение потока к рабочему столу

Когда процесс подключается к Windows-станции, система назначает рабочий стол потоку, выполняющему подключение. Система определяет рабочий стол для назначения потоку согласно следующим правилам.

1.  Если поток вызвал функцию [**сетсреаддесктоп**](/windows/win32/api/winuser/nf-winuser-setthreaddesktop) , он подключается к указанному рабочему столу.
2.  Если поток не вызывал [**сетсреаддесктоп**](/windows/win32/api/winuser/nf-winuser-setthreaddesktop), он подключается к рабочему столу, унаследованному от родительского процесса.
3.  Если поток не вызывал [**сетсреаддесктоп**](/windows/win32/api/winuser/nf-winuser-setthreaddesktop) и не наследовал класс Desktop, система пытается открыть для максимального \_ разрешенного доступа и подключиться к рабочему столу следующим образом:
    -   Если имя рабочего стола было указано в элементе **лпдесктоп** структуры [**стартупинфо**](/windows/desktop/api/processthreadsapi/ns-processthreadsapi-startupinfoa) , которая использовалась при создании процесса, поток подключается к указанному рабочему столу.
    -   В противном случае поток подключается к рабочему столу по умолчанию рабочей станции Windows, к которой подключен процесс.

Рабочий стол, назначенный во время этого процесса подключения, не может быть закрыт путем вызова функции [**клоседесктоп**](/windows/win32/api/winuser/nf-winuser-closedesktop) .

Когда процесс подключается к рабочему столу, система выполняет поиск унаследованных дескрипторов в таблице дескрипторов процесса. Система использует первый найденный обработчик рабочего стола. Если требуется, чтобы дочерний процесс подключаться к определенному настольному рабочему столу, необходимо убедиться, что только нужный маркер помечен как наследуемый. Если дочерний процесс наследует несколько дескрипторов рабочего стола, то результаты подключения к рабочему столу не будут определены.

Дескрипторы рабочего стола, которые открывает система при подключении процесса к рабочему столу, не наследуются.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Обработка подключения к оконной станции](process-connection-to-a-window-station.md)
</dt> </dl>

 

 