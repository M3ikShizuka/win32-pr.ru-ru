---
title: Обработка подключения к оконной станции
description: Процесс автоматически устанавливает соединение с рабочей станцией и настольным компьютером при первом вызове функции USER32 или GDI32 (за исключением оконных функций и рабочих станций).
ms.assetid: 280f69e7-5c99-41a7-94e3-da13deaac9f5
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7a87e97b19ac1210b04447652268c5f53b7e2a6d
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104413382"
---
# <a name="process-connection-to-a-window-station"></a>Обработка подключения к оконной станции

Процесс автоматически устанавливает соединение с рабочей станцией и настольным компьютером при первом вызове функции USER32 или GDI32 (за исключением оконных функций и рабочих станций). Система определяет станцию Windows, к которой процесс подключается в соответствии со следующими правилами.

1.  Если процесс вызвал функцию [**сетпроцессвиндовстатион**](/windows/win32/api/winuser/nf-winuser-setprocesswindowstation) , он подключается к станции окна, указанной в этом вызове.
2.  Если процесс не вызывал [**сетпроцессвиндовстатион**](/windows/win32/api/winuser/nf-winuser-setprocesswindowstation), он подключается к станции окна, унаследованной от родительского процесса.
3.  Если процесс не вызывал [**сетпроцессвиндовстатион**](/windows/win32/api/winuser/nf-winuser-setprocesswindowstation) и не наследовал станцию окна, система пытается открыть для максимального \_ разрешенного доступа и подключиться к станции Windows следующим образом:
    -   Если имя станции Windows было указано в элементе **лпдесктоп** структуры [**стартупинфо**](/windows/desktop/api/processthreadsapi/ns-processthreadsapi-startupinfoa) , которая использовалась при создании процесса, процесс подключается к указанной рабочей станции.
    -   В противном случае, если процесс выполняется в сеансе входа интерактивного пользователя, этот процесс подключается к интерактивной рабочей станции.
    -   Если процесс выполняется в неинтерактивном сеансе входа, имя Windows Station Name формируется на основе идентификатора сеанса входа в систему и предпринимается попытка открыть эту станцию окон. Если операция открытия завершается сбоем, так как эта станция окна не существует, система пытается создать оконную станцию и Рабочий стол по умолчанию.

Станция окна, назначенная во время этого процесса подключения, не может быть закрыта путем вызова функции [**клосевиндовстатион**](/windows/win32/api/winuser/nf-winuser-closewindowstation) .

При подключении процесса к Windows-станции система выполняет поиск наследуемых дескрипторов в таблице дескрипторов процесса. Система использует первый найденный обработчик оконной станции. Если требуется, чтобы дочерний процесс подключаться к определенной наследуемой станции окна, необходимо убедиться, что только нужный маркер помечен как наследуемый. Если дочерний процесс наследует несколько дескрипторов оконных станций, то результаты подключения Windows Station не определяются.

Дескрипторы оконной станции, открываемой системой при подключении процесса к рабочей станции, не наследуются.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Подключение потока к рабочему столу](thread-connection-to-a-desktop.md)
</dt> </dl>

 

 