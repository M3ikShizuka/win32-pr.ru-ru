---
title: Дескрипторы параметров
description: Как упоминалось ранее, дескрипторы параметров стилей стиля ОИФ существуют \ 8211; Oi и \ 8211;.
ms.assetid: c2dad284-abe5-4b38-b3a6-3c7373fc5b84
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 22f6f8b19eb6632c4111547925151865b03b9adc
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "103793207"
---
# <a name="parameter-descriptors"></a>Дескрипторы параметров

Как упоминалось ранее, дескрипторы параметров стиля ( [**Oi**](/windows/desktop/Midl/-oi) и **– ОИФ** ) существуют.

## <a name="the-oi-parameter-descriptors"></a>Дескрипторы параметров – OI

Для полностью интерпретируемых заглушек требуется дополнительная информация для каждого параметра в вызове RPC. Описания параметров процедуры следуют сразу после описания процедуры.

[**Simple — OI**](/windows/desktop/Midl/-oi)

**Дескрипторы параметров**

Формат описания для \[  \] параметра простого типа в или возвращает:

``` syntax
FC_IN_PARAM_BASETYPE 
simple_type<1>
```

–или–

``` syntax
FC_RETURN_PARAM_BASETYPE 
simple_type<1>
```

Где простой \_ тип<1> — это маркер FC, указывающий простой тип. Ниже приведены коды этих кодов.

``` syntax
4e  FC_IN_PARAM_BASETYPE 
53  FC_RETURN_PARAM_BASETYPE
```

**Другие — OI**

**Дескрипторы параметров**

Формат описания для всех других типов параметров:

``` syntax
param_direction<1> 
stack_size<1> 
type_offset<2>
```

Где \_ поле direction<1> для каждого из этих описаний должно быть одним из показанных в следующей таблице.



| Hex | Flag                          | Значение                                                     |
|-----|-------------------------------|-------------------------------------------------------------|
| 4d  | FC \_ в \_ param                 | Параметр in.                                            |
| 50  | \_ \_ выходной \_ параметр FC            | Параметр in/out.                                        |
| 51  | \_выходной \_ параметр FC                | Выходной параметр.                                           |
| 52  | FC \_ return \_ param             | Возвращаемое значение процедуры.                                   |
| 4F  | FC \_ в \_ param \_ без \_ бесплатных \_ inst | В xmit/представитель в качестве параметра, для которого не выполняется освобождение. |



 

Размер стека \_<1> — это размер параметра в стеке, выраженный в виде числа целочисленных параметров, занимаемых параметром в стеке.

> [!Note]  
> Режим [**– Oi**](/windows/desktop/Midl/-oi) не поддерживается на 64-разрядных платформах.

 

Смещение типа \_<2> поле является смещением в таблице строк формата типа, которое указывает дескриптор типа для аргумента.

## <a name="the-oif-parameter-descriptors"></a>Дескрипторы параметров – ОИФ

Существует два возможных формата описания параметра: одно для базовых типов, другое — для всех других типов.

Базовые типы:

``` syntax
PARAM_ATTRIBUTES<2> 
stack_offset<2> 
type_format_char<1> 
unused<1>
```

Другие возможности:

``` syntax
PARAM_ATTRIBUTES<2> 
stack_offset<2> 
type_offset<2>
```

В обоих \_ смещениях стека<2> указывает смещение в стеке виртуальных аргументов в байтах. Для базовых типов тип аргумента указывается непосредственно символом формата, соответствующим типу. Для других типов \_ смещение типа<2> предоставляет смещение в таблице строк формата типа, где находится дескриптор типа для аргумента.

Поле атрибута параметра определяется следующим образом:

``` syntax
typedef struct
  {
  unsigned short  MustSize            : 1;    // 0x0001
  unsigned short  MustFree            : 1;    // 0x0002
  unsigned short  IsPipe              : 1;    // 0x0004
  unsigned short  IsIn                : 1;    // 0x0008
  unsigned short  IsOut               : 1;    // 0x0010
  unsigned short  IsReturn            : 1;    // 0x0020
  unsigned short  IsBasetype          : 1;    // 0x0040
  unsigned short  IsByValue           : 1;    // 0x0080
  unsigned short  IsSimpleRef         : 1;    // 0x0100
  unsigned short  IsDontCallFreeInst  : 1;    // 0x0200
  unsigned short  SaveForAsyncFinish  : 1;    // 0x0400
  unsigned short  Unused              : 2;
  unsigned short  ServerAllocSize     : 3;    // 0xe000
  } PARAM_ATTRIBUTES, *PPARAM_ATTRIBUTES;
```

-   Бит **мустсизе** задается только в том случае, если параметр должен иметь размер.
-   Бит **мустфри** устанавливается, если сервер должен вызвать \* подпрограммы ндрфри параметра.
-   Бит **иссимплереф** задается для параметра, который является указателем ссылки на что-либо, кроме другого указателя, и не имеет выделенных атрибутов. Для такого типа,<> поле смещения типа описания параметра \_ , за исключением указателя ссылки на базовый тип, предоставляет смещение для типа референт; указатель ссылки просто пропускается.
-   Бит **исдонткаллфриинст** задается для определенных \_ параметров представления как параметры, подпрограммы бесплатных экземпляров которых не должны вызываться.
-   Биты **сервераллоксизе** не равны нулю, если параметр находится в, а также находится в \[  \] \[  \] \[  \] указателе на указатель или на enum16, и инициализируется в стеке интерпретатора сервера вместо того, чтобы использовать вызов **I \_ рпкаллокате**. Если не равно нулю, это значение умножается на 8, чтобы получить число байтов для параметра. Обратите внимание, что это означает, что для указателя всегда выделяется по меньшей мере 8 байт.
-   Бит **исбасетипе** устанавливается для простых типов, которые маршалируются с помощью цикла интерпретатора [**-ОИФ**](/windows/desktop/Midl/-oi) "основной". В частности, простой тип с атрибутом Range в нем не помечается как базовый тип, чтобы принудительно выполнять упаковку подпрограммы диапазона посредством диспетчеризации с помощью \_ токена диапазона FC.
-   Бит **исбивалуе** задается для составных типов, отправляемых по значению, но не задается для простых типов, независимо от того, является ли аргумент указателем. Составные типы, для которых оно задано, — это структуры, объединения, [**передачи \_ как**](/windows/desktop/Midl/transmit-as), которые [**представляют \_ собой**](/windows/desktop/Midl/represent-as) [**проводной \_**](/windows/desktop/Midl/wire-marshal) и SAFEARRAY. В целом, бит был представлен для преимуществ основного цикла интерпретатора в интерпретаторе [**– оикф**](/windows/desktop/Midl/-oi) , чтобы гарантировать правильную разыменование непростых аргументов (называемых аргументами составного типа). Этот бит никогда не использовался в предыдущих версиях интерпретатора.

 

 