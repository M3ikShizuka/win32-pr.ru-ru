---
title: Поддержание состояния на сервере между вызовами
description: Часто требуется поддерживать состояние на сервере между отдельными вызовами RPC \ 8212; использование дескрипторов контекста является лучшим способом. Несколько слов о том, как дескрипторы контекста работают внутри, помогают понять, когда лучше работают дескрипторы контекста.
ms.assetid: f76ec489-f48e-473d-b519-3ac143d41fa4
keywords:
- Удаленный вызов процедур RPC, рекомендации, поддержание состояния между вызовами
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e564acbb4748cd76988c1b064a58ede2169d3d20da4033774f3141883a7193bc
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118928589"
---
# <a name="maintaining-state-on-the-server-between-calls"></a>Поддержание состояния на сервере между вызовами

Часто приходится сохранять состояние на сервере между отдельными вызовами RPC — лучше всего использовать дескрипторы контекста. Несколько слов о том, как дескрипторы контекста работают внутри, помогают понять, когда лучше работают дескрипторы контекста.

Клиент никогда не получает состояние, сохраненное на сервере. Чаще всего состояние на сервере — это указатель на блок памяти, и у клиента нет сведений о нем. Все получение клиента — это большой уникальный номер с другими связанными с ним сведениями, которые сервер отправляет клиенту и который представляет маркер контекста во всех последующих операциях. Когда клиент ссылается на открытый обработчик, он отправляет большое число, полученное от сервера при открытии этого маркера контекста.

Сервер отслеживает все большие числа, отправляемые клиенту. Когда сервер получает большое число, представляющее дескриптор контекста, он ищет число в коллекции допустимых, необработанных дескрипторов контекста для этого клиента и находит контекст на стороне сервера, соответствующий заданному большому числу. Он передается в серверную подпрограммы. Если большое число не найдено, \_ \_ \_ возникает исключение несоответствия контекста RPC X SS, которое \_ распространяется на клиент.

Короллариес этой конструкции выглядит следующим образом:

-   Маркер контекста допустим только в контексте существующего сеанса клиента/сервера. Он не может быть передан другому клиенту.
-   Маркер контекста становится недействительным, если сервер перезагружается или в противном случае теряет соединение с клиентом.
-   Клиент не может интерпретировать контекстный маркер на сервере. Для клиента все дескрипторы контекста являются просто большими числами.

Если клиент завершается сбоем, сервер получает уведомление и очищает его контекстные дескрипторы с помощью механизма запуска.

 

 




