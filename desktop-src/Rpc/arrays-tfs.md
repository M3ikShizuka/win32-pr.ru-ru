---
title: Массивы (RPC) (TFS)
description: Категории массива удаленного вызова процедур (RPC) включают в себя фиксированный размер, согласованность, различные, различные и сложные.
ms.assetid: 7144ec87-90f2-463a-80e4-28cb4771325f
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d6d564a2dfd838006be1667343b14a57bdaf4b07
ms.sourcegitcommit: 4d4a6e9ad5de37e467cd3164276771b71e1f113f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/05/2021
ms.locfileid: "106388816"
---
# <a name="arrays-rpc"></a>Массивы (RPC)

Несколько категорий массивов определены на основе их характеристик производительности, в основном, можно ли копировать массив в блок.

Для некоторых категорий, таких как массив фиксированного размера, существует два типа дескрипторов массива. они обозначаются неисправностью в названии ведущего маркера FC.



| Символ формата | Описание                                                           |
|------------------|-----------------------------------------------------------------------|
| SM               | Общий размер типа может быть представлен в 16-разрядном целочисленном типе без знака.    |
| LG               | Общий размер типа должен быть представлен в виде 32-разрядного длинного числа без знака. |



 

Поля, общие для массивов:

-   Общий \_ Размер

    Общий размер массива в памяти, в байтах. Это то же самое, что и размер линии после выравнивания. Общий размер вычисляется для категорий, для которых не существует проблемы заполнения, а размер — фактический размер массива.

-   \_размер элемента

    Общий размер в памяти одного элемента массива, включая заполнение (это может произойти только для сложных массивов).

-   \_Описание элемента

    Описание типа элемента массива.

-   \_Макет указателя

    Дополнительные сведения см. в разделе о [макете указателя](pointer-layout-tfs.md) .

## <a name="fixed-sized-arrays"></a>Массивы фиксированного размера

Строка формата массива фиксированного размера создается для массивов, имеющих известный размер, и поэтому может быть заблокирована в буфере упаковки. Ниже приведены два формата дескрипторов фиксированных массивов.

``` syntax
FC_SMFARRAY alignment<1> 
total_size<2> 
[pointer_layout<>]  
element_description<> 
FC_END
```

и

``` syntax
FC_LGFARRAY alignment<1> 
total_size<4> 
[pointer_layout<>] 
element_description<> 
FC_END
```

## <a name="conformant-array"></a>Согласованный массив

Согласованный массив может быть заблокирован, если размер массива известен.

``` syntax
FC_CARRAY alignment<1>
element_size<2> 
conformance_description<> 
[pointer_layout<>] 
element_description<> 
FC_END
```

\_Описание соответствия<> является дескриптором корреляции и имеет 4 или 6 байт в зависимости от того, используется ли [**/robust**](/windows/desktop/Midl/-robust) .

## <a name="conformant-varying-array"></a>Согласованный переменный массив

Согласованный переменный массив также может быть скопирован в блок.

``` syntax
FC_CVARRAY alignment<1> 
element_size<2> 
conformance_description<> 
variance_description<>  
[pointer_layout<>] 
element_description<> 
FC_END
```

\_Описание соответствия<> и описание дисперсии \_<> является дескриптором корреляции и имеет 4 или 6 байт в зависимости от того, используется ли [**/robust**](/windows/desktop/Midl/-robust) .

## <a name="varying-array"></a>Различные массивы

Различные массивы имеют две возможности в зависимости от размера массива.

``` syntax
FC_SMVARRAY alignment<1>
total_size<2>  
number_elements<2> 
element_size<2> 
variance_description<> 
[pointer_layout<>] 
element_description<> 
FC_END

FC_LGVARRAY alignment<1>
total_size<4>  
number_elements<4> 
element_size<2> 
variance_description<4>
[pointer_layout<>] 
element_description<> 
FC_END
```

Описание дисперсии \_<> является дескриптором корреляции и содержит 4 или 6 байт в зависимости от используемого [**/robust**](/windows/desktop/Midl/-robust) .

Для различных массивов, внедренных в структуру, смещение<2> описания дисперсии \_<> является относительным смещением от положения разного массива в структуре до поля, описывающего дисперсию. Смещение обычно относительно начала структуры.

## <a name="complex-arrays"></a>Сложные массивы

Сложный массив — это любой массив с элементом, который предотвращает копирование блока, и, таким образом, необходимо выполнить дополнительное действие. Эти элементы делают массив сложным:

-   простые типы: ENUM16, \_ \_ INT3264 (только на 64-разрядных платформах), интеграл с \[ [ **диапазоном**](/windows/desktop/Midl/range)\]
-   ссылки и указатели интерфейса (все указатели на 64-разрядных платформах)
-   объединения
-   сложные структуры (см. раздел описание сложной структуры для получения полного списка причин сложной структуры).
-   элементы, определенные с помощью \[ [**передачи \_ в виде**](/windows/desktop/Midl/transmit-as) \] , \[ [**пользовательского \_ маршалирования**](/windows/desktop/Midl/user-marshal)\]
-   Все многомерные массивы, имеющие по крайней мере одно согласованное и (или) изменяющееся измерение, являются сложными независимо от типа базового элемента.

Описание сложного массива выглядит следующим образом:

``` syntax
FC_BOGUS_ARRAY alignment<1> 
number_of_elements<2> 
conformance_description<> 
variance_description<> 
element_description<> 
FC_END
```

Число \_ элементов, \_<2> поле, равно нулю, если массив является согласованным.

\_Описание соответствия<> и описание дисперсии \_<> является дескриптором корреляции и имеет 4 или 6 байт в зависимости от того, используется ли [**/robust**](/windows/desktop/Midl/-robust) . Если массив имеет соответствие и/или дисперсия, \_ Описание соответствия<> и/или описания дисперсии \_<> поля имеют допустимые описания, в противном случае первые 4 байта дескриптора корреляции имеют значение 0xFFFFFFFF. Флаги, при их наличии, устанавливаются в ноль.

 

 
