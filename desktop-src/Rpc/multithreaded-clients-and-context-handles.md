---
title: Многопоточные клиенты и дескрипторы контекста
description: При наличии многопоточного клиента, где несколько потоков используют один и тот же экземпляр обработчика контекста, доступ к экземпляру обработчика контекста сериализуется на сервере по умолчанию.
ms.assetid: 192be467-b1e0-422b-878a-738cb7d72b5b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 67c621d75d8cc48ca1f71719066f455e0efce39f
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104070317"
---
# <a name="multithreaded-clients-and-context-handles"></a>Многопоточные клиенты и дескрипторы контекста

При наличии многопоточного клиента, где несколько потоков используют один и тот же экземпляр обработчика контекста, доступ к экземпляру обработчика контекста сериализуется на сервере по умолчанию. Это позволяет избежать необходимости защиты диспетчера сервера от другого потока от того же клиента, изменяющего контекст или использующий его контекст при отправке вызова. Однако в некоторых случаях сериализация может повлиять на производительность.

Рассмотрим следующее: два клиентских потока вызывают удаленный вызов процедуры, который не изменяет состояние контекста (например, вызов просто получает от него некоторые значения). Такие вызовы не обязательно должны быть сериализованы.

В таких ситуациях в Windows XP предусмотрена модель сериализации в смешанном режиме, где каждый метод может быть объявлен как монопольный или общий доступ к обработчику контекста. Дополнительные сведения см. в разделе [ \_ \_ сериализация обработчика контекста](/windows/desktop/Midl/context-handle-serialize) и [ \_ \_ обработчик контекста](/windows/desktop/Midl/context-handle-noserialize) .

В версиях Windows, предшествовавших Windows XP, единственным средством, позволяющим одновременный доступ к контекстному обработчику, является вызов функции [**рпкссдонтсериализеконтекст**](/previous-versions/aa378473(v=vs.80)) , позволяющей отправлять несколько вызовов в одном обработчике контекста. Вызов функции **рпкссдонтсериализеконтекст** полностью не отключает сериализацию; При возникновении контекстного запуска подпрограммы запуска контекста выполняются только после завершения всех невыполненных запросов клиентов. Вызов **рпкскдонтсериализеконтекст** влияет на весь процесс и не подлежащем. Использование **рпкскдонтсериализеконтекст** в Windows XP и более поздних версиях не рекомендуется; Это делает серверный код очень запутанным при надежной работе с условиями гонки, присущими совершенно несерийные среды.

 

 