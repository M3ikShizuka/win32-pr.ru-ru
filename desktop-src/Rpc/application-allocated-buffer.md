---
title: Буфер Application-Allocated
description: Атрибут ACF \ число байтов \_ \ направляет заглушки использовать предварительно выделенный буфер, который не выделяется или не освобождается подпрограммыми поддержки клиентов.
ms.assetid: 1b370f74-394e-4e57-9749-83334be50f28
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9bb87390637cba57cbdf4021a43f4ec98ea64c3828c67dfdb615ffcd62dc8c16
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "120024184"
---
# <a name="application-allocated-buffer"></a>Буфер Application-Allocated

\[ [**\_ Счетчик байтов**](/windows/desktop/Midl/byte-count) атрибута ACF \] указывает заглушкам использовать предварительно выделенный буфер, который не выделяется и не освобождается подпрограммыми поддержки клиентов. Атрибут \[ **\_ количества байтов** \] применяется к указателю или параметру массива, который указывает на буфер. Для этого требуется параметр, указывающий размер буфера в байтах.

Область памяти, выделенная клиентом, может содержать сложные структуры данных с несколькими указателями. Поскольку область памяти является непрерывной, приложению не нужно делать несколько вызовов для высвобождения каждого указателя и структуры по отдельности. Как и при использовании \[ атрибута [**allocate (все \_ узлы)**](/windows/desktop/Midl/allocate) \] , область памяти может быть выделена или освобождена с помощью одного вызова подпрограммы выделения памяти или бесплатной подпрограммы. Однако, в отличие от атрибута \[ **allocate (все \_ узлы)** \] , параметр buffer не управляется клиентской заглушкой, а клиентским приложением.

Буфер должен быть \[ [](/windows/desktop/Midl/out-idl) \] параметром только для исходящих байтов, а длина буфера в байтах должна быть \[ [](/windows/desktop/Midl/in) \] параметром только для чтения. Атрибут \[ [**\_ количества байтов**](/windows/desktop/Midl/byte-count) \] может применяться только к типам указателей. Атрибут \[ **ACF \_ Count** \] -Byte является РАСШИРЕНИЕМ Майкрософт для устройства DCE IDL и, таким образом, недоступен при компиляции с помощью параметра MIDL [**/ОСФ**](/windows/desktop/Midl/-osf) .

В следующем примере параметр *Прут* использует число байт:

``` syntax
/* function prototype in IDL file (fragment) */
void SortNames(
    [in] short cNames,
    [in, size_is(cNames)] STRINGTYPE pszArray[],
    [in] short cBytes,
    [out, ref] P_TREE_TYPE pRoot  /* tree with sorted data */
);
```

Атрибут \[ [**\_ количества БАЙТОВ**](/windows/desktop/Midl/byte-count) \] отображается в ACF как:

``` syntax
/* ACF file (fragment) */
SortNames([byte_count(cBytes)] pRoot);
```

Заглушка клиента, созданная из этих файлов IDL и ACF, не выделяет и не освобождает память для этого буфера. Заглушка сервера выделяет буфер и освобождает его в одном вызове, используя предоставленный параметр размера. Если данные слишком велики для указанного размера буфера, возникает исключение.

 

 