---
title: Что происходит во время запроса
description: В этом разделе описывается, как сеть обрабатывает запрос, когда 32-разрядный клиент ищет имя в своем собственном домене.
ms.assetid: a8a88743-a245-4258-af05-9261c214ab50
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d6e26fb9aaef0aac2ff66260d51f756725566dee
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127169012"
---
# <a name="what-happens-during-a-query"></a>Что происходит во время запроса

В этом разделе описывается, как сеть обрабатывает запрос, когда 32-разрядный клиент ищет имя в своем собственном домене.

Когда клиентское приложение вызывает [**рпкнсбиндингимпортбегин**](/windows/desktop/api/Rpcnsi/nf-rpcnsi-rpcnsbindingimportbegina), локатор, находящийся на клиентском компьютере, попытается удовлетворить этот запрос. Если в кэше нет ничего, запрос будет перенаправлен RPC на главный Локатор. Если в кэше обнаружено ничего, он отправляет запрос всем компьютерам в домене с помощью широковещательной рассылки через почтовый слот. Если обнаружено совпадение, локатор на каждом компьютере будет отвечать направленному слоту почты. (Например, если процесс на этом компьютере экспортировал интерфейс.) Ответы отправляются по копиям, а RPC завершается с локатора процесса клиента, который будет отвечать на сам клиентский процесс.

В домене локатор клиента выполняет поиск основного локатора в следующих местах:

-   На основном контроллере домена
-   На каждом резервном контроллере домена

Если совпадение не найдено, локатор клиента объявляет себя основным указателем. В этом случае запросы будут транслироваться, если их нельзя удовлетворить локально.

В Рабочей группе локатор клиента поддерживает кэш компьютеров, указатели которых имеют широковещательные рассылки. Он использует тот, который выполнялся дольше, чем локатор главного сервера. Если этот компьютер недоступен, используется следующий компьютер с максимальной навещание и т. д. Если клиенту требуется главный Локатор и кэш пуст, он пополняет кэш, отправив специальный широковещательный слот, который запрашивает ответы на запросы хозяина запросов. Если ответа нет, локатор клиента объявляет себя основным указателем и передает запросы, если они не могут быть удовлетворены локально.

Это меняется, если клиентское приложение является 16-или MS-DOS-программой. В этом случае на клиентском компьютере не выполняется локатор, а Rpcns1.dll или Рпкнслм. RPC содержит код для поиска основного локатора. Все запросы перенаправляются непосредственно в главный указатель.

Эти рекомендации действительны для имен в домене клиента, например имен для "/.:/ ИмяЗаписи ". Если клиент запрашивает имя из другого домена с помощью "/.../Домаин/ентринаме;", локатор клиента перенаправляет запрос в указанный домен, который будет транслировать его, если у него нет ответа. Если домен не работает или в действительности является рабочей группой, запрос завершится ошибкой.

> [!Note]  
> При работе с записями в службе имен помните следующее:

 

-   Клиент не может использовать синтаксис "/.../Домаин/ентринаме" для поиска записи в своем собственном домене. Используйте синтаксис "/.:/ ИмяЗаписи ". Однако можно использовать "/.../Домаин/ентринаме" для поиска записи в другом домене.
-   Доменное имя в "/.../Домаин/ентринаме" должно быть в верхнем регистре. При поиске соответствия локатор учитывает регистр.
-   Имена записей локатора также чувствительны к регистру, но не должны быть прописными буквами.
-   Когда клиент использует "/.:/ ИмяЗаписи "указатель не будет искать записи в других доменах, даже если они имеют отношение доверия с доменом входа в систему.
-   Широковещательные рассылки не являются сегментами локальной сети (например, подсетями). Поэтому полезность локатора ограничена в Организации с несколькими подсетями.

 

 




