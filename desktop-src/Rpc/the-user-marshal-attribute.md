---
title: Атрибут user_marshal
description: Атрибут \ user \_ Marshal \ является атрибутом ACF-Type, аналогичным синтаксису \ представить \_ как \.
ms.assetid: 5a381b44-e271-4713-954f-a55840a92bb7
keywords:
- Удаленный вызов процедур RPC, атрибуты, user_marshal
- user_marshal
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f2bb3237b2d5df001dc94ede5fb03de72b5563eb
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104488065"
---
# <a name="the-user_marshal-attribute"></a>Атрибут пользовательской \_ маршалирования

Атрибут \[ [пользовательской \_ маршалирования](/windows/desktop/Midl/user-marshal) \] — это атрибут ACF-Type, аналогичный синтаксису для \[ [представления в \_ виде](/windows/desktop/Midl/represent-as) \] . Как и в случае с атрибутом IDL, \[ [ \_ ](/windows/desktop/Midl/wire-marshal) \] он обеспечивает более эффективный способ маршалирования данных по сети. Как атрибут ACF, **\[ пользовательское \_ маршалирование \]** позволяет маршалировать пользовательские типы данных, неизвестные для MIDL. Каждый тип конкретного приложения имеет соответствующий переданный тип, который определяет представление сети.

Тип конкретного приложения может быть простым, составным или иметь тип указателя. Основное ограничение заключается в том, что экземпляр типа должен иметь фиксированный, четко определенный объем памяти. Если размер экземпляра типа необходимо изменить, используйте поле указателя вместо согласованного массива. Кроме того, можно определить указатель на изменяемый тип.

Как и в случае с атрибутом **\[ проводного \_ маршалирования \]** , вы предоставляете подпрограммы для определения размера, маршалирования, распаковки и освобождения проходов. В следующей таблице описаны четыре имени подпрограммы, предоставляемые пользователем. <type>— Это *тип* усерм, указанный в определении типа **\[ пользовательского \_ маршалирования \]** .



| Подпрограмма                                                            | Описание                                                               |
|--------------------------------------------------------------------|---------------------------------------------------------------------------|
| [<type>\_усерсизе](the-type-usersize-function.md)           | Изменяет размер буфера данных RPC перед упаковкой на стороне клиента или сервера. |
| [<type>\_усермаршал](the-type-usermarshal-function.md)     | Маршалирует данные на стороне клиента или сервера.                           |
| [<type>\_усерунмаршал](the-type-userunmarshal-function.md) | Распаковать данные на стороне клиента или сервера.                         |
| [<type>\_усерфри](the-type-userfree-function.md)           | Освобождает данные на стороне сервера.                                        |



 

Эти пользовательские подпрограммы предоставляются как клиентом, так и серверным приложением на основе атрибутов направления.

Если параметр доступен только \[ [в](/windows/desktop/Midl/in) \] , клиент передает на сервер. Клиенту требуются функции **<type> \_ усерсизе** и **<type> \_ усермаршал** . Серверу требуются функции **<type> \_ усерунмаршал** и **<type> \_ усерфри** .

Для \[ [](/windows/desktop/Midl/out-idl) \] параметра только для выхода сервер передает клиенту. Серверу требуются функции **<type> \_ усерсизе** и **<type> \_ усермаршал** , тогда как клиенту требуется функция **<type> \_ усермаршал** .

## <a name="related-topics"></a>См. также

<dl> <dt>

[Атрибут Wired \_ Marshal](the-wire-marshal-attribute.md)
</dt> <dt>

[Правила маршалирования для пользовательского маршалирования и передачи проводного \_ маршалирования](marshaling-rules-for-user-marshal-and-wire-marshal.md)
</dt> <dt>

[Пользовательская \_ Упаковка](/windows/desktop/Midl/user-marshal)
</dt> <dt>

[проводное \_ маршалирование](/windows/desktop/Midl/wire-marshal)
</dt> <dt>

[**ндржетусермаршалинфо**](/windows/desktop/api/Rpcndr/nf-rpcndr-ndrgetusermarshalinfo)
</dt> </dl>

 

 