---
title: Определение каналов в IDL-файлах
description: Если в IDL-файле определен канал, компилятор MIDL создает структуру управления канала, члены которой являются указателями на процедуры Push, Pull и Alloc, а также переменную состояния, которая координирует эти процедуры.
ms.assetid: f6c282e4-3056-48c4-bd12-dfcae6d238d7
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 115be7fc5d00458d13df102afebe9ba5b55de070
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104413331"
---
# <a name="defining-pipes-in-idl-files"></a>Определение каналов в IDL-файлах

Если в IDL-файле определен канал, компилятор MIDL создает структуру управления канала, члены которой являются указателями на процедуры Push, Pull и Alloc, а также переменную состояния, которая координирует эти процедуры. Клиентское приложение инициализирует поля в структуре управления каналом, сохраняет свою переменную состояния и управляет передачей данных с помощью собственных функций Push, Pull и Alloc. Код клиентской заглушки вызывает эти функции приложения в циклах во время перемещения данных. Для входного канала заглушка клиента маршалирует данные передачи и передает их в заглушку сервера. Для выходного канала заглушка клиента распаковать данные в буфер и передает указатель на этот буфер обратно клиентскому приложению.

Серверный код заглушки инициализирует поля структуры управления каналом переменной состояния, а также указателями на подпрограммы push и Pull. Заглушка сервера поддерживает состояние и управляет своим частным хранилищем для передаваемых данных. Серверное приложение вызывает процедуры Pull и Push в циклах во время вызова удаленной процедуры при получении и распаковке данных из клиентской заглушки, а также для маршалирования и передачи данных в клиентскую заглушку.

В следующем примере IDL-файла определяется длинный канал типа канала \_ , размер элемента которого определяется как **Long**. В нем также объявляются прототипы функций для удаленной процедуры, которые вызывают конвейер и pipe для отправки и получения данных соответственно. Когда компилятор MIDL обрабатывает IDL-файл, он создает файл заголовка, показанный в примере.

## <a name="example"></a>Пример

``` syntax
// File: pipedemo.idl
typedef pipe long LONG_PIPE;
void InPipe( [in] LONG_PIPE pipe_data );
void OutPipe( [out] LONG_PIPE *pipe_data ); 
//end pipedemo.idl
 
// File: pipedemo.h (fragment)
// Generated by the MIDL compiler from pipedemo.idl
typedef struct pipe_LONG_PIPE
{
    void (__RPC_FAR * pull) (
        char __RPC_FAR * state,
        long __RPC_FAR * buf,
        unsigned long esize,
        unsigned long __RPC_FAR * ecount );
    void (__RPC_FAR * push) (
        char __RPC_FAR * state,
        long __RPC_FAR * buf,
        unsigned long ecount );
    void (__RPC_FAR * alloc) (
        char __RPC_FAR * state,
        unsigned long bsize,
        long __RPC_FAR * __RPC_FAR * buf,
        unsigned long __RPC_FAR * bcount );
    char __RPC_FAR * state;
} LONG_PIPE;
 
void InPipe( 
    /* [in] */ LONG_PIPE pipe_data);
void OutPipe( 
    /* [out] */ LONG_PIPE __RPC_FAR *pipe_data);
//end pipedemo.h
```

## <a name="related-topics"></a>См. также

<dl> <dt>

[дать](/windows/desktop/Midl/pipe)
</dt> <dt>

[**/Oi**](/windows/desktop/Midl/-oi)
</dt> </dl>

 

 