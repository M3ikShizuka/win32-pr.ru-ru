---
title: " в, out, size_is prototype"
description: в \_ качестве размера \ prototype использует одномерный массив символов, передаваемый от клиента серверу и от сервера к клиенту.
ms.assetid: bce9a36f-9f7c-4438-9b5a-15b8877f74c0
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 37829ce0d5a4bb44fefa038e9ce71773f9c4c9bd
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104337793"
---
# <a name="in-out-size_is-prototype"></a>\[в, out и Size \_ — \] прототип

В следующем прототипе функции используется массив символов с одной подсчетностью, который передается обоими способами: от клиента к серверу и от сервера к клиенту:

``` syntax
#define STRSIZE 500 //maximum string length

void Analyze(
    [in, out, length_is(*pcbSize), size_is(STRSIZE)] char  achInOut[],
    [in, out]  long *pcbSize);
```

В качестве \[ параметра [**в**](/windows/desktop/Midl/in) \] параметре *ачинаут* должен указывать на допустимое хранилище на стороне клиента. Разработчик выделяет память, связанную с массивом, на стороне клиента перед выполнением удаленного вызова процедуры.

Заглушки используют \[ [**размер \_ —**](/windows/desktop/Midl/size-is) \] параметр *стрсизе* для выделения памяти на сервере, а для \[ [**\_**](/windows/desktop/Midl/length-is) \] передачи элементов массива в эту память используется параметр length *пкбсизе* . Разработчик должен убедиться, что код клиента задает **\[ длину \_ \]** переменной перед вызовом удаленной процедуры.

В некоторых ситуациях использование отдельных параметров вместо одной строки для ввода и вывода является более эффективным и обеспечивает гибкость. Это продемонстрировано в следующем примере:

``` syntax
/* client */ 
char achInOut[STRSIZE];
long cbSize;
...
gets_s(achInOut, STRSIZE);       // get patient input
cbSize = strlen(achInOut) + 1;   // transmit '\0' too
Analyze(achInOut, &cbSize);
```

В предыдущем примере массив символов Ачинаут также используется в качестве \[ [**выходного**](/windows/desktop/Midl/out-idl) \] параметра. В C имя массива эквивалентно использованию указателя. По умолчанию все указатели верхнего уровня являются ссылочными указателями — они не меняются в значении и указывают на одну и ту же область памяти на клиенте до и после вызова. Вся память, к которой обращаются удаленные процедуры, должна соответствовать размеру, указанному клиентом перед вызовом, или заглушкам будет выдаваться исключение.

Перед возвращением функция Analyze на сервере должна сбросить параметр *пкбсизе* , чтобы указать количество элементов, которые сервер будет передавать клиенту, как показано ниже.

``` syntax
/* server */ 
Analyze(char * str, long * pcbSize)
{
   ...
   *pcbSize = strlen(str) + 1; // transmit '\0' too
   return;
}
```

 

 