---
title: Дескриптор заголовка процедуры
description: Заголовок был расширен несколько раз в течение жизненного цикла модуля NDR. Текущий компилятор по-прежнему создает разные заголовки в зависимости от режима компилятора. Однако более новые заголовки являются надмножеством более старых.
ms.assetid: 05b152b9-bd6d-49d1-8484-d104949c67b1
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: db9c28878d82820e519242172496a7932ac4832e
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104488113"
---
# <a name="procedure-header-descriptor"></a>Дескриптор заголовка процедуры

Заголовок был расширен несколько раз в течение жизненного цикла модуля NDR. Текущий компилятор по-прежнему создает разные заголовки в зависимости от режима компилятора. Однако более новые заголовки являются надмножеством более старых.

## <a name="the-old-oi-header"></a>Старый заголовок – OI

Заголовок имеет следующий формат:

``` syntax
handle_type<1> 
Oi_flags<1>
[rpc_flags<4>]
proc_num<2>  
stack_size<2>
[explicit_handle_description<>]
```

Тип обработчика \_<1> может быть одним из значений, приведенных в следующей таблице.



| Hex | Дескриптор               |
|-----|----------------------|
| 31  | FC \_ BIND \_ Generic    |
| 32  | \_примитив привязки \_ FC  |
| 33  | \_Автоматическая \_ Работа с FC     |
| 34  | \_обработчик обратного вызова FC \_ |
| 0   | (явный маркер)    |



 

Если тип маркера \_<1> поле имеет ненулевое значение, то процедура использует неявный маркер указанного типа. Дополнительные сведения см. в разделе [Handles](handles.md) . Если тип маркера \_<1> поле равно нулю, то обработчик, используемый для привязки, является одним из параметров процедуры.

Явные дескрипторы могут быть простыми, универсальными и контекстными. Последняя имеет следующий токен FC.



| Hex | Дескриптор            |
|-----|-------------------|
| 30  | \_контекст привязки \_ FC |



 

По соглашению типом маркера для интерфейсов DCOM является \_ Автоматическое \_ обработа FC.

\_Флаги Oi<1> поле — это 8-разрядная маска следующих флагов.



| Hex | Flag                         | Значение                                  |
|-----|------------------------------|------------------------------------------|
| 01  | \_Использовано полное \_ ptr- \_ Использование OI          | Использует полный пакет указателя.           |
| 02  | \_ \_ Использовано выделения "Oi RPCSS" \_       | Использует пакет памяти RPCSS.           |
| 04  | \_Процедура объекта \_ OI             | Процедура в интерфейсе объекта.      |
| 08  | Oi \_ имеет \_ рпкфлагс            | Процедура имеет ненулевые флаги RPC.     |
| 10  | Oi\_\*                       | Перегружен.                              |
| 20  | Oi\_\*                       | Перегружен.                              |
| 40  | Oi \_ используют \_ новые \_ \_ подпрограммы init | Использует подпрограммы Windows NT 3.5 бета и init. |
| 80  |                              | Не используется.                                  |



 

Следующие флаги перегружены.



| Hex | Flag                                    | Значение                                             |
|-----|-----------------------------------------|-----------------------------------------------------|
| 10  | используется КОДИРОВКа \_ \_                        | Используется только в поле выбора.                              |
| 20  | используется декодирование \_ \_                        | Используется только в поле выбора.                              |
| 10  | \_Обработка исключений Oi игнорирования \_ объектов \_ \_ | Больше не используется (старый OLE).                         |
| 20  | В Oi \_ есть \_ канал \_ или \_ сбой                | Только в необработанных RPC, \[ канале связи \_ , \_ состоянии сбоя \] .        |
| 20  | В файле Oi \_ obj \_ используется \_ \_ интерпретатор v2           | Только в DCOM используйте интерпретатор [**– ОИФ**](/windows/desktop/Midl/-oi) . |



 

В \_ поле "флаги rpc<4>" описывается, как задать поле **рпкфлагс** структуры [**\_ сообщения RPC**](/windows/desktop/api/RpcdceP/ns-rpcdcep-rpc_message) . Это поле имеется только в том случае, если для \_ флагов oi<1 \_> \_ задано значение Oi рпкфлагс. Если это поле отсутствует, то флаги RPC для удаленной процедуры будут равны нулю.

> [!Note]  
> Для повышения производительности в асинхронных интерпретаторах всегда отображается \_ поле Флаги rpc<4>.

 

В \_ поле proc num<2> содержится номер процедуры процедуры.

Размер стека \_<2> предоставляет общий размер всех параметров в стеке, включая все этот указатель и (или) возвращаемое значение.

Явное \_ Описание обработчика \_<> поле описано далее в этом документе. Это поле отсутствует, если процедура использует неявный обработчик.

 

 