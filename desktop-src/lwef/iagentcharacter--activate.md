---
title: Активация Иажентчарактер
description: Активация Иажентчарактер
ms.assetid: a81eb62d-709b-46b4-9ff2-c9017f7f853e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c1e86d2c094da484f528750d433e0fb6608790e4
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104532507"
---
# <a name="iagentcharacteractivate"></a>Иажентчарактер:: Activate

\[Microsoft Agent является устаревшим в Windows 7 и может быть недоступен в последующих версиях Windows.\]

``` syntax
HRESULT Activate(
   short sState, // topmost character or client setting
);
```

Указывает, является ли клиент активным, или символ является самым верхним.

-   Возвращает значение S \_ , чтобы указать, что операция выполнена успешно.
-   Возвращает \_ значение false, указывающее, что операция не была выполнена успешно.

<dl> <dt>

<span id="sState"></span><span id="sstate"></span><span id="SSTATE"></span>*сстате*
</dt> <dd>

Для этого параметра можно указать следующие значения:



| Значение | Описание                   |
|-------|-------------------------------|
| 0     | Задать как не активный клиент. |
| 1     | Установите в качестве активного клиента.     |
| 2     | Сделайте самый верхний символ.   |



 

</dd> </dl>

Если отображается несколько символов, только один из них получит речевой ввод за раз. Аналогично, если несколько клиентских приложений совместно используют один и тот же символ, только одна из них получает ввод с клавиатуры (например, элемент управления агента Microsoft Agent по щелчку или перетаскиванию событий) за раз. Кодировка для получения входных данных мыши и речи — самый верхний символ, а клиент, принимающий входные данные, — это активный клиент символа. (Окно с самым верхним символом также отображается в верхней части z-порядка окна символов.) Как правило, пользователь определяет, какой символ является самым верхним, путем явного выбора. Однако самая верхняя активация также изменяется при отображении или скрытии символа (он становится или больше не выше самого верхнего, соответственно).

Этот метод также можно использовать для явного управления тем, когда клиент получает входные данные, направленные на символ, например, когда само приложение станет активным. Например, если задать для параметра **State** значение 2, то символ будет самым верхним, а клиент получит все события мыши и речевого ввода, созданные при взаимодействии пользователя с этим символом. Таким образом, он также делает клиент клиентом для ввода активного символа. Однако можно также задать для активного клиента символ, не выполняя самого верхнего символа, установив для параметра **State** значение 1. Это позволяет клиенту получить входные данные, направленные на этот символ, когда символ станет самым верхним. Аналогичным образом можно настроить клиент так, чтобы он не был активным клиентом (чтобы не получать входные данные), когда символ станет самым верхним, установив для параметра **State** значение 0. Вы можете определить, есть ли у символа другие текущие клиенты, использующие [**иажентчарактер:: хасосерклиентс**](iagentcharacter--hasotherclients.md).

Избегайте вызова этого метода непосредственно после метода [**представления**](iagentcharacter--show.md) . **Показывать** автоматически задает клиент input-Active. Если символ скрыт, вызов функции **Activate** может завершиться ошибкой, если он будет обработан до завершения метода **представления** .

Попытка вызвать этот метод с параметром **State** , равным 2 (если указанный символ скрыт), приведет к сбою. Аналогично, если задать для параметра **State** значение 0, а приложение является единственным клиентом, этот вызов завершается неудачно. Символ всегда должен иметь самый верхний клиент.

> [!Note]  
> Вызов этого метода с **состоянием** , установленным в значение 1, обычно не создает событие [**Ажентнотифисинк:: активатеинпутстате**](https://www.bing.com/search?q=**AgentNotifySink::ActivateInputState**) , если другие символы не загружены или приложение уже не содержит активных входных данных.

 

## <a name="see-also"></a>См. также:

[**Иажентчарактер:: Хасосерклиентс**](iagentcharacter--hasotherclients.md)


 

 




