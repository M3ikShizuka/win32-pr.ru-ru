---
title: Расширение индекса (устаревшие функции среды Windows)
description: Узнайте, как расширить индекс в Windows Desktop Search 2. x. Для выпусков Windows, более поздних, чем Windows XP и Windows Server 2003, используйте вместо этого Поиск Windows.
ms.assetid: vs|search|~\search\wds2x\extending_index_ovr.htm
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 63408cfe1efeb8da4d6a4540cc57b99ea56ae935
ms.sourcegitcommit: 5d4e99f4c8f42f5f543e52cb9beb9fb13ec56c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/19/2021
ms.locfileid: "112407357"
---
# <a name="extending-the-index-legacy-windows-environment-features"></a>Расширение индекса (устаревшие функции среды Windows)

> [!NOTE]
> Windows Desktop Search 2. x — это устаревшая технология, которая изначально была доступна в качестве надстройки для Windows XP и Windows Server 2003. В более поздних выпусках используйте вместо этого [Поиск Windows](../search/-search-3x-wds-overview.md) .

Использование и разработка версий 2. x Microsoft Windows Desktop Search (WDS) настоятельно не рекомендуется в пользу [Windows Search](../search/-search-3x-wds-overview.md).

WDS можно расширить для индексации содержимого новых типов файлов и хранилищ данных. В настоящее время WDS 2. x содержит фильтры для более чем 200 типов элементов (включая такие элементы, как HTML, XML и файлы исходного кода) и использует ту же технологию [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)и обработчик протокола, что и службы SharePoint Services. Если для новых типов файлов уже установлены реализации фильтров, службы WDS могут использовать существующие интерфейсы фильтра для индексирования этих данных.

Надстройки WDS 2. x позволяют индексу просматривать и анализировать новые данные и структуры данных для добавления в каталог с возможностью поиска. Эти надстройки также могут расширять оболочку Windows, чтобы связать значки и обработчики контекстного меню с новыми типами файлов и хранилищами данных. Чтобы включить новые типы файлов в каталог WDS, надстройка должна реализовать интерфейс [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter). Чтобы включить новые хранилища данных, надстройка должна быть обработчиком протокола. Если новое хранилище данных содержит внедренные файлы или новые типы файлов, также потребуется написать соответствующий фильтр.

> [!Note]
>
> Фильтры и обработчики протоколов должны быть написаны в машинном коде из-за потенциальных проблем с управлением версиями среды CLR с помощью процесса все надстройки, запущенные в.

 

## <a name="adding-file-types-to-the-index"></a>Добавление типов файлов в индекс

Надстройки могут расширять службы WDS для индексации новых или собственных типов файлов, а также связывать каждый новый тип файлов с помощью значка файла или контекстного меню. Для этого можно создать и зарегистрировать надстройку, которая:

1.  Реализует интерфейс [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)для каждого типа файлов, чтобы службы WDS могли обращаться к тексту и метаданным типа файла и индексировать их.
2.  Реализует интерфейсы **иекстрактикон** и **IContextMenu** для добавления значков и контекстных меню для повышения степени интеграции и удобства использования.

Обсуждение реализации фильтров см. в разделе [Разработка надстроек IFilter](-search-2x-wds-ifilteraddins.md).

## <a name="adding-data-stores-to-the-index"></a>Добавление хранилищ данных в индекс

Надстройки могут расширять возможности WDS для индексации новых хранилищ данных и сопоставления файлов с помощью значка файла или контекстного меню. Для этого можно создать и зарегистрировать обработчик протокола, который:

1.  Реализует интерфейсы **исеарчпротокол** и **иурлакцессор** для обработки и привязки отдельных элементов в источнике содержимого. WDS использует URL-адреса для уникальной идентификации элементов, будь то элементы в файловой системе, в хранилище, похожем на базу данных, или в Интернете.
2.  Реализует интерфейс **иперсистфолдер** и части интерфейса **ишеллфолдер** для добавления значков и контекстных меню для повышения степени интеграции и удобства использования.

Обсуждение реализации обработчиков протоколов см. в разделе [Разработка обработчиков протоколов](-search-2x-wds-phaddins.md).

## <a name="add-in-installer-guidelines"></a>Рекомендации по установщику для надстройки

Установка надстройки должна соответствовать следующим рекомендациям.

-   Установщик должен использовать установщик EXE или MSI.
-   Необходимо указать заметки о выпуске.
-   Для каждой установленной надстройки необходимо создать запись « **Установка и удаление программ** ».
-   Установщик должен задействовать все параметры реестра для конкретного типа файлов или хранить данные, распознаваемые текущей надстройкой.
-   Если предыдущая надстройка перезаписывается, установщик должен уведомить пользователя.
-   Если более новая надстройка перезаписала предыдущую надстройку, то должна быть возможность восстановить функциональность предыдущей надстройки и сделать ее надстройкой по умолчанию для этого типа файла или хранилища.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

**Reference**
</dt> <dt>

[Разработка надстроек IFilter](-search-2x-wds-ifilteraddins.md)
</dt> <dt>

[Разработка обработчиков протоколов](-search-2x-wds-phaddins.md)
</dt> <dt>

**Другие ресурсы**
</dt> <dt>

[**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)
</dt> </dl>

 

 
