---
title: Создание анимаций
description: Создание анимаций
ms.assetid: 6d5c3c61-b3f2-4505-aa43-b6d001c444a5
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f16c460908e7c782054a3f62ece87d01e7c9a817
ms.sourcegitcommit: bf526e267d3991892733bdd229c66d5365cf244a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/05/2021
ms.locfileid: "104570918"
---
# <a name="creating-animations"></a>Создание анимаций

\[Microsoft Agent является устаревшим в Windows 7 и может быть недоступен в последующих версиях Windows.\]

Чтобы начать создание анимации для символа, выберите значок **анимации** в дереве. Откроется страница **Свойства** с параметрами по умолчанию для всех анимаций. Можно изменить размер кадра, Длительность кадра по умолчанию и параметры цветовой палитры на странице **свойств** .

### <a name="setting-your-characters-frame-size"></a>Задание размера кадра символов

Высота и ширина кадра анимации должны оставаться постоянными во всем определении символа (то есть для всех анимаций этого символа). Хотя размер кадра можно изменить с помощью значения по умолчанию (128 x 128 пикселей), изображения, отображаемые в редакторе, будут масштабироваться в соответствии с отображаемым размером по умолчанию. Если изменить параметр кадра по умолчанию, можно отобразить полный и немасштабируемый размер рамки, выбрав **открыть окно фрейма** в меню **Правка** .

### <a name="setting-your-characters-palette"></a>Настройка палитры символов

По умолчанию редактор использует первый загружаемый точечный рисунок, чтобы задать цветовую палитру по умолчанию для персонажа, цвета, определяющие, как выглядит символ, и задает цвет в 11-<sup>ой</sup> позиции палитры в качестве цвета прозрачности. Тем не менее можно явно задать палитру и прозрачность в группе **сведения о палитре** . Это позволяет указать файл изображения, используемый для палитры. Можно указать один из файлов изображений анимации или любой графический файл. Указанный файл палитры должен представлять собой 8-разрядный (256) цветовой файл. После загрузки используйте кнопку **изменить параметр** , чтобы изменить цвет прозрачности.

Цветовая палитра вашего символа не должна переназначить стандартные системные цвета. Редактор будет автоматически резервировать цветовую палитру системы при отображении изображений. Кроме того, все изображения анимации должны использовать одну и ту же цветовую палитру и цвет прозрачности. Это очень важно. В противном случае при загрузке в редактор вы можете увидеть цветное сопоставление изображений.

Хотя можно задать цветовую палитру для символа, в системах Windows, где свойства экрана установлены в 8-разрядную (256) цветовую палитру, цвет символа будет подвергаться текущей системной палитре. Так как приложения могут изменять системную палитру, символ может не отображаться с правильными параметрами цвета. Несмотря на то, что предотвратить это невозможно, можно уменьшить количество используемых цветов и задать палитру символов на основе палитры, используемой приложением, управляющим символом. Например, если вы разрабатываете символ, который будет использоваться с веб-страницами, можно задать палитру символов с помощью палитры полутонов Microsoft Internet Explorer. Можно захватить палитру браузера, щелкнув изображение на веб-странице правой кнопкой мыши и выбрав команду **Сохранить рисунок как** , а затем выбрав **точечный рисунок** в параметре **Сохранить как тип** , а затем нажав кнопку **сохранить**. Чтобы оптимизировать файлы изображений анимации в определенном файле палитры, может потребоваться использовать такие продукты, как равновесия Дебабелизер.

### <a name="creating-a-new-animation"></a>Создание новой анимации

После определения глобальных параметров анимации можно приступать к созданию анимации. Чтобы создать анимацию, выберите **создать** анимацию в меню **Правка** или нажмите кнопку **создать анимацию** на панели инструментов. При этом в дереве под значком **анимации** добавляется новый значок анимации и назначается имя нового значка по умолчанию. Вы можете переименовать анимацию, введя в поле **имя анимации** . Обратите внимание, что имена анимации в определении символа должны быть уникальными. Кроме того, старайтесь не использовать символы в имени, которые не являются допустимыми символами для имен файлов.

### <a name="adding-frames"></a>Добавление кадров

Каждая анимация состоит из кадров. Чтобы создать новый кадр для анимации, выберите пункт **создать рамку** в меню **Правка** или на панели инструментов. При этом в дерево под значком анимации добавляется новый значок кадра, и отображаются три страницы с вкладками. Страница **Общие** включает элементы управления, позволяющие загружать и настраивать изображение для рамки. Он также включает область отображения для внешнего вида рамки.

![Снимок экрана, на котором отображается область изображения с именем файла, путем и положением.](images/f2charflame.gif)

Кадр может содержать одно или несколько изображений. Чтобы определить изображение для рамки, нажмите кнопку **Добавить файл изображения** непосредственно над полем список **изображений** . Откроется диалоговое окно **Выбор файлов изображений** , в котором можно выбрать файл растрового изображения.

![Снимок экрана, на котором показан файл изображения, выбранный в проводнике.](images/f3chardialbox.gif)

Выберите файл, который требуется загрузить, нажмите кнопку **Открыть**, и изображение появится на странице **Общие** . Редактор принимает изображения, хранящиеся в виде 1-разрядного (монохромного), 4-разрядного или 8-разрядного формата точечного рисунка Windows или в формате GIF.

Для настройки внешнего вида изображения внутри рамки можно использовать четыре кнопки со стрелками под изображением в поле " **Расположение** ". Если изображение больше размера кадра, будет отображаться только часть изображения, отображаемая в кадре. Если увеличить размер кадра, изображение может масштабироваться в соответствии с областью экрана редактора.

Можно также отобразить рамку, выбрав **открыть окно фрейма** в меню **Правка** . При этом текущий кадр отображается в отдельном окне без масштабирования изображений, загруженных в кадр. Начальный размер этого окна зависит от настроек высоты и ширины рамки. Размер можно изменить меньше, но не больше. Окно фрейма отражает изменения, внесенные с помощью элементов управления в редакторе, а также позволяет просматривать фреймы при просмотре других страниц свойств.

![Снимок экрана, на котором отображается панель "позиционирование".](images/f4charposctrl.gif)

Кадр можно составить из нескольких изображений. Каждый раз, когда вы наберете кнопку **Добавить изображение** и выбираете другое изображение, изображение добавляется в список и в область изображения. Можно также добавить несколько образов, выбрав более одного файла. Нажмите клавиши SHIFT или CTRL при щелчке в диалоговом окне **Выбор файлов изображений** , а затем нажмите кнопку **Открыть**. Кнопки **вверх и** **вниз** над полем список **изображений** позволяют переместить выбранное изображение в порядке расположения (z-порядок) для рамки. Можно также перемещать изображения, перетаскивая их в списке. При выборе изображения в списке и нажатии кнопки **Удалить** изображение удаляется. Чтобы изменить образ, загруженный в другой файл изображения, можно щелкнуть имя файла, чтобы изменить его напрямую, или нажать кнопку **...** (многоточие), чтобы открыть диалоговое окно **Выбор файлов изображений** и выбрать другой файл.

![Снимок экрана, на котором отображается кнопка с многоточием.](images/f5charell.gif)

Для задания длительности кадра можно использовать текстовое поле **Длительность** . то есть, как долго будет отображаться рамка. Если кадр не имеет изображения и нулевая длительность, фрейм не будет отображаться при воспроизведении анимации.

Можно также указать файл звукового эффекта, который будет воспроизводиться при отображении кадра. Если вы планируете загружать символ с веб-сервера, может потребоваться сжать файл звукового эффекта, чтобы уменьшить время загрузки. Затем сжатый звуковой файл можно указать в редакторе символов агента. Кроме того, старайтесь не использовать звуковые эффекты с длительностью, превышающей длительность анимации, и особенно избегать звуковых эффектов, которые циклируют, поскольку службы анимации Microsoft Agent не отправляют событие завершения анимации до завершения звука. Кроме того, не следует задавать звуковой эффект для любой анимации, назначаемой состояниям **прослушивания** или **слуха** , так как это мешает речевому вводу. Наконец, хотя можно включить несколько звуковых эффектов в анимацию, старайтесь не размещать их так, чтобы они перекрывалися, так как это может повлиять на время анимации. Кроме того, помните, что звуковые эффекты могут воспроизводиться с различной скоростью в зависимости от оборудования пользователя.

Чтобы добавить кадры в анимацию, снова выберите команду **создать кадр** и выполните ту же процедуру. В качестве варианта можно также загрузить несколько изображений и автоматически создать для них новые кадры. Чтобы использовать эту функцию, выберите в меню **Правка** пункт **создать кадры из изображений** . Кадры будут создаваться в алфавитном порядке на основе имен файлов изображений. Завершив определение всех кадров для анимации, можно снова выбрать команду **создать анимацию** , чтобы начать новую анимацию.

Существуют и другие способы добавления кадров в анимацию и перемещения кадров внутри или между анимациями. Можно выбрать другой кадр (из той же или другой анимации), выбрать **Вырезать** или **Копировать**, затем выбрать анимацию или кадр в этой анимации и нажать кнопку **Вставить**. Можно также перетащить фрейм из одной анимации в другую. При перетаскивании в пределах анимации действие перемещается в рамку. При перетаскивании в другую анимацию она копируется. При перетаскивании в предыдущий кадр в той же анимации фрейм вставляется перед рамкой, в которую перетаскивается. При перетаскивании в следующий фрейм он помещается после фрейма, в который выполняется перетаскивание. При перетаскивании фрейма с помощью правой кнопки мыши при отпускании кнопки выводится всплывающее меню с выбранными параметрами перемещения.

Можно также создать анимацию, скопировав существующую анимацию (выберите анимацию и нажав кнопку **Копировать**) и щелкнув значок **анимации** или другой значок анимации и выбрав **Вставить**. Редактор автоматически создает новое имя для анимации, хотя это имя можно изменить.

### <a name="branching"></a>Ветвление

При создании рамки можно также определить, какой кадр будет воспроизводиться далее. По умолчанию следующий кадр, воспроизводимый в последовательности анимации, всегда является следующим кадром в z-порядке. Однако, выбрав страницу **ветвление** , можно задать вероятность для трех других кадров, которые может играть сервер. Введите процент вероятности и номер целевого кадра в соответствующих полях. Можно указать ветвление даже для фреймов, у которых нет изображений и для которых задано значение "ноль". Это позволяет создать ветвь без предварительного отображения определенного изображения.

![Снимок экрана, на котором показана страница "ветвление".](images/f6charbranch.gif)

Вы можете использовать функцию ветвления для создания анимации, которая будет бессрочно работать в цикле. Однако обратите внимание, что при воспроизведении циклической анимации другие анимации в очереди символов не воспроизводятся до тех пор, пока событие, такое как пользователь, не нажимает клавишу Push-to-разговора или клиентское приложение, вызывающее метод [**остановки**](stop-method.md) , останавливает циклическую анимацию. Поэтому внимательно рассмотрите контекст, в котором будет использоваться анимация, прежде чем создавать циклическую анимацию.

Страница ветвление также позволяет создавать ветви выхода. Ветвь выхода — это ветвь к кадру, который будет принимать анимация при остановке анимации и перед воспроизведением следующей анимации. Определение ветвей выхода позволяет плавно перемещаться при переходе от одной анимации к другой. Ветвление выхода не должно создавать циклическую петлю, но в конечном итоге должно иметь возможность выйти в последний кадр анимации.

Нет необходимости предоставлять ветвь Exit для каждого кадра, но если это не так, анимация будет следовать за нормальным ветвлением кадра. Если в кадре нет явной ветви, анимация автоматически подразделяется на следующий кадр. Например, при ветвлении из фрейма 3 в кадр 1, а в кадре 1 нет других ветвей (обычная или выходная ветвь), кадр 1 будет подветвление к кадру 2. Если в кадре 2 нет ветвления, анимация будет переходить к кадру 3, а у вас должен быть цикл. Вместо этого можно создать ветвь из фрейма 3 в кадр 1, а затем установить ветвь выхода Frame 1 в любой кадр, находящуюся после кадра 3, и, как правило, перейти к последнему кадру анимации.

Иногда может потребоваться создать явный окончательный кадр анимации, которая не воспроизводится, но обеспечивает завершение анимации. Например, необходимо выйти из анимации, но выйти на последний кадр не будет подходящим. Это можно сделать, создав пустой кадр нулевой длительности в качестве последнего кадра анимации. Это позволяет воспроизводить анимацию в обычном режиме с помощью последнего кадра анимации, а также позволяет предоставить конечную точку выхода для ветви выхода.

### <a name="previewing-an-animation"></a>Предварительный просмотр анимации

Вы можете просмотреть анимацию в редакторе символов агента, выбрав команду **Предварительный просмотр** в меню **Правка** или кнопку Предварительный просмотр на панели инструментов. Это воспроизводит анимацию, включая все ветви и звуковые эффекты, начиная с текущего выбранного кадра. При завершении анимации он сбрасывается до текущего выбранного кадра. Чтобы воспроизвести всю анимацию, перейдите к представлению в виде дерева, выберите значок анимации или первый кадр анимации и выберите команду **Предварительный просмотр** . Редактор выполняет анимацию кадров на странице **Общие** . Чтобы прерывать предварительную версию до ее завершения, выберите команду " **завершить предварительный просмотр** ". При воспроизведении предварительной версии команда **Предварительный просмотр** автоматически изменится на **прерывать Просмотр** .

Можно также выполнить предварительный просмотр ветви выхода, выбрав команду **Просмотр выхода из ветви** в меню **Правка** или на панели инструментов. Позволяет проверить, как будет отображаться ветвление выхода из любого конкретного кадра.

### <a name="assigning-speaking-overlays"></a>Назначение наложения речи

Можно определить символ, чтобы он выговорит во время последнего кадра анимации. В этом фрейме выберите страницу **наложения** . Эта страница позволяет загрузить и назначить файлы изображений рот стандартным позициям рот, поддерживаемым Microsoft Agent. Нажмите кнопку **Добавить изображение** и выберите изображение из диалогового окна. Можно также выбрать несколько образов, и редактор загрузит и назначит изображения, начиная с выбранного расположения рот. Нажмите кнопки **вверх и** **вниз** или перетащите запись, чтобы изменить назначение изображения в списке. Нажмите кнопку **Удалить** , чтобы удалить изображение. Можно также изменить путь к назначенному файлу, щелкнув его запись в списке и повторно введя его имя файла или нажав кнопку **с многоточием** , чтобы открыть диалоговое окно **Выбор файлов изображений** .

![Снимок экрана, на котором показана страница "наложения" с выбранным файлом.](images/f7charover.gif)

Наложение рта должно попадать в структуру основного кадра, по которому они будут отображаться. В противном случае они будут обрезаны до базового фрейма.

Если вы хотите, чтобы символ проходил от своего рта за пределами базового фрейма, например, когда символ должен проговаривать продвигаться, сначала создайте базовый фрейм с заголовком символа (или областью, которая будет перемещена как символ говорит) в качестве его верхнего изображения. Затем определите наложение рта, чтобы заменить этот образ и задать параметр **заменить базовый кадр сверху Image** . Можно также нажать кнопку **задать все** , чтобы установить этот параметр для всех наложения рта в кадре.

### <a name="assigning-a-return-animation"></a>Назначение анимации возврата

Чтобы создать плавный переход от одной анимации к другой, разработайте последовательности анимации, чтобы начинаться и заканчиваться нейтральным изображением. Дополнительные сведения см. в разделе [**Разработка символов для Microsoft Agent**](designing-characters-for-microsoft-agent.md). Однако это не означает, что каждая анимация должна заканчиваться на нейтральной позиции. Можно анимировать символ с помощью последовательности кадров, проговаривать его во время последнего кадра и создать отдельную дополнительную, дополняющую анимацию, которая возвращает символ в нейтральную точку. Эта дополняющая анимация называется анимацией возврата.

Вы можете определить обратную анимацию, создав явную анимацию для этой цели. Можно также создать обратную анимацию с помощью ветвления выхода, определенной в анимации. Чтобы назначить анимацию возврата, выберите анимацию в дереве и выберите созданную анимацию возврата или используйте команду выйти из ветви из раскрывающегося списка обратная анимация на странице Свойства.

Создание и назначение анимации возврата имеет дополнительное преимущество: когда сервер получает запрос на воспроизведение другой анимации, он пытается воспроизвести анимацию возврата для последней воспроизводимой анимации, если назначена обратная анимация. Это обеспечивает плавный переход. Если анимация начинается и заканчивается в нейтральной позиции, нет необходимости определять обратную анимацию. Аналогично, если вы планируете выполнять переходы от одной анимации к другой, вам может не понадобиться назначать анимацию возврата.

### <a name="assigning-animations-to-states"></a>Назначение анимаций состояниям

Службы анимации Microsoft Agent автоматически воспроизводят анимацию, когда в клиентском приложении размещения используются определенные методы. Например, когда приложение вызывает методы [**MoveTo**](moveto-method.md) и [**жестуреат**](gestureat-method.md) , сервер автоматически определяет место отображения символа и воспроизводит соответствующую анимацию. Аналогичным образом, Microsoft Agent автоматически воспроизводит мгновенное воспроизведение, когда пользователь не взаимодействовал с символом в течение нескольких секунд. Эти условия, когда сервер автоматически воспроизводит анимацию от имени приложения, называются *состояниями*. Однако для того, чтобы сервер знал, какую анимацию следует воспроизвести, необходимо присвоить этим состояниям анимацию.

Чтобы назначить анимацию или анимацию для состояния, создайте соответствующую анимацию, разверните запись состояния в представлении в виде дерева окна редактора и выберите значок состояния. Список созданных анимаций появится в поле со списком в правой части окна. Проверьте анимацию, которую нужно назначить этому состоянию. Обратите внимание, что для одного и того же состояния можно назначить несколько анимаций. Это позволяет серверу случайным образом выбирать различные анимации для состояния. Назначение анимации состояния не мешает анимации воспроизвести эту анимацию напрямую.

Можно также назначить анимацию для состояния, выбрав запись анимации в дереве. В поле список **назначить состояние** на странице **свойства** перечислены состояния. Установите флажок состояния, которому назначается анимация.

Редактор не поддерживает создание дополнительных состояний, так как состояния применимы только к ситуациям, когда сервер должен автоматически воспроизвести анимацию от имени клиентского приложения. Таким же преимуществом не является определение собственного состояния. При необходимости можно воспроизвести любую анимацию явным образом с помощью метода [**Play**](play-method.md) .

### <a name="saving-your-character-definition"></a>Сохранение определения символа

Файл определения символа можно сохранить, выбрав команду **сохранить** в меню **файл** или нажав кнопку **сохранить определение символа** на панели инструментов. Если необходимо сохранить файл определения символа с новым именем, выберите команду **Сохранить как** в меню **файл** . Редактор сохраняет редактируемое определение символа как определение символа агента (. Файл ACD). Кроме того, этот формат текстового файла можно изменить с помощью большинства текстовых редакторов и приложений для обработки текстов.

### <a name="printing-your-character-definition"></a>Печать определения символа

Чтобы напечатать определение символа, выберите команду **Печать** в меню **файл** или нажмите кнопку **Печать** на панели инструментов. Чтобы задать свойства для напечатанного вывода, выберите команду Параметры **страницы** и перед выбором команды **Печать** выберите нужные параметры.

### <a name="building-a-character"></a>Создание символа

По завершении создания анимации символы и изображения должны быть скомпилированы в специальный формат, используемый Microsoft Agent для загрузки этих данных. Чтобы создать символ, выберите команду построить символ в меню **файл** или на панели инструментов. При наличии несохраненных изменений в файле определения символов редактор сохраняет файл определения перед отображением диалогового окна " **символ сборки** ".

![Снимок экрана, показывающий окно "сборка символа" с выбранным файлом.](images/f8charbldg.gif)

Редактор символов агента будет автоматически предлагать имя файла на основе имени файла определения символа. Диалоговое окно "символ сборки" также содержит раскрывающийся список, позволяющий выбирать между созданием символа в виде одного файла хранилища (. ACS) или как несколько файлов. При выборе второго варианта редактор создает. ACF файл, содержащий символьные данные и. Файл ака для каждой созданной анимации. Если вы планируете установить и получить доступ к символу, хранящемуся на том же компьютере, что и клиентское приложение, обычно выбирается один структурированный формат файла. Этот формат обеспечивает простую и эффективную установку и доступ к символу. Однако если доступ к символу будет осуществляться с веб-сервера по протоколу HTTP, создайте свой символ с помощью. ACF (индивидуальный) формат файла. Эта последняя структура файлов позволяет скрипту веб-страницы загружать отдельные файлы анимации, сохраняя их в кэше файлов браузера пользователя. Он обеспечивает более эффективный доступ через Интернет, так как данные анимации можно загружать по мере необходимости, не требуя от пользователя ожидания загрузки всего набора анимаций одновременно. Кроме того, поскольку данные символов хранятся в кэше браузера, место в файле может быть восстановлено автоматически.

Хотя можно также загружать символьные данные (как один структурированный файл или несколько файлов) с веб-сервера и устанавливать их на компьютере пользователя, такой метод требует обеспечения безопасности для загрузки и установки. В результате API Microsoft Agent не включает поддержку скачиваемой установки символа, за исключением кэша браузера. Тем не менее можно по-прежнему поддерживать этот сценарий, создавая собственный элемент управления установкой и распространяющий его после соответствующих соглашений безопасности. Дополнительные сведения см. в пакете Microsoft Internet Client Development Kit.

Параметр сжатия позволяет установить, следует ли сжимать символьные данные. Как правило, необходимо установить этот параметр для сжатия символьных данных, хотя создание символа с сжатыми данными занимает больше времени.

После создания символа последующие сборки будут выполняться быстрее при создании символа в том же расположении каталога. Редактор символов автоматически проверяет и копирует эти файлы, которые не были изменены, и перекомпилирует все измененные данные.

Если редактор обнаруживает ошибки в символьном файле при сборке символа, он записывает данные в файл журнала и отображает окно сообщения. Вы можете просмотреть файл журнала или проигнорировать его и прочитать его позже с помощью текстового редактора. Однако обратите внимание, что редактор будет перезаписывать файл журнала при следующей сборке символьного файла.

### <a name="editing-an-existing-character"></a>Изменение существующего символа

Чтобы изменить существующий символ, выберите **Открыть** в меню **файл** и выберите файл определения символа (. ACD) в открывшемся диалоговом окне и выберите Открыть. Файл будет загружен в редактор. Обратите внимание, что невозможно загрузить скомпилированные символьные файлы (. ACS,. ACF или. АКА) с редактором.

Так как файл определения символа (. ACD) — это текстовый файл. определение символа можно также изменить, открыв файл в текстовом редакторе или программе обработки текста. Однако при завершении изменений необходимо сохранить файл в исходном формате перед его загрузкой в редактор символов для компиляции.

 

 




