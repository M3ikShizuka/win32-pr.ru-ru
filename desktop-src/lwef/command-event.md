---
title: Командное событие
description: Командное событие
ms.assetid: 3e180286-dfa0-4b34-90ee-3267ed6f48af
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5647e7eac3aaba0a6094be6b52cc3726eba34ad7
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127567574"
---
# <a name="command-event"></a>Командное событие

\[Microsoft Agent является устаревшим по отношению к Windows 7 и может быть недоступен в последующих версиях Windows.\]

<dl> <dt>

<span id="Description"></span><span id="description"></span><span id="DESCRIPTION"></span>**Nописание**
</dt> <dd>

Происходит, когда пользователь выбирает команду (клиента).

</dd> <dt>

<span id="Syntax"></span><span id="syntax"></span><span id="SYNTAX"></span>**Syntax**
</dt> <dd>

 Команда подпрограммы " *подагент* \_  " **(ByVal** *UserInput * *)**



| Часть        | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|-------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| *UserInput* | Определяет объект [**команды**](/windows/desktop/lwef/the-command-object) , возвращаемый сервером. <br/> Из объекта [**Command**](/windows/desktop/lwef/the-command-object) можно получить доступ к следующим свойствам:<br/> чарактерид <br/> Строковое значение, определяющее имя (идентификатор) символа, который получил команду. <br/> [**Имя**](name-property.md)<br/> Строковое значение, определяющее имя (идентификатор) команды.<br/> [**Уровень**](confidence-property.md)<br/> Длинное целое значение, указывающее на оценку достоверности для команды. <br/> [**Голосовая связь**](voice-property.md) <br/> Строковое значение, определяющее текст голоса для команды.<br/> Alt1Name <br/> Строковое значение, идентифицирующее имя следующей (второй) команды.<br/> Alt1Confidence <br/> Длинное целое значение, указывающее на оценку достоверности для следующей (второй) команды.<br/> Alt1Voice <br/> Строковое значение, определяющее текст голоса для следующей наиболее подходящей альтернативной команды.<br/> Alt2Name <br/> Строковое значение, определяющее имя наиболее подходящего совпадения команды.<br/> Alt2Confidence <br/> Длинное целое число, определяющее оценку достоверности для третьей наиболее подходящей команды.<br/> Alt2Voice <br/> Строковое значение, определяющее текст голоса для третьей наиболее подходящей команды.<br/> [**Расчета**](count-property.md) <br/> Длинное целое значение, указывающее количество возвращаемых вариантов.<br/> |



 

</dd> </dl>

### <a name="remarks"></a>Комментарии

Сервер уведомляет об этом событии, когда ваше приложение является активным, и пользователь выбирает команду во всплывающем меню речевого ввода или символа. Событие передает количество возможных совпадающих команд в [**количестве**](count-property.md) , а также имя, оценку достоверности и голосовое сообщение для этих совпадений.

Если речевой ввод активирует это событие, сервер возвращает строку, которая определяет наилучшее соответствие в параметре [**Name**](name-property.md) , а второе и лучшее соответствие — в Alt1Name и Alt2Name. Пустая строка указывает, что входные данные не совпали ни с одной из команд, определенных приложением. Например, это может быть одна из определяемых сервером команд. Значение, если команда была сопоставлена с командой агента; Например, если скрыть, в параметре **Name** будет возвращена пустая строка, но вы по-прежнему получите текст, полученный в параметре [**Voice**](voice-property.md) .

Можно получить одно и то же имя команды, возвращаемое в нескольких записях. Параметры [**достоверности**](confidence-property.md), Alt1Confidence и Alt2Confidence возвращают относительные результаты в диапазоне от-100 до 100, которые возвращаются модулем распознавания речи для каждого соответствующего соответствия. Параметры [**Voice**](voice-property.md), Alt1Voice и Alt2Voice возвращают голосовый текст, который подсистема распознавания речи соответствует альтернативе. Если [**Count**](count-property.md) возвращает ноль (0), сервер обнаружил речевой ввод, но определил, что соответствующая команда не найдена.

Если речевой ввод не является источником команды, например, если пользователь выбрал команду во всплывающем меню символа, сервер возвращает имя (ID) команды, выбранной в свойстве [**Name**](name-property.md). Он также возвращает значение параметра [**достоверности**](confidence-property.md) , равное 100, и значение [**голосовыми**](voice-property.md) параметрами в виде пустой строки (""). Alt1Name и Alt2Name также возвращают пустые строки. Alt1Confidence и Alt2Confidence возвращают ноль (0), а Alt1Voice и Alt2Voice возвращают пустые строки. Функция [**Count**](count-property.md) возвращает значение 1.

> [!Note]  
> Не все модули распознавания речи могут возвращать все значения для всех параметров этого события. Обратитесь к поставщику подсистемы, чтобы определить, поддерживает ли подсистема интерфейс API распознавания речи Майкрософт для возврата альтернатив и оценки достоверности.

 

 

