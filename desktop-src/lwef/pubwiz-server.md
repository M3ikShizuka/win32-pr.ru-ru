---
title: Разработка Server-Side
description: Функции на стороне сервера взаимодействуют с мастером клиента через объект Windows. external. Сценарий на стороне сервера предоставляет эти функции для реагирования на события мастера и для получения сведений о мастере.
ms.assetid: 7cc8b814-f230-4326-a9df-a491ed35483e
keywords:
- мастера публикации, проектирование на стороне сервера
- Window. external, мастера публикации
- мастера публикации, Window. external
- мастера публикации, функции сценариев навигации
- сценарии, мастера публикации
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 20b3b218bbca297be446016335d90fe717a88bba
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "103987516"
---
# <a name="server-side-design"></a>Разработка Server-Side

Функции на стороне сервера взаимодействуют с мастером клиента через объект **Windows. external** . Сценарий на стороне сервера предоставляет эти функции для реагирования на события мастера и для получения сведений о мастере.

В этом документе рассматриваются следующие темы.

-   [Реализация функций скрипта навигации](#implementing-navigation-script-functions)
    -   [Onback ()](#onback)
    -   [OnNext ()](#onnext)
    -   [OnCancel ()](#oncancel)
-   [Другие методы и свойства](#other-methods-and-properties)
    -   [Методы](#methods)
    -   [Свойства](#properties)
-   [См. также](#related-topics)

## <a name="implementing-navigation-script-functions"></a>Реализация функций скрипта навигации

Серверный сценарий на каждой HTML-странице реагирует на кнопки навигации с помощью функций **onback**, **onback** и **onback**. Эти функции должны быть доступны через **\_ сценарий ихтмлдокумент:: Get** на клиенте и не принимают параметров.

### <a name="onback"></a>Onback ()

-   Реагирует, когда пользователь нажимает кнопку " **назад** " в мастере.
-   Если текущая страница на стороне сервера является первой страницей на стороне сервера, вызовите метод **Window. external. финалбакк** , чтобы сообщить клиенту о переходе на предыдущую страницу на стороне клиента.
-   Если текущая страница на стороне сервера не является первой страницей на стороне сервера, перейдите на предыдущую страницу на стороне сервера.
-   Эта функция должна быть реализована для каждой страницы. Любая страница, которая не выполняется, считается недопустимой и отображает страницу ошибки.

### <a name="onnext"></a>OnNext ()

-   Реагирует, когда пользователь нажимает кнопку " **Далее** " в мастере.
-   Если текущая страница на стороне сервера является последней страницей на стороне сервера, вызовите метод **Window. external. финалнекст** , чтобы сообщить клиенту о необходимости перехода на следующую страницу на стороне клиента или для завершения работы мастера.
-   Если текущая страница на стороне сервера не является последней страницей на стороне сервера, перейдите к следующей странице на стороне сервера.

### <a name="oncancel"></a>OnCancel ()

-   Реагирует, когда пользователь нажимает кнопку **"Отмена"** в мастере.
-   Пользовательский интерфейс должен быть спроектирован таким образом, чтобы пользователь мог отменять его в любое время.
-   После обработки любой обработки в функции **OnCancel** клиент закрывает мастер.

## <a name="other-methods-and-properties"></a>Другие методы и свойства

Доступ к реализованным клиентом функциям осуществляется через **Windows. external**, как и свойства. Доступны следующие службы:

### <a name="methods"></a>Методы

-   [**сесеадертекст**](/windows/desktop/shell/iwebwizardhost-setheadertext)
-   [**сетвизардбуттонс**](/windows/desktop/shell/iwebwizardhost-setwizardbuttons)
-   [**пасспортаусентикате**](/windows/desktop/shell/inewwdevents-passportauthenticate)

### <a name="properties"></a>Свойства

-   [**Заголовок**](/previous-versions/windows/desktop/legacy/bb774352(v=vs.85))
-   [**Свойство**](/windows/desktop/shell/iwebwizardhost-property)

В следующем примере кода показан код на стороне сервера для простой страницы мастера, которая реализует страницу ошибки веб-службы.


```
<html>
    <head>
        <script language="JavaScript">
            function window.onload()
            {
                window.external.SetWizardButtons(1, 0, 0);    
                <!-- Back button enabled -->
            }

            function window.onback()
            {
                window.external.FinalBack();
            }
        </script>
    </head>
.
.
.
</html>
                    
```



## <a name="related-topics"></a>См. также

<dl> <dt>

[Проектирование на стороне клиента](pubwiz-client.md)
</dt> <dt>

[Регистрация службы](pubwiz-reg.md)
</dt> </dl>

 

 