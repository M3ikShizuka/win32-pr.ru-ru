---
title: События речевого ввода
description: События речевого ввода
ms.assetid: d7b621fe-9274-4b16-af8a-664b0b296c89
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f0dc75bb010286b7645c206d192913017472829d
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104068644"
---
# <a name="speech-input-events"></a>События речевого ввода

\[Microsoft Agent является устаревшим в Windows 7 и может быть недоступен в последующих версиях Windows.\]

Кроме того, в уведомление о событии [**команды**](command-event.md) агент также уведомляет клиент ввода, когда сервер включает или выключает режим прослушивания с помощью событий [**листенстарт**](listenstart-event.md) и [**Листенкомплете**](listencomplete-event.md) ([**иажентнотифисинкекс:: листенингстате**](iagentnotifysinkex--listeningstate.md)). Тем не менее, если пользователь нажимает клавишу режима прослушивания и отсутствует соответствующий механизм распознавания речи для верхнего символа клиента input-Active, сервер запускает режим быстрого нажатия, но не создает событие **листенстарт** для активного клиента символа. Если до завершения времени ожидания пользователь активирует другой символ с поддержкой модуля распознавания речи, сервер пытается активировать речевой ввод и создает событие **листенстарт** .

Аналогичным образом, если клиент пытается включить режим прослушивания с помощью метода [**Listen**](listen-method.md) и не существует соответствующего механизма распознавания речи, происходит сбой вызова и сервер не создает событие [**листенстарт**](listenstart-event.md). В элементе управления Microsoft Agent метод **Listen** возвращает **значение false**, но вызов не вызывает ошибку.

Если включен режим прослушивания ключей и пользователь переключается на символ, использующий другой модуль распознавания речи, сервер переключается на и активирует этот модуль и запускает [**листенкомплете**](listencomplete-event.md) , а затем событие [**листенстарт**](listenstart-event.md) . Если активированный символ не имеет доступного модуля распознавания речи (так как он не установлен или не соответствует параметру идентификатора языка активированного символа), сервер активирует событие **листенкомплете** для ранее активированного символа и передает обратно значение в параметре **причины** . Однако сервер не создает события **листенстарт** или **листенкомплете** для клиентов, не поддерживающих распознавание речи.

Если клиент успешно вызывает метод [**Listen**](listen-method.md) , а символ без поддержки модуля распознавания речи становится входным, до завершения ожидания, а затем пользователь возвращается к символу исходного клиента, сервер создает событие [**листенстарт**](listenstart-event.md) для этого клиента.

Если входной-активный клиент переключает модули распознавания речи, изменяя [**срмодеид**](srmodeid-property.md) в режиме прослушивания, сервер переключается на этот модуль и активирует его без повторного запуска события [**листенстарт**](listenstart-event.md) . Однако если указанный обработчик недоступен, вызов завершается неудачно (вызывает ошибку в элементе управления), а сервер также вызывает событие [**листенкомплете**](listencomplete-event.md) .

 

 




