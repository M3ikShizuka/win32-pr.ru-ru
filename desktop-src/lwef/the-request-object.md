---
title: Объект запроса
description: Объект запроса
ms.assetid: d8b37164-6855-48c0-bcf8-a86c0f8b3a59
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9a50d554a5799af9a434b456113d7c826d2a0aa2
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "105700849"
---
# <a name="the-request-object"></a>Объект запроса

\[Microsoft Agent является устаревшим в Windows 7 и может быть недоступен в последующих версиях Windows.\]

Сервер обрабатывает некоторые методы асинхронно. Это позволяет коду приложения продолжать работу во время выполнения метода. Когда клиентское приложение вызывает один из этих методов, элемент управления создает и возвращает объект [**запроса**](/windows/desktop/lwef/the-request-object) для запроса. Объект **request** можно использовать для наблюдения за состоянием метода путем назначения объектной переменной для метода. В Visual Basic сначала объявите объектную переменную:


```
   Dim MyRequest as Object
```



В VBScript вы не включаете тип переменной в объявление:


```
   Dim MyRequest
```



И используйте инструкцию SET Visual Basic, чтобы присвоить переменную вызову метода:


```
   Set MyRequest = <i>agent</i>.Characters("<i>CharacterID</i>").<i>method</i> (<i>parameter</i>[s])
```



При этом добавляется ссылка на объект [**запроса**](/windows/desktop/lwef/the-request-object) . Объект **запроса** будет уничтожен, если на него больше нет ссылок. Место объявления объекта **запроса** и его использование определяет время его существования. Если объект объявлен как локальный для подпрограммы или функции, он будет разрушен при выходе за пределы области действия. то есть при завершении подпрограммы или функции. Если объект объявлен глобально, он не уничтожается до тех пор, пока не будет выполнено завершение программы или для объекта будет назначено новое значение (или значение, заданное как пустое).

Объект [**request**](/windows/desktop/lwef/the-request-object) предоставляет несколько свойств, которые можно запросить. Например, свойство [**Status**](status-property.md) возвращает текущее состояние запроса. Это свойство можно использовать для проверки состояния запроса:


```
   Dim MyRequest
   
   Set MyRequest = Agent1.Characters.Load ("Genie", "https://agent.microsoft.com/characters/v2/genie/genie.acf")

   If (MyRequest.Status = 2) then
      'do something

   Else If (MyRequest.Status = 0) then
      'do something right away

   End If
```



Свойство [**Status**](status-property.md) возвращает состояние объекта [**запроса**](/windows/desktop/lwef/the-request-object) в виде длинного целого значения.



| Состояние | Определение                                        |
|--------|---------------------------------------------------|
| 0      | Запрос успешно выполнен.                   |
| 1      | Сбой запроса.                                   |
| 2      | Ожидание запроса (в очереди, но не завершено). |
| 3      | Запрос прерван.                              |
| 4      | Запрос выполняется.                              |



 

Объект [**request**](/windows/desktop/lwef/the-request-object) также содержит длинное целое значение в свойстве [**Number**](https://www.bing.com/search?q=**Number**) , которое возвращает ошибку или причину кода [**состояния**](status-property.md) . Если нет, это значение равно нулю (0). Свойство [**Description**](description-property.md) содержит строковое значение, соответствующее номеру ошибки. Если строка не существует, **Описание** содержит сообщение об ошибке, определяемое приложением или объектом.

Значения и значение, возвращаемое свойством [**Number**](https://www.bing.com/search?q=**Number**) , см. в разделе [коды ошибок](microsoft-agent-error-codes.md).

Сервер размещает запросы анимации в очереди указанного символа. Это позволяет серверу воспроизводить анимацию в отдельном потоке, и код приложения может продолжаться во время воспроизведения анимации. При создании ссылки на объект [**запроса**](/windows/desktop/lwef/the-request-object) сервер автоматически оповещает вас о начале или завершении запроса анимации с помощью событий [**рекуестстарт**](https://www.bing.com/search?q=**RequestStart**) и [**рекуесткомплете**](https://www.bing.com/search?q=**RequestComplete**) . Поскольку методы, возвращающие объекты **запроса** , являются асинхронными и могут не завершиться в области вызывающей функции, объявите ссылку на объект **запроса** глобально.

Для возврата объекта [**запроса**](/windows/desktop/lwef/the-request-object) можно использовать следующие методы: [**жестуреат**](gestureat-method.md), [**Get**](get-method.md), [**Hide**](hide-method.md), [**interrupt**](interrupt-method.md), [**Load**](load-method.md), [**MoveTo**](moveto-method.md), [**Play**](play-method.md), [**Показать**](show-method.md), [**говорите**](speak-method.md)и [**Wait**](https://www.bing.com/search?q=**Wait**).

 

 