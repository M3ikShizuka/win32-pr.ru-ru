---
title: Метод Activate
description: Метод Activate
ms.assetid: 8111139d-1453-416e-8f08-38c06669ff4d
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5032c7c7f2faf7ec53028a0cc0ce55847fe300864bb531968fc8190b4e00d164
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118753163"
---
# <a name="activate-method"></a>Метод Activate

\[Microsoft Agent является устаревшим по отношению к Windows 7 и может быть недоступен в последующих версиях Windows.\]

<dl> <dt>

<span id="Description"></span><span id="description"></span><span id="DESCRIPTION"></span>[**Nописание**](../wmformat/description.md)
</dt> <dd>

Задает активный клиент или символ.

</dd> <dt>

<span id="Syntax"></span><span id="syntax"></span><span id="SYNTAX"></span>**Syntax**
</dt> <dd>

*Агент ***. Символы ("**_чарактерид_*_")._ *  \[ *Состояние* активации\]



| Часть    | Описание                                                                                                                                                                           |
|---------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| *Состояние* | Необязательный элемент. Для этого параметра можно указать следующие значения: 0 — не активный клиент.<br/> 1 активный клиент. <br/> 2 (по умолчанию) верхний символ.<br/> |



 

</dd> </dl>

## <a name="remarks"></a>Remarks

Если отображается несколько символов, только один из них получит речевой ввод за раз. Аналогично, если несколько клиентских приложений совместно используют один и тот же символ, только одна из них получает ввод мыши (например, элемент управления агента Microsoft Agent щелкнул или перетаскивает события). Кодировка для получения входных данных мыши и речи — самый верхний символ, а клиент, получающий входные данные, — это активный клиент этого символа. (Окно с самым верхним символом также отображается в верхней части z-порядка окна символов.) Как правило, пользователь определяет верхний символ путем явного выбора символа. Однако самая верхняя активация также изменяется при отображении или скрытии символа (он становится или больше не выше самого верхнего, соответственно).

Этот метод также можно использовать для явного управления тем, когда клиент получает входные данные, направленные на символ, например, когда само приложение станет активным. Например, если задать для параметра *State* значение 2, то символ верхнего уровня и клиент получит все события ввода речи и речевых сообщений, созданные при взаимодействии пользователя с этим символом. Таким образом, он также делает клиент клиентом для ввода активного символа.

Однако вы также можете задать для себя активный клиент для символа, не выполняя его самым верхним, установив для параметра *State* значение 1. Это позволяет клиенту получить входные данные, направленные на этот символ, когда символ станет самым верхним. Аналогичным образом можно настроить клиент так, чтобы он не был активным клиентом (не получать входные данные), когда символ станет самым верхним, установив для параметра *State* значение 0.

Избегайте вызова этого метода непосредственно после метода [**представления**](/previous-versions/visualstudio/foxpro/d79z7xxa(v=vs.71)) . **Показывать** автоматически задает клиент input-Active. Если символ скрыт, вызов [**активации**](/previous-versions/visualstudio/foxpro/01ayxx68(v=vs.71)) может завершиться ошибкой, если он будет обработан до завершения метода **представления** .

При вызове этого метода для функции он возвращает логическое значение, указывающее, был ли метод обработан удачно. Попытка вызвать этот метод с параметром *State* , равным 2, если указанный символ является скрытым, приведет к сбою. Аналогично, если задать для параметра *State* значение 0, а приложение является единственным клиентом, этот вызов завершается неудачей, поскольку символ должен всегда иметь самый верхний клиент.


```
   Dim Genie as Object

   Sub FormLoad()

   Agent1.Characters.Load "Genie", "Genie.acs"

   Set Genie = Agent1.Characters ("Genie")

   If (Genie. Activate = True) Then
      'I'm active

   Else
      'I must be hidden or something

   End If 
   
   End Sub
```



> [!Note]  
> Вызов этого метода с *состоянием* , установленным в значение 1, обычно не создает событие [**активатеинпут**](https://www.bing.com/search?q=**ActivateInput**) , если другие символы не загружены или приложение уже находится в режиме ввода.

 

## <a name="see-also"></a>См. также:

[**Событие активатеинпут**](activateinput-event.md), [ **событие деактиватеинпут**](deactivateinput-event.md)


 

