---
title: Windows Поиск на рабочем столе 2. x
description: знакомство Windows Desktop Search 2. x. для Windows выпусков более поздней версии, чем Windows XP и Windows Server 2003, используйте вместо этого поиск Windows.
ms.assetid: 3d73f850-58b8-4a41-8863-e2914661d4b9
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d3298d668266d913a427c74f605435257c1a4cfba56fae82c809bd9127e7ecf6
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119829104"
---
# <a name="windows-desktop-search-2x"></a>Windows Поиск на рабочем столе 2. x

> [!NOTE]
> Windows настольный поиск 2. x — это устаревшая технология, которая изначально была доступна в качестве надстройки для Windows XP и Windows Server 2003. в более поздних выпусках используйте вместо этого [Windows поиск](../search/-search-3x-wds-overview.md) .

использование и разработка версий 2. x Microsoft Windows Desktop search (WDS) настоятельно не рекомендуется в пользу [Windows поиска](../search/-search-3x-wds-overview.md).

WDS — это служба индексирования и платформа, которая обеспечивает быстрый поиск файлов и данных в различных источниках данных и расположениях. WDS помогает пользователям и другим приложениям находить практически любые данные на своих компьютерах, сообщения электронной почты, встречи календарей, фотографии, документы и многое другое. кроме того, службы WDS могут возвращать результаты из нескольких источников данных в среде Windows Explorer, чтобы пользователи могли быстро просматривать, фильтровать и выполнять результаты поиска.

Службы WDS индексируют данные в заданной области обхода, в указанных расположениях на локальном компьютере и в общей сети, для которых индексатор должен выполнить обход содержимого. Эту область обхода можно контролировать с помощью параметров набора пользователей, API-интерфейсов управления и групповых политик, которые сетевые администраторы могут настраивать для управления разрешениями на доступ пользователей и параметрами индексирования. Групповые политики могут ограничивать доступ к определенным сетевым ресурсам, а также определять индексируемые ресурсы.

В этом разделе рассматриваются следующие вопросы.

-   [Обзор](#windows-desktop-search-2x)
    -   [Об индексаторе WDS](#about-the-wds-indexer)
    -   [Сведения о каталоге WDS](#about-the-wds-catalog)
    -   [Сведения о поисковой подсистеме и результатах](#about-the-search-engine-and-results)
-   [Разработка с помощью WDS](#developing-with-wds)
    -   [Добавление данных в индекс с помощью надстроек](#adding-data-to-the-index-with-add-ins)
    -   [Запрос индекса](#querying-the-index)
-   [Требования к совместимости](#compatibility-requirements)
    -   [Требования к системе](#system-requirements)
-   [См. также](#related-topics)

## <a name="overview"></a>Обзор

### <a name="about-the-wds-indexer"></a>Об индексаторе WDS

при первой установке индексатор обходит наиболее распространенные пользовательские файлы в папке «мои документы», папки электронной почты microsoft Outlook и microsoft Outlook Express, а также расположения, указанные в групповая политика. Кроме того, пользователи могут указать новые файлы и расположения, которые индексатор должен включить (или исключить) при последующих обходе. Каждое включенное расположение идентифицируется по URL-адресу, а индексатор запустится по этому URL-адресу и рекурсивно перебирает все вложенные папки или расположения до тех пор, пока не будут проиндексированы все элементы. Область — это набор URL-адресов. Интерфейсы API управления могут использоваться пользовательскими приложениями для определения области сканирования, набора URL-адресов, указывающих на пути в рамках протокола, например `file://` для папок на диске или `mapi:// ` для хранилищ сообщений электронной почты MAPI, таких как Outlook. Службы WDS используют обработчики протоколов для доступа к хранилищам данных и фильтрам для анализа и индексирования текста и свойств элементов. Затем эти данные сохраняются в каталоге.

### <a name="about-the-wds-catalog"></a>Сведения о каталоге WDS

Каталог WDS — это индекс текста и свойств, собираемых из элементов в указанном электронном письме, локальных дисках, сетевых ресурсах и других локальных хранилищах данных. Содержимое каталога основано на параметрах и наборах правил, установленных WDS, приложениях, созданных на платформе WDS, пользовательских настройках и групповых политик. Для каждого индексированного элемента доступно более 200 свойств, таких как Дата создания, размер и свойства конкретного типа ("из" для сообщений электронной почты). Список этих свойств см. в [справочнике по схемам](-search-2x-wds-schematable.md)WDS.

### <a name="about-the-search-engine-and-results"></a>Сведения о поисковой подсистеме и результатах

в WDS Deskbar или в Windows Explorer пользователи могут выполнять поиск в полнотекстовом содержимом и метаданных свойств индексированных элементов. Аналогичные виды поиска также можно инициировать из командной строки, с веб-страницы или из пользовательского приложения. средство поиска WDS находит элементы, соответствующие условиям поиска, и возвращает их в виде результирующих наборов Microsoft объекты данных ActiveX (ADO). WDS отображает элементы, соответствующие условиям поиска, и может предоставить расширенный предварительный просмотр элемента. Можно создавать приложения для перехвата поискового запроса, выполнения поиска и (или) вывода результирующего набора.

## <a name="developing-with-wds"></a>Разработка с помощью WDS

Существует два основных типа интеграции с WDS: Добавление данных в индекс и запрос содержимого индекса для получения записей, соответствующих условиям поиска.

### <a name="adding-data-to-the-index-with-add-ins"></a>Добавление данных в индекс с помощью Add-Ins

Существует по сути два типа источников данных: хранилища файловой системы и нефайловые системы хранения. Группа файлов в моем документе представляет собой простое хранилище файловой системы. WDS может выполнять поиск данных в файлах, хранящихся в такой файловой системе, если он может найти фильтр для этого типа файлов. WDS можно включить для индексирования нового собственного типа файлов, если для этого типа файла предоставляется реализация интерфейса [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter).

Несистемному хранилищу, например базе данных, требуется обработчик протокола, чтобы разрешить WDS перемещаться по данным и индексировать их в хранилище данных. например, если у вас есть почтовый клиент, хранящий свой список полученных сообщений электронной почты в собственном файле (например, PST-файлы в Outlook), можно предоставить обработчик протокола для индексирования и поиска по каждому отдельному письму, предоставив обработчик протокола. Если хранилище данных является иерархическим, потребуется также реализовать интерфейс [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)для перечисления элементов в хранилище. Для более эффективного взаимодействия с пользователем можно реализовать расширение оболочки для предоставления контекстных меню и значков в представлении результатов.

В настоящее время WDS содержит фильтры для более чем 200 типов элементов (включая элементы с открытым текстом, такие как HTML, XML и файлы исходного кода) и использует ту же технологию [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter)и обработчик протокола, что и SharePoint Services. Если для собственных типов файлов уже установлены фильтры, службы WDS могут использовать существующие интерфейсы фильтра для индексирования этих данных.

### <a name="querying-the-index"></a>Запрос индекса

Службы WDS предоставляют приложениям настроенные результирующие наборы данных из индекса на основе любого из доступных значений схемы. Результаты возвращаются в виде наборов записей ADO. Существует четыре способа включения WDS-запросов в приложение, каждое из которых предлагает различные уровни настройки и надежности.

-   интерфейс исеарчдесктоп. интерфейсы api в этом интерфейсе используются для программного вызова служб WDS путем указания строки запроса, списка возвращаемых столбцов, ограничений области действия, аналогичного предложению язык SQL (SQL) where, и имени столбца, по которому выполняется сортировка. Эти API-интерфейсы доступны для машинного и управляемого кода.
-   управление ActiveX wds. этот элемент управления рисует интерфейс поиска WDS и управляет поиском и отображением результатов. Этот метод проще, чем использование API, но менее гибкий. чтобы использовать этот элемент управления в Microsoft Visual Studio приложении, перейдите в диалоговое окно **выбор элементов панели элементов** в меню **сервис** и добавьте в **область элементов** на вкладке **COM-компоненты** пункт "Windows поиск на рабочем столе — средство просмотра результатов". Затем добавьте элемент управления в форму, в которой необходимо включить его. элемент управления wds ActiveX совместим с wds 2. x и 3. x только в Windows XP.
-   Параметры командной строки — приложения могут вызывать исполняемый файл WDS с различными параметрами для поиска и вывода результатов. Откроется окно WDS с отображаемыми результатами. Это самый простой способ добавить поиск в приложение, но не вернется в вызывающее приложение никаких сведений о том, что делает пользователь в окне WDS.
-   Объект модуля поддержки (BHO) в браузере WDS. Аналогичным образом веб-страницы могут использовать объект BHO для отправки запросов в службы WDS или зарегистрированное приложение поиска. После проверки URL-адреса веб-страниц по списку надежных доменов WDS службы WDS будут выполнять запрос и отображать результаты с помощью стандартного интерфейса поиска или передавать запрос в зарегистрированное приложение поиска.

С помощью [расширенного синтаксиса запросов](-search-2x-wds-aqsreference.md) пользователи могут более эффективно выполнять запросы к каталогам, управляя областью поиска и сочетанием поисковых параметров с помощью логических операторов. Например, пользователь может найти вложение в сообщении электронной почты от Джон, включающее "расписание проекта" или "план проекта", с запросом следующего вида: `from:John isattachment:true "project schedule" OR "project plan"` .

## <a name="compatibility-requirements"></a>Требования к совместимости

WDS 2.6.5 доступна для Windows 2000, Windows Server 2003 и только для Windows XP. WDS — это отдельный загружаемый пакет от корпорации Майкрософт, который можно бесплатно использовать для личного и делового использования. Он должен быть установлен и использоваться для индексирования учетной записи пользователя, прежде чем приложения, созданные для WDS 2.6.5, будут работать.

### <a name="system-requirements"></a>Требования к системе

для использования Windows поиска на рабочем столе необходимо следующее:

-   Windows Internet Explorer или более поздней версии.
-   чтобы включить сообщения электронной почты в каталог, требуется microsoft microsoft Outlook 2000 или более поздней версии или microsoft Outlook Express 6,0 или более поздней версии.
-   для полной предварительной версии документов Microsoft Microsoft Office в представлении результатов требуется Office XP или более поздней версии.
-   Минимальный процессор с процессором Pentium 500 МГц (рекомендуется 1 ГГц).
-   Windows XP, Windows 2000 SP4 или более поздней версии или Windows Server 2003 с пакетом обновления 1 (sp1).
-   Минимум 128 МБ ОЗУ (рекомендуется 256 МБ).
-   рекомендуется 500 МБ свободного места на жестком диске. Размер индекса зависит от объема индексируемого содержимого.
-   рекомендуется разрешение экрана 1024 x 768.

## <a name="related-topics"></a>Связанные разделы

1.  Запрос индекса

    -   [Программный вызов WDS (через Исеарчдесктоп)](-search-2x-wds-callingwdsprogrammatically.md)
    -   [Вызов WDS из веб-страниц](-search-2x-wds-browserhelpobject.md)
    -   [Вызов WDS из командной строки](-search-2x-wds-fromcommandline.md)

2.  [Расширение индекса (обзор)](-search-2x-wds-extendingtheindex.md)

    -   [Разработка надстроек IFilter](-search-2x-wds-ifilteraddins.md)
    -   [Разработка обработчиков протоколов](-search-2x-wds-phaddins.md)

3.  Общие ссылки

    -   [Схема WDS](-search-2x-wds-schematable.md)
    -   [Синтаксис расширенных запросов](-search-2x-wds-aqsreference.md)
    -   [Принимаемые типы WDS](-search-2x-wds-perceivedtype.md)

 

 