---
title: Мастер печати фотографий
description: Мастер печати фотографий помогает пользователям печатать фотографии, предоставляя простой в использовании интерфейс мастера.
ms.assetid: 9cc2c7d4-a2aa-4abc-9c63-b091e044804f
keywords:
- Мастер печати фотографий
- Интерфейс IDropTarget, Мастер печати фотографий
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 38199f7977e428f41cbc0560e0eab9ad2e106709579255ec8c3a1e74d7f7a402
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118475458"
---
# <a name="photo-printing-wizard"></a>Мастер печати фотографий

Мастер печати фотографий помогает пользователям печатать фотографии, предоставляя простой в использовании интерфейс мастера. Мастер позволяет пользователю указать размеры фотопечати и другие параметры печати, а затем отправить фотографии на принтер. Мастер разработан таким образом, чтобы его можно было вызывать программно любым приложением, которое хочет предоставить пользователям возможность печатать фотографии и задавать размеры и другие параметры печати. мастер печати фотографий доступен в Windows XP и Windows Vista.

-   [Функции, предоставляемые мастером печати фотографий](#features-provided-by-the-photo-print-wizard)
-   [Поддерживаемые форматы файлов фотографий](#supported-photo-file-formats)
-   [Программный запуск мастера печати фотографий](#programmatically-launching-the-photo-print-wizard)

## <a name="features-provided-by-the-photo-print-wizard"></a>Функции, предоставляемые мастером печати фотографий

Мастер печати фотографий предлагает несколько вариантов, которые могут быть недоступны в общих диалоговых окнах принтера, таких как шаблоны нескольких макетов с точными размерами. Шаблоны макета позволяют пользователям максимально эффективно использовать пространство, доступное на фотопринтерной бумаге. Другие параметры, которые могут быть заданы или доступны через мастер фотопечати, включают:

-   Выбор принтера из списка доступных принтеров или назначений виртуальной печати (например, для модуля записи XPS-документов Microsoft). в Windows Vista могут быть доступны следующие варианты в зависимости от возможностей принтера или назначения виртуальной печати.
    -   Размер бумаги. Например, «Letter», «Legal», «a3».
    -   Качество печати с точки зрения поддерживаемых точек на дюйм (DPI).
    -   Тип бумаги. Например, «Plain» или «глянцевая».
-   Запуск параметров печати и свойств для конкретного принтера.
-   задание **копий каждого изображения** (в Windows Vista) или **количество попыток использования каждого изображения** (в Windows XP) значения регулятора.
-   Указание шаблона макета для печати. Например, печать **полной страницы** или **печати бумажника**.
-   выбор параметра **вписать изображение в кадр** (доступно только в Windows Vista).
-   Предварительный просмотр распечатанной фотографии с указанными в данный момент параметрами.
-   акцесссинг дополнительные параметры печати, такие как **повышение резкости при печати** и **управлении цветом** (доступно только в Windows Vista).

Любое приложение может воспользоваться преимуществами функций и возможностей печати фотографий, предлагаемых мастером печати фотографий. Приложение может передавать печатаемые файлы. Затем Мастер печати фотографий позаботится о подготовке файла к печати на основе параметров, указанных пользователем, и отправляет подготовленные файлы на принтер.

на следующем рисунке показан интерфейс мастера печати фотографий на Windows Vista.

![Мастер печати фотографий в Windows Vista](images/ppw-vista.png)

на следующем рисунке показан интерфейс мастера печати фотографий на Windows XP

![Мастер печати фотографий в Windows XP](images/ppw-xp.png)

## <a name="supported-photo-file-formats"></a>Поддерживаемые форматы файлов фотографий

в Windows XP мастер фотопечати поддерживает все форматы графических файлов, поддерживаемые Windows GDI+. В настоящее время эти форматы файлов включают:

-   Точечный рисунок (BMP)
-   GIF
-   JPEG
-   Файл обмена изображениями (EXIF)
-   PNG
-   TIFF

дополнительные сведения о форматах графических файлов, поддерживаемых GDI+, см. в разделе [типы растровых изображений](../gdiplus/-gdiplus-types-of-bitmaps-about.md).

в Windows Vista мастер фотопечати поддерживает любой формат файлов изображений, для которого установлен кодек Windowsного компонента для работы с образами (WIC). Компонент WIC предоставляет несколько стандартных кодеков, в том числе:

-   Точечный рисунок (BMP)
-   GIF
-   Формат значка (ICO)
-   JPEG
-   PNG
-   TIFF
-   Windows Формат фотографии мультимедиа

дополнительные сведения о кодеках wic и wic см. в разделе [Windows imaging Component](https://msdn.microsoft.com/library/ms737408(VS.85).aspx) .

## <a name="programmatically-launching-the-photo-print-wizard"></a>Программный запуск мастера печати фотографий

Чтобы вызвать мастер печати фотографий, вызовите интерфейс [интерфейс IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget) со следующим идентификатором класса (CLSID):


```
static const CLSID CLSID_PrintPhotosDropTarget = 
  {0x60fd46de, 0xf830, 0x4894, {0xa6, 0x28, 0x6f, 0xa8, 0x1b, 0xc0, 0x19, 0x0d}};
```



Файлы, которые должны быть обработаны мастером печати фотографий, указываются в объекте [IDataObject](/windows/win32/api/objidl/nn-objidl-idataobject) .

В следующем примере кода показано, как вызвать мастер печати фотографий.


```
static const CLSID CLSID_PrintPhotosDropTarget = 
  {0x60fd46de, 0xf830, 0x4894, {0xa6, 0x28, 0x6f, 0xa8, 0x1b, 0xc0, 0x19, 0x0d}};
            
// A data object that contains the list of photos to print.
IDataObject* pDataObject;

// Create the Photo Printing Wizard drop target.
CComPtr<IDropTarget> spDropTarget;
        
hr = CoCreateInstance(CLSID_PrintPhotosDropTarget,
                      NULL,
                      CLSCTX_INPROC_SERVER,
                      IID_PPV_ARGS(&spDropTarget));

// Drop the data object onto the drop target.
POINTL pt = {0};
DWORD dwEffect = DROPEFFECT_LINK | DROPEFFECT_MOVE | DROPEFFECT_COPY;

spDropTarget->DragEnter(pDataObject, MK_LBUTTON, pt, &dwEffect);

spDropTarget->Drop(pDataObject, MK_LBUTTON, pt, &dwEffect);}
```



 

 