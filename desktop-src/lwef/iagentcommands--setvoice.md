---
title: Иаженткоммандс Сетвоице
description: Иаженткоммандс Сетвоице
ms.assetid: dfb3b58a-7f24-4366-8f04-93a9e956fdc8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8a8e29936dbca65ffded5f8a5e5ea5297b28362e
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "104487593"
---
# <a name="iagentcommandssetvoice"></a>Иаженткоммандс:: Сетвоице

\[Microsoft Agent является устаревшим в Windows 7 и может быть недоступен в последующих версиях Windows.\]

``` syntax
HRESULT SetVoice(
   BSTR bszVoice  // the Voice setting for Command collection
);
```

Задает свойство текста [**голоса**](voice-property.md) для [**команды**](/windows/desktop/lwef/the-command-object).

-   Возвращает значение S \_ , чтобы указать, что операция выполнена успешно.

<dl> <dt>

<span id="bszVoice"></span><span id="bszvoice"></span><span id="BSZVOICE"></span>*бсзвоице*
</dt> <dd>

Объект BSTR, указывающий значение для свойства "текст [**голоса**](voice-property.md) " коллекции [**команд**](/windows/desktop/lwef/the-commands-collection-object) .

</dd> </dl>

Для коллекции [**команд**](/windows/desktop/lwef/the-commands-collection-object) свойство " [**голосовое**](voice-property.md) сообщение" должно иметь значение "доступ к голосовым данным". Кроме того, свойство [**воицекаптион**](voicecaption-property.md) или [**Caption**](caption-property.md) должно иметь значение, отображаемое в окне "Voice Commands", а свойство [**Visible**](visible-property.md) — значение **true** , чтобы оно отображалось во всплывающем меню символа.

Указываемое выражение BSTR может включать в себя квадратные скобки ( \[ \] ) для обозначения дополнительных слов и символов вертикальной черты ( \| ) для указания альтернативных строк. Альтернативные варианты должны быть заключены в круглые скобки. Например, "(Привет! \[ \] \| Привет!)" говорит обработчику распознавания речи, что для команды нужно принять "Hello," Hello "или" Hi ". Не забывайте включать в скобки, а также другие текстовые пробелы. Не забывайте включать в скобки и скобки соответствующие пробелы, а также текст, заключенный в квадратные скобки.

Оператор Star () можно использовать, \* чтобы указать ноль или несколько экземпляров слов, входящих в группу, или оператор «плюс» (+), чтобы указать один или несколько экземпляров. Например, следующий пример приводит к грамматике, которая поддерживает команду "попробовать это", "Попробуйте" и "Попробуйте", с неограниченными итерациями ".

``` syntax
   "please* try this"
```

Следующий формат грамматики исключает "попробовать это", так как оператор + определяет по крайней мере один экземпляр ".

``` syntax
   "please+ try this"
```

Операторы повторения следуют обычным правилам приоритета и применяются к непосредственно предшествующему текстовому элементу. Например, следующая грамматика приводит к последующим результатам: "Нью Йорк" и "Нью Йорк York", но не "Нью Москва".

``` syntax
   "New York+"
```

Поэтому обычно следует использовать эти операторы с символами группирования. Например, следующая грамматика включает в себя "Нью Йорк" и "Нью Йорк":

``` syntax
   "(New York)+"
```

Операторы повторения полезны, если необходимо составить грамматику, которая включает повторяющиеся последовательности, такие как номер телефона или спецификация списка элементов:

``` syntax
   "call (one|two|three|four|five|six|seven|eight|nine|zero|oh)*"
   "I'd like (cheese|pepperoni|pineapple|canadian bacon|mushrooms|and)+"
```

Хотя операторы также можно использовать с квадратными скобками (необязательный символ группирования), это может снизить эффективность обработки грамматики агента.

Кроме того, можно использовать многоточие (...) для поддержки поиска *слов*, то есть сообщить модулю распознавания речи о необходимости пропускать слова, пропускаемые в этой должности, в фразе (иногда называемых словами- *мусором* ). При использовании многоточия подсистема распознавания речи распознает только определенные слова в строке, независимо от того, говорят ли они с соседними словами или фразами. Например, если для этого свойства задано значение " \[ ... \] проверить почту \[ ... \] "модуль распознавания речи будет сопоставлять такие фразы, как" проверить почту "или" проверить почту ", с помощью этой команды. Многоточие можно использовать в любом месте строки. Однако будьте внимательны при использовании этой методики, так как параметры голоса с многоточием могут увеличить потенциальные нежелательные совпадения.

При определении слов и грамматики для команды включите по крайней мере одно необходимое слово; то есть не указывайте только необязательные слова. Кроме того, убедитесь, что слово содержит только произношенные слова и буквы. Для чисел лучше использовать слово, а не однозначное представление. Например, "345" не является хорошей формой грамматики. Аналогичным образом вместо «IEEE» используется «I Triple E». Кроме того, не указывайте знаки препинания и символы. Например, вместо "The \# $1 Пицца!" используйте "число 1 10 доллара пиццы". Включение нерегулярных символов или символов для одной команды может привести к тому, что обработчику речи не удастся скомпилировать грамматику для всех команд. Наконец, сделайте свой параметр голоса как можно более отличающимся от других определяемых вами речевых команд. Чем больше сходство между грамматикой голоса для команд, тем выше вероятность того, что обработчик речи выполнит ошибку распознавания. Можно также использовать оценку достоверности, чтобы лучше отличать две команды, которые могут иметь схожую или подобную грамматику голоса.

Вы можете включить слова в грамматику в *тексте " \\ произношение текста*", где "текст" — это отображаемый текст, а "произношение" — текст, поясняющий произношение. Например, грамматика «первое \\ Начало» будет распознается, когда пользователь говорит «First», но [**командное**](/windows/desktop/lwef/the-command-object) событие возвратит текст « \\ первое имя». Можно также использовать IPA (Международный фонетический алфавит), чтобы указать произношение, начинающееся с символа решетки (" \# "), а затем текст, представляющий произношение IPA.

Для модулей распознавания речи японского языка можно определить грамматику в формате "*Кана \\*", уменьшая альтернативные произношение и увеличивая точность. (Порядок сортировки обратно для обеспечения обратной совместимости.) Это особенно важно для произношения правильных имен в канджи. Однако можно просто передать "кандзи" без японской азбуки, в этом случае подсистема должна прослушивать все приемлемые произношения для кандзи. Можно также передать только символ Кана.

Кроме ошибок, использующих символы форматирования при группировании или повторении, Microsoft Agent не будет сообщать об ошибках в грамматике, если только сама система не сообщит об ошибке. Если вы передали текст в грамматике, которую модуль не смог скомпилировать, но обработчик не сможет обрабатывать и возвращать ошибку, агент не может сообщить об ошибке. Поэтому клиентское приложение должно быть аккуратным определением грамматики для свойства [**Voice**](voice-property.md) .

> [!Note]  
> Доступные функции грамматики могут зависеть от модуля распознавания речи. Чтобы определить, какие параметры грамматики поддерживаются, вы можете узнать у поставщика подсистемы. Используйте [**срмодеид**](srmodeid-property.md) для использования определенного механизма.

 

Работа этого свойства зависит от состояния состояния распознавания речи на сервере Microsoft Agent. Например, если распознавание речи отключено или не установлено, эта функция не оказывает немедленного воздействия. Однако если во время сеанса включено распознавание речи, команда будет доступна, когда клиентское приложение найдет на вход.

## <a name="see-also"></a>См. также:

[**Иаженткоммандс:: Voice**](iagentcommands--getvoice.md), [**Иаженткоммандс:: сеткаптион**](iagentcommands--setcaption.md), [**иаженткоммандс:: сетвисибле**](iagentcommands--setvisible.md)


 

 