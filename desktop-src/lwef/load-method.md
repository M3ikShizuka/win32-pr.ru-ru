---
title: Метод загрузки
description: Метод загрузки
ms.assetid: 72a37471-f69b-49a5-a6eb-d65bff970c0f
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0927fc8e49e55c2bdfcd7b1109bb8604540c199c
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "105700855"
---
# <a name="load-method"></a>Метод загрузки

\[Microsoft Agent является устаревшим в Windows 7 и может быть недоступен в последующих версиях Windows.\]

<dl> <dt>

<span id="Description"></span><span id="description"></span><span id="DESCRIPTION"></span>**Nописание**
</dt> <dd>

Загружает символ в коллекцию [**символов**](/windows/desktop/lwef/the-characters-object) .

</dd> <dt>

<span id="Syntax"></span><span id="syntax"></span><span id="SYNTAX"></span>**Syntax**
</dt> <dd>

*Агент ***. Символы. Load "*** чарактерид * * *",* *  *поставщик*



| Отделение          | Описание                                                                                                                                                                                                                              |
|---------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| *чарактерид* | Обязательный. Строковое значение, которое будет использоваться для ссылки на символьные данные для загрузки.                                                                                                                                                  |
| *Поставщик*    | Обязательный. Тип данных Variant, который должен быть одним из следующих: **filespec** расположение локального файла для указанного файла определения символа. <br/> **URL-адрес** HTTP-адрес для файла определения символа.<br/> |



 

</dd> </dl>

## <a name="remarks"></a>Комментарии

Можно загрузить символы из подкаталога агента, указав относительный путь (который не включает двоеточие или символ косой черты). Это префикс добавляет путь к каталогу символов агента (находится в локализованном каталоге Windows \\ мсажент). Например, при указании следующего параметра будет загружен Genie. ACS из каталога chars агента:


```
   Agent.Character.Load "genie", "genie.acs"
```



Можно также указать собственный каталог в каталоге chars агента.


```
   Agent.Character.Load "genie", "MyCharacters\genie.acs"
```



Можно загрузить символ, заданный в качестве символа по умолчанию текущего пользователя, не включая путь в качестве второго параметра метода **Load** .


```
   Agent.Character.Load "character"
```



Один и тот же символ (символ с одинаковым идентификатором GUID) нельзя загрузить несколько раз из одного экземпляра элемента управления. Аналогичным образом нельзя одновременно загрузить символ по умолчанию и другие символы из одного экземпляра элемента управления, поскольку символ по умолчанию может совпадать с другим символом. Если вы попытаетесь сделать это, сервер выдаст ошибку. Однако можно создать другой экземпляр элемента управления агента и загрузить тот же символ.

Поставщик данных Microsoft Agent поддерживает загрузку символьных данных, хранящихся либо в виде одного структурированного файла (. ACS) с символьными данными и данными анимации вместе или в виде отдельных символьных данных (. ACF) и Animation (. АКА) файлы. Используйте один структурированный. Файл ACS для загрузки символа, хранящегося на локальном диске или в сети и доступ к которому осуществляется с помощью обычного файлового протокола (например, UNC-пути). Используйте отдельный. ACF и. АКА файлы, если требуется загружать файлы анимации по отдельности с удаленного сайта, к которому они обращаются по протоколу HTTP.

Предмет. Файлы ACS, использующие метод **Load** , обеспечивают доступ к анимации символа. Предмет. ACF файлы, для загрузки данных анимации также используется метод [**Get**](get-method.md) . Метод **Load** не поддерживает загрузку. Файлы ACS с веб-сайта HTTP.

При загрузке символа символ не отображается автоматически. Чтобы сделать символ видимым, сначала используйте метод [**Показать**](show-method.md) .

Если метод **Load** используется для загрузки символьного файла, хранящегося на локальном компьютере, и вызов завершается с ошибкой; Например, поскольку файл не найден, агент вызывает ошибку. Вы можете использовать поддержку на языке программирования, чтобы предоставить подпрограмму обработки ошибок для перехвата и обработки ошибки.


```
   Sub Form_Load
      On Error GoTo ErrorHandler
      Agent1.Characters.Load "mychar", "genie.acs"
      ' Successful load
      . . .
      Exit Sub
      ErrorHandler:
      ' Unsuccessful load
      . . .
      Resume Next
   End Sub
```



Можно также решить эту ошибку, установив для [**Раисерекуестеррорс**](https://www.bing.com/search?q=**RaiseRequestErrors**) **значение false**, объявляя объект и назначив ему запрос на **загрузку** . Затем выполните вызов **Load** с инструкцией, которая проверяет состояние объекта [**запроса**](/windows/desktop/lwef/the-request-object) .


```
Dim LoadRequest as Object

   Sub Form_Load
      Agent1.RaiseRequestErrors = False
      Set LoadRequest = Agent1.Characters.Load _
         ("mychar", "c:\some directory\some character.acs")
      If LoadRequest.Status Not 0 Then
         ' Unsuccessful load
         . . .
         Exit Sub
      Else 
         ' Successful load
         . . .
   End Sub
```



При загрузке нелокального символа; Например, при использовании протокола HTTP можно также проверить сбой **загрузки** , назначив объект [**запроса**](/windows/desktop/lwef/the-request-object) методу **Load** . Однако, поскольку этот метод загрузки символа обрабатывается асинхронно, проверьте его состояние в событии [**рекуесткомплете**](requestcomplete-event.md) . Этот метод не будет работать при загрузке символа с помощью протокола UNC, так как метод **Load** обрабатывается синхронно.

 

