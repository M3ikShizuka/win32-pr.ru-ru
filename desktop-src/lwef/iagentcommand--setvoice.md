---
title: Иаженткомманд Сетвоице
description: Иаженткомманд Сетвоице
ms.assetid: bee06616-26bf-4e1e-89da-6765dd77fb02
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e45af753dea18e9fda7b613e3b800ac886d949eb6494fd969cd8b7ceb488dfc2
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118477244"
---
# <a name="iagentcommandsetvoice"></a>Иаженткомманд:: Сетвоице

\[Microsoft Agent является устаревшим по отношению к Windows 7 и может быть недоступен в последующих версиях Windows.\]

``` syntax
HRESULT SetVoice(
   BSTR bszVoice  // voice text setting for Command
);
```

Задает свойство [**Voice**](voice-property.md) для [**команды**](/windows/desktop/lwef/the-command-object).

-   Возвращает значение S \_ , чтобы указать, что операция выполнена успешно.

<dl> <dt>

<span id="bszVoice"></span><span id="bszvoice"></span><span id="BSZVOICE"></span>*бсзвоице*
</dt> <dd>

Значение типа BSTR, указывающее текст для свойства [**Voice**](voice-property.md) [**команды**](/windows/desktop/lwef/the-command-object).

</dd> </dl>

Для [**команды**](/windows/desktop/lwef/the-command-object) должно быть задано свойство [**Voice**](voice-property.md) , а для свойства [**Enabled**](enabled-property.md) — значение доступ к голосовым данным. Кроме того, свойство [**воицекаптион**](voicecaption-property.md) должно иметь значение, отображаемое в **окне "Voice Commands**". (Для обеспечения обратной совместимости при отсутствии **воицекаптион** используется параметр [**Caption**](caption-property.md) .)

Указываемое выражение BSTR может включать в себя квадратные скобки ( \[ \] ) для обозначения дополнительных слов и символов вертикальной черты ( \| ) для указания альтернативных строк. Альтернативные варианты должны быть заключены в круглые скобки. Например, "(Привет! \[ \] \| Привет!)" говорит обработчику распознавания речи, что для команды нужно принять "Hello," Hello "или" Hi ". Не забывайте включать в скобки и скобки соответствующие пробелы, а также текст, заключенный в квадратные скобки.

Оператор Star () можно использовать, \* чтобы указать ноль или несколько экземпляров слов, входящих в группу, или оператор «плюс» (+), чтобы указать один или несколько экземпляров. Например, следующий пример приводит к грамматике, которая поддерживает команду "попробовать это", "Попробуйте" и "Попробуйте", с неограниченными итерациями ".

``` syntax
   "please* try this"
```

Следующий формат грамматики исключает "попробовать это", так как оператор + определяет по крайней мере один экземпляр ".

``` syntax
   "please+ try this"
```

Операторы повторения следуют обычным правилам приоритета и применяются к непосредственно предшествующему текстовому элементу. Например, следующая грамматика приводит к последующим результатам: "Нью Йорк" и "Нью Йорк York", но не "Нью Москва".

``` syntax
   "New York+"
```

Поэтому, как правило, необходимо использовать эти операторы с символами группирования. Например, следующая грамматика включает в себя "Нью Йорк" и "Нью Йорк":

``` syntax
   "(New York)+"
```

Операторы повторения полезны, если необходимо составить грамматику, которая включает повторяющиеся последовательности, такие как номер телефона или спецификация списка элементов:

``` syntax
   "call (one|two|three|four|five|six|seven|eight|nine|zero|oh)*"
   "I'd like (cheese|pepperoni|pineapple|canadian bacon|mushrooms|and)+"
```

Хотя операторы также можно использовать с квадратными скобками (необязательный символ группирования), это может снизить эффективность обработки грамматики агента.

Кроме того, можно использовать многоточие (...) для поддержки поиска *слов*, то есть сообщить модулю распознавания речи о необходимости пропускать слова, пропускаемые в этой должности, в фразе (иногда называемых словами- *мусором* ). Таким образом, обработчик речи распознает только определенные слова в строке независимо от того, когда речь поступала с соседними словами или фразами. Например, если для этого свойства задано значение " \[ ... \] проверить почту \[ ... \] "модуль распознавания речи будет сопоставлять такие фразы, как" проверить почту "или" проверить почту ", с помощью этой команды. Многоточие можно использовать в любом месте строки. Однако будьте внимательны при использовании этого метода, так как параметры голоса с многоточием могут увеличить потенциал нежелательных совпадений.

При определении слов и грамматики для команды всегда обязательно включите по крайней мере одно необходимое слово. то есть не указывайте только необязательные слова. Кроме того, убедитесь, что слово содержит только произношенные слова и буквы. Для чисел лучше использовать слова вместо числового представления. Кроме того, не указывайте знаки препинания и символы. Например, вместо "The \# $1 Пицца!" используйте "число 1 10 доллара пиццы". Включение нерегулярных символов или символов для одной команды может привести к тому, что обработчику речи не удастся скомпилировать грамматику для всех команд. Наконец, сделайте свой параметр голоса как можно более отличающимся от других определяемых вами речевых команд. Чем больше сходство между грамматикой голоса для команд, тем выше вероятность того, что обработчик речи выполнит ошибку распознавания. Можно также использовать оценку достоверности, чтобы лучше отличать две команды, которые могут иметь схожую или подобную грамматику голоса.

Установка свойства [**Voice**](voice-property.md) для [**команды**](/windows/desktop/lwef/the-command-object) автоматически включает речевые службы агента, делая доступными ключ прослушивания и TIP прослушивания. Однако он не загружает модуль распознавания речи.

> [!Note]  
> Доступные функции грамматики могут зависеть от модуля распознавания речи. Чтобы определить, какие параметры грамматики поддерживаются, вы можете узнать у поставщика подсистемы. Чтобы указать подсистему, используйте [**иажентчарактерекс:: срмодеид**](https://www.bing.com/search?q=**IAgentCharacterEx::SRModeID**) .

 

## <a name="see-also"></a>См. также

[**Иаженткомманд:: Voice**](iagentcommand--getvoice.md), [**Иаженткомманд:: сеткаптион**](iagentcommand--setcaption.md), [**иаженткомманд:: Сетенаблед**](iagentcommand--setenabled.md), [**иаженткоммандс:: Add**](iagentcommands--add.md), [**иаженткоммандс:: INSERT**](iagentcommands--insert.md)


 

 