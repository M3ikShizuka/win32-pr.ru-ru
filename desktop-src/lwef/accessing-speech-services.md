---
title: Доступ к голосовым службам (интерфейс сервера агента Microsoft)
description: Доступ к голосовым службам
ms.assetid: 99cf630d-3bd1-403a-833a-9173a84fe3c0
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fda1369fa83c5e8ffaf7f08317f69a2a569620f3
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2020
ms.locfileid: "105691744"
---
# <a name="accessing-speech-services-microsoft-agent-server-interface"></a><span data-ttu-id="7d44d-103">Доступ к голосовым службам (интерфейс сервера агента Microsoft)</span><span class="sxs-lookup"><span data-stu-id="7d44d-103">Accessing Speech Services (Microsoft Agent Server Interface)</span></span>

<span data-ttu-id="7d44d-104">\[Microsoft Agent является устаревшим в Windows 7 и может быть недоступен в последующих версиях Windows.\]</span><span class="sxs-lookup"><span data-stu-id="7d44d-104">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="7d44d-105">Несмотря на то, что службы Microsoft Agent включают поддержку речевого ввода, для доступа к службам речевого ввода агента должен быть установлен совместимый обработчик распознавания речи для команд и управления.</span><span class="sxs-lookup"><span data-stu-id="7d44d-105">Although Microsoft Agent's services include support for speech input, a compatible command-and-control speech recognition engine must be installed to access Agent's speech input services.</span></span> <span data-ttu-id="7d44d-106">Аналогичным образом, если вы хотите использовать речевые службы агента Майкрософт для поддержки синтезированного речевого вывода для символа, необходимо установить совместимый речевой механизм преобразования текста в речь для вашего символа.</span><span class="sxs-lookup"><span data-stu-id="7d44d-106">Similarly, if you want to use Microsoft Agent's speech services to support synthesized speech output for a character, you must install a compatible text-to-speech (TTS) speech engine for your character.</span></span> <span data-ttu-id="7d44d-107">Так как речевые службы Microsoft Agent основаны на Microsoft Speech API (SAPI), можно использовать любые механизмы, совместимости поддержку требуемых речевых интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="7d44d-107">Because Microsoft Agent's speech services are based on the Microsoft Speech API (SAPI), you can use any engines that compatibly support the required speech interfaces.</span></span>

<span data-ttu-id="7d44d-108">Чтобы включить поддержку речевого ввода в приложении, определите объект [**Command**](https://www.bing.com/search?q=**Command**) и задайте его свойство [**Voice**](https://www.bing.com/search?q=**Voice**) .</span><span class="sxs-lookup"><span data-stu-id="7d44d-108">To enable speech input support in your application, define a [**Command**](https://www.bing.com/search?q=**Command**) object and set its [**Voice**](https://www.bing.com/search?q=**Voice**) property.</span></span> <span data-ttu-id="7d44d-109">Microsoft Agent автоматически загрузит речевые службы, чтобы при нажатии пользователем клавиши прослушивания или при вызове [**Listen**](https://www.bing.com/search?q=**Listen**)был загружен модуль распознавания речи.</span><span class="sxs-lookup"><span data-stu-id="7d44d-109">Microsoft Agent will automatically load speech services, so that when the user presses the Listening key or you call [**Listen**](https://www.bing.com/search?q=**Listen**), the speech recognition engine will be loaded.</span></span> <span data-ttu-id="7d44d-110">По умолчанию код языка символа определяет, какой модуль будет загружен.</span><span class="sxs-lookup"><span data-stu-id="7d44d-110">By default the character's language ID will determine which engine is loaded.</span></span> <span data-ttu-id="7d44d-111">Агент пытается загрузить первый обработчик, который функция SAPI возвращает в соответствии с этим языком.</span><span class="sxs-lookup"><span data-stu-id="7d44d-111">Agent attempts to load the first engine that SAPI returns as matching this language.</span></span> <span data-ttu-id="7d44d-112">Используйте [**иажентчарактерекс:: сетсрмодеид**](IAgentCharacterEx::SetSRModeID) , если требуется загрузить конкретный обработчик.</span><span class="sxs-lookup"><span data-stu-id="7d44d-112">Use [**IAgentCharacterEx::SetSRModeID**](IAgentCharacterEx::SetSRModeID) if you want to load a specific engine.</span></span>

<span data-ttu-id="7d44d-113">Чтобы включить вывод текста в речь, используйте метод [**говорите**](https://www.bing.com/search?q=**Speak**) .</span><span class="sxs-lookup"><span data-stu-id="7d44d-113">To enable text-to-speech output, use the [**Speak**](https://www.bing.com/search?q=**Speak**) method.</span></span> <span data-ttu-id="7d44d-114">Microsoft Agent автоматически попытается загрузить подсистему, совпадающую с ИДЕНТИФИКАТОРом языка символа.</span><span class="sxs-lookup"><span data-stu-id="7d44d-114">Microsoft Agent will automatically attempt to load an engine that matches the character's language ID.</span></span> <span data-ttu-id="7d44d-115">Если определение символа включает в себя конкретный идентификатор режима модуля TTS и этот механизм доступен и соответствует ИДЕНТИФИКАТОРу языка символа, агент загружает эту подсистему для символа.</span><span class="sxs-lookup"><span data-stu-id="7d44d-115">If the character's definition includes a specific TTS engine mode ID and that engine is available and matches the character's language ID, Agent loads that engine for the character.</span></span> <span data-ttu-id="7d44d-116">В противном случае агент загружает первый модуль TTS, который функция SAPI возвращает в соответствии с параметром языка символа.</span><span class="sxs-lookup"><span data-stu-id="7d44d-116">If not, Agent loads the first TTS engine that SAPI returns as matching the character's language setting.</span></span> <span data-ttu-id="7d44d-117">Для загрузки конкретного подсистемы можно также использовать [**иажентчарактерекс:: сетттсмодеид**](IAgentCharacterEx::SetTTSModeID) .</span><span class="sxs-lookup"><span data-stu-id="7d44d-117">You can also use [**IAgentCharacterEx::SetTTSModeID**](IAgentCharacterEx::SetTTSModeID) to load a specific engine.</span></span>

<span data-ttu-id="7d44d-118">Как правило, Microsoft Agent загружает модуль распознавания речи при инициации режима прослушивания и загружает модуль преобразования текста в речь при первом вызове метода [**говорите**](https://www.bing.com/search?q=**Speak**) .</span><span class="sxs-lookup"><span data-stu-id="7d44d-118">Typically, Microsoft Agent loads a speech recognition engine when the Listening mode is initiated and loads a text-to-speech engine when [**Speak**](https://www.bing.com/search?q=**Speak**) is first called.</span></span> <span data-ttu-id="7d44d-119">Однако если вы хотите предварительно загрузить модуль распознавания речи, это можно сделать, запросив свойства, связанные с интерфейсами распознавания речи.</span><span class="sxs-lookup"><span data-stu-id="7d44d-119">However, if you want to preload the speech engine, you can do this by querying the properties related to the speech interfaces.</span></span> <span data-ttu-id="7d44d-120">Например, при вызове [**иажентчарактерекс:: жетсрмодеид**](IAgentCharacterEx::GetSRModeID) или [**Иажентчарактерекс:: жетттсмодеид**](IAgentCharacterEx::GetTTSModeID) будет предпринята попытка загрузить этот тип обработчика.</span><span class="sxs-lookup"><span data-stu-id="7d44d-120">For example, calling [**IAgentCharacterEx::GetSRModeID**](IAgentCharacterEx::GetSRModeID) or [**IAgentCharacterEx::GetTTSModeID**](IAgentCharacterEx::GetTTSModeID) will attempt to load that type of engine.</span></span>

 

 




