---
title: Доступ к голосовым службам (интерфейс сервера агента Microsoft)
description: Доступ к голосовым службам
ms.assetid: 99cf630d-3bd1-403a-833a-9173a84fe3c0
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fda1369fa83c5e8ffaf7f08317f69a2a569620f3
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2020
ms.locfileid: "105691744"
---
# <a name="accessing-speech-services-microsoft-agent-server-interface"></a>Доступ к голосовым службам (интерфейс сервера агента Microsoft)

\[Microsoft Agent является устаревшим в Windows 7 и может быть недоступен в последующих версиях Windows.\]

Несмотря на то, что службы Microsoft Agent включают поддержку речевого ввода, для доступа к службам речевого ввода агента должен быть установлен совместимый обработчик распознавания речи для команд и управления. Аналогичным образом, если вы хотите использовать речевые службы агента Майкрософт для поддержки синтезированного речевого вывода для символа, необходимо установить совместимый речевой механизм преобразования текста в речь для вашего символа. Так как речевые службы Microsoft Agent основаны на Microsoft Speech API (SAPI), можно использовать любые механизмы, совместимости поддержку требуемых речевых интерфейсов.

Чтобы включить поддержку речевого ввода в приложении, определите объект [**Command**](https://www.bing.com/search?q=**Command**) и задайте его свойство [**Voice**](https://www.bing.com/search?q=**Voice**) . Microsoft Agent автоматически загрузит речевые службы, чтобы при нажатии пользователем клавиши прослушивания или при вызове [**Listen**](https://www.bing.com/search?q=**Listen**)был загружен модуль распознавания речи. По умолчанию код языка символа определяет, какой модуль будет загружен. Агент пытается загрузить первый обработчик, который функция SAPI возвращает в соответствии с этим языком. Используйте [**иажентчарактерекс:: сетсрмодеид**](IAgentCharacterEx::SetSRModeID) , если требуется загрузить конкретный обработчик.

Чтобы включить вывод текста в речь, используйте метод [**говорите**](https://www.bing.com/search?q=**Speak**) . Microsoft Agent автоматически попытается загрузить подсистему, совпадающую с ИДЕНТИФИКАТОРом языка символа. Если определение символа включает в себя конкретный идентификатор режима модуля TTS и этот механизм доступен и соответствует ИДЕНТИФИКАТОРу языка символа, агент загружает эту подсистему для символа. В противном случае агент загружает первый модуль TTS, который функция SAPI возвращает в соответствии с параметром языка символа. Для загрузки конкретного подсистемы можно также использовать [**иажентчарактерекс:: сетттсмодеид**](IAgentCharacterEx::SetTTSModeID) .

Как правило, Microsoft Agent загружает модуль распознавания речи при инициации режима прослушивания и загружает модуль преобразования текста в речь при первом вызове метода [**говорите**](https://www.bing.com/search?q=**Speak**) . Однако если вы хотите предварительно загрузить модуль распознавания речи, это можно сделать, запросив свойства, связанные с интерфейсами распознавания речи. Например, при вызове [**иажентчарактерекс:: жетсрмодеид**](IAgentCharacterEx::GetSRModeID) или [**Иажентчарактерекс:: жетттсмодеид**](IAgentCharacterEx::GetTTSModeID) будет предпринята попытка загрузить этот тип обработчика.

 

 




