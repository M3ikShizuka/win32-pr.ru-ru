---
title: Объект коллекции Commands
description: Объект коллекции Commands
ms.assetid: 8726ce04-77d3-4ae3-bd46-e75f42b36d6f
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c2367035d86f92d57dc459564943b9e7797ecb04
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "104412799"
---
# <a name="the-commands-collection-object"></a>Объект коллекции Commands

\[Microsoft Agent является устаревшим в Windows 7 и может быть недоступен в последующих версиях Windows.\]

Сервер Microsoft Agent поддерживает список команд, доступных пользователю в данный момент. В этот список входят команды, определяемые сервером для общего взаимодействия (например, скрытие и открытие окна "Voice Commands"), список доступных (но не входящих в систему) клиентов и команды, определенные текущим активным клиентом. Первые два набора команд являются глобальными командами. Это значит, что они доступны в любое время, независимо от клиента ввода-активности. Определяемые клиентом команды доступны только в том случае, если этот клиент является входным, а сам символ является видимым.

Каждое клиентское приложение может определять коллекцию команд, называемых коллекцией [**Commands**](/windows/desktop/lwef/the-commands-collection-object) . Чтобы добавить команду в коллекцию, используйте метод [**Add**](add-method.md) или [**INSERT**](insert-method.md) . Хотя свойства команды можно указать с помощью отдельных инструкций, для оптимальной производительности кода укажите все свойства команды в инструкции **Add** или **INSERT** . Для каждой команды в коллекции можно определить, отображается ли пользовательский доступ к команде во всплывающем меню символа, в окне "голоса" в обоих случаях или в любом из них. Например, если вы хотите, чтобы команда отображалась во всплывающем меню для символа, задайте [**заголовок**](caption-property.md) и [**видимые**](visible-property.md) свойства команды. Чтобы отобразить команду в окне "Voice Commands", задайте свойства [**воицекаптион**](voicecaption-property.md) и [**Voice**](voice-property.md) команды.

Пользователь может получить доступ к отдельным [**командам**](/windows/desktop/lwef/the-commands-collection-object)and в коллекции, только если клиентское приложение является входным. Поэтому при совместном использовании символа с другими клиентскими приложениями, как правило, необходимо задать свойства [**Caption**](caption-property.md), [**воицекаптион**](voicecaption-property.md)и [**Voice**](voice-property.md) для объекта коллекции **Commands** , а также для команд в коллекции. Это помещает запись для коллекции **команд** во всплывающем меню символа и в окне "Voice Commands".

Когда пользователь переключается на клиент, выбрав запись [**команды**](/windows/desktop/lwef/the-commands-collection-object) , сервер автоматически делает ввод клиента активным, уведомляя клиентское приложение с помощью события [**активатеинпут**](activateinput-event.md) и делает команды в коллекции доступными. Сервер также уведомляет клиента о том, что он больше не является входным и не является активным с событием [**деактиватеинпут**](deactivateinput-event.md) . Это позволяет серверу предоставлять и принимать только команды, которые применяются к текущему контексту ввода-активного клиента. Это также позволяет избежать конфликтов имен команд между клиентами.

Клиент также может явным образом запросить, чтобы сделать клиент ввода активным клиентом с помощью метода [**Activate**](activate-method.md) . Этот метод также поддерживает настройку приложения так, чтобы он не был клиентом input-Active. Этот метод можно использовать при совместном использовании символа с другим приложением, настроив приложение в качестве входных данных, если окно приложения получает фокус и не является активным при потере фокуса.

Аналогичным образом можно использовать метод [**Activate**](activate-method.md) , чтобы задать для приложения (или не быть) активный клиент символа. Активный клиент — это клиент, который получает входные данные, когда его символ является самым верхним. При изменении этого состояния сервер уведомляет ваше приложение с событием [**активеклиентчанже**](activeclientchange-event.md) .

При отображении всплывающего меню символа изменения свойств коллекции [**команд**](/windows/desktop/lwef/the-commands-collection-object) или команд в ее коллекции не отображаются, пока пользователь не отобразит меню. Однако окно команд отображает изменения по мере их возникновения.

-   [Методы объекта Commands](commands-object-methods.md)
-   [Свойства объекта Commands](commands-object-properties.md)

 

 