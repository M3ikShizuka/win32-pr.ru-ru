---
title: Метод Listen
description: Метод Listen
ms.assetid: ceb3b62f-2a33-4a13-b608-4cfa800be38a
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6813fb155074c4cc47a51ec7241eddd332edbcc3
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "104069875"
---
# <a name="listen-method"></a>Метод Listen

\[Microsoft Agent является устаревшим в Windows 7 и может быть недоступен в последующих версиях Windows.\]

<dl> <dt>

<span id="Description"></span><span id="description"></span><span id="DESCRIPTION"></span>**Nописание**
</dt> <dd>

Включает режим прослушивания (распознавание речи) в течение времени.

</dd> <dt>

<span id="Syntax"></span><span id="syntax"></span><span id="SYNTAX"></span>**Syntax**
</dt> <dd>

*агент. ***Символы * * * * ("*** чарактерид * * *"). Состояние прослушивания* *  



| Отделение    | Описание                                                                                                                                                                      |
|---------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| *Состояние* | Обязательный. Логическое значение, определяющее, следует ли включать или отключать режим прослушивания. **Значение true** Включает режим прослушивания. <br/> **Значение false** Выключает режим прослушивания.<br/> |



 

</dd> </dl>

## <a name="remarks"></a>Комментарии

Присвоение этому методу значения **true** включает режим прослушивания (включает распознавание речи) в течение фиксированного периода времени (10 секунд). Пока нельзя задать значение времени ожидания, можно отключить режим прослушивания до истечения времени ожидания. Если вы (или другой клиент) успешно установили режим прослушивания в и вы пытаетесь установить это свойство в **значение true** до истечения времени ожидания, метод завершается успешно и сбрасывает время ожидания. Однако если режим прослушивания включен, так как пользователь нажимает клавишу прослушивания, метод завершается, но время ожидания игнорируется, а режим прослушивания завершается в зависимости от взаимодействия пользователя с ключом прослушивания.

Этот метод выполняется успешно только при вызове из input-Active Client и при запуске речевых служб. Чтобы убедиться, что службы речи запущены, запросите или задайте [**срмодеид**](srmodeid-property.md) или настройте [**голосовую**](voice-property.md) настройку для [**команды**](/windows/desktop/lwef/the-command-object) перед вызовом **Listen** . в противном случае произойдет сбой метода. Чтобы определить успешность этого метода, вызовите его как функцию и возвратит логическое значение, указывающее, успешно ли выполнен метод.


```
   If Genie.Listen(True) Then
      'The method succeeded

   Else
      ' The method failed

   End If
```



Метод также завершается ошибкой, если пользователь нажимает клавишу прослушивания, и вы пытаетесь установить значение **Listen** **false**. Однако, если пользователь выпустил ключ прослушивания, а режим прослушивания не истек, он завершится успешно.

**Прослушивание** также завершается ошибкой, если отсутствует совместимый механизм распознавания речи, соответствующий параметру [**LanguageID**](languageid-property.md) символа, пользователь отключил речевой ввод с помощью вкладки свойств Microsoft Agent или звуковое устройство занято.

Если для этого метода задано **значение true**, сервер запускает событие [**листенстарт**](listenstart-event.md) . Сервер отправляет [**листенкомплете**](listencomplete-event.md) при завершении времени ожидания режима прослушивания или при установке параметра **Listen** в **значение false**.

Этот метод не вызывает автоматический вызов метода [**останавливает**](stop-method.md) и воспроизводит анимацию состояния прослушивания, так как сервер выполняет нажатие клавиши прослушивания. Это позволяет определить, следует ли прерывать текущую анимацию с помощью анимации [**листенстарт**](listenstart-event.md) , вызвав метод **остановить** и воспроизводить собственную анимацию. Однако при обнаружении пользователем utterance вызывается метод " **останавливает** " и воспроизводит анимацию состояния слуха.

## <a name="see-also"></a>См. также:

[**Свойство LanguageID**](languageid-property.md), [**событие листенкомплете**](listencomplete-event.md), [**событие листенстарт**](listenstart-event.md)


 

