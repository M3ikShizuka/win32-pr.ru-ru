---
title: Уведомление индекса изменений (устаревшие функции среды Windows)
description: С помощью службы Microsoft Windows Desktop Search (WDS) 2,6 обработчики протоколов для заданного хранилища данных могут сообщить индексатору WDS об изменении данных в их хранилище.
ms.assetid: 700b1707-dd11-4a30-8f00-5c4aae1173ff
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6021cfe5cd7061a3d3255e56d08e665a6caedf03
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2020
ms.locfileid: "104262179"
---
# <a name="notifying-the-index-of-changes-legacy-windows-environment-features"></a>Уведомление индекса изменений (устаревшие функции среды Windows)

> [!NOTE]
> Windows Desktop Search 2. x — это устаревшая технология, которая изначально была доступна в качестве надстройки для Windows XP и Windows Server 2003. В более поздних выпусках используйте вместо этого [Поиск Windows](../search/-search-3x-wds-overview.md) .

С помощью службы Microsoft Windows Desktop Search (WDS) 2,6 обработчики протоколов для заданного хранилища данных могут сообщить индексатору WDS об изменении данных в их хранилище. Это повышает производительность, гарантируя, что индексатор не выполняет сканирование всего хранилища по добавочным индексам. С помощью API уведомления обработчики протоколов могут уведомлять индексатор о перемещении или удалении элемента, а также добавлять области в очередь сканирования индексатора WDS URL-адресов, для которых требуется индексирование. Уведомление полезно для таких приложений, как электронная почта, где обработчик протокола отслеживает хранилище и уведомляет индексатор об изменении элементов и требует индексирования.

## <a name="isearchitemschangedsink"></a>исеарчитемсчанжедсинк

Обработчики протоколов уведомляют индексатор об изменениях через интерфейс [**исеарчитемсчанжедсинк**](/windows/desktop/api/searchapi/nn-searchapi-isearchitemschangedsink) . Сведения об изменениях данных должны собираться в \_ \_ структурах изменения элементов поиска, а также в \_ типе поиска \_ \_ типов перечислений изменений, а затем передавать их индексатору через метод **онитемсчанжед** интерфейса **исеарчитемсчанжедсинк** .

Для доступа к этому интерфейсу обработчики настраиваемых протоколов должны сначала создать экземпляр объекта [**исеарчманажер**](/windows/desktop/api/searchapi/nn-searchapi-isearchmanager) для получения доступа к объекту [**исеарчкаталогманажер**](/windows/desktop/api/searchapi/nn-searchapi-isearchcatalogmanager) . В нем можно создать экземпляр объекта [**исеарчитемсчанжедсинк**](/windows/desktop/api/searchapi/nn-searchapi-isearchitemschangedsink) и уведомить индексатор об изменениях данных.

Метод Онитемсчанжед позволяет получать и передавать изменения данных в хранилище данных клиента для инициирования индексирования.



| Направление | Переменная              | Описание                                                              |
|-----------|-----------------------|--------------------------------------------------------------------------|
| В        | двнумберофчанжес     | Общее число изменений в уведомлении.                             |
| В        | датачанжеентриес\[\] | Все уведомления об изменениях в массиве \_ \_ структур изменения элементов поиска. |
| Исходящий       | двбатчид             | Идентификатор пакета, который будет передан с ошибками.                       |
| Исходящий       | хркомплетионкодес\[\] | Указывает, был ли каждый URL-адрес принят для индексирования.                    |



 

\_ \_ Структура изменения элемента поиска определяет тип произошедших изменений, а также текущий URL-адрес и предыдущий URL-адрес элемента, если применимо. Структура определяется следующим образом:



| Имя свойства | Тип свойства                  | Описание                                                                |
|---------------|--------------------------------|----------------------------------------------------------------------------|
| Change        | \_тип поиска \_ \_ изменений       | Тип изменения, для которого выполняется оповещение.                                 |
| URL-адрес           | LPWSTR                         | URL-адрес объекта, который был изменен.                                   |
| олдурл        | LPWSTR                         | Если уведомление является перемещением, старый URL-адрес предоставляется и должен быть уникальным. |
| Приоритет      | \_приоритет уведомления \_ поиска | Приоритет изменения.                                                |



 

Тип поиска \_ \_ для \_ перечисления изменений определяется следующим образом:



| Значение перечисления                           | Значение   | Описание                                                                                     |
|--------------------------------------|---------|-------------------------------------------------------------------------------------------------|
| Поиск \_ изменений \_ Добавить                  | 0       | Уведомление предназначено для дополнительного URL-адреса.                                                      |
| Поиск \_ изменений, \_ Удаление               | 1       | Уведомление предназначено для удаления URL-адреса.                                                  |
| Поиск \_ изменений \_ изменить               | 2       | Уведомление заключается в том, что URL-адрес был изменен.                                               |
| Поиск \_ изменений \_ Перемещение \_ Переименование         | 3       | Уведомление предназначено для перемещения и переименования объекта на новый URL-адрес.                          |
| Поиск \_ в \_ каталоге семантики изменения \_ | 0x10000 | Уведомление предназначено для URL-адреса контейнера.                                                        |
| \_неполная \_ семантика изменения поиска \_   | 0x20000 | Уведомление предназначено для URL-адреса контейнера, который должен индексировать только его свойства контейнера. |
| \_ \_ Безопасность семантики изменений \_ поиска  | 0x40000 | Уведомление предназначено для URL-адреса или URL-адреса контейнера, свойства безопасности которого изменились.    |



 

\_ \_ Перечисление приоритета уведомлений поиска определяется следующим образом.



| Значение перечисления               | Значение | Описание                                                                                                                                                                    |
|--------------------------|-------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Поиск \_ обычного \_ приоритета | 0     | При индексировании URL-адреса следует использовать только обычные приоритеты. Эти уведомления обрабатываются перед обычным фоновым добавочным индексированием файлов и хранилищ пользователя. |



 

 

 
