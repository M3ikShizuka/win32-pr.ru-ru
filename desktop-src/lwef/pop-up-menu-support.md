---
title: Поддержка всплывающего меню
description: Поддержка всплывающего меню
ms.assetid: a8a1cf91-c18a-497f-89a7-b47536eaca0a
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 890d7eab6595200cb00e8422644b10f39807bab2
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "104337345"
---
# <a name="pop-up-menu-support"></a>Поддержка всплывающего меню

\[Microsoft Agent является устаревшим в Windows 7 и может быть недоступен в последующих версиях Windows.\]

Microsoft Agent включает в себя всплывающее меню (также называемое контекстным меню) для каждого символа. Сервер отображает это всплывающее меню автоматически, когда пользователь щелкает символ правой кнопкой мыши. Вы можете добавить команды для клиентского приложения в меню, определив коллекцию [**команд**](/windows/desktop/lwef/the-commands-collection-object) . Для каждой команды в заданной коллекции можно указать свойства [**Caption**](caption-property.md) и [**Visible**](visible-property.md) . **Заголовок** — это текст, отображаемый в меню, если свойство **Visible** имеет значение **true**. Можно также использовать свойство [**Enabled**](enabled-property.md) , чтобы отобразить команду в меню как отключенную и [**Хелпконтекстид**](helpcontextid-property.md) для поддержки справки для свойства. Определите ключ доступа для текста меню, добавив амперсанд (&) перед текстовым символом параметра **заголовка** текста.

Сервер автоматически добавляет в меню команды для открытия окна «Voice Commands» и скрывает этот символ, а также заголовки [**команд**](/windows/desktop/lwef/the-commands-collection-object) других клиентов символа, позволяющие пользователям переключаться между клиентами. Сервер автоматически добавляет в меню разделитель между записями меню и элементами, определенными клиентом. Разделители отображаются, только если в меню есть элементы для разделения.

Чтобы удалить команды из меню, используйте метод [**Remove**](remove-method.md) . Обратите внимание, что при отображении меню записи меню не меняются. При добавлении или удалении команд или изменении их свойств меню отображает изменения, когда пользователь повторно отображает меню.

Если вы предпочитаете использовать для символа собственные всплывающие службы меню, можно воспользоваться свойством [**аутопопупмену**](autopopupmenu-property.md) , чтобы отключить обработку сервером действия, выполняемого щелчком правой кнопкой мыши. Затем можно использовать уведомление о событии [**щелчка**](click-event.md) , чтобы создать собственное поведение при обработке меню.

Когда пользователь выбирает команду во всплывающем меню символа или в окне "Voice Commands", сервер запускает [**командное**](command-event.md) событие связанного клиента и передает обратно параметры входных данных с помощью объекта [**UserInput**](/windows/desktop/lwef/iagentuserinput) .

Сервер также предоставляет всплывающее меню для значка панели задач "символ". Когда символ отображается, его щелчок правой кнопкой мыши выводит те же команды, которые отображаются щелчком правой кнопкой мыши по символу. Однако если символ скрыт, в него включаются только команды, предоставляемые сервером.

 

 