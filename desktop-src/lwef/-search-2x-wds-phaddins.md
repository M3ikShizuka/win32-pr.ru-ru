---
title: Разработка надстроек для обработчика протокола
description: Можно расширить Microsoft Windows Desktop Search (WDS) для включения новых хранилищ данных путем реализации пользовательского обработчика протокола.
ms.assetid: 2447d95f-5832-453c-8857-3b4f4c158177
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 45a8688621f7d2fda653d769c0e1dfdadd240f49
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "104533173"
---
# <a name="developing-protocol-handler-add-ins"></a>Разработка надстроек для обработчика протокола

> [!NOTE]
> Windows Desktop Search 2. x — это устаревшая технология, которая изначально была доступна в качестве надстройки для Windows XP и Windows Server 2003. В более поздних выпусках используйте вместо этого [Поиск Windows](../search/-search-3x-wds-overview.md) .

Можно расширить Microsoft Windows Desktop Search (WDS) для включения новых хранилищ данных путем реализации пользовательского обработчика протокола.

## <a name="indexing-data-stores-with-protocol-handlers"></a>Индексирование хранилищ данных с помощью обработчиков протоколов

Хранилище данных — это источник содержимого (система базы данных, каталог, файловая система), где хранятся данные и которые можно просканировать с помощью индексатора WDS. Хранилище может быть иерархическим (например, базой данных) или на основе ссылок (например, веб-сайт). Обработчик протокола позволяет индексировать приложения, такие как WDS, для систематического сканирования узлов хранилища данных, чтобы извлечь релевантные сведения для включения в индекс. Каждый обработчик протокола используется для индексации определенного типа хранилища данных. Службы WDS входят в состав обработчиков протоколов для хранилищ файловой системы, а также для хранилищ данных Microsoft Outlook и Microsoft Outlook Express (хранилища электронной почты,. PST-файлы и т. д.). Например, при индексировании электронной почты Outlook обработчик протокола выполняет сканирование всех сообщений во всех папках, извлекая сведения из каждого сообщения и вложения. Эти сведения передаются индексатору для включения в каталог WDS.

Часто пользователям необходимо выполнять поиск в других хранилищах данных, таких как устаревшие базы данных, хранилища электронной почты или структуры данных, не поддерживаемые WDS. WDS можно расширить для сканирования нового хранилища данных с помощью или реализации обработчика протокола специально для этого хранилища данных. Во-первых, сначала необходимо определить, существует ли обработчик протокола для хранилища данных, возможно, для использования с другим приложением, например службами SharePoint Services. В этом случае можно установить обработчик протокола в системе. Однако если еще не существует другого обработчика протокола, необходимо реализовать его. Обработчики протоколов WDS используют те же спецификации, что и службы SharePoint Services, и часто взаимозаменяемы.

Кроме того, если хранилище данных содержит данные или типы файлов, отличные от типов файлов 200, поддерживаемых WDS, необходимо также реализовать фильтр для доступа к содержимому элементов в хранилище и индексировать его. WDS 2. x использует обработчик протокола и технологию [**IFilter**](/windows/desktop/api/filter/nn-filter-ifilter), используемые службами SharePoint Services. Если у вас уже есть фильтры для определенного хранилища и типа файлов, установленных в индексируемой системе, WDS использует существующие интерфейсы для индексирования этих данных.

 

## <a name="roadmap-to-adding-new-data-stores"></a>Стратегия добавления новых хранилищ данных

Чтобы расширить возможности WDS для обхода новых хранилищ данных, можно создать обработчик протокола и одну или несколько следующих надстроек: обработчик контекстного меню, обработчик значков и надстройка Сеарчпротоколоптионс.

1.  Создание и регистрация многопоточного обработчика протокола для хранилища данных.
    -   **Исеарчпротокол** — этот интерфейс обращается к протоколу и сопоставляет URL-адрес с иурлакцессор.
    -   **Иурлакцессор** — это основной интерфейс, используемый для доступа к элементам из источника содержимого и привязки содержимого к соответствующему фильтру.
    -   **Ипротоколхандлерсите** — этот интерфейс используется для запроса и загрузки дополнительных фильтров.
    -   **IFilter** . Этот интерфейс возвращает URL-адрес каждого элемента в папке в виде свойств значения для обработки.

    > [!Note]
    >
    > Минимальная функция надстройки, необходимая для возврата результатов поиска из неиерархического хранилища данных, является реализацией интерфейсов Исеарчпротокол и Иурлакцессор.

     

2.  Реализуйте интерфейс Исеарчпротоколоптионс, чтобы включить настроенные параметры обработчика протоколов, такие как предопределенные начальные страницы:
    -   **Исеарчпротоколоптионс** — этот интерфейс определяет URL-адреса по умолчанию для обработки обработчиком протокола, определяет требования к обработчику протокола и определяет, выполнены ли требования в данной системе.
3.  Расширение оболочки для включения элементов пользовательского интерфейса, таких как контекстные меню и значки файлов, путем реализации следующих интерфейсов:
    -   **Ишеллфолдер** — этот интерфейс, используемый для управления папками, необходим для предоставления интерфейсов IContextMenu и иекстрактикон для URL-адреса в новом хранилище.
    -   **Иперсистфолдер** — этот интерфейс необходим для указания объекту папки оболочки на инициализацию самого себя.
    -   **IPersist** — этот интерфейс предоставляет идентификатор класса (CLSID) объекта, который может храниться в системе постоянно.
    -   **IContextMenu** — этот интерфейс определяет контекстное меню щелчка правой кнопкой мыши для элемента, на который указывает URL-адрес.
    -   **Иекстрактикон** — этот интерфейс определяет значок, отображаемый для элемента, на который указывает URL-адрес.
4.  Реализуйте механизм уведомления индексатора об изменениях в хранилище данных.
    -   **Исеарчитемсчанжедсинк** — этот интерфейс позволяет обработчику протокола уведомлять индекс изменений в хранилище данных. Это повышает производительность, гарантируя, что индексатор не выполняет сканирование всего хранилища по добавочным индексам.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

**Reference**
</dt> <dt>

[Реализация обработчика протокола для WDS](-search-2x-wds-phimplementing.md)
</dt> <dt>

[Добавление значков, предварительных версий и контекстных меню с расширениями оболочки](-search-2x-wds-ph-ui-extensions.md)
</dt> <dt>

[Уведомление индекса изменений](-search-2x-wds-notifyingofchanges.md)
</dt> <dt>

[Установка и регистрация обработчиков протоколов](-search-2x-wds-ph-install-registration.md)
</dt> </dl>

 

 