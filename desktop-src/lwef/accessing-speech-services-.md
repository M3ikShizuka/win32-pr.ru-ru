---
title: Доступ к голосовым службам (Управление агентом Microsoft)
description: Сведения о доступе к голосовым службам с помощью управления Microsoft Agent. Microsoft Agent является устаревшим в Windows 7.
ms.assetid: c6c10f2a-a433-4a8e-a069-48e3c2032fb8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 035bde03d18b77ce43c47375f2075bba02416c39
ms.sourcegitcommit: d0eb44d0a95f5e5efbfec3d3e9c143f5cba25bc3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/17/2021
ms.locfileid: "112262716"
---
# <a name="accessing-speech-services-microsoft-agent-control"></a><span data-ttu-id="d6942-104">Доступ к голосовым службам (Управление агентом Microsoft)</span><span class="sxs-lookup"><span data-stu-id="d6942-104">Accessing Speech Services (Microsoft Agent Control)</span></span>

<span data-ttu-id="d6942-105">\[Microsoft Agent является устаревшим в Windows 7 и может быть недоступен в последующих версиях Windows.\]</span><span class="sxs-lookup"><span data-stu-id="d6942-105">\[Microsoft Agent is deprecated as of Windows 7, and may be unavailable in subsequent versions of Windows.\]</span></span>

<span data-ttu-id="d6942-106">Несмотря на то, что службы Microsoft Agent включают поддержку речевого ввода, для доступа к службам речевого ввода агента должен быть установлен совместимый обработчик распознавания речи для команд и управления.</span><span class="sxs-lookup"><span data-stu-id="d6942-106">Although Microsoft Agent's services include support for speech input, a compatible command-and-control speech recognition engine must be installed to access Agent's speech input services.</span></span> <span data-ttu-id="d6942-107">Аналогичным образом, если вы хотите использовать речевые службы агента Майкрософт для поддержки синтезированного речевого вывода для символа, необходимо установить совместимый речевой механизм преобразования текста в речь для вашего символа.</span><span class="sxs-lookup"><span data-stu-id="d6942-107">Similarly, if you want to use Microsoft Agent's speech services to support synthesized speech output for a character, you must install a compatible text-to-speech (TTS) speech engine for your character.</span></span>

<span data-ttu-id="d6942-108">Чтобы включить поддержку речевого ввода в приложении, определите объект [**Command**](https://www.bing.com/search?q=**Command**) и задайте его свойство [**Voice**](https://www.bing.com/search?q=**Voice**) .</span><span class="sxs-lookup"><span data-stu-id="d6942-108">To enable speech input support in your application, define a [**Command**](https://www.bing.com/search?q=**Command**) object and set its [**Voice**](https://www.bing.com/search?q=**Voice**) property.</span></span> <span data-ttu-id="d6942-109">Агент автоматически загрузит речевые службы, чтобы при нажатии пользователем ключа прослушивания или при вызове [**Listen**](https://www.bing.com/search?q=**Listen**)был загружен модуль распознавания речи.</span><span class="sxs-lookup"><span data-stu-id="d6942-109">Agent will automatically load speech services, so that when the user presses the Listening key or you call [**Listen**](https://www.bing.com/search?q=**Listen**), the speech recognition engine will be loaded.</span></span> <span data-ttu-id="d6942-110">По умолчанию [**LanguageID**](https://www.bing.com/search?q=**LanguageID**) символа определяет, какая подсистема загружена.</span><span class="sxs-lookup"><span data-stu-id="d6942-110">By default the character's [**LanguageID**](https://www.bing.com/search?q=**LanguageID**) will determine which engine is loaded.</span></span> <span data-ttu-id="d6942-111">Агент пытается загрузить первый обработчик, который возвращает Microsoft Speech API (SAPI), как соответствует этому языку.</span><span class="sxs-lookup"><span data-stu-id="d6942-111">Agent attempts to load the first engine that the Microsoft Speech API (SAPI) returns as matching this language.</span></span> <span data-ttu-id="d6942-112">Используйте [**срмодеид**](https://www.bing.com/search?q=**SRModeID**) , если хотите загрузить конкретный обработчик.</span><span class="sxs-lookup"><span data-stu-id="d6942-112">Use [**SRModeID**](https://www.bing.com/search?q=**SRModeID**) if you want to load a specific engine.</span></span>

<span data-ttu-id="d6942-113">Чтобы включить вывод текста в речь, используйте метод [**говорите**](https://www.bing.com/search?q=**Speak**) .</span><span class="sxs-lookup"><span data-stu-id="d6942-113">To enable text-to-speech output, use the [**Speak**](https://www.bing.com/search?q=**Speak**) method.</span></span> <span data-ttu-id="d6942-114">Агент будет автоматически пытаться загрузить подсистему, соответствующую [**LanguageIDу**](https://www.bing.com/search?q=**LanguageID**)символа.</span><span class="sxs-lookup"><span data-stu-id="d6942-114">Agent will automatically attempt to load an engine that matches the character's [**LanguageID**](https://www.bing.com/search?q=**LanguageID**).</span></span> <span data-ttu-id="d6942-115">Если определение символа включает в себя конкретный идентификатор режима модуля TTS и этот механизм доступен и соответствует **LanguageID** символа, агент загружает эту подсистему для символа.</span><span class="sxs-lookup"><span data-stu-id="d6942-115">If the character's definition includes a specific TTS engine mode ID and that engine is available and matches the character's **LanguageID**, Agent loads that engine for the character.</span></span> <span data-ttu-id="d6942-116">Если это не так, он загружает первый модуль TTS, который функция SAPI возвращает в соответствии с параметром языка символа.</span><span class="sxs-lookup"><span data-stu-id="d6942-116">If it is not, it loads the first TTS engine that SAPI returns as matching the character's language setting.</span></span> <span data-ttu-id="d6942-117">Можно также использовать [**ттсмодеид**](https://www.bing.com/search?q=**TTSModeID**) для загрузки определенного подсистемы.</span><span class="sxs-lookup"><span data-stu-id="d6942-117">You can also use the [**TTSModeID**](https://www.bing.com/search?q=**TTSModeID**) to load a specific engine.</span></span>

<span data-ttu-id="d6942-118">Как правило, агент загружает распознавание речи при инициировании режима прослушивания [**и при первом**](https://www.bing.com/search?q=**Speak**) вызове обработчика текста в речь.</span><span class="sxs-lookup"><span data-stu-id="d6942-118">Typically, Agent loads speech recognition when the Listening mode is initiated and a text-to-speech engine when [**Speak**](https://www.bing.com/search?q=**Speak**) is first called.</span></span> <span data-ttu-id="d6942-119">Однако если вы хотите предварительно загрузить модуль распознавания речи, запросите свойства, связанные с интерфейсами распознавания речи.</span><span class="sxs-lookup"><span data-stu-id="d6942-119">However, if you want to preload the speech engine, you query the properties related to the speech interfaces.</span></span> <span data-ttu-id="d6942-120">Например, запросы к [**срмодеид**](https://www.bing.com/search?q=**SRModeID**) или [**ттсмодеид**](https://www.bing.com/search?q=**TTSModeID**) будут пытаться загрузить этот тип обработчика.</span><span class="sxs-lookup"><span data-stu-id="d6942-120">For example, querying [**SRModeID**](https://www.bing.com/search?q=**SRModeID**) or [**TTSModeID**](https://www.bing.com/search?q=**TTSModeID**) will attempt to load that type of engine.</span></span>

<span data-ttu-id="d6942-121">Так как речевые службы агента Microsoft Agent основаны на Microsoft Speech API, можно использовать любые механизмы, поддерживающие необходимые речевые интерфейсы.</span><span class="sxs-lookup"><span data-stu-id="d6942-121">Because Microsoft Agent's speech services are based on the Microsoft Speech API, you can use any engines that support the required speech interfaces.</span></span>

 

 




