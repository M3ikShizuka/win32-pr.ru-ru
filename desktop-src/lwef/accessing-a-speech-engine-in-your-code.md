---
title: Доступ к модулю распознавания речи в коде
description: Доступ к модулю распознавания речи в коде
ms.assetid: ddfe0552-a29e-4ce4-b608-c131efbe300b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b7d81841f6f287d36a6ac01fa77294b1754eeb9b
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "105691487"
---
# <a name="accessing-a-speech-engine-in-your-code"></a>Доступ к модулю распознавания речи в коде

\[Microsoft Agent является устаревшим в Windows 7 и может быть недоступен в последующих версиях Windows.\]

Чтобы использовать определенный обработчик речи в коде, используйте API агента, чтобы задать подсистему. Для модулей речевого ввода используйте [**срмодеид**](https://www.bing.com/search?q=**SRModeID**), указав идентификатор режима для подсистемы. Однако обратите внимание, что подсистема должна быть установлена. Чтобы определить наличие подсистемы, можно запросить **срмодеид**. Подсистема должна соответствовать параметру [**LanguageID**](https://www.bing.com/search?q=**LanguageID**) символа. Например, нельзя задать для **СРМОДЕИД** идентификатор режима распознавания речи на немецком языке для символа, **LanguageID** на французском языке.

**Идентификаторы режима модуля речевого ввода**



| Голосовая связь                                    | Идентификаторы режимов                             |
|------------------------------------------|--------------------------------------|
| Модуль распознавания речи (Майкрософт) версии 4.0 | {D8905400-B5C8-11D0-B968020AFDB1B9C} |



 

Проверьте и задайте в коде [**LanguageID**](https://www.bing.com/search?q=**LanguageID**) и [**срмодеид**](https://www.bing.com/search?q=**SRModeID**) символа, прежде чем пытаться определить грамматику для параметров голоса для **командных** объектов приложения. Кроме того, рекомендуется проверять язык браузера или системы, чтобы вы могли быть уверены в соответствии конфигурации пользователей. Механизм может завершиться ошибкой, если вы попытаетесь определить грамматику для языка, который не соответствует подсистеме.

Кодировка, используемая для вывода текста в речь (TTS), может быть скомпилирована с параметром ID режима подсистемы речевого вывода по умолчанию. При загрузке символа, если модуль установлен и соответствует [**LanguageID**](https://www.bing.com/search?q=**LanguageID**)символа, агент попытается загрузить идентификатор этого режима для речевого вывода. Если обработчик отсутствует или имеет другой **LanguageID**, агент попытается загрузить найденный идентификатор первого режима, который соответствует **LanguageID** символа, но по-прежнему задает скорость и высоту скомпилированного символа.

Обратите внимание, что поскольку все символы, предоставляемые Microsoft Agent, компилируются для использования ядра Lernout & Hauspie Трувоице американский английский в качестве подсистемы речевого вывода по умолчанию, Настройка скорости и высоты символов настраивается для этого языка и подсистемы. Поэтому при использовании других модулей TTS или модулей других языков символы могут не говорить с оптимальным шагом или скоростью. Несмотря на то, что приложение или веб-страница не может записывать значения свойств « [**Высота**](/previous-versions/ms809428(v=msdn.10)) » и « [**скорость**](https://www.bing.com/search?q=**Speed**) », в выходной текст можно включить теги « [смолой](pit-tag.md) » («шаг») и [SPD](spd-tag.md) (Speed), которые будут временно изменять шаг и скорость для конкретного utterance. Однако использование тегов смолой и SPD не приведет к изменению свойств « **шаг** » и « **скорость** ». Дополнительные сведения см. [в разделе Программирование элемента управления Microsoft Agent](programming-the-microsoft-agent-control.md) и [тегов речевого вывода агента Microsoft Agent](microsoft-agent-speech-output-tags.md) .

Кроме того, при использовании других модулей TTS (SPCHAPI.exe), совместимых с SAPI, необходимо установить исполняемый модуль SAPI 4.0, отличный от модуля L&H Трувоице американский (английский язык) с введенными в Microsoft Agent символами, чтобы модули были перечислены правильно. На веб-странице добавьте следующий тег объекта для автоматической установки компонента:

``` syntax
<OBJECT width=0 height=0
CLASSID="CLSID:0C7F3F20-8BAB-11d2-9432-00C04F8EF48F"
CODEBASE="#VERSION=4,0,0,0">
</OBJECT>
```

Чтобы запросить или задать идентификатор режима модуля, используйте [**ттсмодеид**](https://www.bing.com/search?q=**TTSModeID**). С помощью **ттсмодеид** можно задать идентификатор режима, отличный от [**LanguageID**](https://www.bing.com/search?q=**LanguageID**)символа. Например, можно задать немецкий символ для диктовки с использованием идентификатора французского режима. Идентификаторы режима обработчика речевого вывода определяют не только используемый механизм, но и соответствующие голоса, поддерживаемые подсистемой. Можно также использовать редактор символов Microsoft Agent или средства, включенные в [документацию по Microsoft Speech SDK](https://msdn.microsoft.com/library/ee705648.aspx) , для запроса идентификаторов режимов ОБРАБОТЧИКов TTS, установленных в системе.

**Идентификаторы режима речевого вывода**



| Голосовая связь                                       | Идентификаторы режимов                               |
|---------------------------------------------|----------------------------------------|
| Взрослый женщина \# 1, Английский (США), L&H трувоице  | {CA141FD0-AC7F-11D1-97A3-006008273008} |
| Взрослый женщина \# 2, Английский (США), L&H трувоице  | {CA141FD0-AC7F-11D1-97A3-006008273009} |
| Взрослый папа \# 1, Английский (США), L&H трувоице    | {CA141FD0-AC7F-11D1-97A3-006008273000} |
| Взрослый папа \# 2, Английский (США), L&H трувоице    | {CA141FD0-AC7F-11D1-97A3-006008273001} |
| Взрослый папа \# 3, Английский (США), L&H трувоице    | {CA141FD0-AC7F-11D1-97A3-006008273002} |
| Взрослый папа \# 4, Английский (США), L&H трувоице    | {CA141FD0-AC7F-11D1-97A3-006008273003} |
| Взрослый папа \# 5, Английский (США), L&H трувоице    | {CA141FD0-AC7F-11D1-97A3-006008273004} |
| Взрослый папа \# 6, Английский (США), L&H трувоице    | {CA141FD0-AC7F-11D1-97A3-006008273005} |
| Взрослый папа \# 7, Английский (США), L&H трувоице    | {CA141FD0-AC7F-11D1-97A3-006008273006} |
| Взрослый \# 8, Английский (США), L&H трувоице    | {CA141FD0-AC7F-11D1-97A3-006008273007} |
| TTS3000, Британский английский, L&H         | {227A0E40-A92A-11d1-B17B-0020AFED142E} |
| Питер, Британский английский, L&H TTS3000         | {227A0E41-A92A-11d1-B17B-0020AFED142E} |
| Линда, голландский, L&H TTS3000                   | {A0DDCA40-A92C-11d1-B17B-0020AFED142E} |
| Александр, голландский, L&H TTS3000               | {A0DDCA41-A92C-11d1-B17B-0020AFED142E} |
| Вéроникуе, французский, L&H TTS3000              | {0879A4E0-A92C-11d1-B17B-0020AFED142E} |
| Пьер, французский, L&H TTS3000                 | {0879A4E1-A92C-11d1-B17B-0020AFED142E} |
| Анна, немецкий, L&H TTS3000                   | {3A1FB760-A92B-11d1-B17B-0020AFED142E} |
| Стефан, немецкий, L&H TTS3000                 | {3A1FB761-A92B-11d1-B17B-0020AFED142E} |
| Barbara, итальянский, L&H TTS3000               | {7EF71700-A92D-11d1-B17B-0020AFED142E} |
| Стефано, итальянский, L&H TTS3000               | {7EF71701-A92D-11d1-B17B-0020AFED142E} |
| Наоко, японский, L&H TTS3000                | {A778E060-A936-11d1-B17B-0020AFED142E} |
| Кенжи, японский, L&H TTS3000                | {A778E061-A936-11d1-B17B-0020AFED142E} |
| Шин-AH, корейский, L&H TTS3000                | {12E0B720-A936-11d1-B17B-0020AFED142E} |
| Июн-принес, корейский, L&H TTS3000                 | {12E0B721-A936-11d1-B17B-0020AFED142E} |
| Жулиана, португальский (Бразилия), L&H TTS3000   | {8AA08CA0-A1AE-11d3-9BC5-00A0C967A2D1} |
| Александр, португальский (Бразилия), L&H TTS3000 | {8AA08CA1-A1AE-11d3-9BC5-00A0C967A2D1} |
| Светлана, Русский, L&H TTS3000              | {06377F80-D48E-11d1-B17B-0020AFED142E} |
| Борис, Русский, L&H TTS3000                 | {06377F81-D48E-11d1-B17B-0020AFED142E} |
| Кармен, испанский, L&H TTS3000                | {2CE326E0-A935-11d1-B17B-0020AFED142E} |
| Кирилл, испанский, L&H TTS3000                 | {2CE326E1-A935-11d1-B17B-0020AFED142E} |



 

> [!Note]  
> Существует разница между CLSID установки механизма распознавания речи и ИДЕНТИФИКАТОРом его режима. Аналогично, обработчик речи также имеет идентификатор обработчика, но этот идентификатор неприменим в API агента.

 

 

 