---
title: Иажент Загрузка
description: Иажент Загрузка
ms.assetid: 8f25e6b6-a117-4b37-969a-d8f80c7be224
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b4e30a25abb631714384f8349a9d260deade0d6d
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "103987488"
---
# <a name="iagentload"></a>Иажент:: Load

\[Microsoft Agent является устаревшим в Windows 7 и может быть недоступен в последующих версиях Windows.\]

``` syntax
HRESULT Load(
   VARIANT vLoadKey,  // data provider
   long * pdwCharID,  // address of a variable for character ID
   long * pdwReqID    // address of a variable for request ID
);
```

Загружает символ в коллекцию [**символов**](./iagent.md) .

-   Возвращает значение S \_ , чтобы указать, что операция выполнена успешно.

<dl> <dt>

<span id="vLoadKey"></span><span id="vloadkey"></span><span id="VLOADKEY"></span>*влоадкэй*
</dt> <dd>

Тип данных Variant, который должен быть одним из следующих:



|            |                                                                       |
|------------|-----------------------------------------------------------------------|
| *filespec* | Локальное расположение файла определения указанного символа. |
| *URL-адрес*      | HTTP-адрес для файла определения символа.                 |



 

</dd> <dt>

<span id="pdwCharID"></span><span id="pdwcharid"></span><span id="PDWCHARID"></span>*пдвчарид*
</dt> <dd>

Адрес переменной, которая получает идентификатор символа.

</dd> <dt>

<span id="pdwReqID"></span><span id="pdwreqid"></span><span id="PDWREQID"></span>*пдврекид*
</dt> <dd>

Адрес переменной, которая получает идентификатор запроса на [**загрузку**](load-method.md) .

</dd> </dl>

Можно загрузить символы из подкаталога Microsoft Agent, указав относительный путь (который не включает двоеточие или символ косой черты). Это префикс добавляет путь к каталогу символов агента (находится в локализованном каталоге% Windows% \\ мсажент). Можно также использовать относительный адрес для указания собственного каталога в каталоге символов агента.

Один и тот же символ (символ с одинаковым идентификатором GUID) нельзя загрузить несколько раз из одного соединения. Аналогичным образом нельзя загрузить символ по умолчанию и другие символы одновременно из одного соединения, так как символ по умолчанию может совпадать с другим символом. Однако можно создать другое соединение (с помощью CoCreateInstance) и загрузить тот же символ.

Поставщик данных Microsoft Agent поддерживает загрузку символьных данных, хранящихся в виде одного структурированного файла (. ACS) с символьными данными и данными анимации либо в виде отдельных символьных данных (. ACF) и Animation (. АКА) файлы. Как правило, используйте один структурированный. Файл ACS для загрузки символа, хранящегося на локальном диске или в сети и доступ к которому осуществляется с помощью протокола обычного файла (например, UNC-пути). Используйте отдельный. ACF и. АКА файлы, если требуется загружать файлы анимации по отдельности с удаленного сайта, к которому они обращаются по протоколу HTTP.

Предмет. Файлы ACS, использующие метод [**Load**](load-method.md) , предоставляют доступ к анимации символа; После загрузки можно использовать метод [**Play**](play-method.md) для анимации символа. Предмет. ACF файлы, вы также можете использовать метод [**Prepare**](/windows/desktop/lwef/iagentcharacter--prepare) для загрузки данных анимации. Метод **Load** не поддерживает загрузку. Файлы ACS с веб-сайта HTTP.

При загрузке символа символ не отображается автоматически. Чтобы сделать символ видимым, сначала используйте метод [**Показать**](show-method.md) .

 

 