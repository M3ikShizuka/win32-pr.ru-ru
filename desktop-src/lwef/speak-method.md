---
title: Метод говорите
description: Метод говорите
ms.assetid: 6267e04c-feb5-4f48-8a88-4e6ca3388bf3
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 88792a53fac80c68154f938e91fb9bfe63b2b8e3
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "104487624"
---
# <a name="speak-method"></a>Метод говорите

\[Microsoft Agent является устаревшим в Windows 7 и может быть недоступен в последующих версиях Windows.\]

<dl> <dt>

<span id="Description"></span><span id="description"></span><span id="DESCRIPTION"></span>**Nописание**
</dt> <dd>

Говорит заданный текстовый или звуковой файл для указанного символа.

</dd> <dt>

<span id="Syntax"></span><span id="syntax"></span><span id="SYNTAX"></span>**Syntax**
</dt> <dd>

*Агент ***. Символы ("*** чарактерид * * *"). Проговаривать* *  \[ *текст* \] , \[ *URL-адрес*\]



| Отделение   | Описание                                                                                                                                                                                                                                                  |
|--------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| *Text* | Необязательный элемент. Строка, указывающая, что сообщает символ.                                                                                                                                                                                                   |
| *Url*  | Необязательный элемент. Строковое выражение, задающее расположение звукового файла (. WAV или. Формат ЛВВ). Расположение можно указать в виде файла (включая спецификацию пути UNC) или URL-адреса (если данные анимации символов также извлекаются по протоколу HTTP). |



 

</dd> </dl>

## <a name="remarks"></a>Комментарии

Хотя параметры *Text* и *URL* являются необязательными, необходимо указать один из них. Чтобы использовать этот метод с символом, настроенным для диктовки только в его подсказке или использовании механизма преобразования текста в речь (TTS), просто укажите параметр *Text* . Включать пробел между словами для определения подходящих слов в тексте всплывающей подсказки, даже для тех языков, которые обычно не содержат пробелов.

Можно также включить в текстовый параметр символы вертикальной черты ( \| ), чтобы назначить альтернативные строки, чтобы сервер случайно выбрал другую строку каждый раз при обработке метода. 

Поддержка символов вывода TTS определяется при компиляции символа с помощью редактора символов Microsoft Agent. Чтобы создать вывод TTS, перед вызовом этого метода необходимо установить совместимый обработчик TTS. Дополнительные сведения см. в разделе [доступ к голосовым службам](accessing-speech-services.md).

При использовании записанного звукового файла (. WAV или. Только формат ЛВВ.) выходные данные для символа указывают расположение файла в параметре *URL-адреса* . Эта спецификация файла может включать локальный (абсолютный или относительный) или UNC-путь. Имя файла не может содержать символы, не включенные в кодовую страницу США 1252. Однако если для доступа к данным символьной анимации используется протокол HTTP, перед вызовом метода **говорите** используйте метод [**Get**](get-method.md) для загрузки анимации. Сведения о творческой работе см. [в разделе Использование средства редактирования лингвистических сведений Майкрософт](using-the-microsoft-linguistic-information-sound-editing-tool.md) . ЛВВ файлы.

При использовании записанных выходных данных звукового файла можно по-прежнему использовать параметр Text для указания слов, отображаемых в *тексте* всплывающего слова символа. Однако при указании лингвистическо расширенного звукового файла (. ЛВВ) для параметра *URL-адреса* и не указывайте текст для всплывающего окна Word, параметр *Text* использует текст, хранящийся в файле.

Можно также изменять параметры вывода речи специальными тегами, включенными в параметр *Text* . Дополнительные сведения см. в [статье Теги речевого вывода Microsoft Agent](microsoft-agent-speech-output-tags.md).

Если объявляется ссылка на объект и устанавливается этот метод, он возвращает объект [**запроса**](/windows/desktop/lwef/the-request-object) . Его можно использовать для синхронизации других частей кода с выходными данными символа, как показано в следующем примере:


```
   Dim SpeakRequest as Object
...
   Set SpeakRequest = Genie.Speak ("And here it is.")
...
   Sub Agent1_RequestComplete (ByVal Request as Object)
   ' Make certain the request exists
   If SpeakRequest Not Nothing Then
      ' See if it was this request
      If Request = SpeakRequest Then
         ' Display the message box 
         Msgbox "Ta da!"
      End If
   End If
   End Sub
```



Можно также использовать объект [**запроса**](/windows/desktop/lwef/the-request-object) для проверки определенных условий возникновения ошибок. Например, если вы используете метод **говорите** и не установили совместимый механизм TTS, сервер устанавливает свойство [**Status**](status-property.md) объекта **запроса** в значение "Failed" со свойством [**Description**](description-property.md) на "незарегистрированный" класс или ошибка "неизвестный или возвращенный объект". Чтобы определить, установлен ли модуль TTS, используйте свойство [**ттсмодеид**](ttsmodeid-property.md) .

Аналогичным образом, если вы попытаетесь поговорить с звуковым файлом, а если файл не был загружен или возникла проблема с звуковым устройством, сервер также задает для свойства [**Status**](status-property.md) объекта [**запроса**](/windows/desktop/lwef/the-request-object) значение "сбой" с соответствующим номером кода ошибки.

Для синхронизации кода можно также включить Теги речи в закладки в тексте:


```
   Dim SpeakRequest as Object
...
   Set SpeakRequest = Genie.Speak ("And here \mrk=100\it is.")
...
   Sub Agent1_Bookmark (ByVal BookmarkID As Long)
   If BookmarkID = 100 Then
      ' Display the message box 
         Msgbox "Tada!"
      End If
   End Sub
```



Дополнительные сведения о теге распознавания речи см. в разделе [теги вывода речи](mrk-tag.md).

Метод **говорите** использует последнее действие, чтобы определить, какую анимацию речи следует воспроизвести. Например, если перед командой **говорите** [**проигрывать**](play-method.md) «**жестуреригхт**», то на сервере будет воспроизводиться **жестуреригхт** , а затем анимация **жестуреригхт** . Если последняя воспроизводимая анимация не имеет речи, агент воспроизводит анимацию, назначенную состоянию **речи** символа.

Если вы выберете **разговор** и канал звука занят, звуковые выходные данные не будут слышны, а текст отобразится в выноске.

Автоматическое разбиение слов агента в выноске обрывает слова, используя пробелы (например, пробел или знак табуляции). Однако, если это невозможно, может нарушиться слово, чтобы уместить всплывающее сообщение. В таких языках, как японский, китайский и тайский, если пробелы не используются для разбиения слов, вставьте символ пробела нулевой ширины (0x200B) в Юникоде между символами, чтобы определить логические разрывы слов.

> [!Note]  
> Свойство [**включено**](enabled-property.md) для всплывающей подсказки также должно иметь **значение true** для отображаемого текста.

 

> [!Note]  
> Задайте идентификатор языка символа (с помощью параметра **LanguageID** символа перед использованием метода **говорите** , чтобы обеспечить отображение текста внутри всплывающей подсказки.

 

## <a name="see-also"></a>См. также:

Событие [**закладки**](bookmark-event.md), [**событие рекуестстарт**](requeststart-event.md), [**событие рекуесткомплете**](requestcomplete-event.md)


 

 