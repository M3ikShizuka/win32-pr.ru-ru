---
title: Изменения Microsoft Agent в Windows Vista
description: Изменения Microsoft Agent в Windows Vista
ms.assetid: 2498e8d5-2274-477c-a807-77443c76afb7
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 440fb8afb7acb0118c1e48669089c083e935db5b
ms.sourcegitcommit: 967ba3a2a618e6088cb607164a2a924530278645
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/30/2021
ms.locfileid: "113102153"
---
# <a name="microsoft-agent-changes-in-windows-vista"></a>Изменения Microsoft Agent в Windows Vista

\[Microsoft Agent является устаревшим в Windows 7 и может быть недоступен в последующих версиях Windows.\]

В Windows Vista появились некоторые изменения в способах взаимодействия распознавания речи и речи с Windows Vista.

Теперь Microsoft Agent поддерживает компоненты преобразования текста в речь 5 и распознавания речи. Свойства Ттсмодеид и Срмодеид объекта Agent по-прежнему используются для определения выбранного голоса или распознавателя для агента и для изменения этого выбора. Режимы SAPI 4 отображаются как строки GUID, такие как "{ca141fd0-ac7f-11D1-97a3-006008273000}", а токены SAPI 5 (эквивалентно режимам) отображаются как обычные имена, например "Microsoft Анна". Как и в предыдущих выпусках, агент по умолчанию будет использовать механизмы TTS и SR. Если установлены ядра SAPI 5, они всегда будут предпочтительнее всех ядер SAPI 4, которые могут быть установлены. Модуль преобразования текста в речь по умолчанию, как указано на панели управления, используется, если его пол соответствует символу, в противном случае выбирается ядро SAPI 5 того же пола, если таковой имеется. Идентификаторы режима, указанные непосредственно в символе, игнорируются, если имеются обработчики SAPI 5. Параметры по умолчанию можно проверить, прочитав свойства Ттсмодеид и Срмодеид в начале скрипта.

Как и ранее, Ттсмодеид и Срмодеид будут возвращать пустую строку, если отсутствует возможность распознавания текста или речи. Чтобы выбрать конкретный голосовой или распознаватель, необходимо задать для этих свойств соответствующую строку режима SAPI 4 или имя токена SAPI 5. После настройки определенного режима или токена можно также снова прочитать свойство, чтобы убедиться, что его значение было принято, что означает, что новый режим или маркер действительно был доступен и был успешно выбран. Для разработчиков, занимающихся развертыванием агента через Интернет, обратите внимание, что у многих пользователей Vista уже установлен один или несколько голосов SAPI 5, поэтому вам может потребоваться избежать автоматической загрузки голосов SAPI 4, если только сценарий не запрашивает их, так как загруженный голос не будет использоваться.

Модули преобразования текста в SAPI 5 используют разные наборы стандартов по сравнению с SAPI 4 для аннотирования речи с разметкой, например для изменения высоты или скорости распознавания речи. В SAPI 4 используются команды "косая черта", такие как/Пит = 170/. В SAPI 5 используются XML-теги, такие как \<PITCH MIDDLE="5"/> . В Vista агент принимает оба типа заметок в виде команд "косая черта", которые не будут пропускаться механизмами SAPI 5, а XML-теги будут игнорироваться механизмами SAPI 4. Как и в случае с маркерами косой черты, поддержка XML-тегов SAPI 5 отличается от поставщика к поставщику, а некоторые поставщики могут поддерживать дополнительные теги. Дополнительные сведения о XML-тегах SAPI 5 см. в спецификации SAPI 5.

Агент больше не поддерживает несколько языков. Язык, используемый агентом, всегда считается текущим языком пользователя, зарегистрированным в операционной системе. Свойство LanguageID объекта агента по-прежнему доступно для записи, но его значение игнорируется агентом в Vista. Например, если язык пользователя задан как английский (&H0409), и он использует программу, которая устанавливает для LanguageID значение французский (&H040C), то текст подсказки голоса и дополнительные параметры символов по-прежнему будут отображаться на английском языке.

 

 




