---
title: Часто задаваемые вопросы по программированию сценариев
description: Часто задаваемые вопросы по программированию сценариев
ms.assetid: 84078c5b-7b04-48fa-9d0a-d95393c323eb
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 28dec468eb5147968ca0db774f081212a78cf40d
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104067230"
---
# <a name="programming-scripting-faq"></a>Часто задаваемые вопросы по программированию сценариев

\[Microsoft Agent является устаревшим в Windows 7 и может быть недоступен в последующих версиях Windows.\]

### <a name="when-i-use-microsoft-visual-basic-or-other-development-tools-for-scripting-microsoft-agent-i-do-not-see-all-the-properties-and-events-used-in-your-samples-how-do-i-access-them"></a>При использовании Microsoft Visual Basic (или других средств разработки) для создания сценариев Microsoft Agent я не вижу всех свойств и событий, используемых в примерах. Разделы справки получить к ним доступ?

Большинство событий, методов и свойств, поддерживаемых элементом управления Microsoft Agent, доступны только во время выполнения. Дополнительные сведения см. [в справке по программированию элемента управления Microsoft Agent](programming-the-microsoft-agent-control.md) .

### <a name="the-map-tag-or-some-other-tag-doesnt-seem-to-work"></a>Тег Map (или другой тег) не работает.

Некоторые теги содержат строки в кавычках. Для некоторых языков программирования, таких как Microsoft Visual Basic и Visual Basic Scripting Edition, может потребоваться использовать две кавычки для обозначения параметра тега или сцепление символа двойной кавычки в составе строки. Последнее показано в этом Visual Basic примере:

Agent1. characters ("Genie"). Говорите: "это \\ Map =" + Chr (34) + "произнесенный текст" \_ + Chr (34) + "=" + Chr (34) + "текст всплывающего окна" + Chr (34) + " \\ ."

Для программирования C, C++ и Java перед символами обратной косой черты и двойными кавычками следует указать обратную косую черту. Пример:

BSTR Бсзспеак = Сисаллокстринг (L "это \\ \\ Map = \\ " произнесенный текст \\ "= \\ " текст выноски \\ " \\ \\ ");

Пчарактер — >говорите (Бсзспеак,......);

> [!Note]  
> Microsoft Agent не поддерживает все теги, указанные в Microsoft Speech API. Кроме того, поддержка некоторых параметров может зависеть от установленного модуля преобразования текста в речь. Дополнительные сведения см. в [статье Теги речевого вывода Microsoft Agent](microsoft-agent-speech-output-tags.md).

 

### <a name="i-dont-seem-to-get-requeststart-and-requestcomplete-events-in-my-script-or-program"></a>Я не буду получать события Рекуестстарт и Рекуесткомплете в моем сценарии (или программе).

Это может быть вызвано одной из следующих причин.

-   Ваш язык программирования не полностью поддерживает элементы управления ActiveX. Проверьте документацию, чтобы убедиться, что она поддерживает интерфейс ActiveX и события для объектов ActiveX.
-   На веб-странице со скриптами не удалось установить или загрузить другой элемент управления. Убедитесь, что все остальные элементы управления установлены и правильно загружаются без агента Майкрософт.
-   На веб-странице скрипта с кадрами у вас есть `<OBJECT>` тег для элемента управления Microsoft Agent на одной странице и события, внесенные на другой странице. События отправляются только на страницу, на которой размещен элемент управления.

### <a name="i-am-using-the-microsoft-agent-control-with-other-activex-controls-on-my-webpage-and-i-dont-seem-to-get-any-events"></a>Я использую элемент управления Microsoft Agent с другими элементами управления ActiveX на моей веб-странице, и мне кажется, что я не получаю никаких событий.

Проверьте, правильно ли установлены другие элементы управления. Если другой элемент управления ActiveX не может правильно зарегистрироваться, элемент управления агента Microsoft Agent может получить свои события.

### <a name="what-programming-languages-can-i-use-to-program-the-microsoft-agent-control"></a>Какие языки программирования можно использовать для программного управления Microsoft Agent?

Microsoft Agent должен поддерживаться на любом языке, поддерживающем интерфейс ActiveX. Он включает примеры кода для Visual Basic, VBScript, JScript, C/C++ и Java.

### <a name="can-i-access-the-parameters-returned-from-microsoft-agent-using-jscript"></a>Можно ли получить доступ к параметрам, возвращенным Microsoft Agent с помощью JScript?

Да, но в настоящее время единственным способом сделать это является использование `<SCRIPT LANGUAGE="JScript" FOR="*object*" EVENT="event()">` синтаксиса. Хотя этот синтаксис поддерживается для Microsoft Internet Explorer, другие браузеры не поддерживают его, поэтому может потребоваться избегать использования JScript для этой части скрипта страницы.

### <a name="can-microsoft-agent-be-used-with-speech-recognition-or-speech-synthesis-text-to-speech-or-tts-engines-other-than-those-supplied-by-microsoft"></a>Можно ли использовать Microsoft Agent с механизмом распознавания речи или синтезом речи (преобразования текста в речь или TTS), кроме тех, которые предоставлены корпорацией Майкрософт?

Да, при условии, что подсистема поддерживает интерфейсы Microsoft Speech API (SAPI) 4,0, необходимые для Microsoft Agent. Обратитесь к поставщику подсистемы. Полные сведения о интерфейсах SAPI, необходимых для Microsoft Agent, см. в разделе [требования поддержки обработчика речи](speech-engine-support-requirements.md).

### <a name="my-page-includes-html-object-tags-for-microsoft-agent-the-lernout--hauspie-truvoice-tts-engine-and-the-microsoft-command-and-control-speech-recognition-engine-but-not-all-the-components-install"></a>Страница содержит теги HTML-объектов для Microsoft Agent, модуль Lernout & Hauspie Трувоице TTS, а также команды Майкрософт и средство распознавания речи, но не все компоненты.

Как правило, проблему можно исправить, обновив страницу. Как правило, рекомендуется сначала указать тег управления Microsoft Agent `<OBJECT>` , а затем Lernout & Hauspie трувоице Engine, а затем команду и управлять подсистемой распознавания речи.

### <a name="after-calling-the-moveto-method-my-character-seems-to-freeze-even-though-i-have-return-animations-assigned-to-moving-state-animations"></a>После вызова метода MoveTo мой символ зависает, несмотря на то, что у меня есть анимации, назначенные для перемещения анимации состояния.

При воспроизведении анимации службы анимации продолжают отображать последний кадр до тех пор, пока не будет вызвана другая анимация. Поэтому после вызова [**MoveTo**](moveto-method.md)следует воспроизвести другую анимацию. Если вы определили анимацию **возврата** для анимации с **перемещением** состояния, сервер сначала воспроизведет его.

### <a name="when-i-query-the-characters-pitch-property-it-returns-a-value-of--1"></a>При запросе свойства "шаг" для символа возвращается значение-1.

Это происходит, если символ был скомпилирован с помощью свойства «тон» обработчика речи по умолчанию; то есть при построении символа шаг не был изменен.

### <a name="when-my-code-attempts-to-set-the-tts-mode-id-for-a-text-to-speech-engine-i-get-the-following-error-an-outgoing-call-cannot-be-made-since-the-application-is-dispatching-an-input-synchronous-call"></a>Когда мой код пытается установить идентификатор режима TTS для модуля преобразования текста в речь, возникает следующая ошибка: исходящий вызов не может быть выполнен, так как приложение отправляет входящий синхронный вызов.

Чтобы задать свойство Ттсмодеид, необходимо установить Speech.dll. Обычно это часть кода установки модуля распознавания речи. Вы также можете установить это, установив панель управления речевыми объектами, доступную на странице загрузки Microsoft Agent.

### <a name="when-i-retry-loading-a-character-that-failed-to-load-the-call-fails-with-a-character-already-loaded-error"></a>При попытке повторной загрузки символа, который не удалось загрузить, вызов завершается с ошибкой "символ уже загружен".

Элемент управления Microsoft Agent не выгружает объект символа (освобождает ссылку), если не удается загрузить соответствующий ему символьный файл. Если вы хотите повторить попытку загрузки символа, необходимо явно вызвать метод [**unload**](unload-method.md) перед вызовом [**Load**](load-method.md) во второй раз. При попытке выполнить это из скрипта веб-страницы необходимо также выполнить вызов **unload** с оператором On Error Resume Next, иначе вызов **unload** также завершится ошибкой. (Обратите внимание, что в JScript не указан оператор On Error Resume Next.)

Однако может отсутствовать необходимость в включении кода для немедленного повтора загрузки символа, когда не удается загрузить файл. Microsoft Internet Explorer и компонент сервера Microsoft Agent автоматически пытаются повторить попытку несколько раз, поэтому вероятность того, что повторная загрузка приведет к успешной нагрузке, будет удалена. Перед повторным выполнением рекомендуется подождать (установить таймер) несколько секунд.

### <a name="how-can-i-install-microsoft-agent-as-part-of-my-application-or-from-my-web-server"></a>Как можно установить Microsoft Agent как часть приложения или с моего веб-сервера?

Агент можно установить с веб-сайта Майкрософт, включив его *идентификатор CLSID в тег объекта HTML*. Однако если вы хотите включить и установить агент из собственной программы установки приложения или с собственного сервера, скачайте CAB-файл самоустановки Microsoft Agent, загрузив его со страницы загрузки. При скачивании выберите параметр Сохранить в браузере, а не запустить. При каждом запуске этот файл автоматически установит Microsoft Agent на целевой компьютер. Поэтому можно указать файл в сценарии установки.

Не пытайтесь установить Microsoft Agent, скопировав его различные. Библиотеки DLL и попытка зарегистрироваться самостоятельно. Попытка установить агент другими способами означает, что запуск автономного CAB-файла не поддерживается.

Целевая система должна также включать последние версии MSVCRT.DLL (среда выполнения VC + +), REGSVR32.EXE (средство регистрации, включенное в Microsoft VC + +) и COM. Чтобы обеспечить установку правильных версий, необходимо установить Microsoft Internet Explorer 3,02 или более поздней версии. Однако можно также лицензировать эти требования среды выполнения. (Для получения последней версии COM получите доступ к обновлению DCOM с веб-сайта Майкрософт.)

Microsoft Agent 2,0 не будет устанавливаться в Microsoft Windows 2000, так как эта версия операционной системы уже содержит агент.

### <a name="can-i-use-the-visual-basic-setup-wizard-to-install-microsoft-agent"></a>Можно ли использовать мастер установки Visual Basic для установки Microsoft Agent?

Хотя вы можете создать собственную программу установки с помощью кода Visual Basic (VB), для этого нельзя использовать мастер установки Visual Basic. Чтобы установить агент из VB, можно использовать команду оболочки, указав самоустанавливающийся CAB-файл Microsoft Agent.

### <a name="how-do-i-install-microsoft-agent-on-windows-2000"></a>Разделы справки установить Microsoft Agent в Windows 2000?

Microsoft Agent 2,0 не устанавливается в Windows 2000, так как он уже включен в состав операционной системы.

### <a name="agentsvr-crashes-when-speak-is-called-with-a-wav-file"></a>Ажентсвр аварийно завершает работу, когда говорите вызывается с помощью WAV-файла.

Это может произойти, если символ использует TTS для речевого вывода, а затем изменяется на использование WAV-файла. В первом параметре метода говорите текст не был указан.

Чтобы избежать сбоя, включите пробел в первый параметр метода говорите, даже если текстовый вывод отсутствует.

### <a name="even-though-i-have-already-installed-the-agent-language-component-dll-for-a-particular-language-i-still-got-an-error-that-the-component-is-missing-when-i-set-the-characters-language-to-that-language"></a>Несмотря на то, что для определенного языка уже установлен компонент языка агента (DLL), я по-прежнему получаю сообщение об ошибке, отсутствующее в компоненте, когда я устанавливаю язык символа.

Обычно это происходит при наличии таких приложений агента, как Microsoft Office 2000, открытыми при установке компонента языка агента. Закройте все приложения и повторите попытку. Если проблема будет повторяться, перезагрузите компьютер, и вы сможете задать идентификатор языка сейчас.

### <a name="when-i-use-the-ampersand--symbol-the-text-around-the-symbol-in-the-characters-word-balloons-is-truncated"></a>При использовании символа амперсанда "&" текст, окружающий символ в выносках со словом символа, усекается.

Это известная проблема. Это можно обойти с помощью тега map. Например, чтобы отобразить "A & B" в тексте всплывающего окна символа, используйте "A \\ Map =" и "=" && " \\ B" в операторе говорите.

### <a name="my-application-allows-users-to-change-the-default-character-and-when-they-do-the-program-crashes"></a>Мое приложение позволяет пользователям изменять символ по умолчанию, а когда это происходит, программа завершается сбоем.

Существуют две возможные причины.

Если изменить идентификатор режима TTS для символа по умолчанию, а затем разрешить пользователю изменять символ по умолчанию через Шовдефаултчарактерпропертиес, Ажентсвр приведет к сбою.

Эта проблема исправлена в операционных системах Windows 2000 и Windows XP. Чтобы избежать сбоя на других платформах, не следует разрешать пользователю изменять символ по умолчанию после изменения идентификатора режима TTS для символа по умолчанию или не использовать символ по умолчанию в приложении или веб-странице.

Если в приложении не используются символы агента, предоставляемые корпорацией Майкрософт, убедитесь, что в настраиваемом символе используется палитра с полной палитрой 256 цветов. Дополнительные сведения см. в документе разработка символов для Microsoft Agent.

### <a name="my-page-loads-the-agent-character-from-multiple-frames-with-ie-5-i-get-the-microsoft-agent-failed-to-load-error"></a>Страница загружает символ агента из нескольких кадров. При использовании обозревателя Internet Explorer 5 я получаю, что агенту Майкрософт не удалось загрузить сообщение об ошибке.

Это известная проблема с IE 5. Было изменено, как браузер обрабатывает определенное событие, что приводит к запуску скрипта HTML до начала Ажентсвр. Чтобы страница работала во всех версиях браузера, необходимо добавить следующую строку в скрипт:

Ажентконтрол. Connected = true

который явно создает подключение к Ажентсвр. Обратите внимание, что это необходимо сделать, только если страница загружает агент из нескольких кадров.

### <a name="when-my-application-tries-to-install-microsoft-agent-on-windows-2000-or-windows-xp-i-get-the-error-that-agent-is-not-compatible-with-windows-2000-or-windows-xp"></a>Когда приложение пытается установить Microsoft Agent в Windows 2000 (или Windows XP), я получаю сообщение об ошибке: агент несовместим с Windows 2000 (или Windows XP).

Предыдущая версия CAB-файла компонента агента MSAGENT.exe, при выполнении в Windows 2000 (и Windows XP), блокирует установку и отображает неверное сообщение об ошибке, которое агент несовместим с версией операционной системы, которую вы используете. Фактически компоненты ядра Microsoft Agent 2,0 входят в состав Windows 2000 (и Windows XP) и уже устанавливаются по умолчанию с помощью программы установки Windows.

В этой версии проверка удаляется, и файл установки не отображает вышеупомянутое сообщение об ошибке в Windows 2000 (или Windows XP). Обратите внимание, что это единственное изменение в файле установки, и в самих основных компонентах агента нет изменений кода. Поэтому это обновление не затрагивается, если у вас уже установлен агент 2,0 или если ваш веб-сайт использует тег объекта для активации автоматической загрузки компонентов ядра агента из хранилища объектов Майкрософт.

Если вы включили файл установки ядра агента в приложение или при публикации файла установки на сервере, может потребоваться загрузить это обновление. Для этого щелкните здесь и выберите параметр "сохранить эту программу на диск". Для этих случаев необходимо иметь действительную и текущую лицензию на распространение агента.

Кроме того, эту проблему можно обойти, используя параметр Silent при установке предыдущей версии файла установки MSAGENT.exe. Команда Shell:

**MSAGENT.exe/q: a**

То же самое относится к компонентам языка агента, первоначально выпущенным в октябре 1998. В Windows 2000 (и Windows XP) была выполнена проверка, которая не позволила бы установить арабский, французский, немецкий, иврит, итальянский, японский, корейский, упрощенный китайский, испанский и традиционный языковые компоненты. Новые версии этих файлов установки, а также дополнительные 19 языков, добавленные в марте 2000, не содержат эту проверку и будут успешно устанавливаться в Windows 2000 (и Windows XP).

### <a name="my-customized-character-exhibits-some-unexpected-behavior-with-its-transparency-color-on-windows-2000-and-windows-xp"></a>Мой настроенный символ ведет к непредвиденному поведению с цветом прозрачности в Windows 2000 (и Windows XP).

Это известная проблема для символов, созданных с помощью палитры, которая имеет размер менее 256 цветов. Проблемы с такими символами включают цвет прозрачности, отображаемый в фоновом режиме, прозрачный текст, прозрачная выноска или прозрачный фон. Обратите внимание, что такие символы могут привести к сбою приложений при загрузке в диалоговом окне средства выбора символов агента или в коллекции помощников Microsoft Office. Пользовательские символы должны использовать полную палитру с 256 цветами. В качестве отправной точки с полной цветовой палитрой 256 можно использовать образец палитры, предоставленный для символов помощника по Office.

### <a name="the-character-does-not-use-the-british-english-tts-engine-even-though-i-have-set-its-language-id-to-british-english-h0809"></a>Этот символ не использует английский модуль TTS для английского языка, несмотря на то, что для его идентификатора языка задано значение Британский английский &h0809.

Сначала убедитесь, что установлены все необходимые компоненты — основные компоненты агента, двоичные файлы среды выполнения SAPI и модуль TTS SAPI4, совместимый с английским языком, например TTS3000 English (английский язык), доступный для загрузки на странице загрузки агента. Если ваш символ по-прежнему не использует английский модуль TTS для английского языка, то, скорее всего, у вас также установлен модуль TTS для английского языка (США). Так как на английском и американском языках используется один и тот же основной язык (английский) и американский английский по умолчанию, агент выберет первый доступный модуль TTS для английского языка (США), возвращенный SAPI. Чтобы использовать модуль TTS для английского языка, используйте вместо него свойство Ттсмодеид символа. Например, Ттсмодеид для английского языка TTS3000 (английский) — {227A0E41-A92A-11d1-B17B-0020AFED142E}. В Microsoft Visual Basic можно использовать этот механизм, установив Ттсмодеид Мерлин следующим образом:

Ажентконтрол. characters ("Мерлин"). Ттсмодеид = {227A0E41-A92A-11d1-B17B-0020AFED142E}

### <a name="when-the-characters-volume-is-set-to-zero-using-the-speech-tag-vol0-it-either-has-no-effects-or-crashes-the-agentsvr"></a>Если том для этого символа имеет нулевое значение, а тег " \\ VOL" имеет метку "громкость = 0" \\ , он либо не оказывает влияния, либо не завершает работу ажентсвр.

Это известная проблема. В операционных системах Windows 95, Windows 98 и Windows Me том с символом не изменяется, но остается на установленном ранее уровне. На платформах Windows NT 4,0, Windows 2000 и Windows XP это приведет к сбою Ажентсвр, даже если не установлен модуль TTS. Так как диапазон томов символов, от 0 (тишины) до 65535 (максимальный том), имеет большой размер, и различие между последовательными уровнями не является более понятным, простое решение заключается в том, чтобы задать для тома значение 1, а не 0, если требуется, чтобы неразборчиво символа был в качестве голоса.

### <a name="my-customized-characters-return-animation-does-not-play-correctly-after-the-movedown-moveleft-moveright-andor-moveup-animations"></a>Анимация возврата настраиваемого символа не воспроизводится правильно после анимации вниз, Мовелефт, Моверигхт и (или) MoveUp.

Убедитесь, что для состояния диктовки назначена простая анимация речи. Например, можно использовать один кадр, состоящий из нейтральной позиции символа с наложением рот.

 

 




