---
title: Доступ к методам, свойствам и событиям элементов управления
description: Доступ к методам, свойствам и событиям элементов управления
ms.assetid: 70a3b011-0290-4df4-9b66-23b27bcb14e9
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 750ad6280b521cf50c2ecd1fb7f1fcec3e2c4164
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104410881"
---
# <a name="accessing-the-controls-methods-properties-and-events"></a>Доступ к методам, свойствам и событиям элементов управления

\[Microsoft Agent является устаревшим в Windows 7 и может быть недоступен в последующих версиях Windows.\]

Использование управления Microsoft Agent с Visual Basic очень похоже на использование элемента управления с помощью VBScript, за исключением того, что события в Visual Basic должны включать тип данных передаваемых параметров. Добавление элемента управления Microsoft Agent в форму автоматически включит события Microsoft Agent с соответствующими параметрами. При запуске приложения также будет автоматически создано соединение с сервером агента.

Вы также можете использовать синтаксис создания обжект'с языка программирования для создания экземпляра элемента управления во время выполнения. Например, в Visual Basic (5,0 или более поздней версии) при включении элемента управления Microsoft Agent 2,0 в ссылки проекта можно использовать [**с событиями**](https://www.bing.com/search?q=**With+Events**). [**Новое**](https://www.bing.com/search?q=**New**) объявление. Если ссылка не включена, VB выдает ошибку, указывающую на то, что не удалось запустить Microsoft Agent (код ошибки 80042502).

``` syntax
   ' Declare a global variable for the control
   Dim WithEvents MyAgent as Agent

   ' Create an instance of the control using New
   Set MyAgent = New Agent

' Load a character
   MyAgent.Characters.Load "Genie", " Genie.acs"

   ' Display the character
   MyAgent.Characters("Genie").Show
```

Для версий Visual Basic, предшествовавших 5,0, можно использовать ключевое слово [**New**](https://www.bing.com/search?q=**New**) в VB без объявления [**WithEvents**](https://www.bing.com/search?q=**WithEvents**) или функции [**CreateObject**](https://msdn.microsoft.com/library/Bb545141(v=VS.85).aspx) VB, но эти соглашения не будут предоставлять события элемента управления агента. Также необходимо использовать свойство [**Connected**](https://www.bing.com/search?q=**Connected**) , прежде чем ссылаться на любые методы или свойства агента. Если этого не сделать, VB выдаст ошибку, указывающую, что не удалось запустить агент Майкрософт (код ошибки 80042502).

Аналогичным образом для других языков программирования может потребоваться использовать свойство [**Connected**](https://www.bing.com/search?q=**Connected**) , чтобы установить соединение с сервером модели COM, прежде чем ваш код сможет вызывать методы или свойства элемента управления агента. Кроме того, для некоторых языков программирования методы и свойства агента не могут быть предоставлены напрямую, если не объявить элемент управления агента с помощью его типа. Например, в Microsoft Access 97 необходимо объявить объект как агент типа, чтобы увидеть методы и свойства, отображаемые в раскрывающемся списке "автоматическое отображение членов" при вводе.

Большинство языков программирования, поддерживающих элементы управления ActiveX, следуют соглашениям, похожим на Visual Basic. Для языков программирования, которые не поддерживают коллекции объектов, можно использовать метод [**символов**](https://www.bing.com/search?q=**Character**) и [**Командный**](https://www.bing.com/search?q=**Command**) метод для доступа к методам и свойствам элементов в коллекции.

Языки программирования, такие как Visual Basic, которые предоставляют доступ к типам объектов, предоставляемым элементом управления агента, позволяют использовать их в объявлениях объектов. Например, вместо объявления объекта как универсального типа:

``` syntax
   Dim Genie as Object
```

Можно объявить объект как конкретный тип:

``` syntax
   Dim Genie as IAgentCtlCharacterEx
```

Это может повысить общую производительность приложения.

Для некоторых типов объектов можно обнаружить два одинаковых типа, за исключением суффикса "ex". Если оба существуют, используйте тип "ex", так как это обеспечивает все функции агента. Аналоги, отличные от "ex", включены только в целях обратной совместимости.

 

 




