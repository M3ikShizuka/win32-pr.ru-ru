---
title: Метод Креатересторепоинт класса SystemRestore
description: Создает точку восстановления.
ms.assetid: 30e1ff03-816c-463f-9f80-6d84149f0e0b
keywords:
- Восстановление системы метода Креатересторепоинт
- Восстановление системы метода Креатересторепоинт, класс SystemRestore
- Восстановление системы класса SystemRestore, метод Креатересторепоинт
topic_type:
- apiref
api_name:
- SystemRestore.CreateRestorePoint
api_location:
- Root\Default
api_type:
- COM
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: e1cae9e78d1845f628d62dc46362f1bc2bd8a37e
ms.sourcegitcommit: a1494c819bc5200050696e66057f1020f5b142cb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2020
ms.locfileid: "104491037"
---
# <a name="createrestorepoint-method-of-the-systemrestore-class"></a>Метод Креатересторепоинт класса SystemRestore

Создает точку восстановления.

Этот метод является эквивалентом функции [**срсетресторепоинт**](/windows/desktop/api/SRRestorePtAPI/nf-srrestoreptapi-srsetrestorepointa) с помощью скрипта.

## <a name="syntax"></a>Синтаксис


```mof
uint32 CreateRestorePoint(
  [in] String Description,
  [in] uint32 RestorePointType,
  [in] uint32 EventType
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*Описание* \[ окне\]
</dt> <dd>

Отображаемое описание, чтобы пользователь мог легко найти точку восстановления. Максимальная длина строки ANSI — MAX \_ DESC. Максимальная длина строки Юникода — MAX \_ DESC \_ W. Дополнительные сведения см. в разделе [текст описания точки восстановления](restore-point-description-text.md).

</dd> <dt>

*Ресторепоинттипе* \[ окне\]
</dt> <dd>

Тип точки восстановления. Этот элемент может принимать одно из следующих значений.



| Тип точки восстановления                                                                                                                                                                                                                             | Значение                                                                                                                                                      |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="APPLICATION_INSTALL"></span><span id="application_install"></span><dl> <dt>**Приложение \_ УСТАНОВИТЬ**</dt> <dt>0</dt> </dl>         | Приложение установлено.<br/>                                                                                                                |
| <span id="APPLICATION_UNINSTALL"></span><span id="application_uninstall"></span><dl> <dt>**Приложение \_ Удаление**</dt> <dt>1</dt> </dl>   | Удалено приложение.<br/>                                                                                                              |
| <span id="DEVICE_DRIVER_INSTALL"></span><span id="device_driver_install"></span><dl> <dt>**Устройство \_ \_Установка драйвера**</dt> <dt>10</dt> </dl> | Установлен драйвер устройства.<br/>                                                                                                               |
| <span id="MODIFY_SETTINGS"></span><span id="modify_settings"></span><dl> <dt>**Изменение \_ Параметры**</dt> <dt>12</dt> </dl>                    | В приложении были добавлены или удалены компоненты.<br/>                                                                                                 |
| <span id="CANCELLED_OPERATION"></span><span id="cancelled_operation"></span><dl> <dt>**Отменено \_ Операция**</dt> <dt>13</dt> </dl>        | Приложению необходимо удалить созданную точку восстановления. Например, приложение будет использовать этот флаг, когда пользователь отменит установку.<br/> |



 

</dd> <dt>

*Тип события* \[ окне\]
</dt> <dd>

Тип события. Этот элемент может принимать одно из следующих значений.



| Тип события                                                                                                                                                                                                                                                      | Значение                                                                                                                                                                                         |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="BEGIN_NESTED_SYSTEM_CHANGE"></span><span id="begin_nested_system_change"></span><dl> <dt>**Начало \_ ВЛОЖЕНное \_ \_ изменение системы**</dt> <dt>102</dt> </dl> | Начато изменение системы. Последующий вложенный вызов не создает новую точку восстановления. <br/> Последующие вызовы должны использовать КОНЕЧные \_ вложенные \_ \_ изменения системы, а не конечные \_ \_ изменения системы.<br/> |
| <span id="BEGIN_SYSTEM_CHANGE"></span><span id="begin_system_change"></span><dl> <dt>**Начало \_ \_Изменение системы**</dt> <dt>100</dt> </dl>                       | Начато изменение системы. <br/> При последующем вызове должно использоваться КОНЕЧНОе \_ \_ изменение системы, а не незавершенное \_ вложенное \_ \_ изменение системы.<br/>                                                              |
| <span id="END_NESTED_SYSTEM_CHANGE"></span><span id="end_nested_system_change"></span><dl> <dt>**Конец \_ ВЛОЖЕНное \_ \_ изменение системы**</dt> <dt>103</dt> </dl>       | Изменение системы завершено.<br/>                                                                                                                                                           |
| <span id="END_SYSTEM_CHANGE"></span><span id="end_system_change"></span><dl> <dt>**Конец \_ \_Изменение системы**</dt> <dt>101</dt> </dl>                             | Изменение системы завершено.<br/>                                                                                                                                                           |



 

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Если метод выполнен успешно, возвращается значение S \_ . В противном случае метод возвращает один из кодов ошибок COM, определенных в файле WinError. h.

## <a name="remarks"></a>Комментарии

* * Windows 8: * *

Новый раздел реестра позволяет разработчикам приложений изменять частоту создания точек восстановления.

Приложения должны создать этот ключ, чтобы использовать его, так как он не будет существовать в системе. Если ключ не существует, по умолчанию будет применено следующее. Если приложение вызывает метод **креатересторепоинт** для создания точки восстановления, Windows пропускает создание этой новой точки восстановления, если в течение последних 24 часов были созданы какие-либо точки восстановления. Метод **креатересторепоинт** возвращает значение **S \_ ОК**.

Разработчики могут создавать приложения, которые создают  значение DWORD **системресторепоинткреатионфрекуенци** в разделе реестра **HKLM \\ Software \\ Microsoft \\ Windows NT \\ CurrentVersion \\ SystemRestore**. Значение этого раздела реестра может изменить частоту создания точки восстановления. Значение этого раздела реестра может изменить частоту создания точки восстановления.

Если приложение вызывает **креатересторепоинт** для создания точки восстановления, а значение раздела реестра равно 0, восстановление системы не пропускает создание новой точки восстановления.

Если приложение вызывает **креатересторепоинт** для создания точки восстановления, а значение раздела реестра — целое число N, восстановление системы пропускает создание новой точки восстановления, если какие-либо точки восстановления были созданы в течение предыдущих N минут.

## <a name="examples"></a>Примеры


```VB
'CreateRestorePoint Method of the SystemRestore Class
'Creates a restore point. Specifies the beginning and 
'the ending of a set of changes so that System Restore 
'can create a restore point.This method is the 
'scriptable equivalent of the SRSetRestorePoint function.

Set Args = wscript.Arguments
If Args.Count() > 0 Then
    RpName = Args.item(0)
Else 
    RpName = "Vbscript"
End If

Set obj = GetObject("winmgmts:{impersonationLevel=impersonate}!root/default:SystemRestore")

If (obj.CreateRestorePoint(RpName, 0, 100)) = 0 Then
    wscript.Echo "Success"
Else 
    wscript.Echo "Failed"
End If
```



## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Только для \[ классических приложений Windows XP\]<br/>                                       |
| Минимальная версия сервера<br/> | Ни одна версия не поддерживается<br/>                                                         |
| Пространство имен<br/>                | Корневой каталог \\ по умолчанию<br/>                                                          |
| MOF<br/>                      | <dl> <dt>SR. mof</dt> </dl> |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**SystemRestore**](systemrestore.md)
</dt> </dl>

 

 





