---
title: Вызов Срсетресторепоинт
description: Приложение может создать точку восстановления, прежде чем она приведет к существенному изменению системы, например к установке, удалению или обновлению компонентов.
ms.assetid: 77981e75-8c3f-4ecc-82f4-e88d68df661a
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 84ee2fc64fc74dd9ceeff4856a6a63effe0667ff2bd837d7dc8ae521172a1c7e
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119592214"
---
# <a name="calling-srsetrestorepoint"></a>Вызов Срсетресторепоинт

Приложение может создать точку восстановления, прежде чем она приведет к существенному изменению системы, например к установке, удалению или обновлению компонентов.

Установщики должны создать точку восстановления непосредственно перед установкой, вызвав функцию [**срсетресторепоинт**](/windows/desktop/api/SRRestorePtAPI/nf-srrestoreptapi-srsetrestorepointa) с элементом **двевенттипе** в наборе структуры [**ресторепоинтинфо**](/windows/win32/api/srrestoreptapi/ns-srrestoreptapi-restorepointinfoa) , чтобы начать \_ \_ изменение системы. Чтобы уведомить восстановление системы о завершении установки, вызовите **срсетресторепоинт** с параметром **ДВЕВЕНТТИПЕ** , чтобы завершить \_ \_ изменение системы.

Если пользователь отменяет установку приложения, установщик может удалить точку восстановления, созданную после начала установки. Удаление точки восстановления является необязательным и может препятствовать восстановлению после непреднамеренного изменения, внесенного установщиком во время отмены. Если установщик предназначен для удаления точки восстановления, он может вызвать функцию [**срремовересторепоинт**](/windows/desktop/api/SRRestorePtAPI/nf-srrestoreptapi-srremoverestorepoint) или вызвать [**срсетресторепоинт**](/windows/desktop/api/SRRestorePtAPI/nf-srrestoreptapi-srsetrestorepointa) с параметром **двресторепоинттипе** Set в отмененную \_ операцию, **Двевенттипе** установить в конец \_ системного \_ изменения, а **ллсекуенценумбер** задать значение, возвращенное начальным вызовом **SRSetRestorePoint**.

* * Windows 8: * *

Новый раздел реестра позволяет разработчикам приложений изменять частоту создания точек восстановления.

Приложения должны создать этот ключ, чтобы использовать его, так как он не будет существовать в системе. Если ключ не существует, по умолчанию будет применено следующее. если приложение вызывает функцию **срсетресторепоинт** для создания точки восстановления, Windows пропускает создание этой новой точки восстановления, если в течение последних 24 часов были созданы какие-либо точки восстановления. Восстановление системы задает для элемента **иисекуенценумбер** структуры [**статемгрстатус**](/windows/win32/api/srrestoreptapi/ns-srrestoreptapi-statemgrstatus) порядковый номер точки восстановления, созданной ранее в день, и задает для элемента **нстатус** значение **\_ Success Error**. Функция **срсетресторепоинт** возвращает **значение true**.

разработчики могут создавать приложения, которые создают  значение DWORD **системресторепоинткреатионфрекуенци** в разделе реестра **HKLM \\ Software \\ Microsoft \\ Windows NT \\ CurrentVersion \\ SystemRestore**. Значение этого раздела реестра может изменить частоту создания точки восстановления. Значение этого раздела реестра может изменить частоту создания точки восстановления.

Если приложение вызывает **срсетресторепоинт** для создания точки восстановления, а значение раздела реестра равно 0, восстановление системы не пропускает создание новой точки восстановления.

Если приложение вызывает **срсетресторепоинт** для создания точки восстановления, а значение раздела реестра — целое число N, восстановление системы пропускает создание новой точки восстановления, если какие-либо точки восстановления были созданы в течение предыдущих N минут.

* * Windows 8: * *

восстановление системы, выполняемое на Windows 8, наблюдает за файлами загрузочного тома, которые относятся только к восстановлению системы. моментальные снимки загрузочного тома, созданного с помощью восстановления системы, выполняемого на Windows 8, могут быть удалены, если впоследствии моментальный снимок предоставляется более ранней версией Windows. Обратите внимание, что хотя существует только один системный том, для каждой операционной системы в системе с несколькими операционными системами имеется один загрузочный том.

разработчики могут создавать приложения, которые создают  значение DWORD **скопеснапшотс** в разделе реестра **HKLM \\ Software \\ Microsoft \\ Windows NT \\ CurrentVersion \\ SystemRestore**. Если значение этого раздела реестра равно 0, то средство восстановления системы создает моментальные снимки загрузочного тома так же, как в более ранних версиях Windows. если это значение будет удалено, восстановление системы, запущенное на Windows 8, возобновляет создание моментальных снимков, отслеживающих файлы в загрузочном томе, которые относятся только к восстановлению системы.

Пример см. в разделе [Использование восстановления системы](using-system-restore.md).

 

 




