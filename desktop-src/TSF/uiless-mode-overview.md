---
title: Обзор режима Уилесс
description: Обзор режима Уилесс
ms.assetid: cc0e4936-eab1-452d-9ba1-188401918e99
keywords:
- Платформа текстовых служб (TSF), Уилессмоде
- TSF (платформа текстовых служб), Уилессмоде
- Приложения с поддержкой TSF, Уилессмоде
- уилессмоде
- Платформа текстовых служб (TSF), список кандидатов UIElement
- TSF (платформа текстовых служб), UIElement список кандидатов
- Приложения с поддержкой TSF, UIElement список кандидатов
- UIElement список кандидатов
- Платформа текстовых служб (TSF), подсказка UIElement
- TSF (платформа текстовых служб), Совет UIElement
- Приложения с поддержкой TSF, Совет UIElement
- Совет по UIElement
- Платформа текстовых служб (TSF), предопределенные элементы пользовательского интерфейса
- TSF (платформа текстовых служб), предопределенные элементы пользовательского интерфейса
- Приложения с поддержкой TSF, предопределенные элементы пользовательского интерфейса
- предопределенные элементы пользовательского интерфейса
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b7354a88fb28fd0d6bf5f4180ac23359a2117fe7
ms.sourcegitcommit: ee06501cc29132927ade9813e0888aaa4decc487
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/28/2021
ms.locfileid: "104550363"
---
# <a name="uiless-mode-overview"></a>Обзор режима Уилесс

## <a name="how-to-create-uilessmode"></a>Создание Уилессмоде

**Создание потока без интерфейса пользователя:** Приложение может сделать пользовательский интерфейс меньшим потоком с помощью [**итфсреадмгрекс:: активатикс**](/windows/desktop/api/Msctf/nf-msctf-itfthreadmgrex-activateex) с ИТФ \_ AE \_ уиелементенабледонли. Когда Среадмгр активируется с этим флагом, в потоке активируются только советы, которые могут управлять его элементом пользовательского интерфейса. Приложению необходимо реализовать интерфейс [**итфуиелементсинк**](/windows/desktop/api/Msctf/nn-msctf-itfuielementsink) и порекомендовать интерфейс в Диспетчер потоков. [**Итфуиелементсинк:: бегинуиелемент**](/windows/desktop/api/Msctf/nf-msctf-itfuielementsink-beginuielement) вызывается, когда TIP показывает свой пользовательский интерфейс. Приложение может вернуть **значение true** в параметре пбшов, чтобы разрешить TIP отображать исходный пользовательский интерфейс TIP, если приложение не хочет рисовать. Если приложение не разрешает пользовательский интерфейс TIP, оно может вернуть **значение false** в пбшов (см. схемы ниже). Приложение может рисовать пользовательский интерфейс, получая некоторые сведения из параметра *пелемент* . Это может быть список кандидатов, элемент языковой панели или пользовательский интерфейс TIP. Приложение может понять тип пользовательского интерфейса с помощью интерфейса Киинг [**итфуиелемент**](/windows/desktop/api/Msctf/nn-msctf-itfuielement) . При изменении пользовательского интерфейса вызывается [**итфуиелементсинк:: упдатеуиелемент**](/windows/desktop/api/Msctf/nf-msctf-itfuielementsink-updateuielement) . Приложение может сравнить идентификатор GUID из Пелемент->. GUID (), чтобы выяснить, отображается ли элемент приложением в данный момент.

**Создание подсказок с поддержкой пользовательского интерфейса:** Совет должен поддерживать меньший режим пользовательского интерфейса, если он хочет работать с приложением, которое не должно разрешать пользовательский интерфейс TIP, например игровое приложение или полноэкранные приложения. Для того, чтобы использовать интерфейс [**итфтекстинпутпроцессорекс**](/windows/desktop/api/Msctf/nn-msctf-itftextinputprocessorex) , подсказка требует реализации интерфейса API. Если этот интерфейс не реализован, подсказка не будет активирована в потоке в режиме без интерфейса. Кроме того, Совет должен вызвать метод [**итфуиелементмгр:: бегинуиелемент**](/windows/desktop/api/Msctf/nf-msctf-itfuielementmgr-beginuielement) , прежде чем он отобразит видимый пользовательский интерфейс для экрана. Этот метод вызывает [**итфуиелементсинк**](/windows/desktop/api/Msctf/nn-msctf-itfuielementsink) для уведомления приложения. И приложение будет решать, можно ли его отображать или нет. Когда TIP вызывает Бегинуиелемент (), Совет должен иметь интерфейс [**итфуиелемент**](/windows/desktop/api/Msctf/nn-msctf-itfuielement) для соответствующего пользовательского интерфейса. Приложение будет превышено интерфейс для получения другого интерфейса для получения дополнительных сведений для отрисовки ПОЛЬЗОВАТЕЛЬСКОГО интерфейса. Система предопределяет [**итфкандидателистуиелемент**](/windows/desktop/api/Msctf/nn-msctf-itfcandidatelistuielement) и [**итфреадингинформатионуиелемент**](/windows/desktop/api/Msctf/nn-msctf-itfreadinginformationuielement) для TIP. Когда Совет хочет отобразить список кандидатов в потоке, проходящем в режиме без интерфейса, Совет должен создать экземпляр интерфейса **итфкандидателистуиелемент** и вызвать **Итфуиелементмгр:: бегинуиелемент**. Когда вызывается [**итфтекстинпутпроцессорекс:: активатикс**](/windows/desktop/api/Msctf/nf-msctf-itftextinputprocessorex-activateex) , Совет уже знает, что поток является интерфейсом пользователя, поэтому он может исключить дополнительный пользовательский интерфейс. Однако разумеется, он может реализовать собственный интерфейс, который можно Киед из и попытаться создать уведомление. Поэтому TIP и приложения **итфуиелемент** сположение могут иметь согласование для НАСТРАИВАЕМОГО ПОЛЬЗОВАТЕЛЬСКОГО интерфейса TIP.

## <a name="uielement-supporting-tip"></a>Вспомогательная подсказка UIElement

Совет, который поддерживает UIElement, должен классифицироваться по GUID \_ тфкат \_ типкап \_ уиелементенаблед. Совет в GUID \_ тфкат \_ типкап \_ Уиелементенаблед должен использовать [**итфуиелементмгр**](/windows/desktop/api/Msctf/nn-msctf-itfuielementmgr) для отображения любого пользовательского интерфейса, чтобы приложение может управлять видимостью пользовательского интерфейса.

**Показать/скрыть состояние UIElement:** Показать/скрыть состояние, отмеченное методом [**итфуиелемент:: Показать**](/windows/desktop/api/Msctf/nf-msctf-itfuielement-show) или [**итфуиелемент::**](/windows/desktop/api/Msctf/nf-msctf-itfuielement-isshown) OnVisible, является фактическим видимым состоянием. Он не связан с доступностью UIElement. Элемент UIElement должен быть всегда доступен, если существует состояние отображения. Состояние отображения может быть управляемым из приложения. Приложение может внезапно перейти в режим Уилесс и начать рисовать некоторый пользовательский интерфейс, вызвав **итфуиелемент:: Показать** со значением **false** , чтобы скрыть весь пользовательский интерфейс TIP. Затем Совет может использовать один из вариантов. 1) TIP может переместить UIElement в состояние скрыть и начать создание Упдатеуиелемент. 2) TIP может завершить UIElement, так как элемент пользовательского интерфейса не поддерживает функцию скрыть состояние, а TIP вызывает Ендуиелемент (), чтобы завершить его.

## <a name="predefined-ui-elements"></a>Предопределенные элементы пользовательского интерфейса

**Список кандидатов:** Список кандидатов — это один из основных элементов пользовательского интерфейса для входных данных EA. Этот элемент пользовательского интерфейса предоставляет список кандидатов и соответствующее число строк кандидатов для рисования.

**Окно сведений о чтении** Окно сведения о чтении обычно используется для ввода с клавиатуры на китайском языке. Он содержит этап, который не может быть вставлен в документ в качестве строки композиции. В некоторых процессорах ввода для китайского языка открывается небольшое окно сведений для чтения, в котором показана информация для чтения, фонетического или вводимого текста.

## <a name="the-flow-chart-of-uilessmode"></a>Блоковая схема Уилессмоде

![Схема, на которой показана Лессмоденая диаграмма U I.](images/tsf-uilessmode-ovw1.gif)

После того как TIP получит **значение true** в \* пбшовн by [**итфуиелементмгр:: бегинуиелемент**](/windows/desktop/api/Msctf/nf-msctf-itfuielementmgr-beginuielement), tip не нужно вызывать упдатеуиелемент для UIElement. Но TIP необходимо вызвать Ендуиелемент (), чтобы [**итфуиелементмгр**](/windows/desktop/api/Msctf/nn-msctf-itfuielementmgr) и приложение могли отвестить состояние UIElement. TIP должен вызвать Упдатеуиелемент () после того, как Бегинуиелемент () возвращает **значение false** в \* пбшов. Приложение, которое хочет нарисовать пользовательский интерфейс, не проверяет содержимое в Бегинуиелемент (), оно просто возвращает отображение состояния в Бегинуиелемент () и начинает проверку содержимого в Упдатеуиелемент (). Например, флаг обновления элемента UIElement списка кандидатов имеет все биты в первом Упдатеуиелемент (). Это означает, что содержимое UIElement не обязательно должно быть готово в Бегинуиелемент ().

![Схема, показывающая, когда вызывается T I P, вызывается "Итуиелементмгр:: Бегинуиелемент ()" и "Бегинуиелемент приложения Уиелементсинк".](images/tsf-uilessmode-ovw2.gif)![Схема, показывающая, что приложение возвращает значение FALSE в * Пбшов.](images/tsf-uilessmode-ovw3.gif)![уилессмоде Потоковая диаграмма](images/tsf-uilessmode-ovw4.gif)

## <a name="the-candidate-list-uielement"></a>Элемент UIElement списка кандидатов

**О параметре pageIndex:** Приложение, которое рисует список кандидатов, вычислит количество строк на странице при изменении содержимого списка ( \_ параметр TF клуие \_ String установлен). Не рекомендуется изменять индекс страницы, пока список кандидатов доступен для режима Уилесс. Это означает, что список кандидатов TIP должен вести себя на разбиение на страницы, а не на прокрутку при перемещении выделения на следующую страницу. Если прокрутка происходит при выделении, то индекс страницы изменяется, и приложению необходимо повторно вычислить индекс страницы. Результат может не быть ожидаемым для TIP.

**Без выбора:** [**итфкандидателистуиелемент::-SELECT**](/windows/desktop/api/Msctf/nf-msctf-itfcandidatelistuielement-getselection) возвращает \_ значение false, если список кандидатов не имеет выбора. Недопустимое возвращаемое значение первого параметра.

 

 




