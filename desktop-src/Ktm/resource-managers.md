---
description: Диспетчеры ресурсов
ms.assetid: c717b731-cf0b-45cb-bbff-695410fcf6ce
title: Диспетчеры ресурсов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 33d32d697d58705760002065d005f5927717055f235358c12fd0629de86e14b4
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119870024"
---
# <a name="resource-managers"></a>Диспетчеры ресурсов

Диспетчер ресурсов использует журнал диспетчера транзакций для отслеживания состояния транзакции. При обработке транзакции диспетчер ресурсов выполняет следующие действия.

-   Клиент передает транзакцию в RM явным образом.
-   RM присоединяется к транзакции с помощью [**креатинлистмент**](/windows/desktop/api/KtmW32/nf-ktmw32-createenlistment).
-   Затем пользователь может перейти к выполнению любой операции.
-   Когда пользователь вызывает CommitTransaction, KTM отправляет \_ уведомление об подготовке транзакции в RM. На этом этапе диспетчер ресурсов записывает на диск все изменения, которые необходимы для фиксации транзакции, но это может привести к сбою. Если эти операции выполняются успешно, диспетчер ресурсов сообщает о завершении операции подготовки, вызывая [**препарекомплете**](/windows/desktop/api/Ktmw32/nf-ktmw32-preparecomplete). Если эти операции завершаются сбоем, RM отвечает вызовом [**роллбаккенлистмент**](/windows/desktop/api/Ktmw32/nf-ktmw32-rollbackenlistment).
-   Диспетчер ресурсов получает уведомление о подготовке.
-   Диспетчер ресурсов записывает все данные, связанные с транзакцией, в общий файл журнала служб журналов.
-   Диспетчер ресурсов вызывает функцию [**препарекомплете**](/windows/desktop/api/Ktmw32/nf-ktmw32-preparecomplete) и ожидает получения результата транзакции от KTM.
-   В зависимости от результата транзакции диспетчер ресурсов получает событие уведомления о фиксации или откате. Если диспетчер ресурсов получает уведомление о фиксации, изменения вносятся в постоянные и уведомляют KTM, вызывая функцию [**коммиткомплете**](/windows/desktop/api/Ktmw32/nf-ktmw32-commitcomplete) . Если диспетчер ресурсов получает уведомление об откате, он отменяет все изменения и возвращает состояние, существовавшее до внесения любых транзакционных изменений, и сообщает KTM, вызывая [**роллбакккомплете**](/windows/desktop/api/Ktmw32/nf-ktmw32-rollbackcomplete).

## <a name="resource-manager-functions"></a>Функции диспетчер ресурсов

Для работы с диспетчерами ресурсов используются следующие функции.



| Функция                                                                           | Описание                                                                                                                                                                      |
|------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**креатересаурцеманажер**](/windows/desktop/api/Ktmw32/nf-ktmw32-createresourcemanager)                             | Создает новый объект Resource Manager (RM) и связывает RM с диспетчером транзакций (TM).                                                                               |
| [**жетнотификатионресаурцеманажер**](/windows/desktop/api/KtmW32/nf-ktmw32-getnotificationresourcemanager)           | Запрашивает и получает уведомление для диспетчера ресурсов (RM). Эта функция используется регистром RM для получения уведомлений при изменении состояния транзакции.            |
| [**жетнотификатионресаурцеманажерасинк**](/windows/desktop/api/KtmW32/nf-ktmw32-getnotificationresourcemanagerasync) | Запрашивает и получает Асинхронное уведомление для диспетчера ресурсов (RM). Эта функция используется регистром RM для получения уведомлений при изменении состояния транзакции. |
| [**опенресаурцеманажер**](/windows/desktop/api/Ktmw32/nf-ktmw32-openresourcemanager)                                 | Открывает существующий диспетчер ресурсов (RM).                                                                                                                                         |
| [**препарекомплете**](/windows/desktop/api/Ktmw32/nf-ktmw32-preparecomplete)                                         | Указывает, что диспетчер ресурсов (RM) завершил всю обработку, необходимую для обеспечения успешного выполнения операции фиксации или прерывания для указанной транзакции.        |
| [**препрепарекомплете**](/windows/desktop/api/Ktmw32/nf-ktmw32-prepreparecomplete)                                   | Сигнализирует, что этот диспетчер ресурсов завершил предварительную работу, чтобы другие диспетчеры ресурсов могли начать их операции подготовки.                                    |
| [**сетресаурцеманажеркомплетионпорт**](/windows/desktop/api/Ktmw32/nf-ktmw32-setresourcemanagercompletionport)       | Связывает указанный порт завершения ввода-вывода с указанным диспетчером ресурсов (RM). Этот порт получает все уведомления для RM.                                          |



 

 

 



