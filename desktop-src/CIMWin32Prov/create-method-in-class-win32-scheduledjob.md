---
description: Отправляет задание в операционную систему для выполнения в указанное время и дату в будущем.
ms.assetid: 9d582fbb-24cb-401d-8b77-af7671a24e6d
ms.tgt_platform: multiple
title: Метод Create класса Win32_ScheduledJob
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- Win32_ScheduledJob.Create
api_type:
- COM
api_location:
- CIMWin32.dll
ms.openlocfilehash: 9f1acae94ea29d2d57b2952c0b0adc267ad3066c
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104342352"
---
# <a name="create-method-of-the-win32_scheduledjob-class"></a>Метод Create \_ класса Win32 ScheduledJob

Метод **создания** [класса WMI](/windows/desktop/WmiSdk/retrieving-a-class) отправляет задание в операционную систему для выполнения в указанное время и дату в будущем. Для этого метода требуется, чтобы служба расписаний была запущена на компьютере, на который отправляется задание.

В этом разделе используется синтаксис MOF-файл (MOF). Дополнительные сведения об использовании этого метода см. [в разделе вызов метода](/windows/desktop/WmiSdk/calling-a-method).

## <a name="syntax"></a>Синтаксис


```mof
uint32 Create(
  [in]           string   Command,
  [in]           datetime StartTime,
  [in, optional] boolean  RunRepeatedly,
  [in, optional] uint32   DaysOfWeek,
  [in, optional] uint32   DaysOfMonth,
  [in, optional] boolean  InteractWithDesktop,
  [out]          uint32   JobId
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*Команда* \[ окне\]
</dt> <dd>

Имя команды, пакетной программы или двоичного файла и параметры командной строки, которые служба расписания использует для вызова задания.

Пример: "Defrag/q/f".

</dd> <dt>

Время *начала* \[ окне\]
</dt> <dd>

Время в формате UTC для выполнения задания. Форма должна иметь вид "YYYYMMDDHHMMSS. ММММММ (+-) OOO ", где" ГГГГММДД "должен быть заменен на" \* \* \* \* \* \* \* \* ". Например: " \* \* \* \* \* \* \* \* 143000.000000-420" указывает 14,30 (2:30 вечера) PST, в котором действует летнее время.

Раздел "(+-) OOO" в значении свойства StartTime является текущим смещением для локального преобразования времени. Смещение — это разница между временем в формате UTC и местным временем. Чтобы вычислить смещение для часового пояса, умножьте число часов, в течение которых часовой пояс составляет вперед или выше среднего времени по Гринвичу (GMT) на 60 (Используйте положительное число в часах, если часовой пояс находится впереди GMT и отрицательное число, если часовой пояс находится за GMT). Добавьте дополнительные 60 к вычислению, если часовой пояс использует летнее время. Например, тихоокеанское стандартное часовое пояса составляет восемь часов после GMT, поэтому он равен-420 (-8 \* 60 + 60) при использовании летнего времени и-480 (-8 \* 60), если летнее время не используется. Можно также определить значение смещения, запросив свойство смещения класса [**\_ часового пояса Win32**](win32-timezone.md) .

</dd> <dt>

*Рунрепеатедли* \[ в необязательное\]
</dt> <dd>

Если задано **значение true**, запланированное задание выполняется многократно в определенные дни. По умолчанию **False**.

</dd> <dt>

*DaysOfWeek* \[ в необязательное\]
</dt> <dd>

Дни недели, в которые запланировано выполнение задания; используется только в том случае, если параметр *рунрепеатедли* имеет **значение true**. Чтобы запланировать задание более чем на один день недели, присоедините соответствующие значения в логическом или. Например, чтобы запланировать задание для вторники и пятницу, значение *DaysOfWeek* равно 2 или 16.

<dt>

<span id="Monday"></span><span id="monday"></span><span id="MONDAY"></span>

**Понедельник** (1)


</dt> <dd></dd> <dt>

<span id="Tuesday"></span><span id="tuesday"></span><span id="TUESDAY"></span>

**Вторник** (2)


</dt> <dd></dd> <dt>

<span id="Wednesday"></span><span id="wednesday"></span><span id="WEDNESDAY"></span>

**Среда** (4)


</dt> <dd></dd> <dt>

<span id="Thursday"></span><span id="thursday"></span><span id="THURSDAY"></span>

**Четверг** (8)


</dt> <dd></dd> <dt>

<span id="Friday"></span><span id="friday"></span><span id="FRIDAY"></span>

**Пятница** (16)


</dt> <dd></dd> <dt>

<span id="Saturday"></span><span id="saturday"></span><span id="SATURDAY"></span>

**Суббота** (32)


</dt> <dd></dd> <dt>

<span id="Sunday"></span><span id="sunday"></span><span id="SUNDAY"></span>

**Воскресенье** (64)


</dt> <dd></dd> </dl> </dd> <dt>

*DaysOfMonth* \[ в необязательное\]
</dt> <dd>

Дни месяца, когда запланировано выполнение задания; используется только в том случае, если параметр *рунрепеатедли* имеет **значение true**.

<dt>

<span id="1"></span>

<span id="1"></span>**1** (1)


</dt> <dd>

День 1 месяца

</dd> <dt>

<span id="2"></span>

<span id="2"></span>**2** (2)


</dt> <dd>

День 2 месяца

</dd> <dt>

<span id="3"></span>

<span id="3"></span>**3** (4)


</dt> <dd>

День 3 месяца

</dd> <dt>

<span id="4"></span>

<span id="4"></span>**4** (8)


</dt> <dd>

День 4 месяца

</dd> <dt>

<span id="5"></span>

<span id="5"></span>**5** (16)


</dt> <dd>

День 5 в месяце

</dd> <dt>

<span id="6"></span>

<span id="6"></span>**6** (32)


</dt> <dd>

День 6 месяца

</dd> <dt>

<span id="7"></span>

<span id="7"></span>**7** (64)


</dt> <dd>

День 7 месяца

</dd> <dt>

<span id="8"></span>

<span id="8"></span>**8** (128)


</dt> <dd>

День 8 месяца

</dd> <dt>

<span id="9"></span>

<span id="9"></span>**9** (256)


</dt> <dd>

9-й день месяца

</dd> <dt>

<span id="10"></span>

<span id="10"></span>**10** (512)


</dt> <dd>

День 10 месяца

</dd> <dt>

<span id="11"></span>

<span id="11"></span>**11** (1024)


</dt> <dd>

День 11 в месяце

</dd> <dt>

<span id="12"></span>

<span id="12"></span>**12** (2048)


</dt> <dd>

12-й день месяца

</dd> <dt>

<span id="13"></span>

<span id="13"></span>**13** (4096)


</dt> <dd>

13-й день месяца

</dd> <dt>

<span id="14"></span>

<span id="14"></span>**14** (8192)


</dt> <dd>

14-й день месяца

</dd> <dt>

<span id="15"></span>

<span id="15"></span>**15** (16384)


</dt> <dd>

День 15 месяца

</dd> <dt>

<span id="16"></span>

<span id="16"></span>**16** (32768)


</dt> <dd>

16-й день месяца

</dd> <dt>

<span id="17"></span>

<span id="17"></span>**17** (65536)


</dt> <dd>

День 17 месяца

</dd> <dt>

<span id="18"></span>

<span id="18"></span>**18** (131072)


</dt> <dd>

18 дней месяца

</dd> <dt>

<span id="19"></span>

<span id="19"></span>**19** (262144)


</dt> <dd>

День 19 месяца

</dd> <dt>

<span id="20"></span>

<span id="20"></span>**20** (524288)


</dt> <dd>

День 20 месяца

</dd> <dt>

<span id="21"></span>

<span id="21"></span>**21** (1048576)


</dt> <dd>

День 21 месяца

</dd> <dt>

<span id="22"></span>

<span id="22"></span>**22** (2097152)


</dt> <dd>

День 22 месяца

</dd> <dt>

<span id="23"></span>

<span id="23"></span>**23** (4194304)


</dt> <dd>

23-й день месяца

</dd> <dt>

<span id="24"></span>

<span id="24"></span>**24** (8388608)


</dt> <dd>

24-й день месяца

</dd> <dt>

<span id="25"></span>

<span id="25"></span>**25** (16777216)


</dt> <dd>

25-й день месяца

</dd> <dt>

<span id="26"></span>

<span id="26"></span>**26** (33554432)


</dt> <dd>

День 26 месяца

</dd> <dt>

<span id="27"></span>

<span id="27"></span>**27** (67108864)


</dt> <dd>

День 27 месяца

</dd> <dt>

<span id="28"></span>

<span id="28"></span>**28** (134217728)


</dt> <dd>

28-й день месяца

</dd> <dt>

<span id="29"></span>

<span id="29"></span>**29** (268435456)


</dt> <dd>

День 29 месяца

</dd> <dt>

<span id="30"></span>

<span id="30"></span>**30** (536870912)


</dt> <dd>

День 30 месяца

</dd> <dt>

<span id="31"></span>

<span id="31"></span>**31** (1073741824)


</dt> <dd>

День 31 месяца

</dd> </dl> </dd> <dt>

*Интерактвисдесктоп* \[ в необязательное\]
</dt> <dd>

Если задано **значение true**, указанное задание должно быть интерактивным, а это означает, что пользователь может предоставить входные данные для запланированного задания во время выполнения задания. По умолчанию **False**.

</dd> <dt>

Идентификатор *задания* \[ заполняет\]
</dt> <dd>

Идентификатор задания. Этот параметр является обработчиком для задания, запланированного на компьютере.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Возвращает значение 0 (нуль) при успешном выполнении и другое число для указания ошибки. Дополнительные коды ошибок см. в разделе [**константы WMI Error**](/windows/desktop/WmiSdk/wmi-error-constants) или [**вбемерроренум**](/windows/desktop/api/wbemdisp/ne-wbemdisp-wbemerrorenum). Общие значения **HRESULT** см. в разделе [коды системных ошибок](/windows/desktop/Debug/system-error-codes).

<dl> <dt>

**Успешное завершение**
</dt> <dd>

0

Запрос принят.

</dd> <dt>

**Не поддерживается**
</dt> <dd>

1

Запрос не поддерживается.

</dd> <dt>

**Доступ запрещен**
</dt> <dd>

2

У пользователя нет необходимых прав доступа.

</dd> <dt>

**Неизвестный сбой**
</dt> <dd>

8

Интерактивный процесс.

</dd> <dt>

**Путь не найден**
</dt> <dd>

9

Не удается найти путь каталога к исполняемому файлу службы.

</dd> <dt>

**недопустимый параметр.**
</dt> <dd>

21

Службе переданы недопустимые параметры.

</dd> <dt>

**Служба не запущена**
</dt> <dd>

22

Учетная запись, под которой выполняется эта служба, недопустима или не имеет разрешений на запуск службы.

</dd> <dt>

**Другое**
</dt> <dd>

23 4294967295

</dd> </dl>

## <a name="remarks"></a>Комментарии

Если запланированное задание запускает интерактивную программу, например Блокнот, то свойство **интерактвисдескто** должно иметь значение **true** или экран программы не отображается. Процесс по-прежнему отображается в **диспетчере задач** , даже если он не отображается на экране.

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows Vista<br/>                                                                |
| Минимальная версия сервера<br/> | Windows Server 2008<br/>                                                          |
| Пространство имен<br/>                | Корневой \\ CIMV2<br/>                                                                  |
| MOF<br/>                      | <dl> <dt>CIMWin32. mof</dt> </dl> |
| DLL<br/>                      | <dl> <dt>CIMWin32.dll</dt> </dl> |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[Классы операционной системы](/previous-versions//aa392727(v=vs.85))
</dt> <dt>

[**\_ScheduledJob Win32**](win32-scheduledjob.md)
</dt> </dl>

 

