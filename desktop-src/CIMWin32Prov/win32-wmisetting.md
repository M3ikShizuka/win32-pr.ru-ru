---
description: '\_Класс WMI Win32 вмисеттинг Singleton содержит рабочие параметры для службы WMI. Этот класс может иметь только один экземпляр, который всегда существует для каждой системы Windows и не может быть удален. Невозможно создать дополнительные экземпляры.'
ms.assetid: d33cd4f3-969b-46ce-baff-466f1a464906
ms.tgt_platform: multiple
title: Класс Win32_WMISetting
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- Win32_WMISetting
- Win32_WMISetting.Caption
- Win32_WMISetting.Description
- Win32_WMISetting.SettingID
- Win32_WMISetting.ASPScriptDefaultNamespace
- Win32_WMISetting.ASPScriptEnabled
- Win32_WMISetting.AutorecoverMofs
- Win32_WMISetting.AutoStartWin9X
- Win32_WMISetting.BackupInterval
- Win32_WMISetting.BackupLastTime
- Win32_WMISetting.BuildVersion
- Win32_WMISetting.DatabaseDirectory
- Win32_WMISetting.DatabaseMaxSize
- Win32_WMISetting.EnableAnonWin9xConnections
- Win32_WMISetting.EnableEvents
- Win32_WMISetting.EnableStartupHeapPreallocation
- Win32_WMISetting.HighThresholdOnClientObjects
- Win32_WMISetting.HighThresholdOnEvents
- Win32_WMISetting.InstallationDirectory
- Win32_WMISetting.LastStartupHeapPreallocation
- Win32_WMISetting.LoggingDirectory
- Win32_WMISetting.LoggingLevel
- Win32_WMISetting.LowThresholdOnClientObjects
- Win32_WMISetting.LowThresholdOnEvents
- Win32_WMISetting.MaxLogFileSize
- Win32_WMISetting.MaxWaitOnClientObjects
- Win32_WMISetting.MaxWaitOnEvents
- Win32_WMISetting.MofSelfInstallDirectory
api_type:
- DllExport
api_location:
- Wbemcore.dll
ms.openlocfilehash: 8f94524d18074e3a35c7bcad09e9b9fba80e8470
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103895450"
---
# <a name="win32_wmisetting-class"></a>\_Класс Win32 вмисеттинг

[Класс WMI](../wmisdk/retrieving-a-class.md) **Win32 \_ вмисеттинг** Singleton содержит рабочие параметры для службы WMI. Этот класс может иметь только один экземпляр, который всегда существует для каждой системы Windows и не может быть удален. Невозможно создать дополнительные экземпляры.

Приведенный ниже синтаксис является упрощенной версией кода MOF и включает все унаследованные свойства. Свойства и методы имеют алфавитный порядок, а не порядок MOF.

## <a name="syntax"></a>Синтаксис

``` syntax
[Singleton, Dynamic, Provider("WBEMCORE"), UUID("{A83EF166-CA8D-11d2-B33D-00104BCC4B4A}"), AMENDMENT]
class Win32_WMISetting : CIM_Setting
{
  string   Caption;
  string   Description;
  string   SettingID;
  string   ASPScriptDefaultNamespace = "\\\\root\\cimv2";
  boolean  ASPScriptEnabled;
  string   AutorecoverMofs[];
  uint32   AutoStartWin9X;
  uint32   BackupInterval;
  datetime BackupLastTime;
  string   BuildVersion;
  string   DatabaseDirectory;
  uint32   DatabaseMaxSize;
  boolean  EnableAnonWin9xConnections;
  boolean  EnableEvents;
  boolean  EnableStartupHeapPreallocation;
  uint32   HighThresholdOnClientObjects;
  uint32   HighThresholdOnEvents;
  string   InstallationDirectory;
  uint32   LastStartupHeapPreallocation;
  string   LoggingDirectory;
  uint32   LoggingLevel;
  uint32   LowThresholdOnClientObjects;
  uint32   LowThresholdOnEvents;
  uint32   MaxLogFileSize;
  uint32   MaxWaitOnClientObjects;
  uint32   MaxWaitOnEvents;
  string   MofSelfInstallDirectory;
};
```

## <a name="members"></a>Члены

Класс **Win32 \_ вмисеттинг** имеет следующие типы членов:

-   [Свойства](#properties)

### <a name="properties"></a>Свойства

Класс **Win32 \_ вмисеттинг** имеет следующие свойства.

<dl> <dt>

**аспскриптдефаултнамеспаце**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: чтение и запись
</dt> <dt>

Квалификаторы: [**маппингстрингс**](../wmisdk/standard-qualifiers.md) ("Win32Registry \| Software \\ \\ Microsoft \\ \\ WBEM \\ \\ scripting \| по умолчанию Namespace")
</dt> </dl>

Пространство имен скрипта по умолчанию. Это свойство содержит пространство имен, используемое вызовами из API скриптов для WMI, если в вызывающей стороне не указано ни одного объекта.

Это свойство отражает значение в разделе реестра.

**HKey \_ \_** \\  \\  \\  \\ **\| Пространство имен по умолчанию сценариев** Microsoft WBEM по локальному компьютеру    

Пример: root \\ CIMV2

Пример сценария, в котором используется это свойство, см. в разделе "Примечания".

</dd> <dt>

**аспскриптенаблед**
</dt> <dd> <dl> <dt>

Тип данных: **логический**
</dt> <dt>

Тип доступа: чтение и запись
</dt> <dt>

Квалификаторы: [**маппингстрингс**](../wmisdk/standard-qualifiers.md) ("Win32Registry \| Software \\ \\ Microsoft \\ \\ WBEM \\ \\ scripting \| включения for ASP")
</dt> </dl>

Если **значение — true**, скрипты WMI можно использовать на Active Server страницах (ASP). Это свойство допустимо только в системах с неподдерживаемыми версиями Windows. Для поддерживаемых систем Windows сценарии WMI всегда разрешены в ASP.

</dd> <dt>

**ауторековермофс**
</dt> <dd> <dl> <dt>

Тип данных: массив **строк**
</dt> <dt>

Тип доступа: только для чтения
</dt> <dt>

Квалификаторы: [**маппингстрингс**](../wmisdk/standard-qualifiers.md) ("Win32Registry \| Software \\ \\ Microsoft \\ \\ WBEM \\ \\ CIMOM \| Автовосстановление MOF")
</dt> </dl>

Список полных имен MOF-файлов, используемых для инициализации или восстановления репозитория WMI. Этот список определяет порядок, в котором компилируются MOF-файлы.

Это свойство отражает значение в разделе реестра.

**HKey \_ Локальное \_** \\ **программное обеспечение** \\ **Microsoft** \\ **WBEM** \\ **CIMOM \| Автовосстановление MOF**    

</dd> <dt>

**AutoStartWin9X**
</dt> <dd> <dl> <dt>

Тип данных: **UInt32**
</dt> <dt>

Тип доступа: чтение и запись
</dt> <dt>

Квалификаторы: [**маппингстрингс**](../wmisdk/standard-qualifiers.md) ("Win32Registry \| Software \\ \\ Microsoft \\ \\ WBEM \\ \\ CIMOM \| AutostartWin9X")
</dt> </dl>

Не поддерживается.

<dt>

<span id="Don_t_start"></span><span id="don_t_start"></span><span id="DON_T_START"></span>

**Не запускать** (0)


</dt> <dd></dd> <dt>

<span id="Autostart"></span><span id="autostart"></span><span id="AUTOSTART"></span>

**Автозапуск** (1)


</dt> <dd></dd> <dt>

<span id="Start_on_reboot"></span><span id="start_on_reboot"></span><span id="START_ON_REBOOT"></span>

**Запуск при перезагрузке** (2)


</dt> <dd></dd> </dl>

</dd> <dt>

**Тот**
</dt> <dd> <dl> <dt>

Тип данных: **UInt32**
</dt> <dt>

Тип доступа: чтение и запись
</dt> <dt>

Квалификаторы: [**маппингстрингс**](../wmisdk/standard-qualifiers.md) ("Win32Registry \| Software \\ \\ Microsoft \\ \\ WBEM, \\ \\ \| пороговое значение интервала резервного копирования"), [**единицы**](../wmisdk/standard-qualifiers.md) ("минуты")
</dt> </dl>

Не поддерживается. Вместо этого создайте резервную копию репозитория WMI вручную.

</dd> <dt>

**баккупласттиме**
</dt> <dd> <dl> <dt>

Тип данных: **DateTime**
</dt> <dt>

Тип доступа: чтение и запись
</dt> <dt>

Квалификаторы: [**маппингстрингс**](../wmisdk/standard-qualifiers.md) (" \| функции времени Win32API \| жеттимезонеинформатион")
</dt> </dl>

Дата и время последнего выполнения резервного копирования.

</dd> <dt>

**BuildVersion**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: только для чтения
</dt> <dt>

Квалификаторы: [**маппингстрингс**](../wmisdk/standard-qualifiers.md) ("Win32Registry \| Software \\ \\ Microsoft \\ \\ WBEM \| Build")
</dt> </dl>

Сведения о версии текущей установленной службы WMI.

Интервал времени между резервными копиями базы данных WMI.

Это свойство отражает значение в разделе реестра.

**HKey \_ По для локального \_ компьютера** \\  \\  \\ **\| Сборка Microsoft WBEM**

</dd> <dt>

**Заголовок**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: только для чтения
</dt> <dt>

Квалификаторы: [**maxlen**](../wmisdk/standard-qualifiers.md) (64)
</dt> </dl>

Краткое текстовое описание текущего объекта.

Это свойство наследуется [**от \_ параметра CIM**](cim-setting.md).

</dd> <dt>

**датабаседиректори**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: только для чтения
</dt> <dt>

Квалификаторы: [**маппингстрингс**](../wmisdk/standard-qualifiers.md) ("Win32Registry \| Software \\ \\ Microsoft \\ \\ WBEM \\ \\ CIMOM \| каталог репозитория")
</dt> </dl>

Путь к каталогу, который содержит репозиторий WMI.

</dd> <dt>

**датабасемакссизе**
</dt> <dd> <dl> <dt>

Тип данных: **UInt32**
</dt> <dt>

Тип доступа: только для чтения
</dt> <dt>

Квалификаторы: [**маппингстрингс**](../wmisdk/standard-qualifiers.md) ("Win32Registry \| Software \\ \\ Microsoft \\ \\ WBEM \\ \\ CIMOM \| Max DB size"), [**Units**](../wmisdk/standard-qualifiers.md) ("килобайты")
</dt> </dl>

Максимальный размер репозитория WMI.

</dd> <dt>

**Описание**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Текстовое описание текущего объекта.

Это свойство наследуется [**от \_ параметра CIM**](cim-setting.md).

</dd> <dt>

**EnableAnonWin9xConnections**
</dt> <dd> <dl> <dt>

Тип данных: **логический**
</dt> <dt>

Тип доступа: чтение и запись
</dt> <dt>

Квалификаторы: [**маппингстрингс**](../wmisdk/standard-qualifiers.md) ("Win32Registry \| Software \\ \\ Microsoft \\ \\ WBEM \\ \\ CIMOM \| енаблеанонконнектионс")
</dt> </dl>

Не поддерживается.

</dd> <dt>

**EnableEvents**
</dt> <dd> <dl> <dt>

Тип данных: **логический**
</dt> <dt>

Тип доступа: чтение и запись
</dt> <dt>

Квалификаторы: [**маппингстрингс**](../wmisdk/standard-qualifiers.md) ("Win32Registry \| Software \\ \\ Microsoft \\ \\ WBEM \\ \\ CIMOM \| EnableEvents")
</dt> </dl>

Если **значение — true**, подсистема событий WMI должна быть включена.

Это свойство отражает значение в разделе реестра.

**HKey \_ \_** \\ **Программное обеспечение** локального компьютера \\ **Microsoft** \\ **WBEM \| CIMOM \| EnableEvents**

</dd> <dt>

**енаблестартуфеаппреаллокатион**
</dt> <dd> <dl> <dt>

Тип данных: **логический**
</dt> <dt>

Тип доступа: чтение и запись
</dt> <dt>

Квалификаторы: [**маппингстрингс**](../wmisdk/standard-qualifiers.md) ("Win32Registry \| Software \\ \\ Microsoft \\ \\ WBEM \\ \\ CIMOM \| енаблестартуфеаппреаллокатион")
</dt> </dl>

Если **значение — true**, Инструментарий WMI создает предварительно распределенную кучу с размером значения **ЛАСТСТАРТУФЕАППРЕАЛЛОКАТИОН** при инициализации WMI.

</dd> <dt>

**хигхсрешолдонклиентобжектс**
</dt> <dd> <dl> <dt>

Тип данных: **UInt32**
</dt> <dt>

Тип доступа: чтение и запись
</dt> <dt>

Квалификаторы: [**маппингстрингс**](../wmisdk/standard-qualifiers.md) ("Win32Registry \| Software \\ \\ Microsoft \\ \\ WBEM, \\ \\ \| Высокая пороговое значение для клиентских объектов"), [**единиц**](../wmisdk/standard-qualifiers.md) ("объектов в секунду")
</dt> </dl>

Максимальная скорость, с которой объекты, созданные поставщиком, могут доставляться клиентам. Для поддержки разностных резервных копий между поставщиками и клиентами Инструментарий WMI хранит объекты в очередях перед их доставкой потребителям. Для повышения эффективности потребители должны собираются объекты в темпе, соответствующем поставщику. Если память, удерживаемая несобранными объектами, достигает **ловсрешолдонобжектс**, WMI замедляет добавление новых объектов в очередь. Если несобранные события продолжают накапливаться, а максимальное время ожидания доставки событий в **максваитонклиентобжектс** достигается в то время, когда используемая память находится в значении **хигхсрешолдонклиентобжектс**, Инструментарий WMI не принимает больше объектов от поставщиков и не возвращает клиенту **WBEM \_ \_ о нехватке \_ \_ памяти** для клиентов.

</dd> <dt>

**хигхсрешолдоневентс**
</dt> <dd> <dl> <dt>

Тип данных: **UInt32**
</dt> <dt>

Тип доступа: чтение и запись
</dt> <dt>

Квалификаторы: [**маппингстрингс**](../wmisdk/standard-qualifiers.md) ("Win32Registry \| Software \\ \\ Microsoft \\ \\ WBEM \\ \\ CIMOM \| Высокая пороговое значение для событий"), [**единиц**](../wmisdk/standard-qualifiers.md) ("событий в секунду")
</dt> </dl>

Максимальная скорость доставки событий клиентам. Для поддержки разностных резервных копий между поставщиками и клиентами события очередей WMI перед доставкой их клиентам. Для повышения эффективности потребители должны собираются события в темпе, соответствующем поставщику. Если память, удерживаемая несобранными событиями, достигает **ловсрешолдонобжектс**, WMI замедляет добавление новых событий в очередь. Если несобранные события продолжают накапливаться, а максимальное ожидание доставки событий в **максваитоневентс** достигается в то время, когда используемая память находится на значении в **хигхсрешолдоневентс**, WMI не принимает больше событий от поставщиков и не возвращает **WBEM по \_ \_ нехватке \_ \_ памяти** клиентам.

> [!Note]  
> Регулирование выполняется только для постоянных потребителей событий, поэтому временные потребители не должны ждать регулирования при резервном копировании событий в очереди внутренних событий WMI.

 

Это свойство отражает значение в разделе реестра.

**HKey \_ Локальное \_** \\ **программное обеспечение** \\ **Microsoft** \\ **WBEM**, \\ **\| Высокая пороговое значение для клиентских объектов (B)**    

</dd> <dt>

**InstallationDirectory**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: только для чтения
</dt> <dt>

Квалификаторы: [**маппингстрингс**](../wmisdk/standard-qualifiers.md) ("Win32Registry \| Software \\ \\ Microsoft \\ \\ WBEM \| Installation Directory")
</dt> </dl>

Путь к каталогу, в который было установлено программное обеспечение WMI. Расположение по умолчанию — \\ system32 \\ WBEM.

Это свойство отражает значение в разделе реестра.

**HKey \_ \_** \\  \\  \\ **\| Каталог установки Microsoft WBEM** по локальному компьютеру

</dd> <dt>

**ластстартуфеаппреаллокатион**
</dt> <dd> <dl> <dt>

Тип данных: **UInt32**
</dt> <dt>

Тип доступа: только для чтения
</dt> <dt>

Квалификаторы: [**маппингстрингс**](../wmisdk/standard-qualifiers.md) ("Win32Registry \| Software \\ \\ Microsoft \\ \\ WBEM \\ \\ CIMOM \| ластстартуфеаппреаллокатион"), [**Units**](../wmisdk/standard-qualifiers.md) ("bytes")
</dt> </dl>

Размер предварительно выделенной кучи, созданной WMI во время инициализации.

Это свойство отражает значение в разделе реестра.

**HKey \_ \_** \\ **Программное обеспечение** локального компьютера \\ **Microsoft** \\ **WBEM \| CIMOM \| ластстартуфеаппреаллокатион**

</dd> <dt>

**логгингдиректори**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: чтение и запись
</dt> <dt>

Квалификаторы: [**маппингстрингс**](../wmisdk/standard-qualifiers.md) ("Win32Registry \| Software \\ \\ Microsoft \\ \\ WBEM \\ \\ CIMOM \| Logging Directory")
</dt> </dl>

Путь к каталогу, который содержит расположение файлов системного журнала WMI.

Это свойство отражает значение в разделе реестра.

**HKey \_ Каталог программы локального \_ компьютера** для \\  \\  \\ **\| \| ведения журнала Microsoft WBEM CIMOM**

</dd> <dt>

**LoggingLevel**
</dt> <dd> <dl> <dt>

Тип данных: **UInt32**
</dt> <dt>

Тип доступа: чтение и запись
</dt> <dt>

Квалификаторы: [**маппингстрингс**](../wmisdk/standard-qualifiers.md) ("Win32Registry \| Software \\ \\ Microsoft \\ \\ WBEM \\ \\ CIMOM \| Logging")
</dt> </dl>

Включение ведения журнала событий и уровня детализации используемого журнала.

Это свойство отражает значение в разделе реестра.

**HKey \_ \_** \\  \\  \\ **\| \| Ведение журнала Microsoft WBEM CIMOM** по локальному компьютеру

<dt>

<span id="Off"></span><span id="off"></span><span id="OFF"></span>

**Выкл** . (0)


</dt> <dd></dd> <dt>

<span id="Error_logging"></span><span id="error_logging"></span><span id="ERROR_LOGGING"></span>

**Ведение журнала ошибок** (1)


</dt> <dd></dd> <dt>

<span id="Verbose_Error_logging"></span><span id="verbose_error_logging"></span><span id="VERBOSE_ERROR_LOGGING"></span>

**Подробное ведение журнала ошибок** (2)


</dt> <dd></dd> </dl>

</dd> <dt>

**ловсрешолдонклиентобжектс**
</dt> <dd> <dl> <dt>

Тип данных: **UInt32**
</dt> <dt>

Тип доступа: чтение и запись
</dt> <dt>

Квалификаторы: [**маппингстрингс**](../wmisdk/standard-qualifiers.md) ("Win32Registry \| Software \\ \\ Microsoft \\ \\ WBEM, \\ \\ \| низкое пороговое значение для клиентских объектов"), [**единиц**](../wmisdk/standard-qualifiers.md) ("объектов в секунду")
</dt> </dl>

Скорость, с которой WMI начинает замедлять создание новых объектов, создаваемых для клиентов. Для поддержки разностных резервных копий между поставщиками и клиентами Инструментарий WMI хранит объекты в очередях перед их доставкой потребителям. Для повышения эффективности потребители должны собираются объекты в темпе, соответствующем поставщику. Если скорость запросов для объектов достигает **ловсрешолдонклиентобжектс**, WMI постепенно замедляет создание новых объектов в соответствии с частотой использования клиента. Это замедление начинается, когда скорость создания объектов превышает значение этого свойства. См. **хигхсрешолдонклиентобжектс**.

Это свойство отражает значение реестра.

**Ключ \_ Локальное \_** \\ **программное обеспечение** \\ **Microsoft** \\ **WBEM**, \\ **\| Высокая пороговое значение для клиентских объектов (B)**    

</dd> <dt>

**ловсрешолдоневентс**
</dt> <dd> <dl> <dt>

Тип данных: **UInt32**
</dt> <dt>

Тип доступа: чтение и запись
</dt> <dt>

Квалификаторы: [**маппингстрингс**](../wmisdk/standard-qualifiers.md) ("Win32Registry \| Software \\ \\ Microsoft \\ \\ WBEM \\ \\ CIMOM \| низкая пороговое значение для событий"), [**единиц**](../wmisdk/standard-qualifiers.md) ("событий в секунду")
</dt> </dl>

Скорость, с которой WMI начинает замедлять доставку новых событий. Для поддержки разностных резервных копий между поставщиками и клиентами события очередей WMI перед доставкой их клиентам. Для повышения эффективности потребители должны собираются объекты в темпе, соответствующем поставщику. Если очередь выходит за пределы контроля, регулирование WMI — замедляет работу, а доставка событий постепенно соответствует частоте клиента. Это замедление начинается, когда частота создания событий превышает значение этого свойства. См. **хигхсрешолдоневентс**.

> [!Note]  
> Регулирование выполняется только для постоянных потребителей событий, поэтому временные потребители не должны ждать регулирования при резервном копировании событий в очереди внутренних событий WMI.

 

Это свойство отражает значение реестра.

**HKey \_ Локальное \_** \\ **программное обеспечение** \\ **Microsoft** \\ **WBEM**, \\ **\| Высокая пороговое значение для клиентских объектов {B}**    

</dd> <dt>

**макслогфилесизе**
</dt> <dd> <dl> <dt>

Тип данных: **UInt32**
</dt> <dt>

Тип доступа: чтение и запись
</dt> <dt>

Квалификаторы: [**маппингстрингс**](../wmisdk/standard-qualifiers.md) ("Win32Registry \| Software \\ \\ Microsoft \\ \\ WBEM \\ \\ CIMOM \| файл журнала максимальный размер"), [**единиц**](../wmisdk/standard-qualifiers.md) ("байт")
</dt> </dl>

Максимальный размер файлов журналов, создаваемых службой WMI.

Это свойство отражает значение в разделе реестра.

**HKey \_ \_** \\ **Программное обеспечение** локального компьютера. \\  \\ **\| файл журнала Microsoft WBEM CIMOM \| максимальный размер**

</dd> <dt>

**максваитонклиентобжектс**
</dt> <dd> <dl> <dt>

Тип данных: **UInt32**
</dt> <dt>

Тип доступа: чтение и запись
</dt> <dt>

Квалификаторы: [**маппингстрингс**](../wmisdk/standard-qualifiers.md) ("Win32Registry \| Software \\ \\ Microsoft \\ \\ WBEM, \\ \\ \| Max Wait On Events"), [**Units**](../wmisdk/standard-qualifiers.md) ("миллисекунды")
</dt> </dl>

Время, в течение которого созданный объект ожидает использования клиентом до его удаления, и возвращается значение ошибки. Это свойство взаимодействует с свойствами **ловсрешолдонклиентобжектс** и **хигхсрешолдонклиентобжектс** для регулирования — замедляется — доставка объектов потребителям, когда потребитель получает объекты слишком медленно.

</dd> <dt>

**максваитоневентс**
</dt> <dd> <dl> <dt>

Тип данных: **UInt32**
</dt> <dt>

Тип доступа: чтение и запись
</dt> <dt>

Квалификаторы: [**маппингстрингс**](../wmisdk/standard-qualifiers.md) ("Win32Registry \| Software \\ \\ Microsoft \\ \\ WBEM, \\ \\ \| Max Wait On Events"), [**Units**](../wmisdk/standard-qualifiers.md) ("миллисекунды")
</dt> </dl>

Время, в течение которого событие, отправленное клиенту, помещается в очередь перед отброшенным. Это свойство interacts0 с **ловсрешолдоневентс** и **хигхсрешолдоневентс** для регулирования — замедляется — доставка объектов потребителям, когда потребитель получает объекты слишком медленно.

Это свойство отражает значение реестра.

**HKey \_ \_** \\ **Программное обеспечение** локального компьютера \\ **Microsoft** \\ **WBEM**, \\ **\| Максимальное время ожидания событий (МС)**    

</dd> <dt>

**мофселфинсталлдиректори**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: только для чтения
</dt> <dt>

Квалификаторы: [**маппингстрингс**](../wmisdk/standard-qualifiers.md) ("Win32Registry \| Software \\ \\ Microsoft \\ \\ WBEM \| MOF Self-Install Directory")
</dt> </dl>

Путь к каталогу для приложений, которые устанавливают MOF-файлы в репозиторий WMI. Инструментарий WMI автоматически компилирует все MOF-файлы, размещенные в этом каталоге, и, в зависимости от его успешности, перемещает MOF в подкаталог, помеченный как хороший или плохой. Если \# включена команда [pragma автосохранения](../wmisdk/pragma-autorecover.md) , полное имя файла добавляется в список **ауторековермофс** , используемый при инициализации или восстановлении репозитория WMI. Этот список определяет порядок, в котором компилируются MOF.

Это свойство отражает значение в разделе реестра.

**HKey \_ По локального \_ компьютера** \\ **программное обеспечение** \\ **Microsoft** \\ **WBEM \| \| MOF Self = каталог установки**

</dd> <dt>

**SettingID**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: только для чтения
</dt> <dt>

Квалификаторы: [**maxlen**](../wmisdk/standard-qualifiers.md) (256)
</dt> </dl>

Идентификатор, по которому известен текущий объект.

Это свойство наследуется [**от \_ параметра CIM**](cim-setting.md).

</dd> </dl>

## <a name="remarks"></a>Комментарии

Класс **Win32 \_ вмисеттинг** является производным от [**\_ параметра CIM**](cim-setting.md). На компьютере может существовать только один экземпляр этого класса.

Знание того, как инструментарий WMI настроен на компьютере, может быть очень полезен при отладке скриптов или при устранении неполадок в самой службе WMI. Например, многие сценарии WMI написаны с учетом предположения, что корневой \\ CIMV2 является пространством имен по умолчанию на целевом компьютере. В результате авторы сценариев, которым требуется доступ к классу в "root \\ CIMv2", часто не могут включить пространство имен в моникер объекта GetObject, как показано в следующем примере кода:

`Set colServices = GetObject("winmgmts:").ExecQuery ("SELECT * FROM Win32_Service")`

Если корневой \\ CIMV2 не является пространством имен по умолчанию на конечном компьютере, этот сценарий завершится ошибкой. Чтобы избежать этого, корневой CIMV2 пространства имен \\ необходимо добавить в моникер, как показано в следующем примере кода:

`Set colServices = GetObject("winmgmts:root\cimv2").ExecQuery("SELECT * FROM Win32_Service")`

Если пространство имен по умолчанию на целевом компьютере отличается от пространства имен, предполагаемого сценарием, сценарий завершится ошибкой. Поверх этого пользователю будет присвоено неверное сообщение об ошибке "недопустимый класс". В действительности, сбой не происходит из-за того, что класс является недопустимым, но не найден в пространстве имен по умолчанию. Это сложная проблема для устранения неполадок, так как вы, скорее всего, сможете исследовать возможные проблемы с классом, а не проблемы с пространством имен, которое было указано (или, в данном случае, не было).

Для определения того, как инструментарий WMI настроен на компьютере, можно использовать класс **Win32 \_ вмисеттинг** . Сведения о конфигурации, такие как пространство имен по умолчанию или номер построения WMI, могут быть полезны при устранении неполадок в сценариях. Эти параметры также предоставляют важную административную информацию, например, как или даже на том, что ошибки WMI регистрируются на компьютере и какие поставщики WMI будут автоматически перезагружены, если необходимо перестроить репозиторий WMI.

## <a name="examples"></a>Примеры

Пример кода VBScript для [изменения параметров WMI](https://Gallery.TechNet.Microsoft.Com/aa80d174-3592-4fed-9c50-11f34e541445) в коллекции TechNet использует класс **Win32 \_ вмисеттинг** для настройки интервала резервного копирования WMI и уровня ведения журнала.

В [списке в примере кода VBScript пространства имен по умолчанию](https://Gallery.TechNet.Microsoft.Com/3fc69acd-ead0-4dd1-9ea1-e15a7331cfa0) в коллекции TechNet используется класс **Win32 \_ вмисеттинг** для извлечения и вывода текущего параметра WMI "пространство имен по умолчанию для сценариев".

Пример кода VBScript [по пространству имен WMI по умолчанию](https://Gallery.TechNet.Microsoft.Com/6dbb20e6-036d-43a2-ad6d-58325ada6a19) в коллекции TechNet использует свойство **аспскриптдефаултнамеспаце** , чтобы установить для параметра Namespace инструментария WMI "пространство имен по умолчанию для скриптов" значение "root \\ CIMV2".

В [списке всех параметров WMI в](https://Gallery.TechNet.Microsoft.Com/29c04301-e9b2-46d1-8714-2dbb51014c92) примере кода VBSCript используется ряд свойств в **Win32 \_ вмисеттинг** для возврата списка параметров WMI, настроенных на компьютере.

В примере кода JavaScript [сведения о параметрах WMI](https://Gallery.TechNet.Microsoft.Com/0427cfde-4cd9-4a3d-9140-3bb622a1df5d) используется ряд свойств в **Win32 \_ вмисеттинг** для возврата списка параметров WMI, настроенных на компьютере.

В примере кода Python [сведения о параметрах WMI](https://Gallery.TechNet.Microsoft.Com/370e7fbe-ea3c-4290-8a56-1e38519f518d) используется ряд свойств в **Win32 \_ вмисеттинг** для возврата списка параметров WMI, настроенных на компьютере.

В примере кода РЕКСКС объекта [Information WMI List](https://Gallery.TechNet.Microsoft.Com/9309e4c5-2ca6-4662-9451-f1342d5171d2) используется ряд свойств в **Win32 \_ вмисеттинг** для возврата списка параметров WMI, настроенных на компьютере.

В следующем примере кода VBScript показано, как получить версию инструментария WMI, работающего на локальном компьютере. "Win32 \_ вмисеттинг = @" обозначает единственный экземпляр класса. Дополнительные сведения см. в разделе версии WMI.


```VB
set objWMIService = GetObject("winmgmts:{impersonationLevel=Impersonate}!/Root/CIMv2")

set objWMISetting = objWMIService.Get("Win32_WMISetting=@")

WScript.Echo  objWMISetting.BuildVersion
```



## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows Vista<br/>                                                                |
| Минимальная версия сервера<br/> | Windows Server 2008<br/>                                                          |
| Пространство имен<br/>                | Корневой \\ CIMV2<br/>                                                                  |
| MOF<br/>                      | <dl> <dt>CIMWin32. mof</dt> </dl> |
| DLL<br/>                      | <dl> <dt>Wbemcore.dll</dt> </dl> |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**\_Параметр CIM**](cim-setting.md)
</dt> <dt>

[Классы управления службами WMI](./wmi-service-management-classes.md)
</dt> </dl>

 

 
