---
description: '&Win32 \_ поверманажементевент \# 32; Класс WMI представляет события управления питанием, возникающие при изменении состояния электропитания.'
ms.assetid: b5781805-87c7-4eaf-afbb-a1770fcff41c
ms.tgt_platform: multiple
title: Класс Win32_PowerManagementEvent
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- Win32_PowerManagementEvent
- Win32_PowerManagementEvent.SECURITY_DESCRIPTOR
- Win32_PowerManagementEvent.TIME_CREATED
- Win32_PowerManagementEvent.EventType
- Win32_PowerManagementEvent.OEMEventCode
api_type:
- DllExport
api_location:
- CIMWin32.dll
ms.openlocfilehash: 536963be51d665b03af77bb81c7592b44d2a6eb5ddc449bfa82896dd7f7da9b0
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "120064424"
---
# <a name="win32_powermanagementevent-class"></a>\_Класс Win32 поверманажементевент

Класс **WMI \_ поверманажементевент** [инструментария](../wmisdk/retrieving-a-class.md) Win32 представляет события управления питанием, полученные при изменении состояния электропитания. Эти изменения состояния связаны с протоколами управления системой расширенного управления питанием (APM) или интерфейсом ACPI.

Следующий пример синтаксиса — упрощенный MOF-код, который включает все наследуемые свойства. Свойства перечислены в алфавитном порядке, а не в MOF.

## <a name="syntax"></a>Синтаксис

``` syntax
[UUID("{86460B6B-E709-11d2-B139-00105A1F77A1}"), AMENDMENT]
class Win32_PowerManagementEvent : __ExtrinsicEvent
{
  uint8  SECURITY_DESCRIPTOR[];
  uint64 TIME_CREATED;
  uint16 EventType;
  uint16 OEMEventCode;
};
```

## <a name="members"></a>Члены

Класс **Win32 \_ поверманажементевент** имеет следующие типы членов:

-   [Свойства](#properties)

### <a name="properties"></a>Элемент Property

Класс **Win32 \_ поверманажементевент** имеет следующие свойства.

<dl> <dt>

**EventType**
</dt> <dd> <dl> <dt>

Тип данных: **UInt16**
</dt> <dt>

Тип доступа: только для чтения
</dt> <dt>

Квалификаторы: [**маппингстрингс**](../wmisdk/standard-qualifiers.md) (" \| события управления питанием Win32API")
</dt> </dl>

Тип изменения состояния энергопотребления системы.

<dt>

<span id="Entering_Suspend"></span><span id="entering_suspend"></span><span id="ENTERING_SUSPEND"></span>

<span id="Entering_Suspend"></span><span id="entering_suspend"></span><span id="ENTERING_SUSPEND"></span>**Вход в приостановку** (4)


</dt> <dd>

В приостановленном состоянии компьютер находится в выключенном состоянии; Однако это может быть "пробуждено" в ответ на различные события, включая ввод пользователя (например, перемещение мыши или нажатие клавиши на клавиатуре). В то время как компьютер приостановлен, энергопотребление уменьшается до одного из нескольких уровней в зависимости от того, как будет использоваться система. Чем меньше уровень энергопотребления, тем больше времени требуется системе для возврата в рабочее состояние. Когда компьютер переходит в состояние приостановки, Рабочий стол блокируется и необходимо нажать клавиши CTRL + ALT + DELETE и указать допустимое имя пользователя и пароль для возобновления операций.

</dd> <dt>

<span id="Resume_from_Suspend"></span><span id="resume_from_suspend"></span><span id="RESUME_FROM_SUSPEND"></span>

<span id="Resume_from_Suspend"></span><span id="resume_from_suspend"></span><span id="RESUME_FROM_SUSPEND"></span>**Возобновление с приостановки** (7)


</dt> <dd>

Указывает, что было отправлено сообщение о выходе из спящего режима, что позволяет компьютеру вернуться к обычному энергопотреблению.

</dd> <dt>

<span id="Power_Status_Change"></span><span id="power_status_change"></span><span id="POWER_STATUS_CHANGE"></span>

<span id="Power_Status_Change"></span><span id="power_status_change"></span><span id="POWER_STATUS_CHANGE"></span>**Изменение состояния питания** (10)


</dt> <dd>

Указывает изменение состояния питания компьютера, например переключение от батареи питания в AC или от AC к источнику бесперебойного питания. Это событие возникает также, если уровень заряда батареи становится ниже заданного пользователем порога или изменяется на заданную величину в процентах.

</dd> <dt>

<span id="OEM_Event"></span><span id="oem_event"></span><span id="OEM_EVENT"></span>

<span id="OEM_Event"></span><span id="oem_event"></span><span id="OEM_EVENT"></span>**Событие OEM** (11)


</dt> <dd>

Указывает, что система управления расширенным управлением питанием (APM) отправила OEM-событие. Значение события будет захвачено в свойстве **оемевенткоде** . Поскольку некоторые реализации APM BIOS не предоставляют уведомления о событии OEM, это событие может никогда не транслироваться на некоторые компьютеры. APM — это устаревшая схема управления питанием. Несмотря на то что поддержка APM в основном была заменена ACPI (Расширенная конфигурация и интерфейс питания).

</dd> <dt>

<span id="Resume_Automatic"></span><span id="resume_automatic"></span><span id="RESUME_AUTOMATIC"></span>

<span id="Resume_Automatic"></span><span id="resume_automatic"></span><span id="RESUME_AUTOMATIC"></span>**Автоматическое возобновление** (18)


</dt> <dd>

Указывает, что компьютер был пробужден в ответ на событие. Если система обнаруживает активность пользователей (например, щелчок мышью), сообщение Ресумесуспенд будет транслироваться, позволяя приложениям узнавать о том, что они могут возобновить интерактивное взаимодействие с пользователем.

</dd> </dl>

</dd> <dt>

**оемевенткоде**
</dt> <dd> <dl> <dt>

Тип данных: **UInt16**
</dt> <dt>

Тип доступа: только для чтения
</dt> <dt>

Квалификаторы: [**маппингстрингс**](../wmisdk/standard-qualifiers.md) (" \| события управления питанием Win32API")
</dt> </dl>

Состояние питания системы, определенное изготовителем оборудования (OEM), если свойство **EventType** этого класса имеет значение 11 (событие OEM); в противном случае этому свойству присваивается **значение NULL**. События OEM генерируются, когда BIOS APM сообщает о событии APM OEM. Коды событий OEM находятся в диапазоне 0x0200h-0x02FFh.

</dd> <dt>

**\_дескриптор безопасности**
</dt> <dd> <dl> <dt>

Тип данных: массив **Uint8**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Дескриптор, используемый поставщиком событий для определения того, какие пользователи могут получить событие. Это свойство наследуется от [**\_ \_ события**](../wmisdk/--event.md). Дополнительные сведения о константах, используемых для задания этого дескриптора безопасности, см. в разделе [константы безопасности WMI](../wmisdk/wmi-security-constants.md).

</dd> <dt>

**ВРЕМЯ \_ создания**
</dt> <dd> <dl> <dt>

Тип данных: **UInt64**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Уникальное значение, указывающее время создания события. Это 64-разрядное значение, представляющее число 100-наносекундных интервалов после 1 января 1601 г. Эти сведения находятся в формате всеобщего скоординированного времени (UTC).

Это свойство наследуется от [**\_ \_ события**](../wmisdk/--event.md).

Дополнительные сведения об использовании значений **UInt64** в скриптах см. [в разделе Создание сценариев в WMI](../wmisdk/creating-a-wmi-script.md).

</dd> </dl>

## <a name="remarks"></a>Remarks

Класс **Win32 \_ поверманажементевент** является производным от [**\_ \_ екстринсицевент**](../wmisdk/--extrinsicevent.md).

Изменения в состоянии электропитания часто указывают на наличие проблемы с компьютером или с другим управляемым устройством. Если сервер неожиданно переключается от питания от сети к источнику бесперебойного питания, это изменение может указывать на то, что произошла электрическая проблема определенного рода, с компьютером или с электрической системой в комнате, в которой хранится компьютер.

Администраторам необходимо отслеживать эти изменения в состоянии электропитания и немедленно получать уведомления об этих изменениях. Это позволит им выполнять действия до того, как устройство полностью теряет питание. (Например, системы источников бесперебойного питания могут работать только через 15 минут или до завершения работы.)

Класс **Win32 \_ поверманажементевент** можно использовать для отслеживания изменений состояния питания на компьютере. Эти изменения могут включать в себя переключение с одного источника питания на другой, а также на изменение состояния электропитания компьютера (например, ввод или выход из режима приостановки).

Класс **Win32 \_ поверманажементевент** имеет только два свойства: EventType, используемый для указания типа произошедшего события изменения питания, и оемевенттипе, который используется некоторыми производителями оборудования для определения дополнительных событий изменения питания.

дополнительные сведения о том, как реагировать на Windowsные события, см. в статье [мониторинг и реагирование на Windows power events with PowerShell](https://blogs.technet.com/b/heyscriptingguy/archive/2011/08/16/monitor-and-respond-to-windows-power-events-with-powershell.aspx) в разделе эй! Сценарист! .

## <a name="examples"></a>Примеры

Следующий сценарий VBScript отслеживает изменения состояния питания на компьютере.


```VB
Set colMonitoredEvents = GetObject("winmgmts:")._
 ExecNotificationQuery("SELECT * FROM Win32_PowerManagementEvent")
Do
 Set strLatestEvent = colMonitoredEvents.NextEvent
 Wscript.Echo strLatestEvent.EventType
Loop
```



## <a name="requirements"></a>Requirements (Требования)



| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows Vista<br/>                                                                |
| Минимальная версия сервера<br/> | Windows Server 2008<br/>                                                          |
| Пространство имен<br/>                | Корневой \\ CIMV2<br/>                                                                  |
| MOF<br/>                      | <dl> <dt>CIMWin32. mof</dt> </dl> |
| DLL<br/>                      | <dl> <dt>CIMWin32.dll</dt> </dl> |



## <a name="see-also"></a>См. также

<dl> <dt>

[**\_\_екстринсицевент**](../wmisdk/--extrinsicevent.md)
</dt> <dt>

[Аппаратные классы системы компьютера](computer-system-hardware-classes.md)
</dt> <dt>

[Наблюдение за изменениями в состоянии электропитания компьютера](/previous-versions/tn-archive/ee176537(v=technet.10))
</dt> </dl>

 

 
