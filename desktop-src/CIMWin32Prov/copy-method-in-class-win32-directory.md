---
description: Копирует файл или каталог записи логического каталога, указанный в пути к объекту, в расположение, указанное параметром input.
ms.assetid: 038e23d7-71db-4db6-8fb1-e84e972510c9
ms.tgt_platform: multiple
title: Метод Copy класса Win32_Directory
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- Win32_Directory.Copy
api_type:
- COM
api_location:
- CIMWin32.dll
ms.openlocfilehash: 85a16d3e63ef46ad2c536103a4e462a3e830e17f56f83cdcf39bbad5a33ebb23
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118419759"
---
# <a name="copy-method-of-the-win32_directory-class"></a>Метод Copy \_ класса каталога Win32

Метод **копирования** [класса WMI](/windows/desktop/WmiSdk/retrieving-a-class) копирует логический файл или каталог записи каталога, указанный в пути к объекту, в расположение, указанное параметром input. Копирование не поддерживается, если требуется перезапись существующего логического файла.

В этом разделе используется синтаксис MOF-файл (MOF). Дополнительные сведения об использовании этого метода см. [в разделе вызов метода](/windows/desktop/WmiSdk/calling-a-method).

## <a name="syntax"></a>Синтаксис


```mof
uint32 Copy(
   string FileName
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*FileName* 
</dt> <dd>

Полное имя копии файла (или каталога). Пример: c: \\ temp \\ невдиректори

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Возвращает значение 0 (нуль), если файл был успешно скопирован, и любое другое число для указания ошибки.

<dl> <dt>

**0**
</dt> <dd>

Запрос выполнен успешно.

</dd> <dt>

**2**
</dt> <dd>

Отказано в доступе.

</dd> <dt>

**8**
</dt> <dd>

Произошла неопределенная ошибка.

</dd> <dt>

**9**
</dt> <dd>

Указано недопустимое имя.

</dd> <dt>

**10**
</dt> <dd>

Указанный объект уже существует.

</dd> <dt>

**11**
</dt> <dd>

Файловая система не является системой NTFS.

</dd> <dt>

**12**
</dt> <dd>

Платформа не Windows.

</dd> <dt>

**13**
</dt> <dd>

Диск не совпадает.

</dd> <dt>

**14**
</dt> <dd>

Каталог не пуст.

</dd> <dt>

**15**
</dt> <dd>

Нарушение общего доступа.

</dd> <dt>

**16**
</dt> <dd>

Указан недопустимый файл запуска.

</dd> <dt>

**17**
</dt> <dd>

Привилегия, необходимая для операции, не удерживается.

</dd> <dt>

**открыт**
</dt> <dd>

Указан недопустимый параметр.

</dd> </dl>

## <a name="remarks"></a>Remarks

Папки часто необходимо копировать из одного расположения в другое. Например, вы можете скопировать папку с одного сервера на другой, чтобы создать резервную копию этой папки. Также можно иметь папку Templates, которую необходимо скопировать на рабочие станции пользователей, или папку Scripts, которая должна быть скопирована на все DNS-серверы.

\_Метод копирования каталогов Win32 позволяет копировать папку из одного расположения в другое либо на том же компьютере (например, при копировании папки с диска C на диск D), либо на удаленный компьютер. Чтобы скопировать папку, необходимо вернуть экземпляр копируемой папки, а затем вызвать метод Copy, передав в качестве параметра целевое расположение новой копии папки. Например, эта строка кода копирует папку в папку Scripts на диске F:

`objFolder.Copy("F:\Scripts")`

Инструментарий WMI не перезаписывает существующую папку при выполнении метода Copy. Это означает, что операция копирования завершится ошибкой, если папка назначения существует. Например, предположим, что у вас есть папка с именем Scripts и вы пытаетесь скопировать эту папку в удаленную общую папку с именем \\ \\ Archive-FS-01 \\ . Если папка с именем Scripts уже существует в этой общей папке, операция копирования завершится ошибкой.

## <a name="examples"></a>Примеры

Пример кода следующий, взятый из [копии папки с помощью инструментария WMI](https://Gallery.TechNet.Microsoft.Com/71b8f517-0240-42a2-be5c-e5a3921604d2), использует метод Copy для копирования папки C: \\ Scripts в D: \\ Archive.


```VB
strComputer = "." 
Set objWMIService = GetObject("winmgmts:" _ 
    & "{impersonationLevel=impersonate}!\\" & strComputer & "\root\cimv2") 
 
Set colFolders = objWMIService.ExecQuery( _ 
    "Select * from Win32_Directory where Name = 'c:\\Scripts'") 
 
For Each objFolder in colFolders 
    errResults  = objFolder.Copy("D:\Archive") 
Next
```



## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows Vista<br/>                                                                |
| Минимальная версия сервера<br/> | Windows Server 2008<br/>                                                          |
| Пространство имен<br/>                | Корневой \\ CIMV2<br/>                                                                  |
| MOF<br/>                      | <dl> <dt>CIMWin32. mof</dt> </dl> |
| DLL<br/>                      | <dl> <dt>CIMWin32.dll</dt> </dl> |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[Классы операционной системы](/previous-versions//aa392727(v=vs.85))
</dt> <dt>

[**\_Каталог Win32**](win32-directory.md)
</dt> </dl>

 

