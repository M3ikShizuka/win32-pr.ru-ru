---
title: ptr - атрибут
description: Атрибут \ PTR \ обозначает указатель в качестве полного указателя.
ms.assetid: a1233a25-b651-4a01-8abf-a64dc9ee168e
keywords:
- атрибут PTR MIDL
topic_type:
- apiref
api_name:
- ptr
api_type:
- NA
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: b2d8b2ee2e3ea4daccd1c4fa37ff1c1f1899dd3c
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "104337028"
---
# <a name="ptr-attribute"></a>ptr - атрибут

Атрибут **\[ ptr \]** обозначает указатель в качестве полного указателя.

``` syntax
pointer_default(ptr)

typedef [ ptr [ , type-attribute-list ] ] type-specifier declarator-list; 

typedef [ struct | union ]
{
    [ ptr [ , field-attribute-list ] ] type-specifier declarator-list;
    ...
}

[ ptr [ , function-attribute-list ] ] type-specifier ptr-decl function-name(
    [ [ parameter-attribute-list ] ] type-specifier [standard-declarator]
    , ...);

[[ [ function-attribute-list ] ]] type-specifier [[ptr-decl]] function-name(
    [ ptr [[ , parameter-attribute-list ]] ] type-specifier [[standard-declarator]]
    , ...);
```

## <a name="parameters"></a>Параметры

<dl> <dt>

*Type-Attribute-List* 
</dt> <dd>

Указывает один или несколько атрибутов, применяемых к типу. К допустимым атрибутам типа относятся **\[** [**Handle**](handle.md), **\]** **\[** [**Switch \_ Type**](switch-type.md) **\]** , **\[** [**передает \_ as**](transmit-as.md) **\]** ; атрибут указателя **\[** [**ref**](ref.md) **\]** , **\[** [**UNIQUE**](unique.md)или **\[ \] ptr**;, а также **\[** [**\_ маркер контекста**](context-handle.md)атрибутов использования **\]** , **\[** [**String**](string.md) **\]** и **\[** [**Ignore**](ignore.md) **\]** . Несколько атрибутов разделяются запятыми.

</dd> <dt>

*Описатель типа* 
</dt> <dd>

Задает [базовый тип](midl-base-types.md), [**структуру**](struct.md), [**объединение**](union.md)или тип [**перечисления**](enum.md) или идентификатор типа. Дополнительная спецификация хранилища может предшествовать *спецификатору типа*.

</dd> <dt>

*стандартные-деклараторы* 
</dt> <dd>

Задает стандартный декларатор C, например идентификатор, декларатор указателя или декларатор массива. Дополнительные сведения см. в разделе [атрибуты Array и Sized-Pointer](array-and-sized-pointer-attributes.md), [**массивы**](arrays-1.md), [массивы и указатели](/windows/desktop/Rpc/arrays-and-pointers).

</dd> <dt>

*декларатор-список* 
</dt> <dd>

Задает стандартные деклараторы C, такие как идентификаторы, деклараторы указателей и деклараторы массивов. Дополнительные сведения см. в разделе [атрибуты Array и Sized-Pointer](array-and-sized-pointer-attributes.md), [**массивы**](arrays-1.md), [массивы и указатели](/windows/desktop/Rpc/arrays-and-pointers). *Список деклараторов* состоит из одного или нескольких деклараторов, разделенных запятыми. Идентификатор параметра-Name в деклараторе функции является необязательным.

</dd> <dt>

*Список атрибутов Field* 
</dt> <dd>

Указывает ноль или более атрибутов полей, применимых к структуре, элементу объединения или параметру функции. К допустимым атрибутам полей относятся: **\[** [**First \_**](first-is.md)—, **\]** **\[** [**Last \_ —**](last-is.md), **\]** **\[** [**length \_ —**](length-is.md) **\]** , **\[** [**Max \_ —**](max-is.md) **\]** , **\[** [**size \_ —**](size-is.md), **\]** строка атрибутов использования **\[** [](string.md) **\]** , **\[** [**Ignore**](ignore.md) **\]** и **\[** [**контекст контекста \_**](context-handle.md) **\]** ; атрибут указателя **\[** [**ref**](ref.md) **\]** , **\[** [**UNIQUE**](unique.md) **\]** , **\[ ptr \]**, и **\[** [**\_ Тип переключателя**](switch-type.md)атрибута Union **\]** . Несколько атрибутов полей разделяются запятыми.

</dd> <dt>

*Function-Attribute-List* 
</dt> <dd>

Указывает ноль или более атрибутов, которые применяются к функции. Допустимые атрибуты функции — **\[** [**обратный вызов**](callback.md) **\]** , **\[** [**локальный**](local.md) **\]** объект, атрибут указателя **\[** [**ref**](ref.md) **\]** , **\[** [**UNIQUE**](unique.md) **\]** или **\[ ptr \]**; и атрибуты использования **\[** [**строка**](string.md) **\]** , **\[** [**Ignore**](ignore.md) **\]** и **\[** [**Контекстный \_ маркер**](context-handle.md) **\]** .

</dd> <dt>

*PTR-decl* 
</dt> <dd>

Указывает по крайней мере один декларатор указателя, к которому применяется атрибут **\[ ptr \]** . Декларатор указателя аналогичен декларатору указателя, используемому в C; Он создается из \* указателя, модификаторов, таких как **FAR**, и квалификатора [**const**](const.md).

</dd> <dt>

*имя функции* 
</dt> <dd>

Задает имя удаленной процедуры.

</dd> <dt>

*Parameter-список атрибутов* 
</dt> <dd>

Состоит из нуля или более атрибутов, подходящих для указанного типа параметра. [**Атрибуты параметров могут принимать и**](in.md) отменять атрибуты направления [**.**](out-idl.md) Сначала атрибуты поля [**\_ —**](first-is.md), [**Last \_ —**](last-is.md), [**length \_ —**](length-is.md), [**Max \_ —**](max-is.md), [**size \_ —**](size-is.md)и [**\_ Тип переключателя**](switch-type.md); атрибут указателя [**ref**](ref.md), [**UNIQUE**](unique.md)или **\[ ptr \]**, а также [**\_ маркер контекста**](context-handle.md) атрибутов использования и [**строка**](string.md). Атрибут использования [**Ignore**](ignore.md) не может использоваться в качестве атрибута параметра. Несколько атрибутов разделяются запятыми.

</dd> </dl>

## <a name="remarks"></a>Комментарии

Полный указатель, указанный атрибутом **\[ ptr \]** , приближается к полной функциональности указателя языка C. Полный указатель может иметь значение **null** и может изменяться во время вызова от **null** к значению, отличному от **null**. Хранилище, на которое указывают полные указатели, может быть достигнуто другими именами в приложении, поддерживающим псевдонимы и циклы. Эта функциональность требует дополнительных издержек при удаленном вызове процедуры для определения данных, на которые ссылается указатель, определения того, является ли значение **нулевым**, и обнаруживать, указывают ли два указателя на одни и те же данные.

Использовать полные указатели для:

-   Удаленные возвращаемые значения.
-   Двойные указатели, если размер выходного параметра не известен.
-   Указатели **null** .

Полные (и уникальные) указатели не могут использоваться для описания размера массива или объединения, так как эти указатели могут иметь значение **null**. Это ограничение с помощью MIDL предотвращает ошибку, которая может возникать, если в качестве размера используется значение **null** .

Предполагается, что ссылки и уникальные указатели не являются псевдонимами данных. Направленный граф, полученный с помощью уникального или ссылочного указателя, и следующие только уникальные указатели или ссылочные классы не содержат ни пересхождение, ни циклов.

Чтобы избежать присвоения псевдонимов, все значения указателей должны быть получены из указателя ввода того же класса указателя. Если несколько указателей указывают на одно и то же расположение в памяти, все эти указатели должны быть полными указателями.

В некоторых случаях полные и уникальные указатели могут быть смешанными. Полному указателю может быть присвоено значение уникального указателя, если оно не нарушает ограничения на изменение значения уникального указателя. Однако при присвоении уникального указателя значению полного указателя может быть вызвано Присвоение псевдонимов.

Смешивание полных и уникальных указателей может привести к присвоению псевдонимов, как показано в следующем примере:

``` syntax
typedef struct 
{ 
    [ptr] short * pdata;          // full pointer  
} GRAPH_NODE_TYPE; 
 
typedef struct 
{ 
    [unique] graph_node * left;   // unique pointer  
    [unique] graph_node * right;  // unique pointer 
} TREE_NODE_TYPE; 
 
// application code: 
short a = 5; 
TREE_NODE_TYPE * t; 
GRAPH_NODE_TYPE g, h; 
 
g.pdata = h.pdata = &a; 
t->left = &g; 
t->right = &h; 
// t->left->pdata == t->right->pdata == &a
```

Хотя "t->Left" и "t->right" указывают на уникальные расположения в памяти, "t->Left->pData" и "t->right->pData" имеют псевдонимы. По этой причине алгоритмы поддержки псевдонимов должны следовать всем указателям (включая уникальные и ссылочные указатели), которые в конечном итоге могут обращаться к полному указателю.

## <a name="examples"></a>Примеры

``` syntax
pointer_default(ptr) 
 
typedef [ptr, string] unsigned char * MY_STRING_TYPE; 
 
[ptr] char * MyFunction([in, out, unique] long * plNumber);
```

## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**массивы**](arrays-1.md)
</dt> <dt>

[Массивы и указатели](/windows/desktop/Rpc/arrays-and-pointers)
</dt> <dt>

[Атрибуты массива и Sized-Pointer](array-and-sized-pointer-attributes.md)
</dt> <dt>

[Базовые типы MIDL](midl-base-types.md)
</dt> <dt>

[**обратный вызов**](callback.md)
</dt> <dt>

[**const**](const.md)
</dt> <dt>

[**Контекстный \_ маркер**](context-handle.md)
</dt> <dt>

[**перечисления**](enum.md)
</dt> <dt>

[**первый \_ —**](first-is.md)
</dt> <dt>

[**справиться**](handle.md)
</dt> <dt>

[Файл определения интерфейса (IDL)](interface-definition-idl-file.md)
</dt> <dt>

[**обращать**](ignore.md)
</dt> <dt>

[**Последний \_ —**](last-is.md)
</dt> <dt>

[**Длина \_ равна**](length-is.md)
</dt> <dt>

[**Языковые**](local.md)
</dt> <dt>

[**Максимальное \_ число**](max-is.md)
</dt> <dt>

[**Указатель \_ по умолчанию**](pointer-default.md)
</dt> <dt>

[**ref**](ref.md)
</dt> <dt>

[**размер \_ равен**](size-is.md)
</dt> <dt>

[**Строка**](string.md)
</dt> <dt>

[**struct**](struct.md)
</dt> <dt>

[**Тип коммутатора \_**](switch-type.md)
</dt> <dt>

[**передать \_ как**](transmit-as.md)
</dt> <dt>

[**наборов**](union.md)
</dt> <dt>

[**однозначно**](unique.md)
</dt> </dl>

 

 