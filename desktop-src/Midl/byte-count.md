---
title: атрибут byte_count
description: Атрибут \ Byte \_ Count \ ACF является атрибутом параметра, который связывает размер в байтах с областью памяти, обозначенной указателем.
ms.assetid: 7e146888-fe7c-461c-8615-70da1e3b12cd
keywords:
- byte_count атрибута MIDL
topic_type:
- apiref
api_name:
- byte_count
api_type:
- NA
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: ffd42e27be4768fc0817aa76bb366429e236b3a82c45d081a05485b8520a23a1
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "117807829"
---
# <a name="byte_count-attribute"></a>\_атрибут числа байтов

Атрибут ACF **\[ \_ Count \] -Byte** — это атрибут параметра, связывающий размер в байтах с областью памяти, обозначенной указателем.

``` syntax
[ function-attribute-list ] function-name(
    [byte_count(length-variable-name)] parameter-name);
    ...);
```

## <a name="parameters"></a>Параметры

<dl> <dt>

*Function-Attribute-List* 
</dt> <dd>

Указывает ноль или более атрибутов функции ACF.

</dd> <dt>

*имя функции* 
</dt> <dd>

Указывает имя функции, определенной в IDL-файле. Необходимо указать имя функции.

</dd> <dt>

*Length-переменная-имя* 
</dt> <dd>

Задает имя [**\[ \]**](in.md)одноименного параметра, указывающего размер (в байтах) области памяти, на которую ссылается *параметр parameter-name*.

</dd> <dt>

*имя параметра* 
</dt> <dd>

Задает имя параметра указателя, [**\[ который \] является единственным, определенным в IDL-файле**](out-idl.md).

</dd> </dl>

## <a name="remarks"></a>Remarks

**\[ \_ Счетчик \] байтов** атрибута ACF представляет расширение Майкрософт для устройства DCE IDL. Поэтому этот атрибут недоступен при использовании параметра компилятора MIDL [**/ОСФ**](-osf.md).

> [!Note]  
> Атрибут **\[ количества \] байтов** больше не поддерживается в синтаксисе NDR64 из-за трудностей при оценке размера, необходимого для всех параметров [**\[ out \]**](out-idl.md) .

 

Память, на которую ссылается параметр указателя, является непрерывной и не выделяется или освобождается заглушками клиента. Эта функция атрибута **\[ \_ счетчика \] байтов** позволяет создать в памяти клиента область постоянного буфера, которую можно повторно использовать в нескольких вызовах удаленной процедуры.

Возможность отключения выделения памяти заглушки клиента позволяет настроить приложение для повышения эффективности. Например, атрибут **\[ \_ количества \] байтов** может использоваться функциями поставщиков служб, которые используют Microsoft RPC. Когда пользовательское приложение вызывает API поставщика услуг и отправляет указатель на буфер, поставщик услуг может передать указатель буфера на удаленную функцию. Поставщик услуг может повторно использовать буфер во время нескольких удаленных вызовов, не вынуждая пользователя перераспределять область памяти.

Область памяти может содержать сложные структуры данных, состоящие из нескольких указателей. Поскольку область памяти является непрерывной, приложению не нужно выполнять несколько вызовов для индивидуального освобождения каждого указателя и структуры. Вместо этого он может выделить или освободить область памяти с помощью одного вызова функции выделения памяти или бесплатной подпрограммы.

Буфер должен быть [**\[ выходным \]**](out-idl.md)параметром, а длина буфера в байтах должна быть параметром только [**\[ в \]**](in.md)режиме.

Укажите буфер, достаточно большой для размещения всех параметров [**\[ out \]**](out-idl.md) . Из-за скрытого заполнения используйте переоценки, а не точные значения счетчиков. Например, 4-байтовые указатели расмаршалируются на границе с четырьмя байтами на 32-разрядных платформах и 8-байтовых указателях на 8-байтовой границе на 64-разрядных платформах. Таким образом, выравнивание, которое будет выполняться суррогатными заглушками, должно быть учетом в пространстве для буфера. Кроме того, уровни упаковки, используемые при компиляции на языке C, могут различаться. Используйте значение счетчика байтов, которое учитывает дополнительные байты упаковки, добавленные для уровня упаковки, используемого при компиляции на языке C. Надежная практика, охватывающая как 32-разрядные, так и 64 разрядные платформы, предполагает, что каждый объект, поступающий в блок большой памяти, начинается с адреса, кратного 8.

## <a name="examples"></a>Примеры

``` syntax
/* IDL file */ 
HRESULT proc1([in] unsigned long length, 
              [out] struct my_struct * pMyStruct); 
 
/* ACF file */ 
proc1([byte_count(length)] pMyStruct);
```

## <a name="see-also"></a>См. также

<dl> <dt>

[Файл конфигурации приложения (ACF)](application-configuration-file-acf-.md)
</dt> <dt>

[**окне**](in.md)
</dt> <dt>

[**Длина \_ равна**](length-is.md)
</dt> <dt>

[**/осф**](-osf.md)
</dt> <dt>

[**заполняет**](out-idl.md)
</dt> <dt>

[**размер \_ равен**](size-is.md)
</dt> </dl>

 

 




