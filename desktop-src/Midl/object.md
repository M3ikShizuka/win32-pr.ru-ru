---
title: object - атрибут
description: Атрибут \ объект \ Interface определяет COM-интерфейс.
ms.assetid: 51e34ef3-eea7-45f4-b961-a9f742700fe5
keywords:
- атрибут объекта MIDL
topic_type:
- apiref
api_name:
- object
api_type:
- NA
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: cb2c21246282646dcf6ae488411316e07ab62b2f
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "103790902"
---
# <a name="object-attribute"></a>object - атрибут

Атрибут интерфейса **\[ объекта \]** определяет COM-интерфейс. (Список атрибутов интерфейса, не включающий атрибут **\[ Object \]** , указывает на интерфейс DCE RPC.)

``` syntax
[ 
    object, 
    uuid(string-uuid)
    [ , interface-attribute-list] 
] 
interface interface-name : base-interface
{
...    
}
```

## <a name="parameters"></a>Параметры

<dl> <dt>

*Строка UUID* 
</dt> <dd>

Строка UUID, созданная служебной программой uuidgen. Строку UUID можно заключить в кавычки.

</dd> <dt>

*Interface-список атрибутов* 
</dt> <dd>

Другие атрибуты, применяемые к интерфейсу в целом.

</dd> <dt>

*имя интерфейса* 
</dt> <dd>

Имя интерфейса.

</dd> <dt>

*базовый интерфейс* 
</dt> <dd>

COM-интерфейс, от которого наследует этот интерфейс. Базовый интерфейс должен быть [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch)или другим COM-интерфейсом, который прямо или косвенно является производным от **IUnknown** или **IDispatch**.

</dd> </dl>

## <a name="remarks"></a>Комментарии

Список атрибутов интерфейса для COM-интерфейса должен включать **\[** атрибут [**UUID**](uuid.md) **\]** , но не может включать **\[** атрибут [**Version**](version.md) **\]** .

По умолчанию компиляция COM-интерфейса с помощью компилятора MIDL создает файлы, необходимые для создания прокси-библиотеки DLL. Эта библиотека DLL содержит код для поддержки использования пользовательского COM-интерфейса как клиентскими приложениями, так и серверами объектов. Однако если в списке атрибутов интерфейса для COM-интерфейса указан **\[** [**локальный**](local.md) **\]** атрибут, компилятор MIDL создает только файл заголовка интерфейса.

Компилятор MIDL автоматически создает тип данных интерфейса для COM-интерфейса. В качестве альтернативы можно использовать [**typedef**](typedef.md) с ключевым словом [**Interface**](interface.md) , чтобы явно определить тип данных интерфейса. Затем спецификация интерфейса может использовать тип данных интерфейса в параметрах функции и возвращаемых значениях, элементах [**struct**](struct.md) и [**Union**](union.md) и других объявлениях типов. В следующем примере показано использование автоматически созданного типа данных [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream) :

``` syntax
[
    object, 
    uuid (ABCDEFOO-1234-1234-5678-ABCDEF123456)
] 
interface IStream : IUnknown
{ 
    typedef IStream * LPSTREAM; 
    // Other interface definition statements.
}
```

В интерфейсе COM все функции-члены интерфейса считаются виртуальными функциями. Виртуальная функция имеет **неявный** указатель в качестве первого параметра. Виртуальная таблица функций содержит запись для каждой функции члена интерфейса.

Функции- **\[** члены [**нелокальных**](local.md) **\]** объектов интерфейса должны иметь возвращаемое значение HRESULT или SCODE. (Обратите внимание, что более ранние версии MIDL позволяли функциям-членам возвращать [**значение void**](void.md). Однако начиная с MIDL версии 3,0, возврат **void** приводит к ошибке компилятора.) Наличие возвращаемого значения HRESULT или SCODE означает, что если во время удаленного вызова создается исключение, созданные прокси-серверы перехватывают исключение и возвращают код исключения в возвращаемое значение. Если приложение может позволить пропускать ошибки, возникающие во время удаленного вызова процедуры, можно указать HRESULT в качестве возвращаемого типа без проверки возвращаемого значения после вызова.

При перекомпиляции старого приложения изменение возвращаемых типов может привести к проблемам обратной совместимости, когда сервер отправляет недавно введенный результат клиенту. В качестве альтернативы изменению типа возвращаемого значения можно пометить функцию, возвращающую [**void**](void.md) , с помощью **\[** [**\_ вызова**](call-as.md) **\]** атрибута, делая его локальной функцией. Затем определите связанную удаленную функцию с теми же параметрами, но с типом возвращаемого значения HRESULT. При необходимости локальная функция может вызвать исключение на основе этого значения HRESULT.

Атрибут **\[ Object \]** недоступен при компиляции с помощью параметра компилятора MIDL [**/ОСФ**](-osf.md) .

## <a name="examples"></a>Примеры

``` syntax
[
    uuid(12345678-1234-1234-1234-123456789ABC), 
    object
] 
interface IMyInterface : IUnknown
{
    // Interface definition statements.
}

[
    uuid(87654321-1234-1234-1234-123456789ABC), 
    object, 
    local
] 
interface ILocalInterface : ISomeOldCOMInterface
{
    // Interface definition statements.
}
```

## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**вызвать \_ как**](call-as.md)
</dt> <dt>

[Файл определения интерфейса (IDL)](interface-definition-idl-file.md)
</dt> <dt>

[**IID \_ —**](iid-is.md)
</dt> <dt>

[**взаимодействия**](interface.md)
</dt> <dt>

[**Языковые**](local.md)
</dt> <dt>

[**/осф**](-osf.md)
</dt> <dt>

[**определение**](typedef.md)
</dt> <dt>

[**UUID**](uuid.md)
</dt> <dt>

[**Версия**](version.md)
</dt> </dl>

 

 