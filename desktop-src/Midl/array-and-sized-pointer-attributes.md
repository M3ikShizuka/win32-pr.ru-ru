---
title: Атрибуты массива и Sized-Pointer
description: MIDL предоставляет широкий набор функций для передачи массивов данных и указателей на данные. Эти атрибуты можно использовать для задания характеристик массивов и нескольких уровней указателей.
ms.assetid: 482be83f-eb09-40a0-8dd6-a0cbf5dc4485
keywords:
- IDL MIDL, атрибуты, массив и указатель размера
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b0f9ba435d5c413ea152c2bc9b492486ccc1be94
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "103890541"
---
# <a name="array-and-sized-pointer-attributes"></a>Атрибуты массива и Sized-Pointer

MIDL предоставляет широкий набор функций для передачи массивов данных и указателей на данные. Эти атрибуты можно использовать для задания характеристик массивов и нескольких уровней указателей.



| attribute                       | Использование                                                                                                                                                                                                |
|---------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**размер \_ равен**](size-is.md)     | Задает объем памяти, выделяемый для указателей по размеру, размеров указателей на размеры указателей, а также единичных или многомерных массивов.                                                         |
| [**Максимальное \_ число**](max-is.md)       | Максимальное значение для индекса массива.                                                                                                                                                                |
| [**Длина \_ равна**](length-is.md) | Число передаваемых элементов массива.                                                                                                                                                      |
| [**первый \_ —**](first-is.md)   | Индекс первого передаваемого элемента массива.                                                                                                                                              |
| [**Последний \_ —**](last-is.md)     | Возвращает индекс последнего передаваемого элемента массива.                                                                                                                                         |
| [**Строка**](string.md)        | Указывает, что одномерный массив [**char**](char-idl.md), [**WCHAR \_ t**](wchar-t.md), [**Byte**](byte.md) (или эквивалентный) или указатель на такой массив должен обрабатываться как строка. |
| [**разнообраз**](range.md)          | Задает диапазон допустимых значений для аргументов или полей, значения которых задаются во время выполнения.                                                                                                       |



 

MIDL поддерживает три вида указателей: ссылочные указатели, уникальные указатели и полные указатели. Эти указатели указываются атрибутами указателей [**ref**](ref.md), [**UNIQUE**](unique.md)и [**ptr**](ptr.md).

Атрибут указателя может быть применен как атрибут типа. в качестве атрибута поля, который применяется к члену структуры, члену объединения или параметру; или в качестве атрибута функции, который применяется к возвращаемому типу функции. Атрибут указателя также может присутствовать с ключевым словом [**указателя \_ по умолчанию**](pointer-default.md) .

Чтобы разрешить параметру указателя изменять значение во время удаленной функции, необходимо предоставить другой уровень косвенного обращения, предоставив несколько деклараторов указателя. Явный атрибут указателя, примененный к параметру, влияет только на декларатор самого правого указателя для параметра. При наличии нескольких деклараторов указателя в объявлении параметра другой декларатор по умолчанию имеет атрибут указателя, заданный атрибутом [**указателя \_ по умолчанию**](pointer-default.md) . Чтобы применить различные атрибуты указателя к нескольким деклараторам указателя, необходимо определить промежуточные типы, указывающие явные атрибуты указателя.

## <a name="default-pointer-attribute-values"></a>Значения Pointer-Attribute по умолчанию

Если атрибут указателя не связан с указателем, который является параметром, то предполагается, что указатель является указателем [**ref**](ref.md) .

Если атрибут указателя не связан с указателем, который является членом структуры или объединения, компилятор MIDL назначает атрибуты указателя с помощью следующих правил приоритета (1 — наивысший):

1.  Атрибуты, явно примененные к типу указателя
2.  Атрибуты, явно примененные к параметру или члену указателя
3.  Атрибут [**указателя \_ по умолчанию**](pointer-default.md) в IDL-файле, определяющем тип
4.  Атрибут [**указателя \_ по умолчанию**](pointer-default.md) в IDL-файле, который импортирует тип
5.  [**ptr**](ptr.md) (режим использование); [**уникальный**](unique.md) (режим Microsoft RPC по умолчанию)

Когда IDL-файл компилируется в режиме по умолчанию, импортированные файлы могут наследовать атрибуты указателя от импорта файлов. Эта функция недоступна при компиляции с параметром/[**Использование**](-osf.md) . Дополнительные сведения см. в разделе [**Import**](import.md).

## <a name="function-return-types"></a>Типы возвращаемых функцией значения

Указатель, возвращаемый функцией, должен быть [**уникальным**](unique.md) указателем или полным указателем. Компилятор MIDL сообщает об ошибке, если результат функции является указателем ссылки, явно или по умолчанию. Возвращаемый указатель всегда указывает на новое хранилище.

Функции, возвращающие значение указателя, могут указывать атрибут указателя в качестве атрибута функции. Если отсутствует атрибут указателя, то указатель на результат функции использует значение, указанное в качестве атрибута [**\_ по умолчанию указателя**](pointer-default.md) .

## <a name="pointer-attributes-in-type-definitions"></a>Атрибуты указателя в определениях типов

При указании атрибута указателя на верхнем уровне оператора [**typedef**](typedef.md) указанный атрибут применяется к декларатору указателя, как и ожидалось. Если атрибут указателя не указан, деклараторы указателей на верхнем уровне оператора typedef наследуют тип атрибута указателя при использовании.

Устройство DCE IDL не позволяет явно применять один и тот же атрибут указателя дважды, например в объявлении [**typedef**](typedef.md) и в списке атрибутов параметра. При использовании режима по умолчанию (расширений Майкрософт) компилятора MIDL это ограничение неограниченно.

Обсуждение использования массивов и указателей MIDL в удаленных вызовах процедур см. в разделе [массивы и указатели](/windows/desktop/Rpc/arrays-and-pointers).

 

 