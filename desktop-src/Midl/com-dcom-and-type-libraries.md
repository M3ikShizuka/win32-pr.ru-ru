---
title: COM, DCOM и библиотеки типов
description: Модель COM и распределенные объектные модели компонентов (DCOM) используют удаленные вызовы процедур (RPC) для обеспечения взаимодействия между объектами распределенных компонентов.
ms.assetid: 7bade397-676e-43be-82f4-b23cd768fd16
keywords:
- интерфейсы MIDL, COM
- интерфейсы MIDL, DCOM
- интерфейсы MIDL, библиотеки типов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d4f0b21aad9f88f02d8029d478eead50f5501ecc
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "103890572"
---
# <a name="com-dcom-and-type-libraries"></a>COM, DCOM и библиотеки типов

Модель COM и распределенные объектные модели компонентов (DCOM) используют удаленные вызовы процедур (RPC) для обеспечения взаимодействия между объектами распределенных компонентов. Таким образом, интерфейс COM или DCOM определяет идентификатор и внешние характеристики COM-объекта. Он формирует средства, с помощью которых клиенты могут получить доступ к методам и данным объекта. При использовании DCOM этот доступ возможен независимо от того, существуют ли объекты в одном и том же процессе, на разных процессах на одном компьютере или на разных компьютерах. Как и в случае с клиентскими и серверными интерфейсами RPC, объект COM или DCOM может предоставлять свою функциональность различными способами и через несколько интерфейсов.

## <a name="type-library"></a>Библиотека типов

Библиотека типов (. tlb) — это двоичный файл, в котором хранятся сведения о свойствах и методах объектов COM или DCOM в форме, доступной другим приложениям во время выполнения. С помощью библиотеки типов приложение или браузер могут определить, какие интерфейсы поддерживаются объектом, и вызвать методы интерфейса объекта. Это может произойти, даже если объекты и клиентские приложения были написаны на разных языках программирования. Среда выполнения COM/DCOM также может использовать библиотеку типов для обеспечения автоматического перекрестного апартамента, кросс-процесса и кросс-машинного маршалинга для интерфейсов, описанных в библиотеках типов.

## <a name="characteristics-of-an-interface"></a>Характеристики интерфейса

Вы определяете характеристики интерфейса в файле определения интерфейса (IDL) и необязательном файле конфигурации приложения (ACF):

-   IDL-файл определяет характеристики интерфейсов приложения в сети, то есть способ передачи данных между клиентом и сервером или между COM-объектами.
-   В файле ACF указываются характеристики интерфейса, такие как дескрипторы привязки, которые относятся только к локальной операционной среде. В файле ACF также можно указать способ маршалирования и передачи сложной структуры данных в независимую от компьютера форму.

Дополнительные сведения о файлах IDL и ACF см. [в разделе файлы IDL и ACF](/windows/desktop/Rpc/the-idl-and-acf-files).

Файлы IDL и ACF — это скрипты, написанные в язык MIDL (MIDL), которые являются реализацией Майкрософт и расширением языка определения интерфейса использование-DCE (IDL). Расширения Майкрософт для языка IDL позволяют создавать COM-интерфейсы и библиотеки типов. Компилятор, Midl.exe, использует эти скрипты для создания заглушек языка C и файлов заголовков, а также файлов библиотеки типов.

## <a name="the-midl-compiler"></a>Компилятор MIDL

В зависимости от содержимого IDL-файла компилятор MIDL создаст любой из следующих файлов.

Прокси-сервер языка C/файл заглушки, файл идентификатора интерфейса, файл данных DLL и связанный файл заголовка для пользовательского COM-интерфейса. Компилятор MIDL создает эти файлы при обнаружении атрибута объекта в списке атрибутов интерфейса. Более подробные сведения об этих файлах см. в разделе [файлы, созданные для COM-интерфейса](files-generated-for-a-com-interface.md).

Файл скомпилированной библиотеки типов (. tlb) и связанный файл заголовка. MIDL создает эти файлы при обнаружении в IDL-файле оператора [**библиотеки**](library.md) . Общие сведения о библиотеках типов см. в разделе [содержимое библиотеки типов](/previous-versions/windows/desktop/automat/contents-of-a-type-library)в справочнике программиста по автоматизации.

C/C++ — файлы заглушки клиента и сервера языка и связанный файл заголовка для интерфейса RPC. Эти файлы создаются при наличии в IDL-файле интерфейсов, которые не имеют атрибута [**Object**](object.md) . Общие сведения о файлах заглушек и заголовков см. в разделе [Общая процедура сборки](/windows/desktop/Rpc/general-build-procedure). Более подробные сведения см. в разделе [файлы, созданные для интерфейса RPC](files-generated-for-an-rpc-interface.md).

 

 