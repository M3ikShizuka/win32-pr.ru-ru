---
title: атрибут version
description: Атрибут интерфейса \ Version \ определяет определенную версию в нескольких версиях интерфейса RPC. С помощью атрибута Version вы гарантируете, что только совместимые версии клиентского и серверного программного обеспечения могут быть привязаны.
ms.assetid: 66ac5cf3-2230-44fd-aaf6-8013e4a4ae81
keywords:
- атрибут версии MIDL
topic_type:
- apiref
api_name:
- version
api_type:
- NA
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: bacbf7478ebfb745e5fc9b5e50959d0f1587dedf
ms.sourcegitcommit: 57758ecb246c84d65e6e0e4bd5570d9176fa39cd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/25/2019
ms.locfileid: "104069026"
---
# <a name="version-attribute"></a>атрибут version

Атрибут интерфейса **\[ версии \]** определяет определенную версию для нескольких версий интерфейса RPC. С помощью атрибута Version вы гарантируете, что только совместимые версии клиентского и серверного программного обеспечения могут быть привязаны.

``` syntax
version ( major-value[[. minor-value]] )
```

## <a name="parameters"></a>Параметры

<dl> <dt>

*основной ценности* 
</dt> <dd>

Задает короткое целое число без знака от 0 до 65 535 включительно, представляющее основной номер версии.

</dd> <dt>

*вспомогательное значение* 
</dt> <dd>

Задает короткое целое число без знака от 0 до 65 535 включительно, представляющее дополнительный номер версии. Значение дополнительного номера версии является необязательным. Если указано значение, дополнительный номер версии отделяется от основного номера версии на символ точки (.). Если значение не указано, дополнительный номер версии равен нулю.

</dd> </dl>

## <a name="remarks"></a>Комментарии

Компилятор MIDL не поддерживает несколько версий COM-интерфейса. В результате список атрибутов интерфейса, включающий **\[** атрибут [**объекта**](object.md) , **\]** не может включать атрибут **\[ \] Version** . Чтобы создать новую версию существующего COM-интерфейса, используйте наследование интерфейса. Производный COM-интерфейс имеет другой UUID, но наследует функции-члены интерфейса, коды состояния и атрибуты интерфейса базового интерфейса.

В сочетании со значением **\[** [**UUID**](uuid.md) **\]** значение **\[ версии \]** однозначно определяет интерфейс. Библиотека времени выполнения передает значения **\[ версии \]** и **\[ UUID \]** на сервер, когда клиент вызывает удаленную функцию. Клиент может выполнить привязку к серверу для данного интерфейса, если:

-   Значение **\[ UUID \]** одинаково.
-   Основной номер версии совпадает.
-   Дополнительный номер версии клиента меньше или равен дополнительному номеру версии сервера.

Это преимущество и преимущество пользователей в обеспечении совместимости с более широкими версиями Версионсâ, что позволяет изменять интерфейс таким образом, чтобы изменился только дополнительный номер версии. При добавлении новых типов данных, которые не используются существующими функциями, а также при добавлении новых функций без изменения спецификации интерфейса для существующих функций, можно обеспечить совместимость с более широкими характеристиками.

Измените основной номер версии, если применяется одно из следующих условий.

-   При изменении типа данных, используемого существующей функцией.
-   При изменении спецификации интерфейса для существующей функции (например, при добавлении или удалении параметра).
-   При добавлении обратных вызовов, вызванных существующими функциями.

Измените дополнительный номер версии, если выполняются все перечисленные ниже условия.

-   При добавлении определений типов или констант, которые не используются ни одной из существующих функций или обратных вызовов.
-   Если вы не изменяете существующие функции и добавляете в интерфейс новые функции.
-   При добавлении обратных вызовов, которые не вызываются ни одной из существующих функций, а новые обратные вызовы следуют всем существующим функциям.

Если изменения в интерфейсе соответствуют перенаправленным вверх изменениям интерфейса, используйте следующую процедуру.

**Изменение файла интерфейса (IDL)**

1.  Добавьте новые константы и определения типов в файл интерфейса.
2.  Добавьте функции обратного вызова в конец файла интерфейса.
3.  Добавьте новые функции в конец файла интерфейса.

Атрибут **\[ Version \]** может встречаться в заголовке интерфейса не более одного раза.

Если отсутствует атрибут Version, то в интерфейсе используется версия по умолчанию 0,0.

Символ точки между основным и дополнительным номерами является разделителем и не представляет десятичную запятую. Дополнительный номер обрабатывается как целое число. Начальные нули не являются значимыми. Нули в конце являются значимыми.

Например, параметр версии 1,11 представляет собой основное значение одного и незначительного значения одиннадцати. Версия 1,11 не представляет значение в диапазоне от 1,1 до 1,2.

## <a name="see-also"></a>См. также раздел

<dl> <dt>

[Файл определения интерфейса (IDL)](interface-definition-idl-file.md)
</dt> <dt>

[**взаимодействия**](interface.md)
</dt> <dt>

[**объектами**](object.md)
</dt> <dt>

[**UUID**](uuid.md)
</dt> </dl>

 

 




