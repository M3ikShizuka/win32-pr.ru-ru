---
title: size_is - атрибут
description: Используйте атрибут \ size = \_ \, чтобы указать размер памяти в элементах, выделенных для указателей размера, указателей на размеры указателей и одностраничные или многомерные массивы.
ms.assetid: 1f3f3629-f668-460d-86fd-16ef22449973
keywords:
- size_is атрибута MIDL
topic_type:
- apiref
api_name:
- size_is
api_type:
- NA
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: f65a4c3ea93ea9ed55ce4f6f9ce846c81b60fa40
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "103789859"
---
# <a name="size_is-attribute"></a>Size \_ — атрибут

Используйте атрибут \[ **size \_** , \] чтобы указать размер памяти в элементах, выделенных для указателей размера, указателей на размеры указателей и единичных или многомерных массивов.

``` syntax
[ size_is(limited-expression-list) ]
```

## <a name="parameters"></a>Параметры

<dl> <dt>

*список ограниченных выражений* 
</dt> <dd>

Указывает одно или несколько выражений языка C. Каждое выражение принимает неотрицательное целое число, представляющее объем памяти, выделенной для указателя размера или массива. В случае массива задает одно выражение, представляющее размер выделения в элементах первого измерения этого массива. Компилятор MIDL поддерживает условные выражения, логические выражения, реляционные выражения и арифметические выражения. MIDL не разрешает вызовы функций в выражениях и не поддерживает операторы инкремента и декремента. Используйте запятые в качестве заполнителей для неявных параметров или для разделения нескольких выражений.

</dd> </dl>

## <a name="remarks"></a>Комментарии

Если используется \[ атрибут **size \_** \] для выделения памяти для многомерного массива и используется \[ \] нотация массива, следует помнить, что только первое измерение многомерного массива может быть динамически определено во время выполнения. Другие измерения должны быть заданы статически. Дополнительные сведения об использовании \[ **size \_ — это** \] атрибут с несколькими уровнями указателей, позволяющий серверу возвращать клиенту динамически изменяемый массив данных, как показано в примере Proc7, см. раздел [множественные уровни указателей](/windows/desktop/Rpc/multiple-levels-of-pointers).

Можно использовать либо \[ **размер \_ ,** \] либо [**Max ( \_**](max-is.md) но не оба в одном списке атрибутов), чтобы указать размер массива, верхняя граница которого определяется во время выполнения. Однако обратите внимание, что \[ **атрибут \_ size** не \] может использоваться для фиксированных измерений массива. Атрибут \[ **Max \_ —** \] указывает максимальный допустимый индекс массива. В результате указание \[ size \_ равно (n) \] эквивалентно указанию параметра \[ Max \_ равно (n-1) \] .

\[ [**В**](in.md) \] \[ параметре "in" или " [**out**](out-idl.md) \] " параметра-массива с \[ [](string.md) \] атрибутом String не должно быть \[ **атрибута \_ size** \] или \[ [**Max \_**](max-is.md) \] . В этом случае размер выделения определяется на основе НУЛЕВого терминатора входной строки. Все остальные согласованные массивы с \[ \] атрибутом String должны иметь атрибут \[ **size \_** \] или \[ **Max \_** \] .

Несмотря на то, что допускается использование \[ **размера \_** \] атрибута с константой, это неэффективно и не требуется. Например, используйте массив фиксированного размера:

``` syntax
HRESULT Proc3([in] short Arr[MAX_SIZE]);
```

вместо

``` syntax
// legal but marshaling code is much slower
HRESULT Proc3([in size_is(MAX_SIZE)] short Arr[] );
```

Можно использовать \[ **размер \_** , \] а \[ [**длина \_ —**](length-is.md) \] атрибуты вместе. При этом \[ **размер \_ —** \] атрибут определяет объем памяти, выделенной для данных. Атрибут \[ **length \_** \] определяет количество передаваемых элементов. Объем памяти, указанный в параметре \[ **size, \_ имеет** значение \] , и \[ **длина \_** \] атрибута не должна совпадать. Например, клиент может передать \[ выходной \] параметр на сервер и указать большой объем памяти с \[ **размером \_** \] , даже если он указывает небольшое количество элементов данных, которые должны быть переданы с \[ **длиной \_** \] . Это позволяет серверу заполнить массив большим количеством данных, чем получено, который затем можно отправить обратно клиенту.

Как правило, нецелесообразно указывать оба \[ **размера \_** , \] а \[ [**длина \_ —**](length-is.md) \] \[ в \] параметрах in и \[ out \] . В обоих случаях \[ **размер \_** \] управляет выделением памяти. Приложение может использовать \[ **размер \_ —** \] выделить больше элементов массива, чем передается (как указано в параметре \[ **length \_** \] ). Однако это будет неэффективно. Также было бы неэффективно указывать идентичные значения \[ **размера \_** , \] а \[ **длина \_ —** \] . При маршалировании параметров будет создаваться дополнительная нагрузка. Если значения \[ **size \_** \] и \[ **length \_ не** \] совпадают, то параметр \[ **length \_ имеет** значение \] Attribute.

## <a name="examples"></a>Примеры

``` syntax
HRESULT Proc1(
    [in] short m;
    [in, size_is(m)] short a[]);  // If m = 10, a[10]
HRESULT Proc2(
    [in] short m;
    [in, size_is(m)] short b[][20]);  // If m = 10, b[10][20]
HRESULT Proc3(
    [in] short m;
    [size_is(m)] short * pshort); /* Specifies a pointer
                                  to an m-sized block of shorts */
HRESULT Proc4(
    [in] short m;
    [size_is( , m)] short ** ppshort); /* Specifies a pointer 
                                       to a pointer to an m-sized 
                                       block of shorts */
HRESULT Proc5(
    [in] short m;
    [size_is(m ,)] short ** ppshort); /* Specifies an
                                      m-sized block of pointers 
                                      to shorts */
HRESULT Proc6(
    [in] short m;
    [in] short n;
    [size_is(m,n)] short ** ppshort); /* Specifies a pointer to an 
                                      m-sized block of pointers, each 
                                      of which points to an n-sized 
                                      block of shorts. m associates with
                                      the pointer closeest to the identifer
                                      it decorates. n associates with rest.*/
 HRESULT Proc7(
     [out] long  * pSize,
     [out, size_is( , *pSize)] my_type ** ppMyType); /* Specifies a pointer 
                                              to a sized pointer, 
                                              which points to a block 
                                              of my_types, whose size is
                                              unknown when the stub 
                                              calls the server. */
```

## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**массивы**](arrays-1.md)
</dt> <dt>

[Атрибуты поля](/windows/desktop/Rpc/field-attributes)
</dt> <dt>

[**первый \_ —**](first-is.md)
</dt> <dt>

[Файл определения интерфейса (IDL)](interface-definition-idl-file.md)
</dt> <dt>

[**окне**](in.md)
</dt> <dt>

[**Последний \_ —**](last-is.md)
</dt> <dt>

[**Длина \_ равна**](length-is.md)
</dt> <dt>

[**Максимальное \_ число**](max-is.md)
</dt> <dt>

[**min \_ —**](min-is.md)
</dt> <dt>

[**заполняет**](out-idl.md)
</dt> <dt>

[**Строка**](string.md)
</dt> </dl>

 

 