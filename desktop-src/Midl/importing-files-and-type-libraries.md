---
title: Импорт файлов и библиотек типов
description: Ключевые слова MIDL включают, импортирует и importlib позволяют повторно использовать код, ссылаясь на существующие файлы заголовка, IDL и файлов ODL, а также на скомпилированные библиотеки типов.
ms.assetid: b4571c1d-4bd7-4ab1-9ef6-14356a6c4bb4
keywords:
- Язык MIDL MIDL, задачи, импорт файлов и библиотек типов
- Импорт MIDL
- библиотеки типов MIDL, импорт
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 099ada5122ad024e342148bf3c453df0bd50872e6d59a2bbabd7d2892af5f93a
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119013742"
---
# <a name="importing-files-and-type-libraries"></a>Импорт файлов и библиотек типов

Ключевые слова MIDL [**включают**](include.md), [**импортирует**](import.md)и [**importlib**](importlib.md) позволяют повторно использовать код, ссылаясь на существующие файлы заголовка, IDL и файлов ODL, а также на скомпилированные библиотеки типов.

Директива [**include**](include.md) ACF позволяет указать в файле ACF один или несколько файлов заголовков C-Language, которые будут включены в создаваемый MIDL код заглушки. В созданном файле будет **\# содержаться** строка с директивой C-препроцессора с указанным файлом заголовка. Используйте директиву **include** для переноса файлов заголовков, характерных для конкретной операционной среды, и не содержащих сведений, необходимых для интерфейса между клиентом и сервером. Не используйте параметр **включить** для файлов заголовков, содержащих типы данных, которые должны быть доступны для IDL-файла. Вместо этого используйте директиву [**Import**](import.md) .

## <a name="example-1"></a>Пример 1

``` syntax
[
  auto_handle
] 
interface X86PC
{ 
  include "gendefs.h", "protos.h", "myfile.h"; 
  //interface typdefs and function declarations here
}
```

Директива [**импорта**](import.md) IDL является стандартным методом для объединения определений типов и интерфейсов из других файлов IDL (или ODL) и файлов заголовков в IDL-файл. Все инструкции IDL в импортируемом файле, такие как typedef, объявления [**const**](const.md) и определения интерфейса, становятся доступными для ИМПОРТИРОВАНного IDL-файла.

Как и директива препроцессора языка C **\# , директива** [**Import**](import.md) указывает компилятору включать типы данных, определенные в импортированных IDL-файлах. В отличие от директивы **\# include** , Директива **Import** игнорирует прототипы процедур, так как для импортированного файла не создаются заглушки. Поскольку препроцессор вызывается отдельно для импортированного файла, директивы препроцессора (например, * *) не переносятся в импортируемый IDL-файл.

Дополнительные сведения об использовании [**импорта**](import.md) для включения системных файлов заголовков в IDL-файл см. в разделе [Импорт системных файлов заголовков](importing-system-header-files.md).

## <a name="example-2"></a>Пример 2

``` syntax
[
  uuid(. . .), object
] 
interface IKnown : IUnknown
{
  import "base.idl", "unknwn.idl", "helper.idl";
  //remainder of interface definition
}
```

Директива ODL [**importlib**](importlib.md) позволяет ссылаться на скомпилированную библиотеку типов в файле IDL или ODL. Директива **importlib** должна находиться внутри оператора [**Library**](library.md) и должна предшествовать другим описаниям типов в библиотеке. Импортированная библиотека, а также созданная библиотека должна быть доступна приложению во время выполнения.

## <a name="example-3"></a>Пример 3

``` syntax
library NewBrowser
{
  importlib("stdole32.tlb");
  importlib("legacy.tlb");
  //remainder of library definition
};
```

Также можно использовать директиву C-препроцессор **\# include** для включения заголовков и других файлов в IDL-или ODL-файл. Однако имейте в виду, что эта директива будет включать все содержимое указанного файла в буквальном смысле. Если файл заголовка содержит прототипы, которые не нужны или не нужны в файлах заглушки, созданных MIDL, или если они содержат определения типов, не поддерживающие удаленное взаимодействие, следует использовать директиву MIDL [**Import**](import.md) вместо директивы **\# include** .

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[**импортиру**](import.md)
</dt> <dt>

[**importlib**](importlib.md)
</dt> <dt>

[**относится**](include.md)
</dt> <dt>

[Импорт системных файлов заголовков](importing-system-header-files.md)
</dt> </dl>

 

 




