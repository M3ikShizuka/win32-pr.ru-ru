---
title: Использование суррогата System-Supplied
description: Использование суррогата System-Supplied
ms.assetid: 6709e5e2-50e0-470f-b618-3d3043f6e180
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 444cb94c5564a78ec5580ae8e7f781e91a8a9c15
ms.sourcegitcommit: 9eebab0ead09cecdbc24f5f84d56c8b6a7c22736
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/10/2021
ms.locfileid: "124369722"
---
# <a name="using-the-system-supplied-surrogate"></a>Использование суррогата System-Supplied

Чтобы использовать заданный системой суррогат для сервера DLL, зарегистрируйте библиотеку DLL, указав пустую строку или значение **null** для значения [дллсуррогате](dllsurrogate.md) в реестре. Когда запрос на активацию для сервера DLL, обозначенный как назначенный COM-серверу, COM запускает процесс суррогата по умолчанию и запрашиваемую библиотеку DLL (указав идентификатор CLSID в командной строке запуска), чтобы избежать отдельного вызова. (Дополнительные сведения о запуске более чем одного сервера DLL в суррогатном процессе см. в разделе [общий доступ к суррогатам](surrogate-sharing.md)).

Реализацией по умолчанию для процесса-суррогата является смешанный COM-сервер стиля модели. При загрузке нескольких серверов DLL в один процесс-суррогат этот процесс обеспечивает создание экземпляров каждого сервера DLL с помощью потоковой модели, указанной в реестре для этого сервера. Все загруженные свободные потоковые серверы будут объединены в многопоточное подразделение, а каждый попотоковый сервер будет находиться в однопотоковом подразделении. Если сервер DLL поддерживает обе модели потоков, COM выберет многопоточность.

Этот суррогатный процесс написан таким образом, что COM обрабатывает как выгрузку серверов DLL, так и завершение процесса-суррогата.

Предоставляемый системой суррогат будет прекрасно работать для большинства разработчиков, а также очень удобен в использовании. Однако разработчики с особыми соображениями могут решить, что необходим пользовательский суррогат. Дополнительные сведения см. [в разделе Написание пользовательского суррогата](writing-a-custom-surrogate.md).

## <a name="related-topics"></a>Связанные разделы

<dl> <dt>

[Суррогаты библиотеки DLL](dll-surrogates.md)
</dt> </dl>

 

 




