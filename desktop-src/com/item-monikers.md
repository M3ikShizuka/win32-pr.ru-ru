---
title: Моникеры элементов
description: Другим реализованным OLE классом моникера является моникер элемента, который можно использовать для обнаружения объекта, содержащегося в другом объекте.
ms.assetid: ddcf3669-4ad0-4a4e-80a6-eb78058cff09
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 57b692502ba44519a2c51a661ef62a51e133ac04
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "105700473"
---
# <a name="item-monikers"></a>Моникеры элементов

Другим реализованным OLE классом моникера является *моникер элемента*, который можно использовать для обнаружения объекта, содержащегося в другом объекте. Один из типов содержащих объектов — это объект OLE, внедренный в составной документ. Составной документ может обозначать внедренные содержащиеся в нем объекты, назначив каждому из них произвольное имя, например "embedobj1", "embedobj2" и т. д. Другой тип автономного объекта — это выбор пользователя в документе, например диапазон ячеек в электронной таблице или диапазон символов в текстовом документе. Объект, состоящий из выделенного фрагмента, называется *псевдо-объектом* , так как он не обрабатывается как отдельный объект, пока пользователь не помечает выделение. Электронная таблица может обозначать диапазон ячеек с помощью имени «1A: 7F», а документ обработки текста может обозначать диапазон символов, используя имя закладки.

Моникер элемента полезен в основном при объединении или *составлении* с другим моникером, который идентифицирует контейнер. Обычно создается моникер элемента, который затем состоялся в (например,) моникере файла для создания эквивалента полного пути к объекту. Например, можно составить моникер файла "c: \\ рабочий \\report.doc" (который идентифицирует объект-контейнер) с моникером элемента "embedobj1" (который определяет объект в контейнере) для формирования моникера "c: \\ Рабочий \\report.doc\\ embedobj1", который однозначно определяет конкретный объект в определенном файле. Кроме того, можно объединять дополнительные моникеры элементов для обнаружения глубоко вложенных объектов. Например, если "embedobj1" является именем объекта электронной таблицы, для обнаружения определенного диапазона ячеек в этом объекте электронной таблицы можно добавить моникер другого элемента, чтобы создать моникер, эквивалентный "c: \\ рабочий \\report.doc\\ Embedobj1 \\ 1a: 7F."

При объединении с моникером файла моникер элемента формирует полный путь. Таким же моникеры элементов расширяют понятие имен путей за пределами файловой системы, определяя имена путей для определения отдельных объектов, а не только файлов.

Между моникером элемента и моникером файла существует существенная разница. Путь, содержащийся в моникере файла, имеет смысл для всех, кто понимает файловую систему, а частичный путь, содержащийся в моникере элемента, имеет смысл только для конкретного контейнера. Все знают, на что ссылается "c: \\ рабочая \\report.doc", но только один конкретный объект контейнера знает, на что ссылается "1a: 7F". Один контейнер не может интерпретировать моникер элемента, созданный другим приложением; единственный контейнер, который знает, на какой объект ссылается моникер элемента, — это контейнер, который в первую очередь назначил моникер элемента для объекта. По этой причине источник объекта, именуемый сочетанием моникера файла и элемента, должен не только реализовывать [**IPersistFile**](/windows/desktop/api/ObjIdl/nn-objidl-ipersistfile), чтобы упростить привязку моникера файла, но также [**иолеитемконтаинер**](/windows/desktop/api/OleIdl/nn-oleidl-ioleitemcontainer) , чтобы упростить разрешение имени моникера элемента в соответствующий объект в контексте файла.

Преимуществом моникеров является то, что кто-то, использующий моникер для размещения объекта, не должен знать имя, которое содержится в моникере элемента, если моникер элемента является частью составного. Как правило, существование моникера элемента не имеет смысла. Вместо этого следует составить моникер элемента в моникер файла. Затем следует вызвать [**IMoniker:: биндтубжект**](/windows/desktop/api/ObjIdl/nf-objidl-imoniker-bindtoobject) для составного, который привязывает отдельные моникеры внутри него, обрабатывая имена.

Чтобы создать объект моникера элемента и вернуть его указатель на поставщика моникера, OLE предоставляет вспомогательную функцию [**креатеитеммоникер**](/windows/desktop/api/Objbase/nf-objbase-createitemmoniker). Эта функция создает объект моникера элемента и возвращает его указатель на поставщик.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Специальные имена](anti-monikers.md)
</dt> <dt>

[Моникеры класса](class-monikers.md)
</dt> <dt>

[Составные моникеры](composite-monikers.md)
</dt> <dt>

[Моникеры файлов](file-monikers.md)
</dt> <dt>

[Моникеры указателей](pointer-monikers.md)
</dt> </dl>

 

 




