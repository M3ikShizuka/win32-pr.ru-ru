---
title: Сохраняемость
description: Сохраняемость
ms.assetid: 4916ea52-a21c-4938-81cb-392b5ca1f6c1
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7ba5fc0c8e389c7babdf80b76719b39fc02d5604
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "104070718"
---
# <a name="persistence"></a>Сохраняемость

Элемент управления реализует один или несколько интерфейсов сохраняемости для поддержки сохранения состояния. Например, интерфейс [**иперсистстреаминит**](/windows/desktop/api/OCIdl/nn-ocidl-ipersiststreaminit) поддерживает сохраняемость состояния элемента управления на основе потока. **Иперсистстреаминит** является заменой для [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream) и добавляет метод инициализации [**InitNew**](/windows/desktop/api/OCIdl/nf-ocidl-ipersiststreaminit-initnew). Другие методы одинаковы в обоих интерфейсах. **Иперсистстреаминит** не является производным от **IPersistStream**; объект поддерживает только один из двух интерфейсов в зависимости от того, требует ли он возможности инициализировать новые экземпляры.

Другие интерфейсы сохраняемости, которые может предложить элемент управления, включают: [**иперсистстораже**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage), [**иперсистмемори**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768210(v=vs.85)), [**IPersistPropertyBag**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768205(v=vs.85)), [**иперсистмоникер**](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775042(v=vs.85)). Разработчик элемента управления должен решить, какие типы сохраняемости наиболее важны, и реализовать соответствующие интерфейсы сохраняемости. Разработчик элемента управления также решает, что сохранять. Например, элемент управления может сохранять текущие значения его свойств, а также его расположение и размер в пределах контейнера. Клиент решает, какой интерфейс предпочтительнее использовать.

Перед загрузкой элемента управления из его постоянного состояния клиент может проверить флаг ОЛЕМИСК \_ сетклиентситефирст, чтобы определить, поддерживает ли элемент управления получение его клиентского сайта и внешних свойств перед загрузкой его постоянного состояния. Такая оптимизация позволяет экономить время при создании экземпляра элемента управления, так как после этого элемент управления может игнорировать его постоянные значения, а не загружать их только для того, чтобы они переопределялись внешними свойствами, предоставленными клиентом.

Элемент управления может также поддерживать сохранение и восстановление его состояния в наборе свойств OLE, набор идентификаторов и значений в указанном формате. Эта функция может быть полезна для контейнеров, таких как Visual Basic, которые сохраняют свои программы в текстовой форме. Элемент управления, который хочет поддерживать эту функцию, реализует интерфейс [**IDataObject:: GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata) и [**IDataObject:: SetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-setdata) для передачи его значений свойств в контейнер и из контейнера соответственно. Это задание контейнера для преобразования этих данных в текст и их сохранения. Идентификаторы, используемые элементом управления, соответствуют именам и значениям свойств элемента управления. Определение этого набора свойств см. в разделе OLE CDK.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Элементы управления ActiveX](activex-controls.md)
</dt> </dl>

 

 