---
title: Настройка безопасности System-Wide с помощью DCOMCNFG
description: Если требуется, чтобы все приложения на одном компьютере, не предоставляющие собственной безопасности для совместного использования параметров безопасности по умолчанию, были установлены на уровне всей системы.
ms.assetid: 23d1e222-c00b-497c-adc8-4ae14c5bdd98
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c7feaaf356263a48c2c93eb9b3b3764b7352cd39
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104411164"
---
# <a name="setting-system-wide-security-using-dcomcnfg"></a>Настройка безопасности System-Wide с помощью DCOMCNFG

Изменение параметров безопасности на уровне системы повлияет на все серверные приложения COM, не устанавливающие собственные параметры безопасности на уровне процесса. Это может препятствовать правильной работе таких приложений. Если вы изменяете параметры безопасности на уровне системы, чтобы они влияли на параметры безопасности для конкретного приложения COM, вместо этого следует изменить параметры безопасности для этого конкретного COM-приложения. Дополнительные сведения о настройке безопасности на уровне процесса см. в разделе [Настройка безопасности на уровне процесса](setting-processwide-security.md).

Если требуется, чтобы все приложения на одном компьютере, не предоставляющие собственной безопасности для совместного использования параметров безопасности по умолчанию, были установлены на уровне всей системы. Использование Dcomcnfg.exe позволяет легко задавать значения по умолчанию в реестре, которые применяются ко всем приложениям на компьютере.

Важно понимать, что если клиент или сервер явно вызывает [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) для установки безопасности на уровне процесса, параметры по умолчанию в реестре будут игнорироваться, а вместо параметров безопасности процесса будут использоваться параметры для **CoInitializeSecurity** . Кроме того, при использовании Dcomcnfg.exe для указания параметров безопасности конкретного процесса параметры компьютера по умолчанию переопределяются параметрами процесса.

При включении безопасности на уровне системы необходимо задать для уровня проверки подлинности значение, отличное от None, и задать разрешения на запуск и доступ. Можно задать уровень олицетворения по умолчанию, а также включить отслеживание ссылок. В следующих разделах приводятся пошаговые инструкции.

-   [Настройка System-Wide уровня проверки подлинности по умолчанию](#setting-system-wide-default-authentication-level)
-   [Настройка разрешений на запуск System-Wide](#setting-system-wide-launch-permissions)
-   [Настройка разрешений System-Wide доступа](#setting-system-wide-access-permissions)
-   [Настройка уровня олицетворения System-Wide](#setting-system-wide-impersonation-level)
-   [Настройка отслеживания ссылок System-Wide](#setting-system-wide-reference-tracking)
-   [Включение и отключение DCOM](#enabling-and-disabling-dcom)
-   [См. также](#related-topics)

## <a name="setting-system-wide-default-authentication-level"></a>Настройка System-Wide уровня проверки подлинности по умолчанию

Уровень проверки подлинности используется, чтобы сообщить COM о том, какой уровень проверки подлинности клиента должен пройти. Эти уровни обеспечивают различные уровни защиты, от защиты до полного шифрования. Чтобы включить безопасность для компьютера, необходимо выбрать уровень проверки подлинности, отличный от «нет». Вы можете выбрать такой параметр с помощью Dcomcnfg.exe, выполнив следующие действия.

**Установка уровня проверки подлинности на уровне системы**

1.  Запустите файл Dcomcnfg.exe.

2.  Перейдите на вкладку **свойства по умолчанию** .

3.  В списке **Дефаултâ Аусентикатионâ Level (уровень** ) выберите значение, отличное от **(нет)**.

4.  Если будут заданы дополнительные свойства для компьютера, нажмите кнопку **Применить** , чтобы применить новый уровень проверки подлинности. В противном случае нажмите кнопку **ОК** , чтобы применить изменения и выйти Dcomcnfg.exe.

## <a name="setting-system-wide-launch-permissions"></a>Настройка разрешений на запуск System-Wide

Разрешения на запуск, заданные с помощью Dcomcnfg.exe определяют список пользователей, каждый из которых явно предоставил или запретил разрешение на запуск любого сервера, который не предоставляет собственные параметры разрешения на запуск. При задании разрешений на запуск можно добавить или удалить одного или нескольких пользователей или группы из этого списка. Для каждого добавляемого пользователя необходимо указать, предоставлено ли пользователю разрешение на запуск.

**Задание разрешений на запуск для компьютера**

1.  На странице свойств **безопасность по умолчанию** в Dcomcnfg.exe нажмите кнопку **изменить значение по умолчанию** в области **разрешения на запуск по умолчанию** .

2.  Чтобы удалить пользователей или группы, выберите пользователя или группу, которые нужно удалить, и нажмите кнопку **Удалить** . Выбранный пользователь или группа больше не будут отображаться в списке. Завершив удаление пользователей и групп, нажмите кнопку **ОК**.

3.  Если вы хотите добавить пользователя или группу, нажмите кнопку **Добавить** .

4.  Если известно полное имя пользователя, которое вы хотите добавить, введите его в текстовом поле **Добавить имена** . Если имя пользователя неизвестно, см. раздел **Настройка безопасности Процессвиде с помощью DCOMCNFG** для его поиска. После обнаружения имени пользователя выберите пользователя или группу в списке **имена** и нажмите кнопку **Добавить** .

5.  В поле **тип списка доступа** выберите тип доступа ( **Разрешить запуск** или **запретить запуск**). Чтобы добавить других пользователей, которые также будут иметь выбранный тип доступа, повторите шаг 4. Завершив добавление пользователей для выбранного типа доступа, нажмите кнопку **ОК** .

6.  Чтобы добавить пользователей, которые будут иметь другой тип доступа, повторите шаги 4 и 5. В противном случае нажмите кнопку **ОК** , чтобы применить изменения.

## <a name="setting-system-wide-access-permissions"></a>Настройка разрешений System-Wide доступа

Dcomcnfg.exe позволяет задать разрешения на доступ для управления списком пользователей, которым предоставлен или запрещен доступ к методам этих серверов, которые не предоставляют собственные разрешения на доступ. В список можно добавить пользователей или группы, указав, будет ли разрешение на доступ предоставлено или запрещено. Вы также можете удалить пользователей из списка.

При настройке разрешений доступа необходимо убедиться, что система включена в список пользователей, которым предоставлен доступ. Если предоставлены разрешения на доступ всем, система включается неявно.

Процесс настройки разрешений на доступ к компьютеру аналогичен настройке разрешений на запуск. Необходимо выполнить следующие действия.

**Настройка разрешений доступа для компьютера**

1.  На странице свойств **безопасность по умолчанию** в Dcomcnfg.exe нажмите кнопку **изменить значение по умолчанию** в области **разрешения доступа по умолчанию** .

2.  Чтобы удалить пользователей или группы, выберите пользователя или группу, которые нужно удалить, и нажмите кнопку **Удалить** . Выбранный пользователь или группа больше не будут отображаться в списке. Завершив удаление пользователей и групп, нажмите кнопку **ОК**.

3.  Если вы хотите добавить пользователя или группу, нажмите кнопку **Добавить** .

4.  Если известно полное имя пользователя, которое вы хотите добавить, введите его в текстовом поле **Добавить имена** . Если вы не знакомы с именем пользователя, см. раздел [Настройка безопасности на уровне процесса с помощью DCOMCNFG](setting-processwide-security-using-dcomcnfg.md) , чтобы найти его. После обнаружения имени пользователя выберите пользователя или группу в списке **имена** и нажмите кнопку **Добавить** .

5.  В поле **тип списка доступа** выберите тип доступа ( **Разрешить доступ** или **запретить доступ**). Чтобы добавить других пользователей, которые будут иметь выбранный тип доступа, повторите шаг 4. Завершив добавление пользователей для выбранного типа доступа, нажмите кнопку **ОК** .

6.  Чтобы добавить пользователей, которые будут иметь другой тип доступа, повторите шаги 4 и 5. В противном случае нажмите кнопку **ОК** , чтобы применить изменения.

## <a name="setting-system-wide-impersonation-level"></a>Настройка уровня олицетворения System-Wide

Уровень олицетворения, заданный клиентом, определяет количество полномочий, предоставленных серверу для работы от имени клиента. Например, если клиент установил уровень олицетворения делегировать, сервер может получить доступ к локальным и удаленным ресурсам в качестве клиента, а сервер может скрываться на нескольких компьютерах, если задана возможность маскировки. Чтобы определить, какой уровень олицетворения следует выбрать, см. раздел [уровни олицетворения](impersonation-levels.md) и [маскировка](cloaking.md).

Установка уровня олицетворения по умолчанию для всего компьютера сообщает COM, какой уровень олицетворения следует использовать, когда конкретный клиент на компьютере не задает уровень олицетворения программным путем с помощью [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) или [**CoSetProxyBlanket**](/windows/desktop/api/combaseapi/nf-combaseapi-cosetproxyblanket).

**Установка уровня олицетворения для компьютера**

1.  Если Dcomcnfg.exe работает, перейдите на вкладку **свойства по умолчанию** .

2.  В списке **уровень олицетворения по умолчанию** выберите нужный уровень олицетворения.

3.  Если будут заданы дополнительные свойства для компьютера, нажмите кнопку **Применить** , чтобы применить новый уровень олицетворения. В противном случае нажмите кнопку **ОК** , чтобы применить изменения и выйти Dcomcnfg.exe.

## <a name="setting-system-wide-reference-tracking"></a>Настройка отслеживания ссылок System-Wide

Когда вы включаете отслеживание ссылок, вы запрашиваете у COM дополнительные проверки безопасности и отслеживаете сведения, позволяющие избежать слишком раннего освобождения объектов. Помните, что эти дополнительные проверки являются дорогостоящими. Дополнительные сведения об отслеживании ссылок см. в разделе [Отслеживание ссылок](reference-tracking.md). Чтобы включить или отключить отслеживание ссылок, выполните следующие действия.

**Настройка отслеживания ссылок для компьютера**

1.  Если Dcomcnfg.exe работает, перейдите на вкладку **свойства по умолчанию** .

2.  Чтобы включить (или отключить) отслеживание ссылок, установите (или снимите) флажок **включить дополнительную защиту для отслеживания ссылок** в нижней части страницы.

3.  Если будут заданы дополнительные свойства для компьютера, нажмите кнопку **Применить** , чтобы применить новый параметр. В противном случае нажмите кнопку **ОК** , чтобы применить изменения и выйти Dcomcnfg.exe.

## <a name="enabling-and-disabling-dcom"></a>Включение и отключение DCOM

Если компьютер входит в сеть, протокол связи DCOM позволяет COM-объектам на этом компьютере взаимодействовать с COM-объектами на других компьютерах. Можно отключить DCOM для определенного компьютера, но это приведет к отключению всех соединений между объектами на этом компьютере и объектами на других компьютерах.

Отключение DCOM на компьютере не влияет на локальные объекты COM. COM по-прежнему ищет указанные разрешения на запуск. Если разрешения на запуск не указаны, используются разрешения на запуск по умолчанию. Даже если отключить DCOM, если пользователь имеет физический доступ к компьютеру, он может запустить сервер на компьютере, если только не задано разрешение на запуск.

> [!Note]  
> Если отключить DCOM на удаленном компьютере, удаленный доступ к этому компьютеру будет невозможен для повторного включения DCOM. Чтобы повторно включить DCOM, потребуется физический доступ к этому компьютеру.

 

**Ручное включение (отключение) DCOM для компьютера**

1.  Запустите файл Dcomcnfg.exe.

2.  Перейдите на вкладку **Свойства дефаултâ** .

3.  Установите (или снимите) флажок **включить распределенные комâ на этом компьютере** .

4.  Если будут заданы дополнительные свойства для компьютера, нажмите кнопку **Применить** , чтобы включить (или отключить) DCOM. В противном случае нажмите кнопку **ОК** , чтобы применить изменения и выйти Dcomcnfg.exe.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Настройка безопасности на уровне процесса](setting-processwide-security.md)
</dt> </dl>

 

 




