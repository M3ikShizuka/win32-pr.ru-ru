---
title: Управление выделением памяти
description: Управление выделением памяти
ms.assetid: 8a189fe8-5555-44bb-968b-04408fa7fce4
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e2af04b4ecc5b8480230b17ae710b84ce8e6ce5d
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "104413881"
---
# <a name="managing-memory-allocation"></a>Управление выделением памяти

В модели COM многие, если не большинство из них, методы интерфейса вызываются кодом, написанным одной организацией программирования, и реализуются кодом, написанным другим. Многие параметры и возвращаемые значения этих функций имеют типы, которые могут передаваться по значению. Однако иногда необходимо передать структуры данных, для которых это не так, поэтому необходимо, чтобы вызывающий и вызывался совместимая политика выделения и отмены распределения. COM определяет универсальное соглашение о выделении памяти, так как оно является более разумным, чем определение правил с учетом регистра, а реализация удаленного вызова процедур COM может правильно управлять памятью.

Методы COM-интерфейса всегда обеспечивают управление памятью указателей на интерфейс путем вызова функций [**AddRef**](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) и [**Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) , находящихся в интерфейсе [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) , от которого наследуются все остальные COM-интерфейсы. (Дополнительные сведения см. в разделе [правила управления счетчиками ссылок](rules-for-managing-reference-counts.md) .)

В этом разделе описывается, как выделить память для параметров, которые не передаются по значению, а не указатели на интерфейсы, но более рутинные вещи, такие как строки, указатели на структуры и т. д.

Дополнительные сведения см. в следующих разделах:

-   [Распределитель памяти OLE](the-ole-memory-allocator.md)
-   [Правила управления памятью](memory-management-rules.md)
-   [Отладка выделения памяти](debugging-memory-allocations.md)

 

 