---
title: Общие сведения о рекомендациях для контейнеров управления и управления
description: Общие сведения о рекомендациях для контейнеров управления и управления
ms.assetid: c4cf2409-0085-43e6-afa2-f9c03cc50565
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2658c691e13b0a78da82fa006ed22142082e2f7eb8b04d78992943a024487a8c
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "120120464"
---
# <a name="overview-of-control-and-control-container-guidelines"></a>Общие сведения о рекомендациях для контейнеров управления и управления

элемент управления ActiveX — это, по сути, простой объект OLE, поддерживающий интерфейс [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) . Как правило, он поддерживает больше интерфейсов, чтобы обеспечить функциональность, но все дополнительные интерфейсы можно просматривать как необязательные и, таким образом, контейнер элемента управления не должен полагаться на поддерживаемые дополнительные интерфейсы. Если не указать дополнительные интерфейсы, которые должен поддерживать элемент управления, элемент управления может эффективно ориентироваться на конкретную область функциональности без необходимости поддержки определенных интерфейсов для определения в качестве элемента управления. Как и в случае с OLE, как в элементе управления, так и в контейнере элемента управления, никогда не следует предполагать, что интерфейс доступен и стандартные соглашения проверки возврата должны выполняться всегда. Очень важно, чтобы контейнер элемента управления или элемента управления был корректно отключен и предлагал другие функциональные возможности, если необходимый интерфейс недоступен.

контейнер элемента управления ActiveX должен иметь возможность размещения минимального элемента управления ActiveX; Он также будет поддерживать ряд дополнительных интерфейсов, как указано в [контейнерах](containers.md). Существует ряд интерфейсов и методов, которые контейнер может дополнительно поддерживать, которые группируются в функциональные области, известные как *категории компонентов*. Контейнер может поддерживать любое сочетание категорий компонентов, например, существует категория компонента для привязки данных, а контейнер может или не поддерживать функциональность привязки данных в зависимости от потребностей рынка контейнера. Если элементу управления требуется поддержка привязки данных из контейнера для функционирования, это требование будет введено в реестр. Это позволяет контейнеру элемента управления предлагать только вставку элементов управления, которые он может успешно разместить. важно отметить, что категории компонентов задаются как часть OLE и не относятся к элементам управления ActiveX. архитектура элементов управления использует категории компонентов для указания областей функциональности, которые может поддерживать компонент OLE. Категории компонентов не являются кумулятивными или эксклюзивными, поэтому контейнер элементов управления может поддерживать одну категорию без обязательной поддержки другой.

Важно, чтобы элементы управления, требующие дополнительных функций, были четко упакованы и вырынке с этими требованиями. аналогичные контейнеры, которые предлагают определенные функции или категории компонентов, должны быть вырынке и упакованы как предложения этих уровней поддержки при размещении ActiveXных элементов управления. Рекомендуется, чтобы элементы управления настраиваются и проверяются с максимально возможной подмножеством контейнеров, что может привести к снижению или альтернативной функциональности, если интерфейсы или методы недоступны. В ситуации, когда элемент управления не может выполнить назначенную функцию задания без поддержки категории компонента, эта категория должна быть введена как требование в реестре, чтобы предотвратить вставку элемента управления в недопустимый контейнер.

Эти рекомендации определяют интерфейсы и методы, которые элемент управления может использовать для поддержки контейнера элемента управления, хотя, как всегда элемент управления должен проверять возвращаемые значения при использовании [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) или других методов для получения указателей на эти интерфейсы. Контейнер не должен предполагать, что элемент управления поддерживает что-либо больше, чем интерфейс [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) , и эти рекомендации определяют, какие интерфейсы могут поддерживаться элементом управления, и каково присутствие определенного интерфейса.

## <a name="why-the-activex-control-and-control-container-guidelines-are-important"></a>зачем важны рекомендации по контейнерам элемента управления ActiveX и control

ActiveX Элементы управления стали основной архитектурой для разработки программируемых программных компонентов для использования в различных контейнерах, от средств разработки программного обеспечения до средств повышения производительности конечных пользователей. Чтобы элемент управления хорошо работал в различных контейнерах, элемент управления должен иметь возможность предполагать некоторый минимальный уровень функциональности, который может полагаться на все контейнеры.

Следуя этим рекомендациям, разработчики элементов управления и контейнеров делают свои элементы управления и контейнеры более надежными и совместимыми, а в конечном итоге — более удобные и более удобные компоненты для создания решений на основе компонентов.

## <a name="what-to-do-when-an-interface-you-need-is-not-available"></a>Что делать, если необходимый интерфейс недоступен

Программы OLE должны использовать [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) для получения указателей на интерфейсы и должны проверять возвращаемое значение. Приложения OLE не могут безопасно предположить, что **QueryInterface** будет успешно выполнен.

Это требование относится ко всем приложениям OLE. Если запрашиваемый интерфейс недоступен (т. е. [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) возвращает E \_ -интерфейс), элемент управления или контейнер должен быть корректно устранен, даже если это означает, что он не может выполнить назначенную функцию задания.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[ActiveX Рекомендации по контейнерам элементов управления и контроля](activex-control-and-control-container-guidelines.md)
</dt> </dl>

 

 




