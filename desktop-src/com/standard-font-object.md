---
title: Объект стандартного шрифта
description: Объект стандартного шрифта
ms.assetid: f9b54dc4-24d4-4eb7-b43f-c481d64e52df
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8f1beb4ac2890cd3314c1b23f847192f1d3248b02e301c27d5990f524c74c0a7
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118104157"
---
# <a name="standard-font-object"></a>Объект стандартного шрифта

Стандартное свойство шрифта окружения, предоставляемое контейнером, и стандартное свойство Font, предоставляемое элементом управления, предоставляют стандартный объект Font. То есть эти стандартные шрифты предоставляют указатель **IDispatch** на объект стандартного шрифта.

Объект Font — это предоставляемая системой реализация набора интерфейсов на основе базовой поддержки шрифтов GDI. Объект Font создается с помощью функции API [**олекреатефонтиндирект**](/windows/desktop/api/OleCtl/nf-olectl-olecreatefontindirect) , заданной структурой [**фонтдеск**](/windows/win32/api/olectl/ns-olectl-fontdesc) . Объект Font поддерживает ряд свойств для чтения и записи, а также пользовательских методов через его интерфейс [**IFont**](/windows/desktop/api/OCIdl/nn-ocidl-ifont)и поддерживает тот же набор свойств (но не методов) через disp-интерфейс [**IFontDisp**](/windows/win32/api/ocidl/nn-ocidl-ifontdisp). Диспетчерский интерфейс используется для свойств шрифта, упомянутых ранее. Свойства соответствуют атрибутам шрифта GDI, описанным в структуре [**LOGFONT**](/windows/win32/api/dimm/ns-dimm-logfonta) .

Объект Font также поддерживает исходящий интерфейс [**ипропертинотифисинк**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertynotifysink) , чтобы клиент мог определить, когда изменяются свойства шрифта. Так как объект Font поддерживает по крайней мере один исходящий интерфейс, он также реализует [**IConnectionPointContainer**](/windows/desktop/api/OCIdl/nn-ocidl-iconnectionpointcontainer) и одну точку подключения для **ипропертинотифисинк** для этой цели.

объект font предоставляет свойство хфонт, которое является Windowsным маркером шрифта, который соответствует другим атрибутам, заданным для шрифта. Объект Font задерживает этот шрифт, если это возможно, поэтому при последовательном задании двух свойств шрифта не будет реализован промежуточный шрифт. Кроме того, в качестве оптимизации объект стандартного шрифта поддерживает кэш дескрипторов шрифта. Два объекта Font в одном процессе с одинаковыми свойствами будут возвращать один и тот же маркер шрифта. Объект Font может удалить шрифты из этого кэша в, что познакомит с особыми соображениями для клиентов, использующих это свойство Хфонт. Дополнительные сведения см. в разделе [**IFont:: Get \_ хфонт**](/windows/desktop/api/OCIdl/nf-ocidl-ifont-get_hfont) .

Объект Font также поддерживает [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream) , так что он может сохранять и загружать данные из экземпляра [**IStream**](/windows/desktop/api/objidl/nn-objidl-istream). Любой другой объект, который использует объект Font, обычно сохраняет и загружает шрифт как часть собственной обработки сохраняемости объекта.

Кроме того, объект Font поддерживает [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) , через который он предоставляет набор свойств, содержащий типизированные значения для каждого свойства Font.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Свойства элемента управления](control-properties.md)
</dt> </dl>

 

 