---
title: События элемента управления (COM)
description: Помимо предоставления свойств и методов, элемент управления также предоставляет исходящие интерфейсы для уведомления клиента о событиях.
ms.assetid: e7085bc0-c087-4cc8-9c69-ba05b0923b74
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 82b987202cb4e4e635a947ed60e9f947cc428f0aaaacb3d27c27d60ad536b636
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119243634"
---
# <a name="control-events-com"></a>События элемента управления (COM)

Помимо предоставления свойств и методов, элемент управления также предоставляет исходящие интерфейсы для уведомления клиента о событиях. Клиент должен поддерживать обработку этих событий. Дополнительные сведения о том, как работают подключаемые объекты, см. [в разделе события в com и Connected Objects](events-in-com-and-connectable-objects.md) .

Элемент управления может поддерживать различные исходящие интерфейсы для разных целей. Все исходящие интерфейсы помечаются как исходные интерфейсы в сведениях о типе элемента управления, но только один из них помечается по умолчанию, чтобы указать, что это основной исходящий интерфейс.

Контейнер может поддерживать один или несколько исходящих интерфейсов, определенных элементом управления. Элемент управления должен быть готов к работе с контейнерами, которые обеспечивают поддержку только некоторых исходящих интерфейсов.

Элементы управления поддерживают четыре типа событий:

-   События запроса. Элемент управления запрашивает разрешение от своего клиента для того, чтобы сделать что-то путем вызова метода в исходящем интерфейсе, тем самым запуская событие запроса. Клиент передает элемент управления по логическому параметру out в методе, вызванном элементом управления. Таким же клиентом можно предотвратить выполнение действия элементом управления.
-   События до. Элемент управления уведомляет клиента о необходимости выполнения действий путем вызова метода в исходящем интерфейсе, что приводит к срабатыванию события Before. Клиент не имеет возможности предотвращать действие, но может предпринять все необходимые действия, заданные выполняемым действием.
-   После событий. Элемент управления уведомляет своего клиента о том, что он только что выполнил действие путем вызова метода в исходящем интерфейсе, тем самым запуская события After. Опять же, клиент не может отменить это действие, но может выполнить необходимые действия, заданные в ходе выполнения действия.
-   События Do. Элемент управления активирует событие Do, чтобы позволить клиенту переопределить действие элемента управления и предоставить некоторые альтернативные или дополнительные действия. Как правило, метод, который вызывает элемент управления для события Do, имеет ряд параметров для согласования с клиентом о действиях, которые будут выполнены.

Следующие идентификаторы DISPID определены для стандартных событий, которые могут поддерживаться элементами управления: щелчок, двойное нажатие, Клавиша вниз, нажатие клавиши, KeyUp, MouseMove, MouseUp и ошибка. Все эти стандартные события имеют отрицательные значения DISPID, указывающие их стандартное состояние.

Метод [**метод интерфейса IOleControl:: FreezeEvents**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-freezeevents) , когда вызывается со значением **true**, сообщает элементу управления, будет ли контейнер обрабатывать события из элемента управления до тех пор, пока **FreezeEvents** снова не будет вызываться с параметром **false**. В течение этого времени Управление не может зависеть от контейнера, который фактически обрабатывает любые события. Если событие должно быть обработано, элемент управления должен поставить событие в очередь, чтобы его можно было запускать, когда **FreezeEvents** вызывается с параметром **false**.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Элементы управления ActiveX](activex-controls.md)
</dt> </dl>

 

 




