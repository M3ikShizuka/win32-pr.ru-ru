---
title: InprocServer32
description: Регистрирует 32-разрядный внутрипроцессный сервер и задает потоковую модель апартамента, в которой может работать сервер.
ms.assetid: 4edbbd9d-7ea1-4476-aee7-eaf30e54db8d
keywords:
- COM раздела реестра InprocServer32
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0daae9d495ad588e0dc710b63fe7d7ae9f48c11d
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104532345"
---
# <a name="inprocserver32"></a>InprocServer32

Регистрирует 32-разрядный внутрипроцессный сервер и задает потоковую модель апартамента, в которой может работать сервер.

## <a name="registry-entry"></a>Запись реестра

```
HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID
   {CLSID}
      InprocServer32
         (Default) = path
         ThreadingModel = value
```

## <a name="remarks"></a>Комментарии

**ThreadingModel** — это значение **reg \_ SZ** , указывающее потоковую модель. Возможные значения показаны в следующей таблице.



| Значение     | Описание                                |
|-----------|--------------------------------------------|
| Разделение | Однопотоковое подразделение                  |
| Оба      | Однопотоковое или многопоточное подразделение |
| Бесплатный      | Многопоточное подразделение                    |
| нейтральное выражение.   | Нейтральное подразделение                          |



 

Для каждого объекта, предоставленного внутрипроцессного сервером, необходимо использовать одно и то же значение.

Если **ThreadingModel** отсутствует или не задано значение, сервер загружается в первый апартамент, инициализированный в процессе. Этот апартамент иногда называют основным однопотоковым апартаментом (STA). Если первый поток STA в процессе инициализируется моделью COM, а не явным вызовом [**CoInitialize**](/windows/desktop/api/Objbase/nf-objbase-coinitialize) или [**CoInitializeEx**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex), он называется главным STA. Например, COM создает главный STA, если внутрипроцессный сервер, который требуется загрузить, требует STA, но в данный момент в процессе нет STA.

Когда это возможно, внутрипроцессный сервер загружается в тот же апартамент, что и клиент, который его загружает. Если потоковая модель подразделения клиента несовместима с указанной моделью, сервер загружается, как показано в следующей таблице.



| Потоковая модель сервера | Сервер подразделения запущен в |
|---------------------------|----------------------------|
| <not specified>     | Главный STA                   |
| Оба                      | Тот же апартамент, что и клиент   |
| Бесплатный                      | Многопоточное подразделение    |
| нейтральное выражение.                   | Нейтральное подразделение          |



 

Если потоковая модель сервера является Апартаментной, то подразделение, в котором загружен сервер, зависит от апартамента, в котором выполняется клиент, как показано в следующей таблице.



| Клиент подразделения запущен в | Сервер подразделения запущен в |
|----------------------------|----------------------------|
| Многопоточных              | Главный STA                   |
| Нейтральный (в потоке STA)    | Тот же апартамент, что и клиент   |
| Нейтральный (в потоке MTA)    | Главный STA                   |



 

COM также может создать многопотоковый апартамент узла (MTA). Если клиент в однопотоковом апартаменте запрашивает внутрипроцессный сервер, модель потоков которого свободна, если в процессе нет агента передачи сообщений, COM создает агент передачи узла и загружает в него сервер.

Для 32-разрядного внутрипроцессного сервера необходимо зарегистрировать [**InprocHandler32**](inprochandler32.md), [**инпроксервер**](inprocserver.md), **InprocServer32** и [**вставляемые**](insertable.md) ключи. Запись **инпроксервер** необходима только для обеспечения обратной совместимости. Если он отсутствует, класс по-прежнему работает, но не может быть загружен в 16-разрядные приложения.

Если контейнер выполняет поиск в реестре внутрипроцессного сервера, 16-разрядная версия имеет приоритет с 16-разрядным контейнером, а 32-разрядная версия имеет приоритет с 32-битным контейнером.

## <a name="related-topics"></a>См. также

<dl> <dt>

[**инпроксервер**](inprocserver.md)
</dt> </dl>

 

 




