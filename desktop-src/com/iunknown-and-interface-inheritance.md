---
title: IUnknown и наследование интерфейсов
description: IUnknown и наследование интерфейсов
ms.assetid: c45f0947-6020-4aa1-9250-561603a46a68
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9ce4d9d164607745b78001bb92b7dc5331296abe
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "105710381"
---
# <a name="iunknown-and-interface-inheritance"></a>IUnknown и наследование интерфейсов

Наследование в COM не означает повторное использование кода. Поскольку никакие реализации не связаны с интерфейсами, наследование интерфейса не означает наследование кода. Это означает, что контракт, связанный с интерфейсом, наследуется в режиме чистого виртуального базового класса C++ и изменен — либо путем добавления новых методов, либо путем дальнейшего уточнения разрешенного использования методов. В COM нет селективного наследования. Если один интерфейс наследуется от другого, он включает все методы, определяемые другим интерфейсом.

Наследование используется в стандартных COM-интерфейсах с осторожностью. Все предопределенные интерфейсы (и любые настраиваемые интерфейсы, определяемые пользователем) наследуют свои определения из важного интерфейса [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown), который содержит три важных метода: [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)), [**AddRef**](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref)и [**Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release). Все COM-объекты должны реализовывать интерфейс **IUnknown** , так как он предоставляет средства с помощью **QueryInterface**, чтобы свободно перемещаться между различными интерфейсами, которые поддерживает объект, а также средства для управления временем существования с использованием **AddRef** и **Release**.

При создании объекта, поддерживающего [агрегирование](aggregation.md), необходимо реализовать один набор функций [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) для всех интерфейсов, а также изолированный интерфейс **IUnknown** . В любом случае любой объект, реализующий объекты, будет реализовывать методы **IUnknown** . Дополнительные сведения см. в разделе [использование и реализация IUnknown](using-and-implementing-iunknown.md) .

Хотя существует несколько интерфейсов, которые наследуют свои определения от второго интерфейса в дополнение к [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown), большинство просто наследует методы интерфейса **IUnknown** . Это делает большинство интерфейсов относительно компактными и простыми в инкапсуляции.

## <a name="related-topics"></a>См. также

<dl> <dt>

[COM-объекты и интерфейсы](com-objects-and-interfaces.md)
</dt> </dl>

 

 