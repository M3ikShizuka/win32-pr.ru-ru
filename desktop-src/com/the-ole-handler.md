---
title: Обработчик OLE
description: Обработчик OLE — это библиотека DLL, содержащая несколько взаимодействующих компонентов, используемых для связывания и внедрения.
ms.assetid: 5a01b4be-38cf-4019-ba20-ee67b836a3e0
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fb9579f18b44a36a794ff807d9d616dd3a06dd1b
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104068045"
---
# <a name="the-ole-handler"></a>Обработчик OLE

*Обработчик OLE* — это библиотека DLL, содержащая несколько взаимодействующих компонентов, используемых для связывания и внедрения. Чтобы избежать затрат на постоянный обмен данными между контейнером и сервером, обработчик загружается в пространство процесса контейнера для выполнения от имени сервера в качестве типа суррогатного процесса. Обработчик OLE управляет запросами контейнеров, которые не требуют внимания к серверному приложению, например запросы на рисование. Когда контейнер запрашивает, что обработчик объектов не может предоставить, обработчик взаимодействует с серверным приложением, используя механизм взаимодействия COM вне процесса.

Компоненты обработчика OLE включают удаленные части для управления взаимодействием между обработчиком и его сервером, кэш для хранения данных объекта (вместе с информацией о том, как следует форматировать и отображать данные) и управляющий объект, который координирует действия других компонентов библиотеки DLL. Кроме того, если объект является ссылкой, Библиотека DLL также включает компонент связывания или *связанный объект*, который отслеживает имя и расположение источника ссылки.

OLE предоставляет обработчик по умолчанию, который большинство приложений используют для связывания и внедрения. Если значение по умолчанию не соответствует требованиям сервера, можно либо полностью заменить обработчик по умолчанию, либо использовать части предоставляемых им функций, если это необходимо. В последнем случае обработчик приложения реализуется как агрегатный объект, состоящий из нового управляющего объекта и обработчика по умолчанию. Сочетания приложений и обработчиков по умолчанию также называются *внутрипроцессный обработчиками*. *Обработчик удаленного взаимодействия* используется для объектов, которым не назначен CLSID в системном реестре или которые не имеют указанного обработчика. Все, что требуется из обработчика для этих типов объектов, заключается в том, что они передают информацию через границу процесса. Чтобы создать новый экземпляр обработчика по умолчанию, вызовите метод [**олекреатедефаулсандлер**](/windows/desktop/api/Ole2/nf-ole2-olecreatedefaulthandler). В некоторых особых обстоятельствах вызовите [**олекреатимбеддингхелпер**](/windows/desktop/api/Ole2/nf-ole2-olecreateembeddinghelper).

При создании экземпляра обработчика для одного класса его нельзя использовать для другого. При использовании для составного документа обработчик OLE реализует структуры данных на стороне контейнера, когда доступ к объектам определенного класса осуществляется удаленно.

OLE заданный по умолчанию обработчик для клиентов составного документа локальных серверов. Обработчик по умолчанию реализовал ряд интерфейсов, которых нет на стандартном сервере. Когда OLE в дальнейшем позволяло обрабатывать составные документы на серверах, им пришлось создать вспомогательный модуль внедрения, который реализовал эти дополнительные интерфейсы, чтобы клиенты могли беспрепятственно работать с ними.

Конструкторы платформы, которые определяют и реализуют обработчик на стороне клиента, должны учитывать эту ошибку в своем проекте и должны предоставлять эквивалентный внутрипроцессный вспомогательный метод по тем же причинам. Даже если конструкторы не реализуют интерфейсы в обработчике, который не предоставляет серверы, им может потребоваться определить вспомогательную функцию, чтобы они могли добавлять их в будущем. Кроме того, можно реализовать дополнительные интерфейсы для самого объекта сервера.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Упрощенный обработчик Client-Side](the-lightweight-client-side-handler.md)
</dt> </dl>

 

 




