---
title: Интерактивный пользователь
description: Интерактивным пользователем является пользователь, который в данный момент вошел в систему на компьютере, где работает сервер COM.
ms.assetid: 6d43842c-0ad1-4563-b50c-5024bda480f1
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d7d842a468634da0eba31b04317b66185b298fc5a2e44d3567f796dac52dbdc7
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119992734"
---
# <a name="interactive-user"></a>Интерактивный пользователь

*Интерактивным пользователем* является пользователь, который в данный момент вошел в систему на компьютере, где работает сервер COM. Если удостоверение настроено как интерактивный пользователь, все клиенты используют один и тот же экземпляр сервера, если сервер регистрирует свою фабрику класса в качестве многофакторного использования. Если ни один пользователь не вошел в систему, сервер не будет работать. Если сервер имеет графический интерфейс пользователя (GUI), который должен видеть клиент, следует использовать для удостоверения сервера интерактивный пользователь. Однако при выборе этого удостоверения происходит ряд угроз безопасности, так как сервер работает с удостоверением вошедшего в систему пользователя без ведома пользователя или его согласия. Кроме того, приложение службы не может отображать пользовательский интерфейс. Дополнительные сведения см. в разделе [Интерактивные службы](/windows/desktop/Services/interactive-services).

Если сервер COM настроен для работы в качестве интерактивного пользователя, в среде служб терминалов сервер будет запущен в интерактивном сеансе, который соответствует удостоверению пользователя клиента. Однако клиентское приложение может использовать моникер сеанса для ссылки на объект, предоставленный сервером в сеансе, который не соответствует удостоверению клиента. При использовании этого приложения клиентское приложение может указать любой сеанс, в этом случае сервер будет работать от имени пользователя, владеющего сеансом, а не запускающего пользователя. Разрешения на доступ по умолчанию в этом сценарии не позволяют запускающему пользователю вызывать методы на сервере. Однако остаются следующие риски безопасности:

-   Если COM-сервер предоставляет интерфейсы, которые не управляются COM, например TCP-порты, именованные каналы, порты LPC, разделы общей памяти и т. д., они могут использоваться запускающими пользователями для влияния на сервер. Объекты COM, настроенные для запуска от имени интерактивного пользователя, должны максимально сократить эту зону атак.
-   Объекты COM свободны для установки собственных разрешений на доступ. Если объект задает разрешения на доступ, либо в его регистрации AppID, либо путем вызова [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity), чтобы разрешить запуск пользовательского доступа, пользователь сможет запустить сервер для запуска от имени другого пользователя, а затем получить доступ к объекту.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Служба удостоверений приложения](application-identity.md)
</dt> <dt>

[Запуск пользователя](launching-user.md)
</dt> <dt>

[Удостоверение службы](service-identity.md)
</dt> <dt>

[Указанный пользователь](specified-user.md)
</dt> </dl>

 

 