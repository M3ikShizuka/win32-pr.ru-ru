---
title: Уровни олицетворения (COM)
description: Если олицетворение завершилось успешно, это означает, что клиент принял согласие на то, чтобы сервер был клиентом в некоторой степени.
ms.assetid: 7539bbee-063f-4788-aece-7b70684826c8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 85286e5fa880ea7620d6f6ccb6107bf139ec2005
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "103891101"
---
# <a name="impersonation-levels"></a>Уровни олицетворения

Если олицетворение завершилось успешно, это означает, что клиент принял согласие на то, чтобы сервер был клиентом в некоторой степени. Различные степени олицетворения называются *уровнями олицетворения*, и они указывают, сколько полномочий предоставляется серверу при олицетворении клиента.

В настоящее время существует четыре уровня олицетворения: *анонимные*, *выявление*, *олицетворение* и *Делегирование*. В следующем списке кратко описан каждый уровень олицетворения.

<dl> <dt>

<span id="anonymous__RPC_C_IMP_LEVEL_ANONYMOUS_"></span><span id="anonymous__rpc_c_imp_level_anonymous_"></span><span id="ANONYMOUS__RPC_C_IMP_LEVEL_ANONYMOUS_"></span>Анонимный ( \_ \_ \_ Анонимный уровень RPC C \_ )
</dt> <dd>

Клиент анонимен по отношению к серверу. Серверный процесс может олицетворять клиента, но маркер олицетворения не содержит никакой информации о клиенте. Этот уровень поддерживается только для локального межпроцессного транспорта взаимодействия. Все остальные транспорты продают автоматическую роль этого уровня для распознавания.

</dd> <dt>

<span id="identify__RPC_C_IMP_LEVEL_IDENTIFY_"></span><span id="identify__rpc_c_imp_level_identify_"></span><span id="IDENTIFY__RPC_C_IMP_LEVEL_IDENTIFY_"></span>Identify ( \_ Обнаружение на \_ \_ уровне \_ идентификаторов RPC C)
</dt> <dd>

Уровень, установленный в системе по умолчанию. Сервер может получать удостоверение клиента и олицетворять клиента, чтобы производить проверки списка управления доступом (ACL).

</dd> <dt>

<span id="impersonate__RPC_C_IMP_LEVEL_IMPERSONATE_"></span><span id="impersonate__rpc_c_imp_level_impersonate_"></span><span id="IMPERSONATE__RPC_C_IMP_LEVEL_IMPERSONATE_"></span>олицетворять ( \_ \_ \_ олицетворение на уровне RPC C \_ )
</dt> <dd>

Сервер может олицетворять контекст безопасности клиента, пока действует от его лица. Сервер может получать доступ к локальным ресурсам в качестве клиента. Если сервер является локальным, он может получить доступ к сетевым ресурсам в качестве клиента. Если сервер является удаленным, он может получить доступ только к тем ресурсам, которые находятся на том же компьютере, что и сервер.

</dd> <dt>

<span id="delegate__RPC_C_IMP_LEVEL_DELEGATE_"></span><span id="delegate__rpc_c_imp_level_delegate_"></span><span id="DELEGATE__RPC_C_IMP_LEVEL_DELEGATE_"></span>Delegate ( \_ \_ делегат уровня Imp RPC C \_ \_ )
</dt> <dd>

Самый высокий уровень олицетворения. Когда выбран этот уровень, сервер (локальный или удаленный) может олицетворять контекст безопасности клиента, пока действует от его лица. Во время олицетворения учетные данные клиента (как локальных, так и сетевых) могут быть переданы на любое количество компьютеров.

Чтобы олицетворение работало на уровне делегата, должны выполняться следующие требования.

-   Клиент должен задать уровень олицетворения \_ \_ \_ делегата уровня "RPC C" \_ .
-   Учетная запись клиента не должна быть помечена как "учетная запись является конфиденциальной и не может быть делегирована" в службе Active Directory.
-   Учетная запись сервера должна быть помечена атрибутом "доверенный для делегирования" в службе Active Directory.
-   Компьютеры, на которых размещается клиент, сервер и все нижестоящие серверы, должны работать в домене.

</dd> </dl>

Выбирая уровень олицетворения, клиент сообщает серверу, насколько далеко он может пройти через олицетворение клиента. Клиент устанавливает уровень олицетворения для прокси-сервера, который он использует для взаимодействия с сервером.

## <a name="setting-the-impersonation-level"></a>Установка уровня олицетворения

Задать уровень олицетворения можно двумя способами:

-   Клиент может задать процессвиде с помощью вызова [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity).
-   Клиент может установить безопасность на уровне прокси-сервера для интерфейса удаленного объекта с помощью вызова [**иклиентсекурити:: сетбланкет**](/windows/win32/api/objidl/nf-objidl-iclientsecurity-setblanket) (или вспомогательной функции [**CoSetProxyBlanket**](/windows/desktop/api/combaseapi/nf-combaseapi-cosetproxyblanket)).

Уровень олицетворения задается путем передачи соответствующего значения "The RPC \_ C \_ "-Imp \_ \_ "XXX" в [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) или [**CoSetProxyBlanket**](/windows/desktop/api/combaseapi/nf-combaseapi-cosetproxyblanket) с помощью параметра *двимплевел* .

Разные службы проверки подлинности поддерживают олицетворение на уровне делегата в различных экстентах. Например, поставщик NTLMSSP поддерживает олицетворение на уровне делегата между потоками и между процессами, но не между компьютерами. С другой стороны, протокол Kerberos поддерживает олицетворение на уровне делегата на границах компьютеров, а SChannel не поддерживает олицетворение на уровне делегата. Если у вас есть прокси-сервер на уровне олицетворения, и вы хотите задать для уровня олицетворения значение Delegate, следует вызвать [**сетбланкет**](/windows/win32/api/objidl/nf-objidl-iclientsecurity-setblanket) , используя константы по умолчанию для каждого параметра, кроме уровня олицетворения. COM выберет NTLM локально и протокол Kerberos удаленно (когда будет работать протокол Kerberos).

## <a name="related-topics"></a>См. также

<dl> <dt>

[Делегирование и олицетворение](delegation-and-impersonation.md)
</dt> </dl>

 

 