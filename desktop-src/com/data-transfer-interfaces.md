---
title: Интерфейсы Передача данных
description: Интерфейсы Передача данных
ms.assetid: c42e65a4-7b77-4f39-8323-04fa60c5b140
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 63bffa72f2e6bd408cbb7f19121aeef991e74702ff1141b24aba779e6985585c
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119896344"
---
# <a name="data-transfer-interfaces"></a>Интерфейсы Передача данных

Интерфейс [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) предоставляет потребителям данных методы для получения и установки данных объекта, определения форматов, поддерживаемых объектом, и регистрации и получения уведомлений при изменении данных в объекте. При получении данных вызывающий объект может указать формат, в котором они хотят визуализировать данные. Однако источник данных определяет среду хранения, которая возвращается в параметре out, предоставленном вызывающим объектом.

по себе, интерфейс [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) предоставляет все средства, необходимые для реализации Windows переносов буфера обмена или передачи составных документов в приложениях. Если также требуется поддержка перетаскивания, необходимо реализовать интерфейсы [**идропсаурце**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource) и [**интерфейс IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget) вместе с интерфейсом **IDataObject**.

интерфейс [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) , объединенный с api-интерфейсами буфера обмена OLE, предоставляет все возможности интерфейсов api Windows clipboard. Обычно не требуется использовать оба интерфейса API буфера обмена. Поставщики данных, поддерживающие операции перетаскивания или составные документы OLE, должны реализовать интерфейс **IDataObject** . Если приложение поддерживает только переносы в буфер обмена, но вы собираетесь добавлять и удалять или составные документы в более поздних выпусках, вам может потребоваться реализовать интерфейс **IDataObject** и API-интерфейсы буфера обмена OLE, чтобы свести к минимальному количеству времени, затрачиваемого на перекодирование и последующий процесс отладки. Также можно реализовать интерфейс **IDataObject** , чтобы использовать носитель для передачи, отличный от глобальной памяти.

В следующей таблице приводятся сводные сведения о том, какие из них следует использовать, в зависимости от типов данных, которые требуется поддерживать.



| Для поддержки                                                                       | Назначение                                                                                                                                                                         |
|----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Составные документы<br/>                                                    | [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)<br/>                                                                                                                               |
| Перетаскивание передач<br/>                                               | [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject), [**идропсаурце**](/windows/desktop/api/OleIdl/nn-oleidl-idropsource), [**интерфейс IDropTarget**](/windows/desktop/api/OleIdl/nn-oleidl-idroptarget), [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) (или эквивалент)<br/> |
| Передача из буфера обмена с монопольным использованием глобальной памяти<br/>                   | [API буфера обмена](../dataxchg/clipboard.md)<br/>                                                                                                                            |
| Передача из буфера обмена с использованием носителей Exchange, отличных от глобальной памяти.<br/>  | [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)<br/>                                                                                                                               |
| Буфер обмена переносится сейчас, но перетаскивание или составные документы появятся позже<br/> | Интерфейс [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) и указанные выше интерфейсы и функции для "перетаскивания передач"<br/>                                                    |



 

Когда пользователь инициирует операцию обмена данными, исходное приложение создает экземпляр [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) и делает данные доступными в одном или нескольких форматах. При передаче в буфер обмена приложение вызывает функцию [**олесетклипбоард**](/windows/desktop/api/Ole2/nf-ole2-olesetclipboard) , чтобы передать указатель на объект данных в OLE. (**Олесетклипбоард** также предлагает стандартные форматы данных буфера обмена для приложений OLE версии 1 и не OLE.) При перемещении перетаскивания приложение вызывает функцию [**DoDragDrop**](/windows/desktop/api/Ole2/nf-ole2-dodragdrop) .

На принимающей стороне переноса назначение получает указатель [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) либо в качестве аргумента для вызова [**интерфейс IDropTarget::D верхнем**](/windows/desktop/api/OleIdl/nf-oleidl-idroptarget-drop) , либо путем вызова функции [**олесетклипбоард**](/windows/desktop/api/Ole2/nf-ole2-olesetclipboard) в зависимости от способа перемещения — с помощью перетаскивания или буфера обмена. Получая этот указатель, назначение вызывает [**IDataObject:: енумформатетк**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc) , чтобы узнать, какие форматы доступны для извлечения и для каких типов носителей они могут быть получены. Получив эти сведения, получающее приложение запрашивает данные с помощью вызова функции [**IDataObject:: GetData**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-getdata).

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Передача данных](data-transfer.md)
</dt> </dl>

 

