---
title: Улучшения безопасности DCOM в Windows XP с пакетом обновления 2 и Windows Server 2003 с пакетом обновления 1 (SP1)
description: Windows Server XP с пакетом обновления 2 (SP2) и Windows Server 2003 с пакетом обновления 1 (SP1) предоставляют расширенные параметры безопасности по умолчанию для модели DCOM.
ms.assetid: 1917834c-5216-4ef3-a0c2-d8ca63cef53d
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e4ad51807e27a9b97e8b05e467d8a84881c3993a
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "104134642"
---
# <a name="dcom-security-enhancements-in-windows-xp-service-pack-2-and-windows-server-2003-service-pack-1"></a>Улучшения безопасности DCOM в Windows XP с пакетом обновления 2 и Windows Server 2003 с пакетом обновления 1 (SP1)

Windows Server XP с пакетом обновления 2 (SP2) и Windows Server 2003 с пакетом обновления 1 (SP1) предоставляют расширенные параметры безопасности по умолчанию для модели DCOM. В частности, они предоставляют более детализированные права, позволяющие администратору иметь независимый контроль над локальными и удаленными разрешениями для запуска, активации и доступа к COM-серверам.

## <a name="what-does-dcom-do"></a>Что делает DCOM?

Модель COM — это независимая от платформы, распределенная объектно-ориентированная система для создания двоичных компонентов программного обеспечения, которые могут взаимодействовать. Распределенная модель объектов (DCOM) позволяет распределять приложения по расположениям, которые наиболее эффективно подходят вам и к приложению. Протокол связи DCOM прозрачно обеспечивает поддержку надежного, безопасного и эффективного взаимодействия между компонентами COM.

## <a name="who-does-this-feature-apply-to"></a>К кому относится эта функция?

Если COM используется только для внутрипроцессного COM-компонентов, эта функция не применяется к вам.

Эта функция применима к вам при наличии серверного приложения COM, которое соответствует одному из следующих критериев:

-   Разрешение на доступ к приложению менее строго, чем разрешение на запуск, необходимое для запуска приложения.
-   Приложение обычно активируется удаленным клиентом COM без использования учетной записи администратора.
-   Приложение предназначено только для локального использования. Это означает, что вы можете ограничить приложение COM-сервера таким образом, чтобы оно не было доступно для удаленного доступа.

## <a name="what-new-functionality-is-added-to-this-feature-in-windows-xp-service-pack-2-and-windows-server-2003-service-pack-1"></a>Какие новые функции добавляются в эту функцию в Windows XP с пакетом обновления 2 (SP2) и Windows Server 2003 с пакетом обновления 1 (SP1)?

### <a name="computer-wide-restrictions"></a>Ограничения на уровне компьютера

В модели COM было внесено изменение, обеспечивающее управление доступом на уровне компьютера, которое управляет доступом ко всем вызовам, активации или запуску запросов на компьютере. Самый простой способ подумать об этих элементах управления доступом — это дополнительный вызов [**AccessCheck**](/windows/desktop/api/securitybaseapi/nf-securitybaseapi-accesscheck) , который выполняется для списка управления доступом (ACL) на уровне компьютера при каждом вызове, активации или запуске любого сервера COM на компьютере. В случае сбоя **AccessCheck** запрос на вызов, активацию или запуск отклоняется. Это дополнение к выполнению **AccessCheck** , которое выполняется для списков ACL, связанных с сервером. Фактически, он предоставляет минимальный стандарт авторизации, который должен быть передан для доступа к любому серверу COM на компьютере. Список управления доступом на уровне компьютера для запуска разрешений на запуск и запуск, а так же список управления доступом на уровне компьютера для разрешения на доступ для покрытия прав вызова. Их можно настроить с помощью консоли управления (MMC) службы компонентов.

Эти списки управления доступом на уровне компьютера позволяют переопределять слабые параметры безопасности, заданные конкретным приложением, с помощью [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) или параметров безопасности конкретного приложения. Это обеспечивает минимальный стандарт безопасности, который необходимо передать, независимо от параметров конкретного сервера.

Эти списки ACL проверяются при обращении к интерфейсам, предоставляемым службами RPCSS. Это предоставляет метод для управления доступом к этой системной службе.

Эти списки ACL обеспечивают централизованное расположение, в котором администратор может задать общую политику авторизации, которая применяется ко всем COM-серверам на компьютере.

> [!Note]  
> Изменение параметров безопасности на уровне компьютера повлияет на все серверные приложения COM и может препятствовать их правильной работе. Если существуют приложения COM-сервера с ограничениями, которые менее строгими по сравнению с ограничениями на уровне компьютера, уменьшение ограничений на уровне компьютера может предоставить этим приложениям нежелательный доступ. И наоборот, при увеличении ограничений на уровне компьютера некоторые серверные приложения COM могут быть недоступны при вызове приложений.

 

По умолчанию Windows XP с пакетом обновления 2 (SP2) имеет следующие параметры:



| Разрешение        | Администратор                                                                                             | Все                                            | Анонимные               |
|-------------------|-----------------------------------------------------------------------------------------------------------|-----------------------------------------------------|-------------------------|
| Launch<br/> | Локальный запуск<br/> Локальная активация<br/> Удаленный запуск<br/> Удаленная активация<br/> | Локальный запуск<br/> Локальная активация<br/> |                         |
| Access<br/> |                                                                                                           | Локальный доступ<br/> Удаленный доступ<br/>    | Локальный доступ<br/> |



 

По умолчанию параметры ограничений для компьютеров с пакетом обновления 1 (SP1) для Windows Server 2003 приведены ниже.



| Разрешение        | Администратор                                                                                             | Распределенные пользователи COM (встроенная группа)                                                                    | Все                                            | Анонимные                                        |
|-------------------|-----------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------|-----------------------------------------------------|--------------------------------------------------|
| Launch<br/> | Локальный запуск<br/> Локальная активация<br/> Удаленный запуск<br/> Удаленная активация<br/> | Локальный запуск<br/> Локальная активация<br/> Удаленный запуск<br/> Удаленная активация<br/> | Локальный запуск<br/> Локальная активация<br/> | Н/Д<br/>                                   |
| Access<br/> | Н/Д<br/>                                                                                            | Локальный доступ<br/> Удаленный доступ<br/>                                                          | Локальный доступ<br/> Удаленный доступ<br/>    | Локальный доступ<br/> Удаленный доступ<br/> |



 

> [!Note]  
> Распределенные пользователи COM — это новая встроенная группа, входящая в состав Windows Server 2003 с пакетом обновления 1 (SP1), для ускорения процесса добавления пользователей в параметры ограничений компьютера DCOM. Эта группа входит в список ACL, используемый параметрами [мачинеакцессрестриктион](machineaccessrestriction.md) и [мачинелаунчрестриктион](machinelaunchrestriction.md) , поэтому удаление пользователей из этой группы повлияет на эти параметры.

 

### <a name="why-is-this-change-important-what-threats-does-it-help-mitigate"></a>Почему это изменение важно? Какие угрозы помогают решить эту проблемы?

Многие приложения COM включают в себя некоторый код, зависящий от безопасности (например, вызов [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity)), но при этом используются слабые параметры, которые часто допускают несанкционированный доступ к процессу. В настоящее время администратор не может переопределить эти параметры, чтобы обеспечить более высокий уровень безопасности в более ранних версиях Windows.

Инфраструктура COM включает в себя службы RPCSS, системную службу, которая выполняется во время запуска системы и всегда выполняется после этого. Он управляет активацией COM-объектов и выполняемой таблицы объектов и предоставляет вспомогательные службы для удаленного взаимодействия DCOM. Он предоставляет интерфейсы RPC, которые могут быть вызваны удаленно. Поскольку некоторые COM-серверы допускают удаленный доступ без проверки подлинности, эти интерфейсы могут быть вызваны любым пользователем, включая пользователей, не прошедших проверку подлинности. В результате злоумышленники могут атаковать вредоносные пользователи на удаленных компьютерах, не прошедших проверку подлинности.

В более ранних версиях Windows администратор не имел возможности понять уровень выдержки серверов COM на компьютере. Администратор получил представление об уровне доступности, систематически проверяя настроенные параметры безопасности для всех зарегистрированных приложений COM на компьютере, но при этом при установке Windows по умолчанию существует около 150 серверов COM. Эта задача была сложной задачей. Не существовало способа просмотреть параметры для сервера, который включает в себя безопасность в программном обеспечении, что позволяет проанализировать исходный код этого программного обеспечения.

Ограничения на уровне компьютера DCOM снижают эти три проблемы. Он также дает администратору возможность отключить входящую активацию, запуск и вызовы DCOM.

### <a name="what-works-differently"></a>Что работает иначе?

По умолчанию группе «все» предоставляются разрешения локального запуска, локальной активации и локального доступа. Это позволяет всем локальным сценариям работать без изменений в программном обеспечении или операционной системе.

По умолчанию в Windows XP с пакетом обновления 2 (SP2) группе Everyone предоставляются разрешения на вызов удаленного доступа. В Windows Server 2003 с пакетом обновления 1 (SP1) всем и анонимным группам предоставляются разрешения на удаленный доступ. Это позволяет выполнять большинство сценариев клиентов COM, в том числе общий случай, когда клиент COM передает локальную ссылку на удаленный сервер, фактически переключая клиент на сервер. В Windows XP SP2 это может привести к отключению сценариев, требующих вызовов удаленного доступа без проверки подлинности.

Кроме того, по умолчанию разрешения на удаленную активацию и запуск предоставляются только членам группы «Администраторы». Это отключает удаленную активацию без прав администратора для установленных серверов COM.

### <a name="how-do-i-resolve-these-issues"></a>Разделы справки устранить эти проблемы?

Если вы реализуете сервер COM и планируете поддерживать удаленную активацию с помощью неадминистративного COM-клиента, то следует подумать о том, является ли риск, связанный с включением этого процесса, приемлемым, или необходимо изменить свою реализацию, чтобы не требовать удаленной активации с помощью неадминистративного COM-клиента или удаленных вызовов без проверки подлинности.

Если риск является приемлемым и вы хотите включить удаленную активацию неадминистративным клиентом COM или удаленными вызовами без проверки подлинности, необходимо изменить конфигурацию по умолчанию для этой функции.

> [!Note]  
> Изменение параметров безопасности на уровне компьютера повлияет на все серверные приложения COM и может препятствовать их правильной работе. Если существуют приложения COM-сервера с ограничениями, которые менее строгими по сравнению с ограничениями на уровне компьютера, уменьшение ограничений на уровне компьютера может предоставить этим приложениям нежелательный доступ. И наоборот, при увеличении ограничений на уровне компьютера некоторые серверные приложения COM могут быть недоступны при вызове приложений.

 

Параметры конфигурации можно изменить с помощью консоли управления (MMC) службы компонентов или реестра Windows.

При использовании оснастки MMC "службы компонентов" эти параметры можно настроить на вкладке " **Безопасность COM** " диалогового окна " **свойства** " для управляемого компьютера. Область **прав доступа** изменена, чтобы можно было установить ограничения на уровне компьютера в дополнение к стандартным параметрам по умолчанию для серверов COM. Кроме того, можно указать отдельные параметры ACL для локального и удаленного доступа в соответствии с ограничениями и по умолчанию.

В области **разрешения на запуск и активацию** можно управлять локальными и удаленными разрешениями, а также ограничения на уровне компьютера и значения по умолчанию. Можно указать как локальную, так и удаленную активацию и разрешения на запуск независимо.

Кроме того, эти параметры ACL можно настроить с помощью реестра.

Эти списки ACL хранятся в реестре в следующих расположениях:

``` syntax
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Ole\MachineAccessRestriction=ACL
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Ole\MachineLaunchRestriction=ACL
```

Это именованные значения \_ двоичного файла с типом reg, которые содержат данные, описывающие список управления доступом для участников, которые могут обращаться к любому COM-классу или COM-объекту на компьютере. Права доступа в списке ACL:

``` syntax
COM_RIGHTS_EXECUTE 1
COM_RIGHTS_EXECUTE_LOCAL 2
COM_RIGHTS_EXECUTE_REMOTE 4
COM_RIGHTS_ACTIVATE_LOCAL 8
COM_RIGHTS_ACTIVATE_REMOTE 16
```

Эти списки ACL можно создавать с помощью обычных функций безопасности.

> [!Note]  
> Чтобы обеспечить обратную совместимость, список ACL может существовать в формате, который используется до выхода Windows XP SP2 и Windows Server 2003 с пакетом обновления 1 (SP1). которая использует только права доступа COM right \_ \_ или может существовать в новом формате, используемом в Windows XP с пакетом обновления 2 (SP2) и windows Server 2003 с пакетом обновления 1 (SP1), который использует права com с использованием локальной службы COM-права \_ \_ , выполняет удаленный доступ \_ \_ \_ \_ \_ \_ , COM- \_ права \_ активировать \_ локальную службу, а права com — \_ \_ активировать \_ удаленно. Обратите внимание, что \_ \_ всегда должен присутствовать> выполнения прав com. отсутствие этого права создает недопустимый дескриптор безопасности. Также обратите внимание, что не следует смешивать старый формат и новый формат в одном списке ACL; либо все записи контроля доступа (ACE) должны предоставлять только право на \_ \_ выполнение прав доступа COM, либо все они должны ПРЕДОСТАВЛЯТЬ \_ права com \_ в сочетании с правами com, выполнять удаленное выполнение, права com на удаленный доступ, \_ \_ \_ \_ \_ \_ \_ \_ \_ а также \_ активировать права com \_ \_ .

 

> [!Note]  
> Только пользователи с правами администратора могут изменять эти параметры.

 

## <a name="what-existing-functionality-is-changing-in-windows-xp-service-pack-2-and-windows-server-2003-service-pack-1"></a>Какие существующие функции меняются в Windows XP с пакетом обновления 2 и Windows Server 2003 с пакетом обновлений 1?

### <a name="rpcss-runs-as-a-network-service"></a>Службы RPCSS работают как сетевая служба

Службы удаленных вызовов (RPC) являются ключевой службой для сопоставителя конечных точек RPC и инфраструктуры DCOM. Эта служба была запущена в предыдущих версиях Windows в качестве локальной системы. Чтобы сократить область атак Windows и обеспечить глубокую защиту, функциональность службы RPCSS была разделена на две службы. Служба RPCSS со всеми исходными функциями, не требующими привилегий локальной системы, теперь работает под учетной записью сетевой службы. Новая служба Дкомлаунч, которая включает в себя функции, для которых требуются права локальной системы под локальной системной учетной записью.

### <a name="why-is-this-change-important"></a>Почему это изменение важно?

Это изменение сокращает область атаки и обеспечивает глубокую защиту для службы RPCSS, поскольку повышение привилегий в службе RPCSS теперь ограничено правами сетевой службы.

### <a name="what-works-differently"></a>Что работает иначе?

Это изменение должно быть прозрачным для пользователей, так как сочетание RPCSS и Дкомлаунч Services эквивалентно предыдущим службам RPCSS, предоставленным в предыдущих версиях Windows.

### <a name="more-specific-com-permissions"></a>Более конкретные разрешения COM

Серверные приложения COM имеют два типа разрешений: разрешения на запуск и разрешения на доступ. Запустить авторизацию управления разрешениями для запуска COM-сервера во время активации COM, если сервер еще не запущен. Эти разрешения определяются как дескрипторы безопасности, указанные в параметрах реестра. Разрешения на доступ контролируют авторизацию для вызова работающего сервера COM. Эти разрешения определяются как дескрипторы безопасности, предоставляемые инфраструктуре COM через API [**CoInitializeSecurity**](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializesecurity) , или с помощью параметров реестра. Разрешения на запуск и на доступ разрешают или запрещают доступ на основе участников и не отличаются от того, является ли вызывающий объект локальным по отношению к серверу или удаленному.

Первое изменение отличает права доступа COM на основе расстояния. Два расстояния определяются как локальные и удаленные. Локальное COM-сообщение поступает с помощью локального протокола удаленного вызова процедур (ЛРПК), а удаленное COM-сообщение поступает с помощью протокола узла удаленного вызова процедур (RPC), например протокола управления передачей (TCP).

Активация COM — это процесс получения прокси-сервера интерфейса COM на клиенте путем вызова [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) или одного из его вариантов. В качестве побочного результата этого процесса активации иногда для выполнения запроса клиента необходимо запустить COM-сервер. Список ACL разрешений на запуск утверждает, кому разрешено запускать сервер COM. Список ACL разрешений доступа утверждает, кто может активировать COM-объект, или вызвать этот объект после того, как сервер COM уже запущен.

Второе изменение заключается в том, что права на вызов и активацию разделены на две различные операции и перемещение прав на активацию из ACL разрешений доступа к списку ACL разрешения на запуск. Поскольку Активация и запуск связаны с получением указателя на интерфейс, права доступа на активацию и запуск логически входят в один список ACL. Так как вы всегда указываете разрешения на запуск через конфигурацию (по сравнению с разрешениями на доступ, которые часто задаются программно), размещение прав на активацию в списке ACL разрешения на запуск предоставляет администратору контроль над активацией.

Записи управления доступом (ACE) для запуска разбиваются на четыре права доступа:

-   Локальный запуск (LL)
-   Удаленный запуск (RL)
-   Локальная активация (ла)
-   Удаленная активация (RA)

Дескриптор безопасности разрешений доступа разбивается на две права доступа:

-   Вызовы локального доступа (LC)
-   Вызовы удаленного доступа (RC)

Это позволяет администратору применять специфические конфигурации безопасности. Например, можно настроить сервер COM таким образом, чтобы он принимал вызовы локального доступа от всех, в то время как принимать только вызовы удаленного доступа от администраторов. Эти различия можно указать с помощью изменений в дескрипторах безопасности разрешений COM.

### <a name="why-is-this-change-important-what-threats-does-it-help-mitigate"></a>Почему это изменение важно? Какие угрозы помогают решить эту проблемы?

Более ранние версии серверного приложения COM не имеют возможности ограничить приложение, чтобы его можно было использовать только локально без предоставления доступа к приложению по сети с помощью DCOM. Когда пользователь имеет доступ к серверному приложению COM, у него есть доступ как для локального, так и для удаленного использования.

Серверное приложение COM может предоставлять себя пользователям, не прошедшим проверку подлинности, для реализации сценария обратного вызова COM. В этом сценарии приложение также должно предоставлять свою активацию пользователям, не прошедшим проверку подлинности, что может быть нежелательным.

Точные разрешения COM предоставляют администратору возможность управлять политикой разрешений на компьютере COM. Эти разрешения обеспечивают безопасность для описанных сценариев.

### <a name="what-works-differently-are-there-any-dependencies"></a>Что работает иначе? Существуют ли зависимости?

Для обеспечения обратной совместимости существующие дескрипторы безопасности COM обрабатываются для разрешения или запрета одновременного локального и удаленного доступа. То есть запись управления доступом (ACE) разрешает как локальные, так и удаленные, либо запрещает как локальные, так и удаленные.

Отсутствуют проблемы обратной совместимости для вызова или прав на запуск. Однако есть проблемы с совместимостью прав на активацию. Если в существующих дескрипторах безопасности для сервера COM настроенные разрешения на запуск являются более ограниченными, чем разрешения на доступ, и более ограниченны, чем минимальные требования к сценариям активации клиента, необходимо изменить список ACL разрешений на запуск, чтобы предоставить полномочным клиентам соответствующие разрешения на активацию.

Для приложений COM, использующих параметры безопасности по умолчанию, проблемы совместимости отсутствуют. Для приложений, которые динамически запускаются с помощью активации COM, большинство не имеют проблем совместимости, так как разрешения на запуск уже должны включать всех, кто может активировать объект. В противном случае такие приложения создают ошибки активации даже перед применением Windows XP SP2 или Windows Server 2003 с пакетом обновления 1 (SP1), когда вызывающие объекты без разрешения на запуск пытаются активировать объект, а COM-сервер еще не запущен.

Наиболее важным фактором для проблем совместимости являются приложения COM, которые уже запущены другим механизмом, например проводником Windows или диспетчером управления службами. Эти приложения также можно запускать с помощью предыдущей активации COM, которая переопределяет разрешения на доступ и запуск по умолчанию и указывает разрешения на запуск, которые являются более узкими, чем разрешения на вызов. Дополнительные сведения об устранении этой проблемы совместимости см. в разделе "Разделы справки устранить эти проблемы?". в следующем разделе.

Если система, обновленная до версии Windows XP SP2 или Windows Server 2003 с пакетом обновления 1 (SP1), откатывается к предыдущему состоянию, любые записи ACE, которые были изменены для разрешения локального доступа, удаленного доступа или и того, и другого, могут интерпретироваться как для локального, так и для удаленного доступа. Любой элемент ACE, который был изменен для запрета локального доступа, удаленного доступа или обоих этих элементов, интерпретируется для запрета как локального, так и удаленного доступа. При каждом удалении пакета обновления следует убедиться, что никакие новые записи ACE не приведут к прекращению работы приложений.

### <a name="how-do-i-resolve-these-issues"></a>Разделы справки устранить эти проблемы?

Если вы реализуете сервер COM и переопределяете параметры безопасности по умолчанию, убедитесь, что список управления доступом для конкретного приложения предоставляет разрешение на активацию соответствующим пользователям. Если это не так, необходимо изменить список управления доступом для конкретного приложения, чтобы предоставить соответствующим пользователям права на активацию, чтобы приложения и компоненты Windows, использующие DCOM, не завершались сбоем. Эти разрешения на запуск для конкретного приложения хранятся в реестре.

Списки ACL COM можно создавать или изменять с помощью обычных функций безопасности.

## <a name="what-settings-are-added-or-changed-in-windows-xp-service-pack-2"></a>Какие параметры добавляются или изменяются в Windows XP с пакетом обновления 2 (SP2)?

> [!Caution]  
> Неправильное использование этих параметров может привести к сбою в работе приложений и компонентов Windows, использующих DCOM.

 

В приведенной ниже таблице используются следующие аббревиатуры:

ВСЕ — локальный запуск

Активация на Ла-локальная

RL — удаленный запуск

RA — удаленная активация

АККРЕДИТИВ — вызовы локального доступа

RC — вызовы удаленного доступа

ACL — список управления доступом



| Имя параметра                                                                                         | Расположение                                                                                                       | Предыдущее значение по умолчанию                                                                                                                                                                     | Значение по умолчанию                                                                                                                                                                                                                                                                                                                                                             | Возможные значения                                                                                                                                                                                                              |
|------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **мачинелаунчрестриктион**<br/>                                                              | **HKEY \_ по для локального \_ компьютера, \\ \\ Microsoft \\ OLE**<br/>                                                 | Everyone — LL, Ла, RL, RA<br/> Подключившихся<br/> LL, ЛА, RL, RA<br/> (Это новый раздел реестра. В зависимости от существующего поведения это действующие значения.)<br/> | Администратор: LL, Ла, RL, RA<br/>                                                                                                                                                                                                                                                                                                                                  | СПИСКОМ<br/>                                                                                                                                                                                                               |
| **мачинеакцессрестриктион**<br/>                                                              | **HKEY \_ по для локального \_ компьютера, \\ \\ Microsoft \\ OLE**<br/>                                                 | Все — LC, RC<br/> Anonymous-LC, RC<br/> (Это новый раздел реестра. В зависимости от существующего поведения это действующие значения.)<br/>                            | Все: LC, RC<br/> Анонимный: LC<br/>                                                                                                                                                                                                                                                                                                                      | СПИСКОМ<br/>                                                                                                                                                                                                               |
| **каллфаилурелоггинглевел**<br/>                                                               | **HKEY \_ по для локального \_ компьютера, \\ \\ Microsoft \\ OLE**<br/>                                                 | Не применяется<br/>                                                                                                                                                                 | Этот раздел реестра отсутствует; Однако отсутствующий ключ или значение интерпретируется как 2.<br/> Это событие не регистрируется по умолчанию. Если изменить это значение на 1, чтобы начать запись в журнал этих сведений для устранения неполадок, следует следить за размером журнала событий, поскольку это событие может формировать большое количество записей.<br/> | 1 — всегда регистрировать ошибки журнала событий во время вызова в процессе COM-сервера.<br/> 2 — никогда не регистрировать ошибки журнала событий во время вызова в процессе сервера вызовов.<br/>                                                  |
| **инвалидсекуритидескрипторлоггинглевел**<br/>                                                 | **HKEY \_ по для локального \_ компьютера, \\ \\ Microsoft \\ OLE**<br/>                                                 | Не применяется<br/>                                                                                                                                                                 | Этот раздел реестра отсутствует; Однако отсутствующий ключ или значение интерпретируется как 1.<br/> Это событие регистрируется по умолчанию. Это должно происходить редко.<br/>                                                                                                                                                                                                    | 1 — всегда регистрировать ошибки журнала событий, когда инфраструктура COM находит недопустимый дескриптор безопасности.<br/> 2 — никогда не регистрировать ошибки журнала событий, когда инфраструктура COM находит недопустимый дескриптор безопасности.<br/> |
| DCOM: ограничения на запуск компьютера в синтаксисе языка определения дескрипторов безопасности (SDDL)<br/> | (Объект групповая политика) Конфигурация компьютера \\ Параметры Windows \\ Локальные политики \\ Параметры безопасности<br/>  | Не применяется<br/>                                                                                                                                                                 | Не определено<br/>                                                                                                                                                                                                                                                                                                                                                    | Список управления доступом в формате SDDL. Существование этой политики переопределяет значения в Мачинелаунчрестриктион, ранее.<br/>                                                                                            |
| DCOM: ограничения доступа к компьютеру в синтаксисе языка определения дескрипторов безопасности (SDDL)<br/> | (Объект групповая политика) Конфигурация компьютера \\ Параметры Windows \\ Локальные политики \\ Параметры безопасности<br/> | Не применяется<br/>                                                                                                                                                                 | Не определено<br/>                                                                                                                                                                                                                                                                                                                                                    | Список управления доступом в формате SDDL. Существование этой политики переопределяет значения в Мачинеакцессрестриктион, ранее.<br/>                                                                                            |



 

## <a name="what-settings-are-added-or-changed-in-windows-server-2003-service-pack-1"></a>Какие параметры добавляются или изменяются в Windows Server 2003 с пакетом обновления 1 (SP1)?

> [!Note]  
> Неправильное использование этих параметров может привести к сбою в работе приложений и компонентов Windows, использующих DCOM.

 

В приведенной ниже таблице используются следующие аббревиатуры:

ВСЕ — локальный запуск

Активация на Ла-локальная

RL — удаленный запуск

RA — удаленная активация

АККРЕДИТИВ — вызовы локального доступа

RC — вызовы удаленного доступа

ACL — список управления доступом



| Имя параметра                                                                                         | Расположение                                                                                                       | Предыдущее значение по умолчанию                                                                                                                                                             | Значение по умолчанию                                                                                                                                                                                                                                                                                                                                                             | Возможные значения                                                                                                                                                                                                              |
|------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **мачинелаунчрестриктион**<br/>                                                              | **HKEY \_ по для локального \_ компьютера, \\ \\ Microsoft \\ OLE**<br/>                                                 | Все: все, Ла, RL, RA<br/> Anonymous: LL, LA, RL, RA<br/> (Это новый раздел реестра. В зависимости от существующего поведения эти значения будут эффективными.)<br/> | Администратор: LL, Ла, RL, RA<br/> Все: все, Ла<br/> Распределенные пользователи COM: LL, LA, RL, RA<br/>                                                                                                                                                                                                                                                     | СПИСКОМ<br/>                                                                                                                                                                                                               |
| **мачинеакцессрестриктион**<br/>                                                              | **HKEY \_ по для локального \_ компьютера, \\ \\ Microsoft \\ OLE**<br/>                                                 | Все: LC, RC<br/> Anonymous: LC, RC<br/> (Это новый раздел реестра. В зависимости от существующего поведения эти значения будут эффективными.)<br/>                 | Все: LC, RC<br/> Anonymous: LC, RC<br/>                                                                                                                                                                                                                                                                                                                  | СПИСКОМ<br/>                                                                                                                                                                                                               |
| **каллфаилурелоггинглевел**<br/>                                                               | **HKEY \_ по для локального \_ компьютера, \\ \\ Microsoft \\ OLE**<br/>                                                 | Не применяется<br/>                                                                                                                                                         | Этот раздел реестра отсутствует; Однако отсутствующий ключ или значение интерпретируется как 2.<br/> Это событие не регистрируется по умолчанию. Если изменить это значение на 1, чтобы начать запись в журнал этих сведений для устранения неполадок, следует следить за размером журнала событий, поскольку это событие может формировать большое количество записей.<br/> | 1 — всегда регистрировать ошибки журнала событий, когда инфраструктура COM находит недопустимый дескриптор безопасности.<br/> 2 — никогда не регистрировать ошибки журнала событий, когда инфраструктура COM находит недопустимый дескриптор безопасности.<br/> |
| **инвалидсекуритидескрипторлоггинглевел**<br/>                                                 | **HKEY \_ по для локального \_ компьютера, \\ \\ Microsoft \\ OLE**<br/>                                                 | Не применяется<br/>                                                                                                                                                         | Этот раздел реестра отсутствует; Однако отсутствующий ключ или значение интерпретируется как 1.<br/> Это событие регистрируется по умолчанию. Это должно происходить редко.<br/>                                                                                                                                                                                                    | 1 — всегда регистрировать ошибки журнала событий, когда инфраструктура COM находит недопустимый дескриптор безопасности.<br/> 2 — никогда не регистрировать ошибки журнала событий, когда инфраструктура COM находит недопустимый дескриптор безопасности.<br/>         |
| DCOM: ограничения на запуск компьютера в синтаксисе языка определения дескрипторов безопасности (SDDL)<br/> | (Объект групповая политика) Конфигурация компьютера \\ Параметры Windows \\ Локальные политики \\ Параметры безопасности<br/> | Не применяется<br/>                                                                                                                                                         | Не определено.<br/>                                                                                                                                                                                                                                                                                                                                                   | Список управления доступом в формате SDDL. Существование этой политики переопределяет значения в Мачинелаунчрестриктион, ранее.<br/>                                                                                            |
| DCOM: ограничения доступа к компьютеру в синтаксисе языка определения дескрипторов безопасности (SDDL)<br/> | (Объект групповая политика) Конфигурация компьютера \\ Параметры Windows \\ Локальные политики \\ Параметры безопасности<br/> | Не применяется<br/>                                                                                                                                                         | Не определено.<br/>                                                                                                                                                                                                                                                                                                                                                   | Список управления доступом в формате SDDL. Существование этой политики переопределяет значения в Мачинеакцессрестриктион, ранее.<br/>                                                                                            |



 

## <a name="related-topics"></a>См. также

<dl> <dt>

[Безопасность в COM](security-in-com.md)
</dt> </dl>

 

