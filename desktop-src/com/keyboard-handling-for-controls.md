---
title: Обработка клавиатуры для элементов управления
description: Элемент управления реагирует на сочетания клавиш, чтобы конечный пользователь мог инициировать действия, выполняемые элементом управления.
ms.assetid: 59aca5cb-f109-49ee-897d-43610501f7f8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 26081d36c62b11163ceb8c41421ea0370d18b3ce9bf16be68e4e8a06a5f1a489
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "117736561"
---
# <a name="keyboard-handling-for-controls"></a>Обработка клавиатуры для элементов управления

Элемент управления реагирует на сочетания клавиш, чтобы конечный пользователь мог инициировать действия, выполняемые элементом управления. Контейнер управляет работой клавиатуры для всех его внедренных элементов управления. При работе с составными документами сочетания клавиш применяются только к текущему активному объекту. С помощью элементов управления был добавлен механизм, позволяющий элементу управления реагировать на назначенные ему сочетания клавиш, даже если он не активен в пользовательском интерфейсе.

Методы [**метод интерфейса IOleControl:: жетконтролинфо**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-getcontrolinfo) и [**метод интерфейса IOleControl:: OnMnemonic**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrol-onmnemonic) , а также метод [**IOleControlSite:: онконтролинфочанжед**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-oncontrolinfochanged) обрабатывали назначенные клавиши клавиатуры элемента управления. Структура [**контролинфо**](/windows/win32/api/ocidl/ns-ocidl-controlinfo) описывает назначенные сочетания клавиш для элемента управления, а флаги, передаваемые обратно с помощью метода **жетконтролинфо** , описывают поведение элементов управления с помощью клавиш Enter и ESC. Когда элемент управления изменяет свои назначенные клавиши, он вызывает **онконтролинфочанжед** , чтобы контейнер мог перезагрузить структуру при необходимости.

Если элемент управления активен в пользовательском интерфейсе, он также является элементом управления с фокусом. По мере активации и деактивации элементов управления между активными и активными состояниями пользовательского интерфейса элемент управления вызывает [**IOleControlSite:: onfocus**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-onfocus) , чтобы сообщить контейнеру об этих изменениях.

Кроме того, если элемент управления активен в пользовательском интерфейсе, он получит первый шанс обработать все нажатия клавиш. Чтобы предоставить контейнеру возможность обработать нажатие клавиши до элемента управления, элемент управления вызывает [**IOleControlSite:: TranslateAccelerator**](/windows/desktop/api/OCIdl/nf-ocidl-iolecontrolsite-translateaccelerator). Если контейнер не обрабатывает нажатие клавиш, элемент управления обрабатывает его.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Элементы управления ActiveX](activex-controls.md)
</dt> </dl>

 

 




