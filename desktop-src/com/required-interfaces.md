---
title: Требуемые интерфейсы (COM)
description: Сведения о интерфейсах контейнеров элементов управления ActiveX, которые могут или должны быть реализованы контейнерами элементов управления.
ms.assetid: ae238882-d0c9-4120-b8a8-001bf9559cfa
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 55015ee5837754c073d2590144687131c285bb80
ms.sourcegitcommit: 5d4e99f4c8f42f5f543e52cb9beb9fb13ec56c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/19/2021
ms.locfileid: "112407647"
---
# <a name="required-interfaces-com"></a>Требуемые интерфейсы (COM)

В таблице ниже перечислены интерфейсы контейнера элементов управления ActiveX, а также указаны необязательные интерфейсы, которые должны быть реализованы контейнерами элементов управления.



| Интерфейс                                                                      | Необходим?      | Комментарии                                                                                                                                                                                                                                                                                                                                                     |
|--------------------------------------------------------------------------------|----------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**иолеклиентсите**](/windows/desktop/api/OleIdl/nn-oleidl-ioleclientsite)<br/>                            | Да<br/> |                                                                                                                                                                                                                                                                                                                                                              |
| [**иадвисесинк**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink)<br/>                                  | Нет<br/>  | Только когда в контейнере (a) уведомления об изменении данных (элементы управления с [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject)), (b) отображаются уведомления об изменениях (элементы управления, которые не являются активными и имеют [**ивиевобжект**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject) или [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)) и (c) другие уведомления от элементов управления, действующие как стандартные внедренные объекты.<br/> |
| [**иолеинплацесите**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplacesite)<br/>                          | Да<br/> |                                                                                                                                                                                                                                                                                                                                                              |
| [**IOleControlSite**](/windows/desktop/api/OCIdl/nn-ocidl-iolecontrolsite)<br/>                          | Да<br/> |                                                                                                                                                                                                                                                                                                                                                              |
| [**иолеинплацефраме**](/windows/desktop/api/OleIdl/nn-oleidl-ioleinplaceframe)<br/>                        | Да<br/> |                                                                                                                                                                                                                                                                                                                                                              |
| [**иолеконтаинер**](/windows/desktop/api/OleIdl/nn-oleidl-iolecontainer)<br/>                              | Да<br/> | См. примечание 1<br/>                                                                                                                                                                                                                                                                                                                                        |
| **IDispatch** для внешних свойств<br/>                                | Да<br/> | См. Примечание 2 и [свойства окружения для элементов управления](ambient-properties-for-controls.md)<br/>                                                                                                                                                                                                                                                             |
| Управление наборами событий<br/>                                                  | Да<br/> | См. примечание 2<br/>                                                                                                                                                                                                                                                                                                                                        |
| [**исимплефрамесите**](/windows/desktop/api/OCIdl/nn-ocidl-isimpleframesite)<br/>                        | Нет<br/>  | [**Исимплефрамесите**](/windows/desktop/api/OCIdl/nn-ocidl-isimpleframesite) и поддержка вложенных простых фреймов является необязательной.<br/>                                                                                                                                                                                                                                                    |
| [ипропертинотифисинк](data-binding-through-ipropertynotifysink.md)<br/> | Нет<br/>  | Только для контейнеров, которые (a) имеют собственный пользовательский интерфейс редактирования свойств, который потребуется обновить каждый раз, когда элемент управления изменил свойство или (б) требуется управлять \[ [](/windows/desktop/Midl/requestedit) \] изменениями свойств рекуестедит и другими такими функциями привязки данных.<br/>                                                                            |
| [IErrorInfo](/windows/win32/api/oaidl/nn-oaidl-ierrorinfo)<br/>       | Да<br/> | Является обязательным, если контейнер поддерживает сдвоенные интерфейсы. См. Примечание 2.<br/>                                                                                                                                                                                                                                                                                      |
| [**IClassFactory2**](/windows/desktop/api/OCIdl/nn-ocidl-iclassfactory2)<br/>                            | Нет<br/>  | Настоятельно рекомендуется поддержка.<br/>                                                                                                                                                                                                                                                                                                                  |



 

1.  [**Иолеконтаинер**](/windows/desktop/api/OleIdl/nn-oleidl-iolecontainer) реализуется для документа или объекта формы (или соответствующего аналога), содержащего сайты контейнеров. Элементы управления используют **иолеконтаинер** для перехода к другим элементам управления в том же документе или форме.
2.  Поддержка сдвоенных интерфейсов не обязательна, но настоятельно рекомендуется. Написание контейнеров элементов управления ActiveX для использования преимуществ сдвоенных интерфейсов обеспечит лучшую производительность с помощью элементов управления, которые предлагают поддержку сдвоенных интерфейсов.

Контейнеры элементов управления ActiveX должны поддерживать исключения OLE Automation. Если контейнер элемента управления поддерживает сдвоенные интерфейсы, он должен собирать исключения автоматизации с помощью [IErrorInfo](/windows/win32/api/oaidl/nn-oaidl-ierrorinfo).

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Контейнеры](containers.md)
</dt> </dl>

 

