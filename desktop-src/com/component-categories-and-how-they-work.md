---
title: Категории компонентов и принципы их работы
description: Категории компонентов и принципы их работы
ms.assetid: efbf4a25-3c73-4d09-a172-6676c6d6501b
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ddfd5580e12ce3d4a44ca251142e29f6eea8f9f5823cf18999f876a4ef732d09
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "117737021"
---
# <a name="component-categories-and-how-they-work"></a>Категории компонентов и принципы их работы

Категории компонентов определяют области функциональных возможностей, поддерживаемых и необходимых компонентом программного обеспечения, для каждой категории или определенной области функциональности используется запись реестра. Каждая категория компонента определяется глобальным уникальным идентификатором (GUID). при установке элемента управления он регистрируется как элемент управления в системном реестре, используя идентификатор категории компонента для управления, см. раздел [самостоятельная регистрация для элементов](self-registration-for-controls.md)управления. В рамках самостоятельной регистрации будут также зарегистрированы реализуемые им категории компонентов и категории компонентов, для которых требуется контейнер для поддержки, чтобы успешно разместить элемент управления.

Когда контейнер элемента управления предоставляет пользователям элементы управления для вставки, он позволяет пользователю выбирать и создавать экземпляры этих элементов управления, которые смогут адекватно работать в этой среде. Например, если контейнер элемента управления не поддерживает привязку данных, то он не позволит пользователю выбирать и создавать экземпляры этих элементов управления с записью в реестре, что означает, что им требуется категория компонента привязки данных. Доступно обычное диалоговое окно для вставки элементов управления и интерфейсов API для работы с записями реестра.

Категории компонентов не являются кумулятивными или эксклюзивными, для работы элемента управления может потребоваться любое сочетание категорий компонентов. Элемент управления, не имеющий обязательных записей для категорий компонентов, может быть способен функционировать в любом контейнере управления и не требует какой-либо конкретной функциональности контейнера элемента управления.

Следующие категории компонентов идентифицируются здесь, где могут быть доступны более подробные спецификации категорий.

-   Включение элемента управления [**исимплефрамесите**](/windows/desktop/api/OCIdl/nn-ocidl-isimpleframesite) .
-   Простая привязка данных через интерфейс [**ипропертинотифисинк**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertynotifysink) .
-   Расширенная привязка данных (как поддерживается дополнительными интерфейсами DataBinding в VB 4.0).
-   Visual Basic закрытых интерфейсов — [**ивбформат**](/windows/desktop/api/VbInterf/nn-vbinterf-ivbformat), [**ивбжетконтрол**](/windows/desktop/api/VbInterf/nn-vbinterf-ivbgetcontrol)
-   Элементы управления, поддерживающие Интернет.
-   Безоконные элементы управления.

Это не самый полный список категорий. Дополнительные категории, скорее всего, будут определены в будущем по мере определения новых требований. В Майкрософт доступен актуальный список категорий компонентов. в этом списке отражены категории компонентов, обнаруженные корпорацией Майкрософт, и другие, о которых сообщили поставщики корпорации Майкрософт.

Важно помнить, что элементы управления должны попытаться работать в максимально возможном количестве сред. Если возможно, элемент управления должен понизить его функциональность при помещении в контейнер, который не поддерживает определенные интерфейсы. Назначение категорий компонентов заключается в предотвращении ситуации, когда элемент управления помещается в непригодную для себя среду, и элемент управления не может достичь необходимой задачи. Как правило, элемент управления должен постепенно понижаться, если отсутствуют интерфейсы, элемент управления может указать пользователю сообщение о том, что некоторые функциональные возможности недоступны, или явно документировать функции, необходимые контейнеру элемента управления для обеспечения оптимальной производительности.

Обратите внимание, что старые элементы управления и контейнеры не используют категории компонентов и вместо этого используют ключевое слово Control, представленное для элемента управления в реестре. Для распознавания старыми элементами управления "контейнеры" может потребоваться зарегистрировать ключевое слово элемента управления в реестре. разработчики элементов управления должны убедиться, что элемент управления может быть успешно размещен в таких контейнерах, прежде чем это сделать. Контейнеры, использующие категории компонентов, могут успешно использовать их для размещения старых элементов управления, так как библиотека DLL категории компонентов обрабатывает сопоставление. для более старых элементов управления ControlV1 существует отдельная категория, \_ чтобы контейнер мог при необходимости исключить их.

Так как категории компонентов идентифицируются по идентификаторам GUID, для контейнеров, предоставляющих определенные конкретные функции, можно использовать собственные идентификаторы категорий, созданные с помощью средства создания GUID. Однако это может противодействовать преимуществам взаимодействия элементов управления и контейнеров, поэтому предпочтительно использовать все возможные категории компонентов. при определении новых категорий компонентов поставщикам рекомендуется обращаться к ним, чтобы убедиться, что они отвечают общим требованиям marketplace, и следовать правилам взаимодействия элементов управления ActiveX.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Категории компонентов](component-categories.md)
</dt> </dl>

 

 




