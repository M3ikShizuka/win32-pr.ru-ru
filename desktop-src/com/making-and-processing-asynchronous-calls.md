---
title: Создание и обработка асинхронных вызовов
description: COM-объекты могут поддерживать асинхронный вызов.
ms.assetid: bf7f9f8e-66ce-41a4-854c-62dbe840a89e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 173f33ea3a0d4ec59f994eeff259e776efa58ae5b0182ba97f77e1ba99dd0d82
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119130206"
---
# <a name="making-and-processing-asynchronous-calls"></a>Создание и обработка асинхронных вызовов

COM-объекты могут поддерживать асинхронный вызов. Когда клиент выполняет асинхронный вызов, управление немедленно возвращается клиенту. Пока сервер обрабатывает вызов, клиент может выполнять другие действия. Если клиент больше не может продолжать работу без результатов вызова, он может получить результаты вызова в это время.

Например, запрос на большой или сложный набор записей может занять много времени. Клиент может запросить набор записей с помощью асинхронного вызова, а затем выполнить другие действия. Если набор записей доступен, клиент может быстро получить его без блокировки.

Клиенты не выполняют асинхронные вызовы непосредственно на серверный объект. Вместо этого они получают объект вызова, который реализует асинхронную версию синхронного интерфейса для серверного объекта. Асинхронный интерфейс для объекта вызова имеет имя в виде асинхронного *interfacename*. Например, если объект сервера реализует синхронный интерфейс с именем IMyInterface, то будет существовать объект call, реализующий асинхронный интерфейс с именем АсинЦиминтерфаце.

> [!Note]  
> Асинхронная поддержка недоступна для **IDispatch** или для интерфейсов, которые наследуют **IDispatch**.

 

Объекты сервера, поддерживающие асинхронные вызовы, реализуют интерфейс [**икаллфактори**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory) . Этот интерфейс предоставляет единственный метод [**креатекалл**](/windows/win32/api/objidlbase/nf-objidlbase-icallfactory-createcall), который создает экземпляр указанного объекта вызова. Клиенты могут запрашивать **икаллфактори** , чтобы определить, поддерживает ли объект асинхронный вызов.

Для каждого метода в синхронном интерфейсе соответствующий асинхронный интерфейс реализует два метода. Эти методы присоединяют префиксы Begin \_ и Finish \_ к имени синхронного метода. Например, если интерфейс с именем Исимплестреам имеет метод Read, то интерфейс АсинЦисимплестреам будет иметь \_ метод Begin Read и готово \_ Read. Чтобы начать асинхронный вызов, клиент вызывает \_ метод Begin.

При реализации серверного объекта нет необходимости предоставлять объект вызова для каждого интерфейса, реализуемого объектом. Если серверный объект реализует интерфейс [**икаллфактори**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory) и использует стандартную упаковку, то упакованный клиент всегда может получить объект вызова прокси-сервера, даже если на стороне сервера нет объекта Call. Этот прокси-сервер маршалирует \_ метод Begin как синхронный вызов, сервер будет обрабатывать вызов синхронно, а клиент может получить выходные параметры, вызвав \_ метод Finish.

И наоборот, если клиент выполняет упакованный синхронный вызов в интерфейсе, для которого имеется объект вызова на стороне сервера, сервер всегда будет обрабатывать вызов асинхронно. Это поведение не будет очевидным для клиента, так как клиент будет получать те же выходные параметры и то же возвращаемое значение, что было бы получено от синхронного метода.

В любом случае взаимодействие между клиентом и сервером маршалируется, как если бы вызов был синхронным: выходные данные синхронных и асинхронных прокси-серверов неразличимы, как и выходные данные соответствующих заглушек. Такое поведение значительно упрощает модель программирования как клиентов, так и серверов. Если серверный объект реализует [**икаллфактори**](/windows/win32/api/objidlbase/nn-objidlbase-icallfactory), упакованному клиенту не нужно пытаться создать объект вызова, который может быть недоступен клиенту, объект вызова всегда доступен.

Если клиент и сервер находятся в одном апартаменте, объект сервера будет обрабатывать любой вызов, который делает клиент. Если объект вызова недоступен, клиент должен явно получить синхронный интерфейс и выполнить синхронный вызов.

Дополнительные сведения см. в следующих разделах:

-   [Выполнение асинхронного вызова](making-an-asynchronous-call.md)
-   [Отмена асинхронного вызова](canceling-an-asynchronous-call.md)
-   [Отмена вызовов метода](canceling-method-calls.md)
-   [Синхронизация вызовов](call-synchronization.md)

 

 