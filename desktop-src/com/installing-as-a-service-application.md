---
title: Установка в качестве приложения службы
description: Установка в качестве приложения службы
ms.assetid: 0dd4b348-3d12-49ba-8098-4adb9df01a0e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3ed5c474d73c74b3be40bae773c3d51eadf6c69a
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "104070668"
---
# <a name="installing-as-a-service-application"></a>Установка в качестве приложения службы

Помимо запуска в качестве исполняемого файла локального сервера (EXE), COM-объект также может быть упакован для запуска в качестве приложения службы при активации с помощью локального или удаленного клиента. Службы поддерживают многочисленные полезные и пользовательские функции интерфацеâ, включая запуск, остановку, приостановку и перезапуск, а также возможность установить сервер для работы под определенной [учетной записью пользователя](/windows/desktop/Services/service-user-accounts) и с помощью [оконной станции](/windows/desktop/winstation/window-stations).

Объект, написанный как служба, устанавливается для использования в COM путем установки значения [LocalService](localservice.md) в качестве ключа [AppID](appid-key.md) и выполнения стандартной установки службы.

Классы также могут быть настроены для запуска от имени определенной учетной записи пользователя при активации удаленным клиентом без записи в качестве приложения службы. Для этого класс устанавливает имя пользователя и пароль, которые будут использоваться, когда SCM запускает свой локальный серверный процесс.

Если класс настроен таким образом, вызовы [**CoRegisterClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-coregisterclassobject) с этим CLSID завершатся ошибкой, если процесс не был запущен com от имени фактического запроса на активацию. Иными словами, классы, настроенные для запуска от имени конкретного пользователя, могут не регистрироваться под другим удостоверением.

Имя пользователя берется из ключевого значения [запуска от имени](runas.md) в ключе AppID класса. Если имя пользователя — "Интерактивный пользователь", код класса выполняется в контексте безопасности вошедшего в систему пользователя и подключается к интерактивной рабочей станции.

В противном случае пароль будет извлечен из скрытой части реестра, доступной только администраторам компьютера и системы. Затем имя пользователя и пароль используются для создания сеанса входа в систему, в котором выполняется код класса. При запуске таким образом код класса выполняется с помощью собственного рабочего стола и станции окна и не использует дескрипторы окон, буфер обмена или другие элементы пользовательского интерфейса с интерактивным пользователем или другими классами, запущенными в других учетных записях пользователя.

Сервер, зарегистрированный с помощью **LocalService** или **runas** , может зарегистрировать объект в таблице выполняющегося объекта, чтобы разрешить любому клиенту подключаться к нему. Для этого в вызове [**ируннингобжекттабле:: Register**](/windows/desktop/api/ObjIdl/nf-objidl-irunningobjecttable-register) на сервере должен быть установлен \_ флаг ротфлагс аллованиклиент. Параметр сервера этот бит должен иметь имя исполняемого файла в разделе AppID реестра, который ссылается на AppID для исполняемого файла. Сервер, не зарегистрированный как **LocalService** или **runas**, может не зарегистрировать объект с этим флагом.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Регистрация класса при установке](registering-a-class-at-installation.md)
</dt> <dt>

[Регистрация работающего сервера EXE](registering-a-running-exe-server.md)
</dt> <dt>

[Регистрация объектов в таблице ROT](registering-objects-in-the-rot.md)
</dt> <dt>

[Самостоятельная регистрация](self-registration.md)
</dt> </dl>

 

 