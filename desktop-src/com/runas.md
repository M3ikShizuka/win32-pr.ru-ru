---
title: RunAs
description: Настраивает класс для запуска от имени определенной учетной записи пользователя при активации удаленным клиентом без записи в качестве приложения службы.
ms.assetid: 2325a7da-8acd-41f4-a658-36a02532505a
keywords:
- Значение реестра RunAs COM
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b3139d12864eb92cc153b919dc4b9b9a4059379d
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "105700939"
---
# <a name="runas"></a>RunAs

Настраивает класс для запуска от имени определенной учетной записи пользователя при активации удаленным клиентом без записи в качестве приложения службы.

## <a name="registry-entry"></a>Запись реестра

```
HKEY_LOCAL_MACHINE\SOFTWARE\Classes\AppID
   {AppID_GUID}
      RunAs = value
```

## <a name="remarks"></a>Комментарии

Значение указывает имя пользователя и должно быть либо в формате *username*, либо в *доменном ***\\*** имени* , либо в строке "Интерактивный пользователь". Можно также указать строки «NT Authority \\ LocalService» (для локальной службы) и «NT Authority \\ NetworkService» (для сетевой службы). \\Если {*AppID \_ GUID*} указывает на сервер COM, который уже запущен или имеет запись в таблице классов, можно также указать строку "NT Authority System". Тем не менее нельзя использовать «систему NT Authority \\ » с сервером COM, который еще не запущен. Пароль по умолчанию для "NT Authority \\ LocalService", "NT Authority \\ NetworkService" и "система NT Authority \\ " — "" (пустая строка).

> [!Note]  
> Начиная с Windows Vista, для настройки параметров запуска от имени «служба NT Authority» \\ , «NT Authority \\ NetworkService» и «система NT Authority» больше не \\  требуется пустой пароль.

 

Классы, настроенные для запуска от имени конкретного пользователя, могут не регистрироваться под другим удостоверением, поэтому вызовы [**CoRegisterClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-coregisterclassobject) с этим CLSID завершаются неудачей, если процесс не был запущен com от имени фактического запроса на активацию.

Имя пользователя берется из значения **runas** в ключе **AppID** класса. Если имя пользователя — "Интерактивный пользователь", сервер выполняется с удостоверением пользователя, который в данный момент вошел в систему и подключен к интерактивному рабочему столу.

В противном случае пароль будет извлечен из части реестра, доступной только администраторам компьютера и системы. Затем имя пользователя и пароль используются для создания сеанса входа в систему, в котором выполняется сервер. При запуске таким образом пользователь работает с собственным рабочим столом и оконной станцией и не использует дескрипторы окон, буфер обмена или другие элементы пользовательского интерфейса с интерактивным пользователем или другим пользователем, запущенным в других учетных записях пользователей.

Чтобы установить пароль для класса **запуска от имени** , необходимо использовать административное средство DCOMCNFG, установленное в системном каталоге.

Для удостоверений **запуска от имени** , используемых серверами DCOM, учетная запись пользователя, указанная в значении, должна иметь права на вход в качестве пакетного задания. Это право можно добавить с помощью средства администрирования локальной политики безопасности. Перейдите в раздел **Локальные политики** и откройте **Назначение прав пользователя**. Выберите **Вход в качестве пакетного задания** и добавьте учетную запись пользователя.

Значение **runas** не используется для серверов, настроенных для запуска в качестве служб. Службы COM, которые должны выполняться под удостоверением, отличным от LocalSystem, должны устанавливать соответствующие имя пользователя и пароль с помощью приложения панели управления "службы" или функций контроллера служб. (Дополнительные сведения об этих функциях см. в разделе [службы](/windows/desktop/Services/services).)

> [!Note]  
> Начиная с Microsoft Windows Server 2003, класс AppID явно читается из **\_ \_ \\ классов программного обеспечения локального компьютера \\ hKey \\ AppID**, что, в отличие от большинства разделов реестра, не является взаимозаменяемым **с \_ \_ корневым \\ идентификатором классов hKey**.

 

## <a name="related-topics"></a>См. также

<dl> <dt>

[Регистрация серверов COM](registering-com-servers.md)
</dt> </dl>

 

 