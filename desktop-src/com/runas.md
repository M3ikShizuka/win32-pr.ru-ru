---
title: RunAs
description: Настраивает класс для запуска от имени определенной учетной записи пользователя при активации удаленным клиентом без записи в качестве приложения службы.
ms.assetid: 2325a7da-8acd-41f4-a658-36a02532505a
keywords:
- Значение реестра RunAs COM
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b3139d12864eb92cc153b919dc4b9b9a4059379d
ms.sourcegitcommit: 9eebab0ead09cecdbc24f5f84d56c8b6a7c22736
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/10/2021
ms.locfileid: "124369713"
---
# <a name="runas"></a>RunAs

Настраивает класс для запуска от имени определенной учетной записи пользователя при активации удаленным клиентом без записи в качестве приложения службы.

## <a name="registry-entry"></a>Запись реестра

```
HKEY_LOCAL_MACHINE\SOFTWARE\Classes\AppID
   {AppID_GUID}
      RunAs = value
```

## <a name="remarks"></a>Remarks

Значение указывает имя пользователя и должно иметь одно из двух значений: *имя* пользователя, *домен * **\\** _имя пользователя_ или строка "Интерактивный пользователь". Можно также указать строки «NT Authority \\ LocalService» (для локальной службы) и «NT Authority \\ NetworkService» (для сетевой службы). Кроме того, можно указать строку "NT Authority \\ System", если {* AppID \_ GUID *} ссылается на COM-сервер, который уже запущен или имеет запись в таблице классов. Тем не менее нельзя использовать «систему NT Authority \\ » с сервером COM, который еще не запущен. Пароль по умолчанию для "NT Authority \\ LocalService", "NT Authority \\ NetworkService" и "система NT Authority \\ " — "" (пустая строка).

> [!Note]  
> начиная с Windows Vista, больше не требуется пустой пароль для настройки \\ параметров запуска от имени "локальная служба nt", "nt authority \\ networkservice" и "nt authority \\ system". 

 

Классы, настроенные для запуска от имени конкретного пользователя, могут не регистрироваться под другим удостоверением, поэтому вызовы [**CoRegisterClassObject**](/windows/desktop/api/combaseapi/nf-combaseapi-coregisterclassobject) с этим CLSID завершаются неудачей, если процесс не был запущен com от имени фактического запроса на активацию.

Имя пользователя берется из значения **runas** в ключе **AppID** класса. Если имя пользователя — "Интерактивный пользователь", сервер выполняется с удостоверением пользователя, который в данный момент вошел в систему и подключен к интерактивному рабочему столу.

В противном случае пароль будет извлечен из части реестра, доступной только администраторам компьютера и системы. Затем имя пользователя и пароль используются для создания сеанса входа в систему, в котором выполняется сервер. При запуске таким образом пользователь работает с собственным рабочим столом и оконной станцией и не использует дескрипторы окон, буфер обмена или другие элементы пользовательского интерфейса с интерактивным пользователем или другим пользователем, запущенным в других учетных записях пользователей.

Чтобы установить пароль для класса **запуска от имени** , необходимо использовать административное средство DCOMCNFG, установленное в системном каталоге.

Для удостоверений **запуска от имени** , используемых серверами DCOM, учетная запись пользователя, указанная в значении, должна иметь права на вход в качестве пакетного задания. Это право можно добавить с помощью средства администрирования локальной политики безопасности. Перейдите в раздел **Локальные политики** и откройте **Назначение прав пользователя**. Выберите **Вход в качестве пакетного задания** и добавьте учетную запись пользователя.

Значение **runas** не используется для серверов, настроенных для запуска в качестве служб. Службы COM, которые должны выполняться под удостоверением, отличным от LocalSystem, должны устанавливать соответствующие имя пользователя и пароль с помощью приложения панели управления "службы" или функций контроллера служб. (Дополнительные сведения об этих функциях см. в разделе [службы](/windows/desktop/Services/services).)

> [!Note]  
> на сервере Microsoft Windows Server 2003 класс appid явно читается из **\_ \_ \\ классов программного обеспечения локального компьютера HKEY \\ \\ appid**, что, в отличие от большинства разделов реестра, не является взаимозаменяемым с **\_ \_ корневым \\ идентификатором классов hkey**.

 

## <a name="related-topics"></a>Связанные разделы

<dl> <dt>

[Регистрация серверов COM](registering-com-servers.md)
</dt> </dl>

 

 