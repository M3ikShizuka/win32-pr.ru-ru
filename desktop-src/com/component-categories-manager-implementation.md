---
title: Реализация диспетчера категорий компонентов
description: По мере роста количества доступных компонентов становится все сложнее управлять этими компонентами. С точки зрения предоставляемых им интерфейсов, а также задач, которые они выполняют, многие компоненты предлагают аналогичные функции.
ms.assetid: c2c67129-bf19-465b-8354-193922aeafaa
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 941ba5f422a4305a3bb6056d1d02648dde3bffc9c9f872fe7f7804ebb90a19ee
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119679216"
---
# <a name="component-categories-manager-implementation"></a>Реализация диспетчера категорий компонентов

По мере роста количества доступных компонентов становится все сложнее управлять этими компонентами. С точки зрения предоставляемых им интерфейсов, а также задач, которые они выполняют, многие компоненты предлагают аналогичные функции.

Часто бывает необходимо перечислить компоненты, которые можно использовать в определенном контексте. В качестве примера можно привести диалоговое окно **Вставка объекта** , используемое в составных документах OLE, и диалоговое окно « **Вставка элемента управления** », используемое в элементах управления OLE. В этих диалоговых окнах перечислены все компоненты, которые удовлетворяют (или удовлетворяют требованиям), контракты интерфейсов для составных документов или элементов управления. Эти существующие категории (документ OLE, элемент управления OLE) не подразумевают точную сигнатуру интерфейса. Документы OLE должны предоставлять определенный набор базовых интерфейсов (например, [**иолеобжект**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject) или [**иперсистстораже**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage)), но также могут предоставлять дополнительные интерфейсы, такие как [**иолелинк**](/windows/desktop/api/OleIdl/nn-oleidl-iolelink).

В прошлом компоненты были помечены путем добавления понятного имени ("inserted", "Control" и т. д.) в качестве подраздела к **\_ \_ корневому CLSID классов hKey \\ \\ {...}** раздел реестра, соответствующий компоненту. Это хорошо работает для центрального определения категорий, но конфликты имен, когда многие независимые стороны определяют новые категории. Как и в других областях COM, решение, обеспечивающее расширяемое пространство имен, заключается в использовании глобально уникальных идентификаторов (GUID). Вместо того чтобы использовать удобное для восприятия имя, каждой категории назначается уникальный номер (CATID).

Еще одно ограничение, связанное с существующей классификацией, заключается в том, что оно ограничивается возможностями самого компонента. Для многих компонентов требуются определенные возможности из контейнеров. Когда такой компонент вставляется в контейнер, вставка может завершиться ошибкой или неожиданно вести себя, даже если компонент выполняет контракты, подразумеваемые одной из ее категорий. Чтобы перечислить компоненты, которые могут быть использованы в определенных ситуациях, необходимо учитывать возможности как компонента, так и контейнера.

Из-за этих рекомендаций в существующую классификацию были внесены следующие изменения:

-   Категории указываются с помощью CATID, которые являются глобально уникальными идентификаторами.
-   В подразделе **Components** **\_ \_ корневого раздела реестра \\ CLSID для классов hKey** были разработаны два отдельных подраздела, "реализованные категории" и "обязательные категории". Эти подразделы содержат списки CATID, предоставляемые компонентом или которые должен предоставить контейнер компонента.

Для упрощения управления категориями компонентов категории перечислены в центральном месте в реестре: **\_ \_ категории корневых \\ компонентов классов hKey**. В этом разделе перечислены установленные категории с идентификаторами CATID, а также локализованные, понятные имена.

Дополнительные сведения см. в следующих разделах:

-   [Категоризация по возможностям компонентов](categorizing-by-component-capabilities.md)
-   [Категоризация по возможностям контейнеров](categorizing-by-container-capabilities.md)
-   [Диспетчер категорий компонентов](the-component-categories-manager.md)
-   [Классы и ассоциации по умолчанию](default-classes-and-associations.md)
-   [Определение категорий компонентов](defining-component-categories.md)
-   [Связывание значков с категорией](associating-icons-with-a-category.md)

 

 




