---
title: Proxy (Прокси)
description: Прокси-сервер находится в адресном пространстве вызывающего процесса и выступает в качестве суррогата для удаленного объекта.
ms.assetid: 6c82f655-ac46-4ed9-992b-0387b324a8f9
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a11257dd060f51bef118a4afc0cc35acf995c111
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "126971340"
---
# <a name="proxy"></a>Proxy (Прокси)

Прокси-сервер находится в адресном пространстве вызывающего процесса и выступает в качестве суррогата для удаленного объекта. С точки зрения вызывающего объекта прокси-объект является объектом. Как правило, роль прокси-сервера заключается в упаковке параметров интерфейса для вызовов методов в своих интерфейсах объектов. Прокси-сервер упаковывает параметры в буфер сообщений и передает буфер в канал, который обрабатывает транспорт между процессами. Прокси-сервер реализуется как агрегатный или составной объект. Она содержит предоставленный системой Диспетчер прокси-сервера и один или несколько компонентов интерфейса, называемых прокси-интерфейсами интерфейса. Число прокси-серверов интерфейса равно числу интерфейсов объектов, которые были предоставлены этому конкретному клиенту. Для клиентов, которые приводят к работе с объектной моделью компонента, прокси-сервер является реальным объектом.

> [!Note]  
> При пользовательском маршалировании прокси-сервер можно реализовать аналогичным образом или напрямую с объектом без использования заглушки.

 

Каждый прокси-интерфейс представляет собой объект компонента, реализующий код маршалирования для одного из интерфейсов объекта. Прокси-сервер представляет объект, для которого он обеспечивает упаковку кода. Каждый прокси-сервер также реализует интерфейс [**ирпкпроксибуффер**](/windows/win32/api/objidlbase/nn-objidlbase-irpcproxybuffer) . Хотя объектный интерфейс, представленный прокси-сервером, является открытым, реализация **ирпкпроксибуффер** является закрытой и используется внутри прокси-сервера. Диспетчер прокси-сервера отслеживает прокси интерфейсов, а также содержит открытую реализацию интерфейса управления [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) для статистического выражения. Каждый прокси-сервер интерфейса может существовать в отдельной библиотеке DLL, которая загружается, когда поддерживаемый им интерфейс является материализованным для клиента.

## <a name="structure-of-the-proxy"></a>Структура прокси-сервера

На следующей схеме показана структура прокси-сервера, который поддерживает стандартный маршалирование параметров, принадлежащих двум интерфейсам: IA1 и IA2. Каждый прокси-интерфейс реализует [**ирпкпроксибуффер**](/windows/win32/api/objidlbase/nn-objidlbase-irpcproxybuffer) для внутреннего взаимодействия между агрегатными частями. Когда прокси-сервер готов к передаче упакованных параметров через границу процесса, он вызывает методы в интерфейсе [**ирпкчаннелбуффер**](/windows/win32/api/objidlbase/nn-objidlbase-irpcchannelbuffer) , который реализуется каналом. Канал в свою очередь перенаправляет вызов в библиотеку времени выполнения RPC, чтобы он мог достичь места назначения в объекте.

![Схема, на которой показана структура прокси-сервера.](images/4432d8d3-dfab-4635-90f8-408aecf70134.png)

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Канал](channel.md)
</dt> <dt>

[Обмен данными между объектами](inter-object-communication.md)
</dt> <dt>

[Сведения о маршалировании](marshaling-details.md)
</dt> <dt>

[Microsoft RPC](microsoft-rpc.md)
</dt> <dt>

[Заглушка](stub.md)
</dt> </dl>

 

 