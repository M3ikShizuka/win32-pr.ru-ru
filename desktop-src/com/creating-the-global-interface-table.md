---
title: Создание глобальной таблицы интерфейса
description: Создание глобальной таблицы интерфейса
ms.assetid: e8e46642-ef41-4322-97d0-8dd5b7c72992
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f792f9664da554f6522086796f94a00ccdf0dc07
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "104413877"
---
# <a name="creating-the-global-interface-table"></a>Создание глобальной таблицы интерфейса

Используйте следующий вызов, чтобы создать объект таблицы глобальных интерфейсов и получить указатель на [**иглобалинтерфацетабле**](/windows/desktop/api/ObjIdl/nn-objidl-iglobalinterfacetable):

``` syntax
HRESULT hr;
hr = CoCreateInstance(CLSID_StdGlobalInterfaceTable,
                 NULL,
                 CLSCTX_INPROC_SERVER,
                 IID_IGlobalInterfaceTable,
                 (void **)&gpGIT);
if (hr != S_OK) {
  exit(0); // Handle errors here.
}
```

> [!Note]  
> При создании объекта глобальной таблицы интерфейса с помощью предыдущего вызова необходимо создать ссылку на библиотеку UUID. lib. Это позволит разрешить внешние символы CLSID \_ стдглобалинтерфацетабле и IID \_ иглобалинтерфацетабле.

 

Для каждого процесса существует единственный экземпляр глобальной таблицы интерфейса, поэтому все вызовы этой функции в процессе возвращают один и тот же экземпляр.

После вызова функции [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) Зарегистрируйте интерфейс в подразделении, в котором он находится, с помощью вызова метода [**регистеринтерфацеинглобал**](/windows/win32/api/objidl/nf-objidl-iglobalinterfacetable-registerinterfaceinglobal) . Этот метод предоставляет файл cookie, определяющий интерфейс и его расположение. Апартамент, который ищет указатель на этот интерфейс, затем вызывает метод [**жетинтерфацефромглобал**](/windows/win32/api/objidl/nf-objidl-iglobalinterfacetable-getinterfacefromglobal) с этим файлом cookie, а реализация затем предоставляет указатель интерфейса на вызывающий апартамент. Чтобы отозвать глобальную регистрацию интерфейса, любой апартамент может вызвать метод [**ревокеинтерфацефромглобал**](/windows/win32/api/objidl/nf-objidl-iglobalinterfacetable-revokeinterfacefromglobal) .

Простым примером использования [**иглобалинтерфацетабле**](/windows/desktop/api/ObjIdl/nn-objidl-iglobalinterfacetable) является то, что необходимо передать указатель интерфейса на объект в однопотоковом апартаменте (STA) в рабочий поток в другом апартаменте. Вместо того, чтобы выполнять упаковку в поток и передавать поток рабочему потоку в качестве параметра потока, **иглобалинтерфацетабле** позволяет просто передать файл cookie.

При регистрации интерфейса в глобальной таблице интерфейсов вы получаете файл cookie, который можно использовать вместо передачи фактического указателя (при необходимости передачи указателя) либо в параметр, не являющийся методом, который переходит в другой апартамент (в качестве параметра [*среадпрок*](/previous-versions/windows/desktop/legacy/ms686736(v=vs.85)) через [**CreateThread**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createthread)), либо на внутрипроцессный объем памяти, доступный за пределами подразделения.

Необходимо соблюдать осторожность, так как использование глобальных интерфейсов полагается на программиста по управлению такими проблемами, как конкуренция и взаимное исключение, связанные с доступом к глобальному состоянию из нескольких потоков одновременно.

COM предоставляет стандартную реализацию интерфейса [**иглобалинтерфацетабле**](/windows/desktop/api/ObjIdl/nn-objidl-iglobalinterfacetable) . Настоятельно рекомендуется использовать эту стандартную реализацию, так как она предоставляет полноценные потокобезопасные функции.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Когда следует использовать глобальную таблицу интерфейса](when-to-use-the-global-interface-table.md)
</dt> </dl>

 

 