---
title: Просмотр кэширования
description: Просмотр кэширования
ms.assetid: d19c111c-1367-43a2-97a9-35dc0ff5dcc8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 592c5bc2555e907cdc4e600465b807387c3a5548
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127145702"
---
# <a name="view-caching"></a>Просмотр кэширования

Приложение-контейнер должно иметь возможность получить представление объекта в целях отображения или печати для пользователей, если документ открыт, но серверное приложение этого объекта не работает или не установлено на компьютере пользователя. Тем не менее, предположим, что серверы для всех объектов, которые могут быть найдены в документе, установлены на каждом компьютере пользователя и всегда могут выполняться по требованию — нереалистичные. Обработчик объектов по умолчанию, который доступен в любое время, решает эту дилеммой путем кэширования презентаций объектов в хранилище документа и манипулирования этими презентациями на любой платформе независимо от ущерба объекта сервера при любой конкретной установке контейнера.

Контейнеры могут поддерживать Рисование презентаций для одного или нескольких конкретных целевых устройств в дополнение к тому, которое требуется для обслуживания объекта на экране. Более того, при переносе объекта с одной платформы на другую OLE автоматически преобразует форматы данных объекта в объекты, поддерживаемые на новой платформе. например, при перемещении объекта с Windows на Macintosh OLE преобразует свои презентации метафайлов в форматы PICT.

Чтобы представить пользователю точное представление о внедренном объекте, приложение-контейнер объекта запускает диалоговое окно с обработчиком объекта, запрашивая данные и инструкции по рисованию. Для выполнения запросов контейнера обработчик должен реализовать интерфейсы [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject), [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)и [**иолекаче**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache) .

[**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) позволяет приложению контейнера OLE получать данные из внедренных или связанных объектов и передавать их в них. При изменении данных в объекте этот интерфейс предоставляет объекту возможность сделать свои новые данные доступными для контейнера и предоставляет контейнеру способ обновления данных в своей копии объекта. (Обсуждение передаваемых данных в целом см. в главе 4 Передача данных.)

Интерфейс [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) очень похож на интерфейс [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) , за исключением того, что он запрашивает у объекта прорисовку себя в контексте устройства, таком как экран, изображение или метафайл, вместо того, чтобы перемещать или копировать данные в память или другой носитель передачи. Этот интерфейс предназначен для того, чтобы контейнер OLE получал альтернативные виде рисунков представления своих внедренных объектов, чьи данные уже существуют, тем самым избегая издержек на перемещение совершенно новых экземпляров одних и тех же объектов данных просто для получения новых инструкций рисования. Вместо этого интерфейс **IViewObject2** позволяет контейнеру запрашивать объект для предоставления собственного виде рисунков представления путем рисования в контексте устройства, заданном в контейнере.

При вызове интерфейса [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) приложение-контейнер может также указать, что объект рисует себя на целевом устройстве, отличном от того, на котором оно будет фактически подготовлено к просмотру. Это позволяет контейнеру при необходимости формировать различные рендерингы из одного объекта. Например, вызывающая сторона может попросить объект создать себя для принтера, даже если итоговый рисунок будет отображен на экране. Результатом, конечно, будет предварительный просмотр объекта.

Интерфейс [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)также предоставляет методы, позволяющие регистрировать в контейнерах уведомления об изменениях представления. Как и в случае с данными и рекомендациями OLE, соединение с советами по представлениям позволяет контейнеру обновлять его отрисовку объекта на свое удобство, а не в ответ на вызов из объекта. Например, если новая версия серверного приложения объекта предложит дополнительные представления одних и тех же данных, обработчик по умолчанию объекта вызовет реализацию [**иадвисесинк:: онвиевчанже**](/windows/desktop/api/ObjIdl/nf-objidl-iadvisesink-onviewchange) каждого контейнера, чтобы сообщить им о том, что новые презентации были доступны. Контейнер будет извлекать эти сведения из приемника уведомлений только при необходимости.

поскольку контексты устройств Windows имеют значение только в пределах одного процесса, нельзя передавать указатели [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) между процессами. Как следствие, для реализации интерфейса на локальном и удаленном серверах OLE не требуется никакой конкретной работы, даже если бы они не работали должным образом. Интерфейс **IViewObject2** реализует только обработчики объектов и внутрипроцессный сервер. OLE предоставляет реализацию по умолчанию, которую можно использовать в собственных серверах обработки и обработчиках объектов OLE, просто выполнив статистическую обработку обработчика OLE по умолчанию. Или можно написать собственную реализацию **IViewObject2**.

Объект реализует интерфейс [**иолекаче**](/windows/desktop/api/OleIdl/nn-oleidl-iolecache) , чтобы обработчик мог узнать, какие возможности он должен кэшировать. Обработчик объектов также владеет кэшем и гарантирует актуальность. Когда внедренный объект переходит в состояние выполнения, обработчик настраивает соответствующие советы в отношении серверного объекта с самого себя в качестве приемника. Реализации интерфейса [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) и [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2)исполняют данные, кэшированные на стороне клиента. Реализация **IViewObject2** в обработчике отвечает за определение того, какие форматы данных кэшировать для удовлетворения запросов рисования клиента. Реализация интерфейса **IDataObject** в обработчике отвечает за получение данных в различных форматах и т. д. между памятью и базовым экземпляром [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) внедренного объекта. Пользовательские обработчики могут использовать эти реализации путем статистической обработки в обработчике по умолчанию.

> [!Note]  
> Интерфейс [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2) — это простое функциональное расширение [**ивиевобжект**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject) , которое следует реализовать вместо последнего интерфейса, который теперь устарел. В дополнение к методам **ивиевобжект** , интерфейс **IViewObject2** предоставляет один дополнительный [**член, GetObject, который**](/windows/desktop/api/OleIdl/nf-oleidl-iviewobject2-getextent)позволяет приложению-контейнеру получить размер представления объекта из кэша без предварительного перемещения объекта в состояние выполнения с вызовом [**иолеобжект::**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getextent)GetObject.

 

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Составные документы](compound-documents.md)
</dt> </dl>

 

 