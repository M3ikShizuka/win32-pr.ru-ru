---
title: аппидфлагс
description: Набор флагов, которые управляют поведением активации сервера COM.
ms.assetid: ab98e7d3-85c6-4328-84c4-1d4583df69ce
keywords:
- COM-значение реестра Аппидфлагс
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 44ecf7d0d112d2ceff913f3de6250c130e16455c1810cc6234db63a6aaf463fe
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119048872"
---
# <a name="appidflags"></a>аппидфлагс

Набор флагов, которые управляют поведением активации сервера COM.

## <a name="registry-entry"></a>Запись реестра

```
HKEY_LOCAL_MACHINE\SOFTWARE\Classes\AppID
   {AppID_GUID}
      AppIDFlags = flags
```

## <a name="remarks"></a>Remarks

Это значение **reg \_ DWORD** .



| Значение флага | Константа                                              |
|------------|-------------------------------------------------------|
| 0x1        | АППИДРЕГФЛАГС \_ активировать \_ иусервер \_ Desktop          |
| 0x2        | АППИДРЕГФЛАГС \_ безопасный \_ Серверный \_ процесс \_ SD \_ и \_ BIND |
| 0x4        | RPC АППИДРЕГФЛАГС для \_ \_ активации \_ \_ при \_ обнаружении   |



 

### <a name="appidregflags_activate_iuserver_indesktop-description"></a>\_Описание аппидрегфлагс активации \_ ИУСЕРВЕР для \_ рабочего стола

Если флажок **аппидрегфлагс \_ активировать \_ ИУСЕРВЕР для \_ рабочего стола** в **аппидфлагс** или если **аппидфлагс** отсутствует, клиент в сеансе сервера терминалов, выполняющий запрос на активацию для [интерактивного ПОЛЬЗОВАТЕЛЬСКОГО](interactive-user.md) COM-сервера, привязывается к серверу com или запускается и связывается с сервером, на рабочем столе "по умолчанию" рабочей [станции](/windows/desktop/winstation/window-stations) "winsta0" сеанса в запросе на активацию. Например, если клиент работает под управлением «winsta0 \\ desktop1» сеанса 3, запрос на активацию для сеанса 3 будет либо привязан к, либо запущен и привязан к серверу com в «winsta0 \\ Default» сеанса 3, даже если экземпляр COM-сервера уже запущен в «winsta0 \\ desktop1» сеанса 3.

Если в значении **аппидфлагс** установлен флаг **АППИДРЕГФЛАГС \_ активировать \_ иусервер \_ Desktop** , com будет либо привязан к, либо запущен и привязан к, серверный процесс, запущенный на рабочем столе клиента, и сеанс в запросе активации. Например, если на клиенте выполняется "winsta0 \\ desktop1" в сеансе 3, запрос на активацию для сеанса 3 будет либо привязан к, либо запущен и привязан к серверу com в "winsta0 \\ desktop1" в сеансе 3, даже если экземпляр COM-сервера уже выполняется в сеансе 3 в "winsta0 \\ Default".

Клиент может использовать [моникер сеанса](/windows/desktop/TermServ/session-monikers) , чтобы указать сеанс, отличный от сеанса клиента при выполнении запроса на активацию.

Флаг **аппидрегфлагс \_ активировать \_ иусервер \_ Desktop** применяется только к серверам COM, настроенным для запуска runas "[Интерактивный пользователь](interactive-user.md)".

### <a name="appidregflags_secure_server_process_sd_and_bind-description"></a>АППИДРЕГФЛАГС \_ безопасный \_ Серверный \_ процесс \_ SD \_ и \_ Описание привязки

Если в **аппидфлагс** установлен флаг **\_ \_ \_ \_ привязки SD \_ и \_ BIND для аппидрегфлагс Secure Server** , то серверы COM, настроенные для запуска runas "Активатор", будут запущены с дескриптором безопасности процесса, который позволяет [обрабатывать \_ весь \_ доступ](/windows/desktop/ProcThread/process-security-and-access-rights) к идентификатору безопасности логонид маркера процесса. Кроме того, владельцем дескриптора безопасности будет задаваться идентификатор безопасности Логонид маркера процесса.

Если в **аппидфлагс** установлен флаг **\_ \_ \_ \_ привязки SD \_ и \_ BIND для аппидрегфлагс Secure Server** , то серверы COM, настроенные для запуска runas "Этот пользователь", будут запущены с дескриптором безопасности процесса, который позволяет [обрабатывать \_ все \_ права доступа](/windows/desktop/ProcThread/process-security-and-access-rights) в логонид SID маркера процесса. Кроме того, владельцем дескриптора безопасности будет задаваться идентификатор безопасности Логонид маркера процесса. Кроме того, диспетчер управления службами COM (SCM) изменяет маркер серверного процесса COM следующим образом:

-   Он добавляет идентификатор SID APPID в маркер. Он предоставляет ИД безопасности APPID полный доступ в списке управления доступом по умолчанию для маркеров (DACL). в Windows Vista и более поздних версиях Windows он предоставляет разрешение CONTROL овнерригхтс на чтение для элемента управления "идентификатор безопасности \_ " в списке DACL маркера по умолчанию. в версиях Windows, предшествующих Windows Vista, владельцем маркера присваивается идентификатор SID APPID.

При использовании **аппидрегфлагс \_ безопасного \_ серверного \_ процесса \_ SD \_ и \_** флага привязки необходимо учитывать следующие аспекты безопасности.

-   Флаг **аппидрегфлагс \_ Secure \_ Server \_ процесс \_ SD \_ и \_ BIND** предназначен для настройки серверами COM, которые запускаются в одном из встроенных контекстов безопасности службы. это учетная запись NetworkService или LocalService. Если серверы олицетворяют привилегированных клиентов и если не установлен флаг **аппидрегфлагс \_ Secure \_ Server \_ процесс \_ SD \_ и \_ BIND** , вредоносный код, выполняемый в других процессах с тем же контекстом безопасности, может повысить привилегию, перехватить маркеры олицетворения привилегированных клиентов из процесса COM-сервера.
-   Если установлен **флаг \_ \_ \_ \_ \_ привязки SD и \_ BIND для аппидрегфлагс Secure Server** , com ЗАФИКСИРУЕТ дескриптор безопасности объекта Process в случае COM-серверов "Активатор" для запуска от имени. Для таких серверов ожидается, что клиент COM зафиксирует маркер, используемый для активации COM.
-   Если установлен **флаг \_ \_ \_ \_ \_ привязки SD и \_ BIND для аппидрегфлагс Secure Server** , COM фиксирует дескриптор безопасности объекта Process в случае COM-серверов "этого пользователя". Он также фиксирует маркер процесса COM-сервера, так как COM SCM — это сущность, которая создает маркер.

флаг **аппидрегфлагс \_ SECURE \_ SERVER \_ процесс \_ SD \_ и \_ BIND** поддерживается в Windows XP, Windows server 2003, Windows Vista и Windows SERVER 2008 только при применении исправления MSRC8322 ([бюллетень по безопасности MS09-012](https://support.microsoft.com/kb/959454)). он изначально поддерживается в Windows 7 и более поздних версиях Windows.

Флаг **аппидрегфлагс \_ Secure \_ Server \_ процесс \_ SD \_ и \_ BIND** применяется только к серверам COM, настроенным для запуска runas "Активатор" или "Этот пользователь". Он не применяется к COM-серверам, которые являются службами NT.

### <a name="appidregflags_issue_activation_rpc_at_identify-description"></a>\_ \_ RPC Activation аппидрегфлагс для активации \_ \_ в \_ определении описания

Если в **аппидфлагс** установлен флаг **аппидрегфлагс для \_ \_ активации \_ RPC \_ по \_** определению, то com SCM выдаст запросы на активацию объектов в серверный процесс com, используя уровень олицетворения на [ \_ \_ \_ уровне \_ идентификаторов для RPC C](impersonation-levels.md).

Если не установлен флаг **аппидрегфлагс для \_ \_ активации \_ RPC \_ по \_ определению** , com SCM выдает запросы на активацию объектов на серверные процессы, используя уровень олицетворения для [ \_ \_ \_ \_ олицетворения на уровне Imp RPC C](impersonation-levels.md).

При использовании флага **\_ \_ RPC активации аппидрегфлагс \_ в процессе \_ \_ обнаружения** необходимо учитывать следующие аспекты безопасности.

-   Флаг **\_ \_ \_ вызова RPC \_ at \_ аппидрегфлагс для активации проблемы** предназначен для использования серверами COM, которые не выполняют работу от имени клиентов в запросах на активацию объектов. для таких серверов наличие запросов на активацию объектов COM SCM на [ \_ \_ уровне IMP RPC с \_ \_ определяет](impersonation-levels.md) сокращение вероятности использования привилегированных маркеров [**SE \_ олицетворения уровня \_ имени**](/windows/desktop/SecAuthZ/privilege-constants) , отображаемого в процессе.

флаг **аппидрегфлагс \_ для \_ активации \_ RPC \_ AT \_ идентифицирован** поддерживается в Windows 7 и более поздних версиях Windows.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Настольные системы](/windows/desktop/winstation/desktops)
</dt> <dt>

[Уровни олицетворения](impersonation-levels.md)
</dt> <dt>

[Интерактивный пользователь](interactive-user.md)
</dt> <dt>

[Моникеры сеанса](/windows/desktop/TermServ/session-monikers)
</dt> <dt>

[Оконные станции](/windows/desktop/winstation/window-stations)
</dt> </dl>

 

 