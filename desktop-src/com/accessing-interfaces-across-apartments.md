---
title: Доступ к интерфейсам в разных апартаментах
description: Доступ к интерфейсам в разных апартаментах
ms.assetid: 4e0467b9-bbf1-410c-8aab-40450a7f963a
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e89e82fa29e768328e6c110349627d32e92ab010ce61fdf64141ad3ca7fe9a54
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119048922"
---
# <a name="accessing-interfaces-across-apartments"></a>Доступ к интерфейсам в разных апартаментах

COM позволяет любому подразделению в процессе получить доступ к интерфейсу, реализованному для объекта в любом другом апартаменте в процессе. Это делается через интерфейс [**иглобалинтерфацетабле**](/windows/desktop/api/ObjIdl/nn-objidl-iglobalinterfacetable) . Этот интерфейс имеет три метода, которые позволяют выполнять следующие действия:

-   Зарегистрируйте интерфейс как *глобальный* интерфейс (процессвиде).
-   Получение указателя на этот интерфейс из любого другого подразделения через файл cookie.
-   Отозвать глобальную регистрацию интерфейса.

Интерфейс [**иглобалинтерфацетабле**](/windows/desktop/api/ObjIdl/nn-objidl-iglobalinterfacetable) — это эффективный способ хранения указателя интерфейса в памяти, доступ к которому можно получить из нескольких подконтейнеров внутри процесса, таких как переменные на уровне процесса и *гибкие* объекты (объекты с поддержкой свободных потоков), содержащие указатели интерфейсов на другие объекты.

Объект Agile не знает о базовой инфраструктуре COM, в которой она выполняется. Иными словами, подразделение, контекст и поток, на котором он выполняется. Объект может храниться в интерфейсах, относящихся к подразделению или контексту. По этой причине вызов этих интерфейсов из любого места, где выполняется компонент Agile, может не всегда работать должным образом. Глобальная таблица интерфейса позволяет избежать этой проблемы, гарантируя, что используется допустимый прокси-сервер (или прямой указатель) для объекта, основанный на месте, где работает объект Agile.

> [!Note]  
> Глобальная таблица интерфейса не переносима между процессами или границами машин, поэтому ее нельзя использовать вместо обычного механизма передачи параметров.

 

Сведения о создании и использовании глобальной таблицы интерфейса см. в следующих разделах:

-   [Создание глобальной таблицы интерфейса](creating-the-global-interface-table.md)
-   [Когда следует использовать глобальную таблицу интерфейса](when-to-use-the-global-interface-table.md)

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Выбор потоковой модели](choosing-the-threading-model.md)
</dt> <dt>

[Многопоточные подразделения](multithreaded-apartments.md)
</dt> <dt>

[Проблемы потоковой обработки в процессе сервера](in-process-server-threading-issues.md)
</dt> <dt>

[Процессы, потоки и подразделения](processes--threads--and-apartments.md)
</dt> <dt>

[Однопотоковое и многопоточное взаимодействие](single-threaded-and-multithreaded-communication.md)
</dt> <dt>

[Подразделения с одним потоком](single-threaded-apartments.md)
</dt> </dl>

 

 




