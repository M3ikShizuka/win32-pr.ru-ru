---
title: Привязка данных через Ипропертинотифисинк
description: Привязка данных через Ипропертинотифисинк
ms.assetid: 275a84b3-65d8-43de-bfba-72e3e5ee59fe
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 337233455872928f824d8cbb903aba247b1ef496d02c0af04223361731fe3663
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119854654"
---
# <a name="data-binding-through-ipropertynotifysink"></a>Привязка данных через Ипропертинотифисинк

Объекты, поддерживающие свойства, например, с помощью OLE-автоматизации и интерфейса **IDispatch** , могут получать уведомления клиентов при изменении значения определенных свойств. Такое свойство называется связываемым, так как уведомления позволяют клиенту синхронизировать собственное отображение текущих значений свойств объекта. Кроме того, одни и те же объекты могут позволить клиенту контролировать, когда разрешено изменение определенных свойств. Такие свойства называются свойствами запроса на изменение.

[**Ипропертинотифисинк**](/windows/desktop/api/OCIdl/nn-ocidl-ipropertynotifysink) — это стандартный интерфейс уведомления, поддерживающий привязку и изменение свойств запроса. **Ипропертинотифисинк** поддерживается из объекта со свойствами в качестве исходящего интерфейса. То есть интерфейс реализуется объектом приемника клиента, а клиент подключает приемник к вспомогательному объекту через механизм точки подключения, описанный выше. **Ипропертинотифисинк** определяется следующим образом:

``` syntax
interface IPropertyNotifySink : IUnknown 
  { 
    HRESULT OnChanged([in] DISPID dispID); 
    HRESULT OnRequestEdit([in] DISPID dispID); 
  } 
 
```

Когда объект хочет уведомить подключенные приемники о том, что свойство, которое может быть привязано к данному идентификатору DISPID, изменилось, оно вызывает [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged). Если объект изменяет несколько свойств одновременно, он может передать Неизвестный идентификатор DISPID \_ неизвестному для **изменения** в случае, если клиент обновляет свой кэш всех интересующих значений свойств.

Когда свойство запроса изменения собирается изменить, объект может попросить клиента, будет ли он допускать это изменение. Объект вызывает [**уведомление OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) , ПЕРЕДАВ идентификатор DISPID рассматриваемого свойства (или DISPID \_ Unknown для обнаружения всех свойств). Приемник клиента возвращает "S" \_ , чтобы указать, что изменение разрешено, или \_ "ложь" (или "ошибка"), чтобы указать, что изменение не разрешено. Когда объект вызывает **уведомление OnRequestEdit**, он должен соблюдать все пожелания клиента, следуя точной семантике параметров s \_ OK и s \_ false.

Обратите внимание, что [**уведомление OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) нельзя использовать для проверки данных, так как во время вызова новое значение свойства пока недоступно. Уведомление может использоваться только для управления состоянием только для чтения для свойства.

Объекты определяют, какие свойства могут быть привязаны, и запрашивают изменение и помечают такие свойства в сведениях о типе объекта. В сведениях о типе атрибут, допускающий привязку, помечает свойство как поддерживающее [**изменение**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged). Атрибут рекуестедит помечает свойство как поддерживающее [**уведомление OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit).

Одно свойство может поддерживать оба варианта поведения, в которых [**уведомление OnRequestEdit**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onrequestedit) вызывается первым, и только если разрешено изменение с именем [**OnChanged**](/windows/desktop/api/OCIdl/nf-ocidl-ipropertynotifysink-onchanged) .

Единственным исключением поведения таких свойств является то, что уведомления не отправляются в результате инициализации или загрузки объекта. В таких случаях предполагается, что все свойства меняются, и все должно быть разрешено изменять. Поэтому уведомления для этого интерфейса имеют смысл только в контексте полностью инициализированного или загруженного объекта.

К свойствам в сведениях о типе объекта можно применить два других атрибута. Атрибут дефаултбинд помечает связываемое свойство как одно, которое лучше всего представляет состояние объекта в целом. Атрибут дисплайбинд помечает связываемое свойство как подходящее для вывода в пользовательском интерфейсе клиента.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Страницы свойств и вкладки свойств](property-pages-and-property-sheets.md)
</dt> </dl>

 

 




