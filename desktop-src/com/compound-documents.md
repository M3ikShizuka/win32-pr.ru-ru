---
title: Составные документы
description: Составные документы OLE позволяют пользователям, работающим в одном приложении, работать с данными, написанными в различных форматах и производными от нескольких источников.
ms.assetid: d17dc0dd-3115-4830-8c6b-694a8d1accaa
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 76f12e0228b7c8c1d74e4ec33d8069490351f77f
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "104134682"
---
# <a name="compound-documents"></a>Составные документы

Составные документы OLE позволяют пользователям, работающим в одном приложении, работать с данными, написанными в различных форматах и производными от нескольких источников. Например, пользователь может вставить в документ обработки текста граф, созданный во втором приложении, и объект Sound, созданный в третьем приложении. Активация графа приводит к тому, что второе приложение загружает пользовательский интерфейс или по крайней мере ту часть, которая содержит инструменты, необходимые для редактирования объекта. Активация объекта Sound приводит к тому, что третье приложение воспроизводит его. В обоих случаях пользователь может манипулировать данными из внешних источников в контексте одного документа.

Технологии составных документов OLE — это основы, состоящие из модели COM, структурированного хранилища и равномерной пересылки данных. Как показано ниже, каждая из этих основных технологий играет важную роль в составных документах OLE:

<dl> <dt>

<span id="COM"></span><span id="com"></span>-
</dt> <dd>

Объект составного документа — это, по сути, объект COM, который можно внедрить в существующий документ или связать с ним. В качестве объекта COM объект составного документа предоставляет интерфейс [**IUnknown**](/windows/desktop/api/Unknwn/nn-unknwn-iunknown) , через который клиенты могут получать указатели на другие интерфейсы, в том числе несколько, например [**иолеобжект**](/windows/desktop/api/OleIdl/nn-oleidl-ioleobject), [**иолелинк**](/windows/desktop/api/OleIdl/nn-oleidl-iolelink)и [**IViewObject2**](/windows/desktop/api/OleIdl/nn-oleidl-iviewobject2), которые предоставляют специальные функции, уникальные для объектов составного документа.

</dd> <dt>

<span id="Structured_Storage"></span><span id="structured_storage"></span><span id="STRUCTURED_STORAGE"></span>Структурированное хранилище
</dt> <dd>

Объект составного документа должен реализовывать [**иперсистстораже**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststorage) или, при необходимости, интерфейсы [**IPersistStream**](/windows/desktop/api/ObjIdl/nn-objidl-ipersiststream) для управления собственным хранилищем. Контейнер, используемый для создания составных документов, должен предоставлять интерфейс [**IStorage**](/windows/desktop/api/objidl/nn-objidl-istorage) , через который объекты хранят и извлекают данные. Контейнеры практически всегда предоставляют экземпляры **IStorage** , полученные из реализации составных файлов OLE. Контейнеры также должны использовать интерфейсы **иперсистстораже** и/или **IPersistStream** объекта.

</dd> <dt>

<span id="Uniform_Data_Transfer"></span><span id="uniform_data_transfer"></span><span id="UNIFORM_DATA_TRANSFER"></span>Однородное Передача данных
</dt> <dd>

Приложения, поддерживающие составные документы, должны реализовать интерфейс [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) , так как внедренные объекты и связанные объекты начинаются как данные, перенесенные с помощью специальных форматов буфера обмена OLE, а не стандартные форматы буфера обмена Microsoft Windows. Другими словами, форматирование данных как внедренного или связанного объекта — это еще один вариант, предоставляемый унифицированной моделью обмена данными OLE.

</dd> </dl>

Технология составных документов OLE дает преимущества как разработчикам программного обеспечения, так и пользователям. Вместо того, чтобы прикрам каждую представить функцию в единое приложение, разработчики программного обеспечения теперь могут свободно работать, если они предназначены для разработки небольших, более специализированных приложений, которые используют другие приложения для предоставления дополнительных функций. В случаях, когда разработчик программного обеспечения решает предоставить приложение с возможностями, которые выходят за пределы основных функций, разработчик может реализовать эти дополнительные службы в виде отдельных библиотек DLL, которые загружаются в память только при необходимости их служб. Пользователи получают преимущества от меньшего, более быстрого, более производительного программного обеспечения, которое они могут комбинировать и сопоставлять по мере необходимости, управляя всеми необходимыми компонентами в рамках одного главного документа.

Дополнительные сведения см. в следующих разделах:

-   [Контейнеры и серверы](containers-and-servers.md)
-   [Связывание и внедрение](linking-and-embedding.md)
-   [Обработчики объектов](object-handlers.md)
-   [Внутрипроцессный сервер](in-process-servers.md)
-   [Связанные объекты и моникеры](linked-objects-and-monikers.md)
-   [Уведомления](notifications.md)
-   [Интерфейсы составных документов](compound-document-interfaces.md)
-   [Состояния объектов](object-states.md)
-   [Реализация активации In-Place](implementing-in-place-activation.md)
-   [Создание связанных и внедренных объектов из существующих данных](creating-linked-and-embedded-objects-from-existing-data.md)
-   [Просмотр кэширования](view-caching.md)

## <a name="related-topics"></a>См. также

<dl> <dt>

[Передача данных](data-transfer.md)
</dt> <dt>

[Структурированное хранилище](/windows/desktop/Stg/structured-storage-start-page)
</dt> </dl>

 

 