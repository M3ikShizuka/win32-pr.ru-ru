---
title: преферредсервербитнесс
description: Задает предпочтительную архитектуру (32-бит или 64-бит) для этого COM-сервера.
ms.assetid: ef770039-1624-4256-aa09-1443695c1a1f
keywords:
- COM-значение реестра Преферредсервербитнесс
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 107a8c5b1504c5a59ca2ab178cd46236335d44ca
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "104339356"
---
# <a name="preferredserverbitness"></a>преферредсервербитнесс

Задает предпочтительную архитектуру (32-бит или 64-бит) для этого COM-сервера.

## <a name="registry-entry"></a>Запись реестра

```
HKEY_LOCAL_MACHINE\SOFTWARE\Classes\AppID
   {AppID_GUID}
      PreferredServerBitness = value
```

## <a name="remarks"></a>Комментарии

Это значение **reg \_ DWORD** , которое доступно только в 64-разрядных версиях Windows.



| Значение | Описание                                                                                                                                                                                                |
|-------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1     | Сопоставьте серверную архитектуру с архитектурой клиента. Например, если клиент является 32-битным, используйте 32-разрядную версию сервера, если она доступна. В противном случае запрос на активацию клиента завершится ошибкой. |
| 2     | Используйте 32-разрядную версию сервера. Если такой объект не существует, запрос на активацию клиента завершится ошибкой.                                                                                                      |
| 3     | Используйте 64-разрядную версию сервера. Если такой объект не существует, запрос на активацию клиента завершится ошибкой.                                                                                                      |



 

Если это значение отсутствует, то:

-   Если компьютер, на котором размещается сервер, работает под управлением Windows XP или Windows Server 2003 без пакета обновления 1 (SP1) или более поздней версии, то COM предпочитает версию сервера, поддерживающую 64 бит, если он доступен. в противном случае будет активирована 32-разрядная версия сервера.
-   Если компьютер, на котором размещен сервер, работает под управлением Windows Server 2003 с пакетом обновления 1 (SP1) или более поздней версии, COM попытается сопоставить серверную архитектуру с архитектурой клиента. Иными словами, для 32-разрядного клиента COM активирует 32-разрядный сервер, если он доступен. в противном случае будет активирована 64-разрядная версия сервера. Для 64-разрядного клиента COM активирует 64-разрядный сервер, если он доступен. в противном случае будет активирован 32-разрядный сервер.

Клиент также может задать собственную настройку архитектуры с помощью КЛСКТКС \_ активировать \_ 32 \_ bit \_ server и клскткс \_ активировать \_ 64 \_ bit \_ Server flags, и это переопределит предпочтения сервера. Дополнительные сведения и диаграмма возможных взаимодействий между параметрами архитектуры клиента и сервера см. в разделе [**клскткс**](/windows/win32/api/wtypesbase/ne-wtypesbase-clsctx).

## <a name="related-topics"></a>См. также

<dl> <dt>

[**клскткс**](/windows/win32/api/wtypesbase/ne-wtypesbase-clsctx)
</dt> </dl>

 

 