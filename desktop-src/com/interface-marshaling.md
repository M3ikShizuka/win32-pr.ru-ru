---
title: Маршалирование интерфейса
description: Маршалирование интерфейса
ms.assetid: 71069bd3-5f90-406a-be78-bb1af9b1c1c0
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0cdee8762fb9ef69507fb5b2c4295531dd87a98d5174ab4e10f05a66cab718d4
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "120029874"
---
# <a name="interface-marshaling"></a>Маршалирование интерфейса

Если вы не уверены, что ваш интерфейс никогда не будет использоваться в границах апартамента, потока или процесса, необходимо решить, как обеспечить поддержку маршалирования для интерфейсов. Существует три способа обеспечения поддержки маршалирования:

-   Напишите собственный код прокси или заглушки, который вызывает канал COM, который, в свою очередь, вызывает библиотеки времени выполнения RPC. Теоретически это можно сделать, но на практике практически невозможно выполнить без значительного объема усилий.
-   Опишите интерфейсы в файле языка определения интерфейса (IDL) и используйте компилятор MIDL для создания библиотеки прокси-сервера или заглушки. Этот метод обеспечивает максимальную производительность и максимальную гибкость в отношении допустимых типов данных. Используя заглушки прокси-сервера, созданные с помощью MIDL, можно управлять не только управлением памятью, но даже упаковкой и распаковкой сложных типов данных на разных платформах.
-   Используйте MIDL для создания библиотеки типов, которую система использует для обеспечения поддержки маршалирования во время выполнения. Это самый простой способ реализации поддержки упаковки. Все, что нужно сделать, — это создать библиотеку типов и зарегистрировать ее. Интерфейсы должны быть совместимы со службой автоматизации ( [**oleautomation**](/windows/desktop/Midl/oleautomation) или [**Dual**](/windows/desktop/Midl/dual)), которая помещает некоторые ограничения на типы данных, которые можно использовать в качестве параметров метода. однако в большинстве случаев преимущество использования интерфейсов для программ, написанных на других языках, таких как Microsoft Visual Basic и Java, приводит к нарушениям ограничений на типы данных.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Обмен данными между объектами](inter-object-communication.md)
</dt> </dl>

 

 