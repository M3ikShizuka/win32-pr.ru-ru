---
title: События в COM и подключаемых объектах
description: Когда программа обнаруживает что-то произошедшее, она может уведомлять ее клиентов.
ms.assetid: f6ffbd1d-4bc1-4dc2-b3ed-ee12359e3d75
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aa5115cfd08d57658eec879d44b4361e88965b3c
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/29/2020
ms.locfileid: "104069488"
---
# <a name="events-in-com-and-connectable-objects"></a>События в COM и подключаемых объектах

Когда программа обнаруживает что-то произошедшее, она может уведомлять ее клиентов. Например, если программа биржевых котировок обнаруживает изменение цены акции, она может уведомлять всех клиентов об изменении. Этот процесс уведомления называется *срабатыванием события*.

При использовании COM объекты сервера могут использовать события COM для запуска событий без каких-либо сведений о том, какие объекты будут уведомлены. Объекты также могут использовать *подключаемые объекты* для поддержки подробных сведений о клиентах, которые запросили уведомления.

Подключаемые объекты COM предоставляют исходящие интерфейсы своим клиентам в дополнение к входящим интерфейсам. В результате объекты и их клиенты могут взаимодействовать в двунаправленной связи. Входящие интерфейсы реализуются на объекте и получают вызовы от внешних клиентов объекта, а исходящие интерфейсы реализуются на приемнике клиента и получают вызовы от объекта. Объект определяет интерфейс, который необходимо использовать, и клиент реализует его.

Объект определяет входящие интерфейсы и предоставляет реализации этих интерфейсов. Входящие интерфейсы доступны клиентам через метод [**IUnknown:: QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) объекта. Клиенты вызывают методы входящего интерфейса для объекта, и объект выполняет необходимые действия от имени клиента.

Исходящие интерфейсы также определяются объектом, но клиент предоставляет реализации исходящих интерфейсов для объекта приемника, создаваемого клиентом. Затем объект вызывает методы исходящего интерфейса для объекта приемника, чтобы уведомить клиента об изменениях в объекте, активировать события в клиенте, чтобы запросить что-либо от клиента, или, на самом деле, для любой цели, с которой поступает создатель объекта.

Примером исходящего интерфейса является интерфейс Ибуттонсинк, определенный элементом управления "Кнопка отправки" для уведомления клиентов о событиях. Например, объект Button вызывает Ибуттонсинк:: OnClick в объекте приемника клиента, когда пользователь нажимает кнопку на экране. Элемент управления "Кнопка" определяет исходящий интерфейс. Чтобы клиент кнопки обрабатывал событие, клиент должен реализовать этот исходящий интерфейс в объекте приемника, а затем подключить этот приемник к элементу управления Button. Затем, когда события происходят в кнопке, кнопка вызывает приемник, в то время как клиент может выполнить любое действие, которое он хочет назначить нажатию кнопки.

Подключаемые объекты предоставляют общий механизм обмена данными между клиентами и объектами. Любой объект, желающий предоставлять события или уведомления любого вида, может использовать эту технологию. В дополнение к общей технологии Connected, COM предоставляет множество специальных приемников и интерфейсов сайта, используемых объектами для уведомления клиентов о конкретных событиях, интересующих клиента. Например, [**иадвисесинк**](/windows/desktop/api/ObjIdl/nn-objidl-iadvisesink) может использоваться объектами для уведомления клиентов о данных и просмотра изменений в объекте.

Дополнительные сведения см. в следующих разделах:

-   [Архитектура подключаемых объектов](architecture-of-connectable-objects.md)
-   [Подключаемые интерфейсы объектов](connectable-object-interfaces.md)

 

 




