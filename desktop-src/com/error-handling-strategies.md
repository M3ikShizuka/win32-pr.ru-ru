---
title: Стратегии обработки ошибок
description: Стратегии обработки ошибок
ms.assetid: 8d03ede8-0661-43dc-adaf-3c1f5fc1687e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 36c594a8b1e5baf0eab3d928b8f1b861b7f0160d
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "126971372"
---
# <a name="error-handling-strategies"></a>Стратегии обработки ошибок

Поскольку методы интерфейса являются виртуальными, вызывающий объект не может получить информацию о полном наборе значений, которые могут быть возвращены из любого вызова. Одна реализация метода может возвращать пять значений; другой может вернуть восемь.

В документации перечислены общие значения, которые могут возвращаться для каждого метода. Это значения, которые необходимо проверить и обрабатывать в коде, так как они имеют особые значения. Другие значения могут быть возвращены, но, поскольку они не имеют смысла, писать специальный код для их обработке не требуется. Простая проверка нулевого или ненулевого значения является достаточной.

## <a name="hresult-values"></a>Значения HRESULT

Возвращаемое значение функций и методов COM является значением **HRESULT**. Значения некоторых значений HRESULT были изменены в COM, чтобы исключить все дублирование и перекрытие с кодами системных ошибок. Те, которые дублируют дублирование кодов системных ошибок, были изменены на \_ Win32 устройств, а те, которые перекрываются, остаются в \_ неопределенном виде. В следующей таблице перечислены общие значения **HRESULT** и их значения.



| HRESULT                    | Значение                 | Описание                                                                                                                                        |
|----------------------------|-----------------------|----------------------------------------------------------------------------------------------------------------------------------------------------|
| \_прервать<br/>        | 0x80004004<br/> | Операция прервана из-за неизвестной ошибки.<br/>                                                                              |
| E \_ ACCESSDENIED<br/> | 0x80070005<br/> | Общая ошибка отказа в доступе.<br/>                                                                                                          |
| \_Ошибка E<br/>         | 0x80004005<br/> | Произошла неопределенная ошибка.<br/>                                                                                                    |
| E, \_ маркер<br/>       | 0x80070006<br/> | Использован недопустимый маркер.<br/>                                                                                                             |
| E \_ INVALIDARG<br/>   | 0x80070057<br/> | Один или несколько аргументов недопустимы.<br/>                                                                                                      |
| \_интерфейс E<br/>  | 0x80004002<br/> | Метод [**QueryInterface**](/windows/desktop/api/Unknwn/nf-unknwn-iunknown-queryinterface(q)) не распознал запрошенный интерфейс. Интерфейс не поддерживается.<br/> |
| E \_ нотимпл<br/>      | 0x80004001<br/> | Метод не реализован.<br/>                                                                                                          |
| E \_ OUTOFMEMORY<br/>  | 0x8007000E<br/> | Методу не удалось выделить необходимую память.<br/>                                                                                         |
| \_в ожидании<br/>      | 0x8000000A<br/> | Данные, необходимые для завершения операции, пока недоступны.<br/>                                                                      |
| \_указатель E<br/>      | 0x80004003<br/> | Использован недопустимый указатель.<br/>                                                                                                            |
| \_непредвиденная E<br/>   | 0x8000FFFF<br/> | Произошла фатальная ошибка.<br/>                                                                                                    |
| S \_ false<br/>        | 0x00000001<br/> | Метод завершился удачно и вернул логическое значение **false**.<br/>                                                                          |
| \_ОК<br/>           | 0x00000000<br/> | Метод выполнен успешно. Если ожидается логическое возвращаемое значение, возвращается значение **true**.<br/>                                            |



 

## <a name="network-errors"></a>Ошибки сети

Если первые четыре цифры кода ошибки 8007, это указывает на системную или сетевую ошибку. Для декодирования ошибок этих типов можно использовать команду **net** . Чтобы декодировать ошибку, сначала преобразуйте последние четыре цифры шестнадцатеричного кода ошибки в тип Decimal. Затем в командной строке введите следующую команду, где десятичный код заменяется возвращаемым значением, которое необходимо декодировать:

**net helpmsg <** _десятичный \_ код_*_>_*

Команда NET возвращает описание ошибки. Например, если COM возвращает ошибку 8007054B, преобразуйте 054B в Decimal (1355). Затем введите следующую команду.

**NET HELPMSG 1355**

Команда NET возвращает описание ошибки: "указанный домен не существует".

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Обработка ошибок в COM](error-handling-in-com.md)
</dt> </dl>

 

 





