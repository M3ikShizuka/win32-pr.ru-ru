---
title: Сведения о реестре элементов управления ActiveX
description: Сведения о реестре элементов управления ActiveX
ms.assetid: fda5b1e6-2048-4df7-ba8f-145652e3883c
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b6b180b327a4239b220185a9073ebc7bc0826c39
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "104533524"
---
# <a name="activex-controls-registry-information"></a>Сведения о реестре элементов управления ActiveX

Существует ряд параметров и флагов, которые используются в реестре. Кроме того, элементы управления могут поддерживать категории компонентов для классификации предоставляемых ими функций.

Разделы реестра, связанные с элементами управления, отмечены звездочкой в следующем дереве:

```
HKEY_CLASSES_ROOT
   CLSID
      {control_CLSID}
         ProgID = <identifier>
         InprocServer32 = <filename>.dll
         *DefaultIcon = <filename>.<ext>,resourceID
         *ToolboxBitmap32 = <filename>.<ext>,resourceID
         *Control
         verb
            *n = &Properties...
         *MiscStatus = 0
         TypeLib = {object_typelibID}
         *Version = version_number
```

Запись **дефаултикон** используется для задания значка, отображаемого при сворачивании элемента управления в значок. Функция [**екстрактикон**](/windows/win32/api/shellapi/nf-shellapi-extracticona) используется для получения значка из. DLL или. Указанный EXE файл.

Запись **ToolboxBitmap32** определяет имя модуля и идентификатор ресурса для \* точечного рисунка размером 16 15, который будет использоваться для кнопки панели инструментов или панели элементов. Стандартный размер значка Windows слишком велик для использования в этой цели. Эта запись специально поддерживает контейнеры элементов управления с режимом конструктора, в котором один выбирает элементы управления и помещает их в разрабатываемую форму. Например, в Visual Basic значок элемента управления отображается в панели элементов Visual Basic в режиме конструктора.

Запись **элемента управления** помечает объект как элемент управления. Эта запись часто используется контейнерами для заполнения диалоговых окон. Контейнер использует этот подраздел, чтобы определить, следует ли включать объект в диалоговое окно, в котором отображаются элементы управления.

**Вставляемый** вложенный ключ можно также использовать с элементами управления в зависимости от того, может ли объект работать только как внедренный объект на месте без специальных функций управления. Объекты, помеченные как **вставляемые** , отображаются в диалоговом окне «Вставка объекта» своего контейнера. **Вставляемая** запись обычно означает, что элемент управления был протестирован с контейнерами, не являющимися элементом управления.

И **вставляемые** , и вложенные ключи **элемента управления** являются необязательными. Элемент управления может опустить **вставляемый** подраздел, если он не предназначен для работы с более старыми контейнерами, которые не понимают элементы управления. Элемент управления может опускать ключ **элемента управления** , если он предназначен только для работы с конкретным контейнером и поэтому не хочет вставлять его в другие контейнеры.

Элементы управления должны иметь команду Properties, \_ Свойства олеиверб, а также другие поддерживаемые команды. Команда Properties, а также стандартная команда ОЛЕИВЕРБ \_ PRIMARY указывает элементу управления на отображение страницы свойств. Команда свойства отображается как элемент свойства в меню контейнера, когда элемент управления активен. Таким образом, элемент управления может отображать собственную страницу свойств, что позволяет пользователю получить некоторые полезные функции, даже если контейнер не обрабатывает элементы управления.

Элемент управления определяет ключ **мискстатус** , который описывает себя для потенциальных контейнеров. Биты принимают значения от [**олемиск**](/windows/win32/api/oleidl/ne-oleidl-olemisc), а элементы управления добавляют несколько значений в это перечисление. Дополнительные сведения см. в описании значений перечисления **олемиск** . Клиент может получить эти сведения, вызвав [**иолеобжект:: жетмискстатус**](/windows/desktop/api/OleIdl/nf-oleidl-ioleobject-getmiscstatus) без предварительного создания экземпляра элемента управления.

Наконец, **Version** описывает версию элемента управления, которая должна соответствовать версии библиотеки типов, связанной с этим элементом управления.

Кроме того, в сведениях о типе элемента управления атрибут помечает запись coclass как описание элемента управления.

 

 