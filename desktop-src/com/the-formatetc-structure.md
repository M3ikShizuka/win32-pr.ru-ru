---
title: Структура ФОРМАТЕТК
description: Структура ФОРМАТЕТК представляет собой обобщенный формат буфера обмена, дополненный к целевому устройству, аспекту или представлению данных, а также носителю хранилища.
ms.assetid: 46d8988a-4b97-4c86-8b1b-db87044a7e01
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6ece0079cf2c0f07b7356f07ee2c53b1279b7ce7
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "103794058"
---
# <a name="the-formatetc-structure"></a>Структура ФОРМАТЕТК

Структура ФОРМАТЕТК представляет собой обобщенный формат буфера обмена, дополненный к целевому устройству, *аспекту* или представлению данных, а также носителю хранилища. Потребитель данных, например приложение-контейнер OLE, передает структуру [**форматетк**](/windows/win32/api/objidl/ns-objidl-formatetc) в качестве аргумента в вызовах [**IDataObject**](/windows/desktop/api/ObjIdl/nn-objidl-idataobject) , чтобы указать тип данных, которые он желает из источника данных, например объект составного документа. Источник использует структуру **форматетк** для описания форматов, которые он может предоставить.

[**Форматетк**](/windows/win32/api/objidl/ns-objidl-formatetc) может описывать практически любые данные, в том числе другие объекты, такие как моникеры. Контейнер может запросить один из своих внедренных объектов, чтобы получить список его форматов данных, вызвав [**IDataObject:: енумформатетк**](/windows/desktop/api/ObjIdl/nf-objidl-idataobject-enumformatetc), который возвращает объект перечислителя, реализующий интерфейс [**иенумформатетк**](/windows/desktop/api/ObjIdl/nn-objidl-ienumformatetc) . Вместо ответа просто, что он имеет текст и точечный рисунок, объект может предоставить подробное описание данных, включая устройство (обычно экран или принтер), для которого он отображается, аспект, отображаемый пользователю (полное содержимое, эскиз, значок или отформатированный для печати), и носитель, содержащий данные (глобальная память, дисковый файл, объект хранилища или Stream). Эта возможность тесно описывать данные, в то же время, обеспечивает более высокое качество вывода на печать и на экране, а также повышает эффективность просмотра данных, где эскиз эскиза гораздо быстрее извлекается и отображается, чем полностью детализированная отрисовка.

В следующей таблице перечислены поля структуры данных [**форматетк**](/windows/win32/api/objidl/ns-objidl-formatetc) и указанная ими информация.



| Поле                   | Что определяет                                                                                                                                                                                                                                                                    |
|-------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **кфформат**<br/> | Формат, в котором данные должны быть визуализированы, что может быть стандартным форматом буфера обмена, собственным форматом или форматом OLE. Дополнительные сведения о форматах OLE см. в разделе [составные документы](compound-documents.md).<br/>                                          |
| **ptd**<br/>      | Структура [**двтаржетдевице**](/windows/win32/api/objidl/ns-objidl-dvtargetdevice) , которая содержит достаточно информации о целевом устройстве Windows, таком как экран или принтер, чтобы можно было создать обработчик контекста устройства (HDC) с помощью функции [**креатедк**](/windows/desktop/api/wingdi/nf-wingdi-createdca) . <br/> |
| **дваспект**<br/> | Аспект или представление данных для подготовки к просмотру; может быть полным содержимым, эскизом эскиза, значком или отформатированным для печати.<br/>                                                                                                                                  |
| **линдекс**<br/>   | Часть аспекта, представляющая интерес; в настоящее время значение должно быть равно-1, что означает, что все представление является интересным.<br/>                                                                                                                                |
| **тимед**<br/>    | Среда хранения данных, которая может представлять собой глобальную память, дисковый файл или экземпляр одного из интерфейсов структурированного хранилища COM.<br/>                                                                                                                                   |



 

## <a name="related-topics"></a>См. также

<dl> <dt>

[Форматы данных и передачи мультимедиа](data-formats-and-transfer-media.md)
</dt> </dl>

 

