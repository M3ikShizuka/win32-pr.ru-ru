---
title: Использование COM-объектов в сервере сценариев Windows
description: Сервер сценариев Microsoft Windows — это служебная программа для работы со скриптами, которую можно использовать для выполнения скриптов в базовой операционной системе.
ms.assetid: b13c1bdf-91ce-42a2-b66a-20d68952bb34
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b7cb28fc0e388ba69f28c56e780d058d27f9e165
ms.sourcegitcommit: 70f39ec77d19d3c32c376ee2831753d2cafae41a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/09/2021
ms.locfileid: "103820469"
---
# <a name="using-com-objects-in-windows-script-host"></a>Использование COM-объектов в сервере сценариев Windows

Сервер сценариев Microsoft Windows — это служебная программа для работы со скриптами, которую можно использовать для выполнения скриптов в базовой операционной системе. Сервер сценариев Windows можно использовать для автоматизации общих задач, а также для создания мощных макросов и сценариев входа в систему. Сервер сценариев Windows поставляется с обработчиками сценариев VBScript и JScript ActiveX. Другие производители программного обеспечения предоставляют обработчики скриптов ActiveX для таких языков, как Перлскрипт, Пскрипт, Python и др.

Чтобы использовать COM-объект в скрипте, выполняемом сервером сценариев Windows, необходимо сначала создать экземпляр объекта. После создания COM-объекта его можно использовать в скриптах.

Сервер сценариев Windows состоит из двух приложений. Один запускает сценарии с рабочего стола Windows ( `WScript.exe` ), а другой запускает сценарии из командной строки ( `CScript.exe` ).

Чтобы запустить сценарий с рабочего стола, просто дважды щелкните файл сценария. Файлы скриптов представляют собой текстовые файлы. По соглашению файлы VBScript имеют расширение `.vbs` и файлы JScript `.js` .

Чтобы запустить сценарий из командной строки, запустите `Cscript.exe` приложение с командной строкой, как показано ниже.

```console
cscript "c:\\sample scripts\\chart.vbs"
```

где `c:\\sample scripts\\chart.vbs` — путь к файлу, содержащему скрипт.

Вы можете распечатать список параметров, поддерживаемых Cscript.exe, введя следующую командную строку:

```console
call cscript //?
```

Чтобы использовать COM-объект в скрипте, выполняемом сервером сценариев Windows, необходимо сначала создать экземпляр объекта. В VBScript это можно сделать, вызвав `CreateObject()` метод. В JScript один может использовать либо `ActiveXObject` объект, либо `WScript.CreateObject()` метод. В следующем примере демонстрируется вызов `CreateObject()` с использованием VBScript:


```VB
Dim objXL
Set objXL = CreateObject("Excel.Application")
 
```



В следующем примере показано создание `ActiveXObject` объекта с помощью JScript:


```JScript
var objXL = new ActiveXObject("Excel.Application");
 
```
В качестве альтернативы можно использовать `WScript.CreateObject()` метод внутри JScript:

```JScript
var objXL = WScript.CreateObject("Excel.Application");
```


После создания экземпляра COM-объекта можно написать сценарий, использующий объект, например:


```VB
objXL.Visible = true;
 
```



В дополнение к методу CreateObject и объекту Активексобжект, как VBScript, так и JScript предоставляют метод GetObject, возвращающий экземпляр объекта.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Создание сценариев с помощью COM-объектов](scripting-with-com-objects.md)
</dt> </dl>

 

 




