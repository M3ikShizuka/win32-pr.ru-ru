---
description: Содержит атрибуты общего ресурса DDE, поддерживаемые диспетчером общих баз данных NetDDE (DSDM).
ms.assetid: f4101553-06ef-4f83-87c7-5b6fdf0467e5
title: Структура НДДЕШАРЕИНФО (Нддеапи. h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- NDDESHAREINFO
api_type:
- HeaderDef
api_location:
- Nddeapi.h
ms.openlocfilehash: 975382272a4e2c7cc56b0ddf593905b4d745a48b
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127458175"
---
# <a name="nddeshareinfo-structure"></a>Структура НДДЕШАРЕИНФО

\[Сетевой DDE больше не поддерживается. Nddeapi.dll имеется в Windows Vista, но все вызовы функций возвращают ндде \_ не \_ реализованы.\]

Содержит атрибуты общего ресурса DDE, поддерживаемые диспетчером общих баз данных NetDDE (DSDM). Дескриптор безопасности, связанный с каждым общим ресурсом DDE, не передается через эту структуру, но доступ к ним осуществляется с помощью конкретных функций. API-интерфейс NetDDE DSDM принимает эту структуру для функций Set. для функций Get функция DSDM возвращает структуру, упакованную в предоставленный буфер, а также данные, на которые ссылаются члены **лпсзшаренаме**, **лпсзапптопиклист** и **лпсзитемлист**.

## <a name="syntax"></a>Синтаксис


```C++
typedef struct _NDDESHAREINFO {
  LONG   lRevision;
  LPTSTR lpszShareName;
  LONG   lShareType;
  LPTSTR lpszAppTopicList;
  LONG   fSharedFlag;
  LONG   fService;
  LONG   fStartAppFlag;
  LONG   nCmdShow;
  LONG   qModifyId[2];
  LONG   cNumItems;
  LPTSTR lpszItemList;
} NDDESHAREINFO, *PNDDESHAREINFO;
```



## <a name="members"></a>Участники

<dl> <dt>

**лревисион**
</dt> <dd>

Уровень редакции структуры **нддешареинфо** . В настоящее время уровень редакции равен 1.

</dd> <dt>

**лпсзшаренаме**
</dt> <dd>

Имя общей папки. Длина этой строки не должна превышать максимально \_ нддешаренаме символов.

</dd> <dt>

**лшаретипе**
</dt> <dd>

Один или несколько типов общих ресурсов DDE. Этот член может быть сочетанием следующих поддерживаемых типов общего ресурса DDE.



| Тип общего ресурса                                                                                                                                                                                                                           | Значение                                                        |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------|
| <span id="SHARE_TYPE_NEW"></span><span id="share_type_new"></span><dl> <dt>**Общий доступ \_ Введите \_ Новый**</dt> <dt>0x02</dt> </dl>          | Общая папка содержит пару "приложение — OLE" или "раздел".<br/>   |
| <span id="SHARE_TYPE_OLD"></span><span id="share_type_old"></span><dl> <dt>**Общий доступ \_ Введите \_ старый**</dt> <dt>0x01</dt> </dl>          | Общая папка содержит пару "приложение-раздел" DDE.<br/>    |
| <span id="SHARE_TYPE_STATIC"></span><span id="share_type_static"></span><dl> <dt>**Общий доступ \_ Введите \_ статический**</dt> <dt>0x04</dt> </dl> | Общая папка содержит статическую пару "приложение-раздел".<br/> |



 

</dd> <dt>

**лпсзапптопиклист**
</dt> <dd>

Указатель на буфер, содержащий строки, заканчивающиеся нулем, для пар «DDE», «OLE» и «статическая тема приложения/раздела». Буфер должен иметь следующий формат:

``` syntax
<DDE application name>|<DDE topic name>\0
<OLE application name>|<OLE topic name>\0
<static application name>|<static topic name>\0\0
```

</dd> <dt>

**фшаредфлаг**
</dt> <dd>

Если этот член имеет **значение false**, общий ресурс DDE не позволит удаленным пользователям взаимодействовать через него с помощью DDE. Однако локальные пользователи по-прежнему могут взаимодействовать через общий ресурс DDE. Ссылки на локальные клиенты всегда подразумеваются, если соответствующие списки DACL предоставляют доступ.

</dd> <dt>

**фсервице**
</dt> <dd>

Если этот член задан, общий ресурс DDE не будет проверять, установлен ли этот пользователь как доверенный, прежде чем разрешить взаимодействие DDE.

</dd> <dt>

**фстартаппфлаг**
</dt> <dd>

Если этот элемент задан и общая папка является доверенной для запуска приложений, NetDDE попытается запустить приложение, указанное в **лпсзапптопиклист** , если не может изначально начать сеанс DDE с приложением.

</dd> <dt>

**нкмдшов**
</dt> <dd>

Когда NetDDE запускает приложение для инициации диалога DDE, это значение отправляется в приложение с помощью параметра *нкмдшов* функции [**WinMain**](/windows/win32/api/winbase/nf-winbase-winmain) . Он определяет предпочтительный режим отображения окна приложения в. Этот параметр важен только в том случае, если **фстартаппфлаг** является активным. Пользователь, выполнивший вход в систему, в контексте которого запущено приложение, может также переопределить этот параметр при повышении общего ресурса до состояния доверия. Значение по умолчанию для этого элемента — SW \_ шовмаксимизед.

</dd> <dt>

**кмодифид**
</dt> <dd>

8-байтовый серийный номер, указывающий серийный номер изменения общего ресурса DDE. Каждый раз, когда общий ресурс DDE изменяется вызовом [**нддешаресетинфо**](nddesharesetinfo.md) или [**нддесетшаресекурити**](nddesetsharesecurity.md) , эти значения изменяются.

</dd> <dt>

**кнумитемс**
</dt> <dd>

Число элементов, перечисленных в **лпсзитемлист**. Если **кнумитемс** равен нулю, то **лпсзитемлист** является пустым, а сведения об общем ресурсе и связанном дескрипторе безопасности применяются ко всем элементам, обслуживаемым связанным приложением.

</dd> <dt>

**лпсзитемлист**
</dt> <dd>

Указатель на буфер, содержащий строки, заканчивающиеся нулем, указывающие элементы, которые клиентское приложение в транзакции DDE может запрашивать или запускать циклы Advise. Если в списке нет элементов, общий ресурс DDE позволяет использовать любой элемент. Число элементов в списке должно соответствовать количеству **кнумитемс** .

</dd> </dl>

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|--------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows 2000 Professional \[только классические приложения\]<br/>                           |
| Минимальная версия сервера<br/> | Windows 2000 Server \[только классические приложения\]<br/>                                 |
| Заголовок<br/>                   | <dl> <dt>Нддеапи. h</dt> </dl> |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[общие сведения о Exchange сетевых платформа динамических данных](network-dynamic-data-exchange.md)
</dt> <dt>

[Структуры сетевого DDE](network-dde-structures.md)
</dt> <dt>

[**нддесетшаресекурити**](nddesetsharesecurity.md)
</dt> <dt>

[**нддешаресетинфо**](nddesharesetinfo.md)
</dt> <dt>

[**WinMain**](/windows/win32/api/winbase/nf-winbase-winmain)
</dt> </dl>

 

