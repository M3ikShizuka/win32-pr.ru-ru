---
description: Извлекает дескриптор безопасности, связанный с общим ресурсом DDE. Обычно это делается для редактирования.
ms.assetid: 7d3cc965-45ee-40ce-a462-568200592345
title: Функция Нддежетшаресекурити (Нддеапи. h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- NDdeGetShareSecurity
- NDdeGetShareSecurityA
- NDdeGetShareSecurityW
api_type:
- DllExport
api_location:
- Nddeapi.dll
ms.openlocfilehash: dae1352d9e7c45f9ce301dd30d4e7f73d508498c
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127172292"
---
# <a name="nddegetsharesecurity-function"></a>Функция Нддежетшаресекурити

\[Сетевой DDE больше не поддерживается. Nddeapi.dll имеется в Windows Vista, но все вызовы функций возвращают ндде \_ не \_ реализованы.\]

Извлекает дескриптор безопасности, связанный с общим ресурсом DDE. Обычно это делается для редактирования.

## <a name="syntax"></a>Синтаксис


```C++
UINT NDdeGetShareSecurity(
  _In_  LPTSTR               lpszServer,
  _In_  LPTSTR               lpszShareName,
  _In_  SECURITY_INFORMATION si,
  _Out_ PSECURITY_DESCRIPTOR pSD,
  _In_  DWORD                cbSD,
  _Out_ LPDWORD              lpcbsdRequired
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*лпсзсервер* \[ окне\]
</dt> <dd>

Имя сервера, на котором находится DSDM.

</dd> <dt>

*лпсзшаренаме* \[ окне\]
</dt> <dd>

Имя общей папки, дескриптор безопасности которой необходимо получить из DSDM. Этот параметр не может иметь **значение NULL**.

</dd> <dt>

*Si* \[ окне\]
</dt> <dd>

Значение [**\_ сведений о безопасности**](/windows/desktop/SecAuthZ/security-information) , указывающее сведения о безопасности, которые необходимо получить из дескриптора безопасности, связанного с общей папкой.

</dd> <dt>

*pSD* \[ - заполняет\]
</dt> <dd>

Указатель на структуру [**\_ дескриптора безопасности**](/windows/desktop/api/winnt/ns-winnt-security_descriptor) , которая получает собственный дескриптор безопасности. Этот параметр может принимать значение **NULL**. Если этот параметр имеет **значение NULL**, DSDM определяет размер запрашиваемых сведений о безопасности и возвращает число байтов, необходимое в параметре *лпкбсдрекуиред* , а также ндде \_ buf \_ слишком \_ маленький код ошибки.

</dd> <dt>

*кбсд* \[ окне\]
</dt> <dd>

Размер буфера *pSD* . Если *pSD* имеет **значение NULL**, этот параметр должен быть равен нулю.

</dd> <dt>

*лпкбсдрекуиред* \[ заполняет\]
</dt> <dd>

Указатель на переменную, которая получает фактический размер полученного дескриптора безопасности. Этот параметр не может иметь **значение NULL**.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Если функция выполнена удачно, возвращается значение НДДЕ \_ No \_ Error.

Если функция завершается ошибкой, возвращаемое значение является кодом ошибки, который может быть преобразован в текстовое сообщение об ошибке путем вызова [**нддежетеррорстринг**](nddegeterrorstring.md). Если параметр *pSD* имел **значение NULL**, он возвращает ндде \_ buf \_ слишком \_ мал.

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|----------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows 2000 Professional \[только классические приложения\]<br/>                             |
| Минимальная версия сервера<br/> | Windows 2000 Server \[только классические приложения\]<br/>                                   |
| Заголовок<br/>                   | <dl> <dt>Нддеапи. h</dt> </dl>   |
| Библиотека<br/>                  | <dl> <dt>Нддеапи. lib</dt> </dl> |
| DLL<br/>                      | <dl> <dt>Nddeapi.dll</dt> </dl> |
| Имя в кодировке Юникод и ANSI<br/>   | **Нддежетшаресекуритив** (Юникод) и **нддежетшаресекуритя** (ANSI)<br/>    |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[общие сведения о Exchange сетевых платформа динамических данных](network-dynamic-data-exchange.md)
</dt> <dt>

[Сетевые функции DDE](network-dde-functions.md)
</dt> <dt>

[**\_сведения о безопасности**](/windows/desktop/SecAuthZ/security-information)
</dt> <dt>

[**нддесетшаресекурити**](nddesetsharesecurity.md)
</dt> </dl>

 

