---
description: работа с буферами мультимедиа DMO
ms.assetid: 6d0c51b8-0d79-4f04-8e90-0cea4f3b1427
title: работа с буферами мультимедиа DMO
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 311778898fbfa669a602cd189fb5518f7a2814089a87ed33fba7e303c4327cac
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118236960"
---
# <a name="working-with-dmo-media-buffers"></a>работа с буферами мультимедиа DMO

Входные данные передаются кодеку дмос с помощью буферов мультимедиа. Буфер мультимедиа — это объект, реализующий интерфейс [**имедиабуффер**](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediabuffer) . вы можете реализовать класс для этой цели или, если в приложении используется пакет sdk Windows Media Format, можно использовать объекты буфера, определенные в этом пакете sdk.

Если вы реализуете собственный класс буфера, будьте внимательны при обработке памяти буфера. при передаче образца входных данных DMO сохраняет ссылку на буфер до завершения работы с образцом. Вы можете немедленно освободить ссылку на интерфейс [**имедиабуффер**](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediabuffer) , но у вас нет способа узнать, когда кодек больше не нуждается в его ссылке. Чтобы быть уверенным в том, что память освобождается при удалении объекта, следует реализовать класс таким образом, чтобы он выделил и освободил память для внутреннего буфера.

Так как дмос сохраняет ссылки на буферы в течение неизвестного периода времени, довольно просто использовать ограниченный пул буферов. Самым простым решением является выделение нового буфера для каждого образца, хотя это неэффективно.

Лучшим решением является реализация объекта для управления пулом буферов. Для этого напишите код в методе **Release** реализации [**имедиабуффер**](/previous-versions/windows/desktop/api/mediaobj/nn-mediaobj-imediabuffer) , который вызывает метод диспетчера буферов (вместо удаления самого себя), когда счетчик ссылок становится равным нулю. Диспетчер буферов может затем поддерживать список указателей на выделенные объекты буфера. Создайте метод в диспетчере буферов, чтобы проверить список свободных буферов и вернуть указатель, чтобы приложение могла получить доступ к буферам при необходимости. Этот метод должен создавать новые буферы по мере необходимости и добавлять их в список.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Работа с кодеками дмос](workingwithcodecdmos.md)
</dt> </dl>

 

 
