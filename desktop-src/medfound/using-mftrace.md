---
description: Мфтраце — это средство для создания журналов трассировки для Microsoft Media Foundation приложений.
ms.assetid: f93060dc-cb64-4623-847d-5d78bca59d50
title: Использование Мфтраце
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d8416fbde708dd44858fe5df580945f326944a1f
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127579795"
---
# <a name="using-mftrace"></a>Использование Мфтраце

Мфтраце — это средство для создания журналов трассировки для Microsoft Media Foundation приложений.

Мфтраце использует библиотеку "краткие обзора" для подключения к Media Foundationным вызовам API и создания журналов трассировки. мфтраце также может записывать трассировки из любого компонента, использующего трассировку событий для Windows (ETW) или препроцессора трассировки программного обеспечения (WPP) для создания трассировок. Журналы трассировки можно создавать путем запуска нового процесса из Мфтраце или путем присоединения Мфтраце к существующему процессу.

## <a name="usage"></a>Использование

**мфтраце** \[ **-a** *Process* \] \[ **-c** *файл ConfigurationFile* \] \[ **-DC** \] \[ **-ES** \] \[ **-k** *keywords* \] \[ **-l** *Level* \] \[ **-o** *выходной_файл* \] \[ **-v** \] \[ **-** ? \] \[ {*Команда* \| *ETL_FILE*}\]




| аргументов командной строки; | Описание | 
|------------------------|-------------|
| <span id="-a_Process_ID_or_Process_Name"></span><span id="-a_process_id_or_process_name"></span><span id="-A_PROCESS_ID_OR_PROCESS_NAME"></span><strong>-a</strong> <strong></strong> <em>Идентификатор процесса или имя процесса</em><br /> | Присоединение к выполняющемуся процессу.<br /> | 
| <span id="-c_Configuration_File"></span><span id="-c_configuration_file"></span><span id="-C_CONFIGURATION_FILE"></span><strong>-c</strong> <strong></strong> <em>Файл конфигурации</em><br /> | Чтение параметров из указанного файла конфигурации. См. раздел <a href="mftrace-configuration-file.md">файл конфигурации мфтраце</a>.<br /> | 
| <span id="-dc"></span><span id="-DC"></span><strong>-DC</strong><br /> | Отключить трассировку для дочерних процессов. По умолчанию трассировка включена для дочерних процессов.<br /> | 
| <span id="-es"></span><span id="-ES"></span><strong>-ES</strong><br /> | Включите открытые символы.<br /> | 
| <span id="-k_Keywords"></span><span id="-k_keywords"></span><span id="-K_KEYWORDS"></span><strong>-k</strong> <strong></strong> <em>Ключевые слова</em><br /> | Список ключевых слов с разделителями-запятыми. См. <a href="mftrace-keywords.md">Ключевые слова мфтраце</a>.<br /> | 
| <span id="-l_Level"></span><span id="-l_level"></span><span id="-L_LEVEL"></span><strong>-l</strong> <strong></strong> <em>Уровень</em><br /> | Уровень трассировки.<br /><ul><li>0 — нет.</li><li>1: критическая</li><li>2: ошибка</li><li>3: предупреждение</li><li>4: информативные</li><li>5: подробный</li><li>16: Отладка</li></ul> | 
| <span id="-o_Output_File"></span><span id="-o_output_file"></span><span id="-O_OUTPUT_FILE"></span><strong>-o</strong> <strong></strong> <em>Выходной файл</em><br /> | Запись выходных данных трассировки в указанный файл. По умолчанию вывод переходит в <strong>stdout</strong>.<br /> Если указан выходной файл, то расширение имени файла должно быть одним из следующих:<br /><ul><li>. ETL: файл журнала трассировки событий (ETL).</li><li>. log или .txt: текстовый файл.</li></ul> | 
| <span id="-v"></span><span id="-V"></span><strong>-v</strong><br /> | Включить подробный режим.<br /> | 
| <span id="-_"></span><strong>-?</strong><br /> | Отобразить сведения об использовании.<br /> | 
| <span id="COMMAND"></span><span id="command"></span><em>КНОПКИ</em><br /> | Аргументы командной строки для создания нового процесса.<br /> | 
| <span id="ETL_FILE"></span><span id="etl_file"></span><em>ETL_FILE</em><br /> | Имя существующего ETL-файла. Если этот аргумент указан, ETL-файл преобразуется в текстовый вывод.<br /> | 




 

## <a name="environment-variables"></a>Переменные среды

<dl> <dt>

<span id="TRACE_FORMAT_SEARCH_PATH"></span><span id="trace_format_search_path"></span>TRACE_FORMAT_SEARCH_PATH
</dt> <dd>

для трассировки компонентов, использующих препроцессорную трассировку Windows программного обеспечения (WPP), задайте для этой переменной среды значение, определяющее путь к файлам трассировки сообщений (тмф) для компонента.

</dd> <dt>

<span id="_NT_SYMBOL_PATH"></span><span id="_nt_symbol_path"></span>_NT_SYMBOL_PATH
</dt> <dd>

Если поиск символов включен (**-ES**), задайте эту переменную среды, чтобы указать путь к символам.

</dd> </dl>

## <a name="examples"></a>Примеры

Создайте новый процесс и выполните трассировку этого процесса:

``` syntax
mftrace.exe wmplayer.exe Wildlife.wmv
```

Присоединить Мфтраце к существующему процессу:

``` syntax
mftrace.exe -a wmplayer.exe
mftrace.exe -a 9132
```

Отправка выходных данных трассировки в текстовый файл:

``` syntax
mftrace.exe -a wmplayer.exe -o trace.txt
```

Трассировка ETW или события КОНВЕЙЕРа событий Windows:

``` syntax
mftrace.exe -c config.xml -o trace.txt
mftrace.exe -c config.xml -o trace.etl
```

> [!Note]  
> В первом примере создается текстовый файл. Во втором примере создается ETL-файл.

 

Преобразование ETL-файла в текстовый файл:

``` syntax
mftrace.exe -o trace.txt trace.etl
```

## <a name="remarks"></a>Remarks

По умолчанию Мфтраце создает только трассировки. Чтобы создать трассировки ETW или WPP, необходимо предоставить файл конфигурации. Файл конфигурации содержит имена поставщиков трассировки. Дополнительные сведения см. в разделе [Мфтраце Configuration File](mftrace-configuration-file.md).

Мфтраце может отправить выходные данные в следующие места назначения:

-   **stdout** (значение по умолчанию).
-   Текстовый файл.
-   Двоичный ETL-файл.

Если вы ведете запись трассировок трассировки событий Windows или КОНВЕЙЕРа, ETL-файл является наиболее эффективным вариантом, поскольку данные трассировки сохраняются в виде двоичных BLOB. После завершения сеанса трассировки можно использовать Мфтраце для преобразования ETL-файла в текстовый файл.

> [!Note]  
> Для трассировки обзора текстовый вывод настолько же эффективен, как и ETL-файл. Поэтому, если вы регистрируете только трассировки (без трассировок ETW и WPP), рекомендуется выводить текстовые выходные данные.

 

Для трассировки обзора необходимо присоединить Мфтраце к выполняющемуся процессу (**-a**) или использовать мфтраце для создания нового процесса. Для трассировок ETW и WPP Мфтраце прослушивает любой поставщик событий, указанный в файле конфигурации.

Результаты трассировки можно отфильтровать, указав ключевые слова трассировки либо с помощью параметра командной строки **-k** , либо в файле конфигурации. Более типичное использование заключается в регистрации всех трассировок и последующем использовании сценария или **grep** для поиска определенных строковых шаблонов.

## <a name="interpreting-the-trace-results"></a>Интерпретация результатов трассировки

Мфтраце можно использовать для получения ответов на вопросы о том, что происходит внутри приложения или компонента Media Foundation. В следующей таблице перечислены некоторые типичные вопросы. Второй столбец содержит строку поиска, которая может помочь ответить на вопрос.




| Вопрос | Поиск по строкам | 
|----------|----------------|
| Произошла ошибка? | "0xc00d" | 
| Правильно ли разрешается топология? | "Ктопологихелперс:: Trace" | 
| Начался ли сеанс мультимедиа? | "Месессионстартед" | 
| Какой файл был воспроизведен? | "Кмфсаурцересолвердетаурс" | 
| Какие типы носителей используются для исходных потоков? | "New Stream", "Меневстреам", "Кмфмедиасаурцедетаурс:: Трацепд" | 
| Были ли исходные потоки формировать образцы? | "Кмфмедиастреамдетаурс:: Хандливент", "Мемедиасампле" | 
| Было ли воспроизведение достигнуто до конца данных? | "Миндофстреам", "Миндофпресентатион" | 
| Изменилось ли форматирование? | "Местреамформатчанжед" (источники мультимедиа), "новый формат", "Месессионстреамсинкформатчанжед" (приемники мультимедиа) | 
| Какие объекты были созданы? | "COle32ExportDetours:: CoCreateInstance" | 
| Были ли Media Foundation преобразования (МФТС) в конвейере обработки любых данных? | "Кмфтрансформдетаурс::P Роцессаутпут", "Кмфтрансформдетаурс::P Роцессинпут" | 
| Какие состояния были заданы для МФТС? | "Кмфтрансформдетаурс::P Роцессмессаже" | 
| Запрашивал ли запрос MFT входные данные? | "MF_E_TRANSFORM_NEED_MORE_INPUT" (синхронная MFT), "Метрансформнидинпут" (асинхронная MFT). | 
| Создает ли асинхронный файл MFT выходные данные? | "Процессаутпутс Available" | 
| Были ли примеры запросов приемника мультимедиа? | "Местреамсинкрекуестсампле" | 
| Получил ли приемник мультимедиа примеры? | "Кмфстреамсинкдетаурс::P Роцесссампле" | 
| DirectShow: какие образцы были обработаны? | "Sample", "Кмеминпутпиндетаурс" | 
| DirectShow: какой граф фильтра использовался? | "Кграфхелперс:: Trace" | 
| Есть ли несколько процессов? | Вызова<blockquote>[!Note]<br />Также найдите идентификатор процесса, который отображается в начале каждой строки трассировки.</blockquote><br /><br /> | 




 

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[мфтраце](mftrace.md)
</dt> </dl>

 

 




