---
description: Сведения о заголовке ASF хранятся в объектах заголовка ASF файла мультимедиа.
ms.assetid: 1654af97-f4fe-427f-b562-3b109e921719
title: Получение сведений из объектов заголовка ASF
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 346e57721137fd6064e4d6b9fd21080d96c10e740bb7f7ed45bf3fef4cc92722
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118974443"
---
# <a name="getting-information-from-asf-header-objects"></a>Получение сведений из объектов заголовка ASF

Сведения о заголовке ASF хранятся в объектах заголовка ASF файла мультимедиа. Media Foundation предоставляет [объект ASF контентинфо](asf-contentinfo-object.md) для работы с объектом Header. Заполненный объект Контентинфо требуется для того, чтобы приложение читало данные заголовка существующего файла. Это достигается путем вызова [**имфасфконтентинфо::P арсехеадер**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-parseheader). Если синтаксический анализ успешно завершен, Библиотека ASF для файла, которая поддерживается внутренне Media Foundation, заполняется данными заголовка из различных объектов заголовков. Некоторые из этих свойств предоставляются приложению, которое может извлекать через атрибуты дескриптора презентации, дескриптора потока, профиля и свойств метаданных.

Полный список атрибутов см. в разделе [атрибуты Media Foundation для объектов заголовка ASF](media-foundation-attributes-for-asf-header-objects.md).

## <a name="retrieving-header-information-from-a-presentation-descriptor"></a>Получение сведений о заголовке из дескриптора презентации

Объект дескриптора представления содержит описание конкретного источника мультимедиа, в данном случае источник медиа ASF. Если вызов **парсехеадер** завершается успешно, сведения на уровне файла из объекта заголовка сохраняются как атрибуты в дескрипторе презентации. Чтобы создать дескриптор представления, вызовите метод [**имфасфконтентинфо:: женератепресентатиондескриптор**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-generatepresentationdescriptor). Этот метод возвращает указатель на заполненный объект дескриптора представления, содержащий эти атрибуты для ASF-файла, связанного с объектом Контентинфо. Чтобы получить значения для конкретных атрибутов, вызовите методы **имфаттрибутес:: жеткскскс** в дескрипторе представления и укажите **атрибут \_ MF \_ PD ASF \_ xxx** .

В следующем примере кода извлекается длительность воспроизведения ASF-файла, указанного в объекте Контентинфо.


```C++
HRESULT GetPlayDuration(
    IMFASFContentInfo *pContentInfo,  // An initialized ContentInfo object. 
    UINT64 *pcbPlayDuration           // Receives the play duration.
    )
{
    IMFPresentationDescriptor* pPD = NULL;

    HRESULT hr = pContentInfo->GeneratePresentationDescriptor(&pPD);
    if (SUCCEEDED(hr))
    {
        hr = pPD->GetUINT64(MF_PD_ASF_FILEPROPERTIES_PLAY_DURATION, pcbPlayDuration);
        pPD->Release();
    }
    return hr;
}

```



Дополнительные сведения о дескрипторах презентаций в целом см. в разделе [дескрипторы представления](presentation-descriptors.md).

Полный набор атрибутов дескриптора презентации см. в разделе [атрибуты дескриптора представления](presentation-descriptor-attributes.md).

## <a name="retrieving-header-information-from-a-stream-descriptor"></a>Получение сведений о заголовке из дескриптора потока

Объект дескриптора потока предоставляет интерфейс [**имфстреамдескриптор**](/windows/desktop/api/mfidl/nn-mfidl-imfstreamdescriptor) и описывает характеристики потоков в файле. Дескриптор представления для содержимого ASF содержит один или несколько дескрипторов потоков, представляющих потоки, перечисленные в объекте Header. После успешного завершения вызова [**имфасфконтентинфо:: женератепресентатиондескриптор**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-generatepresentationdescriptor) базовые дескрипторы потоков заполняются данными уровня потока из различных объектов заголовка. Чтобы получить дескриптор потока для потока ASF, вызовите [**имфпресентатиондескриптор:: жетстреамдескрипторбиндекс**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationdescriptor-getstreamdescriptorbyindex) в дескрипторе представления, созданном из объекта контентинфо.

Некоторые свойства потока задаются как атрибуты дескрипторов потока. Вызовите методы **имфаттрибутес:: жеткскскс** в дескрипторе потока и укажите **атрибут \_ MF \_ SD \_ xxx** .

Полный набор атрибутов дескриптора потока см. в разделе атрибуты дескриптора потока ASF, перечисленные в разделе [атрибуты дескриптора потока](stream-descriptor-attributes.md).

## <a name="retrieving-header-information-from-the-profile-object"></a>Получение сведений о заголовках из объекта Profile

Помимо дескрипторов потоков, объект профиля ASF также описывает свойства потока. Чтобы получить профиль существующего файла ASF, вызовите [**имфасфконтентинфо:: onprofile**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getprofile). Объект профиля ASF, возвращенный этим методом, не содержит атрибутов **MF \_ PD \_ ASF \_ xxx** . Эти атрибуты доступны приложению только после того, как оно вызовет [**мфкреатеасфпрофилефромпресентатиондескриптор**](/windows/desktop/api/wmcontainer/nf-wmcontainer-mfcreateasfprofilefrompresentationdescriptor) для создания объекта профиля из дескриптора презентации. Профиль можно использовать для получения указателей на объекты взаимного исключения и определения приоритетов потоков.

Дополнительные сведения об объекте Profile см. в разделе [профиль ASF](asf-profile.md) .

## <a name="retrieving-metadata-from-header-objects"></a>Получение метаданных из объектов заголовков

Файл ASF может содержать несколько свойств метаданных, заданных во время кодирования файлов. Приложение может перечислить эти свойства с помощью объекта Контентинфо. Некоторые из этих свойств, такие как сведения о переменной скорости (VBR), доступны приложению с помощью атрибутов в дескрипторе представления, потоках и типах мультимедиа для файла мультимедиа. Эти атрибуты задаются для объекта Контентинфо во время инициализации через вызов [**парсехеадер**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-parseheader) .

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Объект Контентинфо ASF](asf-contentinfo-object.md)
</dt> </dl>

 

 



