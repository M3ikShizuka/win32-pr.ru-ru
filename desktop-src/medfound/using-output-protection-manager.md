---
description: 'Дополнительные сведения о: использование диспетчера выходной защиты'
ms.assetid: 01edc17e-e71c-4772-a03c-09c9a2b8400f
title: Использование диспетчера выходной защиты
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 73e37dd548603a6f9d7769a9e724df3477e2fcde
ms.sourcegitcommit: 9b5faa61c38b2d0c432b7f2dbee8c127b0e28a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2021
ms.locfileid: "122475520"
---
# <a name="using-output-protection-manager"></a>Использование диспетчера выходной защиты

В этом разделе описывается, как использовать диспетчер выходной защиты (ОПМ) для защиты видеосодержимого при перемещении по физическому соединителю на устройство отображения. Этот раздел состоит из следующих подразделов.

-   [Выходные данные видео](#video-outputs)
-   [Инициализация сеанса ОПМ](#initializing-an-opm-session)
-   [Отправка запросов состояния ОПМ](#sending-opm-status-requests)
-   [Отправка команд ОПМ](#sending-opm-commands)
-   [Обработка отключенного вывода видео](#sending-opm-commands)
-   [Защита содержимого с помощью HDCP](#using-hdcp-to-protect-content)

Premium видеосодержимое обычно шифруется для защиты от несанкционированного дублирования. Конечно, перед отображением видео необходимо расшифровать. Расшифрованные, несжатые кадры должны перемещаться по физическому соединителю на устройство дисплея. Поставщики содержимого могут потребовать, чтобы на этом этапе были защищены кадры видео, так как они перемещаются по физическому соединителю.

Для этой цели существуют различные механизмы защиты, включая High-Bandwidth цифровые Защита содержимого (HDCP) и Дисплайпорт Защита содержимого (ДПКП) для цифровых выходов. и система управления созданием копии — аналоговый (CGMS-A) для аналоговых выходов. Как правило, эти механизмы используют шифрование или кодирование сигнала перед переходом на дисплей.

ОПМ позволяет приложению применять механизмы защиты содержимого к выходным данным видео. С помощью ОПМ приложение отправляет команды и запросы состояния в графический драйвер через надежный защищенный канал. ОПМ позволяет приложению:

-   Убедитесь, что графический драйвер подписан корпорацией Майкрософт.
-   Настройте доверенный канал связи с драйвером.
-   Примените механизмы защиты содержимого к физическому выходу.

ОПМ заменяет сертифицированную защиту выхода протокол BGP (Копп) и использует аналогичный API. Для обеспечения обратной совместимости интерфейс ОПМ может эмулировать интерфейс Копп. Различия между ОПМ и Копп включают следующее:

-   ОПМ использует сертификаты X. 509, а Копп использует собственный формат сертификата.
-   ОПМ поддерживает повторители HDCP.
-   Приложения, использующие ОПМ, не должны анализировать сообщения о возобновлении системы HDCP (Срмс).
-   ОПМ можно использовать, если отображение графики использует режим клонирования. Копп не поддерживает режим клонирования.

Если приложение использует путь к защищенному носителю (PMP) для воспроизведения видеосодержимого, вам не нужно использовать API ОПМ, так как PMP делает все необходимые вызовы ОПМ. API ОПМ доступен для приложений, которые не используют PMP.

опм доступен в Windows Vista и более поздних версиях, но API не стал общедоступным до Windows 7. чтобы использовать опм в приложении, необходимо иметь заголовки и файлы библиотеки из пакета SDK для Windows 7. не требуется распространять библиотеки dll для использования опм в Windows Vista или Windows Server 2008.

## <a name="video-outputs"></a>Выходные данные видео

Графический адаптер может иметь несколько физических выходных данных, каждый из которых имеет свои собственные возможности. Прежде чем приложение начнет воспроизводить защищенное содержимое, оно должно установить соответствующие механизмы защиты для каждого видеопотока, связанного с графической картой, которая будет отображать видео. Применяемые механизмы защиты будут зависеть от правил использования содержимого.

Каждый выход видео представлен экземпляром интерфейса [**иопмвидеуутпут**](/windows/desktop/api/opmapi/nn-opmapi-iopmvideooutput) . Для получения выходных данных видео можно использовать обработчики устройств или мониторов Direct3D.

Использование устройства Direct3D:

1.  Получите указатель **IDirect3DDevice9** для устройства Direct3D, которое будет использоваться приложением для создания поверхностей для хранения кадров видео.
2.  Вызовите функцию [**OPMGetVideoOutputsFromIDirect3DDevice9Object**](/windows/desktop/api/opmapi/nf-opmapi-opmgetvideooutputsfromidirect3ddevice9object) . Эта функция выделяет массив указателей [**иопмвидеуутпут**](/windows/desktop/api/opmapi/nn-opmapi-iopmvideooutput) , по одному для каждого выхода.

Использование дескрипторов монитора:

1.  Вызовите **енумдисплаймониторс** , чтобы получить дескрипторы **хмонитор** , которые соответствуют окну видео. С одним и тем же окном можно связать несколько мониторов, поэтому вы можете получить несколько дескрипторов **хмонитор** .
2.  Для каждого обработчика монитора вызовите [**опмжетвидеуутпутсфромхмонитор**](/windows/desktop/api/opmapi/nf-opmapi-opmgetvideooutputsfromhmonitor). Эта функция выделяет массив указателей [**иопмвидеуутпут**](/windows/desktop/api/opmapi/nn-opmapi-iopmvideooutput) , по одному для каждого выхода.

## <a name="initializing-an-opm-session"></a>Инициализация сеанса ОПМ

Прежде чем приложение отправит команды ОПМ или запросы состояния, оно должно проверить, является ли выходное видео доверенным, и установить сеансовый ключ. Ключ сеанса используется для подписывания данных, которыми обмениваются приложение и графический драйвер.

API ОПМ определяет подтверждение, устанавливающее доверие и устанавливающее ключ сеанса. Это подтверждение необходимо выполнить для каждого экземпляра интерфейса [**иопмвидеуутпут**](/windows/desktop/api/opmapi/nn-opmapi-iopmvideooutput) следующим образом:

1.  Вызовите [**иопмвидеуутпут:: стартинитиализатион**](/windows/desktop/api/opmapi/nf-opmapi-iopmvideooutput-startinitialization). Этот метод получает два фрагмента данных:
    -   Случайное число, созданное драйвером. Это число будет использоваться для завершения подтверждения.
    -   Цепочка сертификатов X. 509 драйвера.
2.  Убедитесь, что цепочка сертификатов подписана корпорацией Майкрософт.
    > [!Note]  
    > Отзыв сертификата находится за пределами области действия ОПМ.

     

3.  Получите открытый ключ драйвера из цепочки сертификатов.
4.  Создайте 128-разрядный ключ сеанса AES.
5.  Создание двух случайных 32-разрядных чисел:

    -   Начальный порядковый номер для запросов состояния ОПМ.
    -   Начальный порядковый номер для команд ОПМ.

    Эти номера должны создаваться с помощью криптографического безопасного генератора случайных чисел, например **CryptGenRandom**.

6.  Скопируйте случайное число драйвера (полученное на шаге 1), ключ сеанса и два порядковых номера в структуру [**\_ \_ \_ параметров зашифрованной инициализации ОПМ**](/windows/desktop/api/ksopmapi/ns-ksopmapi-opm_encrypted_initialization_parameters) , как описано в [**иопмвидеуутпут:: финишинитиализатион**](/windows/desktop/api/opmapi/nf-opmapi-iopmvideooutput-finishinitialization).
7.  Зашифруйте структуру [**\_ \_ \_ параметров зашифрованной инициализации ОПМ**](/windows/desktop/api/ksopmapi/ns-ksopmapi-opm_encrypted_initialization_parameters) с помощью рсаес-OAEP, используя открытый ключ драйвера, который находится в сертификате драйвера.
8.  Вызовите [**иопмвидеуутпут:: финишинитиализатион**](/windows/desktop/api/opmapi/nf-opmapi-iopmvideooutput-finishinitialization).

## <a name="sending-opm-status-requests"></a>Отправка запросов состояния ОПМ

Запросы состояния ОПМ возвращают сведения о выходных данных видео, например тип физического соединителя и текущий уровень защиты. Список типов запросов см. в разделе [ОПМ Status](opm-status-requests.md)requests.

Чтобы отправить запрос состояния, выполните следующие действия.

1.  Инициализируйте [**структуру \_ \_ \_ параметров получения сведений ОПМ**](/windows/desktop/api/ksopmapi/ns-ksopmapi-opm_get_info_parameters) , как показано в следующей таблице.

    | Член               | Описание                                                                                                                                                                                                                                                                                                                                                                 |
    |----------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | **омак**             | Пока не пропустите это поле.                                                                                                                                                                                                                                                                                                                                                    |
    | **рнрандомнумбер**   | Криптографически защищенное 128-разрядное случайное число. Всякий раз при выполнении запроса состояния всегда создавайте новое случайное число, даже если вы создаете тот же запрос. Сохраните номер в переменной, так как вам потребуется позднее обратиться к ней.                                                                                                                             |
    | **гуидинформатион**  | Идентификатор GUID, определяющий запрос состояния. Список запросов состояния см. в разделе [ОПМ Status Requests](opm-status-requests.md).                                                                                                                                                                                                                                               |
    | **улсекуенценумбер** | Порядковый номер. Для первого запроса состояния используйте начальный порядковый номер, указанный в методе [**иопмвидеуутпут:: финишинитиализатион**](/windows/desktop/api/opmapi/nf-opmapi-iopmvideooutput-finishinitialization) (шаг 5 [инициализации сеанса ОПМ](#initializing-an-opm-session)). Каждый раз, когда вы вносите еще один запрос о состоянии, увеличивайте это число на 1. |
    | **абпараметерс**     | Массив байтов, который содержит дополнительные входные данные для запроса. Формат входных данных указан в разделе справки по каждому запросу состояния.                                                                                                                                                                                                                    |
    | **кбпараметерссизе** | Размер допустимых данных в массиве **абпараметерс** . Содержимое остальной части массива не определено.                                                                                                                                                                                                                                                              |

    

     

2.  Вычислите однозначный MAC-адрес CBC (ОМАК-1), чтобы вычислить хэш для блока данных, отображаемого после элемента **ОМАК** , а затем присвоить элементу **ОМАК** это значение. См. [пример кода ОПМ](opm-example-code.md).
3.  Вызовите метод [**иопмвидеуутпут::.**](/windows/desktop/api/opmapi/nf-opmapi-iopmvideooutput-getinformation) Передайте указатель на структуру [**\_ \_ \_ параметров получения сведений ОПМ**](/windows/desktop/api/ksopmapi/ns-ksopmapi-opm_get_info_parameters) и указатель на структуру [**\_ запрашиваемой \_ информации ОПМ**](/windows/desktop/api/ksopmapi/ns-ksopmapi-opm_requested_information) . Ответ драйвера записывается в структуру **\_ запрошенной \_ информации ОПМ** .
    -   Элемент **ОМАК** этой структуры содержит ОМАК, вычисленный для данных, следующих за этим элементом.
    -   Элемент **абрекуестединформатион** представляет собой массив байтов, содержащий выходные данные для ответа. Формат выходных данных указан в разделе справки по каждому запросу состояния.
4.  Вычислите ОМАК для [**структуры \_ запрашиваемой \_ информации ОПМ**](/windows/desktop/api/ksopmapi/ns-ksopmapi-opm_requested_information) , не включая элемент **ОМАК** . Убедитесь, что ОМАК соответствует значению в члене **ОМАК** .
5.  Убедитесь, что член **кбрекуестединформатионсизе** структуры [**\_ запрашиваемой \_ информации ОПМ**](/windows/desktop/api/ksopmapi/ns-ksopmapi-opm_requested_information) предоставляет правильный размер выходных данных. Например, выходные данные для запроса [**\_ \_ \_ типа соединителя ОПМ Get**](opm-get-connector-type.md) — это [**ОПМ \_ Стандартная \_ информационная**](/windows/desktop/api/ksopmapi/ns-ksopmapi-opm_standard_information) структура, поэтому значение **кбрекуестединформатионсизе** должно быть `sizeof(OPM_STANDARD_INFORMATION)` .
6.  Приведите элемент **абрекуестединформатион** структуры [**\_ запрашиваемой \_ информации ОПМ**](/windows/desktop/api/ksopmapi/ns-ksopmapi-opm_requested_information) к правильной структуре выходных данных. Например, если запросом состояния является [**ОПМ \_ Получение \_ \_ типа соединителя**](opm-get-connector-type.md), приведите **абрекуестединформатион** к [**\_ стандартной \_ информационной структуре ОПМ**](/windows/desktop/api/ksopmapi/ns-ksopmapi-opm_standard_information) .
7.  Убедитесь, что элемент **рнрандомнумбер** структуры выходных данных соответствует значению **рнрандомнумбер** из шага 1.
8.  Проверьте элемент **улстатусфлагс** в структуре выходных данных, как описано в разделе [Обработка отключенного](#handling-a-disabled-video-output)видеопотока.

Если какая-либо из проверок в шагах 5 – 8 завершается сбоем, приложение должно переключиться на отображение защищенного содержимого.

## <a name="sending-opm-commands"></a>Отправка команд ОПМ

Команды ОПМ используются для установки уровня защиты и других параметров в выходных данных видео. Отправка команды ОПМ аналогична отправке запроса состояния, за исключением отсутствия данных ответа от драйвера. Список команд см. в разделе [команды ОПМ](opm-commands.md).

Чтобы отправить команду ОПМ, выполните следующие действия.

1.  Заполните [**структуру \_ \_ параметров ОПМ configure**](/windows/desktop/api/opmapi/ns-opmapi-opm_configure_parameters) , как показано в следующей таблице.

    | Член                | Описание                                                                                                                                                                                                                                                                                                                                                   |
    |-----------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | **омак**              | Пока не пропустите это поле.                                                                                                                                                                                                                                                                                                                                      |
    | **гуидсеттинг**       | Идентификатор GUID, идентифицирующий команду. Список команд см. в разделе [команды ОПМ](opm-commands.md).                                                                                                                                                                                                                                                             |
    | **улсекуенценумбер**  | Порядковый номер. Для первой команды используйте начальный порядковый номер, указанный в методе [**иопмвидеуутпут:: финишинитиализатион**](/windows/desktop/api/opmapi/nf-opmapi-iopmvideooutput-finishinitialization) (шаг 5 [инициализации сеанса ОПМ](#initializing-an-opm-session)). Каждый раз, когда вы отправляете другую команду, увеличивайте это число на 1. |
    | **абпараметерс**      | Массив байтов, который содержит дополнительные входные данные для команды. Формат входных данных указан в разделе справки по каждой команде.                                                                                                                                                                                                             |
    | **кбсеттингдатасизе** | Размер допустимых данных в массиве **абпараметерс** . Содержимое остальной части массива не определено.                                                                                                                                                                                                                                                |

    

     

2.  Вычислите ОМАК для блока данных, который отображается после элемента **ОМАК** , а затем установите для элемента **ОМАК** это значение.
3.  Вызовите [**иопмвидеуутпут:: Configure**](/windows/desktop/api/opmapi/nf-opmapi-iopmvideooutput-configure).

Для большинства команд существует соответствующий запрос состояния, возвращающий состояние команды. Например, команда [**ОПМ \_ Set \_ Protection \_ Level**](opm-set-protection-level.md) задает уровень защиты, а команда [**ОПМ \_ получить \_ виртуальную \_ защиту \_**](opm-get-virtual-protection-level.md) возвращает текущий уровень защиты.

## <a name="handling-a-disabled-video-output"></a>Обработка отключенного вывода видео

Выходные данные видео могут быть отключены в любое время, чтобы предотвратить несанкционированное использование видеосодержимого. Это может произойти из-за того, что механизм защиты перестанет работать, так как драйвер обнаруживает незаконное изменение, или потому, что дисплей был отключен от физического соединителя. Хотя выходные данные видео отключены, видеокадры не отображаются.

Хотя защита содержимого включена, приложение должно периодически (по крайней мере раз в 2 секунды) выполнить следующие действия.

1.  Вызовите [**иопмвидеуутпут::**](/windows/desktop/api/opmapi/nf-opmapi-iopmvideooutput-getinformation) Get, чтобы отправить [**ОПМ \_ получить \_ фактический \_ \_ уровень защиты**](opm-get-actual-protection-level.md) или [**ОПМ \_ получить \_ виртуальный \_ \_**](opm-get-virtual-protection-level.md) запрос о состоянии защиты. Возвращаемые данные для обеих команд — это [**\_ Стандартная \_ информационная структура ОПМ**](/windows/desktop/api/ksopmapi/ns-ksopmapi-opm_standard_information) .
2.  Проверьте элемент **улинформатион** [**\_ \_ информационной структуры ОПМ Standard**](/windows/desktop/api/ksopmapi/ns-ksopmapi-opm_standard_information) . Этот элемент содержит флаг, указывающий, включена ли защита содержимого. Если защита содержимого отключена, немедленно остановите воспроизведение видео.
3.  Если защита содержимого включена, проверьте элемент **улстатусфлагс** в [**информационной структуре ОПМ \_ Standard \_**](/windows/desktop/api/ksopmapi/ns-ksopmapi-opm_standard_information) . Если флаги не заданы, то выходные данные видео работают правильно. В противном случае выходные данные видео отключаются.

Для **улстатусфлагс** определены следующие флаги.




| Flag | Описание | 
|------|-------------|
| <strong>OPM_STATUS_LINK_LOST</strong> | По какой бы причине защита выходных данных прекратила работу. Например, устройство вывода может быть отключено от коннтектор. Останавливает воспроизведение и выключает все механизмы защиты выходных данных. | 
| <strong>OPM_STATUS_RENEGOTIATION_REQUIRED</strong> | Приложение должно повторно установить сеанс ОПМ. Ответьте следующим образом:<ol><li>Останавливает воспроизведение.</li><li>Отключите все механизмы защиты.</li><li>Освободите интерфейс <a href="/windows/desktop/api/opmapi/nn-opmapi-iopmvideooutput"><strong>иопмвидеуутпут</strong></a> .</li><li>Повторное создание всех поверхностей видео.</li><li>Создайте новый объект ОПМ и попытайтесь восстановить защиту содержимого. Если это не удается, отобразится сообщение об ошибке для пользователя. Не воспроизводить видеоматериалы.</li></ol> | 
| <strong>OPM_STATUS_REVOKED_HDCP_DEVICE_ATTACHED</strong> | Этот флаг применяется только при использовании HDCP и указывает на наличие отозванного устройства HDCP. Закройте воспроизведение и отключите все механизмы защиты на этом видеоролике. Если этот флаг установлен, также устанавливается флаг <strong>OPM_STATUS_LINK_LOST</strong> . | 
| <strong>OPM_STATUS_REVOKED_HDCP_DEVICE_ATTACHED</strong> | Драйвер обнаружил незаконное изменение. Останавливает воспроизведение и не воспроизводит видео с помощью этих выходных данных видео. Также рекомендуется перестать использовать любые другие видеовыходы, так как система может быть скомпрометирована. | 




 

## <a name="using-hdcp-to-protect-content"></a>Защита содержимого с помощью HDCP

В этом разделе описано, как включить защиту выходных данных HDCP с помощью ОПМ. Ниже приведена общая структура действий, которые должен выполнить приложение. Подробные сведения приведены далее в этом разделе.

1.  Приложению может потребоваться предоставить СРМ для вывода видео. Механизм получения Срмс находится за пределами области интерфейса ОПМ. Например, Срмс может доставляться как часть широковещательного потока.
2.  Приложение включает защиту выходных данных HDCP.
3.  Приложение воспроизводит видеоматериалы. Периодически приложение опрашивает драйвер, чтобы убедиться в том, что HDCP включен.
4.  После завершения воспроизведения приложение отключает HDCP.

### <a name="setting-the-srm"></a>Настройка СРМ

Чтобы задать СРМ, выполните следующие действия.

1.  Инициализируйте [**структуру \_ параметров ОПМ Set \_ HDCP \_ СРМ \_**](/windows/desktop/api/opmapi/ns-opmapi-opm_set_hdcp_srm_parameters) с номером версии СРМ.
2.  Сохраните СРМ в переменной.
3.  Отправьте команду [**ОПМ \_ Set \_ HDCP \_ СРМ**](opm-set-hdcp-srm.md) к выходным данным видео. Используйте процедуру, описанную в разделе [Send ОПМ Commands](#sending-opm-commands).
    -   Элемент **абпараметерс** структуры [**\_ \_ параметров ОПМ configure**](/windows/desktop/api/opmapi/ns-opmapi-opm_configure_parameters) содержит структуру [**\_ Parameters ОПМ Set \_ HDCP \_ СРМ \_**](/windows/desktop/api/opmapi/ns-opmapi-opm_set_hdcp_srm_parameters) .
    -   Параметр *пбаддитионалпараметерс* метода [**Иопмвидеуутпут:: Configure**](/windows/desktop/api/opmapi/nf-opmapi-iopmvideooutput-configure) указывает на переменную, содержащую СРМ.
4.  Отправка запроса о состоянии [**\_ версии ОПМ Get \_ Current \_ \_ СРМ \_**](opm-get-current-hdcp-srm-version.md) в выходном видео. Используйте процедуру, описанную в разделе [Отправка запросов состояния ОПМ](#sending-opm-status-requests). Этот запрос состояния не содержит входных данных, поэтому содержимое элемента **абпараметерс** структуры [**\_ параметров ОПМ Get \_ info \_**](/windows/desktop/api/ksopmapi/ns-ksopmapi-opm_get_info_parameters) не определено.
5.  Когда метод [**иопмвидеуутпут::**](/windows/desktop/api/opmapi/nf-opmapi-iopmvideooutput-getinformation) **абрекуестединформатион** возвращает значение, в массиве [**ОПМ \_ запрашиваемой \_ информационной**](/windows/desktop/api/ksopmapi/ns-ksopmapi-opm_requested_information) структуры содержится структура [**ОПМ \_ Standard \_ Information**](/windows/desktop/api/ksopmapi/ns-ksopmapi-opm_standard_information) . Элемент **улинформатион** этой структуры содержит номер версии текущего СРМ. Это значение должно быть равно значению, заданному на шаге 2.

### <a name="enabling-hdcp"></a>Включение HDCP

Чтобы включить HDCP, выполните следующие действия.

1.  Инициализируйте [**структуру \_ \_ \_ \_ параметров уровня защиты ОПМ**](/windows/desktop/api/opmapi/ns-opmapi-opm_set_protection_level_parameters) , используя следующие значения:
    -   **улпротектионтипе**  =  **ОПМ \_ \_Тип защиты \_ HDCP**
    -   **улпротектионлевел**  =  **ОПМ \_ HDCP \_ включен**
    -   **Зарезервировано** = 0
    -   **Reserved2** = 0
2.  Отправка команды [**ОПМ \_ Set \_ Protection \_ Level**](opm-set-protection-level.md) . Входными данными в массиве **абпараметерс** является структура [**\_ \_ \_ \_ параметров ОПМ Set Protection**](/windows/desktop/api/opmapi/ns-opmapi-opm_set_protection_level_parameters) .
3.  Отправьте запрос о состоянии [**\_ \_ виртуальной \_ защиты \_ ОПМ Get Virtual**](opm-get-virtual-protection-level.md) , чтобы проверить, включена ли защита HDCP. Первые 4 байта элемента **абпараметерс** структуры [**\_ \_ \_ параметров получения сведений ОПМ**](/windows/desktop/api/ksopmapi/ns-ksopmapi-opm_get_info_parameters) содержат значение **ОПМ \_ \_ Тип защиты \_ HDCP**.

Когда метод [](/windows/desktop/api/opmapi/nf-opmapi-iopmvideooutput-getinformation) **абрекуестединформатион** возвращает, массив ОПМ в структуре [**\_ запрашиваемой \_ информации**](/windows/desktop/api/ksopmapi/ns-ksopmapi-opm_requested_information) содержит структуру [**ОПМ со \_ стандартной \_ информацией**](/windows/desktop/api/ksopmapi/ns-ksopmapi-opm_standard_information) . Элемент **улинформатион** этой структуры содержит значение из перечисления [**\_ \_ \_ уровня защиты HDCP ОПМ**](/windows/desktop/api/opmapi/ne-opmapi-opm_hdcp_protection_level) . Если значение равно **ОПМ \_ HDCP \_ On**, это означает, что включена поддержка HDCP. В противном случае повторите шаги 1 – 2, пока HDCP не будет включен, или произойдет ошибка. (Не забудьте увеличить порядковый номер и создать новое случайное число каждый раз.)

Для включения HDCP обычно требуется от 100 до 200 миллисекунд, но может потребоваться больше времени. Не считайте, что HDCP включен, пока вы не подтвердите ее.

Когда приложение завершает воспроизведение защищенного содержимого, отключите HDCP. Эти шаги те же, что и при включении HDCP, но на шаге 1 Установите для параметра **улпротектионлевел** значение **ОПМ \_ HDCP \_ Off**.

> [!Note]  
> Не включайте HDCP, если тип соединителя **ОПМ \_ \_ \_ дисплайпорт \_ Embedded**. (См. раздел [**Флаги типа соединителя ОПМ**](opm-connector-type-flags.md).)

 

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Диспетчер выходной защиты](output-protection-manager.md)
</dt> </dl>

 

 



