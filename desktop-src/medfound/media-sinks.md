---
description: Приемники носителей — это объекты конвейера, которые получают данные мультимедиа.
ms.assetid: a0fbce1b-0a16-4449-9eca-906fd9056a1c
title: Приемники носителей
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e9394cbfd49a631d59b9296202a2b6ca7a868869
ms.sourcegitcommit: c16214e53680dc71d1c07111b51f72b82a4512d8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/03/2021
ms.locfileid: "104351245"
---
# <a name="media-sinks"></a>Приемники носителей

*Приемники носителей* — это объекты конвейера, которые получают данные мультимедиа. Приемник носителя — это назначение для одного или нескольких потоков мультимедиа. Приемники мультимедиа делятся на две общие категории:

-   Модуль *подготовки* отчетов — это приемник мультимедиа, который представляет данные для воспроизведения. Расширенный обработчик видео (Евр) отображает видеокадры, а модуль подготовки звука воспроизводит звуковые потоки через звуковую карту или другое звуковое устройство.

-   *Приемник архива* — это приемник мультимедиа, который записывает данные в файл или в другое хранилище.

Основное различие между ними заключается в том, что приемник архива не потребляет данные с фиксированным темпом воспроизведения. Вместо этого он записывает данные, которые он получает как можно быстрее.

Приемники носителей предоставляют интерфейс [**имфмедиасинк**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink) . Каждый приемник мультимедиа содержит один или несколько *приемников потоков*. Каждый приемник потока получает данные из одного потока. Приемники потоков предоставляют интерфейс [**имфстреамсинк**](/windows/desktop/api/mfidl/nn-mfidl-imfstreamsink) . Обычно приложение не создает приемники мультимедиа напрямую. Вместо этого приложение создает один или несколько объектов активации, которые сеанс мультимедиа использует для создания приемника. Все остальные операции в приемнике обрабатываются сеансом мультимедиа, и приложение не вызывает никаких методов приемника носителя или любого приемника потока. Дополнительные сведения об объектах активации см. в разделе [объекты активации](activation-objects.md).

Прочтите оставшуюся часть этого раздела, если вы пишете пользовательский приемник мультимедиа или хотите использовать приемник мультимедиа напрямую без сеанса мультимедиа.

-   [Приемники потоков](#stream-sinks)
-   [Часы представления](#presentation-clock)
-   [Форматы потоков](#stream-formats)
-   [Поток данных](#data-flow)
-   [Метки](#markers)
-   [Изменения состояния](#state-changes)
-   [Завершение](#finalizing)
-   [Завершение работы](#shutting-down)
-   [Интерфейсы приемника мультимедиа](#media-sink-interfaces)
-   [Интерфейсы приемника потока](#stream-sink-interfaces)
-   [События приемника потока](#stream-sink-events)
-   [См. также](#related-topics)

## <a name="stream-sinks"></a>Приемники потоков

Приемник мультимедиа может иметь фиксированное число приемников потоков или может поддерживать Добавление и удаление приемников потоков. Если в нем имеется фиксированное число приемников потоков, метод [**имфмедиасинк::**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasink-getcharacteristics) -медиасинк возвращает \_ флаг фиксированных \_ потоков. В противном случае можно добавлять и удалять приемники потоков. Чтобы добавить новый приемник потока, вызовите метод [**имфмедиасинк:: аддстреамсинк**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasink-addstreamsink). Чтобы удалить приемник потока, вызовите метод [**имфмедиасинк:: ремовестреамсинк**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasink-removestreamsink). \_Флаг фиксированных \_ потоков медиасинк указывает, что приемник мультимедиа не поддерживает эти два метода. (Он может поддерживать другой способ настройки количества потоков, например путем настройки параметров инициализации при создании приемника.) Список приемников потоков упорядочен. Чтобы перечислить их по значению индекса, вызовите метод [**имфмедиасинк:: жетстреамсинкбиндекс**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasink-getstreamsinkbyindex) .

Приемники потоков также имеют идентификаторы. Идентификаторы потоков уникальны в приемнике мультимедиа, но не должны быть последовательными. В зависимости от приемника носителя идентификаторы потоков могут иметь некоторое значение, связанное с содержимым. Например, приемник архива может записывать идентификаторы потоков в заголовок файла. В противном случае они являются произвольными. Чтобы получить приемник потока по его идентификатору, вызовите метод [**имфмедиасинк:: жетстреамсинкбид**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasink-getstreamsinkbyid).

## <a name="presentation-clock"></a>Часы представления

Скорость, с которой приемник носителей потребляет выборки, управляется [часами представления](presentation-clock.md). Сеанс мультимедиа выбирает часы презентации и задает ее в приемнике мультимедиа, вызывая метод [**имфмедиасинк:: сетпресентатионклокк**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasink-setpresentationclock) приемника мультимедиа. Перед началом потоковой передачи необходимо задать часы презентации в приемнике мультимедиа. Для выполнения каждого приемника мультимедиа требуется время показа. Приемник мультимедиа использует часы презентации в двух целях:

-   Для получения уведомлений при запуске или остановке потоковой передачи. Приемник мультимедиа получает эти уведомления через интерфейс [**имфклоккстатесинк**](/windows/desktop/api/mfidl/nn-mfidl-imfclockstatesink) , который должен быть реализован всеми приемниками мультимедиа.

-   Чтобы определить, когда он должен визуализировать образцы. Когда приемник мультимедиа получает новый пример, он получает отметку времени из примера и пытается визуализировать образец в это время презентации.

Часы представления изменяются от другого объекта, который называется *источником времени презентации*. Источники времени представления предоставляют интерфейс [**имфпресентатионтимесаурце**](/windows/desktop/api/mfidl/nn-mfidl-imfpresentationtimesource) . Некоторые приемники мультимедиа имеют доступ к точным часам, поэтому они предоставляют этот интерфейс. Это означает, что приемник мультимедиа может запланировать выборку в соответствии со временем, предоставленным собственными часами. Однако приемник мультимедиа не может предположить, что это так. Он всегда должен использовать время из часов презентации, независимо от того, управляется ли он самим приемником мультимедиа или другими часами.

Если приемник мультимедиа не может сопоставлять скорости с часами, отличными от собственных [**, метод медиасинк**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasink-getcharacteristics) возвращает \_ \_ \_ флаг часов. Если этот флаг установлен и в качестве часов представления используется другой источник времени презентации, приемник мультимедиа, скорее всего, будет работать плохо. Например, может возникнуть сбой во время воспроизведения.

Приемник без учета *скорости* — это приемник мультимедиа, который игнорирует метки времени для выборок и использует данные сразу после получения каждого образца. Приемник мультимедиа с нескоростью, который не имеет интенсивности, Возвращает флаг МЕДИАСИНК с учетом \_ скорости из метода "коэффициенты [**"**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasink-getcharacteristics) . Обычно этот флаг применяется к приемникам архива. Если для каждого приемника мультимедиа в конвейере не используется частота, сеанс мультимедиа использует специальные часы представления с учетом скорости. Это время выполняется так быстро, как приемники используют образцы.

## <a name="stream-formats"></a>Форматы потоков

Прежде чем приемник мультимедиа сможет получать образцы, клиент должен задать тип носителя для приемников потока. Чтобы задать тип мультимедиа, вызовите метод [**имфстреамсинк:: жетмедиатипехандлер**](/windows/desktop/api/mfidl/nf-mfidl-imfstreamsink-getmediatypehandler) приемника потока. Этот метод возвращает указатель на интерфейс [**имфмедиатипехандлер**](/windows/desktop/api/mfidl/nn-mfidl-imfmediatypehandler) . Используйте этот интерфейс для получения списка предпочтительных типов мультимедиа, получения текущего типа мультимедиа и задания типа носителя.

Чтобы получить список предпочтительных типов мультимедиа, вызовите метод [**имфмедиатипехандлер:: жетмедиатипебиндекс**](/windows/desktop/api/mfidl/nf-mfidl-imfmediatypehandler-getmediatypebyindex). Предпочтительные типы следует принимать в качестве подсказки для клиента. Список может быть неполным или включать частичные типы носителей. Частичный тип носителя — это тот, который не имеет всех атрибутов, необходимых для описания допустимого формата. Например, в частичном типе видео можно указать цветовое пространство и битовую глубину, но не ширину или высоту изображения. Частичный тип звука может указывать формат сжатия и частоту выборки, но не число каналов звука.

Чтобы получить текущий тип носителя приемника потока, вызовите метод [**имфмедиатипехандлер:: жеткуррентмедиатипе**](/windows/desktop/api/mfidl/nf-mfidl-imfmediatypehandler-getcurrentmediatype). При первом создании приемника потока он может иметь тип носителя по умолчанию или не иметь типа носителя, пока клиент не установит его.

Чтобы задать тип мультимедиа, вызовите [**имфмедиатипехандлер:: сеткуррентмедиатипе**](/windows/desktop/api/mfidl/nf-mfidl-imfmediatypehandler-setcurrentmediatype). Некоторые приемники потоков могут не поддерживать изменение типа после установки. Поэтому полезно протестировать типы мультимедиа перед их настройкой. Чтобы проверить, будет ли приемник мультимедиа принимать тип мультимедиа (без задания типа), вызовите [**имфмедиатипехандлер:: исмедиатипесуппортед**](/windows/desktop/api/mfidl/nf-mfidl-imfmediatypehandler-ismediatypesupported).

## <a name="data-flow"></a>Поток данных

Приемники носителей используют *модель извлечения*, что означает, что приемники потоков запрашивают данные по мере необходимости. Клиент должен своевременно реагировать на запросы, чтобы избежать сбоев.

Некоторые приемники мультимедиа поддерживают *предвыпуск*. Предварительная подготовка — это процесс передачи данных в приемник мультимедиа до запуска представления. Если приемник мультимедиа поддерживает предустановку, приемник мультимедиа предоставляет интерфейс [**имфмедиасинкпреролл**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasinkpreroll) , а метод WebMethod ВОЗВРАЩАЕТ флаг медиасинк [**, который**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasink-getcharacteristics) \_ можно \_ превращение. Предварительная подготовка гарантирует, что приемник мультимедиа будет готов к представлению первого образца при запуске часов презентации. Рекомендуется всегда выполнять предустановку клиента, если он поддерживается приемником мультимедиа, так как он может предотвратить сбои или пропуски во время воспроизведения.

Поток данных в приемнике мультимедиа работает следующим образом:

1.  Клиент задает типы носителей и часы представления. Приемник мультимедиа регистрируется с часами представления для получения уведомлений об изменениях состояния часов.
2.  При необходимости клиент запрашивает [**имфмедиасинкпреролл**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasinkpreroll). Если приемник мультимедиа предоставляет этот интерфейс, клиент вызывает [**имфмедиасинкпреролл:: нотифипреролл**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasinkpreroll-notifypreroll). В противном случае клиент переходит к шагу 5.
3.  Каждый приемник потока отправляет одно или несколько событий [местреамсинкрекуестсампле](mestreamsinkrequestsample.md) . В ответ на каждое из этих событий клиент получает следующий образец данных для этого потока и вызывает [**имфстреамсинк::P роцесссампле**](/windows/desktop/api/mfidl/nf-mfidl-imfstreamsink-processsample).
4.  Когда каждый приемник потока получает достаточно данных о предрулонной передаче, он отправляет событие [местреамсинкпрероллед](mestreamsinkprerolled.md) .
5.  Клиент вызывает [**имфпресентатионклокк:: Start**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-start) для запуска представления часов.
6.  Часы презентации уведомляют приемник мультимедиа о начале часов, вызвав [**имфклоккстатесинк:: онклоккстарт**](/windows/desktop/api/mfidl/nf-mfidl-imfclockstatesink-onclockstart).
7.  Для получения дополнительных данных каждый приемник потока отправляет события [местреамсинкрекуестсампле](mestreamsinkrequestsample.md) . В ответ на каждое из этих событий клиент получает следующий пример и вызывает [**процесссампле**](/windows/desktop/api/mfidl/nf-mfidl-imfstreamsink-processsample). Этот шаг повторяется до завершения презентации.

Большинство приемников мультимедиа обрабатывают примеры асинхронно, поэтому приемники потоков могут одновременно отправить несколько запросов на выборку.

Во время потоковой передачи клиент может вызвать [**имфстреамсинк::P лацемаркер**](/windows/desktop/api/mfidl/nf-mfidl-imfstreamsink-placemarker) и [**Имфстреамсинк:: Flush**](/windows/desktop/api/mfidl/nf-mfidl-imfstreamsink-flush) в любое время. Маркеры описаны в следующем разделе. Сброс приводит к тому, что приемник потока удаляет все образцы, которые он помещает в очередь, но еще не подготовлен к просмотру.

## <a name="markers"></a>Метки

Маркеры предоставляют клиенту способ указания конкретных точек в потоке. Маркер состоит из следующих сведений:

-   Тип маркера, определенный как член перечисления [**\_ \_ типа маркера мфстреамсинк**](/windows/desktop/api/mfidl/ne-mfidl-mfstreamsink_marker_type) .
-   Данные, связанные с маркером. Значение данных зависит от типа маркера. Некоторые типы маркеров не имеют данных.
-   Необязательные данные для собственного использования клиентом.

Чтобы поместить маркер, клиент вызывает [**имфстреамсинк::P лацемаркер**](/windows/desktop/api/mfidl/nf-mfidl-imfstreamsink-placemarker). Приемник потока завершает обработку всех выборок, полученных перед вызовом **плацемаркер** , а затем отправляет событие [местреамсинкмаркер](mestreamsinkmarker.md) .

Большинство приемников мультимедиа сохраняют очередь ожидающих выборок, которые они обрабатывали асинхронно. События маркера должны быть сериализованы с помощью образца обработки, поэтому приемник мультимедиа должен поместить маркеры в одну очередь. Например, предположим, что клиент выполняет следующие вызовы методов:

1.  [**Процесссампле**](/windows/desktop/api/mfidl/nf-mfidl-imfstreamsink-processsample) (пример \# 1)
2.  [**Процесссампле**](/windows/desktop/api/mfidl/nf-mfidl-imfstreamsink-processsample) (пример \# 2)
3.  [**Плацемаркер**](/windows/desktop/api/mfidl/nf-mfidl-imfstreamsink-placemarker) (маркер \# 1)
4.  [**Процесссампле**](/windows/desktop/api/mfidl/nf-mfidl-imfstreamsink-processsample) (пример \# 3)
5.  [**Плацемаркер**](/windows/desktop/api/mfidl/nf-mfidl-imfstreamsink-placemarker) (маркер \# 2)

В этом примере приемник потока должен отправить событие [местреамсинкмаркер](mestreamsinkmarker.md) для маркера \# 1 после того, как он обрабатывает пример \# 2, и событие для маркера \# 2 после того, как он обработает пример \# 3.

Если клиент очищает приемник потока, приемник потока немедленно обрабатывает все маркеры, находящиеся в очереди. Он устанавливает для кода состояния значение E \_ Abort для этих событий.

Некоторые маркеры содержат сведения, относящиеся к приемнику мультимедиа:

-   **Мфстреамсинк \_ \_Tick маркера**: указывает, что в потоке присутствует разрыв. Следующий пример будет ненепрерывным.
-   **Мфстреамсинк \_ МАРКЕР \_ ендофсегмент**: указывает конец сегмента или конец потока. Следующий пример (если таковой имеется) может быть ненепрерывным.
-   **Мфстреамсинк \_ \_Событие маркера**: содержит событие. В зависимости от типа события и реализации приемника мультимедиа приемник мультимедиа может обрабатывать событие или игнорировать его.

## <a name="state-changes"></a>"Изменения состояния".

Приемник мультимедиа уведомляет об изменениях состояния в часах представления через интерфейс [**имфклоккстатесинк**](/windows/desktop/api/mfidl/nn-mfidl-imfclockstatesink) приемника мультимедиа. Когда клиент задает часы презентации, приемник мультимедиа вызывает [**имфпресентатионклокк:: аддклоккстатесинк**](/windows/desktop/api/mfidl/nf-mfidl-imfpresentationclock-addclockstatesink) , чтобы зарегистрировать себя для уведомлений из часов. В следующей таблице перечислены принципы работы приемника мультимедиа в ответ на изменения состояния часов.



| Изменение состояния часов                                         | Пример обработки                                                                                                                                                                                                                                             | Обработка маркеров                                                                                                                                                                                   |
|------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**онклоккстарт**](/windows/desktop/api/mfidl/nf-mfidl-imfclockstatesink-onclockstart)     | Обработка образцов, отметок времени которых меньше или позднее времени начала часов.                                                                                                                                                                              | Отправка события [местреамсинкмаркер](mestreamsinkmarker.md) при обработке всех примеров, полученных до маркера.                                                                 |
| [**онклоккпаусе**](/windows/desktop/api/mfidl/nf-mfidl-imfclockstatesink-onclockpause)     | При приостановке приемник мультимедиа может завершаться сбоем [**процесссампле**](/windows/desktop/api/mfidl/nf-mfidl-imfstreamsink-processsample) .<br/> Если приемник мультимедиа принимает выборки во время приостановки, он должен поставить их в очередь до перезапуска часов. Не обработайте образцы в очереди во время приостановки.<br/> | Если имеются образцы в очереди, помещайте маркеры в одну очередь. Отправка события маркера при перезапуске часов.<br/> В противном случае немедленно отправьте событие маркера.<br/>                    |
| [**онклоккрестарт**](/windows/desktop/api/mfidl/nf-mfidl-imfclockstatesink-onclockrestart) | Обработайте все образцы, которые были поставлены в очередь во время приостановки, а затем обрабатывают то же, что и [**онклоккстарт**](/windows/desktop/api/mfidl/nf-mfidl-imfclockstatesink-onclockstart).                                                                                                                         | Отправка событий [местреамсинкмаркер](mestreamsinkmarker.md) для маркеров в очереди (сериализованных с помощью образца обработки), а затем обрабатывает то же, что и [**онклоккстарт**](/windows/desktop/api/mfidl/nf-mfidl-imfclockstatesink-onclockstart). |
| [**онклоккстоп**](/windows/desktop/api/mfidl/nf-mfidl-imfclockstatesink-onclockstop)       | Удалите все образцы в очереди. Дальнейшие вызовы [**процесссампле**](/windows/desktop/api/mfidl/nf-mfidl-imfstreamsink-processsample) могут завершиться ошибкой.                                                                                                                                                      | Отправка событий маркера в очереди. При последующих вызовах [**плацемаркер**](/windows/desktop/api/mfidl/nf-mfidl-imfstreamsink-placemarker)немедленно отправьте событие маркера.                                                              |



 

Кроме того, приемники потоков должны отправить следующие события, когда они завершили переходы состояния:

-   [**Онклоккстарт**](/windows/desktop/api/mfidl/nf-mfidl-imfclockstatesink-onclockstart), [**онклоккрестарт**](/windows/desktop/api/mfidl/nf-mfidl-imfclockstatesink-onclockrestart): событие [местреамсинкстартед](mestreamsinkstarted.md)
-   [**Онклоккпаусе**](/windows/desktop/api/mfidl/nf-mfidl-imfclockstatesink-onclockpause): событие [местреамсинкпаусед](mestreamsinkpaused.md)
-   [**Онклоккстоп**](/windows/desktop/api/mfidl/nf-mfidl-imfclockstatesink-onclockstop): событие [местреамсинкстоппед](mestreamsinkstopped.md)

## <a name="finalizing"></a>Завершение

Некоторые приемники мультимедиа потребовали дополнительного шага обработки после доставки последней выборки. Обычно это требование относится к приемникам архива, которые должны записывать заголовки или индексы в файл. Если приемнику мультимедиа требуется окончательная обработка, он предоставляет интерфейс [**имффинализаблемедиасинк**](/windows/desktop/api/mfidl/nn-mfidl-imffinalizablemediasink) .

После того как клиент доставляет последнюю выборку, клиент запрашивает этот интерфейс. Если приемник мультимедиа поддерживает интерфейс, клиент вызывает [**имффинализаблемедиасинк:: бегинфинализе**](/windows/desktop/api/mfidl/nf-mfidl-imffinalizablemediasink-beginfinalize) для асинхронной обработки. Этот метод соответствует стандартной асинхронной модели Media Foundation, описанной в разделе [асинхронные методы обратного вызова](asynchronous-callback-methods.md). Приемник мультимедиа может предположить, что клиент будет вызывать **бегинфинализе**. Сбой вызова **бегинфинализе** может привести к созданию неправильно созданного файла.

## <a name="shutting-down"></a>Завершение работы

Когда клиент завершит работу с приемником мультимедиа, клиент вызывает [**имфмедиасинк:: Shutdown**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasink-shutdown). Внутри этого метода приемник мультимедиа должен прерывать любые циклические счетчики ссылок. Как правило, между приемником мультимедиа и приемниками потоков будут существовать циклические ссылки.

Если для реализации [**имфмедиаевентженератор**](/windows/desktop/api/mfobjects/nn-mfobjects-imfmediaeventgenerator)используется вспомогательный объект очереди событий, вызовите [**Имфмедиаевенткуеуе:: Shutdown**](/windows/desktop/api/mfobjects/nf-mfobjects-imfmediaeventqueue-shutdown) в очереди событий. Этот метод завершает работу очереди событий и сигнализирует любому вызывающему объекту, который в данный момент ожидает события.

После завершения работы все методы в приемнике носителей возвращают MF \_ E \_ Shutdown, за исключением методов **IUnknown** .

## <a name="media-sink-interfaces"></a>Интерфейсы приемника мультимедиа

В следующей таблице перечислены стандартные интерфейсы, которые приемники мультимедиа могут предоставлять через **QueryInterface**. Приемники носителей также могут предоставлять настраиваемые интерфейсы.



| Интерфейс                                                      | Описание                                                                                   |
|----------------------------------------------------------------|-----------------------------------------------------------------------------------------------|
| [**имфмедиасинк**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink)                           | Основной интерфейс для приемников мультимедиа. (Обязательно).                                            |
| [**имфклоккстатесинк**](/windows/desktop/api/mfidl/nn-mfidl-imfclockstatesink)                 | Используется для уведомления приемника мультимедиа при изменении состояния часов представления. (Обязательно).              |
| [**имффинализаблемедиасинк**](/windows/desktop/api/mfidl/nn-mfidl-imffinalizablemediasink)     | Реализуйте, если приемник мультимедиа должен выполнить окончательный этап обработки. (Необязательно.)                 |
| [**имфжетсервице**](/windows/desktop/api/mfidl/nn-mfidl-imfgetservice)                         | Реализуйте, если приемник мультимедиа предоставляет какие бы то ни было интерфейсы службы. (Необязательно.)                       |
| [**имфмедиаевентженератор**](/windows/desktop/api/mfobjects/nn-mfobjects-imfmediaeventgenerator)       | Реализуйте, если приемник мультимедиа отправляет любые события. (Необязательно.)                                     |
| [**имфмедиасинкпреролл**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasinkpreroll)             | Реализуйте, если приемник мультимедиа поддерживает предустановку. (Необязательно.)                                     |
| [**имфпресентатионтимесаурце**](/windows/desktop/api/mfidl/nn-mfidl-imfpresentationtimesource) | Реализуйте, если приемник мультимедиа может предоставить источник времени для часов представления. (Необязательно.) |
| [**имфкуалитядвисе**](/windows/desktop/api/mfidl/nn-mfidl-imfqualityadvise)                   | Реализуйте, если приемник мультимедиа может настроить качество воспроизведения. (Необязательно.)                          |



 

Кроме того, приемник мультимедиа может реализовать в качестве службы следующий интерфейс.



| Интерфейс службы                        | Описание                                    |
|------------------------------------------|------------------------------------------------|
| [**имфратесуппорт**](/windows/desktop/api/mfidl/nn-mfidl-imfratesupport) | Сообщает диапазон поддерживаемых ставок воспроизведения. |



 

Дополнительные сведения об интерфейсах служб и [**имфжетсервице**](/windows/desktop/api/mfidl/nn-mfidl-imfgetservice)см. в разделе [интерфейсы служб](service-interfaces.md).

## <a name="stream-sink-interfaces"></a>Интерфейсы приемника потока

Приемники потоков должны предоставлять следующие интерфейсы через **QueryInterface**.



| Интерфейс                                                | Описание                                                                                              |
|----------------------------------------------------------|----------------------------------------------------------------------------------------------------------|
| [**имфстреамсинк**](/windows/desktop/api/mfidl/nn-mfidl-imfstreamsink)                   | Основной интерфейс для приемников потоков. (Обязательно).                                                      |
| [**имфмедиаевентженератор**](/windows/desktop/api/mfobjects/nn-mfobjects-imfmediaeventgenerator) | Помещает события в очередь. Интерфейс [**имфстреамсинк**](/windows/desktop/api/mfidl/nn-mfidl-imfstreamsink) наследует этот интерфейс. (Обязательно). |



 

В настоящее время для приемников потоков не определены интерфейсы службы.

## <a name="stream-sink-events"></a>События приемника потока

В следующей таблице перечислены события, определенные для универсальных приемников потока. Приемники потоков также могут передавать пользовательские события, не указанные здесь.



| Событие                                                                  | Описание                                                  |
|------------------------------------------------------------------------|--------------------------------------------------------------|
| [местреамсинкформатчанжед](mestreamsinkformatchanged.md)             | Тип носителя приемника потока больше не действителен. (Необязательно.) |
| [местреамсинкмаркер](mestreamsinkmarker.md)                           | Маркер обработан. (Обязательно).                          |
| [местреамсинкпаусед](mestreamsinkpaused.md)                           | Работа приемника потока приостановлена. (Обязательно).                      |
| [местреамсинкпрероллед](mestreamsinkprerolled.md)                     | Предвосстановление завершено. (Необязательно.)                             |
| [местреамсинкратечанжед](mestreamsinkratechanged.md)                 | Приемник потока изменил скорость воспроизведения. (Необязательно.)       |
| [местреамсинкрекуестсампле](mestreamsinkrequestsample.md)             | Запрашивается новый пример. (Обязательно).                       |
| [местреамсинкскрубсамплекомплете](mestreamsinkscrubsamplecomplete.md) | Запрос на очистку завершен. (Необязательно.)                   |
| [местреамсинкстартед](mestreamsinkstarted.md)                         | Запущен приемник потока. (Обязательно).                     |
| [местреамсинкстоппед](mestreamsinkstopped.md)                         | Приемник потока остановлен. (Обязательно).                     |



 

Сейчас для приемников мультимедиа не определены события общего назначения. Некоторые приемники мультимедиа могут отправить пользовательские события.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Конвейер Media Foundation](media-foundation-pipeline.md)
</dt> <dt>

[Архитектура Media Foundation](media-foundation-architecture.md)
</dt> </dl>

 

 




