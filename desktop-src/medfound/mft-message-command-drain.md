---
description: Запрашивает преобразование Media Foundation (MFT) для сброса всех хранящихся данных.
ms.assetid: c48f3a88-a007-4f30-ac60-9e5a8c24e1ee
title: MFT_MESSAGE_COMMAND_DRAIN (Мфтрансформ. h)
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: aa533cfddfda53fd8eb0ee512b0535aaf9ad8f88
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105662777"
---
# <a name="mft_message_command_drain"></a>\_ \_ сток команды сообщения \_ MFT

Запрашивает преобразование Media Foundation (MFT) для сброса всех хранящихся данных.

## <a name="message-parameter"></a>Параметр сообщения

Нет.

## <a name="remarks"></a>Remarks

Чтобы отправить это сообщение, вызовите [**имфтрансформ::P роцессмессаже**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processmessage).

После отправки этого сообщения указанный входной поток не принимает входные данные, пока MFT обрабатывает все данные из предыдущих вызовов [**имфтрансформ::P роцессинпут**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput).

Процесс очистки незначительно различает синхронные МФТС и асинхронные МФТС:

**Синхронный МФТС**

1.  После того как клиент отправляет это сообщение, он вызывает [**имфтрансформ::P роцессаутпут**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processoutput) в цикле до тех пор, пока **ProcessOutput** не вернет код ошибки **MF E для \_ \_ преобразования \_ требуется \_ больше \_ входных данных**.
2.  Пока MFT все еще содержит данные для обработки, дальнейшие вызовы метода [**ProcessInput**](/windows/desktop/api/mftransform/nf-mftransform-imftransform-processinput) завершатся ошибкой. MFT будет создавать выходные данные до тех пор, пока не будут использованы все хранимые данные. Таблица MFT отклоняет все данные, которые не могут быть обработаны, в полный образец выходных данных. (Например, он должен удалить часть видеокадра.)

**Асинхронный МФТС**

1.  Таблица MFT продолжит отсылать события [метрансформхавеаутпут](metransformhaveoutput.md) , пока не будет больше данных для обработки. В течение этого времени события [метрансформнидинпут](metransformneedinput.md) не отправляются.
2.  После того как MFT отправляет Последнее событие [метрансформхавеаутпут](metransformhaveoutput.md) , оно отправляет событие [метрансформдраинкомплете](metransformdraincomplete.md) .
3.  После завершения очистки Таблица MFT не отправляет другое событие [метрансформнидинпут](metransformneedinput.md) , пока не получит [**\_ сообщение MFT \_ о \_ начале \_ \_ потока**](mft-message-notify-start-of-stream.md) сообщения от клиента.

После очистки MFT клиент может отправить дополнительные входные данные. Первый пример после операции стока должен иметь атрибут небесперебойности (атрибут [**мфсампликстенсионности \_**](mfsampleextension-discontinuity-attribute.md) небесперебойности).

> [!Note]  
> В более ранних версиях этой документации указано, что параметр события *улпарам* является членом перечисления [**\_ \_ \_ типа стока MFT**](/windows/win32/api/mftransform/ne-mftransform-_mft_drain_type) . Неверно. *Улпарам* содержит идентификатор потока.

 

### <a name="implementation"></a>Реализация

Асинхронная Таблица MFT всегда должна возвращать [метрансформдраинкомплете](metransformdraincomplete.md) после ее очистки.

Синхронная MFT может игнорировать это сообщение и вернуть \_ значение ОК, если выполняются следующие условия.

-   MFT никогда не хранит более одного входного образца одновременно.
-   Каждый входной образец создает один пример вывода.

В противном случае это сообщение должно быть реализовано в синхронной таблице MFT.

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|------------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Только для \[ классических приложений Windows Vista\]<br/>                                           |
| Минимальная версия сервера<br/> | \[Только для настольных приложений Windows Server 2008\]<br/>                                     |
| Header<br/>                   | <dl> <dt>Мфтрансформ. h</dt> </dl> |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**\_тип сообщения \_ MFT**](/windows/desktop/api/mftransform/ne-mftransform-mft_message_type)
</dt> <dt>

[Асинхронный МФТС](asynchronous-mfts.md)
</dt> </dl>

 

 




