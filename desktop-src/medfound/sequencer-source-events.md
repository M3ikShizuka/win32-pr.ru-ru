---
description: События источника Sequencer
ms.assetid: 28654bae-9ce2-467b-b769-63279d69b173
title: События источника Sequencer
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fdf97cc5ff25c8a5fc40fa4990bf38c652f94e63
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127363716"
---
# <a name="sequencer-source-events"></a>События источника Sequencer

Когда [источник Sequencer](sequencer-source.md) воспроизводит последовательность файлов, сеанс мультимедиа обычно отправляет все те же события, которые отправляются во время обычного воспроизведения, а список [событий сеанса мультимедиа](media-session-events.md). Приложение получает эти события с помощью интерфейса [**Имфмедиаевентженератор**](/windows/desktop/api/mfobjects/nn-mfobjects-imfmediaeventgenerator) сеанса мультимедиа.

Кроме того, существуют некоторые события, относящиеся к сегментам списка воспроизведения.



| Событие                                                                                                   | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
|---------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [меневпресентатион](menewpresentation.md)                                                              | Сообщает приложению о необходимости выполнить предследующую топологию.<br/> Чтобы обеспечить простой переход между двумя последовательными презентациями, источник Sequencer заранее загружает следующую топологию. Пока активная топология все еще воспроизводится, источник Sequencer отправляет это событие для следующей топологии, если в источнике имеется последующая топология.<br/> Данные этого события для этого события являются дескриптором представления для следующей топологии. Приложение отвечает за установку соответствующей топологии в сеансе мультимедиа, как описано в разделе [Использование источника Sequencer](using-the-sequencer-source.md).<br/> |
| [миндофпресентатионсегмент](meendofpresentationsegment.md)                                            | Источник Sequencer вызывает это событие, когда сеанс мультимедиа завершил воспроизведение текущего сегмента, если за этим сегментом следует другой сегмент. (Если текущий сегмент является последним, источник Sequencer создает событие [миндофпресентатион](meendofpresentation.md) .)<br/> Сеанс мультимедиа перенаправляет это событие в приложение. Как правило, приложение получает [миндофпресентатионсегмент](meendofpresentationsegment.md) после того, как сеанс мультимедиа начнет обработку следующего сегмента, но в то время как приемники мультимедиа по-прежнему предоставляют образцы для предыдущего сегмента.<br/>                            |
| [Месессионтопологистатус](mesessiontopologystatus.md)с состоянием **MF \_ топостатус \_ SINK \_**. | Сеанс мультимедиа вызывает это событие при переходе к следующей топологии в источнике Sequencer, и приемники носителей завершили Воспроизведение предыдущей топологии. Это событие содержит указатель на следующую топологию.                                                                                                                                                                                                                                                                                                                                                                                                                                      |



 

## <a name="example-1-playback-without-skipping"></a>Пример 1. воспроизведение без пропуска

Если используется источник Sequencer, то количество событий, получаемых из сеанса мультимедиа, может быть запутанным, особенно потому, что события, связанные с одним сегментом, часто чередуются с событиями для следующего сегмента.

В первом примере приложение помещает в очередь три сегмента: S1, S2 и S3. Третий сегмент имеет флаг **секуенцертопологифлагс \_ Last** , который сигнализирует, что это последний сегмент последовательности. Сегмент, которому соответствует каждое событие, задается в круглых скобках. Также перечислены вызовы [**сеттопологи**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-settopology) приложения, чтобы сделать порядок операций более четким.

-   Приложение вызывает [**имфмедиасессион:: сеттопологи**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-settopology) (S1)
-   [Месессионтопологисет](mesessiontopologyset.md) (S1)
-   [Месессионтопологистатус](mesessiontopologystatus.md): **MF \_ топостатус \_ Ready** (S1)
-   [Меневпресентатион](menewpresentation.md) (предвыпуск S2)
-   Приложение вызывает [**имфмедиасессион:: сеттопологи**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-settopology) (S2)
-   [Месессионтопологистатус](mesessiontopologystatus.md): **MF \_ топостатус \_ Started \_ Source** (начало S1)
-   [Месессионтопологисет](mesessiontopologyset.md) (S2)
-   [Миндофпресентатионсегмент](meendofpresentationsegment.md) (конец S1)
-   [Месессионтопологистатус](mesessiontopologystatus.md): **MF \_ топостатус \_ завершен** (S1)
-   [Месессионтопологистатус](mesessiontopologystatus.md): **MF \_ топостатус \_ SINK \_ переключилось** (переход на S2)
-   [Месессионтопологистатус](mesessiontopologystatus.md): **MF \_ топостатус \_ Ready** (S2)
-   [Месессионтопологистатус](mesessiontopologystatus.md): **MF \_ топостатус \_ Started \_ Source** (начало S2)
-   [Меневпресентатион](menewpresentation.md) (предвыпуск S3)
-   Приложение вызывает [**имфмедиасессион:: сеттопологи**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-settopology) (S2)
-   [Месессионтопологисет](mesessiontopologyset.md) (S3)
-   [Миндофпресентатионсегмент](meendofpresentationsegment.md) (окончание S2)
-   [Месессионтопологистатус](mesessiontopologystatus.md): **MF \_ топостатус \_ завершен** (S2)
-   [Месессионтопологистатус](mesessiontopologystatus.md): **MF \_ топостатус \_ SINK \_ переключилось** (переход на S3)
-   [Месессионтопологистатус](mesessiontopologystatus.md): **MF \_ топостатус \_ Ready** (S3)
-   [Месессионтопологистатус](mesessiontopologystatus.md): **MF \_ топостатус \_ Started \_ Source** (начало S3)
-   [Миндофпресентатион](meendofpresentation.md) (окончание S3; последний сегмент)
-   [Месессионтопологистатус](mesessiontopologystatus.md): **MF \_ топостатус \_ завершен**
-   [месессионендед](mesessionended.md)

В этот список не входят все события, которые могут быть получены. (Например, в нем пропущено событие [месессионкапабилитиесчанжед](mesessioncapabilitieschanged.md) , которое отправляется при изменении возможностей сеанса. Приложение обычно получает несколько событий Месессионкапабилитиесчанжед во всей презентации.) Ниже перечислены события, которые показывают переход от одного сегмента к другому. Наиболее важными событиями являются [меневпресентатион](menewpresentation.md), которые сообщают приложению о предопределенной следующей топологии, и [миндофпресентатионсегмент](meendofpresentationsegment.md), который сигнализирует об окончании сегмента (за исключением последнего сегмента).

Так как события в Media Foundation являются асинхронными и не сериализуются с помощью вызовов методов, точный порядок может отличаться. Например, можно получить **MF \_ топостатус \_ Started \_ Source** для S1, прежде чем приложение вызовет [**сеттопологи**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-settopology) для S2.

Кроме того, вы можете не получить каждое событие, указанное здесь. Например, события [миндофпресентатион](meendofpresentation.md) и [месессионендед](mesessionended.md) не отправляются, если только последний сегмент не имеет **\_ последнего** флага секуенцертопологифлагс.

Наконец, этот список не указывает на время. Время "с начала S1" до "конец S1" — это полная продолжительность S1, которая может составлять несколько секунд или несколько часов, в зависимости от источника.

## <a name="example-2-playback-with-segment-skipping"></a>Пример 2. Воспроизведение с помощью пропущенного сегмента

В этом примере приложение помещает в очередь одни и те же сегменты, но переходит к сегменту 3 во время воспроизведения сегмента 1. В этом случае отправляются следующие события:

-   Приложение вызывает [**имфмедиасессион:: сеттопологи**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-settopology) (S1)
-   [Месессионтопологисет](mesessiontopologyset.md) (S1)
-   [Месессионтопологистатус](mesessiontopologystatus.md): **MF \_ топостатус \_ Ready** (S1)
-   [Меневпресентатион](menewpresentation.md) (предвыпуск S2)
-   Приложение вызывает [**имфмедиасессион:: сеттопологи**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-settopology) (S2)
-   [Месессионтопологистатус](mesessiontopologystatus.md): **MF \_ топостатус \_ Started \_ Source** (начало S1)
-   [Месессионтопологисет](mesessiontopologyset.md) (S2)
-   Приложение вызывает [**имфмедиасессион:: Start**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-start) (переход к S3)
-   [Меневпресентатион](menewpresentation.md) (предвыпуск S3)
-   Приложение вызывает [**имфмедиасессион:: сеттопологи**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-settopology) (S3)
-   [месессионстартед](mesessionstarted.md)
-   [Миндофпресентатионсегмент](meendofpresentationsegment.md) (S1 отменено)
-   [Месессионтопологистатус](mesessiontopologystatus.md): **MF \_ топостатус \_ завершен** (S1)
-   [Месессионтопологисет](mesessiontopologyset.md) (S3)
-   [Месессионтопологистатус](mesessiontopologystatus.md): **MF \_ топостатус \_ SINK \_ переключилось** (переход на S2)
-   [Месессионтопологистатус](mesessiontopologystatus.md): **MF \_ топостатус \_ Ready** (S2)
-   [Месессионтопологистатус](mesessiontopologystatus.md): **MF \_ топостатус \_ Started \_ Source** (S2)
-   [Миндофпресентатионсегмент](meendofpresentationsegment.md) (S2 отменен)
-   [Месессионтопологистатус](mesessiontopologystatus.md): **MF \_ топостатус \_ завершен** (S2)
-   [Месессионтопологистатус](mesessiontopologystatus.md): **MF \_ топостатус \_ SINK \_ переключилось** (переход на S3)
-   [Месессионтопологистатус](mesessiontopologystatus.md): **топостатус \_ Ready** (S3)
-   [Месессионтопологистатус](mesessiontopologystatus.md): **MF \_ топостатус \_ Started \_ Source** (S3)

Когда приложение вызывает [**Запуск**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-start) для перехода к сегменту 3, источник Sequencer отменяет сегмент 1, который по-прежнему воспроизводится. Событие [миндофпресентатионсегмент](meendofpresentationsegment.md) для этого сегмента содержит атрибут " [**% \_ событий \_ \_ топологии источника \_ события MF**](mf-event-source-topology-canceled-attribute.md) ", указывающий, что сегмент завершился, так как он был отменен. Затем, поскольку сегмент 2 уже предварительно выполнил откат, этот сегмент запускается, но затем немедленно отменяется. Событие Миндофпресентатионсегмент для сегмента 2 также содержит атрибут "% событий", **\_ \_ \_ \_ отмененный топологией источника события MF** . Затем сеанс может переключиться на сегмент 3 и воспроизводить его в обычном режиме.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Сведения о источнике Sequencer](about-the-sequencer-source.md)
</dt> <dt>

[Источник Sequencer](sequencer-source.md)
</dt> </dl>

 

 




