---
description: Объекты активации
ms.assetid: 767d5f1c-2b8d-43b6-916b-035129e93204
title: Объекты активации
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 401b4643e7e19c8cf0b7235218eaed2e355565fdb82a9d3756558e1f11991cbe
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119035602"
---
# <a name="activation-objects"></a>Объекты активации

*Объект активации* — это вспомогательный объект, который используется для создания другого объекта, что напоминает фабрику классов. Объекты активации предоставляют интерфейс [**имфактивате**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) .

Объект активации позволяет отложить создание целевого объекта, так как вы можете удерживать указатель на [**имфактивате**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) , не создавая целевой объект. Объекты активации также можно сериализовать и, следовательно, использовать для создания целевого объекта в другом процессе. Например, объекты активации используются для маршалирования компонентов конвейера из процесса приложения в процесс защищенного пути к носителю (PMP). Объекты активации также используются некоторыми функциями перечисления, которые возвращают список **имфактиватеных** указателей. Прежде чем приложение создаст целевой объект, оно может получить сведения об объекте, изучив атрибуты объекта активации.

Чтобы создать целевой объект из объекта активации, вызовите метод [**имфактивате:: активатеобжект**](/windows/desktop/api/mfobjects/nf-mfobjects-imfactivate-activateobject) . Вызывающий объект должен вызвать [**имфактивате:: шутдовнобжект**](/windows/desktop/api/mfobjects/nf-mfobjects-imfactivate-shutdownobject) , когда он завершится с помощью созданного объекта. Часто приложение создает объект активации, а сеанс мультимедиа вызывает **активатеобжект**. В этом случае сеанс мультимедиа, а не приложение, должен вызывать **шутдовнобжект**. В других ситуациях приложение получает указатель [**имфактивате**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) из сеанса мультимедиа, и приложение вызывает **активатеобжект** и **шутдовнобжект**. (Например, см. раздел [как воспроизвести защищенные файлы мультимедиа](how-to-play-protected-media-files.md).)

Объекты активации могут иметь атрибуты, а интерфейс [**имфактивате**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) наследует интерфейс [**имфаттрибутес**](/windows/desktop/api/mfobjects/nn-mfobjects-imfattributes) . Некоторые объекты активации используют атрибуты для настройки созданного объекта. Конкретные атрибуты, поддерживаемые каждым объектом, описаны в справочнике по функции создания объекта активации. Задайте атрибуты с помощью указателя **имфактивате** , полученного от функции.

Для защищенного воспроизведения объекты активации маршалируются в процесс PMP. Для поддержки маршалирования объект активации должен предоставлять интерфейс **IPersistStream** . Кроме того, как объект активации, так и созданный объект должны быть надежными компонентами, если PMP работает в защищенном процессе. Это не является обязательным, если PMP загружается в незащищенном процессе.

Чтобы использовать пользовательский объект конвейера (например, приемник мультимедиа) внутри процесса PMP, необходимо реализовать объект активации для объекта конвейера:

-   Объект активации должен предоставлять [**имфактивате**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) и **IPersistStream**.
-   Метод **IPersist::** GetObject объекта активации должен возвращать CLSID объекта активации.
-   При необходимости можно реализовать методы **IPersistStream:: Save** и **IPersistStream:: Load** для маршалирования любых данных, необходимых для настройки объекта активации.

Когда сеанс мультимедиа загружает топологию внутри процесса PMP, он вызывает метод **CoCreateInstance** , чтобы создать новый экземпляр объекта активации. Затем вызывается метод [**имфактивате:: активатеобжект**](/windows/desktop/api/mfobjects/nf-mfobjects-imfactivate-activateobject) , чтобы создать объект конвейера.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Media Foundation API платформы](media-foundation-platform-apis.md)
</dt> <dt>

[**имфактивате**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate)
</dt> </dl>

 

 



