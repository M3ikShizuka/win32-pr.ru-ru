---
description: Поле ограничений использования
ms.assetid: 36f28e4c-2baf-4618-9935-5d4615f6bc77
title: Поле ограничений использования
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0ccfb5b7c0923bdea117371a3b6af2669bf903fb3af996f754be43d5665c1ee1
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119942683"
---
# <a name="field-of-use-restrictions"></a>Поле ограничений использования

> [!Note]  
> этот раздел относится к Windows 7 и более поздних версий.

 

Ограничение на *Использование полей* — это подготовка, которая ограничивает возможности использования лицензии для определенной технологии.

Media Foundation предоставляет механизм для применения ограничений на использование полей для Media Foundation преобразований (МФТС), особенно кодеков. Этот механизм требует, чтобы основная таблица файлов блокировала свое использование приложениями до тех пор, пока приложение не выйдет подтверждение с MFT. Media Foundation не определяет подтверждение, как правило, это влечет за собой некоторый вид криптографических обменов.

### <a name="registration-and-enumeration"></a>Регистрация и перечисление

Если в MFT есть ограничения на использование полей, установите флаг **\_ \_ \_ Фиелдофусе флага ПЕРЕЧИСЛЕНИЯ MFT** при регистрации MFT. Этот флаг применяется к следующим API регистрации MFT:

-   [**мфтрегистер**](/windows/desktop/api/mfapi/nf-mfapi-mftregister)
-   [**мфтрегистерлокал**](/windows/desktop/api/mfapi/nf-mfapi-mftregisterlocal)
-   [**мфтрегистерлокалбиклсид**](/windows/desktop/api/mfapi/nf-mfapi-mftregisterlocalbyclsid)
-   [**Имфлокалмфтрегистратион:: Регистермфтс**](/windows/desktop/api/mfidl/nf-mfidl-imflocalmftregistration-registermfts)

По умолчанию МФТС, зарегистрированные с помощью этого флага, исключаются из результатов перечисления. Чтобы перечислить МФТС с ограничениями на использование полей, вызовите [**мфтенумекс**](/windows/desktop/api/mfapi/nf-mfapi-mftenumex) и укажите **флаг \_ перечисления MFT \_ флаг \_ фиелдофусе** в параметре *flags* . Этот процесс представлен на схеме ниже.

![Схема, демонстрирующая MFT и приложение, отправляющее данные в реестр](images/mft-fou01.gif)

Функция [**мфтенум**](/windows/desktop/api/mfapi/nf-mfapi-mftenum) всегда исключает все МФТС с ограничениями на использование полей.

### <a name="unlocking-the-mft"></a>Разблокировка MFT

Чтобы использовать таблицу MFT с ограничениями на использование полей, выполните следующие действия.

1.  Приложение реализует интерфейс [**имффиелдофусемфтунлокк**](/windows/desktop/api/mfidl/nn-mfidl-imffieldofusemftunlock) .
2.  Метод [**имффиелдофусемфтунлокк:: Unlock**](/windows/desktop/api/mfidl/nf-mfidl-imffieldofusemftunlock-unlock) принимает указатель на интерфейс **IUnknown** таблицы MFT.
3.  В методе [**Unlock**](/windows/desktop/api/mfidl/nf-mfidl-imffieldofusemftunlock-unlock) приложение выполняет необходимое подтверждение, используя любой механизм, определяемый MFT. Этот шаг не определяется Media Foundation API.
4.  Если метод [**Unlock**](/windows/desktop/api/mfidl/nf-mfidl-imffieldofusemftunlock-unlock) завершился, Таблица MFT разблокируется.

Приложение задает указатель [**имффиелдофусемфтунлокк**](/windows/desktop/api/mfidl/nn-mfidl-imffieldofusemftunlock) , устанавливая атрибут [MFT \_ фиелдофусе \_ Unlock \_](mft-fieldofuse-unlock-attribute.md) . Задать этот атрибут можно несколькими способами в зависимости от того, как ваше приложение создает кодировщик или конвейер кодирования:



| API                   | Как разблокировать используемое поле                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|-----------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Модуль чтения исходного кода         | Если приложение использует [модуль чтения исходного кода](source-reader.md) для декодирования файла мультимедиа, установите атрибут [ \_ Фиелдофусе \_ Unlock \_ ](mft-fieldofuse-unlock-attribute.md) в файле MFT в параметрах конфигурации. См. раздел [атрибуты модуля чтения исходного кода](source-reader-attributes.md).                                                                                                                                                                                                                                                                         |
| Модуль записи приемников           | Если приложение использует модуль записи приемника для кодирования файла мультимедиа, установите атрибут [ \_ фиелдофусе \_ Unlock \_ для MFT](mft-fieldofuse-unlock-attribute.md) в параметрах конфигурации. См. раздел [атрибуты модуля записи приемника](sink-writer-attributes.md).                                                                                                                                                                                                                                                                                                    |
| Быстрый перекодированный        | Если приложение использует функцию быстрого перекодирования для создания топологии кодирования, установите [ \_ \_ \_ атрибут MFT фиелдофусе Unlock](mft-fieldofuse-unlock-attribute.md) при вызове [**имфтранскодепрофиле:: сетконтаинераттрибутес**](/windows/desktop/api/mfidl/nf-mfidl-imftranscodeprofile-setcontainerattributes). Дополнительные сведения о функции быстрого перекодирования см. в разделе [API перекодирования](transcode-api.md).                                                                                                                                                                      |
| Топология              | Если топология создается напрямую, установите [ \_ \_ \_ атрибут MFT фиелдофусе Unlock](mft-fieldofuse-unlock-attribute.md) в качестве атрибута в топологии. См. раздел [атрибуты топологии](topology-attributes.md).                                                                                                                                                                                                                                                                                                                                                  |
| Объект активации MFT | Если приложение напрямую перечисляет декодеры или кодировщики, которые он будет использовать, установите [ \_ \_ \_ атрибут MFT фиелдофусе Unlock](mft-fieldofuse-unlock-attribute.md) для указателей [**имфактивате**](/windows/desktop/api/mfobjects/nn-mfobjects-imfactivate) , возвращаемых функцией [**мфтенумекс**](/windows/desktop/api/mfapi/nf-mfapi-mftenumex) . <br/> Задайте атрибут перед вызовом [**имфактивате:: активатеобжект**](/windows/desktop/api/mfobjects/nf-mfobjects-imfactivate-activateobject) , чтобы создать таблицу MFT. Объект активации вызывает [**имффиелдофусемфтунлокк:: Unlock**](/windows/desktop/api/mfidl/nf-mfidl-imffieldofusemftunlock-unlock) при создании MFT.<br/> |



 

На следующей схеме показана связь между объектами активации MFT и интерфейсом [**имффиелдофусемфтунлокк**](/windows/desktop/api/mfidl/nn-mfidl-imffieldofusemftunlock) .

![Схема, показывающая приложение, объект активации и MFT со стрелками к объекту Фау, который имеет стрелку обратно в MFT](images/mft-fou02.gif)

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Преобразования Media Foundation](media-foundation-transforms.md)
</dt> </dl>

 

 




