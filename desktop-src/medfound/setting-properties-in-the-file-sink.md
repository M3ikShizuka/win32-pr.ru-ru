---
description: Сведения о настройке свойств в приемнике файлов ASF, которые приложение может использовать для архивации данных ASF Media в файл.
ms.assetid: a47caabd-23e3-4d22-b4b6-5fdb79d62ca1
title: Задание свойств в приемнике файла
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8dc61c07812f669fc3006447abce932d79f4b1342eca07bbdcd9f68102d4275a
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119953224"
---
# <a name="setting-properties-in-the-file-sink"></a>Задание свойств в приемнике файла

Приемник ASF-файлов — это реализация [**имфмедиасинк**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasink) , предоставляемая Media Foundation, которую приложение может использовать для архивации данных ASF Media в файл. Сведения об объектной модели приемников ASF Media и общем использовании см. в статье [приемники мультимедиа ASF](asf-media-sinks.md).

После [создания приемника файлов ASF](creating-the-asf-file-sink.md)его необходимо настроить с помощью сведений о потоках в выходном файле. Эта процедура описана в разделе [Добавление сведений о потоке в приемник ASF-файлов](adding-stream-information-to-the-asf-file-sink.md). В зависимости от типа кодировки можно задать дополнительные свойства для приемника файлов. сегменты утечки; Общие свойства файла. Эти параметры не записываются в окончательный объект заголовка ASF. В этом разделе описывается процесс добавления этих свойств в хранилище свойств приемника файлов.

Объект Контентинфо хранит свойства глобального файла и отдельные свойства потока для приемника файла. Дополнительные сведения о получении ссылки на объект ASF Контентинфо в приемнике файлов см. [в разделе Создание приемника файлов ASF](creating-the-asf-file-sink.md).

Чтобы получить ссылку на хранилище свойств приемника файла ([**ипропертисторе**](/windows/win32/api/propsys/nn-propsys-ipropertystore)), вызовите [**Имфасфконтентинфо:: жетенкодингконфигуратионпропертисторе**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore) в ссылке на объект контентинфо файла приемника файлов.

## <a name="stream-encoding-properties"></a>Свойства кодирования потока

Для правильного кодирования содержимого файл должен иметь определенные сведения о кодировке, такие как тип кодировки и связанные параметры кодировки. Эти значения задаются в приемнике файлов как значения свойств в хранилище свойств, которое поддерживается объектом ASF Контентинфо. если вы настраиваете приемник файлов перед созданием экземпляров соответствующих кодировщиков, можно использовать объект контентинфо со всеми заполненными свойствами для создания Windowsных кодировщиков мультимедиа. В этом случае свойства автоматически устанавливаются для экземпляров кодировщиков. И наоборот, если вы создаете кодировщики перед приемником, убедитесь, что свойства, заданные в кодировщиках, копируются в хранилище свойств приемника файлов.

Чтобы задать свойства кодировки, необходим доступ к хранилищу свойств на уровне потока для приемника файла. Передайте номер потока в параметре *встреамнумбер* метода [**Имфасфконтентинфо:: жетенкодингконфигуратионпропертисторе**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore) . Номера потоков должны совпадать со значениями, заданными при настройке каждого потока в профиле. Значения свойств задаются путем вызова метода [**ипропертисторе:: SetValue**](/windows/win32/api/propsys/nn-propsys-ipropertystore). В следующей таблице описаны поддерживаемые свойства.

Свойства зависят от типа кодировки. Сведения о свойствах и соответствующих значениях, которые необходимо задать, см. в разделе [Свойства кодировки](configuring-the-encoder.md).

## <a name="leaky-bucket-property"></a>Свойство контейнера с утечкой

Параметры сегмента с утечкой определяют фактическое окно буфера, используемое кодировщиком для потока. Свойство [**мфпкэй \_ асфстреамсинк \_ \_**](mfpkey-asfstreamsink-corrected-leakybucket-property.md) для приемника файлов содержит параметры контейнера с утечкой, скорость потока, окно буфера и заполнение исходного буфера. Это свойство задается в хранилище свойств уровня потока для приемника файла и должно быть задано после создания и настройки кодировщиков. Это значение задается в. Во время согласования типа мультимедиа кодировщик решает окно буфера и используемую скорость. Эти значения можно получить с помощью интерфейса **ивмкодеклеакибуккет** , который определен в вмкодеЦифацес. h, и необходимо создать ссылку на вмкодекдспууид. lib для вызова его методов.

Извлеченные значения можно задать для этого свойства в каждом потоке в приемнике файлов ASF.

## <a name="global-file-sink-properties"></a>Свойства приемника глобальных файлов

Чтобы получить глобальное хранилище свойств приемника файлов, передайте 0 в параметре *встреамнумбер* метода [**Имфасфконтентинфо:: жетенкодингконфигуратионпропертисторе**](/windows/desktop/api/wmcontainer/nf-wmcontainer-imfasfcontentinfo-getencodingconfigurationpropertystore) . Значения свойств задаются путем вызова метода [**ипропертисторе:: SetValue**](/windows/win32/api/propsys/nn-propsys-ipropertystore). В следующей таблице описаны поддерживаемые свойства.

| Свойства уровня файла                                                                                | Описание                                                                                                                                                                                                                                                                                           |
|------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**МФПКЭЙ \_ асфмедиасинк \_ Base \_ сендтиме**](mfpkey-asfmediasink-base-sendtime-property.md)           | Время отправки указывает, когда будут освобождены полезные данные внутри сегмента утечки. Это значение свойства указывает первое время отправки. Мультиплексор использует это значение для вычисления последующего времени отправки для созданных пакетов и гарантирует, что данные непрерывно проходят через сегмент утечки. |
| [**МФПКЭЙ \_ асфмедиасинк \_ АВТОнастройка скорости \_**](mfpkey-asfmediasink-autoadjust-bitrate-property.md) | Это логическое значение указывает, нужно ли мультиплексору автоматически настраивать скорость потока, чтобы гарантировать, что данные не будут переполнены контейнером утечки.                                                                                                                                                  |
| [**МФПКЭЙ \_ асфмедиасинк \_ дрмактион**](mfpkey-asfmediasink-drmaction-property.md)                    | Указывает действие DRM для приемника мультимедиа ASF при создании файла. В этом выпуске поддерживается только перекодировать DRM.                                                                                                                                                                                   |



 

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Приемники мультимедиа ASF](asf-media-sinks.md)
</dt> <dt>

[Компоненты ASF уровня конвейера](pipeline-layer-asf-components.md)
</dt> <dt>

[Поддержка ASF в Media Foundation](asf-support-in-media-foundation.md)
</dt> </dl>

 

 
