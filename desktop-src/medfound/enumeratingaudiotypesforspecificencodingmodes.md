---
description: Перечисление типов аудио для конкретных режимов кодирования
ms.assetid: d44960eb-da5e-4379-ba9d-cb804559dc53
title: Перечисление типов аудио для конкретных режимов кодирования (Microsoft Media Foundation)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a16a8b97afdd48cb1d7828f80778aa9fcf8dc1ab
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104423537"
---
# <a name="enumerating-audio-types-for-specific-encoding-modes-microsoft-media-foundation"></a>Перечисление типов аудио для конкретных режимов кодирования (Microsoft Media Foundation)

Типы входных и выходных носителей, принимаемые звуковым кодировщиком, очень структурированы. Для получения поддерживаемых типов выходных данных необходимо вызвать метод **имедиаобжект:: жетаутпуттипе** или **Имфтрансформ:: жетаутпуттипе**. После получения типа выходных данных его не следует изменять.

Если вы хотите использовать режим кодирования, отличный от однопроходного CBR, необходимо установить режим, а затем перечислить типы выходных данных для этого режима. кодировщик изменяет Поддерживаемые типы выходных данных в зависимости от набора режимов. Свойства, управляющие режимом кодирования, — это [**мфпкэй \_ Вбренаблед**](mfpkey-vbrenabledproperty.md) и [**мфпкэй \_ пассесусед**](mfpkey-passesusedproperty.md). Если режим задан в кодировщике, необходимо перечислить и выбрать тип выходных данных, используя его без изменения, как и в случае с CBR.

## <a name="identifying-quality-based-vbr-types"></a>Определение типов VBR с учетом качества

Процедура идентификации типов VBR с учетом качества зависит от того, выступает ли кодировщик в качестве объекта мультимедиа DirectX (DMO) или выступает в качестве Media Foundation преобразования (MFT). Сведения о том, когда кодировщик выступает в качестве DMO или MFT, см. на страницах справочника по отдельным кодекам в разделе [объекты кодека](codecobjects.md).

Если звуковый кодировщик выступает в роли DMO и вы настраиваете кодировщик для использования однопроходных VBR, он перечисляет все поддерживаемые типы вывода. Тем не менее, как правило, необходимо выбрать один тип VBR на основе параметра Quality. Кодировщик помещает значение качества для однопроходных выходных типов VBR в элемент **навгбитесперсек** структуры **вавеформатекс** , на который указывает **\_ тип носителя DMO \_ . пбформат**.

Это значение хранится в следующем формате: 0x7FFFFFXX, где XX — это значение качества (от 0 до 100). Например, значение **навгбитесперсек** в 0x7FFFFF62 указывает уровень качества 98 (0x62 = 98).

В следующем примере показано, как проверить уровень качества в формате, когда кодировщик выступает в роли DMO.


```
void ShowQuality(WAVEFORMATEX* pWave)
{
    // Store the average bytes per second in a local variable
    // with a more manageable name.
    DWORD dwBps = pWave->nAvgBytesPerSec;

    // Verify that the value is a VBR quality level by using 
    // a bitmask to check for the bit pattern 0x7FFFFFXX. 
    if(dwBps & 0x7FFFFF00 == 0x7FFFFF00)
        printf("VBR Quality: %d%%\n",(dwBps & 0x000000FF));
    else // Not a valid VBR quality value.
        printf("Not a valid one-pass VBR audio format.\n");
}
```



Когда кодировщик выступает в качестве MFT и перечисляет тип выходных данных при вызове **жетаваилаблеаутпуттипе**, можно запросить таблицу MFT для **мфпкэй \_ последнего \_ \_ перечисленного свойства \_ вбркуалити** . Возвращаемое значение указывает качество VBR последнего возвращенного типа выходного носителя. Затем это значение можно использовать для задания свойства [**мфпкэй \_ требуемого \_ вбркуалити**](mfpkey-desired-vbrqualityproperty.md) кодировщика.

## <a name="setting-peak-constraints"></a>Настройка ограничений пиковой нагрузки

Для уровня с VBR (однопроходный) и с неограниченными двумя проходами VBR дополнительные параметры не требуются после получения выходного типа. Чтобы использовать пиковую нагрузку, извлеките выходной тип с поддержкой VBR и двумя наборами проходов. Этот тип, без изменения, описывает параметры с неограниченными VBR. Чтобы задать ограничения пиковой нагрузки, задайте свойства [мфпкэй \_ Рмакс](mfpkey-rmaxproperty.md) и [мфпкэй \_ бмакс](mfpkey-bmaxproperty.md) .

## <a name="related-topics"></a>См. также

<dl> <dt>

[Настройка кодирования звука](configuringaudioencoding.md)
</dt> <dt>

[Поиск типов вывода звукового кодировщика](findingaudioencoderoutputtypes.md)
</dt> <dt>

[Использование кодировки Two-Pass](usingtwoencodingpasses.md)
</dt> <dt>

[Использование кодирования VBR](usingvbrencoding.md)
</dt> </dl>

 

 



