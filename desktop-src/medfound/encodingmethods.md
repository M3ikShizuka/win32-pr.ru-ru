---
description: Методы кодирования
ms.assetid: 17ab5ecc-0173-4c5c-9d65-40e506ab7e07
title: Методы кодирования (Microsoft Media Foundation)
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: e4366f11ea9d120d638c5600f84fc16f6c5320f8
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105710816"
---
# <a name="encoding-methods-microsoft-media-foundation"></a>Методы кодирования (Microsoft Media Foundation)

Большинство кодеков аудио и видео Windows Media поддерживает несколько методов кодирования. Знание того, как и когда следует использовать каждый из методов, может помочь в создании высококачественного сжатого содержимого.

Все методы кодирования сосредоточены на буфере, используемом декодером для управления сжатыми входными данными. Этот буфер определяется скоростью потока в битах в секунду и окном буфера в миллисекундах. При кодировании кодек придерживается ограничений буфера. Дополнительные сведения о буфере см. [в разделе Модель буфера для сегмента утечки](the-leaky-bucket-buffer-model.md).

## <a name="constant-bit-rate-encoding"></a>Кодирование постоянной скорости потока

Скорость потока, закодированная одним из кодеков аудио-и видеофайлов Windows Media, не является константой. Кодирование с постоянной скоростью (CBR) — это, следовательно, неверное условие. Отличительная особенность потока, закодированного с помощью CBR, — это небольшое окно буфера, которое ограничивает вариант размеров выборки. Кодировка CBR используется в основном для содержимого, которое передается в потоке по сети в место назначения. В таком случае важно иметь возможность полагаться на единообразное использование пропускной способности.

С точки зрения конфигурации, кодировка CBR отличается от других режимов в том, что перед началом кодирования устанавливается как средняя скорость потока выходного содержимого, так и окно буфера, которое применяется к этой скорости. В других режимах одно или оба этих значения неизвестны при настройке кодировщика и вычисляются кодеком во время кодирования. CBR — стандартный режим кодирования, используемый кодировщиком Windows Media Encoder дмос.

## <a name="two-pass-constant-bit-rate-encoding"></a>Кодирование постоянной скорости Two-Pass

Стандартный CBR использует только один проход кодирования. Вы предоставляете содержимое в качестве входных примеров, а кодек сжимает содержимое и возвращает выходные примеры. Также можно дважды обработать входные примеры. На первом этапе кодек выполняет вычисления для оптимизации кодирования содержимого. На втором этапе кодек использует данные, собранные во время первого прохода для кодирования содержимого.

CBR кодировка с двумя проходами имеет много преимуществ. Он часто дает значительные преимущества по сравнению со стандартной кодировкой CBR, не изменяя никаких требований к буферизации. Это делает этот режим кодировки идеальным для содержимого, переходящего по сети. Единственная ситуация, в которой два этапа CBR нецелесообразна, заключается в том, что вы кодируете содержимое из активного источника и не можете использовать второй проход.

Тип выходного носителя CBR потока данных идентичен стандартному потоку CBR. Вы по-прежнему указываете скорость и окно буфера для использования. При настройке DMO необходимо задать для него выполнение двух этапов. И необходимо уведомить DMO по завершении отправки образцов для первого прохода.

## <a name="quality-based-variable-bit-rate-encoding"></a>Quality-Based кодирование переменной скорости

Поскольку кодировка CBR на самом деле не поддерживает постоянную скорость потока, различие между ней и переменной скоростью кодирования (VBR) может показаться немного Хази. Основное различие между CBR и VBR — размер используемого окна буфера. Потоки с кодированием VBR обычно имеют большие окна буфера по сравнению с потоками, закодированными CBR. Частота, основанная на уровне качества, не является исключением. в этом случае для него не определена скорость или окно буфера. Вместо этого задается значение качества. Затем кодек пытается сжать данные, чтобы качество закодированного носителя было согласованным в течение всего времени, независимо от требований к буферу результирующего потока.

На основе качества VBR используется один проход кодирования, который обычно создает большие сжатые потоки. После завершения кодирования кодек устанавливает требования к буферу, чтобы декодер мог распаковать данные. Закодированный поток VBR не подходит для потоковой передачи по сети, поэтому скорость на основе качества должна использоваться только для локальных сценариев воспроизведения (или для загрузки и воспроизведения).

## <a name="unconstrained-variable-bit-rate-encoding"></a>Кодирование переменной скорости с неограниченным битом

В отличие от VBR с неограниченным качеством, неограниченное значение VBR не кодируется на конкретный уровень качества. Вместо этого он кодирует содержимое на максимально возможное качество, сохраняя заданную скорость. Неограниченная VBR использует два прохода кодирования и похожа на два прохода CBR, за исключением того, что для потока не задан параметр окна буфера. Это означает, что ограничение размера отдельных выборок в потоке не ограничено, если средняя скорость потока меньше или равна заданному значению.

Неограниченная VBR имеет ограниченный объем использования, так как существует несколько сценариев воспроизведения, требующих сохранения требований к буферу. Кодек может установить в окне буфера любое значение, необходимое после кодирования, что позволяет не контролировать размер буфера. В большинстве случаев, если вы не собираетесь беспокоиться о размере буфера или при согласовании использования пропускной способности, следует использовать значение VBR на основе качества.

## <a name="peak-constrained-variable-bit-rate-encoding"></a>Peak-Constrained кодирование переменной скорости

Режим последней кодировки — Пиковая с ограниченным числом VBR. Как и в случае с неограниченными VBR, в этом режиме используется два прохода кодирования и кодируется в указанную скорость. Однако с пиковым числом VBR также настраивается пиковое значение для кодировки. Пиковые значения похожи на обычные значения конфигурации буфера: Пиковая скорость и пиковое окно буфера. Файл кодируется в соответствии с буфером, описанным в пиковых значениях, с условием, что общая средняя скорость потока равна или меньше средней указанной величине скорости.

Ограниченные VBR могут быть трудно концептуализировать. Ниже приведен самый простой способ представить используемую модель буферизации. Предположим, поток представляет собой поток CBR с пиковой скоростью потока и пиковым окном буфера, используемым для определения буфера. Как правило, Пиковая скорость очень высока. Кодировщик гарантирует, что ожидаемое среднее значение скорости передачи, которое вы указали, будет поддерживаться на протяжении потока. В любой конкретный момент в потоке средняя скорость потока гарантированно превышает общий размер в битах, деленный на длительность потока в секундах).

Рассмотрим следующий пример: вы настраиваете поток с средним битом скорости в 16 000 бит/с, пиковой скоростью в 48 000 бит/с и пиковым окном буфера в 3 000 (3 секунды). Размер буфера, используемого для потока, составляет 144 000 бит (48 000 бит в секунду x 3 секунды), определяемый значениями пиковой нагрузки. Кодировщик сжимает данные, чтобы они соответствовали этому буферу. Кроме того, средняя скорость потока должна составлять 16 000 или меньше. Если кодировщику необходимо сделать несколько очень больших выборок для работы с сложным сегментом содержимого, то может воспользоваться преимуществами большого размера буфера. Однако другие части потока должны быть закодированы с более низкой скоростью, чтобы сократить среднее до указанного уровня.

Скорость кодирования с ограничением в пиковую пользу полезна для устройств воспроизведения с ограниченной емкостью буфера и некоторыми ограничениями на скорость передачи данных. Распространенный пример — это кодировка, используемая для DVD.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Использование кодирования VBR](usingvbrencoding.md)
</dt> <dt>

[Кодеки Windows Media](windows-media-codecs.md)
</dt> </dl>

 

 



