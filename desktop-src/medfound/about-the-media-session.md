---
description: Сведения о сеансе мультимедиа
ms.assetid: 09f50b11-0e0a-42b6-a7bf-bb0135343351
title: Сведения о сеансе мультимедиа
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 68816f4c9b9468de2e687a7d00087c5232cc5d24509c9166c5f04c7c0370f6f5
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119035642"
---
# <a name="about-the-media-session"></a>Сведения о сеансе мультимедиа

Сеанс мультимедиа предоставляет интерфейс [**имфмедиасессион**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasession) . Существует два способа создания сеанса мультимедиа в зависимости от того, будет ли приложение поддерживать защищенное содержимое:

-   Если приложение не поддерживает защищенное содержимое, можно создать сеанс мультимедиа, вызвав метод [**мфкреатемедиасессион**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatemediasession). Эта функция создает сеанс мультимедиа внутри процесса приложения.
-   Для поддержки защищенного содержимого создайте сеанс мультимедиа, вызвав [**мфкреатепмпмедиасессион**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatepmpmediasession). Эта функция создает сеанс мультимедиа внутри процесса защищенного пути к носителю (PMP). Приложение получает указатель на прокси-объект, который маршалирует вызовы метода через границу процесса. Обратите внимание, что сеанс PMP Media можно использовать для воспроизведения незашифрованного содержимого, а также защищенного содержимого.

Любое приложение, использующее сеанс мультимедиа, будет выполнять следующие общие действия:

1.  Создайте топологию.
2.  Постановка топологии в очередь в сеансе мультимедиа путем вызова [**имфмедиасессион:: сеттопологи**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-settopology).
3.  Управление потоком данных путем вызова [**имфмедиасессион:: Start**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-start), [**имфмедиасессион::P Аусе**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-pause)или [**имфмедиасессион:: останавливаться**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-stop).
4.  Перед выходом из приложения вызовите метод [**имфмедиасессион:: Close**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-close) , чтобы закрыть сеанс мультимедиа.
5.  Завершите работу всех источников мультимедиа, созданных приложением, вызвав [**имфмедиасаурце:: Shutdown**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasource-shutdown).
6.  Завершите сеанс мультимедиа, вызвав [**имфмедиасессион:: Shutdown**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-shutdown).

При использовании сеанса мультимедиа приложение не должно запускать, приостанавливать или останавливать источник мультимедиа напрямую. Все изменения состояния должны быть инициированы вызовом методов [**имфмедиасессион**](/windows/desktop/api/mfidl/nn-mfidl-imfmediasession) . Изменения состояния в источнике мультимедиа обрабатываются сеансом мультимедиа.

Многие другие сведения будут зависеть от конкретных функциональных возможностей приложения.

## <a name="protected-content"></a>Защищенное содержимое

Чтобы воспроизвести защищенное содержимое, необходимо создать сеанс мультимедиа внутри защищенного пути к носителю (PMP), вызвав [**мфкреатепмпмедиасессион**](/windows/desktop/api/mfidl/nf-mfidl-mfcreatepmpmediasession). Эта функция создает экземпляр сеанса мультимедиа внутри PMP и возвращает указатель на прокси-объект, который маршалирует интерфейсы через границу процесса.

В большинстве случаев использование сеанса мультимедиа в PMP является прозрачным для приложения. Однако приложению может потребоваться вызвать определенные действия, которые позволят пользователю воспроизвести содержимое. Например, пользователю может потребоваться получить лицензию DRM. Media Foundation определяет универсальный механизм для этих действий с помощью интерфейса [**имфконтентенаблер**](/windows/desktop/api/mfidl/nn-mfidl-imfcontentenabler) .

Дополнительные сведения см. в следующих разделах:

-   [Путь к защищенному носителю](protected-media-path.md)
-   [Воспроизведение защищенных файлов мультимедиа](how-to-play-protected-media-files.md)

## <a name="presentation-clock"></a>Часы представления

Сеанс мультимедиа управляет всеми аспектами часов представления.

-   Создание часов представления.

-   Выбор источника времени.

-   Уведомление приемников мультимедиа о часах

-   Запуск, остановка и приостановка часов по мере необходимости.

-   Идет завершение работы часов.

Чтобы получить указатель на часы презентации, вызовите [**имфмедиасессион::-Clock**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-getclock) в сеансе мультимедиа. Часы презентации не возвращают допустимое время, пока сеанс мультимедиа не отправит событие [месессионтопологистатус](mesessiontopologystatus.md) с помощью флага подключения MF \_ топостатус \_ . До **этого времени функция return возвращает** значение MF E с \_ \_ часами \_ без \_ \_ источника.

Приложение, использующее сеанс мультимедиа, никогда не должно запускать, останавливать или приостанавливать часы презентации; изменение частоты часов; или выключите часы.

Когда приложение вызывает [**имфмедиасессион:: Start**](/windows/desktop/api/mfidl/nf-mfidl-imfmediasession-start), сеанс мультимедиа запускает презентацию с начальным временем, равным начальной позицией, указанной в методе **Start** . Дополнительные сведения о сеансе мультимедиа см. в разделе [сеанс мультимедиа](media-session.md).

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Сеанс мультимедиа](media-session.md)
</dt> </dl>

 

 



