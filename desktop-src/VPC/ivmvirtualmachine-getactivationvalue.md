---
title: Метод Ивмвиртуалмачине Жетактиватионвалуе (Впккоминтерфацес. h)
description: Извлекает значение указанного параметра активации для этой виртуальной машины.
ms.assetid: 9a6f138f-6a8a-4cdf-8fb3-83d541d88fba
keywords:
- Метод Жетактиватионвалуе Virtual PC
- Метод Жетактиватионвалуе Virtual PC, интерфейс Ивмвиртуалмачине
- Ивмвиртуалмачине интерфейс Virtual PC, метод Жетактиватионвалуе
topic_type:
- apiref
api_name:
- IVMVirtualMachine.GetActivationValue
api_location:
- VPCCOMInterfaces.h
api_type:
- COM
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: a1e03d1178df5961ba76a0ab61e74c781315cce07f32657903e5fa3e4e0a7623
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118123201"
---
# <a name="ivmvirtualmachinegetactivationvalue-method"></a>Метод Ивмвиртуалмачине:: Жетактиватионвалуе

\[Windows Virtual PC больше не доступен для использования в Windows 8. Вместо этого используйте [поставщик WMI Hyper-V (v2)](/windows/desktop/HyperV_v2/windows-virtualization-portal).\]

Извлекает значение указанного параметра активации для этой виртуальной машины.

## <a name="syntax"></a>Синтаксис


```C++
HRESULT GetActivationValue(
  [in]          BSTR    activationKey,
  [out, retval] VARIANT *activationValue
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*активатионкэй* \[ окне\]
</dt> <dd>

Ключ, используемый для обнаружения значения активации, хранящегося в файле " \* . VMC".

</dd> <dt>

*активатионвалуе* \[ out, retval\]
</dt> <dd>

Значение активации. Это значение может быть одним из следующих **вариантов** : **VT \_ Array** \| **VT \_ UI1** (RAW bytes), **VT \_ BSTR** (String), **VT \_ I4** (целое число) или **VT \_ bool** (Boolean).

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Этот метод может возвращать одно из этих значений.



| Возвращаемый код и значение                                                                                                                                                      | Описание                                                                             |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------|
| <dl> <dt>**С \_ ОК**</dt> <dt>0</dt> </dl>                            | Операция выполнена успешно.<br/>                                                |
| <dl> <dt>**Д \_ INVALIDARG**</dt> <dt>0x80000003</dt> </dl>           | Параметр *активатионкэй* имеет **значение NULL** или является пустым.<br/>                          |
| <dl> <dt>**Д \_**</dt> <dt>0x80004003</dt> указателя </dl>              | Параметр *активатионвалуе* имеет **значение NULL**.<br/>                                 |
| <dl> <dt>**Виртуальная машина \_ \_Неизвестный \_ 0xA0040207 виртуальной машины**</dt> <dt></dt> </dl>      | Конфигурация неизвестна.<br/>                                                |
| <dl> <dt>**Виртуальная машина \_ E \_ преф \_ не \_ Найдено**</dt> <dt>0xA0040300</dt> </dl> | Предпочтение не найдено, или эта конфигурация не имеет допустимой активации.<br/> |
| <dl> <dt>**\_ E \_ Exception**</dt> <dt>0x80020009</dt> </dl>      | Произошла непредвиденная ошибка.<br/>                                            |



 

## <a name="remarks"></a>Remarks

Этот метод обеспечивает доступ низкого уровня к любому значению активации. Его можно использовать для задания значений активации для определяемых пользователем ключей. При запуске виртуальной машины выполняется копия ее значений конфигурации, которая становится набором значений активации. Значения активации сохраняются до тех пор, пока виртуальная машина не будет выключена или перезапущена. обратите внимание, что Windows Virtual PC может использовать конфигурацию только для хранения значений для определенных ключей, то есть значение активации не может использоваться.

Ключи активации хранятся внутри иерархии так же, как и разделы реестра в Windows. Чтобы указать конкретный подраздел, создается «путь к ключу», который задает различные ключи в формате с разделителями-отметками.

Например, чтобы прочитать значение ключа "действие по умолчанию \_ ", расположенное в следующем дереве ключей:

``` syntax
<settings>
    <undo_drives>
        <default_action type="integer">1</default_action>
```

Строка пути *активатионкэй* будет указана следующим образом:

``` syntax
"settings/undo_drives/default_action"
```

## <a name="requirements"></a>Requirements (Требования)



| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | только Windows 7 \[ настольных приложений\]<br/>                                                    |
| Минимальная версия сервера<br/> | Ни одна версия не поддерживается<br/>                                                                     |
| Окончание поддержки клиента<br/>    | Windows 7<br/>                                                                          |
| Продукт<br/>                  | Windows Virtual PC<br/>                                                                 |
| Заголовок<br/>                   | <dl> <dt>Впккоминтерфацес. h</dt> </dl> |
| IID<br/>                      | IID \_ ивмвиртуалмачине определен как f7092aa1-33ed-4f78-a59f-c00adfc2edd7<br/>          |



## <a name="see-also"></a>См. также

<dl> <dt>

[**ивмвиртуалмачине**](ivmvirtualmachine.md)
</dt> </dl>

 

