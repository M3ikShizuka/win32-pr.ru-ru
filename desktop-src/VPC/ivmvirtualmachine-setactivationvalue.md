---
title: Метод Ивмвиртуалмачине Сетактиватионвалуе (Впккоминтерфацес. h)
description: Задает значение указанного параметра активации для этой виртуальной машины.
ms.assetid: 6d664a80-1777-42ca-8454-df84c64ab505
keywords:
- Метод Сетактиватионвалуе Virtual PC
- Метод Сетактиватионвалуе Virtual PC, интерфейс Ивмвиртуалмачине
- Ивмвиртуалмачине интерфейс Virtual PC, метод Сетактиватионвалуе
topic_type:
- apiref
api_name:
- IVMVirtualMachine.SetActivationValue
api_location:
- VPCCOMInterfaces.h
api_type:
- COM
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 4c7cb48b5691a9ca99a0fca5b696d8b545a40e46
ms.sourcegitcommit: a1494c819bc5200050696e66057f1020f5b142cb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2020
ms.locfileid: "104492225"
---
# <a name="ivmvirtualmachinesetactivationvalue-method"></a>Метод Ивмвиртуалмачине:: Сетактиватионвалуе

\[Windows Virtual PC больше не доступна для использования в Windows 8. Вместо этого используйте [поставщик WMI Hyper-V (v2)](/windows/desktop/HyperV_v2/windows-virtualization-portal).\]

Задает значение указанного параметра активации для этой виртуальной машины.

## <a name="syntax"></a>Синтаксис


```C++
HRESULT SetActivationValue(
  [in] BSTR    activationKey,
  [in] VARIANT activationValue
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*активатионкэй* \[ окне\]
</dt> <dd>

Ключ, используемый для обнаружения значения активации, хранящегося в файле " \* . VMC".

</dd> <dt>

*активатионвалуе* \[ окне\]
</dt> <dd>

Значение активации. Это значение может быть одним из следующих **вариантов** : **VT \_ Array** \| **VT \_ UI1** (необработанные байты) **, VT \_ BSTR** (String), **VT \_ UI4** (целое число) или **VT \_ bool** (Boolean).

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Этот метод может возвращать одно из этих значений.



| Возвращаемый код и значение                                                                                                                                                      | Описание                                                                                                                    |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------|
| <dl> <dt>**С \_ ОК**</dt> <dt>0</dt> </dl>                            | Операция выполнена успешно.<br/>                                                                                       |
| <dl> <dt>**Д \_ INVALIDARG**</dt> <dt>0x80000003</dt> </dl>           | Параметр *активатионкэй* имеет **значение NULL** или является пустым, либо параметр *активатионвалуе* не является допустимым типом Variant.<br/> |
| <dl> <dt>**Виртуальная машина \_ \_Неизвестный \_ 0xA0040207 виртуальной машины**</dt> <dt></dt> </dl>      | Конфигурация неизвестна.<br/>                                                                                       |
| <dl> <dt>**Виртуальная машина \_ E \_ преф \_ не \_ Найдено**</dt> <dt>0xA0040300</dt> </dl> | В конфигурации отсутствует действительная активация.<br/>                                                                          |
| <dl> <dt>**\_ E \_ Exception**</dt> <dt>0x80020009</dt> </dl>      | Произошла непредвиденная ошибка.<br/>                                                                                   |



 

## <a name="remarks"></a>Комментарии

Этот метод обеспечивает доступ низкого уровня к любому значению активации. Его можно использовать для задания значений активации для определяемых пользователем ключей. Будьте внимательны при использовании этого метода для задания значений активации системы, так как для значения активации не выполняется проверка ошибок. Кроме того, некоторые значения активации нельзя изменить, пока виртуальная машина работает. При запуске виртуальной машины выполняется копия ее значений конфигурации, которая становится набором значений активации. Значения активации сохраняются до тех пор, пока виртуальная машина не будет выключена или перезапущена. Обратите внимание, что Windows Virtual PC может использовать конфигурацию только для хранения значений для определенных ключей, то есть значение активации не может использоваться.

> [!Note]  
> Для изменения любых значений активации необходимо запустить сеанс виртуальной машины.

 

Ключи активации хранятся внутри иерархической структуры аналогично разделам реестра в Windows. Чтобы указать конкретный подраздел, создается «путь к ключу», который задает различные ключи в формате с разделителями-отметками.

Например, чтобы задать значение ключа "действие по умолчанию \_ ", расположенное в следующем дереве ключей:

``` syntax
<settings>
    <undo_drives>
        <default_action type="integer">1</default_action>
```

Строка пути *активатионкэй* будет указана следующим образом:

``` syntax
"settings/undo_drives/default_action"
```

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | \[Только классические приложения Windows 7\]<br/>                                                    |
| Минимальная версия сервера<br/> | Ни одна версия не поддерживается<br/>                                                                     |
| Окончание поддержки клиента<br/>    | Windows 7<br/>                                                                          |
| Продукт<br/>                  | Windows Virtual PC<br/>                                                                 |
| Header<br/>                   | <dl> <dt>Впккоминтерфацес. h</dt> </dl> |
| IID<br/>                      | IID \_ ивмвиртуалмачине определен как f7092aa1-33ed-4f78-a59f-c00adfc2edd7<br/>          |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**ивмвиртуалмачине**](ivmvirtualmachine.md)
</dt> </dl>

 

