---
title: Метод Ивмвиртуалпк Сетконфигуратионвалуе (Впккоминтерфацес. h)
description: Задает значение указанного параметра конфигурации.
ms.assetid: 7760b81e-734d-4970-8875-f2d310ff6c5c
keywords:
- Метод Сетконфигуратионвалуе Virtual PC
- Метод Сетконфигуратионвалуе Virtual PC, интерфейс Ивмвиртуалпк
- Ивмвиртуалпк интерфейс Virtual PC, метод Сетконфигуратионвалуе
topic_type:
- apiref
api_name:
- IVMVirtualPC.SetConfigurationValue
api_location:
- VPCCOMInterfaces.h
api_type:
- COM
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: ecb8ff3bb68829e944461cedb1c86904c7150593
ms.sourcegitcommit: a1494c819bc5200050696e66057f1020f5b142cb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2020
ms.locfileid: "104534853"
---
# <a name="ivmvirtualpcsetconfigurationvalue-method"></a>Метод Ивмвиртуалпк:: Сетконфигуратионвалуе

\[Windows Virtual PC больше не доступна для использования в Windows 8. Вместо этого используйте [поставщик WMI Hyper-V (v2)](/windows/desktop/HyperV_v2/windows-virtualization-portal).\]

Задает значение указанного параметра конфигурации.

## <a name="syntax"></a>Синтаксис


```C++
HRESULT SetConfigurationValue(
  [in] BSTR    preferenceKey,
  [in] VARIANT preferenceValue
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*преференцекэй* \[ окне\]
</dt> <dd>

Ключ, используемый для задания предпочтения, который хранится в файле конфигурации для каждого пользователя (Options.xml в "% LocalAppData% \\ Microsoft \\ Windows Virtual PC").

> [!IMPORTANT]
> Необходимо внести изменения в Options.xml только с помощью метода **сетконфигуратионвалуе** . Изменение Options.xml с помощью любого другого метода не поддерживается.

 

</dd> <dt>

*преференцевалуе* \[ окне\]
</dt> <dd>

Значение предпочтения. Это значение может быть одним из следующих **вариантов** : **VT \_ Array** \| **VT \_ UI1** (необработанные байты) **, VT \_ BSTR** (String), **VT \_ UI4** (целое число) или **VT \_ bool** (Boolean).

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Этот метод может возвращать одно из этих значений.



| Возвращаемый код и значение                                                                                                                                                                        | Описание                                                                                     |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------|
| <dl> <dt>**С \_ ОК**</dt> <dt>0</dt> </dl>                                              | Операция выполнена успешно.<br/>                                                        |
| <dl> <dt>**Д \_**</dt> <dt>0x80004003</dt> указателя </dl>                                | Параметр *преференцекэй* или *Преференцевалуе* имеет **значение NULL**.<br/>                      |
| <dl> <dt>**Д \_ INVALIDARG**</dt> <dt>0x80000003</dt> </dl>                             | Параметр *преференцекэй* недопустим или является пустой строкой.<br/>                    |
| <dl> <dt>**\_ E \_ Exception**</dt> <dt>0x80020009</dt> </dl>                        | Произошла непредвиденная ошибка.<br/>                                                    |
| <dl> <dt>**Д \_ ACCESSDENIED**</dt> <dt>0x80070005</dt> </dl>                           | У текущего пользователя недостаточно прав доступа к файлу конфигурации.<br/>                  |
| <dl> <dt>**Виртуальная машина \_ E \_ аппаратная \_ виртуализация \_ отключена**</dt> <dt>0xA0040951</dt> </dl> | Процессор не поддерживает расширения виртуализации с аппаратным ускорением (ЗАКОНЧИТЕ).<br/> |



 

## <a name="remarks"></a>Комментарии

Для параметра *преференцекэй* поддерживаются следующие значения.



| значение *преференцекэй*      | Описание                                                                                                                                                                           | Тип данных            | Значение по умолчанию   |
|----------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------|-----------------|
| " \_ время ожидания простоя"<br/> | Количество секунд, в течение которых vpc.exe должно ожидать выхода, если нет активных виртуальных машин или приложений, использующих [интерфейсы ВИРТУАЛЬНЫХ ПК Windows](virtual-pc-interfaces.md).<br/> | цело<br/> | пределах<br/> |



 

Этот метод обеспечивает доступ низкого уровня к любому значению конфигурации. Его можно использовать для задания значений конфигурации для определяемых пользователем ключей. Будьте внимательны при использовании этого метода для задания значений конфигурации системы, так как для значения конфигурации не выполняется проверка ошибок. Кроме того, некоторые значения конфигурации нельзя изменить во время работы виртуальной машины.

Ключи конфигурации находятся в файле "Options.xml" виртуальной машины в формате XML. Ключи хранятся в виде иерархической структуры аналогично разделам реестра в Windows. Чтобы указать конкретный подраздел, создается «путь к ключу», который задает различные ключи в формате с разделителями-отметками.

Например, чтобы задать значение ключа "время ожидания простоя \_ ", расположенное в следующем дереве ключей:

``` syntax
<preferences>
  <idle_timeout type="integer">60</idle_timeout>
```

Строка пути *преференцекэй* будет указана следующим образом:

``` syntax
"idle_timeout"
```

Если какой-либо из ключей в требуемом дереве имеет значение атрибута ID, атрибут и его значение внедряются в строку пути *преференцекэй* сразу после связанного с ней ключа конфигурации, используя следующий формат в квадратных скобках: " \[ @id ="*\_ значение идентификатора*" \] ".

Например, чтобы задать значение ключа «гольф», расположенное в следующем дереве ключей:

``` syntax
<preferences>
  <alpha>
    <bravo>
      <charlie>
        <delta id="1">
          <echo id="0">
            <foxtrot>
              <golf type="string">D</golf>
```

Строка пути *преференцекэй* будет указана следующим образом:

``` syntax
"alpha/bravo/charlie/delta[@id=1]/echo[@id=0]/foxtrot/golf"
```

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | \[Только классические приложения Windows 7\]<br/>                                                    |
| Минимальная версия сервера<br/> | Ни одна версия не поддерживается<br/>                                                                     |
| Окончание поддержки клиента<br/>    | Windows 7<br/>                                                                          |
| Продукт<br/>                  | Windows Virtual PC<br/>                                                                 |
| Header<br/>                   | <dl> <dt>Впккоминтерфацес. h</dt> </dl> |
| IID<br/>                      | IID \_ ивмвиртуалпк определен как 236ba0d9-a24a-4292-A132-27c1421dfd01<br/>               |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**ивмвиртуалпк**](ivmvirtualpc.md)
</dt> <dt>

[**Ивмвиртуалмачине:: Сетконфигуратионвалуе**](ivmvirtualmachine-setconfigurationvalue.md)
</dt> </dl>

 

