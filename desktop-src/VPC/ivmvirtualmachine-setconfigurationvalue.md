---
title: Метод Ивмвиртуалмачине Сетконфигуратионвалуе (Впккоминтерфацес. h)
description: Задает значение указанного параметра конфигурации для виртуальной машины.
ms.assetid: 43c3ac88-2e25-4c9e-a2ac-fcae5add62c5
keywords:
- Метод Сетконфигуратионвалуе Virtual PC
- Метод Сетконфигуратионвалуе Virtual PC, интерфейс Ивмвиртуалмачине
- Ивмвиртуалмачине интерфейс Virtual PC, метод Сетконфигуратионвалуе
topic_type:
- apiref
api_name:
- IVMVirtualMachine.SetConfigurationValue
api_location:
- VPCCOMInterfaces.h
api_type:
- COM
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: f1ebafd53a2eb82ea1869b5522d0258ece67d110
ms.sourcegitcommit: a1494c819bc5200050696e66057f1020f5b142cb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2020
ms.locfileid: "105691906"
---
# <a name="ivmvirtualmachinesetconfigurationvalue-method"></a>Метод Ивмвиртуалмачине:: Сетконфигуратионвалуе

\[Windows Virtual PC больше не доступна для использования в Windows 8. Вместо этого используйте [поставщик WMI Hyper-V (v2)](/windows/desktop/HyperV_v2/windows-virtualization-portal).\]

Задает значение указанного параметра конфигурации для виртуальной машины.

## <a name="syntax"></a>Синтаксис


```C++
HRESULT SetConfigurationValue(
  [in] BSTR    configurationKey,
  [in] VARIANT configurationValue
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*конфигуратионкэй* \[ окне\]
</dt> <dd>

Ключ, используемый для задания значения конфигурации, хранящегося в файле " \* . VMC".

> [!IMPORTANT]
> Изменения следует вносить в " \* . VMC" только с помощью метода **сетконфигуратионвалуе** . Изменение " \* . VMC" с помощью любого другого метода не поддерживается.

 

</dd> <dt>

*configurationValue* \[ окне\]
</dt> <dd>

Значение конфигурации. Это значение может должно быть одним из следующих типов **вариантов** : **VT \_ Array** \| **VT \_ UI1** (необработанные байты), **VT \_ BSTR** (строка), **VT \_ UI4** (Integer) или **VT \_ bool** (Boolean).

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Этот метод может возвращать одно из этих значений.



| Возвращаемый код и значение                                                                                                                                                 | Описание                                                                                                                         |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------|
| <dl> <dt>**С \_ ОК**</dt> <dt>0</dt> </dl>                       | Операция выполнена успешно.<br/>                                                                                            |
| <dl> <dt>**Д \_ INVALIDARG**</dt> <dt>0x80000003</dt> </dl>      | Параметр *конфигуратионкэй* имеет **значение NULL** или является пустым, либо параметр *configurationValue* не является допустимым типом Variant.<br/> |
| <dl> <dt>**Виртуальная машина \_ \_Неизвестный \_ 0xA0040207 виртуальной машины**</dt> <dt></dt> </dl> | Конфигурация неизвестна.<br/>                                                                                            |
| <dl> <dt>**\_ E \_ Exception**</dt> <dt>0x80020009</dt> </dl> | Произошла непредвиденная ошибка.<br/>                                                                                        |



 

## <a name="remarks"></a>Комментарии

Для параметра *конфигуратионкэй* поддерживаются следующие значения.



| значение *конфигуратионкэй*                                     | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Тип данных            | Значение по умолчанию     |
|--------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------|-------------------|
| "оборудование/BIOS/ \_ Синхронизация времени \_ при \_ загрузке"<br/>              | значение true, если синхронизация CMOS-памяти виртуальной машины выполняется с часами узла при загрузке; в противном случае — значение false.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | логическая<br/> | True<br/> |
| "интеграция/Microsoft/ \_ время узла \_ Синхронизация/включение" "<br/> | "true", если синхронизация времени узла включена в компонентах интеграции; в противном случае — значение false.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | логическая<br/> | True<br/> |
| "параметры пользовательского интерфейса \_ / \_ Автоматическая \_ Публикация приложений"<br/>                  | "true", если автоматическая публикация приложений включена в компонентах интеграции; в противном случае — значение false. Это также называется виртуальными приложениями.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | логическая<br/> | True<br/> |
| "параметры пользовательского интерфейса \_ /секунды \_ для \_ сохранения"<br/>                   | Число секунд ожидания перед сохранением виртуальной машины после закрытия всех приложений. Однако значения ниже 20 и более 4 294 968 имеют особое значение. Дополнительные сведения см. в следующем списке.<br/> <dl> <dt><span id="0"></span>0</dt> <dd> Никогда не сохраняйте виртуальную машину.<br/> </dd> <dt><span id="120"></span>1 20</dt> <dd> Подождите 20 секунд, прежде чем сохранять виртуальную машину.<br/> </dd> <dt><span id="214_294_967"></span>21 4 294 967</dt> <dd> Подождите указанное число секунд, прежде чем сохранять виртуальную машину.<br/> </dd> <dt><span id="4_294_9684_294_967_295"></span>4 294 968 4 294 967 295</dt> <dd> Подождите 4 294 968 секунд перед сохранением виртуальной машины.<br/> </dd> </dl> | цело<br/> | 300<br/>    |



 

Этот метод обеспечивает доступ низкого уровня к любому значению конфигурации. Его можно использовать для задания значений конфигурации для определяемых пользователем ключей. Будьте внимательны при использовании этого метода для задания значений конфигурации системы, так как для значения конфигурации не выполняется проверка ошибок. Кроме того, некоторые значения конфигурации нельзя изменить, пока виртуальная машина работает.

Ключи конфигурации находятся в \* файле ". VMC" виртуальной машины в формате XML. Ключи хранятся в виде иерархической структуры аналогично разделам реестра в Windows. Чтобы указать конкретный подраздел, создается «путь к ключу», который задает различные ключи в формате с разделителями-отметками.

Например, чтобы задать значение ключа "ОЗУ \_ size", расположенное в следующем дереве ключей:

``` syntax
<preferences>
  <hardware>
    <bios>
      <time_sync_at_boot type="boolean">true</time_sync_at_boot>
```

Строка пути *конфигуратионкэй* будет указана следующим образом:

``` syntax
"hardware/memory/ram_size"
```

Если какой-либо из ключей в требуемом дереве имеет значение атрибута ID, атрибут и его значение внедряются в строку пути *конфигуратионкэй* сразу после связанного с ней ключа конфигурации, используя следующий формат в квадратных скобках: " \[ @id ="*\_ значение идентификатора*" \] ".

Например, чтобы задать значение ключа «гольф», расположенное в следующем дереве ключей:

``` syntax
<preferences>
  <alpha>
    <bravo>
      <charlie>
        <delta id="1">
          <echo id="0">
            <foxtrot>
              <golf type="string">D</golf>
```

Строка пути *конфигуратионкэй* будет указана следующим образом:

``` syntax
"alpha/bravo/charlie/delta[@id=1]/echo[@id=0]/foxtrot/golf"
```

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | \[Только классические приложения Windows 7\]<br/>                                                    |
| Минимальная версия сервера<br/> | Ни одна версия не поддерживается<br/>                                                                     |
| Окончание поддержки клиента<br/>    | Windows 7<br/>                                                                          |
| Продукт<br/>                  | Windows Virtual PC<br/>                                                                 |
| Header<br/>                   | <dl> <dt>Впккоминтерфацес. h</dt> </dl> |
| IID<br/>                      | IID \_ ивмвиртуалмачине определен как f7092aa1-33ed-4f78-a59f-c00adfc2edd7<br/>          |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**ивмвиртуалмачине**](ivmvirtualmachine.md)
</dt> <dt>

[**Ивмвиртуалпк:: Сетконфигуратионвалуе**](ivmvirtualpc-setconfigurationvalue.md)
</dt> </dl>

 

