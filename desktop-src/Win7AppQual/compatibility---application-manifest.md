---
description: .
ms.assetid: f022374d-ea3f-477f-9b59-3188b775ed64
title: Манифест приложения
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bf4fd1ae8a9f66dafbe65a3db09dd014dbef31e5
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105713037"
---
# <a name="application-manifest"></a>Манифест приложения

## <a name="affected-platforms"></a>Затронутые платформы

**Клиенты** — Windows 7  
**Серверы** — Windows Server 2008 R2  









## <a name="feature-impact"></a>Воздействие на функции

 **Серьезность** — низкая  
**Частота** -низкая  





## <a name="description"></a>Описание

В Windows 7 появился новый раздел манифеста приложения под названием «совместимость». В этом разделе описывается, как Windows определяет версии Windows, предназначенные для приложения, и позволяет Windows предоставлять поведение, ожидаемое приложением в зависимости от версии Windows, для которой предназначено приложение.

Раздел совместимости позволяет Windows предоставлять новое поведение для нового программного обеспечения, созданного разработчиком, сохраняя совместимость с существующим программным обеспечением. Этот раздел также помогает Windows обеспечить более высокую совместимость в будущих версиях Windows. Например, приложение, объявляющая поддержку только для Windows 7 в разделе "совместимость", будет продолжать появление поведения Windows 7 в будущей версии Windows.

## <a name="manifestation-of-change"></a>Изменение манифеста

Приложения без раздела совместимости в манифесте по умолчанию получат поведение Windows Vista в Windows 7 и будущих версиях Windows. Обратите внимание, что Windows XP и Windows Vista не пропускают этот раздел манифеста и не влияют на них.

Следующие компоненты Windows предоставляют разные режимы работы на основе раздела Compatibility в Windows 7:

**Пул потоков RPC по умолчанию**

-   **Windows 7:** Чтобы повысить масштабируемость и сократить число потоков, RPC переключится в пул потоков NT (пул по умолчанию). В Windows Vista RPC использовал частный пул потоков.
    -   Для двоичных файлов, скомпилированных для Win7, используется пул по умолчанию
    -   Если я \_ рпкмгмтенабледедикатедсреадпул вызов до вызова API RPC, используется пул частных потоков (поведение Vista).
    -   Если \_ рпкмгмтенабледедикатедсреадпул вызывается после вызова RPC, используется пул по умолчанию, I \_ рпкмгмтенабледедикатедсреадпул возвращает ошибку 1764, а запрошенная операция не поддерживается.
-   **Windows Vista (по умолчанию):** Для двоичных файлов, скомпилированных для Windows Vista и ниже, используется частный пул.

**Блокировка DirectDraw**

-   **Windows 7:** Приложения, которые были манифесты для Windows 7, не могут вызвать API блокировки в ДДРАВ для блокировки видеобуфера основного рабочего стола. Это приведет к ошибке, и будет возвращен **пустой** указатель для первичной реплики. Это поведение применяется, даже если диспетчер окон рабочего стола композиция не включена. Приложения, совместимые с Windows 7, не должны блокировать основной буфер видео для подготовки к просмотру.
-   **Windows Vista (по умолчанию):** Приложения смогут получить блокировку основного видеобуфера, так как устаревшие приложения зависят от этого поведения. Запуск приложения выключает диспетчер окон рабочего стола.

**Блочный блок DirectDraw (БЛТ) до первичного без усечения окна**

-   **Windows 7:** Приложения, манифестные для Windows 7, не могут выполнять БЛТ в видеобуфер основного рабочего стола без окна обрезки. Это приведет к ошибке, и область БЛТ не будет подготовлена к просмотру. Windows обеспечивает это поведение, даже если вы не включаете диспетчер окон рабочего столаную композицию. Приложения, совместимые с Windows 7, должны БЛТ в окно обрезки.
-   **Windows Vista (по умолчанию):** Приложения должны иметь возможность БЛТ к основному приложению без окна обрезки, так как устаревшие приложения зависят от этого поведения. Запуск этого приложения выключает диспетчер окон рабочего стола.

**API GetOverlappedResult**

-   **Windows 7:** Разрешает состояние гонки, когда многопоточное приложение, использующее GetOverlappedResult, может возвращаться без сброса события в структуре OVERLAPPED, что приводит к преждевременному возвращению следующего вызова этой функции.
-   **Windows Vista (по умолчанию):** Обеспечивает поведение с условием гонки о том, что приложения могут иметь зависимость от. Приложения, желающие избежать этого состязания перед поведением Windows 7, должны ждать перекрытое событие и при получении сигнала вызвать GetOverlappedResult с Бваит = = **false**.

**Помощник по совместимости программ (PCA)**

-   **Windows 7:** Приложения с разделом совместимости не будут получать исправление PCA.
-   **Windows Vista (по умолчанию):** Приложения, которые не удается правильно установить или завершить работу во время выполнения при определенных обстоятельствах, приведут к устранению уязвимости PCA. Дополнительные сведения см. в разделе справки.

## <a name="leveraging-feature-capabilities"></a>Использование возможностей функций

Обновите манифест приложения, используя последние сведения о совместимости для поддержки операционной системы. В разделе описаны дополнения к манифесту:

-   **Пространство имен:** Compatibility. v1 (xmlns = "urn: схемы-Microsoft-COM: Compatibility. v1" >)

-   **Имя раздела:** Совместимость (новый раздел)

-   **Суппортедос:** GUID поддерживаемой операционной системы — идентификаторы GUID, которые сопоставляются с поддерживаемыми операционными системами:

    -   {e2011457-1546-43c5-a5fe-008deee3d3f0} для Windows Vista: это значение по умолчанию для контекста свитчбакк.
    -   {35138b9a-5d96-4fbd-8e2d-a2440225f93a} для Windows 7: приложения, которые задают это значение в манифесте приложения, получают поведение Windows 7.

    > [!Note]  
    > Корпорация Майкрософт будет создавать и публиковать идентификаторы GUID для будущих версий Windows по мере необходимости.

     

Ниже приведен пример обновленного манифеста.

> [!Note]  
> Имена атрибутов и тегов в манифесте приложения чувствительны к регистру.

 


```XML
<?xml version="1.0" encoding="UTF-8" standalone="yes"?> 
  <assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0"> 
    <compatibility xmlns="urn:schemas-microsoft-com:compatibility.v1"> 
      <application> 
        <!--The ID below indicates application support for Windows Vista --> 
          <supportedOS Id="{e2011457-1546-43c5-a5fe-008deee3d3f0}"/> 
        <!--The ID below indicates application support for Windows 7 --> 
          <supportedOS Id="{35138b9a-5d96-4fbd-8e2d-a2440225f93a}"/> 
      </application> 
    </compatibility>
  </assembly>
```



Значение добавления идентификаторов GUID для обеих операционных систем в приведенном выше примере — предоставление поддержки нижнего уровня. Для приложений, поддерживающих обе платформы, отдельные манифесты для каждой платформы не требуются.

## <a name="compatibility-performance-reliability-and-usability-testing"></a>Совместимость, производительность, надежность и тестирование на удобство использования

1.  Протестируйте приложение с помощью нового раздела "совместимость" и `SupportedOS ID ={35138b9a-5d96-4fbd-8e2d-a2440225f93a}` Убедитесь, что приложение работает правильно, используя Последнее поведение Windows 7.
2.  Протестируйте приложение с новым разделом совместимости и `SupportedOS ID ={e2011457-1546-43c5-a5fe-008deee3d3f0}` (или без него целиком), чтобы убедиться, что приложение работает правильно с использованием поведения Windows Vista в Windows 7.

## <a name="known-issues"></a>Известные проблемы

**Несоответствие контекста** Приложение выполняется в контексте Windows Vista, а не в контексте Windows 7 на компьютере с 64-разрядной операционной системой Windows 7 или Windows Server 2008 R2.

**Решение** Доступны обновления для всех поддерживаемых 64-разрядных версий Windows 7 и Windows Server 2008 R2, а также для всех поддерживаемых версий Windows Server 2008 R2 на основе Itanium. Перейдите на страницу служба поддержки Майкрософт [KB 978637: приложение выполняется в контексте Windows Vista, а не в контексте Windows 7 на компьютере с 64-разрядной версией Windows 7 или Windows Server 2008 R2](https://support.microsoft.com/kb/978637) для получения дополнительных сведений и загрузки правильной версии для системы.

**Диагностика аварийного дампа заблокирована**

**Решение** Перейдите на страницу служба поддержки Майкрософт [KB 976038. исключения, возникающие в приложении, которое выполняется в 64-разрядной версии Windows, пропускаются](https://support.microsoft.com/kb/976038) для получения дополнительных сведений.

## <a name="links-to-other-resources"></a>Ссылки на другие ресурсы

-   [**Функция Куеряктктксв**](/windows/win32/api/winbase/nf-winbase-queryactctxw)
-   [Манифест UAC](/previous-versions/bb756929(v=msdn.10))
-   [Манифесты приложений для приложений Windows](../sbscs/application-manifests.md)
-   [Диспетчер окон рабочего стола (DWM)](../dwm/dwm-overview.md)
-   [Обновление несовпадения контекста](https://support.microsoft.com/kb/978637)

 

 
