---
description: Манифест приложения
ms.assetid: f022374d-ea3f-477f-9b59-3188b775ed64
title: Манифест приложения
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 80c52b8eb2af87c271151be3d7989f50b2903084
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127571035"
---
# <a name="application-manifest"></a>Манифест приложения

## <a name="affected-platforms"></a>Затронутые платформы

**клиенты** — Windows 7  
**серверы** — Windows Server 2008 R2  









## <a name="feature-impact"></a>Воздействие на функции

 **Серьезность** — низкая  
**Частота** -низкая  





## <a name="description"></a>Описание

в Windows 7 появился новый раздел в манифесте приложения под названием «совместимость». этот раздел поможет Windows определить версии Windows, предназначенные для приложения, и позволяет Windows обеспечить поведение приложения в зависимости от версии Windows, для которой предназначено приложение.

раздел "совместимость" позволяет Windows предоставлять новое поведение для нового программного обеспечения, созданного разработчиком, сохраняя совместимость с существующим программным обеспечением. этот раздел также помогает Windows обеспечить более высокую совместимость в будущих версиях Windows. например, приложение, объявляющего поддержку только для Windows 7 в разделе "совместимость", будет продолжать поступать Windows 7 в будущей версии Windows.

## <a name="manifestation-of-change"></a>Изменение манифеста

приложения без раздела совместимости в манифесте будут по умолчанию поступать Windows Vista в Windows 7 и будущих версиях Windows. обратите внимание, что Windows XP и Windows Vista не пропускают этот раздел манифеста и не влияет на них.

следующие Windows компоненты предоставляют разные режимы работы на основе раздела Compatibility в Windows 7:

**Пул потоков RPC по умолчанию**

-   **Windows 7:** Чтобы повысить масштабируемость и сократить число потоков, RPC переключится в пул потоков NT (пул по умолчанию). для Windows Vista RPC использовал частный пул потоков.
    -   Для двоичных файлов, скомпилированных для Win7, используется пул по умолчанию
    -   Если я \_ рпкмгмтенабледедикатедсреадпул вызов до вызова API RPC, используется пул частных потоков (поведение Vista).
    -   Если \_ рпкмгмтенабледедикатедсреадпул вызывается после вызова RPC, используется пул по умолчанию, I \_ рпкмгмтенабледедикатедсреадпул возвращает ошибку 1764, а запрошенная операция не поддерживается.
-   **Windows Vista (по умолчанию):** для двоичных файлов, скомпилированных для Windows Vista и ниже, используется частный пул.

**Блокировка DirectDraw**

-   **Windows 7:** приложения, манифестные для Windows 7, не могут вызывать API блокировки в ддрав для блокировки видеобуфера основного рабочего стола. Это приведет к ошибке, и будет возвращен **пустой** указатель для первичной реплики. Это поведение применяется, даже если диспетчер окон рабочего стола композиция не включена. приложения, совместимые с Windows 7, не должны блокировать основной видеобуфер для подготовки к просмотру.
-   **Windows Vista (по умолчанию):** Приложения смогут получить блокировку основного видеобуфера, так как устаревшие приложения зависят от этого поведения. Запуск приложения выключает диспетчер окон рабочего стола.

**Блочный блок DirectDraw (БЛТ) до первичного без усечения окна**

-   **Windows 7:** приложения, которые были манифесты для Windows 7, не могут выполнять блт в буфер видео основного рабочего стола без окна обрезки. Это приведет к ошибке, и область БЛТ не будет подготовлена к просмотру. Windows обеспечивает это поведение, даже если не включено диспетчер окон рабочего стола композиция. приложения, совместимые с Windows 7, должны блт в окно обрезки.
-   **Windows Vista (по умолчанию):** Приложения должны иметь возможность БЛТ к основному приложению без окна обрезки, так как устаревшие приложения зависят от этого поведения. Запуск этого приложения выключает диспетчер окон рабочего стола.

**API GetOverlappedResult**

-   **Windows 7:** Разрешает состояние гонки, когда многопоточное приложение, использующее GetOverlappedResult, может возвращаться без сброса события в структуре OVERLAPPED, что приводит к преждевременному возвращению следующего вызова этой функции.
-   **Windows Vista (по умолчанию):** Обеспечивает поведение с условием гонки о том, что приложения могут иметь зависимость от. приложения, желающие избежать этого состязания перед Windows 7, должны ждать перекрытого события и при получении сигнала вызвать GetOverlappedResult с бваит = = **FALSE**.

**Помощник по совместимости программ (PCA)**

-   **Windows 7:** Приложения с разделом совместимости не будут получать исправление PCA.
-   **Windows Vista (по умолчанию):** Приложения, которые не удается правильно установить или завершить работу во время выполнения при определенных обстоятельствах, приведут к устранению уязвимости PCA. Дополнительные сведения см. в разделе справки.

## <a name="leveraging-feature-capabilities"></a>Использование возможностей функций

Обновите манифест приложения, используя последние сведения о совместимости для поддержки операционной системы. В разделе описаны дополнения к манифесту:

-   **Пространство имен:** Compatibility. v1 (xmlns = "urn: схемы-Microsoft-COM: Compatibility. v1" >)

-   **Имя раздела:** Совместимость (новый раздел)

-   **Суппортедос:** GUID поддерживаемой операционной системы — идентификаторы GUID, которые сопоставляются с поддерживаемыми операционными системами:

    -   {e2011457-1546-43c5-a5fe-008deee3d3f0} для Windows Vista: это значение по умолчанию для контекста свитчбакк.
    -   {35138b9a-5d96-4fbd-8e2d-a2440225f93a} для Windows 7: приложения, которые задают это значение в манифесте приложения, получают поведение Windows 7.

    > [!Note]  
    > корпорация майкрософт будет создавать и публиковать идентификаторы guid для будущих версий Windows по мере необходимости.

     

Ниже приведен пример обновленного манифеста.

> [!Note]  
> Имена атрибутов и тегов в манифесте приложения чувствительны к регистру.

 


```XML
<?xml version="1.0" encoding="UTF-8" standalone="yes"?> 
  <assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0"> 
    <compatibility xmlns="urn:schemas-microsoft-com:compatibility.v1"> 
      <application> 
        <!--The ID below indicates application support for Windows Vista --> 
          <supportedOS Id="{e2011457-1546-43c5-a5fe-008deee3d3f0}"/> 
        <!--The ID below indicates application support for Windows 7 --> 
          <supportedOS Id="{35138b9a-5d96-4fbd-8e2d-a2440225f93a}"/> 
      </application> 
    </compatibility>
  </assembly>
```



Значение добавления идентификаторов GUID для обеих операционных систем в приведенном выше примере — предоставление поддержки нижнего уровня. Для приложений, поддерживающих обе платформы, отдельные манифесты для каждой платформы не требуются.

## <a name="compatibility-performance-reliability-and-usability-testing"></a>Совместимость, производительность, надежность и тестирование на удобство использования

1.  протестируйте приложение с помощью нового раздела "совместимость" и `SupportedOS ID ={35138b9a-5d96-4fbd-8e2d-a2440225f93a}` убедитесь, что приложение работает правильно, используя последнее поведение Windows 7.
2.  протестируйте приложение с новым разделом совместимости и `SupportedOS ID ={e2011457-1546-43c5-a5fe-008deee3d3f0}` (или без него целиком), чтобы убедиться, что приложение работает правильно с использованием поведения Windows Vista в Windows 7.

## <a name="known-issues"></a>Известные проблемы

**Несоответствие контекста** приложение выполняется в контексте Windows Vista, а не в контексте Windows 7 на компьютере, на котором работает 64-разрядная версия Windows 7 или Windows Server 2008 R2.

**Решение** доступны обновления для всех поддерживаемых версий x64 Windows 7 и Windows Server 2008 r2, а также для всех поддерживаемых версий Windows Server 2008 r2 на базе процессоров Itanium. перейдите на страницу служба поддержки Майкрософт [KB 978637. приложение выполняется в контексте Windows Vista, а не в контексте Windows 7 на компьютере с 64-разрядной версией Windows 7 или Windows Server 2008 R2](https://support.microsoft.com/kb/978637) для получения дополнительных сведений и загрузки правильной версии для системы.

**Диагностика аварийного дампа заблокирована**

**Решение** перейдите на страницу служба поддержки Майкрософт [KB 976038: исключения, возникающие в приложении, которое выполняется в 64-разрядной версии Windows, не учитываются](https://support.microsoft.com/kb/976038) для получения дополнительных сведений.

## <a name="links-to-other-resources"></a>Ссылки на другие ресурсы

-   [**Функция Куеряктктксв**](/windows/win32/api/winbase/nf-winbase-queryactctxw)
-   [Манифест UAC](/previous-versions/bb756929(v=msdn.10))
-   [манифесты приложений для Windows приложений](../sbscs/application-manifests.md)
-   [Диспетчер окон рабочего стола (DWM)](../dwm/dwm-overview.md)
-   [Обновление несовпадения контекста](https://support.microsoft.com/kb/978637)

 

 
