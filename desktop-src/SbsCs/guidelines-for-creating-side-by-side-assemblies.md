---
description: Следующие рекомендации описывают, как создавать собственные параллельные сборки COM или Win32.
ms.assetid: e10fe92c-bce8-420e-a84c-2748e929eb1b
title: Рекомендации по созданию параллельных сборок
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: af8e8fd2bd31a65477b44d3afcf2156d5160a72a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104144521"
---
# <a name="guidelines-for-creating-side-by-side-assemblies"></a>Рекомендации по созданию параллельных сборок

Следующие рекомендации описывают, как создавать собственные параллельные сборки COM или Win32. Если необходимая функциональность предоставляется одной из [поддерживаемых параллельных сборок Майкрософт](supported-microsoft-side-by-side-assemblies.md), вам может не потребоваться создавать собственные параллельные сборки. В этом случае используйте сборки, предоставляемые корпорацией Майкрософт, и выполните процедуры по использованию параллельных сборок в [с помощью изолированных приложений и параллельных сборок](using-isolated-applications-and-side-by-side-assemblies.md).

Во-первых, определите, является ли ваш компонент подходящим кандидатом для параллельной сборки. Дополнительные сведения см [. в разделе следует ли предоставлять общий компонент в качестве параллельной сборки?](should-you-provide-a-shared-component-as-a-side-by-side-assembly.md)

Чтобы создать параллельную сборку, следуйте приведенным ниже рекомендациям.

-   Решите, какие ресурсы включать в сборку. Помните, что сборка состоит из одного или нескольких файлов, которые всегда предоставляются приложениям и клиентам вместе. Эта сборка выступает в качестве основной единицы, используемой для именования, привязки, управления версиями, развертывания и [конфигурации по умолчанию](default-configuration.md). Как правило, если не определено, входят ли два ресурса в одну сборку, рекомендуется создать их для перехода в отдельные сборки. Как правило, параллельная сборка состоит из одной библиотеки DLL.
-   Создайте [Манифест](manifests.md) сборки для сборки. Манифест должен описывать COM-объект или библиотеки типов в сборке. Дополнительные сведения о том, что следует создать в манифесте сборки, см. в разделе [Манифесты сборки](assembly-manifests.md).
-   Оцените использование объектов, когда в системе выполняется несколько версий сборки. Определите, требуются ли для разных версий сборки отдельные структуры данных, такие как размещенные в памяти файлы, именованные каналы, зарегистрированные сообщения Windows и классы, Общая память, семафоры, мьютексы и драйверы оборудования. Все структуры данных, используемые в версиях сборок, должны быть обратно совместимыми версиями. Решите, какие структуры данных можно использовать в разных версиях и какие структуры данных должны быть частными для версии. Определите, требуются ли для общих структур данных отдельные объекты синхронизации, такие как семафоры и мьютексы.
-   Создайте библиотеку DLL, которая будет работать как параллельная сборка, придерживаясь рекомендаций по [созданию библиотеки DLL для параллельной сборки](authoring-a-dll-for-a-side-by-side-assembly.md).
-   Создайте набор файлов заголовков и вспомогательных функций, чтобы обеспечить простой способ создания разделов реестра, содержащих состояние сборки. Сборки обычно сохраняют свои параметры состояния в разделах реестра. Параметры реестра должны быть записаны на отдельной версии, чтобы изолировать несколько версий сборки, которые могут выполняться одновременно. Разработка параллельной сборки и библиотеки DLL для правильного хранения и обработки состояния сборки во время параллельного предоставления общего доступа. Следуйте рекомендациям по [созданию хранилища состояний для параллельных сборок](authoring-state-storage-for-side-by-side-assemblies.md).
-   Разработчики приложений, использующих [закрытые сборки](/windows/desktop/Msi/private-assemblies) , должны защищать каталог приложения. Если приложение установлено с помощью [установщик Windows](../msi/windows-installer-portal.md), то каталог приложения можно защитить с помощью таблицы локкпермиссионс. Как правило, системе предоставляется доступ на чтение, запись и выполнение для закрытых сборок; все остальные процессы получают доступ только для выполнения и чтения.
-   Протестируйте сборку с помощью сценариев с параллельным предоставлением общего доступа, чтобы убедиться, что это допустимая параллельная сборка. Для успешной установки сборки недостаточно, чтобы гарантировать, что она будет работать должным образом.
-   Применяйте метод для нумерации обновлений для сборки. Каждая сборка связана с номером версии, сопоставленным с четырьмя частями. Слева направо основной, дополнительный, номер сборки и номер редакции разделены точками. Измените основной или дополнительный номер сборки для версии, которая несовместима с предыдущими версиями. Изменение только частей сборки и редакции для обратно совместимых изменений в сборке. Например, разработчик может применять метод нумерации, в котором все 1.0.0. \* Номера версий относятся к версиям обновления для сборки 1.0.0.0.

 

 
