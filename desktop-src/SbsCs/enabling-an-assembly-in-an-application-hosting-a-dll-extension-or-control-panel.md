---
description: Если в приложении размещается библиотека DLL, расширение, подключаемый модуль или панель управления стороннего разработчика, может потребоваться включить сборку в приложении&\# 8212; без включения этой сборки для размещенных компонентов.
ms.assetid: 832957ca-82fc-4600-b469-512621dde921
title: Включение сборки в приложении, где размещается библиотека DLL, расширение или панель управления
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4b04dd19b18c2cdce4783be47333b9afe53dd1ae
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105647407"
---
# <a name="enabling-an-assembly-in-an-application-hosting-a-dll-extension-or-control-panel"></a>Включение сборки в приложении, где размещается библиотека DLL, расширение или панель управления

Если в приложении размещается библиотека DLL, расширение, подключаемый модуль или панель управления стороннего разработчика, может потребоваться включить сборку в приложении, не включая эту сборку для размещенных компонентов. Это может быть так, когда размещенному компоненту требуется изменение кода для использования сборки. Как разработчик приложения, возможно, вам не удастся внести изменения в эти компоненты сторонних разработчиков. В этом случае следует выполнить процедуру, описанную в этом разделе, чтобы приложение может использовать сборку без влияния на размещенные компоненты.

-   Чтобы включить сборку в приложении, не затрагивая размещенные библиотеки DLL, расширения, подключаемые модули или панели управления, манифест, описывающий зависимость приложения от сборки, должен быть включен в приложение в качестве ресурса. Размещенные компоненты, которые не включены в сборку, не должны включать манифесты, описывающие эту зависимость.
-   Чтобы включить сборку в приложении и ее размещенных библиотеках DLL, расширениях, подключаемых модулях или панелях управления, включите манифесты как ресурсы как в приложение, так и на его размещенные компоненты. Манифесты, включенные в приложение и в размещенные компоненты, должны описывать зависимость от сборки. Как правило, разработчик приложения добавляет в приложение манифест, а разработчик размещенных компонентов добавляет манифест в библиотеку DLL, расширение, подключаемый модуль или панель управления.

Следующий метод можно использовать для добавления манифеста в приложение или размещенного компонента, который является библиотекой DLL, расширением, подключаемым модулем или панелью управления.

**Для включения сборки в приложении или размещенном компоненте.**

1.  Создайте манифест, описывающий зависимость приложения или расширения для сборки.

    Например, манифест для "Йоураппликатион" можно создать, скопировав следующий пример манифеста и подставив правильные значения для **assemblyIdentity**, **processorArchitecture** и **Description**. Установите значение **processorArchitecture** равным x86, если сборка на базе 32-разрядной платформы и архитектура ia64 при сборке на 64-разрядной платформе. Элемент **Description** содержит описание параметра приложения. Дополнительные сведения о формате манифеста см. в разделе [манифесты приложений](application-manifests.md).

    ``` syntax
    <?xml version="1.0" encoding="UTF-8" standalone="yes"?>
    <assembly xmlns="urn:schemas-microsoft-com:asm.v1" manifestVersion="1.0">
    <assemblyIdentity
        version="1.0.0.0"
        processorArchitecture="x86"
        name="YourCompanyName.YourDivision.YourApp"
        type="win32"
    />
    <description>Your app description here</description>
    <dependency>
        <dependentAssembly>
            <assemblyIdentity
                type="win32"
                name="Proseware.Research.SampleAssembly"
                version="6.0.0.0"
                processorArchitecture="X86"
                publicKeyToken="0000000000000000"
                language="*"
            />
        </dependentAssembly>
    </dependency>
    </assembly>
    ```

2.  Создайте ресурс в приложении или расширение типа "RT" с \_ идентификатором 2.

    Например, если имя приложения — Йоурапп, приложение должно содержать следующее:

    ``` syntax
    #define MANIFEST_RESOURCE_ID 2
    MANIFEST_RESOURCE_ID RT_MANIFEST "YourApp.manifest"
    ```

3.  Скомпилируйте приложение с флагом-ДИСОЛАТИОН \_ , поддерживающим \_ поддержку, или вставьте эту инструкцию перед \# оператором include "Windows. h". В случае приложения с несколькими модулями \_ \_ на всех модулях должен быть включен флаг-дисолатион с поддержкой включения.

    ``` syntax
    #define ISOLATION_AWARE_ENABLED 1
    ```

4.  Проверьте, правильно ли работают сборки, используемые приложением, в приложении и размещенном компоненте.

Дополнительные сведения о добавлении сборки в приложения без расширений см. в разделе [Включение сборки в приложении без расширений](enabling-an-assembly-in-an-application-without-extensions.md).

 

 



