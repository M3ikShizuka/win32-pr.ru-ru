---
description: Контексты активации — это структуры данных в памяти, содержащие сведения, которые система может использовать для перенаправления приложения для загрузки конкретной версии DLL, экземпляра объекта COM или пользовательской версии окна.
ms.assetid: 5416f8c0-d99b-4a5d-a689-a47bd0cf1a88
title: Контексты активации
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2f1f20d747f63ba71eee73fc17c0d5543003e5f7
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104345332"
---
# <a name="activation-contexts"></a>Контексты активации

[*Контексты активации*](a-sbscs-gly.md) — это структуры данных в памяти, содержащие сведения, которые система может использовать для перенаправления приложения для загрузки конкретной версии DLL, экземпляра объекта COM или пользовательской версии окна. Один раздел контекста активации может содержать сведения о перенаправлении библиотек DLL, которые используются загрузчиком DLL. другой раздел может содержать сведения о COM-сервере. Функции контекста активации используют, создают, активируют и деактивируют контексты активации. Функции активации могут перенаправить привязку приложения к объектам с именованием версий, которые указывают определенные версии DLL, классы окон, серверы COM, библиотеки типов и интерфейсы. Дополнительные сведения о функциях контекста активации и структурах см. в разделе [Справочник по контексту активации](activation-context-reference.md).

Начиная с Windows XP, функции контекста активации позволяют Windows использовать сведения в [манифестах](manifests.md) для создания объектов с именами версий. Если приложение создает процесс путем вызова функции [**CreateProcess**](/windows/desktop/api/processthreadsapi/nf-processthreadsapi-createprocessa), Windows проверяет наличие [манифеста приложения](application-manifests.md). Если манифест существует, Windows использует сведения в манифесте для заполнения контекста активации. Поскольку манифесты описывают зависимость приложения от [параллельных версий сборок](about-side-by-side-assemblies-.md) , объекты, указанные без версий в манифесте, сопоставляются с именами объектов версии. Например, манифест может описывать библиотеки DLL, файлы, классы окон, серверы COM, библиотеки типов и интерфейсы.

Когда глобальный объект создается в контексте активации, система автоматически присваивает объекту имя, зависящее от версии, путем консультации с манифестом. Когда приложение выполняет и запрашивает именованный объект, он получает объект с именем версии. Это позволяет нескольким версиям модуля кода запускаться в системе одновременно, не мешая друг другу. Например, [оболочка Windows](/previous-versions/windows/desktop/legacy/bb776778(v=vs.85)) использует манифест для описания зависимости от версии 6,0 Comctl32 и создания версий классов окон.

Если приложение создает ресурс путем вызова [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa), этот процесс указывает имя класса для этой функции. Вызов [**жеткуррентакткткс**](/windows/desktop/api/Winbase/nf-winbase-getcurrentactctx) получает текущий контекст активации и проверяет существование сопоставления для данного имени класса. Если сопоставление существует, оно будет использовать эту версию вызывающего процесса для разрешения сопоставления и предоставления имени класса, зависящего от версии. Windows создает окно с процедурой окна, стилями и другими атрибутами, связанными с именем и версией этого класса.

Контекст активации управляется системой в большинстве случаев. Разработчикам приложений и поставщикам сборок обычно не требуется вызывать стек. Приложения могут управлять контекстом активации путем прямого вызова контекста активации. Дополнительные сведения см. [в разделе Использование API контекста активации](using-the-activation-context-api.md).

 

 
