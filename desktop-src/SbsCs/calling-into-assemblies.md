---
description: При вызове EntryPoint сборки рекомендуется использовать тот же контекст активации, который был активным при поиске сборки.
ms.assetid: 8b2de5f5-ea95-441f-9345-b64de53ea05f
title: Вызов сборок
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 03e4742b19ea47e03fac5f7d0318248ea167182e
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127271691"
---
# <a name="calling-into-assemblies"></a>Вызов сборок

При вызове EntryPoint сборки рекомендуется использовать тот же контекст активации, который был активным при поиске сборки. Как минимум, убедитесь, что компонент, загружающий сборку, не получает контекст активации, который использует ваше приложение. Утечка контекста активации по границам DLL может привести к непредвиденным зависимостям. Это не является проблемой, если приложение \_ \_ выполняет компиляцию включенной в режиме изоляции, так как в этом случае контекст активации по умолчанию не активен. Если не выполнить компиляцию с \_ \_ включенной поддержкой режима изоляции, необходимо активировать контекст активации **null** или тот же контекст активации, который использовался для загрузки сборки.

В следующем примере выполняется проверка того, что размещенная библиотека DLL запускается в контексте, который он распознает:

``` syntax
ULONG_PTR ulpCookie;
ActivateActCtx(hTheActCtxForMyDll, &ulpCookie);
__try 
{
        MyDllIsolatedFunction();
    myDllIsolatedComInterface->Funct();
}
__finally 
{
    DeactivateActCtx(0, ulpCookie);
}
```

 

 



