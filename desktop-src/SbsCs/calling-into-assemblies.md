---
description: При вызове EntryPoint сборки рекомендуется использовать тот же контекст активации, который был активным при поиске сборки.
ms.assetid: 8b2de5f5-ea95-441f-9345-b64de53ea05f
title: Вызов сборок
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ae6f785c9d68aa0dbf4bec24927d9f2a1443aed1fb7fe65ec9244616fce8feec
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119142427"
---
# <a name="calling-into-assemblies"></a>Вызов сборок

При вызове EntryPoint сборки рекомендуется использовать тот же контекст активации, который был активным при поиске сборки. Как минимум, убедитесь, что компонент, загружающий сборку, не получает контекст активации, который использует ваше приложение. Утечка контекста активации по границам DLL может привести к непредвиденным зависимостям. Это не является проблемой, если приложение \_ \_ выполняет компиляцию включенной в режиме изоляции, так как в этом случае контекст активации по умолчанию не активен. Если не выполнить компиляцию с \_ \_ включенной поддержкой режима изоляции, необходимо активировать контекст активации **null** или тот же контекст активации, который использовался для загрузки сборки.

В следующем примере выполняется проверка того, что размещенная библиотека DLL запускается в контексте, который он распознает:

``` syntax
ULONG_PTR ulpCookie;
ActivateActCtx(hTheActCtxForMyDll, &ulpCookie);
__try 
{
        MyDllIsolatedFunction();
    myDllIsolatedComInterface->Funct();
}
__finally 
{
    DeactivateActCtx(0, ulpCookie);
}
```

 

 



