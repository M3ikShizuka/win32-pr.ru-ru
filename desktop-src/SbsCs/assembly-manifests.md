---
description: Манифест сборки — это XML-файл, описывающий параллельную сборку.
ms.assetid: f7973019-0a80-498e-adf1-c66267c813f4
title: Манифесты сборки
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 94310ce3fdbb05706f889ea9755f7a47320ada56
ms.sourcegitcommit: 61a4c522182aa1cacbf5669683d9570a3bf043b2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/26/2021
ms.locfileid: "122884884"
---
# <a name="assembly-manifests"></a>Манифесты сборки

Манифест сборки — это XML-файл, описывающий параллельную сборку. Манифесты сборок описывают имена и версии параллельных сборок, файлов и ресурсов сборки, а также зависимость сборки в других параллельных сборках. Для правильной установки, активации и выполнения параллельных сборок требуется, чтобы манифест сборки всегда сопровождаться сборкой в системе.

Полный список схем XML см. в разделе [Схема файла манифеста](manifest-file-schema.md).

Манифесты сборки имеют следующие элементы и атрибуты.



| Элемент                           | Атрибуты                | Обязательно |
|-----------------------------------|---------------------------|----------|
| **сборок**                      |                           | Да      |
|                                   | **манифестверсион**       | Да      |
| **не наследуется**                 |                           | нет       |
| **Неправильн**              |                           | Да      |
|                                   | **type**                  | Да      |
|                                   | **name**                  | Да      |
|                                   | **language**              | нет       |
|                                   | **processorArchitecture** | нет       |
|                                   | **version**               | Да      |
|                                   | **publicKeyToken**        | нет       |
| **зависимостей**                    |                           | нет       |
| **dependentAssembly**             |                           | нет       |
| **file**                          |                           | нет       |
|                                   | **name**                  | Да      |
|                                   | **hashAlg**               | нет       |
|                                   | **hash**                  | нет       |
| **comClass**                      |                           | нет       |
|                                   | **description**           | нет       |
|                                   | **этому**                 | Да      |
|                                   | **threadingModel**        | нет       |
|                                   | **tlbid**                 | нет       |
|                                   | **ID**                | нет       |
|                                   | **мискстатус**            | нет       |
|                                   | **мискстатусикон**        | нет       |
|                                   | **мискстатусконтент**     | нет       |
|                                   | **мискстатусдокпринт**    | нет       |
|                                   | **мискстатусдокпринт**    | нет       |
| **Экспорт Typelib**                       |                           | нет       |
|                                   | **tlbid**                 | Да      |
|                                   | **version**               | Да      |
|                                   | **хелпдир**               | Да      |
|                                   | **идентификатора**            | нет       |
|                                   | **flags**                 | нет       |
| **коминтерфацеекстерналпроксистуб** |                           | Нет       |
|                                   | **IID**                   | Да      |
|                                   | **baseInterface**         | нет       |
|                                   | **нуммесодс**            | нет       |
|                                   | **name**                  | нет       |
|                                   | **tlbid**                 | нет       |
|                                   | **proxyStubClsid32**      | нет       |
| **коминтерфацепроксистуб**         |                           | нет       |
|                                   | **IID**                   | Да      |
|                                   | **name**                  | Да      |
|                                   | **tlbid**                 | нет       |
|                                   | **baseInterface**         | Нет       |
|                                   | **нуммесодс**            | нет       |
|                                   | **proxyStubClsid32**      | нет       |
|                                   | **threadingModel**        | нет       |
| **виндовкласс**                   |                           | нет       |
|                                   | **версиями**             | Нет       |



 

## <a name="file-location"></a>Расположение файла

Манифесты сборки можно установить в трех расположениях:

-   Манифесты сборок, сопровождающие [Общие сборки](/windows/desktop/Msi/shared-assemblies), должны быть установлены в виде отдельного файла в параллельном кэше сборок. обычно это папка WinSxS в каталоге Windows.
-   Манифесты сборок, которые прилагаются к [частным сборкам](/windows/desktop/Msi/private-assemblies), должны устанавливаться в структуре каталогов приложения. Обычно это отдельный файл в той же папке, что и исполняемый файл приложения.
-   Как ресурс в библиотеке DLL, сборка доступна для закрытого использования библиотеки DLL. Манифест сборки нельзя включать в качестве ресурса в EXE-файл. EXE-файл может включать [манифест приложения](application-manifests.md) в качестве ресурса.

## <a name="file-name-syntax"></a>Синтаксис имени файла

Имя манифеста сборки — это любое допустимое имя файла, за которым следует manifest.

Например, манифест сборки, который ссылается на MyAssembly, будет использовать следующий синтаксис имени файла. Если манифест сборки устанавливается как отдельный файл или если идентификатор ресурса равен 1, можно опустить поле <*идентификатор ресурса*>.

<dl> myAssembly. <resource ID> . явление
</dl>

> [!Note]  
> Из-за способа параллельного поиска закрытых сборок применяются следующие ограничения именования при упаковке библиотеки DLL как закрытой сборки. Рекомендуемый способ — разместить манифест сборки в библиотеке DLL как ресурс. В этом случае идентификатор ресурса должен равняться 1, а имя закрытой сборки может совпадать с именем библиотеки DLL. Например, если имя библиотеки DLL Microsoft.Windows.mysample.dll, то значение атрибута Name, используемое в элементе **assemblyIdentity** манифеста, также может быть равно Microsoft. Windows. mysample. Другой способ — разместить манифест сборки в отдельном файле. В этом случае имя сборки и ее манифеста должны отличаться от имени библиотеки DLL. Например, Microsoft. Windows. мисамплеасм, Microsoft. Windows. мисамплеасм. manifest и Microsoft.Windows.Mysample.dll. Дополнительные сведения о параллельном поиске закрытых сборок см. в разделе [последовательность поиска сборок](assembly-searching-sequence.md).

 

## <a name="elements"></a>Элементы

В именах элементов и атрибутов учитывается регистр. Значения элементов и атрибутов не учитывают регистр, за исключением значения атрибута Type.

<dl> <dt>

<span id="assembly"></span><span id="ASSEMBLY"></span>**сборок**
</dt> <dd>

Элемент контейнера. Его первым подэлементом должен быть элемент **assemblyIdentity** или, который можно **наследовать** . Манифест сборки однозначно описывает параллельную сборку, обозначенную **assemblyIdentity**. Обязательный.

Элемент Assembly должен находиться в пространстве имен urn: schemas-microsoft-com: ASM. v1. Дочерние элементы сборки также должны находиться в этом пространстве имен путем наследования или добавления тегов.

Элемент **Assembly** имеет следующий атрибут.



| attribute           | Описание                                           |
|---------------------|-------------------------------------------------------|
| **манифестверсион** | Атрибут **манифестверсион** должен иметь значение 1,0. |



 

</dd> <dt>

<span id="noInheritable"></span><span id="noinheritable"></span><span id="NOINHERITABLE"></span>**не наследуется**
</dt> <dd>

Включите этот элемент в манифест сборки, чтобы указать, что сборка управляет [контекстами активации](activation-contexts.md) и ее объектами. Элемент, который **является наследником** , должен быть вложенным элементом элемента **Assembly** . Элемент **assemblyIdentity** должен следовать после любого элемента, который не **наследуется** . Элемент, **наследуемый** атрибутом, является обязательным в манифесте сборки, если сборка используется любыми [манифестами приложений](application-manifests.md) , включающими элемент **NoInherit** . Элемент, который не **наследуется** в манифесте приложения, не имеет силы. Элемент, который не **наследуется** , не имеет дочерних элементов.

</dd> <dt>

<span id="assemblyIdentity"></span><span id="assemblyidentity"></span><span id="ASSEMBLYIDENTITY"></span>**Неправильн**
</dt> <dd>

Описывает и однозначно определяет параллельную сборку.

Как первый подэлемент элемента **Assembly** , **assemblyIdentity** описывает и уникально идентифицирует параллельную сборку, которая владеет этим манифестом сборки. Это называется **assemblyIdentity** -контекстом для манифеста сборки.

Как первый подэлемент элемента **dependentAssembly** , **assemblyIdentity** описывает и уникально идентифицирует параллельную сборку, используемую в **теге**"DEF-контекст". Это называется **assemblyIdentity** -ключевым словом в манифесте сборки. Сборка в DEF-контексте требует правильной работы сборки REF-context. Обратите внимание, что каждый **ASSEMBLYIDENTITY** ref-context должен точно соответствовать соответствующему **теге** DEF в манифесте сборки, на которую указывает ссылка.

Этот элемент не содержит вложенных элементов. Элемент **assemblyIdentity** имеет следующие атрибуты.



| attribute                 | Описание                                                                                                                                                                                                                                                                                                                                                                                                                               |
|---------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **type**                  | Указывает тип сборки. Значение должно быть в виде Win32 и в нижнем регистре. Обязательный.                                                                                                                                                                                                                                                                                                                                                         |
| **name**                  | Уникально именует сборку. Используйте следующий формат для имени сборки: Organization.Division.Name. Например, Microsoft. Windows. мисамплеасм. Обязательный. Обратите внимание, что в случае DLL, упакованной в виде закрытой сборки с отдельным файлом манифеста, имя сборки должно отличаться от имени библиотеки DLL и манифеста.<br/>                                                                              |
| **language**              | Определяет язык сборки. Необязательный элемент. Если сборка зависит от языка, укажите код языка DHTML. В **теге** "DEF-контекст" манифеста сборки, предназначенного для международных использования (не зависящий от языка), не указывайте атрибут Language.<br/> В **ТЕГЕ** ref-context манифеста сборки, предназначенного для международных использования (нейтральный к языку), задайте для параметра Language значение " \* ".<br/> |
| **processorArchitecture** | Указывает процессор. допустимые значения — x86 для 32-разрядных Windows и ia64 для 64-разрядной Windows. Необязательный элемент.                                                                                                                                                                                                                                                                                                                               |
| **version**               | Указывает версию сборки. Используйте формат версии из четырех частей: оближешь. nnnnn. ууо. ппппп. Каждая из частей, разделенных точками, может быть 0-65535 включительно. Дополнительные сведения см. в разделе [версии сборки](assembly-versions.md). Обязательный.                                                                                                                                                                                               |
| **publicKeyToken**        | 16-символьная шестнадцатеричная строка, представляющая последние 8 байт хэша SHA-1 открытого ключа, для которого подписана сборка. Открытый ключ, используемый для подписи каталога, должен иметь длину 2048 бит или более. Требуется для общих параллельных сборок.                                                                                                                                                                                |



 

</dd> <dt>

<span id="dependency"></span><span id="DEPENDENCY"></span>**зависимостей**
</dt> <dd>

Контейнерный элемент, включающий по крайней мере один объект **dependentAssembly**. Первый подэлемент должен быть элементом **dependentAssembly** . У **зависимости** нет атрибутов. Необязательный элемент.

</dd> <dt>

<span id="dependentAssembly"></span><span id="dependentassembly"></span><span id="DEPENDENTASSEMBLY"></span>**dependentAssembly**
</dt> <dd>

Первый подэлемент должен быть элементом **assemblyIdentity** , который описывает и однозначно определяет параллельную сборку, используемую параллельной сборкой, которой принадлежит манифест сборки. Каждое **dependentAssembly** должно находиться внутри только одной **зависимости**. Необязательный элемент.

</dd> <dt>

<span id="file"></span><span id="FILE"></span>**File**
</dt> <dd>

Содержит файлы, используемые параллельной сборкой. Содержит вложенные элементы **comClass**, **typelib**, **виндовкласс** и **коминтерфацепроксистуб** . Необязательный элемент.

Элемент **File** имеет следующие атрибуты.



| attribute   | Описание                                                                                             |
|-------------|---------------------------------------------------------------------------------------------------------|
| **name**    | Имя файла, например Conctl32.dll.                                                            |
| **hashAlg** | Алгоритм, используемый для создания хэша файла. Это значение должно быть SHA1.                                 |
| **hash**    | Хэш файла, на который ссылается имя. Шестнадцатеричная строка длины в зависимости от хэш-алгоритма. |



 

</dd> <dt>

<span id="comClass"></span><span id="comclass"></span><span id="COMCLASS"></span>**comClass**
</dt> <dd>

Вложенный элемент элемента **File** . Необязательный элемент.

Элемент **comClass** имеет следующие атрибуты.



| attribute               | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|-------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **description**         | Имя класса.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **этому**               | Идентификатор GUID, однозначно определяющий класс. Обязательный. Значение должно быть в формате допустимого GUID.                                                                                                                                                                                                                                                                                                                                                                                                                             |
| **threadingModel**      | Потоковая модель, используемая внутрипроцессный COM-классами. Если это свойство имеет значение null, то модель потоков не используется. Компонент создается в основном потоке клиента, а вызовы из других потоков маршалируются в этот поток. Необязательный элемент. Допустимые значения: «апартамент», «Free», «Both» и «Neutral».                                                                                                                                                                                                                         |
| **tlbid**               | Идентификатор GUID для библиотеки типов для этого COM-компонента. Значение должно быть в формате GUID. Необязательный элемент.                                                                                                                                                                                                                                                                                                                                                                                                                              |
| **ID**              | Программный идентификатор, зависящий от версии, связанный с COM-компонентом. Формат ProgID — <*поставщик*>. <*компонент*>. <*версии*>.                                                                                                                                                                                                                                                                                                                                                                      |
| **мискстатус**          | Дублирует в манифесте сборки сведения, предоставленные ключом реестра Мискстатус. Если значения для атрибутов **мискстатусикон**, **мискстатусконтент**, **мискстатусдокпринт** или **мискстатуссумбнаил** не найдены, то соответствующее значение по умолчанию, указанное в **мискстатус** , используется для отсутствующих атрибутов. Значением может быть список значений атрибутов, разделенных запятыми, из таблицы ниже. Этот атрибут можно использовать, если класс COM является классом OCX, требующим значения раздела реестра Мискстатус. |
| **мискстатусикон**      | Дублирует в манифесте сборки сведения, предоставленные \_ значком дваспект. Он может предоставить значок объекта. Значением может быть список значений атрибутов, разделенных запятыми, из таблицы ниже. Этот атрибут можно использовать, если класс COM является классом OCX, требующим значения раздела реестра Мискстатус.                                                                                                                                                                                                                |
| **мискстатусконтент**   | Дублирует в манифесте сборки сведения, предоставленные \_ содержимым дваспект. Он может обеспечить возможность воспроизведения составного документа для экрана или принтера. Значением может быть список значений атрибутов, разделенных запятыми, из таблицы ниже. Этот атрибут можно использовать, если класс COM является классом OCX, требующим значения раздела реестра Мискстатус.                                                                                                                                                                          |
| **мискстатусдокпринт**  | Дублирует в манифесте сборки сведения, предоставленные ДВАСПЕКТ \_ докпринт. Он может предоставлять представление объекта на экране, как будто печатается на принтере. Значением может быть список значений атрибутов, разделенных запятыми, из таблицы ниже. Этот атрибут можно использовать, если класс COM является классом OCX, требующим значения раздела реестра Мискстатус.                                                                                                                                               |
| **мискстатуссумбнаил** | Дублирует в манифесте сборки сведения, предоставленные \_ эскизом дваспект. Он может предоставить эскиз объекта для воспроизведения в средстве просмотра. Значением может быть список значений атрибутов, разделенных запятыми, из таблицы ниже. Этот атрибут можно использовать, если класс COM является классом OCX, требующим значения раздела реестра Мискстатус.                                                                                                                                                                         |



 

У элемента **comClass** могут быть &lt; &gt; элементы ProgID... в </progid> качестве дочерних элементов, в которых перечислены зависимые от версии идентификаторы ProgID.

В следующем примере показан элемент **comClass** , входящий в **Файловый** элемент.

``` syntax
<file name="sampleu.dll">
        <comClass description="Font Property Page"
    clsid="{0BE35200-8F91-11CE-9DE3-00AA004BB851}"
          threadingModel = "Both"
             tlbid = "{44EC0535-400F-11D0-9DCD-00A0C90391D3}"/>
        <comClass description="Color Property Page"
    clsid="{0BE35201-8F91-11CE-9DE3-00AA004BB851}" 
    progid="ABC.Registrar"/>
    </file>
```

Если класс COM является классом OCX, который требует наличия подраздела реестра Мискстатус для указания способа создания и отображения объекта, можно включить объект, скопировав эту информацию в манифест сборки. Укажите характеристики объекта с помощью атрибутов **мискстатус**, **мискстатусикон**, **мискстатусконтент**, **мискстатусдокпринт** и **мискстатуссумбнаил** элемента **comClass** . Задайте для этих атрибутов разделенный запятыми список значений атрибутов из следующей таблицы. Эти атрибуты дублируют данные, предоставляемые перечислением ДВАСПЕКТ. Если значение для **мискстатусикон**, **мискстатусконтент**, **мискстатусдокпринт** или **мискстатуссумбнаил** не найдено, используется значение по умолчанию, заданное в **мискстатус** . Используйте значения атрибутов из следующей таблицы. Они соответствуют битовым флагам перечисления [**олемиск**](/windows/win32/api/oleidl/ne-oleidl-olemisc) .



| Значение атрибута              | Константа ОЛЕМИСК                      |
|------------------------------|---------------------------------------|
| рекомпосеонресизе            | ОЛЕМИСК \_ рекомпосеонресизе            |
| онликоник                   | ОЛЕМИСК \_ онликоник                   |
| инсертнотреплаце             | ОЛЕМИСК \_ инсертнотреплаце             |
| static                       | ОЛЕМИСК \_ статический                       |
| кантлинкинсиде               | ОЛЕМИСК \_ кантлинкинсиде               |
| canlinkbyole1                | ОЛЕМИСК \_ CANLINKBYOLE1                |
| ислинкобжект                 | ОЛЕМИСК \_ ислинкобжект                 |
| некоторая сторона                    | ОЛЕМИСК \_                    |
| активатевхенвисибле          | ОЛЕМИСК \_ активатевхенвисибле          |
| рендерингисдевицеиндепендент | ОЛЕМИСК \_ рендерингисдевицеиндепендент |
| инвисиблеатрунтиме           | ОЛЕМИСК \_ инвисиблеатрунтиме           |
| алвайсрун                    | ОЛЕМИСК \_ алвайсрун                    |
| актсликебуттон               | ОЛЕМИСК \_ актсликебуттон               |
| актсликелабел                | ОЛЕМИСК \_ актсликелабел                |
| науиактивате                 | ОЛЕМИСК \_ науиактивате                 |
| с выровняйтем                    | ОЛЕМИСК, \_ выровняйте                    |
| симплефраме                  | ОЛЕМИСК \_ симплефраме                  |
| сетклиентситефирст           | ОЛЕМИСК \_ сетклиентситефирст           |
| ImeMode                      | ТОЛЕМИСК \_ IMEMODE                     |
| игнореативатевхенвисибле     | ОЛЕМИСК \_ игнореактиватевхенвисибле    |
| вантстоменумерже             | ОЛЕМИСК \_ вантстоменумерже             |
| суппортсмултилевелундо       | ОЛЕМИСК \_ суппортсмултилевелундо       |



 

</dd> <dt>

<span id="typelib"></span><span id="TYPELIB"></span>**Экспорт Typelib**
</dt> <dd>

Вложенный элемент элемента **File** . Необязательный элемент.

Элемент **typelib** содержит атрибуты, приведенные в следующей таблице.



| attribute      | Описание                                                                                                                                                                                                                                                                                                                                                                                                                     |
|----------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **tlbid**      | Уникальный идентификатор библиотеки типов. Обязательный.                                                                                                                                                                                                                                                                                                                                                                                    |
| **version**    | Номер версии из двух частей библиотеки типов. При увеличении только дополнительного номера версии все функции предыдущей библиотеки типов поддерживаются совместимым образом. При изменении основного номера версии код, скомпилированный для библиотеки типов, должен быть повторно скомпилирован. Номер версии библиотеки типов может отличаться от номера версии приложения. Обязательный.                                      |
| **хелпдир**    | Каталог, в котором находится файл справки для типов в библиотеке типов. Если приложение поддерживает библиотеки типов для нескольких языков, библиотеки могут ссылаться на разные имена файлов в каталоге файлов справки. Если значение не указано, укажите "". Обязательный.                                                                                                                                                          |
| **идентификатора** | Шестнадцатеричное строковое представление идентификатора локали (LCID). Это одна или четыре шестнадцатеричные цифры без префикса 0x и начальные нули. Код языка (LCID) может иметь нейтральный идентификатор языка. Дополнительные сведения см. в разделе [идентификаторы языкового стандарта](/windows/desktop/Intl/locale-identifiers). Необязательный элемент.                                                                                                                                      |
| **flags**      | Строковое представление флагов библиотеки типов для этой библиотеки типов. В частности, это должен быть один из элементов "Restricted", "CONTROL", "HIDDEN" и "ХАСДИСКИМАЖЕ". Это значения перечисления [**либфлагс**](/windows/win32/api/oaidl/ne-oaidl-libflags) , которые являются одними и теми же флагами, указанными в параметре *улибфлагс* метода [**икреатетипелиб:: сетлибфлагс**](/windows/win32/api/oaidl/nf-oaidl-icreatetypelib-setlibflags) . Необязательный элемент. |



 

В следующем примере показан элемент **typelib** , входящий в **Файловый** элемент.

``` syntax
<file name="sampleu.dll">
       <typelib tlbid="{44EC0535-400F-11D0-9DCD-00A0C90391D3}"
       version="1.0" helpdir=""/>
</file>
```

</dd> <dt>

<span id="comInterfaceExternalProxyStub"></span><span id="cominterfaceexternalproxystub"></span><span id="COMINTERFACEEXTERNALPROXYSTUB"></span>**коминтерфацеекстерналпроксистуб**
</dt> <dd>

**Коминтерфацеекстерналпроксистуб** является вложенным элементом элемента **Assembly** и используется для интерфейсов автоматизации. Например, [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) и его производные интерфейсы. Необязательный элемент.

Реализация заглушки прокси-сервера по умолчанию подходит для большинства интерфейсов автоматизации, таких как интерфейсы, производные от [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch). Заглушка прокси-сервера интерфейса и все остальные реализации интерфейса-заглушки прокси-сервера должны быть перечислены в **коминтерфацеекстерналпроксистуб**. Элемент **коминтерфацеекстерналпроксистуб** содержит атрибуты, приведенные в следующей таблице.



| attribute         | Описание                                                                                                                                                                                 |
|-------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **IID**           | Идентификатор IID интерфейса, для которого объявляется прокси. Обязательный. Значение должно иметь вид: "{IID}".                                                                         |
| **baseInterface** | Идентификатор IID интерфейса, из которого производятся атрибуты, описанные атрибутом **IID** . Этот атрибут является необязательным. Значение должно иметь вид: "{IID}".                            |
| **нуммесодс**    | Число методов, реализованных интерфейсом. Этот атрибут является необязательным. Значение должно иметь вид: "n".                                                                       |
| **name**          | Имя интерфейса, которое будет отображаться в коде. Например, "Ивиевобжект". Это не должна быть описательная строка. Этот атрибут является необязательным. Значение должно иметь вид: "имя". |
| **tlbid**         | Библиотека типов, содержащая описание интерфейса, указанного атрибутом **IID** . Этот атрибут является необязательным. Значение должно иметь вид: "{тлбид}".                |
| proxyStubClsid32  | Карты идентификатор IID для идентификатора CLSID в 32-разрядных прокси-библиотеках.                                                                                                                                                |



 

В следующем примере показан элемент **коминтерфацеекстерналпроксистуб** .

``` syntax
<comInterfaceExternalProxyStub 
  name="IAxWinAmbientDispatch" 
    iid="{B6EA2051-048A-11D1-82B9-00C04FB9942E}" 
    numMethods="35" 
  baseInterface="{00000000-0000-0000-C000-000000000046}"/>
```

</dd> <dt>

<span id="comInterfaceProxyStub"></span><span id="cominterfaceproxystub"></span><span id="COMINTERFACEPROXYSTUB"></span>**коминтерфацепроксистуб**
</dt> <dd>

Вложенный элемент элемента **File** . Необязательный элемент.

Если файл в сборке реализует прокси-заглушку, соответствующий тег файла должен содержать вложенный элемент **коминтерфацепроксистуб** с атрибутами, идентичными элементу **коминтерфацепроксистуб** . Упаковка интерфейсов между процессами и потоками может не работать должным образом, если пропущены некоторые зависимости **коминтерфацепроксистуб** для компонента.

Элемент **коминтерфацепроксистуб** имеет следующие атрибуты.



| attribute            | Описание                                                                                                                                                                                                                                                                                                 |
|----------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **IID**              | Тот. IID интерфейса, для которого объявляется прокси. Обязательный. Значение должно иметь вид: "{IID}".                                                                                                                                                                                        |
| **name**             | Имя интерфейса, которое будет отображаться в коде. Например, "Ивиевобжект". Это не должна быть описательная строка. Этот атрибут является необязательным. Значение должно иметь вид: "имя".                                                                                                                 |
| **tlbid**            | Библиотека типов, содержащая описание интерфейса, указанного атрибутом **IID** . Этот атрибут является необязательным. Значение должно иметь вид: "{тлбид}".                                                                                                                                 |
| **baseInterface**    | Идентификатор IID интерфейса, из которого производятся атрибуты, описанные атрибутом **IID** . Этот атрибут является необязательным. Значение должно иметь вид: "{IID}".                                                                                                                                            |
| **нуммесодс**       | Число методов, реализованных интерфейсом. Этот атрибут является необязательным. Значение должно иметь вид: "n".                                                                                                                                                                                       |
| **proxyStubClsid32** | Карты идентификатор IID для идентификатора CLSID в 32-разрядных прокси-библиотеках.                                                                                                                                                                                                                                                                |
| **threadingModel**   | Потоковая модель, используемая внутрипроцессный COM-классами. Если это свойство имеет значение null, то модель потоков не используется. Компонент создается в основном потоке клиента, а вызовы из других потоков маршалируются в этот поток. Необязательный элемент. Допустимые значения: «апартамент», «Free», «Both» и «Neutral». |



 

</dd> <dt>

<span id="windowclass"></span><span id="WINDOWCLASS"></span>**виндовкласс**
</dt> <dd>

Имя класса Windows, для которого необходимо указать версию. Элемент **виндовкласс** имеет следующий атрибут.



| attribute     | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|---------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **версиями** | Этот атрибут определяет, содержит ли внутреннее имя класса окна, используемое при регистрации, версию сборки, содержащей класс окна. Значение этого атрибута может быть "Yes" или "No". Значение по умолчанию — Yes. Значение "No" следует использовать только в том случае, если один и тот же класс окна определен параллельным компонентом и эквивалентным непараллельным компонентом, и вы хотите обрабатывать их как один и тот же класс окна. Обратите внимание, что обычные правила регистрации класса окна применяются только к первому компоненту, который регистрирует класс окна, и может зарегистрировать его, так как он не имеет версию. |



 

В следующем примере показан элемент **виндовкласс** , входящий в **Файловый** элемент.

``` syntax
<file name="comctl32.dll">
        <windowClass versioned="no">ToolbarWindow32</windowClass>
</file>
```

</dd> </dl>

## <a name="example"></a>Пример

Ниже приведен пример манифеста сборки.

``` syntax
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<assembly xmlns="urn:schemas-microsoft-com:asm.v1" 
manifestVersion="1.0">
    <assemblyIdentity type="win32" name="Microsoft.Tools.SampleAssembly" version="6.0.0.0" processorArchitecture="x86" publicKeyToken="0000000000000000"/>
    <file name="sampleu.dll" hash="3eab067f82504bf271ed38112a4ccdf46094eb5a" hashalg="SHA1">
        <comClass description="Font Property Page" clsid="{0BE35200-8F91-11CE-9DE3-00AA004BB851}"/>
        <comClass description="Color Property Page" clsid="{0BE35201-8F91-11CE-9DE3-00AA004BB851}"/>
        <comClass description="Picture Property Page" clsid="{0BE35202-8F91-11CE-9DE3-00AA004BB851}"/>
    </file>
    <file name="bar.dll" hash="ac72753e5bb20446d88a48c8f0aaae769a962338" hashalg="SHA1"/>
    <file name="foo.dll" hash="a7312a1f6cfb46433001e0540458de60adcd5ec5" hashalg="SHA1">
        <comClass description="Registrar Class" clsid="{44EC053A-400F-11D0-9DCD-00A0C90391D3}" progid="ATL.Registrar"/>
    <comInterfaceProxyStub iid="{B6EA2051-048A-11D1-82B9-00C04FB9942E}" name=" IAxWinAmbientDispatch " tlbid="{34EC053A-400F-11D0-9DCD-00A0C90391D3}"/>
        <typelib tlbid="{44EC0535-400F-11D0-9DCD-00A0C90391D3}" version="1.0" helpdir=""/>
    </file>
    <file name="sampledll.dll" hash="ba62960ceb15073d2598379307aad84f3a73dfcb" hashalg="SHA1"/>
<windowClass>ToolbarWindow32</windowClass>
        <windowClass>ComboBoxEx32</windowClass>
        <windowClass>sample_trackbar32</windowClass>
        <windowClass>sample_updown32</windowClass>
</assembly>
```

 

