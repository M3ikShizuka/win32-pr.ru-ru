---
description: Указание контекста активации по умолчанию
ms.assetid: 4d9a8552-7098-458d-a592-45524871cce5
title: Указание контекста активации по умолчанию
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4d1598e0a111b358a783b940a5c036d63eef348740ff2467d3ed78720c6a5210
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119977144"
---
# <a name="specifying-a-default-activation-context"></a>Указание контекста активации по умолчанию

когда приложение или компонент создает новый процесс, Windows выполняет поиск манифеста приложения по умолчанию. Обратите внимание, что манифест, входящий в состав приложения в качестве ресурса, имеет приоритет над внешним манифестом. Контекст активации по умолчанию — это первый контекст активации, который активен до активации любого другого контекста активации. Этот контекст активации всегда активен, если не активировать другие контексты. Если \_ \_ во время компиляции приложения или компонента вы определили поддержку режима изоляции, то такие вызовы, как [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance), [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya)и [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa) , могут выполнять автоматическое управление контекстом.

Загрузчик позволяет приложению указать контекст активации по умолчанию двумя методами. Файл манифеста можно разместить в ресурсах исполняемого файла, и загрузчик обнаружит его. Это аналогично размещению файла манифеста в таблице ресурсов исполняемого объекта. Манифест можно поместить в файл с именем *Myapp*.exe. Манифест в том же каталоге, что и *Myapp*.exe, и загрузчик находит его при поиске.exe *MyApp* .

Если ни один из этих методов не используется, приложение запускается с системным контекстом активации по умолчанию, который содержит минимальный набор сборок.

Лучший способ использования автоматического управления контекстом — это компиляция приложения с \_ \_ включенной поддержкой режима изоляции. Рекомендуется задать это значение в командной строке компилятора для всего создаваемого проекта, а не задавать в отдельных исходных файлах или заголовках. Это делает большинство интерфейсов API Win32 осведомленными о контекстах активации и способах управления ими. Вместо того, чтобы выполнять собственное управление контекстами активации, нужно просто поместить манифест в таблицу ресурсов с идентификатором ресурса ИСОЛАТИОНАВАРЕ \_ манифеста Resource ID \_ \_ (числовое значение 2) типа "Манифест RT" \_ (числовое значение 24). Затем такие функции, как [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa), [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance)и [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) , автоматически активируют этот контекст перед выполнением фактического вызова.

Обратите внимание, что при компиляции \_ с \_ включенной поддержкой режима изоляции нельзя также выполнять собственное управление контекстом активации. если \_ \_ включена поддержка режима изоляции, Windows игнорирует любой контекст динамической активации, который приложение может попытаться выполнить между вызовами [**активатеакткткс**](/windows/desktop/api/Winbase/nf-winbase-activateactctx) и [**CreateWindow**](/windows/win32/api/winuser/nf-winuser-createwindowa) . Это означает, что если приложение использует режим \_ поддержки изоляции, \_ необходимо убедиться, что манифест содержит полный список всех сборок, необходимых для компонента.

 

 
