---
description: Если изолированное приложение задает зависимость сборки, параллельный поиск сборки между общими сборками в папке WinSxS.
ms.assetid: 93496631-55cc-4dd9-9a51-b748c35fd477
title: Последовательность поиска сборок
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dc689ecb14c55f0e8a609c7e7497fce969e88b8e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104081020"
---
# <a name="assembly-searching-sequence"></a>Последовательность поиска сборок

Если изолированное приложение задает зависимость сборки, параллельный поиск сборки между [общими сборками](/windows/desktop/Msi/shared-assemblies) в папке WinSxS. Если требуемая сборка не найдена, то параллельно выполняет поиск закрытой сборки, установленной в папке структуры каталогов приложения.

[Закрытые сборки](/windows/desktop/Msi/private-assemblies) могут быть развернуты в следующих расположениях в структуре каталогов приложения:

-   В папке приложения. Как правило, это папка, содержащая исполняемый файл приложения.
-   Во вложенную папку в папке приложения. Имя вложенной папки должно совпадать с именем сборки.
-   В папке приложения, зависящей от языка. Имя вложенной папки представляет собой строку кодов языка DHTML, указывающих языковой язык и региональные параметры или язык.
-   Во вложенной папке вложенной папки для конкретного языка в папку приложения. Имя более поздней вложенной папки — это строка кодов языка DHTML, указывающая языковой языковой стандарт или язык. Более глубокая вложенная папка имеет то же имя, что и сборка.

При первом параллельном поиске закрытой сборки он определяет, существует ли в структуре каталогов приложения вложенная папка конкретного языка. Если вложенная папка для конкретного языка не существует, параллельный поиск закрытой сборки в следующих расположениях с использованием следующей последовательности.

1.  Параллельный поиск выполняется в папке WinSxS.
2.  \\\\< > \\ appdir < *имя сборки* # C0.DLL
3.  \\\\< > \\ appdir < *имя сборки*>. manifest
4.  \\\\< > \\ appdir < *имя* > \\ сборки < *имя сборки* # C0.DLL
5.  \\\\< > \\ appdir < *имя* > \\ сборки < *имя сборки*>. manifest

Если существует вложенная папка для конкретного языка, структура каталогов приложения может содержать закрытую сборку, локализованную на нескольких языках. Параллельный поиск в вложенных папках, относящихся к конкретному языку, чтобы убедиться, что приложение использует указанный язык или лучший доступный язык. Имена вложенных папок, зависящих от языка, задаются с помощью строки кодов языка DHTML, задающих язык и региональные параметры или язык. Если вложенная папка для конкретного языка существует, параллельный поиск закрытой сборки в следующих расположениях с использованием следующей последовательности.

1.  Параллельный поиск выполняется в папке WinSxS.
2.  \\\\< > \\ appdir < *язык — язык и региональные параметры* > \\ < *имя сборки* # C0.DLL
3.  \\\\< > \\ appdir < *язык — язык и региональные параметры* > \\ < *имя сборки*>. manifest
4.  \\\\< > \\ appdir < *язык — язык и региональные параметры* > \\ < *имя* > \\ сборки < *имя сборки* # C0.DLL
5.  \\\\< > \\ appdir < *язык — язык и региональные параметры* > \\ < *имя* > \\ сборки < *имя сборки*>. manifest

Обратите внимание, что параллельная последовательность поиска находит DLL-файл с именем сборки и останавливается перед поиском файла манифеста с именем сборки. Для работы с закрытой сборкой, которая является библиотекой DLL, рекомендуется разместить манифест сборки в файле DLL как ресурс. Идентификатор ресурса должен быть равен 1, а имя закрытой сборки может совпадать с именем библиотеки DLL. Например, если имя библиотеки DLL MICROSOFT.WINDOWS.MYSAMPLE.DLL, то значение атрибута Name, используемое в элементе **assemblyIdentity** манифеста сборки, также может быть Microsoft. Windows. MySample. В качестве альтернативы можно разместить манифест сборки в отдельном файле, однако имя сборки и ее манифеста должны отличаться от имени библиотеки DLL. Например, Microsoft. Windows. Мисамплеасм, Microsoft. Windows. Мисамплеасм. manifest и MICROSOFT.WINDOWS.MYSAMPLE.DLL.

Например, если программа MyApp установлена в корне диска c: и требует мясм в французском (Бельгия), параллельно использует следующую последовательность для поиска наилучшего приближения к локализованному экземпляру мясм.

1.  Параллельные поиски в WinSxS для fr-Version.
2.  c: \\ MyApp \\ fr — \\myasm.dll
3.  c: \\ MyApp \\ fr — \\ мясм. manifest
4.  c: \\ MyApp \\ fr — \\ мясм \\myasm.dll
5.  c: \\ MyApp \\ fr — \\ мясм \\ мясм. manifest
6.  Параллельный поиск в WinSxS для версии fr.
7.  c: \\ MyApp \\ fr \\myasm.dll
8.  c: \\ MyApp \\ fr \\ мясм. manifest
9.  c: \\ MyApp \\ fr \\ мясм \\myasm.dll
10. c: \\ MyApp \\ fr \\ мясм \\ мясм. manifest
11. Параллельный поиск в WinSxS для версии en-US.
12. c: \\ MyApp \\ en-US \\myasm.dll
13. c: \\ MyApp \\ en-US \\ мясм. manifest
14. c: \\ MyApp \\ en-us \\ мясм \\myasm.dll
15. c: \\ MyApp \\ en-US \\ мясм \\ мясм. manifest
16. Параллельный поиск в WinSxS для версии EN.
17. c: \\ MyApp \\ en \\myasm.dll
18. c: \\ MyApp \\ en \\ мясм. manifest
19. c: \\ MyApp \\ en \\ мясм \\myasm.dll
20. c: \\ MyApp \\ en \\ мясм \\ мясм. manifest
21. Параллельный поиск в WinSxS для версии без языка.
22. c: \\ myapp \\myasm.dll
23. c: \\ MyApp \\ мясм. manifest
24. c: \\ MyApp \\ мясм \\myasm.dll
25. c: \\ MyApp \\ мясм \\ мясм. manifest

Если параллельный поиск достигает версии сборки, не зависящей от языка, и в системе есть версия [многоязыкового пользовательского интерфейса (MUI)](/windows/desktop/Intl/multilingual-user-interface) Windows, то параллельная сборка пытается выполнить привязку к <*AssemblyName*>. MUI. Параллельная сборка не пытается выполнить привязку к <*assemblyname*>. MUI, если поиск достиг локализованной версии сборки. [Манифест сборки](assembly-manifests.md) нейтральной к языку сборки не будет иметь атрибут Language в элементе **assemblyIdentity** . Если параллельно достигает сборки, не зависящей от языка, и установлен MUI, параллельный поиск выполняется в следующих расположениях с использованием следующей последовательности для <*assemblyname*>. MUI. Параллельно использует одну и ту же последовательность поиска, если сборка не зависит от языка и региональных параметров, за исключением <*язык*> не выполняет поиск.

1.  Параллельно Поиск <*assemblyname*>. MUI в папке WinSxS.
2.  \\\\<*язык и региональные параметры* > \\ < языка пользователя *имя сборки*>. MUI
3.  \\\\<*язык* > \\ пользователя < *имя сборки*>. MUI
4.  \\\\<*язык и региональные параметры системы* > \\ < *имя сборки*>. MUI
5.  \\\\<*язык* > \\ системы < *имя сборки*>. MUI
6.  \\\\<*нет* > \\ языка < *имя сборки*>. MUI

Например, если параллельный поиск находит закрытую сборку на языке c: \\ MyApp \\ мясм \\ мясм. manifest, а мясм является независимой от языка сборкой. Параллельно использует следующую последовательность для поиска мясм. MUI. Обратите внимание, что параллельно не будет искать сборку MUI, не зависящую от языка.

1.  Параллельный поиск в WinSxS для версии сборки MUI на FR-версия.
2.  c: \\ MyApp \\ fr — \\myasm.mui.dll
3.  c: \\ MyApp \\ fr — \\ мясм. MUI. manifest
4.  c: \\ MyApp \\ fr — \\ мясм \\myasm.mui.dll
5.  c: \\ MyApp \\ fr — \\ мясм \\ мясм. MUI. manifest
6.  Параллельный поиск в WinSxS для версии fr сборки MUI.
7.  c: \\ MyApp \\ fr \\myasm.mui.dll
8.  c: \\ MyApp \\ fr \\ мясм. MUI. manifest
9.  c: \\ MyApp \\ fr \\ мясм \\myasm.mui.dll
10. c: \\ MyApp \\ fr \\ мясм \\ мясм. MUI. manifest
11. Параллельный поиск в WinSxS для версии сборки MUI en-US.
12. c: \\ MyApp \\ en-US \\myasm.mui.dll
13. c: \\ MyApp \\ en-US \\ мясм. MUI. manifest
14. c: \\ MyApp \\ en-us \\ мясм \\myasm.mui.dll
15. c: \\ MyApp \\ en-US \\ мясм \\ мясм. MUI. manifest
16. Параллельный поиск в WinSxS для версии многоязычной сборки MUI.
17. c: \\ MyApp \\ en \\myasm.mui.dll
18. c: \\ MyApp \\ en \\ мясм. MUI. manifest
19. c: \\ MyApp \\ en \\ мясм \\myasm.mui.dll
20. c: \\ MyApp \\ en \\ мясм \\ мясм. MUI. manifest

 

 
