---
description: При условии, что система определяет активность пользователя или приложения, она не будет переходить в спящий режим.
ms.assetid: 83c9394a-1813-405a-802a-0623e5de50d3
title: Критерии спящего режима системы
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9b93b0eb1a55d156a9d75b51ef826c85eabd28b29789cf50bb7f0fd7b5fee90a
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "120032824"
---
# <a name="system-sleep-criteria"></a>Критерии спящего режима системы

При условии, что система определяет активность пользователя или приложения, она не будет переходить в спящий режим. Система может обнаруживать определенные действия, такие как ввод данных пользователем или сетевая связь. Однако существуют и другие действия, которые система не может обнаружить. Например, приложение презентации требует отображения экрана. Однако может показаться, что приложение бездействует во время презентации, что приводит к выключению экрана.

Чтобы уведомить систему о том, что приложение занято, используйте функцию [**SetThreadExecutionState**](/windows/desktop/api/Winbase/nf-winbase-setthreadexecutionstate) . Эта функция предотвращает переход системы в спящий режим или отключение дисплея во время работы приложения.

Приложения для представления и мультимедиа должны вызывать функцию [**SetThreadExecutionState**](/windows/desktop/api/Winbase/nf-winbase-setthreadexecutionstate) с параметром ES, чтобы система могла убедиться в том, что не следует переводить устройство отображения в спящий режим. **\_ \_** Приложения обработки событий, такие как средства для управления входящими факсами, должны вызывать **SetThreadExecutionState** с **\_ системой ES \_**, обрабатывать событие, а затем очищать флаг, чтобы система могла вернуться в спящий режим. Обратите внимание, что большинству приложений для повышения производительности не требуется использовать **SetThreadExecutionState** , так как система может обычно определять действия путем ввода данных пользователем.

Чтобы сохранить время с момента последнего ввода данных пользователем, система использует таймер простоя экрана и таймер простоя системы. Система сравнивает неактивные таймеры со значениями, настроенными в схеме управления питанием. Если значение таймера "Отображение" в режиме простоя больше, чем значение времени ожидания, и ни один из потоков не запросил отображение, вызвав [**SetThreadExecutionState**](/windows/desktop/api/Winbase/nf-winbase-setthreadexecutionstate) с параметром " **\_ Показать не \_ требуется**", система выключает экран. Аналогично, если таймер простоя системы превышает значение времени ожидания системы, а приложения не запрашивают систему путем вызова **SetThreadExecutionState** с помощью **\_ системы ES \_**, система переходит в спящий режим.

Система поддерживает число приложений с именем [**SetThreadExecutionState**](/windows/desktop/api/Winbase/nf-winbase-setthreadexecutionstate). Система отслеживает каждый поток, который вызывает **SetThreadExecutionState** , и соответствующим образом корректирует счетчик. Если этот счетчик достигнет нуля и входные данные не были введены пользователем, система переходит в спящий режим.

Если уровень питания низкий, приложение может запросить вмешательство пользователя или запросить, что система приостанавливает работу. Можно приостановить работу системы с помощью функции [**сетсуспендстате**](/windows/desktop/api/PowrProf/nf-powrprof-setsuspendstate) .

Если система автоматически пробуждается ([ПБТ \_ апмресумеаутоматик](pbt-apmresumeautomatic.md)), ни один из таймеров не важен. Дополнительные сведения см. в разделе [системные события пробуждения](system-wake-up-events.md).

## <a name="entering-sleep"></a>Переход в спящий режим

Когда система переходит в спящий режим, она автоматически сохраняет состояние всей системы и всех приложений. Поэтому большинству приложений не нужно предпринимать никаких специальных действий. Приложения, которым необходимо выполнять определенные действия до того, как системные переходы могут зарегистрироваться для включения событий питания.

Когда система отправляет событие [ПБТ \_ апмсуспенд](pbt-apmsuspend.md) , у каждого приложения есть две секунды для выполнения необходимых действий до того, как система начнет переход в спящий режим. Приложения должны ограничить действия, которые они принимают в ответ на это событие, чтобы убедиться, что они завершают все операции за отведенное время.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Сведения об управлении питанием](about-power-management.md)
</dt> <dt>

[События пробуждения системы](system-wake-up-events.md)
</dt> </dl>

 

 



