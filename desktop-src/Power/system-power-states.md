---
description: Для пользователя система может быть либо включена, либо выключена.
ms.assetid: 3d897a88-125e-457f-9ea7-ac2056b0767a
title: Состояния питания системы
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2eb93931326b67c7469b6a8ae256892e2dd77d4b
ms.sourcegitcommit: 9b5faa61c38b2d0c432b7f2dbee8c127b0e28a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2021
ms.locfileid: "122469911"
---
# <a name="system-power-states"></a>Состояния питания системы

Для пользователя система может быть либо включена, либо выключена. Другие обнаруживаемые состояния отсутствуют. Однако система поддерживает несколько состояний электропитания, которые соответствуют состояниям электропитания, заданным в спецификации расширенной конфигурации и интерфейса питания (ACPI). Существуют также разновидности этих состояний, например гибридный спящий режим и быстрый запуск. В этом разделе рассматриваются эти состояния и описывается их связь друг с другом.

> [!NOTE]
> Системные интеграторы и разработчики, создающие драйверы или приложения с системной службой, должны быть особенно осторожными к проблемам с качеством драйвера, например утечкам памяти. Хотя всегда было важно качество драйвера, время между перезагрузкой ядра может быть значительно длиннее, чем в предыдущих версиях ОС, поскольку при инициировании пользователем спящего режима и завершении работы ядро, драйверы и службы будут сохранены и восстановлены, а не запущены повторно.

 

В следующей таблице перечислены состояния питания ACPI от самого высокого до самого низкого энергопотребления.




| Состояние электропитания | Состояние ACPI | Описание | 
|-------------|------------|-------------|
| Выполняется операция<br /> | S0<br /> | Система полностью пригодна для использования. Аппаратные компоненты, которые не используются, могут сэкономить электроэнергию за счет пониженного энергопотребления.<br /> | 
| Сон<br /> (Современный ждущий режим)<br /> | Низкое энергопотребление S0<br /> | Некоторые системы SoC поддерживают состояние низкого энергосбережения, известное как <a href="/windows-hardware/design/device-experiences/modern-standby">современные ждущие режимы</a>. В этом состоянии система может быстро переключиться с низкого энергопотребления на режим высокой мощности, чтобы он мог быстро реагировать на события оборудования и сети. Системы, поддерживающие современные резервные, не используют S1-S3.<br /> | 
| Сон<br /> | S1<br /> S2<br /> S3<br /> | Вероятно, система отключена. Потребляемая мощность в этих штатах (S1-S3) меньше S0 и больше, чем S4; S3 потребляет меньше энергии, чем S2, и S2 потребляет меньше энергии, чем S1. Обычно системы поддерживают одно из этих трех состояний, а не все три.<br /> В этих состояниях (S1-S3) постоянно обновляется Энергозависимая память для поддержания состояния системы. Некоторые компоненты остаются включенными, поэтому компьютер может выходить из входных данных с клавиатуры, локальной сети или USB-устройства.<br /><em>Гибридный спящий режим</em>, используемый на настольных компьютерах, — это место, где система использует файл гибернации с S1-S3. Файл гибернации сохраняет состояние системы в случае, если система теряет питание в спящем режиме.<br /><blockquote>[!Note]<br />Системы SoC, поддерживающие современные резервные (состояния низкого энергопотребления), не используют S1-S3.</blockquote><br /><br /> | 
| Режим гибернации<br /> | S4<br /> | Вероятно, система отключена. Энергопотребление уменьшается до самого нижнего уровня. Система сохраняет содержимое энергозависимой памяти в файл гибернации для сохранения состояния системы. Некоторые компоненты остаются включенными, поэтому компьютер может выходить из входных данных с клавиатуры, локальной сети или USB-устройства. Рабочий контекст можно восстановить, если он хранится на незащищенном носителе. <br /><em>Быстрый запуск</em> — это место, где пользователь выходит из системы перед созданием файла спящего режима. Это позволяет сократить файл гибернации, что более подходит для систем с меньшими возможностями хранения.<br /> | 
| Мягкое отключение<br /> | S5<br /> | Вероятно, система отключена. Это состояние состоит из полного завершения работы и цикла загрузки.<br /> | 
| Механическое выключение<br /> | G3<br /> | Система полностью отключена и не потребляет электроэнергии. Система возвращается в рабочее состояние только после полной перезагрузки.<br /> | 




 

Перечисление [**\_ \_ состояния энергопотребления системы**](/windows/desktop/api/WinNT/ne-winnt-system_power_state) определяет значения, используемые для указания состояния питания системы.

## <a name="working-state-s0"></a>Рабочее состояние (S0)

Во время рабочего состояния система находится в спящем режиме и работает. Проще говоря, устройство "включено". Если экран включен или выключен, устройство находится в полном состоянии выполнения. Для экономии энергии, особенно на устройствах с питанием от аккумулятора, мы настоятельно рекомендуем выключить аппаратные компоненты, если они не используются.

> [!IMPORTANT]
> Выключите аппаратные компоненты, если они не используются, независимо от состояния. Низкое энергопотребление — важное замечание для потребителей мобильных устройств.

 

## <a name="sleep-state-modern-standby"></a>Состояние сна (современный ждущий режим)

В режиме низкого энергопотребления S0 в рабочем состоянии, которое также называется [современным ждущим](/windows-hardware/design/device-experiences/modern-standby)режимом, система остается частично работающей. В современных ждущих режимах система может оставаться в актуальном состоянии при каждом доступе к подходящей сети, а также при необходимости выполнять пробуждение, если требуется действие в реальном времени, например обслуживание ОС. Современные спящие функции выполняются значительно быстрее, чем S1-S3. Дополнительные сведения см. в статье [современные резервные](/windows-hardware/design/device-experiences/modern-standby).

> [!Note]  
> Современные ждущие режимы доступны только в некоторых системах SoC. Если она поддерживается, система не поддерживает S1-S3.

 

## <a name="sleep-state-s1-s3"></a>Состояние сна (S1 — S3)

система переходит в спящий режим на основе ряда критериев, включая действия пользователя или приложения, а также предпочтения, которые пользователь задает на странице **Параметры** приложения **Power &** . По умолчанию система использует состояние сна с наименьшим энергопотреблением, поддерживаемое всеми включенными устройствами пробуждения. Дополнительные сведения о том, как система определяет, когда следует переходить в спящий режим, см. в разделе [условия спящего режима системы](system-sleep-criteria.md).

Перед переходом системы в спящий режим он определяет соответствующее состояние сна, уведомляет приложения и драйверы ожидающего перехода, а затем переводит систему в состояние сна. В случае критического перехода, например при достижении порогового значения критического аккумулятора, система не уведомляет приложения и драйверы. Приложения должны быть подготовлены для этого и предпринять соответствующие действия при возврате системы в рабочее состояние.

В этих состояниях (S1-S3) постоянно обновляется Энергозависимая память для поддержания состояния системы. Некоторые компоненты остаются включенными, поэтому компьютер может выходить из входных данных с клавиатуры, локальной сети или USB-устройства.

Система также выходит из спящего режима в ответ на действия пользователя или событие пробуждения, определенное приложением. Дополнительные сведения см. в разделе [системные события пробуждения](system-wake-up-events.md). Время, необходимое для пробуждения системы, зависит от состояния сна, из которого он выходит из спящего режима. Система занимает больше времени для выхода из состояния с низким энергопотреблением (S3), чем из состояния с более высоким энергопотреблением (S1) из-за дополнительной работы, которую может потребоваться оборудование (стабилизация источника питания, повторная инициализация процессора и т. д.).

> [!Caution]  
> При вызове [**SetThreadExecutionState**](/windows/desktop/api/Winbase/nf-winbase-setthreadexecutionstate)значение параметра **ES AWAYMODE должно использоваться \_ \_** только в тех случаях, когда они совершенно необходимы приложениям мультимедиа, которым требуется система для выполнения фоновых задач, таких как запись содержимого телевизионных передач или потокового мультимедиа на другие устройства, пока система находится в спящем режиме. Приложения, не требующие критической фоновой обработки или выполняемые на переносных компьютерах, не должны включать режим отсутствия, так как не позволяет системе сэкономить электроэнергию, переходя в режим true Sleep.

 

### <a name="hybrid-sleep-s1-s3--hibernation-file"></a>Гибридный спящий режим (S1-S3 + файл гибернации)

*Гибридный спящий режим* — это специальное состояние, которое представляет собой сочетание состояний спящего режима и спящего режима, когда система использует файл гибернации с S1-S3. Он доступен только в некоторых системах. Если этот параметр включен, система записывает файл гибернации, но переходит в спящий режим с повышенным энергопотреблением. Если при переходе системы в спящий режим питание теряется, система выходит из спящего режима, что занимает больше времени, но восстанавливает состояние системы пользователя.

## <a name="hibernate-state-s4"></a>Состояние гибернации (S4)

Windows использует режим гибернации, чтобы обеспечить быстрый запуск. Если он доступен, он также используется на мобильных устройствах для продления времени работы батареи системы, предоставляя механизм сохранения всех состояний пользователей до завершения работы системы. При переходе в спящий режим все содержимое памяти записывается в файл на основном системном диске, *файле гибернации*. Это сохраняет состояние операционной системы, приложений и устройств. В случае, когда объем общей памяти потребляет всю физическую память, файл гибернации должен быть достаточно большим, чтобы гарантировать наличие места для сохранения всего содержимого физической памяти. Поскольку данные записываются в долговременное хранилище, DRAM не требуется поддерживать самообновление и могут быть выключены. Это означает, что энергопотребление режима гибернации очень низкий, почти так же, как питание выключено.

Во время полного завершения работы и загрузки (S5) весь сеанс пользователя уничтожается и перезапускается при следующей загрузке. В отличие от спящего режима (S4), сеанс пользователя закрывается и сохраняется состояние пользователя.

### <a name="fast-startup-reduced-hibernation-file"></a>Быстрый запуск (сокращенный файл гибернации)

*Быстрый запуск* — это тип завершения работы, который использует файл гибернации для ускорения последующей загрузки. Во время этого типа отключения пользователь выходит из системы перед созданием файла спящего режима. Быстрый запуск позволяет сократить файл гибернации, что более подходит для систем с меньшими возможностями хранения. Дополнительные сведения см. в разделе [типы файлов спящего режима](#hibernation-file-types).

При использовании быстрого запуска система отображается пользователю как при полном завершении работы (S5), даже несмотря на то, что система на самом деле прошла работу в режиме S4. Сюда входит, как система реагирует на сигналы пробуждения устройства.

Быстрый запуск — журналы сеансов пользователей, но содержимое ядра (сеанс 0) записывается на жесткий диск. Это обеспечивает более быструю загрузку.

Чтобы программно запустить быстрое завершение работы в стиле запуска, вызовите функцию [**инитиатешутдовн**](/windows/desktop/api/winreg/nf-winreg-initiateshutdowna) с флагом **\_ гибридного завершения работы** или функцией [**ExitWindowsEx**](/windows/desktop/api/winuser/nf-winuser-exitwindowsex) с флагом **\_ гибридного \_ завершения работы евкс** .

> [!Note]  
> начиная с Windows 8 быстрый запуск является переходом по умолчанию при запросе выключения системы. Полное завершение работы (S5) возникает при запросе перезагрузки системы (или при вызове приложением API завершения работы).

 

### <a name="entering-hibernation"></a>Переход в спящий режим

При выполнении запроса в спящий режим выполняются следующие шаги, когда система переходит в спящий режим:

1.  Уведомления о приложениях и службах
2.  Уведомления о драйверах
3.  Состояние пользователя и системы сохраняется на диске в сжатом формате
4.  Оповещение встроенного по

> [!Note]  
> начиная с Windows 8 все ядра системы используются для сжатия данных в памяти и записи на диск.

 

Чтобы программно запустить переход в спящий режим, вызовите функцию [**сетсуспендстате**](/windows/desktop/api/PowrProf/nf-powrprof-setsuspendstate) .

### <a name="resuming-from-hibernation"></a>Возобновление из спящего режима

При выходе системы из спящего режима.

При включении системы в процессе выхода из спящего режима выполняются следующие действия.

1.  Системная запись
2.  Системная память распаковывается и восстанавливается из файла гибернации
3.  Инициализация устройства
4.  Драйверы восстанавливаются до перехода в спящий режим.
5.  Службы восстанавливаются в состояние, в котором они находились до перехода в режим гибернации
6.  Система станет доступной для входа

Выход из спящего режима начинается с системного сообщения, похожего на завершение работы S5. Диспетчер загрузки ОС определяет, что требуется возобновление из спящего режима, выявляя допустимый файл гибернации. Затем она направляет систему к возобновлению, восстанавливая содержимое памяти и все регистры архитектуры. В случае выхода из спящего режима содержимое системной памяти считывается с диска, распаковывается и восстанавливается, что приводит систему в точное состояние, в котором она находилась в спящем режиме. После восстановления памяти устройства перезапускаются, а компьютер возвращается в состояние выполнения, готовое для входа.

> [!Note]  
> При выходе из спящего режима драйверы и службы получают уведомления, но не перезапускаются. Они восстанавливаются только в том состоянии, в котором они были до перехода в режим гибернации.

 

### <a name="hibernation-file-types"></a>Типы файлов спящего режима

Файлы гибернации используются для гибридного спящего режима, быстрого запуска и стандартного спящего режима (описан ранее). Существует два типа, отличающиеся по размеру, файлы спящего режима полного и уменьшенного размера. Сокращенный файл гибернации может использоваться только при быстром запуске.



| Тип файла спящего режима | Размер по умолчанию           | Поддерживает...                           |
|-----------------------|------------------------|---------------------------------------|
| Полное                  | 40% физической памяти | режим гибернации, гибридный спящий режим, быстрый запуск |
| XDR               | 20% физической памяти | Быстрый запуск                          |



 

Чтобы проверить или изменить тип используемого файла спящего режима, запустите служебную программу **powercfg.exe** . В следующих примерах показано, как это делать. Чтобы получить дополнительные сведения, запустите `powercfg /? hibernate`.



| Пример                                                                        | Описание                                                                                                                                                                                                                                                                                                                                                   |
|-------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `powercfg /a`<br/>                                                | **Проверьте тип файла спящего режима.** При использовании полного файла гибернации состояние "Гибернация" является доступным параметром. Если используется сокращенный файл гибернации, то результаты не будут поддерживаться в спящем режиме. Если в системе вообще нет файла спящего режима, результаты будут включены в спящий режим.<br/> |
| `powercfg /h /type full`<br/>                                     | **Измените тип файла спящего режима на полный.** Это не рекомендуется в системах с объемом памяти менее 32 ГБ.<br/>                                                                                                                                                                                                                        |
| `powercfg /h /type reduced`<br/>                                  | **Измените тип файла спящего режима на сокращенный.** Если команда возвращает «неверный параметр», см. Следующий пример.<br/>                                                                                                                                                                                                        |
| `powercfg /h /size 0`<br/> `powercfg /h /type reduced`<br/> | **Повторите попытку изменения типа файла спящего режима на сокращенный.** Если для файла гибернации задан пользовательский размер более 40%, необходимо сначала установить размер файла равным нулю. Затем повторите настройку.<br/>                                                                                                                       |



 

## <a name="soft-off-state-s5"></a>Состояние мягкого отключения (S5)

Состояние «мягкое отключение» происходит, когда система полностью завершает работу без файла гибернации. Мягкое отключение также называется "полным завершением работы". Во время полного завершения работы и загрузки весь сеанс пользователя уничтожается и перезапускается при следующей загрузке. Следовательно, Загрузка/запуск из этого состояния занимает значительно больше времени, чем S1-S4. Полное завершение работы (S5) возникает при запросе перезагрузки системы (или при вызове приложением API завершения работы).

## <a name="mechanical-off-state-g3"></a>Состояние механических вывыкл. (G3)

В этом состоянии система полностью отключена и не потребляет электроэнергии. Система возвращается в рабочее состояние только после полной перезагрузки.

## <a name="wake-on-lan-behavior"></a>Режим пробуждения по локальной сети

Функция Wake-on-LAN (WOL) выводит компьютер из состояния пониженного энергопотребления, когда сетевой адаптер обнаруживает событие WOL (как правило, специально сконструированный пакет Ethernet).

WOL поддерживается в спящем режиме (S3) или режиме гибернации (S4). Он не поддерживается в состоянии завершения работы с быстрым запуском или с мягким отключением (S5). Сетевые карты не включаются в пробуждение в этих штатах, так как пользователи не хотят, чтобы их системы пробуждаться самостоятельно.

> [!Note]  
> Протокол WOL официально не поддерживается при мягком выключении (S5). однако BIOS в некоторых системах может поддерживать арминг сетевые карты для пробуждения, хотя в этом случае Windows не участвует в процессе.

 

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Сведения об управлении питанием](about-power-management.md)
</dt> </dl>
