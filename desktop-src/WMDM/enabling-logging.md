---
title: Включение журнала
description: Включение журнала
ms.assetid: 50fc1d71-b650-4ba5-a6e1-631c0b9fe8ad
keywords:
- Windows Диспетчер устройств носителя, ведение журнала
- Диспетчер устройств, ведение журнала
- Классические приложения, ведение журнала
- поставщики услуг, ведение журнала
- инструкции по программированию, ведение журнала
- Ведение журнала
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1ff937b2a3abd16f7319c3abb73a3a2159350049fff8c89d343cc5545f8a21ff
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118585122"
---
# <a name="enabling-logging"></a>Включение журнала

Windows Диспетчер устройств мультимедиа предоставляет объект ведения журнала, который может сохранять данные в текстовый файл во время выполнения. Разработчики как приложений, так и поставщиков служб могут использовать этот объект для хранения сообщений в файле журнала во время работы поставщика приложения или службы. этот объект особенно полезен при обработке защищенных drm файлов, поскольку Windows Media диспетчер устройств не позволяет подключать отладчик к процессу, который обрабатывает файлы, защищенные с помощью drm.

Средство ведения журнала — это COM-объект с ИДЕНТИФИКАТОРом класса CLSID \_ вмдмлогжер, который предоставляет один интерфейс, [**ивмдмлогжер**](/windows/desktop/api/wmdmlog/nn-wmdmlog-iwmdmlogger). Компонентам не требуется сертификат для использования объекта ведения журнала.

по умолчанию Windows Media диспетчер устройств сохраняет файл журнала независимо от того, использует ли приложение **ивмдмлогжер**. Этот файл журнала является простым текстовым файлом, а каждая запись содержит запись, предшествующую метке времени в формате YYYYMMDDHHMMSS, с использованием 24-часового местного времени. Windows Диспетчер устройств носителя записывает все вызовы API, а также все записи, которые добавляются путем вызова сообщений **ивмдмлогжер** . Все записи файла журнала добавляются к файлу до тех пор, пока не будет вызван [**Сброс**](/windows/desktop/api/wmdmlog/nf-wmdmlog-iwmdmlogger-reset) или размер файла превышает максимальный. Файл закрывается автоматически после каждой операции ведения журнала. Для записей приложений и системных записей используется один и тот же файл журнала.

Ниже показано, как использовать объект ведения журнала.

1.  Включите вмдмлог. h в проект.
2.  Создайте объект ведения журнала, вызвав **CoCreateInstance**(CLSID \_ вмдмлогжер) и запрашивая интерфейс **ивмдмлогжер** . Назначьте указатель интерфейса глобальной переменной.
3.  Убедитесь, что ведение журнала включено, вызвав [**ивмдмлогжер:: enable**](/windows/desktop/api/wmdmlog/nf-wmdmlog-iwmdmlogger-isenabled); Если это не так, включите его, вызвав [**ивмдмлогжер:: enable**](/windows/desktop/api/wmdmlog/nf-wmdmlog-iwmdmlogger-enable).
4.  Укажите имя и размер настраиваемого файла журнала. Это делается путем вызова [**ивмдмлогжер:: сетлогфиленаме**](/windows/desktop/api/wmdmlog/nf-wmdmlog-iwmdmlogger-setlogfilename) и [**Ивмдмлогжер:: сетсизепарамс**](/windows/desktop/api/wmdmlog/nf-wmdmlog-iwmdmlogger-setsizeparams).
5.  В точках кода, где необходимо создать запись в журнале, вызовите [**ивмдмлогжер:: логдворд**](/windows/desktop/api/wmdmlog/nf-wmdmlog-iwmdmlogger-logdword) для строк журнала, содержащих переменные (этот метод похож на **вспринтф** , так как он позволяет отформатировать строку, содержащую значение переменной), или вызвать [**ивмдмлогжер:: логстринг**](/windows/desktop/api/wmdmlog/nf-wmdmlog-iwmdmlogger-logstring) для записи в журнал строк констант.

Пример кода см. на страницах справочника по методам [**ивмдмлогжер**](/windows/desktop/api/wmdmlog/nn-wmdmlog-iwmdmlogger).

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[**Задачи, общие для приложений и поставщиков служб**](tasks-common-to-applications-and-service-providers.md)
</dt> </dl>

 

 




