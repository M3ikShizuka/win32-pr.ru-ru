---
title: Перечисление устройств (ВМДМ)
description: Перечисление устройств
ms.assetid: 7602da65-4c98-4766-b206-2129dad4cc2a
keywords:
- Диспетчер устройств Windows Media, перечисление устройств
- Диспетчер устройств, перечисление устройств
- программное содержимое, перечисление устройств
- поставщики услуг, перечисление устройств
- Создание поставщиков услуг, перечисление устройств
- Перечисление устройств
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 316b87f6ad3f5680e0c22da832da7b1efec24629
ms.sourcegitcommit: cba7f424a292fd7f3a8518947b9466439b455419
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/23/2019
ms.locfileid: "103785088"
---
# <a name="enumerating-devices-wmdm"></a>Перечисление устройств (ВМДМ)

Диспетчер устройств Windows Media поддерживает кэш подключенных устройств, которые обновляются при запуске приложения диспетчер устройств Windows Media, при подключении или отключении устройства самонастраивающийся (PnP) или при вызове [**IWMDeviceManager2:: Reinitialize**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdevicemanager2-reinitialize). Этот кэш предоставляется приложению при вызове [**ивмдевицеманажер:: енумдевицес**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdevicemanager-enumdevices) или [**IWMDeviceManager2:: EnumDevices2**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdevicemanager2-enumdevices2). Каждое устройство предоставляется приложению как интерфейс [**ивмдмдевице**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmdevice) . Если поставщик услуг зарегистрирован для работы с устройствами PnP, Windows Media диспетчер устройств будет знать о текущем списке подключенных устройств. Если поставщик услуг зарегистрирован для управления устройствами, не поддерживающими PnP, поставщик услуг отвечает за обнаружение подключенных устройств. Поставщик услуг может быть зарегистрирован только для устройств PnP или не на основе PnP, но не в обоих случаях.

Следующие действия показывают, как Windows Media диспетчер устройств поддерживает или обновляет свой кэш. Обратите внимание, что кэш никогда не обновляется при подключении или отключении устройства, не поддерживающего PnP.

Запуск приложения диспетчер устройств Windows Media

-   Диспетчер устройств Windows Media извлекает список подключенных устройств PnP из подсистемы PnP и вызывает [**IMDServiceProvider2:: креатедевице**](/windows/desktop/api/mswmdm/nf-mswmdm-imdserviceprovider2-createdevice) для служб SP, зарегистрированных для каждого подключенного устройства. (Он обнаруживает правильного поставщика услуг, запрашивая параметр устройства ВМДМСПКЛСИД для идентификатора класса поставщика услуг, ответственного за это устройство. Дополнительные сведения см. в разделе [Параметры устройства](device-parameters.md) .) Все возвращенные устройства добавляются в кэш Windows Media диспетчер устройств устройств.
-   Windows Media диспетчер устройств находит все зарегистрированные в нем поставщики служб, не поддерживающих PnP, и вызывает [**имдсервицепровидер:: енумдевицес**](/windows/desktop/api/mswmdm/nf-mswmdm-imdserviceprovider-enumdevices) для каждого поставщика услуг, чтобы получить список устройств от каждого из них. Все возвращенные устройства добавляются в кэш.

Приложение вызывает Ивмдевицеманажер/2:: Енумдевицес/2

-   Диспетчер устройств Windows Media возвращает свой список кэшированных устройств.

Устройство PnP подключается

-   Windows Media диспетчер устройств находит соответствующего поставщика услуг и вызывает **IMDServiceProvider2:: креатедевице** и добавляет устройство в свой кэш.
-   Если приложение реализует [**ивмдмнотификатион**](/windows/desktop/api/mswmdm/nn-mswmdm-iwmdmnotification), Windows Media Диспетчер устройств вызывает [**Ивмдмнотификатион:: вмдммессаже**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmnotification-wmdmmessage) с уведомлением о получении.

PnP-устройство отключается

-   Диспетчер устройств Windows Media удаляет элемент из кэша.
-   Если приложение реализует Ивмдмнотификатион, Windows Media диспетчер устройств вызывает Ивмдмнотификатион:: Вмдммессаже с уведомлением о отправлении.

Приложение вызывает IWMDeviceManager2:: Reinitialize

-   Обновляет кэш всеми подключенными устройствами.

Устройство, не поддерживающее PnP, подключается или отключается

-   Диспетчер устройств Windows Media не сообщает о поступлении или отправлении и не выполняет никаких действий.

## <a name="related-topics"></a>См. также

<dl> <dt>

[**Создание поставщика услуг**](creating-a-service-provider.md)
</dt> </dl>

 

 




