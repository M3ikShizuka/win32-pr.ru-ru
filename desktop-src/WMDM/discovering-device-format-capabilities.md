---
title: Обнаружение возможностей форматирования устройств
description: Обнаружение возможностей форматирования устройств
ms.assetid: dd139816-dc8c-4e73-9a21-67287bfe6405
keywords:
- Windows Диспетчер устройств мультимедиа, возможности устройства
- Диспетчер устройств, возможности устройства
- рекомендации по программированию, возможности устройств
- Классические приложения, возможности устройств
- создание Windows мультимедиа диспетчер устройств приложений, возможности устройств
- запись файлов на устройства, возможности устройств
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 03e4fc32c0980a1022f7affb225918ccf0d49e5d14c5bb7310e70e7aa4f83a62
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118585150"
---
# <a name="discovering-device-format-capabilities"></a>Обнаружение возможностей форматирования устройств

Приложение может попытаться определить возможности воспроизведения устройства перед отправкой файла. Если устройство не может работать с форматом файла, который требуется отправить, приложение может попытаться перекодировать файл в формат, который может использовать устройство, или уведомить пользователя о том, что устройство не поддерживает запрошенный файл.

Обратите внимание, что некоторые устройства, такие как устройства класса запоминающих устройств, могут использоваться только как съемные носители носителей без возможности воспроизведения. В этом случае было бы нежелательным для приложения перекодировать файл перед его отправкой на устройство.

Хотя метод [**ивмдмдевице:: GetType**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmdevice-gettype) позволяет устройству сообщать о своих возможностях, некоторые устройства возвращают неверные значения для этого метода. Перед копированием файла на устройство может потребоваться попросить пользователя о том, предназначено ли воспроизведение, и, если да, попытаться перекодировать файл в один из зарегистрированных форматов устройства (или в разумном формате, если устройство поддерживает утверждения любого формата). Другой подход заключается в том, что все форматы, специально перечисленные как поддерживаемые устройством, предназначены для воспроизведения, а все остальные файлы должны передаваться без изменений.

После обнаружения формата переносимого файла и форматов, поддерживаемых устройством, можно выбрать оптимальный формат целевого объекта для перекодирования.

В прошлом было распространено, что приложение возвращало ноль для свойства, чтобы указать поддержку любых значений этого свойства. Например, нулевое значение для [**\_ вавеформатекс**](-waveformatex.md). нсамплесперсек указывает на поддержку любой скорости. Теперь рекомендуемым способом указания поддержки любого значения является указание ВМДМ \_ Enum \_ prop \_ Допустимые \_ значения \_ any в [**вмдм \_ prop \_ DESC**](wmdm-prop-desc.md). Валидвалуесформ. Однако некоторые свойства могут вернуть ноль, чтобы указать конкретную поддержку. Например, если [**\_ битмапинфохеадер**](-bitmapinfoheader.md). бисизеимаже имеет значение 0, это указывает на битовую карту RGB для бизнес-аналитики \_ . Исключения для нулевых значений указаны в документации по соответствующим структурам.

Однако важно отметить, что устройства часто не сообщают о своих возможностях формата или в стандартном виде. Например, устройства часто сообщают о том, что они поддерживают любой формат, когда на самом деле они могут работать только с конкретными форматами или с конкретными скоростями в формате формата. Вы решаете, должно ли приложение принимать такие отчеты или должен ли он иметь некоторый верхний предел для возможностей воспроизведения устройства (например, 192 кбит/с).

Рекомендуемый способ запроса поддержки формата устройства — [**IWMDMDevice3:: жетформаткапабилити**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmdevice3-getformatcapability). Если этот метод не поддерживается, приложение должно возвращаться к [**ивмдмдевице:: жетформатсуппорт**](/windows/desktop/api/mswmdm/nf-mswmdm-iwmdmdevice-getformatsupport). **Жетформатсуппорт**, в отличие от **GetFormatSupport2**, не возвращает сведения о видео.

Как приложение запрашивает возможности форматирования устройства, зависит от того, какой интерфейс поддерживает приложение. Дополнительные сведения см в следующих разделах.

-   [Получение возможностей форматирования на устройствах, поддерживающих IWMDMDevice3](getting-format-capabilities-on-devices-that-support-iwmdmdevice3.md)
-   [Получение возможностей форматирования на устройствах, поддерживающих только Ивмдмдевице](getting-format-capabilities-on-devices-that-support-only-iwmdmdevice.md)

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[**Запись файлов на устройство**](writing-files-to-the-device.md)
</dt> </dl>

 

 




