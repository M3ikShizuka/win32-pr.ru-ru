---
title: Образец поставщика услуг
description: Образец поставщика услуг
ms.assetid: bbdeddb5-4ddf-4a61-828c-a9ba7af307ea
keywords:
- Диспетчер устройств Windows Media, примеры
- Диспетчер устройств, примеры
- Диспетчер устройств Windows Media, пример поставщика услуг
- Диспетчер устройств, пример поставщика услуг
- поставщики услуг, примеры
- Примеры, поставщики услуг
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7e8b7e781785944ac1ca390a62303f1149d710d1
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "105691235"
---
# <a name="sample-service-provider"></a>Образец поставщика услуг

Пакет Windows Media диспетчер устройств SDK содержит образец поставщика услуг, который вы хотите использовать. Этот поставщик услуг включает класс, сообщающий каждый жесткий диск компьютера, как если бы он был подключенным устройством. Единственным приложением, которое будет использовать этот поставщик услуг, является пример приложения. Проводник Windows не будет видеть "устройства", выданные этим поставщиком услуг. Пример поставщика услуг представляет собой COM-объект, созданный на основе ATL. Ниже описано, как использовать образец поставщика услуг.

> [!Note]  
> Пример поставщика служб реализует очень мало функций, поэтому его не следует использовать для тестирования приложений диспетчер устройств Windows Media. Чтобы протестировать приложение, используйте полностью реализованный поставщик услуг.

 

-   Пример был доставлен с ошибкой в коде, которая приведет к сбою поставщика услуг. Чтобы исправить эту ошибку, откройте файл мдспенумстораже. cpp, установленный в папке < *путь установки пакета SDK*  > \\ WMFSDK95 \\ вмдм \\ МДСП \\ мшдсп, перейдите в строку 185 и измените следующую строку:

`wcsncpy(pStg->m_wcsName, m_wcsPath, dwLen);`

На эту:

`wcsncpy(pStg->m_wcsName, m_wcsPath, ARRAYSIZE(pStg->m_wcsName));`

1.  Скомпилируйте файл MsHDSP.dll. Это можно сделать с помощью NMAKE или Visual Studio. Сведения о компиляции приложения см. в разделе [Компиляция примера поставщика услуг с помощью NMAKE](compiling-the-sample-service-provider-using-nmake.md) или [Компиляция примера поставщика услуг с помощью Visual Studio](compiling-the-sample-service-provider-using-visual-studio.md) .
2.  Зарегистрируйте MsHDSP.dll с помощью regsvr32. Следующая строка, введенная в окно командной строки в той же папке, что и MsHDSP.dll, зарегистрирует образец поставщика услуг:

    ```C++
    regsvr32 mshdsp.dll
    ```

    

    Чтобы отключить олицетворение устройства, введите в командной строке следующую строку:

    ```C++
    regsvr32 /u mshdsp.dll
    ```

    

3.  Съемные устройства, олицетворенные с помощью этой библиотеки DLL, могут рассматриваться только в примере приложения, поставляемого с этим пакетом SDK. Скомпилируйте пример приложения с помощью одного из методов, описанных в [примере классического приложения](sample-desktop-application.md).
4.  Чтобы выполнить отладку поставщика услуг с помощью Visual Studio, откройте поставщик службы в Visual Studio и выберите команду **запустить** в меню **Отладка** . Во всплывающем диалоговом окне перейдите к образцу приложения, созданному на предыдущем шаге, и нажмите кнопку **ОК**, и поставщик услуг начнет работать в режиме отладки.

    Чтобы запустить поставщик службы без отладки в Visual Studio, просто зарегистрируйте msdhsp.dll и запустите пример приложения для настольных систем, которое поставляется вместе с пакетом SDK. Пример классического приложения запускает образец поставщика услуг автоматически.

## <a name="related-topics"></a>См. также

<dl> <dt>

[**Примеры**](samples.md)
</dt> </dl>

 

 




