---
title: Недавние элементы
description: Список Недавние элементы — это панель в меню приложение, в которой отображаются последние использовавшиеся элементы для приложения.
ms.assetid: fdead358-d303-46de-9f8e-6fc2832d8e94
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 61f78c01fc4d6cc830eba644f7dcf22b6fb03e82
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104570005"
---
# <a name="recent-items"></a>Недавние элементы

Список Недавние элементы — это панель в [меню приложение](windowsribbon-controls-applicationmenu.md) , в которой отображаются последние использовавшиеся элементы для приложения.

-   [Подробные сведения](#details)
-   [Свойства недавних элементов](#recent-items-properties)
-   [Замечания](#remarks)
-   [См. также](#related-topics)

## <a name="details"></a>Сведения

На следующем снимке экрана показан список последних элементов из WordPad для Windows 7.

![снимок экрана: список последних элементов на ленте Microsoft Paint.](images/controls/recentitems.png)

[Меню приложения](windowsribbon-controls-applicationmenu.md) может иметь не более одного списка [**аппликатионмену. рецентитемс**](windowsribbon-element-applicationmenu-recentitems.md) , представленного элементом **аппликатионмену. рецентитемс** для отображения последних документов, изображений, фильмов и других проектов, над которыми пользователь работал. Число элементов в списке в диапазоне от нуля до максимального числа, указанного в разметке, со значением по умолчанию, равным 10. Последние элементы отображаются в виде нумерованного списка строк, указывающих имена файлов. Рекомендуется использовать свойство [**Command. лабелдескриптион**](windowsribbon-element-command-labeldescription.md) для предоставления полного пути к расположению файла, как показано на следующем снимке экрана.

![снимок экрана: список последних элементов в меню приложения.](images/overviews/applicationmenu-menurecentitems.png)

Элемент [**рецентитемс**](windowsribbon-element-recentitems.md) имеет атрибут *енаблепиннинг* , который, если задано значение `true` , отображает значок ПИН-кода справа от каждого элемента в списке, как показано на следующем снимке экрана.

> [!Note]  
> Закрепление включено по умолчанию, если не указан атрибут *енаблепиннинг* .

 

![снимок экрана с закреплением последних элементов в меню приложения.](images/overviews/applicationmenu-menurecentitemspinned.png)

Алгоритм закрепления предназначен для того, чтобы элементы не выпадают из списка **последних элементов** . Алгоритм создает следующее поведение:

-   Новый элемент всегда добавляется в верхнюю часть списка **последних элементов** .
-   Элементы будут перемещены вниз в списке с течением времени. После заполнения списка (достигает максимального количества элементов, указанных в разметке) более старые элементы переходят в нижнюю часть списка, так как новые элементы добавляются в начало списка.
-   Если элемент уже присутствует где-либо в списке, но снова доступен, он переместится в начало списка.
-   Если элемент закреплен, он по-прежнему будет переноситься вниз по списку, но не будет выпадать в нижнюю часть. Вместо этого после заполнения списка первый незакрепленный элемент, расположенный выше закрепленного элемента, будет отключен при добавлении нового элемента в список.
-   Если количество закрепленных элементов достигает максимального числа элементов, новые элементы не добавляются в список до тех пор, пока элемент не будет откреплен.

## <a name="recent-items-properties"></a>Свойства недавних элементов

Платформа ленты определяет коллекцию [ключей свойств](windowsribbon-reference-properties.md) для элемента управления "Недавние элементы".

Как правило, свойство недавние элементы обновляется в пользовательском интерфейсе ленты путем непроверки команды, связанной с элементом управления, посредством вызова метода [**иуифрамеворк:: инвалидатеуикомманд**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-invalidateuicommand) . Событие "недействительность" обрабатывается и задается обновлением свойства с помощью метода обратного вызова [**иуикоммандхандлер:: упдатепроперти**](/windows/desktop/api/uiribbon/nf-uiribbon-iuicommandhandler-updateproperty) .

Метод обратного вызова [**иуикоммандхандлер:: упдатепроперти**](/windows/desktop/api/uiribbon/nf-uiribbon-iuicommandhandler-updateproperty) не выполняется и приложение запрашивает обновленное значение свойства до тех пор, пока свойство не будет обязательно для платформы. Например, при активации вкладки и элементе управления, отображенном в ленте, или при отображении подсказки.

> [!Note]  
> В некоторых случаях свойство можно получить с помощью метода [**иуифрамеворк:: жетуикоммандпроперти**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-getuicommandproperty) и задать с помощью метода [**Иуифрамеворк:: сетуикоммандпроперти**](/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setuicommandproperty) .

 

В следующей таблице перечислены ключи свойств, связанные с элементом управления "Недавние элементы".



| Ключ свойства                                                                       | Примечания                                     |
|------------------------------------------------------------------------------------|-------------------------------------------|
| [UI \_ PKEY \_ keytip](windowsribbon-reference-properties-uipkey-keytip.md)           | Может обновляться только через недействительность. |
| [UI \_ PKEY \_ рецентитемс](windowsribbon-reference-properties-uipkey-recentitems.md) | Может обновляться только через недействительность. |



 

## <a name="remarks"></a>Комментарии

Метод [иаппликатиондокументлистс::/List](/windows/win32/api/shobjidl_core/nf-shobjidl_core-iapplicationdocumentlists-getlist) можно использовать для получения списка MRU оболочки Windows для приложения ленты. Объект, полученный этим методом, затем может использоваться приложением для создания данных, необходимых платформе Ribbon для заполнения списка **последних элементов** [меню приложения](windowsribbon-controls-applicationmenu.md).

> [!Note]  
> При использовании этого метода *листтипе* должен иметь значение `ADLT_RECENT` .

 

Пример реализации списка MRU-элементов в приложении платформы Ribbon см. в примере [хтмледитриббон](windowsribbon-htmleditribbonsample.md).

## <a name="related-topics"></a>См. также

<dl> <dt>

[Библиотека элементов управления платформы Windows ленты](windowsribbon-controls-entry.md)
</dt> <dt>

[**Элемент разметки недавних элементов**](windowsribbon-element-recentitems.md)
</dt> </dl>

 

 