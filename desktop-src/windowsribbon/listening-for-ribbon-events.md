---
title: Прослушивание событий ленты
description: платформа Windows Ribbon использует функцию трассировки событий для Windows (ETW), чтобы разработчики могли узнать, как пользователи взаимодействуют с лентой приложения.
ms.assetid: F29A8E41-C902-410E-BD28-653E078320E9
keywords:
- Windows Лента, события
- Лента, события
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dcf28052aa741437a7f96f90ddb1b4a773ae4c4a
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127572262"
---
# <a name="listening-for-ribbon-events"></a>Прослушивание событий ленты

платформа Windows Ribbon использует функцию [трассировки событий для Windows (ETW)](../etw/event-tracing-portal.md) , чтобы разработчики могли узнать, как пользователи взаимодействуют с лентой приложения.

## <a name="introduction"></a>Введение

Механизм событий платформы Ribbon разработан таким образом, что платформа сообщает приложению о событиях пользовательского интерфейса ленты, чтобы вы могли отслеживать действия пользователей, изучать их шаблоны взаимодействия и оценивать тенденции использования. Эти сведения можно использовать для уточнения пользовательского интерфейса для будущих итераций приложения ленты.

При использовании событий платформы Ribbon происходит следующее.

1.  для получения уведомлений о событиях ленты из платформы ленты приложение ленты должно зарегистрировать прослушиватель [событий для трассировки Windows (ETW)](../etw/event-tracing-portal.md) .
2.  платформа ribbon запускает обратные вызовы событий пользовательского интерфейса ribbon во время выполнения, если приложение зарегистрировало [трассировку событий для прослушивателя Windows (ETW)](../etw/event-tracing-portal.md) .

## <a name="supported-events"></a>Поддерживаемые события

События, предоставляемые для приложений ленты, описаны в следующей таблице. 


| Событие | Отчет о событиях | 
|-------|--------------|
| Активированная вкладка | Идентификатор команды<br /> Имя команды<br /> Команда события<br /> | 
| Активирована контекстная вкладка | Идентификатор команды<br /> Имя команды<br /> Команда события<br /> | 
| Меню приложения открыто | Команда события<br /> | 
| Меню приложения закрыто | Команда события<br /> | 
| Открыто меню (обычный или Галерея) | Идентификатор команды<br /> Имя команды<br /> Команда события<br /><blockquote>[!Note]<br />События меню QAT не отображаются.</blockquote><br /> | 
| Меню (обычный или Галерея) закрыто | Идентификатор команды<br /> Имя команды<br /> Команда события<br /><blockquote>[!Note]<br />События меню QAT не отображаются.</blockquote><br /> | 
| Команда | Идентификатор команды<br /> Имя команды<br /> Команда события<br /> Одно из следующих расположений событий:<ul><li>ЛЕНТЕ</li><li>куиккакцесстулбар</li><li>аппликатионмену</li><li>контекстпопуп</li></ul><br /> ИДЕНТИФИКАТОР родительской команды<br /> Имя родительской команды<br /> Один из следующих методов Invoke:<ul><li>Откройте</li><li>KEYTIP</li><li>ЭКВИВАЛЕНТ</li><li>ПЕРСОНИФИЦИРОВАН</li></ul><br /><blockquote>[!Note]<br />Коллекции элементов и поля со списком содержат выбранный индекс элемента, но не содержат строковые и целочисленные значения. Счетчики не включают целочисленное значение.</blockquote><br /> | 
| Лента уменьшена | Команда события<br /> | 
| Лента развернута (кнопка развертывания нажата или касание закреплена) | Команда события<br /> | 
| Режим приложения переключен | Команда события<br /> Идентификатор режима (значение, заданное с помощью <a href="/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes"><strong>сетмодес</strong></a>)<br /><blockquote>[!Note]<br />Приложение отвечает за распаковку этого целого числа, чтобы определить, какие режимы были установлены.</blockquote><br /> | 
| Отображаемая подсказка | Команда события<br /> ИДЕНТИФИКАТОР родительской команды<br /> Имя родительской команды<br /> | 




 

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Windows Руководства для разработчиков платформы Ribbon](windowsribbon-guides-entry.md)
</dt> <dt>

[Объявление команд и элементов управления с разметкой ленты](./windowsribbon-schema.md)
</dt> <dt>

[Рекомендации по работе пользователя с лентой](https://msdn.microsoft.com/library/cc872782.aspx)
</dt> <dt>

[Процесс разработки ленты](https://msdn.microsoft.com/library/cc872781.aspx)
</dt> </dl>

