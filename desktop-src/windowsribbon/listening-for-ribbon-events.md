---
title: Прослушивание событий ленты
description: платформа Windows Ribbon использует функцию трассировки событий для Windows (ETW), чтобы разработчики могли узнать, как пользователи взаимодействуют с лентой приложения.
ms.assetid: F29A8E41-C902-410E-BD28-653E078320E9
keywords:
- Windows Лента, события
- Лента, события
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f9519553a40cd613085949d4650c2689e817f387e47e9ab4380b629464e90d2b
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118202974"
---
# <a name="listening-for-ribbon-events"></a>Прослушивание событий ленты

платформа Windows Ribbon использует функцию [трассировки событий для Windows (ETW)](../etw/event-tracing-portal.md) , чтобы разработчики могли узнать, как пользователи взаимодействуют с лентой приложения.

## <a name="introduction"></a>Введение

Механизм событий платформы Ribbon разработан таким образом, что платформа сообщает приложению о событиях пользовательского интерфейса ленты, чтобы вы могли отслеживать действия пользователей, изучать их шаблоны взаимодействия и оценивать тенденции использования. Эти сведения можно использовать для уточнения пользовательского интерфейса для будущих итераций приложения ленты.

При использовании событий платформы Ribbon происходит следующее.

1.  для получения уведомлений о событиях ленты из платформы ленты приложение ленты должно зарегистрировать прослушиватель [событий для трассировки Windows (ETW)](../etw/event-tracing-portal.md) .
2.  платформа ribbon запускает обратные вызовы событий пользовательского интерфейса ribbon во время выполнения, если приложение зарегистрировало [трассировку событий для прослушивателя Windows (ETW)](../etw/event-tracing-portal.md) .

## <a name="supported-events"></a>Поддерживаемые события

События, предоставляемые для приложений ленты, описаны в следующей таблице. 

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Событие</th>
<th>Отчет о событиях</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Активированная вкладка</td>
<td>Идентификатор команды<br/> Имя команды<br/> Команда события<br/></td>
</tr>
<tr class="even">
<td>Активирована контекстная вкладка</td>
<td>Идентификатор команды<br/> Имя команды<br/> Команда события<br/></td>
</tr>
<tr class="odd">
<td>Меню приложения открыто</td>
<td>Команда события<br/></td>
</tr>
<tr class="even">
<td>Меню приложения закрыто</td>
<td>Команда события<br/></td>
</tr>
<tr class="odd">
<td>Открыто меню (обычный или Галерея)</td>
<td>Идентификатор команды<br/> Имя команды<br/> Команда события<br/>
<blockquote>
[!Note]<br />
События меню QAT не отображаются.
</blockquote>
<br/></td>
</tr>
<tr class="even">
<td>Меню (обычный или Галерея) закрыто</td>
<td>Идентификатор команды<br/> Имя команды<br/> Команда события<br/>
<blockquote>
[!Note]<br />
События меню QAT не отображаются.
</blockquote>
<br/></td>
</tr>
<tr class="odd">
<td>Команда</td>
<td>Идентификатор команды<br/> Имя команды<br/> Команда события<br/> Одно из следующих расположений событий:
<ul>
<li>ЛЕНТЕ</li>
<li>куиккакцесстулбар</li>
<li>аппликатионмену</li>
<li>контекстпопуп</li>
</ul>
<br/> ИДЕНТИФИКАТОР родительской команды<br/> Имя родительской команды<br/> Один из следующих методов Invoke:
<ul>
<li>Откройте</li>
<li>KEYTIP</li>
<li>ЭКВИВАЛЕНТ</li>
<li>ПЕРСОНИФИЦИРОВАН</li>
</ul>
<br/>
<blockquote>
[!Note]<br />
Коллекции элементов и поля со списком содержат выбранный индекс элемента, но не содержат строковые и целочисленные значения. Счетчики не включают целочисленное значение.
</blockquote>
<br/></td>
</tr>
<tr class="even">
<td>Лента уменьшена</td>
<td>Команда события<br/></td>
</tr>
<tr class="odd">
<td>Лента развернута (кнопка развертывания нажата или касание закреплена)</td>
<td>Команда события<br/></td>
</tr>
<tr class="even">
<td>Режим приложения переключен</td>
<td>Команда события<br/> Идентификатор режима (значение, заданное с помощью <a href="/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes"><strong>сетмодес</strong></a>)<br/>
<blockquote>
[!Note]<br />
Приложение отвечает за распаковку этого целого числа, чтобы определить, какие режимы были установлены.
</blockquote>
<br/></td>
</tr>
<tr class="odd">
<td>Отображаемая подсказка</td>
<td>Команда события<br/> ИДЕНТИФИКАТОР родительской команды<br/> Имя родительской команды<br/></td>
</tr>
</tbody>
</table>



 

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Windows Руководства для разработчиков платформы Ribbon](windowsribbon-guides-entry.md)
</dt> <dt>

[Объявление команд и элементов управления с разметкой ленты](./windowsribbon-schema.md)
</dt> <dt>

[Рекомендации по работе пользователя с лентой](https://msdn.microsoft.com/library/cc872782.aspx)
</dt> <dt>

[Процесс разработки ленты](https://msdn.microsoft.com/library/cc872781.aspx)
</dt> </dl>

