---
title: Прослушивание событий ленты
description: Платформа Windows Ribbon использует инфраструктуру трассировки событий для Windows (ETW), позволяющую разработчикам узнать, как пользователи взаимодействуют с лентой приложения.
ms.assetid: F29A8E41-C902-410E-BD28-653E078320E9
keywords:
- Лента Windows, события
- Лента, события
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fcbfb2c6417c1423cb785b6b80de4396146535c2
ms.sourcegitcommit: ae73f4dd3cf5a3c6a1ea7d191ca32a5b01f6686b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/08/2020
ms.locfileid: "104339449"
---
# <a name="listening-for-ribbon-events"></a>Прослушивание событий ленты

Платформа Windows Ribbon использует инфраструктуру [трассировки событий для Windows (ETW)](../etw/event-tracing-portal.md) , позволяющую разработчикам узнать, как пользователи взаимодействуют с лентой приложения.

## <a name="introduction"></a>Введение

Механизм событий платформы Ribbon разработан таким образом, что платформа сообщает приложению о событиях пользовательского интерфейса ленты, чтобы вы могли отслеживать действия пользователей, изучать их шаблоны взаимодействия и оценивать тенденции использования. Эти сведения можно использовать для уточнения пользовательского интерфейса для будущих итераций приложения ленты.

При использовании событий платформы Ribbon происходит следующее.

1.  Приложение ленты должно зарегистрировать прослушиватель [трассировки событий Windows (ETW)](../etw/event-tracing-portal.md) для получения уведомлений о событиях ленты из платформы ленты.
2.  Платформа Ribbon запускает обратные вызовы событий пользовательского интерфейса ленты во время выполнения, если приложение зарегистрировало прослушиватель [трассировки событий для Windows (ETW)](../etw/event-tracing-portal.md) .

## <a name="supported-events"></a>Поддерживаемые события

События, предоставляемые для приложений ленты, описаны в следующей таблице. 

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Событие</th>
<th>Отчет о событиях</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Активированная вкладка</td>
<td>Идентификатор команды<br/> Имя команды<br/> Команда события<br/></td>
</tr>
<tr class="even">
<td>Активирована контекстная вкладка</td>
<td>Идентификатор команды<br/> Имя команды<br/> Команда события<br/></td>
</tr>
<tr class="odd">
<td>Меню приложения открыто</td>
<td>Команда события<br/></td>
</tr>
<tr class="even">
<td>Меню приложения закрыто</td>
<td>Команда события<br/></td>
</tr>
<tr class="odd">
<td>Открыто меню (обычный или Галерея)</td>
<td>Идентификатор команды<br/> Имя команды<br/> Команда события<br/>
<blockquote>
[!Note]<br />
События меню QAT не отображаются.
</blockquote>
<br/></td>
</tr>
<tr class="even">
<td>Меню (обычный или Галерея) закрыто</td>
<td>Идентификатор команды<br/> Имя команды<br/> Команда события<br/>
<blockquote>
[!Note]<br />
События меню QAT не отображаются.
</blockquote>
<br/></td>
</tr>
<tr class="odd">
<td>Get-Help</td>
<td>Идентификатор команды<br/> Имя команды<br/> Команда события<br/> Одно из следующих расположений событий:
<ul>
<li>ЛЕНТЕ</li>
<li>куиккакцесстулбар</li>
<li>аппликатионмену</li>
<li>контекстпопуп</li>
</ul>
<br/> ИДЕНТИФИКАТОР родительской команды<br/> Имя родительской команды<br/> Один из следующих методов Invoke:
<ul>
<li>Откройте</li>
<li>KEYTIP</li>
<li>ЭКВИВАЛЕНТ</li>
<li>ПЕРСОНИФИЦИРОВАН</li>
</ul>
<br/>
<blockquote>
[!Note]<br />
Коллекции элементов и поля со списком содержат выбранный индекс элемента, но не содержат строковые и целочисленные значения. Счетчики не включают целочисленное значение.
</blockquote>
<br/></td>
</tr>
<tr class="even">
<td>Лента уменьшена</td>
<td>Команда события<br/></td>
</tr>
<tr class="odd">
<td>Лента развернута (кнопка развертывания нажата или касание закреплена)</td>
<td>Команда события<br/></td>
</tr>
<tr class="even">
<td>Режим приложения переключен</td>
<td>Команда события<br/> Идентификатор режима (значение, заданное с помощью <a href="/windows/desktop/api/uiribbon/nf-uiribbon-iuiframework-setmodes"><strong>сетмодес</strong></a>)<br/>
<blockquote>
[!Note]<br />
Приложение отвечает за распаковку этого целого числа, чтобы определить, какие режимы были установлены.
</blockquote>
<br/></td>
</tr>
<tr class="odd">
<td>Отображаемая подсказка</td>
<td>Команда события<br/> ИДЕНТИФИКАТОР родительской команды<br/> Имя родительской команды<br/></td>
</tr>
</tbody>
</table>



 

## <a name="related-topics"></a>См. также

<dl> <dt>

[Руководства для разработчиков платформы Windows Ribbon](windowsribbon-guides-entry.md)
</dt> <dt>

[Объявление команд и элементов управления с разметкой ленты](./windowsribbon-schema.md)
</dt> <dt>

[Рекомендации по работе пользователя с лентой](https://msdn.microsoft.com/library/cc872782.aspx)
</dt> <dt>

[Процесс разработки ленты](https://msdn.microsoft.com/library/cc872781.aspx)
</dt> </dl>

