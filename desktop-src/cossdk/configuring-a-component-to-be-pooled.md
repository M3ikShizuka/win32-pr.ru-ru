---
description: Компонент можно настроить для объединения в пул только в том случае, если он правильно написан для поддержки пула. Дополнительные сведения об этих требованиях см. в разделе Требования для объектов в пуле.
ms.assetid: ffd812cc-811e-4f2a-8736-d1cb22d5abb7
title: Настройка компонента для объединения в пул
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 780f7e1d9128b213b138e63b9dfa7e0f40642681
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127342082"
---
# <a name="configuring-a-component-to-be-pooled"></a>Настройка компонента для объединения в пул

Компонент можно настроить для объединения в пул только в том случае, если он правильно написан для поддержки пула. Дополнительные сведения об этих требованиях см. в разделе [требования для объектов в пуле](requirements-for-poolable-objects.md).

> [!Note]  
> По умолчанию компонент не настроен для объединения в пул.

 

При настройке компонента для объединения в пул можно указать следующие свойства, чтобы определить, как COM+ обслуживает пул.

-   **Минимальный размер пула.** Представляет количество объектов, создаваемых при запуске приложения, и минимальное количество объектов, которые хранятся в пуле во время выполнения приложения. Если количество доступных объектов в пуле падает ниже указанного минимума, создаются новые объекты для удовлетворения любых необработанных запросов объектов и повторного заполнения пула. Если количество доступных объектов в пуле больше минимального, то эти избыточные объекты уничтожаются во время цикла очистки.
-   **Максимальный размер пула.** Представляет максимальное количество объектов в составе пула, создаваемых диспетчером пула, активно используемых клиентами и неактивными в пуле. При создании объектов диспетчер пула служб проверяет, что максимальный размер пула не достигнут, и, если нет, диспетчер пула создает новый экземпляр объекта, который будет выделился клиенту. Если достигнут максимальный размер пула, клиентские запросы будут поставлены в очередь и получат первый доступный объект из пула на основе первого обслуживаемого. Время ожидания запросов на создание объектов истекает через указанный период.
-   **Время ожидания создания (МС).** Указывает, как долго клиент будет ожидать в миллисекундах, чтобы объект был возвращен из пула после вызова [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance). Если клиентский вызов завершается неудачно, возвращается ошибка E \_ timeout.

**Задание свойств, связанных с пулом**

1.  В области сведений средства администрирования "службы компонентов" щелкните правой кнопкой мыши компонент, который требуется настроить, и выберите пункт **Свойства**.

2.  В диалоговом окне Свойства компонента перейдите на вкладку **Активация** .

3.  Чтобы включить использование пула объектов для компонента, установите флажок **включить пул объектов** .

4.  В поле **Минимальный размер пула** введите минимальное число объектов этого типа в пуле. Для пула будет поддерживаться по крайней мере столько объектов.

5.  В поле u введите максимальное число объектов этого типа в пуле. Количество объектов, активированных и отключенных, никогда не будет превышать это значение.

6.  В поле **время ожидания создания (МС)** введите время в миллисекундах, в течение которого клиент будет ожидать объект в пуле, если он недоступен немедленно.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Мониторинг статистики объектов](monitoring-object-statistics.md)
</dt> </dl>

 

 
