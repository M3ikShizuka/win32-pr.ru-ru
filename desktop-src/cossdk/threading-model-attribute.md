---
description: COM+ управляет потоками. Каждый компонент COM имеет свойство ThreadingModel, которое можно указать при разработке компонента. Это свойство определяет, как объекты компонентов назначаются потокам для выполнения метода.
ms.assetid: 5fae8475-3d2e-4939-80a7-bc9a677a50b3
title: Атрибут модели потоков
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 91960a753b29ac5f5209a5bafa31c362f3dfe08d
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104423266"
---
# <a name="threading-model-attribute"></a>Атрибут модели потоков

COM+ управляет потоками. Каждый компонент COM имеет свойство **ThreadingModel** , которое можно указать при разработке компонента. Это свойство определяет, как объекты компонента назначаются потокам для выполнения метода.

Для просмотра свойства потоковой модели можно использовать средство администрирования "службы компонентов", щелкнув правой кнопкой мыши компонент в папке **компоненты** , выбрав пункт **свойства**, а затем перейдя на вкладку **параллелизм** . В рамках **потоковой модели** возможны следующие значения:

-   **Контейнер основного потока**
-   **Контейнер с одним потоком**
-   **Контейнер свободных потоков**
-   **Нейтральное подразделение**
-   **Любое подразделение**

Предпочтительная модель потоков для COM+ — это [нейтральное подразделение](neutral-apartments.md). Однако если не указать модель потоков для компонента, COM+ использует главный контейнер потока, который является значением по умолчанию.

> [!Note]  
> Более подробные сведения см. [в разделе Выбор модели потоков](/windows/desktop/com/choosing-the-threading-model).

 

В следующей таблице показана модель программирования для апартаментов в COM+.



| Модель                     | Разделение                                                 | Бесплатный                               | Оба                               | нейтральное выражение.                      | Не указано                      |
|---------------------------|-----------------------------------------------------------|------------------------------------|------------------------------------|------------------------------|------------------------------------|
| С одним потоком, без Main | Создано в текущем апартаменте                              | Создано в многопоточном подразделении | Создано в текущем апартаменте       | Создано в нейтральном апартаменте | Создано в основном потоковом подразделении |
| Один поток, основной     | Создано в текущем апартаменте                              | Создано в многопоточном подразделении | Создано в текущем апартаменте       | Создано в нейтральном апартаменте | Создано в текущем апартаменте       |
| Многопоточных             | Создано в однопотоковом апартаменте узла                 | Создано в многопоточном подразделении | Создано в многопоточном подразделении | Создано в нейтральном апартаменте | Создано в основном потоковом подразделении |
| Нейтральный (в потоке STA)   | Создано в размещающем однопотоковое подразделение для этого потока | Создано в многопоточном подразделении | Создано в нейтральном апартаменте       | Создано в нейтральном апартаменте | Создано в основном потоковом подразделении |
| Нейтральный (в потоке MTA)   | Создано в однопотоковом апартаменте узла                 | Создано в многопоточном подразделении | Создано в нейтральном апартаменте       | Создано в нейтральном апартаменте | Создано в основном потоковом подразделении |



 

## <a name="related-topics"></a>См. также

<dl> <dt>

[**ThreadingModel**](components.md)
</dt> </dl>

 

 
