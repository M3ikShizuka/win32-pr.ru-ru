---
description: Служба событий COM+ использует объект класса событий для управления соединением между издателем и подписчиком.
ms.assetid: 877c5890-588d-4978-8fb2-b4ecf4134068
title: Объект класса событий COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aae397f647354ac24395fa073365160829a687a2
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103990539"
---
# <a name="the-com-event-class-object"></a>Объект класса событий COM+

Служба событий COM+ использует *объект класса событий* для управления соединением между издателем и подписчиком. Объект класса событий — это компонент COM+, который управляется и хранится в системе событий COM+ и содержит интерфейсы и методы, используемые издателем для запуска событий. Это постоянный объект, указывающий события, которые могут возникнуть и, при необходимости, идентифицирует издателя. Вы указываете интерфейсы и методы, которые должен содержать класс событий, предоставляя библиотеку типов.

Чтобы запустить событие, издатель создает экземпляр объекта класса событий, вызывая [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) или метод Microsoft Visual Basic **CreateObject** и запрашивая интерфейс события. Объект класса событий с экземпляром содержит реализацию системы событий запрошенного интерфейса. Заинтересованный подписчик также должен реализовать интерфейс класса событий для получения событий от данного издателя. При создании экземпляра объекта класса событий система событий связывает его с соответствующими подписчиками. Список подписчиков сохраняется в течение времени существования объекта класса событий. Событие может быть доставлено нескольким подписчикам последовательно или параллельно.

При реализации объекта класса событий необходимо предоставить самостоятельную библиотеку DLL, которая экспортирует функции [**DllRegisterServer**](/windows/desktop/api/olectl/nf-olectl-dllregisterserver) и [**DllUnregisterServer**](/windows/desktop/api/olectl/nf-olectl-dllunregisterserver) . Функция **DllRegisterServer** регистрирует COM-класс, а функция **DllUnregisterServer** отменяет регистрацию компонента. Объекты класса событий хранятся в каталоге COM+ либо с помощью средства администрирования служб компонентов, либо программно с помощью методов интерфейсов [**икомадминкаталог:: инсталлевенткласс**](/windows/desktop/api/ComAdmin/nf-comadmin-icomadmincatalog-installeventclass) или [**Икомадминкаталог:: инсталлмултипливентклассес**](/windows/desktop/api/ComAdmin/nf-comadmin-icomadmincatalog-installmultipleeventclasses) . Подробные сведения о регистрации объектов класса событий см. в разделе [Регистрация класса событий](registering-an-event-class.md).

Поскольку объекты класса событий — это компоненты, другие атрибуты, такие как очереди, транзакции, безопасность и т. д., могут быть настроены для них с помощью средства администрирования служб компонентов или функций административного пакета SDK для COM+.

> [!Note]  
> Служба событий COM+ использует маршалирование библиотеки типов. Это накладывает некоторые ограничения на интерфейсы класса событий. Например, модуль упаковки библиотеки типов не поддерживает [**размер \_**](/windows/desktop/Midl/size-is) атрибутов MIDL, а [**length \_ имеет длину**](/windows/desktop/Midl/length-is).

 

Объект класса событий обладает атрибутами публикации, которые определяют способ публикации событий, а также следующие свойства:

-   **Евентклсид**. Уникальный идентификатор, указывающий идентификатор CLSID компонента.
-   **Евенткласснаме**. Уникальный идентификатор, указывающий идентификатор PROGID компонента.
-   **Библиотеку типов**. Предоставляет список интерфейсов, предоставляемых объектом класса событий. Нет необходимости реализовывать интерфейсы обработки, указанные в библиотеке типов.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Вопросы безопасности событий COM+](com--events-security-considerations.md)
</dt> <dt>

[Фильтрация событий в COM+](filtering-events-in-com-.md)
</dt> <dt>

[Публикация и доставка событий в COM+](publishing-and-delivering-events-in-com-.md)
</dt> <dt>

[Подписки](subscriptions.md)
</dt> <dt>

[Использование событий COM+ с компонентами в очереди COM+](using-com--events-with-com--queued-components.md)
</dt> </dl>

 

 
