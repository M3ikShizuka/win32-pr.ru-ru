---
description: Безопасность очередей компонентов
ms.assetid: 3fbeb81a-e3e4-495b-b891-896877fab92f
title: Безопасность очередей компонентов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 682a9b409df2f605c259a6af6741dcc6e59d9fc23852b950a13225b24386c010
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118547086"
---
# <a name="queued-components-security"></a>Безопасность очередей компонентов

Когда клиент выполняет вызов метода в очередь объекта, фактически выполняется вызов средства записи, который упаковывает его как часть сообщения на сервер. Прослушиватель считывает сообщение из очереди и передает его проигрывателю. Проигрыватель вызывает фактический серверный компонент и выполняет тот же вызов метода. Серверный компонент должен наблюдать за контекстом вызова безопасности клиента (а не с контекстом вызова безопасности проигрывателя), когда проигрыватель выполняет вызов метода. Средство записи маршалирует контекст вызова безопасности клиента в сообщение, а проигрыватель демаршалирует его на сервер перед вызовом метода. Что касается объекта сервера, в контексте безопасности между прямым вызовом клиента и непрямым вызовом из проигрывателя нет различий между ними. В частности, вызываемые методы выполняются с привилегиями отправителя.

Компонент в очереди COM+ поддерживает семантику безопасности на основе ролей так же, как и другие компоненты, созданные для использования с приложениями COM+. Таким образом, компоненты приложения, помещенного в очередь, могут использовать программные интерфейсы для обнаружения членства в роли вызывающего объекта ([**исекуритикаллконтекст:: искаллеринроле**](/windows/desktop/api/ComSvcs/nf-comsvcs-isecuritycallcontext-iscallerinrole)) или определенного пользователя ([**Исекуритикаллконтекст:: исусеринроле**](/windows/desktop/api/ComSvcs/nf-comsvcs-isecuritycallcontext-isuserinrole)). Рекомендуется, чтобы все компоненты в очереди с потенциальным влиянием на безопасность использовали эти интерфейсы для явной проверки учетных данных отправителя.

Удостоверение вызывающего объекта — это удостоверение, связанное с вызовом метода. Удостоверение вызывающего объекта используется системой безопасности на основе ролей и содержится в контексте вызова безопасности. В компонентах, помещенных в очередь, удостоверение абонента представляется в виде данных в сообщении очереди сообщений. Служба очереди сообщений проверяет подлинность удостоверения отправителя сообщений. Если удостоверение вызывающей стороны и удостоверение отправителя сообщений одинаковы, то служба очередей сообщений выполняет проверку подлинности как сообщения, так и вызывающего. Это обычный случай.

> [!Note]  
> Компоненты, поставленные в очередь COM+, не поддерживают безопасность в стиле олицетворения, что позволяет серверу получить маркер доступа, соответствующий удостоверению клиента, и использовать его для выполнения проверок контроля доступа или для работы в контексте Client Security.

 

Когда вызывающая сторона компонента из очереди взаимодействует с компонентом через необработанный регистратор, идентификаторы вызывающего и отправителя сообщений могут отличаться. В этом случае компоненты, поставленные в очередь COM+, проверяют, что отправитель сообщения является членом роли доверенного пользователя QC на сервере. Кроме того, для необработанного средства записи требуется сертификат проверки подлинности, так как он проходит проверку подлинности с помощью очереди сообщений.

Членам роли доверенного пользователя QC разрешено указывать произвольное удостоверение, что означает, что злоумышленник может выполнить вызов компонента в очереди с повышенными привилегиями. Поэтому рекомендуется, чтобы количество таких пользователей хранилось в абсолютном минимальном объеме.

Из-за риска сложной атаки, связанной с любым механизмом, который распространяет удостоверение по сети, а также риск простой атаки типа "отказ в обслуживании" путем переполнения очередей с помощью неисполняемых запросов, рекомендуется развертывать службу COM+ в очереди только в сети доверенных узлов, например  в частной сети или виртуальной частной сети или за соответствующим образом настроенным брандмауэром.

Компоненты, поставленные в очередь COM+, выполняются через DCOM, поэтому вы можете защитить целостность и секретность вызовов методов в очереди, выбрав параметр " **Конфиденциальность пакетов** " в качестве **уровня проверки подлинности для вызовов** на вкладке " **Безопасность** " на странице **свойств** вашего приложения, помещенного в очередь.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Безопасность COM+](com--security.md)
</dt> <dt>

[Ограничения безопасности в режиме рабочей группы](security-limitations-in-workgroup-mode.md)
</dt> <dt>

[Указание протокола проверки подлинности](specifying-the-authentication-protocol.md)
</dt> </dl>

 

 



