---
description: Создание фильтра издателя
ms.assetid: d91efecc-f02a-41c6-acf7-37b74723e7e8
title: Создание фильтра издателя
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 997fe37cf0021bcb2aa153c2dc4b73597e0c43cc
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104142610"
---
# <a name="creating-a-publisher-filter"></a>Создание фильтра издателя

Существует два метода для установки фильтра издателя: с помощью свойства Мултипублишерфилтерклсид класса событий или с помощью [**иевентконтрол:: сетпублишерфилтер**](/windows/desktop/api/Eventsys/nf-eventsys-ieventcontrol-setpublisherfilter).

-   Так как он позволяет составлять объект события с помощью службы [очередей компонентов COM+](com--queued-components.md) , предпочтительным методом является использование свойства мултипублишерфилтерклсид в классе событий для установки фильтра издателя. Это устанавливает один объект фильтра для всех методов интерфейсов событий для объекта события. Объект события активирует фильтр издателя при создании экземпляра объекта класса событий с помощью функции [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance).
-   Можно также использовать [**сетпублишерфилтер**](/windows/desktop/api/Eventsys/nf-eventsys-ieventcontrol-setpublisherfilter). Однако при выборе этого метода интерфейс не куеуабле и, следовательно, не сможет использовать объект события с службой COM+ Components Queues между издателем и объектом класса событий. Дополнительные сведения об использовании службы очередей компонентов с событиями COM+ см. в разделе [Использование событий COM+ с компонентами, помещенными в очередь com+](using-com--events-with-com--queued-components.md).

Событие может иметь один или несколько объектов Filter или ни одного. Объекты фильтра издателя должны поддерживать либо [**ипублишерфилтер**](/windows/desktop/api/EventSys/nn-eventsys-ipublisherfilter) , либо [**имултиинтерфацепублишерфилтер**](/windows/desktop/api/EventSys/nn-eventsys-imultiinterfacepublisherfilter), в зависимости от того, имеется ли один или несколько обработчиков, которые обрабатывались в объекте класса событий. В интерфейсах **ипублишерфилтер** и **Имултиинтерфацепублишерфилтер** задан метод **Initialize** . Метод **Initialize** вызывается объектом класса событий сразу после создания объекта фильтра.

События COM+ пытаются вызвать два метода в фильтре. Сначала он вызывает [**ипублишерфилтер::P репаретофире**](/windows/desktop/api/EventSys/nf-eventsys-ipublisherfilter-preparetofire) и передает в фильтр указатель интерфейса [**ифирингконтрол**](/windows/desktop/api/EventSys/nn-eventsys-ifiringcontrol) . Затем он запрашивает объект фильтра для интерфейса событий. Если фильтр поддерживает интерфейс событий, он вызывает для него метод. Это обеспечивает доступ к параметрам издателя для события. Фильтр может использовать эти параметры, чтобы определить, какие подписки следует активировать.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Фильтрация событий в COM+](filtering-events-in-com-.md)
</dt> </dl>

 

 
