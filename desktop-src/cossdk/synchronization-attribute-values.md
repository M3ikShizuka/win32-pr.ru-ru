---
description: Атрибут синхронизации — это декларативное свойство, которое указывает, какой тип синхронизации должен иметь компоненты при активации.
ms.assetid: 7f044ee5-b99e-4f0c-a680-b1e2672949fc
title: Значения атрибутов синхронизации
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4606726d5202a1453e98d5bf609084982f8f824e
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104423310"
---
# <a name="synchronization-attribute-values"></a>Значения атрибутов синхронизации

Атрибут синхронизации — это декларативное свойство, которое указывает, какой тип синхронизации должен иметь компоненты при активации. При включении атрибута синхронизации COM+ обрабатывает сведения о синхронизации от вашего имени; никаких других вызовов делать не нужно.

В зависимости от требований объект может совместно использовать синхронизацию вызывающего объекта, требовать новую синхронизацию или выполнять синхронизацию без синхронизации.

COM+ предоставляет следующие значения атрибутов синхронизации:

-   **Отключены.** При отключении атрибута синхронизации COM+ игнорирует требования синхронизации компонента в определении контекста для объекта. В результате объект может или не может совместно использовать контекст вызывающего объекта (и синхронизацию).

    В общем случае следует использовать это значение атрибута, если известно, что компонент никогда не обращается к диспетчеру ресурсов. При переносе COM-компонентов в COM+ необходимо отключить атрибут синхронизации, чтобы обеспечить то же поведение, что и ненастроенный COM-компонент. Ненастроенный компонент — это COM-компонент, который не был установлен в приложении COM+.

-   **Не поддерживается.** Объект с этим значением никогда не участвует в синхронизации, независимо от состояния своего вызывающего объекта. Этот параметр доступен только для компонентов, которые являются нетранзакционными и не используют службу JIT- [активации COM+](com--just-in-time-activation.md) .

-   **Поддерживается.** Объект с этим значением участвует в синхронизации, если он существует. Это значение объявляется, если требуется, чтобы объект был совместно использоваться в синхронизации вызывающего объекта, но не требовал синхронизации собственного.

    Хорошей причиной установки атрибута синхронизации является то, что этот параметр может быть менее затратным в плане системных ресурсов. Тем не менее, гораздо сложнее написать компонент из-за необходимости его защиты от одновременных вызовов. Смысл установки атрибута синхронизации в значение support заключается в том, что при определенных обстоятельствах экземпляр объекта может быть создан таким образом, что он не синхронизирован. Если потоковая модель компонента бесплатна или обе версии, необходимо защитить данные экземпляра с помощью некоторого типа механизма блокировки. Если потоковая модель является Апартаментной (STA), вам не нужно защищать данные экземпляра.

-   **Обязательный.** При задании этого атрибута COM+ гарантирует, что все объекты, создаваемые из компонента, будут синхронизированы. Фактически, каждый раз, когда COM+ создает экземпляр компонента, это гарантирует, что в каждый момент времени только один поток проходит через этот экземпляр.

    Когда COM+ активирует объект, он проверяет состояние синхронизации вызывающего объекта. Если вызывающий объект является синхронизированным, COM+ помещает границу синхронизации вызывающего объекта в, чтобы включить новый объект. В противном случае COM+ начинает синхронизацию.

-   **Требуется New.** Объект с этим значением должен участвовать в новой синхронизации, где COM+ управляет контекстами и апартаментами от имени всех компонентов, участвующих в вызове. COM+ автоматически инициирует новую синхронизацию, которая отличается от синхронизации вызывающего объекта.

    Чтобы задать для атрибута синхронизации значение New, следует использовать этот параметр, чтобы более эффективно делать внешние вызовы к экземпляру компонента. Однако он также выполняет вызовы между объектом и объектом, который создал его с точки зрения системных ресурсов.

    Например, предположим, что у объекта и его объекта-создателя есть общая граница синхронизации. Если клиент A вызывает объект Creator и клиент б вызывает объект, то второй вызов будет ожидать завершения первого вызова. Если задано значение требуется новое, объект создается в отдельной границе синхронизации. В этом случае вызовы из других объектов могут обрабатываться одновременно. Однако вызовы от объекта-создателя к объекту необходимы для большего количества системных ресурсов, так как они должны пересекать границы синхронизации.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Настройка атрибута синхронизации](setting-the-synchronization-attribute.md)
</dt> <dt>

[Зависимости синхронизации](synchronization-dependencies.md)
</dt> </dl>

 

 



