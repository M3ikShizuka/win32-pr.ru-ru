---
description: Настроенный COM-компонент обычно активируется в собственном контексте; Это значит, что COM+ ссылается на сведения каталога компонентов, чтобы предоставить все настроенные службы.
ms.assetid: 09dc7165-22b1-4eca-9591-d83e85556f3f
title: Принудительная активация в контексте по умолчанию
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d188fb50521e09c88a9c61136e33928176faa1f70a94680b31cf0cc1e75cb8eb
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "120070764"
---
# <a name="enforcing-activation-in-the-default-context"></a>Принудительная активация в контексте по умолчанию

Настроенный COM-компонент обычно активируется в собственном контексте; Это значит, что COM+ ссылается на сведения о каталоге компонента, чтобы предоставить все настроенные службы. Однако можно активировать настроенный компонент в контексте по умолчанию. Базовый COM-компонент — зарегистрированный компонент, который не содержит сведений о каталоге COM+, обычно активируется в контексте по умолчанию.

Активация COM-компонента в контексте по умолчанию предоставляет три основных преимущества производительности, как показано ниже.

-   Системные ресурсы сохраняются путем ограничения количества создаваемых контекстов.
-   Вы увеличиваете производительность, ограничивая количество вызовов между контекстами. Поскольку для вызовов между контекстами требуется маршалирование, для COM-объекта, активируемого в контексте по умолчанию, гораздо быстрее выполнять вызовы других объектов в контексте по умолчанию. В этом случае производительность (вызовов в одном и том же контексте) аналогична производительности вызова подпрограммы.
-   Вы можете импортировать старые приложения COM в COM+ и запустить их без проблем. Например, у вас может быть несколько старых приложений COM, реализованных в соответствии с предположением, что это позволяло передавать ссылки на объекты в подразделении без маршалирования ссылок. Эти COM-приложения не работают при импорте в COM+, так как ссылки на объекты передаются через границы контекста. Однако этот тип приложения COM можно запустить при импорте, если вы используете средство администрирования "службы компонентов", чтобы пометить все классы в приложении как которые **должны быть активированы в контексте по умолчанию**.

Основным недостатком активации настроенного компонента в контексте по умолчанию является то, что COM+ не предоставляет какие-либо настроенные службы компонента. Существует компромисс между улучшенной производительностью и возможностью использования служб COM+.

Например, предположим, что компоненту COM не требуются какие-либо службы COM+ (такие [как транзакции](com--transactions.md), [JIT-активация](com--just-in-time-activation.md), [события](com--events.md), [очереди компонентов](com--queued-components.md), [Синхронизация](com--synchronization.md)или [пул объектов](com--object-pooling.md)) и что компонент выполняет ряд вызовов к другим COM-компонентам, которые могут быть активированы в контексте по умолчанию. В этом случае рекомендуется активировать вызывающий компонент в контексте по умолчанию.

Если компоненту COM требуются службы COM+, он не может быть помечен как **должен быть активирован в контексте по умолчанию**. Кроме того, нет фактического повышения производительности, если COM-объект, активированный в контексте по умолчанию, выполняет несколько вызовов объектов в других контекстах. (Дополнительные сведения см. в разделе [контексты](com--contexts.md).)

**Принудительное применение активации в контексте по умолчанию**

1.  В области сведений средства администрирования "службы компонентов" щелкните правой кнопкой мыши компонент (расположенный в папке **Components** любого выбранного приложения COM+), который требуется активировать в контексте по умолчанию, и выберите пункт **свойства**.

2.  В диалоговом окне Свойства компонента перейдите на вкладку **Активация** .

3.  Установите флажок **должен быть активирован в контексте по умолчанию**.

4.  Нажмите **OK**.

> [!Note]  
> При запуске настроенного компонента в контексте по умолчанию COM+ не активирует ни одну из настроенных служб для этого компонента. Эти службы снова становятся доступными при снятии флажка **необходимо активировать в контексте по умолчанию** и последующем запуске настроенного компонента в собственном контексте.

 

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Основные понятия JIT-активации COM+](com--just-in-time-activation-concepts.md)
</dt> <dt>

[Принудительная активация в контексте вызывающего объекта](enforcing-activation-in-the-caller-s-context.md)
</dt> </dl>

 

 



