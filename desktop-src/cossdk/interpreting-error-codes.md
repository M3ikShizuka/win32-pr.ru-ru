---
description: Анализ кодов ошибок
ms.assetid: df2fe03b-2f5f-4958-926f-17e3a025a9b5
title: Анализ кодов ошибок
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 659ee7def9feff50d375a07ab201e1cca25bffd7
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105673129"
---
# <a name="interpreting-error-codes"></a>Анализ кодов ошибок

Определив, какое приложение является источником проблемы, необходимо выяснить, какая ошибка возникла. Ошибки возникают и сообщаются в разных форматах в зависимости от языка, используемого приложением.

В Microsoft Visual C++ значения успеха, предупреждения и сбоя возвращаются с помощью 32-разрядного числа, известного как **HRESULT**. Список определенных системой значений **HRESULT** см. в файле заголовка Winerror. h, который входит в состав Windows SDK. Этот файл содержит все коды и описания ошибок COM+. Дополнительные сведения о значениях **HRESULT** см. в разделе [Обработка ошибок](/windows/desktop/com/error-handling-in-com).

На языке Java создается экземпляр COM. MS. com. Комфаилексцептион для обозначения сбоя, где объект Комфаилексцептион указывает **HRESULT**. Экземпляр COM. MS. com. Комсукцессексцептион указывает на успешное выполнение с возвращаемым значением false. Сведения об интерпретации этих исключений см. в документации по Microsoft Visual J++.

> [!Note]  
> Процессы сервера приложений COM+, в которых размещаются объекты Visual J++, не будут бездействовать (даже с нулевыми активными объектами), если не отключить JIT-отладку в интегрированной среде разработки VJ6. Сведения о том, как это сделать, см. в документации по Visual J++.

 

В Visual Basic можно получить значения **HRESULT** , изучив свойство Err. Number. Описание ошибки можно получить с помощью свойства Err. Description.

Служебную программу ERRLOOK можно также использовать в Microsoft Visual Studio для получения сообщения о системной ошибке или сообщения об ошибке модуля. ERRLOOK автоматически извлекает текст сообщения об ошибке при перетаскивании шестнадцатеричного или десятичного значения из отладчика Visual Studio или другого приложения с поддержкой автоматизации. Можно также ввести значение, либо введя его в буфер IDE, либо вставляя его из него, а затем выбрав пункт **Поиск** .

Следующий метод C++ выводит описание ошибки на основе входного **значения HRESULT**.


```C++
#include <stdio.h>
#include <windows.h>
#include <tchar.h>

void ErrorDescription(HRESULT hr) 
{ 
     if(FACILITY_WINDOWS == HRESULT_FACILITY(hr)) 
         hr = HRESULT_CODE(hr); 
     TCHAR* szErrMsg; 

     if(FormatMessage( 
       FORMAT_MESSAGE_ALLOCATE_BUFFER|FORMAT_MESSAGE_FROM_SYSTEM, 
       NULL, hr, MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT), 
       (LPTSTR)&szErrMsg, 0, NULL) != 0) 
     { 
         _tprintf(TEXT("%s"), szErrMsg); 
         LocalFree(szErrMsg); 
     } else 
         _tprintf( TEXT("[Could not find a description for error # %#x.]\n"), hr); 
}
```



В следующей таблице приведены описания распространенных кодов ошибок в COM+.



| Коды ошибок                                                   | Определения                                                                                                                                                                                                      |
|---------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| КОМАДМИН \_ E \_ алреадинсталлед<br/>                      | Объект уже зарегистрирован.<br/>                                                                                                                                                                     |
| \_ \_ файл приложения комадмин \_ E \_ реадфаил<br/>                   | Произошла ошибка при чтении файла приложения.<br/>                                                                                                                                                          |
| \_ \_ \_ Версия файла приложения комадмин \_ E<br/>                    | Недопустимый номер версии в файле приложения.<br/>                                                                                                                                                           |
| \_ \_ файл приложения комадмин \_ E \_ вритефаил<br/>                  | Произошла ошибка при записи в файл приложения.<br/>                                                                                                                                                       |
| КОМАДМИН \_ E \_ аппдирнотфаунд<br/>                        | Каталог установки приложения не найден.<br/>                                                                                                                                                          |
| \_приложение комкк \_ E \_ не \_ поставлено в очередь<br/>                 | Только приложения COM+, помеченные как "поставленные в очередь", можно создавать с помощью моникера "Queue".<br/>                                                                                                                      |
| КОМАДМИН \_ E \_ аппликатионексистс<br/>                     | Приложение уже установлено.<br/>                                                                                                                                                                 |
| КОМАДМИН \_ E \_ апплид \_ соответствует \_ CLSID<br/>                | На этом компьютере уже установлен CLSID с таким же идентификатором GUID, как и у нового идентификатора приложения.<br/>                                                                                                            |
| \_приложение комадмин \_ \_ не \_ работает<br/>                     | Указанное приложение в данный момент не выполняется.<br/>                                                                                                                                                   |
| КОМАДМИН \_ E \_ аусентикатионлевел<br/>                   | Не удалось задать требуемый уровень проверки подлинности для запроса на обновление.<br/>                                                                                                                                       |
| КОМАДМИН \_ E \_ бадпас<br/>                               | Недопустимый путь к файлу.<br/>                                                                                                                                                                             |
| КОМАДМИН \_ E \_ бадрегистрилибид<br/>                      | Недопустимый идентификатор зарегистрированной библиотеки типов.<br/>                                                                                                                                                            |
| КОМАДМИН \_ E \_ бадрегистрипрогид<br/>                     | ProgID компонента отсутствует или поврежден.<br/>                                                                                                                                                         |
| КОМАДМИН \_ е \_ \_ не может \_ экспортировать \_ \_ прокси приложения<br/>          | Прокси приложения не может быть экспортирован.<br/>                                                                                                                                                              |
| КОМАДМИН \_ е \_ \_ не удается \_ запустить \_ приложение<br/>                  | Не удалось запустить приложение, так как это либо приложение библиотеки, либо прокси приложения.<br/>                                                                                                       |
| КОМАДМИН \_ е \_ \_ не удается \_ экспортировать \_ \_ приложение sys<br/>            | Системное приложение не может быть экспортировано.<br/>                                                                                                                                                             |
| КОМАДМИН \_ е не \_ удается \_ подписываться \_ на \_ компонент<br/>        | Пользователь не может подписываться на этот компонент, так как компонент мог быть импортирован.<br/>                                                                                                             |
| КОМАДМИН \_ E \_ канткопифиле<br/>                          | Произошла ошибка при копировании файла.<br/>                                                                                                                                                                   |
| КОМАДМИН \_ E \_ клсидориидмисматч<br/>                    | Идентификаторы CLSID файла приложения или идентификаторов IID не соответствуют соответствующим библиотекам DLL.<br/>                                                                                                                                      |
| КОМАДМИН \_ . \_ \_ Перемещение \_ неверного \_ приемника<br/>                 | Произошел сбой при перемещении компонента, так как конечное приложение больше не существует.<br/>                                                                                                                       |
| КОМАДМИН \_ , \_ \_ Блокировка перемещения \_<br/>                    | Перемещение компонента запрещено, так как исходное или конечное приложение либо является системным приложением, либо в настоящий момент заблокировано для изменений.<br/>                                                |
| КОМАДМИН \_ E \_ компфиле \_ бадтлб<br/>                      | Не удалось загрузить библиотеку типов.<br/>                                                                                                                                                                 |
| КОМАДМИН \_ E \_ компфиле \_ класснотаваил<br/>               | Библиотека DLL не поддерживает компоненты, перечисленные в библиотеке типов.<br/>                                                                                                                                   |
| КОМАДМИН \_ E \_ компфиле \_ доеснотексист<br/>                | Этот файл не существует.<br/>                                                                                                                                                                             |
| КОМАДМИН \_ E \_ компфиле \_ жетклассобж<br/>                 | Сбой метода [**жетклассобжект**](/windows/desktop/api/objidl/nf-objidl-iclassactivator-getclassobject) в библиотеке DLL.<br/>                                                                                                                |
| КОМАДМИН \_ E \_ компфиле \_ лоаддллфаил<br/>                 | Не удалось загрузить библиотеку DLL.<br/>                                                                                                                                                                          |
| КОМАДМИН \_ E \_ компфиле \_ регистратор<br/>                 | Регистратор компонентов, упоминаемый в этом файле, недоступен.<br/>                                                                                                                                     |
| КОМАДМИН \_ E \_ компфиле \_ нотинсталлабле<br/>              | Файл не содержит компоненты или сведения о компоненте.<br/>                                                                                                                                        |
| КОМАДМИН \_ E \_ кореккомпинсталлед<br/>                    | Компонент в той же библиотеке DLL уже установлен.<br/>                                                                                                                                                     |
| КОМАДМИН \_ E \_ длллоадфаилед<br/>                         | Не удалось загрузить библиотеку DLL.<br/>                                                                                                                                                                          |
| КОМАДМИН, функция \_ \_ DLLREGISTERSERVER<br/>                     | Ошибка функции [**DllRegisterServer**](/windows/desktop/api/olectl/nf-olectl-dllregisterserver) при установке компонента.<br/>                                                                                                  |
| КОМАДМИН \_ E \_ EVENTCLASS \_ \_ не может быть \_ подписчиком<br/>      | Класс событий не может быть настроен в качестве компонента подписчика. При попытке создать подписку с классом событий в качестве подписчика возвращается эта ошибка.<br/>                          |
| КОМАДМИН \_ E \_ инвалидусеридс<br/>                        | Один или несколько пользователей в файле приложения недопустимы.<br/>                                                                                                                                              |
| КОМАДМИН \_ E \_ кэймиссинг<br/>                            | Объект не найден в каталоге.<br/>                                                                                                                                                              |
| \_ \_ прокси приложения комадмин E lib \_ \_ \_ несовместим<br/>         | Библиотечные приложения и прокси приложений несовместимы. Эта ошибка возвращается при попытке экспорта прокси приложения, если свойство активации приложения является библиотекой. <br/> |
| КОМАДМИН \_ E \_ норегистриклсид<br/>                       | CLSID компонента отсутствует или поврежден.<br/>                                                                                                                                                          |
| КОМАДМИН \_ E \_ носервершаре<br/>                         | Общая папка сервера недоступна.<br/>                                                                                                                                                                    |
| КОМАДМИН \_ E \_ нотчанжеабле<br/>                         | Изменения в этом объекте и его вложенных объектах были отключены.<br/>                                                                                                                                        |
| КОМАДМИН \_ E \_ нотделетеабле<br/>                         | Функция удаления отключена для этого объекта.<br/>                                                                                                                                                |
| КОМАДМИН \_ E \_ нотинрегистри<br/>                         | Объект не найден в реестре.<br/>                                                                                                                                                                     |
| КОМАДМИН \_ E \_<br/>                                | Один или несколько пользователей недопустимы.<br/>                                                                                                                                                                      |
| \_объект комадмин \_ E \_ \_ не \_ существует<br/>              | Не удается найти один из указанных объектов.<br/>                                                                                                                                                         |
| \_ \_ \_ отсутствует родительский объект комадмин E \_<br/>               | Один из объектов, которые вставляются или обновляются, не принадлежит допустимой родительской коллекции.<br/>                                                                                                            |
| КОМАДМИН \_ E \_ обжектеррорс<br/>                          | Произошли ошибки при доступе к одному или нескольким объектам. Дополнительные сведения см. в статье о коллекции [**errorInfo**](errorinfo.md) .<br/>                                                                               |
| КОМАДМИН \_ E \_ обжектексистс<br/>                          | Объект, который вы пытаетесь добавить или переименовать, уже существует.<br/>                                                                                                                                        |
| КОМАДМИН \_ E \_ обжектинвалид<br/>                         | Одно или несколько свойств объекта отсутствуют или являются недопустимыми.<br/>                                                                                                                                        |
| КОМАДМИН \_ E \_ обжектнотпулабле<br/>                     | Этот объект не может быть помещен в пул.<br/>                                                                                                                                                                      |
| КОМАДМИН \_ E \_ пропертисавефаилед<br/>                    | Одно или несколько параметров свойств либо недопустимы, либо конфликтуют друг с другом.<br/>                                                                                                                      |
| \_ \_ переполнение свойства комадмин E \_<br/>                    | Значение свойства слишком велико.<br/>                                                                                                                                                                      |
| КОМАДМИН \_ E \_ регфиле \_ поврежден<br/>                      | Файл регистрации поврежден.<br/>                                                                                                                                                                     |
| КОМАДМИН \_ E \_ регистертлб<br/>                           | Системе не удалось зарегистрировать библиотеку типов.<br/>                                                                                                                                                   |
| КОМАДМИН \_ E \_ регистрарфаилед<br/>                       | Произошли ошибки в регистраторе компонентов.<br/>                                                                                                                                                     |
| КОМАДМИН \_ E \_ ремотеинтерфаце<br/>                       | Сведения об интерфейсе отсутствуют или изменены.<br/>                                                                                                                                                   |
| для КОМАДМИН \_ E \_ требуется \_ другая \_ платформа<br/>         | Эта операция не включена на этой платформе.<br/>                                                                                                                                                       |
| \_роль комадмин E не \_ \_ \_ \_ существует<br/>                | Роль, назначенная компоненту, интерфейсу или методу, не существует в приложении.<br/>                                                                                                               |
| КОМАДМИН \_ E \_ роликсистс<br/>                            | Роль уже существует.<br/>                                                                                                                                                                              |
| КОМАДМИН \_ E \_ сервиценотинсталлед<br/>                   | Служба не установлена.<br/>                                                                                                                                                                         |
| \_сеанс комадмин E \_<br/>                               | Версия каталога сервера не поддерживается.<br/>                                                                                                                                                          |
| КОМАДМИН \_ S \_ сомеалреадипаусед<br/>                     | Один или несколько из указанных процессов приложения уже приостановлены.<br/>                                                                                                                               |
| КОМАДМИН \_ S \_ сомеалреадируннинг<br/>                    | Один или несколько указанных процессов приложения уже запущены.<br/>                                                                                                                              |
| КОМАДМИН \_ \_ Запуск \_ приложения \_ требует \_ компонентов<br/>         | Для запуска приложения необходимо, чтобы в приложении были компоненты.<br/>                                                                                                                                 |
| КОМАДМИН \_ E \_ свкапп \_ не является \_ пулом \_ или \_ изготавливается<br/> | Приложения COM+, работающие в качестве службы NT, могут не помечаться как помещенные в пул или перезапускаются.<br/>                                                                                                               |
| КОМАДМИН \_ E \_ системапп<br/>                             | Эта операция не может быть выполнена в системном приложении.<br/>                                                                                                                                         |
| \_пользователь комадмин \_ E \_ в \_ наборе<br/>                         | Один или несколько пользователей уже назначены локальному набору разделов.<br/>                                                                                                                                      |
| КОМАДМИН \_ E \_ усерпассвднотвалид<br/>                    | Для приложения задано недопустимое удостоверение или пароль.<br/>                                                                                                                                         |



 

## <a name="related-topics"></a>См. также

<dl> <dt>

[Изоляция сбоев и политика FailFast](fault-isolation-and-failfast-policy.md)
</dt> <dt>

[Поиск источника ошибки](finding-the-source-of-an-error.md)
</dt> <dt>

[Изменение возвращаемых значений COM+](how-com--modifies-return-values.md)
</dt> <dt>

[Стратегии обработки ошибок в COM+](strategies-for-handling-errors-in-com-.md)
</dt> <dt>

[Устранение неполадок](troubleshooting-the-com--crm.md)
</dt> </dl>

 

