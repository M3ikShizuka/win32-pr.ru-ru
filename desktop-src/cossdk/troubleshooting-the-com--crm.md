---
description: Устранение неполадок COM+ CRM
ms.assetid: 4d2d9372-b540-4e08-9b57-8687802610b6
title: Устранение неполадок COM+ CRM
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1b04e37d183dbf3df8d017e780917f955e14a033
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104539050"
---
# <a name="troubleshooting-the-com-crm"></a>Устранение неполадок COM+ CRM

Ниже перечислены наиболее распространенные проблемы, возникающие при разработке и использовании COM+ CRM.

-   **Сообщения журнала событий.** Если серверное приложение CRM обнаруживает серьезную внутреннюю ошибку, оно будет FailFast (завершить процесс серверного приложения CRM) и записать сообщение в журнал событий Windows. Если возникнут проблемы, обратитесь к журналу событий.

-   **Исключения из компенсатора CRM.** Инфраструктура CRM создает компенсатор CRM и передает ему уведомления о результатах транзакции и записи журнала, записанные рабочим работником CRM. Если CRM-компенсатор возвращает ошибку или создает исключение, оно перехватывается инфраструктурой CRM и вызывает FailFast. Сообщение в журнале событий указывает на то, что было получено исключение от компенсатора CRM. Эти исключения можно игнорировать. (См. [раздел Параметры системного реестра com+ CRM](com--crm-registry-settings.md).) Исключения из компенсатора CRM, скорее всего, означают проблему в конкретном компоненте CRM Compensator, а не в самой инфраструктуре CRM.

-   **Трассировка восстановления.** Трассировка восстановления может быть очень полезной для определения проблем во время восстановления. Дополнительные сведения о включении трассировки восстановления см. в разделе [параметры реестра com+ CRM](com--crm-registry-settings.md).

-   **Попытка запуска с CRM не включена.** Не достаточно просто поместить компоненты CRM Worker и CRM Compensator в серверное приложение COM+. Поддержка Крмс должна быть специально включена для конкретного серверного приложения COM+ с помощью параметра **Включить компенсирующие диспетчеры ресурсов** на вкладке **Дополнительно** страницы свойств приложения COM+. (Дополнительные сведения см. в разделе [Настройка компонентов COM+ CRM](configuring-com--crm-components.md) .) При попытке использовать CRM внутри серверного приложения, на котором не включен CRM, в рабочую роль CRM возвращается код ошибки.

-   **Попытка запуска Крмс в клиентских процессах.** Крмс не выполняются в клиентских процессах; они должны выполняться в процессе серверного приложения COM+. Компоненты CRM могут быть помещены в пакет библиотеки для использования несколькими серверными приложениями COM+, но они недоступны для использования в клиентских процессах. При попытке использовать интерфейсы CRM внутри клиентского процесса возвращается код ошибки для рабочей роли CRM.

-   **Выполняется восстановление.** Восстановление запускается при запуске приложения сервера CRM. Однако восстановление выполняется в фоновом режиме во время нормальной обработки серверного приложения CRM. Рабочую роль CRM можно создать до завершения восстановления. Крмс нельзя использовать в процессе серверного приложения CRM до успешного завершения восстановления. В этом случае Рабочая роль CRM получает код ошибки "выполняется восстановление" при попытке зарегистрировать компенсатор CRM. Рабочая роль CRM должна опрашивать или иным образом откладываться до завершения восстановления. Время восстановления зависит от конкретного типа CRM, и его следует учитывать при проектировании CRM. Операции восстановления длительной длительности не являются желательными.

-   **Безопасность файла журнала CRM.** Если доступ к файлу журнала CRM запрещен, ознакомьтесь со статьей [вопросы безопасности COM+ CRM](com--crm-security-considerations.md) , описывающие, как задается безопасность в файле журнала CRM.

-   **Сомнительные транзакции.** В редких случаях транзакция DTC может переключиться в состояние «под сомнением». то есть DTC не может определить результат транзакции. В таких случаях в процессе восстановления CRM хранит записи журнала для этой транзакции в файле журнала CRM. Если транзакция с сомнительными проблемами была разрешена координатором DTC, выполнение транзакции завершается другим восстановлением CRM.

-   **Создание и выпуск компенсатора CRM.** При первом регистрации компенсатора CRM работником CRM он создается инфраструктурой CRM и запрашивается для определения того, какой из поддерживаемых им интерфейсов компенсатора CRM. Затем он немедленно освобождается. Компенсаторы CRM должны поддерживать возможность создания и освобождения без промежуточных вызовов методов. Если компенсатор CRM не может быть создан правильно, возможно, из-за неправильной регистрации COM или если он не поддерживает хотя бы один из правильных интерфейсов CRM, то в рабочую роль CRM возвращается код ошибки.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Основные понятия о компенсации диспетчер ресурсов COM+](com--compensating-resource-manager-concepts.md)
</dt> </dl>

 

 



