---
description: Функцию автоматического завершения можно включить для любого метода, предоставляемого компонентом, для которого включена JIT-активация COM+. Если JIT-активация отключена, автозавершение недоступно.
ms.assetid: d699b85c-441f-4ea6-8d03-d1fa9a8a357f
title: Включение автоматического завершения для метода
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0130e5f8b2fde6c6755ef4174892aa35be8a24cd
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105710777"
---
# <a name="enabling-auto-done-for-a-method"></a>Включение автоматического завершения для метода

Функцию автоматического завершения можно включить для любого метода, предоставляемого компонентом, для которого включена JIT-активация COM+. Если JIT-активация отключена, автозавершение недоступно.

Необходимо включить Автозаполнение только для метода, который намеренно написал, чтобы воспользоваться его преимуществами, поскольку эта функция потенциально может изменить ожидаемое поведение метода.

При включении функции автозавершения изменяется поведение JIT-активации и автоматических транзакций для этого метода по умолчанию. Вы можете использовать эту функцию, так как она может устранить необходимость явного объявления согласованности и завершения. Это можно сделать, просто возвращая HRESULT, если включено автозаполнение. По сути, при включении автоматического завершения вы указываете COM+ сделать следующее:

-   Установите бит done равным true по умолчанию для контекста, в котором объект выполняется при каждом вызове метода.
-   Проверьте значение HRESULT, возвращенное методом. Если оно указывает на успешное выполнение или сбой, задайте соответствующим образом бит согласованности. Это может привести к автоматическому вызову [**иобжектконтекст:: сеткомплете**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete) или [**Иобжектконтекст:: SetAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort), в зависимости от того, что делает метод внутренним.

**Включение автоматического завершения для метода**

1.  В области сведений средства администрирования "службы компонентов" щелкните правой кнопкой мыши метод, который необходимо настроить, и выберите пункт **Свойства**.

2.  В диалоговом окне Свойства метода перейдите на вкладку **Общие** .

3.  Чтобы включить автозавершение, установите флажок **автоматически Деактивировать этот объект при возврате из этого метода** . Если флажок недоступен, необходимо сначала включить JIT-активацию для компонента. (Подробные инструкции см.[в разделе Включение JIT-активации для компонента](enabling-jit-activation-for-a-component.md) .)

4.  Нажмите кнопку **ОК**.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Основные понятия JIT-активации COM+](com--just-in-time-activation-concepts.md)
</dt> <dt>

[Включение JIT-активации для компонента](enabling-jit-activation-for-a-component.md)
</dt> <dt>

[Установка бита done](setting-the-done-bit.md)
</dt> </dl>

 

 



