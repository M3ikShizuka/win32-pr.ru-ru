---
description: В каталоге COM+ хранятся атрибуты приложения COM+, атрибуты классов и атрибуты уровня компьютера. Он гарантирует согласованность между этими атрибутами и предоставляет общие операции над этими атрибутами.
ms.assetid: 1838757c-aa8e-4678-8042-207498fb0bbc
title: Каталог COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ad869a6df6a61fc338fe07002512a1de27002788
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105662077"
---
# <a name="the-com-catalog"></a>Каталог COM+

В каталоге COM+ хранятся атрибуты приложения COM+, атрибуты классов и атрибуты уровня компьютера. Он гарантирует согласованность между этими атрибутами и предоставляет общие операции над этими атрибутами.

Каталог COM+ использует два разных хранилища, как показано ниже.

-   База данных регистрации COM+
-   Реестр Windows (**\_ \_ корневой класс классов hKey**)

Каталог представляет единое логическое представление этих двух магазинов и предоставляет их через библиотеку администрирования COM+. Эта библиотека предоставляет, используя язык сценариев, все функциональные возможности средства администрирования служб компонентов.

Для существующих COM-компонентов, которые не нуждаются в новых службах COM+, поиск выполняется в существующем реестре Windows. Каталог COM+ также использует реестр Windows для регистрации библиотеки типов и прокси-сервера интерфейса или заглушки.

## <a name="split-registration"></a>Регистрация разбиения

Для новых компонентов, которые уже являются существующими COM-компонентами, которые используются в среде служб (например, компоненты MTS), основной COM-аспект регистрации хранится в реестре Windows, а новые службы и атрибуты (например, компоненты в очереди) хранятся в базе данных регистрации COM+. Такая *Регистрация называется разделенной регистрацией*.

Каждый атрибут хранится только в одном расположении: в реестре Windows или в базе данных регистрации COM+. Новые COM-компоненты регистрируются исключительно в базе данных регистрации COM+, что приводит к дублированию в реестре Windows, чтобы существующие средства могли их использовать.

## <a name="transactional-updates-to-the-catalog"></a>Обновления транзакций каталога

Некоторые операции с каталогом выполняются в транзакционном режиме. При вызове библиотеки администрирования COM+ из транзакционного компонента обновления базы данных регистрации COM+ будут выполняться в пределах границ транзакции вызывающего компонента.

Однако обновления, затрагивающие изменения в других хранилищах (например, файловую систему и реестр Windows), не обязательно будут полностью транзакционными. Прерванная транзакция может оставить эти магазины в состоянии, которое не согласуется с изменениями, внесенными в друг друга или в базу данных регистрации COM+.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Создание пакетов установки для приложений COM+](creating-installation-packages-for-com--applications.md)
</dt> <dt>

[Развертывание прокси приложения](deploying-application-proxies.md)
</dt> <dt>

[Служебная программа репликации COMREPL](the-comrepl-replication-utility.md)
</dt> </dl>

 

 



