---
description: Строки конструктора объектов COM+ — это строки инициализации, которые задаются администратором для компонента.
ms.assetid: b4915dae-c97c-4d36-95ee-bb10dcb40845
title: Основные понятия о строках конструктора объектов COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9baef62780950e93043a48c2ccf13910faf7c692dc534f984ffd028e0b342dcd
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "120029524"
---
# <a name="com-object-constructor-strings-concepts"></a>Основные понятия о строках конструктора объектов COM+

Строки конструктора объектов COM+ — это строки инициализации, которые задаются администратором для компонента. Можно использовать строки конструктора объектов для записи одного компонента с степенью общего, позволяющей впоследствии настроить ее для конкретной задачи. то есть можно выполнить конструирование параметризованных объектов.

Например, эту функцию можно использовать для записи компонента, содержащего Универсальное подключение ODBC, а позднее указать точное имя DSN для компонента в административном виде. При изменении конфигурации системы можно соответствующим образом изменить строку конструктора.

> [!Note]  
> Строки конструктора объектов не следует использовать для хранения конфиденциальных данных.

 

Вы можете использовать строки конструктора объектов в сочетании с [пулом объектов](com--object-pooling.md) для достижения большей степени детализации в способах пула и повторного использования ресурсов. Например, можно создать несколько отдельных компонентов, идентичных, за исключением строк конструктора и идентификаторов CLSID, для поддержки различных пулов объектов, которые могут использовать соединения с отдельными группами клиентов. Это может оказаться полезным, если соединения открываются способом, который привязывает их к определенным ролям безопасности, например, когда подключения открываются с определенной проверкой подлинности в базе данных, и их не рекомендуется использовать в общем случае.

Для этого можно написать один универсальный компонент, основанный на строках конструктора объектов, с помощью [**интерфейс IObjectConstruct**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectconstruct)и перекомпилировать его для создания нескольких настраиваемых компонентов с отдельным идентификатором CLSID. Затем можно самостоятельно адаптировать каждый компонент, чтобы открыть соответствующее соединение со строкой конструктора, настроить их для группировки в пул, и они будут храниться в разных пулах на каждый CLSID.

Можно указать строку конструктора, если компонент был написан специально для распознавания введенной строки. Компоненты могут получать доступ к этим строкам программным путем с помощью [**интерфейс IObjectConstruct**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectconstruct).

Строки конструктора передаются во время создания объекта только при административном включении создания объектов. COM+ вызывает метод [**интерфейс IObjectConstruct:: конструирует**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectconstruct-construct) , который он реализует. В этом методе можно получить доступ к строке конструктора с помощью [**иобжектконструктстринг**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectconstructstring). Пустые строки могут быть допустимыми записями.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Группирование объектов COM+](com--object-pooling.md)
</dt> <dt>

[Указание строки конструктора объекта для компонента](specifying-an-object-constructor-string-for-a-component.md)
</dt> <dt>

[Использование строки конструктора объекта для создания компонента](using-an-object-constructor-string-to-construct-a-component.md)
</dt> </dl>

 

 



