---
description: Диспетчер распределителя предоставляет пулы ресурсов для распределительов ресурсов и гарантирует, что ресурс, предоставленный распределителем ресурсов, будет правильно прикреплен в транзакции объектов приложения.
ms.assetid: c8986943-56a1-4668-9e80-7ab2a42333a8
title: Диспетчер распределителя COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ec090ba8c6324363c80a00685e4bc9cfa11185fa1b95ad5db3575608c9fe60ee
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119991694"
---
# <a name="com-dispenser-manager"></a>Диспетчер распределителя COM+

Диспетчер распределителя предоставляет пулы ресурсов для распределителя ресурсов и гарантирует, что ресурс, предоставленный распределителем ресурсов, будет правильно прикреплен к транзакции объекта приложения. Диспетчер распределителя ресурсов автоматически освобождает ресурсы, которые еще зарезервированы в конце времени существования объекта, устраняя вероятность утечки ресурсов. Диспетчер распределителя может попросить распределителя ресурсов создать новый ресурс или удалить бездействующие ресурсы при необходимости для настройки уровней инвентаризации вместо использования статических параметров.

> [!Note]  
> Так как интерфейсы распределителя ресурсов, предоставляемые приложению, не должны быть COM-интерфейсами, диспетчер распределителя можно использовать в процессе без инициализации COM, например для поддержки распределителя ресурсов ODBC.

 

При создании ресурса распределитель ресурсов может указать время, в течение которого бездействующий ресурс будет оставаться в пуле до его уничтожения. Поток, выполняемый в диспетчере распределителя, всегда ищет эти бездействующие ресурсы.

## <a name="the-inventory-statistics-manager"></a>Диспетчер статистики инвентаризации

Диспетчер распределителя использует *Диспетчер статистики инвентаризации* для управления уровнями инвентаризации ресурсов пула. Диспетчер статистики инвентаризации ведет запись о том, когда используется каждый ресурс, и удаляет ресурсы из инвентаризации, если они не использовались в течение *x* секунд, где значение *x* задается для каждого ресурса при создании ресурса.

## <a name="the-holder-component"></a>Компонент держателя

Диспетчер распределителя опрашивает каждый *держатель*, компонент, созданный диспетчером распределителя, который выводит список инвентаризации ресурсов для каждого распределителя ресурсов каждые 10 секунд, что позволяет изменять их инвентаризацию. Каждый держатель вызывает диспетчер статистики инвентаризации, чтобы предложить уровни инвентаризации для каждого типа ресурсов. В результате держатель может попросить распределителя ресурсов создать или уничтожить некоторые запасы.

Держатель владельца и ресурса взаимодействует с запросами ресурсов определенного типа. Между владельцем и распределителем ресурсов существуют следующие связи:

-   Держатель может запросить ресурс от распределителя ресурсов. Распределитель ресурсов либо возвращает доступный ресурс, либо создает новый.
-   Владелец может уведомить распределитель ресурсов о том, что приложению больше не требуется ресурс, а затем вернуть его в пул ресурсов.
-   Владелец и распределитель ресурсов работают вместе для поддержания размера пула ресурсов.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Основные понятия распределителя ресурсов COM+](com--resource-dispenser-concepts.md)
</dt> </dl>

 

 



