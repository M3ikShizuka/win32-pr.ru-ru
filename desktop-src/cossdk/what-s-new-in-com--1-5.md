---
description: COM+ версии 1,5 добавляет новые функции, предназначенные для повышения общей масштабируемости, доступности и управляемости приложений COM+ как для разработчиков, так и для системных администраторов.
ms.assetid: e7073ba5-6b19-4d94-8cc0-b4e16bb44afd
title: Новые возможности COM+ 1,5
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 994237002ea5d19c2cb00364f1064df38ed7271f
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104423438"
---
# <a name="whats-new-in-com-15"></a>Новые возможности COM+ 1,5

COM+ версии 1,5 добавляет новые функции, предназначенные для повышения общей масштабируемости, доступности и управляемости приложений COM+ как для разработчиков, так и для системных администраторов.

COM+ 1,5 доступен начиная с Windows XP и Windows Server 2003. Новые функции COM+ 1,5 недоступны в Windows 2000.

## <a name="application-level-access-checks-enabled-by-default"></a>Проверки доступа Application-Level включены по умолчанию

В рамках повышения безопасности системы проверки доступа по умолчанию включены при создании приложения COM+. В предыдущих версиях проверки доступа по умолчанию отключены на уровне приложения и включены по умолчанию на уровне компонента. Начиная с Windows Server 2003, проверки доступа по умолчанию включены на уровне приложения и по умолчанию отключены на уровне компонента. Дополнительные сведения и процедуры изменения параметров по умолчанию см. в разделе [Создание нового приложения COM+](creating-a-new-com--application.md), [Включение проверки доступа для приложения](enabling-access-checks-for-an-application.md)и [Включение проверки доступа на уровне компонента](enabling-access-checks-at-the-component-level.md) .

## <a name="application-pooling"></a>Объединение приложений в пул

Используя новое свойство Конкуррентаппс объекта [**комадминкаталогобжект**](comadmincatalogobject.md) в коллекции [**приложений**](applications.md) , пулы приложений COM+ добавляют масштабируемость для однопотоковых процессов и интегрируются с новой службой перезапуска приложений COM+. Подробные сведения см. в разделе [Группирование приложений COM+](com--application-pooling.md) .

## <a name="application-recycling"></a>Перезапуск приложений

Перезапуск приложений значительно увеличивает общую стабильность ваших приложений. Поскольку производительность большинства приложений может снизиться с течением времени из-за таких факторов, как утечка памяти, зависимость от кода стороннего разработчика и немасштабируемое использование ресурсов, перезапуск приложений COM+ предоставляет простое решение для корректного завершения процесса, связанного с приложением, и его перезапуска. Подробные сведения см. в разделе [перезапуск приложений COM+](com--application-recycling.md) . Пошаговые инструкции по настройке перезапуска процессов см. в разделе «Настройка повторного запуска процессов» справки по администрированию служб компонентов.

## <a name="com-partitions"></a>Разделы COM+

В этом выпуске COM+ предоставляет поддержку для разделов COM+ — функцию, которая позволяет устанавливать и настраивать на одном компьютере несколько версий приложений COM+. Эта функция позволяет сэкономить затраты и время на использование нескольких серверов для управления различными версиями приложения. На одном компьютере каждая секция действует как виртуальный сервер. После установки приложения в каждый раздел создаются наборы разделов, которые сопоставляют пользователей с логическими серверами. Подробные сведения о настройке разделов COM+ и управлении ими см. в разделе [разделы COM+](com--partitions.md) . Пошаговые инструкции см. в разделе «Администрирование разделов приложений» справки по администрированию служб компонентов.

## <a name="com-services-without-components"></a>Службы COM+ без компонентов

С помощью COM+ 1,5 можно использовать службы, предоставляемые COM+, без необходимости создания компонента для хранения методов, вызывающих эти службы. Это значительно выгодно для разработчиков, которые обычно не используют компоненты, но хотят использовать такие службы COM+, как транзакции или средство регистрации COM+. Используя службы COM+ без компонентов, разработчики могут избежать издержек при создании компонента, который используется для доступа только к необходимым службам COM+. Подробные сведения см. в разделе [службы COM+ без компонентов](com--services-without-components.md) .

## <a name="com-soap-service"></a>Служба COM+ SOAP

С помощью COM+ 1,5 теперь можно предоставлять приложение COM+ в качестве веб-службы XML. Можно также прозрачно использовать веб-службу XML, развернутую с помощью COM+ или нет, в качестве COM-компонента. Это означает, что вы можете легко создавать новые веб-службы XML из существующих приложений COM+ и легко внедрять веб-службы XML в новые приложения COM+. Подробные сведения см. в разделе [Служба COM+ SOAP](com--soap-service.md) .

## <a name="configurable-isolation-levels"></a>Настраиваемые уровни изоляции

Разработчики COM+ могут использовать новое свойство Тксисолатионлевел или средство администрирования служб компонентов для настройки уровня изоляции приложения по мере необходимости, помогая увеличить параллелизм, производительность и масштабируемость. Благодаря этой гибкости вы получаете право на получение всех последних задолженностей из своих приложений. Подробные сведения см. в разделе [Настройка уровней изоляции транзакций](configuring-transaction-isolation-levels.md) .

## <a name="creating-private-components"></a>Создание частных компонентов

В сценариях, где в приложении имеется несколько вспомогательных компонентов, которые должны вызываться только из других компонентов в этом приложении, этот выпуск COM+ позволяет использовать новое свойство Исприватекомпонент, чтобы пометить эти компоненты как частные. (В предыдущем выпуске COM+ все компоненты должны быть общедоступными для доступа к службам COM+, что означает, что эти компоненты могут быть активированы из других приложений.) Частный компонент может просматриваться и активироваться только другими компонентами в том же приложении, что обеспечивает более полный контроль над тем, какие функции предоставлять. Необходимо только документировать и поддерживать общедоступные компоненты, одновременно используя закрытые компоненты, доступ к которым извне приложения невозможен, но все равно может воспользоваться преимуществами всех служб COM+.

## <a name="dtc-security-settings"></a>Параметры безопасности DTC

Для координатор распределенных транзакций Майкрософт (DTC) были добавлены несколько новых параметров безопасности, что позволяет настраивать уровни безопасности для управления распределенными транзакциями. См. раздел вопросы безопасности DTC об этих параметрах и способах их реализации.

Чтобы упростить взаимную проверку подлинности, DTC может работать только под учетной записью NetworkService. Подробные сведения см. в разделе Управление учетными записями и привилегиями.

Для восстановления баз данных XA рекомендуется предоставить учетной записи NetworkService разрешения и роли, необходимые для выполнения этого восстановления. Точный метод выполнения этого зависит от каждой базы данных. Дополнительные сведения см. в разделе Отключение собственных распределенных транзакций и отключение TIP и транзакций XA.

Чтобы обеспечить более безопасную систему при использовании транзакций XA, платформы Windows Server 2003 содержат новую запись реестра для указания DLL-файлов XA. При обновлении до Windows Server 2003 можно работать с транзакциями XA, как и раньше, создав запись реестра в разделе **hKey \_ Local \_ Machine \\ Software \\ Microsoft \\ MSDTC \\ XADLL**, где значение Name — это имя библиотеки DLL (в формате *dllname*. dll), а значение — полный путь к DLL-файлу. Необходимо создать запись для каждого используемого DLL-файла XA. Если компьютер, на котором выполняется DTC, входит в состав кластера, необходимо выполнить запись реестра для каждого узла в кластере. Дополнительные сведения см. в разделе Управление транзакциями XA.

## <a name="low-memory-activation-gates"></a>Шлюзы активации Low-Memory

В этом выпуске COM+ автоматически проверяет память перед созданием сервера или объекта COM+. Если процентная доля виртуальной памяти, доступная для приложения, падает ниже фиксированного порога, активация завершается ошибкой до создания объекта. При сбое этих активаций, которые обычно запускаются, служба [шлюза активации COM+ Low-Memory](com--low-memory-activation-gates.md) значительно повышает надежность системы.

## <a name="moving-and-copying-com-components"></a>Перемещение и копирование компонентов COM

В этом выпуске COM+ позволяет перемещать и копировать компоненты. Это означает, что можно настроить одну физическую реализацию компонента много раз в разные моменты времени. Вы получаете возможность повторного использования компонентов на двоичном уровне, а не на уровне исходного кода, что приводит к уменьшению объема кода, снижению затрат на разработку и ускорению рынка. Подробные сведения см. в разделе [Перемещение компонентов](moving-components.md) и [Копирование компонентов](copying-components.md) .

## <a name="network-access"></a>Сетевой доступ

В Windows Server 2003 по умолчанию отключен доступ к сети COM+, что означает, что COM+ можно использовать только локально по умолчанию. Используйте следующую процедуру, чтобы включить доступ к сети COM+.

**Включение доступа к сети через COM+**

1.  В меню **Пуск** выберите пункт **Панель управления**, а затем выберите пункт **Установка и удаление программ**.

2.  Щелкните элемент **Установка и удаление компонентов Windows**.

3.  Выберите пункт **Сервер приложений** и нажмите кнопку **Подробности**.

4.  Установите флажок **включить доступ к com+ через сеть** и нажмите кнопку **ОК**.

5.  Нажмите кнопку **Далее** , чтобы завершить работу мастера компонентов Windows.

6.  Нажмите кнопку **Готово** , чтобы закрыть мастер.

По умолчанию в Windows Server 2003 доступ к сетевым транзакциям DTC отключен. На этих платформах DTC по умолчанию может выполнять только локальные транзакции. Используйте следующую процедуру, чтобы включить доступ к сети DTC.

> [!NOTE]
> Доступ к сети DTC можно также включить с помощью средства администрирования "службы компонентов" или программно с помощью библиотеки администрирования COM+. Практические сведения см. в разделе «Настройка безопасности DTC» справки по администрированию служб компонентов.

**Включение доступа к сети DTC**

1.  В меню **Пуск** выберите пункт **Панель управления**, а затем выберите пункт **Установка и удаление программ**.

2.  Щелкните элемент **Установка и удаление компонентов Windows**.

3.  Выберите пункт **Сервер приложений** и нажмите кнопку **Подробности**.

4.  Установите флажок **включить доступ к сети DTC** и нажмите кнопку **ОК**.

5.  Нажмите кнопку **Далее** , чтобы завершить работу мастера компонентов Windows.

6.  Нажмите кнопку **Готово** , чтобы закрыть мастер.

## <a name="pausing-and-disabling-applications"></a>Приостановка и отключение приложений

Теперь приложения COM+ являются более управляемыми. Администратор может приостанавливать и возобновлять серверные приложения COM+, а также включать и отключать и использовать библиотеки COM+, серверные приложения или даже отдельные настроенные компоненты. Как приостановка, так и отключение позволяют избежать будущих активаций, не влияя на существующие экземпляры компонентов. Дополнительные сведения см. в разделе "Администрирование приложений COM+" справки по администрированию служб компонентов.

## <a name="process-dumping"></a>Дамп процесса

Это непростая диагностика приложений в рабочей среде. Как собрать сведения о проблеме, не нарушая работу запущенных процессов? Теперь COM+ предоставляет решение с помощью новой функции дампа процесса. Эта функция позволяет системному администратору выгружать все состояния процесса без его завершения. Дополнительные сведения см. в разделе "Администрирование процесса аварийного дампа для отладки приложений COM+" в справке по администрированию служб компонентов.

## <a name="process-initialization"></a>Инициализация процесса

Многие серверные приложения должны выполнить определенную инициализацию и очистку, когда они будут запущены и завершены. При работе в Windows Server 2003 можно создать класс, реализующий интерфейс [**ипроцессинитиализер**](/windows/desktop/api/ComSvcs/nn-comsvcs-iprocessinitializer) . При запуске процесс вызывает [**ипроцессинитиализер:: Startup**](/windows/desktop/api/ComSvcs/nf-comsvcs-iprocessinitializer-startup) и при завершении работы он вызывает [**Ипроцессинитиализер:: Shutdown**](/windows/desktop/api/ComSvcs/nf-comsvcs-iprocessinitializer-shutdown). Это дает компоненту возможность выполнять необходимые задачи, такие как инициализация подключений, файлов и кэшей.

## <a name="running-com-applications-as-nt-services"></a>Запуск приложений COM+ в качестве служб NT

Разработчики COM+ теперь могут использовать средство администрирования "службы компонентов" для настройки и реализации серверного приложения COM+ в качестве службы NT. Это означает, что сервер может быть автоматически запущен или перезапущен, если приложение должно выполняться всегда. что приложение COM+ может запускаться как учетная запись локальной системы, если требуется выполнить привилегированные операции; и что зависимые службы приложения теперь могут запускаться автоматически. Подробные сведения см. [в разделе приложения COM+, выполняющиеся в качестве приложений службы](com--applications-running-as-service-applications.md) .

## <a name="side-by-side-assemblies"></a>Параллельные сборки

Параллельные сборки (SxS) позволяют приложениям указывать, какую версию системной библиотеки DLL или классического компонента COM следует использовать, например MDAC, MFS, MSVCRT или MSXML. Например, если приложение ASP использует MSXML версии 2,0, можно гарантировать, что это приложение по-прежнему использует MSXML версии 2,0 даже после применения пакетов обновления на сервере. Это значит, что даже если на компьютере установлена новая версия MSXML, версия 2,0 остается и используется приложением.

Чтобы настроить сборки SxS, необходимо знать путь к библиотеке DLL и убедиться, что файл манифеста COM+ существует в каждом виртуальном каталоге, который должен использовать библиотеку DLL. Манифест COM+ — это XML-файл, содержащий сведения о том, где установлена библиотека DLL. Этот манифест используется для создания контекста активации для приложения. Контекст активации позволяет приложению загрузить определенную версию библиотеки DLL, экземпляр объекта COM или пользовательскую версию окна. Для ввода полного пути к корневому каталогу приложения, содержащему допустимый файл манифеста сборки SxS, можно использовать средство администрирования служб компонентов или свойство Аппликатиондиректори. Дополнительные сведения см. в разделе [изолированные приложения и параллельные сборки](/windows/desktop/SbsCs/isolated-applications-and-side-by-side-assemblies-portal).

## <a name="windows-error-reporting"></a>Отчеты об ошибках Windows

COM+ 1,5 включает поддержку компонента отчеты об ошибках Windows (WER), который доступен начиная с Windows XP. WER позволяет пользователям уведомлять Майкрософт об ошибках приложений, сбоях ядра и не отвечает на запросы приложений. Эти уведомления позволяют группам поддержки клиентов Майкрософт более эффективно решать технические проблемы. Кроме того, компонент отчеты об ошибках Windows позволяет разработчикам COM+ получать сведения, которые можно использовать для улучшения своих приложений. Дополнительные сведения см. в разделе [Отчеты об ошибках Windows](/windows/desktop/wer/windows-error-reporting).

 

 
