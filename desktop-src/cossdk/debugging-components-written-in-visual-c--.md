---
description: Когда вы будете готовы к отладке функциональных возможностей COM+ в компонентах Microsoft Visual C++, можно настроить Visual C++ проект или средство администрирования служб компонентов для запуска отладчика.
ms.assetid: 206467ac-108a-49de-a884-66959dc77650
title: Отладка компонентов, написанных на Visual C++
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a14e4b6324cc69531f09612c2af37fa03a036fd4
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105701176"
---
# <a name="debugging-components-written-in-visual-c"></a>Отладка компонентов, написанных на Visual C++

Когда вы будете готовы к отладке функциональных возможностей COM+ в компонентах Microsoft Visual C++, можно настроить Visual C++ проект или средство администрирования служб компонентов для запуска отладчика. При использовании Visual C++ можно выполнять отладку с помощью удаленного клиента, используя OLE RPC и JIT-отладку. Если не удается запустить клиент в отладчике или если клиент запущен на другом компьютере, можно использовать параметр **запустить com+ в отладчике** . Это можно найти в средстве администрирования "службы компонентов" как флажок на вкладке " **Дополнительно** " диалогового окна " **свойства** приложения COM+".

После завершения отладки следует завершить работу отлаживаемого приложения COM+. Если серверный процесс остался на работе, при следующей попытке построить БИБЛИОТЕКУ DLL может появиться сообщение об ошибке, если существующая библиотека DLL все еще загружена в память. Чтобы завершить работу приложения COM+, щелкните правой кнопкой мыши приложение в дереве консоли и выберите пункт **Завершение работы**.

> [!Note]  
> При использовании транзакций может также потребоваться увеличить время ожидания транзакции, значение по умолчанию — 60 секунд. Можно также указать значение 0, фактически указав бесконечное время ожидания транзакции. С помощью средства администрирования "службы компонентов" измените значение параметра время ожидания транзакции на вкладке **Параметры** окна **Мой компьютер свойства** .

 

## <a name="debugging-server-application-components-with-visual-c"></a>Отладка компонентов серверного приложения с помощью Visual C++

При отладке серверных приложений COM+ может потребоваться отладка удаленных вызовов путем загрузки клиента и серверного приложения в отладчик. С помощью Visual C++ можно отлаживать удаленные вызовы к компонентам, используя параметры JIT и OLE RPC. Параметр JIT заставляет скомпилированный компонент запускать отладчик Visual C++ при возникновении ошибки; параметр OLE RPC позволяет отладчику выполнять шаг от клиента к компоненту при пошаговом выполнении кода.

После включения этих функций можно запустить клиент в отладчике. Когда клиент выполняет вызов компонента, отладчик будет выполнять шаг с заходом в код компонента в серверном процессе, даже если сервер находится на другом компьютере в сети. При необходимости сеанс отладки автоматически запускается на компьютере сервера. Аналогичным образом, один шаг после оператора return в коде компонента вернет отладку к следующему оператору в коде клиента.

> [!Note]  
> Вы можете сохранить несколько шагов, используя параметр **запуска com+ в отладчике** . Это позволяет указать Visual C++ (или другой) отладчик без необходимости создавать специальные параметры отладки в среде Visual C++. Это можно найти в средстве администрирования "службы компонентов" как флажок на вкладке " **Дополнительно** " диалогового окна " **свойства** приложения COM+". Дополнительные сведения см. в подразделе «отладка без Visual C++» этого раздела.

 

Если приложение COM+, содержащее компонент, является серверным приложением, необходимо завершить работу приложения с помощью средства администрирования "службы компонентов". Для этого щелкните правой кнопкой мыши приложение COM+ в дереве консоли и выберите пункт **Завершение работы**.

**Включение отладки RPC в Visual C++**

1.  В Visual C++ в меню **Сервис** выберите пункт **Параметры**.

2.  В диалоговом окне **Параметры** на вкладке **Отладка** установите флажки Отладка и **JIT-** Отладка **OLE RPC** .

3.  Нажмите кнопку **ОК**.

Чтобы начать отладку, Запустите клиентский проект в отладчике.

Вы также можете отлаживать компонент, не запуская клиент в отладчике. В этом случае компонент должен запустить отладчик самостоятельно. Для этого в проекте компонента необходимо указать исполняемый файл для сеанса отладки, а также идентификатор приложения COM+.

**Включение компонента серверного приложения для запуска отладчика Visual C++**

1.  В меню **проект** выберите пункт **Параметры**.

2.  В диалоговом окне **Параметры проекта** в поле **параметры для** выберите **Отладка Win32**.

3.  На вкладке **Отладка** в поле **Категория** выберите **Общие**.

4.  В поле **исполняемый файл для сеанса отладки** введите полный путь к Dllhost.exe, за которым следует аргумент, указывающий идентификатор приложения COM+, содержащего компонент.

    > [!Note]  
    > С помощью средства администрирования "службы компонентов" вы увидите идентификатор приложения на вкладке **Общие** диалогового окна **свойства** приложения COM+. Ниже приведен пример:

     

    > [!Note]  
    > C: \\ WinNT \\ system32 \\Dllhost.exe/Процессид: {applicationID}

     

5.  Нажмите кнопку **ОК**.

Теперь можно задать точки останова, запустить отладчик и начать вызов компонента.

## <a name="debugging-library-application-components-with-visual-c"></a>Отладка компонентов библиотечного приложения с помощью Visual C++

Для отладки компонентов в библиотечном приложении необходимо настроить проект клиента, так как в процессе клиента будет размещаться приложение библиотеки.

**Включение отладки библиотечного приложения с помощью Visual C++**

1.  В Visual C++ в меню **проект** выберите пункт **Параметры**.

2.  В диалоговом окне **Параметры проекта** в поле **параметры для** выберите пункт **Отладка Win32**.

3.  На вкладке **Отладка** в поле **Категория** щелкните **дополнительные библиотеки DLL**.

4.  В списке **модули** добавьте библиотеки DLL компонентов в приложение библиотеки. Это позволяет устанавливать точки останова до фактической загрузки библиотеки DLL.

5.  Нажмите кнопку **ОК**.

## <a name="debugging-without-visual-c"></a>Отладка без Visual C++

Независимо от того, используете ли вы Visual C++ для отладки, можно использовать параметр **запустить в отладчике** , чтобы указать отладчик, в котором должны выполняться компоненты.

**Указание отладчика с помощью средства администрирования "службы компонентов"**

1.  В дереве консоли выберите приложение библиотеки COM+, содержащее компоненты, которые вы хотите отладить.

2.  Щелкните приложение правой кнопкой мыши и выберите пункт **Свойства**.

3.  В диалоговом окне **Свойства** приложения перейдите на вкладку **Дополнительно** .

4.  В разделе **Отладка** установите флажок **запустить в отладчике** .

5.  В поле **путь к отладчику** введите путь к отладчику, который необходимо использовать. Можно также нажать кнопку **Обзор** , чтобы найти отладчик. Ниже приведен пример: C: \\ WinNT \\ system32 \\Ntsd.exe.

6.  Нажмите кнопку **ОК**.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Отладка компонентов, написанных на Visual Basic](debugging-components-written-in-visual-basic.md)
</dt> </dl>

 

 



