---
description: Получение и задание свойств
ms.assetid: 259612e7-70df-4f0f-90bc-766008dfdce7
title: Получение и задание свойств (службы компонентов)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 805d98463e1f9b8f08c1018b49554c95e2735bfa7ea6dca21d90243eb324df49
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118306759"
---
# <a name="getting-and-setting-properties-component-services"></a>Получение и задание свойств (службы компонентов)

Прежде чем можно будет читать или записывать определенные свойства, предоставляемые элементом коллекции, необходимо выполнить следующие действия.

1.  Получение коллекции.
2.  Заполните коллекцию данными для чтения из каталога COM+.
3.  Получение конкретного элемента в коллекции, представляющего его с помощью объекта из класса [**комадминкаталогобжект**](comadmincatalogobject.md) .

Пример, демонстрирующий эти шаги, см. [в разделе Навигация по иерархии коллекции com+](navigating-the-com--collection-hierarchy.md).

Так как определенные свойства могут различаться в зависимости от того, что представляет элемент; то есть элемент, представляющий компонент, имеет разные свойства, чем одно, представляющее приложение COM+. Задайте любое из этих свойств, используя одно универсальное свойство, свойство Value, в [**комадминкаталогобжект**](comadmincatalogobject.md).

Свойство Value позволяет получать или задавать любое конкретное именованное свойство, предоставляемое элементом, возвращая значение для именованного свойства при получении, а также при задании имени и значения.

Изменения фактически не записываются в каталог COM+, пока вы явно не сохраните изменения с помощью метода [**SaveChanges**](/windows/desktop/api/ComAdmin/nf-comadmin-icatalogcollection-savechanges) для объекта [**комадминкаталогколлектион**](comadmincatalogcollection.md) . Ожидающие изменения для всех свойств всех элементов в данной коллекции сохраняются одновременно. Дополнительные сведения см. в разделе [Сохранение или удаление изменений](saving-or-discarding-changes.md).

Не все внесенные изменения будут приняты. Каталог COM+ применяет некоторую логику согласования, чтобы обеспечить разумную настройку. Кроме того, при изменении некоторых свойств другие могут автоматически измениться с помощью той же логики согласования. Эти эффекты отображаются при попытке сохранить изменения.

> [!Note]  
> Может возникнуть состязание с другим модулем записи в каталог COM+. Между вызовами функций [**заполнения**](/windows/desktop/api/ComAdmin/nf-comadmin-icatalogcollection-populate) и [**SaveChanges**](/windows/desktop/api/ComAdmin/nf-comadmin-icatalogcollection-savechanges) для заданной коллекции не существует блокировки этих данных в каталоге. Несколько сторон могут одновременно настраивать элементы в определенной коллекции и могут полагаться на них при сохранении изменений. Это означает, что кто-то другой может изменить параметры объекта до или после того, как запускают какую-либо программу с помощью объектов Комадмин или с помощью средства администрирования "службы компонентов" локально или удаленно. Общее правило с записью объектов в каталог состоит в том, что все свойства объекта записываются одновременно. То есть последний модуль записи WINS — объект сохраняется в каталоге точно так же, как и последний настроенный модуль записи.

 

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Взаимозависимости между свойствами](interdependencies-between-properties.md)
</dt> <dt>

[Запрос доступных свойств](querying-for-available-properties.md)
</dt> <dt>

[Сохранение или Отмена изменений](saving-or-discarding-changes.md)
</dt> </dl>

 

 



