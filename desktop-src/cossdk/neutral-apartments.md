---
description: COM+ вводит нейтральные подразделения для упрощения программирования в многопоточных средах. Нейтральный апартамент является предпочтительной моделью для COM+ для компонентов без пользовательского интерфейса.
ms.assetid: 679742af-7c04-4b0e-822a-a43e1aafa936
title: Нейтральные подразделения
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4ac3bdff2670e4f99ad94af20278eaca6a38861e
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104423337"
---
# <a name="neutral-apartments"></a>Нейтральные подразделения

COM+ вводит нейтральные подразделения для упрощения программирования в многопоточных средах. Нейтральный апартамент является предпочтительной моделью для COM+ для компонентов без пользовательского интерфейса.

В прошлом, чтобы предотвратить узкие места, Разработчики COM+, которым требуется масштабируемость сервера, приходилось реализовывать беспотоковые компоненты. Однако модели с беспроблемными потоками сложнее реализовать, поскольку они должны иметь дело с доступом через блокировку. В нейтральных апартаментах объекты следуют рекомендациям для многопоточных подразделениях, но могут выполняться в потоках любого типа. Когда поток выполняется в нейтральном апартаменте, контекст объекта получается, не вызывая переключения потока.

Каждый процесс может иметь только один нейтральный апартамент. Чтобы выбрать нейтральное подразделение, используйте следующий параметр реестра:

```
HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID
   {CLSID}
      InprocServer32
         ThreadingModel = Neutral
```

Компоненты с пользовательскими интерфейсами должны по-прежнему использовать Однопотоковые подразделения в качестве предпочтительных моделей. Чтобы выбрать однопотоковое подразделение, используйте следующий параметр реестра:

**ThreadingModel** = подразделение

 

 



