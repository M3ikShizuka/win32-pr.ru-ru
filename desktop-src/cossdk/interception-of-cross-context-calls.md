---
description: Когда объект активируется в заданном контексте, последующие вызовы или из него в контексте обрабатываются иначе, чем вызовы через границу контекста.
ms.assetid: 9e234b41-f269-4674-adc4-12018277a14b
title: Перехват вызовов между контекстами
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3d70bc8bff83d02b13656f9854f0e6d16cd4e173
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127168539"
---
# <a name="interception-of-cross-context-calls"></a>Перехват вызовов между контекстами

Когда объект активируется в заданном контексте, последующие вызовы или из него в контексте обрабатываются иначе, чем вызовы через границу контекста. Вызовы через границы контекста обрабатываются с помощью упрощенных прокси-серверов. Эти прокси-серверы обрабатывали любое решение, необходимое для корректировки среды выполнения из одной, которая допускает вызывающий объект. Этот процесс называется *перехватом*.

Перехват вызовов между контекстами необходим, поскольку объекты в разных контекстах имеют различные требования к времени выполнения — это именно причина для контекстов. COM+ перехватывает все ссылки на объекты, передаваемые в качестве параметров метода, и автоматически преобразует их в прокси-серверы, чтобы их можно было использовать в новом контексте.

Если ссылки на объекты совместно используются через границы контекста другими средствами, например в глобальных переменных, следует всегда использовать [**комаршалинтерфаце**](/windows/desktop/api/combaseapi/nf-combaseapi-comarshalinterface) и [**каунмаршалинтерфаце**](/windows/desktop/api/combaseapi/nf-combaseapi-counmarshalinterface). Эти функции могут преобразовать ссылку на объект в прокси-сервер, доступный в другом контексте. Никогда не предоставляйте ссылку на необработанный объект через границы контекста.

Поведение вызовов в контексте может иметь нежелательные последствия в случае, когда объекты предоставляют интерфейсы, которые не могут быть упакованы. В этом случае вам, вероятно, придется налагать, что объект, который не может быть маршалирован, активируется только в контексте его вызывающего объекта и никогда не в своем собственном контексте. Это можно сделать, выбрав параметр **должен быть активирован в контексте вызывающего** объекта на вкладке **Активация** страницы **Свойства** компонента. (Пошаговые инструкции см. [в разделе принудительная активация в контексте вызывающего объекта](enforcing-activation-in-the-caller-s-context.md) .)

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Активация контекста](context-activation.md)
</dt> </dl>

 

 
