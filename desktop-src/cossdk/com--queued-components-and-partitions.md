---
description: Служба COM+ в очереди компонентов полностью поддерживает понятие секций. Это значит, что при выполнении компонента, помещенного в очередь в пределах секции, сообщение помещается в очередь и компонент в конечном итоге выполняется в разделе Components.
ms.assetid: 08b0f7b5-6c45-4471-9634-1f42fbbf500c
title: Компоненты и разделы, помещенные в очередь COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0296119d32eafefd3212ae37e32543b8fd14b884ff6401c16827717a9a6960b6
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119129076"
---
# <a name="com-queued-components-and-partitions"></a>Компоненты и разделы, помещенные в очередь COM+

Служба COM+ в очереди компонентов полностью поддерживает понятие секций. Это значит, что при выполнении компонента, помещенного в очередь в секции, сообщение помещается в очередь и компонент в конечном итоге выполняется в секции компонента.

## <a name="queue-names-for-partitioned-components"></a>Имена очередей для секционированных компонентов

Обычно служба очередей компонентов использует имя приложения в качестве имени очереди. Это означает, что в сценарии, не относящемся к секциям, где на компьютере существует только один экземпляр имени приложения, каждое имя приложения имеет собственную очередь сообщений.

Однако в случае секций, где на компьютере может существовать несколько экземпляров одного и того же имени приложения, служба очередей компонентов использует одну и ту же очередь для всех компонентов, использующих одно и то же имя приложения.

## <a name="activating-queued-components"></a>Активация компонентов в очереди

Те же правила, с помощью которых идентификатор секции используется для активации компонента, не относящегося к очереди, применяются к компоненту, расположенному в очереди, следующим образом.

-   Если моникер используется для активации компонента в очереди и включен идентификатор секции, этот идентификатор секции используется для нахождение секции. Этот идентификатор секции имеет приоритет над любым ИДЕНТИФИКАТОРом секции, который может существовать в контексте активируемого компонента.
-   Если моникер не используется для активации компонента, используется идентификатор раздела, который находится в контексте объекта.
-   Если в контексте объекта не существует идентификатора секции, используется сопоставление пользователя с Секцией по умолчанию в Active Directory.

> [!Note]  
> Если серверный компьютер отключается от сети, а сопоставление набора разделов «пользователь-Секция» изменяется в то время, когда сервер отключен, то кэш разделов может содержать устаревшее сопоставление набора разделов «пользователь-секция». Это может привести к ошибке активации, если сопоставление пользовательских наборов секций является механизмом, используемым для активации компонента.

 

События COM+ полностью интегрированы в разделы. Это означает, что подписчик может подписываться на издателя, чье приложение находится в пределах секции. Чтобы разрешить эту подписку, коллекция классов подписчика включает два свойства, связанные с Секцией — идентификатор секции класса событий и идентификатор приложения класса событий.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Ограничения разработки приложений](application-design-restrictions.md)
</dt> <dt>

[Реализация секционирования](partition-implementation.md)
</dt> <dt>

[Регистрация и Активация компонентов в секциях](registering-and-activating-components-in-partitions.md)
</dt> <dt>

[Что такое разделы COM+?](what-are-com--partitions-.md)
</dt> </dl>

 

 



