---
description: Можно использовать компенсирующий диспетчер ресурсов COM+ (CRM), чтобы легко и быстро интегрировать ресурсы приложений с транзакциями Microsoft координатор распределенных транзакций (DTC).
ms.assetid: 8d1d034f-8a09-40ae-842a-5251135bd3c8
title: Основные понятия о компенсации диспетчер ресурсов COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 14206a54ffcb4f7e06ddf7362736a722393b0791
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103990546"
---
# <a name="com-compensating-resource-manager-concepts"></a>Основные понятия о компенсации диспетчер ресурсов COM+

Можно использовать компенсирующий диспетчер ресурсов COM+ (CRM), чтобы легко и быстро интегрировать ресурсы приложений с транзакциями Microsoft координатор распределенных транзакций (DTC). Ресурсы приложения могут проголосовать за результат транзакции, а также получить конечное уведомление о его результатах. Создается устойчивый журнал, чтобы ресурсы приложения могли записывать записи, которые остались неудачными, а CRM восстанавливает этот файл журнала при перезапуске приложения.

В состав CRM входят следующие два компонента:

-   Рабочая роль CRM. Этот компонент выполняет основную работу конкретного CRM и реализует интерфейс, относящийся к задаче, которую он должен выполнить. Инфраструктура CRM предоставляет интерфейс рабочей роли CRM, с помощью которой Рабочая роль CRM может записывать записи в устойчивый файл журнала на диске. Рабочая роль CRM должна записать записи в журнал и сделать их устойчивыми, прежде чем выполнять свою работу, чтобы при возникновении сбоя восстановление могла выполняться правильно. Работнику CRM всегда требуется транзакция.
-   Компенсатор CRM. Этот компонент создается инфраструктурой CRM по завершении транзакции. Он реализует определенный интерфейс, с помощью которого инфраструктура CRM может передавать уведомления о завершении транзакций и записи журнала, которые ранее были записаны рабочей ролью CRM.

COM+ CRM обеспечивает атомарность с помощью уведомлений о транзакциях и устойчивость к журналу CRM, но не обеспечивает изоляцию ресурсов. В многопоточной среде обязанностью разработчика CRM является обеспечение того, что доступ к ресурсам с помощью нескольких рабочих ролей CRM или внешних приложений сериализуется во время транзакции.

После того как транзакция пройдет фазу подготовки, сотрудники CRM и CRM могут работать параллельно. Рабочий компонент CRM новой транзакции может стать активным, пока компенсатор CRM предыдущей транзакции все еще обрабатывает предыдущую транзакцию.

Во время сбоев до восстановления серверного приложения CRM прерванная транзакция должна считаться активной и незавершенной. Внешние процессы не должны иметь возможности доступа к ресурсам, которые были изменены этой конкретной транзакцией до восстановления процесса сервера CRM.

В CRM определены три типа интерфейсов для основных функций CRM:

-   [**Икрмлогконтрол**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmlogcontrol) реализуется в Клерке CRM и используется работником CRM для записи записей журнала в журнал. Он также может использоваться компенсатором CRM.
-   [**Икрмкомпенсатор**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmcompensator) и [**Икрмкомпенсаторвариантс**](/windows/desktop/api/ComSvcs/nn-comsvcs-icrmcompensatorvariants) РЕАЛИЗУЮТСЯ в компенсаторе CRM. Эти интерфейсы используются для доставки уведомлений о результатах транзакций и связанных с ними записей журнала в компенсатор CRM. Как правило, компенсатор CRM реализует только один из этих интерфейсов в зависимости от того, требуются ли ему неструктурированные или структурные записи журнала. *Структурированные записи журнала* — это те, которые встроены в коллекцию вариантов и обычно используются в Microsoft Visual Basic. *Неструктурированные записи журнала* представляют собой только буфер байтов и обычно используются Microsoft Visual C++. Компенсатор CRM может реализовывать оба интерфейса компенсатора; Однако для доставки записей журнала используется только один объект за раз.
-   Интерфейсы мониторинга COM+ CRM используются для мониторинга Крмс в определенном серверном приложении. Подробные сведения об интерфейсах мониторинга см. в разделе [com+ CRM Monitoring interfaces](com--crm-monitoring-interfaces.md).

В следующих подразделах этого раздела содержатся дополнительные сведения о службе COM+ CRM.

-   [Вопросы безопасности COM+ CRM](com--crm-security-considerations.md)
-   [Операционный процесс COM+ CRM](com--crm-operating-process.md)
-   [Запуск и восстановление COM+ CRM](com--crm-startup-and-recovery.md)
-   [Использование COM+ CRM в среде кластера](using-the-com--crm-in-a-cluster-environment.md)
-   [Обработка ошибок в COM+ CRM](error-handling-in-the-com--crm.md)
-   [Параметры реестра COM+ CRM](com--crm-registry-settings.md)
-   [Устранение неполадок COM+ CRM](troubleshooting-the-com--crm.md)
-   [Предложения по проектированию для разработки COM+ CRM](design-suggestions-for-developing-a-com--crm.md)
-   [Интерфейсы мониторинга COM+ CRM](com--crm-monitoring-interfaces.md)
-   [Интерфейсы COM+ CRM](com--crm-interfaces.md)

## <a name="related-topics"></a>См. также

<dl> <dt>

[Задачи компенсирующих диспетчер ресурсов COM+](com--compensating-resource-manager-tasks.md)
</dt> </dl>

 

 



