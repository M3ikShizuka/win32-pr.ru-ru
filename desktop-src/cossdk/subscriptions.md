---
description: 'Данные подписки находятся в каталоге COM+ подписки. Подписку можно создать с помощью средства администрирования "службы компонентов" или программно с помощью интерфейса Икомадминкаталог:: Инсталлкомпонент.'
ms.assetid: 190e88f3-1d87-4c27-9451-0a633cbae829
title: Подписки
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9973eb76fc22354f1a2fc8e381c90cf5be1efee3
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127347531"
---
# <a name="subscriptions"></a>Подписки

Данные подписки находятся в каталоге COM+ подписки. Подписку можно создать с помощью средства администрирования "службы компонентов" или программно с помощью интерфейса [**икомадминкаталог:: инсталлкомпонент**](/windows/desktop/api/ComAdmin/nf-comadmin-icomadmincatalog-installcomponent) .

Коллекция [**субскриптионсфоркомпонент**](subscriptionsforcomponent.md) используется для добавления, удаления или изменения сведений, относящихся к подпискам. Коллекция **субскриптионсфоркомпонент** является дочерней коллекцией для компонента. Чтобы добавить подписку, получите коллекцию **субскриптионсфоркомпонент** компонента и используйте метод [**Add**](/windows/desktop/api/ComAdmin/nf-comadmin-icatalogcollection-add) , чтобы добавить запись в коллекцию. Чтобы настроить различные свойства объекта Subscription, используйте свойство [**value**](/windows/desktop/api/ComAdmin/nf-comadmin-icatalogobject-get_value) . Чтобы сохранить изменения, используйте команду [**SaveChanges**](/windows/desktop/api/ComAdmin/nf-comadmin-icatalogcollection-savechanges) в объекте коллекции **субскриптионсфоркомпонент** .

Можно также использовать средство администрирования служб компонентов, чтобы изменить некоторые, но не все свойства подписки. Подписки указывают следующие сведения:

-   Удостоверение и расположение подписчика
-   Метод доставки.
-   Методы событий для доставки
-   Объект класса событий и свойство PublisherID компонента класса событий, из которого подписчик желает получать события

Подписки существуют независимо от объектов класса событий. Вы можете отключить подписку, задав для свойства Enabled значение false. Отключенная подписка не вызывается событиями COM+.

Существуют следующие три типа подписок:

<dl> <dt>

<span id="Persistent"></span><span id="persistent"></span><span id="PERSISTENT"></span>Надежно
</dt> <dd>

Постоянные подписки находятся в каталоге COM+ и не зависят от времени существования подписчика. Постоянные подписки сохранили перезагрузку системы. Как правило, постоянная подписка создается, когда приложение устанавливается на компьютере подписчика и удаляется при удалении приложения. После создания постоянной подписки события COM+ активируют подписчик каждый раз, когда в него должно быть доставлено событие.

Когда издатель создает и вызывает объект [класса событий](the-com--event-class-object.md) , объект ищет все постоянные подписки в каталоге COM+ и создает новый экземпляр каждого объекта. Процесс создания может быть либо прямым, либо через моникер для очередей компонентов. Укажите объект подписчика по свойству [**субскрибермоникер**](subscriptionsforcomponent.md) подписки. Объекты подписчиков, созданные постоянной подпиской, всегда освобождаются после каждого вызова события.

</dd> <dt>

<span id="Transient"></span><span id="transient"></span><span id="TRANSIENT"></span>Регулярные
</dt> <dd>

Для временных подписок можно использовать коллекцию [**трансиентсубскриптионс**](transientsubscriptions.md) , родительский объект которых является объектом корневого каталога. Временные подписки запрашивают событие для определенного объекта подписчика, который уже существует. Временные подписки хранятся в каталоге COM+, но подписка удаляется при остановке системы событий или операционной системы. В отличие от постоянных подписок, временные подписки привязаны к определенному объекту и хранятся только в системе событий. Временные подписки могут быть более эффективными, чем постоянные подписки, но необходимо управлять жизненным циклом объектов. Сведения о регистрации временной подписки см. в разделе [регистрация временной подписки](registering-a-transient-subscription.md).

</dd> <dt>

<span id="Per_user"></span><span id="per_user"></span><span id="PER_USER"></span>На пользователя
</dt> <dd>

Подписки на пользователя могут доставлять события только при входе подписчика на компьютер системы событий. Когда подписчик входит в систему, система событий включает все подписки, для которых установлен *флаг "* **значение true** ", а для параметра *username* — имя пользователя, выполнившего вход. При выходе подписчика из системы подписки отключаются.

Подписки на пользователя вступают в силу только в том случае, если издатель и подписчик находятся на одном компьютере. Вход и выход из системы обнаруживаются только на компьютере издателя, а не на компьютере, на котором находится объект подписчика.

</dd> </dl>

Система событий использует мета-события для уведомления заинтересованных подписчиков при создании, изменении или удалении объектов класса событий или подписок. Чтобы получить метаданные из системы событий, приложения должны создать подписку, находящейся на компьютере системы событий и указывающую идентификатор интерфейса (IID \_ иевентобжектчанже).

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Фильтрация событий в COM+](filtering-events-in-com-.md)
</dt> <dt>

[Публикация и доставка событий в COM+](publishing-and-delivering-events-in-com-.md)
</dt> <dt>

[Объект класса событий COM+](the-com--event-class-object.md)
</dt> <dt>

[Использование событий COM+ с компонентами в очереди COM+](using-com--events-with-com--queued-components.md)
</dt> </dl>

 

 



