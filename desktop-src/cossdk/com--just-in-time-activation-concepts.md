---
description: Служба JIT-активации позволяет COM+ деактивировать объект, когда клиент по-прежнему владеет активной ссылкой на этот объект.
ms.assetid: dbc7b257-8506-42c8-8a78-3474c6d4f4b6
title: Основные понятия JIT-активации COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6c942bfeb342ea305083e0c7d7ebdea2fe96bf24
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105710707"
---
# <a name="com-just-in-time-activation-concepts"></a>Основные понятия JIT-активации COM+

Служба JIT-активации позволяет COM+ деактивировать объект, когда клиент по-прежнему владеет активной ссылкой на этот объект. В следующий раз, когда клиент вызывает метод для объекта, который клиент считает активным, служба JIT-активации COM+ снова активирует объект прозрачно для клиента, по времени.

Основное преимущество использования COM + JIT-активации заключается в том, что можно позволить клиентам хранить ссылки на объекты в течение всего времени, не требуя придерживать ценных ресурсов сервера, таких как память. Ниже приведены другие важные преимущества.

-   Использование службы JIT-активации COM+ значительно упрощает модель программирования для клиента, поскольку клиент не должен думать о том, как он использует ресурсоемкие серверные объекты и серверные ресурсы. Без JIT-активации клиенты могут повлечь значительные штрафы, когда им часто приходится вызывать и освобождать объекты.
    > [!Note]  
    > Вы можете более подробно повысить производительность с помощью службы [пула объектов COM+](com--object-pooling.md) . Используя объекты, активируемые JIT-активацией, можно значительно ускорить повторную активацию объектов для клиентов при повторном использовании ресурсов, которые они могут хранить, что позволяет более точно контролировать объем памяти, используемой данным объектом на сервере. Дополнительные сведения см. в разделе [группирование пулов объектов и JIT-активация com+](object-pooling-and-com--jit-activation.md).

     

-   При использовании распределенных приложений для создания каждого объекта требуется дорогостоящий циклический обмен данными, а чем дальше клиент от сервера, тем выше затраты на активацию и упаковку объекта сервера, открытие канала и настройку прокси-сервера и заглушки. С помощью службы JIT-активации COM+ можно сократить частоту создания объектов, чтобы значительно повысить производительность приложения.
-   При использовании JIT-активации COM+ для активации этих объектов, на которых клиенты хранят долгосрочные ссылки, но которые они не обязательно использовать, память сервера не всегда связана с поддержанием активности этих объектов. Это может значительно повысить масштабируемость приложения. Единственная производительность, которую видят клиенты, — это время, затрачиваемое COM+ на повторную активацию объекта, обычно это просто больше времени, чем требуется для выделения памяти для объекта и значительно меньше, чем циклический обмен данными для создания удаленных объектов.

## <a name="enabling-com-jit-activation"></a>Включение JIT-активации COM+

Включить службу JIT-активации COM+ для компонента можно с помощью средства администрирования "службы компонентов" или административных функций. Дополнительные сведения о том, как это сделать, см. [в разделе Включение JIT-активации для компонента](enabling-jit-activation-for-a-component.md).

JIT-активация COM+ может взаимодействовать с другими службами COM+, например следующими:

-   Если компонент требует транзакций, для него автоматически включается JIT-активация. Более подробные сведения см. в разделе [транзакции и JIT-активация com+](transactions-and-com--jit-activation.md).
-   Если для компонента включена JIT-активация, для синхронизации автоматически устанавливается значение обязательно. Это означает, что если два клиента одновременно вызывают JIT-активируемый компонент и вызов метода для одного из них, что приведет к деактивации объекта, то другой не будет потерян.

## <a name="how-deactivation-is-triggered"></a>Как активируется деактивация

COM+ деактивирует объект на основе состояния бита завершения в контексте объекта. Объект может использовать этот бит, чтобы сообщить, выполняется ли он, то есть готов к деактивации — во время вызова метода. Дополнительные сведения см. [в разделе Установка бита done](setting-the-done-bit.md).

## <a name="using-the-auto-done-property"></a>Использование свойства автоматического завершения

С помощью средства администрирования "службы компонентов" можно настроить метод таким способом, чтобы объект был автоматически деактивирован при возврате метода. (Инструкции по заданию этого свойства см. [в разделе Включение автозаполнения для метода](enabling-auto-done-for-a-method.md) .) Выбрав этот параметр, можно исключить повторяющиеся вызовы метода для голосования в транзакциях. Поскольку значение по умолчанию для бита согласованности имеет значение true, если вы изменили бит done на true и не принимаете никаких действий для изменения этих параметров, [**иобжектконтекст:: сеткомплете**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete) вызывается автоматически после возврата метода.

Однако существует одно предостережение этого поведения: COM+ будет проверять значение HRESULT, возвращаемое методом. Если значение HRESULT указывает на сбой, бит согласованности имеет значение false и результат будет таким же, как при вызове [**иобжектконтекст:: SetAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort).

Подводя итог, если выбрать автозаполнение для метода и не предпринимать никаких действий для задания каких-либо битов, и если возвращается значение HRESULT (HR), то применяется следующее:

-   В случае успешности (HR) это так, как если бы вы вызывали [**сеткомплете**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setcomplete).
-   Если произошел сбой (HR), это так, как если бы вы вызывали [**SetAbort**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontext-setabort).

## <a name="using-iobjectcontrol-to-manage-object-activation-and-deactivation"></a>Использование IObjectControl для управления активацией и деактивацией объектов

Можно реализовать интерфейс [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol) , чтобы среда выполнения COM+ автоматически управляла деактивацией и реактивацией объектов. Когда объект реализует этот интерфейс, COM+ вызывает [**IObjectControl::D еактивате**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-deactivate) , когда он деактивирует объект и [**IObjectControl:: Activate**](/windows/desktop/api/ComSvcs/nf-comsvcs-iobjectcontrol-activate) при его повторной активации. Эти методы обеспечивают автоматическую инициализацию контекста при активации объекта и очистке состояния при деактивации.

При группировании объектов, использующих JIT-активацию COM+, настоятельно рекомендуется реализовать [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol). Дополнительные сведения см. в разделе [группирование пулов объектов и JIT-активация com+](object-pooling-and-com--jit-activation.md).

## <a name="statelessness-and-jit-activation"></a>Стателесснесс и JIT-активация

Транзакционные объекты, как правило, не имеют состояния, так как вы не можете совместно использовать состояние через границу транзакции. Поэтому JIT-активацию следует использовать только в том случае, если объект не имеет состояния, которое было бы потеряно при деактивации. в противном случае вы нарушаете изоляцию транзакций. Из-за особенностей естественного использования объектов транзакций они выполняют определенную единицу работы и освобождают объект при фиксации или прерывании транзакции — JIT-активация и автоматические транзакции тесно связаны друг с друга. Настройка объекта для требования транзакций активирует JIT-активацию COM+ автоматически.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Задачи JIT-активации COM+](com--just-in-time-activation-tasks.md)
</dt> <dt>

[Объединение объектов в пул и JIT-активация COM+](object-pooling-and-com--jit-activation.md)
</dt> <dt>

[Транзакции и JIT-активация COM+](transactions-and-com--jit-activation.md)
</dt> </dl>

 

 



