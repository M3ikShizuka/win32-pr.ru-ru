---
description: Типы потоков распределителя ресурсов COM+
ms.assetid: 3ab67adb-311f-404c-a3ca-d274af53f91c
title: Типы потоков распределителя ресурсов COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 761d85edc3105785ded904fd2dc6083a9aea30cd
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104423277"
---
# <a name="com-resource-dispenser-thread-types"></a>Типы потоков распределителя ресурсов COM+

Вызовы распределителя ресурсов COM+ могут исходить в одном из следующих типов потоков:

-   Апартаментный поток (STA)
-   Свободный поток (MTA)
-   Поток, не связанный с COM (приложение или поток сборщика мусора диспетчера программ- [распределителя](com--dispenser-manager.md) )

Если распределитель ресурсов не является COM-объектом, он должен иметь возможность обрабатывать вызовы, поступающие из любого потока в любое время. Если распределитель ресурсов является COM-объектом, COM-объект должен быть зарегистрирован в потоковой модели **обоих типов**. Это позволяет потокам STA или MTA создавать и использовать распределитель ресурсов без переключения потока.

Если распределитель ресурсов создает и использует другой COM-объект (например, диспетчер ресурсов вне процесса), ему может потребоваться поддерживать несколько учетных записей-посредников для этого другого объекта COM и гарантировать, что вызовы объекта выполняются с помощью соответствующего прокси-сервера для вызывающего потока. Когда распределитель ресурсов создает этот объект, он маршалирует и сохраняет ссылку. Перед повторным вызовом объекта его необходимо распаковать, чтобы создать прокси-сервер для вызывающего потока.

Возможно, более эффективно кэшировать эти прокси для каждого потока, сохранив карту из идентификатора потока в указатель прокси-сервера. Эта схема расширяется по мере использования новых потоков в процессе.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Основные понятия распределителя ресурсов COM+](com--resource-dispenser-concepts.md)
</dt> </dl>

 

 



