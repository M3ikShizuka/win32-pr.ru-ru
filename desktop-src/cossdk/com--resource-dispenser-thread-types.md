---
description: Типы потоков распределителя ресурсов COM+
ms.assetid: 3ab67adb-311f-404c-a3ca-d274af53f91c
title: Типы потоков распределителя ресурсов COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f20f9fc25dd1811b401dd15998ddb3f8fb9b21e5964277cc94d0ab1797eae622
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119129056"
---
# <a name="com-resource-dispenser-thread-types"></a>Типы потоков распределителя ресурсов COM+

Вызовы распределителя ресурсов COM+ могут исходить в одном из следующих типов потоков:

-   Апартаментный поток (STA)
-   Свободный поток (MTA)
-   Поток, не связанный с COM (приложение или поток сборщика мусора диспетчера программ- [распределителя](com--dispenser-manager.md) )

Если распределитель ресурсов не является COM-объектом, он должен иметь возможность обрабатывать вызовы, поступающие из любого потока в любое время. Если распределитель ресурсов является COM-объектом, COM-объект должен быть зарегистрирован в потоковой модели **обоих типов**. Это позволяет потокам STA или MTA создавать и использовать распределитель ресурсов без переключения потока.

Если распределитель ресурсов создает и использует другой COM-объект (например, диспетчер ресурсов вне процесса), ему может потребоваться поддерживать несколько учетных записей-посредников для этого другого объекта COM и гарантировать, что вызовы объекта выполняются с помощью соответствующего прокси-сервера для вызывающего потока. Когда распределитель ресурсов создает этот объект, он маршалирует и сохраняет ссылку. Перед повторным вызовом объекта его необходимо распаковать, чтобы создать прокси-сервер для вызывающего потока.

Возможно, более эффективно кэшировать эти прокси для каждого потока, сохранив карту из идентификатора потока в указатель прокси-сервера. Эта схема расширяется по мере использования новых потоков в процессе.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Основные понятия распределителя ресурсов COM+](com--resource-dispenser-concepts.md)
</dt> </dl>

 

 



