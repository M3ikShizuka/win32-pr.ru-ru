---
description: Флаги consistent и Done
ms.assetid: a641fa95-5587-4362-9869-e5c27c6dd2ce
title: Флаги consistent и Done
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 56a61d1f715d06e6bfb6632b9bbb59276074c4d7
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104539431"
---
# <a name="consistent-and-done-flags"></a>Флаги consistent и Done

COM+ всегда создает объект контекста перед активацией транзакционного объекта. Объект контекста содержит сведения, относящиеся к объекту, такие как его создатель и идентификатор транзакции. Каждый объект контекста также содержит *последовательный флаг* и *флаг Done*. Вместе эти флаги определяют состояние транзакционного объекта.

Флаг consistent указывает, что транзакционный объект является согласованным или несогласованным. Конкретные сведения о том, что делает целостность состояния объекта, зависит от программиста. Когда вызов метода устанавливает для этого флага значение true, объект является последовательным. Значение false указывает, что объект не согласуется. COM+ устанавливает для флага значение true при создании экземпляра объекта. Последовательный объект готов к продолжению транзакции. Пока объект остается активным, последующие вызовы метода могут многократно переключить флаг consistent с true на false и наоборот.

Флаг Done определяет длительность транзакции. При возврате вызова метода COM+ проверяет флаг Done. Если метод устанавливает для этого флага значение true, COM+ деактивирует объект и заметит флаг consistent. Если флаг done имеет значение false, то COM+ не активирует объект или замещает флаг consistent. COM+ задает для флага done значение false при создании экземпляра объекта.

Флаг consistent приводит голосование к фиксации или прерыванию транзакции, в которой она выполняется, а флаг done завершает голосование. COM+ проверяет флаг consistent, когда флаг Done установлен в значение true для возвращаемого вызова метода или когда объект деактивируется. Несмотря на то что последовательный флаг объекта может постоянно меняться в каждом вызове метода, учитываются только последние изменения.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Управление автоматическими транзакциями в COM+](managing-automatic-transactions-in-com-.md)
</dt> <dt>

[Установка флагов consistent и Done](setting-the-consistent-and-done-flags.md)
</dt> </dl>

 

 



