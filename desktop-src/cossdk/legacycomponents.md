---
description: Содержит объект для каждого ненастроенного компонента в коллекции приложений. Ненастроенные компоненты не могут использовать службы COM+. Свойства, предоставляемые этими объектами, сохраняют параметры, сделанные на уровне компонента.
ms.assetid: 87f3b93f-71aa-4187-88d2-889c13d8bd06
title: Коллекция Легацикомпонентс
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- LegacyComponents
api_type:
- COM
api_location: ''
ms.openlocfilehash: 5761950dcb0ceb5c857daf37ba2236733ec30c22
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127347626"
---
# <a name="legacycomponents-collection"></a>Коллекция Легацикомпонентс

Содержит объект для каждого ненастроенного компонента в коллекции приложений. Ненастроенные компоненты не могут использовать службы COM+. Свойства, предоставляемые этими объектами, сохраняют параметры, сделанные на уровне компонента.

Эта коллекция поддерживает метод [**Remove**](/windows/desktop/api/ComAdmin/nf-comadmin-icatalogcollection-remove) объекта [**комадминкаталогколлектион**](comadmincatalogcollection.md) , но не метод [**Add**](/windows/desktop/api/ComAdmin/nf-comadmin-icatalogcollection-add) . Чтобы установить или импортировать компоненты в приложение, используйте методы для объекта [**комадминкаталог**](comadmincatalog.md) .

## <a name="members"></a>Элементы

Коллекция **легацикомпонентс** наследует от интерфейса [**IUnknown**](/windows/desktop/api/unknwn/nn-unknwn-iunknown) , но не содержит дополнительных элементов.

## <a name="related-collections"></a>Связанные коллекции

Можно переходить от этой коллекции к любой из следующих коллекций:

-   [**ErrorInfo**](errorinfo.md)
-   [**PropertyInfo**](propertyinfo.md)
-   [**релатедколлектионинфо**](relatedcollectioninfo.md)

Вы можете переходить к этой коллекции из следующих коллекций:

-   [**Приложения**](applications.md)

## <a name="properties"></a>Элемент Property

Объект [**комадминкаталогобжект**](comadmincatalogobject.md) в коллекции поддерживает следующие свойства:

-   [AccessPermissions](#accesspermissions)
-   [активатеатстораже](#activateatstorage)
-   [AppID](#appid)
-   [AppName](#appname)
-   [аусентикатионлевел](#authenticationlevel)
-   [Разрядность](#bitness)
-   [ClassName](#classname)
-   [ЭТОМУ](#clsid)
-   [дллсуррогате](#dllsurrogate)
-   [InprocHandler32](#inprochandler32)
-   [InprocServer32](#inprocserver32)
-   [IsEnabled](#isenabled)
-   [лаунчпермиссионс](#launchpermissions)
-   [LocalServer32](#localserver32)
-   [локальная служба.](#localservice)
-   [Пароль](#password)
-   [ProgID:](#progid)
-   [RemoteServer](#remoteserver)
-   [RunAs](#runas)
-   [сервицепараметер](#serviceparameter)
-   [срптрустлевел](#srptrustlevel)
-   [ThreadingModel](#threadingmodel)

### <a name="accesspermissions"></a>AccessPermissions



| Ввод | Значение |
|----------------|---------------------------------------------------------------------------------|
| Описание    | Указывает учетные записи пользователей, которым разрешен или запрещен доступ к компоненту. |
| Access         | ReadWrite                                                                       |
| Тип           | Строка                                                                          |
| По умолчанию        | Недоступно                                                                             |
| Минимальная система | Windows XP                                                                      |



 

### <a name="activateatstorage"></a>активатеатстораже



| Ввод | Значение |
|----------------|------------------------------------------------------------------|
| Описание    | Указывает, следует ли запускать сервер на компьютере хранения данных. |
| Access         | ReadWrite                                                        |
| Тип           | Допустимые значения строки: "N" "Y"                                    |
| По умолчанию        | "N"                                                              |
| Минимальная система | Windows XP                                                       |



 

### <a name="appid"></a>AppID



| Ввод | Значение |
|----------------|---------------------|
| Описание    | Код приложения. |
| Access         | ReadOnly            |
| Тип           | Строка              |
| По умолчанию        | Недоступно                 |
| Минимальная система | Windows XP          |



 

### <a name="appname"></a>AppName



| Ввод | Значение |
|----------------|------------------------------|
| Описание    | Имя приложения. |
| Access         | ReadOnly                     |
| Тип           | Строка                       |
| По умолчанию        | Недоступно                          |
| Минимальная система | Windows XP                   |



 

### <a name="authenticationlevel"></a>аусентикатионлевел



| Ввод | Значение |
|----------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Описание    | Задает уровень проверки подлинности для вызовов со значениями, соответствующими параметрам проверки подлинности удаленного вызова процедур (RPC). При выборе Комадминаусентикатиондефаулт используется параметр в свойстве Дефаултаусентикатионлевел в коллекции [**локалкомпутер**](localcomputer.md) . |
| Access         | ReadWrite                                                                                                                                                                                                                                                                                             |
| Тип           | Длинные возможные значения: Комадминаусентикатиондефаулт (0) Комадминаусентикатионноне (1) Комадминаусентикатионконнект (2) COMAdminAuthenticationCall (3) COMAdminAuthenticationPacket (4) COMAdminAuthenticationIntegrity (5) COMAdminAuthenticationPrivacy (6)                                              |
| По умолчанию        | Комадминаусентикатиондефаулт (0)                                                                                                                                                                                                                                                                     |
| Минимальная система | Windows XP                                                                                                                                                                                                                                                                                            |



 

> [!Note]  
> Рекомендуется использовать константы в перечислении, а не числовые значения.

 

### <a name="bitness"></a>Разрядность



| Ввод | Значение |
|----------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Описание    | Представляет двоичный тип разрядности компонента. в системах, использующих 64-разрядные Windows, это свойство различает 64-разрядные компоненты и 32-разрядные компоненты. |
| Access         | ReadOnly                                                                                                                                                              |
| Тип           | Длинные возможные значения: COMAdmin32BitComponent (0x1) COMAdmin64BitComponent (0x2)                                                                                         |
| По умолчанию        | Недоступно                                                                                                                                                                   |
| Минимальная система | Windows XP                                                                                                                                                            |



 

### <a name="classname"></a>ClassName



| Ввод | Значение |
|----------------|------------------------|
| Описание    | Имя класса. |
| Access         | ReadOnly               |
| Тип           | Строка                 |
| По умолчанию        | Недоступно                    |
| Минимальная система | Windows XP             |



 

### <a name="clsid"></a>CLSID



| Ввод | Значение |
|----------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------|
| Описание    | Идентификатор GUID для компонента. Это свойство возвращается при вызове метода свойства [**ключа**](/windows/desktop/api/ComAdmin/nf-comadmin-icatalogobject-get_key) для объекта этой коллекции. |
| Access         | ReadOnly                                                                                                                                                  |
| Тип           | Строка                                                                                                                                                    |
| По умолчанию        | Недоступно                                                                                                                                                       |
| Минимальная система | Windows XP                                                                                                                                                |



 

### <a name="dllsurrogate"></a>дллсуррогате



| Ввод | Значение |
|----------------|------------------------------------------------------------|
| Описание    | Указывает полный путь к серверному приложению суррагате. |
| Access         | ReadWrite                                                  |
| Тип           | Строка                                                     |
| По умолчанию        | Недоступно                                                        |
| Минимальная система | Windows XP                                                 |



 

### <a name="inprochandler32"></a>InprocHandler32



| Ввод | Значение |
|----------------|--------------------------------------------------------------------|
| Описание    | Указывает полный путь к 32-разрядной библиотеке DLL пользовательского обработчика. |
| Access         | ReadWrite                                                          |
| Тип           | Строка                                                             |
| По умолчанию        | Недоступно                                                                |
| Минимальная система | Windows XP                                                         |



 

### <a name="inprocserver32"></a>InprocServer32



| Ввод | Значение |
|----------------|------------------------------------------------------------|
| Описание    | Указывает полный путь к 32-разрядной библиотеке DLL внутрипроцессного сервера. |
| Access         | ReadWrite                                                  |
| Тип           | Строка                                                     |
| По умолчанию        | Недоступно                                                        |
| Минимальная система | Windows XP                                                 |



 

### <a name="isenabled"></a>IsEnabled



| Ввод | Значение |
|----------------|-------------------------------------------------------------------------------------------------------------------------------------------|
| Описание    | Если приложение или компонент COM+ отключены, параметр Enable имеет значение false. Если приложение или компонент COM+ включен, то параметр Enabled имеет значение true. |
| Access         | ReadWrite                                                                                                                                 |
| Тип           | Bool                                                                                                                                      |
| По умолчанию        | Верно                                                                                                                                      |
| Минимальная система | Windows XP                                                                                                                                |



 

### <a name="launchpermissions"></a>лаунчпермиссионс



| Ввод | Значение |
|----------------|----------------------------------------------------------------------------------------|
| Описание    | Указывает учетные записи пользователей, которым разрешено или запрещено разрешение на запуск этого компонента. |
| Access         | ReadWrite                                                                              |
| Тип           | Строка                                                                                 |
| По умолчанию        | Недоступно                                                                                    |
| Минимальная система | Windows XP                                                                             |



 

### <a name="localserver32"></a>LocalServer32



| Ввод | Значение |
|----------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Описание    | Указывает полный путь к 32-битному локальному серверному приложению. Чтобы защитить систему безопасности системы, используйте заключенные в кавычки строки в пути, чтобы указать, где заканчивается имя исполняемого файла и начинаются аргументы. Например, " \\ " C: \\ Program Files \\ Files \\Application.exe\\ "param1 Param2". |
| Access         | ReadWrite                                                                                                                                                                                                                                                                                   |
| Тип           | Строка                                                                                                                                                                                                                                                                                      |
| По умолчанию        | Недоступно                                                                                                                                                                                                                                                                                         |
| Минимальная система | Windows XP                                                                                                                                                                                                                                                                                  |



 

### <a name="localservice"></a>локальная служба.



| Ввод | Значение |
|----------------|-----------------------------------------------------|
| Описание    | Указывает полный путь к приложению службы. |
| Access         | ReadWrite                                           |
| Тип           | Строка                                              |
| По умолчанию        | Недоступно                                                 |
| Минимальная система | Windows XP                                          |



 

### <a name="password"></a>Пароль



| Ввод | Значение |
|----------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Описание    | Задает пароль, используемый процессом сервера для входа в систему с указанным удостоверением запуска от имени. Пароль должен быть задан в то же время, что и идентификатор запуска от имени, до использования команды [**SaveChanges**](/windows/desktop/api/ComAdmin/nf-comadmin-icatalogcollection-savechanges), так как пароль и удостоверение проверяются перед сохранением. Если пароль и удостоверение не будут синхронизированы, компонент нельзя будет запустить до тех пор, пока администратор не запустит их. |
| Access         | WriteOnly                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Тип           | Строка                                                                                                                                                                                                                                                                                                                                                                                                                       |
| По умолчанию        | NULL                                                                                                                                                                                                                                                                                                                                                                                                                         |
| Минимальная система | Windows XP                                                                                                                                                                                                                                                                                                                                                                                                                   |



 

### <a name="progid"></a>ProgID:



| Ввод | Значение |
|----------------|--------------------------------------------------------------------------------------------------------------------------------------|
| Описание    | Имя, идентифицирующее компонент. Это свойство возвращается при вызове метода свойства Name для объекта этой коллекции. |
| Access         | ReadOnly                                                                                                                             |
| Тип           | Строка                                                                                                                               |
| По умолчанию        | Недоступно                                                                                                                                  |
| Минимальная система | Windows XP                                                                                                                           |



 

### <a name="remoteserver"></a>RemoteServer



| Ввод | Значение |
|----------------|---------------------------------------|
| Описание    | Указывает компьютер удаленного сервера. |
| Access         | ReadWrite                             |
| Тип           | Строка                                |
| По умолчанию        | Недоступно                                   |
| Минимальная система | Windows XP                            |



 

### <a name="runas"></a>RunAs



| Ввод | Значение |
|----------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Описание    | Указывает пользователя, удостоверение которого будет выполняться компонентом. Пароль должен быть задан в то же время, что и идентификатор запуска от имени, до использования команды [**SaveChanges**](/windows/desktop/api/ComAdmin/nf-comadmin-icatalogcollection-savechanges), так как пароль и удостоверение проверяются перед сохранением. Если пароль и удостоверение не будут синхронизированы, компонент нельзя будет запустить до тех пор, пока администратор не запустит их. |
| Access         | ReadWrite                                                                                                                                                                                                                                                                                                                                                                                         |
| Тип           | Строка                                                                                                                                                                                                                                                                                                                                                                                            |
| По умолчанию        | Недоступно                                                                                                                                                                                                                                                                                                                                                                                               |
| Минимальная система | Windows XP                                                                                                                                                                                                                                                                                                                                                                                        |



 

### <a name="serviceparameter"></a>сервицепараметер



| Ввод | Значение |
|----------------|-------------------------------------------------------------------------------------------|
| Описание    | Указывает параметры, передаваемые в приложение при вызове в качестве приложения службы. |
| Access         | ReadWrite                                                                                 |
| Тип           | Строка                                                                                    |
| По умолчанию        | Недоступно                                                                                       |
| Минимальная система | Windows XP                                                                                |



 

### <a name="srptrustlevel"></a>срптрустлевел



| Ввод | Значение |
|----------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Описание    | Указывает уровень доверия для компонента в политике ограниченного использования программ (SRP). Уровень доверия SRP относится к уровню доверия, который вы желаете присвоить компоненту. Неограниченный уровень доверия SRP соответствует более безопасному \_ \_ значению перечисления LEVELID фуллитрустед, а недопустимый уровень доверия SRP соответствует более безопасному \_ \_ неразрешенному значению LEVELID. Перечисление уровней доверия определяется в Винсафер. h. |
| Access         | ReadWrite                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Тип           | Допустимые значения: БЕЗОПАСная \_ LEVELID \_ запрещена (0x0) более безопасная \_ LEVELID \_ фуллитрустед (0x40000)                                                                                                                                                                                                                                                                                                                                         |
| По умолчанию        | более безопасный \_ LEVELID \_ фуллитрустед                                                                                                                                                                                                                                                                                                                                                                                                        |
| Минимальная система | Windows XP                                                                                                                                                                                                                                                                                                                                                                                                                          |



 

Компонент, который вы готовы к доверию с неограниченным доступом, должен иметь наиболее строгий уровень безопасности, подключенный к нему. Приложения, которые не ограничены, могут загружать только неограниченные компоненты, в то время как запрещенные приложения не будут запускаться и поэтому не смогут загрузить какие бы то ни было компоненты.

### <a name="threadingmodel"></a>ThreadingModel.



| Ввод | Значение |
|----------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Описание    | Определяет, как экземпляры компонента назначаются потокам для выполнения метода. Значения соответствуют моделям потоков COM.                                                  |
| Access         | ReadOnly                                                                                                                                                                            |
| Тип           | Длинные возможные значения: Комадминсреадингмоделапартмент (0) Комадминсреадингмоделфри (1) Комадминсреадингмоделмаин (2) COMAdminThreadingModelBoth (3) COMAdminThreadingModelNeutral (4) |
| По умолчанию        | Недоступно                                                                                                                                                                                 |
| Минимальная система | Windows XP                                                                                                                                                                          |



 

## <a name="see-also"></a>См. также раздел

<dl> <dt>

[Коллекции администрирования COM+](com--administration-collections.md)
</dt> </dl>

 

 
