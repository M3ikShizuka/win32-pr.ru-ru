---
description: Группировка объектов в пул — это автоматическая служба, предоставляемая COM+, которая позволяет настроить компонент для сохранения активных экземпляров в пуле, готовых к использованию любым клиентом, запрашивающим этот компонент.
ms.assetid: 74a45220-449a-4d89-a979-a206e5e3d3ad
title: Основные понятия пула объектов COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 836dd6f29c2f0bd120843a1a93763d46cb51224966f255251f7e3bfb4c7fa66a
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119129146"
---
# <a name="com-object-pooling-concepts"></a>Основные понятия пула объектов COM+

Группировка объектов в пул — это автоматическая служба, предоставляемая COM+, которая позволяет настроить компонент для сохранения активных экземпляров в пуле, готовых к использованию любым клиентом, запрашивающим этот компонент. Можно выполнять административную настройку и мониторинг пула, поддерживаемого для данного компонента, указывая такие характеристики, как размер пула и время ожидания запроса на создание. Когда приложение выполняется, COM+ управляет пулом, обрабатывая сведения об активации и повторном использовании объектов в соответствии с заданными критериями.

Вы можете добиться очень значительных преимуществ производительности и масштабирования, используя объекты таким образом, особенно при написании, чтобы воспользоваться всеми преимуществами повторного использования. При использовании пула объектов вы получаете следующие преимущества:

-   Вы можете ускорить использование объектов для каждого клиента, разделять время на инициализацию и получение ресурсов от реальной работы, выполняемой объектом для клиентов.
-   Вы можете поделиться затратами на приобретение дорогостоящих ресурсов для всех клиентов.
-   Вы можете предварительно распределять объекты при запуске приложения, прежде чем поступать в клиентские запросы.
-   Вы можете управлять использованием ресурсов с помощью управления административным пулом, например, установив соответствующий максимальный уровень пула, можно оставаться открытым только столько подключений к базам данных, сколько есть лицензия.
-   Вы можете административно настроить пулы, чтобы воспользоваться преимуществами доступных аппаратных ресурсов, можно легко настроить конфигурацию пула по мере изменения доступных ресурсов оборудования.
-   Время повторной активации можно ускорить для объектов, использующих [JIT-активацию](com--just-in-time-activation.md), и намеренно управлять выделением ресурсов для клиентов.

## <a name="writing-poolable-objects"></a>Запись объектов в пуле

Объекты, которые могут быть объединены в пул, должны отвечать определенным требованиям, чтобы обеспечить использование одного экземпляра объекта несколькими клиентами. Например, они не могут удерживать состояние клиента или иметь сходство потоков. Транзакционные объекты также имеют определенные требования, в то же, что управляемые ресурсы, удерживаемые объектом poold, должны прикрепляться к транзакции вручную.

Объекты в составе пула могут реализовывать [**IObjectControl**](/windows/desktop/api/ComSvcs/nn-comsvcs-iobjectcontrol) , чтобы контролировать их повторное использование. Это позволяет выполнять инициализацию при активации в заданном контексте, очищать состояние клиента при деактивации и указывать, когда они находятся в непригодном для использования состоянии.

Часто бывает полезно писать объекты poold довольно универсально, чтобы их можно было изменять с помощью строки конструктора. Например, объект может быть записан для хранения универсального соединения ODBC с определенным DSN, указанным администратором в строке конструктора.

Подразделы этого раздела, описанные в следующей таблице, содержат сведения о том, как работает пул объектов в COM+, а также сведения о том, как создавать, настраивать и реализовывать объекты, доступные в пуле.



| Раздел                                                                                                 | Описание                                                                                              |
|-------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------|
| [Как работает пул объектов](how-object-pooling-works.md)<br/>                                   | Представляет основные понятия.<br/>                                                                      |
| [Повышение производительности с помощью пула объектов](improving-performance-with-object-pooling.md)<br/> | Содержит конкретные сведения о наиболее эффективном использовании пула объектов.<br/>                 |
| [Требования к объектам в пуле](requirements-for-poolable-objects.md)<br/>                 | Содержит сведения о том, как написать объект, который должен быть помещен в пул.<br/>                              |
| [Группирование транзакционных объектов в пул](pooling-transactional-objects.md)<br/>                         | Предоставляет подробные сведения о специальных требованиях, применяемых к транзакционным объектам в пуле.<br/> |
| [Управление временем существования и состоянием объекта](controlling-object-lifetime-and-state.md)<br/>         | Описывает, как можно реализовать объекты в составе пула, чтобы контролировать их повторное использование.<br/>               |



 

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Задачи пула объектов COM+](com--object-pooling-tasks.md)
</dt> </dl>

 

 




