---
description: Служба событий COM+ используется для управления доставкой событий от издателей подписчикам.
ms.assetid: 0945163b-1276-47f6-ae7f-9d932a1b586d
title: Использование событий COM+ с компонентами в очереди COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4be31dd1088b720902295738c23173c28145cef2
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105710789"
---
# <a name="using-com-events-with-com-queued-components"></a>Использование событий COM+ с компонентами в очереди COM+

Служба событий COM+ используется для управления доставкой событий от издателей подписчикам. Службу очередей компонентов COM+ можно использовать для того, чтобы время обработки издателя и подписчика не зависело от постановки в очередь сообщения издателя и последующего его воспроизведения на подписчике. Необходимость использования службы очередей компонентов зависит от базовой бизнес-логики приложения. Если требуется, чтобы события не зависели от времени, их можно создать с помощью службы COM+ Events в службе очередей компонентов COM+.

> [!Note]  
> Дополнительные сведения об использовании службы очередей компонентов COM+ см. в разделе [com+ Queued Components](com--queued-components.md).

 

Служба очередей компонентов поддерживает порядок вызова методов в одном сообщении. Средство записи выполняет пакетную обработку всех вызовов методов в сообщении, после чего проигрыватель вызывает эти методы по порядку при обработке сообщения.

Устройство записи и проигрыватель с очередями можно разместить в одном из следующих двух мест:

-   Между издателем и объектом события
-   Между объектом события и подписчиком

При размещении средства записи и проигрывателя между издателем и объектом события выполняется создание компонента [класса событий](the-com--event-class-object.md) куеуабле. Компонент класса событий должен быть помечен для постановки в очередь и активироваться проигрывателем в процессе, отдельном от издателя.

Для асинхронной доставки событий создайте устройство записи и проигрыватель между объектом события и подписчиком и установите атрибут queued объекта Subscription. Это задает Субскрибермоникер следующим образом: "очередь:/New:/ {12345678-1234-1234-1234-123456789012} ".

При использовании компонентов в очереди в ситуации с событиями необходимо учитывать порядок доставки. Так как служба очередей компонентов записывает и воспроизводит все вызовы в течение всего времени существования одного объекта в одном сообщении, все вызовы воспроизводятся в том порядке, в котором они были сделаны. Однако, если имеется несколько сеансов с несколькими объектами, порядок гарантировать нельзя. Если важен порядок, убедитесь, что вызовы, которые должны воспроизводиться в последовательном порядке, находятся на одном и том же экземпляре объекта.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Фильтрация событий в COM+](filtering-events-in-com-.md)
</dt> <dt>

[Публикация и доставка событий в COM+](publishing-and-delivering-events-in-com-.md)
</dt> <dt>

[Подписки](subscriptions.md)
</dt> <dt>

[Объект класса событий COM+](the-com--event-class-object.md)
</dt> </dl>

 

 



