---
description: Использование компьютера, использующего протокол HTTP, позволяет пользователям использовать веб-браузер для простого доступа к информации на удаленном сервере по сети.
ms.assetid: 44f3ff21-4978-4902-aa74-ddeef60881db
title: Общие сведения о службе COM+ SOAP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b93ce7d80753f306777d3ac0b77dc46dc4e08d22
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105662095"
---
# <a name="com-soap-service-overview"></a>Общие сведения о службе COM+ SOAP

Использование компьютера, использующего протокол HTTP, позволяет пользователям использовать веб-браузер для простого доступа к информации на удаленном сервере по сети. Веб-службы XML теперь затронули разработку приложений, позволяя клиентским приложениям легко вызывать удаленные методы по сети.

Часто бывает полезно, чтобы клиентское приложение могло вызывать метод, реализованный на удаленном сервере. Иногда метод использует временные данные, хранящиеся на удаленном сервере (например, метод, который возвращает текущую цену акции, соответствующую заданному символу-отметке). В других случаях разработчику требуется возможность обновления реализации методов без необходимости повторного развертывания всех приложений, которые его используют.

Как и веб-страницы, доступ к XML Web Services осуществляется через веб-сервер, например IIS, с использованием протокола HTTP. Однако вместо веб-страниц, закодированных в HTML, эти пакеты HTTP содержат входные и выходные параметры вызовов к методу, реализованному на сервере, закодированном в SOAP.

Чтобы использовать веб-службу XML, необходимо знать URL-адрес, по которому предоставляется служба, и имя метода, который необходимо вызвать, и указать входные параметры для метода. [Стандарт SOAP 1,1](https://www.w3.org/TR/SOAP/) предоставляет следующий пример пакета HTTP, содержащего удаленный вызов веб-службы XML по адресу https://www.stockquoteserver.com/StockQuote , который возвращает текущую цену на акцию, соответствующую данному символу Tick.

``` syntax
POST /StockQuote HTTP/1.1
Host: www.stockquoteserver.com
Content-Type: text/xml; "charset=utf-8"
Content-Length: nnnn
SOAPAction: "Some-URI"

<SOAP-ENV:Envelope
xmlns:SOAP-ENV="https://schemas.xmlsoap.org/soap/envelope/"
SOAP-ENV:encodingStyle="https://schemas.xmlsoap.org/soap/encoding/">
<SOAP-ENV:Body>
<m:GetLastTradePrice xmlns:m="Some-URI">
<symbol>DIS</symbol>
</m:GetLastTradePrice>
</SOAP-ENV:Body>
</SOAP-ENV:Envelope>
```

Как показано в предыдущем примере, SOAP — это экземпляр XML, который может быть внедрен в HTTP-запрос. Аналогичным образом результат возвращается как HTTP-пакет с полезной нагрузкой SOAP, как показано в следующем примере.

``` syntax
HTTP/1.1 200 OK
Content-Type: text/xml; "charset=utf-8"
Content-Length: nnnn

<SOAP-ENV:Envelope
xmlns:SOAP-ENV="https://schemas.xmlsoap.org/soap/envelope/"
SOAP-ENV:encodingStyle="https://schemas.xmlsoap.org/soap/encoding//">
<SOAP-ENV:Body>
<m:GetLastTradePriceResponse xmlns:m="Some-URI">
<Price>34.5</Price>
</m:GetLastTradePriceResponse>
</SOAP-ENV:Body>
</SOAP-ENV:Envelope>
```

Хотя полезно иметь представление об инфраструктуре, которая является веб-службами XML, COM+ упрощает создание и использование веб-служб XML, которые часто не приходится углубляться на этот уровень.

Вы можете предоставлять методы в интерфейсах по умолчанию настроенных компонентов COM в любом приложении COM+ в качестве веб-службы XML. При написании компонентов не требуются специальные рекомендации по программированию, за исключением того, что методы, которые необходимо предоставить, должны быть в интерфейсе по умолчанию, а компонент должен быть настроен (в каталоге COM+ сервера). Не требуется писать код для взаимодействия через сетевой интерфейс или для синтаксического анализа SOAP. Подробные инструкции по использованию службы COM+ SOAP для создания веб-службы XML см. в разделе [Создание веб-служб XML](creating-xml-web-services.md).

При предоставлении приложения COM+ в качестве веб-службы XML подробные сведения о синтаксисе всех методов, доступных из веб-службы XML, публикуются автоматически с помощью языка описания веб-служб (WSDL). Эти сведения используются клиентами, которые используют веб-службу XML.

COM+ предоставляет два способа доступа и использования удаленной веб-службы XML, как показано ниже.

-   Режим *хорошо известного объекта* (ВКО) можно использовать для доступа к любой веб-службе XML, которая публикует свой синтаксис с помощью WSDL, даже если эта веб-служба XML не была создана с помощью COM+ или даже Microsoft Windows.
-   Режим *активируемого клиентом объекта* (Као) можно использовать только для доступа к веб-службам XML, созданным посредством предоставления приложений COM+. Режим Као повышает производительность с помощью постоянных подключений, функции, которая не поддерживается текущим стандартом SOAP.

Оба метода позволяют клиентским приложениям удаленно вызывать методы веб-служб XML, не требуя написания кода для взаимодействия через сетевой интерфейс или синтаксического анализа SOAP. Дополнительные сведения о доступе к веб-службам XML в любом режиме см. в разделе [доступ к веб-службам XML в режиме Као](accessing-xml-web-services-in-cao-mode.md) и [доступ к веб-службам XML в режиме ВКО](accessing-xml-web-services-in-wko-mode.md).

> [!Note]  
> COM+ поддерживает только спецификацию SOAP-RPC, а не спецификацию SOAP-Document.

 

COM+ упрощает использование веб-служб XML, позволяя использовать существующие приложения COM+ в качестве веб-служб XML в режиме Као, полностью прозрачным образом. При [экспорте](exporting-a-soap-enabled-application.md) приложения COM+, которое было предоставлено в виде веб-службы XML с сервера, любой клиент, выполняющий [Импорт](importing-a-soap-enabled-application.md) приложения, может прозрачно использовать веб-службу сервера XML при каждом использовании импортированного приложения. Это средство значительно упрощает преобразование существующих приложений COM+ в веб-службы XML и развертывание этих служб в сети.

Использование веб-служб XML имеет несколько уникальных преимуществ по сравнению с альтернативными реализациями удаленных вызовов процедур (RPC), включая следующие.

-   SOAP — это полноценная межплатформенная реализация RPC, которая повышает совместимость.
-   Веб-службы XML поддерживают методы с входными и выходными параметрами.
-   Веб-службы XML выполняются через HTTP, что обычно может проникнуть брандмауэры, которые могут блокировать другие реализации RPC.
-   Если веб-служба XML реализована с помощью COM+, разработчику не нужно писать специальный код. Это чрезвычайное преимущество по сравнению с альтернативными механизмами RPC.

> [!Note]  
> Веб-службы XML не поддерживают асинхронные или прозрачные вызовы транзакций. Если эта функция необходима, используйте службу [com+ в очереди компонентов](com--queued-components.md) .

 

## <a name="related-topics"></a>См. также

<dl> <dt>

[Вопросы безопасности службы COM+ SOAP](com--soap-service-security-considerations.md)
</dt> </dl>

 

 



