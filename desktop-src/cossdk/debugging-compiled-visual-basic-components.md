---
description: Учитывая, что во многих случаях вы сможете отлаживать только часть функциональных возможностей компонентов в среде Microsoft Visual Basic, существуют ситуации, в которых потребуется отладка компонентов, созданных с Visual Basic после компиляции. Так как среда Visual Basic не включает это, необходимо использовать среду Microsoft Visual C++.
ms.assetid: a58c5884-3c2d-4699-8b19-277003912dfd
title: Отладка скомпилированных компонентов Visual Basic
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 07b32a39f0f1c50e1da4c9534b40658838361225
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104141459"
---
# <a name="debugging-compiled-visual-basic-components"></a>Отладка скомпилированных компонентов Visual Basic

Учитывая, что во многих случаях вы сможете отлаживать только часть функциональных возможностей компонента в среде Microsoft Visual Basic, существуют ситуации, в которых потребуется отладка компонентов, созданных с Visual Basic после компиляции. Так как среда Visual Basic не включает это, необходимо использовать среду Microsoft Visual C++.

**Отладка компонента Visual Basic в среде Visual C++**

1.  В Visual Basic 6,0 откройте проект Visual Basic, который требуется отладить.

2.  В меню **файл** выберите команду **создать YourProject.dll**.

3.  В диалоговом окне **Создание проекта** нажмите кнопку **Параметры**.

4.  В диалоговом окне **Свойства проекта** на вкладке **Компиляция** щелкните **компилировать в машинный код** **без оптимизации** и установите флажок **создать символьную отладочную информацию** .

5.  Нажмите кнопку **ОК**, а затем еще раз нажмите кнопку **ОК** , чтобы скомпилировать проект.

6.  Переместите скомпилированную библиотеку DLL в расположение, в котором обычно установлены приложения COM+.

    > [!Note]  
    > Если вы не перемещаете библиотеку DLL, может появиться сообщение об ошибке, информирующее о том, что не удалось найти символьную отладочную информацию для библиотеки DLL. Если вы не можете заставить отладчик останавливаться на точках останова в компоненте, убедитесь, что библиотека DLL находится в каталоге стандартных пакетов, удалите компонент из пакета и повторно добавьте компонент.

     

7.  Запустите Visual C++.

8.  В меню **файл** выберите пункт **открыть рабочую область**.

9.  В диалоговом окне **открыть рабочую область** установите для **файлов типа** значение **все файлы ( \* . \* )**, выберите скомпилированный компонент и нажмите кнопку **Открыть**.

10. В меню **файл** выберите пункт **Открыть** (не **открыть рабочую область**) и откройте модуль Visual Basic (. BAS), форму (. frm) или класс (CLS), который требуется отладить.

11. В меню **проект** выберите пункт **Параметры**.

12. В диалоговом окне **Параметры проекта** на вкладке **Отладка** выберите **Общие** в поле **Категория** .

13. В поле **исполняемый файл для сеанса отладки** введите полный путь к Dllhost.exe, за которым следует аргумент, указывающий идентификатор процесса приложения COM+, содержащего компонент. Идентификатор процесса можно найти на вкладке **Общие** диалогового окна **свойства** приложения COM+. Ниже приведен пример: C: \\ WinNT \\ system32 \\Dllhost.exe/процессид: { <processID> }.

14. Нажмите кнопку **ОК**.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Поддержка отладки Visual Basic COM+ отличается от MTS](com--visual-basic-debugging-support-contrasted-with-mts.md)
</dt> <dt>

[Отладка в интегрированной среде разработки Visual Basic](debugging-in-the-visual-basic-ide.md)
</dt> </dl>

 

 



