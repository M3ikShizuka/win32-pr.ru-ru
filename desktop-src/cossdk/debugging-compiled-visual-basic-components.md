---
description: учитывая, что во многих случаях вы сможете отлаживать только часть функциональных возможностей компонентов в среде Microsoft Visual Basic, существуют ситуации, в которых потребуется отладка компонентов, созданных с Visual Basic после компиляции. так как среда Visual Basic не включает это, необходимо использовать среду Microsoft Visual C++.
ms.assetid: a58c5884-3c2d-4699-8b19-277003912dfd
title: отладка скомпилированных компонентов Visual Basic
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2eac784808602d3554e4610e70a8d8a22ef2ca1594062599ec6acd43db68b98a
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119128786"
---
# <a name="debugging-compiled-visual-basic-components"></a>отладка скомпилированных компонентов Visual Basic

учитывая, что во многих случаях вы сможете отлаживать только часть функциональных возможностей компонента в среде Microsoft Visual Basic, существуют ситуации, в которых потребуется отладка компонентов, созданных с Visual Basic после компиляции. так как среда Visual Basic не включает это, необходимо использовать среду Microsoft Visual C++.

**отладка компонента Visual Basic в среде Visual C++**

1.  в Visual Basic 6,0 откройте проект Visual Basic, который требуется отладить.

2.  В меню **файл** выберите команду **создать YourProject.dll**.

3.  в диалоговом окне **создание Project** нажмите кнопку **параметры**.

4.  в диалоговом окне **свойства Project** на вкладке **компиляция** щелкните **компилировать в машинный код** **без оптимизации** и установите флажок **создать символьную отладочную информацию** .

5.  Нажмите кнопку **ОК**, а затем еще раз нажмите кнопку **ОК** , чтобы скомпилировать проект.

6.  Переместите скомпилированную библиотеку DLL в расположение, в котором обычно установлены приложения COM+.

    > [!Note]  
    > Если вы не перемещаете библиотеку DLL, может появиться сообщение об ошибке, информирующее о том, что не удалось найти символьную отладочную информацию для библиотеки DLL. Если вы не можете заставить отладчик останавливаться на точках останова в компоненте, убедитесь, что библиотека DLL находится в каталоге стандартных пакетов, удалите компонент из пакета и повторно добавьте компонент.

     

7.  Запустите Visual C++.

8.  В меню **файл** выберите пункт **открыть рабочую область**.

9.  В диалоговом окне **открыть рабочую область** установите для **файлов типа** значение **все файлы ( \* . \* )**, выберите скомпилированный компонент и нажмите кнопку **Открыть**.

10. в меню **файл** выберите пункт **открыть** (не **открыть рабочую область**) и откройте модуль Visual Basic (. bas), форму (. frm) или класс (cls), который требуется отладить.

11. в меню **Project** выберите пункт **Параметры**.

12. в диалоговом окне **Project Параметры** на вкладке **отладка** выберите **общие** в поле **категория** .

13. В поле **исполняемый файл для сеанса отладки** введите полный путь к Dllhost.exe, за которым следует аргумент, указывающий идентификатор процесса приложения COM+, содержащего компонент. Идентификатор процесса можно найти на вкладке **Общие** диалогового окна **свойства** приложения COM+. Ниже приведен пример: C: \\ WinNT \\ system32 \\Dllhost.exe/процессид: { <processID> }.

14. Нажмите кнопку **ОК**.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[поддержка отладки Visual Basic COM+ отличается от MTS](com--visual-basic-debugging-support-contrasted-with-mts.md)
</dt> <dt>

[отладка в интегрированной среде разработки Visual Basic](debugging-in-the-visual-basic-ide.md)
</dt> </dl>

 

 



