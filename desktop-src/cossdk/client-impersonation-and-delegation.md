---
description: В некоторых случаях серверное приложение должно представлять клиентское удостоверение для ресурсов, к которым он обращается от имени клиента. обычно это вызывает проверку доступа или проверку подлинности для удостоверения клиентов.
ms.assetid: fd75eb54-eefe-411f-a7aa-0bc8628f8778
title: Олицетворение и делегирование клиента
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3f8b0262f3d8dd6736d183fa76eb5d3f0946d50b2724e76bcea73843644aaefb
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119129376"
---
# <a name="client-impersonation-and-delegation"></a>Олицетворение и делегирование клиента

В некоторых случаях серверное приложение должно представлять идентификатор клиента для ресурсов, к которым он обращается от имени клиента. обычно это вызывает проверку доступа или проверку подлинности для удостоверения клиента. В определенный экстент сервер может действовать под удостоверением клиента — действие, называемое олицетворением клиента.

*Олицетворение* — это возможность выполнения потока в контексте безопасности, отличном от процесса, владеющего потоком. Серверный поток использует маркер доступа, представляющий учетные данные клиента, и при этом он может получить доступ к ресурсам, к которым у клиента есть доступ.

Использование олицетворения гарантирует, что сервер может выполнять точно то, что может сделать клиент. Доступ к ресурсам может быть либо ограничен, либо расширен, в зависимости от того, что у клиента есть разрешение.

Можно выбрать, чтобы сервер олицетворяет клиента при подключении к базе данных, чтобы база данных могла пройти проверку подлинности и авторизовать клиента. Или, если приложение получает доступ к файлам, защищенным с помощью дескриптора безопасности, и позволяет клиенту получать авторизованный доступ к данным в этих файлах, приложение может олицетворять клиента перед доступом к файлам.

## <a name="how-to-implement-impersonation"></a>Как реализовать олицетворение

Для олицетворения требуется участие как клиента, так и сервера (и, в некоторых случаях, системных администраторов). Клиент должен указать его готовность, чтобы позволить серверу использовать удостоверение, и сервер должен явно предположить идентификацию клиента программным способом. Дополнительные сведения см. в разделах [требования на стороне клиента для олицетворения](client-side-requirements-for-impersonation.md) и [требования на стороне сервера для олицетворения](server-side-requirements-for-impersonation.md).

## <a name="administrative-requirements-for-delegate-level-impersonation"></a>Административные требования для Delegate-Level олицетворения

Чтобы эффективно использовать наиболее мощную форму олицетворения, *делегирования*, которая является олицетворением клиентов по сети, учетные записи пользователей клиента и сервера должны быть правильно настроены в службе Active Directory для их поддержки (в дополнение к предоставлению клиентом полномочий на олицетворение на уровне делегирования), как показано ниже.

-   Удостоверение сервера должно быть помечено как "доверенное для делегирования" в службе Active Directory.
-   Удостоверение клиента не должно быть помечено как "учетная запись является конфиденциальной и не может быть делегирована" в службе Active Directory.

Эти функции настройки дают администратору домена высокий уровень контроля над делегированием, что желательно, учитывая степень доверия (и, следовательно, риски безопасности). Дополнительные сведения о делегировании см. в разделе [Делегирование и олицетворение](/windows/desktop/com/delegation-and-impersonation).

## <a name="cloaking"></a>Маскировка

Наряду с полномочиями, которые клиент предоставляет серверу через уровень олицетворения, функция маскировки сервера во многом определяет, как будет вести себя олицетворение. Маскировка влияет на то, какие удостоверения фактически представляются сервером, когда он выполняет вызовы от имени клиента — его собственный или клиентский. Дополнительные сведения см. в разделе [маскировка](cloaking.md).

## <a name="performance-implications"></a>Влияние на производительность

Олицетворение может значительно повлиять на производительность и масштабирование. Как правило, олицетворение клиента в вызове является более затратным, чем вызов напрямую. Ниже приведены некоторые проблемы, которые следует учитывать.

-   Вычислительные издержки на передачу идентификаторов в сложных шаблонах, особенно если включена Динамическая маскировка.
-   Общая сложность применения избыточной проверки безопасности в многочисленных местах, а не просто централизованно на среднем уровне.
-   Такие ресурсы, как подключения к базе данных, при открытии олицетворения клиента, не могут быть повторно использованы для нескольких клиентов — очень большой препятствием для масштабирования.

Иногда единственным эффективным решением проблемы является использование олицетворения, но это решение следует тщательно взвесить. Дополнительные сведения об этих проблемах см. в статье [многоуровневая защита приложений](multi-tier-application-security.md).

## <a name="queued-components"></a>Очереди компонентов

[Поставленные в очередь компоненты](com--queued-components.md) не поддерживают олицетворение. Когда клиент выполняет вызов объекта в очереди, фактически выполняется вызов средства записи, который упаковывает его как часть сообщения на сервер. Затем прослушиватель считывает сообщение из очереди и передает его проигрывателю, который вызывает фактический серверный компонент и выполняет тот же вызов метода. Таким образом, когда сервер получает вызов, исходный маркер клиента недоступен через олицетворение. Тем не менее, безопасность на основе ролей по-прежнему применима и программная безопасность с помощью интерфейса [**исекуритикаллконтекст**](/windows/desktop/api/ComSvcs/nn-comsvcs-isecuritycallcontext) будет работать. Дополнительные сведения см. [в разделе Безопасность компонентов в очереди](queued-components-security.md).

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Аутентификация клиента](client-authentication.md)
</dt> <dt>

[Безопасность библиотечных приложений](library-application-security.md)
</dt> <dt>

[Многоуровневая защита приложений](multi-tier-application-security.md)
</dt> <dt>

[Безопасность программных компонентов](programmatic-component-security.md)
</dt> <dt>

[Администрирование безопасности на основе ролей](role-based-security-administration.md)
</dt> <dt>

[Использование политики ограниченного использования программ в COM+](using-the-software-restriction-policy-in-com-.md)
</dt> </dl>

 

 
