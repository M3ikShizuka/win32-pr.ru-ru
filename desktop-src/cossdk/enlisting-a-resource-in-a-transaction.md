---
description: Прикрепление ресурса в транзакции
ms.assetid: b41fe0aa-a4cf-4d4a-9543-8eb0b38f07a2
title: Прикрепление ресурса в транзакции
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: db0a0bf93f373872c8be79054899dea4199dda7e
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127457936"
---
# <a name="enlisting-a-resource-in-a-transaction"></a>Прикрепление ресурса в транзакции

После выделения ресурса, но непосредственно перед возвращением ресурса в распределитель ресурсов Диспетчер распределителя проверяет с помощью COM+, чтобы определить, выполняется ли вызывающий объект в транзакции. Если вызывающий объект выполняется в рамках транзакции, диспетчер распределителя обращается к распределителе ресурсов и запрашивает его прикрепление к ресурсу в транзакции. Затем ресурс возвращается в распределитель ресурсов, который затем возвращает его вызывающему экземпляру.

Распределитель ресурсов должен иметь возможность прикрепления к транзакции OLE с координатор распределенных транзакций (DTC).

> [!Note]  
> Прикрепление транзакции является необязательным, когда распределитель ресурсов распределяет нетранзакционные ресурсы, такие как память или потоки.

 

По завершении транзакции COM+ Уведомляет диспетчер распределителя о том, была ли она зафиксирована или прервана. Затем Диспетчер распределителя сообщает каждому контейнеру распределителя ресурсов, что все ресурсы, прикрепленные к этой транзакции, теперь можно переместить в общий учет.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Основные понятия распределителя ресурсов COM+](com--resource-dispenser-concepts.md)
</dt> <dt>

[Состояния ресурсов в пуле, доступные для распределителя ресурсов COM+](pooled-resource-states-available-to-com--resource-dispenser.md)
</dt> <dt>

[Процесс выделения ресурсов распределителя ресурсов](resource-dispenser-resource-allocation-process.md)
</dt> </dl>

 

 



