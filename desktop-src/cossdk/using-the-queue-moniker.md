---
description: Моникер очереди используется для активации компонента очереди программным способом.
ms.assetid: d3d22ae6-7d16-4f25-9f15-21b2163cb0f5
title: Использование моникера очереди
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 938b4c0c8afc19e953d7f62f17f95bbd63f387e6
ms.sourcegitcommit: 9b5faa61c38b2d0c432b7f2dbee8c127b0e28a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2021
ms.locfileid: "122473690"
---
# <a name="using-the-queue-moniker"></a>Использование моникера очереди

Моникер очереди используется для активации компонента очереди программным способом. Моникер очереди требует, чтобы он получал идентификатор класса (CLSID) объекта для вызова из нового моникера непосредственно справа от него. При использовании префикса слева новый моникер передает CLSID в моникер слева от него.

## <a name="component-services-administrative-tool"></a>Средство администрирования служб компонентов

Не применяется.

## <a name="visual-basic"></a>Visual Basic

Параметр отображаемого имени GetObject имеет значение "Queue:/New:", за которым следует идентификатор программы или идентификатор GUID строкового типа (или без фигурных скобок) объекта сервера, для которого создается экземпляр. В следующих примерах показаны три допустимые активации компонента с моникером очереди:

1.  ``` syntax
    Set objMyQC = GetObject ("queue:/new:QCShip.Ship")
    ```

2.  ``` syntax
    Set objMyQC = GetObject ("queue:/new:{812DF40E-BD88-11D0-8A6D-00C04FC340EE}")
    ```

3.  ``` syntax
    Set objMyQC = GetObject ("queue:/new:812DF40E-BD88-11D0-8A6D-00C04FC340EE")
    ```

## <a name="cc"></a>C/C++

Параметр отображаемого имени [**кожетобжект**](https://docs.microsoft.com/windows/desktop/api/objbase/nf-objbase-cogetobject) имеет значение "Queue:/New:", за которым следует идентификатор программы или идентификатор GUID строкового типа (или без фигурных скобок) объекта сервера, для которого создается экземпляр. В следующих примерах показаны три допустимые активации компонента с моникером очереди:

1.  ``` syntax
    hr = CoGetObject (
      L"queue:/new:QCShip.Ship",
      NULL, IID_IShip, (void**)&pShip);
    ```

2.  ``` syntax
    hr = CoGetObject (
      L"queue:/new:{812DF40E-BD88-11D0-8A6D-00C04FC340EE}", 
      NULL, IID_IShip, (void**)&pShip);
    ```

3.  ``` syntax
    hr = CoGetObject (
      L"queue:/new:812DF40E-BD88-11D0-8A6D-00C04FC340EE",
      NULL, IID_IShip, (void**)&pShip);
    ```

## <a name="remarks"></a>Комментарии

Моникер очереди принимает необязательные параметры, которые изменяют свойства сообщения, отправляемого в очередь сообщений. Например, чтобы сообщение очереди сообщений было отправлено с приоритетом 6, компонент очереди будет активирован следующим образом:

``` syntax
hr = CoGetObject (
  L"queue:Priority=6,ComputerName=MyComp/new:QCShip.Ship",
  NULL, IID_IShip, (void**)&pShip);
```

В следующей таблице перечислены параметры моникера очереди, влияющие на очередь назначения.




| Параметр | Описание | 
|-----------|-------------|
| <em>ИмяКомпьютера</em><br /> | Указывает часть имени компьютера в пути очереди сообщений. Путь очереди очереди сообщений имеет формат <em>ComputerName</em> \<em> QueueName </em> . Если не указано, используется имя компьютера, связанное с настроенным приложением.<br /> | 
| <em>QueueName</em><br /> | Указывает имя очереди сообщений. Путь очереди очереди сообщений имеет формат <em>ComputerName</em> \<em> QueueName </em> . Если не указано, используется имя очереди, связанное с настроенным приложением.<br /> Чтобы получить нетранзакционную очередь, сначала можно указать имя очереди, а затем создать приложение COM+ с тем же именем.<br /> | 
| <em>PathName</em><br /> | Указывает полное имя пути очереди сообщений. Если этот параметр не указан, используется имя пути очереди сообщений, связанное с настроенным приложением. Чтобы переопределить имя назначения, путь можно указать в следующей форме для установки рабочей группы очереди сообщений:<br /> Queue:<em>PathName</em> = <em>имя_компьютера</em>\привате $ \ AppName/New: MyProject. кмикласс<br /><blockquote>[!Note]<br />для языков программирования C и Microsoft Visual C++ требуется две обратные косые черты, представляющие одну обратную косую кавычки в строковых литералах, например, в чикаго \\ .</blockquote><br /> | 
| <em>FormatName</em><br /> | Если приложение COM+ помечается как поставленное в очередь, COM+ создает очередь сообщений, имя которой совпадает с именем приложения. Имя формата очереди сообщений в этой очереди находится в каталоге COM+, связанном с приложением COM+. Чтобы переопределить имя назначения, можно указать имя формата в следующей форме для установки рабочей группы очереди сообщений:<br /> Очередь:<em>FormatName</em>= Direct = OS:<em>имя_компьютера</em>\привате $ \ AppName/New: ProgID<br /> В конфигурации Active Directory "PRIVATE $" не указывается как часть имени очереди. <br /> | 




 

> [!Note]  
> Необязательные параметры моникера очереди обрабатываются слева направо. Указывайте каждое ключевое слово только один раз. При указании параметра *PathName* заменяются параметры *ComputerName* и *QueueName*. Конкретный параметр *FormatName* удаляет предыдущие сведения о параметре *ComputerName*, *QueueName* и *PathName* .

 

## <a name="associating-the-queued-components-listener-with-a-specific-private-queue"></a>Связывание прослушивателя очередей компонентов с определенной частной очередью

Прослушиватель очередей компонентов COM+ получает только из очередей, связанных с приложением COM+, отмеченным как поставленное в очередь. Если приложение COM+ помечается как поставленное в очередь, COM+ создает очередь сообщений, имя которой совпадает с именем приложения. Имя формата очереди сообщений в этой очереди находится в каталоге COM+, связанном с приложением COM+. Когда приложение COM+ запускается и помечается как Listen, запускается прослушиватель в процессе приложения COM+ и открывается очередь. В следующей таблице перечислены параметры моникера очереди, влияющие на сообщение очереди сообщений.




| Параметр | Описание | 
|-----------|-------------|
| <em>Дл</em><br /> | Задает целое число без знака, например, с определяемым значением 12345.<br /> | 
| <em>AuthLevel</em><br /> | Задает уровень проверки подлинности сообщения. Сообщение с проверкой подлинности имеет цифровую подпись и требует сертификат для пользователя, отправляющего сообщение. Допустимые значения:<br /><ul><li>MQMSG_AUTH_LEVEL_NONE, 0</li><li>MQMSG_AUTH_LEVEL_ALWAYS, 1</li></ul> | 
| <em>Доставка</em><br /> | Указывает параметр доставки сообщения. Это значение игнорируется для транзакционных очередей. Допустимые значения:<br /><ul><li>MQMSG_DELIVERY_EXPRESS, 0</li><li>MQMSG_DELIVERY_RECOVERABLE, 1</li></ul> | 
| <em>енкрипталгорисм</em><br /> | Указывает алгоритм шифрования, используемый очередью сообщений для шифрования и расшифровки сообщения. Допустимые значения:<br /><ul><li>CALG_RC2, CALG_RC4</li><li>Любое целочисленное значение, допустимое для очереди сообщений для <em>енкрипталгорисм</em>.</li></ul> | 
| <em>HashAlgorithm</em><br /> | Задает криптографическую хэш-функцию. Допустимые значения:<br /><ul><li>CALG_MD2, CALG_MD4, CALG_MD5, CALG_SHA, CALG_SHA1, CALG_MAC, CALG_SSL3_SHAMD5, CALG_HMAC, CALG_TLS1PRF</li><li>Любое целочисленное значение, допустимое для очереди сообщений для <em>HashAlgorithm</em>.</li></ul> | 
| Журнал<br /> | Указывает параметр журнала сообщений очереди сообщений. Допустимые значения:<br /><ul><li>MQMSG_JOURNAL_NONE, 0</li><li>MQMSG_DEADLETTER, 1</li><li>MQMSG_JOURNAL, 2</li></ul> | 
| <em>Label</em><br /> | Задает строку метки сообщения до MQ_MAX_MSG_LABEL_LEN символов. <br /> | 
| <em>макстиметореачкуеуе</em><br /> | Указывает максимальное время (в секундах), в течение которого сообщение будет достигнуто в очереди. <br /> Допустимые значения:<br /><ul><li>INFINITE</li><li>LONG_LIVED</li><li>Количество секунд</li></ul> | 
| <em>макстиметорецеиве</em><br /> | Указывает максимальное время (в секундах), в течение которого сообщение должно быть получено целевым приложением. Допустимые значения:<br /><ul><li>INFINITE</li><li>LONG_LIVED</li><li>Количество секунд</li></ul> | 
| <em>Приоритет</em><br /> | Задает уровень приоритета сообщения в разрешенных значениях очереди сообщений.<br /> Допустимые значения:<br /><ul><li>MQ_MIN_PRIORITY, 0</li><li>MQ_MAX_PRIORITY, 7</li><li>MQ_DEFAULT_PRIORITY, 3</li><li>Число от 0 до 7</li></ul> | 
| <em>привлевел</em><br /> | Задает уровень конфиденциальности, используемый для шифрования сообщений.<br /> Допустимые значения:<br /><ul><li>MQMSG_PRIV_LEVEL_NONE, НЕТ, 0</li><li>MQMSG_PRIV_LEVEL_BODY, ТЕКСТ,</li><li>MQMSG_PRIV_LEVEL_BODY_BASE, BODY_BASE, 1</li><li>MQMSG_PRIV_LEVEL_BODY_ENHANCED, BODY_ENHANCED, 3</li></ul> | 
| <em>Трассировка</em><br /> | Задает параметры трассировки, используемые при трассировке маршрутизации очереди сообщений.<br /> Допустимые значения:<br /><ul><li>MQMSG_TRACE_NONE, 0</li><li>MQMSG_SEND_ROUTE_TO_REPORT_QUEUE, 1</li></ul> | 




 

Полный набор функций административного пакета SDK для COM+ доступен с помощью COM-объектов. Это позволяет любой программе запускать и прекращать работу приложений COM+ по мере необходимости.

> [!Note]  
> При запуске приложения COM+ это приложение, которое выполняется, а не отдельные компоненты в приложении. Если приложение вызывает компонент, не относящийся к очереди, запускается приложение COM+, содержащее компонент. Если флажок прослушиватель включен, прослушиватель также запускается и начинает обработку сообщений для компонентов в очереди. Несмотря на то, что служба очередей компонентов может запускаться таким образом, если компоненты, помещенные в очередь и не поставленные в очередь, упаковывались в одно приложение COM+, следует убедиться, что при выполнении компонента, не относящегося к очереди, должны запускаться компоненты из очереди. Если это не так, упакуйте компоненты, помещенные в очередь, в приложение COM+, отдельное от других компонентов.

 

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Активация очередей компонентов](activating-component-queues.md)
</dt> </dl>

 

 




