---
description: Как правило, задержка между уровнями распределенного приложения существенно различается.
ms.assetid: 4780a9fd-5940-4b10-a596-22214b17c033
title: Оптимизация взаимодействия между уровнем представления и бизнес-логики COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fe6094cb12cc7875d8a18dea3d28ac55bf8d6ae2
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105701269"
---
# <a name="optimizing-interactions-between-the-com-business-logic-tier-and-the-presentation-tier"></a>Оптимизация взаимодействия между уровнем представления и бизнес-логики COM+

Как правило, задержка между уровнями распределенного приложения существенно различается. Вызовы между уровнями представления и бизнес-логики часто выполняются медленнее, чем вызовы между бизнес-уровнем и уровнем данных. В результате удержание состояния является более затратным при вызове уровня бизнес-логики.

В следующих разделах рассматриваются способы передачи данных между уровнями представления и бизнес-логики.

-   [Передача параметров](#passing-parameters)
-   [Параметры передачи данных](#data-passing-options)
-   [Использование шаблона фабрики для передачи данных](#using-a-factory-pattern-to-pass-data)
-   [См. также](#related-topics)

## <a name="passing-parameters"></a>Передача параметров

Для передачи определенного набора данных между уровнем представления и бизнес-логикой может быть одна строка, несколько строк или сочетание одной строки (например, заголовок) и несколько строк детализации данных. Наиболее эффективный способ передачи этой информации между уровнями — одним вызовом метода. Этот отдельный вызов управляет всем передаваемым набором данных. Это необходимо, если вы не решите управлять транзакцией на уровне представления (и сделаете всю обработку транзакций на уровне представления идентичной функции). Корпорация Майкрософт не рекомендует выполнять транзакции из уровня представления, поскольку вызовы между этим уровнем и уровнем бизнес-логики обычно являются самой медленной из всех вызовов многоуровневого приложения.

Одним из способов создания такого метода является передача отдельных строк информации в качестве параметров и передача нескольких строк в качестве наборов записей ADO. Наборы записей являются основой методологии доступа к данным Microsoft ADO, а использование наборов записей ADO позволяет передавать всю информацию, относящуюся к одной транзакции, за один шаг.

## <a name="data-passing-options"></a>Параметры передачи данных

Существуют и другие варианты, которые следует учитывать при передаче данных. Они включают использование списка параметров и наборов записей ADO (как описано выше), только наборов записей ADO, строк в кодировке XML или массивов структур. В этом разделе обсуждаются все эти возможности.

В следующей таблице показаны области, в которых необходимо предпринять дополнительные меры при использовании любого из четырех различных возможностей передачи аргументов. "X" представляет области, где компромиссы должны быть понятны и взвесить в соответствии с потребностями каждого проекта. Старайтесь не принимать принятые в качестве аргументов решения для каждого компонента. Преимущества согласованной модели программирования на протяжении всего проекта значительно перевешивают любое преимущество оптимизации для каждого метода или компонента, но не в самых исключительных обстоятельствах. Столбцы описаны в списке, который следует за таблицей.



|                       | Параллелизм  | Глобальная сеть          | Развертывание   | Сложность   |
|-----------------------|--------------|--------------|--------------|--------------|
| Ввод | Значение |
| Наборы записей<br/> |              | X<br/> | X<br/> | X<br/> |
| XML<br/>        | X<br/> |              | X<br/> | X<br/> |
| Массивы<br/>     | X<br/> |              | X<br/> | X<br/> |



 

Четыре столбца определяют области, которые следует отслеживать при использовании этого параметра для передачи параметров.

-   **Столбец параллелизма** представляет необходимость в кодировании или предоставлении механизма, который управляет условиями блокировки в операциях обновления. Так как методы, выполняющие сохранение, могут представлять обновления, могут возникнуть проблемы с параллелизмом. Два типа блокировки — это распространенные оптимистичные и пессимистические прогнозы. Пессимистические блокировки не позволяют пользователю получать данные для обновления, в то время как другой пользователь может выполнить обновление. Оптимистическая блокировка позволяет значительно большему числу пользователей, используя торговую вероятность того, что все два пользователя будут обновлять один и тот же документ одновременно. Вызовы оптимистической блокировки для проверки того, что сохраненные данные соответствуют данным в момент обращения к копии данных для изменения. Наборы записей ADO обеспечивают автоматическую поддержку оптимистической блокировки. Сценарии обновления, включающие списки однострочных параметров, не предоставляют достаточной поддержки для проверки параллелизма. В XML эта проблема возникает из-за того, что в XML-данных отсутствует поддержка блокировки.
-   **Столбец WAN** представляет условия, в которых может возникнуть состязание за передачу данных в глобальной сети (WAN). Когда глобальная сеть не имеет достаточных ресурсов для управления всеми перемещаемыми данными, пользователи приложений могут задерживать время ответа. Для поддержки оптимистичного параллелизма отключенные наборы записей ADO передают на клиент две копии данных с сервера. Вторая копия используется клиентом для определения наименьшего набора строк обновления для обратной передачи при фиксации изменения. Хотя это снижает трафик с уровня представления на данные, дополнительные нагрузки второй копии могут быть значительными. Использование наборов записей в качестве единственного способа передачи всей информации, таким образом, приводит к удвоенному числу данных, передаваемых между уровнями по мере необходимости, за исключением случаев, когда набор строк обновления передается обратно на уровень данных из уровня представления.
-   **В столбце развертывание** представлены проблемы, связанные с передачей данных, если требуется специальная технология как для вызывающего, так и для компонента сети. Например, для использования наборов записей ADO требуется, чтобы компоненты ADO присутствовали как на клиенте, так и на сервере. Средства синтаксического анализа XML должны присутствовать и на обеих сторонах, чтобы не пришлось анализировать код в приложениях.
-   **Столбец сложность** указывается для всех четырех вариантов, и это вопрос предпочтений или предыдущей модели программирования, который может быть уже установлен в вашей организации. Некоторые люди находят передачу параметров очень громоздким и покажутся слишком сложными в задачах программирования. Отслеживание того, какой параметр обрабатывается и как все они видны в одном окне редактирования, может создать логистическую сложность, которую некоторые разработчики найдут в неуправляемом виде.

Метод передачи параметров также может иметь компромиссы, например следующие:

-   Параметры могут управлять несколькими аргументами и типами аргументов, а также принимать решение о том, когда можно сделать набор записей параметром.
-   Наборы записей ADO могут вырезать иерархические связи в параметрах метода до одного или двух аргументов. Это значительно упрощает модель программирования и поддерживает добавление столбцов позже, но также скрывает информационную иерархию. Информация в наборе записей ADO и последующий их извлечение включает в себя знание имен каждого столбца или знание порядка столбцов. Такая ситуация может усложнить работу других разработчиков компонентов или приложений в проекте.
-   XML — это разный счетчик сложности скрытой иерархии, упомянутой выше. Программисту необходимо понимать использование синтаксического анализатора XML для получения доступа к информации и часто знать имена каждого элемента в наборе данных до того, как набор данных будет найден.
-   Массивы структур представляют необходимость общего понимания информации, передаваемой в составе вызывающего объекта и компонента. Такая необходимость в карте, совместно используемой двумя системными элементами, может привести к проблемам при работе с различными версиями компонентов. Несмотря на то, что сигнатура метода может не измениться, изменения ожидаемой информации могут привести к несовместимости вызывающих программ.

Поскольку проблемы сложности, связанные со всеми четырьмя методами передачи параметров, настолько похожи, спорна, что существует значительная возможность упрощения, связанная с одним выбором.

## <a name="using-a-factory-pattern-to-pass-data"></a>Использование шаблона фабрики для передачи данных

Одна важная точка проектирования — простота использования. В момент, когда вы решили использовать наборы записей ADO для передачи структурированного набора сведений обратно на уровень представления, вы предоставили проблему сложности. Программисты уровня представления должны понимать структуру этих наборов записей. Более сложные проблемы могут возникать, когда требуется несколько сведений для передачи набора данных в набор записей. Чтобы упростить это, следует рассмотреть возможность создания метода фабрики набора записей, когда предполагается, что данные должны передаваться в структурированных наборах записей ADO.

Фабрика набора записей должна возвращать пустой, но недоступный для записи набор записей в вызывающий объект. В этом наборе записей должны быть настроены соответствующие поля (имена и типы данных), чтобы вызывающему клиенту не нужно было знать, как изготовление набора записей. Такой подход часто называют *шаблоном фабрики* и является распространенным шаблоном решения, который решает необходимость создания объекта определенной сложности без необходимости знать особенности ее создания.

Простые варианты проектирования, такие как выбор одного и того же имени параметра для одного и того же элемента данных в каждом методе, где передаются эти сведения, позволяют легко просмотреть метод и узнать, что ожидается. Проверка того, что порядок, в котором передаются аргументы, соответствуют всем семействам методов, обеспечивает комфорт, обеспечивающий согласованную модель.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Оптимизация взаимодействия между уровнем бизнес-логики COM+ и уровнем данных](optimizing-interactions-between-the-com--business-logic-tier-and-the-data-tier.md)
</dt> </dl>

 

 




