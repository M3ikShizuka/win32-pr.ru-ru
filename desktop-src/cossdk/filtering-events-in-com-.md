---
description: 'События COM+ предоставляют два способа управления событиями, которые достигают подписчиков: фильтрацию и фильтрацию параметров издателя.'
ms.assetid: dfc82a57-5587-462d-a43d-516b7d70e25e
title: Фильтрация событий в COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6d3a7d152813e4806a9cfb6a342255e0981ecf37
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127342047"
---
# <a name="filtering-events-in-com"></a>Фильтрация событий в COM+

События COM+ предоставляют два способа управления событиями, которые достигают подписчиков: *фильтрацию* и *фильтрацию параметров* издателя.

## <a name="publisher-filtering"></a>Publisher Записей

Publisher фильтрация управляет порядком и срабатыванием метода события в объекте [класса событий](the-com--event-class-object.md) . фильтрация Publisher позволяет издателю определить, какие подписчики получили определенное событие.

Примером эффективного использования фильтрации издателя является обмен на фондовой бирже. Большинству подписчиков нужно иметь представление о добавлении нового запаса. Однако многие из этих же подписчиков могут не захотеть быть в курсе каждого изменения стоимости акций. Publisherная фильтрация обеспечивает детализацию, необходимую для эффективной доставки событий только тем подписчикам, которые хотят получить эти сведения.

При вызове метода для объекта класса событий «экземпляр» он собирает все фильтры издателя для этого метода. Фильтр заставляет объект события вызывать метод события для конкретного подписчика. Фильтр определяет, какие подписки должны срабатывать и в каком порядке их запускать. Например, фильтр может прочитать список подписок и создать заказ на основе некоторых критериев приложения, а затем вызвать подписчиков в таком порядке.

подробные инструкции по созданию фильтра издателя см. в разделе [создание фильтра Publisher](creating-a-publisher-filter.md).

## <a name="parameter-filtering"></a>Фильтрация параметров

В отличие от фильтрации издателя, служба событий COM+ предоставляет необязательную фильтрацию параметров подписчика для каждой подписки и вызов метода события. При фильтрации параметров свойство параметром filterCriteria подписки оценивается по параметрам метода события. Этот тип фильтрации используется для каждого метода, каждой подписки и обеспечивает уровень фильтрации подписчиков в источнике событий. Строка условий фильтра распознает операторы отношения для проверки равенства (=, = =,!,! =, ~, ~ =,  <>), вложенные круглые скобки, **а также логические** ключевые слова **и**, **или**.

Фильтрация параметров происходит после фильтрации издателя и запуска объекта стандартного события для данной подписки. Если используется фильтрация издателя, Фильтрация параметров происходит только в том случае, если фильтр издателя вызывает [**ифирингконтрол:: фиресубскриптион**](/windows/desktop/api/EventSys/nf-eventsys-ifiringcontrol-firesubscription). По этой причине фильтрация и фильтрация параметров издателя могут составляться вместе, но фильтрация издателя имеет приоритет.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Публикация и доставка событий в COM+](publishing-and-delivering-events-in-com-.md)
</dt> <dt>

[Подписки](subscriptions.md)
</dt> <dt>

[Объект класса событий COM+](the-com--event-class-object.md)
</dt> <dt>

[Использование событий COM+ с компонентами в очереди COM+](using-com--events-with-com--queued-components.md)
</dt> </dl>

 

 



