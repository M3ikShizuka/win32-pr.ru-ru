---
description: COM+ пытается предотвратить ситуации, в которых эти пути ошибок должны выполняться на сервере.
ms.assetid: 0de125a2-2e91-49b9-a903-6c2e173e22a2
title: Основные понятия о шлюзах активации COM+ Low-Memory
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 37d844a0492301ef067f5b3cd0e0749ec3a21779
ms.sourcegitcommit: bf526e267d3991892733bdd229c66d5365cf244a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/05/2021
ms.locfileid: "103999815"
---
# <a name="com-low-memory-activation-gates-concepts"></a>Основные понятия о шлюзах активации COM+ Low-Memory

Как правило, синхронизация не требуется, если имеется однопотоковое подразделение (STA), так как подразделение обеспечивает синхронизацию. Синхронизация важна при наличии многопоточного апартамента (MTA) и объекта с произвольным потоком. В прошлом объекты, работающие в свободной потоке, вынуждены обрабатывали блокировку. Можно исключить необходимость использования блокировки, задав атрибут синхронизации для компонента.

Проблемы надежности часто возникают, когда ресурсы сервера не могут эффективно реагировать на пиковые нагрузки. Если на сервере недостаточно физических ресурсов для удовлетворения пикового спроса, виртуальная память может исчерпана. Это станет проблемой, если пользовательский код или системный код не обрабатывает ошибки выделения памяти ненадлежащим образом. Сервер начинает замедлять работу, и по мере исчерпания памяти происходит сбой выделения памяти. Сервер выполняет пути ошибок, чтобы обработать ошибки выделения ресурсов. Если путь ошибки содержит ошибку в системном или пользовательском коде, выполняемом на сервере, очень сложно выполнить перехват и обработку безопасного кода.

COM+ пытается предотвратить ситуации, в которых эти пути ошибок должны выполняться на сервере. С помощью компонента "шлюзы активации нехватки памяти" COM+ активно отслеживает нагрузку на память в системе и обеспечивает доступность разумного объема памяти до выполнения пользовательского кода. Если процентная доля виртуальной памяти, доступная для приложения, падает ниже фиксированного порога, активация завершается сбоем до создания серверного приложения или объекта COM+ (как показано на рисунке ниже). При сбое этих активаций, которые обычно запускаются, функция шлюзов нехватки памяти сокращает количество проблем, связанных с выделением памяти в пользовательском коде, что значительно повышает надежность системы.

![Схема, показывающая связь между приложением COM+ и шлюзом активации нехватки памяти.](images/ada5ef02-f2b1-46bb-b0fc-fe7d65f31b43.png)

Шлюз активации нехватки памяти применяется только к настроенным COM-компонентам, установленным в приложении COM+.

## <a name="how-the-low-memory-activation-gates-feature-works"></a>Принципы работы функции "шлюзы активации Low-Memory"

В зависимости от типа активации функция шлюза активации с нехваткой памяти использует другой фиксированный пороговый уровень. При создании серверного приложения COM+ COM+ разрешает активацию, если доступно более 10% виртуальной памяти. Если доступен менее 10 процентов, COM+ выполнит выделение тестов, чтобы определить, может ли файл подкачки расширяться в соответствии с новой загрузкой памяти. Если файл подкачки разворачивается, создается серверное приложение. Если не удается расширить файл подкачки, происходит сбой активации и память не выделяется.

Процесс происходит аналогично при создании объекта. В этом случае COM+ разрешает активацию, если доступно более 5% виртуальной памяти. Если доступен менее 5 процентов, COM+ продолжает выделение тестов. Опять же, если выделение тестов расширяет файл подкачки, создается объект. В противном случае активация завершается ошибкой.

Фиксированные уровни пороговых значений для шлюзов активации с нехваткой памяти сейчас не настраиваются. По этой причине нет задач, связанных с этой функцией.

 

 



