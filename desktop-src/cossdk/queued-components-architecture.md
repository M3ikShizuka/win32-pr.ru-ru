---
description: Служба COM+ в очереди компонентов расширяет модель программирования COM, предоставляя среду, в которой компонент может быть вызван синхронно (в режиме реального времени) или асинхронно (в очереди).
ms.assetid: fd455679-b2b3-487f-8494-9ea296ce2c89
title: Архитектура очередей компонентов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 93914fd82a14c73b134098a759c8d61e324b6cda65d03de23f9c3ea2fcfb53f8
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "117916213"
---
# <a name="queued-components-architecture"></a>Архитектура очередей компонентов

Служба COM+ в очереди компонентов расширяет модель программирования COM, предоставляя среду, в которой компонент может быть вызван синхронно (в режиме реального времени) или асинхронно (в очереди). Компоненту не нужно знать, используется ли он в режиме реального времени или в очереди.

Приложения обмена сообщениями подобны транзакциям электронной почты между программами. Инициатор запроса отправляет сообщение на сервер; Когда сервер получает к нему, сообщение обрабатывается. Как и электронная почта, система обмена сообщениями должна выполнить обработку сведений о сети и убедиться, что сообщение перемещается с клиента на сервер. В инфраструктуре компонентов с очередями за это отвечает Служба очереди сообщений.

Служба COM+ «очереди компонентов» состоит из следующих частей:

-   Средство записи (для клиента или на стороне отправки)
-   Прослушиватель (для сервера или принимающей стороны)
-   Проигрыватель (для сервера или принимающей стороны)

![Схема, показывающая путь от клиента к серверу: Клиент, устройство записи, очередь, прослушиватель, проигрыватель, сервер.](images/d732774b-1ca6-45ad-bce0-a95b0bfc3edb.png)

## <a name="the-recorder"></a>Средство записи

В типичном сценарии с очередями компонентов клиент вызывает компонент в очереди. Выполняется вызов средства записи очередей компонентов, которое упаковывает его как часть сообщения на сервер и помещает в очередь. Средство записи маршалирует в сообщение контекст безопасности клиента и записывает все вызовы метода клиента. В роли прокси-сервера для серверного компонента средство записи выбирает интерфейсы из интерфейсов куеуабле в каталоге COM+.

Представление записи отправляется в очередь сообщений в виде сообщения, отправляемого на сервер. Если для компонента в очереди задан атрибут транзакции Required или Supported, очередь сообщений принимает сообщение только в том случае, если транзакция на стороне клиента фиксируется и очередь очереди сообщений является транзакционной, то есть обычно установленной по умолчанию. Если для параметра атрибута транзакции требуется New, очередь сообщений может принять сообщение, даже если транзакция на стороне клиента прерывается. Дополнительные сведения о транзакциях см. в разделе [транзакционная очередь сообщений](transactional-message-queuing.md).

## <a name="the-listener"></a>Прослушиватель

Прослушиватель очередей компонентов извлекает сообщение из очереди и передает его в проигрыватель очередей компонентов.

## <a name="the-player"></a>Проигрыватель

Проигрыватель отменяет упаковку контекста безопасности клиента на стороне сервера, а затем вызывает серверный компонент и выполняет те же вызовы метода. Вызовы методов воспроизводятся проигрывателем до тех пор, пока не завершится клиентский компонент и транзакция, которая записала вызовы метода, фиксируется.

## <a name="the-message-mover"></a>Перемещение сообщений

Средство перемещения сообщений о компонентах в очереди — это служебная программа, которая перемещает все сообщения об ошибках очереди сообщений из одной очереди в другую, чтобы их можно было повторить. Служебная программа перемещения сообщений — это объект автоматизации, который можно вызывать с помощью VBScript; Дополнительные сведения см. в разделе [Обработка ошибок](handling-errors-in-queued-components.md).

 

 



