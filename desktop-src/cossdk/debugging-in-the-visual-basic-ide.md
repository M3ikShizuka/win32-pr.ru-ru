---
description: Использование интегрированной среды разработки (IDE) Microsoft Visual Basic для отладки дает Visual Basic разработчикам доступ к знакомым средствам и простоте использования.
ms.assetid: d31efc97-c286-434d-93f5-77b34ec16205
title: Отладка в интегрированной среде разработки Visual Basic
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 74574fdb289e1ad334337f17943c6961b95bf288
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104423270"
---
# <a name="debugging-in-the-visual-basic-ide"></a>Отладка в интегрированной среде разработки Visual Basic

Использование интегрированной среды разработки (IDE) Microsoft Visual Basic для отладки дает Visual Basic разработчикам доступ к знакомым средствам и простоте использования. Хотя для многих компонентов в конечном итоге потребуется более полная Отладка с помощью Microsoft Visual C++ной среды, одна из стратегий может быть первой по возможности выполнять отладку как можно больше функций с Visual Basic. Например, можно использовать Visual Basic IDE для отладки в COM+, если еще не отладка многопоточности, отслеживание компонентов, удаленные вызовы или изоляция процессов.

Как правило, при использовании среды Visual Basic для отладки сначала необходимо скомпилировать проект и добавить библиотеку DLL в приложение COM+. Затем необходимо задать двоичную совместимость для проекта, ссылающуюся на созданную библиотеку DLL, и запустить проект, чтобы начать отладку.

## <a name="general-guidelines-for-debugging-in-the-visual-basic-environment"></a>Общие рекомендации по отладке в среде Visual Basic

-   При отладке с помощью Visual Basic COM+ обрабатывает компоненты Visual Basic как если бы они принадлежали приложению библиотеки, даже если компоненты зарегистрированы как относящиеся к серверному приложению. Так как она выполняется как приложение библиотеки, значки компонентов в средстве администрирования "службы компонентов" не проводятся при отладке компонентов.
-   Если изменить атрибуты транзакции для компонента во время отладки или внести изменения в исходный код, требующие Visual Basic для создания нового идентификатора CLSID или ProgID, обязательно удалите и переустановите приложение COM+, содержащее этот компонент. Если для компонента задана двоичная совместимость, вы будете предупреждать о внесении изменений.

## <a name="notes-on-debugging-within-a-com-application"></a>Примечания об отладке в приложении COM+

-   При внесении изменений в Visual Basic IDE в интерфейсы компонента, имена классов, имена проектов, поддержка транзакций или другие параметры могут содержать несоответствия между данными конфигурации в обозревателе служб компонентов и фактической конфигурацией, выполняемой в отладчике Visual Basic.
-   Не экспортируйте приложение COM+ во время отладки компонента в приложении. COM+ будет рассматривать среду разработки Visual Basic как компонент.
-   Если вы используете компонент вне отладчика и затем решили начать отладку, экземпляр компонента может по-прежнему выполняться в COM+ при запуске в отладчике. COM+ определит это условие и попытается автоматически завершить работу экземпляра, который он контролирует. Чтобы избежать этой проблемы, перед началом отладки удалите компонент из средства администрирования "службы компонентов".

**Отладка с использованием среды Visual Basic**

1.  Откройте проект компонента в Visual Basic.

2.  Скомпилируйте компонент, а затем задайте в проекте двоичную совместимость для скомпилированного компонента.

3.  Задайте для свойства Мтстрансактионмоде значение, отличное от 0-Нотанмтсобжект. При запуске проекта этот параметр запрашивает Visual Basic активации компонента в COM+.

4.  В меню **проект** выберите пункт **свойства**, а затем введите начальную программу на вкладке **Отладка** . Программа запуска — это клиентский исполняемый файл, вызывающий этот компонент.

    > [!Note]  
    > Начальная программа должна быть локальной для отлаживаемого компонента.

     

5.  Нажмите клавишу F5, чтобы начать отладку компонента.

После нажатия клавиши F5 Visual Basic запускает клиентское приложение и запускает компонент в режиме отладки. Точки останова можно размещать в коде компонента и устанавливать контрольные значения для переменных.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Поддержка отладки Visual Basic COM+ отличается от MTS](com--visual-basic-debugging-support-contrasted-with-mts.md)
</dt> <dt>

[Отладка скомпилированных компонентов Visual Basic](debugging-compiled-visual-basic-components.md)
</dt> </dl>

 

 



