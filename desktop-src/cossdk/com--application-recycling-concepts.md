---
description: Повторное использование приложений может значительно повысить общую стабильность приложений COM+, предлагая быстрое решение известных проблем и помогая защититься от непредвиденных.
ms.assetid: bf98318b-4d87-44cc-85a1-68faf5547e06
title: Основные понятия перезапуска приложений COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ab37376ff3bc6d03f454f63822641ed69fad0b47
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104423286"
---
# <a name="com-application-recycling-concepts"></a>Основные понятия перезапуска приложений COM+

Повторное использование приложений может значительно повысить общую стабильность приложений COM+, предлагая быстрое решение известных проблем и помогая защититься от непредвиденных. Например, производительность приложения может снизиться со временем из-за таких проблем, как утечка памяти, немасштабируемое использование ресурсов и сбой процесса. COM+ предоставляет возможность повторного использования приложений в качестве решения для этих проблем. Можно использовать повторное использование приложений для автоматического завершения процесса и его перезапуска, таким путем повторная инициализация невыполненного процесса и повторное выделение памяти, которую он использует.

Перезапуск приложений работает путем создания дубликата процесса Dllhost, связанного с приложением. Этот дублирующий процесс dllhost обслуживает все будущие запросы объектов, что оставляет старую версию dllhost для завершения обслуживания оставшихся запросов объектов. Старый процесс dllhost завершает работу при обнаружении выпуска всех внешних ссылок на объекты в процессе или при достижении значения времени ожидания истечения срока действия. В этом случае повторное использование приложений гарантирует, что клиентское приложение не будет испытывать перерыв в работе службы.

> [!Note]  
> Нельзя перезапустить приложение COM+, настроенное для запуска в качестве службы Windows. Кроме того, библиотечные приложения имеют свойства перезапуска и группирования для своего хостового процесса.

 

Можно настроить перезапуск приложений в административном виде с помощью средства администрирования "службы компонентов" или программно с помощью административного пакета SDK для COM+. Процессы можно перезапускать на основе нескольких критериев, определяемых следующими свойствами объекта [**комадминкаталогобжект**](comadmincatalogobject.md) в коллекции [**приложений**](applications.md) :

-   **Рециклелифетимелимит.** Максимальное число минут, в течение которых процесс может быть выполнен до его повторного запуска. Допустимый диапазон — от 0 до 30 240 минут (21 день). Значение по умолчанию (в минутах) равно 0, что означает, что процесс не будет перезапущен из-за превышения времени существования.
-   **Рециклемеморилимит.** Максимальный объем использования памяти процесса (в килобайтах) перед повторным запуском процесса. Если использование памяти процесса превышает указанное число в течение более одной минуты, процесс будет перезапущен. Допустимый диапазон — от 0 до 1 048 576 КБ. По умолчанию объем используемой памяти составляет 0 КБ, что означает, что процесс не будет перезапущен из-за достижения предела памяти.
-   **Рециклекалллимит.** Максимальное число вызовов, которые объекты приложения могут принять перед повторным запуском процесса. Допустимый диапазон — от 0 до 1 048 576 вызовов. По умолчанию число вызовов равно 0, что означает, что процесс не будет перезапущен из-за достижения предельного числа вызовов.
-   **Рециклеактиватионлимит.** Максимальное число активаций объекта приложения, которое следует принять перед повторным запуском процесса. Допустимый диапазон — от 0 до 1 048 576 активаций. По умолчанию число активаций равно 0, что означает, что процесс не будет перезапущен из-за ограничения активации.

Кроме того, свойство Рецикликспиратионтимеаут объекта [**комадминкаталогобжект**](comadmincatalogobject.md) используется для принудительного завершения процесса очистки. Указывает количество минут ожидания выпуска всех внешних ссылок на объекты в перезапущенном процессе перед принудительным завершением процесса. Допустимый диапазон — от 1 до 1440 минут (24 часа), а время ожидания истечения срока действия по умолчанию — 15 минут. Это значение используется только в том случае, если уже определено, что процесс будет перезапущен на основе других критериев.

Можно выбрать более одного критерия для перезапуска приложения. COM+ перезапускает приложение после того, как первый набор критериев будет удовлетворен. Вы можете задать значение времени ожидания истечения срока действия, чтобы определить, как долго Старый процесс dllhost может потратить на выполнение оставшихся запросов на обслуживание, прежде чем принудительно завершить работу.

Коллекция [**аппликатионинстанцес**](applicationinstances.md) предоставляет свойство хасрециклед, которое позволяет определить, было ли приложение перезапущено.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Задачи перезапуска приложений COM+](com--application-recycling-tasks.md)
</dt> <dt>

[**рециклесуррогате**](/windows/desktop/api/ComSvcs/nf-comsvcs-recyclesurrogate)
</dt> </dl>

 

 



