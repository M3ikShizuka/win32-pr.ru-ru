---
description: Обработка ошибок администрирования COM+
ms.assetid: 03f00c19-ff81-478b-b545-048f3dbe5eda
title: Обработка ошибок администрирования COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9e7e5838d7fee7616a23f5e361df1aef65421492
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105710747"
---
# <a name="handling-com-administration-errors"></a>Обработка ошибок администрирования COM+

Ошибки, формируемые при использовании объектов Комадмин, регистрируются двумя способами:

-   Использование кодов ошибок, характерных для библиотеки Комадмин.
-   Использование расширенных сведений об ошибках, доступных в специальной коллекции [**errorInfo**](errorinfo.md) .

## <a name="error-codes"></a>Коды ошибок

Код ошибок администрирования обрабатывается так же, как и любое сообщение об ошибке COM. В Microsoft Visual C++ эти коды возвращаются в виде значений **HRESULT** . В Microsoft Visual Basic они создаются как исключения, которые можно перехватить. Для программистов C++ коды ошибок администрирования COM+ определяются в файле Winerror. h. Для Visual Basic программистов они доступны в интегрированной среде разработки Visual Basic.

## <a name="errorinfo-collection"></a>Коллекция ErrorInfo

При возникновении ошибки, о которой сообщается какой либо код ошибки, может быть доступна более подробная информация в зависимости от характера ошибки. Объекты Комадмин предоставляют расширенные сведения в случаях, когда точная причина сбоя трудно определить без подробного отчета, например с несколькими операциями чтения и записи.

Например, при использовании таких методов, как [**Заполнение**](/windows/desktop/api/ComAdmin/nf-comadmin-icatalogcollection-populate) и [**SaveChanges**](/windows/desktop/api/ComAdmin/nf-comadmin-icatalogcollection-savechanges) для объекта [**комадминкаталогколлектион**](comadmincatalogcollection.md) , можно считывать или записывать данные для каждого элемента в коллекции. Могут возникать сложные ошибки, которые могут быть трудно диагностировать на основе одного числового кода ошибки. Таким образом, Библиотека Комадмин предоставляет расширенные сведения об ошибке через специальную коллекцию.

Когда доступна расширенная информация об ошибке, она помещается в коллекцию [**errorInfo**](errorinfo.md) , связанную с исходной коллекцией, в которой возникла ошибка. Чтобы получить отчет об ошибках, получите коллекцию **errorInfo** , связанную с исходной коллекцией, и изучите содержащиеся в ней элементы. Коллекцию **errorInfo** можно получить с помощью функции [**IsCollection**](/windows/desktop/api/ComAdmin/nf-comadmin-icatalogcollection-getcollection) в [**комадминкаталогколлектион**](comadmincatalogcollection.md), и оставить второй параметр пустым, где обычно указывается свойство ключа родительского элемента.

При возникновении ошибки необходимо немедленно получить и заполнить коллекцию [**errorInfo**](errorinfo.md) для коллекции, которая завершилась сбоем, без выполнения каких бы то ни было других операций с этой коллекцией. В противном случае коллекция **errorInfo** сбрасывается и не содержит подробностей об ошибке.

Элементы в коллекции [**errorInfo**](errorinfo.md) предоставляют специальные свойства отчетов об ошибках Мажорреф и минорреф, которые подробноируют конкретную причину ошибки. Дополнительные сведения см. в разделе **errorInfo**.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Операции администрирования COM+ в транзакциях](com--administration-operations-within-transactions.md)
</dt> <dt>

[Вводный пример с использованием каталога администрирования COM+](introductory-example-using-the-com--administration-catalog.md)
</dt> <dt>

[Общие сведения об объектах Комадмин](overview-of-the-comadmin-objects.md)
</dt> <dt>

[Получение коллекций в каталоге COM+](retrieving-collections-on-the-com--catalog.md)
</dt> <dt>

[Установка свойств и сохранение изменений в каталоге COM+](setting-properties-and-saving-changes-to-the-com--catalog.md)
</dt> </dl>

 

 



