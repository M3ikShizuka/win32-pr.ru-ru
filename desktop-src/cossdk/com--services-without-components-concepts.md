---
description: В COM+ 1,5 введена возможность использования служб COM+ без компонентов.
ms.assetid: da93d164-234a-4d1e-b82c-f3f904bb8cb6
title: Службы COM+ без компонентов концепции
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d4d692657d33143b9437a9c8134260a8c32431cb
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103896322"
---
# <a name="com-services-without-components-concepts"></a>Службы COM+ без компонентов концепции

В COM+ 1,5 введена возможность использования служб COM+ без компонентов. Это значительно снижает затраты на производительность при использовании служб COM+ из среды, которая не использует компоненты, а также исключает сложность использования этих служб. Начиная с IIS 6,0, IIS и ASP пользуются преимуществами использования служб COM+ без компонентов.

Изначально службы COM+ предназначены для использования с компонентами COM+. Однако некоторые среды программирования не основаны на компонентах, поэтому для использования служб COM+ требуются значительные издержки. Например, до выпуска COM+ 1,5 службам IIS пришлось создавать объекты оболочки только для того, чтобы иметь возможность использовать службы транзакций COM+ на страницах ASP. Затраты на производительность, основанные на создании этих объектов, включают хранение данных конфигурации как в метабазе IIS, так и в базе данных регистрации COM+ (Регдб), а также дополнительный обмен данными между метабазой IIS и Регдб COM+, необходимый для эффективного управления данными конфигурации.

Если службам IIS требуется использовать вторую службу COM+, например синхронизацию, для этого пришлось создать совершенно другой объект оболочки. Чтобы использовать транзакции и синхронизацию COM+, потребуется третий тип объекта оболочки совместимости. Сложность этого подхода масштабируется как O (N2), что делает реализацию новых служб чрезвычайно сложной.

С появлением служб COM+ без компонентов, необходимые службы настраиваются с помощью объекта, созданного из класса. Класс [**ксервицеконфиг**](cserviceconfig.md) реализует интерфейсы, необходимые для настройки различных служб, обеспечивая гибкость для поддержки нескольких служб одновременно и возможность поддержки новых служб в будущем.

Затем настроенные службы можно использовать с помощью двух разных механизмов: они могут использоваться с помощью функции [**кокреатеактивити**](/windows/desktop/api/ComSvcs/nf-comsvcs-cocreateactivity) , которая применяет службы ко всей работе, переданной функцией, и также может использоваться путем внедрения работы, которая использует службы между вызовами функций [**коентерсервицедомаин**](/windows/desktop/api/ComSvcs/nf-comsvcs-coenterservicedomain) и [**колеавесервицедомаин**](/windows/desktop/api/ComSvcs/nf-comsvcs-coleaveservicedomain) . Ни одна из этих функций не требует создания новых компонентов, чтобы иметь возможность использовать службы COM+. требуется только объект [**ксервицеконфиг**](cserviceconfig.md) .

## <a name="related-topics"></a>См. также

<dl> <dt>

[Задачи служб COM+ без компонентов](com--services-without-components-tasks.md)
</dt> </dl>

 

 



