---
description: Служба инструментирования COM+ позволяет создавать собственные программы управления событиями COM+ и ведения журналов, если требуется отобразить различные метрики производительности для компонентов COM+.
ms.assetid: 07f68734-a382-4fe5-86af-90805f61c68d
title: Основные понятия инструментария COM+
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 160a546c07ea4204f1f4da3ba4c56c76a6eed6b52a8d397d470d0bc34b76adc8
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118549510"
---
# <a name="com-instrumentation-concepts"></a>Основные понятия инструментария COM+

Служба инструментирования COM+ позволяет создавать собственные программы управления событиями COM+ и ведения журналов, если требуется отобразить различные метрики производительности для компонентов COM+. инструментирование com+ можно также использовать для настройки пользовательских событий и для преобразования событий COM+ в формат Visual Studio Analyzer (VSA) при обновлении пакетов mts, получающих события MTS.

> [!Note]  
> начиная с Windows Server 2003, только администраторы имеют права доступа на чтение журналов трассировки для системных событий.

 

Подписавшись на события, опубликованные издателем системных событий, клиенты могут реализовать [интерфейсы инструментария com+](com--instrumentation-interfaces.md) для получения уведомлений для различных МЕТРИК производительности com+, таких как сведения об отдельных объектах com+, приложениях COM+ и службах com+. Метрики публикуются на клиенте с помощью [службы событий COM+](com--events.md)— системы слабо связанных событий (лце), которая хранит сведения о событиях от разных издателей в хранилище событий в каталоге COM+.

> [!Note]  
> Инструментирование COM+ не гарантирует доставку события.

 

Каждая метрика имеет метку времени, указывающую время создания метрики, а не время ее отправки или получения. Клиент может сопоставить метку времени и узнать стоимость выполнения приложения COM+, стоимость транзакции, выполняемой в приложении COM+, или стоимость вызова метода внутри приложения COM+.

Можно также использовать службу инструментария COM+ для фильтрации конкретных сведений о метриках производительности, которые необходимо просмотреть. Например, при подписке на интерфейс или метод инструментария COM+ можно указать свойства для подписки в структуре [**комсвксевентинфо**](/windows/win32/api/comsvcs/ns-comsvcs-comsvcseventinfo) , например идентификатор приложения (элемент **ГУИДАПП** ) или идентификатор процесса (**двпид** Member).

Если указан идентификатор приложения, вы получаете только метрики из указанного приложения. Если указан идентификатор процесса, вы получаете метрики из указанного серверного приложения и библиотечных приложений, загруженных в этот процесс. Пользователь может указать идентификатор приложения и идентификатор процесса, но идентификатор приложения должен быть сервером серверного приложения, работающего в процессе с указанным ИДЕНТИФИКАТОРом процесса. Если ни один из этих параметров не указан, пользователь получает метрики из всех серверных и библиотечных приложений.

Метрики инструментария COM+ предоставляют достаточно информации для приложения мониторинга, чтобы сопоставлять их с метриками операционной системы для анализа производительности, планирования загрузки, а также для моделирования и прогнозирования.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Интерфейсы инструментария COM+](com--instrumentation-interfaces.md)
</dt> </dl>

 

 



