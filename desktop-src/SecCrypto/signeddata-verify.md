---
description: Определяет, являются ли сигнатуры подписанных данных в объекте Сигнеддата допустимыми.
ms.assetid: 920ac235-0c1a-4b15-9cdd-c7e0c3ea6107
title: Сигнеддата. Verify, метод
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- SignedData.Verify
api_type:
- COM
api_location:
- Capicom.dll
ms.openlocfilehash: 3cb48943a826296c13df80130171442fc29435f8
ms.sourcegitcommit: c8ec1ded1ffffc364d3c4f560bb2171da0dc5040
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2021
ms.locfileid: "105665243"
---
# <a name="signeddataverify-method"></a>Сигнеддата. Verify, метод

\[Метод **Verify** доступен для использования в операционных системах, указанных в разделе требования. Вместо этого используйте [**класс SignedCms**](/dotnet/api/system.security.cryptography.pkcs.signedcms?view=dotnet-plat-ext-3.1&preserve-view=true) в пространстве имен [**System. Security. Cryptography. PKCS**](/dotnet/api/system.security.cryptography.pkcs?view=dotnet-plat-ext-3.1&preserve-view=true) .\]

Метод **Verify** определяет, являются ли [*подписи*](../secgloss/d-gly.md) подписанных данных в объекте [**сигнеддата**](signeddata.md) допустимыми. Чтобы проверить подпись, зашифрованный [*хэш*](../secgloss/h-gly.md) содержимого расшифровывается с помощью открытого ключа подписавший из сертификата подписи. Расшифрованный хэш сравнивается с новым хэшем содержимого данных. Подпись допустима, если хэши совпадают. Кроме того, этот метод также создает цепочку сертификатов для определения допустимости сертификата, предоставляющего [*открытый ключ*](../secgloss/p-gly.md) , используемый для расшифровки хэша.

## <a name="syntax"></a>Синтаксис


```VB
SignedData.Verify( _
  ByVal SignedMessage, _
  [ ByVal bDetached ], _
  [ ByVal VerifyFlag ] _
)
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*Сигнедмессаже* \[ окне\]
</dt> <dd>

Строка, содержащая подписанное сообщение для проверки.

</dd> <dt>

*бдетачед* \[ в необязательное\]
</dt> <dd>

Если **значение равно true**, данные для подписи отсоединяются; Это значит, что подписанное содержимое не входит в состав подписанного объекта. Чтобы проверить подпись отсоединенного содержимого, приложение должно иметь копию исходного содержимого. Отсоединенное содержимое часто используется для уменьшения размера подписанного объекта для отправки через Интернет, если получатель подписанного сообщения имеет исходную копию подписанных данных. Значение по умолчанию равно **False**.

</dd> <dt>

*Верифифлаг* \[ в необязательное\]
</dt> <dd>

Значение перечисление [ \_ \_ \_ \_ флагов CAPICOM, подписанных проверкой данных](capicom-signed-data-verify-flag.md) , которое указывает политику проверки. По умолчанию используется значение CAPICOM \_ проверить \_ подпись \_ и \_ сертификат. При использовании этого значения проверяется как достоверность сертификата, так и достоверность подписи. Этот параметр может быть установлен для проверки подписи, а не сертификата. Этот параметр может принимать одно из указанных ниже значений.



| Значение                                                                                                                                                                                                                                             | Значение                                                                                                     |
|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------|
| <span id="CAPICOM_VERIFY_SIGNATURE_ONLY"></span><span id="capicom_verify_signature_only"></span><dl> <dt>**CAPICOM \_ проверить \_ \_ только подпись**</dt> </dl>                                   | Проверяется только подпись.<br/>                                                                   |
| <span id="CAPICOM_VERIFY_SIGNATURE_AND_CERTIFICATE"></span><span id="capicom_verify_signature_and_certificate"></span><dl> <dt>**CAPICOM \_ Проверка \_ подписи \_ и \_ сертификата**</dt> </dl> | Проверяется подпись и допустимость сертификата, используемого для создания подписи.<br/> |



 

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Этот метод возвращает строку, содержащую закодированные подписанные данные.

В случае сбоя этого метода возникнет ошибка. Объект **Err** будет содержать дополнительные сведения об ошибке.

## <a name="requirements"></a>Требования



| Требование | Значение |
|----------------------------|----------------------------------------------------------------------------------------|
| Распространяемые компоненты<br/> | CAPICOM 2,0 или более поздней версии на Windows Server 2003 и Windows XP<br/>                  |
| DLL<br/>             | <dl> <dt>Capicom.dll</dt> </dl> |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**Криптографические объекты**](cryptography-objects.md)
</dt> <dt>

[**сигнеддата**](signeddata.md)
</dt> </dl>

 

 
