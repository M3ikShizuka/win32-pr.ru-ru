---
description: BLOB-объекты используются с поставщиком RSA/SChannel для экспорта ключей из и импорта ключей в поставщик служб шифрования (CSP).
ms.assetid: 97d5ee6d-4687-4cd2-b122-36f8ea3c93ca
title: BLOB-объекты ключей RSA/SChannel
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cea26a98e9c2925442166eb28245ebc471b1749e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103897598"
---
# <a name="rsaschannel-key-blobs"></a>BLOB-объекты ключей RSA/SChannel

[*BLOB-объекты*](../secgloss/b-gly.md) используются с поставщиком [*RSA*](../secgloss/r-gly.md) / [*SChannel*](../secgloss/s-gly.md) для экспорта ключей из и импорта ключей в [*поставщик служб шифрования*](../secgloss/c-gly.md) (CSP).

-   [BLOB-объекты открытого ключа](#public-key-blobs)
-   [BLOB-объекты закрытых ключей](#private-key-blobs)
-   [Простые ключевые BLOB-объекты](#simple-key-blobs)

## <a name="public-key-blobs"></a>BLOB-объекты открытого ключа

Для хранения [*открытых ключей*](../secgloss/p-gly.md)используются [*большие двоичные объекты с открытым ключом*](../secgloss/p-gly.md), тип **публиккэйблоб**. Эти ключи экспортируются и импортируются в виде последовательности байтов в следующем формате.

``` syntax
PUBLICKEYSTRUC  publickeystruc ;
RSAPUBKEY       rsapubkey;
BYTE            modulus[rsapubkey.bitlen/8];
```

В следующей таблице описаны все компоненты открытого ключа. Все значения представлены в формате с [*прямым порядком байтов*](../secgloss/l-gly.md) .



| Поле          | Описание                                                                                                                                                                                                                                                                                        |
|----------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| остатка от деления        | Последовательность **байтов** . Данные модуля открытого ключа находятся непосредственно после структуры **рсапубкэй** . Длина этих данных зависит от длины открытого ключа. Число байтов может быть определено путем деления значения элемента **Битлен** **рсапубкэй** на восемь. |
| публиккэйструк | Структура [**публиккэйструк**](/windows/desktop/api/Wincrypt/ns-wincrypt-publickeystruc) .                                                                                                                                                                                                                                              |
| рсапубкэй      | Структура [**рсапубкэй**](/windows/desktop/api/Wincrypt/ns-wincrypt-rsapubkey) . **Фокусный** элемент должен иметь значение 0x31415352. Это шестнадцатеричное значение является кодировкой [*ASCII*](../secgloss/a-gly.md) для RSA1.                                                                                      |



 

> [!Note]  
> Большие двоичные объекты с открытым ключом не шифруются. Они содержат открытые ключи в виде открытого [*текста*](../secgloss/p-gly.md) .

 

## <a name="private-key-blobs"></a>BLOB-объекты закрытых ключей

[*BLOB-объекты с закрытыми ключами*](../secgloss/p-gly.md)типа **приватекэйблоб** используются для хранения [*пар открытого и закрытого ключей*](../secgloss/p-gly.md). Эти ключи экспортируются и импортируются в виде последовательности байтов в следующем формате.

``` syntax
PUBLICKEYSTRUC  publickeystruc ;
RSAPUBKEY       rsapubkey;
BYTE            modulus[rsapubkey.bitlen/8];
BYTE            prime1[rsapubkey.bitlen/16];
BYTE            prime2[rsapubkey.bitlen/16];
BYTE            exponent1[rsapubkey.bitlen/16];
BYTE            exponent2[rsapubkey.bitlen/16];
BYTE            coefficient[rsapubkey.bitlen/16];
BYTE            privateExponent[rsapubkey.bitlen/8];
```

Если [*большой двоичный объект ключа*](../secgloss/k-gly.md) зашифрован, то все, кроме [**публиккэйструк**](/windows/desktop/api/Wincrypt/ns-wincrypt-publickeystruc) части большого двоичного объекта, шифруются.

> [!Note]  
> Параметры алгоритма шифрования и ключа шифрования не сохраняются вместе с BLOB-объектом закрытого ключа. Для управления этими сведениями отвечает приложение.

 

В следующей таблице описывается каждый компонент BLOB-объекта закрытого ключа.

> [!Note]  
> Эти поля соответствуют полям, описанным в разделе 7,2 [*стандарта криптографии с открытым ключом*](../secgloss/p-gly.md) (PKCS) \# 1 с незначительными отличиями.

 



| Поле           | Описание                                                                                                                                                                                                   |
|-----------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| exponent1       | Последовательность **байтов** . Первый показатель степени. Оно имеет числовое значение d Mod (p – 1).                                                                                                                           |
| exponent2       | Последовательность **байтов** . Второй показатель степени. Оно имеет числовое значение d Mod (q – 1).                                                                                                                          |
| части     | Последовательность **байтов** . Части. Оно имеет числовое значение (обратная часть q) mod p.                                                                                                                           |
| Modulus         | Последовательность **байтов** . Модуль. Он содержит строку, содержащую *Prime1* \* *Prime2*. Он часто называется n.                                                                                               |
| prime1          | Последовательность **байтов** . Простое число 1, которое часто называют p.                                                                                                                                                        |
| prime2          | Последовательность **байтов** . Простое число 2, которое часто называют q.                                                                                                                                                        |
| публиккэйструк  | Структура [**публиккэйструк**](/windows/desktop/api/Wincrypt/ns-wincrypt-publickeystruc) .                                                                                                                                                         |
| приватикспонент | Последовательность **байтов** . Закрытый показатель степени, часто известный как d.                                                                                                                                                  |
| рсапубкэй       | Структура [**рсапубкэй**](/windows/desktop/api/Wincrypt/ns-wincrypt-rsapubkey) . **Фокусный** элемент должен иметь значение 0x32415352. Это шестнадцатеричное значение является кодировкой [*ASCII*](../secgloss/a-gly.md) для RSA2. |



 

> [!Note]  
> Большие двоичные объекты с закрытыми ключами не шифруются. Они содержат закрытые ключи в виде открытого текста.

 

При вызове [**криптекспорткэй**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptexportkey)разработчик может выбрать, следует ли шифровать ключ. **Приватекэйблоб** шифруется, если параметр *хекспкэй* содержит допустимый маркер для ключа сеанса. Все, кроме [**публиккэйструк**](/windows/desktop/api/Wincrypt/ns-wincrypt-publickeystruc) части большого двоичного объекта, шифруется.

> [!Note]  
> Параметры алгоритма шифрования и ключа шифрования не сохраняются вместе с BLOB-объектом закрытого ключа. Приложение должно управлять и хранить эти сведения. Если для *хекспкэй* передается ноль, закрытый ключ будет экспортирован без шифрования.

 

> [!Caution]  
> Экспортировать закрытые ключи без шифрования небезопасно, так как они уязвимы для перехвата и использования неавторизованными сущностями.

 

## <a name="simple-key-blobs"></a>Простые ключевые BLOB-объекты

[*Простые ключевые BLOB-объекты*](../secgloss/s-gly.md)типа **симплеблоб** используются для хранения и передачи ключей сеанса. Они всегда шифруются с помощью [*открытого ключа обмена ключами*](../secgloss/k-gly.md). Эти ключи экспортируются и импортируются в виде последовательности байтов в следующем формате.

``` syntax
PUBLICKEYSTRUC  publickeystruc ;
ALG_ID          algid;
BYTE            encryptedkey[rsapubkey.bitlen/8];
```

В следующей таблице описаны все простые компоненты больших двоичных объектов.



| Поле          | Описание                                                                                                                                                                                                                                                                                                                   |
|----------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| алгид          | Структура [**\_ идентификаторов ALG**](alg-id.md) . Обычно это указывает алгоритм КАЛГ \_ RSA \_ KEYX, который указывает, что данные ключа сеанса были зашифрованы с помощью открытого ключа обмена ключами, используя [*алгоритм открытого ключа RSA*](../secgloss/r-gly.md). |
| EncryptedKey   | Последовательность **байтов** . Зашифрованные данные ключа сеанса имеют вид \# блока шифрования PKCS 1, тип 2. Сведения об этом формате данных см. в разделе стандарты криптографии с открытым ключом (PKCS), опубликованные RSA Data Security, Inc.                                                                                     |
| публиккэйструк | Структура [**публиккэйструк**](/windows/desktop/api/Wincrypt/ns-wincrypt-publickeystruc) .                                                                                                                                                                                                                                                                         |



 

Эти данные всегда имеют тот же размер, что и модуль открытого ключа. Например, открытые ключи, создаваемые базовым поставщиком служб шифрования Майкрософт, всегда имеют 512 бит (64 байт), поэтому зашифрованные данные ключа сеанса также всегда имеют размер 64 байт.

 

 
