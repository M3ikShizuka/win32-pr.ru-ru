---
description: Использование функций CryptoAPI для управления хранилищами сертификатов и сертификатами, списками отзыва сертификатов и списками доверия сертификатов в этих магазинах.
ms.assetid: 6a56c355-8f24-41cc-88d9-2a02d9863ccf
title: Управление сертификатами с помощью хранилищ сертификатов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 98abb2b612f77db3f1c59e53fb9c7bf0f34cefb3
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127270896"
---
# <a name="managing-certificates-with-certificate-stores"></a>Управление сертификатами с помощью хранилищ сертификатов

В течение определенного периода времени [*Сертификаты*](../secgloss/c-gly.md) будут накапливаться на компьютере пользователя. Для управления этими сертификатами требуются средства. Интерфейс [*CryptoAPI*](../secgloss/c-gly.md) предоставляет эти средства как функции для хранения, извлечения, удаления, перечисления и проверки сертификатов. CryptoAPI также предоставляет средства для присоединения сертификатов к сообщениям.

CryptoAPI предлагает две основные категории функций для управления сертификатами: функции, управляющие [*хранилищами сертификатов*](../secgloss/c-gly.md), и функции, которые работают с сертификатами, [*списками отзыва сертификатов*](../secgloss/c-gly.md) (CRL) и [*списками доверия сертификатов*](../secgloss/c-gly.md) (CTL) в этих магазинах.

Функции, управляющие [*хранилищами сертификатов*](../secgloss/c-gly.md) , включают функции для работы с логическими или [*виртуальными хранилищами*](../secgloss/v-gly.md), [*удаленными*](../secgloss/r-gly.md)хранилищами, [*внешними хранилищами*](../secgloss/e-gly.md)и хранилищами, которые могут быть перемещены.

Сертификаты, [*списки отзыва*](../secgloss/c-gly.md)сертификатов и [*списки CTL*](../secgloss/c-gly.md) можно хранить и поддерживать в [*хранилищах сертификатов*](../secgloss/c-gly.md). Их можно получить из магазина, в котором они были сохранены для использования в процессах проверки подлинности.

[*Хранилище сертификатов*](../secgloss/c-gly.md) является центральным для всех функций сертификатов. Управление сертификатами осуществляется в хранилище с помощью функций с префиксом "CERT". Типичным хранилищем сертификатов является связанный список [*сертификатов*](../secgloss/c-gly.md) , как показано на следующем рисунке.

![хранилище сертификатов](images/certstore1.png)

На предыдущем рисунке показана:

-   Каждое [*хранилище сертификатов*](../secgloss/c-gly.md) имеет указатель на первый блок сертификата в этом хранилище.
-   Блок сертификата включает указатель на данные этого сертификата и указатель "Далее" на следующий блок сертификата в хранилище.
-   Указатель "Далее" в последнем блоке сертификата имеет значение **null**.
-   Блок данных сертификата содержит контекст сертификата только для чтения и все расширенные свойства сертификата.
-   Блок данных каждого сертификата содержит [*счетчик ссылок*](../secgloss/r-gly.md) , который отслеживает количество указателей на существующий сертификат.

Сертификаты в [*хранилище сертификатов*](../secgloss/c-gly.md) обычно хранятся в определенном постоянном хранилище, таком как файл на диске или системный реестр. Хранилища сертификатов также можно создавать и открывать строго в памяти. Хранилище памяти предоставляет временное хранилище сертификатов для работы с сертификатами, которые не нужно хранить.

Дополнительные расположения магазинов позволяют сохранять и искать Магазины в различных частях реестра локального компьютера или с соответствующими наборами разрешений в реестре на удаленном компьютере.

У каждого пользователя есть личное хранилище My Store, в котором хранятся сертификаты этого пользователя. Хранилище My может находиться в любом из нескольких физических расположений, включая реестр на локальном или удаленном компьютере, файл на диске, базу данных, службу каталогов, [*смарт-карту*](../secgloss/s-gly.md)или другое расположение. Хотя любой сертификат может храниться в хранилище My, это хранилище должно быть зарезервировано для персональных сертификатов пользователя: сертификаты, используемые для подписывания и расшифровки сообщений этого пользователя.

Использование сертификатов для проверки подлинности зависит от наличия сертификатов, выданных издателем доверенных сертификатов. Сертификаты для издателей доверенных сертификатов обычно хранятся в корневом хранилище, которое в настоящее время хранится в подразделе реестра. В контексте CryptoAPI защищено корневое хранилище, а диалоговые окна пользовательского интерфейса напоминают пользователю о необходимости поместить в это хранилище только доверенные сертификаты. В случае корпоративной сети сертификаты могут быть отправлены (скопированы) системным администратором с компьютера контроллера домена в корневые хранилища на клиентских компьютерах. Этот процесс предоставляет все члены домена с аналогичными списками доверия.

Другие сертификаты могут храниться в системном хранилище [*центра сертификации*](../secgloss/c-gly.md) (ЦС) или в созданных пользователем файловых хранилищах.

Списки функций для использования и обслуживания хранилищ сертификатов см. в разделе [функции хранилища сертификатов](cryptography-functions.md).

Пример, в котором используются некоторые из этих функций, см. в разделе [Пример программы C: операции с хранилищем сертификатов](example-c-program-certificate-store-operations.md).

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Управление состоянием хранилища сертификатов](managing-a-certificate-store-state.md)
</dt> <dt>

[Работа с сертификатами в хранилищах сертификатов](working-with-certificates-in-certificate-stores.md)
</dt> <dt>

[Ссылки на сертификаты](certificate-links.md)
</dt> <dt>

[Хранилища коллекций](collection-stores.md)
</dt> <dt>

[Логические и физические хранилища](logical-and-physical-stores.md)
</dt> <dt>

[Расположения системных хранилищ](system-store-locations.md)
</dt> <dt>

[Перенос хранилища сертификатов](certificate-store-migration.md)
</dt> </dl>

 

 
