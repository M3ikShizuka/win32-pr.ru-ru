---
description: Базовый поставщик, надежный поставщик и Улучшенный поставщик используют одинаковые ключевые BLOB-объекты.
ms.assetid: f1bd347b-33bd-40bc-9a9b-c06f264f1af4
title: Большие двоичные объекты расширенного поставщика
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9f693fd469a1df2e76078e61bb69c90ea5d5041d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105664135"
---
# <a name="enhanced-provider-key-blobs"></a>Большие двоичные объекты расширенного поставщика

Базовый поставщик, надежный поставщик и Улучшенный поставщик используют одинаковые [*Ключевые BLOB-объекты*](../secgloss/k-gly.md).

-   [BLOB-объекты открытого ключа](#public-key-blobs)
-   [BLOB-объекты закрытых ключей](#private-key-blobs)
-   [Простые ключевые BLOB-объекты](#simple-key-blobs)

## <a name="public-key-blobs"></a>BLOB-объекты открытого ключа

[*BLOB-объекты открытого ключа*](../secgloss/p-gly.md), тип **публиккэйблоб**, используются для хранения [*открытых ключей*](../secgloss/p-gly.md) за пределами [*поставщика служб шифрования*](../secgloss/c-gly.md) (CSP). Большие двоичные объекты открытого ключа поставщика имеют следующий формат.

``` syntax
PUBLICKEYSTRUC  publickeystruc;
RSAPUBKEY rsapubkey;
BYTE modulus[rsapubkey.bitlen/8];
```

В следующей таблице описаны все компоненты открытого ключа. Все значения представлены в формате с [*прямым порядком байтов*](../secgloss/l-gly.md) .



| Поле          | Описание                                                                                                                                                                                                                                                                           |
|----------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| остатка от деления        | Данные модуля открытого ключа находятся непосредственно после структуры [**рсапубкэй**](/windows/desktop/api/Wincrypt/ns-wincrypt-rsapubkey) . Размер этих данных зависит от размера открытого ключа. Число байтов может быть определено путем деления значения поля **рсапубкэй битлен** на восемь. |
| публиккэйструк | Структура [**публиккэйструк**](/windows/desktop/api/Wincrypt/ns-wincrypt-publickeystruc) .                                                                                                                                                                                                                                 |
| рсапубкэй      | Структура [**рсапубкэй**](/windows/desktop/api/Wincrypt/ns-wincrypt-rsapubkey) . **Фокусный** элемент должен иметь значение 0x31415352. Это шестнадцатеричное значение является кодировкой [*ASCII*](../secgloss/a-gly.md) для RSA1.                                                                         |



 

> [!Note]  
> Большие двоичные объекты с открытым ключом не шифруются. Они содержат открытые ключи в виде открытого [*текста*](../secgloss/p-gly.md) .

 

## <a name="private-key-blobs"></a>BLOB-объекты закрытых ключей

[*BLOB-объекты с закрытыми ключами*](../secgloss/p-gly.md)типа **приватекэйблоб** используются для хранения [*закрытых ключей*](../secgloss/p-gly.md) за пределами CSP. Большие двоичные объекты с закрытым ключом поставщика имеют следующий формат.

``` syntax
PUBLICKEYSTRUC  publickeystruc;
RSAPUBKEY rsapubkey;
BYTE modulus[rsapubkey.bitlen/8];
BYTE prime1[rsapubkey.bitlen/16];
BYTE prime2[rsapubkey.bitlen/16];
BYTE exponent1[rsapubkey.bitlen/16];
BYTE exponent2[rsapubkey.bitlen/16];
BYTE coefficient[rsapubkey.bitlen/16];
BYTE privateExponent[rsapubkey.bitlen/8];
```

В следующей таблице описывается компонент BLOB-объекта закрытого ключа.

> [!Note]  
> Эти поля соответствуют полям, описанным в разделе 7,2 [*стандарта криптографии с открытым ключом*](../secgloss/p-gly.md) (PKCS) \# 1 с незначительными отличиями.

 



| Поле           | Описание                                                                                                                                                                                                   |
|-----------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| части     | Части. Оно имеет числовое значение (обратная часть q) mod p.                                                                                                                                                |
| exponent1       | Показатель степени 1. Оно имеет числовое значение d Mod (p – 1).                                                                                                                                                        |
| exponent2       | Экспонента 2. Оно имеет числовое значение d Mod (q – 1).                                                                                                                                                        |
| Modulus         | Модуль. Он имеет значение *Prime1*×*Prime2* и часто называется n.                                                                                                                                   |
| prime1          | Простое число 1, которое часто называют p.                                                                                                                                                                             |
| prime2          | Простое число 2, которое часто называют q.                                                                                                                                                                             |
| приватикспонент | Закрытый показатель степени, часто известный как d.                                                                                                                                                                           |
| публиккэйструк  | Структура [**публиккэйструк**](/windows/desktop/api/Wincrypt/ns-wincrypt-publickeystruc) .                                                                                                                                                         |
| рсапубкэй       | Структура [**рсапубкэй**](/windows/desktop/api/Wincrypt/ns-wincrypt-rsapubkey) . **Фокусный** элемент должен иметь значение 0x32415352. Это шестнадцатеричное значение является кодировкой [*ASCII*](../secgloss/a-gly.md) для RSA2. |



 

> [!Note]  
> Большие двоичные объекты с закрытыми ключами не шифруются. Они содержат закрытые ключи в виде открытого текста.

 

При вызове [**криптекспорткэй**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptexportkey)разработчик может выбрать, следует ли шифровать ключ. **Приватекэйблоб** шифруется, если параметр *хекспкэй* содержит допустимый маркер для ключа сеанса. Все, кроме [**публиккэйструк**](/windows/desktop/api/Wincrypt/ns-wincrypt-publickeystruc) части большого двоичного объекта, шифруется.

> [!Note]  
> Параметры алгоритма шифрования и ключа шифрования не сохраняются вместе с BLOB-объектом закрытого ключа. Приложение должно управлять и хранить эти сведения. Если для *хекспкэй* передается ноль, закрытый ключ будет экспортирован без шифрования.

 

> [!Caution]  
> Экспортировать закрытые ключи без шифрования небезопасно, так как они уязвимы для перехвата и использования неавторизованными сущностями.

 

## <a name="simple-key-blobs"></a>Простые ключевые BLOB-объекты

[*Простые ключевые BLOB-объекты*](../secgloss/s-gly.md)типа **симплеблоб** используются для хранения и передачи ключей сеанса за пределами CSP. Большие двоичные объекты с простыми ключами поставщика всегда шифруются с помощью [*открытого ключа обмена ключами*](../secgloss/k-gly.md). Элемент **pbData** в **симплеблоб** представляет собой последовательность байтов в следующем формате.

``` syntax
PUBLICKEYSTRUC  publickeystruc;
ALG_ID algid;
BYTE encryptedkey[rsapubkey.bitlen/8];
```

В следующей таблице описаны все компоненты элемента **pbData** в **симплеблоб**.



| Поле          | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|----------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| алгид          | Структура [**\_ идентификаторов ALG**](alg-id.md) , указывающая алгоритм шифрования, используемый для шифрования данных ключа сеанса. Обычно это имеет значение КАЛГ \_ RSA \_ KEYX, которое указывает на то, что данные ключа сеанса были зашифрованы с помощью открытого ключа шифрования [*RSA*](../secgloss/r-gly.md).                                                                                                                           |
| EncryptedKey   | Последовательность **байтов** , представляющая зашифрованные данные ключа сеанса в форме \# блока шифрования PKCS 1, типа 2. Сведения об этом формате данных см. в разделе стандарты криптографии с открытым ключом (PKCS) \# 1, опубликованные RSA Data Security, Inc. Эти данные всегда имеют тот же размер, что и модуль открытого ключа. Например, открытые ключи, создаваемые базовым поставщиком Microsoft RSA, могут иметь длину 512 бит (64 байт), поэтому зашифрованные данные ключа сеанса также всегда имеют значение 512 бит (64 байт).<br/> |
| публиккэйструк | Структура [**публиккэйструк**](/windows/desktop/api/Wincrypt/ns-wincrypt-publickeystruc) .                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |



 

Дополнительные сведения о базовом поставщике и BLOB-объектах расширенного поставщика см. в [статье основные двоичные объекты базового поставщика](base-provider-key-blobs.md).

 

 
