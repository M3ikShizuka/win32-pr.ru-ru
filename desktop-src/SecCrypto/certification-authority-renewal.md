---
description: Службы сертификатов поддерживают обновление центра сертификации (ЦС).
ms.assetid: b6c76642-9a23-471e-af08-58e91d778f09
title: Продление центра сертификации
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 49f486e877e2ce1645cddf0099599e120776194dfd71e4e8b131d936c85e1f45
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119993114"
---
# <a name="certification-authority-renewal"></a>Продление центра сертификации

[*Службы сертификатов*](../secgloss/c-gly.md) поддерживают обновление [*центра сертификации*](../secgloss/c-gly.md) (ЦС). Продление — это выдача нового сертификата ЦС для продления срока службы ЦС за пределами даты окончания его исходного сертификата. Центр сертификации можно обновить как задачу в оснастке MMC центра сертификации или с помощью средства Certutil.exe (с командой **-реневцерт** ).

Каждое продление приводит к новому сертификату ЦС. Однако администратор может либо создать новую пару из открытого и закрытого ключей, либо повторно использовать существующую пару открытого и закрытого ключей для сертификата ЦС. Для согласованности и целостности сертификаты ЦС и [*списки отзыва сертификатов*](../secgloss/c-gly.md) (CRL), ВЫДАННЫЕ центром сертификации до его продления, будут доступны после обновления ЦС. Чтобы сделать их доступными, службы сертификатов поддерживают индекс сертификатов ЦС, списков отзыва сертификатов и ключей.

Ниже приведены индексы и имена суффиксов сертификатов ЦС и CRL во время различных операций обновления ЦС.



| Операция                | Индекс сертификата ЦС | Суффикс имени файла сертификата ЦС | Список отзыва сертификатов и индекс ключа | Список CRL и суффикс имени контейнера ключей |
|--------------------------|----------------------|---------------------------------|-------------------|-----------------------------------|
| Установка исходного ЦС | 0                    | ""                              | 0                 | ""                                |
| Продление с новым ключом     | 1                    | "(1)"                           | 1                 | "(1)"                             |
| Повторное использование ключа обновления      | 2                    | "(2)"                           | 1                 | "(1)"                             |
| Повторное использование ключа обновления      | 3                    | "(3)"                           | 1                 | "(1)"                             |
| Продление с новым ключом     | 4                    | "(4)"                           | 4                 | "(4)"                             |
| Повторное использование ключа обновления      | 5                    | "(5)"                           | 4                 | "(4)"                             |
| Продление с новым ключом     | 6                    | "(6)"                           | 6                 | "(6)"                             |
| Повторное использование ключа обновления      | 7                    | "(7)"                           | 6                 | "(6)"                             |



 

При установке ЦС индекс сертификата равен нулю, а суффикс сертификата — "" (пустая строка). При каждом обновлении сертификата (независимо от того, используются ли ключи повторно), индекс сертификата увеличивается на единицу, а суффикс имени файла сертификата становится строкой в формате "(*n*)", где *n* представляет количество раз, когда сертификат ЦС был продлен. После первого продления индекс сертификата равен 1, а суффикс имени файла сертификата — "(1)". После второго продления индекс сертификата равен 2, а суффикс имени файла сертификата — "(2)" и т. д.

Хотя индекс и суффикс сертификата ЦС увеличиваются на один раз при каждом обновлении центра сертификации, список CRL и индексы ключей и суффиксы имени файла устанавливаются в индекс сертификата ЦС только в том случае, если процесс обновления включает новую пару из открытого и закрытого ключей. В противном случае значения этих индексов и суффиксов остаются теми же, что и для последнего индекса. Во время продления администратор указывает, создается ли новая пара ключей или используется существующая пара ключей. (В оснастке «Центр сертификации» в качестве параметра пользовательского интерфейса указывается новая или существующая пара ключей; в средстве Certutil.exe команда **certutil-реневцерт** обновляет ЦС с помощью новой пары ключей, а команда **certutil-РЕНЕВЦЕРТ реусекэйс** обновляет ЦС с помощью существующей пары ключей.)

Индекс списка отзыва сертификатов напрямую привязан к индексу ключа, который устанавливается в индекс сертификата ЦС только в том случае, если для обновления используется новая пара ключей. После первого продления (которое использовало новую пару ключей) индекс списка CRL и ключа устанавливается в 1, а список CRL и суффикс имени контейнера ключа — "(1)". Однако после второго продления индекс списка отзыва сертификатов и ключа остается равным 1, а список CRL и суффикс имени контейнера ключей также остается "(1)"; Это связано с тем, что второе продление использует существующую пару ключей, и для каждой пары ключей ЦС выдается только один список отзыва сертификатов.

Вы можете получить индексированные сертификаты ЦС и списки отзыва сертификатов, вызвав метод **жетцертификатепроперти** (в интерфейсах [**ицертсерверексит**](/windows/desktop/api/Certif/nn-certif-icertserverexit) и [**ицертсерверполици**](/windows/desktop/api/Certif/nn-certif-icertserverpolicy) ). При получении определенных свойств, связанных с сертификатом ЦС или списком отзыва сертификатов, можно добавить в имена свойств индекс, начинающийся с нуля сертификата ЦС. Например, чтобы получить индекс списка отзыва сертификатов, соответствующий третьему сертификату ЦС, передайте свойство "Крлиндекс. 2" в [**ицертсерверполици:: жетцертификатепроперти**](/windows/desktop/api/Certif/nf-certif-icertserverpolicy-getcertificateproperty); для таблицы полученное значение свойства "Крлиндекс. 2" будет равно 1. Свойство с именем "Церткаунт" можно использовать, чтобы определить, сколько раз ЦС выдавал сертификат ЦС.

Сертификаты и списки отзыва сертификатов ЦС содержат расширение, которое предоставляет сведения о сертификате и индексе ключа. Расширение определяется в Винкрипт. h как Сзоид \_ CERTSRV \_ \_ версии CA со значением "1.3.6.1.4.1.311.21.1". Данные расширения — это значение **типа DWORD** (кодируется в виде \_ целого числа X509 в расширении); младшие 16 бит являются индексом сертификата, а старшие 16 бит — ключевым индексом.

При первоначальной установке ЦС создается нулевой индекс сертификата и индекс ключа, равный нулю. Возобновление сертификата ЦС приведет к увеличению индекса сертификата. Если ключ повторно используется в продлении, индекс ключа будет таким же, как и предыдущий индекс ключа. Если ключ не используется повторно, индекс ключа будет соответствовать новому индексу сертификата.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[**Ицертсерверполици:: Жетцертификатепроперти**](/windows/desktop/api/Certif/nf-certif-icertserverpolicy-getcertificateproperty)
</dt> <dt>

[**Ицертсерверексит:: Жетцертификатепроперти**](/windows/desktop/api/Certif/nf-certif-icertserverexit-getcertificateproperty)
</dt> </dl>

 

 
