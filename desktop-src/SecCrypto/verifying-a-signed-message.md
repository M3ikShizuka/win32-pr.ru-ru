---
description: Эти действия проверяют подпись подписанных данных.
ms.assetid: 18246cc1-d3c4-4426-a342-ce3864cc412e
title: Проверка подписанного сообщения
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1e8f85a5bcde56df7bb41bb92276123bcd26024e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105664384"
---
# <a name="verifying-a-signed-message"></a>Проверка подписанного сообщения

Эти действия проверяют подпись подписанных данных. На следующем рисунке показаны отдельные задачи, которые должны быть выполнены, как показано в следующем списке.

![Проверка подписанного сообщения](images/verifmsg.png)

**Проверка подписи подписанного сообщения**

1.  Получение указателя на подписанное сообщение.
2.  Откройте [*хранилище сертификатов*](../secgloss/c-gly.md).
3.  Используя идентификатор лица, содержащийся в сообщении, получите сертификат отправителя и получите маркер его [*открытого ключа*](../secgloss/p-gly.md).

    В качестве альтернативы этапам 2 и 3 можно использовать сертификат, содержащийся в сообщении, для получения открытого ключа подписавших.

4.  С помощью открытого ключа подписи расшифровывать цифровую подпись, создавая первоначальный дайджест данных в сообщении.
5.  Используя хэш-алгоритм, содержащийся в сообщении, следует [*хэшировать*](../secgloss/h-gly.md) данные, содержащиеся в сообщении, выдавая новый дайджест.
6.  Сравните дайджест, полученный из сообщения, с новым только что созданным дайджестом.
7.  Если эти две дайджеста совпадают, подпись проверяется. Это означает, что [*закрытый ключ*](../secgloss/p-gly.md) , который использовался для подписывания данных, соответствует открытому ключу, только что использовался для расшифровки подписи, и что данные не изменялись с момента подписания данных.

    Если два дайджеста не совпадают, подпись не проверяется, а закрытые или открытые ключи не совпадают или данные были изменены с момента подписания или и того, и другого.

Для проверки подписи можно использовать одну функцию [**криптверифимессажесигнатуре**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptverifymessagesignature), как показано в следующей процедуре.

**Проверка подписанного сообщения**

1.  Получение указателя на подписанное сообщение.
2.  Возвращает размер подписанного сообщения.
3.  Получение маркера для поставщика служб шифрования.
4.  Инициализируйте структуру " [**Проверка шифрования сообщения с помощью \_ \_ \_ абзаца**](/windows/desktop/api/Wincrypt/ns-wincrypt-crypt_verify_message_para) ".
5.  Вызовите [**криптверифимессажесигнатуре**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptverifymessagesignature) , чтобы проверить подпись.

Код, реализующий эту процедуру, включен в [Пример программы на языке C: подпись сообщения и проверка подписи сообщения](example-c-program-signing-a-message-and-verifying-a-message-signature.md).

 

 
