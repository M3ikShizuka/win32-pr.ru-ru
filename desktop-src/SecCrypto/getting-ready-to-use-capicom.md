---
description: Приложения, использующие объекты CAPICOM, должны создаваться с помощью CAPICOM.dll. CAPICOM.dll также должны присутствовать и быть зарегистрированы во время выполнения для использования объектов CAPICOM.
ms.assetid: 69de5232-e2f9-4aed-935d-5fbcd7998cc9
title: Подготовка к использованию элемента CAPICOM
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 83a6b76c293395fd0979cf5c304b27bae75622996279bd891b8c0c1301dca82e
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119006637"
---
# <a name="getting-ready-to-use-capicom"></a>Подготовка к использованию элемента CAPICOM

\[CAPICOM — это 32-разрядный компонент, доступный для использования в следующих операционных системах: Windows Server 2008, Windows Vista и Windows XP. вместо этого используйте платформа .NET Framework для реализации функций безопасности. Дополнительные сведения см. [в разделе альтернативы использованию элемента CAPICOM](alternatives-to-using-capicom.md).\]

Приложения, использующие объекты CAPICOM, должны создаваться с помощью CAPICOM.dll. CAPICOM.dll также должны присутствовать и быть зарегистрированы во время выполнения для использования объектов CAPICOM. CAPICOM.dll следует добавлять в ссылки на проекты Visual Basic для использования объектов CAPICOM.

CAPICOM доступен в виде распространяемого файла, который можно скачать из [распространяемого пакета Platform SDK: CAPICOM](https://www.microsoft.com/download/details.aspx?id=25281). Дополнительные сведения о версиях CAPICOM см. в разделе [CAPICOM Versions](capicom-versions.md).

**Регистрация CAPICOM.dll**

-   В командной строке измените каталог на каталог, где хранится CAPICOM.dll, а затем введите следующую команду:

    **regsvr32 CAPICOM.dll**

## <a name="example-code-limitations"></a>Примеры ограничений для кода

Для более краткого и более удобного для чтения кода принципы хорошей практики программирования не всегда следуют в этих примерах. В частности, отображаются только ограниченные ответы на ошибки. Работающие приложения всегда должны проверять возвращенные коды ошибок и выполнять соответствующие действия при обнаружении ошибки.

## <a name="necessary-key-containers-keys-and-certificates-in-capicom"></a>Необходимые контейнеры ключей, ключи и сертификаты в CAPICOM

Хотя некоторые операции с объектами CAPICOM можно выполнять на любом компьютере любым пользователем, создание [*цифровых подписей*](../secgloss/d-gly.md) и получение содержимого в виде текста в оболочке сообщения с помощью объектов CAPICOM — это операции на основе сертификатов. Пользователь, который создает цифровую подпись и пользователь, который получает зашифрованное содержимое запечатанного сообщения, должен иметь цифровой сертификат с доступным связанным закрытым ключом. Если сертификат с соответствующим закрытым ключом отсутствует, операция шифрования завершится ошибкой. Пользователи приложений CAPICOM должны обеспечить наличие соответствующего сертификата и доступного закрытого ключа при выполнении приложений.

Некоторые примеры в следующих разделах выполняют операции, для которых требуется доступная [*пара открытого и закрытого ключей*](../secgloss/p-gly.md) для шифрования и расшифровки файлов, сообщений и подписей. Во время выполнения многие из этих программ будут компилироваться и выполняться, но при этом не будет иметь соответствующие [*контейнеры ключей*](../secgloss/k-gly.md), ключи, хранилища сертификатов и [*Сертификаты*](../secgloss/c-gly.md) в этих хранилищах.

**Создание самозаверяющего сертификата**

1.  Установите средства подписывания. они устанавливаются в составе пакета средств разработки программного обеспечения (sdk) для Microsoft Windows, пакета sdk платформы или пакета sdk для платформа .NET Framework.
2.  После загрузки Makecert.exe выполните следующую команду в командной строке, подставив имя пользователя *username*, название организации для *название_организации* и название компании для *CompanyName*:

    **MakeCert-r-n "CN =**_имя_пользователя_*_, OU =_*_название_организации_*_, o =_*_CompanyName_*_"-SS My_*

3.  Сертификат можно поместить в хранилище My текущего пользователя. Импортируйте сертификат, созданный в корневом хранилище, чтобы он был доверенным.

 

 
