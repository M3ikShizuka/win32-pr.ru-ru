---
description: Службы сертификатов предоставляют веб-страницы регистрации, которые можно использовать для запроса сертификатов.
ms.assetid: 1e198bc8-c712-4d0f-9e3a-35a295445acf
title: Настройка страниц веб-регистрации служб сертификатов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4eb2fbf421eceb1ebf0b15379aca5d0788a992ba
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "103913047"
---
# <a name="customizing-certificate-services-web-enrollment-pages"></a>Настройка страниц веб-регистрации служб сертификатов

[*Службы сертификатов*](../secgloss/c-gly.md) предоставляют веб-страницы регистрации, которые можно использовать для запроса сертификатов. Администратор может настраивать некоторые элементы, которые можно просматривать на страницах веб-регистрации. Однако перед внесением изменений необходимо ознакомиться с веб-страницами регистрации и веб-скриптами. Дополнительные сведения о веб-сценариях см. в разделе [сценарии](/previous-versions/ms950396(v=msdn.10)).

Значения по умолчанию для полей различающегося имени для Организации, подразделений, регионов, штат и страны или региона являются значениями, указанными для [*центра сертификации*](../secgloss/c-gly.md) (ЦС) при установке служб сертификатов. Эти значения по умолчанию отображаются на веб-страницах и могут быть изменены пользователем в процессе регистрации сертификата. Однако если вы хотите, чтобы на веб-страницах отображались другие значения по умолчанию, можно изменить файл Цертдат. Inc (в каталоге \\ *виндовсдиректори* \\ system32 \\ certsrv \\ ). в частности, можно присвоить пользовательские значения следующим переменным, предоставленным для настройки.



| Переменная            | Описание                                                                                                                                                                                                                               |
|---------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| сдефаулткомпани     | Компания по умолчанию (отображается в [*запросе сертификата*](../secgloss/c-gly.md) как поле Организации [*X. 509*](../secgloss/x-gly.md) ). |
| сдефаулторгунит     | Отдел по умолчанию (отображается в запросе сертификата как поле подразделения X. 509).                                                                                                                                           |
| сдефаултлокалити    | Город по умолчанию (отображается в запросе сертификата как поле расположения X. 509).                                                                                                                                                            |
| сдефаултстате       | Область или край по умолчанию (отображается в запросе сертификата как поле состояния X. 509).                                                                                                                                                     |
| сдефаулткаунтри     | Страна или регион по умолчанию (отображается в запросе сертификата как поле страны или региона X. 509).                                                                                                                                            |
| нпендингтимеаутдайс | Число дней, в течение которых пользователь может получить ожидающий сертификат после запроса.                                                                                                                                          |



 

Другие переменные не должны изменяться в файле Цертдат. Inc.

В следующем примере для подразделения по умолчанию задается значение "Marketing".


```VB
sDefaultOrgUnit="Marketing"
```



Кроме того, файл Цертрктп. Inc можно изменить для добавления, изменения или удаления [*шаблонов сертификатов*](../secgloss/c-gly.md) или типов, доступных пользователю. Эти шаблоны и типы, а также связанные сведения содержатся в массиве измерений с именем Ргаваилректипес (*m*, 5).

Этот массив, как и все массивы Visual Basic Scripting Edition, основан на нулях, и в результате первое измерение массива *m*, выделяет память для *m*+ 1 элементов. Поэтому при настройке веб-страниц необходимо изменить число элементов в массиве Ргаваилректипес, присвоить измерению *m* значение меньше, чем общее число необходимых элементов. Например, если у вас будут семь шаблонов сертификатов, измените объявление Ргаваилректипес, как показано в следующем примере.


```VB
Dim rgAvailReqTypes(6,5)
```



Второе измерение массива, которое всегда имеет значение 5, выделяет шесть полей, составляющих каждый элемент. Эти шесть полей представляют шаблон или тип сертификата, отображаемое имя, связанное с этим шаблоном или типом, а также указывает, требуется ли для шаблона наличие [*расширений электронной почты в Интернете*](../secgloss/s-gly.md) (S/MIME).

Чтобы облегчить понимание того, к какому из этих полей обращается доступ, Цертрктп. Inc также предоставляет следующие константы, которые можно использовать при задании значений полей.



| Константа                              | Описание                                                                                                                                                                                                                                                                                                                          |
|---------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **\_OID поля**                        | (Относится к автономным ЦС) Индекс для первого поля элемента; представляет [*идентификатор объекта*](../secgloss/o-gly.md) (OID) для типа сертификата.<br/>                                                                                                           |
| **\_шаблон поля**                   | (Относится к ЦС предприятия) Индекс для первого поля элемента; представляет шаблон сертификата.<br/>                                                                                                                                                                                                                           |
| **ПОЛЕ \_ FRIENDLYNAME**               | Индекс для второго поля элемента; Представляет отображаемое имя (которое пользователь увидит при регистрации) элемента в первом поле.                                                                                                                                                                                               |
| **ПОЛЕ \_ ксплист**                    | Индекс для третьего поля элемента. Список имен [*поставщиков служб шифрования*](../secgloss/c-gly.md) , разрешенных шаблоном. Каждое имя в списке отделяется вопросительным знаком (?).                                                    |
| **ПОЛЕ \_ CSPLIST2**                   | Индекс четвертого поля элемента. Дополнительный список имен [*поставщиков служб шифрования*](../secgloss/c-gly.md) , разрешенных шаблоном. Каждое имя в списке отделяется вопросительным знаком (?). Этот список содержит разные значения по умолчанию. |
| **\_экспортируемое поле**                 | Индекс для пятого поля элемента. Указывает, указывает ли шаблон, что ключ должен быть экспортирован. Если это поле содержит значение "true", ключ может быть экспортирован. Если это поле содержит значение "false", ключ не может быть экспортирован.                                                                                                        |
| **для \_ поля \_ требуются \_ возможности SMIME** | Эта константа не поддерживается.                                                                                                                                                                                                                                                                                                      |



 

Например, следующие выражения присваивают идентификатор объекта 1.3.6.1.5.5.7.3.2 первому полю первого элемента и присваивают полю "сертификат веб-браузера" второе поле первого элемента (значение массива 0 индексирует первый элемент).


```VB
rgAvailReqTypes(0, FIELD_OID) = "1.3.6.1.5.5.7.3.2"
rgAvailReqTypes(0, FIELD_FRIENDLYNAME) = "Web Browser Certificate"
```



Результатом этих назначений является то, что пользователь увидит текстовый **сертификат веб-браузера** при регистрации, и если пользователь выберет **сертификат веб-браузера**, [*запрос сертификата*](../secgloss/c-gly.md) будет содержать идентификатор объекта 1.3.6.1.5.5.7.3.2.

Файл Цертрктп. Inc также содержит константы, которые используются для отображаемых имен шаблонов сертификатов или типов. В следующем примере показан формат.


```VB
' Strings for localization.
Const L_WebBrowserCert_Text="Web Browser Certificate"
Const L_EmailProtectionCert_Text="E-Mail Protection Certificate"
Const L_UserTemplateCert_Text="User Certificate"
```



Эти константы определяются в блоке в файле Цертрктп. Inc, и эта группировка упрощает Присвоение каждому из них пользовательского значения. Это особенно полезно при локализации отображаемых имен для международных версий веб-страниц.

Наконец, файл Цертрктп. Inc содержит переменную, представляющую количество шаблонов сертификатов или типов в массиве Ргаваилректипес. В отличие от измерения *m* массива, присвойте значение переменной наваилректипес фактическому числу шаблонов сертификатов или типов, которые будут использоваться при установке. Это значение должно быть не больше *m*+ 1. Несмотря на то, что объявлено ближе к началу файла Цертрктп. Inc, Наваилректипес присваивает значение после заполнения массива Ргаваилректипес, что упрощает просмотр количества элементов, которые фактически используются массивом. Значение Наваилректипес используется в другой итерации на страницах веб-регистрации, поэтому важно, чтобы эта переменная точно отражала количество шаблонов сертификатов или типов, которые должны быть доступны пользователю для просмотра.

Обратите внимание, что добавление [*шаблонов сертификатов*](../secgloss/c-gly.md) и типов в файл цертрктп. Inc не гарантирует, что пользователь сможет получить сертификат с этими характеристиками. ЦС должен иметь разрешение на выдачу сертификата для указанного шаблона или типа сертификата.

Установки могут создавать собственные приложения или веб-страницы для запроса и получения сертификата. Объекты [**ICEnroll4**](/windows/desktop/api/Xenroll/nn-xenroll-icenroll4) и [**ICertRequest2**](/windows/desktop/api/Certcli/nn-certcli-icertrequest2) позволяют программистам и разработчикам создавать приложения для [*запросов сертификатов*](../secgloss/c-gly.md) .

Чтобы запросить сертификат для [*смарт-карты*](../secgloss/s-gly.md), можно использовать Управление регистрацией смарт-карты. Дополнительные сведения и примеры кода см. в разделе [**искрденр**](iscrdenr.md).

 

 
