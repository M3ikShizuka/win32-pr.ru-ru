---
description: Импортирует сертификаты из файла в хранилище.
ms.assetid: 884326b4-77ca-43d4-bda9-127d823ce9bc
title: Метод Store. Load
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- Store.Load
api_type:
- COM
api_location:
- Capicom.dll
ms.openlocfilehash: 32261a6fd8c5cf4382832d8286d63ce5d44fb542
ms.sourcegitcommit: c8ec1ded1ffffc364d3c4f560bb2171da0dc5040
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2021
ms.locfileid: "105669507"
---
# <a name="storeload-method"></a>Метод Store. Load

\[Метод **Load** доступен для использования в операционных системах, указанных в разделе требования. Вместо этого используйте [**класс X509Store**](/dotnet/api/system.security.cryptography.x509certificates.x509store?view=netcore-3.1) в пространстве имен [**System. Security. Cryptography. X509Certificates**](/dotnet/api/system.security.cryptography.x509certificates.publickey.-ctor?view=netcore-3.1) .\]

Метод **Load** импортирует сертификаты из файла в хранилище.

## <a name="syntax"></a>Синтаксис


```VB
Store.Load( _
  ByVal FileName, _
  [ ByVal Password ], _
  [ ByVal KeyStorageFlag ] _
)
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*Имя файла* \[ окне\]
</dt> <dd>

Строка, содержащая путь к файлу. cer,. SST,. SPC,. P7S или. pfx или любому файлу, подписанному с помощью Authenticode.

</dd> <dt>

*Пароль* \[ в необязательное\]
</dt> <dd>

Строка, содержащая пароль в виде открытого текста для файла. Для пароля можно использовать до 32 символов Юникода, включая завершающий нуль-символ. Сведения о защите пароля см. в разделе [обработка паролей](../secbp/handling-passwords.md).

</dd> <dt>

*Кэйсторажефлаг* \[ в необязательное\]
</dt> <dd>

Значение перечисления [**\_ \_ \_ флагов хранилища CAPICOM Key**](capicom-key-storage-flag.md) , определяющее флаги хранилища ключей. По умолчанию используется \_ хранилище CAPICOM key \_ \_ . Этот параметр может принимать одно из указанных ниже значений.



| Значение                                                                                                                                                                                                                           | Значение                               |
|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|
| <span id="CAPICOM_KEY_STORAGE_DEFAULT"></span><span id="capicom_key_storage_default"></span><dl> <dt>**\_хранилище CAPICOM \_ key \_ по умолчанию**</dt> </dl>                       | Хранилище ключей по умолчанию.<br/>       |
| <span id="CAPICOM_KEY_STORAGE_EXPORTABLE"></span><span id="capicom_key_storage_exportable"></span><dl> <dt>**\_хранилище CAPICOM Key, \_ \_ экспортируемое**</dt> </dl>              | Ключ доступен для экспорта.<br/>     |
| <span id="CAPICOM_KEY_STORAGE_USER_PROTECTED"></span><span id="capicom_key_storage_user_protected"></span><dl> <dt>**\_ \_ \_ защищенное пользователем хранилище CAPICOM key \_**</dt> </dl> | Ключ защищен пользователем.<br/> |



 

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Этот метод не возвращает значение.

## <a name="remarks"></a>Комментарии

Если метод **Load** вызывается в хранилище памяти, все создаваемые контейнеры ключей будут удалены при удалении хранилища памяти. Например, если PFX-файл загружается в хранилище памяти и позднее добавляется в системное хранилище (например, в хранилище My) из хранилища памяти, то сертификат в хранилище My не будет содержать ключ. В этом случае PFX-файл должен быть загружен непосредственно в хранилище My.

Этот метод вызывает CAPICOM \_ E \_ не \_ разрешен при создании скрипта из веб-приложения.

Если не удалось расшифровать файл закрытого ключа паролем, то необходимо запросить [*поставщик служб шифрования*](../secgloss/c-gly.md) (CSP) по умолчанию. Если CSP по умолчанию является базовым поставщиком служб шифрования Майкрософт и операция расшифровки завершается неудачно, то операцию расшифровки следует повторить с помощью строгого поставщика служб шифрования (Майкрософт) или поставщика Microsoft Enhanced Cryptographic, в зависимости от того, какая из них доступна.

Если сертификат, загружаемый в хранилище, совпадает с тем, который уже есть, метод **Load** удалит существующий сертификат из хранилища, а затем добавит новый сертификат. Новый сертификат будет наследовать свойства от существующего сертификата. Существующий контейнер закрытых ключей заменяется новым контейнером закрытого ключа.

## <a name="requirements"></a>Требования



| Требование | Значение |
|----------------------------|----------------------------------------------------------------------------------------|
| Распространяемые компоненты<br/> | CAPICOM 2,0 или более поздней версии на Windows Server 2003 и Windows XP<br/>                  |
| DLL<br/>             | <dl> <dt>Capicom.dll</dt> </dl> |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**Магазин**](store.md)
</dt> </dl>

 

 
