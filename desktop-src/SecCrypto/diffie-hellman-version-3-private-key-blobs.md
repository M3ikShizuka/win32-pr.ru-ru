---
description: Описывает формат экспортированного BLOB-объекта закрытого ключа Diffie-Hellman версии 3.
ms.assetid: c759e6e1-f7af-4cd6-a67e-ff0da1e91eb1
title: BLOB-объекты закрытого ключа Diffie-Hellman версии 3
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cb35a6db0cfd75d34ba30d26be816a64c1b04205
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104497199"
---
# <a name="diffie-hellman-version-3-private-key-blobs"></a>BLOB-объекты закрытого ключа Diffie-Hellman версии 3

При экспорте большого двоичного объекта [*закрытого ключа*](../secgloss/p-gly.md) Diffie-Hellman версии 3 он имеет следующий формат:


```C++
BLOBHEADER        blobheader;
DHPRIVKEY_VER3   dhprivkeyver3;
BYTE p[dhprivkeyver3.bitlenP/8]; 
            // Where P is the prime modulus
BYTE q[dhprivkeyver3.bitlenQ/8]; 
            // Where Q is a large factor of P-1
BYTE g[dhprivkeyver3.bitlenP/8]; 
            // Where G is the generator parameter
BYTE j[dhprivkeyver3.bitlenJ/8]; 
            // Where J is (P-1)/Q
BYTE y[dhprivkeyver3.bitlenP/8]; 
            // Where Y is (G^X) mod P
BYTE x[dhprivkeyver3.bitlenX/8]; 
            // Where X is the private exponent
```



Этот формат [*большого двоичного объекта*](../secgloss/b-gly.md) экспортируется, когда \_ флаг шифрования BLOB \_ -объекта VER3 используется с [**криптекспорткэй**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptexportkey). Так как версия находится в большом двоичном объекте, нет необходимости указывать флаг при использовании этого большого двоичного объекта с [**криптимпорткэй**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptimportkey).

В следующей таблице описаны все компоненты [*большого двоичного объекта ключа*](../secgloss/k-gly.md).



| Поле         | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|---------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| блобхеадер    | Структура [**блобхеадер**](/windows/desktop/api/Wincrypt/ns-wincrypt-publickeystruc) .                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| dhprivkeyver3 | Структура [**\_ VER3 дхпривкэй**](/windows/win32/api/wincrypt/ns-wincrypt-dhprivkey_ver3) . Для закрытых ключей необходимо задать для **волшебного** члена значение 0x34484400. Обратите внимание, что шестнадцатеричное значение — это просто кодировка [*ASCII*](../secgloss/a-gly.md) "DH4".                                                                                                                                                                                                                                                                                            |
| С             | Значение P находится непосредственно после структуры [**дхпривкэй \_ VER3**](/windows/win32/api/wincrypt/ns-wincrypt-dhprivkey_ver3) и всегда должно быть длиной в байтах поля **дхпривкэй \_ VER3** **битленп** (разрядная длина P), деленная на 8 (формат с [*прямым порядком байтов*](../secgloss/l-gly.md) ).                                                                                                                                                                                                                            |
| Q             | Значение Q находится непосредственно после значения P и всегда должно быть длиной в байтах поля [**дхпривкэй \_ VER3**](/windows/win32/api/wincrypt/ns-wincrypt-dhprivkey_ver3) **битленк** , деленного на 8 (формат с [*прямым порядком байтов*](../secgloss/l-gly.md) ). Если значение Битленк равно 0, то это значение отсутствует в большом двоичном объекте.                                                                                                                                                                                                  |
| G             | Значение G расположено непосредственно после значения Q и всегда должно быть длиной в байтах поля [**дхпривкэй \_ VER3**](/windows/win32/api/wincrypt/ns-wincrypt-dhprivkey_ver3) **битленп** (разрядная длина P), деленная на восемь. Если длина данных равна одному или нескольким байтам, меньшим, чем P, деленному на 8, то данные должны быть дополнены требуемыми байтами (нулевыми значениями), чтобы данные были требуемой длины (формат с [*прямым порядком байтов*](../secgloss/l-gly.md) ).                                                                 |
| J             | Значение J находится непосредственно после значения G и всегда должно быть длиной в байтах поля [**дхпривкэй \_ VER3**](/windows/win32/api/wincrypt/ns-wincrypt-dhprivkey_ver3) **битленж** , деленного на 8 (формат с [*прямым порядком байтов*](../secgloss/l-gly.md) ). Если значение Битленж равно 0, то это значение отсутствует в большом двоичном объекте.                                                                                                                                                                                                  |
| Да             | Значение Y (G ^ X) mod P находится непосредственно после значения J и всегда должно быть длиной в байтах поля [**дхпривкэй \_ VER3**](/windows/win32/api/wincrypt/ns-wincrypt-dhprivkey_ver3) **Битленп** (бит длиной P), разделенного на восемь. Если длина данных, полученная в результате вычисления (G ^ X) mod P, равна одному или более байтам, меньшим, чем P, то данные должны быть дополнены требуемыми байтами (нулевыми значениями), чтобы данные были требуемой длины (формат с [*прямым порядком байтов*](../secgloss/l-gly.md) ). |
| X             | Значение X является случайным целым числом, таким образом, что открытая часть пары ключей Диффи-Хелмана, Y, равна: Y = (G ^ X) mod P<br/>                                                                                                                                                                                                                                                                                                                                                                                                                      |



 

При вызове [**криптекспорткэй**](/windows/desktop/api/Wincrypt/nf-wincrypt-cryptexportkey)разработчик может выбрать, следует ли шифровать ключ. Ключ шифруется, если параметр *хекспкэй* содержит допустимый маркер для ключа сеанса. Все, кроме [**блобхеадер**](/windows/desktop/api/Wincrypt/ns-wincrypt-publickeystruc) части большого двоичного объекта, шифруется. Обратите внимание, что алгоритм шифрования и параметры ключа шифрования не хранятся вместе с [*BLOB-объектом закрытого ключа*](../secgloss/p-gly.md). Приложение должно управлять и хранить эти сведения. Если для *хекспкэй* передается ноль, закрытый ключ будет экспортирован без шифрования.

> [!Note]  
> Экспортировать закрытые ключи без шифрования небезопасно, так как они уязвимы для перехвата и использования неавторизованными сущностями.

 

 

 
