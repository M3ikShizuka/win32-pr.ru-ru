---
description: Создает цифровую подпись для подписанного содержимого. Цифровая подпись состоит из хэша содержимого, подписывания которого шифруется с помощью закрытого ключа подписавшего.
ms.assetid: ee98a36c-f9a9-4247-ae48-7b1a10b92be4
title: Сигнеддата. Sign, метод
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- SignedData.Sign
api_type:
- COM
api_location:
- Capicom.dll
ms.openlocfilehash: 9f885bb110b51264bc6108ca8c0f881cc48f7710
ms.sourcegitcommit: c8ec1ded1ffffc364d3c4f560bb2171da0dc5040
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2021
ms.locfileid: "105685175"
---
# <a name="signeddatasign-method"></a>Сигнеддата. Sign, метод

\[Метод **Sign** доступен для использования в операционных системах, указанных в разделе требования. Вместо этого используйте [**класс SignedCms**](/dotnet/api/system.security.cryptography.pkcs.signedcms?view=dotnet-plat-ext-3.1&preserve-view=true) в пространстве имен [**System. Security. Cryptography. PKCS**](/dotnet/api/system.security.cryptography.pkcs?view=dotnet-plat-ext-3.1&preserve-view=true) .\]

Метод **Sign** создает [*цифровую подпись*](../secgloss/d-gly.md) для подписанного содержимого. Цифровая подпись состоит из [*хэша*](../secgloss/h-gly.md) содержимого, подписывания которого шифруется с помощью закрытого ключа подписавшего. Этот метод можно использовать только после инициализации свойства [**сигнеддата. Content**](signeddata-content.md) . Если метод **Sign** вызывается для объекта, который уже имеет сигнатуру, старая сигнатура заменяется. Подпись создается с помощью алгоритма подписи SHA1.

## <a name="syntax"></a>Синтаксис


```VB
SignedData.Sign( _
  [ ByVal Signer ], _
  [ ByVal bDetached ], _
  [ ByVal EncodingType ] _
)
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*Подписавший* \[ в необязательное\]
</dt> <dd>

Ссылка на объект- [**подписывающий**](signer.md) подписи данных. Объект " **подписавший** " должен иметь доступ к [*закрытому ключу*](../secgloss/p-gly.md) [*сертификата*](../secgloss/c-gly.md) , используемого для подписания. Этот параметр может иметь **значение NULL**. Дополнительные сведения см. в разделе Примечания.

</dd> <dt>

*бдетачед* \[ в необязательное\]
</dt> <dd>

Если **значение равно true**, данные для подписи отсоединяются; Это значит, что подписанное содержимое не входит в состав подписанного объекта. Чтобы проверить подпись отсоединенного содержимого, приложение должно иметь копию исходного содержимого. Отсоединенное содержимое часто используется для уменьшения размера подписанного объекта для отправки через Интернет, если получатель подписанного сообщения имеет исходную копию подписанных данных. Значение по умолчанию равно **False**.

</dd> <dt>

*Енкодингтипе* \[ в необязательное\]
</dt> <dd>

Значение перечисления типа " [CAPICOM \_ Encoding \_ ](capicom-encoding-type.md) ", указывающее способ кодирования подписанных данных. Значение по умолчанию — CAPICOM- \_ кодировать \_ Base64. Этот параметр может принимать одно из указанных ниже значений.



| Значение                                                                                                                                                                                  | Значение                                                                                                                                                                                                                            |
|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="CAPICOM_ENCODE_ANY"></span><span id="capicom_encode_any"></span><dl> <dt>**CAPICOM \_ кодирует \_ ANY**</dt> </dl>          | Этот тип кодирования используется только в том случае, если входные данные имеют неизвестный тип кодирования. Если это значение используется для указания типа кодирования вывода, \_ \_ вместо этого будет использоваться CAPICOM-Encoding Base64. Представлено в CAPICOM 2,0.<br/> |
| <span id="CAPICOM_ENCODE_BASE64"></span><span id="capicom_encode_base64"></span><dl> <dt>**CAPICOM \_ кодирует \_ Base64**</dt> </dl> | Данные сохраняются в виде строки в кодировке Base64.<br/>                                                                                                                                                                               |
| <span id="CAPICOM_ENCODE_BINARY"></span><span id="capicom_encode_binary"></span><dl> <dt>**\_двоичная кодировка CAPICOM \_**</dt> </dl> | Данные сохраняются в виде чисто двоичной последовательности.<br/>                                                                                                                                                                                |



 

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Этот метод возвращает строку, содержащую закодированные подписанные данные.

В случае сбоя этого метода возникнет ошибка. Объект **Err** будет содержать дополнительные сведения об ошибке.

## <a name="remarks"></a>Комментарии

> [!IMPORTANT]
> При вызове этого метода из веб-скрипта скрипту необходимо использовать закрытый ключ для создания цифровой подписи. Предоставление недоверенным веб-узлам использования закрытого ключа является угрозой безопасности. Диалоговое окно с запросом на то, может ли веб-сайт использовать закрытый ключ при первом вызове этого метода. Если вы разрешите скрипту использовать закрытый ключ для создания цифровой подписи и установите флажок "больше не показывать это окно", диалоговое окно больше не будет отображаться для любого скрипта в этом домене, который использует закрытый ключ для создания цифровой подписи. Однако скрипты за пределами этого домена, которые пытаются использовать закрытый ключ для создания цифровой подписи, все равно приведут к появлению этого диалогового окна. Если вы не разрешите скрипту использовать закрытый ключ и установите флажок "больше не выводить это диалоговое окно", скрипты внутри этого домена автоматически не смогут использовать закрытый ключ для создания цифровых подписей.

 

Поскольку создание [*цифровой подписи*](../secgloss/d-gly.md) требует использования [*закрытого ключа*](../secgloss/p-gly.md), веб-приложения, которые пытаются использовать этот метод, потребуются запросы пользовательского интерфейса, позволяющие пользователю утверждать использование закрытого ключа по соображениям безопасности.

Следующие результаты применяются к значению параметра *SignIn* :

-   Если параметр- *подписывающий* имеет значение, отличное от **null**, этот метод использует закрытый ключ, указанный в соответствующем сертификате, для шифрования подписи. Если закрытый ключ, на который указывает сертификат, недоступен, метод завершается ошибкой.
-   Если параметр- *подписывающий* имеет **значение NULL** и в хранилище текущего пользователя есть ровно один сертификат \_ с доступом к закрытому ключу, этот сертификат используется для создания подписи.
-   Если параметр- *подписывающий* имеет значение **null**, то значением свойства [**Settings. енаблепромптфорцертификатеуи**](settings-enablepromptforcertificateui.md) является true, и в \_ хранилище текущего пользователя с доступным закрытым ключом существует несколько сертификатов. в этом случае появляется диалоговое окно, позволяющее пользователю выбрать используемый сертификат.
-   Если параметр- *подписывающий* имеет **значение NULL** , а свойство [**Settings. енаблепромптфорцертификатеуи**](settings-enablepromptforcertificateui.md) имеет значение false, то метод завершается ошибкой.
-   Если параметр- *подписывающий* имеет **значение NULL** и в хранилище текущего пользователя нет сертификата \_ с доступным закрытым ключом, метод завершается ошибкой.

## <a name="requirements"></a>Требования



| Требование | Значение |
|----------------------------|----------------------------------------------------------------------------------------|
| Распространяемые компоненты<br/> | CAPICOM 2,0 или более поздней версии на Windows Server 2003 и Windows XP<br/>                  |
| DLL<br/>             | <dl> <dt>Capicom.dll</dt> </dl> |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**Криптографические объекты**](cryptography-objects.md)
</dt> <dt>

[**сигнеддата**](signeddata.md)
</dt> </dl>

 

 
