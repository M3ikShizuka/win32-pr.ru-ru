---
description: Если вы предоставляете счетчики на 64-разрядном компьютере, необходимо установить на компьютере и 32-разрядную, и 64-разрядную версию поставщика, если вы хотите поддерживать как 32-разрядные, так и 64-разрядные потребителей.
ms.assetid: 2dba2c46-0185-4ce6-a7cc-27cdd9b19b70
title: Поддержка 64-разрядных версий
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e465529f35d8a9becb2583e9d5c00ac19a74d3be
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105663263"
---
# <a name="64-bit-support"></a>Поддержка 64-разрядных версий

Библиотека DLL поставщика данных о производительности 64-бит не может выполняться в 32-разрядном процессе, а библиотека DLL поставщика данных о производительности 32-bit не может выполняться в 64-разрядном процессе. Регистрация поставщика поддерживает только одно `Library` значение пути к библиотеке DLL поставщика данных о производительности, поэтому нельзя предоставить разные пути для использования в 32-разрядных потребителях и 64-разрядных потребителях.

Для поддержки поставщиков v1 в 64-разрядных операционных системах доступны следующие параметры:

- **Рекомендуется:** Установите и зарегистрируйте путь к 32-разрядной версии библиотеки DLL поставщика.
  - 32-разрядные пользователи будут работать изначально: они загружают библиотеку DLL 32-разрядного поставщика в клиентский процесс 32-bit.
  - 64-разрядные потребители будут работать косвенно: они не смогут загрузить DLL-библиотеку поставщика 32 в процесс 64-bit, но Windows автоматически вернется к созданию 32-разрядного процесса перфхост, загрузке библиотеки DLL-разрядного поставщика в процесс перфхост и отправке данных о производительности из перфхост процесса в 32-разрядный процесс потребителя.
- **только 64-разрядная версия:** Установите и зарегистрируйте путь к 64-разрядной версии библиотеки DLL поставщика.
  - 32-разрядные пользователи завершатся сбоем: они не смогут загрузить библиотеку DLL 64-разрядного поставщика в 32-разрядный процесс.
  - 64-разрядные пользователи будут работать в собственном режиме: они будут загружать библиотеку DLL поставщика 32-bit.

> [!NOTE]
> Несколько встроенных поставщиков данных о производительности Windows устанавливают 32-разрядную библиотеку DLL в `%systemroot%\syswow64` , устанавливают 64-разрядную библиотеку DLL в `%systemroot%\system32` и зарегистрируют `Library` путь как `%systemroot%\system32\ProviderName.dll` , что позволяет перенаправление файловой системы разрешать путь к соответствующей библиотеке DLL. Это поддерживается только для поставщиков данных о производительности, которые являются частью операционной системы Windows. Поставщики, не являющиеся частью операционной системы Windows, не должны устанавливать файлы в `Windows` папку. Нераспознанные файлы в `Windows` папке могут быть удалены во время обслуживания или обновления.
