---
description: Большинству счетчиков требуется два образца значений, чтобы вычислить отображаемое значение.
ms.assetid: 75e45baf-51c5-400c-a31f-92bdab4ee492
title: Отображение данных о производительности
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 22d913474b794585dd557fae2b1fc232336b637d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105673811"
---
# <a name="displaying-performance-data"></a>Отображение данных о производительности

Большинству счетчиков требуется два образца значений, чтобы вычислить отображаемое значение. Формула для каждого счетчика определяет, требуется ли для счетчика два образца. Список счетчиков и их формул см. в разделе Типы счетчиков [комплекта средств для развертывания Windows Server 2003](/previous-versions/windows/it-pro/windows-server-2003/cc776490(v=ws.10)).

[Сбор данных о производительности](collecting-performance-data.md) показывает, как получить пример данных. После получения примеров вы обычно вызываете [**пдхжетформаттедкаунтервалуе**](/windows/desktop/api/Pdh/nf-pdh-pdhgetformattedcountervalue) для вычисления воспроизводимого значения.

Если необходимо масштабировать значение счетчика вверх или вниз для вывода значения, вызовите функцию [**пдхсеткаунтерскалефактор**](/windows/desktop/api/Pdh/nf-pdh-pdhsetcounterscalefactor) перед вызовом [**пдхжетформаттедкаунтервалуе**](/windows/desktop/api/Pdh/nf-pdh-pdhgetformattedcountervalue). Значения счетчиков могут масштабироваться по степени десять от-7 до 7.

Если путь к счетчику содержит символ-шаблон для имени экземпляра, вызовите [**пдхжетформаттедкаунтераррай**](/windows/desktop/api/Pdh/nf-pdh-pdhgetformattedcounterarraya) , чтобы получить массив отформатированных значений счетчиков для каждого собираемого экземпляра.

Для расчета отображаемого значения можно также использовать функции [**пдхкалкулатекаунтерфромраввалуе**](/windows/desktop/api/Pdh/nf-pdh-pdhcalculatecounterfromrawvalue) и [**пдхформатфромраввалуе**](/windows/desktop/api/Pdh/nf-pdh-pdhformatfromrawvalue) . Чтобы использовать эти функции, необходимо получить собранный пример после каждого вызова [**пдхколлекткуеридата**](/windows/desktop/api/Pdh/nf-pdh-pdhcollectquerydata) и сохранить пример самостоятельно. Чтобы получить пример, вызовите функцию [**пдхжетравкаунтервалуе**](/windows/desktop/api/Pdh/nf-pdh-pdhgetrawcountervalue) или [**пдхжетравкаунтераррай**](/windows/desktop/api/Pdh/nf-pdh-pdhgetrawcounterarraya) . Для значений счетчиков на основе времени вызовите [**пдхжеткаунтертимебасе**](/windows/desktop/api/Pdh/nf-pdh-pdhgetcountertimebase) перед **пдхформатфромраввалуе** , чтобы получить базовое время счетчика.

При выполнении вычислений с использованием необработанных данных всегда проверяйте элемент **кстатус** в структуре [**\_ \_ счетчика PDH RAW**](/windows/desktop/api/Pdh/ns-pdh-pdh_raw_counter) перед использованием примера. Пример недопустим, если значение **кстатус** не является PDH \_ кстатус \_ новые \_ данные или \_ \_ допустимые данные PDH кстатус \_ .

## <a name="displaying-statistics-for-a-counter"></a>Отображение статистики для счетчика

Если необходимо вычислить минимальное, максимальное и среднее значение счетчика, вызовите функцию [**пдхкомпутекаунтерстатистикс**](/windows/desktop/api/Pdh/nf-pdh-pdhcomputecounterstatistics) . При сборе образцов Храните [**\_ необработанные структуры \_ счетчиков PDH**](/windows/desktop/api/Pdh/ns-pdh-pdh_raw_counter) в массиве, который передается в **пдхкомпутекаунтерстатистикс**. Функция возвращает статистические значения в структуре [**\_ статистики PDH**](/windows/desktop/api/Pdh/ns-pdh-pdh_statistics) .

Эту функцию также можно использовать для сжатия файла журнала. Например, прочитайте десять записей из файла журнала, вызовите [**пдхкомпутекаунтерстатистикс**](/windows/desktop/api/Pdh/nf-pdh-pdhcomputecounterstatistics) , чтобы вычислить среднее значение, а затем записать среднее значение в выходной файл журнала.

 

 
