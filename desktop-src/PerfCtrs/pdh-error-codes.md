---
description: Все функции модуля поддержки данных о производительности (PDH) возвращают значение типа PDH \_ .
ms.assetid: ea67d798-81db-44ad-b0fb-24e0c3be7388
title: Коды ошибок вспомогательного приложения для получения данных о производительности
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f0417801b4f7a23e48a74201aa48193987a0edee
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105663222"
---
# <a name="performance-data-helper-error-codes"></a>Коды ошибок вспомогательного приложения для получения данных о производительности

Все функции модуля поддержки данных **\_ о** производительности (PDH) возвращают значение типа PDH. Если функция выполнена, возвращается значение `ERROR_SUCCESS` . В противном случае функция возвращает [код системной ошибки](/windows/desktop/Debug/system-error-codes) или код ошибки PDH. Чтобы получить текст описания ошибки в приложении, используйте функцию [**FormatMessage**](/windows/desktop/api/winbase/nf-winbase-formatmessage) , как показано в следующем примере.

```C++
#include <windows.h>
#include <stdio.h>
#include <pdhmsg.h>

void main(void)
{
    HANDLE hPdhLibrary = NULL;
    LPWSTR pMessage = NULL;
    DWORD_PTR pArgs[] = { (DWORD_PTR)L"<collectionname>" };
    DWORD dwErrorCode = PDH_PLA_ERROR_ALREADY_EXISTS;

    hPdhLibrary = LoadLibrary(L"pdh.dll");
    if (NULL == hPdhLibrary)
    {
        wprintf(L"LoadLibrary failed with %lu\n", GetLastError());
        return;
    }

    if (!FormatMessage(FORMAT_MESSAGE_FROM_HMODULE
                       FORMAT_MESSAGE_ALLOCATE_BUFFER
                       FORMAT_MESSAGE_IGNORE_INSERTS,
                       hPdhLibrary,
                       dwErrorCode,
                       0,
                       (LPWSTR)&pMessage,
                       0,
                       NULL))
    {
        wprintf(L"Format message failed with 0x%x\n", GetLastError());
        return;
    }

    wprintf(L"Formatted message: %ls\n", pMessage);
    LocalFree(pMessage);
}
```

Для функций сбора и форматирования данных важно помнить, что возвращаемое значение функции указывает на успешность или ошибку вызова функции, а не обязательно для данных счетчика. Всегда проверяйте возвращаемый элемент **кстатус** в значении счетчика, чтобы убедиться, что возвращаемые данные являются допустимыми, прежде чем использовать их. Если значение элемента **кстатус** не указывает на успешное выполнение, не используйте данные.

В следующей таблице приведен список кодов ошибок, характерных для PDH. Эти значения определены в `pdhmsg.h` файле заголовка.

| Код ошибки                                                   | Описание
|--------------------------------------------------------------|------------
| 0x00000000 ( \_ \_ допустимые данные кстатус PDH \_ )                       | Возвращенные данные являются допустимыми.
| 0x00000001 (PDH \_ кстатус \_ New \_ Data)                         | Возвращаемое значение данных является допустимым и отличается от последней выборки.
| 0x800007D0 (PDH \_ кстатус \_ без \_ компьютера)                       | Не удалось подключиться к указанному компьютеру, или компьютер находится в автономном режиме.
| 0x800007D1 (PDH \_ кстатус \_ без \_ экземпляра)                      | Указанный экземпляр отсутствует.
| 0x800007D2 ( \_ Дополнительные \_ данные PDH)                                 | Больше данных для возврата, чем поместится в указанном буфере. Выделите буфер большего размера и снова вызовите функцию.
| 0x800007D3 ( \_ элемент PDH \_ кстатус \_ не \_ проверен)              | Элемент данных был добавлен в запрос, но не был проверен или недоступен. Другие сведения о состоянии этого элемента данных недоступны.
| 0x800007D4 ( \_ Повтор PDH)                                      | Необходимо повторить выбранную операцию.
| 0x800007D5 (PDH \_ No \_ Data)                                   | Нет данных для возврата.
| 0x800007D6 ( \_ \_ отрицательный знаменатель PDH Calc \_ )                | Обнаружен счетчик с отрицательным знаменателем.
| 0x800007D7 ( \_ Вычисление \_ негативного значения PDH Calc \_ )                   | Обнаружен счетчик с отрицательным базовым значением времени.
| 0x800007D8 ( \_ \_ отрицательное значение PDH Calc \_ )                      | Обнаружен счетчик с отрицательным значением.
| 0x800007D9 ( \_ диалоговое окно PDH \_ отменено)                          | Пользователь отменил это диалоговое окно.
| 0x800007DA (истечение PDH \_ \_ \_ \_ файла журнала)                         | Достигнут конец файла журнала.
| 0x800007DB ( \_ \_ время ожидания асинхронного запроса PDH \_ )                      | Истекло время ожидания завершения потока асинхронной коллекции счетчиков.
| 0x800007DC (PDH \_ не \_ может \_ установить \_ источник данных реального времени по умолчанию \_ ) | Невозможно изменить установленный по умолчанию источник данных в режиме реального времени. Существуют сеансы запросов, собирающие данные счетчиков в режиме реального времени.
| 0xC0000BB8 (PDH \_ кстатус \_ No \_ Object)                        | Указанный объект не найден в системе.
| 0xC0000BB9 (PDH \_ кстатус \_ без \_ счетчика)                       | Не удалось найти указанный счетчик.
| 0xC0000BBA ( \_ \_ недопустимые \_ данные PDH кстатус)                     | Возвращены недопустимые данные.
| 0xC0000BBB ( \_ \_ сбой выделения памяти PDH \_ )                | Функции PDH не удалось выделить достаточно временного объема памяти для завершения операции. Закройте некоторые приложения или Расширьте файл подкачки и повторите функцию.
| 0xC0000BBC ( \_ Недопустимый \_ маркер PDH)                            | Этот маркер не является допустимым объектом PDH.
| 0xC0000BBD ( \_ Недопустимый \_ аргумент PDH)                          | Обязательный аргумент отсутствует или неверен.
| 0xC0000BBE ( \_ функция PDH \_ не \_ найдена)                       | Не удается найти указанную функцию.
| 0xC0000BBF (PDH \_ кстатус \_ No \_ COUNTERNAME)                   | Счетчик не указан.
| 0xC0000BC0 (PDH \_ кстатус \_ Bad \_ COUNTERNAME)                  | Не удалось проанализировать путь счетчика. Проверьте формат и синтаксис указанного пути.
| 0xC0000BC1 ( \_ Недопустимый \_ буфер PDH)                            | Недопустимый буфер, переданный вызывающим объектом.
| 0xC0000BC2 ( \_ недостаточный \_ Размер PDH)                       | Запрошенные данные больше, чем указанный буфер. Не удалось вернуть запрошенные данные.
| 0xC0000BC3 (PDH \_ не удается \_ подключить \_ компьютер)                   | Не удалось подключиться к запрошенному компьютеру.
| 0xC0000BC4 ( \_ Недопустимый \_ путь PDH)                              | Не удалось интерпретировать указанный путь счетчика.
| 0xC0000BC5 ( \_ Недопустимый \_ экземпляр PDH)                          | Не удалось прочитать имя экземпляра по указанному пути счетчика.
| 0xC0000BC6 ( \_ недопустимые \_ данные PDH)                              | Недопустимые данные.
| 0xC0000BC7 ( \_ \_ данные диалогового окна PDH отсутствуют \_ )                           | Блок данных диалогового окна отсутствует или является недопустимым.
| 0xC0000BC8 (PDH \_ не \_ может \_ считывать \_ строки имен)                | Не удается прочитать счетчик и (или) текст справки с указанного компьютера.
| 0xC0000BC9 ( \_ \_ \_ Ошибка при создании файла журнала PDH \_ )                   | Не удалось создать указанный файл журнала.
| 0xC0000BCA ( \_ \_ \_ Ошибка при открытии файла журнала PDH \_ )                     | Не удалось открыть указанный файл журнала.
| 0xC0000BCB ( \_ тип журнала \_ PDH \_ не \_ найден)                      | Указанный тип файла журнала не установлен в этой системе.
| 0xC0000BCC (PDH \_ больше \_ \_ данных)                             | Больше нет доступных данных.
| 0xC0000BCD ( \_ запись PDH \_ не \_ в \_ \_ файле журнала)                  | Указанная запись не найдена в файле журнала.
| 0xC0000BCE ( \_ источник данных \_ PDH \_ — \_ \_ файл журнала)                | Указанный источник данных является файлом журнала.
| 0xC0000BCF ( \_ источник данных PDH в \_ \_ \_ режиме реального \_ времени)               | Указанный источник данных является текущим действием.
| 0xC0000BD0 (PDH \_ не \_ удается \_ прочитать \_ заголовок журнала)                  | Не удалось прочитать заголовок файла журнала.
| 0xC0000BD1 ( \_ файл PDH \_ не \_ найден)                           | Не удалось найти указанный файл.
| 0xC0000BD2 ( \_ файл PDH \_ уже \_ существует)                      | Уже существует файл с указанным именем.
| 0xC0000BD3 (PDH \_ не \_ реализован)                           | Функция, на которую указывает ссылка, не реализована.
| 0xC0000BD4 ( \_ строка PDH \_ не \_ найдена)                         | Не удалось найти указанную строку в списке имен производительности и текстовых строк справки.
| 0x80000BD5 (PDH \_ не \_ удается \_ отобразить \_ файлы имен)                   | Не удалось выполнить сопоставление с именами данных счетчика производительности. Данные будут считываться из реестра и сохранены локально.
| 0xC0000BD6 ( \_ неизвестный \_ Формат журнала PDH \_ )                       | Библиотека PDH DLL не распознает формат указанного файла журнала.
| 0xC0000BD7 ( \_ команда PDH Unknown \_ логсвк \_ )                   | Указанное значение команды службы журналов не распознано.
| 0xC0000BD8 ( \_ запрос PDH \_ логсвк \_ не \_ найден)                  | Указанный запрос от службы журналов не найден или не может быть открыт.
| 0xC0000BD9 (PDH \_ логсвк \_ не \_ открыт)                        | Не удалось открыть ключ службы журнала данных производительности. Это может быть вызвано недостаточными привилегиями или отсутствием установленной службы.
| 0xC0000BDA ( \_ Ошибка PDH WBEM \_ )                                | Произошла ошибка при доступе к хранилищу данных WBEM.
| 0xC0000BDB ( \_ нет доступа к PDH \_ )                             | Не удалось получить доступ к нужному компьютеру или службе. Проверьте разрешения и проверку подлинности службы журнала или интерактивного сеанса пользователя для компьютеров или служб, которые отслеживаются.
| 0xC0000BDC ( \_ файл журнала \_ PDH \_ слишком \_ мал)                      | Указанный максимальный размер файла журнала слишком мал для записи выбранных счетчиков. В этом файле журнала данные записываться не будут. Укажите меньший набор счетчиков для записи или больший размер файла и повторите вызов.
| 0xC0000BDD ( \_ Недопустимый \_ источник данных PDH)                        | Не удается подключиться к источнику данных ODBC.
| 0xC0000BDE ( \_ Недопустимый PDH \_ sqldb)                             | База данных SQL не содержит допустимый набор таблиц для Perfmon.
| 0xC0000BDF (PDH \_ No \_ Counters)                               | Не найдены счетчики для этого набора журналов SQL Perfmon.
| 0xC0000BE0 ( \_ \_ сбой выделения PDH SQL \_ )                         | Сбой вызова SQLAllocStmt с %1.
| 0xC0000BE1 ( \_ сбой PDH SQL \_ аллоккон \_ )                      | Сбой вызова SQLAllocConnect с %1.
| 0xC0000BE2 ( \_ сбой PDH SQL \_ exec \_ Direct \_ )                  | Сбой вызова SQLExecDirect с %1.
| 0xC0000BE3 ( \_ \_ сбой при выборке из PDH SQL \_ )                         | Сбой вызова SQLFetch с %1.
| 0xC0000BE4 ( \_ сбой PDH SQL \_ ROWCOUNT \_ )                      | Сбой вызова SQLRowCount с %1.
| 0xC0000BE5 ( \_ \_ \_ не удалось выполнить дополнительные результаты PDH SQL \_ )                 | Сбой вызова SQLMoreResults с %1.
| 0xC0000BE6 ( \_ сбой PDH SQL \_ Connect \_ )                       | Сбой вызова SQLConnect с %1.
| 0xC0000BE7 ( \_ \_ сбой привязки PDH SQL \_ )                          | Сбой вызова SQLBindCol с %1.
| 0xC0000BE8 (PDH \_ не удается \_ подключиться к \_ \_ серверу WMI)               | Не удалось подключиться к серверу WMI на запрошенном компьютере.
| 0xC0000BE9 ( \_ \_ сбор "PDH \_ PLA \_ " уже запущен)          | Коллекция "%1! s!" уже работает.
| 0xC0000BEA ( \_ \_ \_ Перекрытие расписания ошибок PDH PLA \_ )              | Указанное время начала позже времени окончания.
| 0xC0000BEB ( \_ коллекция PDH \_ PLA \_ не \_ найдена)                | Коллекция "%1! s!" не существует.
| 0xC0000BEC ( \_ \_ прошло расписание ошибок PDH PLA \_ \_ )              | Указанное время окончания уже прошло.
| 0xC0000BED ( \_ Ошибка PDH PLA \_ при \_ запуске)                        | Коллекция "%1! s!" не запущено; Проверьте наличие ошибок в журнале событий приложений.
| 0xC0000BEE ( \_ Ошибка PDH \_ PLA \_ уже \_ существует)                | Коллекция "%1! s!" уже существует.
| 0xC0000BEF ( \_ \_ \_ несоответствие типа ошибки PDH PLA \_ )                 | Несоответствие типа параметров.
| 0xC0000BF0 ( \_ путь к \_ ошибке PDH PLA \_ )                       | Указанная информация не разрешается в допустимое имя пути.
| 0xC0000BF1 ( \_ \_ Ошибка службы PDH PLA \_ )                        | Служба "журналы производительности & оповещения" не ответила.
| 0xC0000BF2 ( \_ \_ Ошибка проверки PDH PLA \_ )                     | Переданы недопустимые сведения.
| 0x80000BF3 ( \_ \_ предупреждение проверки PDH PLA \_ )                   | Переданы недопустимые сведения.
| 0xC0000BF4 ( \_ \_ \_ \_ слишком длинное имя ошибки PDH PLA \_ )                | Указано слишком длинное имя.
| 0xC0000BF5 ( \_ Недопустимый \_ \_ Формат журнала SQL \_ "PDH")                  | Неверный формат журнала SQL. Правильный формат: `SQL:<DSN-name>!<LogSet-Name>` .
| 0xC0000BF6 ( \_ Счетчик PDH \_ уже \_ в \_ запросе)                | Счетчик производительности в вызове [**пдхаддкаунтер**](/windows/desktop/api/Pdh/nf-pdh-pdhaddcountera) уже добавлен в запрос производительности. Этот счетчик игнорируется.
| 0xC0000BF7 ( \_ двоичный \_ Журнал PDH \_ поврежден)                       | Не удается прочитать данные счетчика и данные из входных двоичных файлов журнала.
| 0xC0000BF8 ( \_ пример журнала \_ PDH \_ слишком \_ мал)                    | По крайней мере один из входных двоичных файлов журнала содержит менее двух выборок данных.
| 0xC0000BF9 ( \_ Операционная система PDH \_ более поздней \_ версии)                         | Версия операционной системы на компьютере с именем %1 позже, чем на локальном компьютере. Эта операция недоступна с локального компьютера.
| 0xC0000BFA ( \_ ОС с \_ более ранней \_ версией)                       | %1 поддерживает %2 или более позднюю версию. Проверьте версию операционной системы на компьютере с именем %3.
| 0xC0000BFB ( \_ неправильное \_ время добавления PDH \_ )                    | Выходной файл должен содержать данные более ранней версии, чем добавляемый файл.
| 0xC0000BFC ( \_ Счетчик НЕсопоставленных \_ добавлений PDH \_ )                 | Оба файла должны иметь одинаковые счетчики для добавления.
| 0xC0000BFD ( \_ \_ \_ сбой изменения детализации PDH SQL \_ )                 | Невозможно изменить макет таблицы Каунтердетаил в базе данных SQL.
| 0xC0000BFE ( \_ \_ \_ истекло время ожидания данных о производительности запросов PDH \_ )                 | Система занята. При сборе данных счетчика времени ожидания произошла ошибка. Повторите попытку позже или увеличьте значение реестра **коллекттиме** .
