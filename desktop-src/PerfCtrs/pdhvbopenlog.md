---
description: Функция Пдхвбопенлог открывает указанный файл журнала для чтения и записи. Эта функция вызывает Пдхопенлог.
ms.assetid: d9b8d98c-64f2-4319-8ab2-67b776143cf7
title: Функция Пдхвбопенлог
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- PdhVbOpenLog
api_type:
- DllExport
api_location:
- Pdh.dll
ms.openlocfilehash: 7921585039cab285589f2cdde0f328c033069a87
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104545511"
---
# <a name="pdhvbopenlog-function"></a>Функция Пдхвбопенлог

Функция **пдхвбопенлог** открывает указанный файл журнала для чтения и записи. Эта функция вызывает [**пдхопенлог**](/windows/desktop/api/Pdh/nf-pdh-pdhopenloga).

> [!IMPORTANT]
> Функция, описанная в этом разделе, может быть изменена или недоступна в будущем. Вместо этого корпорация Майкрософт рекомендует использовать функции, описанные в разделе [функции счетчиков производительности](performance-counters-functions.md).

Функция Пдхвбопенлог ( \_ ByVal Сзлогфиленаме AS LPCTSTR, \_ ByVal ДВАКЦЕССФЛАГС как DWORD, \_ BYVAL лпдвлогтипе AS Лпдворд, \_ ByVal хкуери как PDH \_ ХКУЕРИ, \_ ByVal Двмакссизе AS DWORD, \_ ByVal SZUSERCAPTION как LPCSTR, \_ ByRef phLog AS PDH \_ HLOG \_ ) как DWORD

## <a name="parameters"></a>Параметры

<dl> <dt>

*сзлогфиленаме* \[ окне\]
</dt> <dd>

Указатель на строку, указывающую имя открываемого файла журнала.

Если файл журнала содержит данные SQL, формат имени файла журнала — **SQL:**_источник_ данных *_!_* _LogFilename_. В этом случае значением параметра *лпдвлогтипе* является \_ тип журнала PDH \_ \_ SQL.

</dd> <dt>

*двакцессфлагс* \[ окне\]
</dt> <dd>

Тип доступа, который должен быть указан при открытии файла журнала. Этот параметр может принимать одно из указанных ниже значений.



| Значение                                                                                                                                                                                   | Значение                                                          |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------|
| <span id="PDH_LOG_READ_ACCESS"></span><span id="pdh_log_read_access"></span><dl> <dt>**\_доступ на \_ Чтение \_ журнала PDH**</dt> </dl>       | Файл журнала открыт для операции чтения.<br/>            |
| <span id="PDH_LOG_WRITE_ACCESS"></span><span id="pdh_log_write_access"></span><dl> <dt>**\_доступ на \_ запись в журнал PDH \_**</dt> </dl>    | Для операции записи открыт новый файл журнала.<br/>       |
| <span id="PDH_LOG_UPDATE_ACCESS"></span><span id="pdh_log_update_access"></span><dl> <dt>**\_доступ для \_ обновления \_ журнала PDH**</dt> </dl> | Для операции записи открыт существующий файл журнала.<br/> |



 

Значение, выбранное из предыдущей таблицы, может быть объединено с помощью оператора OR с одним из следующих флагов создания доступа.



| Значение                                                                                                                                                                                   | Значение                                                                                                                                                          |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="PDH_LOG_CREATE_NEW"></span><span id="pdh_log_create_new"></span><dl> <dt>**\_ \_ Создание нового журнала \_ PDH**</dt> </dl>          | Будет создан новый файл журнала с указанным именем.<br/>                                                                                                    |
| <span id="PDH_LOG_CREATE_ALWAYS"></span><span id="pdh_log_create_always"></span><dl> <dt>**\_ \_ всегда создавать журнал \_ PDH**</dt> </dl> | Создается новый файл журнала с указанным именем, а любой существующий файл журнала с тем же именем удаляется.<br/>                                             |
| <span id="PDH_LOG_OPEN_EXISTING"></span><span id="pdh_log_open_existing"></span><dl> <dt>**\_Журнал PDH \_ открыт \_ существующий**</dt> </dl> | Открывается существующий файл журнала с указанным именем. Если файл журнала с указанным именем не существует, это значение совпадает с параметром журнал PDH \_ \_ создать \_ новый.<br/> |
| <span id="PDH_LOG_OPEN_ALWAYS"></span><span id="pdh_log_open_always"></span><dl> <dt>**\_Журнал PDH \_ \_ всегда открыт**</dt> </dl>       | Открывается существующий файл журнала с указанным именем или создается новый файл журнала с указанным именем.<br/>                                          |



 

</dd> <dt>

*лпдвлогтипе* \[ окне\]
</dt> <dd>

Указатель на переменную, которая указывает тип открываемого файла журнала. Этот параметр может принимать одно из указанных ниже значений.



| Значение                                                                                                                                                                                      | Значение                                                                                                                 |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
| <span id="PDH_LOG_TYPE_UNDEFINED"></span><span id="pdh_log_type_undefined"></span><dl> <dt>**\_тип журнала PDH не \_ \_ определен**</dt> </dl> | Неопределенный формат файла журнала.<br/>                                                                                   |
| <span id="PDH_LOG_TYPE_CSV"></span><span id="pdh_log_type_csv"></span><dl> <dt>**\_тип журнала PDH ( \_ \_ CSV)**</dt> </dl>                   | Текстовые файлы, содержащие заголовки столбцов в первой строке, и отдельные образцы данных в каждой последующей строке.<br/> |
| <span id="PDH_LOG_TYPE_SQL"></span><span id="pdh_log_type_sql"></span><dl> <dt>**\_тип журнала \_ PDH \_ SQL**</dt> </dl>                   | Данные в файле журнала находятся в SQL.<br/>                                                                          |
| <span id="PDH_LOG_TYPE_TSV"></span><span id="pdh_log_type_tsv"></span><dl> <dt>**\_тип журнала \_ PDH \_ TSV**</dt> </dl>                   | То же, что и \_ Формат журнала PDH \_ \_ .<br/>                                                                                 |
| <span id="PDH_LOG_TYPE_BINARY"></span><span id="pdh_log_type_binary"></span><dl> <dt>**\_ \_ двоичный тип журнала PDH \_**</dt> </dl>          | Формат двоичного файла журнала. Содержит циклические файлы журналов.<br/>                                                         |
| <span id="PDH_LOG_TYPE_PERFMON"></span><span id="pdh_log_type_perfmon"></span><dl> <dt>**\_монитор для \_ типа \_ журнала PDH**</dt> </dl>       | Формат файла журнала Perfmon.<br/>                                                                                     |



 

</dd> <dt>

*хкуери* \[ окне\]
</dt> <dd>

Обработчик запроса. Этот маркер возвращается функцией [**пдхвбопенкуери**](pdhvbopenquery.md) .

Этот параметр может иметь **значение NULL** , если файл журнала должен быть открыт для чтения.

</dd> <dt>

*двмакссизе* \[ окне\]
</dt> <dd>

Максимальный размер файла журнала в байтах. Это значение используется только в том случае, если файл журнала имеет ограниченный размер или циклический файл журнала.

</dd> <dt>

*сзусеркаптион* \[ окне\]
</dt> <dd>

Указатель на строку, которая указывает заданный пользователем заголовок файла журнала. Заголовок файла журнала обычно описывает содержимое файла журнала. При открытии существующего файла журнала значение этого параметра игнорируется.

</dd> <dt>

*флог* \[ в, ссылка\]
</dt> <dd>

Указатель на буфер, который получает маркер открытого файла журнала.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Если функция завершается с ошибкой, она возвращает 0.

Если функция завершается ошибкой, возвращаемое значение является [кодом системной ошибки](/windows/desktop/Debug/system-error-codes) или [кодом ошибки PDH](pdh-error-codes.md). Ниже приведены возможные значения.



| Код возврата                                                                                                | Описание                                                                                            |
|------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------|
| <dl> <dt>**\_недостаточный \_ Размер буфера PDH**</dt> </dl>   | Запрошенные данные больше, чем указанный буфер. Не удалось вернуть запрошенные данные.<br/> |
| <dl> <dt>**\_Недопустимый \_ аргумент PDH**</dt> </dl>      | Один или несколько буферов строк имеют неправильный размер.<br/>                                  |
| <dl> <dt>**\_Недопустимый \_ маркер PDH**</dt> </dl>        | Этот маркер не является допустимым объектом PDH.<br/>                                                       |
| <dl> <dt>**\_ \_ \_ Ошибка при открытии файла журнала PDH \_**</dt> </dl> | Не удалось открыть указанный файл журнала.<br/>                                                      |
| <dl> <dt>**\_файл PDH \_ не \_ найден**</dt> </dl>       | Не удалось найти указанный файл.<br/>                                                          |



 

## <a name="remarks"></a>Комментарии

При использовании этой функции для записи данных о производительности в файл журнала сначала необходимо открыть запрос с помощью [**пдхвбопенкуери**](pdhvbopenquery.md).

В настоящий момент должен быть открытый запрос, и перед вызовом этой функции необходимо добавить в него нужные счетчики.

Обратите внимание, что файлы журнала в формате PerfMon можно открывать только для чтения.

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Только для \[ классических приложений Windows XP\]<br/>                                        |
| Минимальная версия сервера<br/> | \[Только для настольных приложений Windows Server 2003\]<br/>                               |
| Библиотека<br/>                  | <dl> <dt>PDH. lib</dt> </dl> |
| DLL<br/>                      | <dl> <dt>Pdh.dll</dt> </dl> |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**пдхопенлог**](/windows/desktop/api/Pdh/nf-pdh-pdhopenloga)
</dt> <dt>

[**пдхвбжетлогфилесизе**](pdhvbgetlogfilesize.md)
</dt> <dt>

[**пдхвбупдателог**](pdhvbupdatelog.md)
</dt> </dl>

 

