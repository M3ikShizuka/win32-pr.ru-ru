---
description: После получения запроса от сервера клиент создает ответ на запрос дайджеста, вызывая функцию InitializeSecurityContext (Digest).
ms.assetid: b26b5676-a614-4017-a4e5-a5395292a667
title: Создание ответа на запрос дайджеста
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8b577334348745425db23d3de41431ba4e37b7af
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127271400"
---
# <a name="generating-the-digest-challenge-response"></a>Создание ответа на запрос дайджеста

После получения запроса от сервера клиент создает ответ на запрос дайджеста, вызывая функцию [**InitializeSecurityContext (Digest)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) . Эта функция создает отпечаток [*ХЭША*](/windows/desktop/SecGloss/h-gly) MD5, используя сведения о запрошенном ресурсе и данных из запроса, и выводит маркер безопасности, который представляет [*контекст*](/windows/desktop/SecGloss/s-gly)частичной безопасности. Для завершения проверки подлинности клиент должен вернуть маркер серверу, который выдал запрос.

В следующей таблице описаны параметры [*функции*](/windows/desktop/SecGloss/c-gly) [**InitializeSecurityContext (Digest)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) и значения, которые необходимо указать при формировании ответа на запрос дайджеста.



| Параметр                  | Описание                                                                                                                                                                                               |
|----------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| *фконтекстрек*<br/>   | Атрибуты контекста безопасности, запрашиваемые клиентом. Дополнительные сведения см. в разделе Требования к контексту ответа дайджест-запроса.<br/>                                                             |
| *псзтаржетнаме*<br/> | HTTP: строка с завершающим нулем, указывающая целевой URL-адрес.<br/> SASL: строка с завершающим нулем, указывающая целевой объект DNS/SPN.<br/>                                                         |
| *пинпут*<br/>        | Буферы, содержащие сведения, необходимые для дайджест-поставщика общих служб. Дополнительные сведения см. [в разделе Входные буферы для ответа на запрос дайджеста](input-buffers-for-the-digest-challenge-response.md).<br/> |
| *пфконтекстаттр*<br/> | Получает атрибуты, поддерживаемые возвращенным контекстом безопасности. Дополнительные сведения см. в разделе Требования к контексту ответа дайджест-запроса.<br/>                                                  |
| *паутпут*<br/>       | Адрес \_ буфера типа токена pvbuffer, который получает маркер безопасности для отправки обратно на сервер.<br/>                                                                                           |



 

## <a name="digest-challenge-response-context-requirements"></a>Требования к контексту ответа дайджест-запроса

Требования к контексту — это флаги, которые определяют:

-   Определяет, функционируют ли Microsoft Digest как механизм SASL или протокол проверки подлинности HTTP.
-   Качество защиты, поддерживаемое [*контекстом безопасности*](/windows/desktop/SecGloss/s-gly) , совместно используемым клиентом и сервером.

По умолчанию Microsoft Digest функционирует как механизм SASL.

Требования к контексту указываются как флаги, передаваемые в параметр *фконтекстрек* функции [**InitializeSecurityContext**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) . Флаги влияют на качество защиты контекста безопасности, управляя директивой КОП в ответе на запрос.

По умолчанию директива КОП имеет значение "auth". Чтобы создать ответ на запрос, который устанавливает для КОП значение "auth-int", необходимо следующее:

1.  Для запроса дайджеста должна быть задана директива КОП с параметром "auth-int".
2.  Клиент должен указать один или несколько из следующих флагов:

    -   \_ \_ целостность требований ISC
    -   \_ \_ обнаружение воспроизведения на наличие заявок на ISC \_
    -   \_ \_ Обнаружение последовательности заявок \_ ISC

Только для SASL: создание ответа на запрос с директивой КОП, для которого задано значение "auth-conf", с указанием \_ \_ флага конфиденциальности ISC. Поскольку этот флаг не является допустимым для проверки подлинности HTTP, он не может использоваться с \_ \_ флагом HTTP ISC.

## <a name="verifying-the-quality-of-protection"></a>Проверка качества защиты

Клиент должен проверить флаги атрибутов контекста безопасности, возвращаемые в параметре *пфконтекстаттр* функции [**InitializeSecurityContext**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) . Клиент должен отправить ответ на запрос серверу только в том случае, если качество защиты, обозначенное флагами, достаточно для целей. Соответствующие флаги могут быть любым сочетанием следующих.

-   \_ \_ целостность возврата ISC
-   Обнаружение повторного \_ воспроизведения ISC RET \_ \_
-   \_ \_ Обнаружение последовательности возврата \_ ISC
-   \_Конфиденциальность возврата ISC \_ (только для контекстов SASL)

Дополнительные сведения об директиве КОП см. в разделе [качество защиты и шифров](quality-of-protection-and-ciphers.md).

Дополнительные сведения об директивах ответа на запрос см. [в разделе содержимое ответа на запрос дайджеста](contents-of-a-digest-challenge-response.md).

 

