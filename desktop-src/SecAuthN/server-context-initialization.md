---
description: Как и клиент, сервер также получает маркер учетных данных, готовый к ответу на входящий запрос проверки подлинности от клиента.
ms.assetid: 2a0aeadf-e099-4264-8522-e498f437bf75
title: Инициализация контекста сервера
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a6d4a81c8033dc6b5dda8baca9ee7dfcc87d2b14c1cd139ff4a7f8eda99603f4
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118918333"
---
# <a name="server-context-initialization"></a>Инициализация контекста сервера

Как и клиент, сервер также получает маркер [*учетных данных*](../secgloss/c-gly.md) , готовый к ответу на входящий запрос проверки подлинности от клиента. Учетные данные сервера используются для проверки подлинности сервера для клиента в [*протоколах безопасности*](../secgloss/s-gly.md) , поддерживающих проверку подлинности сервера или взаимную проверку подлинности. Сервер получает маркер для своих учетных данных, определенных учетной записью службы, используемой для запуска сервера. Для этого вызывается [**AcquireCredentialsHandle**](/windows/win32/api/sspi/nf-sspi-acquirecredentialshandlea).

Сервер может получить свой обработчик учетных данных, а затем переключиться в состояние прослушивания или подождать в состоянии прослушивания до тех пор, пока не будет получен запрос на подключение и не получится обработчик входящих учетных данных. Дополнительные сведения о функциях учетных данных см. в разделе [Управление учетными](authentication-functions.md)данными.

Когда сервер получает сообщение запроса на подключение от клиента, он создает локальный [*контекст безопасности*](../secgloss/s-gly.md) для клиента с помощью [**AcceptSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext). Сервер использует этот локальный контекст безопасности для выполнения будущих запросов тем же клиентом. Дополнительные сведения о контекстных функциях см. в разделе [Управление контекстами](authentication-functions.md).

Сервер проверяет состояние возврата и дескриптор буфера вывода, чтобы убедиться в отсутствии ошибок, и может отклонить запрос на соединение в случае возникновения ошибок. Если в выходном буфере, возвращенном функцией [**AcceptSecurityContext (Общие)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext), содержится информация, она объединяет этот буфер в ответное сообщение клиенту.

Любой выходной буфер из [**AcceptSecurityContext (Общие)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) должен быть отправлен обратно клиенту. Кроме того, если для состояния возврата требуется, чтобы протокол продолжал работу (в СЕКУНДах, когда это \_ \_ \_ необходимо, или же \_ я \_ завершил работу \_ и \_ Продолжить), требуется еще один обмен сообщениями с клиентом.

Для дополнительных отрезков сервер ожидает ответа клиента с помощью другого сообщения. Это время ожидания может быть истекло, чтобы избежать атаки типа "отказ в обслуживании", когда клиент намеренно не отвечает, что вызывает серверный поток и скоро все потоки сервера перестают отвечать на запросы.

 

 
