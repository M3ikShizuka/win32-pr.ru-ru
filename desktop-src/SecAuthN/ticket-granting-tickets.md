---
description: По мере первоначальной разработки протокола Kerberos главный ключ пользователя был получен на основе пароля, предоставленного пользователем.
ms.assetid: b8fcb68d-751e-4495-ab92-8b70c96aaa7a
title: Ticket-Grantingные билеты
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 39dff161ba2d905f676fe6b6b5e7e7d5289ee550
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127146554"
---
# <a name="ticket-granting-tickets"></a>Ticket-Grantingные билеты

По мере первоначальной разработки [*протокола Kerberos*](../secgloss/k-gly.md) главный ключ пользователя был получен на основе пароля, предоставленного пользователем. Когда пользователь вошел в систему, клиент Kerberos на рабочей станции пользователя принимает пароль от пользователя и преобразует его в ключ шифрования путем передачи текста с помощью односторонней [*хэш-*](../secgloss/h-gly.md) функции. Полученный хэш-код был [*главным ключом*](../secgloss/m-gly.md)пользователя. Клиент использовал этот *главный ключ* для расшифровки [*ключей сеанса*](../secgloss/s-gly.md) , полученных от KDC.

Проблема с первоначальным проектированием Kerberos заключается в том, что клиенту требуется главный ключ пользователя каждый раз при расшифровке ключа сеанса из центра распространения ключей. Это означает, что клиент должен попросить пользователя указать пароль в начале каждого обмена клиента и сервера, либо клиент должен сохранить ключ пользователя на рабочей станции. Частое прерывание работы пользователя слишком агрессивно. Хранение ключа на рабочей станции вызывает риск компрометации ключа, полученного на основе пароля пользователя, который является долгосрочным ключом.

Решение этой проблемы в протоколе Kerberos заключается в том, что клиент получает временный ключ из центра распространения ключей. Этот временный ключ подходит только для этого [*сеанса входа в систему*](../secgloss/l-gly.md). Когда пользователь входит в систему, клиент запрашивает билет для KDC так же, как он запрашивает билет для любой другой службы. KDC реагирует на создание ключа сеанса входа и билета для специального сервера, полной службы предоставления билетов KDC. Одна копия ключа сеанса входа внедряется в билет, а билет шифруется с помощью главного ключа KDC. Еще одна копия ключа сеанса входа шифруется с помощью главного ключа пользователя, полученного из пароля входа пользователя. Как билет, так и зашифрованный ключ сеанса отправляются клиенту.

Когда клиент получает ответ KDC, он расшифровывает ключ сеанса входа с помощью главного ключа пользователя, полученного из пароля пользователя. Клиенту больше не требуется ключ, полученный из пароля пользователя, так как клиент теперь будет использовать ключ сеанса входа для расшифровки его копии любого ключа сеанса сервера, получаемого из центра распространения ключей. Клиент сохраняет ключ сеанса входа в кэш билетов и его билет для полной службы предоставления билетов KDC.

Билет для полной службы предоставления билетов называется билет предоставления билета (TGT). Когда клиент запрашивает у центра распространения ключей запрос на получение билета к серверу, он предоставляет [*учетные данные*](../secgloss/c-gly.md) в виде сообщения средства проверки подлинности и билета — в данном случае TGT — так же, как и учетные данные для любой другой службы. Служба предоставления билетов открывает TGT с главным ключом, извлекает ключ сеанса входа для этого клиента и использует ключ сеанса входа для шифрования клиентской версии ключа сеанса для сервера.

 

 
