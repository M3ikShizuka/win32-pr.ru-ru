---
description: Некоторые функции поставщика сети принимают адрес и размер буфера, в который функция помещает структуру данных с переменным размером.
ms.assetid: 0029a04d-6cf2-40e1-ae1d-4c349a379ad7
title: Обработка буферизованных данных
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 63e123fc1ccccae6120b6db1c9ada554acc5b02a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104265814"
---
# <a name="handling-buffered-data"></a>Обработка буферизованных данных

Некоторые функции поставщика сети принимают адрес и размер буфера, в который функция помещает структуру данных с переменным размером.

В каждом случае используется один и тот же механизм. Вызывающий объект выделяет буфер и передает его адрес в функцию. Он также передает адрес **DWORD** , указывающий размер буфера в байтах.

Затем функция копирует как часть запрашиваемой структуры данных, так как она может находиться в буфере. Если все данные умещаются в буфер, функция возвращает WN \_ Success. Если данные не помещаются в буфер, данные могут остаться неполными, а функция устанавливает \_ ошибку WN more \_ Data. В любом случае **параметр DWORD** , указывающий размер буфера, устанавливается равным числу байтов, фактически необходимых для структуры данных. Таким образом, если переданный буфер был слишком мал и функция завершилась ошибкой, вызывающий объект может выделить новый буфер требуемого размера и вызвать функцию еще раз.

Когда возвращаемые структуры данных содержат строки переменной длины, отдельные структуры данных обычно содержат указатели на эти строки. Сами строки также должны размещаться в буфере. Однако важно поместить их в конец буфера. В противном случае они будут выполнять индексирование до n структуры. Иными словами, все структуры располагаются последовательно в начале буфера. Указатели на строки или данные переменной длины должны быть фактическими указателями, а не смещениями в буфере.

Если буфер используется для передачи и возврата данных, состоящих только из строк, **параметр DWORD** , указывающий размер буфера, должен быть установлен в общее число символов, которое будет помещаться в эти строки, а не на число байтов.

 

 



