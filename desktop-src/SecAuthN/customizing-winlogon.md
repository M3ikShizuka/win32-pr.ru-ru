---
description: Настройка поведения Winlogon путем реализации поставщика учетных данных.
ms.assetid: 70b47e29-c755-4c59-a493-d7fcbbc94b83
title: Настройка Winlogon
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a10b2ae1e029bb741a2402a25d8e51f331fdd1cac1e9918dfef3b35b36c8e6d4
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119008662"
---
# <a name="customizing-winlogon"></a>Настройка Winlogon

Настройка поведения [*Winlogon*](/windows/desktop/SecGloss/w-gly) путем реализации поставщика учетных данных. Дополнительные сведения о поставщиках учетных данных см. в разделе [**интерфейс икредентиалпровидер**](/windows/win32/api/credentialprovider/nn-credentialprovider-icredentialprovider).

**Windows Server 2003 и Windows XP:** Поставщики учетных данных не поддерживаются.

в следующих разделах описаны способы настройки Winlogon в Windows версиях до Windows Vista.

> [!Note]  
> библиотеки dll GINA и пакеты уведомлений Winlogon игнорируются в Windows Vista.

 

-   [Пакеты уведомлений Winlogon](#winlogon-notification-packages)
-   [Заглушки GINA](#gina-stubs)
-   [Перехватчики GINA](#gina-hooks)

## <a name="winlogon-notification-packages"></a>Пакеты уведомлений Winlogon

Пакет уведомлений Winlogon — это библиотека DLL, которая экспортирует функции, которые обрабатывали события Winlogon. Например, когда пользователь входит в систему, Winlogon вызывает каждый пакет уведомлений, чтобы предоставить сведения о событии. Дополнительные сведения см. в разделе [пакеты уведомлений Winlogon](winlogon-notification-packages.md).

## <a name="gina-stubs"></a>Заглушки GINA

Заглушка [*GINA*](/windows/desktop/SecGloss/g-gly) — это ПОЛЬЗОВАТЕЛЬСКАЯ библиотека GINA, которая использует реализации функции экспорта ранее установленной библиотеки GINA DLL (обычно MsGina.dll). Заглушка GINA получает указатели на каждую функцию, экспортируемую ранее установленной DLL-библиотекой GINA. Каждая функция-заглушка GINA затем использует соответствующий указатель на функцию для вызова соответствующей функции в ранее установленной библиотеке DLL GINA.

> [!IMPORTANT]
> Каждая функция-заглушка GINA должна вызывать соответствующую функцию в ранее установленной модели GINA.

 

Функция-заглушка GINA может реализовать дополнительные функциональные возможности в одной или нескольких функциях экспорта. Например, функция [**влкслогжедаутсас**](/windows/desktop/api/Winwlx/nf-winwlx-wlxloggedoutsas) заглушки GINA может проверить текущее время перед вызовом функции **влкслогжедаутсас** MsGina.dll. Если текущее время находилось в определенном диапазоне, функция-заглушка может отобразить сообщение о том, что вход в систему не разрешен в течение этого периода времени, и вернуть **влкс \_ SAS \_ Action \_ None** в Winlogon. Функция **влкслогжедаутсас** MsGina.dll будет вызываться только в течение допустимого периода времени.

Приложение-заглушка GINA получает таблицу диспетчеризации для функций поддержки Winlogon с помощью параметра *пвинлогонфунктионс* функции [**влксинитиализе**](/windows/desktop/api/Winwlx/nf-winwlx-wlxinitialize) . Приложение-заглушка GINA может использовать эту таблицу диспетчеризации для вызова функций поддержки Winlogon. Например, приложение-заглушка GINA может вызвать функцию [**влкссаснотифи**](/windows/win32/api/winwlx/nc-winwlx-pwlx_sas_notify) , чтобы вызвать событие [*последовательности безопасности*](/windows/desktop/SecGloss/s-gly) (SAS) при вставке [*смарт-карты*](/windows/desktop/SecGloss/s-gly) в [*средство чтения*](/windows/desktop/SecGloss/r-gly).

Дополнительные сведения о создании заглушек GINA см. в образце заглушек GINA в \\ каталоге Samples \\ Security \\ GINA \\ Гинастуб (пакет средств разработки программного обеспечения для платформы).

> [!Note]  
> Все вызовы между GINA и Winlogon должны находиться в одном потоке.

 

## <a name="gina-hooks"></a>Перехватчики GINA

Ловушка GINA — это заглушка GINA, которая в своей реализации функции [**влксинитиализе**](/windows/desktop/api/Winwlx/nf-winwlx-wlxinitialize) заменяет указатель на функцию поддержки [**влксдиалогбокспарам**](/windows/win32/api/winwlx/nc-winwlx-pwlx_dialog_box_param) в таблице диспетчеризации указателем на собственную реализацию функции **влксдиалогбокспарам** . В результате каждый раз, когда ранее установленная GINA (обычно MsGina.dll) вызывает функцию **влксдиалогбокспарам** , вызывается функция, реализованная обработчиком GINA.

Функция [**влксдиалогбокспарам**](/windows/win32/api/winwlx/nc-winwlx-pwlx_dialog_box_param) , реализованная с помощью ловушки GINA, может заменить процедуру обратного вызова [**DialogProc**](/windows/win32/api/winuser/nc-winuser-dlgproc) , которая реагирует на определенное событие диалогового окна.

Это дает обработчику GINA полный контроль над внешним видом и поведением всех диалоговых окон, создаваемых MsGina.dll.

Дополнительные сведения о создании ловушки GINA см. в образце ловушек GINA в \\ каталоге Samples \\ Security \\ GINA \\ Гинахук в установке пакета Platform SDK.

> [!Note]  
> Все вызовы между GINA и Winlogon должны находиться в одном потоке.

 

 

 
