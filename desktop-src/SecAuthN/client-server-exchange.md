---
description: Обмен данными между клиентом и сервером
ms.assetid: 2449c4b3-720d-4b84-b3cf-fcc4abd05d33
title: Обмен данными между клиентом и сервером
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6274705ef6719c846f0551f90fca8790ba89f2e7
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104155906"
---
# <a name="clientserver-exchange"></a>Обмен данными между клиентом и сервером

После того как пользователь получил билет на сервер, клиент рабочей станции может установить безопасный сеанс связи с этим сервером.

**Установка безопасного сеанса связи с сервером**

1.  Клиент отправляет серверу сообщение типа КРБ \_ AP \_ req (запрос приложения Kerberos). Это сообщение содержит сообщение средства проверки подлинности, зашифрованное с помощью ключа, отправленного [*центр распространения ключей*](/windows/desktop/SecGloss/k-gly) (KDC) для сеанса с сервером, билет для сеансов с сервером и флаг, указывающий, запрашивает ли клиент взаимную проверку подлинности. Установка флага, запрашивающего взаимную проверку подлинности, — один из вариантов настройки [*Kerberos*](/windows/desktop/SecGloss/k-gly). Пользователь никогда не запрашивает, следует ли использовать взаимную проверку подлинности.
2.  Сервер получает КРБ \_ AP \_ , расшифровывает билет и извлекает данные авторизации пользователя и [*ключ сеанса*](/windows/desktop/SecGloss/s-gly).
3.  Сервер использует ключ сеанса из билета для расшифровки сообщения средства проверки подлинности пользователя и вычисляет метку времени в.
4.  Если сообщение проверки подлинности является допустимым, сервер проверяет флаг взаимной проверки подлинности в запросе клиента.
5.  Если установлен флаг взаимной проверки подлинности, то сервер использует сеансовый ключ для шифрования времени из сообщения проверки подлинности пользователя и возвращает результат в сообщении типа КРБ \_ AP \_ (ответ приложения Kerberos).
6.  Когда клиент получает КРБ \_ AP \_ , он расшифровывает сообщение проверки подлинности сервера с помощью ключа сеанса, который используется совместно с сервером, и сравнивает время, отправленное службой, со временем исходного сообщения средства проверки подлинности. Если они совпадают, Клиент гарантирует, что служба является подлинной, и подключение будет продолжено.

 

 
