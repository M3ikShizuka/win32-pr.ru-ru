---
description: поставщик сети — это библиотека DLL, которая позволяет операционной системе Windows поддерживать конкретный сетевой протокол.
ms.assetid: 21dfa941-72fd-4f2c-8bc4-379ed6ca2a4c
title: Реализация поставщика сети
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4776bd97b9528bd04bbda25b88e0ff45a8f911429bb573e62dbbb8581abdfbac
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "120015984"
---
# <a name="implementing-a-network-provider"></a>Реализация поставщика сети

поставщик сети — это библиотека DLL, которая позволяет операционной системе Windows поддерживать конкретный сетевой протокол. Это достигается путем реализации API поставщика сети. Этот API представляет собой набор функций, которые вызывают [*маршрутизаторы нескольких поставщиков*](../secgloss/m-gly.md) (многопротокольные вызовы) для взаимодействия с сетью. Затем поставщик сети преобразует эти вызовы в вызовы API для конкретного сетевого интерфейса, чтобы выполнить действие, заданное многопротокольным маршрутизатором. таким образом, операционная система Windows может взаимодействовать с новыми сетевыми протоколами без необходимости понимания сетевых интерфейсов api.

Чтобы создать поставщик сети, напишите библиотеку DLL, которая экспортирует функцию [**нпжеткапс**](/windows/desktop/api/Npapi/nf-npapi-npgetcaps) .

Поддержка других функций в API поставщика сети является необязательной. Если поставщику сети не требуется функция, Библиотека DLL не должна реализовывать ее или предоставлять реализацию заглушки. Дополнительные сведения см. в разделах по отдельным функциям в разделе [функции поставщика сети](authentication-functions.md).

Исключением является то, что если поддерживается одна из следующих функций перечисления, необходимо также поддерживать две другие функции: [**нпопененум**](/windows/desktop/api/Npapi/nf-npapi-npopenenum), [**нпенумресаурце**](/windows/desktop/api/Npapi/nf-npapi-npenumresource)и [**нпклосинум**](/windows/desktop/api/Npapi/nf-npapi-npcloseenum).

следующие рекомендации описывают, как создать поставщик сети, который взаимодействует с многопротокольным маршрутизатором и Windows операционной системой. Когда это возможно, поставщик должен соблюдать следующие рекомендации по скорости, проверке и маршрутизации.

## <a name="speed"></a>Speed

Поставщик сети должен быстро определить, является ли сетевой ресурс собственным. Это обусловлено тем, что многопротокольному маршрутизатору может потребоваться циклический перебор нескольких поставщиков для поиска владельца ресурса.

Если поставщик сети не владеет ресурсом, он должен сразу же вернуть \_ код состояния WN Bad \_ NETNAME.

Также важно, чтобы поставщики, которые поддерживают [**нпжетдиректоритипе**](/windows/desktop/api/Npapi/nf-npapi-npgetdirectorytype) , быстро возвращали результаты для этой функции, так как она вызывается, когда винфиле вырисовывает дерево каталогов.

## <a name="validation"></a>Проверка

Порядок проверки важен. Поставщик сети должен сначала определить, запущена ли его сеть, а затем определить, поддерживает ли сеть и сетевой поставщик операцию. Если после выполнения этих проверок поставщик сети получает сетевые ресурсы, он должен определить, владеет ли он. Наконец, он должен проверить другие параметры.

## <a name="routing"></a>Маршрутизация

Если многопротокольный маршрутизатор должен циклически проходить через поставщиков сети, он попытается использовать всех поставщиков, пока один из них не примет вызов. Иными словами, многопротокольный маршрутизатор всегда пытается найти поставщика сети.

Однако он запишите первую значительную ошибку, сообщаемую поставщиком. Ошибки, такие как ошибка \_ Bad \_ НЕТПАС, ошибка \_ Bad \_ net \_ Name, ошибка \_ Недопустимый \_ параметр, \_ Недопустимый уровень, \_ считаются несущественными, так как они просто означают, что поставщик не управляет ресурсом. Тем не менее, если поставщик завершается ошибкой с ошибкой \_ Недопустимый пароль или произошла какая-либо \_ другая существенная ошибка, то он записывает эту ошибку и возобновляет работу через поставщиков сети. В общем случае при маршрутизации, если поставщик не принимает вызов, многопротокольный маршрутизатор сообщает о первой важной ошибке, обнаруженной при переборе поставщиков сети.

Поставщику сети следует использовать такое поведение многопротокольного поставщика при выборе возвращаемого сообщения об ошибке.

## <a name="implementation-note"></a>Примечание о реализации

при реализации DLL поставщика сети поставщик не должен вызывать другие [Windows сетевые функции](../wnet/windows-networking-functions.md), [интерфейсы api оболочки](../shell/samples-usingthumbnailproviders.md)или другие запросы на основе пути UNC, которые могут привести к перезаписи в подсистему MPR. Если вы выполняете такие вызовы из библиотеки DLL поставщика сети, приложение или другие компоненты операционной системы могут столкнуться с состязаниями, низкой производительностью или взаимоблокировками внутри подсистемы MPR.

 

 
