---
description: Возвращает сертификат из учетных данных пользователя.
ms.assetid: 3C79D049-89DC-4AF5-8C0A-5B7EBBBD69D3
title: Функция Жетцертификатефромкред (Лсаидпров. h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- GetCertificateFromCred
api_type:
- HeaderDef
api_location:
- Lsaidprov.h
ms.openlocfilehash: 3660fd4cfb8baa3e025789a2cde9dc04dd7e1e1678b0516a56562f1ea5be43dc
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119994486"
---
# <a name="getcertificatefromcred-function"></a>Функция Жетцертификатефромкред

Возвращает сертификат из учетных данных пользователя.

## <a name="syntax"></a>Синтаксис


```C++
NTSTATUS GetCertificateFromCred(
  _In_  PVOID  ProviderHandle,
  _In_  HANDLE ClientToken,
  _In_  PVOID  SuppliedCred,
  _In_  ULONG  SuppliedCredSize,
  _Out_ PVOID  *CertContext
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*Провидерхандле* \[ окне\]
</dt> <dd>

Маркер поставщика удостоверений.

</dd> <dt>

*Клиенттокен* \[ окне\]
</dt> <dd>

Маркер вызывающего объекта, который получает сертификат.

</dd> <dt>

*Супплиедкред* \[ окне\]
</dt> <dd>

Указатель на SECPKG структуру [**\_ \_ учетных данных**](/windows/desktop/api/Ntsecpkg/ns-ntsecpkg-secpkg_supplied_credential) , содержащую учетные данные для идентификатора в сети, сертификат которого запрашивается. Поставщик удостоверений должен проверить входные данные так, как если бы они поступили из ненадежного источника.

</dd> <dt>

*Супплиедкредсизе* \[ окне\]
</dt> <dd>

Размер (в байтах) буфера *супплиедкред* .

</dd> <dt>

*Цертконтекст* \[ заполняет\]
</dt> <dd>

Если функция выполнена, этот параметр является указателем на возвращаемый \_ указатель контекста кцерт. Завершив использование контекста сертификата, освободите его, вызвав функцию [**цертфрицертификатеконтекст**](/windows/desktop/api/wincrypt/nf-wincrypt-certfreecertificatecontext) .

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Если функция завершается успешно, функция возвращает состояние \_ Success.

Если функция завершается ошибкой, функция может вернуть один из следующих кодов ошибок NTSTATUS.



| Возвращаемое значение                                                                                            | Описание                                                                                                                                                                            |
|---------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <dl> <dt>СОСТОЯНИЕ \_ не \_ поддерживается</dt> </dl>       | Поставщик удостоверений не распознает тип учетных данных предоставляемых учетных данных. LSA попытается обратиться к следующему поставщику удостоверений.<br/>                                           |
| <dl> <dt>\_Ошибка входа в состояние \_</dt> </dl>       | Неверные учетные данные.<br/>                                                                                                                                                |
| <dl> <dt>\_Недопустимый \_ параметр Status</dt> </dl>   | Недействительный параметр. Учетные данные могут быть в неправильном формате, а не в определенной структуре [**\_ \_ учетных данных SECPKG**](/windows/desktop/api/Ntsecpkg/ns-ntsecpkg-secpkg_supplied_credential) .<br/> |
| <dl> <dt>СОСТОЯНИЕ " \_ сеть \_ недоступна"</dt> </dl> | Поставщик удостоверений не может связаться с облаком для получения сертификата.<br/>                                                                                                   |
| <dl> <dt>\_ \_ срок действия пароля истек</dt> </dl>    | Срок действия пароля учетной записи истек.<br/>                                                                                                                                           |
| <dl> <dt>\_учетная запись состояния \_ заблокирована \_</dt> </dl> | Учетная запись заблокирована. <br/>                                                                                                                                           |
| <dl> <dt>Прочие</dt> </dl>                       | Другие коды ошибок, относящиеся к поставщику. <br/>                                                                                                                                       |



 

## <a name="remarks"></a>Remarks

Перед получением сертификата из облака поставщик удостоверений должен проверить наличие действительного сертификата для этого пользователя в хранилище сертификатов пользователя "MY". Если существует действительный сертификат, поставщик должен вернуть этот сертификат, чтобы избежать ненужного сетевого трафика.

Поставщик удостоверений также может кэшировать сертификат локально, если он защищен от текущего пользователя.

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|----------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows 8 \[ только классические приложения\]<br/>                                             |
| Минимальная версия сервера<br/> | Windows Server 2012 \[ только классические приложения\]<br/>                                   |
| Заголовок<br/>                   | <dl> <dt>Лсаидпров. h</dt> </dl> |



 

