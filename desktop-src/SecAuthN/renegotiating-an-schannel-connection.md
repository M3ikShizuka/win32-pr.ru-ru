---
description: Чтобы изменить атрибуты подключения, такие как набор шифров или проверка подлинности клиента, можно запросить &\# 0034; повтор&\# 0034; или повторное согласование соединения.
ms.assetid: 681b607d-66d8-4012-9a84-d202c9778a26
title: Повторное согласование подключения Schannel
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9fbcd25dad39ab7f35e77277eee9275004cd8a26
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105650765"
---
# <a name="renegotiating-an-schannel-connection"></a>Повторное согласование подключения Schannel

Чтобы изменить атрибуты подключения, такие как набор шифров или проверка подлинности клиента, можно запросить повтор или повторное согласование соединения.

Если изменяемые атрибуты контролируются учетными данными, необходимо получить новые учетные данные перед повторной согласованием соединения. Дополнительные сведения см. в разделе [Получение учетных данных SChannel](obtaining-schannel-credentials.md).

Чтобы запросить повтор из клиентского приложения, вызовите функцию [**InitializeSecurityContext (Schannel)**](./initializesecuritycontext--schannel.md) . Серверные приложения вызывают функцию [**AcceptSecurityContext (Schannel)**](acceptsecuritycontext--schannel.md) . Задайте следующие параметры:

-   Укажите существующий [*контекст безопасности*](../secgloss/s-gly.md#_SECURITY_SECURITY_CONTEXT_GLY) в параметре *фконтекст* .
-   (Только для клиентов) Укажите то же имя сервера (в параметре *псзтаржетнаме* ), как указано при установке контекста.
-   Укажите новые учетные данные с помощью параметра *фкредентиал* , если это применимо.
-   Если вы хотите изменить атрибуты контекста, не связанные с учетными данными, укажите эти атрибуты с помощью параметра *фконтекстрек* .

После вызова соответствующей функции приложение должно отправить результаты клиенту и продолжить обработку входящих сообщений с помощью функции [**декриптмессаже (Schannel)**](decryptmessage--schannel.md) .

Функция [**декриптмессаже (Schannel)**](decryptmessage--schannel.md) возвратит ответ, \_ когда я буду повторно \_ согласовывать, когда канал Schannel готов для продолжения работы приложения. Когда вы получаете повторное \_ \_ согласование кода возврата в секунду, приложение должно вызвать [**AcceptSecurityContext (Schannel)**](acceptsecuritycontext--schannel.md) (Servers) или [**InitializeSecurityContext (Schannel)**](./initializesecuritycontext--schannel.md) (клиенты) и передать содержимое SECBUFFER_EXTRA, возвращенное из декриптмессаже в SECBUFFER_TOKEN. После того как этот вызов вернет значение, продолжайте, как будто приложение создает новое соединение.

 

 
