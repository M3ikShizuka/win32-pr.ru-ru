---
description: Протокол дайджест-доступа
ms.assetid: 7b2fd75e-dd0d-4a63-a84b-a64f08f883f2
title: Протокол дайджест-доступа
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 86aa8f05580c27c866c0568dbc67c4d5ba5c2016
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104569325"
---
# <a name="the-digest-access-protocol"></a>Протокол дайджест-доступа

Протокол дайджест-доступа, указанный в [RFC 2617](https://www.ietf.org/rfc/rfc2617.txt) , реализуется с помощью [*поставщика службы поддержки*](../secgloss/s-gly.md) Microsoft Digest Security (SSP). Реализация состоит из набора функций безопасности [интерфейса поставщика поддержки безопасности](sspi.md) (SSPI), которые вызываются клиентскими и серверными приложениями:

-   Установите [*контекст безопасности*](../secgloss/s-gly.md) для обмена сообщениями.
-   Получите объекты данных, необходимые для дайджест-SSP, например [*учетные данные*](../secgloss/c-gly.md) и дескрипторы контекста.
-   Доступ к механизмам [*обеспечения целостности*](../secgloss/i-gly.md) и конфиденциальности сообщений.

Проверка подлинности с доступом выполняется в парных транзакциях запросов и ответов с запросами, происходящими на стороне клиента и ответов, происходящих на сервере. Успешная проверка подлинности с доступом дайджеста требует наличия двух пар "запрос-ответ".

Если для проверки подлинности HTTP используется дайджест-поставщик, то соединение между первой и второй парой "запрос-ответ" не поддерживается. Иными словами, сервер не ждет второго запроса после отправки первого ответа.

На следующем рисунке показаны действия, выполняемые на HTTP-пути клиентом и сервером для выполнения проверки подлинности с помощью дайджеста SSP. Механизм SASL использует взаимную проверку подлинности, поэтому данные проверки подлинности отправляются обратно на обратный вызов по УБЫВАНИЮ сервера клиенту, который проверяет, что клиент взаимодействует с правильным сервером.

![Протокол дайджест-доступа](images/digest1.png)

Процесс начинается с клиента, запрашивающего защищенный доступ к ресурсу с сервера путем отправки HTTP-запроса 1.

Сервер получает HTTP-запрос 1 и определяет, что ресурсу требуются данные проверки подлинности, которые не были добавлены в запрос. Сервер создает запрос для клиента следующим образом:

1.  Сервер получает свои [*учетные данные*](../secgloss/c-gly.md) , вызывая функцию [**AcquireCredentialsHandle**](/windows/win32/api/sspi/nf-sspi-acquirecredentialshandlea) .
2.  Сервер создает запрос дайджеста, вызывая функцию [**AcceptSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) .
3.  Сервер отправляет заголовок WWW-Authenticate в ответ на запрос клиента (отображается как HTTP-ответ 1). Заголовок содержит запрос дайджеста и непрозрачную директиву, содержащую ссылку на частичный [*контекст безопасности*](../secgloss/s-gly.md) , установленный для клиента. Заголовок отправляется с кодом состояния 401, указывающим на то, что клиентский запрос создал ошибку несанкционированного доступа. Дополнительные сведения о дайджест-запросах см. в разделе [содержание запроса дайджеста](contents-of-a-digest-challenge.md) и [Создание запроса дайджеста](generating-the-digest-challenge.md).
4.  Клиент получает ответ HTTP 1, извлекает запрос дайджеста, отправленный сервером, и создает ответ на запрос дайджеста следующим образом:
    1.  Учетные данные пользователя получаются либо путем вызова функции [**AcquireCredentialsHandle**](/windows/win32/api/sspi/nf-sspi-acquirecredentialshandlea) , либо посредством интерактивного запроса учетных данных пользователя.
    2.  Сведения о запросах и учетных данных передаются в функцию [**InitializeSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-initializesecuritycontexta) , которая создает ответ на запрос дайджеста.
5.  Клиент отправляет заголовок авторизации, содержащий ответ на запрос к серверу (показанный в виде HTTP-запроса 2). Дополнительные сведения о ответе на запрос дайджеста см. в разделе [содержимое ответа на запрос дайджеста](contents-of-a-digest-challenge-response.md) и [Создание ответа на запрос дайджеста](generating-the-digest-challenge-response.md).
6.  Сервер получает HTTP-запрос 2, извлекает ответ на запрос, отправленный клиентом, и проверяет подлинность данных, вызывая функцию [**AcceptSecurityContext (General)**](/windows/win32/api/sspi/nf-sspi-acceptsecuritycontext) . Дополнительные сведения о процессе проверки подлинности см. в [статье Начальная проверка подлинности с помощью Microsoft Digest](initial-authentication-using-microsoft-digest.md).
7.  Сервер отправляет ответ HTTP 2 обратно клиенту в качестве второго и последнего ответа, необходимого для протокола дайджест-доступа. Если проверка подлинности прошла успешно, этот ответ содержит запрошенный ресурс.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Содержимое ответа на запрос дайджеста](contents-of-a-digest-challenge-response.md)
</dt> </dl>

 

 
