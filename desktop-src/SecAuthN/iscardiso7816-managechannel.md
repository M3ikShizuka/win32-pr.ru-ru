---
description: Метод Манажечаннел создает команду блока данных протокола приложения (КАТЕГОРИЯХ APDU), которая открывает и закрывает логические каналы.
ms.assetid: a55b5b3f-0404-45bd-afeb-e96173319a50
title: 'Метод ISCardISO7816:: Манажечаннел (Скардссп. h)'
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- ISCardISO7816.ManageChannel
api_type:
- COM
api_location:
- Scardssp.dll
ms.openlocfilehash: 92fb91c0630996938e247dbc244ac0c311c52531401367d5326bd197ffaabf9c
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119481129"
---
# <a name="iscardiso7816managechannel-method"></a>Метод ISCardISO7816:: Манажечаннел

\[Метод **манажечаннел** доступен для использования в операционных системах, указанных в разделе требования. он недоступен для использования в Windows Server 2003 с пакетом обновления 1 (SP1) и более поздних версий, Windows Vista, Windows Server 2008 и последующих версиях операционной системы. [Модули смарт-карт](/previous-versions/windows/desktop/secsmart/smart-card-modules) предоставляют аналогичные функции.\]

Метод **манажечаннел** создает команду [*блока данных протокола приложения*](../secgloss/a-gly.md) (категориях APDU), которая открывает и закрывает логические каналы.

Функция Open открывает новый логический канал, отличный от основного. Для карты можно назначить номер логического канала или указать номер логического канала, который будет предоставлен карте.

Функция Close явным образом закрывает логический канал, отличный от базового. После успешного закрытия логический канал должен быть доступен для повторного использования.

## <a name="syntax"></a>Синтаксис


```C++
HRESULT ManageChannel(
  [in]      BYTE       byChannelState,
  [in]      BYTE       byChannel,
  [in, out] LPSCARDCMD *ppCmd
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*бичаннелстате* \[ окне\]
</dt> <dd>

Bit B8 P1 используется для указания функции Open или функции Close; Если B8 имеет значение 0, то Управление КАНАЛом должно открыть логический канал, а если B8 — 1, то Управление КАНАЛом должно закрывать логический канал:

P1 = "00" для открытия

P1 = ' 80 ' для закрытия

Другие значения — РФУ

</dd> <dt>

*бичаннел* \[ окне\]
</dt> <dd>

Для функции Open (P1 = ' 00 ') биты B1 и B2 в P2 используются для кодирования номера логического канала таким же образом, как в байте класса, остальные биты P2 — это РФУ.

Если значения B1 и B2 для p2 равны **null**, то карта присвоит номер логического канала, который будет возвращен в битах B1 и B2 поля данных.

Если B1 и/или B2 в P2 не равны **null**, они направляют логический номер канала, отличный от базового. затем карточка будет открывать внешний назначенный номер логического канала.

</dd> <dt>

*ппкмд* \[ в, out\]
</dt> <dd>

На входе — указатель на объект интерфейса [**искардкмд**](iscardcmd.md) или **значение NULL**.

При возвращении он заполняется командой КАТЕГОРИЯХ APDU, созданной этой операцией. Если для *ппкмд* было задано **значение NULL**, то объект [*смарт-карты*](../secgloss/s-gly.md) [**искардкмд**](iscardcmd.md) создается внутренним образом и возвращается с помощью указателя *ппкмд* .

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Метод возвращает одно из следующих возможных значений.



| Код возврата                                                                                   | Описание                                  |
|-----------------------------------------------------------------------------------------------|----------------------------------------------|
| <dl> <dt>**\_ОК**</dt> </dl>          | Operation completed successfully (Операция выполнена успешно).<br/> |
| <dl> <dt>**E \_ INVALIDARG**</dt> </dl>  | Недопустимый параметр.<br/>                |
| <dl> <dt>**\_указатель E**</dt> </dl>     | Передан неверный указатель.<br/>      |
| <dl> <dt>**E \_ OUTOFMEMORY**</dt> </dl> | Недостаточно памяти.<br/>                    |



 

## <a name="remarks"></a>Remarks

Когда функция Open успешно выполняется из базового логического канала, необходимо неявно выбрать MF в качестве текущей DF, а состояние безопасности нового логического канала должно совпадать с базовым логическим каналом после ATR. Состояние безопасности нового логического канала должно быть отдельно от другого логического канала.

Когда функция Open успешно выполняется из логического канала, который не является базовым, текущий DF логического канала, выдавшего команду, будет выбрана в качестве текущей DF. Кроме того, состояние безопасности для нового логического канала должно совпадать с состоянием безопасности логического канала, из которого была выполнена функция Open.

После успешного завершения функции закрытия состояние безопасности, связанное с этим логическим каналом, будет потеряно.

Список всех методов, предоставляемых этим интерфейсом, см. в разделе [**ISCardISO7816**](iscardiso7816.md).

Кроме приведенных выше кодов ошибок COM, этот интерфейс может возвращать код ошибки смарт-карты, если для завершения запроса была вызвана функция смарт-карты. Дополнительные сведения см. в статье [возвращаемые значения смарт-карты](authentication-return-values.md).

## <a name="requirements"></a>Requirements (Требования)



| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows \[Только классические приложения XP\]<br/>                                             |
| Минимальная версия сервера<br/> | Windows Только для \[ настольных приложений сервера 2003\]<br/>                                    |
| Окончание поддержки клиента<br/>    | Windows XP<br/>                                                                   |
| Поддержка конца сервера<br/>    | Windows Server 2003<br/>                                                          |
| Header<br/>                   | <dl> <dt>Скардссп. h</dt> </dl>   |
| Библиотека типов<br/>             | <dl> <dt>Скардсрв. tlb</dt> </dl> |
| DLL<br/>                      | <dl> <dt>Scardssp.dll</dt> </dl> |
| IID<br/>                      | IID \_ ISCardISO7816 определен как 53B6AA68-3F56-11D0-916B-00AA00C18068<br/>        |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**ISCardISO7816**](iscardiso7816.md)
</dt> </dl>

 

 
