---
description: XAudio2 может вызывать функции, предоставляемые клиентом, чтобы уведомить его асинхронно о некоторых событиях, происходящих в потоке обработки звука.
ms.assetid: 4fbd4229-f7ac-33b3-b4b7-f09150a60598
title: Обратные вызовы в XAudio2
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4ee191ad8c15d238a065c837c6fb192befbe7a51
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104349812"
---
# <a name="xaudio2-callbacks"></a>Обратные вызовы в XAudio2

XAudio2 может вызывать функции, предоставляемые клиентом, чтобы уведомить его асинхронно о некоторых событиях, происходящих в потоке обработки звука. Эти обратные вызовы могут быть глобальными или конкретными для заданного исходного голоса. Чтобы получить вызовы глобальной подсистемы, клиент должен предоставить экземпляр класса, реализующего интерфейс [**IXAudio2EngineCallback**](/windows/desktop/api/xaudio2/nn-xaudio2-ixaudio2enginecallback) при инициализации XAudio2. Чтобы получить исходные голосовые обратные вызовы, клиент должен предоставить экземпляр класса, реализующего интерфейс [**IXAudio2VoiceCallback**](/windows/desktop/api/xaudio2/nn-xaudio2-ixaudio2voicecallback) при создании исходных голосов. Дополнительные сведения см. в разделе **IXAudio2EngineCallback** и **IXAudio2VoiceCallback**.

Необходимо тщательно реализовать обратные вызовы, чтобы избежать возникновения перерывов в аудио. При каждом выполнении обратного вызова XAudio2 не может создать звук. Задержка более чем на несколько миллисекунд может вызвать проблему со звуком. Задержки этой природы также создают выходные данные отладчика. Это указывает на потенциальные проблемы с производительностью. Как минимум функции обратного вызова не должны выполнять следующие действия:

-   Доступ к жесткому диску или другому постоянному хранилищу
-   Создание ресурсоемких или блокирующих вызовов API
-   Синхронизация с другими частями клиентского кода
-   Требовать значительный уровень загрузки ЦП

Если при проектировании клиента требуется обратный вызов для активации действий, например перечисленных выше, обратный вызов должен сообщить другому клиентскому потоку о выполнении работы. Это можно сделать с помощью простого механизма **выполнить SetEvent** или более сложных механизмов, например неблокирующей очереди команд, которая используется другим потоком.

## <a name="ixaudio2enginecallback"></a>IXAudio2EngineCallback

Класс [**IXAudio2EngineCallback**](/windows/desktop/api/xaudio2/nn-xaudio2-ixaudio2enginecallback) содержит методы, которые уведомляют клиента при возникновении определенных событий в подсистеме XAudio2. Эти методы должны быть реализованы клиентом XAudio2. XAudio2 вызывает эти методы посредством указателя интерфейса, предоставленного клиентом, с помощью метода [**IXAudio2:: регистерфоркаллбаккс**](/windows/win32/api/xaudio2/nf-xaudio2-ixaudio2-registerforcallbacks) . Все эти методы возвращают **значение void**, а не **HRESULT**.

## <a name="ixaudio2voicecallback"></a>IXAudio2VoiceCallback

Класс [**IXAudio2VoiceCallback**](/windows/desktop/api/xaudio2/nn-xaudio2-ixaudio2voicecallback) содержит методы, которые уведомляют клиента при возникновении определенных событий в определенном исходном голосовом XAudio2. XAudio2 вызывает эти методы с помощью указателя интерфейса, предоставленного клиентом в [**IXAudio2:: креатесаурцевоице**](/windows/win32/api/xaudio2/nf-xaudio2-ixaudio2-createsourcevoice). Как и в случае с [**IXAudio2EngineCallback**](/windows/desktop/api/xaudio2/nn-xaudio2-ixaudio2enginecallback), эти методы должны быть реализованы клиентом XAudio2 и возвращать **значение void** , а не **HRESULT**.

Как упоминалось ранее, важно, чтобы предоставляемые клиентом реализации этих обратных вызовов возвращались как можно быстрее, желательно в миллисекундах. Обратные вызовы выполняются в потоке обработки звука, и вся обработка прерывается до возвращения обратного вызова. Задержка в обратном вызове может легко вызвать проблему со звуком.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Обратные вызовы](callbacks.md)
</dt> <dt>

[Руководство по программированию для XAudio2](programming-guide.md)
</dt> <dt>

[Руководство: использование обратных вызовов речевых источников](how-to--use-source-voice-callbacks.md)
</dt> <dt>

[Руководство: использование обратных вызовов модуля](how-to--use-engine-callbacks.md)
</dt> <dt>

[Руководство: организация звукового потока с диска](how-to--stream-a-sound-from-disk.md)
</dt> </dl>

 

 
