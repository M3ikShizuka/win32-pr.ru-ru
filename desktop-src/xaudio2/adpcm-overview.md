---
description: Адаптивный разностный импульсный код (ADPCM) — это формат сжатия с потерей данных, который реализуется для XAudio2, чтобы предоставить дополнительные возможности для указания размера блока образца сжатия.
ms.assetid: ae8a0a3e-293c-8193-d252-046d79771cfb
title: Общие сведения о ADPCM
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6e1be1155d6d9f5a542b605c497ce28aa34191c0ac129582c18ec4a47b9f510f
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118962723"
---
# <a name="adpcm-overview"></a>Общие сведения о ADPCM

Адаптивный разностный импульсный код (ADPCM) — это формат сжатия с потерей данных, который реализуется для XAudio2, чтобы предоставить дополнительные возможности для указания размера блока образца сжатия. При использовании формата сжатия потери данных некоторые данные изменяются и теряются во время сжатия. ADPCM может обеспечить степень сжатия до 4:1.

Реализация ADPCM для XAudio2 предоставляет дополнительные возможности для указания размера блока образца сжатия. ADPCM позволяет конструктору аудио выбрать параметр, который является подходящим компромиссом между размером, качеством и разрешением (для размещения точек цикла).

XAudio2 использует измененную версию кодека Microsoft ADPCM, поддерживающую расширенное форматирование данных, необходимое для предоставления пользовательских размеров блоков выборки. По этой причине звуковые модули не поддерживают эту версию аудиокодека ADPCM, поэтому XAudio2 не могут воспроизводить аудиоданные.

> [!Note]  
> в настоящее время сжатие ADPCM доступно только для Windows, включая XNA game Studio Express для развертываний Windows.

 

## <a name="adpcm-encoding"></a>Кодировка ADPCM

Звуковые данные кодируются в ADPCM с помощью программы командной строки Адпкменкоде.

-   адпкменкоде

    Чтобы кодировать звуковые файлы как ADPCM для использования с XAudio2, используйте программу командной строки **адпкменкоде** .

## <a name="adpcm-decoding"></a>ADPCM декодирование

Программное декодирование ADPCM поддерживается в XAudio2.

-   XAudio2

    Чтобы использовать данные в кодировке ADPCM в XAudio2, необходимо инициализировать структуру **адпкмвавеформат** с использованием значений, характерных для ADPCM, и передать ее в качестве аргумента в [**IXAudio2:: креатесаурцевоице**](/windows/win32/api/xaudio2/nf-xaudio2-ixaudio2-createsourcevoice) при создании исходного голоса. Пример загрузки и воспроизведения звука в XAudio2 см. в статье [как воспроизвести звук с помощью XAudio2](how-to--play-a-sound-with-xaudio2.md).

## <a name="samplesperblock"></a>самплесперблокк

Сжатие ADPCM выполняется путем разделения звуковой волны на блоки и прогнозирования вариации образцов аудио в каждом блоке. Размер блоков измеряется в примерах. Наименьшим размером блока является 32 выборок, а самым высоким — 512.

Более крупные блоки позволяют лучше сжимать, что приводит к уменьшению размеров файлов, но за счет увеличения качества звука и разрешения для выровняйте точки цикла.

Как правило, изменение значения Самплесперблокк приводит к следующим компромиссам:



| Если Самплесперблокк...      | Сжатие файлов | Качество звука | Разрешение точки цикла |
|----------------------------|------------------|---------------|-----------------------|
| Увеличение (до максимума 512)  | Повышения        | Уменьшать     | Уменьшать             |
| Уменьшение (до минимума 32) | Уменьшать        | Повышения     | Повышения             |



 

## <a name="restrictions"></a>Ограничения

Так как в ADPCM используются блоки примеров, которые вычисляются по одному за другим, волна, сжатая с помощью ADPCM, может иметь незаконченный, незавершенный блок в конце. Декодер ADPCM создает бездействия в оставшейся части этого частичного блока, что позволяет эффективно выполнять циклическое воспроизведение.

Значение параметра *самплесперблокк* влияет на разрешение, с помощью которого можно выстроить волновые данные и точки цикла.

Если вы попытаетесь применить сжатие к неоднородной волновой волны, будет выдано сообщение об ошибке или предупреждение в зависимости от того, используется ли волна в любом цикле событий воспроизведения. Нельзя сжимать волн, используемый в циклах событий воспроизведения. Удалите его из цикла событий воспроизведения и повторно примените сжатие.

При использовании волн исключительно в режиме без цикла ограничение по выравниванию блока выборки не применяется.

## <a name="adpcm-file-structure"></a>Файловая структура ADPCM

ADPCM-файл — это стандартный файл Metallica со следующими типами блоков.



| Блок FCC     | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|---------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| RIFF          | Стандартный блок Metallica, содержащий тип файла со значением WAVE в первых четырех байтах его раздела данных, а также другие фрагменты в файле в оставшейся части его раздела данных.                                                                                                                                                                                                                                                                 |
| FMT           | Содержит заголовок Format для файла ADPCM. Данные в этом блоке соответствуют структуре **адпкмвавеформат** .                                                                                                                                                                                                                                                                                                                             |
| .          | Содержит закодированные звуковые данные ADPCM. При использовании ADPCM в XAudio2 необходимо прочитать содержимое фрагмента данных в буфер и передать его в исходный голоса в качестве элемента **паудиодата** в структуре [**\_ буфера XAudio2**](/windows/desktop/api/xaudio2/ns-xaudio2-xaudio2_buffer) . Содержимое блока данных не нужно менять байтами.                                                                                                                            |
| СМПЛ и всмп | Необязательные типы блоков, содержащие сведения о циклах для файла ADPCM. При использовании ADPCM в XAudio2 значения, содержащиеся в блоках СМПЛ или всмп, используются для заполнения **лупбегинлупленгс** и **лупкаунт** элементов структуры [**\_ буфера XAudio2**](/windows/desktop/api/xaudio2/ns-xaudio2-xaudio2_buffer) . на Xbox 360 необходимо переключить данные, загружаемые из смпл фрагмента, чтобы учитывать порядок следования байтов разницу между Windows и Xbox 360. |



 

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Руководство по программированию](programming-guide.md)
</dt> </dl>

 

 
