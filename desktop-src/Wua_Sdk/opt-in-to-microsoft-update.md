---
description: Можно выбрать компьютер в службе Центр обновления Майкрософт, а затем зарегистрировать эту службу в автоматическое обновление.
ms.assetid: d6f3d8ca-3b7e-409c-87b6-db247b7b68e4
title: Opt-In Центр обновления Майкрософт
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6b149eb28024d77f66a08371827187adf05d4b78
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104143684"
---
# <a name="opt-in-to-microsoft-update"></a>Opt-In Центр обновления Майкрософт

Можно выбрать компьютер в службе Центр обновления Майкрософт, а затем зарегистрировать эту службу в автоматическое обновление.

В примере сценариев в этом разделе показано, как использовать агент Центр обновления Windows (WUA) для регистрации службы Центр обновления Майкрософт с автоматическое обновление. Кроме того, чтобы зарегистрировать службу, пользователь может посетить Центр обновления Майкрософт.

Перед запуском этого образца убедитесь, что на компьютере установлена версия WUA 7.0.6000 или более поздняя версия. Дополнительные сведения о том, как определить версию установленного агента WUA, см. [в разделе Определение текущей версии WUA](determining-the-current-version-of-wua.md).

## <a name="example"></a>Пример

В следующем примере сценария показано, как с помощью агента Центр обновления Windows (WUA) зарегистрировать службу Центр обновления Майкрософт с автоматическое обновление. Пример разрешает отложенную или автономную обработку при необходимости.

> [!IMPORTANT]
> Этот сценарий предназначен для демонстрации использования API-интерфейсов агента Центр обновления Windows и предоставления примера того, как разработчики могут использовать эти API для решения проблем. Этот сценарий не предназначен для рабочего кода, и сам сценарий не поддерживается корпорацией Майкрософт (хотя поддерживаются базовые API-интерфейсы Центр обновления Windows агента).

 


```VB
Set ServiceManager = CreateObject("Microsoft.Update.ServiceManager")
ServiceManager.ClientApplicationID = "My App"

'add the Microsoft Update Service, GUID
Set NewUpdateService = ServiceManager.AddService2("7971f918-a847-4430-9279-4a52d1efe18d",7,"")

```



В более ранних версиях WUA (минимальная версия 7.0.6000) можно упростить процесс согласия с помощью параметра реестра. После того как раздел и значения реестра настроены, процесс согласия Центр обновления Майкрософт выполняется в следующий раз, когда WUA выполняет поиск. Процесс согласия может инициироваться автоматическое обновление или вызывающим объектом API.

Например, полный путь к разделу реестра и значения, которые необходимо задать для процесса включения, выглядит следующим образом:

**HKLM** \\ **Программное обеспечение** \\ **Microsoft** \\ **Windows** \\ **CurrentVersion** \\ **Windowsupdate** \\ **Пендингсервицерегистратион** \\ **7971f918-A847-4430-9279-4a52d1efe18d**

**Клиентаппликатионид** = мое приложение

**Регистервисау** = 1

> [!Note]
>
> Раздел реестра учитывается только при обновлении агента WUA с версии, предшествующей версии 7.0.6000, до версии 7.0.6000 или более поздней версии. Мы рекомендуем применять при перезаписи существующих значений реестра, поскольку перезапись значений может привести к изменению результатов предыдущего запроса на регистрацию службы.
>
> Для создания этого раздела реестра требуются учетные данные администратора. В Windows Vista вызывающий объект должен создать раздел реестра в процессе с повышенными правами.

 

 

 



