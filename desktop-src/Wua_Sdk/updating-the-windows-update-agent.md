---
description: Windows агент обновления (WUA) автоматически обновляется, если он подключен к серверу Windows Server Update Services (WSUS) или Центр обновления Windows.
ms.assetid: 829112ab-b240-4cc4-8053-18b484934886
title: обновление агента Центр обновления Windows
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5388475aaf9fa83413a916520035eb9539187390bf5a3bd8f5c836cb1b176357
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118814655"
---
# <a name="updating-windows-update-agent"></a>обновление агента Центр обновления Windows

Windows агент обновления (WUA) обновляется с помощью различных средств, в зависимости от версии Windows, выполняемой на устройстве. Старые версии WUA не могут подключаться к текущим службам обновления, могут быть несовместимы со всеми обновлениями и могут не поддерживать все документированные API. Вот как можно убедиться, что WUA полностью обновлен и совместим.

**в версиях Windows начиная с Windows 7 и Windows Server 2008 R2**

Windows обновления агента обновления (WUA) включены в регулярные периодические обновления для Windows, распределенных по Центр обновления Windows или Windows Server Update Services (WSUS). вам не нужно предпринимать никаких дополнительных действий по обновлению WUA на этих Windows версиях.

**в версиях Windows до Windows 7 и Windows Server 2008 R2**

WUA автоматически обновляется, когда автоматическое обновление подключается к службам Центр обновления Windows или WSUS.

если автоматическое обновление еще не удалось запустить, возможно, на устройстве, на котором работают эти Windowsные версии, установлена более старая версия WUA, которая не поддерживает все документированные api. если при использовании API-интерфейса WUA для выполнения проверки, загрузки или установки получен результат WU_E_SELFUPDATE_REQUIRED, эта ошибка говорит о том, что установленная версия WUA слишком старая для подключения к текущим службам Центр обновления Windows. Вы не можете использовать обычные API-интерфейсы WUA для обновления WUA в этих операционных системах. 

пользователь может вручную обновить WUA до текущей версии, открыв панель управления Центр обновления Windows, выбрав пункт проверить обновления и приняв отображаемое самостоятельное обновление. Кроме того, агент WUA можно обновить программным способом.

**для программного обновления агента WUA в версиях Windows до Windows 7 и Windows Server 2008 R2**

1.  Используйте API [WinHTTP](../winhttp/winhttp-start-page.md) для скачивания [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab).
2.  Используйте [криптографические функции](../seccrypto/cryptography-functions.md) , чтобы убедиться, что скачанная копия [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab) имеет цифровую подпись от корпорации Майкрософт. Если вы не можете проверить цифровую подпись, прервите ее.
3.  Используйте API [интерфейса распаковки файлов](../devnotes/cabinet-api-functions.md) для извлечения XML-файла из [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab).
4.  используйте api MSXML ([MSXML](/previous-versions/windows/desktop/ms763742(v=vs.85))) для загрузки XML-файла и нахождение узла файл wuredist/стандалонередист/architecture для архитектуры компьютера. Например, для x86 выберите узел файл Wuredist/Стандалонередист/Architecture с атрибутом **Name** платформы x86.
5.  Вызовите [**ивиндовсупдатеажентинфо:: info**](/windows/desktop/api/Wuapi/nf-wuapi-iwindowsupdateagentinfo-getinfo) , чтобы определить текущую версию WUA. Если **ивиндовсупдатеажентинфо::-info** возвращает номер версии по крайней мере выше, чем атрибут **clientVersion** в узле архитектуры, который вы находили, прервите.
6.  используйте [MSXML](/previous-versions/windows/desktop/ms763742(v=vs.85)) api-интерфейсы для чтения атрибута **довнлоадурл** из найденного узла архитектуры. **довнлоадурл** предоставляет URL-адрес для скачивания соответствующего установщика агента WUA для архитектуры компьютера.
7.  Используйте API [WinHTTP](../winhttp/winhttp-start-page.md) для загрузки соответствующего установщика.
8.  Используйте функцию [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) или аналогичный API для выполнения скачанного установщика.

 

 
