---
description: Агент Центр обновления Windows (WUA) автоматически обновляет себя при подключении к серверу Windows Server Update Services (WSUS) или Центр обновления Windows.
ms.assetid: 829112ab-b240-4cc4-8053-18b484934886
title: Обновление агента Центр обновления Windows
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b00fe439b1bea377e2699f6fe5714b208ac5d951
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105711175"
---
# <a name="updating-windows-update-agent"></a>Обновление агента Центр обновления Windows

Агент Центр обновления Windows (WUA) обновляется с помощью различных средств, в зависимости от версии Windows, работающей на устройстве. Старые версии WUA не могут подключаться к текущим службам обновления, могут быть несовместимы со всеми обновлениями и могут не поддерживать все документированные API. Вот как можно убедиться, что WUA полностью обновлен и совместим.

**В версиях Windows, начиная с Windows 7 и Windows Server 2008 R2**

Обновления агента Центр обновления Windows (WUA) включены в регулярные периодические обновления Windows, распределенные по Центр обновления Windows или Windows Server Update Services (WSUS). Вам не нужно предпринимать никаких дополнительных действий по обновлению WUA в этих версиях Windows.

**В версиях Windows до Windows 7 и Windows Server 2008 R2**

WUA автоматически обновляется, когда автоматическое обновление подключается к службам Центр обновления Windows или WSUS.

Если автоматическое обновление еще не удалось запустить, возможно, на устройстве под управлением этих версий Windows будет запущена более старая версия WUA, которая не поддерживает все документированные API-интерфейсы. Если при использовании API-интерфейса WUA для выполнения проверки, загрузки или установки получен результат WU_E_SELFUPDATE_REQUIRED, эта ошибка говорит о том, что установленная версия WUA слишком старая для подключения к текущим службам Центр обновления Windows. Вы не можете использовать обычные API-интерфейсы WUA для обновления WUA в этих операционных системах. 

Пользователь может вручную обновить WUA до текущей версии, открыв панель управления Центр обновления Windows, выбрав пункт Проверить обновления и приняв отображаемое самостоятельное обновление. Кроме того, агент WUA можно обновить программным способом.

**Программное обновление агента WUA в версиях Windows до Windows 7 и Windows Server 2008 R2**

1.  Используйте API [WinHTTP](../winhttp/winhttp-start-page.md) для скачивания [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab).
2.  Используйте [криптографические функции](../seccrypto/cryptography-functions.md) , чтобы убедиться, что скачанная копия [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab) имеет цифровую подпись от корпорации Майкрософт. Если вы не можете проверить цифровую подпись, прервите ее.
3.  Используйте API [интерфейса распаковки файлов](../devnotes/cabinet-api-functions.md) для извлечения XML-файла из [Wuredist.cab](https://update.microsoft.com/redist/wuredist.cab).
4.  Используйте API-интерфейсы Microsoft XML Core Services ([MSXML](/previous-versions/windows/desktop/ms763742(v=vs.85))) для загрузки XML-файла и размещения узла файл Wuredist/стандалонередист/Architecture для архитектуры компьютера. Например, для x86 выберите узел файл Wuredist/Стандалонередист/Architecture с атрибутом **Name** платформы x86.
5.  Вызовите [**ивиндовсупдатеажентинфо:: info**](/windows/desktop/api/Wuapi/nf-wuapi-iwindowsupdateagentinfo-getinfo) , чтобы определить текущую версию WUA. Если **ивиндовсупдатеажентинфо::-info** возвращает номер версии по крайней мере выше, чем атрибут **clientVersion** в узле архитектуры, который вы находили, прервите.
6.  Используйте API-интерфейсы [MSXML](/previous-versions/windows/desktop/ms763742(v=vs.85)) для чтения атрибута **довнлоадурл** из найденного узла архитектуры. **довнлоадурл** предоставляет URL-адрес для скачивания соответствующего установщика агента WUA для архитектуры компьютера.
7.  Используйте API [WinHTTP](../winhttp/winhttp-start-page.md) для загрузки соответствующего установщика.
8.  Используйте функцию [**CreateProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa) или аналогичный API для выполнения скачанного установщика.

 

 
