---
description: Для создания изображения или выполнения операций с плавающей запятой необходимо работать в правильном цветовом пространстве.
ms.assetid: 1DD8E2D3-430F-4EE4-9C41-78736C904920
title: Преобразование данных для цветового пространства
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 91b5dbec2f826c40d5274cbddb3b54d1cdd9f695
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/06/2021
ms.locfileid: "103805602"
---
# <a name="converting-data-for-the-color-space"></a>Преобразование данных для цветового пространства

Для создания изображения или выполнения операций с плавающей запятой необходимо работать в правильном цветовом пространстве. Рекомендуется выполнять операции с плавающей запятой в линейном цветовом пространстве. Затем, чтобы показать изображения на экране, преобразуйте данные в стандартное цветовое пространство RGB (sRGB, гамма 2,2-исправлено). Представление экрана в цветовом пространстве sRGB имеет важное значение для точности цвета. Если изображения не являются гамма-2,2 — исправлены, они выделяют слишком много битов или слишком много пропускной способности, чтобы выделить, что пользователи не могут отличать и слишком мало разрядов или пропускной способности для теневых значений, с которыми они чувствительны, и поэтому требуют большего количества битов или пропускной способности для поддержания одинакового качества визуализации. Таким образом, чтобы обеспечить наилучшую точность цвета, выводятся изображения на экране с гаммой 2,2-исправленными.

-   [Точность цвета](#color-accuracy)
-   [См. также](#related-topics)

## <a name="color-accuracy"></a>Точность цвета

Форматы отображения с целочисленными значениями (например, [**\_ Формат DXGI \_ B8G8R8A8 \_ UNORM \_ sRGB**](/windows/desktop/api/dxgiformat/ne-dxgiformat-dxgi_format), [**\_ Формат DXGI \_ R10G10B10 \_ XR \_ смещение \_ a2 \_ UNORM**](/windows/desktop/api/dxgiformat/ne-dxgiformat-dxgi_format)и т. д.) всегда содержат исправленные данные sRGB. Форматы отображаемых значений с плавающей запятой (в настоящее время только в [**\_ формате DXGI \_ R16G16B16A16 \_ float**](/windows/desktop/api/dxgiformat/ne-dxgiformat-dxgi_format)) содержат линейные значения.

\_ [Модификатор формата](/windows/desktop/api/dxgiformat/ne-dxgiformat-dxgi_format) sRGB указывает операционной системе, что приложение помещает данные sRGB на экране. Приложение всегда должно поместить данные sRGB в задние буферы с форматами с целочисленными значениями, чтобы представлять данные sRGB на экране, даже если у данных нет этого модификатора формата в имени формата. Полный список форматов вывода для просмотра:

-   [Поддержка формата DXGI для оборудования уровня компонентов Direct3D 12,1](hardware-support-for-direct3d-12-1-formats.md)
-   [Поддержка формата DXGI для оборудования уровня компонентов Direct3D 12,0](hardware-support-for-direct3d-12-0-formats.md)
-   [Поддержка формата DXGI для оборудования уровня компонентов Direct3D 11,1](format-support-for-direct3d-11-1-feature-level-hardware.md)
-   [Поддержка формата DXGI для оборудования уровня компонентов Direct3D 11,0](format-support-for-direct3d-11-0-feature-level-hardware.md)
-   [Аппаратная поддержка форматов Direct3D 10Level9](/previous-versions//ff471324(v=vs.85))
-   [Аппаратная поддержка форматов Direct3D 10,1](/previous-versions//cc627091(v=vs.85))
-   [Поддержка оборудования для форматов Direct3D 10](/previous-versions//cc627090(v=vs.85))

При записи выходных значений с плавающей запятой из шейдера пикселей в представления визуализации (**рендертаржетвиев**) с помощью \_ [модификатора формата](/windows/desktop/api/dxgiformat/ne-dxgiformat-dxgi_format) sRGB, привязанного к [конвейеру](/windows/desktop/direct3d11/overviews-direct3d-11-graphics-pipeline), вы преобразуете их в гамма-2,2 — исправленное цветовое пространство. Аналогично, когда в конвейере привязываются представления ресурсов шейдера (**шадерресаурцевиев**) с \_ модификатором формата sRGB, вы преобразуете значения из гамма-2,2 коррекции в цветовую область до линейного цветового пространства при чтении их из **шадерресаурцевиев** s. Затем шейдер может выполнять над ними операции.

Например, используйте код, аналогичный приведенному ниже, для записи выходных значений с плавающей запятой из шейдера в формат **рендертаржетвиев** :


```
struct PSOut
{
    float4 color : SV_Target;
};

PSOut S( PSIn input )
{
    PSOut output;
    output.color = float4( 1.0, 0.0, 0.0, 1.0 );
    return output;
}
```



При возврате подпрограммы «» значения с плавающей запятой (1, 0, 0, 1) преобразуются в формат **рендертаржетвиев** . Затем, если \_ для **рендертаржетвиев** назначается [Модификатор формата](/windows/desktop/api/dxgiformat/ne-dxgiformat-dxgi_format) sRGB, происходит преобразование гаммы.

Эти действия необходимо выполнить, чтобы убедиться, что отображаемое на экране содержимое имеет наилучшую цветовую точность.

**Обеспечение точности цветов в конвейере**

1.  Если у текстуры есть содержимое sRGB, убедитесь, что в **шадерресаурцевиев** есть \_ [Модификатор формата](/windows/desktop/api/dxgiformat/ne-dxgiformat-dxgi_format) sRGB, поэтому при считывании из **шадерресаурцевиев** в шейдер вы преобразуете содержимое текстуры из гамма-2,2 — исправлено цветовое пространство в линейное цветовое пространство.
2.  Убедитесь, что **рендертаржетвиев** также имеет \_ [Модификатор формата](/windows/desktop/api/dxgiformat/ne-dxgiformat-dxgi_format) sRGB, чтобы выходные значения шейдера были преобразованы в гамму.

При выполнении предыдущих шагов при вызове метода [**IDXGISwapChain1::P resent1**](/windows/desktop/api/DXGI1_2/nf-dxgi1_2-idxgiswapchain1-present1) содержимое, отображаемое на экране, имеет наилучшую точность цвета.

Вы можете использовать метод [**ID3D11Device:: креатерендертаржетвиев**](/windows/desktop/api/d3d11/nf-d3d11-id3d11device-createrendertargetview) для создания **формата DXGI с \_ форматом \_ \* \_ sRGB** в задних буферах из цепочки буферов, созданной только с форматом **\_ \_ \* \_ UNORM формата DXGI** . Это специальное исключение для правила создания представлений целевого объекта рендеринга, в котором говорится, что можно использовать другой формат с **ID3D11Device:: креатерендертаржетвиев** только в том случае, если вы создали ресурс, который вы хотите просмотреть с **\_ \_ \* \_ типом формата DXGI**.

Дополнительные сведения о правилах преобразования данных см. в разделе [правила преобразования данных](/windows/desktop/direct3d10/d3d10-graphics-programming-guide-resources-data-conversion).

Сведения о том, как одновременно считывать данные из текстуры и записывать их в текстуру, см. в разделе [Распаковка и упаковка \_ формата упаковки для In-Place редактирования изображений](/windows/desktop/direct3dhlsl/dx-graphics-hlsl-unpacking-packing-dxgi-format).

## <a name="related-topics"></a>См. также

<dl> <dt>

[Улучшение представления с помощью модели перелистывания, "грязных" прямоугольников и областей с прокруткой](dxgi-1-2-presentation-improvements.md)
</dt> </dl>

 

 
