---
description: Реализация расширений контекстного меню
ms.assetid: b8bea667-b9ea-476d-942f-281cb2e9636c
title: Реализация расширений контекстного меню
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c65918f385984355490456cccb626ba297bd3368
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105711971"
---
# <a name="implementing-context-menu-extensions"></a>Реализация расширений контекстного меню

Расширение пространства имен WPD поддерживает расширяемые контекстные меню (или ярлыки). Это меню, которое появляется, когда пользователь щелкает правой кнопкой мыши объект, например файл или папку. Некоторые приложения WPD будут использовать эти расширяемые меню для поддержки операций с содержимым на стороне устройства (или объектами, расположенными на устройстве).

Расширяемые контекстные меню поддерживаются интерфейсами, описанными в следующей таблице. Дополнительные сведения об этих интерфейсах см. в Windows SDK.



| Интерфейс           | Описание                                                                                                                |
|---------------------|----------------------------------------------------------------------------------------------------------------------------|
| IContextMenu        | Оболочка Windows Vista вызывает методы в этом интерфейсе для создания или слияния нового контекстного меню с заданным объектом. |
| IDataObject         | Используется для передачи массива ПИДЛ контекстного меню обработчику контекстного меню.                                                    |
| IPropertySetStorage | Этот интерфейс используется для получения свойств WPD для заданного объекта.                                                    |
| ипропертистораже    | Этот интерфейс также используется для извлечения свойств WPD для заданного объекта.                                               |
| ишеллекстинит       | Инициализирует расширения оболочки Windows Vista для контекстного меню.                                                       |
| IStream             | Будет предоставляться.                                                                                                            |



 

Контекстные меню для WPD реализуются так же, как и любые другие контекстные меню в Windows Vista. Если вы уже реализовали обработчик контекстного меню, можно изменить существующий код таким образом, чтобы он поддерживал содержимое на стороне устройства. Если вы никогда не создавали обработчик контекстного меню, см. раздел Создание обработчиков контекстного меню в Windows SDK.

Две точки, в которых обработчик контекстного меню WPD отличается от любого другого обработчика, находятся в регистрации обработчика и поддержке содержимого на стороне устройства.

 

 



