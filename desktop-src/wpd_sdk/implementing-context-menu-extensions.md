---
description: Реализация расширений контекстного меню
ms.assetid: b8bea667-b9ea-476d-942f-281cb2e9636c
title: Реализация расширений контекстного меню
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 090f37b4cf77f9508e8c149ef6389297c561e1a4e574ef767f3a5e5c7e07fe05
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118194687"
---
# <a name="implementing-context-menu-extensions"></a>Реализация расширений контекстного меню

Расширение пространства имен WPD поддерживает расширяемые контекстные меню (или ярлыки). Это меню, которое появляется, когда пользователь щелкает правой кнопкой мыши объект, например файл или папку. Некоторые приложения WPD будут использовать эти расширяемые меню для поддержки операций с содержимым на стороне устройства (или объектами, расположенными на устройстве).

Расширяемые контекстные меню поддерживаются интерфейсами, описанными в следующей таблице. дополнительные сведения об этих интерфейсах см. в Windows SDK.



| Интерфейс           | Описание                                                                                                                |
|---------------------|----------------------------------------------------------------------------------------------------------------------------|
| IContextMenu        | оболочка Windows Vista вызывает методы в этом интерфейсе для создания или слияния нового контекстного меню с заданным объектом. |
| IDataObject         | Используется для передачи массива ПИДЛ контекстного меню обработчику контекстного меню.                                                    |
| IPropertySetStorage | Этот интерфейс используется для получения свойств WPD для заданного объекта.                                                    |
| ипропертистораже    | Этот интерфейс также используется для извлечения свойств WPD для заданного объекта.                                               |
| ишеллекстинит       | инициализирует расширения оболочки Windows Vista для контекстного меню.                                                       |
| IStream             | Будет предоставляться.                                                                                                            |



 

контекстные меню для WPD реализуются так же, как и любое другое контекстное меню в Windows Vista. Если вы уже реализовали обработчик контекстного меню, можно изменить существующий код таким образом, чтобы он поддерживал содержимое на стороне устройства. если вы никогда не создавали обработчик контекстного меню, см. раздел создание обработчиков контекстного меню в Windows SDK.

Две точки, в которых обработчик контекстного меню WPD отличается от любого другого обработчика, находятся в регистрации обработчика и поддержке содержимого на стороне устройства.

 

 



