---
title: Преобразования (DirectComposition)
description: В этом разделе обсуждается поддержка Microsoft DirectComposition для двухмерных (двумерных) преобразований и описываются типы преобразований, поддерживаемых DirectComposition.
ms.assetid: a0f41cc6-e848-4831-8063-609e17d9b4c6
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 27a1fec5774d208f240e6d2f1c8b7df09d25c486
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2020
ms.locfileid: "104559088"
---
# <a name="transforms-directcomposition"></a>Преобразования (DirectComposition)

> [!NOTE]
> Для приложений в Windows 10 рекомендуется использовать интерфейсы API Windows. UI. компоновки вместо DirectComposition. Дополнительные сведения см. в разделе [модернизировать The классическое приложение с использованием визуального слоя](/windows/uwp/composition/visual-layer-in-desktop-apps).

В этом разделе обсуждается поддержка Microsoft DirectComposition для двухмерных (двумерных) преобразований и описываются типы преобразований, поддерживаемых DirectComposition.

DirectComposition также поддерживает трехмерные преобразования перспективы, но поскольку они нуждаются в создании промежуточного растрового изображения, DirectComposition считает их эффектными, а не преобразованиями. Дополнительные сведения об эффектах преобразования трехмерной перспективы см. в разделе [эффекты](effects.md).

Этот раздел включает следующие подразделы:

-   [Что такое DirectComposition 2D-преобразование?](#what-is-a-directcomposition-2d-transform)
-   [DirectComposition 2D-координатное пространство](#the-directcomposition-2d-coordinate-space)
-   [Поддержка аффинных двумерных преобразований](#support-for-affine-2d-transforms)
-   [Двумерные преобразования матрицы](#matrix-2d-transforms)
-   [Группы преобразований](#transform-groups)
-   [Преобразовать анимацию](#transform-animation)
-   [См. также](#related-topics)

## <a name="what-is-a-directcomposition-2d-transform"></a>Что такое DirectComposition 2D-преобразование?

2D-преобразование позволяет изменять положение, размер или природу визуального элемента в двух измерениях, перемещая визуальный элемент в другое расположение (перевод), делая его большим или меньшим (масштабирование), включая его (вращение) или искажение фигуры (асимметрия).

2D-преобразование достигается путем сопоставления точек визуального элемента от одной позиции к другой внутри одного и того же пространства координат или из одного пространства координат в другое. Это сопоставление описывается таблицей значений, называемой матрицей преобразования, определенной как коллекция из трех строк с тремя столбцами значений с плавающей запятой, как показано в следующей таблице.



|                 |                 |     |
|-----------------|-----------------|-----|
| M11Default: 1,0 | M12Default: 0,0 | 0,0 |
| M21Default: 0,0 | M22Default: 1,0 | 0,0 |
| M31OffsetX: 0,0 | M32OffsetY: 0,0 | 1.0 |



 

Матрица преобразования для аффинных двумерных преобразований представляет собой матрицу размером 3 на 2, которая опускает третий столбец из предыдущей матрицы преобразования. В следующей таблице показан макет этой матрицы.



|                 |                 |
|-----------------|-----------------|
| M11Default: 1,0 | M12Default: 0,0 |
| M21Default: 0,0 | M22Default: 1,0 |
| M31OffsetX: 0,0 | M32OffsetY: 0,0 |



 

> [!Note]  
> DirectComposition не выполняет специальной обработки при применении 2D-преобразований к стерео-содержимому. Это означает, что при применении к нему 2D-преобразования трехмерное содержимое может показаться искаженным.

 

## <a name="the-directcomposition-2d-coordinate-space"></a>DirectComposition 2D-координатное пространство

В DirectComposition используется левое 2D-пространство координат; то есть положительные значения оси x увеличиваются вправо, а положительные значения оси y увеличиваются вниз. Визуальные элементы располагаются относительно источника, то есть точки, в которой пересекаются ось x и y (0,0), как показано на следующем рисунке.

![ось x и ось y левого пространства координат](images/coordinatespace.png)

Управляя значениями в матрице преобразования объемом 3 по 2, можно поворачивать, масштабировать, отклонять и преобразовывать объекты в двух измерениях. Например, если для Оффсеткс задано значение 100, а для параметра offset — 200, то объект перемещается вправо на 100 пикселей и вниз 200 пикселей.

## <a name="support-for-affine-2d-transforms"></a>Поддержка аффинных двумерных преобразований

В следующей таблице описаны типы аффинных преобразований, поддерживаемых DirectComposition, и перечислены интерфейсы, которые можно использовать для выполнения различных типов преобразований.



| Преобразование или интерфейс                                                                               | Описание                                                                                              | Иллюстрация                                                                                                                      |
|---------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------|
| Вращение двухмерной [**идкомпоситионротатетрансформ**](/windows/win32/api/dcomp/nn-dcomp-idcompositionrotatetransform) \[ новой строки\]          | поворот визуального элемента на указанный угол относительно указанной центральной точки.                                 | ![Иллюстрация квадрата, повернутого на 45 градусов по часовой стрелке относительно центра исходного квадрата](images/rotate.png)               |
| Масштабирование строки 2D-[**идкомпоситионскалетрансформ**](/windows/win32/api/dcomp/nn-dcomp-idcompositionscaletransform) \[\]             | масштабирование визуального элемента на указанный коэффициент относительно указанной центральной точки.                                 | ![Иллюстрация квадратной шкалы 130%](images/scale.png)                                                                  |
| Наклон строки 2D [**идкомпоситионскевтрансформ**](/windows/win32/api/dcomp/nn-dcomp-idcompositionskewtransform) \[\]                | наклон визуального элемента на указанный угол вдоль оси x и оси y и вокруг указанной центральной точки. | ![Иллюстрация квадратно наклоненного 30 градусов против часовой стрелки от оси y](images/skew.png)                                   |
| Перевод строки 2D [**идкомпоситионтранслатетрансформ**](/windows/win32/api/dcomp/nn-dcomp-idcompositiontranslatetransform) \[\] | изменение расположения визуального элемента в направлении оси x и оси y.                               | ![Иллюстрация квадрата, перемещенного на 20 единиц вдоль положительной оси x и 10 единиц вдоль положительной оси y](images/translate.png) |



 

## <a name="matrix-2d-transforms"></a>Двумерные преобразования матрицы

Интерфейс [**идкомпоситионматрикстрансформ**](/windows/win32/api/dcomp/nn-dcomp-idcompositionmatrixtransform) позволяет определить собственную матрицу «3 на 2 аффинного преобразования» и применить ее к визуальному элементу. Этот интерфейс полезен, если необходимо применить тип аффинных 2D-преобразования, недоступного через другие интерфейсы преобразования DirectComposition. Вы определяете матрицу, заполняя структуру [**D2D \_ \_ 3X2 \_ F**](/windows/desktop/api/dcommon/ns-dcommon-d2d_matrix_3x2_f) и передавая ее в метод [**идкомпоситионматрикстрансформ:: сетматрикс**](/windows/win32/api/dcomp/nf-dcomp-idcompositionmatrixtransform-setmatrix) .

## <a name="transform-groups"></a>Группы преобразований

Группы преобразования можно использовать для объединения нескольких преобразований в один. Группа преобразования определяет коллекцию объектов Transform, матрицы которых умножаются в том порядке, в котором они указаны в коллекции. Полученная матрица преобразования затем применяется к визуальному элементу. Группа преобразования дает тот же результат, что и применение каждого преобразования отдельно.

Помните, что порядок объектов Transform в группе преобразований важен. Например, если визуальный элемент сначала поворачивается, затем масштабируется, а затем преобразуется, результат будет отличаться от результата, который сначала преобразуется, затем поворачивается, а затем масштабируется. DirectComposition всегда применяет преобразования к визуальному элементу в том порядке, в котором они указаны в коллекции.

Чтобы создать группу преобразования, сначала создайте объекты преобразования, которые необходимо включить в группу, а затем передайте массив указателей объектов преобразования в метод [**идкомпоситиондевице:: креатетрансформграуп**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-createtransformgroup) . После создания группы преобразований нельзя добавлять или удалять объекты преобразования. Однако можно изменить свойства отдельных объектов Transform в коллекции, и изменения будут отражены в результирующей матрице преобразования.

## <a name="transform-animation"></a>Преобразовать анимацию

Свойства преобразования можно анимировать. При анимации свойства DirectComposition изменяет значение свойства с течением времени, а не сразу. Это особенно полезно при создании переходов. Дополнительные сведения см. в разделе [анимация](animation.md).

## <a name="related-topics"></a>См. также

<dl> <dt>

[Основные понятия DirectComposition](directcomposition-concepts.md)
</dt> </dl>

 

 
