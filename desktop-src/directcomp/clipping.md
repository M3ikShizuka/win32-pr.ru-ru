---
title: Обрезка (DirectComposition)
description: В этом разделе описывается поддержка обрезкими визуальных элементов в Microsoft DirectComposition.
ms.assetid: B6E0D8F5-B6B9-40CC-B079-850AC8F2D538
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f4feb537dfb41053dd1099eca7f122b3284dce95
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2020
ms.locfileid: "104414669"
---
# <a name="clipping-directcomposition"></a>Обрезка (DirectComposition)

> [!NOTE]
> Для приложений в Windows 10 рекомендуется использовать интерфейсы API Windows. UI. компоновки вместо DirectComposition. Дополнительные сведения см. в разделе [модернизировать The классическое приложение с использованием визуального слоя](/windows/uwp/composition/visual-layer-in-desktop-apps).

Обрезка позволяет раскрывать только часть визуального или визуального дерева путем ограничения отрисовки визуального элемента или дерева определенной прямоугольной областью. В этом разделе описывается поддержка обрезкими визуальных элементов в Microsoft DirectComposition. Она включает следующие разделы:

-   [Прямоугольник обрезки](#clip-rectangle)
-   [Объект Clip](#clip-object)
-   [Анимированный прямоугольник клипа](#animated-clip-rectangle)
-   [См. также](#related-topics)

## <a name="clip-rectangle"></a>Прямоугольник обрезки

Визуальный объект имеет свойство Clip, определяющее прямоугольную область или *прямоугольный прямоугольник* в содержимом растрового изображения визуального элемента. При отрисовке визуального элемента на экране отображается только часть содержимого растрового изображения, находящаяся внутри прямоугольника обрезки, а содержимое, выходящее за пределы прямоугольника обрезки, обрезается (не рисуется). По умолчанию свойство Clip включает все содержимое растрового изображения.

Свойство Clip для визуального элемента применяется ко всем дочерним и потомкам дочерних элементов. Иными словами, все дочернее или дочернее содержимое, находящееся за пределами границ родительского прямоугольника, также обрезается.

DirectComposition применяет свойство Clip перед применением свойств Оффсеткс, offset и 2D-преобразования, но после применения эффектов и свойств трехмерного преобразования. Это означает, что двумерные преобразования, Оффсеткс и смещение будут влиять как на визуальное содержимое, так и на прямоугольник клипа. В то время как трехмерные преобразования и эффекты не будут применены к прямоугольнику Clip.

Например, при применении смещения или 2D-преобразования к прямоугольнику обрезки применяется матрица преобразования. Таким образом, добавление смещения и 2D-вращения (45 градусов) вместе с скругленным угловым прямоугольником приведет к следующим результатам:

![Схема, демонстрирующая результат 2D-преобразования в прямоугольнике обрезки.](images/clipping2dtransform.png)

При применении трехмерного преобразования «внутри» прямоугольника обрезки матрица преобразования не влияет на прямоугольник. Даже при применении вращения вокруг оси Z (аналогично предыдущему примеру) Следующая диаграмма является результатом:

![Схема, показывающая, что трехмерное преобразование не влияет на прямоугольный ролик (визуальный поворот внутри клипа).](images/clipping3dtransform.png)

Обратите внимание, что визуальный элемент, повернутый в зажиме, потому, что трехмерная матрица не применяется к самому клипу.

Если для свойства Clip задан пустой прямоугольник, визуальный элемент полностью обрезается. Это значит, что визуальный элемент включен в визуальное дерево, но не отображает ничего. Если вы не хотите включать в композицию конкретный визуальный элемент, удалите визуальный элемент из визуального дерева вместо установки пустого прямоугольника обрезки. Удаление визуальных результатов обеспечивает лучшую производительность.

Свойство Clip визуального элемента задается с помощью метода [**идкомпоситионвисуал:: сетклип**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-setclip(constd2d_rect_f_)) . Этот метод включает перегрузки, которые позволяют задать значение свойства Clip в виде статического прямоугольника или объекта Clip. Используйте статический прямоугольник, если не нужно изменять размеры прямоугольника обрезки в течение времени существования визуального элемента. Если необходимо изменить размеры или анимировать прямоугольник обрезки, используйте объект Clip.

## <a name="clip-object"></a>Объект Clip

Объект Clip — это объект модели COM, представляющий прямоугольник Clip. Объект Clip создается с помощью метода [**идкомпоситиондевице:: креатеректанглеклип**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-createrectangleclip) , а затем для задания свойств объекта используется интерфейс [**идкомпоситионректанглеклип**](/windows/win32/api/dcomp/nn-dcomp-idcompositionrectangleclip) объекта. Только что созданный объект Clip имеет минимальные возможные значения для свойств Left и Top, а также максимальное возможное значение для свойств Right и Bottom, что фактически делает его объектом Clip-Op. Иными словами, объект представляет прямоугольник клипа, который будет включать все содержимое растрового изображения визуального элемента.

Объект Clip включает набор свойств, позволяющих указать скругленные углы для объекта Clip. Свойства позволяют задать радиус и радиус оси x для каждого угла объекта обрезки.

## <a name="animated-clip-rectangle"></a>Анимированный прямоугольник клипа

Можно анимировать прямоугольник клипа, применяя объекты анимации к свойствам слева, сверху, справа и снизу объекта Clip. Используйте перегруженный метод [**идкомпоситионвисуал:: сетклип (идкомпоситионклип)**](/windows/win32/api/dcomp/nf-dcomp-idcompositionvisual-setclip(idcompositionclip)) , чтобы применить анимированный прямоугольник клипа к свойству Clip визуального элемента.

Дополнительные сведения об объектах анимации см. в разделе [анимация](animation.md).

## <a name="related-topics"></a>См. также

<dl> <dt>

[Основные понятия DirectComposition](directcomposition-concepts.md)
</dt> <dt>

[Обрезка с помощью объекта прямоугольной обрезки](how-to--set-the-clip-rectangle-for-a-visual.md)
</dt> </dl>

 

 
