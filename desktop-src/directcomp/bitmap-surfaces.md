---
title: Растровые объекты
description: В этом разделе описываются типы растрового содержимого, которое поддерживает DirectComposition.
ms.assetid: BC32CF76-D5E4-4B25-AFD5-42E8DABFA0D0
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bc36253511c060b264039f27975c694272c1c916ad0067c1955fd02f00553d6d
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118089054"
---
# <a name="bitmap-objects"></a>Растровые объекты

> [!NOTE]
> для приложений на Windows 10 рекомендуется использовать интерфейсы api Windows. UI. компоновки вместо DirectComposition. Дополнительные сведения см. в разделе [модернизировать The классическое приложение с использованием визуального слоя](/windows/uwp/composition/visual-layer-in-desktop-apps).

Microsoft DirectComposition — это механизм компоновки точечных рисунков. Он позволяет разработчикам приложений объединять несколько растровых изображений и манипулировать ими различными способами для достижения интересных визуальных эффектов и анимации в пользовательском интерфейсе приложения. В этом разделе описываются типы растрового содержимого, которое поддерживает DirectComposition.

-   [Растровое содержимое](#bitmap-content)
    -   [Растровые изображения видеопамяти](#video-memory-bitmaps)
    -   [Точечные рисунки окна](#window-bitmaps)
    -   [Связывание содержимого растрового изображения с визуальным элементом](#associating-bitmap-content-with-a-visual)
    -   [Альфа-канал](#alpha-channel)
-   [Связанные темы](#related-topics)

## <a name="bitmap-content"></a>Растровое содержимое

Приложения предоставляют DirectComposition с растровым содержимым для создания и анимации путем создания визуальных объектов и установки [свойства содержимого](basic-concepts.md) этих объектов. DirectComposition не предоставляет службы растрирования. Приложение должно использовать другую библиотеку растрирования с аппаратным ускорением, например [Direct2D](../direct2d/direct2d-portal.md) или [Direct3D](/windows/desktop/direct3d11/atoc-dx-graphics-direct3d-11) , для заполнения составных точечных рисунков. После составления DirectComposition передает составное растровое содержимое в [Диспетчер окон рабочего стола (DWM)](/windows/desktop/dwm/dwm-overview) для отрисовки на экране.

**Поддерживаемые типы растрового содержимого** Microsoft DirectComposition поддерживает следующие виды точечных рисунков:

-   [Растровые изображения видеопамяти](#video-memory-bitmaps)
-   [Точечные рисунки окна](#window-bitmaps)

### <a name="video-memory-bitmaps"></a>Растровые изображения видеопамяти

Растровое изображение видеопамяти можно растрово использовать в аппаратном обеспечении с помощью методов Microsoft DirectX (включая модель взаимодействия DX-to-GDI). Он поддерживается перекрестными общими областями, видимыми вызывающему приложению и DirectComposition. Точечный рисунок видеопамяти не подлежит разрыву, так как приложение может считывать данные только из поверхностей, DirectComposition текстуры от.

### <a name="video-content"></a>Видеоматериал

Приложения могут использовать DirectComposition для создания кадров видео, использующих цепочки подкачки DirectX без окон, привязанные к поверхности DirectComposition. По сути, DirectComposition считает содержимое видео последовательностью растровых изображений. DirectComposition не предоставляет средств для представления видеокадров.

DirectComposition поддерживает бесоконные цепочки подкачки, то есть цепочки подкачки, не привязанные к конкретному окну, и позволяет двум различным приложениям совместно использовать цепочки подкачки без окон через границы процесса. Совместное использование бесоконных цепочек подкачки позволяет выполнять видеосценарии, в которых цепочка буферов создается в одном процессе и используется с DirectComposition во втором процессе. Цепочки подкачки без окон создаются с помощью метода [**IDXGIFactory2:: креатесвапчаинфоркомпоситионсурфаце**](/windows/desktop/api/dxgi1_2/nf-dxgi1_2-idxgifactory2-createswapchainforcomposition) .

Дополнительные сведения о цепочках подкачки DirectX см. в статье [Общие сведения о DXGI](/windows/desktop/direct3ddxgi/d3d10-graphics-programming-guide-dxgi).

### <a name="stereo-content"></a>Стерео содержимое

По сути, цепочка стереозвука состоит из поверхностей Microsoft DirectX Graphics Framework (DXGI), представляющих левый и правый каналы для стерео трехмерного содержимого. Если цепочка стереозвука используется в качестве ресурса точечного рисунка для визуального элемента, DirectComposition в стерео. Все нестерео-содержимое (содержимое Mono) считается идентичным левым и правым каналом. то есть для обоих каналов используется одно и то же содержимое растрового изображения. DirectComposition объединяет все содержимое левого и правого содержимого отдельно. Если устройство вывода не поддерживает стерео, DirectComposition рассматривает левый или правый канал (в зависимости от приложения) как содержимое Mono и объединяет его, используя только эти данные для ресурса точечного рисунка.

DirectComposition не поддерживает создание и обработку стерео-содержимого, а также не может повысить уровень цепочки Mono до пары стерео. Приложение должно выполнить эти задачи перед показом содержимого DirectX стерео в DirectComposition. Кроме того, приложение должно предоставлять смещения левого и правого канала для восприятия глубины; DirectComposition не может скорректировать значения левого и правого смещения канала, чтобы изменить воспринимаемую глубину стерео содержимого DirectX.

Стерео-содержимое DirectX состояло и сохраняется в DWM, когда доступно оборудование с поддержкой стерео.

### <a name="window-bitmaps"></a>Точечные рисунки окна

"Точечный рисунок" не является реальным точечным рисунком, но является заполнителем, который DirectComposition заменяет в режиме реального времени с помощью растрирования многоуровневого или дочернего окна верхнего уровня. Растровое изображение окна аналогично эскизу DWM, за исключением того, что эскиз может содержать вклады из многих окон, например принадлежащие дочерние окна, в то время как точечный рисунок окна DirectComposition всегда является представлением всего одного окна и его дочерних элементов.

Поскольку DirectComposition имеет доступ к областям перенаправления всех окон и всех визуальных деревьев, он может повторно использовать содержимое из одного окна в нескольких визуальных деревьях. Окно должно быть разслойно, поскольку в неслоеном окне отсутствует выделенная поверхность перенаправления и, следовательно, ее растрирование не всегда доступна для DirectComposition.

Чтобы использовать точечный рисунок окна, приложение связывает визуальный элемент с дескриптором окна (HWND). После этого DirectComposition повторно создает визуальный элемент при каждом изменении содержимого окна, включая изменение содержимого в результате изменений визуальных деревьев, связанных с окном. Другими словами, как эскизы DWM, точечные рисунки DirectComposition окна являются динамическими.

### <a name="associating-bitmap-content-with-a-visual"></a>Связывание содержимого растрового изображения с визуальным элементом

Для всех трех видов точечных рисунков приложение может связать один и тот же точечный рисунок с несколькими визуальными элементами. Это означает, что одно выделение памяти может использоваться для отображения одного и того же содержимого несколько раз.

### <a name="alpha-channel"></a>Альфа-канал

Все точечные рисунки имеют формат 32 бит на пиксель (бит в пикселах), который включает восемь бит для прозрачности на пиксель. Однако приложение может указать, как DirectComposition должен использовать альфа-канал. В частности, DirectComposition может состоять из альфа-канала или вообще игнорировать альфа-канал. в этом случае точечный рисунок считается полностью непрозрачным.

В дополнительном режиме альфа-канала этот канал игнорируется, но значения красного, зеленого и синего интерпретируются как значения альфа для каждого канала вместо обычной интерпретации этих каналов как интенситиес Color. Этот режим удобен для визуализации с поддержкой ClearType, для чего требуются сведения о покрытии. чтобы использовать режим альфа для каждого канала, приложение должно сначала использовать [Direct2D](../direct2d/direct2d-portal.md) и [DirectWrite](/windows/desktop/DirectWrite/direct-write-portal) для записи данных о покрытии в точечный рисунок. Затем приложение должно установить правильный режим альфа-канала и указать цвет текста при связывании точечного рисунка с визуальным изображением. DirectComposition смешивает цвет текста с данными о покрытии, что обеспечивает ClearType в смешении с фоном.

В ситуациях, когда алгоритм ClearType неприменим, например, если точечный рисунок не соответствует разровну по осям и не должен быть нарисован на промежуточной поверхности, DirectComposition может использовать данные о покрытии в точечном рисунке для создания растрирования в градациях серого вместо этого автоматически и без дополнительных затрат.

Дополнительные сведения см. в описании параметра *алфамоде* функции [**Идкомпоситиондевице:: креатесурфаце**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-createsurface) или [**идкомпоситиондевице:: креатевиртуалсурфаце**](/windows/win32/api/dcomp/nf-dcomp-idcompositiondevice-createvirtualsurface) .

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Основные понятия DirectComposition](directcomposition-concepts.md)
</dt> </dl>

 

 