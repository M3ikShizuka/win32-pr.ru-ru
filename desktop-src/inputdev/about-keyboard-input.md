---
title: О вводе с клавиатуры
description: В этом разделе рассматривается ввод с клавиатуры.
ms.assetid: de34727e-e8c7-481d-982d-0e42a02704db
keywords:
- Ввод данных пользователем, ввод с клавиатуры
- запись вводимых пользователем данных, ввод с клавиатуры
- ввод с клавиатуры
- фокус клавиатуры
- сообщения о нажатии клавиш
- Символьные сообщения
- Системные нажатия клавиш
- несистемные нажатия клавиш
- сообщения несистемных символов
- Мертвые ключи
- сообщения недоставленных символов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0de85794901be3fef37156bde29520039f85702b
ms.sourcegitcommit: b3839bea8d55c981d53cb8802d666bf49093b428
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/16/2021
ms.locfileid: "114373201"
---
# <a name="about-keyboard-input"></a><span data-ttu-id="20a09-114">О вводе с клавиатуры</span><span class="sxs-lookup"><span data-stu-id="20a09-114">About Keyboard Input</span></span>

<span data-ttu-id="20a09-115">Приложения должны принимать ввод пользователя с клавиатуры и с помощью мыши.</span><span class="sxs-lookup"><span data-stu-id="20a09-115">Applications should accept user input from the keyboard as well as from the mouse.</span></span> <span data-ttu-id="20a09-116">Приложение получает ввод с клавиатуры в форме сообщений, размещенных в своих окнах.</span><span class="sxs-lookup"><span data-stu-id="20a09-116">An application receives keyboard input in the form of messages posted to its windows.</span></span>

<span data-ttu-id="20a09-117">В этом разделе описываются следующие темы:</span><span class="sxs-lookup"><span data-stu-id="20a09-117">This section covers the following topics:</span></span>

-   [<span data-ttu-id="20a09-118">Модель ввода с клавиатуры</span><span class="sxs-lookup"><span data-stu-id="20a09-118">Keyboard Input Model</span></span>](#keyboard-input-model)
-   [<span data-ttu-id="20a09-119">Фокус клавиатуры и активация</span><span class="sxs-lookup"><span data-stu-id="20a09-119">Keyboard Focus and Activation</span></span>](#keyboard-focus-and-activation)
-   [<span data-ttu-id="20a09-120">Сообщения о нажатии клавиш</span><span class="sxs-lookup"><span data-stu-id="20a09-120">Keystroke Messages</span></span>](#keystroke-messages)
    -   [<span data-ttu-id="20a09-121">Системные и несистемные нажатия клавиш</span><span class="sxs-lookup"><span data-stu-id="20a09-121">System and Nonsystem Keystrokes</span></span>](#system-and-nonsystem-keystrokes)
    -   [<span data-ttu-id="20a09-122">Описание кодов виртуальных клавиш</span><span class="sxs-lookup"><span data-stu-id="20a09-122">Virtual-Key Codes Described</span></span>](#virtual-key-codes-described)
    -   [<span data-ttu-id="20a09-123">Флаги сообщения о нажатии клавиш</span><span class="sxs-lookup"><span data-stu-id="20a09-123">Keystroke Message Flags</span></span>](#keystroke-message-flags)
-   [<span data-ttu-id="20a09-124">Символьные сообщения</span><span class="sxs-lookup"><span data-stu-id="20a09-124">Character Messages</span></span>](#character-messages)
    -   [<span data-ttu-id="20a09-125">Сообщения несистемных символов</span><span class="sxs-lookup"><span data-stu-id="20a09-125">Nonsystem Character Messages</span></span>](#nonsystem-character-messages)
    -   [<span data-ttu-id="20a09-126">Сообщения недоставленных символов</span><span class="sxs-lookup"><span data-stu-id="20a09-126">Dead-Character Messages</span></span>](#dead-character-messages)
-   [<span data-ttu-id="20a09-127">Состояние ключа</span><span class="sxs-lookup"><span data-stu-id="20a09-127">Key Status</span></span>](#key-status)
-   [<span data-ttu-id="20a09-128">Нажатие клавиш и переводы символов</span><span class="sxs-lookup"><span data-stu-id="20a09-128">Keystroke and Character Translations</span></span>](#keystroke-and-character-translations)
-   [<span data-ttu-id="20a09-129">Поддержка горячего ключа</span><span class="sxs-lookup"><span data-stu-id="20a09-129">Hot-Key Support</span></span>](#hot-key-support)
-   [<span data-ttu-id="20a09-130">Клавиши клавиатуры для обзора и других функций</span><span class="sxs-lookup"><span data-stu-id="20a09-130">Keyboard Keys for Browsing and Other Functions</span></span>](#keyboard-keys-for-browsing-and-other-functions)
-   [<span data-ttu-id="20a09-131">Имитация входных данных</span><span class="sxs-lookup"><span data-stu-id="20a09-131">Simulating Input</span></span>](#simulating-input)
-   [<span data-ttu-id="20a09-132">Языки, языковые стандарты и раскладки клавиатуры</span><span class="sxs-lookup"><span data-stu-id="20a09-132">Languages, Locales, and Keyboard Layouts</span></span>](#languages-locales-and-keyboard-layouts)

## <a name="keyboard-input-model"></a><span data-ttu-id="20a09-133">Модель ввода с клавиатуры</span><span class="sxs-lookup"><span data-stu-id="20a09-133">Keyboard Input Model</span></span>

<span data-ttu-id="20a09-134">Система обеспечивает аппаратную поддержку клавиатуры для приложений, устанавливая драйвер устройства клавиатуры, подходящий для текущей клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="20a09-134">The system provides device-independent keyboard support for applications by installing a keyboard device driver appropriate for the current keyboard.</span></span> <span data-ttu-id="20a09-135">Система обеспечивает независимую от языка клавиатурную поддержку с помощью языковой структуры клавиатуры, выбранной пользователем или приложением.</span><span class="sxs-lookup"><span data-stu-id="20a09-135">The system provides language-independent keyboard support by using the language-specific keyboard layout currently selected by the user or the application.</span></span> <span data-ttu-id="20a09-136">Драйвер устройства клавиатуры получает коды сканирования с клавиатуры, которые отправляются в раскладку клавиатуры, где они преобразуются в сообщения и публикуются в соответствующих окнах приложения.</span><span class="sxs-lookup"><span data-stu-id="20a09-136">The keyboard device driver receives scan codes from the keyboard, which are sent to the keyboard layout where they are translated into messages and posted to the appropriate windows in your application.</span></span>

<span data-ttu-id="20a09-137">Каждому ключу на клавиатуре присваивается уникальное значение, которое называется *кодом сканирования*, зависящим от устройства идентификатором для ключа на клавиатуре.</span><span class="sxs-lookup"><span data-stu-id="20a09-137">Assigned to each key on a keyboard is a unique value called a *scan code*, a device-dependent identifier for the key on the keyboard.</span></span> <span data-ttu-id="20a09-138">Клавиатура формирует два кода сканирования, когда пользователь вводит ключ — один, когда пользователь нажимает клавишу, а другой — когда пользователь отпускает ключ.</span><span class="sxs-lookup"><span data-stu-id="20a09-138">A keyboard generates two scan codes when the user types a key—one when the user presses the key and another when the user releases the key.</span></span>

<span data-ttu-id="20a09-139">Драйвер устройства клавиатуры интерпретирует код сканирования и преобразует его (сопоставляется) в *код виртуального ключа*, аппаратно-независимое значение, определяемое системой и определяющее назначение ключа.</span><span class="sxs-lookup"><span data-stu-id="20a09-139">The keyboard device driver interprets a scan code and translates (maps) it to a *virtual-key code*, a device-independent value defined by the system that identifies the purpose of a key.</span></span> <span data-ttu-id="20a09-140">После перевода кода просмотра раскладка клавиатуры создает сообщение, содержащее код сканирования, код виртуального ключа и другие сведения о нажатии клавиши, а затем помещает сообщение в очередь системных сообщений.</span><span class="sxs-lookup"><span data-stu-id="20a09-140">After translating a scan code, the keyboard layout creates a message that includes the scan code, the virtual-key code, and other information about the keystroke, and then places the message in the system message queue.</span></span> <span data-ttu-id="20a09-141">Система удаляет сообщение из очереди системных сообщений и отправляет его в очередь сообщений соответствующего потока.</span><span class="sxs-lookup"><span data-stu-id="20a09-141">The system removes the message from the system message queue and posts it to the message queue of the appropriate thread.</span></span> <span data-ttu-id="20a09-142">В конечном итоге, цикл обработки сообщений потока удаляет сообщение и передает его в соответствующую процедуру окна при обработке.</span><span class="sxs-lookup"><span data-stu-id="20a09-142">Eventually, the thread's message loop removes the message and passes it to the appropriate window procedure for processing.</span></span> <span data-ttu-id="20a09-143">На следующем рисунке показана модель ввода с клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="20a09-143">The following figure illustrates the keyboard input model.</span></span>

![модель обработки ввода с клавиатуры](images/csinp-01.png)

## <a name="keyboard-focus-and-activation"></a><span data-ttu-id="20a09-145">Фокус клавиатуры и активация</span><span class="sxs-lookup"><span data-stu-id="20a09-145">Keyboard Focus and Activation</span></span>

<span data-ttu-id="20a09-146">Система отправляет сообщения клавиатуры в очередь сообщений основного потока, создавшего окно с фокусом клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="20a09-146">The system posts keyboard messages to the message queue of the foreground thread that created the window with the keyboard focus.</span></span> <span data-ttu-id="20a09-147">*Фокус клавиатуры* является временным свойством окна.</span><span class="sxs-lookup"><span data-stu-id="20a09-147">The *keyboard focus* is a temporary property of a window.</span></span> <span data-ttu-id="20a09-148">Система совместно использует клавиатуру для всех окон на экране, перебирая фокус клавиатуры в направлении пользователя из одного окна в другое.</span><span class="sxs-lookup"><span data-stu-id="20a09-148">The system shares the keyboard among all windows on the display by shifting the keyboard focus, at the user's direction, from one window to another.</span></span> <span data-ttu-id="20a09-149">Окно с фокусом клавиатуры получает (из очереди сообщений создавшего его потока) все сообщения клавиатуры до тех пор, пока фокус не изменится на другое окно.</span><span class="sxs-lookup"><span data-stu-id="20a09-149">The window that has the keyboard focus receives (from the message queue of the thread that created it) all keyboard messages until the focus changes to a different window.</span></span>

<span data-ttu-id="20a09-150">Поток может вызвать функцию [**Focus**](/windows/win32/api/winuser/nf-winuser-getfocus) , чтобы определить, какая из ее окон (если есть) в данный момент имеет фокус клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="20a09-150">A thread can call the [**GetFocus**](/windows/win32/api/winuser/nf-winuser-getfocus) function to determine which of its windows (if any) currently has the keyboard focus.</span></span> <span data-ttu-id="20a09-151">Поток может передать фокус клавиатуры одному из окон, вызвав функцию [**SetFocus**](/windows/win32/api/winuser/nf-winuser-setfocus) .</span><span class="sxs-lookup"><span data-stu-id="20a09-151">A thread can give the keyboard focus to one of its windows by calling the [**SetFocus**](/windows/win32/api/winuser/nf-winuser-setfocus) function.</span></span> <span data-ttu-id="20a09-152">Когда фокус клавиатуры меняется с одного окна на другое, система отправляет сообщение [**WM \_ киллфокус**](wm-killfocus.md) в окно, которое потеряло фокус, а затем отправляет сообщение [**WM \_ SETFOCUS**](wm-setfocus.md) в окно, получивший фокус.</span><span class="sxs-lookup"><span data-stu-id="20a09-152">When the keyboard focus changes from one window to another, the system sends a [**WM\_KILLFOCUS**](wm-killfocus.md) message to the window that has lost the focus, and then sends a [**WM\_SETFOCUS**](wm-setfocus.md) message to the window that has gained the focus.</span></span>

<span data-ttu-id="20a09-153">Понятие фокуса клавиатуры относится к активному окну.</span><span class="sxs-lookup"><span data-stu-id="20a09-153">The concept of keyboard focus is related to that of the active window.</span></span> <span data-ttu-id="20a09-154">*Активное окно* — это окно верхнего уровня, с которым пользователь работает в данный момент.</span><span class="sxs-lookup"><span data-stu-id="20a09-154">The *active window* is the top-level window the user is currently working with.</span></span> <span data-ttu-id="20a09-155">Окно с фокусом клавиатуры является либо активным окном, либо дочерним окном активного окна.</span><span class="sxs-lookup"><span data-stu-id="20a09-155">The window with the keyboard focus is either the active window, or a child window of the active window.</span></span> <span data-ttu-id="20a09-156">Чтобы помочь пользователю определить активное окно, система размещает его в верхней части Z-порядка и выделяет его заголовок (если он имеет одно значение) и границу.</span><span class="sxs-lookup"><span data-stu-id="20a09-156">To help the user identify the active window, the system places it at the top of the Z order and highlights its title bar (if it has one) and border.</span></span>

<span data-ttu-id="20a09-157">Пользователь может активировать окно верхнего уровня, щелкнув его, выбрав его с помощью сочетания клавиш ALT + TAB или ALT + ESC, или выбрав его из список задач.</span><span class="sxs-lookup"><span data-stu-id="20a09-157">The user can activate a top-level window by clicking it, selecting it using the ALT+TAB or ALT+ESC key combination, or selecting it from the Task List.</span></span> <span data-ttu-id="20a09-158">Поток может активировать окно верхнего уровня с помощью функции [**сетактивевиндов**](/windows/win32/api/winuser/nf-winuser-setactivewindow) .</span><span class="sxs-lookup"><span data-stu-id="20a09-158">A thread can activate a top-level window by using the [**SetActiveWindow**](/windows/win32/api/winuser/nf-winuser-setactivewindow) function.</span></span> <span data-ttu-id="20a09-159">Он может определить, активно ли созданное окно верхнего уровня с помощью функции [**жетактивевиндов**](/windows/win32/api/winuser/nf-winuser-getactivewindow) .</span><span class="sxs-lookup"><span data-stu-id="20a09-159">It can determine whether a top-level window it created is active by using the [**GetActiveWindow**](/windows/win32/api/winuser/nf-winuser-getactivewindow) function.</span></span>

<span data-ttu-id="20a09-160">Когда одно окно деактивируется, а другая активируется, система отправляет сообщение [**\_ активации WM**](wm-activate.md) .</span><span class="sxs-lookup"><span data-stu-id="20a09-160">When one window is deactivated and another activated, the system sends the [**WM\_ACTIVATE**](wm-activate.md) message.</span></span> <span data-ttu-id="20a09-161">Младшее слово параметра *wParam* равно нулю, если окно деактивируется, и ненулевое значение, если оно активировано.</span><span class="sxs-lookup"><span data-stu-id="20a09-161">The low-order word of the *wParam* parameter is zero if the window is being deactivated and nonzero if it is being activated.</span></span> <span data-ttu-id="20a09-162">Когда процедура окна по умолчанию получает сообщение об **\_ активации WM** , она устанавливает фокус клавиатуры на активное окно.</span><span class="sxs-lookup"><span data-stu-id="20a09-162">When the default window procedure receives the **WM\_ACTIVATE** message, it sets the keyboard focus to the active window.</span></span>

<span data-ttu-id="20a09-163">Для блокировки событий ввода с клавиатуры и мыши при достижении приложения используйте [**блоккинпут**](/windows/win32/api/winuser/nf-winuser-blockinput).</span><span class="sxs-lookup"><span data-stu-id="20a09-163">To block keyboard and mouse input events from reaching applications, use [**BlockInput**](/windows/win32/api/winuser/nf-winuser-blockinput).</span></span> <span data-ttu-id="20a09-164">Обратите внимание, что функция **блоккинпут** не будет влиять на асинхронную таблицу ввода состояния клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="20a09-164">Note, the **BlockInput** function will not interfere with the asynchronous keyboard input-state table.</span></span> <span data-ttu-id="20a09-165">Это означает, что вызов функции [**SendInput**](/windows/win32/api/winuser/nf-winuser-sendinput) во время блокировки входных данных приведет к изменению таблицы с асинхронным входным состоянием клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="20a09-165">This means that calling the [**SendInput**](/windows/win32/api/winuser/nf-winuser-sendinput) function while input is blocked will change the asynchronous keyboard input-state table.</span></span>

## <a name="keystroke-messages"></a><span data-ttu-id="20a09-166">Сообщения о нажатии клавиш</span><span class="sxs-lookup"><span data-stu-id="20a09-166">Keystroke Messages</span></span>

<span data-ttu-id="20a09-167">Нажатие клавиши приводит к тому, что сообщение [**WM \_ KeyDown**](wm-keydown.md) или [**WM \_ сискэйдовн**](wm-syskeydown.md) помещается в очередь сообщений потока, подключенную к окну с фокусом клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="20a09-167">Pressing a key causes a [**WM\_KEYDOWN**](wm-keydown.md) or [**WM\_SYSKEYDOWN**](wm-syskeydown.md) message to be placed in the thread message queue attached to the window that has the keyboard focus.</span></span> <span data-ttu-id="20a09-168">Освобождение ключа приводит к тому, что сообщение [**WM \_ KEYUP**](wm-keyup.md) или [**WM \_ сискэйуп**](wm-syskeyup.md) помещается в очередь.</span><span class="sxs-lookup"><span data-stu-id="20a09-168">Releasing a key causes a [**WM\_KEYUP**](wm-keyup.md) or [**WM\_SYSKEYUP**](wm-syskeyup.md) message to be placed in the queue.</span></span>

<span data-ttu-id="20a09-169">Сообщения о ключах и ключах обычно встречаются парами, но если пользователь удерживает ключ достаточно долго для запуска функции автоматического повтора клавиатуры, система создает несколько сообщений [**WM \_ KeyDown**](wm-keydown.md) или [**WM \_ сискэйдовн**](wm-syskeydown.md) в строке.</span><span class="sxs-lookup"><span data-stu-id="20a09-169">Key-up and key-down messages typically occur in pairs, but if the user holds down a key long enough to start the keyboard's automatic repeat feature, the system generates a number of [**WM\_KEYDOWN**](wm-keydown.md) or [**WM\_SYSKEYDOWN**](wm-syskeydown.md) messages in a row.</span></span> <span data-ttu-id="20a09-170">Затем он создает одно сообщение [**WM \_ KEYUP**](wm-keyup.md) или [**WM \_ сискэйуп**](wm-syskeyup.md) , когда пользователь отпускает ключ.</span><span class="sxs-lookup"><span data-stu-id="20a09-170">It then generates a single [**WM\_KEYUP**](wm-keyup.md) or [**WM\_SYSKEYUP**](wm-syskeyup.md) message when the user releases the key.</span></span>

<span data-ttu-id="20a09-171">В этом разделе описываются следующие темы:</span><span class="sxs-lookup"><span data-stu-id="20a09-171">This section covers the following topics:</span></span>

-   [<span data-ttu-id="20a09-172">Системные и несистемные нажатия клавиш</span><span class="sxs-lookup"><span data-stu-id="20a09-172">System and Nonsystem Keystrokes</span></span>](#system-and-nonsystem-keystrokes)
-   [<span data-ttu-id="20a09-173">Описание кодов виртуальных клавиш</span><span class="sxs-lookup"><span data-stu-id="20a09-173">Virtual-Key Codes Described</span></span>](#virtual-key-codes-described)
-   [<span data-ttu-id="20a09-174">Флаги сообщения о нажатии клавиш</span><span class="sxs-lookup"><span data-stu-id="20a09-174">Keystroke Message Flags</span></span>](#keystroke-message-flags)

### <a name="system-and-nonsystem-keystrokes"></a><span data-ttu-id="20a09-175">Системные и несистемные нажатия клавиш</span><span class="sxs-lookup"><span data-stu-id="20a09-175">System and Nonsystem Keystrokes</span></span>

<span data-ttu-id="20a09-176">Система делает различие между нажатиями клавиш и несистемными нажатиями.</span><span class="sxs-lookup"><span data-stu-id="20a09-176">The system makes a distinction between system keystrokes and nonsystem keystrokes.</span></span> <span data-ttu-id="20a09-177">Системные нажатия клавиш создают системные сообщения о нажатии клавиш, [**WM \_ Сискэйдовн**](wm-syskeydown.md) и [**WM \_ сискэйуп**](wm-syskeyup.md).</span><span class="sxs-lookup"><span data-stu-id="20a09-177">System keystrokes produce system keystroke messages, [**WM\_SYSKEYDOWN**](wm-syskeydown.md) and [**WM\_SYSKEYUP**](wm-syskeyup.md).</span></span> <span data-ttu-id="20a09-178">Несистемные нажатия клавиш создают несистемные сообщения о нажатии клавиш, [**WM \_ KeyDown**](wm-keydown.md) и [**WM \_ KEYUP**](wm-keyup.md).</span><span class="sxs-lookup"><span data-stu-id="20a09-178">Nonsystem keystrokes produce nonsystem keystroke messages, [**WM\_KEYDOWN**](wm-keydown.md) and [**WM\_KEYUP**](wm-keyup.md).</span></span>

<span data-ttu-id="20a09-179">Если процедура окна должна обработать системное сообщение о нажатии, убедитесь, что после обработки сообщения процедура передает ее функции [**дефвиндовпрок**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) .</span><span class="sxs-lookup"><span data-stu-id="20a09-179">If your window procedure must process a system keystroke message, make sure that after processing the message the procedure passes it to the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function.</span></span> <span data-ttu-id="20a09-180">В противном случае все системные операции, включающие клавишу ALT, будут отключены всякий раз, когда окно имеет фокус клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="20a09-180">Otherwise, all system operations involving the ALT key will be disabled whenever the window has the keyboard focus.</span></span> <span data-ttu-id="20a09-181">То есть пользователь не сможет получить доступ к меню или системному окну окна или использовать сочетание клавиш ALT + ESC или ALT + TAB для активации другого окна.</span><span class="sxs-lookup"><span data-stu-id="20a09-181">That is, the user won't be able to access the window's menus or System menu, or use the ALT+ESC or ALT+TAB key combination to activate a different window.</span></span>

<span data-ttu-id="20a09-182">Системные сообщения о нажатии клавиш предназначены главным образом для использования системой, а не приложением.</span><span class="sxs-lookup"><span data-stu-id="20a09-182">System keystroke messages are primarily for use by the system rather than by an application.</span></span> <span data-ttu-id="20a09-183">Система использует их для предоставления встроенного интерфейса клавиатуры меню и позволяет пользователю управлять тем, какое окно активно.</span><span class="sxs-lookup"><span data-stu-id="20a09-183">The system uses them to provide its built-in keyboard interface to menus and to allow the user to control which window is active.</span></span> <span data-ttu-id="20a09-184">Системные сообщения о нажатии клавиш генерируются, когда пользователь вводит ключ в сочетании с клавишей ALT, или когда пользователь вводит и не имеет фокуса клавиатуры (например, если активное приложение является сведенным).</span><span class="sxs-lookup"><span data-stu-id="20a09-184">System keystroke messages are generated when the user types a key in combination with the ALT key, or when the user types and no window has the keyboard focus (for example, when the active application is minimized).</span></span> <span data-ttu-id="20a09-185">В этом случае сообщения помещаются в очередь сообщений, присоединенную к активному окну.</span><span class="sxs-lookup"><span data-stu-id="20a09-185">In this case, the messages are posted to the message queue attached to the active window.</span></span>

<span data-ttu-id="20a09-186">Несистемные сообщения о нажатии клавиш предназначены для использования в окнах приложений; Функция [**дефвиндовпрок**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) не выполняет никаких действий с ними.</span><span class="sxs-lookup"><span data-stu-id="20a09-186">Nonsystem keystroke messages are for use by application windows; the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function does nothing with them.</span></span> <span data-ttu-id="20a09-187">Процедура окна может отменить любые несистемные сообщения о нажатии клавиш, которые не требуются.</span><span class="sxs-lookup"><span data-stu-id="20a09-187">A window procedure can discard any nonsystem keystroke messages that it does not need.</span></span>

### <a name="virtual-key-codes-described"></a><span data-ttu-id="20a09-188">Описанные Virtual-Key коды</span><span class="sxs-lookup"><span data-stu-id="20a09-188">Virtual-Key Codes Described</span></span>

<span data-ttu-id="20a09-189">Параметр **wParam** сообщения с нажатием клавиши содержит код виртуального ключа нажатого или освобожденного ключа.</span><span class="sxs-lookup"><span data-stu-id="20a09-189">The **wParam** parameter of a keystroke message contains the virtual-key code of the key that was pressed or released.</span></span> <span data-ttu-id="20a09-190">Оконная процедура обрабатывает или игнорирует сообщение о нажатии клавиши в зависимости от значения в коде виртуального ключа.</span><span class="sxs-lookup"><span data-stu-id="20a09-190">A window procedure processes or ignores a keystroke message, depending on the value of the virtual-key code.</span></span>

<span data-ttu-id="20a09-191">Типичная процедура окна обрабатывает только небольшое подмножество получаемых сообщений о нажатии клавиш и игнорирует остальные.</span><span class="sxs-lookup"><span data-stu-id="20a09-191">A typical window procedure processes only a small subset of the keystroke messages that it receives and ignores the rest.</span></span> <span data-ttu-id="20a09-192">Например, процедура окна может обрабатывать только WM-сообщения с нажатием клавиши [**\_ KeyDown**](wm-keydown.md) и только те, которые содержат коды виртуальных клавиш для клавиш перемещения курсора, клавиши Shift (также называемые клавишами управления) и функциональные клавиши.</span><span class="sxs-lookup"><span data-stu-id="20a09-192">For example, a window procedure might process only [**WM\_KEYDOWN**](wm-keydown.md) keystroke messages, and only those that contain virtual-key codes for the cursor movement keys, shift keys (also called control keys), and function keys.</span></span> <span data-ttu-id="20a09-193">Типичная процедура окна не обрабатывает сообщения нажатия клавиш из символьных клавиш.</span><span class="sxs-lookup"><span data-stu-id="20a09-193">A typical window procedure does not process keystroke messages from character keys.</span></span> <span data-ttu-id="20a09-194">Вместо этого он использует функцию [**TranslateMessage**](/windows/desktop/api/winuser/nf-winuser-translatemessage) для преобразования сообщения в символьные сообщения.</span><span class="sxs-lookup"><span data-stu-id="20a09-194">Instead, it uses the [**TranslateMessage**](/windows/desktop/api/winuser/nf-winuser-translatemessage) function to convert the message into character messages.</span></span> <span data-ttu-id="20a09-195">Дополнительные сведения о **TranslateMessage** и символьных сообщениях см. в разделе [Message characters](#character-messages).</span><span class="sxs-lookup"><span data-stu-id="20a09-195">For more information about **TranslateMessage** and character messages, see [Character Messages](#character-messages).</span></span>

### <a name="keystroke-message-flags"></a><span data-ttu-id="20a09-196">Флаги сообщения о нажатии клавиш</span><span class="sxs-lookup"><span data-stu-id="20a09-196">Keystroke Message Flags</span></span>

<span data-ttu-id="20a09-197">Параметр **lParam** сообщения с нажатием клавиши содержит дополнительные сведения о нажатии клавиши, создавшей сообщение.</span><span class="sxs-lookup"><span data-stu-id="20a09-197">The **lParam** parameter of a keystroke message contains additional information about the keystroke that generated the message.</span></span> <span data-ttu-id="20a09-198">Эти сведения включают число повторов, код сканирования, флаг расширенного ключа, код контекста, предыдущий флаг состояния и флаг состояния перехода.</span><span class="sxs-lookup"><span data-stu-id="20a09-198">This information includes the repeat count, the scan code, the extended-key flag, the context code, the previous key-state flag, and the transition-state flag.</span></span> <span data-ttu-id="20a09-199">На следующем рисунке показаны расположения этих флагов и значений в параметре **lParam** .</span><span class="sxs-lookup"><span data-stu-id="20a09-199">The following illustration shows the locations of these flags and values in the **lParam** parameter.</span></span>

![Расположение флагов и значений в параметре LPARAM сообщения о нажатии клавиши](images/csinp-02.png)

<span data-ttu-id="20a09-201">Приложение может использовать следующие значения для управления флагами нажатия клавиш.</span><span class="sxs-lookup"><span data-stu-id="20a09-201">An application can use the following values to manipulate the keystroke flags.</span></span>



| <span data-ttu-id="20a09-202">Значение</span><span class="sxs-lookup"><span data-stu-id="20a09-202">Value</span></span>            | <span data-ttu-id="20a09-203">Описание</span><span class="sxs-lookup"><span data-stu-id="20a09-203">Description</span></span>                                                                       |
|------------------|-----------------------------------------------------------------------------------|
| <span data-ttu-id="20a09-204">**КФ \_ алтдовн**</span><span class="sxs-lookup"><span data-stu-id="20a09-204">**KF\_ALTDOWN**</span></span>  | <span data-ttu-id="20a09-205">Управляет флагом клавиши ALT, который указывает, нажата ли клавиша ALT.</span><span class="sxs-lookup"><span data-stu-id="20a09-205">Manipulates the ALT key flag, which indicates whether the ALT key is pressed.</span></span>     |
| <span data-ttu-id="20a09-206">**КФ \_ длгмоде**</span><span class="sxs-lookup"><span data-stu-id="20a09-206">**KF\_DLGMODE**</span></span>  | <span data-ttu-id="20a09-207">Управляет флагом режима диалогового окна, указывающим, является ли диалоговое окно активным.</span><span class="sxs-lookup"><span data-stu-id="20a09-207">Manipulates the dialog mode flag, which indicates whether a dialog box is active.</span></span> |
| <span data-ttu-id="20a09-208">**КФ \_ Расширенная**</span><span class="sxs-lookup"><span data-stu-id="20a09-208">**KF\_EXTENDED**</span></span> | <span data-ttu-id="20a09-209">Управляет флагом расширенного ключа.</span><span class="sxs-lookup"><span data-stu-id="20a09-209">Manipulates the extended key flag.</span></span>                                                |
| <span data-ttu-id="20a09-210">**КФ \_ менумоде**</span><span class="sxs-lookup"><span data-stu-id="20a09-210">**KF\_MENUMODE**</span></span> | <span data-ttu-id="20a09-211">Управляет флагом режима меню, указывающим, является ли меню активным.</span><span class="sxs-lookup"><span data-stu-id="20a09-211">Manipulates the menu mode flag, which indicates whether a menu is active.</span></span>         |
| <span data-ttu-id="20a09-212">**\_Повтор КФ**</span><span class="sxs-lookup"><span data-stu-id="20a09-212">**KF\_REPEAT**</span></span>   | <span data-ttu-id="20a09-213">Управляет предыдущим флагом состояния ключа.</span><span class="sxs-lookup"><span data-stu-id="20a09-213">Manipulates the previous key state flag.</span></span>                                          |
| <span data-ttu-id="20a09-214">**КФ \_ up**</span><span class="sxs-lookup"><span data-stu-id="20a09-214">**KF\_UP**</span></span>       | <span data-ttu-id="20a09-215">Управляет флагом состояния перехода.</span><span class="sxs-lookup"><span data-stu-id="20a09-215">Manipulates the transition state flag.</span></span>                                            |

<span data-ttu-id="20a09-216">Пример кода:</span><span class="sxs-lookup"><span data-stu-id="20a09-216">Example code:</span></span>

```cpp
case WM_KEYDOWN:
case WM_KEYUP:
case WM_SYSKEYDOWN:
case WM_SYSKEYUP:
{
    WORD vkCode = LOWORD(wParam);                                       // virtual-key code

    BYTE scanCode = LOBYTE(HIWORD(lParam));                             // scan code
    BOOL scanCodeE0 = (HIWORD(lParam) & KF_EXTENDED) == KF_EXTENDED;    // extended-key flag, 1 if scancode has 0xE0 prefix

    BOOL upFlag = (HIWORD(lParam) & KF_UP) == KF_UP;                    // transition-state flag, 1 on keyup
    BOOL repeatFlag = (HIWORD(lParam) & KF_REPEAT) == KF_REPEAT;        // previous key-state flag, 1 on autorepeat
    WORD repeatCount = LOWORD(lParam);                                  // repeat count, > 0 if several keydown messages was combined into one message

    BOOL altDownFlag = (HIWORD(lParam) & KF_ALTDOWN) == KF_ALTDOWN;     // ALT key was pressed

    BOOL dlgModeFlag = (HIWORD(lParam) & KF_DLGMODE) == KF_DLGMODE;     // dialog box is active
    BOOL menuModeFlag = (HIWORD(lParam) & KF_MENUMODE) == KF_MENUMODE;  // menu is active
    
    // ...
}
break;
```

### <a name="repeat-count"></a><span data-ttu-id="20a09-217">Число повторов</span><span class="sxs-lookup"><span data-stu-id="20a09-217">Repeat Count</span></span>

<span data-ttu-id="20a09-218">Можно проверить число повторов, чтобы определить, представляет ли сообщение с нажатием клавиши более одного нажатия.</span><span class="sxs-lookup"><span data-stu-id="20a09-218">You can check the repeat count to determine whether a keystroke message represents more than one keystroke.</span></span> <span data-ttu-id="20a09-219">Система увеличивает число, когда клавиатура создает [**WM \_ KeyDown**](wm-keydown.md) или [**WM \_ сискэйдовн**](wm-syskeydown.md) сообщения быстрее, чем приложение может их обработать.</span><span class="sxs-lookup"><span data-stu-id="20a09-219">The system increments the count when the keyboard generates [**WM\_KEYDOWN**](wm-keydown.md) or [**WM\_SYSKEYDOWN**](wm-syskeydown.md) messages faster than an application can process them.</span></span> <span data-ttu-id="20a09-220">Это часто происходит, когда пользователь удерживает ключ достаточно долго для запуска функции автоматического повтора клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="20a09-220">This often occurs when the user holds down a key long enough to start the keyboard's automatic repeat feature.</span></span> <span data-ttu-id="20a09-221">Вместо того чтобы заполнять очередь системных сообщений с помощью полученных сообщений о ключах, система объединяет сообщения в одно ключевое сообщение и увеличивает число повторов.</span><span class="sxs-lookup"><span data-stu-id="20a09-221">Instead of filling the system message queue with the resulting key-down messages, the system combines the messages into a single key down message and increments the repeat count.</span></span> <span data-ttu-id="20a09-222">Освобождение ключа не может запустить функцию автоматической повторной отправки, поэтому число повторов для сообщений [**WM \_ KEYUP**](wm-keyup.md) и [**WM \_ сискэйуп**](wm-syskeyup.md) всегда равно 1.</span><span class="sxs-lookup"><span data-stu-id="20a09-222">Releasing a key cannot start the automatic repeat feature, so the repeat count for [**WM\_KEYUP**](wm-keyup.md) and [**WM\_SYSKEYUP**](wm-syskeyup.md) messages is always set to 1.</span></span>

### <a name="scan-code"></a><span data-ttu-id="20a09-223">Код сканирования</span><span class="sxs-lookup"><span data-stu-id="20a09-223">Scan Code</span></span>

<span data-ttu-id="20a09-224">Код сканирования — это значение, которое генерирует аппаратное обеспечение клавиатуры при нажатии пользователем клавиши.</span><span class="sxs-lookup"><span data-stu-id="20a09-224">The scan code is the value that the keyboard hardware generates when the user presses a key.</span></span> <span data-ttu-id="20a09-225">Это зависящее от устройства значение, идентифицирующее нажатую клавишу, а не символ, представленный ключом.</span><span class="sxs-lookup"><span data-stu-id="20a09-225">It is a device-dependent value that identifies the key pressed, as opposed to the character represented by the key.</span></span> <span data-ttu-id="20a09-226">Приложение обычно игнорирует коды проверки.</span><span class="sxs-lookup"><span data-stu-id="20a09-226">An application typically ignores scan codes.</span></span> <span data-ttu-id="20a09-227">Вместо этого он использует ненезависимые от устройства коды виртуальных клавиш для интерпретации сообщений о нажатии клавиш.</span><span class="sxs-lookup"><span data-stu-id="20a09-227">Instead, it uses the device-independent virtual-key codes to interpret keystroke messages.</span></span>

### <a name="extended-key-flag"></a><span data-ttu-id="20a09-228">Флаг Extended-Key</span><span class="sxs-lookup"><span data-stu-id="20a09-228">Extended-Key Flag</span></span>

<span data-ttu-id="20a09-229">Флаг расширенного ключа указывает, поступило ли сообщение о нажатии клавиши из одного из дополнительных клавиш на расширенной клавиатуре.</span><span class="sxs-lookup"><span data-stu-id="20a09-229">The extended-key flag indicates whether the keystroke message originated from one of the additional keys on the enhanced keyboard.</span></span> <span data-ttu-id="20a09-230">Расширенные ключи состоят из клавиш ALT и CTRL в правой части клавиатуры; клавиши INS, DEL, ДОМАШНяя, КОНЕЧная страница вверх, PAGE DOWN и стрелка в кластерах слева от цифровой клавиатуры; Клавиша NUM LOCK; Клавиша BREAK (CTRL + ПАУЗа); Клавиша PRINT СКРН; и клавиши деления (/) и ENTER на цифровой клавиатуре.</span><span class="sxs-lookup"><span data-stu-id="20a09-230">The extended keys consist of the ALT and CTRL keys on the right-hand side of the keyboard; the INS, DEL, HOME, END, PAGE UP, PAGE DOWN, and arrow keys in the clusters to the left of the numeric keypad; the NUM LOCK key; the BREAK (CTRL+PAUSE) key; the PRINT SCRN key; and the divide (/) and ENTER keys in the numeric keypad.</span></span> <span data-ttu-id="20a09-231">Флаг расширенного ключа устанавливается, если ключ является расширенным ключом.</span><span class="sxs-lookup"><span data-stu-id="20a09-231">The extended-key flag is set if the key is an extended key.</span></span>

<span data-ttu-id="20a09-232">Если указано, код сканирования должен предшествовать байту префикса со значением 0xE0 (224).</span><span class="sxs-lookup"><span data-stu-id="20a09-232">If specified, the scan code was preceded by a prefix byte having the value 0xE0 (224).</span></span>

### <a name="context-code"></a><span data-ttu-id="20a09-233">Код контекста</span><span class="sxs-lookup"><span data-stu-id="20a09-233">Context Code</span></span>

<span data-ttu-id="20a09-234">Код контекста указывает, была ли нажата клавиша ALT при создании сообщения с нажатием клавиши.</span><span class="sxs-lookup"><span data-stu-id="20a09-234">The context code indicates whether the ALT key was down when the keystroke message was generated.</span></span> <span data-ttu-id="20a09-235">Код равен 1, если клавиша ALT была нажата, и 0, если он был включен.</span><span class="sxs-lookup"><span data-stu-id="20a09-235">The code is 1 if the ALT key was down and 0 if it was up.</span></span>

### <a name="previous-key-state-flag"></a><span data-ttu-id="20a09-236">Предыдущий Key-State флаг</span><span class="sxs-lookup"><span data-stu-id="20a09-236">Previous Key-State Flag</span></span>

<span data-ttu-id="20a09-237">Предыдущий флаг состояния ключа указывает, был ли ключ, создавший сообщение нажатия клавиши, выше или выше.</span><span class="sxs-lookup"><span data-stu-id="20a09-237">The previous key-state flag indicates whether the key that generated the keystroke message was previously up or down.</span></span> <span data-ttu-id="20a09-238">Значение равно 1, если ключ был ранее отключен, и 0, если ключ был выше.</span><span class="sxs-lookup"><span data-stu-id="20a09-238">It is 1 if the key was previously down and 0 if the key was previously up.</span></span> <span data-ttu-id="20a09-239">Этот флаг можно использовать для указания сообщений о нажатии клавиш, созданных функцией автоматической повтора клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="20a09-239">You can use this flag to identify keystroke messages generated by the keyboard's automatic repeat feature.</span></span> <span data-ttu-id="20a09-240">Этот флаг имеет значение 1 для сообщений о нажатии клавиш WM [**\_ KeyDown**](wm-keydown.md) и [**WM \_ сискэйдовн**](wm-syskeydown.md) , созданных функцией автоматического повтора.</span><span class="sxs-lookup"><span data-stu-id="20a09-240">This flag is set to 1 for [**WM\_KEYDOWN**](wm-keydown.md) and [**WM\_SYSKEYDOWN**](wm-syskeydown.md) keystroke messages generated by the automatic repeat feature.</span></span> <span data-ttu-id="20a09-241">Всегда имеет значение 1 для сообщений [**WM \_ KEYUP**](wm-keyup.md) и [**WM \_ сискэйуп**](wm-syskeyup.md) .</span><span class="sxs-lookup"><span data-stu-id="20a09-241">It is always set to 1 for [**WM\_KEYUP**](wm-keyup.md) and [**WM\_SYSKEYUP**](wm-syskeyup.md) messages.</span></span>

### <a name="transition-state-flag"></a><span data-ttu-id="20a09-242">Флаг Transition-State</span><span class="sxs-lookup"><span data-stu-id="20a09-242">Transition-State Flag</span></span>

<span data-ttu-id="20a09-243">Флаг перехода в состояние указывает на нажатие клавиши или освобождение ключа, создавшего сообщение о нажатии клавиши.</span><span class="sxs-lookup"><span data-stu-id="20a09-243">The transition-state flag indicates whether pressing a key or releasing a key generated the keystroke message.</span></span> <span data-ttu-id="20a09-244">Этот флаг всегда имеет значение 0 для сообщений [**WM \_ KeyDown**](wm-keydown.md) и [**WM \_ сискэйдовн**](wm-syskeydown.md) . всегда имеет значение 1 для сообщений [**WM \_ KEYUP**](wm-keyup.md) и [**WM \_ сискэйуп**](wm-syskeyup.md) .</span><span class="sxs-lookup"><span data-stu-id="20a09-244">This flag is always set to 0 for [**WM\_KEYDOWN**](wm-keydown.md) and [**WM\_SYSKEYDOWN**](wm-syskeydown.md) messages; it is always set to 1 for [**WM\_KEYUP**](wm-keyup.md) and [**WM\_SYSKEYUP**](wm-syskeyup.md) messages.</span></span>

## <a name="character-messages"></a><span data-ttu-id="20a09-245">Символьные сообщения</span><span class="sxs-lookup"><span data-stu-id="20a09-245">Character Messages</span></span>

<span data-ttu-id="20a09-246">Сообщения о нажатии клавиш предоставляют много информации о нажатиях клавиш, но не содержат кодов символов для нажатия клавиш.</span><span class="sxs-lookup"><span data-stu-id="20a09-246">Keystroke messages provide a lot of information about keystrokes, but they do not provide character codes for character keystrokes.</span></span> <span data-ttu-id="20a09-247">Чтобы получить коды символов, приложение должно включить функцию [**TranslateMessage**](/windows/desktop/api/winuser/nf-winuser-translatemessage) в цикл обработки сообщений потока.</span><span class="sxs-lookup"><span data-stu-id="20a09-247">To retrieve character codes, an application must include the [**TranslateMessage**](/windows/desktop/api/winuser/nf-winuser-translatemessage) function in its thread message loop.</span></span> <span data-ttu-id="20a09-248">**TranslateMessage** передает сообщение [**WM \_ KeyDown**](wm-keydown.md) или [**WM \_ сискэйдовн**](wm-syskeydown.md) в раскладку клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="20a09-248">**TranslateMessage** passes a [**WM\_KEYDOWN**](wm-keydown.md) or [**WM\_SYSKEYDOWN**](wm-syskeydown.md) message to the keyboard layout.</span></span> <span data-ttu-id="20a09-249">Макет проверяет код виртуального ключа сообщения и, если он соответствует ключу символа, предоставляет эквивалент кода символа (принимая во внимание состояние клавиш SHIFT и CAPS LOCK).</span><span class="sxs-lookup"><span data-stu-id="20a09-249">The layout examines the message's virtual-key code and, if it corresponds to a character key, provides the character code equivalent (taking into account the state of the SHIFT and CAPS LOCK keys).</span></span> <span data-ttu-id="20a09-250">Затем он создает символьное сообщение, содержащее код символа и размещает сообщение в верхней части очереди сообщений.</span><span class="sxs-lookup"><span data-stu-id="20a09-250">It then generates a character message that includes the character code and places the message at the top of the message queue.</span></span> <span data-ttu-id="20a09-251">Следующая итерация цикла обработки сообщений удаляет символьное сообщение из очереди и отправляет сообщение в соответствующую процедуру окна.</span><span class="sxs-lookup"><span data-stu-id="20a09-251">The next iteration of the message loop removes the character message from the queue and dispatches the message to the appropriate window procedure.</span></span>

<span data-ttu-id="20a09-252">В этом разделе описываются следующие темы:</span><span class="sxs-lookup"><span data-stu-id="20a09-252">This section covers the following topics:</span></span>

-   [<span data-ttu-id="20a09-253">Сообщения несистемных символов</span><span class="sxs-lookup"><span data-stu-id="20a09-253">Nonsystem Character Messages</span></span>](#nonsystem-character-messages)
-   [<span data-ttu-id="20a09-254">Сообщения недоставленных символов</span><span class="sxs-lookup"><span data-stu-id="20a09-254">Dead-Character Messages</span></span>](#dead-character-messages)

### <a name="nonsystem-character-messages"></a><span data-ttu-id="20a09-255">Сообщения несистемных символов</span><span class="sxs-lookup"><span data-stu-id="20a09-255">Nonsystem Character Messages</span></span>

<span data-ttu-id="20a09-256">Процедура окна может принимать следующие символьные сообщения: [**WM \_ char**](wm-char.md), [**WM \_ деадчар**](wm-deadchar.md), [**WM \_ сисчар**](/windows/desktop/menurc/wm-syschar), [**WM \_ сисдеадчар**](wm-sysdeadchar.md)и [**WM \_ уничар**](wm-unichar.md).</span><span class="sxs-lookup"><span data-stu-id="20a09-256">A window procedure can receive the following character messages: [**WM\_CHAR**](wm-char.md), [**WM\_DEADCHAR**](wm-deadchar.md), [**WM\_SYSCHAR**](/windows/desktop/menurc/wm-syschar), [**WM\_SYSDEADCHAR**](wm-sysdeadchar.md), and [**WM\_UNICHAR**](wm-unichar.md).</span></span> <span data-ttu-id="20a09-257">Функция [**TranslateMessage**](/windows/desktop/api/winuser/nf-winuser-translatemessage) создает сообщение **WM \_ char** или **WM \_ деадчар** при обработке сообщения [**WM \_ KeyDown**](wm-keydown.md) .</span><span class="sxs-lookup"><span data-stu-id="20a09-257">The [**TranslateMessage**](/windows/desktop/api/winuser/nf-winuser-translatemessage) function generates a **WM\_CHAR** or **WM\_DEADCHAR** message when it processes a [**WM\_KEYDOWN**](wm-keydown.md) message.</span></span> <span data-ttu-id="20a09-258">Аналогичным образом создается сообщение **WM \_ Сисчар** или **WM \_ сисдеадчар** при обработке сообщения [**WM \_ сискэйдовн**](wm-syskeydown.md) .</span><span class="sxs-lookup"><span data-stu-id="20a09-258">Similarly, it generates a **WM\_SYSCHAR** or **WM\_SYSDEADCHAR** message when it processes a [**WM\_SYSKEYDOWN**](wm-syskeydown.md) message.</span></span>

<span data-ttu-id="20a09-259">Приложение, обрабатывающее ввод с клавиатуры, обычно игнорирует все сообщения, кроме [**WM \_ char**](wm-char.md) и [**WM \_ уничар**](wm-unichar.md) , передавая все остальные сообщения в функцию [**дефвиндовпрок**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) .</span><span class="sxs-lookup"><span data-stu-id="20a09-259">An application that processes keyboard input typically ignores all but the [**WM\_CHAR**](wm-char.md) and [**WM\_UNICHAR**](wm-unichar.md) messages, passing any other messages to the [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) function.</span></span> <span data-ttu-id="20a09-260">Обратите внимание, что **WM \_ char** использует 16-разрядный формат преобразования Юникода (UTF), тогда как **WM \_ уничар** использует UTF-32.</span><span class="sxs-lookup"><span data-stu-id="20a09-260">Note that **WM\_CHAR** uses 16-bit Unicode Transformation Format (UTF) while **WM\_UNICHAR** uses UTF-32.</span></span> <span data-ttu-id="20a09-261">Система использует сообщения [**WM \_ Сисчар**](/windows/desktop/menurc/wm-syschar) и [**WM \_ сисдеадчар**](wm-sysdeadchar.md) для реализации мнемоник меню.</span><span class="sxs-lookup"><span data-stu-id="20a09-261">The system uses the [**WM\_SYSCHAR**](/windows/desktop/menurc/wm-syschar) and [**WM\_SYSDEADCHAR**](wm-sysdeadchar.md) messages to implement menu mnemonics.</span></span>

<span data-ttu-id="20a09-262">Параметр **wParam** всех символьных сообщений содержит код символа нажатой клавиши.</span><span class="sxs-lookup"><span data-stu-id="20a09-262">The **wParam** parameter of all character messages contains the character code of the character key that was pressed.</span></span> <span data-ttu-id="20a09-263">Значение кода символа зависит от класса окна окна, получающего сообщение.</span><span class="sxs-lookup"><span data-stu-id="20a09-263">The value of the character code depends on the window class of the window receiving the message.</span></span> <span data-ttu-id="20a09-264">Если версия функции [**registerClass**](/windows/desktop/api/winuser/nf-winuser-registerclassa) , используемая в Юникоде, использовалась для регистрации класса Window, система предоставляет символы Юникода всем окнам этого класса.</span><span class="sxs-lookup"><span data-stu-id="20a09-264">If the Unicode version of the [**RegisterClass**](/windows/desktop/api/winuser/nf-winuser-registerclassa) function was used to register the window class, the system provides Unicode characters to all windows of that class.</span></span> <span data-ttu-id="20a09-265">В противном случае система предоставляет коды символов ASCII.</span><span class="sxs-lookup"><span data-stu-id="20a09-265">Otherwise, the system provides ASCII character codes.</span></span> <span data-ttu-id="20a09-266">Дополнительные сведения см. в разделе [Юникод и](/windows/desktop/Intl/unicode-and-character-sets)кодировки.</span><span class="sxs-lookup"><span data-stu-id="20a09-266">For more information, see [Unicode and Character Sets](/windows/desktop/Intl/unicode-and-character-sets).</span></span>

<span data-ttu-id="20a09-267">Содержимое параметра **lParam** символьного сообщения идентично содержимому параметра **lParam** сообщения о нажатии клавиши, которое было преобразовано для создания символьного сообщения.</span><span class="sxs-lookup"><span data-stu-id="20a09-267">The contents of the **lParam** parameter of a character message are identical to the contents of the **lParam** parameter of the key-down message that was translated to produce the character message.</span></span> <span data-ttu-id="20a09-268">Дополнительные сведения см. в разделе [Флаги сообщения о нажатии клавиш](#keystroke-message-flags).</span><span class="sxs-lookup"><span data-stu-id="20a09-268">For information, see [Keystroke Message Flags](#keystroke-message-flags).</span></span>

### <a name="dead-character-messages"></a><span data-ttu-id="20a09-269">Сообщения Dead-Character</span><span class="sxs-lookup"><span data-stu-id="20a09-269">Dead-Character Messages</span></span>

<span data-ttu-id="20a09-270">Некоторые неанглийские клавиатуры содержат ключи символов, которые не должны создавать символы самостоятельно.</span><span class="sxs-lookup"><span data-stu-id="20a09-270">Some non-English keyboards contain character keys that are not expected to produce characters by themselves.</span></span> <span data-ttu-id="20a09-271">Вместо этого они используются для добавления диакритических знаков к символу, созданному последующим нажатием клавиши.</span><span class="sxs-lookup"><span data-stu-id="20a09-271">Instead, they are used to add a diacritic to the character produced by the subsequent keystroke.</span></span> <span data-ttu-id="20a09-272">Эти ключи называются *неработающими ключами*.</span><span class="sxs-lookup"><span data-stu-id="20a09-272">These keys are called *dead keys*.</span></span> <span data-ttu-id="20a09-273">Клавиша с циркумфлексом на немецкой клавиатуре является примером неработающего ключа.</span><span class="sxs-lookup"><span data-stu-id="20a09-273">The circumflex key on a German keyboard is an example of a dead key.</span></span> <span data-ttu-id="20a09-274">Чтобы ввести символ, состоящий из символа "o" с циркумфлексом, немецкий пользователь должен ввести ключ с циркумфлексом, а затем клавишу "o".</span><span class="sxs-lookup"><span data-stu-id="20a09-274">To enter the character consisting of an "o" with a circumflex, a German user would type the circumflex key followed by the "o" key.</span></span> <span data-ttu-id="20a09-275">Окно с фокусом клавиатуры получит следующую последовательность сообщений:</span><span class="sxs-lookup"><span data-stu-id="20a09-275">The window with the keyboard focus would receive the following sequence of messages:</span></span>

1.  [<span data-ttu-id="20a09-276">**WM \_ KeyDown**</span><span class="sxs-lookup"><span data-stu-id="20a09-276">**WM\_KEYDOWN**</span></span>](wm-keydown.md)
2.  [<span data-ttu-id="20a09-277">**WM \_ деадчар**</span><span class="sxs-lookup"><span data-stu-id="20a09-277">**WM\_DEADCHAR**</span></span>](wm-deadchar.md)
3.  [<span data-ttu-id="20a09-278">**WM \_ KEYUP**</span><span class="sxs-lookup"><span data-stu-id="20a09-278">**WM\_KEYUP**</span></span>](wm-keyup.md)
4.  [<span data-ttu-id="20a09-279">**WM \_ KeyDown**</span><span class="sxs-lookup"><span data-stu-id="20a09-279">**WM\_KEYDOWN**</span></span>](wm-keydown.md)
5.  [<span data-ttu-id="20a09-280">**WM \_ char**</span><span class="sxs-lookup"><span data-stu-id="20a09-280">**WM\_CHAR**</span></span>](wm-char.md)
6.  [<span data-ttu-id="20a09-281">**WM \_ KEYUP**</span><span class="sxs-lookup"><span data-stu-id="20a09-281">**WM\_KEYUP**</span></span>](wm-keyup.md)

<span data-ttu-id="20a09-282">[**TranslateMessage**](/windows/desktop/api/winuser/nf-winuser-translatemessage) создает сообщение [**WM \_ Деадчар**](wm-deadchar.md) при обработке сообщения [**WM \_ KeyDown**](wm-keydown.md) из неработающего ключа.</span><span class="sxs-lookup"><span data-stu-id="20a09-282">[**TranslateMessage**](/windows/desktop/api/winuser/nf-winuser-translatemessage) generates the [**WM\_DEADCHAR**](wm-deadchar.md) message when it processes the [**WM\_KEYDOWN**](wm-keydown.md) message from a dead key.</span></span> <span data-ttu-id="20a09-283">Хотя параметр *wParam* сообщения **WM \_ деадчар** содержит код символа диакритических знаков для неработающего ключа, приложение обычно игнорирует сообщение.</span><span class="sxs-lookup"><span data-stu-id="20a09-283">Although the *wParam* parameter of the **WM\_DEADCHAR** message contains the character code of the diacritic for the dead key, an application typically ignores the message.</span></span> <span data-ttu-id="20a09-284">Вместо этого он обрабатывает сообщение [**WM \_ char**](wm-char.md) , созданное последующим нажатием клавиши.</span><span class="sxs-lookup"><span data-stu-id="20a09-284">Instead, it processes the [**WM\_CHAR**](wm-char.md) message generated by the subsequent keystroke.</span></span> <span data-ttu-id="20a09-285">Параметр *wParam* сообщения **WM \_ char** содержит код символа буквы с диакритическим знаком.</span><span class="sxs-lookup"><span data-stu-id="20a09-285">The *wParam* parameter of the **WM\_CHAR** message contains the character code of the letter with the diacritic.</span></span> <span data-ttu-id="20a09-286">Если последующее нажатие клавиш создает символ, который не может быть объединен с диакритическим знаком, система создает два сообщения **\_ типа WM char** .</span><span class="sxs-lookup"><span data-stu-id="20a09-286">If the subsequent keystroke generates a character that cannot be combined with a diacritic, the system generates two **WM\_CHAR** messages.</span></span> <span data-ttu-id="20a09-287">Параметр *wParam* первого элемента содержит код символа диакритических знаков; параметр *wParam* второго класса содержит код символа последующего символа.</span><span class="sxs-lookup"><span data-stu-id="20a09-287">The *wParam* parameter of the first contains the character code of the diacritic; the *wParam* parameter of the second contains the character code of the subsequent character key.</span></span>

<span data-ttu-id="20a09-288">Функция [**TranslateMessage**](/windows/desktop/api/winuser/nf-winuser-translatemessage) создает сообщение [**WM \_ Сисдеадчар**](wm-sysdeadchar.md) при обработке сообщения [**WM \_ сискэйдовн**](wm-syskeydown.md) от системного неработающего ключа (неработающего ключа, который нажат в сочетании с клавишей Alt).</span><span class="sxs-lookup"><span data-stu-id="20a09-288">The [**TranslateMessage**](/windows/desktop/api/winuser/nf-winuser-translatemessage) function generates the [**WM\_SYSDEADCHAR**](wm-sysdeadchar.md) message when it processes the [**WM\_SYSKEYDOWN**](wm-syskeydown.md) message from a system dead key (a dead key that is pressed in combination with the ALT key).</span></span> <span data-ttu-id="20a09-289">Как правило, приложение игнорирует сообщение **WM \_ сисдеадчар** .</span><span class="sxs-lookup"><span data-stu-id="20a09-289">An application typically ignores the **WM\_SYSDEADCHAR** message.</span></span>

## <a name="key-status"></a><span data-ttu-id="20a09-290">Состояние ключа</span><span class="sxs-lookup"><span data-stu-id="20a09-290">Key Status</span></span>

<span data-ttu-id="20a09-291">При обработке сообщения клавиатуры приложению может потребоваться определить состояние другого ключа, Кроме того, который создал текущее сообщение.</span><span class="sxs-lookup"><span data-stu-id="20a09-291">While processing a keyboard message, an application may need to determine the status of another key besides the one that generated the current message.</span></span> <span data-ttu-id="20a09-292">Например, приложение для обработки текста, которое позволяет пользователю нажать SHIFT + END, чтобы выбрать блок текста, должен проверять состояние клавиши SHIFT при получении сообщения о нажатии клавиши из конечного ключа.</span><span class="sxs-lookup"><span data-stu-id="20a09-292">For example, a word-processing application that allows the user to press SHIFT+END to select a block of text must check the status of the SHIFT key whenever it receives a keystroke message from the END key.</span></span> <span data-ttu-id="20a09-293">Приложение может использовать функцию [**жеткэйстате**](/windows/win32/api/winuser/nf-winuser-getkeystate) для определения состояния виртуального ключа на момент создания текущего сообщения; она может использовать функцию [**жетасинккэйстате**](/windows/win32/api/winuser/nf-winuser-getasynckeystate) для получения текущего состояния виртуального ключа.</span><span class="sxs-lookup"><span data-stu-id="20a09-293">The application can use the [**GetKeyState**](/windows/win32/api/winuser/nf-winuser-getkeystate) function to determine the status of a virtual key at the time the current message was generated; it can use the [**GetAsyncKeyState**](/windows/win32/api/winuser/nf-winuser-getasynckeystate) function to retrieve the current status of a virtual key.</span></span>

<span data-ttu-id="20a09-294">Раскладка клавиатуры содержит список имен.</span><span class="sxs-lookup"><span data-stu-id="20a09-294">The keyboard layout maintains a list of names.</span></span> <span data-ttu-id="20a09-295">Имя ключа, создающего один символ, совпадает с символом, созданным ключом.</span><span class="sxs-lookup"><span data-stu-id="20a09-295">The name of a key that produces a single character is the same as the character produced by the key.</span></span> <span data-ttu-id="20a09-296">Имя несимвольного ключа, такого как TAB и ENTER, хранится в виде символьной строки.</span><span class="sxs-lookup"><span data-stu-id="20a09-296">The name of a noncharacter key such as TAB and ENTER is stored as a character string.</span></span> <span data-ttu-id="20a09-297">Приложение может получить имя любого ключа из драйвера устройства, вызвав функцию [**жеткэйнаметекст**](/windows/win32/api/winuser/nf-winuser-getkeynametexta) .</span><span class="sxs-lookup"><span data-stu-id="20a09-297">An application can retrieve the name of any key from the device driver by calling the [**GetKeyNameText**](/windows/win32/api/winuser/nf-winuser-getkeynametexta) function.</span></span>

## <a name="keystroke-and-character-translations"></a><span data-ttu-id="20a09-298">Нажатие клавиш и переводы символов</span><span class="sxs-lookup"><span data-stu-id="20a09-298">Keystroke and Character Translations</span></span>

<span data-ttu-id="20a09-299">Система включает несколько специальных функций, которые преобразуют коды сканирования, коды символов и коды виртуальных клавиш, предоставляемые различными сообщениями о нажатии клавиш.</span><span class="sxs-lookup"><span data-stu-id="20a09-299">The system includes several special purpose functions that translate scan codes, character codes, and virtual-key codes provided by various keystroke messages.</span></span> <span data-ttu-id="20a09-300">К этим функциям относятся [**мапвиртуалкэй**](/windows/win32/api/winuser/nf-winuser-mapvirtualkeya), [**ToAscii**](/windows/win32/api/winuser/nf-winuser-toascii), [**тауникоде**](/windows/win32/api/winuser/nf-winuser-tounicode)и [**вккэйскан**](/windows/win32/api/winuser/nf-winuser-vkkeyscana).</span><span class="sxs-lookup"><span data-stu-id="20a09-300">These functions include [**MapVirtualKey**](/windows/win32/api/winuser/nf-winuser-mapvirtualkeya), [**ToAscii**](/windows/win32/api/winuser/nf-winuser-toascii), [**ToUnicode**](/windows/win32/api/winuser/nf-winuser-tounicode), and [**VkKeyScan**](/windows/win32/api/winuser/nf-winuser-vkkeyscana).</span></span>

<span data-ttu-id="20a09-301">Кроме того, Microsoft Rich Editing 3,0 поддерживает [редактор IME для хекстауникоде](/windows/desktop/Intl/hextounicode-ime), позволяющий пользователю выполнять преобразование между шестнадцатеричными и символами Юникода с помощью горячих клавиш.</span><span class="sxs-lookup"><span data-stu-id="20a09-301">In addition, Microsoft Rich Edit 3.0 supports the [HexToUnicode IME](/windows/desktop/Intl/hextounicode-ime), which allows a user to convert between hexadecimal and Unicode characters by using hot keys.</span></span> <span data-ttu-id="20a09-302">Это означает, что при включении Microsoft Rich Edit 3,0 в приложение приложение будет наследовать функции IME Хекстауникоде.</span><span class="sxs-lookup"><span data-stu-id="20a09-302">This means that when Microsoft Rich Edit 3.0 is incorporated into an application, the application will inherit the features of the HexToUnicode IME.</span></span>

## <a name="hot-key-support"></a><span data-ttu-id="20a09-303">Поддержка Hot-Key</span><span class="sxs-lookup"><span data-stu-id="20a09-303">Hot-Key Support</span></span>

<span data-ttu-id="20a09-304">*Горячая клавиша* — это сочетание клавиш, которое создает сообщение с помощью [**\_ горячих клавиш WM**](wm-hotkey.md) , сообщение, которое система размещает в верхней части очереди сообщений потока, минуя все существующие сообщения в очереди.</span><span class="sxs-lookup"><span data-stu-id="20a09-304">A *hot key* is a key combination that generates a [**WM\_HOTKEY**](wm-hotkey.md) message, a message the system places at the top of a thread's message queue, bypassing any existing messages in the queue.</span></span> <span data-ttu-id="20a09-305">Приложения используют Горячие ключи для получения высокого приоритетного ввода с клавиатуры пользователя.</span><span class="sxs-lookup"><span data-stu-id="20a09-305">Applications use hot keys to obtain high-priority keyboard input from the user.</span></span> <span data-ttu-id="20a09-306">Например, путем определения сочетания клавиш, состоящего из сочетания клавиш CTRL + C, приложение может позволить пользователю отменить длительную операцию.</span><span class="sxs-lookup"><span data-stu-id="20a09-306">For example, by defining a hot key consisting of the CTRL+C key combination, an application can allow the user to cancel a lengthy operation.</span></span>

<span data-ttu-id="20a09-307">Чтобы определить горячую клавишу, приложение вызывает функцию [**RegisterHotKey**](/windows/win32/api/winuser/nf-winuser-registerhotkey) , задавая сочетание клавиш, которое создает сообщение с [**помощью \_ горячих клавиш WM**](wm-hotkey.md) , маркер окна для получения сообщения и идентификатор сочетания клавиш.</span><span class="sxs-lookup"><span data-stu-id="20a09-307">To define a hot key, an application calls the [**RegisterHotKey**](/windows/win32/api/winuser/nf-winuser-registerhotkey) function, specifying the combination of keys that generates the [**WM\_HOTKEY**](wm-hotkey.md) message, the handle to the window to receive the message, and the identifier of the hot key.</span></span> <span data-ttu-id="20a09-308">Когда пользователь нажимает клавишу горячего ключа, в очередь сообщений потока, создавшего окно, помещается сообщение с **\_ сочетанием клавиш WM** .</span><span class="sxs-lookup"><span data-stu-id="20a09-308">When the user presses the hot key, a **WM\_HOTKEY** message is placed in the message queue of the thread that created the window.</span></span> <span data-ttu-id="20a09-309">Параметр *wParam* сообщения содержит идентификатор сочетания клавиш.</span><span class="sxs-lookup"><span data-stu-id="20a09-309">The *wParam* parameter of the message contains the identifier of the hot key.</span></span> <span data-ttu-id="20a09-310">Приложение может определить несколько горячих ключей для потока, но каждый горячий ключ в потоке должен иметь уникальный идентификатор.</span><span class="sxs-lookup"><span data-stu-id="20a09-310">The application can define multiple hot keys for a thread, but each hot key in the thread must have a unique identifier.</span></span> <span data-ttu-id="20a09-311">Перед завершением работы приложения следует использовать функцию [**унрегистерхоткэй**](/windows/win32/api/winuser/nf-winuser-unregisterhotkey) для уничтожения сочетания клавиш.</span><span class="sxs-lookup"><span data-stu-id="20a09-311">Before the application terminates, it should use the [**UnregisterHotKey**](/windows/win32/api/winuser/nf-winuser-unregisterhotkey) function to destroy the hot key.</span></span>

<span data-ttu-id="20a09-312">Приложения могут использовать сочетание клавиш, чтобы облегчить пользователю выбор сочетания клавиш.</span><span class="sxs-lookup"><span data-stu-id="20a09-312">Applications can use a hot key control to make it easy for the user to choose a hot key.</span></span> <span data-ttu-id="20a09-313">Элементы управления горячими ключами обычно используются для определения горячего ключа, который активирует окно. они не используют функции [**RegisterHotKey**](/windows/win32/api/winuser/nf-winuser-registerhotkey) и [**унрегистерхоткэй**](/windows/win32/api/winuser/nf-winuser-unregisterhotkey) .</span><span class="sxs-lookup"><span data-stu-id="20a09-313">Hot key controls are typically used to define a hot key that activates a window; they do not use the [**RegisterHotKey**](/windows/win32/api/winuser/nf-winuser-registerhotkey) and [**UnregisterHotKey**](/windows/win32/api/winuser/nf-winuser-unregisterhotkey) functions.</span></span> <span data-ttu-id="20a09-314">Вместо этого приложение, использующее горячее управление ключами, обычно отправляет сообщение [**WM \_ сесоткэй**](wm-sethotkey.md) для установки сочетания клавиш.</span><span class="sxs-lookup"><span data-stu-id="20a09-314">Instead, an application that uses a hot key control typically sends the [**WM\_SETHOTKEY**](wm-sethotkey.md) message to set the hot key.</span></span> <span data-ttu-id="20a09-315">Всякий раз, когда пользователь нажимает клавишу горячего ключа, система отправляет сообщение [**WM \_ сискомманд**](/windows/desktop/menurc/wm-syscommand) с указанием \_ сочетания клавиш SC.</span><span class="sxs-lookup"><span data-stu-id="20a09-315">Whenever the user presses the hot key, the system sends a [**WM\_SYSCOMMAND**](/windows/desktop/menurc/wm-syscommand) message specifying SC\_HOTKEY.</span></span> <span data-ttu-id="20a09-316">Дополнительные сведения об элементах управления горячими ключами см. в разделе «Использование элементов управления горячих клавиш» раздела [элементы управления горячими ключами](../controls/hot-key-controls.md).</span><span class="sxs-lookup"><span data-stu-id="20a09-316">For more information about hot key controls, see "Using Hot Key Controls" in [Hot Key Controls](../controls/hot-key-controls.md).</span></span>

## <a name="keyboard-keys-for-browsing-and-other-functions"></a><span data-ttu-id="20a09-317">Клавиши клавиатуры для обзора и других функций</span><span class="sxs-lookup"><span data-stu-id="20a09-317">Keyboard Keys for Browsing and Other Functions</span></span>

<span data-ttu-id="20a09-318">Windows обеспечивает поддержку клавиатур с специальными ключами для функций браузера, функций мультимедиа, запуска приложений и управления питанием.</span><span class="sxs-lookup"><span data-stu-id="20a09-318">Windows provides support for keyboards with special keys for browser functions, media functions, application launching, and power management.</span></span> <span data-ttu-id="20a09-319">[**WM \_ аппкомманд**](wm-appcommand.md) поддерживает дополнительные клавиши клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="20a09-319">The [**WM\_APPCOMMAND**](wm-appcommand.md) supports the extra keyboard keys.</span></span> <span data-ttu-id="20a09-320">Кроме того, функция [**шеллпрок**](/previous-versions/windows/desktop/legacy/ms644991(v=vs.85)) изменяется для поддержки дополнительных клавиш клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="20a09-320">In addition, the [**ShellProc**](/previous-versions/windows/desktop/legacy/ms644991(v=vs.85)) function is modified to support the extra keyboard keys.</span></span>

<span data-ttu-id="20a09-321">Маловероятно, что дочернее окно в приложении компонента сможет напрямую реализовать команды для этих дополнительных клавиш клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="20a09-321">It is unlikely that a child window in a component application will be able to directly implement commands for these extra keyboard keys.</span></span> <span data-ttu-id="20a09-322">Поэтому при нажатии одной из этих клавиш [**дефвиндовпрок**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) отправит сообщение [**WM \_ аппкомманд**](wm-appcommand.md) в окно.</span><span class="sxs-lookup"><span data-stu-id="20a09-322">So when one of these keys is pressed, [**DefWindowProc**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) will send a [**WM\_APPCOMMAND**](wm-appcommand.md) message to a window.</span></span> <span data-ttu-id="20a09-323">**Дефвиндовпрок** также получит всплывающее сообщение **WM \_ аппкомманд** в родительском окне.</span><span class="sxs-lookup"><span data-stu-id="20a09-323">**DefWindowProc** will also bubble the **WM\_APPCOMMAND** message to its parent window.</span></span> <span data-ttu-id="20a09-324">Это похоже на способ вызова контекстных меню с помощью правой кнопки мыши, которая заключается в том, что **дефвиндовпрок** отправляет сообщение [**WM \_ CONTEXTMENU**](/windows/desktop/menurc/wm-contextmenu) при щелчке правой кнопкой мыши и передает его родительскому элементу.</span><span class="sxs-lookup"><span data-stu-id="20a09-324">This is similar to the way context menus are invoked with the right mouse button, which is that **DefWindowProc** sends a [**WM\_CONTEXTMENU**](/windows/desktop/menurc/wm-contextmenu) message on a right button click, and bubbles it to its parent.</span></span> <span data-ttu-id="20a09-325">Кроме того, если **дефвиндовпрок** получает сообщение **WM \_ аппкомманд** для окна верхнего уровня, оно будет вызывать обработчик оболочки с кодом **хшелл \_ аппкомманд**.</span><span class="sxs-lookup"><span data-stu-id="20a09-325">Additionally, if **DefWindowProc** receives a **WM\_APPCOMMAND** message for a top-level window, it will call a shell hook with code **HSHELL\_APPCOMMAND**.</span></span>

<span data-ttu-id="20a09-326">Windows также поддерживает Microsoft IntelliMouse Explorer, который является мышью с пятью кнопками.</span><span class="sxs-lookup"><span data-stu-id="20a09-326">Windows also supports the Microsoft IntelliMouse Explorer, which is a mouse with five buttons.</span></span> <span data-ttu-id="20a09-327">Две дополнительные кнопки поддерживают навигацию в браузере вперед и назад.</span><span class="sxs-lookup"><span data-stu-id="20a09-327">The two extra buttons support forward and backward browser navigation.</span></span> <span data-ttu-id="20a09-328">Дополнительные сведения см. в разделе [ксбуттонс](about-mouse-input.md).</span><span class="sxs-lookup"><span data-stu-id="20a09-328">For more information, see [XBUTTONs](about-mouse-input.md).</span></span>

## <a name="simulating-input"></a><span data-ttu-id="20a09-329">Имитация входных данных</span><span class="sxs-lookup"><span data-stu-id="20a09-329">Simulating Input</span></span>

<span data-ttu-id="20a09-330">Для имитации непрерывной последовательности событий пользовательского ввода используйте функцию [**SendInput**](/windows/win32/api/winuser/nf-winuser-sendinput) .</span><span class="sxs-lookup"><span data-stu-id="20a09-330">To simulate an uninterrupted series of user input events, use the [**SendInput**](/windows/win32/api/winuser/nf-winuser-sendinput) function.</span></span> <span data-ttu-id="20a09-331">Функция принимает три параметра.</span><span class="sxs-lookup"><span data-stu-id="20a09-331">The function accepts three parameters.</span></span> <span data-ttu-id="20a09-332">Первый параметр, *Цинпутс*, указывает количество событий ввода, которые будут смоделированы.</span><span class="sxs-lookup"><span data-stu-id="20a09-332">The first parameter, *cInputs*, indicates the number of input events that will be simulated.</span></span> <span data-ttu-id="20a09-333">Второй параметр, *ргинпутс*, представляет собой массив [**входных**](/windows/win32/api/winuser/ns-winuser-input) структур, каждый из которых описывает тип входного события и дополнительные сведения об этом событии.</span><span class="sxs-lookup"><span data-stu-id="20a09-333">The second parameter, *rgInputs*, is an array of [**INPUT**](/windows/win32/api/winuser/ns-winuser-input) structures, each describing a type of input event and additional information about that event.</span></span> <span data-ttu-id="20a09-334">Последний параметр, *кбсизе*, принимает размер **входной** структуры в байтах.</span><span class="sxs-lookup"><span data-stu-id="20a09-334">The last parameter, *cbSize*, accepts the size of the **INPUT** structure, in bytes.</span></span>

<span data-ttu-id="20a09-335">Функция [**SendInput**](/windows/win32/api/winuser/nf-winuser-sendinput) работает путем встраивания последовательности имитации входных событий в входной поток устройства.</span><span class="sxs-lookup"><span data-stu-id="20a09-335">The [**SendInput**](/windows/win32/api/winuser/nf-winuser-sendinput) function works by injecting a series of simulated input events into a device's input stream.</span></span> <span data-ttu-id="20a09-336">Этот результат аналогичен многократному вызову [**\_ события кэйбд**](/windows/win32/api/winuser/nf-winuser-keybd_event) или функции [**мыши \_**](/windows/win32/api/winuser/nf-winuser-mouse_event) за исключением того, что система гарантирует, что никакие другие события ввода не интермингле с имитацией событий.</span><span class="sxs-lookup"><span data-stu-id="20a09-336">The effect is similar to calling the [**keybd\_event**](/windows/win32/api/winuser/nf-winuser-keybd_event) or [**mouse\_event**](/windows/win32/api/winuser/nf-winuser-mouse_event) function repeatedly, except that the system ensures that no other input events intermingle with the simulated events.</span></span> <span data-ttu-id="20a09-337">По завершении вызова возвращаемое значение указывает количество успешно воспроизведенных входных событий.</span><span class="sxs-lookup"><span data-stu-id="20a09-337">When the call completes, the return value indicates the number of input events successfully played.</span></span> <span data-ttu-id="20a09-338">Если это значение равно нулю, входные данные были заблокированы.</span><span class="sxs-lookup"><span data-stu-id="20a09-338">If this value is zero, then input was blocked.</span></span>

<span data-ttu-id="20a09-339">Функция [**SendInput**](/windows/win32/api/winuser/nf-winuser-sendinput) не сбрасывает текущее состояние клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="20a09-339">The [**SendInput**](/windows/win32/api/winuser/nf-winuser-sendinput) function does not reset the keyboard's current state.</span></span> <span data-ttu-id="20a09-340">Таким образом, если при вызове этой функции пользователь нажал клавиши, они могут повлиять на события, создаваемые этой функцией.</span><span class="sxs-lookup"><span data-stu-id="20a09-340">Therefore, if the user has any keys pressed when you call this function, they might interfere with the events that this function generates.</span></span> <span data-ttu-id="20a09-341">Если вы беспокоитесь о возможных помехах, проверьте состояние клавиатуры с помощью функции [**жетасинккэйстате**](/windows/win32/api/winuser/nf-winuser-getasynckeystate) и при необходимости внесите необходимые исправления.</span><span class="sxs-lookup"><span data-stu-id="20a09-341">If you are concerned about possible interference, check the keyboard's state with the [**GetAsyncKeyState**](/windows/win32/api/winuser/nf-winuser-getasynckeystate) function and correct as necessary.</span></span>

## <a name="languages-locales-and-keyboard-layouts"></a><span data-ttu-id="20a09-342">Языки, языковые стандарты и раскладки клавиатуры</span><span class="sxs-lookup"><span data-stu-id="20a09-342">Languages, Locales, and Keyboard Layouts</span></span>

<span data-ttu-id="20a09-343">*Язык* — это естественный язык, например английский, французский и японский.</span><span class="sxs-lookup"><span data-stu-id="20a09-343">A *language* is a natural language, such as English, French, and Japanese.</span></span> <span data-ttu-id="20a09-344">*Подязык* — это вариант естественного языка, который говорят в определенном географическом регионе, например на английском языке, произнесенном в великобритании и США.</span><span class="sxs-lookup"><span data-stu-id="20a09-344">A *sublanguage* is a variant of a natural language that is spoken in a specific geographical region, such as the English sublanguages spoken in the United Kingdom and the United States.</span></span> <span data-ttu-id="20a09-345">Приложения используют значения, называемые [идентификаторами языка](/windows/desktop/Intl/language-identifiers), для уникальной идентификации языков и подязыков.</span><span class="sxs-lookup"><span data-stu-id="20a09-345">Applications use values, called [language identifiers](/windows/desktop/Intl/language-identifiers), to uniquely identify languages and sublanguages.</span></span>

<span data-ttu-id="20a09-346">Приложения обычно используют *национальные* настройки для установки языка, на котором обрабатываются входные и выходные данные.</span><span class="sxs-lookup"><span data-stu-id="20a09-346">Applications typically use *locales* to set the language in which input and output is processed.</span></span> <span data-ttu-id="20a09-347">Например, Настройка языкового стандарта для клавиатуры влияет на значения символов, формируемые клавиатурой.</span><span class="sxs-lookup"><span data-stu-id="20a09-347">Setting the locale for the keyboard, for example, affects the character values generated by the keyboard.</span></span> <span data-ttu-id="20a09-348">Установка языкового стандарта для дисплея или принтера влияет на отображаемые или печатаемые глифы.</span><span class="sxs-lookup"><span data-stu-id="20a09-348">Setting the locale for the display or printer affects the glyphs displayed or printed.</span></span> <span data-ttu-id="20a09-349">Приложения устанавливают языковой стандарт для клавиатуры, загружая и используя раскладки клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="20a09-349">Applications set the locale for a keyboard by loading and using keyboard layouts.</span></span> <span data-ttu-id="20a09-350">Они устанавливают языковой стандарт для дисплея или принтера, выбирая шрифт, который поддерживает указанный языковой стандарт.</span><span class="sxs-lookup"><span data-stu-id="20a09-350">They set the locale for a display or printer by selecting a font that supports the specified locale.</span></span>

<span data-ttu-id="20a09-351">Раскладка клавиатуры не только определяет физическое положение клавиш на клавиатуре, но и определяет значения символов, создаваемые при нажатии клавиш.</span><span class="sxs-lookup"><span data-stu-id="20a09-351">A keyboard layout not only specifies the physical position of the keys on the keyboard but also determines the character values generated by pressing those keys.</span></span> <span data-ttu-id="20a09-352">Каждый макет определяет текущий язык ввода и определяет, какие символьные значения должны быть созданы с помощью ключей и сочетаний клавиш.</span><span class="sxs-lookup"><span data-stu-id="20a09-352">Each layout identifies the current input language and determines which character values are generated by which keys and key combinations.</span></span>

<span data-ttu-id="20a09-353">Каждая раскладка клавиатуры имеет соответствующий маркер, который определяет макет и язык.</span><span class="sxs-lookup"><span data-stu-id="20a09-353">Every keyboard layout has a corresponding handle that identifies the layout and language.</span></span> <span data-ttu-id="20a09-354">Младшим словом маркера является идентификатор языка.</span><span class="sxs-lookup"><span data-stu-id="20a09-354">The low word of the handle is a language identifier.</span></span> <span data-ttu-id="20a09-355">Высокое значение — это обработчик устройства, который указывает физический макет или равен нулю, что указывает на физический макет по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="20a09-355">The high word is a device handle, specifying the physical layout, or is zero, indicating a default physical layout.</span></span> <span data-ttu-id="20a09-356">Пользователь может связать любой язык ввода с физическим макетом.</span><span class="sxs-lookup"><span data-stu-id="20a09-356">The user can associate any input language with a physical layout.</span></span> <span data-ttu-id="20a09-357">Например, пользователь с английской диктовкой, который иногда работает на французском языке, может установить французский язык ввода для клавиатуры, не меняя при этом физический макет клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="20a09-357">For example, an English-speaking user who very occasionally works in French can set the input language of the keyboard to French without changing the physical layout of the keyboard.</span></span> <span data-ttu-id="20a09-358">Это означает, что пользователь может ввести текст на французском языке с помощью привычного английского макета.</span><span class="sxs-lookup"><span data-stu-id="20a09-358">This means the user can enter text in French using the familiar English layout.</span></span>

<span data-ttu-id="20a09-359">Как правило, приложения не должны работать непосредственно с языками ввода.</span><span class="sxs-lookup"><span data-stu-id="20a09-359">Applications are generally not expected to manipulate input languages directly.</span></span> <span data-ttu-id="20a09-360">Вместо этого пользователь настраивает сочетания языка и макета, а затем переключается между ними.</span><span class="sxs-lookup"><span data-stu-id="20a09-360">Instead, the user sets up language and layout combinations, then switches among them.</span></span> <span data-ttu-id="20a09-361">Когда пользователь щелкает текст, помеченный другим языком, приложение вызывает функцию [**активатекэйбоардлайаут**](/windows/win32/api/winuser/nf-winuser-activatekeyboardlayout) для активации макета пользователя по умолчанию для этого языка.</span><span class="sxs-lookup"><span data-stu-id="20a09-361">When the user clicks into text marked with a different language, the application calls the [**ActivateKeyboardLayout**](/windows/win32/api/winuser/nf-winuser-activatekeyboardlayout) function to activate the user's default layout for that language.</span></span> <span data-ttu-id="20a09-362">Если пользователь редактирует текст на языке, который отсутствует в активном списке, приложение может вызвать функцию [**лоадкэйбоардлайаут**](/windows/win32/api/winuser/nf-winuser-loadkeyboardlayouta) с языком, чтобы получить макет на основе этого языка.</span><span class="sxs-lookup"><span data-stu-id="20a09-362">If the user edits text in a language which is not in the active list, the application can call the [**LoadKeyboardLayout**](/windows/win32/api/winuser/nf-winuser-loadkeyboardlayouta) function with the language to get a layout based on that language.</span></span>

<span data-ttu-id="20a09-363">Функция [**активатекэйбоардлайаут**](/windows/win32/api/winuser/nf-winuser-activatekeyboardlayout) задает язык ввода для текущей задачи.</span><span class="sxs-lookup"><span data-stu-id="20a09-363">The [**ActivateKeyboardLayout**](/windows/win32/api/winuser/nf-winuser-activatekeyboardlayout) function sets the input language for the current task.</span></span> <span data-ttu-id="20a09-364">Параметр *HKL* может быть либо маркером раскладки клавиатуры, либо идентификатором языка с нулевым значением.</span><span class="sxs-lookup"><span data-stu-id="20a09-364">The *hkl* parameter can be either the handle to the keyboard layout or a zero-extended language identifier.</span></span> <span data-ttu-id="20a09-365">Маркеры раскладки клавиатуры можно получить из функции [**лоадкэйбоардлайаут**](/windows/win32/api/winuser/nf-winuser-loadkeyboardlayouta) или [**жеткэйбоардлайаутлист**](/windows/win32/api/winuser/nf-winuser-getkeyboardlayoutlist) .</span><span class="sxs-lookup"><span data-stu-id="20a09-365">Keyboard layout handles can be obtained from the [**LoadKeyboardLayout**](/windows/win32/api/winuser/nf-winuser-loadkeyboardlayouta) or [**GetKeyboardLayoutList**](/windows/win32/api/winuser/nf-winuser-getkeyboardlayoutlist) function.</span></span> <span data-ttu-id="20a09-366">Для выбора следующей или предыдущей клавиатуры можно также использовать значения **HKL \_ Next** и HKL, предшествующие **\_ предыдущему** .</span><span class="sxs-lookup"><span data-stu-id="20a09-366">The **HKL\_NEXT** and **HKL\_PREV** values can also be used to select the next or previous keyboard.</span></span>

<span data-ttu-id="20a09-367">Функция [**жеткэйбоардлайаутнаме**](/windows/win32/api/winuser/nf-winuser-getkeyboardlayoutnamea) извлекает имя активной раскладки клавиатуры для вызывающего потока.</span><span class="sxs-lookup"><span data-stu-id="20a09-367">The [**GetKeyboardLayoutName**](/windows/win32/api/winuser/nf-winuser-getkeyboardlayoutnamea) function retrieves the name of the active keyboard layout for the calling thread.</span></span> <span data-ttu-id="20a09-368">Если приложение создает активный макет с помощью функции [**лоадкэйбоардлайаут**](/windows/win32/api/winuser/nf-winuser-loadkeyboardlayouta) , **жеткэйбоардлайаутнаме** извлекает ту же строку, которая использовалась для создания макета.</span><span class="sxs-lookup"><span data-stu-id="20a09-368">If an application creates the active layout using the [**LoadKeyboardLayout**](/windows/win32/api/winuser/nf-winuser-loadkeyboardlayouta) function, **GetKeyboardLayoutName** retrieves the same string used to create the layout.</span></span> <span data-ttu-id="20a09-369">В противном случае строка является основным идентификатором языка, соответствующим языковому стандарту активного макета.</span><span class="sxs-lookup"><span data-stu-id="20a09-369">Otherwise, the string is the primary language identifier corresponding to the locale of the active layout.</span></span> <span data-ttu-id="20a09-370">Это означает, что функция не обязательно различает различные макеты с одним и тем же основным языком, поэтому не может возвращать определенные сведения о языке ввода.</span><span class="sxs-lookup"><span data-stu-id="20a09-370">This means the function may not necessarily differentiate among different layouts with the same primary language, so cannot return specific information about the input language.</span></span> <span data-ttu-id="20a09-371">Однако функцию [**жеткэйбоардлайаут**](/windows/win32/api/winuser/nf-winuser-getkeyboardlayout) можно использовать для определения языка ввода.</span><span class="sxs-lookup"><span data-stu-id="20a09-371">The [**GetKeyboardLayout**](/windows/win32/api/winuser/nf-winuser-getkeyboardlayout) function, however, can be used to determine the input language.</span></span>

<span data-ttu-id="20a09-372">Функция [**лоадкэйбоардлайаут**](/windows/win32/api/winuser/nf-winuser-loadkeyboardlayouta) загружает раскладку клавиатуры и делает макет доступным для пользователя.</span><span class="sxs-lookup"><span data-stu-id="20a09-372">The [**LoadKeyboardLayout**](/windows/win32/api/winuser/nf-winuser-loadkeyboardlayouta) function loads a keyboard layout and makes the layout available to the user.</span></span> <span data-ttu-id="20a09-373">Приложения могут сделать макет немедленно активным для текущего потока с помощью значения **\_ активации КЛФ** .</span><span class="sxs-lookup"><span data-stu-id="20a09-373">Applications can make the layout immediately active for the current thread by using the **KLF\_ACTIVATE** value.</span></span> <span data-ttu-id="20a09-374">Приложение может использовать значение **\_ переупорядочения КЛФ** для изменения порядка макетов без указания значения **КЛФ \_ Activate** .</span><span class="sxs-lookup"><span data-stu-id="20a09-374">An application can use the **KLF\_REORDER** value to reorder the layouts without also specifying the **KLF\_ACTIVATE** value.</span></span> <span data-ttu-id="20a09-375">При загрузке раскладок клавиатуры в приложениях всегда следует использовать значение **\_ подстановки \_ КЛФ** .</span><span class="sxs-lookup"><span data-stu-id="20a09-375">Applications should always use the **KLF\_SUBSTITUTE\_OK** value when loading keyboard layouts to ensure that the user's preference, if any, is selected.</span></span>

<span data-ttu-id="20a09-376">Для многоязычной поддержки функция [**лоадкэйбоардлайаут**](/windows/win32/api/winuser/nf-winuser-loadkeyboardlayouta) предоставляет флаги **КЛФ \_ реплацеланг** и **КЛФ \_ нотеллшелл** .</span><span class="sxs-lookup"><span data-stu-id="20a09-376">For multilingual support, the [**LoadKeyboardLayout**](/windows/win32/api/winuser/nf-winuser-loadkeyboardlayouta) function provides the **KLF\_REPLACELANG** and **KLF\_NOTELLSHELL** flags.</span></span> <span data-ttu-id="20a09-377">Флаг **КЛФ \_ реплацеланг** направляет функцию на замену существующей раскладки клавиатуры без изменения языка.</span><span class="sxs-lookup"><span data-stu-id="20a09-377">The **KLF\_REPLACELANG** flag directs the function to replace an existing keyboard layout without changing the language.</span></span> <span data-ttu-id="20a09-378">Попытка заменить существующий макет, используя тот же идентификатор языка, но без указания **КЛФ \_ реплацеланг** , является ошибкой.</span><span class="sxs-lookup"><span data-stu-id="20a09-378">Attempting to replace an existing layout using the same language identifier but without specifying **KLF\_REPLACELANG** is an error.</span></span> <span data-ttu-id="20a09-379">Флаг **КЛФ \_ нотеллшелл** предотвращает уведомление функции от оболочки при добавлении или замене раскладки клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="20a09-379">The **KLF\_NOTELLSHELL** flag prevents the function from notifying the shell when a keyboard layout is added or replaced.</span></span> <span data-ttu-id="20a09-380">Это полезно для приложений, которые добавляют несколько макетов в последовательный ряд вызовов.</span><span class="sxs-lookup"><span data-stu-id="20a09-380">This is useful for applications that add multiple layouts in a consecutive series of calls.</span></span> <span data-ttu-id="20a09-381">Этот флаг следует использовать во всех вызовах, кроме последнего.</span><span class="sxs-lookup"><span data-stu-id="20a09-381">This flag should be used in all but the last call.</span></span>

<span data-ttu-id="20a09-382">Функция [**унлоадкэйбоардлайаут**](/windows/win32/api/winuser/nf-winuser-unloadkeyboardlayout) ограничена тем, что не может выгружать системный язык ввода по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="20a09-382">The [**UnloadKeyboardLayout**](/windows/win32/api/winuser/nf-winuser-unloadkeyboardlayout) function is restricted in that it cannot unload the system default input language.</span></span> <span data-ttu-id="20a09-383">Это гарантирует, что пользователь всегда будет иметь один макет, доступный для ввода текста, используя тот же набор символов, который используется оболочкой и файловой системой.</span><span class="sxs-lookup"><span data-stu-id="20a09-383">This ensures that the user always has one layout available for enter text using the same character set as used by the shell and file system.</span></span>

 

 
