---
description: Если универсальный узел и клиент могут видеть друг друга в сети, но фактический узел и клиент не могут, скорее всего, проблема заключается в сообщениях, передаваемых между конечными точками по сети.
ms.assetid: 1b0943fb-076e-4feb-9a4f-36a06bdd19ae
title: Использование клиента отладки WSD для проверки трафика многоадресной рассылки
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4a814ac97512ef4b0691c22d3238d151372023a7
ms.sourcegitcommit: 59ec383331366f8a62c94bb88468ca03e95c43f8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/13/2021
ms.locfileid: "107380668"
---
# <a name="using-wsd-debug-client-to-verify-multicast-traffic"></a>Использование клиента отладки WSD для проверки трафика многоадресной рассылки

Если универсальный узел и клиент могут видеть друг друга в сети, но фактический узел и клиент не могут, скорее всего, проблема заключается в сообщениях, передаваемых между конечными точками по сети. Дополнительные сведения об универсальном узле и клиенте см. в разделе [Использование универсального узла и клиента для протокола UDP WS-Discovery](using-a-generic-host-and-client-for-udp-ws-discovery.md). Так как полная трассировка сети может быть трудной для собираются, фильтрации и чтения, клиентское средство отладки WSD можно использовать для печати сторон многоадресной рассылки WS-Discovery сообщений.

Клиент отладки WSD в режиме многоадресной рассылки может проверять только половину сообщений, так как клиент не может печатать одноадресные сообщения. Если требуется одноадресный трафик, пропустите процедуру непосредственно, чтобы [проверить трассировку сети для протокола UDP WS-Discovery](inspecting-network-traces-for-udp-ws-discovery.md).

В этой процедуре показан метод, который будет отображать весь многоадресный трафик в сети. Сведения о том, как отобразить только многоадресный трафик с устройства, см. в разделе [Фильтрация результатов отладки WSD для клиента](#filtering-wsd-debug-client-results) ниже.

**Использование клиента отладки WSD для проверки трафика многоадресной рассылки**

1.  Настройте узел и клиент для работы по сети (то есть убедитесь, что узел и клиент будут работать на разных компьютерах).
2.  Откройте командную строку и выполните следующую команду: **всддебуг \_client.exe/Mode multicast**
3.  Воспроизведите ошибку, запустив узел и клиент или нажав клавишу F5 в обозревателе сети.
4.  Убедитесь, что сообщения являются многоадресными.

Если требуемые сообщения отображаются в выходных данных клиента отладки WSD, то ошибка приложения может находиться в содержимом многоадресного сообщения, в случае существования или содержимого соответствующих одноадресных ответных сообщений. Продолжайте устранение неполадок, следуя указаниям в разделе [Проверка трассировки сети для протокола UDP WS-Discovery](inspecting-network-traces-for-udp-ws-discovery.md).

Если требуемые сообщения отображаются в выходных данных клиента отладки WSD, скорее всего, обнаружена проблема с источником проблемы приложения. Вероятно, трафик многоадресной рассылки не передается по сети. Эта ошибка может произойти, если приложение не перечисляет адаптеры многоадресной рассылки правильно. Приложения должны явно передавать многоадресный трафик по всем сетевым интерфейсам; в противном случае пакеты не могут быть созданы для интерфейса замыкания на себя или для других интерфейсов. Чтобы убедиться, что пакеты не отображаются в сети, следуйте инструкциям в разделе [Проверка трассировки сети для протокола UDP WS-Discovery](inspecting-network-traces-for-udp-ws-discovery.md) и найдите свидетельство об отсутствии многоадресных сообщений.

## <a name="verifying-that-messages-are-being-multicast"></a>Проверка многоадресной рассылки сообщений

Всегда проверяйте, что сообщения [зонда](probe-message.md) являются многоадресными. При необходимости убедитесь, что сообщения " [Привет](hello-message.md) " и " [разрешение](resolve-message.md) " являются многоадресными. Обратите внимание, что не все приложения используют сообщения разрешения. Дополнительные сведения о шаблонах сообщений, используемых клиентами и узлами, см. в статьях [шаблоны сообщений обнаружения и обмена метаданными](discovery-and-metadata-exchange-message-patterns.md) и [Начало работы с использованием WSDAPI устранение неполадок](getting-started-with-wsdapi-troubleshooting.md).

Сообщения должны быть активированы для отправки, как описано в шаге 3 выше. Клиент отладки WSD отображает необработанное сообщение SOAP в качестве выходных данных. Так как все сообщения, выводимые клиентом отладки WSD в режиме многоадресной рассылки, получаются через сокет многоадресной рассылки, адрес назначения сообщения не отображается.

В следующем примере выходных данных клиента отладки WSD отображается сообщение пробы. \<wsa:Action>Элемент идентифицирует сообщение как сообщение пробы. Проверьте \<wsa:Action> поле, чтобы убедиться, что полученное сообщение является сообщением пробы.

``` syntax
UDP message at 05/08/07 10:06:55 from soap.udp://[127.0.0.1:49334]
<?xml version="1.0" encoding="utf-8" ?>
<soap:Envelope xmlns:soap="https://www.w3.org/2003/05/soap-envelope" xmlns:wsa="h
ttp://schemas.xmlsoap.org/ws/2004/08/addressing" xmlns:wsd="https://schemas.xmlso
ap.org/ws/2005/04/discovery" xmlns:wsdp="https://schemas.xmlsoap.org/ws/2006/02/d
evprof"><soap:Header><wsa:To>urn:schemas-xmlsoap-org:ws:2005:04:discovery</wsa:T
o><wsa:Action>https://schemas.xmlsoap.org/ws/2005/04/discovery/Probe</wsa:Action>
<wsa:MessageID>urn:uuid:256ad815-1576-4e59-8efc-4c1e0f15fdd2</wsa:MessageID></so
ap:Header><soap:Body><wsd:Probe><wsd:Types>wsdp:Device</wsd:Types></wsd:Probe></
soap:Body></soap:Envelope>
```

В следующем примере выходных данных клиента отладки WSD отображается сообщение Hello. \<wsa:Action>Элемент идентифицирует сообщение как сообщение Hello.

``` syntax
UDP message at 05/08/07 10:10:49 from soap.udp://[[::1]:49343]
<?xml version="1.0" encoding="utf-8" ?>
<soap:Envelope xmlns:soap="https://www.w3.org/2003/05/soap-envelope" xmlns:wsa="h
ttp://schemas.xmlsoap.org/ws/2004/08/addressing" xmlns:wsd="https://schemas.xmlso
ap.org/ws/2005/04/discovery" xmlns:wsdp="https://schemas.xmlsoap.org/ws/2006/02/d
evprof"><soap:Header><wsa:To>urn:schemas-xmlsoap-org:ws:2005:04:discovery</wsa:T
o><wsa:Action>https://schemas.xmlsoap.org/ws/2005/04/discovery/Hello</wsa:Action>
<wsa:MessageID>urn:uuid:8999e29a-b056-4345-9e13-f42dbedab28a</wsa:MessageID><wsd
:AppSequence InstanceId="1" SequenceId="urn:uuid:abb0a2a1-6efc-4242-b8e7-c02484a
6eea2" MessageNumber="1"></wsd:AppSequence></soap:Header><soap:Body><wsd:Hello><
wsa:EndpointReference><wsa:Address>urn:uuid:02a76d74-82d0-43e6-ab09-16f54ab81ac6
</wsa:Address></wsa:EndpointReference><wsd:Types>wsdp:Device</wsd:Types><wsd:Met
adataVersion>1</wsd:MetadataVersion></wsd:Hello></soap:Body></soap:Envelope>
```

## <a name="filtering-wsd-debug-client-results"></a>Фильтрация результатов отладки клиента для WSD

Фильтрация результатов отладки клиента WSD может помочь определить трафик инцидента, включающий устройство. Фильтрация необходима только для бесшумных сетей.

Существует два способа фильтрации результатов. IP-адреса для фильтрации можно определить явным образом при запуске клиента отладки WSD. Кроме того, IP-адреса можно указать после запуска клиента. В этом разделе описываются оба метода.

**Указание IP-адресов для фильтрации при запуске клиента отладки WSD**

1.  Настройте узел и клиент для работы по сети (то есть убедитесь, что узел и клиент будут работать на разных компьютерах).
2.  Собирайте IP-адреса устройства. Если устройство имеет несколько адресов (например, в нем есть адреса IPv4 и IPv6), необходимо собрать все адреса.
3.  Откройте командную строку и выполните следующую команду: **всддебуг \_client.exe/Mode multicast/IP Add***<device IP>*

*<device IP>* — Это IP-адрес. В следующем списке приведены некоторые примеры форматов для этого IP-адреса.

-   адреса
-   ::1
-   mydevice.contoso.com

Клиент отладки WSD автоматически разрешает имена узлов, предоставленные в командной строке.

**Фильтрация результатов после запуска клиента отладки WSD**

1.  Настройте узел и клиент для работы по сети (то есть убедитесь, что узел и клиент будут работать на разных компьютерах).
2.  Собирайте IP-адреса устройства. Если устройство имеет несколько адресов (например, в нем есть адреса IPv4 и IPv6), необходимо собрать все адреса.
3.  Откройте командную строку и выполните следующую команду: **всддебуг \_client.exe/Mode multicast**
4.  В командной строке клиента отладки WSD выполните следующую команду: **IP Add** . *<device IP>*
5.  Повторите шаг 4, пока не будут добавлены все IP-адреса устройств.

В следующей процедуре предполагается, что клиент отладки WSD запущен и выполняется фильтрация по IP-адресу.

**Проверка фильтрации правильных IP-адресов**

-   В командной строке клиента отладки WSD выполните следующую команду: **IP-печать** .

    Отобразится список фильтруемых IP-адресов.

В следующей процедуре предполагается, что клиент отладки WSD запущен и выполняется фильтрация по IP-адресу.

**Отключение фильтрации**

-   В командной строке клиента отладки WSD выполните следующую команду: **IP Clear** .

    Весь трафик многоадресной рассылки теперь будет отображаться в выходных данных отладки.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Процедуры диагностики WSDAPI](wsdapi-diagnostic-procedures.md)
</dt> <dt>

[начало работы с разрешениями WSDAPI](getting-started-with-wsdapi-troubleshooting.md)
</dt> </dl>

 

 



