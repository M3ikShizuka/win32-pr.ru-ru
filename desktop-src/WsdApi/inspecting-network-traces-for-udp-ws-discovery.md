---
description: Любой анализатор сетевых пакетов, который может отображать необработанные пакеты, может использоваться для проверки пакетов WS-Discovery UDP. Рекомендуется Microsoft Network Monitor 3 (Netmon). Дополнительные сведения о netmon см. в статье Загрузка Netmon и примеры DPWS Filters.
ms.assetid: f12f9847-b87f-4d5f-bee3-4d219f9ad898
title: Проверка трассировки сети для UDP-WS-Discovery
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ce21e2943a37640eb091aa03c02eba0886164166b2959e31e897ee788424cd41
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "117920758"
---
# <a name="inspecting-network-traces-for-udp-ws-discovery"></a>Проверка трассировки сети для UDP-WS-Discovery

Любой анализатор сетевых пакетов, который может отображать необработанные пакеты, может использоваться для проверки пакетов WS-Discovery UDP. Рекомендуется Microsoft Network Monitor 3 (Netmon). Дополнительные сведения о netmon см. в статье [Загрузка Netmon и примеры DPWS Filters](downloading-netmon-and-sample-dpws-filters.md).

**Проверка трассировки сети для протокола UDP WS-Discovery**

1.  Настройте узел и клиент для работы по сети (то есть убедитесь, что узел и клиент будут работать на разных компьютерах).
2.  Установите анализатор пакетов (Netmon) на клиенте или на узле.
3.  Настройте анализатор пакетов для записи трафика на сетевом адаптере, соединяющем узел и клиент.
4.  Воспроизведите ошибку, запустив узел и клиент или нажав клавишу F5 в обозревателе сети.
5.  Отфильтруйте результаты, чтобы изолировать WS-Discoveryный трафик. Чтобы просмотреть примеры фильтров Netmon, см. [статью Загрузка Netmon и примеры DPWS Filters](downloading-netmon-and-sample-dpws-filters.md).
    > [!Note]  
    > Это необязательный шаг.

     

6.  Убедитесь, что сообщения, передаваемые между клиентом и узлом, соответствуют основным требованиям к трафику.

## <a name="verifying-that-messages-meet-traffic-requirements"></a>Проверка соответствия сообщений требованиям к трафику

WSDAPI клиенты и узлы должны отправить сообщения, соответствующие следующим критериям. общие сведения о шаблонах сообщений см. в разделе [обнаружение и метаданные Exchange шаблонах сообщений](discovery-and-metadata-exchange-message-patterns.md).

-   Сообщения [пробы](probe-message.md) должны отправляться с помощью многоадресной рассылки UDP на порт 3702.
-   Элемент **types** сообщения [пробы](probe-message.md) должен присутствовать и не должен быть пустым. Он должен содержать типы, на которые будет отвечать узел.
-   Сообщение [ProbeMatch](probematches-message.md) должно быть отправлено на UDP-порт, с которого была отправлена [проба](probe-message.md) .
-   Элемент очистки сообщения [ProbeMatch](probematches-message.md) должен **быть указан и** не должен быть пустым. Его значение должно соответствовать значению элемента **MessageId** из соответствующего сообщения [зонда](probe-message.md) .
-   Если элемент **ксаддрс** был добавлен в сообщение [ProbeMatch](probematches-message.md) , необходимо проверить предоставленные транспортные адреса. Дополнительные сведения см. в разделе [правила проверки ксаддр](xaddr-validation-rules.md).
-   Сообщение [ProbeMatch](probematches-message.md) должно быть отправлено в течение 4 секунд соответствующего [проверочного](probe-message.md) сообщения. брандмауэр Windows может удалить сообщение probematch, отправленное более 4 секунд после сообщения пробы.
-   Если в сообщении [ProbeMatch](probematches-message.md) не было указано ни одного элемента **ксаддрс** , а клиент или узел отправит HTTP-сообщение (например, запрос на [Получение](get--metadata-exchange--http-request-and-message.md) метаданных или сообщение службы), клиент или узел должен отправить сообщение с [разрешением](resolve-message.md) по многоадресной рассылке UDP на порт 3702.
-   Если отправляется сообщение с [разрешением](resolve-message.md) , сообщение [ресолвематчес](resolvematches-message.md) должно быть отправлено по адресу UDP-порту, с которого было отправлено сообщение разрешения.
-   Сообщение [ресолвематчес](resolvematches-message.md) должно быть отправлено в течение 4 секунд соответствующего сообщения о [разрешении](resolve-message.md) . брандмауэр Windows может удалить ресолвематчесмессаже, который посылается более 4 секунд после сообщения разрешения.

Если сообщения, отправленные программой, не соответствуют этим требованиям к сообщениям, причина проблемы была идентифицирована успешно и дальнейшие действия по устранению неполадок не требуются. Перепишите программу таким образом, чтобы она создавала согласованные сообщения и повторно протестировать программу.

Если источник проблемы по-прежнему не удается определить, обратитесь за помощью в службу поддержки Майкрософт. Перед обращением в службу поддержки собирайте соответствующие файлы журналов, чтобы определить основную причину проблемы. Дополнительные сведения см. в разделе [Включение трассировки WSDAPI](enabling-wsdapi-tracing.md).

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Процедуры диагностики WSDAPI](wsdapi-diagnostic-procedures.md)
</dt> <dt>

[начало работы с разрешениями WSDAPI](getting-started-with-wsdapi-troubleshooting.md)
</dt> <dt>

[Загрузка Netmon и примеров фильтров DPWS](downloading-netmon-and-sample-dpws-filters.md)
</dt> </dl>

 

 



