---
description: Узнайте, как проверять трассировку сети с помощью прямого обнаружения. Анализатор сетевых пакетов, отображающий необработанные пакеты, может проверять запросы на обмен метаданными HTTP.
ms.assetid: 9b124117-06e7-4637-9863-0f9650861526
title: Проверка трассировки сети для приложений с помощью направленного обнаружения
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 02d94ea3bc102c57c415be518883296e049490ca
ms.sourcegitcommit: d0eb44d0a95f5e5efbfec3d3e9c143f5cba25bc3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/17/2021
ms.locfileid: "112262126"
---
# <a name="inspecting-network-traces-for-applications-using-directed-discovery"></a>Проверка трассировки сети для приложений с помощью направленного обнаружения

Любой анализатор сетевых пакетов, который может отображать необработанные пакеты, может использоваться для проверки запросов на обмен метаданными HTTP. Рекомендуется Microsoft Network Monitor 3 (Netmon). Дополнительные сведения о netmon см. в статье [Загрузка Netmon и примеры DPWS Filters](downloading-netmon-and-sample-dpws-filters.md).

**Проверка трассировки сети для направленного обнаружения**

1.  Настройте узел и клиент для работы по сети (то есть убедитесь, что узел и клиент будут работать на разных компьютерах).
2.  Установите анализатор пакетов (Netmon) на клиенте или на узле.
3.  Настройте анализатор пакетов для записи трафика на сетевом адаптере, соединяющем узел и клиент.
4.  Воспроизведите ошибку, запустив узел и клиент или нажав клавишу F5 в обозревателе сети.
5.  Отфильтруйте результаты, чтобы изолировать WS-Discovery и трафик обмена метаданными. Чтобы просмотреть примеры фильтров Netmon, см. [статью Загрузка Netmon и примеры DPWS Filters](downloading-netmon-and-sample-dpws-filters.md).
    > [!Note]  
    > Это необязательный шаг.

     

6.  Убедитесь, что сообщения, передаваемые между клиентом и узлом, соответствуют основным требованиям к трафику.

## <a name="verifying-that-messages-meet-traffic-requirements"></a>Проверка соответствия сообщений требованиям к трафику

WSDAPI клиенты и узлы должны отправить сообщения, соответствующие следующим критериям. Общие сведения о шаблонах сообщений см. в статье [шаблоны сообщений обнаружения и обмена метаданными](discovery-and-metadata-exchange-message-patterns.md).

-   Сообщения [пробы](probe-message.md) должны отправляться по протоколу HTTP или HTTPS, обычно к порту 5357 или 5358.
-   Элемент **types** сообщения [пробы](probe-message.md) должен присутствовать и не должен быть пустым. Он должен содержать типы, на которые будет отвечать узел.
-   Сообщение [ProbeMatch](probematches-message.md) должно быть отправлено на порт HTTP или HTTPS, с которого была отправлена [проба](probe-message.md) .
-   Элемент очистки сообщения [ProbeMatch](probematches-message.md) должен **быть указан и** не должен быть пустым. Его значение должно соответствовать значению элемента **MessageId** из соответствующего сообщения [зонда](probe-message.md) .
-   Если элемент **ксаддрс** был добавлен в сообщение [ProbeMatch](probematches-message.md) , необходимо проверить предоставленные транспортные адреса. Дополнительные сведения см. в разделе [правила проверки ксаддр](xaddr-validation-rules.md).
-   Сообщение [ProbeMatch](probematches-message.md) должно быть отправлено в течение 4 секунд соответствующего [проверочного](probe-message.md) сообщения. Брандмауэр Windows может удалить сообщение ProbeMatch, отправленное более 4 секунд после сообщения пробы.
-   Если в сообщение [ProbeMatch](probematches-message.md) не включался элемент **ксаддрс** , а клиент или узел отправит HTTP-сообщение (например, запрос на [Получение](get--metadata-exchange--http-request-and-message.md) метаданных или сообщение службы), то клиент или узел должен отправить сообщение с [разрешением](resolve-message.md) по протоколу HTTP или HTTPS. Это сообщение обычно отправляется на порт 5357 или 5358.
-   Если отправляется сообщение с [разрешением](resolve-message.md) , то сообщение [ресолвематчес](resolvematches-message.md) должно быть отправлено на порт HTTP или HTTPS, с которого было отправлено сообщение разрешения.
-   Сообщение [ресолвематчес](resolvematches-message.md) должно быть отправлено в течение 4 секунд соответствующего сообщения о [разрешении](resolve-message.md) . Брандмауэр Windows может удалить Ресолвематчесмессаже, отправленный после сообщения с разрешением более 4 секунд.

Если сообщения, отправленные программой, не соответствуют этим требованиям к сообщениям, причина проблемы была идентифицирована успешно и дальнейшие действия по устранению неполадок не требуются. Перепишите программу таким образом, чтобы она создавала согласованные сообщения и повторно протестировать программу.

Если источник проблемы по-прежнему не удается определить, обратитесь за помощью в службу поддержки Майкрософт. Перед обращением в службу поддержки собирайте соответствующие файлы журналов, чтобы определить основную причину проблемы. Дополнительные сведения см. в разделе [Включение трассировки WSDAPI](enabling-wsdapi-tracing.md).

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Устранение неполадок в приложениях с помощью направленного обнаружения](troubleshooting-applications-using-directed-discovery.md)
</dt> <dt>

[Процедуры диагностики WSDAPI](wsdapi-diagnostic-procedures.md)
</dt> <dt>

[начало работы с разрешениями WSDAPI](getting-started-with-wsdapi-troubleshooting.md)
</dt> <dt>

[Загрузка Netmon и примеров фильтров DPWS](downloading-netmon-and-sample-dpws-filters.md)
</dt> </dl>

 

 



