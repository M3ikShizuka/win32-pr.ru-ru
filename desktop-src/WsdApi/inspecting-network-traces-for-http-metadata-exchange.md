---
description: Любой анализатор сетевых пакетов, который может отображать необработанные пакеты, может использоваться для проверки запросов на обмен метаданными HTTP. Рекомендуется Microsoft Network Monitor 3 (Netmon). Дополнительные сведения о netmon см. в статье Загрузка Netmon и примеры DPWS Filters.
ms.assetid: b3b6c4d1-5fa3-41fb-ae1d-067638e385b0
title: Проверка трассировки сети для обмена метаданными HTTP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0c9993c542789b7f11eb35344dd6b0b03bfbafc3
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104263908"
---
# <a name="inspecting-network-traces-for-http-metadata-exchange"></a>Проверка трассировки сети для обмена метаданными HTTP

Любой анализатор сетевых пакетов, который может отображать необработанные пакеты, может использоваться для проверки запросов на обмен метаданными HTTP. Рекомендуется Microsoft Network Monitor 3 (Netmon). Дополнительные сведения о netmon см. в статье [Загрузка Netmon и примеры DPWS Filters](downloading-netmon-and-sample-dpws-filters.md).

Эта диагностическая процедура может не быть полезной для клиентов и узлов, использующих безопасный канал для обмена данными, так как содержимое сообщения зашифровано.

**Проверка трассировки сети для обмена метаданными HTTP**

1.  Настройте узел и клиент для работы по сети (то есть убедитесь, что узел и клиент будут работать на разных компьютерах).
2.  Установите анализатор пакетов (Netmon) на клиенте или на узле.
3.  Настройте анализатор пакетов для записи трафика на сетевом адаптере, соединяющем узел и клиент.
4.  Воспроизведите ошибку, запустив узел и клиент или нажав клавишу F5 в обозревателе сети.
5.  Отфильтруйте результаты, чтобы изолировать WS-Discovery и трафик обмена метаданными. Чтобы просмотреть примеры фильтров Netmon, см. [статью Загрузка Netmon и примеры DPWS Filters](downloading-netmon-and-sample-dpws-filters.md).
    > [!Note]  
    > Это необязательный шаг.

     

6.  Убедитесь, что сообщения, передаваемые между клиентом и узлом, соответствуют основным требованиям к трафику.

## <a name="verifying-that-messages-meet-traffic-requirements"></a>Проверка соответствия сообщений требованиям к трафику

WSDAPI клиенты и узлы должны отправить сообщения, соответствующие следующим критериям. Общие сведения о шаблонах сообщений см. в статье [шаблоны сообщений обнаружения и обмена метаданными](discovery-and-metadata-exchange-message-patterns.md).

-   Сообщения должны удовлетворять требованиям к трафику, приведенным в разделе [Проверка трассировки сети для протокола UDP WS-Discovery](inspecting-network-traces-for-udp-ws-discovery.md), если только это не является абсолютно уверенным, что WS-Discovery не используется для обмена метаданными.
-   Должно быть установлено TCP-соединение между клиентом и первым транспортным адресом, указанным в элементе **ксаддрс** сообщения [ProbeMatch](probematches-message.md) или [ресолвематчес](resolvematches-message.md) . В следующем списке показан типичный обмен пакетами, используемый для установления TCP-соединения.
    -   Клиент отправляет пакет TCP SYN на узел с указанным портом.
    -   Узел отправляет клиенту пакет TCP SYN/ACK.
    -   Клиент отправляет пакет TCP ACK узлу по указанному порту.

    После отправки клиентом пакета TCP ACK устанавливается подключение TCP. Обратите внимание, что обмен сообщениями не произойдет, если подключение TCP было установлено ранее.
-   Клиент должен отправить допустимый запрос [Get](get--metadata-exchange--http-request-and-message.md) HTTP и сообщение.
-   Узел должен прослушиваться по URL-пути, указанному в запросе [Get](get--metadata-exchange--http-request-and-message.md) HTTP.
-   Элемент **to** сообщения [получения](get--metadata-exchange--http-request-and-message.md) метаданных должен быть указан и не пуст. Значение элемента **to** должно соответствовать одному из адресов конечной точки узла. Адрес конечной точки узла обычно объявляется в сообщении [ProbeMatch](probematches-message.md) или [ресолвематчес](resolvematches-message.md) .
-   Узел должен отправить допустимый заголовок ответа HTTP. Если первоначальный запрос был успешным, заголовок ответа должен содержать код состояния HTTP/1.1 200.
-   Узел должен отправить допустимое сообщение [GetResponse](getresponse--metadata-exchange--message.md) .
-   Элемент **очистки** сообщения [GetResponse](getresponse--metadata-exchange--message.md) должен присутствовать и не должен быть пустым. Его значение должно соответствовать значению элемента **MessageId** из соответствующего сообщения [Get](get--metadata-exchange--http-request-and-message.md) .

Если HTTP-запросы или сообщения обмена метаданными, отправленные программой, не соответствуют этим требованиям к трафику, причина проблемы была идентифицирована успешно и дальнейшие действия по устранению неполадок не требуются. Перепишите программу таким образом, чтобы она создавала согласованные сообщения и запросы и повторно протестировать программу.

Если источник проблемы по-прежнему не удается определить, обратитесь за помощью в службу поддержки Майкрософт. Перед обращением в службу поддержки собирайте соответствующие файлы журналов, чтобы определить основную причину проблемы. Дополнительные сведения см. в разделе [Включение трассировки WSDAPI](enabling-wsdapi-tracing.md).

## <a name="related-topics"></a>См. также

<dl> <dt>

[Процедуры диагностики WSDAPI](wsdapi-diagnostic-procedures.md)
</dt> <dt>

[начало работы с разрешениями WSDAPI](getting-started-with-wsdapi-troubleshooting.md)
</dt> <dt>

[Загрузка Netmon и примеров фильтров DPWS](downloading-netmon-and-sample-dpws-filters.md)
</dt> </dl>

 

 



