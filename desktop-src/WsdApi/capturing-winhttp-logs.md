---
description: Журналы WinHTTP можно использовать для устранения неполадок в приложениях WSDAPI. Это полезно при сбое обмена метаданными или при сбое согласования SSL/TLS.
ms.assetid: 75ba330d-afcd-4d8f-93c7-a1b9f80dd050
title: Запись журналов WinHTTP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 378801e97b2eef8c1ea0c40a5973844d75a94e02
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104155990"
---
# <a name="capturing-winhttp-logs"></a>Запись журналов WinHTTP

Журналы [WinHTTP](/windows/desktop/WinHttp/winhttp-start-page) можно использовать для устранения неполадок в приложениях WSDAPI. Это полезно при сбое обмена метаданными или при сбое согласования SSL/TLS.

В этой процедуре показано, как записать журналы WinHTTP на клиентском компьютере. Клиентское приложение на основе WSDAPI не должно выполняться, если включено ведение журнала. Если клиентское приложение выполняется при включении ведения журнала, клиент и (или) компьютер должны быть перезапущены, прежде чем WS-Discovery и трафик обмена метаданными появится в журналах WinHTTP.

**Запись журналов WinHTTP**

1.  Откройте окно командной строки с повышенными привилегиями на клиентском компьютере.
2.  Выполните следующую команду: **netsh WinHTTP Set Trace трассировка-File-prefix = "C: \\ temp \\ DPWS" уровень = verbose Format = ANSI состояние = включено Max-Trace-File-Size = 1073741824**

    Эта команда включает ведение журнала WinHTTP. Все файлы журналов будут храниться в каталоге C: \\ TEMP, а имена файлов будут начинаться с префикса DPWS. Будет храниться не более 1 ГБ файлов журнала.

3.  Если процесс, использующий WinHTTP на клиенте, уже запущен, перезагрузите компьютер. Например, если используются API-интерфейсы [обнаружения функций](/previous-versions/windows/desktop/fundisc/fd-portal) , необходимо перезапустить компьютер. API-интерфейсы обнаружения функций вызывают WinHTTP из узла службы, который, возможно, уже запущен при включенной трассировке.
4.  Запустите клиентское приложение на основе WSDAPI. Отлаживаемый приложение или можно использовать клиент отладки WSD.
5.  Воспроизведение ошибки приложения.
6.  Завершите работу клиентского приложения на основе WSDAPI.
7.  Если процесс, использующий WinHTTP, не завершается клиентским приложением, перезагрузите компьютер. Например, если используются API-интерфейсы [обнаружения функций](/previous-versions/windows/desktop/fundisc/fd-portal) , необходимо перезапустить компьютер.
8.  Выполните следующую команду: **netsh WinHTTP set tracing State = Disabled**

    Эта команда отключает ведение журнала WinHTTP.

9.  Проверьте журналы DPWS в C: \\ TEMP и убедитесь, что были отправлены необходимые запросы и сообщения.
10. Если используется обмен данными по защищенному каналу (HTTPS), проверьте наличие ошибок SSL/TLS.

После записи журналов WinHTTP журналы можно просмотреть, чтобы найти причину сбоя приложения WSDAPI. Обратите внимание, что текстовый редактор, используемый для просмотра этих журналов, должен запускаться от имени администратора. Дополнительные сведения см. [в разделе Использование ведения журнала WinHTTP для проверки получения трафика](using-winhttp-logging-to-verify-get-traffic.md).

## <a name="related-topics"></a>См. также

<dl> <dt>

[Известен](/windows/desktop/WinHttp/winhttp-start-page)
</dt> <dt>

[Использование ведения журнала WinHTTP для проверки получения трафика](using-winhttp-logging-to-verify-get-traffic.md)
</dt>
</dl>
