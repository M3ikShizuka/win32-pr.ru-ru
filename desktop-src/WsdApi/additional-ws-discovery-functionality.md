---
description: В этом разделе описаны функции обнаружения, реализованные в WSDAPI, но не описанные в спецификации DPWS или WS-Discovery.
ms.assetid: ae7eff53-c932-4cba-9e71-c60f308f0e2d
title: Дополнительные функции WS-Discovery
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7a7ee4094950c51ed84724abb9eaea493f7dad7cf7803832fb6e8762fdd99811
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118106782"
---
# <a name="additional-ws-discovery-functionality"></a>Дополнительные функции WS-Discovery

В некоторых случаях [профиль устройств для веб-служб](https://specs.xmlsoap.org/ws/2006/02/devprof/) (DPWS) и связанные спецификации не определяют функции реализации явным образом. Например, спецификация [WS-Discovery](https://specs.xmlsoap.org/ws/2005/04/discovery/ws-discovery.pdf) не определяет поведение клиента и узла в многосетевых средах. При реализации WSDAPI некоторые функции обнаружения были добавлены за пределы функций, определенных в спецификации.

WSDAPI также реализует выбранные части WS-Discovery v 1.1 1 для взаимодействия с прокси-сервером обнаружения по протоколу HTTP.

В этом разделе описаны функции обнаружения, реализованные в WSDAPI, но не описанные в спецификации DPWS или WS-Discovery.

## <a name="ipv6-addresses-and-the-soapudp-uri-format"></a>IPv6-адреса и формат URI SOAP. UDP

SOAP-over-UDP и WS-Discovery явно не описывают, как литеральный IPv6-адрес представлен в формате URI SOAP. UDP. [RFC 2396](https://www.ietf.org/rfc/rfc2396.txt), озаглавленный "универсальные идентификаторы ресурсов (URI): универсальный синтаксис", указывает, что литеральные IPv6-адреса не поддерживаются форматом URI SOAP. UDP.

Для простоты WSDAPI распознает IPv6-адреса, заключенные в квадратные скобки в схеме SOAP. UDP. Например, адрес `soap.udp://[2001:abcd:0001:0002:0003:0004:0005:0032]:3702` распознается WSDAPI. Это похоже на то, как IPv6-адреса обрабатываются в HTTP.

## <a name="hello-and-xaddrs"></a>Привет и Ксаддрс

Объект размещения DPWS WSDAPI никогда не отправляет сообщение [Hello](hello-message.md) WS-Discovery с [ксаддрс](xaddr-validation-rules.md) в теле сообщения. Клиент всегда будет отсылать сообщение с [разрешением](resolve-message.md) после получения сообщения Hello, если клиенту необходимо получить ксаддрс.

Существует два преимущества этого подхода. Во-первых, устройство, созданное на WSDAPI, никогда не будет предоставлять Ксаддрс, которые раскрывают IP-адреса частных сетей. Во-вторых, устройство, созданное на WSDAPI, предоставляет доступ к Ксаддрс только для клиента, что означает, что IPv6-адреса никогда не отправляются клиенту IPv4.

При получении сообщения [проверки](probe-message.md) или разрешения в ответ отправляется только одно ксаддр. Отправленный Ксаддр соответствует локальному адресу, на который был получен запрос. Если запрос был получен в подсетях по протоколу IPv6, то WSDAPI будет предоставлять глобальный IPv6-адрес в ответе.

## <a name="preferred-addresses"></a>Предпочтительные адреса

Устройство может предоставлять несколько Ксаддрс в сообщении [Hello](hello-message.md), [пробематч](probematches-message.md)или [ресолвематч](resolvematches-message.md) . Служба также может быть доступна на нескольких конечных точках с разными адресами транспорта. В таких случаях WSDAPI будет пытаться связаться с устройством по первому используемому адресу. Адрес можно использовать, если он доступен из доступного протокола, такого как IPv4 на компьютере, где установлена IPv4, или IPv6 на компьютере, где установлен IPv6. Кроме того, если адрес поступил от устройства или службы, которые не находятся в локальной подсети, он может использоваться только в том случае, если он является IPv4, локальным сайтом IPv6 или локальным каналом IPv6.

## <a name="wsdl-in-metadata-exchange"></a>WSDL в обмене метаданными

Устройства и службы, созданные на сервере WSDAPI, не обеспечивают их WSDL в обмене метаданными, если только они не расширены приложением для предоставления этих сведений. По умолчанию наполнение WSDL не является частью модели программирования.

## <a name="app_max_delay"></a>\_Максимальная \_ Задержка приложения

DPWS определяет \_ максимальную \_ задержку приложения, случайный интервал для задержки между получением [пробы](probe-message.md) и отправкой [пробематч](probematches-message.md), как 5 000 миллисекунд. Windows Брандмауэр требует, чтобы модель многоадресного запроса/одноадресного ответа для UDP работала только в 4-секундном окне брандмауэра. В результате WSDAPI будет передавать ответы в 2 500 мс или менее, а не в окне 5 000 MS, описанном в разделе \_ Max Delay (максимальная задержка приложения) \_ .

## <a name="iana-port-reservations"></a>Резервирования портов IANA

Протокол WSDAPI использует TCP-порт 5357 для трафика HTTP и TCP-порт 5358 для трафика HTTPS по умолчанию. Эти порты зарезервированы для процессов с более низким уровнем привилегий с помощью резервирования URL-адресов в HTTP.sys и также зарезервированы IANA.

## <a name="udp-port-sharing"></a>Общий доступ к портам UDP

WSDAPI использует общий доступ к портам. Одноадресные сообщения, отправленные на порт 3702, могут быть неправильно обработаны всеми приложениями на базе WSDAPI. Если приложение привязывается только к порту 3702, оно может препятствовать правильному использованию этого порта приложениями на основе WSDAPI.

## <a name="ws-discovery-v11-cd1-proxy"></a>Прокси-сервер WS-Discovery v 1.1

WSDAPI будет искать и взаимодействовать с прокси-сервером обнаружения, который реализует протокол управляемого режима WS-Discovery v 1.1 с интерфейсом 1. WS-Discovery v 1.1 1 – Первая редакция WS-Discovery включает явное описание протокола HTTP для обмена данными между прокси-сервером и клиентом или устройством.

Чтобы ограничить количество одновременных версий, используемых в многоадресных запросах, WSDAPI отправляет запрос на проверку WS-Discovery в пространстве имен 2005/04, но ищет тип DiscoveryProxy WS-Discovery v 1.1 1. Если прокси-сервер отвечает, то WSDAPI отправляет проверку HTTP или разрешает запрос в указанную конечную точку прокси, как определено в WS-Discovery v 1.1 1.

 

 



