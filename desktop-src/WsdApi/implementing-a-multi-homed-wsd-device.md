---
description: В этом разделе описывается поддержка многосетевой поддержки устройств в WSDAPI и предоставляются рекомендации по реализации для разработчиков клиентов и устройств.
ms.assetid: d30ed536-d477-4f50-8c80-aacc35f948b9
title: Реализация многосетевого устройства WSD
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1ac3537b96a577db47419d55cb5c6f732f8f7906
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104272424"
---
# <a name="implementing-a-multi-homed-wsd-device"></a>Реализация многосетевого устройства WSD

[WS-Discovery](https://specs.xmlsoap.org/ws/2005/04/discovery/ws-discovery.pdf) и [профиль устройств для веб-служб](https://specs.xmlsoap.org/ws/2006/02/devprof/) (DPWS) не описывают реализацию устройств с несколькими сетевыми интерфейсами. В этом разделе описывается поддержка многосетевой поддержки устройств в WSDAPI и предоставляются рекомендации по реализации для разработчиков клиентов и устройств. В этом разделе предполагается, что сообщения обнаружения отправляются по протоколам IPv4 и IPv6 (если они доступны) с одинаковым ИДЕНТИФИКАТОРом сообщения и сведениями о последовательности приложений.

## <a name="discovery-in-a-multi-homed-environment"></a>Обнаружение в среде с несколькими сетевыми интерфейсами

Как упоминалось в разделе [Hello](hello-message.md) и [ксаддрс](xaddr-validation-rules.md) [дополнительных функций WS-Discovery](additional-ws-discovery-functionality.md), WSDAPI никогда не предоставляет ксаддрс в сообщении Hello. Это означает, что одно и то же сообщение Hello можно отправить по всем сетевым интерфейсам с одинаковым ИДЕНТИФИКАТОРом сообщения и сведениями о последовательности приложений. Это упрощает обнаружение конфликтов клиентов для удаления нескольких сообщений Hello с одного и того же устройства, когда клиент и устройство совместно используют более одной подсети.

Так как [ксаддрс](xaddr-validation-rules.md) не отправляются в сообщении [Hello](hello-message.md) , клиентские реализации должны отправить сообщение с [разрешением](resolve-message.md) , чтобы получить соответствующий адрес устройства. Разрешение следует отправлять для всех клиентских интерфейсов с тем же ИДЕНТИФИКАТОРом сообщения, и устройство должно фильтровать дублирующиеся сообщения по мере необходимости. Использование того же идентификатора сообщения для сообщения с разрешением позволяет устройству выбрать предпочтительный интерфейс для взаимодействия с клиентами, если это необходимо.

При отправке сообщения [ресолвематч](resolvematches-message.md) устройство должно предоставлять [ксаддрс](xaddr-validation-rules.md) , относящиеся к сетевому интерфейсу, для которого он является одноадресным. Такой подход позволяет избежать множественных попыток подключения клиентов и сложной логики повторных попыток.

## <a name="metadata-exchange-in-a-multi-homed-environment"></a>Обмен метаданными в среде с несколькими сетевыми интерфейсами

Реализация обмена метаданными в среде с несколькими сетевыми средами сложнее, чем реализация обнаружения из-за управления версиями метаданных. Если клиент запрашивает метаданные через несколько интерфейсов, клиент может получить несколько сообщений [GetResponse](getresponse--metadata-exchange--message.md) через различные интерфейсы. Эти сообщения GetResponse могут содержать разные разделы метаданных **отношений** с одинаковой версией метаданных. Это сокращает значение номера версии метаданных.

Существует альтернативный подход, в котором в ответ на все адреса службы отправляется одно сообщение с методом [GetResponse](getresponse--metadata-exchange--message.md) . Недостаток этого метода заключается в том, что частная информация, например топология непрямо доступных сетей, может быть раскрываться.

В Windows Vista метаданные, предоставляемые WSDAPI, содержат только адреса, допустимые для интерфейса, на основе которого был получен запрос метаданных.

 

 



