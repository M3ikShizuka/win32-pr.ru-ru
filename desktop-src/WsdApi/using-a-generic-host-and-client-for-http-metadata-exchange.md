---
description: Если клиент и узел не могут обмениваться метаданными, то для пользовательского узла и клиента можно заменить универсальный узел и клиент, чтобы помочь устранить проблему.
ms.assetid: 7e5c8444-b3ee-4e9c-984f-13d54f2bbfc0
title: Использование универсального узла и клиента для метаданных HTTP Exchange
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 10040f4834df1a77115a361d23d82ec3dfcc6c57
ms.sourcegitcommit: 61a4c522182aa1cacbf5669683d9570a3bf043b2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/26/2021
ms.locfileid: "122883177"
---
# <a name="using-a-generic-host-and-client-for-http-metadata-exchange"></a>Использование универсального узла и клиента для метаданных HTTP Exchange

Если клиент и узел не могут обмениваться метаданными, то для пользовательского узла и клиента можно заменить универсальный узел и клиент, чтобы помочь устранить проблему. Если адрес устройства или метаданные устройства не отображаются в выходных данных клиента отладки WSD, указанные адреса транспорта или сетевая среда могут вызвать сбой. Дополнительные сведения об универсальном узле и клиенте см. в разделе [средства отладки](debugging-tools.md).

Если вы проверили, что универсальный узел и клиент могут завершить как WS-Discovery, так и обмен метаданными HTTP, эту диагностическую процедуру можно пропустить, а устранение неполадок можно продолжить, выполнив процедуры, описанные в статье [Использование ведения журнала WinHTTP для проверки получения трафика](using-winhttp-logging-to-verify-get-traffic.md).

Если узел или клиент является приложением, запущенным на компьютере, универсальный узел или клиент должны быть запущены в том же контексте безопасности, что и фактический узел или клиент. Например, если фактический узел или клиент работает от имени администратора, то универсальный узел или клиент должен работать от имени администратора. Кроме того, если узел или клиент является автономным устройством, он должен быть полностью заменен ПК, на котором работает универсальный узел или клиент, в контексте безопасности, который обеспечивает неограниченный доступ к сети (например, Запуск от имени администратора).

**Использование универсального узла и клиента для устранения неполадок при обмене метаданными HTTP**

1.  Откройте окно командной строки.
2.  Выполните следующую команду: **всддебуг \_host.exe/Mode Metadata/Start**

    > [!Note]  
    > может появиться диалоговое окно **Безопасность Windows предупреждения** . Если это так, нажмите кнопку **разблокировать** , чтобы разрешить запуск узла отладки WSD.

     

    Эта команда создает выходные данные, аналогичные приведенным ниже. Запишите идентификатор устройства.

    ``` syntax
    WSDAPI Debug Host
    Copyright (C) Microsoft Corporation 2007.  All rights reserved.
    Device ID is urn:uuid:37f86d35-e6ac-4241-964f-1d9ae46fb366
    Host metadata>
    ```

3.  Выполните следующую команду: **всддебуг \_client.exe/Mode метаданных/Хелло Off/ресолве** *&lt; ID &gt;*. Замените *&lt; ID &gt;* идентификатором устройства, указанным на шаге 2.
    > [!Note]  
    > может появиться диалоговое окно **Безопасность Windows предупреждения** . Если это так, нажмите кнопку **разблокировать** , чтобы разрешить запуск клиента отладки WSD.

     

Клиент отладки WSD создает выходные данные, аналогичные приведенным ниже.

``` syntax
WSDAPI Debug Client
Copyright (C) Microsoft Corporation 2007.  All rights reserved.
Client ID is urn:uuid:0f571af7-6b0e-4daf-8054-f2233ac27910
Hello mode is disabled
Client metadata>
*****************************************************************************
Add at 02/28/07 15:16:51
+ EPR:
  + Address:                 urn:uuid:37f86d35-e6ac-4241-964f-1d9ae46fb366
+ Types:
    (wsdp) https://schemas.xmlsoap.org/ws/2006/02/devprof:Device
+ XAddrs:
  https://[::1]:5357/37f86d35-e6ac-4241-964f-1d9ae46fb366
+ Metadata version:          2
+ Instance ID:               1
+ Probe/Resolve tag:         WSDAPI debug_client
+ Remote transport address:  [::1]:3702
+ Local transport address:   ::1
+ Local interface GUID:      42133cd4-6a70-11db-bbc9-806e6f6e6963
Client metadata>
*****************************************************************************
Getting metadata for host at 02/28/07 15:16:51:
+ Endpoint reference:
  + Address:
    urn:uuid:37f86d35-e6ac-4241-964f-1d9ae46fb366
Using xAddr: https://[::1]:5357/37f86d35-e6ac-4241-964f-1d9ae46fb366
Client metadata>
*****************************************************************************
Metadata for host:
+ Endpoint reference:
  + Address:           urn:uuid:37f86d35-e6ac-4241-964f-1d9ae46fb366
Metadata section:
  + Dialect:
    https://schemas.xmlsoap.org/ws/2006/02/devprof/ThisDevice
  + Friendly name:
    [no lang]: Debugging Host
  + Firmware version:  1.0
  + Serial number:     00000000
Metadata section:
  + Dialect:
    https://schemas.xmlsoap.org/ws/2006/02/devprof/ThisModel
  + Manufacturer:
    [no lang]: Microsoft Corporation
  + Manufacturer URL:  https://www.microsoft.com/
  + Model names:
    [no lang]: Microsoft Debugging Host
  + Model number:      https://www.microsoft.com/
End of metadata
Client metadata>
```

Клиент отладки WSD может создавать большой объем выходных данных в сети с множеством устройств DPWS. Выходные данные можно перенаправить в файл для упрощения анализа. Введите **log tee** *&lt; имя_файла &gt;* в командной строке клиента отладки WSD, чтобы перенаправить вывод в файл. Перенаправление выходных данных можно остановить, введя **log tee остановиться** в командной строке клиента отладки WSD.

Запишите адрес ссылки на конечную точку (EPR). Этот адрес EPR должен соответствовать ИДЕНТИФИКАТОРу устройства, указанному на шаге 2 выше. Кроме того, убедитесь, что клиент отладки WSD полностью выпечатал метаданные для устройства. Метаданные устройства начинаются с `Metadata for host` и заканчиваются на `End of metadata` .

Если идентификатор устройства и метаданные устройства правильно отображаются в выходных данных клиента отладки WSD, то, скорее всего, сбой приложения не связан с переданными адресами транспорта, операционной системой или сетевой средой. Замените универсальный узел и клиент пользовательским узлом и клиентом и продолжайте устранение неполадок, выполнив процедуры, описанные в статье [Использование ведения журнала WinHTTP для проверки получения трафика](using-winhttp-logging-to-verify-get-traffic.md).

Если адрес устройства и метаданные устройства не отображаются в выходных данных клиента отладки WSD, то ошибка может быть вызвана одной или несколькими из следующих причин.

-   Адрес транспорта, объявленный узлом, неверен или имеет неправильный формат. Клиент отладки WSD пытается получить метаданные устройства из URL-адреса, указанного в элементе **ксаддрс** сообщения [ProbeMatch](probematches-message.md) или [ресолвематчес](resolvematches-message.md) . URL-адрес, используемый для обмена метаданными, отображается в выходных данных клиента отладки WSD с префиксом фразы `Using xAddr` . В следующем примере показан Ксаддрс, используемый для обмена метаданными в приведенном выше выходных данных клиента отладки WSD.

    ``` syntax
    Using xAddr: https://[::1]:5357/37f86d35-e6ac-4241-964f-1d9ae46fb366
    ```

    Если указанный Ксаддрс не соответствует [правилам проверки ксаддр](xaddr-validation-rules.md), то клиент отладки WSD не сможет получить метаданные устройства.

-   Приложение выполняется в неправильном контексте безопасности. Убедитесь, что приложение использует правильные учетные данные, а клиент и узел имеют достаточные разрешения для доступа к сети.
-   Неправильная конфигурация брандмауэра. следуйте инструкциям в разделе [проверка параметров брандмауэра и Параметры брандмауэра](inspecting-adapter-and-firewall-settings.md) , чтобы убедиться в правильности настроек Windows брандмауэре и отсутствии других правил удаления пакетов. Клиент и узел также можно скопировать на компьютер "поддерживалась" (один с установкой операционной системы по умолчанию, которая никогда не присоединяется к домену), чтобы попытаться воспроизвести сбой.
-   Политика IPSec блокирует приложение. Скопируйте клиент и узел на компьютер, который не подчиняется политикам IPSec, и попробуйте воспроизвести ошибку.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Процедуры диагностики WSDAPI](wsdapi-diagnostic-procedures.md)
</dt> <dt>

[начало работы с разрешениями WSDAPI](getting-started-with-wsdapi-troubleshooting.md)
</dt> </dl>

 

 



