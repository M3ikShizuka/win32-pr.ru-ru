---
description: Ожидание обхода цепочки (WCT) позволяет отладчикам диагностировать зависания приложений и взаимоблокировки.
ms.assetid: d266a663-b101-4936-9574-f6ce223419ae
title: Ожидание обхода цепочки
ms.topic: article
ms.date: 08/10/2020
ms.custom: contperf-fy21q1
ms.openlocfilehash: 842beb7d5470bc2b3e6e9c7c1150ff2aa1a4cf76
ms.sourcegitcommit: f374b50b37160b683da16b59ac9340282a8f50a5
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/04/2021
ms.locfileid: "103894014"
---
# <a name="wait-chain-traversal"></a>Ожидание обхода цепочки

Ожидание обхода цепочки (WCT) позволяет отладчикам диагностировать зависания приложений и взаимоблокировки.

*Цепочка ожидания* — это последовательность потоков и объектов синхронизации, в которой каждый поток ожидает объект, следующий за ним. Каждый следующий объект, в свою очередь, принадлежит следующему потоку в цепочке.

Поток ожидает объект синхронизации от времени, когда поток запрашивает объект, пока поток не получит его. Это "Блокировка" принадлежит потоку от момента его получения потоком, пока поток не освободит его. Иными словами, когда поток 1 ожидает блокировку, принадлежащую потоку 2, поток 1 находится в состоянии ожидания для потока 2.

WCT поддерживает следующие примитивы синхронизации:

- [Расширенный вызов локальной процедуры (ALPC)](../etw/alpc.md)
- [Модель COM](../com/the-component-object-model.md)
- [Критические секции](../sync/critical-section-objects.md)
- [Мьютексы](../sync/mutex-objects.md)
- [SendMessage](/windows/win32/api/winuser/nf-winuser-sendmessage)
- Операции [ожидания](../sync/wait-functions.md) для [процессов и потоков](../procthread/processes-and-threads.md)

Чтобы получить цепочку ожидания для одного или нескольких потоков, создайте сеанс WCT с помощью функций [опенсреадваитчаинсессион](/windows/desktop/api/Wct/nf-wct-openthreadwaitchainsession) и [GetThreadWaitChain](/windows/desktop/api/Wct/nf-wct-getthreadwaitchain) . Сеансы WCT представлены с помощью маркера типа **хвкт**.

## <a name="sessions-can-be-synchronous-or-asynchronous"></a>Сеансы могут быть синхронными или асинхронными

Синхронные сеансы нельзя отменить и заблокировать вызывающий поток до получения цепочки ожидания.

Асинхронные сеансы не блокируют вызывающий поток и могут быть отменены приложением с помощью функции [клосесреадваитчаинсессион](/windows/desktop/api/Wct/nf-wct-closethreadwaitchainsession) . Результаты асинхронных операций становятся доступными через функцию обратного вызова [ваитчаинкаллбакк](/windows/win32/api/wct/nc-wct-pwaitchaincallback) , предоставляемую приложением.

Для асинхронных сеансов вызывающий объект может указать указатель на структуру данных контекста через [GetThreadWaitChain](/windows/desktop/api/Wct/nf-wct-getthreadwaitchain) (этот же указатель передается функции обратного вызова [ваитчаинкаллбакк](/windows/win32/api/wct/nc-wct-pwaitchaincallback) ).

Структура контекстных данных определяется пользователем и непрозрачна для WCT. Оно может использоваться приложением для обмена контекстом между запросом WCT и функцией обратного вызова. Как правило, обработчик событий передается через эту структуру, и при выполнении обратного вызова это событие сообщается, и поток мониторинга сообщает о завершении запроса.

Пример обхода цепочки ожидания см. [в разделе Использование WCT](using-wct.md) .

## <a name="related-topics"></a>См. также

[С помощью WCT](using-wct.md), [справочника по WCT](wct-reference.md), [MSDN Magazine 2007 Июль-Bugslayer: ожидание цепочки ожидания](/archive/msdn-magazine/2007/july/bugslayer-wait-chain-traversal)