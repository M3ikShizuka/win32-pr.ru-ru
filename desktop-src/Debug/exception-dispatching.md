---
description: При возникновении исключения оборудования или программного обеспечения процессор прекращает выполнение в момент возникновения исключения и передает управление системе.
ms.assetid: 35a1b9bd-8da9-47e6-beda-e0b159bd840d
title: Отправка исключения
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e02b40aa132541fe88d692cbbf1881a8b620a209
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104140794"
---
# <a name="exception-dispatching"></a>Отправка исключения

При возникновении исключения оборудования или программного обеспечения процессор прекращает выполнение в момент возникновения исключения и передает управление системе. Во первых, система сохраняет как состояние компьютера текущего потока, так и сведения, описывающие исключение. Затем система пытается найти обработчик исключений для обработки исключения.

Состояние компьютера в потоке, в котором произошло исключение, сохраняется в структуре [**контекста**](/windows/desktop/api/WinNT/ns-winnt-arm64_nt_context) . Эта информация (называемая *записью контекста*) позволяет системе продолжить выполнение в точке исключения, если исключение успешно обработано. Описание исключения (называемое **записью исключения**) сохраняется в структуре [**\_ записи исключения**](/windows/desktop/api/WinNT/ns-winnt-exception_record) . Так как в нем хранятся зависимые от компьютера сведения о записи контекста отдельно от независимой от компьютера информации об исключении, механизм обработки исключений передается на разные платформы.

Информация в контексте и записи исключений доступна с помощью функции [**жетексцептионинформатион**](getexceptioninformation.md) и может быть предоставлена любым обработчикам исключений, которые выполняются в результате исключения. Запись исключения содержит следующие сведения.

-   Код исключения, определяющий тип исключения.
-   Флаги, указывающие, является ли исключение непрерывным. Любая попытка продолжить выполнение после непостоянного исключения создает еще одно исключение.
-   Указатель на другую запись исключения. Это упрощает создание связанного списка исключений при возникновении вложенных исключений.
-   Адрес, по которому произошло исключение.
-   Массив аргументов, которые предоставляют дополнительные сведения об исключении.

При возникновении исключения в коде пользовательского режима система использует следующий порядок поиска для поиска обработчика исключений:

1.  Если процесс отлаживается, система уведомляет отладчик. Дополнительные сведения см. в разделе [обработка исключений отладчика](debugger-exception-handling.md).
2.  Если процесс не отлаживается или связанный отладчик не обрабатывает исключение, система пытается найти обработчик исключений на основе кадров путем поиска в кадрах стека потока, в котором произошло исключение. Сначала система выполняет поиск в текущем кадре стека, а затем выполняет поиск по предшествующим кадрам стека в обратном порядке.
3.  Если не удается найти обработчик на основе фрейма или обработчик на основе фрейма не обрабатывает исключение, но процесс отлаживается, система уведомляет отладчик второй раз.
4.  Если процесс не отлаживается или связанный отладчик не обрабатывает исключение, система обеспечивает обработку по умолчанию на основе типа исключения. Для большинства исключений действием по умолчанию является вызов функции [**ExitProcess**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-exitprocess) .

При возникновении исключения в коде режима ядра система выполняет поиск в кадрах стека ядра в попытке найти обработчик исключений. Если обработчик не найден или обработчик не обрабатывает исключение, система завершает работу так, как если бы была вызвана функция [**екситвиндовс**](/windows/win32/api/winuser/nf-winuser-exitwindows) .

 

 
