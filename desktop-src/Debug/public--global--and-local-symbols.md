---
description: Возможности обработки символов API DbgHelp были изменены за годы.
ms.assetid: 6dc41682-6104-418b-b045-7afe8c2b11e9
title: Открытые, глобальные и локальные символы
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 72ecaa40549b091af204f2e318aefef8a256408e5f81b461e63a54c333719dd5
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118406104"
---
# <a name="public-global-and-local-symbols"></a>Открытые, глобальные и локальные символы

Возможности обработки символов API DbgHelp были изменены за годы. Чтобы обеспечить работу кода в различных сценариях и предоставить полные сведения о символах, используйте новейшие функции, когда это возможно. Например, [**сименумсимболс**](/windows/desktop/api/Dbghelp/nf-dbghelp-symenumsymbols) заменяет [**SymEnumerateSymbols64**](/windows/desktop/api/Dbghelp/nf-dbghelp-symenumeratesymbols), [**Симфромнаме**](/windows/desktop/api/Dbghelp/nf-dbghelp-symfromname) заменяет [**SymGetSymFromName64**](/windows/desktop/api/Dbghelp/nf-dbghelp-symgetsymfromname), а [**симфромаддр**](/windows/desktop/api/Dbghelp/nf-dbghelp-symfromaddr) заменяет [**SymGetSymFromAddr64**](/windows/desktop/api/Dbghelp/nf-dbghelp-symgetsymfromaddr).

## <a name="public-symbols"></a>Открытые символы

Начальные версии DbgHelp.dll поддерживали проверку только открытых символов. Эти символы формируются для любого элемента в коде, который должен быть предоставлен между различными исходными файлами. Они также включают все элементы, экспортированные из модуля.

Символы либо внедряются в изображение, либо хранятся отдельно в файле. dbg или. pdb. Единственная Хранимая информация — это имя и адрес символа. Имена доступны в виде декорированных имен. Чтобы просмотреть недекорированные имена, вызовите функцию [**симсетоптионс**](/windows/desktop/api/Dbghelp/nf-dbghelp-symsetoptions) с помощью симопт \_ UNDNAME или используйте функцию [**ундекоратесимболнаме**](/windows/desktop/api/Dbghelp/nf-dbghelp-undecoratesymbolname) .

Обратите внимание, что API DbgHelp изначально не разрабатывался для поддержки нескольких экземпляров одного и того же символа в модуле. Это обусловлено тем, что открытые символы ограничены уникальными именами внутри модуля. Поэтому [**SymGetSymFromName64**](/windows/desktop/api/Dbghelp/nf-dbghelp-symgetsymfromname) возвращает только первый символ, который соответствует. Чтобы получить все символы, соответствующие, вызовите [**сименумсимболс**](/windows/desktop/api/Dbghelp/nf-dbghelp-symenumsymbols).

## <a name="global-and-local-symbols"></a>Глобальные и локальные символы

Новые версии DbgHelp.dll поддерживают глобальные и локальные символы при использовании PDB-файлов. Эти новые версии включают в себя статические функции, функции, ограниченные в исходном файле, параметрах функций и локальных переменных. Когда DbgHelp ищет символ, он проверяет глобальные и локальные таблицы символов перед проверкой таблицы общедоступных символов. Это связано с тем, что для этих типов символов доступно больше информации, чем для общедоступных символов.

Глобальные и локальные символы хранятся с недекорированными именами. Поэтому \_ флаг симопт UNDNAME не действует. Чтобы получить декорированные имена символов, необходимо использовать флаг " \_ только общие" симопт \_ . В результате DbgHelp будет искать только открытые символы.

Чтобы просмотреть локальные символы или параметры функции, вызовите функцию [**симсетконтекст**](/windows/desktop/api/Dbghelp/nf-dbghelp-symsetcontext) с элементом **инструктионоффсет** в структуре [**\_ \_ кадра стека Imagehlp**](/windows/desktop/api/DbgHelp/ns-dbghelp-imagehlp_stack_frame) , равным адресу любого символа функции. Последующие вызовы [**симфромнаме**](/windows/desktop/api/Dbghelp/nf-dbghelp-symfromname) и [**сименумсимболс**](/windows/desktop/api/Dbghelp/nf-dbghelp-symenumsymbols) могут действовать в контексте этого адреса. Для этого присвойте параметру *Басеофдлл* **значение NULL** и опустите спецификатор модуля из параметра *Name* или *Mask* . Это заставляет DbgHelp искать совпадающие символы в области, указанной параметром **симсетконтекст**.

Чтобы определить, является ли символ параметром, проверьте элемент **flags** в структуре [**\_ сведений о символах**](/windows/desktop/api/DbgHelp/ns-dbghelp-symbol_info) . Если символ является параметром, член содержит \_ параметр симфлаг. Если это локальный символ, член содержит СИМФЛАГ \_ Local.

 

 



