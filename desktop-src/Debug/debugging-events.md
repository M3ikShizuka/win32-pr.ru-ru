---
description: Событие отладки — это инцидент в отлаживаемом процессе, который заставляет систему уведомлять отладчик.
ms.assetid: 43ca51f1-ba73-4031-96c3-5815311ce6f6
title: События отладки
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e7d1f9f723e55b75b32d9f9e3cbf4baac0a8cc683dd3a5aa1b95a2931bceba29
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119642194"
---
# <a name="debugging-events"></a>События отладки

Событие отладки — это инцидент в отлаживаемом процессе, который заставляет систему уведомлять отладчик. События отладки включают создание процесса, создание потока, загрузку библиотеки динамической компоновки (DLL), выгрузку библиотеки DLL, отправку выходной строки и создание исключения.

Если событие отладки происходит, когда отладчик ожидает один из них, система заполняет структуру [**\_ событий отладки**](/windows/win32/api/minwinbase/ns-minwinbase-debug_event) , указанную параметром [**ваитфордебужевент**](/windows/win32/api/debugapi/nf-debugapi-waitfordebugevent) , на сведения, описывающие событие.

Когда система уведомляет отладчик о событии отладки, она также приостанавливает все потоки в затронутом процессе. Потоки не возобновляют выполнение, пока отладчик не продолжит событие отладки с помощью [**континуедебужевент**](/windows/win32/api/debugapi/nf-debugapi-continuedebugevent). При отладке процесса могут возникнуть следующие события отладки.



| Событие отладки                          | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| СОЗДАТЬ \_ \_ событие отладки \_ процесса<br/> | Создается каждый раз при создании нового процесса в отлаживаемом процессе или когда отладчик начинает отладку уже активного процесса. Система создает это событие отладки до начала выполнения процесса в пользовательском режиме и до того, как система создаст другие события отладки для нового процесса. <br/> Структура [**\_ событий Debug**](/windows/win32/api/minwinbase/ns-minwinbase-debug_event) содержит структуру [**\_ \_ отладочной \_ информации процесса создания**](/windows/win32/api/minwinbase/ns-minwinbase-create_process_debug_info) . Эта структура включает в себя маркер нового процесса, обработчик файла изображения процесса, обработчик исходного потока процесса и другие сведения, описывающие новый процесс.<br/> Обработчик процесса имеет \_ \_ доступ к виртуальной машине Read и Process для \_ \_ записи. Если отладчик имеет такие типы доступа к потоку, он может считывать и записывать данные в память процесса с помощью функций [**реадпроцессмемори**](/windows/win32/api/memoryapi/nf-memoryapi-readprocessmemory) и [**вритепроцессмемори**](/windows/win32/api/memoryapi/nf-memoryapi-writeprocessmemory) . Если система ранее сообщила о событии завершения \_ процесса \_ Debug \_ , система закрывает этот обработчик, когда отладчик вызывает функцию [**континуедебужевент**](/windows/win32/api/debugapi/nf-debugapi-continuedebugevent) .<br/> Обработчик файла образа процесса имеет универсальный \_ доступ для чтения и открыт для совместного использования с доступом на чтение. Отладчик должен закрыть этот обработчик при обработке \_ события создания процесса \_ отладки \_ .<br/> Обработчику исходного потока процесса назначен \_ \_ контекст Get, \_ контекст набора потоков \_ , а \_ приостановка потока — \_ возобновление доступа к потоку. Если отладчик имеет такие типы доступа к потоку, он может считывать и записывать в регистры потока с помощью функций [**GetThreadContext**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getthreadcontext) и [**SetThreadContext**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-setthreadcontext) и может приостанавливать и возобновлять поток с помощью функций [**суспендсреад**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-suspendthread) и [**ресумесреад**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-resumethread) . Если система ранее сообщила о событии завершения \_ процесса \_ Debug \_ , система закрывает этот обработчик, когда отладчик вызывает функцию [**континуедебужевент**](/windows/win32/api/debugapi/nf-debugapi-continuedebugevent) .<br/> |
| СОЗДАТЬ \_ \_ событие отладки \_ потока<br/>  | Создается всякий раз, когда создается новый поток в отлаживаемом процессе или когда отладчик начинает отладку уже активного процесса. Это событие отладки создается до начала выполнения нового потока в пользовательском режиме. <br/> Структура [**\_ событий Debug**](/windows/win32/api/minwinbase/ns-minwinbase-debug_event) содержит структуру [**\_ \_ отладочной \_ информации о создании потока**](/windows/win32/api/minwinbase/ns-minwinbase-create_thread_debug_info) . Эта структура включает в себя маркер нового потока и начальный адрес потока. Этот обработчик имеет \_ контекст получения \_ контекста, \_ контекста набора потоков \_ и \_ приостановки потока \_ возобновление доступа к потоку. Если отладчик имеет такие типы доступа к потоку, он может считывать и записывать в регистры потока с помощью функций [**GetThreadContext**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-getthreadcontext) и [**SetThreadContext**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-setthreadcontext) и может приостанавливать и возобновлять поток с помощью функций [**суспендсреад**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-suspendthread) и [**ресумесреад**](/windows/win32/api/processthreadsapi/nf-processthreadsapi-resumethread) .<br/> Если система ранее сообщила о событии \_ \_ события отладки потока выхода \_ , система закрывает обработчик в новом потоке, когда отладчик вызывает функцию [**континуедебужевент**](/windows/win32/api/debugapi/nf-debugapi-continuedebugevent) .<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| \_событие отладки \_ исключения<br/>       | Создается каждый раз при возникновении исключения в отлаживаемом процессе. К возможным исключениям относятся попытки доступа к недоступной памяти, выполнение инструкций точки останова, попытка деления на ноль или любое другое исключение, указанное в [структурированной обработке исключений](structured-exception-handling.md). <br/> Структура [**\_ событий Debug**](/windows/win32/api/minwinbase/ns-minwinbase-debug_event) содержит структуру [**\_ \_ сведений об отладке исключения**](/windows/win32/api/minwinbase/ns-minwinbase-exception_debug_info) . Эта структура описывает исключение, вызвавшее событие отладки.<br/> Помимо стандартных условий исключений, во время отладки процесса консоли может возникнуть дополнительный код исключения. Система создает \_ код исключения элемента управления dbg \_ , когда Ctrl + c является входным для процесса консоли, который ОБРАБАТЫВАЕТ сигналы Ctrl + c и отлаживается. Этот код исключения не предназначен для обработки приложениями. Приложение никогда не должно использовать обработчик исключений, чтобы справиться с ним. Он вызывается только для преимуществ отладчика и используется только при присоединении отладчика к процессу консоли.<br/> Если процесс не отлаживается или отладчик передает \_ \_ необработанное исключение элемента управления dbg (с помощью команды GN), выполняется поиск в списке функций обработчика приложения, как описано в статье о функции [**SetConsoleCtrlHandler**](/windows/console/setconsolectrlhandler) .<br/> Если отладчик обрабатывает \_ исключение элемента управления dbg \_ (с помощью команды GH), приложение не будет заметит CTRL + C, за исключением следующего кода.<br/> `while ((inputChar = getchar()) != EOF) ...`<br/> Поэтому отладчик не может быть использован для прекращения ожидания чтения в таком коде из процесса завершения.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                           |
| выход \_ из \_ обработки \_ события отладки<br/>   | Создается каждый раз при завершении отладки последнего потока в процессе. Это событие отладки происходит сразу после того, как система выгружает библиотеки DLL процесса и обновляет код завершения процесса. <br/> Структура [**\_ событий Debug**](/windows/win32/api/minwinbase/ns-minwinbase-debug_event) содержит структуру [**\_ \_ отладочной \_ информации о процессе выхода**](/windows/win32/api/minwinbase/ns-minwinbase-exit_process_debug_info) , которая указывает код выхода.<br/> Отладчик освобождает все внутренние структуры, связанные с процессом, при получении этого события отладки. Система закрывает обработчик отладчика для завершения процесса и всех потоков процесса. Отладчик не должен закрывать эти дескрипторы.<br/> Часть процесса завершения работы в режиме ядра не может быть завершена до тех пор, пока отладчик, получающий это событие, вызывает [**континуедебужевент**](/windows/win32/api/debugapi/nf-debugapi-continuedebugevent). До тех пор дескрипторы процессов открыты, а виртуальное адресное пространство не освобождается, поэтому отладчик может проверить дочерний процесс. Чтобы получать уведомления о завершении процесса завершения работы в режиме ядра, следует дублировать дескриптор, возвращенный с помощью \_ \_ события создания отладки процесса \_ , вызвать **континуедебужевент**, а затем дождаться сигнала повторяющегося дескриптора процесса.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| выйти \_ из \_ события отладки потока \_<br/>    | Создается всякий раз, когда происходит завершение работы потока, который является частью отлаживаемого процесса. Система создает это событие отладки сразу после обновления кода выхода потока. <br/> Структура [**\_ событий Debug**](/windows/win32/api/minwinbase/ns-minwinbase-debug_event) содержит структуру [**\_ \_ \_ сведений об отладке потока выхода**](/windows/win32/api/minwinbase/ns-minwinbase-exit_thread_debug_info) , которая указывает код выхода.<br/> Это событие отладки не происходит, если поток выхода является последним потоком процесса. В этом случае \_ \_ \_ происходит событие завершения отладки процесса отладки.<br/> Отладчик освобождает все внутренние структуры, связанные с потоком, при получении этого события отладки. Система закрывает обработчик отладчика в потоке выхода. Отладчик не должен закрывать этот обработчик.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| ЗАГРУЗИТЬ \_ \_ событие отладки библиотеки DLL \_<br/>       | Создается каждый раз, когда отлаживаемый процесс загружает библиотеку DLL. Это событие отладки происходит, когда системный загрузчик разрешает ссылки на библиотеку DLL или когда отлаживаемый процесс использует функцию [**LoadLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) . Это событие отладки происходит только в первый раз, когда система прикрепляет библиотеку DLL к виртуальному адресному пространству процесса. <br/> Структура [**\_ событий Debug**](/windows/win32/api/minwinbase/ns-minwinbase-debug_event) содержит структуру [**\_ \_ отладочной \_ информации о загрузке DLL**](/windows/win32/api/minwinbase/ns-minwinbase-load_dll_debug_info) . Эта структура включает в себя обработчик для вновь загруженной библиотеки DLL, базовый адрес библиотеки DLL и другие сведения, описывающие библиотеку DLL. Отладчик должен закрыть обработчик для обработчика DLL при обработке \_ \_ события отладки Load DLL \_ .<br/> Как правило, отладчик загружает таблицу символов, связанную с библиотекой DLL, при получении этого события отладки.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| ВЫХОДное \_ \_ событие строки отладки \_<br/>  | Создается, когда отлаживаемый процесс использует <br/>Функция [**OutputDebugString**](/windows/win32/api/debugapi/nf-debugapi-outputdebugstringa) . Структура [**\_ событий Debug**](/windows/win32/api/minwinbase/ns-minwinbase-debug_event) содержит [**выходную структуру \_ отладочной \_ строки \_**](/windows/win32/api/minwinbase/ns-minwinbase-output_debug_string_info) . Эта структура задает адрес, длину и формат строки отладки.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| событие "выгрузка \_ отладки DLL" \_ \_<br/>     | Создается каждый раз, когда отлаживаемый процесс выгружает библиотеку DLL с помощью функции [**FreeLibrary**](/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary) . Это событие отладки происходит только в момент последней выгрузки библиотеки DLL из адресного пространства процесса (то есть когда счетчик использования библиотеки DLL равен нулю). <br/> Структура [**\_ событий Debug**](/windows/win32/api/minwinbase/ns-minwinbase-debug_event) содержит структуру [**\_ \_ отладочной \_ информации о выгрузке DLL**](/windows/win32/api/minwinbase/ns-minwinbase-unload_dll_debug_info) . Эта структура задает базовый адрес библиотеки DLL в адресном пространстве процесса, который выгружает библиотеку DLL.<br/> Как правило, отладчик выгружает таблицу символов, связанную с библиотекой DLL, при получении этого события отладки.<br/> Когда процесс завершается, система автоматически выгружает DLL-файлы процесса, но не создает \_ \_ событие Отладка отладочного события отладки DLL \_ .<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| \_событие копирования<br/>                    | Создается каждый раз, когда отлаживаемый процесс выходит за пределы элемента управления отладчика системы.<br/> Структура [**\_ событий Debug**](/windows/win32/api/minwinbase/ns-minwinbase-debug_event) содержит структуру [**\_ сведений RIP**](/windows/win32/api/minwinbase/ns-minwinbase-rip_info) . Эта структура указывает ошибку и тип ошибки.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |



 

 

 
