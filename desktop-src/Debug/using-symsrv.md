---
description: Использование SymSrv
ms.assetid: d400f222-c50c-4c7b-8f8a-0c3ed3bba3b9
title: Использование SymSrv
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5bbaf68e80555629db8bc9a2a21394b95fe6fb85
ms.sourcegitcommit: f848119a8faa29b27585f4df53f6e50ee9666684
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/27/2021
ms.locfileid: "110550039"
---
# <a name="using-symsrv"></a><span data-ttu-id="e93e5-103">Использование SymSrv</span><span class="sxs-lookup"><span data-stu-id="e93e5-103">Using SymSrv</span></span>

<span data-ttu-id="e93e5-104">SymSrv предоставляет файлы символов из централизованных хранилищ символов.</span><span class="sxs-lookup"><span data-stu-id="e93e5-104">SymSrv delivers symbol files from centralized symbol stores.</span></span> <span data-ttu-id="e93e5-105">Эти магазины могут содержать любое количество файлов символов, соответствующих любому числу программ или операционных систем.</span><span class="sxs-lookup"><span data-stu-id="e93e5-105">These stores can contain any number of symbol files, corresponding to any number of programs or operating systems.</span></span> <span data-ttu-id="e93e5-106">Магазины также могут содержать двоичные файлы, которые особенно полезны при отладке файлов минидампа.</span><span class="sxs-lookup"><span data-stu-id="e93e5-106">The stores can also contain binary files, which are particularly useful when debugging minidump files.</span></span>

<span data-ttu-id="e93e5-107">Магазины могут содержать фактические и двоичные файлы символов или просто указатели на файлы символов.</span><span class="sxs-lookup"><span data-stu-id="e93e5-107">The stores can contain the actual symbol and binary files or simply pointers to symbol files.</span></span> <span data-ttu-id="e93e5-108">Если хранилище содержит указатели, SymSrv будет получать фактические файлы непосредственно из их источников.</span><span class="sxs-lookup"><span data-stu-id="e93e5-108">If the store contains pointers, SymSrv will retrieve the actual files directly from their sources.</span></span>

<span data-ttu-id="e93e5-109">SymSrv также может разделять большое хранилище символов на меньшее подмножество, которое подходит для специализированной задачи отладки.</span><span class="sxs-lookup"><span data-stu-id="e93e5-109">SymSrv can also separate a large symbol store into a smaller subset that is appropriate for a specialized debugging task.</span></span>

<span data-ttu-id="e93e5-110">Наконец, SymSrv может получать файлы символов из источника HTTP или HTTPS, используя сведения о входе в систему, предоставляемые операционной системой.</span><span class="sxs-lookup"><span data-stu-id="e93e5-110">Finally, SymSrv can obtain symbol files from an HTTP or HTTPS source using the logon information provided by the operating system.</span></span> <span data-ttu-id="e93e5-111">SymSrv поддерживает HTTPS-сайты, защищенные SmartCards, сертификатами и обычными именами входа и паролями.</span><span class="sxs-lookup"><span data-stu-id="e93e5-111">SymSrv supports HTTPS sites protected by smartcards, certificates, and regular logins and passwords.</span></span>

## <a name="setting-the-symbol-path"></a><span data-ttu-id="e93e5-112">Задание пути к символам</span><span class="sxs-lookup"><span data-stu-id="e93e5-112">Setting the Symbol Path</span></span>

<span data-ttu-id="e93e5-113">Как описано в разделе [пути к символам](symbol-paths.md), путь к символам ( \_ \_ \_ переменная среды пути к символам NT) может состоять из нескольких элементов пути, разделенных точкой с запятой.</span><span class="sxs-lookup"><span data-stu-id="e93e5-113">As described in [Symbol Paths](symbol-paths.md), the symbol path (\_NT\_SYMBOL\_PATH environment variable) can be made up of several path elements separated by semicolons.</span></span> <span data-ttu-id="e93e5-114">Если один или несколько из этих элементов пути начинаются с текста "SRV \* ", то элемент является сервером символов и будет использовать SymSrv для поиска файлов символов.</span><span class="sxs-lookup"><span data-stu-id="e93e5-114">If any one or more of these path elements begins with the text "srv\*", then the element is a symbol server and will use SymSrv to locate symbol files.</span></span>

> [!Note]  
> <span data-ttu-id="e93e5-115">Если текст "SRV \* " не указан, но фактический элемент пути является хранилищем сервера символов, обработчик символов будет действовать так, как если \* бы был указан "SRV".</span><span class="sxs-lookup"><span data-stu-id="e93e5-115">If the "srv\*" text is not specified but the actual path element is a symbol server store, then the symbol handler will act as if "srv\*" were specified.</span></span> <span data-ttu-id="e93e5-116">Обработчик символов выполняет это определение, выполняя поиск файла с именем "pingme.txt" в корневом каталоге указанного пути.</span><span class="sxs-lookup"><span data-stu-id="e93e5-116">The symbol handler makes this determination by searching for the existence of a file called "pingme.txt" in the root directory of the specified path.</span></span>

 

<span data-ttu-id="e93e5-117">Так же, как пути к символам состоят из элементов пути к символам, разделенных точкой с запятой, серверы символов состоят из элементов хранилища символов, разделенных звездочками.</span><span class="sxs-lookup"><span data-stu-id="e93e5-117">Just as symbol paths are made up of symbol path elements separated by semicolons, symbol servers are made up of symbol store elements separated by asterisks.</span></span> <span data-ttu-id="e93e5-118">После префикса "SRV" может содержаться до 10 хранилищ символов \* .</span><span class="sxs-lookup"><span data-stu-id="e93e5-118">There can be up to 10 symbol stores after the "srv\*" prefix.</span></span> <span data-ttu-id="e93e5-119">Магазины, перечисленные слева от списка, называются *нисходящими* хранилищами, а магазины справа называются *вышестоящими* хранилищами.</span><span class="sxs-lookup"><span data-stu-id="e93e5-119">Stores listed to the left of the list are called *downstream* stores and stores to the right are called *upstream* stores.</span></span>

<dl> <span data-ttu-id="e93e5-120">SRV \* *SymbolStore*</span><span class="sxs-lookup"><span data-stu-id="e93e5-120">srv\**SymbolStore*</span></span>  
<span data-ttu-id="e93e5-121">SRV \* *SymbolStore1* \* *симболсторен*  
</span><span class="sxs-lookup"><span data-stu-id="e93e5-121">srv\**SymbolStore1*\**SymbolStoreN*  
</span></span></dl>

<span data-ttu-id="e93e5-122">Если в путь включено только один элемент хранилища символов, SymSrv будет пытаться использовать любой запрошенный файл непосредственно из этого хранилища.</span><span class="sxs-lookup"><span data-stu-id="e93e5-122">If only one symbol store element is included in the path, then SymSrv will attempt to use the any requested file directly from that store.</span></span>

<span data-ttu-id="e93e5-123">Если в пути есть два хранилища символов, SymSrv ищет файл символов в крайнем левом хранилище символов.</span><span class="sxs-lookup"><span data-stu-id="e93e5-123">If there are two symbol stores in the path, SymSrv looks for the symbol file in the leftmost symbol store.</span></span> <span data-ttu-id="e93e5-124">Если файл существует, он используется.</span><span class="sxs-lookup"><span data-stu-id="e93e5-124">If the file is there, it is used.</span></span> <span data-ttu-id="e93e5-125">Если это не так, SymSrv просматривает хранилище символов непосредственно справа.</span><span class="sxs-lookup"><span data-stu-id="e93e5-125">If it is not there, SymSrv looks in the symbol store immediately to the right.</span></span> <span data-ttu-id="e93e5-126">Если файл находится там, он копируется в левое хранилище и открывается из него.</span><span class="sxs-lookup"><span data-stu-id="e93e5-126">If the file is there, it is copied to the left store and opened from there.</span></span>

<span data-ttu-id="e93e5-127">Если существует более двух магазинов, это поведение будет продолжаться до тех пор, пока файл не будет найден или в списке больше нет хранилищ.</span><span class="sxs-lookup"><span data-stu-id="e93e5-127">If there are more than two stores, this behavior continues to the right until the file is found or there are no more stores in the list.</span></span>

<span data-ttu-id="e93e5-128">Файл никогда не открывается ни из одного хранилища, но из самого левого хранилища.</span><span class="sxs-lookup"><span data-stu-id="e93e5-128">The file is never opened from any store but the leftmost store.</span></span> <span data-ttu-id="e93e5-129">Если файл находится в другом месте в цепочке, он копируется в каждое хранилище слева от него.</span><span class="sxs-lookup"><span data-stu-id="e93e5-129">If the file is found anywhere else in the chain, it is copied to every store to the left of it.</span></span> <span data-ttu-id="e93e5-130">Этот процесс копирования называется "каскадным" и предоставляет определенные преимущества, которые будут кларфиед позже в этом документе.</span><span class="sxs-lookup"><span data-stu-id="e93e5-130">This copy process is called "cascading" and provides certain benefits that will clarfied later in this document.</span></span>

## <a name="types-of-symbol-stores"></a><span data-ttu-id="e93e5-131">Типы хранилищ символов</span><span class="sxs-lookup"><span data-stu-id="e93e5-131">Types of Symbol Stores</span></span>

<span data-ttu-id="e93e5-132">В следующей таблице показаны примеры поддерживаемых типов хранилищ символов.</span><span class="sxs-lookup"><span data-stu-id="e93e5-132">The following table displays examples of the supported symbol store types.</span></span>

|  <span data-ttu-id="e93e5-133">Тип хранилища символов</span><span class="sxs-lookup"><span data-stu-id="e93e5-133">Symbol store type</span></span>       |  <span data-ttu-id="e93e5-134">Описание</span><span class="sxs-lookup"><span data-stu-id="e93e5-134">Description</span></span> |
|----------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="e93e5-135">\\\\\\Общая папка сервера</span><span class="sxs-lookup"><span data-stu-id="e93e5-135">\\\\server\\share</span></span>          | <span data-ttu-id="e93e5-136">Полный UNC-путь к общей папке на удаленном сервере.</span><span class="sxs-lookup"><span data-stu-id="e93e5-136">A fully qualified UNC path to a share on a remote server.</span></span>                                                                                                                                                                                                                                                                                                 |
| <span data-ttu-id="e93e5-137">c: \\ локалкаче</span><span class="sxs-lookup"><span data-stu-id="e93e5-137">c:\\LocalCache</span></span>             | <span data-ttu-id="e93e5-138">Путь к каталогу на клиентском компьютере.</span><span class="sxs-lookup"><span data-stu-id="e93e5-138">A path to a directory on the client computer.</span></span>                                                                                                                                                                                                                                                                                                             |
| https://InternetSite        | <span data-ttu-id="e93e5-139">URL веб-сайта, на котором размещены символы.</span><span class="sxs-lookup"><span data-stu-id="e93e5-139">The URL to a web site hosting the symbols.</span></span> <span data-ttu-id="e93e5-140">Должно быть крайним правым магазином в списке и не должно быть единственным хранилищем в списке.</span><span class="sxs-lookup"><span data-stu-id="e93e5-140">Must be the rightmost store in the list and should not be the only store in the list.</span></span>                                                                                                                                                                                                                          |
| https://SecureInternetSite | <span data-ttu-id="e93e5-141">URL-адрес защищенного веб-сайта, на котором размещены символы.</span><span class="sxs-lookup"><span data-stu-id="e93e5-141">The URL to a secure web site hosting the symbols.</span></span> <span data-ttu-id="e93e5-142">Это может поддерживать пароли, учетные данные входа в Windows, сертификаты и SmartCards.</span><span class="sxs-lookup"><span data-stu-id="e93e5-142">This can support passwords, Windows login credentials, certificates, and smartcards.</span></span> <span data-ttu-id="e93e5-143">Должно быть крайним правым магазином в списке и не должно быть единственным хранилищем в списке.</span><span class="sxs-lookup"><span data-stu-id="e93e5-143">Must be the rightmost store in the list and should not be the only store in the list.</span></span>                                                                                                                              |
| <blank>              | <span data-ttu-id="e93e5-144">Если между двумя звездочками нет текста, это означает, что *по умолчанию используется нисходящий магазин*.</span><span class="sxs-lookup"><span data-stu-id="e93e5-144">If there is no text between two asterisks, this indicates the *default downstream store*.</span></span> <span data-ttu-id="e93e5-145">Расположение задается путем вызова [**симсесомедиректори**](/windows/desktop/api/Dbghelp/nf-dbghelp-symsethomedirectory).</span><span class="sxs-lookup"><span data-stu-id="e93e5-145">The location is set by calling [**SymSetHomeDirectory**](/windows/desktop/api/Dbghelp/nf-dbghelp-symsethomedirectory).</span></span> <span data-ttu-id="e93e5-146">Значение по умолчанию — каталог с именем «sym» непосредственно под каталогом программы вызывающего приложения.</span><span class="sxs-lookup"><span data-stu-id="e93e5-146">The default value is a directory named "sym" immediately below the program directory of the calling application.</span></span> <span data-ttu-id="e93e5-147">Иногда это называется *локальным кэшем по умолчанию*.</span><span class="sxs-lookup"><span data-stu-id="e93e5-147">This is sometimes referred to as the *default local cache*.</span></span> |



 

<span data-ttu-id="e93e5-148">Так как хранилище символов на основе HTTP не может быть записано в, оно должно быть крайним правым магазином в списке.</span><span class="sxs-lookup"><span data-stu-id="e93e5-148">Because an HTTP-based symbol store cannot be written to, it must be the rightmost store in the list.</span></span> <span data-ttu-id="e93e5-149">Если хранилище символов на основе HTTP было расположено в середине или слева от списка магазинов, в него невозможно скопировать найденные файлы, и цепочка будет разорвана.</span><span class="sxs-lookup"><span data-stu-id="e93e5-149">If an HTTP-based symbol store was located in the middle or the left of the store list, it would not be possible to copy any found files to it and the chain would be broken.</span></span> <span data-ttu-id="e93e5-150">Более того, поскольку обработчик символов не может открыть файл с веб-сайта, хранилище на основе HTTP не должно быть самым левым или храниться только в списке.</span><span class="sxs-lookup"><span data-stu-id="e93e5-150">Furthermore, because the symbol handler cannot open a file from a web site, an HTTP-based store should not be the leftmost or only store on the list.</span></span> <span data-ttu-id="e93e5-151">Если при использовании этого пути к символам отображается SymSrv, будет предпринята попытка восстановить его путем копирования файла в нисходящий банк по умолчанию и открывать его из него независимо от того, указано ли в пути к символам значение по умолчанию подчиненного хранилища.</span><span class="sxs-lookup"><span data-stu-id="e93e5-151">If SymSrv is ever presented with this symbol path, it will attempt to recover by copying the file to the default downstream store and open it from there, regardless of whether the default downstream store is indicated in the symbol path or not.</span></span>

## <a name="examples"></a><span data-ttu-id="e93e5-152">Примеры</span><span class="sxs-lookup"><span data-stu-id="e93e5-152">Examples</span></span>

<span data-ttu-id="e93e5-153">Чтобы использовать SymSrv с хранилищем символов в \\ \\ мибуилдс \\ мисимболс, задайте следующий путь к символам:</span><span class="sxs-lookup"><span data-stu-id="e93e5-153">To use SymSrv with a symbol store on \\\\mybuilds\\mysymbols, set the following symbol path:</span></span>

<span data-ttu-id="e93e5-154">**Задайте \_ \_ путь к символам NT \_ = SRV \* \\ \\ мибуилдс \\ мисимболс**</span><span class="sxs-lookup"><span data-stu-id="e93e5-154">**set \_NT\_SYMBOL\_PATH= srv\*\\\\mybuilds\\mysymbols**</span></span>

<span data-ttu-id="e93e5-155">Чтобы задать путь к символам, чтобы отладчик скопирует файлы символов из хранилища символов в \\ \\ мибуилдс \\ мисимболс в локальный каталог c: \\ локалсимболс, используйте:</span><span class="sxs-lookup"><span data-stu-id="e93e5-155">To set the symbol path so that the debugger will copy symbol files from a symbol store on \\\\mybuilds\\mysymbols to your local directory c:\\localsymbols, use:</span></span>

<span data-ttu-id="e93e5-156">**Задайте \_ \_ путь к символам NT \_ = SRV \* c: \\ локалсимболс \* \\ \\ мибуилдс \\ мисимболс**</span><span class="sxs-lookup"><span data-stu-id="e93e5-156">**set \_NT\_SYMBOL\_PATH=srv\*c:\\localsymbols\*\\\\mybuilds\\mysymbols**</span></span>

<span data-ttu-id="e93e5-157">Чтобы задать путь к символам, чтобы отладчик скопировал файлы символов из хранилища символов в \\ \\ мибуилдс \\ мисимболс в подчиненное хранилище по умолчанию (обычно c: \\ Debuggers \\ SYM), используйте следующую команду:</span><span class="sxs-lookup"><span data-stu-id="e93e5-157">To set the symbol path so that the debugger will copy symbol files from a symbol store on \\\\mybuilds\\mysymbols to the default downstream store (typically c:\\debuggers\\sym), use:</span></span>

<span data-ttu-id="e93e5-158">**Задайте \_ \_ путь к символам NT \_ = SRV \* \* \\ \\ мибуилдс \\ мисимболс**</span><span class="sxs-lookup"><span data-stu-id="e93e5-158">**set \_NT\_SYMBOL\_PATH=srv\*\*\\\\mybuilds\\mysymbols**</span></span>

<span data-ttu-id="e93e5-159">Чтобы использовать каскадное хранилище, задайте следующий путь к символам:</span><span class="sxs-lookup"><span data-stu-id="e93e5-159">To use a cascading store, set the following symbol path:</span></span>

<span data-ttu-id="e93e5-160">**задать \_ \_ путь к символам NT \_ = SRV \* c: \\ локалсимболс \* \\ \\ неарбисервер \\ Store\*https://DistantServer**</span><span class="sxs-lookup"><span data-stu-id="e93e5-160">**set \_NT\_SYMBOL\_PATH = srv\*c:\\localsymbols\*\\\\NearbyServer\\store\*https://DistantServer**</span></span>

<span data-ttu-id="e93e5-161">В этом примере SymSrv сначала ищет файл в c: \\ локалсимболс.</span><span class="sxs-lookup"><span data-stu-id="e93e5-161">In this example, SymSrv first looks for the file in c:\\localsymbols.</span></span> <span data-ttu-id="e93e5-162">Если он найден, он вернет путь к файлу.</span><span class="sxs-lookup"><span data-stu-id="e93e5-162">If it is found there, it will return a path to the file.</span></span> <span data-ttu-id="e93e5-163">В противном случае SymSrv ищет файл в \\ \\ неарбисервер \\ Store.</span><span class="sxs-lookup"><span data-stu-id="e93e5-163">Otherwise, SymSrv looks for the file in \\\\NearbyServer\\store.</span></span> <span data-ttu-id="e93e5-164">Если он найден, SymSrv копирует файл в c: \\ локалсимболс и возвращает путь к файлу; если он не найден, SymSrv ищет файл в https://DistantServer и, если он найден, SymSrv копирует файл в \\ \\ неарбисервер \\ Store, а затем в c: \\ локалсимболс.</span><span class="sxs-lookup"><span data-stu-id="e93e5-164">If it is found there, SymSrv copies the file to c:\\localsymbols and returns a path to the file; if it is not found, SymSrv looks for the file in https://DistantServer, and if it is found there, SymSrv copies the file to \\\\NearbyServer\\store, then to c:\\localsymbols.</span></span>

<span data-ttu-id="e93e5-165">В последнем примере показано, насколько разумным дизайном пути к символам можно воспользоваться для оптимизации загрузки символов.</span><span class="sxs-lookup"><span data-stu-id="e93e5-165">This last example shows how judicious design of a symbol path can be used to optimize the downloading of symbols.</span></span> <span data-ttu-id="e93e5-166">Если у вас есть рабочий сайт с группой отладчиков и все они должны получить символы из удаленных расположений, можно настроить общий сервер с хранилищем символов рядом со всеми отладчиками.</span><span class="sxs-lookup"><span data-stu-id="e93e5-166">If you have a work site with a group of debuggers and they all need to get symbols from a distant location, you can set up a common server with a symbol store near all the debuggers.</span></span> <span data-ttu-id="e93e5-167">Затем настройте каждый отладчик с помощью пути к символам выше.</span><span class="sxs-lookup"><span data-stu-id="e93e5-167">Then setup every debugger with the symbol path above.</span></span> <span data-ttu-id="e93e5-168">Первый отладчик, требующий определенную версию файла foo. pdb, загрузит его из https://DistantServer в \\ \\ неарбисервер \\ Store, а затем на свой собственный компьютер в c: \\ локалсимболс.</span><span class="sxs-lookup"><span data-stu-id="e93e5-168">The first debugger that requires a certain version of foo.pdb will download it from https://DistantServer to \\\\NearbyServer\\store and then to its own machine in c:\\localsymbols.</span></span> <span data-ttu-id="e93e5-169">Следующий отладчик, которому требуется один и тот же файл, сможет скачать его из \\ \\ хранилища неарбисервер, \\ так как он уже загружен в это расположение с помощью предыдущего отладчика.</span><span class="sxs-lookup"><span data-stu-id="e93e5-169">The next debugger that requires the same file will be able to download it from \\\\NearbyServer\\store because it was already downloaded to that location by the previous debugger.</span></span> <span data-ttu-id="e93e5-170">Это многоуровневое кэширование экономит значительное время и пропускную способность сети.</span><span class="sxs-lookup"><span data-stu-id="e93e5-170">This multi-level caching saves significant time and network bandwidth.</span></span>

## <a name="microsoft-symbol-store"></a><span data-ttu-id="e93e5-171">Хранилище символов Майкрософт</span><span class="sxs-lookup"><span data-stu-id="e93e5-171">Microsoft Symbol Store</span></span>

<span data-ttu-id="e93e5-172">Корпорация Майкрософт предоставляет доступ к серверу символов Интернета, содержащему файлы символов для многих версий операционной системы Windows.</span><span class="sxs-lookup"><span data-stu-id="e93e5-172">Microsoft provides access to an Internet symbol server that contains symbol files for the many versions of the Windows operating system.</span></span> <span data-ttu-id="e93e5-173">Этот каталог символов не обязательно должен быть полным, но он является обширным.</span><span class="sxs-lookup"><span data-stu-id="e93e5-173">This catalog of symbols is not guaranteed to be complete, but it is extensive.</span></span> <span data-ttu-id="e93e5-174">Также представлены другие продукты Майкрософт.</span><span class="sxs-lookup"><span data-stu-id="e93e5-174">Other Microsoft products are also represented.</span></span>

<span data-ttu-id="e93e5-175">Сервер символов Интернета заполняется различными символами Windows для операционных систем Microsoft Windows, включая исправления, пакеты обновления, пакеты исправлений безопасности и розничные выпуски.</span><span class="sxs-lookup"><span data-stu-id="e93e5-175">The Internet symbol server is populated with a variety of Windows symbols for Microsoft Windows operating systems, including hot fixes, Service Packs, Security Rollup Packages, and retail releases.</span></span> <span data-ttu-id="e93e5-176">Кроме того, на сервере доступны символы для текущих бета-версий и кандидатов на выпуски продуктов Windows, а также множество других продуктов Майкрософт, таких как Microsoft Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="e93e5-176">Symbols are also available on the server for current Betas and Release Candidates for Windows products, plus a variety of other Microsoft products, such as Microsoft Internet Explorer.</span></span>

<span data-ttu-id="e93e5-177">При наличии доступа к Интернету во время отладки можно настроить отладчик для загрузки символов по мере необходимости во время сеанса отладки, вместо того чтобы загружать файлы символов отдельно перед сеансом отладки.</span><span class="sxs-lookup"><span data-stu-id="e93e5-177">If you have access to the Internet during debugging, you can configure the debugger to download symbols as needed during a debugging session, rather than downloading symbol files separately before a debugging session.</span></span> <span data-ttu-id="e93e5-178">Символы загружаются в указанное расположение каталога, а затем отладчик загружает их из него.</span><span class="sxs-lookup"><span data-stu-id="e93e5-178">The symbols are downloaded to a directory location that you specify and then the debugger loads them from there.</span></span>

<span data-ttu-id="e93e5-179">URL-адрес для хранилища символов Майкрософт — https://msdl.microsoft.com/download/symbols .</span><span class="sxs-lookup"><span data-stu-id="e93e5-179">The URL for the Microsoft symbol store is https://msdl.microsoft.com/download/symbols.</span></span> <span data-ttu-id="e93e5-180">В следующем примере показано, как задать путь к символам отладчика (Замените путь подчиненного хранилища для *c: \\ довнстреамсторе*):</span><span class="sxs-lookup"><span data-stu-id="e93e5-180">The following example shows how to set the debugger symbol path (substitute your downstream store path for *c:\\DownstreamStore*):</span></span>

``` syntax
srv*c:\DownstreamStore*https://msdl.microsoft.com/download/symbols
```

## <a name="compressed-files"></a><span data-ttu-id="e93e5-181">Сжатые файлы</span><span class="sxs-lookup"><span data-stu-id="e93e5-181">Compressed Files</span></span>

<span data-ttu-id="e93e5-182">SymSrv совместим с хранилищами символов, которые содержат сжатые файлы, при условии, что это сжатие предустановлено с помощью средства compress.exe, которое было распространено с помощью пакета Windows Server 2003 Resource Kit.</span><span class="sxs-lookup"><span data-stu-id="e93e5-182">SymSrv is compatible with symbol stores that contain compressed files, as long as this compression has been preformed with the compress.exe tool that was distributed with the Windows Server 2003 Resource Kit.</span></span> <span data-ttu-id="e93e5-183">Сжатые файлы должны содержать символ подчеркивания в качестве последнего символа в расширениях файлов (например, Module1. PD \_ или Module2. DB \_ ).</span><span class="sxs-lookup"><span data-stu-id="e93e5-183">Compressed files should have an underscore as the last character in their file extensions (for example, module1.pd\_ or module2.db\_).</span></span> <span data-ttu-id="e93e5-184">Дополнительные сведения см. [в разделе Использование SymStore](using-symstore.md).</span><span class="sxs-lookup"><span data-stu-id="e93e5-184">For details, see [Using SymStore](using-symstore.md).</span></span>

<span data-ttu-id="e93e5-185">При каскадном изменении файлы не сжимаются, если целевое хранилище не является крайним левым хранилищем в пути.</span><span class="sxs-lookup"><span data-stu-id="e93e5-185">When cascading, files are not uncompressed unless the target store is the leftmost store in the path.</span></span> <span data-ttu-id="e93e5-186">Если в пути содержится только одно хранилище и он содержит сжатый файл, SymSrv скопирует файл в подчиненное хранилище по умолчанию и откроет его из него, даже если в пути к символам не указано подчиненное хранилище по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="e93e5-186">If there is only one store in the path and it contains a compressed file, SymSrv will copy the file to the default downstream store and open it from there, even though the default downstream store is not indicated in they symbol path.</span></span>

<span data-ttu-id="e93e5-187">**DbgHelp 6,1 и более ранних версий:** Если файлы в главном хранилище сжимаются, необходимо использовать подчиненное хранилище.</span><span class="sxs-lookup"><span data-stu-id="e93e5-187">**DbgHelp 6.1 and earlier.:** If the files in the master store are compressed, you must use a downstream store.</span></span> <span data-ttu-id="e93e5-188">SymSrv будет распаковать все файлы перед копированием их в подчиненное хранилище.</span><span class="sxs-lookup"><span data-stu-id="e93e5-188">SymSrv will uncompress all files before copying them to the downstream store.</span></span>

## <a name="deleting-the-cache"></a><span data-ttu-id="e93e5-189">Удаление кэша</span><span class="sxs-lookup"><span data-stu-id="e93e5-189">Deleting the Cache</span></span>

<span data-ttu-id="e93e5-190">Если в качестве кэша используется подчиненное хранилище, можно в любое время удалить этот каталог, чтобы сэкономить место на диске.</span><span class="sxs-lookup"><span data-stu-id="e93e5-190">If you are using a downstream store as a cache, you can delete this directory at any time to save disk space.</span></span>

<span data-ttu-id="e93e5-191">Возможно наличие огромного хранилища символов, включающего файлы символов для множества различных программ или версий Windows.</span><span class="sxs-lookup"><span data-stu-id="e93e5-191">It is possible to have a vast symbol store that includes symbol files for many different programs or Windows versions.</span></span> <span data-ttu-id="e93e5-192">При обновлении версии Windows, используемой на целевом компьютере, все кэшированные файлы символов будут соответствовать предыдущей версии.</span><span class="sxs-lookup"><span data-stu-id="e93e5-192">If you upgrade the version of Windows used on your target computer, the cached symbol files will all match the earlier version.</span></span> <span data-ttu-id="e93e5-193">Эти кэшированные файлы не будут использоваться в дальнейшем, поэтому это может быть хорошим временем для удаления кэша.</span><span class="sxs-lookup"><span data-stu-id="e93e5-193">These cached files will not be of any further use, and therefore this might be a good time to delete the cache.</span></span>

<span data-ttu-id="e93e5-194">Средства отладки для Windows поставляются с помощью служебной программы, именуемой agestore.exe, которая выборочно удаляет файлы из дерева каталогов, освобождая последние использованные файлы.</span><span class="sxs-lookup"><span data-stu-id="e93e5-194">Debugging Tools for Windows comes with a utility called agestore.exe that will selectively remove files from a directory tree, leaving the most recently used files.</span></span> <span data-ttu-id="e93e5-195">Это средство предназначено для удаления неиспользуемых файлов из хранилищ сервера символов.</span><span class="sxs-lookup"><span data-stu-id="e93e5-195">This tool is designed for pruning out unused files from symbol server stores.</span></span> <span data-ttu-id="e93e5-196">Он позволяет управлять множеством параметров, включая алгоритмы уменьшения и размера каталога.</span><span class="sxs-lookup"><span data-stu-id="e93e5-196">It allows you to control many options including cut off date and directory size algorithms.</span></span>

## <a name="flat-cache-directory"></a><span data-ttu-id="e93e5-197">Каталог плоского кэша</span><span class="sxs-lookup"><span data-stu-id="e93e5-197">Flat Cache Directory</span></span>

<span data-ttu-id="e93e5-198">Можно объявить подчиненное хранилище по умолчанию в виде неструктурированного каталога, а не стандартной древовидной структуры символов.</span><span class="sxs-lookup"><span data-stu-id="e93e5-198">It is possible to declare the default downstream store as a flat directory, rather than a standard symbol tree structure.</span></span> <span data-ttu-id="e93e5-199">Для этого вызовите функцию [**симсетоптионс**](/windows/desktop/api/Dbghelp/nf-dbghelp-symsetoptions) с **\_ неструктурированным \_ каталогом симопт** (это также задает параметр **ссрвопт \_ плоского \_ \_ хранилища по умолчанию** в SymSrv).</span><span class="sxs-lookup"><span data-stu-id="e93e5-199">To do so, call the [**SymSetOptions**](/windows/desktop/api/Dbghelp/nf-dbghelp-symsetoptions) function with **SYMOPT\_FLAT\_DIRECTORY** (this also sets the **SSRVOPT\_FLAT\_DEFAULT\_STORE** option in SymSrv).</span></span> <span data-ttu-id="e93e5-200">Не забудьте вызвать [**симсесомедиректори**](/windows/desktop/api/Dbghelp/nf-dbghelp-symsethomedirectory) перед этим. в противном случае файлы символов можно записать в каталог программы.</span><span class="sxs-lookup"><span data-stu-id="e93e5-200">Be sure to call [**SymSetHomeDirectory**](/windows/desktop/api/Dbghelp/nf-dbghelp-symsethomedirectory) before doing so; otherwise, the symbol files can be written to the program directory.</span></span>

## <a name="pointer-files"></a><span data-ttu-id="e93e5-201">Файлы указателей</span><span class="sxs-lookup"><span data-stu-id="e93e5-201">Pointer Files</span></span>

<span data-ttu-id="e93e5-202">SymStore может создавать и использовать файлы, указывающие на целевой файл, а не на сам целевой файл.</span><span class="sxs-lookup"><span data-stu-id="e93e5-202">SymStore can create and use files that point to a target file rather than the target file itself.</span></span> <span data-ttu-id="e93e5-203">Если хранилище символов содержит такой файл указателя, по умолчанию файл копируется из расположения, указанного в файле указателя, в хранилище.</span><span class="sxs-lookup"><span data-stu-id="e93e5-203">If a symbol store contains such a pointer file, the default is to copy the file from the location indicated in the pointer file to the store.</span></span> <span data-ttu-id="e93e5-204">Чтобы настроить хранилище таким путем, чтобы файл указателя копировался вместо файла, на который он указывает, создайте файл с именем wantsptr.txt в корневом каталоге целевого хранилища.</span><span class="sxs-lookup"><span data-stu-id="e93e5-204">To configure a store such that the pointer file is copied instead of the file it points to, create a file named wantsptr.txt in the root of the target store.</span></span> <span data-ttu-id="e93e5-205">Содержимое wantsptr.txt не имеет значения, а только наличие файла.</span><span class="sxs-lookup"><span data-stu-id="e93e5-205">The contents of wantsptr.txt are not important, only the presence of the file.</span></span>

## <a name="excluding-files-from-symbols-list"></a><span data-ttu-id="e93e5-206">Исключение файлов из списка символов</span><span class="sxs-lookup"><span data-stu-id="e93e5-206">Excluding Files from Symbols List</span></span>

<span data-ttu-id="e93e5-207">Чтобы исключить файлы из поиска символов, можно указать их имена в symsrv.ini или в реестре.</span><span class="sxs-lookup"><span data-stu-id="e93e5-207">To exclude files from a symbols search, you can specify their names in symsrv.ini or in the registry.</span></span> <span data-ttu-id="e93e5-208">Чтобы указать файлы в symsrv.ini, создайте раздел с именем Renames и выведите список файлов.</span><span class="sxs-lookup"><span data-stu-id="e93e5-208">To specify the files in symsrv.ini, create a section named Exclusions and list the files.</span></span> <span data-ttu-id="e93e5-209">Имена файлов могут содержать подстановочные знаки, как показано в следующем примере:</span><span class="sxs-lookup"><span data-stu-id="e93e5-209">The file names can contain wildcards, as shown in the following example:</span></span>

``` syntax
[Exclusions]
dbghelp.pdb
symsrv.*
mso*
```

<span data-ttu-id="e93e5-210">Symsrv.ini должны находиться в том же каталоге, в котором находится symsrv.dll.</span><span class="sxs-lookup"><span data-stu-id="e93e5-210">Symsrv.ini should be located in the same directory that symsrv.dll resides.</span></span> <span data-ttu-id="e93e5-211">В большинстве случаев файл не существует, и необходимо создать новый.</span><span class="sxs-lookup"><span data-stu-id="e93e5-211">In most installations, the file does not exist and you will need to create a new one.</span></span>

<span data-ttu-id="e93e5-212">Кроме того, можно хранить файлы, исключаемые из реестра.</span><span class="sxs-lookup"><span data-stu-id="e93e5-212">Alternatively, you can store the files to be excluded in the registry.</span></span> <span data-ttu-id="e93e5-213">Создайте следующий раздел реестра: **hKey \_ локальный \_ компьютер \\ программное \\ обеспечение \\ \\ исключения Microsoft Symbol Server**.</span><span class="sxs-lookup"><span data-stu-id="e93e5-213">Create the following registry key: **HKEY\_LOCAL\_MACHINE\\Software\\Microsoft\\Symbol Server\\Exclusions**.</span></span> <span data-ttu-id="e93e5-214">Сохраните каждое имя файла как строковое значение (REG \_ SZ) в этом ключе.</span><span class="sxs-lookup"><span data-stu-id="e93e5-214">Store each file name as a string value (REG\_SZ) within this key.</span></span> <span data-ttu-id="e93e5-215">Имя строкового значения указывает имя файла, который необходимо исключить.</span><span class="sxs-lookup"><span data-stu-id="e93e5-215">The name of the string value specifies the name of the file to be excluded.</span></span> <span data-ttu-id="e93e5-216">Содержимое строкового значения можно использовать для хранения комментария, описывающего причину исключения файла.</span><span class="sxs-lookup"><span data-stu-id="e93e5-216">You can use the contents of the string value to store a comment describing why the file is being excluded.</span></span>

## <a name="installation"></a><span data-ttu-id="e93e5-217">Установка</span><span class="sxs-lookup"><span data-stu-id="e93e5-217">Installation</span></span>

<span data-ttu-id="e93e5-218">Сервер символов SymSrv (symsrv.dll) включен в пакет средств отладки для Windows.</span><span class="sxs-lookup"><span data-stu-id="e93e5-218">The SymSrv (symsrv.dll) symbol server is included in the Debugging Tools for Windows package.</span></span> <span data-ttu-id="e93e5-219">Он должен быть установлен в том же каталоге, что и копия dbghelp.dll, которую вы загружаете.</span><span class="sxs-lookup"><span data-stu-id="e93e5-219">It must be installed in the same directory as the copy of dbghelp.dll that you are loading.</span></span> <span data-ttu-id="e93e5-220">Дополнительные сведения см. [в разделе вызов библиотеки DBGHELP](calling-the-dbghelp-library.md).</span><span class="sxs-lookup"><span data-stu-id="e93e5-220">For more details, see [Calling the DbgHelp Library](calling-the-dbghelp-library.md).</span></span>

 

 



