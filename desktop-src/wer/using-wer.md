---
title: Использование WER
description: начиная с Windows Vista Windows предоставляет отчеты о сбоях, неответе и сбоях ядра по умолчанию, не требуя внесения изменений в приложение.
ms.assetid: c096cd89-e3a7-4959-a35f-40e6168f277e
keywords:
- Windows отчеты об ошибках Windows отчетов об ошибках с помощью
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 17dfa8bc2235f43770cd177ad3e5d9a7d1aacde36034152b88cb06af3879e8c1
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118442244"
---
# <a name="using-wer"></a>Использование WER

начиная с Windows Vista Windows предоставляет отчеты о сбоях, неответе и сбоях ядра по умолчанию, не требуя внесения изменений в приложение. При необходимости отчет будет содержать сведения дампа минидампа и кучи. Вместо этого приложения используют API WER для отправки отчетов о проблемах, связанных с приложениями, в корпорацию Майкрософт.

поскольку Windows автоматически сообщает о необработанных исключениях, приложение не должно обрабатывать неустранимые исключения. Если процесс сбоя или неотвечающего процесса является интерактивным, WER отображает пользовательский интерфейс, уведомляющий пользователя о проблеме. приложение считается неотвечающим, если оно не реагирует на Windows сообщения в течение пяти секунд, пока пользователь пытается взаимодействовать с приложением.

## <a name="windows-error-reporting-flow-for-crashes-non-response-and-kernel-faults"></a>поток отчеты об ошибках Windows для сбоев, нереагирования и сбоев ядра

Ниже показаны действия, выполняемые для сбоев приложения, нереагирования или сбоя ядра.

1.  Происходит событие проблемы.
2.  Операционная система вызывает WER.
3.  WER собирает данные, создает отчет и запрашивает у пользователя разрешение (при необходимости).
4.  WER отправляет отчет в корпорацию Майкрософт (сервер Watson), если он был отправлен.
5.  Если сервер Watson запрашивает дополнительные данные, то средство WER собирает данные и запрашивает у пользователя разрешение (при необходимости).
6.  Если приложение зарегистрировано для восстановления и перезапуска, то программа WER выполняет зарегистрированные функции обратного вызова, пока данные сжимаются и отправляются в корпорацию Майкрософт (если пользователь не отправлял).
7.  Если в корпорации Майкрософт есть ответ на проблему, пользователь получает уведомления.

Приложения могут использовать следующие функции для настройки содержимого отчета, отправляемого в корпорацию Майкрософт. Функции регистрации сообщают о том, что в отчете об ошибках, создаваемых, включаются определенные файлы и блоки памяти.

-   [**веррегистерфиле**](/windows/desktop/api/Werapi/nf-werapi-werregisterfile)
-   [**веррегистермемориблокк**](/windows/desktop/api/Werapi/nf-werapi-werregistermemoryblock)
-   [**версетфлагс**](/windows/desktop/api/Werapi/nf-werapi-wersetflags)
-   [**верунрегистерфиле**](/windows/desktop/api/Werapi/nf-werapi-werunregisterfile)
-   [**верунрегистермемориблокк**](/windows/desktop/api/Werapi/nf-werapi-werunregistermemoryblock)
-   [**вержетфлагс**](/windows/desktop/api/Werapi/nf-werapi-wergetflags)

## <a name="windows-error-reporting-flow-for-generic-event-reporting"></a>поток отчеты об ошибках Windows для отчетов об универсальных событиях

Следующие шаги показывают, как приложения могут получить отчет об ошибке для некритической ошибки.

1.  Возникло некритическое событие проблемы.
2.  Приложение распознает событие и использует следующую последовательность вызовов функций для создания отчета.
    1.  Чтобы создать отчет, вызовите функцию [**веррепорткреате**](/windows/desktop/api/Werapi/nf-werapi-werreportcreate) .
    2.  Вызовите функцию [**веррепортсетпараметер**](/windows/desktop/api/Werapi/nf-werapi-werreportsetparameter) , чтобы задать параметры отчета.
    3.  Вызовите функцию [**веррепортаддфиле**](/windows/desktop/api/Werapi/nf-werapi-werreportaddfile) , чтобы добавить файлы в отчет.
    4.  Вызовите функцию [**веррепортадддумп**](/windows/desktop/api/Werapi/nf-werapi-werreportadddump) , чтобы добавить в отчет Малый дамп (при необходимости).
    5.  Чтобы отправить отчет, вызовите функцию [**веррепортсубмит**](/windows/desktop/api/Werapi/nf-werapi-werreportsubmit) .
    6.  Вызовите [**веррепортклосехандле**](/windows/desktop/api/Werapi/nf-werapi-werreportclosehandle) , чтобы освободить ресурсы.
3.  В зависимости от конкретных параметров, используемых при вызове функций на шаге 2, WER завершает отчеты об ошибках. WER гарантирует, что отчеты будут выполняться в соответствии с политиками, установленными пользователем. Например, WER отправит отчет в корпорацию Майкрософт, поставит в очередь отчет и отобразит соответствующие пользовательские интерфейсы.

## <a name="excluding-an-application-from-windows-error-reporting"></a>исключение приложения из отчеты об ошибках Windows

чтобы исключить приложение из Windows отчетов об ошибках, используйте функцию [**вераддексклудедаппликатион**](/windows/desktop/api/Werapi/nf-werapi-weraddexcludedapplication) . Чтобы восстановить отчеты об ошибках для приложения, используйте функцию [**верремовиксклудедаппликатион**](/windows/desktop/api/Werapi/nf-werapi-werremoveexcludedapplication) .

## <a name="automatically-recovering-data-and-restarting-a-faulted-application"></a>Автоматическое восстановление данных и перезапуск сбойного приложения

Приложение может использовать восстановление и перезагрузку приложения, чтобы сохранить данные и сведения о состоянии до завершения работы приложения из-за необработанного исключения или зависания приложения. При запросе приложение также перезапускается. Дополнительные сведения см. в разделе [Восстановление приложений и перезапуск](/windows/desktop/Recovery/application-recovery-and-restart-portal).

## <a name="legacy-api"></a>Устаревший API

Приложение может сообщить об ошибке, вызвав функцию [**репортфаулт**](/windows/desktop/api/ErrorRep/nf-errorrep-reportfault) . Однако не следует использовать функцию **репортфаулт** , если нет особой необходимости в том, что поведение по умолчанию для отчетов об ошибках операционной системы не может быть удовлетворено.

Если включен отчет об ошибках, система отображает диалоговое окно, указывающее, что приложение столкнулось с проблемой и будет закрыто. при наличии отладчика, настроенного в разделе **" \_ \_ \\ программное обеспечение локального компьютера HKEY \\ Microsoft \\ Windows NT \\ CurrentVersion \\ аедебуг** ", пользователю предоставляется возможность запустить отладчик. Пользователю также предоставляется возможность отправить отчет в корпорацию Майкрософт. Если пользователь отправляет отчет, система отображает еще одно диалоговое окно, которое составило пользователя для отчета и предоставляет ссылку на дополнительные сведения.

Система отчетов об ошибках поддерживает следующие режимы работы.



| Режим работы          | Описание                                                                                                                                                                                                                                                                                                                                  |
|-------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Отчеты о общей памяти | Если контекст безопасности приложения совпадает с контекстом безопасности вошедшего в систему пользователя, система отчетов об ошибках использует блок общей памяти для обмена данными. Этот режим нельзя использовать с режимом создания отчетов манифеста.<br/>                                                                                               |
| Отчеты о манифестах      | Если контекст безопасности приложения не совпадает с контекстом безопасности вошедшего в систему пользователя, система отчетов об ошибках использует файл для обмена данными. Этот режим также используется для создания отчетов о неотвечающих приложениях и сбоях ядра. Этот режим нельзя использовать с режимом создания отчетов общей памяти.<br/>                      |
| Отчеты в Интернете      | Система отчетов об ошибках отправляет все данные в корпорацию Майкрософт через Интернет. Это режим работы по умолчанию. Его нельзя использовать с корпоративным режимом отчетов. Этот режим используется, если администратор не указал путь передачи Организации.<br/>                                                                     |
| Корпоративные отчеты     | Система отчетов об ошибках отправляет все данные в общую папку, а не передает их непосредственно в корпорацию Майкрософт. Это позволяет корпоративным ИТ-менеджерам проверять данные перед их отправкой в корпорацию Майкрософт. Этот режим используется при наличии корпоративного пути передачи, указанного администратором. Его нельзя использовать с режимом создания отчетов в Интернете.<br/> |
| Отчеты без монитора      | Система отчетов об ошибках не отображает никаких диалоговых окон для пользователя. Это позволяет корпоративным ИТ Manager получать отчеты об ошибках от своих сотрудников в любое время. Этот режим используется, когда администратор включает отчеты, но уведомление отключено. Его можно использовать только в корпоративном режиме отчетов.<br/>        |



 

Чтобы исключить приложение из отчетов об ошибках, используйте функцию [**аддерексклудедаппликатион**](/windows/desktop/api/ErrorRep/nf-errorrep-adderexcludedapplicationa) .

 

