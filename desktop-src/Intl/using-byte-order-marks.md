---
description: Всегда добавляйте префикс к текстовому файлу Юникода с меткой порядка байтов, которая информирует приложение о получении файла о том, что файл является упорядоченным по байтам.
ms.assetid: d9f1ef5c-6367-4183-9c07-01c73cb4debc
title: Использование меток порядка байтов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7b72d2ec366020f4c82c418e654e1c7fa0b4c8c1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105651202"
---
# <a name="using-byte-order-marks"></a>Использование меток порядка байтов

Всегда добавляйте префикс к текстовому файлу Юникода с меткой порядка байтов, которая информирует приложение о получении файла о том, что файл является упорядоченным по байтам. Доступные метки порядка байтов перечислены в следующей таблице. Поскольку обычный текст в Юникоде представляет собой последовательность из 16-разрядных значений кода, он учитывает порядок байтов, используемый при написании текста.

> [!Note]  
> Метка порядка байтов не является управляющим символом, который выбирает порядок байтов текста.

 



| Метка порядка байтов | Описание           |
|-----------------|-----------------------|
| EF BB BF        | UTF-8                 |
| FF FE           | UTF-16, с прямым порядком байтов |
| FE FF           | UTF-16, обратный порядок байтов    |
| FF FE 00 00     | UTF-32, с прямым порядком байтов |
| 00 00 FE FF     | UTF-32, с обратным порядком байтов    |



 

> [!Note]  
> Корпорация Майкрософт использует UTF-16 с прямым порядком байтов.

 

В идеале весь текст в Юникоде следует только одному набору правил порядка следования байтов. Однако это невозможно, поскольку микропроцессоры отличаются размещением наименее значимого байта. Процессоры Intel и MIPS сначала размещаются на наименее значащий байт, тогда как процессоры Motorola (и все файлы в формате Юникод с обратным байтом) располагают его последними. При использовании только одного набора правил порядка байтов пользователи одного типа микропроцессора вынуждены менять порядок байтов каждый раз, когда текстовый файл считывается или записывается, даже если файл никогда не передается в другую операционную систему на основе другого микропроцессора.

Предпочтительное место для указания порядка байтов находится в заголовке файла, но текстовые файлы не имеют заголовков. Поэтому в Юникоде определен символ (U + FEFF) и несимвольный (U + ФФФЕ) в качестве меток порядка байтов. Они представляют собой зеркально отображаемые байтовые изображения.

Поскольку последовательность U + FEFF превышена в начале обычного текстового файла в формате, отличном от Юникода, она может служить неявным маркером или сигнатурой для того, чтобы идентификатор файла определялся как файл Юникода. Приложения, считывающие текстовые файлы в Юникоде и не в Юникоде, должны использовать эту последовательность в качестве индикатора того, что файл, скорее всего, является файлом Юникода. Сравните этот метод с использованием маркера MS-DOS EOF для завершения текстовых файлов.

Когда приложение обнаруживает U + FEFF в начале текстового файла, оно обычно обрабатывает файл как файл Юникода, хотя он может выполнять дальнейшие эвристические проверки. Такая проверка может быть настолько простой, как тестирование, чтобы выяснить, является ли изменение в байтах нижнего порядка большим, чем изменение в байтах с высоким порядковым номером. Например, если текст ASCII преобразуется в текст в Юникоде, каждый второй байт равен 0. Кроме того, при проверке того, что символы перевода строки и возврата каретки (U + 000A; и U + 000D), а также для четного или нечетного размера файла, могут дать строгий показатель природы файла.

Когда приложение обнаруживает U + ФФФЕ в начале текстового файла, оно интерпретирует его как файл с обратным байтом в Юникоде. Приложение может либо поменять порядок байтов, либо предупредить пользователя о том, что произошла ошибка.

Поскольку символ метки порядка байтов Юникода не найден ни в одной кодовой странице, он исчезает, если данные преобразуются в ANSI. В отличие от других символов Юникода, он не заменяется символом по умолчанию при преобразовании. Если метка порядка байтов находится в середине файла, она не интерпретируется как символ Юникода и не влияет на вывод текста.

> [!Note]  
> Значение Юникода U + FFFF недопустимо в текстовых файлах и не может передаваться между приложениями. Он зарезервирован для частного использования приложения.

 

## <a name="related-topics"></a>См. также

<dl> <dt>

[Использование специальных символов в Юникоде](using-special-characters-in-unicode.md)
</dt> </dl>

 

 



