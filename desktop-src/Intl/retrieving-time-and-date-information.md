---
description: Этот раздел содержит инструкции по использованию функций многоязыковой поддержки в приложениях для получения сведений о времени и датах, а также данных о длительности. Если приложение должно сохранять данные, см. статью использование постоянных данных языкового стандарта.
ms.assetid: 1880ff8f-110c-4661-8b1f-afe1d8d2a38d
title: Получение сведений о времени и дате
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ea2c2fa1d15de2c1ba5587a981373ff14b1c1c7f
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127171947"
---
# <a name="retrieving-time-and-date-information"></a>Получение сведений о времени и дате

Этот раздел содержит инструкции по использованию функций многоязыковой поддержки в приложениях для получения сведений о [времени и датах](time-and-date.md) , а также данных о длительности. Если приложение должно сохранять данные, см. статью [использование постоянных данных языкового стандарта](using-persistent-locale-data.md).

**Windows Vista и более поздних версий:** Функции, описанные в этом разделе, могут получать данные из [пользовательских языковых стандартов](custom-locales.md). В частности, они могут использоваться для настройки форматов даты и времени. Например, можно использовать формат времени, например "Хххмм'сс" ", что приведет к последующим строкам времени, таким как" 12H34 "12" "".

## <a name="retrieve-time-information"></a>Получение сведений о времени

Приложение может получать строки в любое время в формате, подходящем для текущего языкового стандарта, с помощью функций [**жеттимеформат**](/windows/desktop/api/datetimeapi/nf-datetimeapi-gettimeformata) и [**жеттимеформатекс**](/windows/desktop/api/datetimeapi/nf-datetimeapi-gettimeformatex) . Каждая из функций проверяет все значения времени в допустимой структуре [**SYSTEMTIME**](/windows/win32/api/minwinbase/ns-minwinbase-systemtime) , чтобы определить, что она находится в соответствующем диапазоне значений, игнорируя части даты в структуре. Если любое из значений времени находится вне допустимого диапазона, функция завершается ошибкой с \_ недопустимым \_ параметром Code Error. Функция не возвращает ошибок для неправильной строки формата, но просто формирует максимально возможную строку времени.

> [!Note]  
> Функции времени NLS не включают миллисекунды в составе отформатированной строки времени.

 

Чтобы получить формат времени без выполнения фактического форматирования, приложение может использовать функцию [**GetLocaleInfo**](/windows/desktop/api/Winnls/nf-winnls-getlocaleinfoa) или [**GetLocaleInfoEx**](/windows/desktop/api/Winnls/nf-winnls-getlocaleinfoex) , указав в вызове константу [ \_ стимеформат locale](locale-stime-constants.md) .

**Использование маркеров времени**

Примеры маркеров времени: "AM" и "PM" для английского языка (США) и "de." и «du». для испанского (Мексика). Если параметр TIME \_ нотимемаркер указан в вызове [**Жеттимеформат**](/windows/desktop/api/datetimeapi/nf-datetimeapi-gettimeformata) или [**жеттимеформатекс**](/windows/desktop/api/datetimeapi/nf-datetimeapi-gettimeformatex), функция удаляет разделители перед и после маркера времени. Если маркер времени существует и \_ в вызове не задан флаг Time нотимемаркер, функция локализуется маркер времени на основе указанного идентификатора языкового стандарта.

**Удалить разделители за последние минуты и секунды**

Приложение может вызвать [**жеттимеформат**](/windows/desktop/api/datetimeapi/nf-datetimeapi-gettimeformata) или [**жеттимеформатекс**](/windows/desktop/api/datetimeapi/nf-datetimeapi-gettimeformatex) с заданными интервалами времени \_ номинутесорсекондс или времени \_ , чтобы удалить разделители, предшествующие элементам минут и (или) секунд.

**Использовать 24-часовой формат времени**

Если приложение поддерживает 24-часовой формат времени, оно может вызвать [**жеттимеформат**](/windows/desktop/api/datetimeapi/nf-datetimeapi-gettimeformata) или [**жеттимеформатекс**](/windows/desktop/api/datetimeapi/nf-datetimeapi-gettimeformatex) с временем \_ FORCE24HOURFORMAT. Если установлен \_ флаг времени нотимемаркер, функция отображает любой существующий маркер времени.

## <a name="retrieve-date-information"></a>Получение сведений о датах

Приложение может извлекать строки для любой даты в формате, подходящем для текущего языкового стандарта, с помощью функций [**жетдатеформат**](/windows/desktop/api/datetimeapi/nf-datetimeapi-getdateformata) и [**жетдатеформатекс**](/windows/desktop/api/datetimeapi/nf-datetimeapi-getdateformatex) . Любая из функций проверяет каждое из значений даты: год, месяц, день и день недели в допустимой структуре [**SYSTEMTIME**](/windows/win32/api/minwinbase/ns-minwinbase-systemtime) , игнорируя часть структуры времени. Имя дня, сокращенное название дня, название месяца и сокращенное название месяца локализованы на основе идентификатора локали. Если день недели неверен, функция использует правильное значение и не возвращает ошибку. Если любое из других значений даты находится вне допустимого диапазона, функция завершается ошибкой с \_ недопустимым \_ параметром Code Error. Функция не возвращает ошибок для неправильной строки формата, но просто формирует наиболее подходящую строку даты.

Если приложению требуется формат даты для конкретного календаря, он должен использовать [**жеткалендаринфо**](/windows/desktop/api/Winnls/nf-winnls-getcalendarinfoa) или [**жеткалендаринфоекс**](/windows/desktop/api/Winnls/nf-winnls-getcalendarinfoex), передав соответствующий [**идентификатор календаря**](calendar-identifiers.md). Чтобы вернуть все форматы даты для конкретного календаря, приложение может использовать [**енумкалендаринфоекс**](/windows/desktop/api/Winnls/nf-winnls-enumcalendarinfoexa), [**енумкалендаринфоексекс**](/windows/desktop/api/Winnls/nf-winnls-enumcalendarinfoexex), [**енумдатеформатсекс**](/windows/desktop/api/Winnls/nf-winnls-enumdateformatsexa)или [**енумдатеформатсексекс**](/windows/desktop/api/Winnls/nf-winnls-enumdateformatsexex).

**Укажите альтернативный календарь**

Приложение может вызвать [**жетдатеформат**](/windows/desktop/api/datetimeapi/nf-datetimeapi-getdateformata) или [**жетдатеформатекс**](/windows/desktop/api/datetimeapi/nf-datetimeapi-getdateformatex) с флагом Date. Используйте альтернативный \_ Календарь, \_ \_ чтобы использовать формат по умолчанию для указанного альтернативного календаря. Если для альтернативного календаря формат по умолчанию отсутствует, функция использует переопределения пользователя.

Чтобы получить формат даты для альтернативного календаря, приложение может использовать [**GetLocaleInfo**](/windows/desktop/api/Winnls/nf-winnls-getlocaleinfoa) или [**GetLocaleInfoEx**](/windows/desktop/api/Winnls/nf-winnls-getlocaleinfoex) с константой [ \_ иоптионалкалендар locale](locale-ioptionalcalendar.md) .

**Укажите тип даты**

Если приложение хочет использовать краткий формат даты, оно указывает дату \_ шортдате в вызове [**Жетдатеформат**](/windows/desktop/api/datetimeapi/nf-datetimeapi-getdateformata) или [**жетдатеформатекс**](/windows/desktop/api/datetimeapi/nf-datetimeapi-getdateformatex). Длинный формат даты можно получить, указав DATE \_ лонгдате в вызове функции. Если ни один из флагов не указан и *лпформат* имеет значение **null**, функция использует \_ в качестве значения по умолчанию Date шортдате.

Чтобы получить короткий и длинный формат даты для календаря языкового стандарта по умолчанию, приложение должно использовать функцию [**GetLocaleInfo**](/windows/desktop/api/Winnls/nf-winnls-getlocaleinfoa) или [**GetLocaleInfoEx**](/windows/desktop/api/Winnls/nf-winnls-getlocaleinfoex) с константой [locale \_ сшортдате](locale-sshortdate.md) или [locale \_ слонгдате](locale-slongdate.md) .

**Укажите формат даты**

Приложение может указать формат даты, который [**жетдатеформат**](/windows/desktop/api/datetimeapi/nf-datetimeapi-getdateformata) или [**жетдатеформатекс**](/windows/desktop/api/datetimeapi/nf-datetimeapi-getdateformatex) использует для формирования строки даты. Если требуется формат даты для указанного языкового стандарта, приложение может вызвать функцию с параметром *лпформат* , имеющим значение **null**. Если параметр не имеет значение **null**, функция использует языковой стандарт только для информации, которая не указана в формате строки рисунка, например названия дня и месяца для языкового стандарта.

Приложение может заключить любой текст, который должен оставаться в точной форме в одинарных кавычках. Одинарную кавычку также можно использовать в качестве escape-символа, чтобы иметь возможность отображать метку в строке даты. Однако escape-последовательность должна быть заключена в две одинарные кавычки. Например, чтобы отобразить дату как "Май" 93 ", строка форматирования будет иметь вид" мммм "' ' yy ' '.

## <a name="retrieve-duration-information"></a>Получение сведений о длительности

**Windows Vista и более поздних версий:** Функции [**жетдуратионформат**](/windows/desktop/api/Winnls/nf-winnls-getdurationformat) и [**жетдуратионформатекс**](/windows/desktop/api/Winnls/nf-winnls-getdurationformatex) доступны для получения форматов длительности для национальных настроек, включая пользовательские языковые стандарты. Чтобы получить формат длительности по умолчанию для языкового стандарта, приложение должно использовать функцию [**GetLocaleInfo**](/windows/desktop/api/Winnls/nf-winnls-getlocaleinfoa) или [**GetLocaleInfoEx**](/windows/desktop/api/Winnls/nf-winnls-getlocaleinfoex) с константой [locale \_ сдуратион](locale-sduration.md) .

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Поддержка национальных языков](about-national-language-support.md)
</dt> <dt>

[Время и Дата](time-and-date.md)
</dt> <dt>

[Использование постоянных данных языкового стандарта](using-persistent-locale-data.md)
</dt> </dl>

 

 
