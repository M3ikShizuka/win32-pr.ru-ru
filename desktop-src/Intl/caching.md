---
description: Uniscribe сохраняет сопоставления Юникода с глифом (кмап), ширину глифов и таблицы формирования скриптов OpenType.
ms.assetid: c06c0eaf-41cb-4fd1-9750-a78355217f12
title: Кэширование (Международная локализация)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2a01d8444fa222c2b6f6c7b03d0e1be70c1e04b1509ab020b8769d87b2b5cbc0
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119500834"
---
# <a name="caching-internationalization"></a>Кэширование (Международная локализация)

Uniscribe сохраняет сопоставления Юникода с глифом (кмап), ширину глифов и таблицы формирования скриптов OpenType. Дескриптор таблиц для конкретного шрифта определенного размера называется "кэшем скриптов". Многие функции Uniscribe вызывают как параметр дескриптора контекста устройства, так и указатель на структуру [**\_ кэша скрипта**](script-cache.md) . Эти функции сначала ищут сведения в кэше скрипта, используя контекст устройства, только если требуемые таблицы еще не кэшированы. При вызове функции [**скриптшапе**](/windows/desktop/api/Usp10/nf-usp10-scriptshape), [**скриптплаце**](/windows/desktop/api/Usp10/nf-usp10-scriptplace)или [**скрипттекстаут**](/windows/desktop/api/Usp10/nf-usp10-scripttextout) приложение должно передать указатель на структуру **\_ кэша скрипта** . Перед первым возвратом приложения в функцию Uniscribe этот обработчик должен инициализироваться со **значением NULL** . Приложение никогда не должно передавать один и тот же маркер для различных шрифтов или различных размеров.

Приложение может освободить кэш скриптов в любое время. Uniscribe поддерживает подсчет ссылок в своих шрифтах и кэшах форм, освобождает данные только при освобождении всех размеров шрифта и освобождает данные, только если освобождаются все шрифты, поддерживаемые фигурой. Когда приложение выполняется с использованием стиля, оно должно вызвать функцию [**скриптфрикаче**](/windows/desktop/api/Usp10/nf-usp10-scriptfreecache) , чтобы освободить кэш скриптов для стиля.

Для [**скриптшапе**](/windows/desktop/api/Usp10/nf-usp10-scriptshape) и [**скриптплаце**](/windows/desktop/api/Usp10/nf-usp10-scriptplace)допустимо, чтобы приложение передавало контекст неопределенного устройства. Чаще всего вызов будет выполнен, так как необходимые таблицы уже кэшированы. Если для формирования или размещения требуется доступ к контексту устройства, **скриптшапе** или **скриптплаце** сразу же возвращает \_ код ошибки E. Затем приложение должно выбрать шрифт в контексте устройства. Для большинства приложений это способствует повышению производительности за счет предотвращения повторной подготовки обработчика контекста устройства к вызовам [**SelectObject**](/windows/win32/api/wingdi/nf-wingdi-selectobject).

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Использование Uniscribe](using-uniscribe.md)
</dt> </dl>

 

 
