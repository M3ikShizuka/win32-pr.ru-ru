---
description: Описание основных принципов многоязыкового интерфейса пользователя
ms.assetid: 9ab19a56-4d31-471d-949e-a539751b62e3
title: Описание основных принципов многоязыкового интерфейса пользователя
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 82dbeedb246944bef6c23c739eafddff86423b35
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103991367"
---
# <a name="mui-fundamental-concepts-explained"></a>Описание основных принципов многоязыкового интерфейса пользователя

-   [Предварительные требования для MUI](#prerequisite-for-mui)
-   [Отделение исходного кода от ресурсов, зависящих от языка](#separation-of-source-code-from-language-specific-resources)
    -   [Первые дни: код и ресурсы вместе](#the-early-days-code-and-resources-live-together)
    -   [Логически отделение кода и локализуемых ресурсов](#logically-separating-code-and-localizable-resources)
    -   [Физическая разделяющая код и ресурсы](#physically-separating-code-and-resources)
-   [Динамическая загрузка ресурсов для конкретного языка](#dynamically-loading-language-specific-resources)
-   [Создание приложений многоязыкового интерфейса пользователя](#building-mui-applications)

## <a name="prerequisite-for-mui"></a>Предварительные требования для MUI

Базовым необходимым условием для создания приложения, совместимого с MUI, для Windows Vista и других приложений является проектирование приложения в соответствии с [рекомендациями по глобализации](https://msdn.microsoft.com/goglobal/bb688110.aspx)Windows.

## <a name="separation-of-source-code-from-language-specific-resources"></a>Отделение исходного кода от ресурсов, зависящих от языка

Одной из фундаментальных технологий многоязыкового интерфейса пользователя является отделение исходного кода приложения от зависящих от языка ресурсов, что позволяет более эффективно использовать многоязычные сценарии в приложениях. Разделение кода и ресурсов достигается с помощью различных механизмов и в разные градусы со временем, как описано в следующих разделах. Каждый метод обеспечивает различные степени гибкости при сборке, развертывании и обслуживании приложения.

Рекомендуемым решением для приложений, совместимых с MUI, является последний описанный здесь способ, а именно физическое разделение исходного кода приложения и ресурсов, в результате чего ресурсы могут быть разбиты на один файл на поддерживаемый язык для обеспечения максимальной гибкости при сборке, развертывании и обслуживании.

### <a name="the-early-days-code-and-resources-live-together"></a>Первые дни: код и ресурсы вместе

Изначально локализованные приложения были созданы путем изменения исходного кода и изменения ресурсов (обычно строки) в самом коде и повторной компиляции приложений. Это означало, что для создания локализованной версии необходимо скопировать исходный исходный код, преобразовать элементы текста (recompiles) в исходный код и перекомпилировать код. На следующем рисунке показан код приложения с текстом, который необходимо локализовать.

![Концептуальная схема, показывающая приложение, которое содержит блоки внедренных текстовых ресурсов](images/mui-fundamental-concepts-explained-fig3.gif)

Хотя такой подход позволяет создавать локализованные приложения, он также имеет значительные недостатки.

-   Для этого требуется несколько версий исходного кода, по крайней мере один для исходного языка и один для каждого из целевых языков. Это создает значительные проблемы, синхронизирующие различные языковые версии приложения. В частности, если дефект необходимо исправить в коде, ошибку необходимо исправить в каждой копии исходного кода (по одному на каждый язык).
-   Это также чрезвычайно подвержено ошибкам, так как в нем требуются локализаторы, не являющиеся разработчиками, для внесения изменений в исходный код, что создает значительный риск с точки зрения целостности кода.

Сочетание этих недостатков делает это очень неэффективным, и требуется лучшая модель.

### <a name="logically-separating-code-and-localizable-resources"></a>Логически отделение кода и локализуемых ресурсов

Значительное улучшение по сравнению с предыдущей моделью — это логическое разделение кода и локализуемых ресурсов для приложения. Это изолирует код от ресурсов и гарантирует, что код остается нетронутым при изменении ресурсов при локализации. С точки зрения реализации строки и другие элементы пользовательского интерфейса хранятся в файлах ресурсов, которые относительно просты в преобразовании и логически отделены от разделов кода.

В идеале, Добавление поддержки для любого языка может быть так же простым, как перевод локализуемых ресурсов на этот новый язык, и использование этих переведенных ресурсов для создания новой локализованной версии приложения без внесения каких-либо изменений в код. На следующем рисунке показано, как код и локализуемые ресурсы должны быть логически разделены внутри приложения.

![Концептуальная схема, на которой показано приложение, которое содержит локализуемые ресурсы, отделенные от кода](images/mui-fundamental-concepts-explained-fig4.gif)

Эта модель упрощает создание локализованных версий приложения и является значительным улучшением по сравнению с предыдущей моделью. Эта модель, реализованная с помощью средств управления ресурсами, была очень успешной в течение нескольких лет и по-прежнему используется многими приложениями уже сегодня. Однако у него есть серьезные недостатки:

-   В то время как логически разделены, код и локализованные ресурсы по-прежнему физически объединяются в один исполняемый файл. В частности, Обслуживание по-прежнему проблематично, так как один и тот же дефект кода (идентичный во всех языковых версиях) требует наличия исправления для каждого языка. Таким образом, если один из них отправляет приложение на 20 языках, исправление службы должно выдаваться 20 раз (по одному для каждого языка), хотя код только один раз исправляется.
-   Распространение и использование многоязычных приложений не поддерживается этой моделью. Это может быть серьезной проблемой в сценариях OEM и Enterprise. Например, если компьютер должен совместно использоваться двумя пользователями, использующими разные языки, необходимо дважды установить приложения с этой моделью, а затем включить какой-либо механизм для переключения между двумя установками. Предполагается, что отсутствуют дополнительные зависимости, препятствующие реализации этого сценария. На следующем рисунке показан пример ошибки с одним кодом, которая требует наличия двух исправлений.

![Концептуальная схема, в которой показаны два локализованных приложения с одинаковыми дефектами кода](images/mui-fundamental-concepts-explained-fig5.gif)

Очевидно, что хотя эта модель хорошо работает в некоторых сценариях, ее ограничения для многоязычных приложений и их развертываний могут быть очень проблематичными.

Разновидность этой модели, которая устраняет некоторые проблемы, связанные с многоязычными приложениями, представляет собой модель, в которой локализуемые ресурсы содержат набор различных языковых ресурсов. Эта модель имеет общую базу кода и несколько ресурсов для разных языков в одном приложении. Например, приложение может поставляться на английском, немецком, французском, испанском, нидерландском и итальянском языках в одном пакете. На следующем рисунке показано приложение, которое содержит несколько языковых ресурсов.

![Концептуальная схема, на которой показано приложение с кодом, отделенным от двух ресурсов, зависящих от языкового стандарта](images/mui-fundamental-concepts-explained-fig6.gif)

Эта модель упрощает обслуживание приложения при необходимости исправления дефекта кода, что является улучшением, но не улучшает предыдущие модели, когда речь идет о поддержке дополнительных языков. В этом случае по-прежнему необходимо освободить новую версию приложения (и этот выпуск потенциально осложняется тем, что все языковые ресурсы будут синхронизированы в одном распространении).

### <a name="physically-separating-code-and-resources"></a>Физическая разделяющая код и ресурсы

Следующим эволюционным шагом является физическое разделение кода и ресурсов. В этой модели ресурсы являются абстрактными по отношению к коду и физически разделены в разных файлах реализации. В частности, это означает, что код может стать независимым от языка; Этот же физический код фактически поставляется для всех локализованных версий приложения. На следующем рисунке показано, что код и локализуемые ресурсы должны быть физически разделены.

![Концептуальная схема, показывающая приложение, отделенное от его локализуемых ресурсов](images/mui-fundamental-concepts-explained-fig7.gif)

Этот подход имеет несколько преимуществ по сравнению с предыдущими подходами:

-   Развертывание многоязычных решений значительно упрощено. Для добавления поддержки любого определенного языка требуется только доставка и установка нового набора языковых ресурсов для этого конкретного языка. Это особенно важно, если языковые ресурсы недоступны одновременно. С помощью этой модели можно развернуть приложение в наборе основных языков и увеличить количество поддерживаемых языков с течением времени без необходимости изменять или повторно развертывать фактический код. Это преимущество расширяется резервным механизмом, который обеспечивает частичную локализацию приложений и компонентов системы на определенном языке, гарантируя, что ресурсы, не найденные на этом предпочитаемом языке, будут возвращаться к другому языку, который пользователи также понимают. В целом, эта модель помогает уменьшить существенные изученные затраты на развертывание приложений на нескольких языках, так как в этом случае развертывание одного образа выполняется гораздо более эффективно.
-   Улучшено удобство обслуживания. Дефект кода необходимо исправить и развернуть только один раз, так как код полностью независим от локализации. В этой модели, выполнив исправление для дефекта кода, при условии, что изменение не связано с пользовательским интерфейсом, гораздо проще и экономичнее, чем в любой из предыдущих моделей.

## <a name="dynamically-loading-language-specific-resources"></a>Динамическая загрузка ресурсов для конкретного языка

Основные принципы многоязыкового интерфейса пользователя, которые [физически разделяют исходный код от ресурсов, зависящих от языка](#physically-separating-code-and-resources), и создание независящего от языка двоичного файла для приложения, по сути, устанавливают архитектуру, пригодного для реализации динамической загрузки зависящих от языка ресурсов на основе языковых параметров пользователя и системы.

Исходный код приложения, Объединенный в двоичный файл, не зависящий от языка, может использовать интерфейсы API многоязыкового интерфейса пользователя на платформе Windows для абстракции выбора соответствующего языка пользовательского интерфейса для данного контекста. MUI поддерживает это:

-   Создание списка приоритетов отображаемых языков пользовательского интерфейса на основе параметров системы, пользователя и уровня приложения, уровня пользователя и системного уровня.
-   Реализация резервного механизма, который выбирает подходящий кандидат из этого списка языков по расстановке, исходя из доступности локализованных ресурсов.

Ниже перечислены преимущества динамической загрузки ресурсов пользовательского интерфейса с приоритетными вариантами.

-   Он обеспечивает частичную локализацию приложений и компонентов системы на определенном языке, так как ресурсы, не найденные на этом предпочитаемом языке, автоматически переходят на следующий язык в списке с приоритетом.
-   Это позволяет выполнять такие сценарии, как динамическое переключение с одного языка на другой.
-   Он позволяет создавать региональные или международные образы с единым развертыванием, охватывающие набор языков для изготовителей оборудования и предприятий.

## <a name="building-mui-applications"></a>Создание приложений многоязыкового интерфейса пользователя

В предыдущих разделах были описаны варианты отделения исходного кода от ресурсов конкретного языка, а также полученное преимущество использования основных API-интерфейсов платформы Windows для динамической загрузки локализованных ресурсов. Хотя это и есть рекомендации, следует обратить внимание на то, что для разработки приложения MUI для платформы Windows не существует определенного специального способа.

Разработчики приложений имеют полное решение о том, как они работают с различными параметрами языка пользовательского интерфейса, параметрами создания ресурсов и методами загрузки ресурсов. Разработчики могут оценить рекомендации, приведенные в этом документе, и выбрать сочетание, которое соответствует их требованиям и среде разработки.

В следующей таблице перечислены различные варианты проектирования, доступные разработчикам приложений, которые ищут создание приложения MUI для платформы Windows.



<table>
<thead>
<tr class="header">
<th>Параметры языка пользовательского интерфейса</th>
<th>создание ресурсов;</th>
<th>Загрузка ресурсов</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="2">Следуйте параметрам языка пользовательского интерфейса в операционной системе $ {Remove} $<br />
</td>
<td>Один язык в двоичном файле с разделенным ресурсом (технология ресурсов MUI)<br/> -или-<br/> Несколько языков в двоичном файле ресурсов без разбиения<br/></td>
<td>Приложение вызывает функции загрузки стандартных ресурсов. Ресурсы возвращаются на языках, соответствующих параметрам операционной системы.<br/></td>
</tr>
<tr class="even">
<td>Механизм ресурсов для конкретного приложения<br/></td>
<td>Приложение вызывает интерфейс API многоязыкового интерфейса пользователя, чтобы получить предпочтительные для потока языки интерфейса пользователя или языки пользовательского интерфейса, предпочитаемые процессом, из операционной системы и использовать эти параметры для загрузки собственных ресурсов.<br/></td>

</tr>
<tr class="odd">
<td rowspan="2">Параметры языка пользовательского интерфейса, зависящие от приложения $ {Remove} $<br />
</td>
<td>Один язык в двоичном файле с разделенным ресурсом<br/> -или-<br/> Несколько языков в двоичном файле ресурсов без разбиения<br/></td>
<td>Приложение вызывает интерфейс API многоязыкового интерфейса пользователя, чтобы задать языки пользовательского интерфейса для конкретного приложения или предпочтительные языки интерфейса, а затем вызывает стандартные функции загрузки ресурсов. Ресурсы возвращаются на языках, установленных на языках приложения или системы.<br/> -или-<br/> Приложение проверяет ресурсы на определенном языке и обрабатывает их отдельные ресурсы из полученных двоичных данных.<br/></td>
</tr>
<tr class="even">
<td>Механизм ресурсов для конкретного приложения<br/></td>
<td>Приложение управляет собственной загрузкой ресурсов.<br/></td>

</tr>
</tbody>
</table>



 

 

 




