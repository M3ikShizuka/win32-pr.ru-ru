---
description: Приложения записывают символы, определенные конечным пользователем (Еудкс) и область частного использования (PUA), на экран или на принтер, как при написании других символов, используя функции вывода, такие как текст и ExtTextOut.
ms.assetid: c975c70d-4231-4a69-bec2-d51d6993fdd4
title: Запись, сопоставление и сортировка EUDC и PUA символов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a6c34264d956bb6a87407e249f68b2bc03fb2c99
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127057757"
---
# <a name="writing-mapping-and-sorting-eudc-and-pua-characters"></a>Запись, сопоставление и сортировка EUDC и PUA символов

Приложения записывают символы, определенные конечным пользователем (Еудкс) и область частного использования (PUA), на экран или на принтер, как при написании других символов, используя функции вывода, такие как [текст](/windows/win32/api/wingdi/nf-wingdi-textouta) и [ExtTextOut](/windows/win32/api/wingdi/nf-wingdi-exttextouta). Эти функции автоматически извлекают символьные данные из шрифтов EUDC или PUA, если включен EUDC. Дополнительные сведения см. в разделе [ \_ пользовательские и закрытые символы области использования](end-user-defined-characters.md).

При написании символов Еудкс или PUA операция функции вывода текста зависит от текущего выбранного шрифта. Если выбранный шрифт является встроенным символьным шрифтом EUDC или PUA, функция получает символьную информацию из этого шрифта. Если выбранный шрифт представляет собой шрифт [с двухбайтовой кодировкой (DBCS](double-byte-character-sets.md) ) TrueType, имеющий связанный отдельный шрифт EUDC, функция получает сведения из УКАЗАННОГО шрифта EUDC. Аналогично, если выбранный шрифт является шрифтом [Юникода](unicode.md) TrueType с соответствующим отдельным шрифтом PUA символов, функция получает информацию из шрифта PUA символов. Если у выбранного шрифта нет соответствующего символьного шрифта EUDC или PUA, функция получает сведения из системного шрифта EUDC по умолчанию. Если символ отсутствует в системном шрифте EUDC по умолчанию или отсутствует системный шрифт EUDC по умолчанию, функция записывает символ по умолчанию, определенный выбранным шрифтом.

Приложения могут сопоставлять Еудкс с Юникод и обратно с помощью функций [**MultiByteToWideChar**](/windows/desktop/api/Stringapiset/nf-stringapiset-multibytetowidechar) и [**WideCharToMultiByte**](/windows/desktop/api/Stringapiset/nf-stringapiset-widechartomultibyte) . Функция **MultiByteToWideChar** сопоставляет большинство еудкс с символами в PUAе Юникода. Однако для поддержки определенных национальных или региональных стандартов некоторые Еудкс могут быть сопоставлены с кодовыми позициями, отличными от PUA Юникода. Функция **WideCharToMultiByte** сопоставляет символ в PUA с его аналогом EUDC, если такое сопоставление существует и если кодовая точка не имеет допустимого СОПОСТАВЛЕНИЯ без PUA в Юникоде. Не все кодовые страницы имеют диапазон EUDC. Кодовая страница, указанная в вызове **WideCharToMultiByte** , должна содержать диапазон кода EUDC для сопоставления с диапазоном EUDC. Если кодовая страница не содержит диапазон кода EUDC, функция получает символ по умолчанию для любых символов в PUAе Юникода.

[**MultiByteToWideChar**](/windows/desktop/api/Stringapiset/nf-stringapiset-multibytetowidechar) и [**WideCharToMultiByte**](/windows/desktop/api/Stringapiset/nf-stringapiset-widechartomultibyte) не гарантируют сопоставление круговых поездок. Иными словами, можно начать с определенной многобайтовой строки, содержащей Еудкс, преобразовать строку в Юникод с помощью **MultiByteToWideChar** и снова соотнести ее с исходной кодировкой DBCS с **WideCharToMultiByte**, а затем получить результат, который не идентичен исходной строке. Приложения, использующие сопоставление Еудкс с Юникодом, должны гарантировать, что все необходимые символы могут циклически переойти между соответствующей областью кодовой страницы EUDC и PUAом Юникода.

Приложения не должны пытаться сопоставлять Еудкс из одной кодовой страницы в другую. Если приложение начинается с EUDC с одной кодовой страницы, сопоставляется с Юникодом с помощью [**MultiByteToWideChar**](/windows/desktop/api/Stringapiset/nf-stringapiset-multibytetowidechar)и сопоставляется с другой кодировкой DBCS с [**WideCharToMultiByte**](/windows/desktop/api/Stringapiset/nf-stringapiset-widechartomultibyte), нет никаких гарантий относительно результатов. Исходный символ может быть сопоставлен с другим EUDC в кодовой странице назначения, или же он может быть сопоставлен как неопределенный символ. Аналогичным образом, сопоставление строки Юникода с кодовой страницей, имеющей диапазон EUDC, может иметь непредвиденные результаты. Если строка Юникода содержит PUA кодовую точку, возможно, что кодовая точка будет сопоставлена с EUDC, которая не представляет один и тот же символ.

Приложения могут сравнивать строки DBCS, содержащие Еудкс, с помощью версии ANSI функции [CompareString](/windows/win32/api/stringapiset/nf-stringapiset-comparestringw) . Функция фактически сопоставляет символы в Юникоде перед сравнением символьных значений. Приложения могут создать ключ сортировки для строки с помощью версии ANSI функции [**LCMapString завершилось ошибкой**](/windows/desktop/api/Winnls/nf-winnls-lcmapstringa) и \_ значения лкмап SORTKEY. Эта функция фактически сопоставляет символы в Юникоде. Все символы в PUA сортируются после всех остальных символов Юникода. Внутри области символы сортируются в числовом порядке. Если приложение пытается получить сведения о CTYPE для EUDC с помощью функции [жетстрингтипеа](/windows/desktop/api/Winnls/nf-winnls-getstringtypea) , функция получает **значение NULL** для каждого символа.

## <a name="related-topics"></a>Связанные разделы

<dl> <dt>

[Использование Юникода и кодировок](using-unicode-and-character-sets.md)
</dt> </dl>

 

 
