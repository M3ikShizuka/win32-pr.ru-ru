---
description: В этом разделе описывается, как можно работать с международными доменными именами (IDNs) в приложениях.
ms.assetid: e0ca356e-f8c1-4845-ae1e-ce2ae8987515
title: Обработка международных доменных имен (IDNs)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6310cf74e39758dc6974a1247fe9a5b506276f5c3da55d546d6bc6c2b5a8c992
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119898593"
---
# <a name="handling-internationalized-domain-names-idns"></a>Обработка международных доменных имен (IDNs)

В этом разделе описывается, как можно работать с международными доменными именами (IDNs) в приложениях. IDNs указаны в сетевой рабочей группе [RFC 3490: Интернатионализинг Domain Names in Applications (IDNA)](http://www.faqs.org/rfcs/rfc3490.html). До этого черновой версии IDNs были ограничены восточноазиатскими символами без диакритических знаков. IDNA позволяет IDNs включать латинские символы с диакритическими знаками, а также символы из нелатинских алфавитов, таких как кириллица, арабский и китайский. Стандарт также устанавливает правила сопоставления IDNs с доменными именами только для ASCII. Поэтому проблемы IDNA можно обрабатывать на стороне клиента, не требуя изменения сервера доменных имен (DNS).

> [!Caution]  
> В RFC 3490 введен ряд проблем безопасности, связанных с использованием IDNs. Дополнительные сведения см. в соответствующем разделе [вопросов безопасности: международные функции](security-considerations--international-features.md).

 

> [!Note]  
> В настоящее время IDNA основывается на Unicode 3,2.

 

## <a name="nls-api-functions-for-handling-idns"></a>Функции API NLS для обработки IDNs

NLS включает следующие функции преобразования, которые приложение может использовать для преобразования IDN в различные представления. Пример использования этих функций см. в разделе [NLS: международного доменного имени (IDN)](nls--internationalized-domain-name--idn--conversion-sample.md).

-   [**ИднтоасЦии**](/windows/desktop/api/Winnls/nf-winnls-idntoascii). Преобразует IDN в Punycode.
-   [**Иднтонамепрепуникоде**](/windows/desktop/api/Winnls/nf-winnls-idntonameprepunicode). Выполняет Намепреп часть преобразования IDN в имя ASCII. Эта функция создает каноническое представление строки в Юникоде.
-   [**Иднтауникоде**](/windows/desktop/api/Winnls/nf-winnls-idntounicode). Преобразует строку Punycode в обычную строку UTF-16.

NLS также определяет несколько функций API, которые можно использовать для устранения некоторых угроз безопасности, предоставляемых технологией IDN. в Windows Vista и более поздних версиях следующие функции используются для проверки того, что символы в заданном IDN были полностью выведены из скриптов, связанных с определенным языковым стандартом или региональными стандартами. Пример использования этих функций см. в разделе [NLS — пример Межязыкового доменного имени (IDN)](nls--internationalized-domain-name--idn--mitigation-sample.md).

-   [**Жетстрингскриптс**](/windows/desktop/api/Winnls/nf-winnls-getstringscripts). Предоставляет список скриптов, используемых в определенной строке.
-   [**GetLocaleInfo**](/windows/desktop/api/Winnls/nf-winnls-getlocaleinfoa), [**GetLocaleInfoEx**](/windows/desktop/api/Winnls/nf-winnls-getlocaleinfoex). Получение сведений о языковых стандартах. Использование функций с *LCType* , установленным в [locale \_ сскриптс](locale-sscripts.md) , предоставляет список сценариев, которые обычно используются для определенного языкового стандарта.
-   [**Верифискриптс**](/windows/desktop/api/Winnls/nf-winnls-verifyscripts). Сравнивает списки скриптов. Чтобы проверить несколько языковых стандартов, приложение может выполнить несколько вызовов [**GetLocaleInfo**](/windows/desktop/api/Winnls/nf-winnls-getlocaleinfoa) или [**GetLocaleInfoEx**](/windows/desktop/api/Winnls/nf-winnls-getlocaleinfoex) и [**верифискриптс**](/windows/desktop/api/Winnls/nf-winnls-verifyscripts).

для приложений, работающих в Windows XP и Windows Server 2003, функции [**довнлевелжетлокалескриптс**](downlevelgetlocalescripts.md), [**довнлевелжетстрингскриптс**](downlevelgetstringscripts.md)и [**довнлевелверифискриптс**](downlevelverifyscripts.md) играют аналогичную роль в перечисленных выше функциях в целях уменьшения угроз безопасности. Загружаемые [API-интерфейсы Microsoft для международного доменного имени (IDN) по устранению проблем](https://www.microsoft.com/downloads/details.aspx?FamilyID=AD6158D7-DDBA-416A-9109-07607425A815&displaylang=en) доступны в [центре загрузки MSDN](https://www.microsoft.com/?ref=go).

## <a name="handle-unicode-strings"></a>Обрабатывайте строки в Юникоде

IDNA поддерживает преобразование строк Юникода в допустимые метки имен узлов, за исключением строк, содержащих определенные запрещенные символы, такие как управляющие символы, символы из закрытой области использования (PUA) и т. д. Приложение может использовать \_ \_ \_ правила STD3 ASCII \_ с флагами с несколькими функциями преобразования NLS для принудительного сбоя функций, если они обнаруживают символы ASCII, отличные от букв, цифр или знаков дефиса (-), или если строка начинается или заканчивается символом дефиса-минуса. Эти символы всегда запрещено использовать в доменных именах и остаются запрещенными в стандартном черном варианте.

## <a name="handle-unassigned-code-points"></a>Обработку неназначенных кодовых точек

IDNs не может содержать неназначенные кодовые точки. Таким образом, кодовые точки, не связанные с символом ("назначено") в Юникоде 3,2, не имеют определенных сопоставлений IDN, несмотря на то, что в \_ \_ некоторых функциях преобразования флаг IDN РАЗРЕШАЕТ неназначенные значения, позволяющий сопоставлять их с Punycode. Список неназначенных кодовых точек можно найти в [RFC 3454](http://www.faqs.org/rfcs/rfc3454.html).

> [!Caution]  
> Если приложение кодирует неназначенные кодовые точки как Punycode, результирующие имена доменов должны быть недопустимыми. Безопасность может быть скомпрометирована, если более поздняя версия IDNA делает эти имена юридическими или если приложение отфильтровывает недопустимые символы, чтобы попытаться создать юридическое имя домена.

 

Неназначенные кодовые точки не допускаются в хранимых строках, используемых в идентификаторах протоколов и именованных сущностях, таких как имена в цифровых сертификатах и компонентах доменных имен DNS. Однако кодовые точки разрешены в строках запроса, например, в именах, вводимых пользователем, для цифровых сертификатов и поисков DNS, которые используются для сопоставления с хранимыми идентификаторами.

> [!Caution]  
> Хотя строки запросов могут использовать неназначенные кодовые точки, их не следует использовать в приложениях. Даже строка запроса, предоставляемая пользователем, представляет собой риск атаки "подмена". При таком типе атак сайт узла неразборчивые перенаправляет пользователей с сайта, к которому они обращаются, к другому сайту, который может предоставить третьим лицам конфиденциальную информацию. Например, копирование строки из входящей электронной почты может представлять те же риски, что и щелчок по ссылке в браузере.

 

## <a name="convert-domain-names-to-ascii-names"></a>Преобразование доменных имен в имена ASCII

Приложение может использовать функцию [**иднтоасЦии**](/windows/desktop/api/Winnls/nf-winnls-idntoascii) и некоторые функции по устранению рисков для преобразования IDNS в ASCII.

> [!Caution]  
> Поскольку строки с очень разными двоичными представлениями могут сравниваться одинаково, эта функция может вызывать определенные проблемы безопасности. Дополнительные сведения см. в обсуждении функций сравнения в статье [вопросы безопасности: международные функции](security-considerations--international-features.md).

 

## <a name="examples"></a>Примеры

В [примере преобразования NLS: международного доменного имени (IDN)](nls--internationalized-domain-name--idn--conversion-sample.md) демонстрируется использование функций преобразования IDN. В [примере защиты NLS: международного доменного имени (IDN)](nls--internationalized-domain-name--idn--mitigation-sample.md) показано использование функций предотвращения использования IDN.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Поддержка национальных языков](using-national-language-support.md)
</dt> <dt>

[Вопросы безопасности: международные функции](security-considerations--international-features.md)
</dt> </dl>

 

 



