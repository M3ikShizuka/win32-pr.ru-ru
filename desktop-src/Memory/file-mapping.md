---
description: Сопоставление файлов — это привязка содержимого файла к части виртуального адресного пространства процесса.
ms.assetid: 86a8bc81-914d-46a2-99fd-65dfd03bbcdd
title: Сопоставление файлов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b7f49162a4545d0e087e6b291e429d89049dbf57
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127144401"
---
# <a name="file-mapping"></a>Сопоставление файлов

*Сопоставление файлов* — это привязка содержимого файла к части виртуального адресного пространства процесса. Система создает *объект сопоставления файлов* (также известный как *объект раздела*) для поддержки этой ассоциации. *Представление файлов* — это часть виртуального адресного пространства, используемая процессом для доступа к содержимому файла. Сопоставление файлов позволяет процессу использовать случайные входные и выходные данные (I/O) и последовательный ввод-вывод. Это также позволяет процессу эффективно работать с большим размером файла данных, например с базой данных, без необходимости сопоставлять весь файл в памяти. Для совместного использования данных в нескольких процессах также могут использоваться отображенные в памяти файлы.

Процессы считывают и записывают в представление файлов с помощью указателей так же, как и с динамически выделяемой памятью. Использование сопоставления файлов повышает эффективность, поскольку файл находится на диске, но представление файлов находится в памяти. Процессы также могут управлять представлением файла с помощью функции [**VirtualProtect**](/windows/win32/api/memoryapi/nf-memoryapi-virtualprotect) .

На следующем рисунке показана связь между файлом на диске, объектом сопоставления файлов и представлением файла.

![отношение между файлом на диске, объектом сопоставления файлов и представлением файла.](images/fmap.png)

Файл на диске может представлять собой любой файл, который необходимо преобразовать в память, или системный файл подкачки. Объект сопоставления файлов может состоять из всей или только части файла. Он поддерживается файлом на диске. Это означает, что когда система меняет местами страницы объекта сопоставления файлов, любые изменения, внесенные в объект сопоставления файлов, записываются в файл. Когда страницы объекта сопоставления файлов меняются местами, они восстанавливаются из файла.

Представление файла может состоять из всей или только части объекта сопоставления файлов. Процесс управляет файлом через представления файлов. Процесс может создать несколько представлений для объекта сопоставления файлов. Представления файлов, созданные каждым процессом, находятся в виртуальном адресном пространстве этого процесса. Если процессу требуются данные из части файла, отличной от того, что находится в текущем представлении файла, он может отменить сопоставление текущего представления файлов, а затем создать новое представление файла.

Если несколько процессов используют один и тот же объект сопоставления файлов для создания представлений для локального файла, данные согласованы. Это значит, что представления содержат идентичные копии файла на диске. Файл не может находиться на удаленном компьютере, если требуется совместное использование памяти несколькими процессами.

Дополнительные сведения см. в следующих разделах:

-   [Создание объекта сопоставления файлов](creating-a-file-mapping-object.md)
-   [Создание представления файлов](creating-a-file-view.md)
-   [Совместное использование файлов и памяти](sharing-files-and-memory.md)
-   [Чтение и запись в представлении файлов](reading-and-writing-from-a-file-view.md)
-   [Закрытие объекта сопоставления файлов](closing-a-file-mapping-object.md)
-   [Безопасность и права доступа для сопоставления файлов](file-mapping-security-and-access-rights.md)
-   [Использование сопоставления файлов](using-file-mapping.md)

 

 
