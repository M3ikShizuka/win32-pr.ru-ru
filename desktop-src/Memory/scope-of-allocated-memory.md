---
description: Вся память, выделенная процессом с помощью функций выделения памяти (Хеапаллок, VirtualAlloc, GlobalAlloc или Локалаллок), доступна только процессу.
ms.assetid: b47200dc-6824-4fd8-8d9f-2aaa439a74ff
title: Область выделенной памяти
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7f06b0ee3f9446962bb508c23d4c5542fd16168027c5913b63438d16b6cea910
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119067674"
---
# <a name="scope-of-allocated-memory"></a>Область выделенной памяти

Вся память, выделенная процессом с помощью функций выделения памяти ( [**хеапаллок**](/windows/desktop/api/HeapApi/nf-heapapi-heapalloc), [**VirtualAlloc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc), [**GlobalAlloc**](/windows/desktop/api/WinBase/nf-winbase-globalalloc)или [**локалаллок**](/windows/desktop/api/WinBase/nf-winbase-localalloc)), доступна только процессу. Однако память, выделенная библиотекой DLL, выделяется в адресном пространстве процесса, вызвавшего библиотеку DLL, и недоступен для других процессов, использующих ту же самую библиотеку DLL. Для создания общей памяти необходимо использовать сопоставление файлов.

Сопоставление именованных файлов предоставляет простой способ создания блока общей памяти. Процесс может указать имя, если в нем используется функция [**CreateFileMapping**](/windows/desktop/api/WinBase/nf-winbase-createfilemappinga) для создания объекта сопоставления файлов. Другие процессы могут указывать одно и то же имя для функции **CreateFileMapping** или [**OpenFileMapping**](/windows/desktop/api/WinBase/nf-winbase-openfilemappinga) , чтобы получить маркер объекта сопоставления.

Каждый процесс задает свой обработчик для объекта сопоставления файлов в функции [**MapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffile) , чтобы сопоставить представление файла с его собственным адресным пространством. Представления всех процессов для одного объекта сопоставления файлов сопоставлены с одними и теми же страницами физического хранилища. Однако виртуальные адреса сопоставленных представлений могут отличаться от одного процесса к другому, если только функция [**MapViewOfFileEx**](/windows/win32/api/memoryapi/nf-memoryapi-mapviewoffileex) не используется для сопоставления представления по указанному адресу. Несмотря на то, что страницы физического хранилища, используемые для сопоставленного представления файлов, можно использовать совместно, они не являются глобальными. они недоступны для процессов, которые не сопоставили представление файла.

Все страницы, зафиксированные путем сопоставления представления файла, освобождаются, когда последний процесс с представлением объекта сопоставления либо завершается, либо отменяет сопоставление представления путем вызова функции [**UnmapViewOfFile**](/windows/win32/api/memoryapi/nf-memoryapi-unmapviewoffile) . В настоящее время заданный файл (при наличии), связанный с объектом сопоставления, обновляется. Указанный файл также можно принудительно обновить, вызвав функцию [**флушвиевоффиле**](/windows/win32/api/memoryapi/nf-memoryapi-flushviewoffile) .

Дополнительные сведения см. в разделе [Сопоставление файлов](file-mapping.md). Пример общей памяти в библиотеке DLL см. [в разделе Использование общей памяти в библиотеке Dynamic-Link](../dlls/using-shared-memory-in-a-dynamic-link-library.md).

Если несколько процессов имеют доступ на запись к общей памяти, необходимо синхронизировать доступ к памяти. Дополнительные сведения см. в разделе [Синхронизация](../sync/synchronization.md).

 

 
