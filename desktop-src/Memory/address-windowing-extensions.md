---
description: Расширения AWE — это набор расширений, позволяющих приложению быстро управлять физической памятью более 4 ГБ.
ms.assetid: 48a29922-8130-4540-86b0-0faa120566a6
title: Расширения для окон адресов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b8cb311bf9ecef2de334018ca3f9982a31f0b072
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127144469"
---
# <a name="address-windowing-extensions"></a>Расширения для окон адресов

Расширения AWE — это набор расширений, позволяющих приложению быстро управлять физической памятью более 4 ГБ. Для некоторых приложений, интенсивно использующих данные, таких как системы управления базами данных и инженерных и инженерных программ, необходим доступ к очень большим кэшам данных. В случае с очень большими наборами данных ограничение размера кэша в пределах 2 ГБ адресного пространства пользователя является очень строгим. В таких ситуациях кэш слишком мал для правильной поддержки приложения.

AWE решает эту проблему, позволяя приложениям напрямую обращаться к большим объемам памяти, продолжая использовать 32-разрядные указатели. Расширения AWE позволяют приложениям иметь кэш данных размером более 4 ГБ (при наличии достаточного объема физической памяти). Расширения AWE используют физическую нестраничную память и представления окон различных частей физической памяти в пределах 32-битного виртуального адресного пространства.

Расширения AWE накладывают несколько ограничений на то, как может использоваться эта память, в первую очередь, потому что эти ограничения позволяют очень быстро сопоставлять, повторно сопоставлять и освобождать. Высокая скорость управления памятью важна для этих потенциально неогромных адресных пространств.

-   Диапазоны виртуальных адресов, выделенные для расширений AWE, не могут совместно обрабатываться другими процессами (и поэтому не наследуются). На самом деле два разных виртуальных адреса AWE в одном процессе не могут сопоставлять одну и ту же физическую страницу. Эти ограничения обеспечивают быстрое повторное сопоставление и очистку при освобождении памяти.
-   Физические страницы, которые могут быть выделены для области AWE, ограничены числом физических страниц, имеющихся на компьютере, так как эта память никогда не помещается в разбивку на страницы. она блокируется до тех пор, пока приложение явно не освободит его или не завершит работу. Физические страницы, выделенные для данного процесса, можно сопоставить с любой виртуальной областью AWE в рамках одного процесса. Приложения, использующие расширения AWE, должны быть внимательны, чтобы не занимать настолько много физической памяти, что они приводят к чрезмерной нагрузке на другие приложения или препятствуют созданию новых процессов или потоков из-за нехватки ресурсов. Используйте функцию [**глобалмемористатусекс**](/windows/win32/api/sysinfoapi/nf-sysinfoapi-globalmemorystatusex) для отслеживания использования физической памяти.
-   Виртуальные адреса AWE всегда доступны для чтения и записи и не могут быть защищены посредством вызовов [**VirtualProtect**](/windows/win32/api/memoryapi/nf-memoryapi-virtualprotect) (т. е. нет памяти только для чтения, недоступна память, страницы защиты и т. д.).
-   Диапазоны адресов AWE нельзя использовать для буферизации данных для видеоадаптеров или видеовызовов.
-   Диапазон памяти AWE не может быть разделен, и его части нельзя удалить. Вместо этого весь диапазон виртуальных адресов должен быть удален как единица, если требуется удаление. Это означает, что при вызове [**VirtualFree**](/windows/win32/api/memoryapi/nf-memoryapi-virtualfree)необходимо указать **\_ выпуск MEM** .
-   Приложения могут сопоставлять несколько регионов одновременно, если они не перекрываются.
-   Приложения, использующие расширения AWE, не поддерживаются в режиме эмуляции. Это значит, что приложение x86, использующее функции AWE, должно быть перекомпилировано для запуска на другом процессоре, в то время как большинство приложений могут выполняться без перекомпиляции в эмуляторе на других платформах.

Это решение устраняет проблемы физической памяти в очень общем и широко применимом способе. Ниже перечислены некоторые преимущества расширений AWE.

-   Для обработки памяти AWE определена небольшая группа новых функций.
-   Расширения AWE обеспечивают очень быструю возможность повторного сопоставления. Повторное сопоставление выполняется путем манипулирования таблицами виртуальной памяти, а не перемещением данных в физическую память.
-   Расширения AWE обеспечивают гранулярность размера страницы, соответствующую процессору (например, 4 КБ на x86), что более полезно для приложений, чем большие страницы (например, 2 МБ или 4 МБ на платформе x86).

Для использования расширений AWE приложение должно иметь разрешение Блокировка страниц в памяти. Чтобы получить эту привилегию, администратор должен добавить **блокировку страниц в памяти** в **назначения прав пользователя**. Дополнительные сведения о том, как это сделать, см. в разделе "права пользователя" справки по операционной системе.

Следующие функции составляют API расширений AWE.



| Функция                                                                          | Описание                                                                                                                                                                                                                                               |
|-----------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**VirtualAlloc**](/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc) и [ **виртуалаллоцекс**](/windows/win32/api/memoryapi/nf-memoryapi-virtualallocex) | Зарезервируйте часть виртуального адресного пространства, используемую для расширений AWE, с помощью функции **mem \_ PHYSICAL**.                                                                                                                                                                       |
| [**аллокатеусерфисикалпажес**](/windows/win32/api/memoryapi/nf-memoryapi-allocateuserphysicalpages)                    | Выделение физической памяти для использования с расширениями AWE.                                                                                                                                                                                                                |
| [**мапусерфисикалпажес**](/windows/win32/api/memoryapi/nf-memoryapi-mapuserphysicalpages)                              | Сопоставьте виртуальные адреса AWE (или сделает их недействительными) с любым набором физических страниц, полученных с помощью [**аллокатеусерфисикалпажес**](/windows/win32/api/memoryapi/nf-memoryapi-allocateuserphysicalpages).                                                                                                    |
| [**мапусерфисикалпажесскаттер**](/windows/desktop/api/WinBase/nf-winbase-mapuserphysicalpagesscatter)                | Сопоставьте виртуальные адреса AWE (или сделает их недействительными) с любым набором физических страниц, полученных с помощью [**аллокатеусерфисикалпажес**](/windows/win32/api/memoryapi/nf-memoryapi-allocateuserphysicalpages), но с более детализированным контролем, чем предоставлено [**мапусерфисикалпажес**](/windows/win32/api/memoryapi/nf-memoryapi-mapuserphysicalpages). |
| [**фриусерфисикалпажес**](/windows/win32/api/memoryapi/nf-memoryapi-freeuserphysicalpages)                            | Свободная физическая память, используемая для расширений AWE.                                                                                                                                                                                                               |



 

 

 
