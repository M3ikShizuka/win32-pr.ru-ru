---
title: Использование интерфейсов IADs
description: ADSI каждый элемент службы каталогов представлен объектом ADSI, который представляет собой объект модели COM, поддерживающий стандартный интерфейс IUnknown COM, а также интерфейсы IDispatch и IADs.
ms.assetid: bdbf2012-6863-4611-8173-6a3cd9c4960f
ms.tgt_platform: multiple
keywords:
- IADs ADSI, использование
- ADSI ADSI, использование, использование интерфейсов IADs
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 878afa9350a45f18238bebb69df1a96eba52715e
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "104413744"
---
# <a name="using-the-iads-interfaces"></a>Использование интерфейсов IADs

ADSI каждый элемент службы каталогов представлен объектом ADSI, который представляет собой объект модели COM, поддерживающий стандартный интерфейс [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) com, а также интерфейсы [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) и [**iAds**](/windows/desktop/api/Iads/nn-iads-iads) . Функция **iAds** предоставляет основные функции обслуживания для объектов ADSI.

Каждый объект ADSI должен поддерживать этот интерфейс, который служит для:

-   Укажите идентификатор объекта по имени, классу или ADsPath.
-   Определяет контейнер объектов, который управляет созданием и удалением объектов.
-   Получите определение схемы объекта.
-   Загрузите атрибуты объекта в кэш свойств и зафиксируйте изменения в хранилище постоянного каталога.
-   Доступ к значениям атрибута объекта и их изменение в кэше свойств.

Интерфейс [**iAds**](/windows/desktop/api/Iads/nn-iads-iads) предназначен для того, чтобы объекты ADSI предоставляющих сетевым администраторам и поставщикам служб каталогов эффективное и устойчивое представление различных базовых служб каталогов.

![объект ADSI, поддерживающий интерфейс iAds](images/ds2iads.png)

На предыдущем рисунке показан универсальный объект ADSI, поддерживающий фундаментальные интерфейсы [**iAds**](/windows/desktop/api/Iads/nn-iads-iads), [**иадспропертилист**](/windows/desktop/api/Iads/nn-iads-iadspropertylist), [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), [**идиректорйобжект**](/windows/desktop/api/Iads/nn-iads-idirectoryobject)и [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch). Объект ADSI, такой как, управляет данными из хранилища данных базовой службы каталогов через интерфейсы, которые она поддерживает. Эти данные называются свойствами объекта, а подпрограммы, которые получают и задают эти свойства, называются методами свойств. Свойства только для чтения имеют один метод свойства, который получает значение свойства. Свойства чтения и записи имеют два метода: метод, который задает значение и одно из них, которое получает значение. Свойства реализуются для каждого объекта ADSI с помощью [кэша свойств](the-adsi-attribute-cache.md). [**IAds:: Get \_ ADsPath**](iads-property-methods.md) и **IADs::p UT \_ ADsPath** — примеры методов свойств. Методы свойств не являются очевидными для Visual Basic и других клиентов автоматизации, которые обеспечивают прямые ссылки на свойство. Например, Visual Basic ссылается на **iAds:: ADsPath** непосредственно с использованием синтаксиса **Object. ADsPath** . Дополнительные сведения см. в разделе [методы свойств интерфейса](interface-property-methods.md).

Кроме того, объект ADSI взаимодействует с другими объектами ADSI и напрямую с пространством имен с помощью методов. Методы выполняются немедленно. Примеры методов включают в себя [**iAds:: сетинфо**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) и [**iAds:: info**](/windows/desktop/api/Iads/nf-iads-iads-getinfo).

Доступ к свойствам, методам свойств и методам осуществляется через стандартные интерфейсы COM.

Объект ADSI однозначно идентифицируется по его ADsPath. Например, путь к пространству имен LDAP — «LDAP://MyServer/DC=Fabrikam,DC=COM». Дополнительные сведения о Адспасс см. в разделе [Привязка ADSI](binding-to-an-adsi-object.md). Для программистов, знакомых с моникерами COM, это концептуально похоже на отображаемое имя моникера COM.

Любой объект ADSI, который содержит другие объекты ADSI, называемый объектом контейнера ADSI, также поддерживает интерфейс [**иадсконтаинер**](/windows/desktop/api/Iads/nn-iads-iadscontainer) , предоставляющий методы и свойства, управляющие созданием, удалением и перечислением объектов ADSI, содержащихся в объекте. На следующем рисунке показан объект контейнера ADSI.

![Объект контейнера ADSI](images/dsiadsc.png)

Большинство объектов ADSI содержатся в других объектах. Единственным объектом ADSI без родительского контейнера является объект **пространств имен** ADSI верхнего уровня ("ADS:").

Метод [**iAds:: сетинфо**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) объекта-контейнера постоянно сохраняет кэшированные свойства объекта контейнера ADSI в хранилище в дополнение к любым объектам, созданным с помощью метода [**Иадсконтаинер:: Create**](/windows/desktop/api/Iads/nf-iads-iadscontainer-create) . [**Иадсконтаинер::D удалить**](/windows/desktop/api/Iads/nf-iads-iadscontainer-delete) не влияет на кэш свойств, но удаляет базовый элемент каталога пространства имен, представленный этим объектом.

 

 