---
title: Проблемы проверки подлинности для ADSI с ASP
description: В зависимости от конфигурации интрасети, при запуске кода ADSI из страницы ASP могут возникнуть проблемы с проверкой подлинности.
ms.assetid: 287e2e19-7da9-497b-bf46-595ff4755261
ms.tgt_platform: multiple
keywords:
- ADSI, страницы ASP, проблемы проверки подлинности
- ADSI, проверка подлинности, проблемы ASP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 423d1aa39006f89ca366423da9d135e00af45693
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "103793801"
---
# <a name="authentication-issues-for-adsi-with-asp"></a>Проблемы проверки подлинности для ADSI с ASP

В зависимости от конфигурации интрасети, при запуске кода ADSI из страницы ASP могут возникнуть проблемы с проверкой подлинности.

Проверка подлинности для доступа к контроллеру домена может быть предоставлена с помощью делегирования. Делегирование позволяет службе работать в качестве пользователя, поэтому она может получить доступ к сетевому ресурсу с помощью учетных данных пользователя. Если ваша интрасеть соответствует этой конфигурации, необходимо настроить IIS для использования делегирования. Установите механизм проверки подлинности IIS как анонимный или NTLM. Если выбран параметр анонимный, то контекст безопасности будет сопоставлен с \_ учетной записью компьютера IUSR. При выборе NTLM контекст безопасности изменится в зависимости от того, какой пользователь входит в систему на веб-сайте. Дополнительные сведения и инструкции по настройке сервера IIS для делегирования см. в разделе [Windows 2000 Resource Kit](https://support.microsoft.com/kb/927229).

Если используется сервер IIS, использующий запрос или ответ NT, или клиент браузера, не поддерживающий Kerberos, то проверка подлинности с двойным прыжком не поддерживается. Проверка подлинности с двойным прыжком означает, что учетные данные пользователя передаются с клиента браузера на сервер IIS, а затем сервер IIS передает учетные данные на внутренний сервер. В этом случае можно использовать одно из следующих решений, чтобы разрешить доступ к каталогу со страницы ASP:

-   Используйте [**иадсопендсобжект:: опендсобжект**](/windows/desktop/api/Iads/nf-iads-iadsopendsobject-opendsobject) или [**ADsOpenObject**](binding-with-adsopenobject-and-iadsopendsobject-opendsobject.md) для передачи учетных данных в Active Directory. На веб-странице выполняется проверка подлинности подключенного пользователя к серверу IIS. После проверки подлинности пользователя веб-страница может использовать Опендсобжект или ADsOpenObject для передачи имени пользователя и пароля в службу каталогов для получения проверки подлинности на внутреннем сервере. Затем веб-страница может получить доступ к данным из каталога.
-   Добавьте код в COM-объект и помещайте этот объект в [приложение COM+](../cossdk/com--application-overview.md) (которое ранее называлось пакетом MTS). Затем приложение COM+ можно запустить от имени [учетной записи пользователя домена](/windows/desktop/AD/domain-user-accounts).
-   Используйте несколько страниц ASP, где одна страница проверяет подлинность клиента, а другая страница передает учетные данные в каталог, используя анонимную проверку подлинности для учетной записи пользователя домена.

Эти методы подразумевают проверку подлинности веб-клиента, а затем изменяют учетные данные при обращении к каталогу, так как проверка подлинности с двойным прыжком с теми же учетными данными невозможна.

 

 