---
title: Преимущества использования расширений ADSI
description: Способ реализации методов расширения зависит от модуля записи расширений.
ms.assetid: dbd1a203-b94c-4739-8c9d-aed1c9b43426
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e27e80e6c095fcc02ca02c57b0987d1e6ed410ff
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104067335"
---
# <a name="benefits-of-using-adsi-extensions"></a>Преимущества использования расширений ADSI

Способ реализации методов расширения зависит от модуля записи расширений. Модуль записи расширений может даже реализовать метод полностью вне области действия каталога. Например, разработчику резервных копий и восстановления программных планов можно расширить объект с именем **Computer**. Разработчик должен создать два метода: **резервное копирование** и **Восстановление**. Эти методы работают удаленно на физическом компьютере, на который указывает объект **компьютера** в каталоге. Выполняя роль расширения, компонент обращается к инфраструктуре ADSI и просматривается клиентами ADSI как неотъемлемой частью объекта.

В следующих сценариях описываются ситуации, когда создание расширения для ADSI будет выгодно:

-   Создайте расширение для интеграции компонента с объектом каталога. Поскольку в каталоге имеется объект **пользователя** , РАЗРАБОТЧИКУ отдела кадров может потребоваться создать расширение ADSI, которое заполняет другие данные в каталоге при создании **пользователя** .
-   Создайте расширение, если для компонента требуется поиск в каталоге. Компоненту может потребоваться каталог в качестве отправной точки для поиска. Например, при создании нового приложения. Объект приложения **тулапп** можно опубликовать в каталоге. Приложение может поддерживать уведомления о состоянии для коллекции почтовых серверов. Вы решили сделать это приложение расширением ADSI.

    Теперь пользователь может искать все экземпляры **тулапп** в каталоге. Для каждого возвращаемого объекта пользователь может выдать вызов **нотифинов ()**. Приложение или расширение может получать в каталоге больше текущих данных объектов и уведомлять каждый сервер асинхронно.

-   Создайте расширение как соединение между пространствами имен и моделями программирования. Например, ISV проводит новую объектную модель для служб печати. Объект **очереди печати** уже определен в каталоге. Независимый поставщик программного обеспечения может создать расширение ADSI и связать его с объектом **очереди печати** . Пользователи ADSI могут выполнить привязку к объекту **очереди печати** и начать использовать объектную модель для независимого поставщика программного обеспечения. С точки зрения клиента ADSI эта точка соединения прозрачна.
-   Создайте расширение для упрощения задач. Многие задачи в каталоге могут быть выполнены путем поиска и установки нескольких атрибутов в объекте или нескольких объектах. Создание одной функции для управления несколькими атрибутами упрощает разработку для модулей записи приложений и сценариев.

Расширения для клиентов ADSI расширяют среду программирования ADSI несколькими способами:

-   Разработчикам, создающим клиенты ADSI, не нужно изучать новую модель программирования. Расширения являются частью ADSI. Они будут использовать ту же парадигму для поиска, обработки данных и защиты объектов.
-   Администраторы могут управлять связанными приложениями, поддерживающими каталоги, с помощью расширений.
-   Потребители расширений могут просматривать объект ADSI и расширение как один интегрированный объект.
-   Существующие компоненты могут быть интегрированы с интерфейсом ADSI, что позволяет расширениям использовать существующие инвестиции и создавать взаимосвязи между компонентами.

Расширения ADSI разработаны со следующими целями:

-   Простота реализации. С текущими существующими технологиями Майкрософт, системой разработки Microsoft Visual C++ и библиотекой активных шаблонов можно быстро создать расширение.
-   Клиенты просматривают один IDispatch. С точки зрения сценариев и модулей записи автоматизации, методы и свойства расширения прозрачно смешиваются в один объект ADSI.
-   Независимых. Модули записи расширений могут независимо расширять интерфейсы ADSI без предварительного знания существующих расширений.

Рассмотрим этот сценарий: корпоративному разработчику или поставщику программного обеспечения требуется разработать программу резервного копирования. Это приложение резервного копирования позволяет администратору выполнять резервное копирование всех компьютеров в подразделении. С расширением ADSI возможны следующие сценарии.


```VB
Dim ou
On Error Resume Next
Set ou = GetObject("LDAP://OU=Sales, DC=Fabrikam, DC=COM")
If Err.Number<>0 Then
    MsgBox("An error has occurred.")
    Err.Clear
    Set ou = Nothing
    Exit Sub
End If

ou.Filter = Array("computer")

For each comp in ou
   Debug.Print comp.Get("networkAddress")
   Debug.Print comp.LastBackUp
   comp.BackUpNow
Next
```



**Ластбаккуп** — это свойство, а **кнопка** — это метод, предоставляемый модулем записи расширений. В коде показаны преимущества для потребителей и поставщиков расширений. Модуль записи расширений не должен создавать новый способ фильтрации, поиска и доступа к каталогу. Потребителю расширения не нужно переучить новую парадигму программирования. Новые методы и свойства, предоставляемые модулем записи расширений, просматриваются как часть ADSI.

 

 




