---
title: Синтаксис атрибутов ADSI
description: С каждым атрибутом в каталоге связан синтаксис. Например, целое число, строка, число и т. д. ADSI определяет собственный синтаксис, соответствующий синтаксису собственного каталога. В этом разделе описываются типы синтаксиса атрибутов в ADSI.
ms.assetid: 83d3d42f-e35e-4bd1-b26e-d141e9ec9c31
ms.tgt_platform: multiple
keywords:
- атрибуты ADSI, синтаксис
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 310a678c48051909e4a3e7555b9d8ff0a508c339cfcd41ed6c66286529cadde1
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119023932"
---
# <a name="adsi-attribute-syntax"></a>Синтаксис атрибутов ADSI

С каждым атрибутом в каталоге связан синтаксис. Например, целое число, строка, число и т. д. ADSI определяет собственный синтаксис, соответствующий синтаксису собственного каталога. В этом разделе описываются типы синтаксиса атрибутов в ADSI.

## <a name="distinguished-name-string"></a>Строка различающегося имени


```VB
Syntax Type: ADSTYPE_DN_STRING
```



Различающееся имя удобно использовать для связи между двумя объектами. Например, он может создать ссылку, которая делает объект Алисы диспетчером объекта Bob. Если объект Алисы перемещается в другое место, ссылка на диспетчер между Алисой и Бобом обновляется автоматически.

Различающееся имя должно содержать допустимый объект различающегося имени. Если различающееся имя не соответствует допустимому существующему объекту, большинство серверов отклоняет запрос и возвращает ошибку нарушения ограничения.

Примеры:


```VB
Set x = GetObject("LDAP://CN=Bob, OU=Sales,DC=Fabrikam, DC=com)
x.Put "manager", "CN=Alice, OU=Sales, DC=Fabrikam, DC=COM"
x.SetInfo
 
PADS_ATTR_INFO pInfo;
// .. IDirectoryObject::GetObjectAttribute
printf("%S\n", pInfo->pADsValues->DNString );
```



## <a name="case-exact-string-and-case-ignore-string"></a>Строка с точным регистром и регистром символов


```VB
Syntax Types: ADSTYPE_CASE_IGNORE_STRING, ADSTYPE_CASE_EXACT_STRING.
```



Точная строка Case учитывает регистр, а строка без учета регистра не учитывает регистр. Этот синтаксис используется в больших процентах атрибутов в каталоге.

> [!Note]  
> Каталог может или не может хранить его как строку в Юникоде. Однако ADSI принимает и возвращает строки в Юникоде.

 

Пример


```VB
Dim propList As IADsPropertyList
Set propList = GetObject("LDAP://DC=Fabrikam,DC=com")
Set propVal = New PropertyValue
 
' --- Property Value ---
propVal.CaseIgnoreString = "Fabrikam, Inc - Seattle, WA"
propVal.ADsType = ADSTYPE_CASE_IGNORE_STRING
```



## <a name="printable-string"></a>Печатная строка


```VB
Syntax Type: ADSTYPE_PRINTABLE_STRING
```



Этот синтаксис используется для атрибутов со строковыми значениями, где прописные и строчные буквы считаются неравными для сравнений, например, "FABRIKAM" и "Fabrikam" не совпадают. ADSI принимает любое содержимое для печатной строки; Он не пытается проверить, действительно ли они доступны для печати.

## <a name="numeric-string"></a>Числовая строка


```VB
Syntax Type: ADSTYPE_NUMERIC_STRING
```



В этом синтаксисе строки совпадают, как в печатной строке, за исключением того, что все символы пробела игнорируются в сравнениях. ADSI не выполняет проверку значений, чтобы убедиться в том, что в значениях этого синтаксиса отображаются только цифры и пробелы. Active Directory принимает любое содержимое для числовой строки; Он не проверяет, являются ли символы числовыми.

## <a name="utc-time"></a>Время в формате UTC


```VB
Syntax Type: ADSTYPE_UTC_TIME
```



Этот синтаксис сохраняет дату и время в одной строке. Строковый формат состоит из трех Объединенных частей: (1) YYMMDD; (2) ЧЧММ или ЧЧММСС (оба допустимы); и (3) "Z", чтобы указать, что заданное время является временем по Гринвичу (GMT), или "+/-ХХММ", чтобы указать, что указанное время является местным временем с заданной разностной копией по ГРИНВИЧу. Разностное резервное копирование основано на формуле: GMT = Local + DIFFERENTIAL.

> [!Note]  
> Первые две цифры года не хранятся в этой строке.

 

Примерами допустимых значений являются "9101311455Z", "910131145503Z", "9101314455-0500", "910131145503 + 0130". Эта строка хранится в виде однобайтовых символов ASCII, и с ней не хранится номер кодовой страницы.

Хотя сортировка поддерживается, она выполняется только в виде строки, учитывающей регистр символов ASCII, а не с помощью правильного интерпретации значения строк.

Принимается любое допустимое строковое значение. Не предпринимается попытка убедиться, что строка содержит допустимую строку времени.

## <a name="generalized-time"></a>Обобщенное время


```VB
Syntax Type: ADSTYPE_UTC_TIME
```



Если определен новый атрибут для хранения значений времени, следует использовать синтаксис Женерализедтиме. Синтаксис Женерализедтиме использует четыре символа для представления года вместо двух, как в Утктиме.

Формат синтаксиса Женерализедтиме — "YYYYMMDDHHMMSS. 0Z". Примером допустимого значения является "20010928060000.0 Z". "Z" обозначает отсутствие разностного времени. Active Directory сохраняет дату и время как среднее время по Гринвичу (GMT). Если значение времени не указано, по умолчанию используется значение GMT.

Если время указано в часовом поясе, отличном от GMT, то разностное соединение между часовым поясом и GMT добавляется к строке вместо «Z» в формате «YYYYMMDDHHMMSS. 0 \[ +/- \] ЧЧММ». Пример допустимого значения: "20010928060000.0 + 0200".

Разностное резервное копирование основано на формуле: GMT = Local + DIFFERENTIAL.

## <a name="boolean"></a>Логическое


```VB
Syntax Type: ADSTYPE_BOOLEAN
```



Active Directory принимает для этого синтаксиса только 32-разрядное значение со знаком. Он обрабатывает нуль как **false** и все ненулевые значения как **true**.

## <a name="integer"></a>Целочисленный тип


```VB
Syntax Type: ADSTYPE_INTEGER
```



32-разрядное числовое значение со знаком.

## <a name="large-integer"></a>Большое целое число


```VB
Syntax Type: ADSTYPE_LARGE_INTEGER
```



64-разрядное числовое значение со знаком. Большие целые числа фактически реализуются как COM-объекты в интерфейсе [**иадсларжеинтежер**](/windows/desktop/api/Iads/nn-iads-iadslargeinteger) . Методы **хигхпарт** и **ловпарт** используются для доступа к 2 32-разрядным половинам длинного целочисленного значения.

Пример


```VB
Dim x as IADsLargeInteger
Set o = GetObject("LDAP://DC=Fabrikam,DC=com")
Set x = o.Get("UsnCreated")
Debug.Print x.HighPart
Debug.Print x.LowPart
```



## <a name="octet-string"></a>Строка октета


```VB
Syntax Type: ADSTYPE_OCTET_STRING
```



Строка октета возвращается в виде массива вариантов байтов. Это количество октетов, за которыми следует ряд октетов. Октет — это 8-разрядный байт, поэтому последовательность октетов представляет собой строку двоичных данных.

## <a name="object-class"></a>Класс объекта


```VB
Syntax Type: ADSTYPE_CASE_IGNORE_STRING
```



Класс объекта является уникальным идентификатором объекта для данного класса схемы. Класс каждого экземпляра объекта определяется атрибутом **objectClass** . При создании можно никогда не изменять класс объекта. **objectClass** является многозначным атрибутом. Он перечисляет конкретный класс объекта и классы всех структурных или абстрактных классов, из которых был получен конкретный класс. Сюда входит Top, класс, из которого все остальные классы в конечном итоге являются производными. В Active Directory не перечислены вспомогательные классы в атрибуте **objectClass** .

## <a name="security-descriptor"></a>Дескриптор безопасности


```VB
Syntax Type: ADSTYPE_NT_SECURITY_DESCRIPTOR
```



Права доступа определяют, какие возможности имеет субъект безопасности при попытке выполнить операцию с объектом Active Directory. Дескриптор безопасности описывает сведения об управлении доступом, связанные с объектом.

Дескриптор безопасности хранится как свойство объекта каталога в свойстве **нтсекуритидескриптор** . Когда прошедший проверку подлинности пользователь пытается получить доступ к объекту каталога, сервер каталогов определяет предоставленный или запрещенный ему доступ на основе дескриптора безопасности объекта.

Перечисление [**\_ \_ элементов \_ управления SD в ADS**](/windows/win32/api/iads/ne-iads-ads_sd_control_enum) определяет флаги управления для дескриптора безопасности.

В следующем примере кода показано, как получить дескриптор безопасности.


```VB
' Obtain a security descriptor.
Dim x as IADs
Dim sd as IADsSecurityDescriptor
Dim acl as IADsAccessControlList
 
Set x = GetObject("LDAP://DC=Fabrikam, DC=com")
Set sd = x.Get("nTSecurityDescriptor")
 
Debug.Print sd.Control
Debug.Print sd.Group
Debug.Print sd.Owner
Debug.Print sd.Revision
 
Set acl = sd.DiscretionaryAcl
Set sacl = sd.SystemAcl
```



## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Синтаксис для атрибутов Active Directory](/windows/desktop/AD/syntaxes-for-attributes-in-active-directory-domain-services)
</dt> <dt>

[Выбор синтаксиса](/windows/desktop/AD/choosing-a-syntax)
</dt> <dt>

[Как указать значения для сравнения](/windows/desktop/AD/how-to-specify-comparison-values)
</dt> </dl>

 

 