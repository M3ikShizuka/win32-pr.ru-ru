---
title: Получение больших наборов результатов
description: Если существует вероятность того, что возвращаемый результирующий набор будет содержать более 1000 элементов, необходимо использовать поиск на странице.
ms.assetid: 1439d6b8-50dd-4d37-bcc9-dd0f63af865f
ms.tgt_platform: multiple
keywords:
- Получение списка больших наборов результатов ADSI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 78f8902d25010690953cfae8a03ff9e500b4ebda
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "105654108"
---
# <a name="retrieving-large-results-sets"></a>Получение больших наборов результатов

Если существует вероятность того, что возвращаемый результирующий набор будет содержать более 1000 элементов, необходимо использовать поиск на странице. Поиск Active Directory, выполненных без разбиения на страницы, ограничивается возвратом максимум из первых 1000 записей. При поиске с постраничным поиском результирующий набор представляется отдельными страницами, каждый из которых содержит предварительно определенное количество записей результатов. При таком типе поиска новые страницы результирующих записей возвращаются до тех пор, пока не будет достигнут конец результирующего набора.

По умолчанию сервер, отвечающий на запрос запроса, полностью вычисляет результирующий набор перед возвратом данных. В большом результирующем наборе для этого требуется память сервера, так как получен результирующий набор, и пропускная способность сети при возвращении большого результата. Установка размера страницы позволяет серверу отправить данные на страницах во время построения страниц. Затем клиент кэширует эти данные и предоставляет курсор на код уровня приложения. Подкачка настраивается путем определения количества строк, которые сервер вычисляет перед возвратом данных по сети клиенту.

Страничный поиск обеспечивает преимущества для клиента и сервера. Например, клиент может более быстро реагировать на представление результатов для конечных пользователей. Это особенно важно для графических средств пользовательского интерфейса, которые могут отображать данные, в то время как другой поток одновременно получает больше данных от сервера.

При настройке запроса при указании порядка сортировки для результирующего набора сервер должен полностью вычислить результирующий набор перед возвратом данных клиенту, что влияет на время отклика для запроса.

На стороне сервера страничный поиск делает операцию масштабируемой. Например, если 100 Клиенты выдают запросы на поиск одновременно и, в среднем, каждый клиент возвращает 200 объектов, если размер страницы не указан, сервер должен иметь достаточно памяти для хранения полного результирующего набора записей по 20 000. Кроме того, если каждый клиент указал размер страницы в десять объектов, требования к памяти на сервере будут снижены до 20.

> [!Note]  
> Не все службы каталогов поддерживают страничный поиск. Active Directory реализует архитектуру размера страницы.

 

Многие серверы каталогов задают административное ограничение для максимального числа объектов, которые они могут возвращать, если клиент не указал размер страницы. При достижении ограничения по администрированию ADSI формирует **\_ \_ \_ \_ превышение лимита администратора DS** с ошибкой Win32.

На стороне клиента страничный поиск позволяет клиенту прерывать операцию, пока она все еще выполняется. В отличие от этого, при нестраничном поиске клиент блокируется до тех пор, пока данные не будут полностью возвращены или произойдет ошибка. Это может повлиять на производительность сети, если результирующий набор оказывается больше и занимает больше времени, чем ожидалось.

От имени клиента ADSI обрабатывает размер страницы прозрачно. Клиенту не нужно подсчитывать количество выполняемых объектов. ADSI инкапсулирует взаимодействие сервера для клиента. С точки зрения клиента, поиск возвращает полный результирующий набор.

Дополнительные сведения об использовании параметра "искать время ожидания" с конкретным интерфейсом поиска см. в следующих статьях:

-   [Подкачка с помощью IDirectorySearch](paging-with-idirectorysearch.md)
-   [Поиск с помощью объекты данных ActiveX](searching-with-activex-data-objects-ado.md)
-   [Поиск с помощью OLE DB](searching-with-ole-db.md)

Страничный поиск прозрачен для приложения, так как ADSI автоматически получает дополнительные страницы результатов, пока не достигнет конца результирующего набора или окончания заданного предела времени. При использовании страничного поиска предельный размер не переопределяет размер страницы. Ограничение размера можно использовать только при получении результирующего набора, содержащего менее 1000 записей.

 

 




