---
title: Интеграция расширений в ADSI
description: Рекомендации, описывающие взаимодействие ADSI с расширениями.
ms.assetid: 00301551-ec56-4cb4-8e77-264c3ad48814
ms.tgt_platform: multiple
keywords:
- расширения ADSI
- ADSI и расширения
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 956a76954851ea54b4eae99bfa45102a3b2fefa5
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "104070617"
---
# <a name="how-adsi-integrates-extensions"></a>Интеграция расширений в ADSI

Следующие рекомендации описывают взаимодействие ADSI с расширениями.

-   Что-то связано с объектом каталога ADSI. Например, "LDAP://кН = Жеффсмис, OU = Sales, DC = Fabrikam, DC = COM".
-   ADSI определяет, что объект находится в классе **User** .
-   ADSI выполняет поиск в реестре и определяет расширения CLSID для **пользователя**. Имейте в виду, что ADSI кэширует эти данные.
-   Что-то вызывает метод **QueryInterface** для IID \_ имекстенсион. ADSI ищет интерфейсы, связанные с объектом **пользователя** , начиная с собственных интерфейсов, а затем анализируя интерфейсы расширения.
-   Если найдено совпадение, ADSI создает экземпляр компонента, который поддерживает IID \_ имекстенсион, и вызывает **QueryInterface** для расширения. Полученный интерфейс возвращается.
-   Пользователь использует этот интерфейс для вызова методов интерфейса.
-   Затем клиент вызывает **QueryInterface** для IID \_ ийаурекстенсион, который находится в другом компоненте. Этот компонент делегирует этот вызов **QueryInterface** интерфейсу [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) агрегатора, который, в свою очередь, является самим ADSI.
-   Опять же, ADSI ищет интерфейсы и создает экземпляр компонента.

 

 