---
title: Модель схемы ADSI
description: Схема похожа на словарь в том, что она содержит определение каждого типа объекта, известного службе каталогов.
ms.assetid: 70561a11-1560-4b1c-a999-e2a7b2002ab0
ms.tgt_platform: multiple
keywords:
- ADSI модель схемы ADSI
- ADSI ADSI, о программе, схема
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4893151c81eefa0a17420e18d5d87da232641571
ms.sourcegitcommit: 61a4c522182aa1cacbf5669683d9570a3bf043b2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/26/2021
ms.locfileid: "122883881"
---
# <a name="adsi-schema-model"></a>Модель схемы ADSI

Схема похожа на словарь в том, что она содержит определение каждого типа объекта, известного службе каталогов. Клиентские приложения ADSI могут просматривать схему для обнаружения функций любой конкретной реализации ADSI. Кроме того, ADSI предоставляет интерфейсы управления схемой, которые можно использовать для взаимодействия с базовой схемой службы каталогов.

Некоторые схемы являются расширяемыми, поставщики ADSI или сторонние поставщики могут выбрать публикацию новых интерфейсов или дополнительных свойств для существующих интерфейсов. Клиенты ADSI используют эти данные, чтобы определить, какие функции поддерживаются для каждой службы каталогов.

Существует три вида объектов схемы: классы, свойства и синтаксис, каждый из которых поддерживает интерфейсы управления схемой [**иадскласс**](/windows/desktop/api/Iads/nn-iads-iadsclass), [**иадспроперти**](/windows/desktop/api/Iads/nn-iads-iadsproperty)и [**иадссинтакс**](/windows/desktop/api/Iads/nn-iads-iadssyntax).

> [!Note]  
> Класс является перегруженным термином. Существуют классы C++, классы Java, классы COM и классы ADSI. В этом документе класс Word, если иное не является квалифицированным, ссылается на категорию или тип объекта схемы.

 

ADSI абстрагирует схему каждой службы каталогов и помещает ее в каждый корневой узел верхнего уровня в объекте **Namespace** . Чтобы определить, какие классы поддерживает служба каталогов на данном корневом узле, необходимо перечислить объект схемы и получить список объектов класса, объектов свойств и объектов синтаксиса. Дополнительные сведения см. [в разделе Использование схемы ADSI](using-the-adsi-schema.md).

## <a name="adsi-ldap-provider-schema-cache"></a>Кэш схемы поставщика LDAP ADSI

Поставщик LDAP для ADSI пытается кэшировать данные схемы на локальном компьютере. Подсхема определяется различающимся именем, хранящимся в атрибуте [**субсчемасубентри**](/windows/desktop/ADSchema/a-subschemasubentry) , расположенном в корне службы каталогов Enterprise (RootDSE). Помимо предоставления данных о подсхеме серверы LDAP V3 должны предоставлять атрибут [**модифитиместамп**](/windows/desktop/ADSchema/a-modifytimestamp) , который используется для определения времени последнего изменения схемы.

Когда ADSI сначала выполняет привязку к серверу LDAP, он получает данные о подсхеме с помощью атрибута [**субсчемасубентри**](/windows/desktop/ADSchema/a-subschemasubentry) . Если ADSI обнаруживает объект подсхемы, он сохраняет указатель на данные в реестре на компьютере, который подключается к LDAP-серверу. Сведения о том, где хранятся эти значения в реестре, см. в разделе [ADSI и управление учетными записями пользователей](adsi-and-uac.md).

Затем ADSI пытается обработать данные схемы и считывает атрибут [**модифитиместамп**](/windows/desktop/ADSchema/a-modifytimestamp) . Если атрибут **модифитиместамп** существует и интерфейсы ADSI успешно обработают схему, ADSI записывает эту подсхему на диск и создает два следующих значения реестра в разделе раздела. Если данные подсхемы существуют, но не могут быть обработаны, ни один из этих значений реестра не будет создан:

-   Значение **времени** , которое содержит атрибут [**модифитиместамп**](/windows/desktop/ADSchema/a-modifytimestamp) . Это значение используется для обеспечения актуальности данных схемы и предотвращения перезагрузки данных схемы.
-   Значение **файла** , содержащее путь, по которому ADSI хранит данные схемы в файловой системе. По умолчанию ADSI кэширует подсхему в &lt; &gt; \\ каталоге systemroot счкаче с именем файла, соответствующим имени LDAP-сервера.

Если данные подсхемы могут быть обработаны, но атрибут [**модифитиместамп**](/windows/desktop/ADSchema/a-modifytimestamp) не предоставляется, данные схемы кэшируются в памяти, но не записываются на диск. Если сервер LDAP V3 подключен через ADSI на локальном компьютере, а кэшированная подсхема отсутствует, скорее всего, это может быть вызвано одной из следующих причин:

-   Сервер не предоставил правильные свойства.
-   Интерфейсу ADSI не удалось обработать схему.
-   Интерфейсу ADSI не удалось записать файл в файловую систему.

 

 
