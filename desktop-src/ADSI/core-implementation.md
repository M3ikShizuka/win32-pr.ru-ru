---
title: Базовая реализация
description: 'Поставщик ADSI поддерживает следующие функции:'
ms.assetid: 39798237-a181-43b4-8441-ac711f923d4d
ms.tgt_platform: multiple
keywords:
- интерфейсы ADSI для базовой реализации
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d78487b701cac0409745ed3a7776dd882f2c37a878dec1d144c3b52a426db487
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118962093"
---
# <a name="core-implementation"></a>Базовая реализация

Поставщик ADSI поддерживает следующие функции:

-   ADsPath строк в формате COM и URL. По определению можно получить объект Active Directory с помощью ADsPath. Поставщики поддерживают синтаксис, который служба каталогов требует использовать для реализации **парседисплайнаме** .
-   Объект пространства имен верхнего уровня, поддерживающий [**ипарседисплайнаме::P арседисплайнаме**](/windows/win32/api/oleidl/nf-oleidl-iparsedisplayname-parsedisplayname) и [**иадсопендсобжект**](/windows/desktop/api/Iads/nn-iads-iadsopendsobject). Этот объект содержит корневые узлы для этого пространства имен. Часть реализации **парседисплайнаме** должна включать средство синтаксического анализа, которое проверяет синтаксические ошибки в своем собственном пространстве имен. Этот объект также должен поддерживать [**iAds**](/windows/desktop/api/Iads/nn-iads-iads) и **иадсопендсобжект**.
-   Интерфейс [**iAds**](/windows/desktop/api/Iads/nn-iads-iads) . Сюда входит простая реализация кэша свойств с помощью метода [**iAds::-info**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) и [**iAds:: сетинфо**](/windows/desktop/api/Iads/nf-iads-iads-setinfo). Операции, которые получают или задают свойства объекта, выполняются в режиме кэширования. Значения кэша записываются в базовое хранилище каталога во время процедуры **iAds:: сетинфо**. Однако метод ADSI не кэшируется, но выполняется немедленно.
-   Интерфейсы [**иадспропертилист**](/windows/desktop/api/Iads/nn-iads-iadspropertylist), [**иадспропертентри**](/windows/desktop/api/Iads/nn-iads-iadspropertyentry) и [**иадспропертивалуе**](/windows/desktop/api/Iads/nn-iads-iadspropertyvalue) для прямого доступа к свойствам и их перечисления в кэше свойств. Для служб каталогов, которые не предоставляют схему, этот интерфейс позволяет управлять свойствами объекта.
-   Интерфейс [**идиректорйобжект**](/windows/desktop/api/Iads/nn-iads-idirectoryobject) для клиентов, не поддерживающих автоматизацию. При этом используется протокол over-Wire для максимальной производительности и обход кэша свойств.
-   Интерфейс [**иадсконтаинер**](/windows/desktop/api/Iads/nn-iads-iadscontainer) . Каждый объект Active Directory имеет родительский контейнер, который управляет его временем существования. Имейте в виду, что для объектов контейнера ADs параметр [**iAds:: info**](/windows/desktop/api/Iads/nf-iads-iads-getinfo) влияет только на свойства контейнера, а не на его содержимое. Сетинфо для объектов контейнера ADs затрагивает только свойства контейнера и не влияет на вновь созданные объекты или объекты, которые уже существуют в контейнере.
-   Интерфейс [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) . это интерфейс автоматизации для таких языков, как Visual Basic scripting Edition, которые не используют привязку времени компиляции. Связано с этим данными библиотеки типов, которые должен предоставить поставщик. Дополнительные сведения см. в статье [вопросы реализации поставщиков ADSI](implementation-issues-for-adsi-providers.md).
-   Объект контейнера класса схемы, соответствующий синтаксис, свойство и объекты класса схемы, поддерживающие [**иадссинтакс**](/windows/desktop/api/Iads/nn-iads-iadssyntax), [**иадспроперти**](/windows/desktop/api/Iads/nn-iads-iadsproperty)и [**иадскласс**](/windows/desktop/api/Iads/nn-iads-iadsclass) соответственно. Как минимум, каждый корневой узел должен содержать собственный объект-контейнер класса схемы.
-   Интерфейс [**иадсмемберс**](/windows/desktop/api/Iads/nn-iads-iadsmembers) , если какие – либо поддерживаемые атрибуты являются коллекциями объектов ADSI, например группами безопасности.
-   Интерфейс [**иадсколлектион**](/windows/desktop/api/Iads/nn-iads-iadscollection) , если поддерживаемые атрибуты являются коллекциями одного и того же типа элементов каталога с [**Иадсколлектион:: Add**](/windows/desktop/api/Iads/nf-iads-iadscollection-add) и [**иадсколлектион:: Remove**](/windows/desktop/api/Iads/nf-iads-iadscollection-remove) .
-   Перечисление **иенумкскскскс** поддерживает все определенные объекты перечислителя.
-   Подпрограммы для отображения синтаксиса и преобразования собственных данных в тип данных [**Variant**](/windows/win32/api/oaidl/ns-oaidl-variant) .
-   Следуйте соглашениям ADSI для предоставляемых поставщиком объектов ADSI. Включает файлы справки и библиотеки типов, которые задокументированы свойства и методы интерфейса.

Как и в случае любой реализации COM, вызовы [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) должны возвращать **\_ интерфейс e** для нереализованных интерфейсов, **e \_ нотимпл** для нереализованных методов интерфейсов, которые в противном случае реализованы, и возвращать **E \_ ADS \_ свойство \_ не \_ поддерживается** для нереализованных свойств. Дополнительные сведения о сдвоенных интерфейсах и их влиянии на реализацию свойства см. в разделе [сдвоенные интерфейсы](dual-interfaces.md).

 

 