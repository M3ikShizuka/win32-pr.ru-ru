---
title: Общие сведения о коде
description: На следующем рисунке представлено концептуальное представление блоков кода, необходимых для реализации компонента поставщика в примере ADSI.
ms.assetid: b353c2d9-ef86-4e4c-ac00-4756fc9ec57d
ms.tgt_platform: multiple
keywords:
- Обзор кода Active Directory
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e99a4974ac97488fc051ea80dbde7a8a83fa329e
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "104070624"
---
# <a name="code-overview"></a>Общие сведения о коде

На следующем рисунке представлено концептуальное представление блоков кода, необходимых для реализации компонента поставщика в примере ADSI. Каждый раздел описан на следующем рисунке. Опытные программисты COM могут обнаружить, что это будет подходящим обзором примера компонента поставщика. Дополнительные сведения см. в разделе [сведения о коде](code-details.md).

![Пример реализации поставщика](images/dssmco.png)

Следующие нумерованные элементы соответствуют блочным элементам на рисунке.

1.  Загрузка библиотеки DLL (Либмаин. cpp, GUID. cpp). Точка входа для библиотеки DLL. Определения статических объектов фабрики класса для двух объектов поставщика: GUID. cpp содержит определения CLSID для реализаций различных объектов компонента поставщика.
2.  Фабрика классов объектов поставщика и код создания (Кпровкф. cpp, Кпров. cpp, Стдфакт. cpp). Объект поставщика — это объект, который поддерживает [**ипарседисплайнаме**](/windows/win32/api/oleidl/nn-oleidl-iparsedisplayname) во время операций привязки моникера, как описано в разделе Поиск и привязка в примере компонента поставщика.
3.  Привязка к объекту (Жетобж. cpp). Этот код вызывает средство синтаксического анализа, чтобы проверить синтаксическую правильность заданного ADsPath, а затем выполняет все необходимое сопоставление из пути ADsPath с собственным путем к службе каталогов для создаваемого элемента как объекта Active Directory. Он ищет определение схемы для этого типа объекта и заполняет обязательные свойства. После создания объекта Active Directory для вызывающей стороны извлекается указатель на интерфейс [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) .
4.  Средство синтаксического анализа для пространства имен поставщика (Parse. cpp). Это код, вызываемый элементом 3. Средство синтаксического анализа проверяет, что переданная строка ADsPath синтаксически правильна для своего собственного пространства имен.
5.  Фабрика класса, создание и перечисление для объекта пространства имен (Кнамкф. cpp, Кнамесп. cpp, Ценумнс. cpp). Объект пространства имен — это объект контейнера, который можно перечислить, чтобы найти все объекты корневого узла для этого пространства имен.
6.  Фабрика классов и код создания для универсального Active Directoryного объекта, а фабрика класса, создание и перечисление кода для универсального объекта контейнера баннеров (Кженобж. cpp, Ценумобж. cpp, Common. cpp, Core. cpp). Этот код выполняется при создании объекта Active Directory.
7.  Фильтрация и перечисление вариантов (Ценумвар. cpp, Object. cpp). Если коллекция ВАРИАТИВНЫХ элементов одного типа управляется в интерфейсе ADSI, используется этот код.
8.  Глобальные (Globals. cpp). Ключевые слова пространства имен, структуры сопоставления синтаксиса из собственных форматов данных в тип VARIANT автоматизации ADs определяются здесь.
9.  Маршалирование и распаковка данных (Pack. cpp, Property. cpp, Смпопер. cpp). Преобразование из собственных форматов данных в поддерживаемый набор типов вариантов автоматизации происходит, когда свойства объекта загружаются в кэш свойств. Другая специальная обработка данных должна выполняться при копировании, удалении или перемещении структур с указателями в памяти.
10. Кэш свойств (Кпропс. cpp). Свойства кэширования — это функция среды ADSI. Методы [**iAds::**](/windows/desktop/api/Iads/nf-iads-iads-getinfo)жетинфоекс, [**iAds::**](/windows/desktop/api/Iads/nf-iads-iads-getinfoex)и [**iAds:: сетинфо**](/windows/desktop/api/Iads/nf-iads-iads-setinfo) действуют в кэше свойств.
11. Управление памятью (память. cpp). Использование одного набора функций памяти для выделения и освобождения памяти позволяет компоненту "пример поставщика" контролировать использование памяти и прекращать утечку памяти.
12. Объекты схемы и управление (Ксчобж. cpp, Кпрпобж. cpp, Кклсобж. cpp, Ценумсч. cpp). Сюда входят подпрограммы для создания, управления и перечисления объектов схемы. В их число входят объекты классов схемы, объекты свойств и объекты синтаксиса, а также возможность перечисления объекта контейнера класса схемы.
13. Вызовы, относящиеся к операционной системе (Регдсапи. cpp). Сюда входят все вызовы, ссылающиеся на собственную операционную систему. Среди прочих функций они включают в себя функции открытия, закрытия, чтения и изменения объектов, а также доступ к схеме и данным свойств. В примере компонента поставщика произошло моделирование иерархии каталогов с помощью реестра. Только имена функций должны быть значительными интересами для модуля записи поставщика.
14. Реализация [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) (кдиспмгр. cpp). Этот код обращается к данным библиотеки типов, чтобы обеспечить возможность вызова методов интерфейса при автоматизации, совместимых с автоматизацией.

 

 