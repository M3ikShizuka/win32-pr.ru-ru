---
title: Ограничение размера с IDirectorySearch
description: Клиент может сосредоточиться на небольшом количестве объектов, возвращаемых с сервера, и игнорировать оставшуюся часть результирующего набора.
ms.assetid: 55393177-f49b-4163-8e33-2ec24a64b99a
ms.tgt_platform: multiple
keywords:
- Ограничение размера с помощью IDirectorySearch ADSI
- ADSI, поиск, IDirectorySearch, другие параметры поиска, предельный размер
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9d6ee4e23cb3014ea92e8510da88767a433b76c0fe73ccbe74bac6ba0bfc1c49
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118178749"
---
# <a name="size-limit-with-idirectorysearch"></a>Ограничение размера с IDirectorySearch

Чтобы уменьшить потребность в памяти или в других целях, клиент может сосредоточиться на небольшом количестве объектов, возвращаемых с сервера, и игнорировать оставшуюся часть результирующего набора, который не является нужным. Для этого клиент указывает предельный размер поиска и другие соответствующие условия поиска. Например, если в каталоге хранятся результаты тестирования учебного района, можно запросить Десять ведущих учащихся с самыми высокими показателями тестирования, указав предельный размер в десять (10) и сортировку по убыванию.

Значение по умолчанию для ограничения размера не ограничено. Чтобы задать предельный размер, задайте для параметра поиска **\_ Сеарчпреф \_ размер \_ ADS** значение **\_ целого числа адстипе** , которое содержит максимальный размер в массиве [**\_ \_ сведений об ADS сеарчпреф**](/windows/desktop/api/Iads/ns-iads-ads_searchpref_info) , переданном в метод [**IDirectorySearch:: сетсеарчпреференце**](/windows/desktop/api/Iads/nf-iads-idirectorysearch-setsearchpreference) .

В следующем примере кода показано, как задать предельный размер. Значение предельного размера, равное нулю, указывает на отсутствие ограничения по размеру.


```C++
ADS_SEARCHPREF_INFO SearchPref;
SearchPref.dwSearchPref = ADS_SEARCHPREF_SIZE_LIMIT;
SearchPref.vValue.dwType = ADSTYPE_INTEGER;
SearchPref.vValue.Integer = 1000;
```



Для Active Directory ограничение размера определяет максимальное число объектов, возвращаемых при поиске. Кроме того, для Active Directory максимальное количество объектов, возвращаемых функцией поиска, — 1000.

 

 




