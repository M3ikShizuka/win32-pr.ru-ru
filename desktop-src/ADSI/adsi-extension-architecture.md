---
title: Архитектура расширения ADSI
description: Расширения ADSI основаны на модели агрегирования COM с помощью нескольких усовершенствований. Расширения должны соответствовать всем правилам COM. Дополнительные сведения см. в спецификации COM.
ms.assetid: 59e39273-1f66-4bdd-89ed-31947a268d1f
ms.tgt_platform: multiple
keywords:
- расширения ADSI, Архитектура расширения
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 377409f4b9ac36d72d6885e89860b9e6e680b103
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "103793866"
---
# <a name="adsi-extension-architecture"></a>Архитектура расширения ADSI

Расширения ADSI основаны на модели агрегирования COM с помощью нескольких усовершенствований. Расширения должны соответствовать всем правилам COM. Дополнительные сведения см. в спецификации COM.

Ниже приведена проверка модели агрегирования COM.

![модель агрегирования com](images/comagmod.png)

Статистическое выражение, также называемое внутренним объектом, представляет собой объект, создаваемый агрегатором. Объект расширения является агрегатом.

Агрегатор, также называемый внешним объектом, является объектом, который создает статистическое выражение. ADSI является агрегатором.

Внутренний объект делегирует свой [**интерфейс**](/windows/win32/api/unknwn/nn-unknwn-iunknown) IUnknown интерфейсу **IUnknown** агрегатора.

Расширения ADSI добавляют следующие улучшения в агрегирование COM для удовлетворения своих требований:

-   Позволяет каждому модулю записи расширений расширять объекты ADSI. Модуль записи расширений может зарегистрировать свое расширение в ADSI и не повлияет на существование других расширений. В модели агрегирования COM агрегатор должен иметь CLSID агрегата. ADSI ослабляет это требование, делая его средством агрегации для всех расширений. Таким образом, вместо формирования слоя вложенных компонентов расширения находятся на одном уровне.
-   Разрешает один объект, один интерфейс IDispatch. Поддержка автоматизации является одной из важнейших функций ADSI. Поддержка автоматизации достигается благодаря тому, что ADSI поддерживает интерфейс [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch) . Модули записи расширений рекомендуется поддерживать интерфейс **IDispatch** . Однако для данного объекта должен быть только один интерфейс **IDispatch** . ADSI интегрирует и собирает многие интерфейсы **IDispatch** из разных расширений и представляет их как единый интерфейс **IDispatch** для контроллера автоматизации. Каждое расширение, при выполнении статистической обработки, должно перенаправлять вызовы **IDispatch** в интерфейс **IDispatch** , предоставляемый ADSI.

Все эти решения возможны из-за служб, предоставляемых диспетчером объектов ADSI, которые располагаются на каждом поставщике ADSI.

На следующем рисунке показана архитектура модели расширения ADSI.

![Архитектура модели расширения ADSI](images/adsiexmo.png)

ADSI поддерживает два уровня расширения:

-   Поддержка раннего связывания. Это первый уровень расширения. Расширение должно поддерживать регистрацию и реализовывать новые интерфейсы. Потребители расширений должны использовать средства или узлы сценариев, поддерживающие раннее связывание, например Visual C++, Visual Basic.
-   Поддержка поздних привязок. Это происходит, когда расширение удовлетворяет всем требованиям раннего связывания и реализует дополнительный интерфейс [**иадсекстенсион**](/windows/desktop/api/Iads/nn-iads-iadsextension). Разработчики расширений могут использовать любое средство, работающее в качестве контроллера автоматизации, например сервер сценариев Windows, Active Server страницы или HTML с помощью VBScript.

 

 