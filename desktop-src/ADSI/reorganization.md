---
title: Реорганизации
description: Организация продаж перешла в новую организацию \ 8212; \ 0034; Продажи и поддержка. \ 0034; Джулия Банкерт была выдвинута на вице — президент по интересу и создаст новую организацию.
ms.assetid: 38b05d0b-2739-43c2-aac7-7555a5bfbc91
ms.tgt_platform: multiple
keywords:
- Реорганизация ADSI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 587f3de34738814b34ad250bb00bb7b71121d65c
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104067319"
---
# <a name="reorganization"></a>Реорганизации

Организация продаж перешла в новую организацию — «продажи и поддержка». Джулия Банкерт была выдвинута на вице — президент по интересу и создаст новую организацию. Джо Ворден, администратор предприятия, должен переместить подразделение «продажи» в новое подразделение, продажи и поддержку.


```VB
Set dom = GetObject("LDAP://DC=Fabrikam,DC=COM")
Set salesSupport = dom.Create("organizationalUnit", "CN=Sales and Support")
Set sales = salesSupport.MoveHere("LDAP://OU=Sales,DC=Fabrikam,DC=COM", vbNullString)
```



В этом примере кода все объекты в подразделении Sales, включая подразделение, перемещаются в новое подразделение.

Теперь Сергей может переместить Юлия в подразделение "продажи и поддержка".


```VB
Set usr = salesSupport.MoveHere("LDAP://CN=Julie Bankert,OU=Sales,OU=Sales and Support,DC=Fabrikam,DC=COM")
usr.Put "title", "Vice President"
usr.SetInfo
```



Имейте в виду, что ссылка «руководитель-прямой отчет» между Юлия Банкерт и Олегом серого автоматически обновляется Active Directory.

**Создание отчета Active Directory**

1.  Откройте Visual Basic версии 6,0 и при появлении запроса на выбор типа проекта выберите **проект данных**.
2.  В **проекте данных** дважды щелкните **Environment1 данных**.
3.  В окне **Среда данных** щелкните правой кнопкой мыши объект подключения **(Connection1)** и выберите пункт **Свойства**.
4.  Выберите **поставщик OLE DB для служб каталогов Майкрософт** и нажмите кнопку **Далее**.
5.  Установите флажок **использовать встроенную безопасность Windows NT** и нажмите кнопку **ОК**. При этом создается объект соединения.
6.  Снова щелкните правой кнопкой мыши окно **среды данных** , чтобы выбрать **команду Добавить**. Щелкните правой кнопкой мыши объект **команда1** и выберите пункт **свойства**. Появится следующее диалоговое окно **свойств команда1** .

    ![диалоговое окно «Свойства команда1»](images/adadsi3.png)

7.  Нажмите кнопку « **инструкция SQL** » и введите следующее:

    Выберите имя, telephoneNumber из "LDAP://ДК = Fabrikam, DC = com", где objectCategory = "Person" и objectClass = "User"

    Объект **команды** создан. Добавьте в отчет объект **Command** .

8.  Дважды щелкните **Report1 данных** в окне **проекта** .
9.  Перетащите объект **команда1** из окна **DataEnvironment1** в раздел **сведений** в окне **отчета данных** .
10. В **свойствах DataReport1** для **DataSource** выберите **DataEnvironment1** в раскрывающемся меню и выберите **команда1** в поле **DataMember** .
11. В окне проекта щелкните правой кнопкой мыши **проект Data** и выберите **Свойства проекта** данных.
12. В диалоговом окне " **проект-свойства** проекта" в разделе " **объект запуска**" выберите **DataReport1** в раскрывающемся меню. Нажмите кнопку **ОК**, чтобы сохранить изменения.
13. Компиляция. Появится следующее диалоговое окно **DataReport1** .

    ![диалоговое окно «datareport1»](images/adadsi4.png)

## <a name="related-topics"></a>См. также

<dl> <dt>

[Соединение разнородных данных](joining-heterogeneous-data.md)
</dt> </dl>

 

 




