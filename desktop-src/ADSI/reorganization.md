---
title: Реорганизации
description: Организация продаж перешла в новую организацию \ 8212; \ 0034; Продажи и поддержка. \ 0034; Джулия Банкерт была выдвинута на вице — президент по интересу и создаст новую организацию.
ms.assetid: 38b05d0b-2739-43c2-aac7-7555a5bfbc91
ms.tgt_platform: multiple
keywords:
- Реорганизация ADSI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 368b4db1909c50242e3eda1402e46896e54785aa66739b324995b7edbdd1b007
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118690768"
---
# <a name="reorganization"></a>Реорганизации

Организация продаж перешла в новую организацию — «продажи и поддержка». Джулия Банкерт была выдвинута на вице — президент по интересу и создаст новую организацию. Джо Ворден, администратор предприятия, должен переместить подразделение «продажи» в новое подразделение, продажи и поддержку.


```VB
Set dom = GetObject("LDAP://DC=Fabrikam,DC=COM")
Set salesSupport = dom.Create("organizationalUnit", "CN=Sales and Support")
Set sales = salesSupport.MoveHere("LDAP://OU=Sales,DC=Fabrikam,DC=COM", vbNullString)
```



В этом примере кода все объекты в подразделении Sales, включая подразделение, перемещаются в новое подразделение.

Теперь Сергей может переместить Юлия в подразделение "продажи и поддержка".


```VB
Set usr = salesSupport.MoveHere("LDAP://CN=Julie Bankert,OU=Sales,OU=Sales and Support,DC=Fabrikam,DC=COM")
usr.Put "title", "Vice President"
usr.SetInfo
```



Имейте в виду, что ссылка «руководитель-прямой отчет» между Юлия Банкерт и Олегом серого автоматически обновляется Active Directory.

**Создание отчета Active Directory**

1.  откройте Visual Basic версии 6,0 и при появлении запроса на выбор типа проекта выберите **Project данных**.
2.  в **Project данных** дважды щелкните **Environment1 данных**.
3.  В окне **Среда данных** щелкните правой кнопкой мыши объект подключения **(Connection1)** и выберите пункт **Свойства**.
4.  Выберите **поставщик OLE DB для служб каталогов Майкрософт** и нажмите кнопку **Далее**.
5.  выберите **использовать Windows NT встроенная безопасность** и нажмите кнопку **ок**. При этом создается объект соединения.
6.  Снова щелкните правой кнопкой мыши окно **среды данных** , чтобы выбрать **команду Добавить**. Щелкните правой кнопкой мыши объект **команда1** и выберите пункт **свойства**. Появится следующее диалоговое окно **свойств команда1** .

    ![диалоговое окно «Свойства команда1»](images/adadsi3.png)

7.  нажмите кнопку параметра **SQL инструкции** и введите следующее:

    Выберите имя, telephoneNumber из "LDAP://ДК = Fabrikam, DC = com", где objectCategory = "Person" и objectClass = "User"

    Объект **команды** создан. Добавьте в отчет объект **Command** .

8.  дважды щелкните **Report1 данных** в окне **Project** .
9.  Перетащите объект **команда1** из окна **DataEnvironment1** в раздел **сведений** в окне **отчета данных** .
10. В **свойствах DataReport1** для **DataSource** выберите **DataEnvironment1** в раскрывающемся меню и выберите **команда1** в поле **DataMember** .
11. в окне проекта щелкните правой кнопкой мыши **Project данные** и выберите **свойства проекта** данных.
12. в диалоговом окне **свойства Project проекта** в разделе **объект запуска** выберите **DataReport1** в раскрывающемся меню. Нажмите кнопку **ОК**, чтобы сохранить изменения.
13. Компиляция. Появится следующее диалоговое окно **DataReport1** .

    ![диалоговое окно «datareport1»](images/adadsi4.png)

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Соединение разнородных данных](joining-heterogeneous-data.md)
</dt> </dl>

 

 




