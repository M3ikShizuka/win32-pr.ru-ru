---
title: Коды ошибок Win32 для ADSI
description: Стандартные коды ошибок Win32 также используются для возврата сообщений об ошибках ADSI.
ms.assetid: 5b7b85c9-ccca-4ea3-8b37-54f6b30a509f
ms.tgt_platform: multiple
keywords:
- Коды ошибок Win32 для ADSI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3b18539e93504991f244bbba8b41b13e524ff236918145deda73788169cef368
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119589744"
---
# <a name="win32-error-codes-for-adsi"></a>Коды ошибок Win32 для ADSI

Стандартные коды ошибок Win32 также используются для возврата сообщений об ошибках ADSI. В частности, поставщик LDAP ADSI сопоставляет все коды ошибок LDAP с кодами ошибок Win32. Значения **HRESULT** этих кодов ошибок имеют формат 0x8007XXXX, где четыре последние шестнадцатеричные цифры (xxxx) соответствуют значениям **DWORD** соответствующего кода ошибки Win32. Например, значение ошибки ADSI 0x80072020 дает значение ошибки Win32 0x2020 в шестнадцатеричном или 8224 в десятичном формате.

Чтобы преобразовать значение **HRESULT** кода ошибки ADSI, возвращенного приложением, в соответствующее значение **DWORD** ошибки Win32, как определено в заголовочных файлах выше, используйте следующую процедуру.

Большинство кодов ошибок Win32 для ADSI определены в файле Winerror. h или Лмерр. h. Значения ошибок перечислены в виде десятичных значений в этих файлах.

**Преобразование значения **HRESULT** кода ошибки ADSI в соответствующее значение **DWORD** ошибки Win32**

1.  преобразуйте значение **HRESULT** в шестнадцатеричное число, если оно начинается с десятичного значения, как вы можете получить из Visual Basic приложения.
2.  Удалите часть 0x8007, чтобы получить остаток.
3.  Преобразуйте остаток в десятичное число.
4.  Поиск десятичного остатка в файле Winerror. h.
5.  Если не найдено в файле Winerror. h, вычтите 2100 из десятичного остатка и найдите результат в Лмерр. h.

adsi 2,0 сопоставляет коды ошибок LDAP набору кодов ошибок Win32, отличающихся от тех, которые используются в ADSI для Windows 2000 и клиента DS. Различия перечислены в:

-   [Коды ошибок Win32](win32-error-codes.md)
-   [Коды ошибок Win32 для ADSI 2,0](win32-error-codes-for-adsi-2-0.md)

 

 




