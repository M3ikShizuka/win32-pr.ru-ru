---
title: Управление схемой
description: Компонент поставщика в примере ADSI определяет классы схемы \ 0034; подразделение \ 0034; и \ 0034; Пользователь \ 0034; и управляют этими классами схемы следующим образом.
ms.assetid: c3e07846-a11e-46d4-9863-a89810896ad7
ms.tgt_platform: multiple
keywords:
- ADSI управления схемой
- ADSI управления схемой
- Управление схемами ADSI
- схемы, управление ADSI
- Управление схемой ADSI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 99d398f8eb056498977f886e836c0f97c95f0b9b
ms.sourcegitcommit: b0ebdefc3dcd5c04bede94091833aa1015a2f95c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "104551896"
---
# <a name="schema-management"></a>Управление схемой

Компонент "пример поставщика ADSI" определяет классы схемы "подразделение" и "пользователь", а также управляет этими классами схем следующим образом.

Класс схемы "подразделение" представлен объектом-контейнером ADs и может содержать другие "подразделения" и "Пользователи". Объект контейнера поддерживает интерфейсы [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch), [**iAds**](/windows/desktop/api/Iads/nn-iads-iads)и [**иадсконтаинер**](/windows/desktop/api/Iads/nn-iads-iadscontainer). Класс схемы User представлен универсальным Active Directory объектом и не содержит других типов объектов. В примере компонента поставщика объект пользователя реализуется как универсальный объект Active Directory, который поддерживает интерфейсы **IUnknown**, **IDispatch** и **iAds**. Имейте в виду, что объект User в данном случае не поддерживает интерфейс [**IADsUser**](/windows/desktop/api/Iads/nn-iads-iadsuser) .

В примере компонента поставщика также должен быть реализован объект пространства имен ADs, который поддерживает интерфейсы [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown), [**iAds**](/windows/desktop/api/Iads/nn-iads-iads), [**иадсконтаинер**](/windows/desktop/api/Iads/nn-iads-iadscontainer), [**иадсопендсобжект**](/windows/desktop/api/Iads/nn-iads-iadsopendsobject)и [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch).

На следующем рисунке показаны сведения о схеме, представляющей два примера классов схемы компонентов поставщика.

![Пример схемы компонента поставщика ADSI](images/dssmsch.png)

Обратите внимание, что на предыдущем рисунке класс схемы "подразделение" определяет три свойства: "Description", "Хеадкаунтс" и "ID". Класс схемы user определяет четыре свойства: "ID", "Name", "PhoneNumber" и "Title". Свойство "ID" совместно используется обоими классами схемы. Каждое свойство определяется как объект синтаксиса "String" или "integer".

> [!Note]  
> Объекты синтаксиса не представлены в первом выпуске примера компонента поставщика. Однако в большинстве реализаций схемы Microsoft ADSI объекты синтаксиса включаются в объект контейнера схемы, точно так же, как класс схемы и объекты свойств. По этой причине они показаны здесь.

 

Этот компонент поставщика предоставляет доступ к данным схемы клиентскому приложению ADSI в виде объектов класса ADs, объектов свойств ADs и объектов синтаксиса ADs, всех в объекте контейнера схемы, чтобы данные схемы можно было извлечь во время выполнения.

Адспасс для объектов контейнера класса схемы, определенных для компонента примера поставщика, — это "Sample://Seattle/schema" и "Sample://Toronto/schema". В этом примере содержимое схем идентично.

 

 