---
title: Ссылки (ADSI)
description: Ссылки происходят, когда запрашиваемый сервер не содержит этих данных, но может его найти.
ms.assetid: 2068ce7a-0b94-4d25-a18f-97f26863bd1d
ms.tgt_platform: multiple
keywords:
- Ссылки ADSI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1d5fb6ad299c2f47efa9723857b53cf7eee5350589757153eaaae869b2c37e6b
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119444024"
---
# <a name="referrals-adsi"></a>Ссылки (ADSI)

Ссылки происходят, когда запрашиваемый сервер не содержит этих данных, но может его найти. Целевой сервер возвращает результирующий набор, который может содержать как фактические данные, так и ссылку на другой сервер для получения дополнительных данных. Включив *Отслеживание ссылок*, базовый код клиента ADSI будет использовать эти ссылочные данные, чтобы попытаться получить целевой объект с сервера, описанного в ссылочных данных. Имейте в виду, что отключение отслеживание ссылок может привести к уменьшению результирующего набора, в то время как включение отслеживание ссылок может привести к тому, что запрос будет охватывать много серверов. Если это возможно, рекомендуемым решением будет использование глобального каталога.

Дополнительные сведения о ссылках и прослеживании ссылок в Active Directory см. в разделе [ссылки](/windows/desktop/AD/referrals).

Например, когда клиент сообщает серверу A (а) о запросе объекта пользователя (U), может предложить, что клиент продолжит поиск на сервере B (б), если U не находится в, но известно как B. Клиент имеет возможность выбора в соответствии с ссылкой или нет. Поиск по ссылкам освобождает клиента от обязательного расширенного распознавания возможностей каждого сервера. Однако клиент должен указать тип ссылок, которые должен выполнить сервер.

Active Directory предлагает службы поиска по справочным службам. Клиент может выбрать любой из следующих типов прослеживания ссылок:

-   Никогда: сервер не должен создавать ссылку на клиент, хотя он распознает, что другой сервер хранит запрошенные данные.
-   External: сервер должен создавать ссылки, если запрос может быть разрешен на другом сервере другого дерева каталогов. Например, клиент запрашивает "OU = Sales, DC = Fabrikam, DC = COM" на сервере "fab01" в домене "Fabrikam.com". Однако объект не принадлежит "fab01", но известно, что он находится на сервере "ARC01" в домене "Fabrikam.com". Таким словами, "fab01" указывает клиенту на "ARC01".
-   Подчиненный: сервер должен создавать ссылки, если запрос может быть разрешен на сервере, имя которого образует непрерывный путь от исходного сервера. Область поиска должна быть на уровне поддерева.

    Например, сервер A содержит объекты в «DC = Sales, DC = Fabrikam, DC = com». Сервер B содержит объекты в "DC = Сиэтл, DC = Sales, DC = Fabrikam, DC = com". Имейте в виду, что имя сервера B образует непрерывный путь от сервера A. Когда клиент обращается к серверу A, запрос к поддереву "DC = Sales, DC = Fabrikam, DC = com" запрашивается и указывает, что ссылка является подчиненным типом, возникает следующее событие:

    -   Сервер A возвращает все объекты, которые он знает в области.
    -   Сервер A информирует клиента, что объекты в "DC = Сиэтл, DC = Sales, DC = Fabrikam, DC = COM" можно найти на сервере B.

    Клиент может выбрать связь с сервером б. Если это так, происходит следующее событие:

    -   Сервер B отвечает запрошенным объектам.
    -   Если сервер B обнаруживает другие серверы по непрерывному пути именования и процесс продолжится.

-   Всегда: сервер создает ссылки, если поиск может быть разрешен на основе внешнего типа или подчиненного типа.

> [!Note]  
> В Active Directory глобальный каталог содержит все объекты в определенном предприятии. Поиск сервера глобального каталога обеспечивает лучшую производительность, чем в соответствии с тем, что предоставляет ссылки с одного сервера на другой.

 

В большинстве случаев отслеживание ссылок будет прозрачным для вызывающего объекта. Если ссылка относится к объекту в другом домене или лесу, базовый API LDAP будет пытаться использовать текущие учетные данные для привязки к целевому объекту ссылки. В случае успеха отслеживание ссылок будет прозрачным. Если это не удалось, будет возвращена ссылка и код ошибки ссылки.

Дополнительные сведения об использовании параметров прослеживания ссылок с конкретным интерфейсом поиска см. в следующих статьях:

-   [Отслеживание ссылок с помощью IDirectorySearch](referral-chasing-with-idirectorysearch.md)
-   [поиск с помощью объекты данных ActiveX](searching-with-activex-data-objects-ado.md)
-   [Поиск с помощью OLE DB](searching-with-ole-db.md)

 

 