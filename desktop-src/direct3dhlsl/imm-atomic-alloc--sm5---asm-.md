---
title: imm_atomic_alloc (SM5-ASM)
description: Атомарное увеличение скрытого 32-битного счетчика, хранящегося в представлении Count или Append UAV (неупорядоченное представление доступа), возвращая исходное значение.
ms.assetid: 534FA3C3-6FAC-41DC-AC07-0E53FEED000C
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 28a97709629497bae9af0298789453ef1d1172b7
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "126888205"
---
# <a name="imm_atomic_alloc-sm5---asm"></a>IMM \_ Atomic \_ Alloc (SM5-ASM)

Атомарное увеличение скрытого 32-битного счетчика, хранящегося в представлении Count или Append UAV (неупорядоченное представление доступа), возвращая исходное значение.



| IMM \_ Atomic \_ Alloc dst0 \[ . единственная \_ \_ Маска компонента \] , дстуав |
|-------------------------------------------------------------|



 



| Элемент                                                                                           | Описание                                                               |
|------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------|
| <span id="dst0"></span><span id="DST0"></span>*dst0*<br/>                                | \[в \] содержит возвращенное значение счетчика.<br/>                    |
| <span id="dstUAV"></span><span id="dstuav"></span><span id="DSTUAV"></span>*дстуав*<br/> | \[в \] структурированном буфере UAV с флагом Count или Append. <br/> |



 

## <a name="remarks"></a>Комментарии

Существует скрытое значение счетчика без знака 32-разрядного целого числа, связанное с каждым представлением счетчика или с добавлением буфера, которое инициализируется при привязке представления к конвейеру, включая параметр для сохранения предыдущего значения.

Эта инструкция выполняет атомарное приращение значения счетчика, возвращая исходный объект в *dst0*.

Для добавления UAV возвращаемое значение допустимо только на время вызова шейдера. После этого реализация может изменить макет памяти. Любая адресация памяти на основе возвращаемого значения должна быть ограничена вызовом шейдера.

В случае добавления UAV компилятор HLSL может использовать возвращаемое значение в качестве индекса структуры, используемого для доступа к структурированному буферу. При доступе к любому индексу структуры, отличному от расположений, возвращенных вызовами с помощью вызова **IMM \_ атомарного \_ распределения** или [ \_ использования](imm-atomic-consume--sm5---asm-.md) , выдается неопределенное значение, в котором доступ к КАКОМУ-то расположению памяти в UAV осуществляется случайным образом и фиксированным только на время существования вызова шейдера.

Для счетчика UAV возвращаемое значение может быть сохранено приложением как ссылка на фиксированное расположение в UAV, которое имеет смысл после того, как вызов шейдера не будет выполнен. Любое расположение в UAVе Count всегда может быть доступно независимо от значения счетчика.

Фиксация счетчика не производится, поэтому он переносится на переполнение.

Один и тот же шейдер не может попытаться одновременно **\_ \_ использовать** и IMM **\_ Atomic \_ Alloc** , и IMM Atomic на одном UAV. Кроме того, GPU не может разрешить несколько вызовов шейдера для смешения **\_ \_ распределения IMM Atomic** и **IMM \_ Atomic \_** на одном UAV.

Эта инструкция применяется к следующим этапам шейдера:



| Вершина | Поверхности | Домен | Geometry | Пиксель | Вычисления |
|--------|------|--------|----------|-------|---------|
|        |      |        |          | X     | X       |



 

Так как Уавс доступны на всех стадиях шейдера для Direct3D 11,1, эта инструкция применяется ко всем этапам шейдера для среды выполнения Direct3D 11,1, которая доступна начиная с Windows 8.



| Вершина | Поверхности | Домен | Geometry | Пиксель | Вычисления |
|--------|------|--------|----------|-------|---------|
| X      | X    | X      | X        | X     | X       |



 

## <a name="minimum-shader-model"></a>Минимальная модель шейдера

Эта инструкция поддерживается в следующих моделях шейдеров:



| Модель шейдера                                              | Поддерживается |
|-----------------------------------------------------------|-----------|
| [Модель шейдера 5](d3d11-graphics-reference-sm5.md)        | yes       |
| [Модель шейдера 4,1](dx-graphics-hlsl-sm4.md)              | Нет        |
| [Модель шейдера 4](dx-graphics-hlsl-sm4.md)                | Нет        |
| [Модель шейдера 3 (DirectX HLSL)](dx-graphics-hlsl-sm3.md) | Нет        |
| [Модель шейдера 2 (DirectX HLSL)](dx-graphics-hlsl-sm2.md) | Нет        |
| [Модель шейдера 1 (DirectX HLSL)](dx-graphics-hlsl-sm1.md) | Нет        |



 

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Сборка Shader Model 5 (DirectX HLSL)](shader-model-5-assembly--directx-hlsl-.md)
</dt> </dl>

 

 





