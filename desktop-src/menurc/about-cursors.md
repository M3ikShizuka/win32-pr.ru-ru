---
title: О курсорах
description: В этом разделе обсуждаются стандартные курсоры.
ms.assetid: 0ca8e51c-1159-47e9-ba3f-5ced0667cadb
keywords:
- ресурсы, курсоры
- курсоры, сведения
- курсоры, стандартные
- стандартные курсоры
- Функция Сетсистемкурсор
- курсоры, пользовательские
- пользовательские курсоры
- курсоры, горячие участки
- курсоры, создание
- создание курсоров
- курсоры, расположение
- курсоры, внешний вид
- уничтожение курсоров
- дублирование курсоров
- курсор класса
- ограничивать курсоры
- курсоры, уничтожение
- курсоры, дублирование
- курсоры, класс
- курсоры, ограничивать
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6f2d0b91ba4670d2510413240efd742b2e0ba69b
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "104069959"
---
# <a name="about-cursors"></a>О курсорах

Windows предоставляет набор стандартных курсоров, доступных для использования любым приложением в любое время. Файлы заголовков SDK содержат идентификаторы для стандартных курсоров — идентификаторы начинаются с префикса **IDC \_** .

С каждым из стандартных указателей сопоставлено изображение по умолчанию. Пользователь или приложение может заменить изображение по умолчанию, связанное с любым стандартным курсором, в любое время. Приложение заменяет образ по умолчанию с помощью функции [**сетсистемкурсор**](/windows/desktop/api/Winuser/nf-winuser-setsystemcursor) . На следующем рисунке показано несколько стандартных курсоров из Windows Vista:

![стандартные курсоры, включая руки, знак плюс с четырьмя стрелками, стрелка с вопросительным знаком, круг, перо](images/cursorsstandard.png)

Приложение может использовать функцию [**жетиконинфо**](/windows/desktop/api/Winuser/nf-winuser-geticoninfo) для получения текущего изображения курсора и может нарисовать курсор с помощью функции [**дравиконекс**](/windows/desktop/api/Winuser/nf-winuser-drawiconex) . Чтобы нарисовать изображение по умолчанию для стандартного курсора, укажите флаг **\_ совместимости di** в вызове **дравиконекс**. Если не указать флаг совместимости с **di \_** , **дравиконекс** рисует стандартный курсор, используя изображение, указанное пользователем.

Пользовательские курсоры предназначены для использования в определенном приложении и могут быть любой конструкцией, которую определяет разработчик. На следующем рисунке показано несколько пользовательских курсоров.

![пользовательские курсоры, в том числе руки, полукруглые, барабаны, вристватч, метрономе](images/cursorscustom.png)

Курсоры могут быть либо монохромными, либо цветными, а также статическими или анимированными. Тип курсора, используемого на конкретной компьютерной системе, зависит от отображаемой системы. Старые экраны, такие как VGA, не поддерживают цветные или анимированные курсоры. Новые дисплеи, драйверы отображения которых используют подсистему, не зависящую от устройства (DIB), поддерживают их.

Курсоры и значки похожи и могут использоваться в различных ситуациях. Единственное различие между ними заключается в том, что изображение, указанное в качестве курсора, должно иметь формат, который может поддерживаться дисплеем. Например, курсор должен быть монохромным для дисплея VGA.

В этом обзоре содержатся сведения по следующим темам:

-   [Активная разактивная области](#the-hot-spot)
-   [Мышь и курсор](#the-mouse-and-the-cursor)
-   [Создание курсора](#cursor-creation)
-   [Расположение и внешний вид курсора](#cursor-location-and-appearance)
-   [Конфинемент курсора](#cursor-confinement)
-   [Уничтожение курсора](#cursor-destruction)
-   [Дублирование курсора](#cursor-duplication)
-   [Курсор класса окна](#the-window-class-cursor)

## <a name="the-hot-spot"></a>Активная разактивная области

В курсоре пиксел, именуемый *активной* точкой, отмечает точное расположение на экране, на которое влияет событие мыши, например нажатие кнопки мыши. Обычно активная точка является фокальной точкой курсора. Система отслеживает и распознает этот момент как позицию курсора. Например, типичные гиперобъекты — это пиксел на кончике курсора в форме стрелки и пиксель в середине курсора в виде перекрестной формы. На следующих изображениях показаны два курсора из программы рисования, в которых горячие участки связаны с кончиком кисти и перекрестной заливкой.

![Гиперобъекты на двух курсорах](images/cursorhotspot.png)

При возникновении события ввода мыши драйвер мыши преобразует событие в соответствующее сообщение мыши, которое содержит координаты активной точки. Система отправляет сообщение мыши в окно, содержащее активную точку, или на окно, которое захватывает входные данные мыши. Дополнительные сведения см. в разделе Ввод с помощью [мыши](/windows/desktop/inputdev/mouse-input).

## <a name="the-mouse-and-the-cursor"></a>Мышь и курсор

Система отражает движение мыши, перемещая курсор на экране соответствующим образом. Когда курсор перемещается над различными частями окна или в разные окна, система (или приложение) изменяет внешний вид курсора. Например, когда курсор пересекается над гиперссылкой, система меняет курсор с стрелки на руки.

![изменение стандартного курсора на руки при наведении на гиперссылку](images/cursorchangingstate.png)

Если в системе нет мыши, система отображает и перемещает курсор, только когда пользователь выбирает определенные системные команды, например, используемые для изменения размера или перемещения окна. Чтобы предоставить пользователю метод отображения и перемещения курсора, когда мышь недоступна, приложение может использовать функции курсора для имитации перемещения мыши. Учитывая эту возможность моделирования, пользователь может перемещать курсор с помощью клавиш со стрелками.

## <a name="cursor-creation"></a>Создание курсора

Поскольку стандартные курсоры заранее определены, их не нужно создавать. Чтобы использовать стандартный курсор, приложение получает маркер курсора с помощью функции [**лоадкурсор**](/windows/desktop/api/Winuser/nf-winuser-loadcursora) или [**лоадимаже**](/windows/desktop/api/Winuser/nf-winuser-loadimagea) . *Маркер курсора* — это уникальное значение типа **хкурсор** , определяющее стандартный или пользовательский курсор.

Чтобы создать настраиваемый курсор для приложения, обычно используется графическое приложение и курсор включается в качестве ресурса в файл определения ресурса приложения. Во время выполнения вызовите [**лоадкурсор**](/windows/desktop/api/Winuser/nf-winuser-loadcursora) , чтобы получить маркер курсора. Ресурсы курсоров содержат данные для нескольких различных устройств вывода. Функция **лоадкурсор** автоматически выбирает наиболее подходящие данные для текущего устройства вывода. Для загрузки курсора непосредственно из. CUR или. ANI, используйте функцию [**лоадкурсорфромфиле**](/windows/desktop/api/Winuser/nf-winuser-loadcursorfromfilea) .

Можно также создать пользовательский курсор во время выполнения с помощью функции [**креатеикониндирект**](/windows/desktop/api/Winuser/nf-winuser-createiconindirect) , которая создает курсор на основе содержимого структуры [**иконинфо**](/windows/desktop/api/Winuser/ns-winuser-iconinfo) . Функция [**жетиконинфо**](/windows/desktop/api/Winuser/nf-winuser-geticoninfo) заполняет эту структуру координатами горячей точки и информацией о связанной маске и цвете.

Приложения должны реализовывать пользовательские курсоры как ресурсы и использовать [**лоадкурсор**](/windows/desktop/api/Winuser/nf-winuser-loadcursora), [**лоадкурсорфромфиле**](/windows/desktop/api/Winuser/nf-winuser-loadcursorfromfilea)или [**лоадимаже**](/windows/desktop/api/Winuser/nf-winuser-loadimagea) , а не создавать курсор во время выполнения. Использование ресурсов курсора позволяет избежать зависимости устройств, упрощает локализацию и позволяет приложениям совместно использовать макеты курсоров.

Функция [**креатеиконфромресаурцеекс**](/windows/desktop/api/Winuser/nf-winuser-createiconfromresourceex) позволяет приложению создавать значки и курсоры на основе данных ресурса. **Креатеиконфромресаурцеекс** создает курсор на основе данных двоичных ресурсов из других исполняемых файлов (exe) или библиотек DLL. Перед ним должны стоять вызовы функции [**лукупиконидфромдиректорекс**](/windows/desktop/api/Winuser/nf-winuser-lookupiconidfromdirectoryex) , а также несколько функций ресурсов. **Лукупиконидфромдиректорекс** определяет наиболее подходящие данные курсора для текущего устройства вывода. Дополнительные сведения о функциях ресурсов см. в разделе [ресурсы](resources.md).

## <a name="cursor-location-and-appearance"></a>Расположение и внешний вид курсора

Система автоматически отображает курсор мыши и обновляет его позицию на экране. Вы можете получить текущие экранные координаты курсора и переместить курсор в любое место на экране с помощью функций [**жеткурсорпос**](/windows/desktop/api/Winuser/nf-winuser-getcursorpos) и [**сеткурсорпос**](/windows/desktop/api/Winuser/nf-winuser-setcursorpos) соответственно.

Вы также можете получить маркер текущего курсора с помощью функции [**oncursor**](/windows/desktop/api/Winuser/nf-winuser-getcursor) , а также задать курсор с помощью функции [**сеткурсор**](/windows/desktop/api/Winuser/nf-winuser-setcursor) . После вызова **сеткурсор** внешний вид курсора не меняется до тех пор, пока указатель мыши не будет перемещен, курсор явно задается другим курсором или выполняется системная команда.

Когда пользователь перемещает мышь, система перерисовывает курсор в новом месте. Система автоматически перерисовывает дизайн курсора, связанный с окном, на которое указывает курсор.

Можно скрыть и снова отобразить курсор, не изменяя дизайн курсора с помощью функции [**шовкурсор**](/windows/desktop/api/Winuser/nf-winuser-showcursor) . Эта функция использует внутренний счетчик, чтобы определить, когда следует скрывать или отображать курсор. Попытка отобразить курсор увеличивает значение счетчика; попытка скрыть курсор уменьшает значение счетчика. Курсор отображается только в том случае, если этот счетчик больше или равен нулю.

Функция [**жеткурсоринфо**](/windows/desktop/api/Winuser/nf-winuser-getcursorinfo) получает следующие сведения для глобального курсора: указывает, является ли курсор скрытым или отображается, маркером для курсора и координатами курсора.

## <a name="cursor-confinement"></a>Конфинемент курсора

Можно ограничить курсор на прямоугольную область экрана с помощью функции [**клипкурсор**](/windows/desktop/api/Winuser/nf-winuser-clipcursor) . Это полезно, когда пользователь должен ответить на определенное событие в пределах области прямоугольника. Например, **клипкурсор** можно использовать для ограничения курсора на модальное диалоговое окно, предотвращая взаимодействие пользователя с другими окнами, пока диалоговое окно не закроется.

Функция [**жетклипкурсор**](/windows/desktop/api/Winuser/nf-winuser-getclipcursor) получает экранные координаты прямоугольной области, к которой курсор временно ограничен. Если необходимо ограничить курсор, можно также использовать эту функцию для сохранения координат исходной области, в которой курсор может перемещаться. Затем можно восстановить курсор в исходную область, когда новая конфинемент больше не нужна.

## <a name="cursor-destruction"></a>Уничтожение курсора

Вы можете уничтожить маркер курсора и освободить память, используемую курсором, вызвав функцию [**дестройкурсор**](/windows/desktop/api/Winuser/nf-winuser-destroycursor) . Однако эта функция не влияет на общий курсор. Общий курсор действителен, пока модуль, из которого он был загружен, остается в памяти. Следующие функции получают общий курсор:

-   [**лоадкурсор**](/windows/desktop/api/Winuser/nf-winuser-loadcursora)
-   [**лоадкурсорфромфиле**](/windows/desktop/api/Winuser/nf-winuser-loadcursorfromfilea)
-   [**Лоадимаже**](/windows/desktop/api/Winuser/nf-winuser-loadimagea) (при использовании **\_ общего** флага LR)
-   [**Копимаже**](/windows/desktop/api/Winuser/nf-winuser-copyimage) (если используется флаг **\_ Копиретурнорг LR** , а *химаже* является общим курсором)

Если курсор, созданный с помощью функции [**креатеикониндирект**](/windows/desktop/api/Winuser/nf-winuser-createiconindirect) , больше не нужен, то следует уничтожить курсор. Функция [**дестройикон**](/windows/desktop/api/Winuser/nf-winuser-destroyicon) уничтожает маркер курсора и освобождает память, используемую курсором. Используйте эту функцию только для курсоров, созданных с помощью **креатеикониндирект**.

## <a name="cursor-duplication"></a>Дублирование курсора

Функция [**копикурсор**](/windows/desktop/api/Winuser/nf-winuser-copycursor) копирует маркер курсора. Это позволяет коду приложения или библиотеки DLL получить маркер в курсор, принадлежащий другому модулю. Затем, при освобождении другого модуля, модуль, который скопировал курсор, может по-прежнему использовать конструкцию курсора.

Сведения о том, как добавлять, удалять или заменять ресурсы курсора в исполняемых файлах, см. в разделе [ресурсы](resources.md).

## <a name="the-window-class-cursor"></a>Курсор класса окна

При регистрации класса окна с помощью функции [**registerClass**](/windows/desktop/api/winuser/nf-winuser-registerclassa) можно назначить ей курсор по умолчанию, известный как *курсор класса*. После того как приложение регистрирует класс Window, каждое окно этого класса имеет указанный курсор класса.

Чтобы переопределить курсор класса, обработайте сообщение [**WM \_ сеткурсор**](wm-setcursor.md) . Можно также заменить курсор класса с помощью функции [**сеткласслонг**](/windows/desktop/api/winuser/nf-winuser-setclasslonga) . Эта функция изменяет параметры окна по умолчанию для всех окон указанного класса. Дополнительные сведения см. в разделе [курсор класса](/windows/desktop/winmsg/about-window-classes).

 

 