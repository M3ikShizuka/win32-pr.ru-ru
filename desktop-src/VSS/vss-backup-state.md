---
description: 'Во время операции резервного копирования инициатор запроса использует Ивссбаккупкомпонентс:: Сетбаккупстате для определения типа выполняемой операции.'
ms.assetid: 43dcdac7-ed8e-4150-83eb-585e0e92f13c
title: Состояние резервного копирования VSS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 35701e1b576d9ea2e5464516589ae419dc73b74898768af06e974da05afffa8c
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119056222"
---
# <a name="vss-backup-state"></a>Состояние резервного копирования VSS

Во время операции резервного копирования инициатор запроса использует [**ивссбаккупкомпонентс:: сетбаккупстате**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate) для определения типа выполняемой операции.

Эта информация не включается в форму с простым извлечением в документе компоненты резервного копирования, поэтому разработчики инициаторов должны хранить эти сведения отдельно на любом носителе резервных копий.

Состояние резервного копирования содержит следующее:

<dl> <dt>

<span id="Backup_Type"></span><span id="backup_type"></span><span id="BACKUP_TYPE"></span>Тип резервного копирования
</dt> <dd>

Тип резервного копирования задает критерии для идентификации файлов для резервного копирования. Оценка этих критериев должна выполняться с помощью API VSS.

При принятии решения о типе резервной копии и о том, какие модули записи будут работать, запрашивающие стороны должны проанализировать типы (или схемы — см. раздел [поддержка схемы резервного копирования](writer-backup-schema-support.md)) операций резервного копирования, которые поддерживает каждый из модулей записи системы. Резервные копии в VSS могут иметь следующие типы:

-   Full ( \_ \_ полная очистка VSS) — файлы будут архивироваться независимо от даты последнего резервного копирования. Будет обновлен Журнал резервного копирования каждого файла, и этот тип резервного копирования можно использовать в качестве основы для добавочной или разностной резервной копии. Для восстановления полной резервной копии требуется только один образ резервной копии.
-   Копировать резервную копию \_ ( \_ в виде BT-копии VSS), как и в \_ случае с типом "BT-полная резервная копия VSS" \_ , резервное копирование файлов выполняется независимо от даты последнего резервного копирования. Однако журнал резервного копирования каждого файла не будет обновлен, и такой тип резервного копирования нельзя использовать в качестве основы для добавочной или разностной резервной копии.
-   Добавочная ( \_ \_ добавочная служба VSS) — API VSS используется, чтобы гарантировать копирование только тех файлов, которые были изменены или добавлены с момента последнего полного или добавочного резервного копирования на носитель. Для восстановления добавочной резервной копии требуется исходный образ резервного копирования и все добавочные образы резервных копий, созданные с момента создания исходной резервной копии.
-   Разностная (VSS \_ BT \_ разностная) — API VSS используется, чтобы гарантировать копирование только тех файлов, которые были изменены или добавлены с момента последнего полного резервного копирования, на носитель. все промежуточные данные резервных копий игнорируются. Для восстановления разностной резервной копии требуется исходный образ резервной копии и последняя разностная резервная копия, созданная с момента последнего полного резервного копирования.
-   Файл журнала ( \_ Журнал VSS BT \_ ) — резервное копирование выполняется только для файлов журнала модуля записи (файлов, добавленных в компонент с помощью метода [**Ивсскреатевритерметадата:: адддатабаселогфилес**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles) и получаемых путем вызова [**ивссвмкомпонент:: жетдатабаселогфиле**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdatabaselogfile)). Этот тип резервного копирования относится только к VSS.

Разработчики могут реализовать эти резервные копии с помощью сведений и методов за пределами VSS. Только когда инициатор запроса реализует резервную копию с помощью API VSS, должна иметься один из перечисленных типов резервных копий. Например, инициатор запроса участвует в \_ \_ резервной копии журнала VSS BT только в том случае, если он использовал сведения, возвращенные [**Ивссвмкомпонент:: жетдатабаселогфиле**](/windows/desktop/api/VsBackup/nf-vsbackup-ivsswmcomponent-getdatabaselogfile) для обнаружения файлов журнала. Аналогичным образом, \_ \_ добавочные разностные и VSS BT \_ \_ могут применяться только к операциям добавочного или разностного копирования, как описано в разделе [добавочные и разностные резервные копии](incremental-and-differential-backups.md).

</dd> <dt>

<span id="Specification_about_Selectability"></span><span id="specification_about_selectability"></span><span id="SPECIFICATION_ABOUT_SELECTABILITY"></span>Спецификация выбора
</dt> <dd>

Резервное копирование VSS может принять во внимание концепцию выбора компонентов в VSS — это называется запуском в [*режиме компонента*](vssgloss-c.md)или для их пропуска.

Примером, не выполняющимся в режиме компонента, будет создание резервной копии образа системы, где приложение резервного копирования потребовало бы от модуля записи обеспечить стабильность данных, но при этом выбор компонентов будет неважен.

</dd> <dt>

<span id="Saving_Bootable_State"></span><span id="saving_bootable_state"></span><span id="SAVING_BOOTABLE_STATE"></span>Сохранение загрузочного состояния
</dt> <dd>

VSS поддерживает сохранение работающего состояния системы в полностью загрузочной конфигурации. Однако это не всегда требуется, и подготовка модуля записи к сохранению загрузочного состояния может иногда снизить производительность работающей системы в реальном времени.

Таким образом, запрашивающие стороны указывают, будет ли резервная копия включать загрузочное состояние системы в качестве аргумента для [**ивссбаккупкомпонентс:: сетбаккупстате**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate). Модули записи определяют, должны ли они поддерживать сохранение состояния загрузочной системы путем вызова [**квссвритер:: исбутаблестатебаккедуп**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-isbootablesystemstatebackedup).

Даже если состояние загрузочной системы не выбрано, будут созданы теневые копии системных файлов и резервные копии файлов.

тем не менее, если резервная копия не сохранила состояние загрузочной системы (см. раздел [резервное копирование и восстановление состояния системы в Windows server 2003 R2 и Windows Server 2003 с пакетом обновления 1 (SP1](backing-up-and-restoring-system-state-under-vss.md))), следует соблюдать значительную осторожность в восстановлении системных файлов.

Вы не можете восстановить эту информацию из полученного документа компонентов резервного копирования, поэтому авторы инициаторов должны сохранить наличие резервной копии системы с загрузочным состоянием.

</dd> <dt>

<span id="Partial_File_Support"></span><span id="partial_file_support"></span><span id="PARTIAL_FILE_SUPPORT"></span>Частичная поддержка файлов
</dt> <dd>

Некоторые модули записи поддерживают восстановление файлов с помощью перезаписи частей файлов, которыми они управляют. Инициатор запроса может воспользоваться преимуществами этого метода, и если да, то он указывает, что нужно установить сведения в [**ивссбаккупкомпонентс:: сетбаккупстате**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setbackupstate).

</dd> </dl>

 

 



