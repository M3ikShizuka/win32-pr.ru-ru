---
description: Поставщики управляют работающими томами и создают их теневые копии по запросу.
ms.assetid: 4e6b46b0-df9e-4458-b0ac-e237d7656337
title: Поставщики
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6bb336dbb51fcbd715ea236ecdc0c62d81daf29d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105692889"
---
# <a name="providers"></a>Поставщики

[*Поставщики*](vssgloss-p.md) управляют работающими томами и создают их теневые копии по запросу.

В ответ на запрос от инициатора запроса поставщик создает события COM для сигнализации приложений с помощью теневой копии, затем создает и обслуживает эту копию, пока она больше не нужна.

В то время как теневая копия существует, поставщик создает среду, в которой есть две независимые копии тома, которые были скопированы: один запущенный диск используется и обновляется как обычная, а другой — с фиксированным и стабильным для резервного копирования.

Хотя поставщик по умолчанию предоставляется как часть Windows, другие поставщики могут предоставлять собственные реализации, оптимизированные для собственных предложений по оборудованию и программному обеспечению хранилища.

С точки зрения разработчика приложения для конечных пользователей или резервного копирования и восстановления, все поставщики будут иметь один и тот же интерфейс (см. раздел [Выбор поставщиков](selecting-providers.md)).

Все поставщики должны иметь возможность выполнять следующие действия:

-   Перехват запросов ввода-вывода между файловой системой и базовой системой массового хранения.
-   Захватывать и получать сведения о состоянии тома во время создания теневого копирования, сохраняя представление файлов на диске с неполными операциями ввода-вывода, которые отражаются в состоянии.
-   Используйте представление "точка во времени" для предоставления (минимальных версий приложений с поддержкой VSS) виртуального тома, содержащего теневые скопированные данные.

В зависимости от того, как это сделано, поставщик может иметь один из трех типов:

-   [Поставщик системы](#system-provider)
-   [Поставщики программного обеспечения](#software-providers)
-   [Поставщики оборудования](#hardware-providers)

## <a name="system-provider"></a>Поставщик системы

Один поставщик теневых копий, [*поставщик системы*](vssgloss-s.md), предоставляется как часть установки операционной системы Windows по умолчанию. В настоящее время поставщик системы является определенным экземпляром поставщика программного обеспечения. Однако это может измениться в будущем.

Для сохранения представления тома, содержащегося в теневой копии, поставщик системы использует метод копирования при записи. Копии секторов на диске, которые были изменены («diff»), начиная с начала создания теневой копии, хранятся в области хранения теневых копий.

Таким образом, поставщик системы может предоставлять динамический том, который может быть записан и прочитан обычным способом, и применять "diff" к данным динамического тома для эффективного предоставления замороженных данных теневой копии.

Для системного поставщика область хранения теневой копии должна находиться в томе NTFS. Том для теневого копирования не обязательно должен быть томом NTFS, однако среди подключенных к системе томов должен быть по крайней мере один том NTFS.

## <a name="software-providers"></a>Поставщики программного обеспечения

Поставщики теневого копирования программного обеспечения перехватывают и обрабатывают запросы ввода-вывода в программном уровне между файловой системой и программным обеспечением диспетчера томов. Эти поставщики реализуются как компонент DLL пользовательского режима и как минимум один драйвер устройства в режиме ядра (как правило, но не обязательно) драйвер фильтра хранилища. Работа по созданию этих теневых копий выполняется в программном обеспечении.

Поставщик теневого копирования программного обеспечения должен поддерживать представление тома "на момент времени", имея доступ к набору файлов, который можно использовать для правильного повторного создания состояния тома перед теневой копией. Примером этого является метод копирования при записи поставщика системы.

Однако служба VSS не накладывает никаких ограничений на то, какие методы используются поставщиками программного обеспечения для создания и обслуживания теневых копий, а сторонние производители могут реализовать свои поставщики программного обеспечения по мере их появлении.

Кроме того, служба VSS обеспечивает поддержку большинства функций поставщиков теневого копирования программного обеспечения, таких как определение точки во времени, синхронизацию данных и очистку, предоставление общего интерфейса для резервного копирования приложений и управление теневой копией.

Поставщик программного обеспечения, по определению, будет применяться к более широкому спектру платформ хранения, чем поставщик оборудования, и должен иметь одинаковую возможность работать с базовыми дисками или логическими томами. Это общее снижение производительности, которое может быть доступно при реализации теневых копий на оборудовании, и не использует какие-либо функции отслеживания томов или зеркального отображения файлов, характерные для конкретного поставщика.

## <a name="hardware-providers"></a>Поставщики оборудования

Аппаратные поставщики теневого копирования перехватывают запросы ввода-вывода из файловой системы на уровне оборудования, работая в сочетании с адаптером или контроллером хранилища оборудования. Работа по созданию теневой копии выполняется адаптером узла, устройством хранения или RAID-контроллером за пределами операционной системы.

Эти поставщики реализуются как компонент DLL пользовательского режима, взаимодействующий с оборудованием, которое будет предоставлять данные теневого копирования. Таким образом, поставщику теневого копирования может потребоваться вызвать или создать другие компоненты режима ядра.

Поставщики оборудования предоставляют теневые копии всех дисков или логических устройств (LUN) VSS. Запросы по-прежнему работают с теневыми копиями томов. все сопоставления томов и дисков обрабатываются внутренним образом с помощью VSS. Теневые копии, созданные поставщиками оборудования для томов, расположенных на динамических дисках, имеют определенное требование: они не могут быть импортированы в одну и ту же систему. Они должны быть созданы и импортированы в другую систему.

Хотя поставщик аппаратного теневого копирования использует функции VSS, определяющие момент времени, обеспечивает синхронизацию данных, управляет теневой копией и предоставляет общий интерфейс с приложениями резервного копирования, VSS не задает базовый механизм, по которому поставщик оборудования создает и поддерживает теневые копии.

 

 



