---
description: 'Модель смены состояния в поставщике теневого копирования упрощается благодаря сериализации создания теневого копирования с момента вызова Ивссбаккупкомпонентс:: Стартснапшотсет до тех пор, пока не будет возвращен вызов Ивссбаккупкомпонентс::D Оснапшотсет.'
ms.assetid: 5dbf0fb3-53cb-4532-9a8f-bd955afe16c4
title: Переходы состояний в поставщиках теневого копирования
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ad6141b9b8f221a1e67e95fde1e6b33ad819c0cbdead57eeb676164e89acc392
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118121604"
---
# <a name="state-transitions-in-shadow-copy-providers"></a>Переходы состояний в поставщиках теневого копирования

Модель смены состояния в поставщике теневого копирования упрощается благодаря сериализации создания теневого копирования с момента вызова [**ивссбаккупкомпонентс:: стартснапшотсет**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-startsnapshotset) до тех пор, пока не будет возвращен вызов [**Ивссбаккупкомпонентс::D оснапшотсет**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset) . Если другой инициатор запроса попытается создать теневую копию в течение этого времени, вызов **стартснапшотсет** завершится ошибкой с **\_ \_ настроенным моментальным снимком \_ \_ \_ "ошибка VSS E**", указывая на то, что второй инициатор запроса должен подождать и повторить попытку.

VSS будет вызывать метод [**ивсспровидеркреатеснапшотсет:: абортснапшотс**](/windows/desktop/api/VsProv/nf-vsprov-ivssprovidercreatesnapshotset-abortsnapshots) только после того, как инициатор запроса вызвал [**доснапшотсет**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset), даже если теневая копия завершается сбоем или прерывается до этой точки. Это означает, что поставщик не получит вызов **абортснапшотс** до тех пор, пока не будет вызван [**Ивсспровидеркреатеснапшотсет:: ендпрепареснапшотс**](/windows/desktop/api/VsProv/nf-vsprov-ivssprovidercreatesnapshotset-endpreparesnapshots) . Если теневая копия прерывается или завершается неудачей до этой точки, поставщик не получает указания до запуска новой теневой копии. По этой причине поставщик должен быть готов к обработке непоследовательного вызова [**ивсшардвареснапшотпровидер:: бегинпрепареснапшот**](/windows/desktop/api/VsProv/nf-vsprov-ivsshardwaresnapshotprovider-beginpreparesnapshot) в любой точке. Этот непоследовательный вызов представляет начало новой последовательности теневых копий и будет иметь новый идентификатор набора теневых копий.

 

 



