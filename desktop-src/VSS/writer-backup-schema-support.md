---
description: Для полной реализации резервной копии требуется участие в системе записи системы.
ms.assetid: ea504f8e-26d9-499e-b3e9-03515b480a75
title: Поддержка схемы резервного копирования модуля записи
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 56b037591d6deda2657acdfe4f4e4755fef96b52bafc92e4cc51e4ef7119de1f
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118344247"
---
# <a name="writer-backup-schema-support"></a>Поддержка схемы резервного копирования модуля записи

Для полной реализации резервной копии требуется участие в системе записи системы. Различные типы поддерживаемых резервных копий называются схемами и указываются с помощью битовой маски (или побитовой или) членов [**перечисления \_ \_ схемы резервного копирования VSS**](/windows/desktop/api/Vss/ne-vss-vss_backup_schema) . В настоящее время поддерживаются следующие допустимые схемы:

-   Схема по умолчанию: полная \_ ( \_ неопределенная область восстановления службы VSS). указывает, что модуль записи поддерживает резервную копию, в которой будут создаваться резервные копии всех файлов, независимо от даты последнего резервного копирования. Журнал резервного копирования каждого файла может быть обновлен инициатором запроса, и модули записи, поддерживающие \_ \_ значение перечисления с меткой времени "BS" VSS, будут хранить обновленную отметку времени с инициатором запроса. Эту схему резервного копирования можно использовать в качестве основы добавочной или разностной резервной копии.

    Для восстановления полной резервной копии требуется только один образ резервной копии.

-   Копирование резервной копии \_ ( \_ копия BS VSS), как \_ и \_ схема полного резервного копирования в VSS, указывает, что модуль записи поддерживает резервную копию, в которой будут создаваться резервные копии всех файлов независимо от даты последнего резервного копирования. Однако журнал резервного копирования каждого файла не будет обновлен ни инициатором запроса, ни модулем записи, и такая резервная копия не может использоваться в качестве основы для добавочной или разностной резервной копии.
-   Файл журнала ( \_ Журнал VSS \_ ) — резервное копирование требуется только для файлов журнала модуля записи. Для этого необходимо, чтобы модуль записи добавил хотя бы один файл по крайней мере в один компонент с помощью метода [**ивсскреатевритерметадата:: адддатабаселогфилес**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-adddatabaselogfiles) . Этот тип резервного копирования относится только к VSS.
-   Пользовательские расположения для восстановления ( \_ \_ модуль записи в VSS \_ поддерживает \_ новый \_ целевой объект) — указывает поддержку модуля записи для изменения инициатора запроса во время восстановления, где восстанавливаются файлы. Это означает, что модуль записи был закодирован для проверки такого перемещения (с помощью [**ивсскомпонент:: жетневтаржет**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getnewtarget)) и имеет емкость для работы с перемещенными файлами.
-   Восстановление с помощью Move ( \_ \_ модуль записи VSS \_ поддерживает \_ Восстановление \_ с \_ перемещением) — указывает, что модуль записи поддерживает запуск нескольких экземпляров модуля записи с одним и тем же идентификатором класса и поддерживает инициатор запроса, который перемещает компонент в другой экземпляр модуля записи во время восстановления. Экземпляр модуля записи указывается с помощью имени Постоянного экземпляра модуля записи, переданного в качестве параметра *всзвритеринстанценаме* в метод [**Квссвритер:: Initialize**](/windows/desktop/api/VsWriter/nf-vswriter-cvsswriter-initialize) . Инициатор запроса может получить имя экземпляра модуля записи с помощью [**ивссексаминевритерметадатаекс:: жетидентитекс**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadataex-getidentityex) и переместить компоненты во время восстановления с помощью [**Ивссбаккупкомпонентсекс:: сетселектедфорресторикс**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex-setselectedforrestoreex).

    **Windows Server 2003 и Windows XP:** это значение не поддерживается до Windows Server 2003 с пакетом обновления 1 (SP1).

-   Добавочное ( \_ \_ Добавочное изменение VSS) — указывает, что модуль записи использует API VSS, чтобы помочь инициатору запроса, гарантируя, что только файлы, которые были изменены или добавлены с момента последнего полного или добавочного резервного копирования, будут скопированы на носитель хранения.

    Для восстановления добавочной резервной копии требуется исходный образ резервного копирования и все добавочные образы резервных копий, созданные с момента создания исходной резервной копии.

-   Разностная ( \_ \_ разностная резервная копия VSS). указывает, что модуль записи использует API VSS, чтобы гарантировать, что только файлы, которые были изменены или добавлены с момента последнего полного резервного копирования, будут скопированы на носитель. все промежуточные данные резервных копий игнорируются.

    Для восстановления разностной резервной копии требуется исходный образ резервной копии и последняя разностная резервная копия, созданная с момента последнего полного резервного копирования.

-   Добавочное или разностное: поддержка меток времени ( \_ Метка времени VSS \_ ) — указывает, что модуль записи поддерживает использование механизма временной метки VSS для включения файлов в добавочные или разностные операции. Во время резервного копирования модуль записи должен сохранить метку резервного копирования [*набора файлов*](vssgloss-f.md) с помощью метода [**Ивсскомпонент:: сетбаккупстамп**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-setbackupstamp) , а при восстановлении извлечь его с помощью [**ивсскомпонент:: жетпревиаусбаккупстамп**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-getpreviousbackupstamp).
-   Добавочный/разностный: время последнего изменения ( \_ \_ Последнее изменение VSS \_ ) — указывает, что при реализации добавочных или разностных резервных копий с использованием различных файлов средство записи может предоставлять сведения о времени последнего изменения независимо друг от друга. Эти сведения могут предоставляться инициатору запроса через метод [**ивсскомпонент:: адддифференцедфилесбиластмодифитиме**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscomponent-adddifferencedfilesbylastmodifytime) .
-   Добавочное/разностное: ограничение поддержки \_ ( \_ \_ добавочная \_ разностная копия VSS) — указывает, поддерживает ли модуль записи как разностные, так и инкрементные схемы резервного копирования, но только монопольно: например, нельзя выполнить добавочное резервное копирование с разностной резервной копией.
-   Независимое состояние системы ( \_ \_ состояние независимой \_ системы VSS \_ ) — указывает, что модуль записи поддерживает резервное копирование данных, которые являются частью состояния системы, но также могут создавать резервные копии независимо от состояния системы.

    **Windows Server 2003 и Windows XP:** это значение не поддерживается до Windows Vista.

-   Восстановление Roll-Forward ( \_ Восстановление VSS \_ Накату \_ ) — указывает, что модуль записи поддерживает инициатор запроса, устанавливающий точку отката с помощью [**IVssBackupComponentsEx2:: сетроллфорвард**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex2-setrollforward).

    **Windows Server 2003 и Windows XP:** это значение не поддерживается до Windows Vista.

-   Restore Rename \_ ( \_ Rename, Restore, восстановление, переименование VSS \_ ) — указывает, что модуль записи поддерживает имя для восстановления с помощью [**IVssBackupComponentsEx2:: сетресторенаме**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex2-setrestorename).

    **Windows Server 2003 и Windows XP:** это значение не поддерживается до Windows Vista.

-   Полномочное восстановление ( \_ \_ полномочное \_ Восстановление VSS) — указывает, что модуль записи поддерживает параметр запрашивающего принудительного восстановления с помощью [**IVssBackupComponentsEx2:: сетаусоритативересторе**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponentsex2-setauthoritativerestore).

Модули записи устанавливают свои схемы с помощью метода [**ивсскреатевритерметадата:: сетбаккупсчема**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setbackupschema) , а инициатор запроса получает схему каждого модуля записи путем вызова [**Ивссексаминевритерметадата:: жетбаккупсчема**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getbackupschema).

 

 



