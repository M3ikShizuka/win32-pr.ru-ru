---
description: 'VSS допускает существование нескольких теневых копий одновременно, но позволяет выполнять только один процесс создания теневых копий между вызовом Ивссбаккупкомпонентс:: Стартснапшотсет и возвратом из вызова Ивссбаккупкомпонентс::D Оснапшотсет.'
ms.assetid: 26657fc2-180f-4ebb-820c-2159e7fe7584
title: Обработка ошибок в поставщиках теневого копирования
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0963df4c9c81c2cd9f96e7c1828243f3910a1df34d5ef94a714f17c57b404b5c
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "120032684"
---
# <a name="error-handling-in-shadow-copy-providers"></a>Обработка ошибок в поставщиках теневого копирования

VSS допускает существование нескольких теневых копий одновременно, но позволяет выполнять только один процесс создания теневых копий между вызовом [**ивссбаккупкомпонентс:: стартснапшотсет**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-startsnapshotset) и возвратом из вызова [**Ивссбаккупкомпонентс::D оснапшотсет**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-dosnapshotset).

## <a name="no-partial-commit"></a>Без частичной фиксации

Если какой-либо поставщик не может создать теневую копию на любом томе или LUN в наборе теневых копий, создание всего набора теневых копий завершается сбоем. Это сделано намеренно. Такая схема упрощает проблемы поведения, связанные с семантикой частичного сбоя, и поддерживает согласованную точку во времени для всех теневых копий в наборе.

## <a name="reporting-fault-conditions"></a>Отчеты об условиях сбоя

При возникновении ошибки или состояния сбоя поставщика поставщик должен зарегистрировать ошибку в журнале событий приложений. К ним относятся, помимо прочего, любые специфические для поставщика ошибки при создании или импорте набора теневых копий или при сбое выделения ресурсов для теневой копии при записи после создания. Это ведение журнала не должно выполняться в течение времени, когда тома в наборе теневых копий находятся в замороженном состоянии.

## <a name="valid-provider-return-values"></a>Допустимые возвращаемые значения поставщика

В следующей таблице перечислены допустимые коды возврата для методов поставщика и их значений.



| Значение                                                                                                                                                                              | Описание                                                                                                                                                                                                                                            |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="S_OK"></span><span id="s_ok"></span>\_ОК<br/>                                                                                                                     | Метод успешно выполнен.<br/>                                                                                                                                                                                                                  |
| <span id="E_OUTOFMEMORY"></span><span id="e_outofmemory"></span>E \_ OUTOFMEMORY<br/>                                                                                          | Поставщик не хватает памяти или других системных ресурсов.<br/>                                                                                                                                                                                    |
| <span id="E_INVALIDARG"></span><span id="e_invalidarg"></span>E \_ INVALIDARG<br/>                                                                                             | Одно из значений параметра недопустимо.<br/>                                                                                                                                                                                                   |
| <span id="E_ACCESSDENIED"></span><span id="e_accessdenied"></span>E \_ ACCESSDENIED<br/>                                                                                       | Непривилегированный клиент пытался вызвать поставщик.<br/>                                                                                                                                                                                |
| <span id="VSS_E_BAD_STATE"></span><span id="vss_e_bad_state"></span>\_ \_ неправильное \_ состояние VSS<br/>                                                                                  | Либо поставщик не поддерживает запрошенную операцию, либо операция не может быть выполнена над объектом, так как объект находится в неправильном состоянии.<br/>                                                                                     |
| <span id="VSS_E_OBJECT_NOT_FOUND"></span><span id="vss_e_object_not_found"></span>\_объект VSS \_ E \_ не \_ найден<br/>                                                            | Параметр ссылается на объект, который не был найден (например, идентификатор теневой копии, идентификатор набора теневых копий или том).<br/>                                                                                                                               |
| <span id="VSS_E_INSUFFICIENT_STORAGE"></span><span id="vss_e_insufficient_storage"></span>\_ \_ недостаточно места в \_ хранилище VSS<br/>                                                 | Поставщик не может выполнить операцию из-за нехватки места на диске.<br/>                                                                                                                                                           |
| <span id="VSS_E_VOLUME_NOT_SUPPORTED"></span><span id="vss_e_volume_not_supported"></span>том с VSS \_ E \_ \_ не \_ поддерживается<br/>                                                | На этом компьютере нет поставщика, поддерживающего запрошенную операцию на томе.<br/>                                                                                                                                                                |
| <span id="VSS_E_VOLUME_NOT_SUPPORTED_BY_PROVIDER"></span><span id="vss_e_volume_not_supported_by_provider"></span>\_тома VSS \_ E \_ не \_ поддерживаются \_ \_ поставщиком<br/>          | Поставщик не поддерживает том.<br/>                                                                                                                                                                                                   |
| <span id="VSS_E_MAXIMUM_NUMBER_OF_SNAPSHOTS_REACHED"></span><span id="vss_e_maximum_number_of_snapshots_reached"></span>\_ \_ \_ достигнуто максимальное число \_ \_ моментальных снимков \_ VSS E<br/> | Поставщик достиг максимального количества теневых копий, которое он может поддерживать.<br/>                                                                                                                                                           |
| <span id="VSS_E_PROVIDER_VETO"></span><span id="vss_e_provider_veto"></span>\_ \_ запрет поставщика VSS \_ E<br/>                                                                      | Поставщик обнаружил внутреннюю ошибку во время выполнения, которая не соответствует другому возвращаемому значению. Поставщик также должен записать в журнал событий приложений событие, предоставляющее пользователю сведения о том, как устранить эту проблему.<br/> |
| <span id="VSS_E_CANNOT_REVERT_DISKID"></span><span id="vss_e_cannot_revert_diskid"></span>VSS \_ E \_ не может \_ вернуть \_ DISKID<br/>                                                | Не удалось установить запрошенное значение для подписи MBR или идентификатора GPT для одного или нескольких дисков. Дополнительные сведения см. в журнале событий приложений.<br/>                                                                                            |



 

Поставщик не должен пытаться вернуть другие коды ошибок.

Если поставщик возвращает код ошибки, который не является ожидаемым (например, **" \_ false**", " **e \_ Fail** **", "e expected \_**" или " **\_ прервано**"), VSS записывает событие в журнал событий, в котором упоминается поставщик и метод со сбоем, а затем преобразует ошибку в **VSS \_ E \_ непредвиденную \_ \_ ошибку поставщика** перед возвратом в инициатор запроса. Это не делается для каких-либо операций возврата из [**ивсспровидеркреатеснапшотсет:: абортснапшотс**](/windows/desktop/api/VsProv/nf-vsprov-ivssprovidercreatesnapshotset-abortsnapshots) или [**ивсспровидернотификатионс:: unload**](/windows/desktop/api/VsProv/nf-vsprov-ivssprovidernotifications-onunload).

 

 




