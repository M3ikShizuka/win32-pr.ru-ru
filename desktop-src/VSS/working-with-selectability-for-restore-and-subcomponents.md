---
description: Возможность выбора для восстановления позволяет инициатору запроса определить, когда компонент может быть восстановлен отдельно.
ms.assetid: 684dc50f-5d7b-4c95-85dd-77c320d65fff
title: Работа с выборкой для восстановления и подкомпонентов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f1186c9517af8e7e7b914b9508e10a2b4c8d1961afdbf6d68c2dadcede58c4c4
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "117937385"
---
# <a name="working-with-selectability-for-restore-and-subcomponents"></a>Работа с выборкой для восстановления и подкомпонентов

Возможность выбора для восстановления позволяет инициатору запроса определить, когда компонент может быть восстановлен отдельно. Компонент, который был включен для резервного копирования, может отображаться одним из двух способов:

-   Возможно, компонент был [*явно включен*](vssgloss-e.md) в резервную копию. Эти компоненты имеют соответствующий экземпляр [**ивсскомпонент**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) в документе компонента резервного копирования. Эти компоненты включаются в восстановление с помощью [**ивссбаккупкомпонентс:: сетселектедфорресторе**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore).
-   Возможно, компонент был [*неявно включен*](vssgloss-i.md) в резервную копию. Эти компоненты не имеют соответствующего экземпляра [**ивсскомпонент**](/windows/desktop/api/VsWriter/nl-vswriter-ivsscomponent) в документе архивных компонентов. Однако в документе всегда будет экземпляр **ивсскомпонент** для некоторого компонента предка. Эти компоненты включаются в восстановление с помощью [**ивссбаккупкомпонентс:: аддресторесубкомпонент**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent).

Любой компонент, явно включенный в резервную копию, всегда может быть выбран для восстановления отдельно, независимо от значения выборки для восстановления. Инициатор запроса вызывает [**ивссбаккупкомпонентс:: сетселектедфорресторе**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-setselectedforrestore), передавая ему идентификатор модуля записи, логический путь и имя конкретного компонента. Компоненты, неявно включенные в резервную копию, будут восстановлены при восстановлении явно включенного предка. Неявно включенные компоненты можно выбирать отдельно для восстановления только в том случае, если они помечены как доступные для восстановления. Инициатор запроса сначала вызывает **ивссбаккупкомпонентс:: сетселектедфорресторе** на ближайшем явно включенном компоненте предка, а затем вызывает [**Ивссбаккупкомпонентс:: аддресторесубкомпонент**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-addrestoresubcomponent) в компоненте предка, чтобы выбрать неявно включенный компонент для восстановления. После этого будет восстановлен только неявно выбранный компонент. все остальные компоненты набора компонентов не будут восстановлены.

В отличие от выбора для резервного копирования, которое всегда должно быть задано явно при добавлении компонента с помощью [**ивсскреатевритерметадата:: AddComponent**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-addcomponent), возможность выбора для восстановления имеет значение по умолчанию false, которое может быть переопределено.

Поскольку компоненты верхнего уровня (компоненты с пустым логическим путем) можно явно включать в резервную копию, выбор для восстановления не имеет смысла для этих компонентов.

 

 



