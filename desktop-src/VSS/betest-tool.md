---
description: Тестирование является инициатором запроса VSS, который проверяет расширенные операции резервного копирования и восстановления.
ms.assetid: a6cc7308-a9fa-4a84-9e7c-4d0adda28db5
title: Средство тестирования
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7559c304532b337214108435b740595897694f7c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "103913387"
---
# <a name="betest-tool"></a>Средство тестирования

Тестирование является инициатором запроса VSS, который проверяет расширенные операции резервного копирования и восстановления. Это средство можно использовать для проверки использования приложением сложных функций VSS, как показано ниже.

-   Добавочная и разностная резервные копии
-   Сложные параметры восстановления, такие как полномочное восстановление
-   Параметры Накату

> [!Note]  
> Тестирование включено в пакет средств разработки программного обеспечения Microsoft Windows (SDK) для Windows Vista и более поздних версий. Пакет SDK для VSS 7,2 включает версию теста "тестирование", которая выполняется только в Windows Server 2003. В этом разделе описывается Windows SDKная версия теста, а не версия Windows Server 2003, входящая в состав пакета SDK для VSS 7,2. Сведения о скачивании Windows SDK и пакета SDK для VSS 7,2 см. в разделе [Служба теневого копирования томов](volume-shadow-copy-service-portal.md).

 

В Windows SDK установки средство тестирования можно найти в `%Program Files(x86)%\Windows Kits\8.1\bin\x64` (для 64-разрядной версии Windows) и `%Program Files(x86)%\Windows Kits\8.1\bin\x86` (для 32-разрядной версии Windows).

## <a name="running-the-betest-tool"></a>Запуск средства тестирования

Чтобы запустить средство тестирования из командной строки, используйте следующий синтаксис:

 *Параметры командной строки* для тестирования

В следующем примере показано, как использовать средство "тестирование" вместе с [средством записи теста VSS](vss-test-writer-tool.md), которое является модулем записи VSS.

**Пример использования средства тестирования**

1.  Создайте тестовый каталог с именем C: \\ Test. Скопируйте следующие файлы в этот каталог:
    -   betest.exe
    -   vswriter.exe
    -   [BetestSample.xml](#sample-xml-configuration-file-betestsamplexml)
    -   [VswriterSample.xml](#sample-xml-configuration-file-vswritersamplexml)
2.  Создайте каталог с именем C: \\ тестпас. Помещайте в этот каталог некоторые файлы тестовых данных.
3.  Создайте каталог с именем C: \\ баккупдестинатион. Оставьте этот каталог пустым.
4.  Откройте два окна команд с повышенными привилегиями и настройте рабочий каталог в каждом из на C: \\ Test.
5.  В первом окне командной строки запустите [средство записи теста VSS](vss-test-writer-tool.md) следующим образом:

    **vswriter.exe VswriterSample.xml**

    Файл vswriterSample.xml настраивает средство записи тестов VSS (всвритер) для сообщения о содержимом каталога c: \\ тестпас в процессе подготовки к операции резервного копирования. Обратите внимание, что средство записи тестов VSS не будет создавать выходные данные до тех пор, пока не обнаружит действия от запрашивающей стороны, например, для выполнения проверки. Чтобы закрыть средство записи тестов VSS, нажмите клавиши CTRL + C.

6.  Во втором окне команды используйте средство тестирования для выполнения операции резервного копирования следующим образом.

    **betest.exe/B/S backup.xml/D C: \\ баккупдестинатион/x BetestSample.xml**

    В ходе тестирования выполняется резервное копирование файлов из каталога C: \\ тестпас в каталог c: \\ баккупдестинатион. Документ компонента резервного копирования будет сохранен на языке C: \\ test \\backup.xml.

7.  Если операция резервного копирования прошла успешно, удалите содержимое каталога C: \\ тестпас и используйте средство тестирования для выполнения операции восстановления следующим образом.

    **betest.exe/R/S backup.xml/D C: \\ баккупдестинатион/x BetestSample.xml**

## <a name="betest-tool-command-line-options"></a>Параметры Command-Line средства тестирования

Средство тестирования использует следующие параметры командной строки для задания выполняемой работы.

<dl> <dt>

<span id="_Auth"></span><span id="_auth"></span><span id="_AUTH"></span>**/аус**
</dt> <dd>

Выполняет принудительную операцию восстановления для Active Directory или Active Directory режиме приложения.

**Windows Server 2003:** Этот параметр командной строки не поддерживается.

</dd> <dt>

<span id="_B"></span><span id="_b"></span>**B**
</dt> <dd>

Выполняет операцию резервного копирования, но не выполняет восстановление.

</dd> <dt>

<span id="_BC"></span><span id="_bc"></span>**/бк**
</dt> <dd>

Выполняет только операцию резервного копирования.

**Windows Server 2003:** Этот параметр командной строки не поддерживается.

</dd> <dt>

<span id="_C_Filename"></span><span id="_c_filename"></span><span id="_C_FILENAME"></span>**/C** *имя файла*
</dt> <dd>

> [!Note]  
> Этот параметр командной строки предоставляется только для обеспечения обратной совместимости. Вместо него следует использовать параметр командной строки **/x** .

 

Выбирает компоненты для резервного копирования или восстановления в зависимости от содержимого файла конфигурации, заданного параметром *filename*. Этот файл должен содержать только символы ANSI в диапазоне от 0 до 127 и не должен превышать 1 МБ. Каждая строка в файле должна иметь следующий формат:

*Вритерид* : *ComponentName*;

Где *вритерид* — это идентификатор модуля записи, а *ComponentName* — имя одного из компонентов модуля записи. Имена идентификатора модуля записи и компонента должны быть заключены в кавычки и должны быть пробелами до и после двоеточия (:). Если указано два или более компонентов, их необходимо разделять запятыми. Пример:

"5affb034-969f-4919-8875-88f830d0ef89" : "TestFiles1", "TestFiles2", "TestFiles3";

</dd> <dt>

<span id="_D_Path"></span><span id="_d_path"></span><span id="_D_PATH"></span>**/D** *путь*
</dt> <dd>

Сохраните резервные копии файлов или восстановите их из каталога резервного копирования, указанного в параметре *path*.

</dd> <dt>

<span id="_NBC"></span><span id="_nbc"></span>**/нбк**
</dt> <dd>

Пропускает операцию резервного копирования завершено.

**Windows Server 2003:** Этот параметр командной строки не поддерживается.

</dd> <dt>

<span id="_O"></span><span id="_o"></span>**/O**
</dt> <dd>

Указывает, что резервная копия включает загрузочное состояние системы.

</dd> <dt>

<span id="_P"></span><span id="_p"></span>**/P**
</dt> <dd>

Создает постоянную теневую копию.

**Windows Server 2003:** Этот параметр командной строки не поддерживается.

</dd> <dt>

<span id="_Pre_Filename"></span><span id="_pre_filename"></span><span id="_PRE_FILENAME"></span> *Имя файла* /пре
</dt> <dd>

Если тип резервной копии, указанный в параметре командной строки **/t** , является добавочным или разностным, задайте для документа резервного копирования файл, указанный в поле *имя файла* для предыдущей полной или добавочной архивации.

**Windows Server 2003 и Windows XP:** Этот параметр командной строки не поддерживается.

</dd> <dt>

<span id="_R"></span><span id="_r"></span>**/R**
</dt> <dd>

Выполняет восстановление, но не выполняет резервное копирование. Аргумент должен использоваться вместе с параметром командной строки **/s** .

</dd> <dt>

<span id="_Rollback"></span><span id="_rollback"></span><span id="_ROLLBACK"></span>**/роллбакк**
</dt> <dd>

Создает теневую копию, которую можно использовать для отката приложения.

**Windows Server 2003:** Этот параметр командной строки не поддерживается.

</dd> <dt>

<span id="_S_Filename"></span><span id="_s_filename"></span><span id="_S_FILENAME"></span>**/S** *имя файла*
</dt> <dd>

В случае резервного копирования сохраняет документ резервной копии в файл, указанный параметром *filename*. В случае только восстановления загружает документ резервной копии из этого файла.

</dd> <dt>

<span id="_Snapshot"></span><span id="_snapshot"></span><span id="_SNAPSHOT"></span>**/снапшот**
</dt> <dd>

Создает теневую копию тома, но не выполняет резервное копирование и восстановление.

**Windows Server 2003:** Этот параметр командной строки не поддерживается.

</dd> <dt>

<span id="_StopError"></span><span id="_stoperror"></span><span id="_STOPERROR"></span>**/стоперрор**
</dt> <dd>

Останавливает выполнение теста при обнаружении ошибки первого модуля записи.

**Windows Server 2003:** Этот параметр командной строки не поддерживается.

</dd> <dt>

<span id="_T_BackupType"></span><span id="_t_backuptype"></span><span id="_T_BACKUPTYPE"></span>**/T** *BackupType*
</dt> <dd>

Указывает тип резервной копии. *BackupType* может быть полным, записывать, копировать, добавочным или разностным. Дополнительные сведения о типах резервных копий см. в статье [**\_ \_ тип резервного копирования VSS**](/windows/desktop/api/Vss/ne-vss-vss_backup_type).

</dd> <dt>

<span id="_V"></span><span id="_v"></span>**/V**
</dt> <dd>

Создает подробный вывод, который можно использовать для устранения неполадок.

**Windows Server 2003:** Этот параметр командной строки не поддерживается.

</dd> <dt>

<span id="_X_Filename"></span><span id="_x_filename"></span><span id="_X_FILENAME"></span>**/X** *имя_файла*
</dt> <dd>

Выбирает компоненты для резервного копирования или восстановления в зависимости от содержимого XML-файла конфигурации, заданного параметром *filename*. Этот файл должен содержать только символы ANSI в диапазоне от 0 до 127. Формат XML-файла определяется схемой в файле BETest.xml. Пример файла конфигурации см. в разделе BetestSample.xml. Оба эти файла находятся в каталоге всстулс.

> [!Note]  
> Файл BETest.xml можно просмотреть в Internet Explorer. Перед открытием этого файла убедитесь, что файл ксдр-счема. XSL находится в том же каталоге, что и BETest.xml. Файл ксдр-счема. xsl содержит инструкции по подготовке к просмотру, которые делают файл BETest.xml более читаемым.

 

**Windows Server 2003:** Этот параметр командной строки не поддерживается.

</dd> </dl>

## <a name="sample-xml-configuration-file-betestsamplexml"></a>Пример XML-файла конфигурации: BetestSample.xml

Следующий пример файла конфигурации, BetestSample.xml, можно найти в каталоге Всстулс.

``` syntax
<BETest>
    <Writer writerid="5affb034-969f-4919-8875-88f830d0ef89">
        <Component componentName="TestFiles">
        </Component>
    </Writer>
</BETest>
```

В этом примере простого файла конфигурации выбирается один компонент для резервного копирования или восстановления.

## <a name="sample-xml-configuration-file-vswritersamplexml"></a>Пример XML-файла конфигурации: VswriterSample.xml

Следующий пример файла конфигурации, VswriterSample.xml, можно найти в каталоге Всстулс.

``` syntax
<TestWriter   usage="USER_DATA"
                    deleteFiles="no">

    <RestoreMethod method="RESTORE_IF_CAN_BE_REPLACED" 
                   writerRestore="always"
                   rebootRequired="no" />
    
    <Component componentType="filegroup" 
               componentName="TestFiles">
               <ComponentFile path="c:\TestPath" filespec="*" recursive="no" />
    </Component>

</TestWriter>
```

Корневой элемент в этом файле конфигурации называется Тествритер. Все остальные элементы упорядочиваются по элементу Тествритер.

Первый атрибут, связанный с Тествритер, — это атрибут Usage. Этот атрибут указывает тип использования, сообщаемый с помощью метода [**ивссексаминевритерметадата::-Identity**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getidentity) . Одним из возможных значений этого атрибута являются \_ данные пользователя.

Вторым атрибутом является атрибут Делетефилес. Этот атрибут описан в разделе [Настройка атрибутов модуля записи](vss-test-writer-tool.md).

Первым дочерним элементом корневого элемента является элемент Ресторемесод. Этот элемент задает следующее:

-   Метод Restore (в данном случае Restore \_ , \_ Если \_ можно \_ заменить)
-   Требует ли модуль записи события восстановления (в данном случае всегда)
-   Требуется ли перезагрузка после восстановления модуля записи (в данном случае нет)

Этот элемент может дополнительно указывать сопоставление альтернативного расположения. (В этом случае альтернативное расположение не указано.) Дополнительные сведения см. в разделе [Указание сопоставлений альтернативного расположения](vss-test-writer-tool.md).

Второй дочерний элемент является элементом компонента. Этот элемент заставляет модуль записи добавить компонент в свои метаданные. Элемент component содержит атрибуты, описывающие компонент и дочерние элементы для описания содержимого компонента, например следующие:

-   Параметра ComponentType, указывающее, является ли это файловой группой или базой данных (в данном случае, файловой группой)
-   Логикалпас для логического пути к компоненту (в данном случае — None)
-   componentName для имени компонента (в данном случае "Тестфилес")
-   Выберите параметр, чтобы указать состояние для резервного копирования.

Элемент Component также имеет дочерний элемент с именем Компонентфиле, который добавляет спецификацию файла в этот компонент. (Элемент компонента может иметь произвольное число элементов Компонентфиле, которые можно указать для каждого компонента.) Этот элемент Компонентфиле имеет следующие атрибуты:

-   path = "c: \\ тестпас"
-   filespec = " \* "
-   recursive = "нет"

 

 



