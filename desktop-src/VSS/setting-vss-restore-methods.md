---
description: Настройка операций восстановления на самом деле начинается во время резервного копирования данных, когда модули записи указывают, как должны быть восстановлены данные в документах метаданных модуля записи.
ms.assetid: b1f948cd-d3b0-4637-b76d-b54a74bb5948
title: Настройка методов восстановления VSS
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 27f7b0d138555b1e10dba55483c694c08a649e97e59cb66ed65c1a276187d3c5
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "117751730"
---
# <a name="setting-vss-restore-methods"></a>Настройка методов восстановления VSS

Настройка операций восстановления на самом деле начинается во время резервного копирования данных, когда модули записи указывают, как должны быть восстановлены данные в документах метаданных модуля записи.

Эти спецификации, которые называются [*методами восстановления*](vssgloss-r.md) или исходными [*целевыми объектами восстановления*](vssgloss-r.md), могут быть изменены во время восстановления с помощью модуля записи, задавая новые целевые объекты восстановления или инициаторами запроса, восстанавливающимися в новые расположения (см. раздел [нестандартные расположения резервного копирования и восстановления](non-default-backup-and-restore-locations.md)).

Вызывая [**ивсскреатевритерметадата:: сетресторемесод**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setrestoremethod), модуль записи указывает, какой метод Restore следует использовать в документе метаданных модуля записи. Метод Restore задает ширину модуля записи и применяется ко всем файлам во всех компонентах, которыми управляет модуль записи.

Инициатор запроса получает (и должен учитывать) эту информацию, вызывая [**ивссексаминевритерметадата:: жетресторемесод**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getrestoremethod).

Метод Restore определяется перечислением [**перечисления \_ Ресторемесод \_ для VSS**](/windows/desktop/api/VsWriter/ne-vswriter-vss_restoremethod_enum) , которое передается в [**ивсскреатевритерметадата:: сетресторемесод**](/windows/desktop/api/VsWriter/nf-vswriter-ivsscreatewritermetadata-setrestoremethod) и возвращается из [**ивссексаминевритерметадата:: GetRestoreMethod**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssexaminewritermetadata-getrestoremethod).

Документ метаданных модуля записи поддерживает следующие допустимые методы восстановления (метод Restore в VSS \_ рме \_ undefine указывает на ошибку модуля записи). На рисунках показано, как должны быть реализованы различные поддерживаемые и определенные методы восстановления ( \_ для пользовательской службы VSS рме \_ не связана никакая фигура, так как по определению он относится к модулю записи и должен соответствовать конкретным API-интерфейсам и документации модуля записи):

-   VSS \_ рме \_ RESTORE \_ \_ , если это не так \_ . Восстановление файлов компонента на диск, если ни один из файлов не находится на диске. Состояние целевого файла должно быть проверено после события перед [**восстановлением**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) .
    ![Схема, на которой показано дерево устранения неполадок для VSS_RME_RESTORE_IF_NOT_THERE.](images/rint.png)
-   \_рме VSS \_ RESTORE \_ \_ , если может \_ заменить. Восстановление файлов на диск, если все файлы можно заменить. Состояние целевого файла должно быть проверено после события перед [**восстановлением**](/windows/desktop/api/VsBackup/nf-vsbackup-ivssbackupcomponents-prerestore) .
    ![Схема, на которой показано дерево устранения неполадок для VSS_RME_RESTORE_IF_CAN_REPLACE.](images/ricr.png)
-   \_ \_ \_ Запуск восстановления рме VSS \_ . Служба будет остановлена перед восстановлением файлов.
    ![Схема, на которой показано дерево устранения неполадок для VSS_RME_STOP_RESTORE_START.](images/srr.png)
-   \_рме VSS \_ Восстановление \_ в \_ альтернативное \_ расположение. Восстановление файлов на диск в альтернативном расположении. Сопоставления альтернативного расположения указываются в документе метаданных модуля записи.
    ![Схема, на которой показано дерево устранения неполадок для VSS_RME_RESTORE_TO_ALTERNATE_LOCATION.](images/rtal.png)
-   \_Восстановление рме \_ VSS \_ при \_ перезагрузке. Приводит к восстановлению файлов (перезаписывается) при перезагрузке компьютера.
    ![Схема, на которой показано дерево устранения неполадок для VSS_RME_RESTORE_AT_REBOOT.](images/rar.png)
-   \_Восстановление рме VSS при \_ \_ \_ перезагрузке \_ \_ , если не может \_ заменить. Если файл не удалось восстановить на диск в работающей системе, то он будет восстановлен (перезаписывается) при перезагрузке компьютера.
    ![Схема, на которой показано дерево устранение неполадок forVSS_RME_RESTORE_AT_REBOOT_IF_CANNOT_REPLACE. ](images/raricr.png)
-   \_рме VSS \_ Custom. Ни один из предопределенных методов не будет работать. для выполнения операции восстановления приложение резервного копирования должно использовать специализированные API. Для этого метода резервного копирования инициатор запроса должен полностью разобраться в вопросе модуля записи. Ознакомьтесь с [особыми вариантами использования VSS](special-vss-usage-cases.md) для текущих поддерживаемых экземпляров.

 

 



