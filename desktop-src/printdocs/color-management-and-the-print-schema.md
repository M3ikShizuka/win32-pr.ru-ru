---
description: Сведения о настраиваемых пользователем ключевых словах в схеме печати для управления цветом, например Пажеколорманажемент и Пажеблаккженератионпроцессинг.
ms.assetid: 296255b8-fe5c-46dd-b717-487aaae0db80
title: Управление цветом и схема печати
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9258d9dcc59ab24f9cfca8e170bf3f3f62841b21
ms.sourcegitcommit: 5d4e99f4c8f42f5f543e52cb9beb9fb13ec56c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/19/2021
ms.locfileid: "112409677"
---
# <a name="color-management-and-the-print-schema"></a><span data-ttu-id="77035-103">Управление цветом и схема печати</span><span class="sxs-lookup"><span data-stu-id="77035-103">Color Management and the Print Schema</span></span>

<span data-ttu-id="77035-104">Этот раздел не является актуальным.</span><span class="sxs-lookup"><span data-stu-id="77035-104">This topic is not current.</span></span> <span data-ttu-id="77035-105">Самые актуальные сведения см. в [спецификации печати схемы](https://download.microsoft.com/download/D/E/C/DECA6E6B-3E81-48E7-B7EF-6D92A547D03C/print-schema-spec-2-0.zip).</span><span class="sxs-lookup"><span data-stu-id="77035-105">For the most current information, see the [Print Schema Specification](https://download.microsoft.com/download/D/E/C/DECA6E6B-3E81-48E7-B7EF-6D92A547D03C/print-schema-spec-2-0.zip).</span></span>

<span data-ttu-id="77035-106">Настраиваемые пользователем ключевые слова элемента могут быть специальными или не зависящими от XPS.</span><span class="sxs-lookup"><span data-stu-id="77035-106">User Configurable Element keywords may either be XPS specific or non-XPS specific.</span></span> <span data-ttu-id="77035-107">В случае, когда они не относятся к XPS, для устаревшей печати на основе GDI можно использовать ключевое слово.</span><span class="sxs-lookup"><span data-stu-id="77035-107">In the case where they are not XPS specific, the keyword may be used for Legacy GDI-based printing.</span></span> <span data-ttu-id="77035-108">Если приложение принимает решение установить эти ключевые слова в PrintTicket, то для определения правильного действия и поведения, выполняемого на основе определений, представленных в схеме печати, требуется драйвер.</span><span class="sxs-lookup"><span data-stu-id="77035-108">If an application decides to set these keywords in a PrintTicket, it is up to the driver to determine the proper action and behavior to take based on the definitions presented in the Print Schema.</span></span> <span data-ttu-id="77035-109">Любое из этих ключевых слов можно использовать в контексте ICM.</span><span class="sxs-lookup"><span data-stu-id="77035-109">Any of these keywords may be used in the context of ICM.</span></span> <span data-ttu-id="77035-110">Дополнительные сведения см. в пакете SDK для Windows Vista.</span><span class="sxs-lookup"><span data-stu-id="77035-110">For more information, please see the Windows Vista SDK.</span></span>



| <span data-ttu-id="77035-111">Заданное пользователем ключевое слово схемы печати</span><span class="sxs-lookup"><span data-stu-id="77035-111">Print Schema User Configurable Keyword</span></span>       | <span data-ttu-id="77035-112">Эквивалент DEVMODE</span><span class="sxs-lookup"><span data-stu-id="77035-112">DEVMODE Equivalent</span></span>     | <span data-ttu-id="77035-113">Специфика XPS</span><span class="sxs-lookup"><span data-stu-id="77035-113">XPS Specific</span></span>   |
|----------------------------------------------|------------------------|----------------|
| <span data-ttu-id="77035-114">пажеколорманажемент</span><span class="sxs-lookup"><span data-stu-id="77035-114">PageColorManagement</span></span><br/>               | <span data-ttu-id="77035-115">дмикммесод</span><span class="sxs-lookup"><span data-stu-id="77035-115">dmICMMethod</span></span><br/> | <span data-ttu-id="77035-116">Нет</span><span class="sxs-lookup"><span data-stu-id="77035-116">No</span></span><br/>  |
| <span data-ttu-id="77035-117">пажеблаккженератионпроцессинг</span><span class="sxs-lookup"><span data-stu-id="77035-117">PageBlackGenerationProcessing</span></span><br/>     | <span data-ttu-id="77035-118">Нет</span><span class="sxs-lookup"><span data-stu-id="77035-118">None</span></span><br/>        | <span data-ttu-id="77035-119">Да</span><span class="sxs-lookup"><span data-stu-id="77035-119">Yes</span></span><br/> |
| <span data-ttu-id="77035-120">пажеблендколорспаце</span><span class="sxs-lookup"><span data-stu-id="77035-120">PageBlendColorSpace</span></span><br/>               | <span data-ttu-id="77035-121">Нет</span><span class="sxs-lookup"><span data-stu-id="77035-121">None</span></span><br/>        | <span data-ttu-id="77035-122">Да</span><span class="sxs-lookup"><span data-stu-id="77035-122">Yes</span></span><br/> |
| <span data-ttu-id="77035-123">пажесаурцеколорпрофиле</span><span class="sxs-lookup"><span data-stu-id="77035-123">PageSourceColorProfile</span></span><br/>            | <span data-ttu-id="77035-124">Нет</span><span class="sxs-lookup"><span data-stu-id="77035-124">None</span></span><br/>        | <span data-ttu-id="77035-125">Нет</span><span class="sxs-lookup"><span data-stu-id="77035-125">No</span></span><br/>  |
| <span data-ttu-id="77035-126">пажедестинатионколорпрофиле</span><span class="sxs-lookup"><span data-stu-id="77035-126">PageDestinationColorProfile</span></span><br/>       | <span data-ttu-id="77035-127">Нет</span><span class="sxs-lookup"><span data-stu-id="77035-127">None</span></span><br/>        | <span data-ttu-id="77035-128">Нет</span><span class="sxs-lookup"><span data-stu-id="77035-128">No</span></span><br/>  |
| <span data-ttu-id="77035-129">пажеикмрендерингинтент</span><span class="sxs-lookup"><span data-stu-id="77035-129">PageICMRenderingIntent</span></span><br/>            | <span data-ttu-id="77035-130">дмикминтент</span><span class="sxs-lookup"><span data-stu-id="77035-130">dmICMIntent</span></span><br/> | <span data-ttu-id="77035-131">Нет</span><span class="sxs-lookup"><span data-stu-id="77035-131">No</span></span><br/>  |
| <span data-ttu-id="77035-132">жобоптималдестинатионколорпрофиле</span><span class="sxs-lookup"><span data-stu-id="77035-132">JobOptimalDestinationColorProfile</span></span><br/> | <span data-ttu-id="77035-133">Нет</span><span class="sxs-lookup"><span data-stu-id="77035-133">None</span></span><br/>        | <span data-ttu-id="77035-134">Нет</span><span class="sxs-lookup"><span data-stu-id="77035-134">No</span></span><br/>  |
| <span data-ttu-id="77035-135">пажедевицеколорспацеусаже</span><span class="sxs-lookup"><span data-stu-id="77035-135">PageDeviceColorSpaceUsage</span></span><br/>         | <span data-ttu-id="77035-136">Нет</span><span class="sxs-lookup"><span data-stu-id="77035-136">None</span></span><br/>        | <span data-ttu-id="77035-137">Да</span><span class="sxs-lookup"><span data-stu-id="77035-137">Yes</span></span><br/> |



 

## <a name="pagecolormanagement-system-handling"></a><span data-ttu-id="77035-138">Пажеколорманажемент обработка системы</span><span class="sxs-lookup"><span data-stu-id="77035-138">PageColorManagement System Handling</span></span>

<span data-ttu-id="77035-139">Для Пажеколорманажемент система обеспечивает автоматическую обработку PrintTicket для DEVMODE или DEVMODE в отношении преобразования PrintTicket, если это необходимо.</span><span class="sxs-lookup"><span data-stu-id="77035-139">For PageColorManagement, the system provides automatic handling of PrintTicket to DEVMODE or DEVMODE to PrintTicket conversion if necessary.</span></span> <span data-ttu-id="77035-140">Это зависит от конкретного пути печати между приложением (Win32 или WPF) и драйвером (на основе GDI или XPSDrv).</span><span class="sxs-lookup"><span data-stu-id="77035-140">This depends on the specific print path between the application (Win32 or WPF)and the driver (GDI-based or XPSDrv).</span></span> <span data-ttu-id="77035-141">В случае печати из Windows Presentation Foundationного приложения в драйвер печати Microsoft XPSDrv не следует объявлять Пажеколорманажемент общедоступный вариант системы в документе PrintTicket или PrintCapabilities. в этом случае система не может автоматически обрабатывать управление цветом.</span><span class="sxs-lookup"><span data-stu-id="77035-141">In the case of printing from a Windows Presentation Foundation application to a Microsoft XPSDrv print driver, a PageColorManagement public option of System SHOULD NOT be advertised in either the PrintTicket or PrintCapabilities document; in this case, color management cannot be handled automatically by the system.</span></span> <span data-ttu-id="77035-142">Печать из приложения Win32 в драйвер печати Microsoft XPSDrv может привести к управлению цветом между приложением и GDI, однако после преобразования в формат XPS отсутствует автоматическая обработка системы управления цветом между документом XPS и драйвером и (или) устройством, так как в формате XPS каждый элемент содержит полные сведения о цвете, а также драйвер или устройство для обработки этой информации.</span><span class="sxs-lookup"><span data-stu-id="77035-142">Printing from a Win32 application to a Microsoft XPSDrv print driver may result in color management between the application and GDI, however after conversion to XPS-format, there will be no automatic system handling of color management between the XPS document and the driver and/or device, because the XPS-format tags each element with complete color information, and it is up to the driver or the device to process this information.</span></span>



| <span data-ttu-id="77035-143">Общедоступные варианты Пажеколорманажемент</span><span class="sxs-lookup"><span data-stu-id="77035-143">PageColorManagement Public Options</span></span> | <span data-ttu-id="77035-144">Значение DEVMODE</span><span class="sxs-lookup"><span data-stu-id="77035-144">DEVMODE Value</span></span>                  |
|------------------------------------|--------------------------------|
| <span data-ttu-id="77035-145">Нет</span><span class="sxs-lookup"><span data-stu-id="77035-145">None</span></span><br/>                    | <span data-ttu-id="77035-146">ДМИКММЕСОД \_ None</span><span class="sxs-lookup"><span data-stu-id="77035-146">DMICMMETHOD\_NONE</span></span><br/>   |
| <span data-ttu-id="77035-147">Устройство</span><span class="sxs-lookup"><span data-stu-id="77035-147">Device</span></span><br/>                  | <span data-ttu-id="77035-148">\_устройство дмикммесод</span><span class="sxs-lookup"><span data-stu-id="77035-148">DMICMMETHOD\_DEVICE</span></span><br/> |
| <span data-ttu-id="77035-149">Драйвер</span><span class="sxs-lookup"><span data-stu-id="77035-149">Driver</span></span><br/>                  | <span data-ttu-id="77035-150">\_драйвер дмикммесод</span><span class="sxs-lookup"><span data-stu-id="77035-150">DMICMMETHOD\_DRIVER</span></span><br/> |
| <span data-ttu-id="77035-151">Система</span><span class="sxs-lookup"><span data-stu-id="77035-151">System</span></span><br/>                  | <span data-ttu-id="77035-152">ДМИКММЕСОД \_ система</span><span class="sxs-lookup"><span data-stu-id="77035-152">DMICMMETHOD\_SYSTEM</span></span><br/> |



 

## <a name="pageicmrenderingintent-system-handling"></a><span data-ttu-id="77035-153">Пажеикмрендерингинтент обработка системы</span><span class="sxs-lookup"><span data-stu-id="77035-153">PageICMRenderingIntent System Handling</span></span>

<span data-ttu-id="77035-154">Для Пажеикмрендерингинтент система обеспечивает автоматическую обработку PrintTicket для DEVMODE или DEVMODE в отношении преобразования PrintTicket, если это необходимо.</span><span class="sxs-lookup"><span data-stu-id="77035-154">For PageICMRenderingIntent, the system provides automatic handling of PrintTicket to DEVMODE or DEVMODE to PrintTicket conversion if necessary.</span></span> <span data-ttu-id="77035-155">Это зависит от конкретного пути печати между приложением (Win32 или Windows Presentation Foundation) и драйвером (на основе GDI или XPSDrv).</span><span class="sxs-lookup"><span data-stu-id="77035-155">This depends on the specific print path between the application (Win32 or Windows Presentation Foundation) and the driver (GDI-based or XPSDrv).</span></span>



| <span data-ttu-id="77035-156">Общедоступные варианты Пажеикмрендерингинтент</span><span class="sxs-lookup"><span data-stu-id="77035-156">PageICMRenderingIntent Public Options</span></span> | <span data-ttu-id="77035-157">Значение DEVMODE</span><span class="sxs-lookup"><span data-stu-id="77035-157">DEVMODE Value</span></span>                       |
|---------------------------------------|-------------------------------------|
| <span data-ttu-id="77035-158">абсолутеколориметрик</span><span class="sxs-lookup"><span data-stu-id="77035-158">AbsoluteColorimetric</span></span><br/>       | <span data-ttu-id="77035-159">ДМИКМ \_ ABS \_</span><span class="sxs-lookup"><span data-stu-id="77035-159">DMICM\_ABS\_COLORIMETRIC</span></span><br/> |
| <span data-ttu-id="77035-160">релативеколориметрик</span><span class="sxs-lookup"><span data-stu-id="77035-160">RelativeColorimetric</span></span><br/>       | <span data-ttu-id="77035-161">ДМИКМ \_</span><span class="sxs-lookup"><span data-stu-id="77035-161">DMICM\_COLORIMETRIC</span></span><br/>      |
| <span data-ttu-id="77035-162">Фотографий</span><span class="sxs-lookup"><span data-stu-id="77035-162">Photographs</span></span><br/>                | <span data-ttu-id="77035-163">\_контрастность дмикм</span><span class="sxs-lookup"><span data-stu-id="77035-163">DMICM\_CONTRAST</span></span><br/>          |
| <span data-ttu-id="77035-164">бусинессграфикс</span><span class="sxs-lookup"><span data-stu-id="77035-164">BusinessGraphics</span></span><br/>           | <span data-ttu-id="77035-165">ДМИКМ \_ насыщенность</span><span class="sxs-lookup"><span data-stu-id="77035-165">DMICM\_SATURATE</span></span><br/>          |



 

<span data-ttu-id="77035-166">Все другие ключевые слова, связанные с управлением цветом (помимо Пажеколорманажемент или Пажеикмрендерингинтент), не имеют такой автоматической обработки.</span><span class="sxs-lookup"><span data-stu-id="77035-166">All other Color Management related keywords (besides PageColorManagement or PageICMRenderingIntent) do not have such automatic handling.</span></span>

## <a name="joboptimaldestinationcolorprofile-and-pagedestinationcolorprofile-usage"></a><span data-ttu-id="77035-167">Использование Жобоптималдестинатионколорпрофиле и Пажедестинатионколорпрофиле</span><span class="sxs-lookup"><span data-stu-id="77035-167">JobOptimalDestinationColorProfile and PageDestinationColorProfile Usage</span></span>

<span data-ttu-id="77035-168">Приложение может запросить документ PrintCapabilities для Жобоптималдестинатионколорпрофиле.</span><span class="sxs-lookup"><span data-stu-id="77035-168">An application MAY decide to query PrintCapabilities document for JobOptimalDestinationColorProfile.</span></span> <span data-ttu-id="77035-169">Это может дать приложению оптимальный цветовой профиль, заданный в соответствии с текущими настройками устройства, как определено в документе PrintCapabilities.</span><span class="sxs-lookup"><span data-stu-id="77035-169">This could give an application the optimal color profile given the current device configuration as defined in the PrintCapabilities document.</span></span> <span data-ttu-id="77035-170">Если приложение решает, что драйверу требуется выполнять управление цветом для цветового профиля назначения, заданного параметром Жобоптималдестинатионколорпрофиле, то для Пажеколорманажемент и Пажедестинатионколорпрофиле будет установлено значение Driver и DriverConfiguration в PrintTicket соответственно.</span><span class="sxs-lookup"><span data-stu-id="77035-170">If the application decides it would like the driver to perform color management to the destination color profile specified by JobOptimalDestinationColorProfile, then PageColorManagement and PageDestinationColorProfile would be set to Driver and DriverConfiguration in the PrintTicket respectively.</span></span> <span data-ttu-id="77035-171">Если приложение не хочет использовать Жобоптионалдестинатионколорпрофиле и выбирает его самостоятельно, ему следует присвоить параметру Пажеколорманажемент значение None, а также задать для Пажедестинатионколорпрофиле значение Application в PrintTicket, чтобы передать, что приложение уже выполнило управление цветом для указанного целевого цветового профиля.</span><span class="sxs-lookup"><span data-stu-id="77035-171">If the application does not want to use the JobOptionalDestinationColorProfile and chooses to use its own, it SHOULD set PageColorManagement to None and also set the PageDestinationColorProfile to Application in the PrintTicket to convey that the application has already performed color management to its specified destination color profile.</span></span> <span data-ttu-id="77035-172">Другой сценарий может возникнуть, когда приложение выбирает использование оптимального цветового профиля назначения, возвращенного драйверами PrintCapabilities, но решает, что Управление цветом осуществляется самостоятельно.</span><span class="sxs-lookup"><span data-stu-id="77035-172">Another scenario may occur when the application chooses to use the optimal destination color profile returned by the drivers PrintCapabilities but decides to do color management on its own.</span></span> <span data-ttu-id="77035-173">В этом случае для Пажеколорманажемент будет установлено значение None, а для свойства Пажедестинатионколорпрофиле — значение Application.</span><span class="sxs-lookup"><span data-stu-id="77035-173">In this case, PageColorManagement would be set to None and PageDestinationColorProfile would be set to Application.</span></span>

## <a name="pagesourcecolorprofile-usage"></a><span data-ttu-id="77035-174">Использование Пажесаурцеколорпрофиле</span><span class="sxs-lookup"><span data-stu-id="77035-174">PageSourceColorProfile Usage</span></span>

<span data-ttu-id="77035-175">Для Пажесаурцеколорпрофиле приложение может указать исходный цветовой профиль для каждой страницы PrintTicket, независимо от параметра, выбранного для Пажеколорманажемент.</span><span class="sxs-lookup"><span data-stu-id="77035-175">For PageSourceColorProfile, an application MAY specify a source color profile for each page in the PrintTicket, regardless of the option selected for PageColorManagement.</span></span> <span data-ttu-id="77035-176">Независимо от того, присутствует она или нет, драйвер может решить поведение для каждого варианта на основе определений, представленных в схеме печати.</span><span class="sxs-lookup"><span data-stu-id="77035-176">Whether it is present or not, it is up to the driver to decide the behavior for each case based on the definitions presented in the Print Schema.</span></span> <span data-ttu-id="77035-177">Например, приложение может установить для Пажеколорманажемент значение None, а затем не задавать Пажесаурцеколорпрофиле в PrintTicket.</span><span class="sxs-lookup"><span data-stu-id="77035-177">For example, an application may set PageColorManagement to None, and then not set PageSourceColorProfile in the PrintTicket.</span></span> <span data-ttu-id="77035-178">Кроме того, приложение может установить для Пажеколорманажемент значение Driver, а затем задать Пажесаурцеколорпрофиле в PrintTicket. в этом случае драйвер отвечает за определение поведения в рамках правил Принтсчема.</span><span class="sxs-lookup"><span data-stu-id="77035-178">It is also possible for an application to set PageColorManagement to Driver, and then set PageSourceColorProfile in the PrintTicket; the driver in this case is responsible for determining the behavior within the guidelines of the PrintSchema.</span></span>

## <a name="pagedevicecolorspaceusage"></a><span data-ttu-id="77035-179">пажедевицеколорспацеусаже</span><span class="sxs-lookup"><span data-stu-id="77035-179">PageDeviceColorSpaceUsage</span></span>

<span data-ttu-id="77035-180">Пажедевицеколорспацеусаже — это определяемый пользователем настраиваемый элемент XPS, который задается приложением.</span><span class="sxs-lookup"><span data-stu-id="77035-180">PageDeviceColorSpaceUsage is an XPS specific user configurable element that is set by the application.</span></span> <span data-ttu-id="77035-181">Он предоставляет инструкции для устройства, устанавливая соответствующий параметр в PrintTicket для обработки профиля цветового пространства, связанного в документе XPS.</span><span class="sxs-lookup"><span data-stu-id="77035-181">It provides instructions for the device by setting the appropriate option in the PrintTicket, for color space profile handling associated within an XPS document.</span></span> <span data-ttu-id="77035-182">Приложение и (или) существующий PrintTicket может указать это ключевое слово в PrintTicket, отправляемом на устройство.</span><span class="sxs-lookup"><span data-stu-id="77035-182">The application and/or existing PrintTicket MAY specify this keyword in a PrintTicket sent to the device.</span></span> <span data-ttu-id="77035-183">Независимо от того, присутствует она или нет, драйвер может решить поведение каждого случая на основе определений, представленных в схеме печати.</span><span class="sxs-lookup"><span data-stu-id="77035-183">Whether it is present or not, it is up to the driver to decide the behavior for each case, based on the definitions presented in the Print Schema.</span></span>

## <a name="print-schema-color-management-example-flow"></a><span data-ttu-id="77035-184">Пример потока для управления цветом схемы печати</span><span class="sxs-lookup"><span data-stu-id="77035-184">Print Schema Color Management Example Flow</span></span>

<span data-ttu-id="77035-185">На следующей схеме показан поток для наиболее вероятных сценариев использования управления цветом и схемы печати.</span><span class="sxs-lookup"><span data-stu-id="77035-185">The following diagram illustrates flow for the most likely scenarios for using Color Management and the Print Schema.</span></span> <span data-ttu-id="77035-186">Для простоты и удобочитаемости использовались только следующие пользовательские ключевые слова схемы печати для демонстрации их использования: Пажеколорманажемент, Жобоптималдестинаионколорпрофиле, Пажесаурцеколорпрофиле и Пажедестинатионколорпрофиле.</span><span class="sxs-lookup"><span data-stu-id="77035-186">For simplicity and readability, only the following user configurable Print Schema keywords were used to demonstrate their usage: PageColorManagement, JobOptimalDestinaionColorProfile, PageSourceColorProfile, and PageDestinationColorProfile.</span></span> <span data-ttu-id="77035-187">Сплошная линия представляет собой действие, которое должно быть выполнено, а пунктирная линия представляет действие, которое может быть выполнено.</span><span class="sxs-lookup"><span data-stu-id="77035-187">A solid line represents an action that SHOULD occur and a dashed line represents an action that MAY occur.</span></span> <span data-ttu-id="77035-188">Следующий сценарий не является гарантированным взаимодействием, которое будет выдаваться между приложением, драйвером и системой, однако оно представляет наиболее распространенный вариант использования.</span><span class="sxs-lookup"><span data-stu-id="77035-188">The following scenario is not the guaranteed interaction that will result between the application, driver, and system, however, it represents the most common usage case that will occur.</span></span>

![Диаграмма, показывающая, как обрабатываются параметры управления цветом](images/local-1992284846-colormanagementtest3.png)

## <a name="related-topics"></a><span data-ttu-id="77035-190">Связанные темы</span><span class="sxs-lookup"><span data-stu-id="77035-190">Related topics</span></span>

<dl> <dt>

[<span data-ttu-id="77035-191">Печать спецификации схемы</span><span class="sxs-lookup"><span data-stu-id="77035-191">Print Schema Specification</span></span>](https://download.microsoft.com/download/D/E/C/DECA6E6B-3E81-48E7-B7EF-6D92A547D03C/print-schema-spec-2-0.zip)
</dt> </dl>

 

 




