---
description: Функция Енумпринтерс перечисляет доступные принтеры, серверы печати, домены или поставщики печати.
ms.assetid: 0d0cc726-c515-4146-9273-cdf1db3c76b7
title: Функция Енумпринтерс (Винспул. h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- EnumPrinters
- EnumPrintersA
- EnumPrintersW
api_type:
- DllExport
api_location:
- Winspool.drv
ms.openlocfilehash: fb88cef081010f1319fb194904933ba2366d6593f0d2517c696bb6d6490ace20
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119353844"
---
# <a name="enumprinters-function"></a>Функция Енумпринтерс

Функция **енумпринтерс** перечисляет доступные принтеры, серверы печати, домены или поставщики печати.

## <a name="syntax"></a>Синтаксис


```C++
BOOL EnumPrinters(
  _In_  DWORD   Flags,
  _In_  LPTSTR  Name,
  _In_  DWORD   Level,
  _Out_ LPBYTE  pPrinterEnum,
  _In_  DWORD   cbBuf,
  _Out_ LPDWORD pcbNeeded,
  _Out_ LPDWORD pcReturned
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*Флаги* \[ окне\]
</dt> <dd>

Типы объектов печати, которые должна перечислять функция. Это значение может быть одним или несколькими следующими значениями.



| Значение                                                                                                                                                                                               | Значение                                                                                                                                                                                                                                                |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="PRINTER_ENUM_LOCAL"></span><span id="printer_enum_local"></span><dl> <dt>**\_локальный принтер перечисление \_**</dt> </dl>                       | Если \_ \_ флаг имени перечисления принтера не передается, функция игнорирует параметр *Name* и перечисляет локально установленные принтеры. Если \_ \_ также передается имя перечисления принтера, функция перечисляет локальные принтеры по *имени*. <br/> |
| <span id="PRINTER_ENUM_NAME"></span><span id="printer_enum_name"></span><dl> <dt>**\_имя ПЕРЕЧИСЛЕНИЯ \_ принтера**</dt> </dl>                          | Функция перечисляет принтер, определенный по *имени*. Это может быть сервер, домен или поставщик услуг печати. Если *Name* имеет **значение NULL**, функция перечисляет доступные поставщики печати.<br/>                                                    |
| <span id="PRINTER_ENUM_SHARED"></span><span id="printer_enum_shared"></span><dl> <dt>**\_перечисление общих принтеров \_**</dt> </dl>                    | Функция перечисляет принтеры, имеющие общий атрибут. Не может использоваться в изоляции; Используйте операцию или для объединения с другим \_ типом ПЕРЕЧИСЛЕНИЯ принтера.<br/>                                                                               |
| <span id="PRINTER_ENUM_CONNECTIONS"></span><span id="printer_enum_connections"></span><dl> <dt>**Перечисление подключений к ПРИНТЕРАм \_ \_**</dt> </dl>     | Функция перечисляет список принтеров, к которым пользователь сделал предыдущие соединения.<br/>                                                                                                                                               |
| <span id="PRINTER_ENUM_NETWORK"></span><span id="printer_enum_network"></span><dl> <dt>**\_сеть перечисление принтеров \_**</dt> </dl>                 | Функция перечисляет сетевые принтеры в домене компьютера. Это значение допустимо, только если *уровень* равен 1.<br/>                                                                                                                                |
| <span id="PRINTER_ENUM_REMOTE"></span><span id="printer_enum_remote"></span><dl> <dt>**\_Удаленный перечисление принтеров \_**</dt> </dl>                    | Функция перечисляет сетевые принтеры и серверы печати в домене компьютера. Это значение допустимо, только если *уровень* равен 1.<br/>                                                                                                              |
| <span id="PRINTER_ENUM_CATEGORY_3D"></span><span id="printer_enum_category_3d"></span><dl> <dt>**Категория перечисления ПРИНТЕРов, \_ \_ \_ трехмерная**</dt> </dl>    | Функция перечисляет только объемные принтеры.<br/>                                                                                                                                                                                                   |
| <span id="PRINTER_ENUM_CATEGORY_ALL"></span><span id="printer_enum_category_all"></span><dl> <dt>**\_Категория ПЕРЕЧИСЛЕНИЯ принтеров \_ \_**</dt> </dl> | Функция перечисляет все устройства печати, включая 3D-принтеры.<br/>                                                                                                                                                                           |



 

Если *уровень* равен 4, можно использовать только \_ Локальные константы "перечисление принтера" \_ и " \_ перечисление принтера" \_ .

> [!Note]  
> устройства с 3D-печатью не перечисляются по умолчанию. Чтобы перечислить только объемные принтеры, необходимо включить обе **категории для перечисления принтеров \_ \_ \_ 3D** и **Printer \_ Enum \_ локальный** . Чтобы включить 3D-принтеры вместе со всеми другими локальными принтерами, используйте **\_ Перечисление \_ категории \_ все** и **\_ \_ Локальное перечисление принтеров локальный**.

 

</dd> <dt>

*Имя* \[ окне\]
</dt> <dd>

Если *уровень* равен 1, *Флаги* содержат \_ имя перечисления принтера \_ , *а имя* не **равно NULL**, то *Name* — это указатель на строку, завершающуюся нулем, которая указывает имя объекта для перечисления. Эта строка может быть именем сервера, домена или поставщика услуг печати.

Если *уровень* равен 1, *Флаги* содержат \_ имя перечисления принтера \_ , а *Name* — **null**, функция перечисляет доступные поставщики печати.

Если *уровень* равен 1, *Флаги* содержат \_ УДАЛЕНное перечисление принтеров \_ , а *Name* имеет **значение NULL**, функция перечисляет принтеры в домене пользователя.

Если *Level* имеет значение 2 или 5, то *Name* — это указатель на строку, завершающуюся нулем, которая указывает имя сервера, чьи принтеры необходимо перечислить. Если эта строка имеет **значение NULL**, функция перечисляет принтеры, установленные на локальном компьютере.

Если *уровень* равен 4, *имя* должно иметь **значение NULL**. Функция всегда запрашивается на локальном компьютере.

Если параметр *Name* имеет **значение NULL**, при установке *флагов* на принтер перечисление локального принтера перечисление \_ \_ \| \_ \_ подключений перечисляет принтеры, установленные на локальном компьютере. К этим принтерам относятся те, которые физически подключены к локальному компьютеру, а также удаленные принтеры, к которым подключено сетевое подключение.

Если параметр *Name* имеет **значение NOT NULL**, установка *флагов* на принтер перечисление \_ \_ локального \| принтера \_ \_ перечисляет локальные принтеры, установленные на *имени* сервера.

</dd> <dt>

*Уровень* \[ окне\]
</dt> <dd>

Тип структур данных, на которые указывает *ппринтеренум*. Допустимые значения: 1, 2, 4 и 5, соответствующие структурам данных [**принтера \_ \_ 1**](printer-info-1.md), [**\_ сведения о \_ принтере**](printer-info-2.md) , [**сведения о принтере \_ \_ 4**](printer-info-4.md)и [**\_ сведения о принтере \_ 5**](printer-info-5.md) .

Это значение может быть равно 1, 2, 4 или 5.

</dd> <dt>

*ппринтеренум* \[ заполняет\]
</dt> <dd>

Указатель на буфер, который получает массив [**сведений о принтере \_ \_ 1**](printer-info-1.md), [**\_ сведения о принтере \_**](printer-info-2.md), сведения о [**принтере \_ \_ 4**](printer-info-4.md)или [**\_ сведения о принтере \_ 5**](printer-info-5.md) . Каждая структура содержит данные, описывающие доступный объект Print.

Если *уровень* равен 1, массив содержит структуры [**« \_ \_ 1**](printer-info-1.md) », «принтер». Если *уровень* равен 2, массив содержит структуры [**" \_ сведения \_ о принтере 2**](printer-info-2.md) ". Если *Level* имеет значение 4, то массив содержит структуры [**Printer \_ info \_ 4**](printer-info-4.md) . Если *Level* имеет значение 5, то массив содержит структуры [**Printer \_ info \_ 5**](printer-info-5.md) .

Буфер должен быть достаточно большим, чтобы получать массив структур данных и любые строки или другие данные, к которым она указывает. Если буфер слишком мал, параметр *пкбнидед* возвращает требуемый размер буфера.

</dd> <dt>

*кббуф* \[ окне\]
</dt> <dd>

Размер (в байтах) буфера, на который указывает *ппринтеренум*.

</dd> <dt>

*пкбнидед* \[ заполняет\]
</dt> <dd>

Указатель на значение, которое получает число байтов, скопированных, если функция выполнена, или число байтов, необходимое, если *кббуф* слишком мал.

</dd> <dt>

*пкретурнед* \[ заполняет\]
</dt> <dd>

Указатель на значение, получающее число структур, которые получает количество [**принтеров \_ \_ 1**](printer-info-1.md), [**\_ сведения о принтере \_ 2**](printer-info-2.md) , [**\_ сведения о принтере \_ 4**](printer-info-4.md)или [**\_ сведения о принтере \_ 5**](printer-info-5.md) , возвращаемые функцией в массиве, на который указывает *ппринтеренум* .

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Если функция выполнена, возвращаемое значение будет ненулевым.

Если функция выполняется неудачно, возвращается нулевое значение.

## <a name="remarks"></a>Remarks

Не вызывайте этот метод в [**DllMain**](/windows/desktop/Dlls/dllmain).

> [!Note]  
> Это блокирующая или синхронная функция, которая может не возвращать значение немедленно. Скорость возврата этой функцией зависит от факторов времени выполнения, таких как состояние сети, Конфигурация сервера печати и факторы реализации драйвера принтера, которые трудно предсказать при написании приложения. Вызов этой функции из потока, который управляет взаимодействием с пользовательским интерфейсом, может привести к невозможности реагирования приложения.

 

Если **енумпринтерс** возвращает структуру [**Printer \_ info \_ 1**](printer-info-1.md) , в которой \_ указан контейнер перечисления принтеров \_ , это означает, что имеется иерархия объектов принтера. Приложение может перечислить иерархию, вызвав **енумпринтерс** еще раз, указав в качестве *имени* значение элемента **pName** в структуре " **\_ сведения о принтере \_ 1** ".

Функция **енумпринтерс** не получает сведения о безопасности. Если в массиве, на который указывает *ппринтеренум*, возвращаются структуры с [**\_ информацией о принтерах \_ 2**](printer-info-2.md) , их члены *псекуритидескриптор* будут иметь **значение NULL**.

Чтобы получить сведения о принтере по умолчанию, вызовите [**жетдефаултпринтер**](getdefaultprinter.md).

Структура [**Printer \_ info \_ 4**](printer-info-4.md) обеспечивает простой и быстрый способ получения имен принтеров, установленных на локальном компьютере, а также удаленных подключений, которые пользователь установил. Когда **енумпринтерс** вызывается со структурой данных **Printer \_ \_ 4** , эта функция запрашивает в реестре указанные сведения, а затем сразу же возвращает. Это отличается от поведения **енумпринтерс** при вызове с другими уровнями **\_ \_ \* *структуры данных принтера. В частности, при* вызове _ енумпринтерс** со структурой данных уровня 2 (принтер) он выполняет вызов [**опенпринтер**](openprinter.md) для каждого удаленного соединения.[**\_ \_**](printer-info-2.md) Если удаленное подключение не работает или удаленный сервер больше не существует или удаленный принтер больше не существует, функция должна дождаться истечения времени ожидания RPC и, следовательно, вызвать сбой вызова **опенпринтер** . Это может занять некоторое время. Передача структуры **" \_ сведения \_ о принтере 4** " позволяет приложению получить минимально необходимую информацию. Если требуется более подробная информация, можно выполнить следующий вызов **енумпринтерс** уровня 2.

**Windows Vista:** Данные принтера, возвращаемые функцией **енумпринтерс** , извлекаются из локального кэша, когда значение *Level* равно 4.

В следующей таблице показаны выходные данные **енумпринтерс** для различных значений *флагов* , если параметр *Level* имеет значение 1.

В столбце "параметр *имени* " таблицы следует подставить соответствующее имя для поставщика печати, домена и компьютера. Например, для «поставщика печати» можно использовать имя поставщика сетевых принтеров или имя локального поставщика печати. Чтобы получить имена поставщиков печати, вызовите **енумпринтерс** с параметром *Name* , имеющим значение **null**.



| Параметр *flags*                                  | Параметр *Name*                            | Результат                                                                                            |
|----------------------------------------------------|---------------------------------------------|---------------------------------------------------------------------------------------------------|
| \_Перечисление ЛОКАЛЬНЫХ принтеров \_ ( \_ без \_ имени перечисления принтера) | Параметр *Name* игнорируется.<br/> | Все локальные принтеры.<br/>                                                                    |
| \_имя ПЕРЕЧИСЛЕНИЯ \_ принтера                                | "Поставщик печати"<br/>                 | Все доменные имена<br/>                                                                       |
| \_имя ПЕРЕЧИСЛЕНИЯ \_ принтера                                | "Поставщик печати! Поддомен<br/>          | Все принтеры и серверы печати в домене компьютера<br/>                                |
| \_имя ПЕРЕЧИСЛЕНИЯ \_ принтера                                | "Поставщик печати! \\ \\ Машине<br/>    | Все общие принтеры на \\ \\ компьютере<br/>                                                     |
| \_имя ПЕРЕЧИСЛЕНИЯ \_ принтера                                | Пустая строка ""<br/>              | Все локальные принтеры.<br/>                                                                    |
| \_имя ПЕРЕЧИСЛЕНИЯ \_ принтера                                | **NULL**<br/>                         | Все поставщики печати в домене компьютера<br/>                                           |
| Перечисление подключений к ПРИНТЕРАм \_ \_                         | Параметр *Name* игнорируется.<br/> | Все подключенные удаленные принтеры<br/>                                                          |
| \_сеть перечисление принтеров \_                             | Параметр *Name* игнорируется.<br/> | Все принтеры в домене компьютера<br/>                                                  |
| \_Удаленный перечисление принтеров \_                              | Пустая строка ""<br/>              | Все принтеры и серверы печати в домене компьютера<br/>                                |
| \_Удаленный перечисление принтеров \_                              | "Поставщик печати"<br/>                 | То же, что и \_ имя ПЕРЕЧИСЛЕНИЯ принтера \_<br/>                                                            |
| \_Удаленный перечисление принтеров \_                              | "Поставщик печати! Поддомен<br/>          | Все принтеры и серверы печати в домене компьютера, независимо от указанного *домена* .<br/> |
| Категория перечисления ПРИНТЕРов, \_ \_ \_ трехмерная                        | Параметр *Name* игнорируется.<br/> | Перечисляются только объемные принтеры.<br/>                                                       |
| \_Категория ПЕРЕЧИСЛЕНИЯ принтеров \_ \_                       | Параметр *Name* игнорируется.<br/> | 3D-принтеры перечисляются вместе со всеми остальными принтерами.<br/>                             |



 

## <a name="requirements"></a>Requirements (Требования)



| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows 2000 Professional \[только классические приложения\]<br/>                                                |
| Минимальная версия сервера<br/> | Windows 2000 Server \[только классические приложения\]<br/>                                                      |
| Заголовок<br/>                   | <dl> <dt>винспул. h (включает Windows. h)</dt> </dl> |
| Библиотека<br/>                  | <dl> <dt>Винспул. lib</dt> </dl>                   |
| DLL<br/>                      | <dl> <dt>Винспул. drv</dt> </dl>                   |
| Имя в кодировке Юникод и ANSI<br/>   | **Енумпринтерсв** (Юникод) и **енумпринтерса** (ANSI)<br/>                                       |



## <a name="see-also"></a>См. также

<dl> <dt>

[Вывод на печать](printdocs-printing.md)
</dt> <dt>

[Функции API очереди печати принтера](printing-and-print-spooler-functions.md)
</dt> <dt>

[**аддпринтер**](addprinter.md)
</dt> <dt>

[**делетепринтер**](deleteprinter.md)
</dt> <dt>

[**Наложение**](getprinter.md)
</dt> <dt>

[**\_Сведения о принтере \_ 1**](printer-info-1.md)
</dt> <dt>

[**\_Сведения о принтере \_ 2**](printer-info-2.md)
</dt> <dt>

[**\_Сведения о принтере \_ 4**](printer-info-4.md)
</dt> <dt>

[**\_Сведения о принтере \_ 5**](printer-info-5.md)
</dt> <dt>

[**сетпринтер**](setprinter.md)
</dt> </dl>

 

