---
description: Функция Коннекттопринтердлг отображает диалоговое окно, позволяющее пользователям просматривать принтеры в сети и подключаться к ним.
ms.assetid: 7cb9108b-8b65-4af3-88c8-a69771ed8e3f
title: Функция Коннекттопринтердлг (Винспул. h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- ConnectToPrinterDlg
api_type:
- DllExport
api_location:
- WinSpool.drv
ms.openlocfilehash: 9af428533d111300d31f6529a0a030fc3b81ee7c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105674281"
---
# <a name="connecttoprinterdlg-function"></a>Функция Коннекттопринтердлг

Функция **коннекттопринтердлг** отображает диалоговое окно, позволяющее пользователям просматривать принтеры в сети и подключаться к ним. Если пользователь выбирает принтер, функция пытается создать соединение с ним; Если подходящий драйвер не установлен на сервере, пользователю предоставляется возможность создать принтер локально.

## <a name="syntax"></a>Синтаксис


```C++
HANDLE ConnectToPrinterDlg(
  _In_ HWND  hwnd,
  _In_ DWORD Flags
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*HWND* \[ окне\]
</dt> <dd>

Указывает родительское окно диалогового окна.

</dd> <dt>

*Флаги* \[ окне\]
</dt> <dd>

Этот параметр зарезервирован и должен быть равен нулю.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Если функция выполнена удачно и пользователь выбирает принтер, возвращаемое значение является маркером выбранного принтера.

Если функция завершается ошибкой или пользователь отменяет диалоговое окно, не выбирая принтер, возвращается значение **null**.

## <a name="remarks"></a>Комментарии

> [!Note]  
> Это блокирующая или синхронная функция, которая может не возвращать значение немедленно. Скорость возврата этой функцией зависит от факторов времени выполнения, таких как состояние сети, Конфигурация сервера печати и факторы реализации драйвера принтера, которые трудно предсказать при написании приложения. Вызов этой функции из потока, который управляет взаимодействием с пользовательским интерфейсом, может привести к невозможности реагирования приложения.

 

Функция **коннекттопринтердлг** пытается создать подключение к выбранному принтеру. Однако если на сервере, на котором находится принтер, не установлен подходящий драйвер, функция предлагает пользователю возможность создания принтера локально. Вызывающее приложение может определить, был ли функция создала принтер локально, вызвав метод «The [**PrintOut**](getprinter.md) » со структурой « [**Printer \_ info \_ 2**](printer-info-2.md) », а затем изучен элемент **атрибутов** этой структуры.

Приложение должно вызывать [**делетепринтер**](deleteprinter.md) для удаления локального принтера. Приложение должно вызывать [**делетепринтерконнектион**](deleteprinterconnection.md) для удаления подключения к принтеру.

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows 2000 Professional \[только классические приложения\]<br/>                                                |
| Минимальная версия сервера<br/> | Windows 2000 Server \[только классические приложения\]<br/>                                                      |
| Заголовок<br/>                   | <dl> <dt>Винспул. h (включение Windows. h)</dt> </dl> |
| Библиотека<br/>                  | <dl> <dt>Винспул. lib</dt> </dl>                   |
| DLL<br/>                      | <dl> <dt>Винспул. drv</dt> </dl>                   |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[Вывод на печать](printdocs-printing.md)
</dt> <dt>

[Функции API очереди печати принтера](printing-and-print-spooler-functions.md)
</dt> <dt>

[**аддпринтерконнектион**](addprinterconnection.md)
</dt> <dt>

[**клосепринтер**](closeprinter.md)
</dt> <dt>

[**делетепринтер**](deleteprinter.md)
</dt> <dt>

[**делетепринтерконнектион**](deleteprinterconnection.md)
</dt> <dt>

[**Наложение**](getprinter.md)
</dt> <dt>

[**\_Сведения о принтере \_ 2**](printer-info-2.md)
</dt> </dl>

 

 




