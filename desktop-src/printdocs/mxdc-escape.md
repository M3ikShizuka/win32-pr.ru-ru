---
description: Escape- \_ функция мксдк-принтера позволяет приложениям записывать документы в файл или на принтер в формате XPS с помощью конвертера документов XPS Microsoft (мксдк).
ms.assetid: 79aeb32e-94b1-4806-8ebf-a9d0956f4667
title: Функция MXDC_ESCAPE (Мксдк. h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- MXDC_ESCAPE
api_type:
- HeaderDef
api_location:
- mxdc.h
ms.openlocfilehash: 08b5ae7e44f7b9c35d6a395b78ce514aee050e5f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105650794"
---
# <a name="mxdc_escape-function"></a>\_Escape-функция мксдк

Escape-функция **мксдк \_** -принтера позволяет приложениям записывать документы в файл или на принтер в формате XPS с помощью конвертера документов XPS Microsoft (мксдк).

Чтобы выполнить эту операцию, вызовите функцию [**екстескапе**](/windows/desktop/api/Wingdi/nf-wingdi-extescape) со следующими параметрами.

## <a name="syntax"></a>Синтаксис


```C++
int MXDC_ESCAPE(
    hdc,
    cbInput,
    lpszInData,
    cbOutput,
    lpszOutData
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*HDC* 
</dt> <dd>

Маркер контекста устройства принтера.

</dd> <dt>

*кбинпут* 
</dt> <dd>

Размер (в байтах) данных, на которые указывает параметр *лпсзиндата* .

</dd> <dt>

*лпсзиндата* 
</dt> <dd>

Указатель на буфер, содержащий входные данные, которые всегда хранятся в одной из следующих структур.

<dl> <dd><a href="mxdcescapeheader.md">**мксдцескапехеадер**</a></dd> <dd><a href="mxdcprintticketescape.md">**мксдкпринттиккетескапе**</a></dd> <dd><a href="mxdcs0pagepassthroughescape.md">**MxdcS0PagePassthroughEscape**</a></dd> <dd><a href="mxdcs0pageresourceescape.md">**MxdcS0PageResourceEscape**</a></dd> </dl>

Каждая из этих структур имеет элемент кода операции, указывающий, что именно должно выполняться МКСДК. Подробные замечания об этих кодах см. в разделе Мксдцескапехеадер.



| Код операции (код операции)                                                                                                                                                                                                  | Действие                                                                                                                                                                                                                            |
|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="MXDCOP_GET_FILENAME"></span><span id="mxdcop_get_filename"></span><dl> <dt>**МКСДКОП \_ получить \_ имя файла**</dt> </dl>                                          | Задает для параметра *лпсзаутдата* функции [**екстескапе**](/windows/desktop/api/Wingdi/nf-wingdi-extescape) значение, либо полный путь к выходному файлу в виде строки, завершающейся нулем, либо другой размер строки.<br/>                               |
| <span id="MXDCOP_PRINTTICKET_FIXED_DOC_SEQ"></span><span id="mxdcop_printticket_fixed_doc_seq"></span><dl> <dt>**\_ \_ фиксированная \_ последовательность документов мксдкоп PRINTTICKET \_**</dt> </dl> | Связывает билет на печать с фиксированной последовательностью документов XPS.<br/>                                                                                                                                                         |
| <span id="MXDCOP_PRINTTICKET_FIXED_DOC"></span><span id="mxdcop_printticket_fixed_doc"></span><dl> <dt>**\_ \_ фиксированный документ мксдкоп PRINTTICKET \_**</dt> </dl>              | Связывает билет печати с документом XPS.<br/>                                                                                                                                                                        |
| <span id="MXDCOP_PRINTTICKET_FIXED_PAGE"></span><span id="mxdcop_printticket_fixed_page"></span><dl> <dt>**\_ \_ фиксированная страница мксдкоп PRINTTICKET \_**</dt> </dl>           | Связывает билет на печать со страницей XPS.<br/>                                                                                                                                                                            |
| <span id="MXDCOP_SET_S0PAGE"></span><span id="mxdcop_set_s0page"></span><dl> <dt>**МКСДКОП \_ Set \_ S0PAGE**</dt> </dl>                                                | Отправляет в выходные данные разметку XPS текущей страницы.<br/>                                                                                                                                                                |
| <span id="MXDCOP_SET_S0PAGE_RESOURCE"></span><span id="mxdcop_set_s0page_resource"></span><dl> <dt>**МКСДКОП \_ задать \_ S0PAGE \_ ресурс**</dt> </dl>                    | Отправляет на выход на страницу ресурс, например изображение или шрифт.<br/>                                                                                                                                                 |
| <span id="MXDCOP_SET_XPSPASSTHRU_MODE"></span><span id="mxdcop_set_xpspassthru_mode"></span><dl> <dt>**МКСДКОП \_ Set \_ кспспасссру \_ mode**</dt> </dl>                 | Помещает МКСДК в состояние сквозной передачи, позволяя приложению записывать XPS непосредственно в выходной файл без какой-либо обработки МКСДК. Таким образом может быть написан весь документ или даже последовательность документов.<br/> |



 

</dd> <dt>

*кбаутпут* 
</dt> <dd>

Размер (в байтах) данных, на которые указывает параметр *лпсзаутдата* .

</dd> <dt>

*лпсзаутдата* 
</dt> <dd>

Указатель на буфер, содержащий выходные данные.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Если функция выполнена удачно, возвращаемое значение больше нуля. Если функция завершается ошибкой или не поддерживается, возвращаемое значение меньше или равно нулю.

## <a name="remarks"></a>Комментарии

Эта escape-последовательность поддерживается МКСДК и XPSDrv, но не GDI.

Чтобы определить, является ли драйвер принтера МКСДК, вызовите [**екстескапе**](/windows/desktop/api/Wingdi/nf-wingdi-extescape) с помощью [**escape-**](/previous-versions/windows/desktop/legacy/dd144931(v=vs.85)) последовательности. Если драйвер является МКСДК, **екстескапе** вернет строку, завершающуюся нулем, " http://schemas.microsoft.com/xps/2005/06 ". Убедитесь, что буфер, на который ссылается параметр *лпсзаутдата* , достаточно велик, чтобы вместить эту строку.

Чтобы определить, является ли драйвер принтера Windows встроенным драйвером для записи XPS-документов (Microsoft), убедитесь, что драйвер принтера является МКСДК, а затем определите, что имя драйвера принтера — "Microsoft XPS Document Writer".

Чтобы получить имя драйвера принтера, используйте один из следующих методов. <dl> Вызовите [**жетпринтердривер**](getprinterdriver.md) с параметром *Level* , имеющим значение 1. Имя драйвера принтера возвращается в элементе **pName** структуры [**драйвера \_ \_ 1**](driver-info-1.md) .  
или  
Вызовите [**метод установки, указав**](getprinter.md) для параметра *уровня* значение 2. Имя драйвера принтера возвращается в элементе **пдривернаме** структуры " [**\_ сведения \_ о принтере**](printer-info-2.md) ".  
</dl>

В следующей таблице показано, где будут записаны различные объекты в XPS-файле различных типов.



| Объект       | Расположение в выходном файле    |
|--------------|--------------------------------|
| Фиксированная страница   | /Documents/1/Pages/Esc%d.fpage |
| Thumbnail    | /Documents/1/Metadata          |
| Билет на печать | /Documents/1/Metadata          |
| Шрифт         | /Documents/1/Resources/Fonts   |
| Образ        | /Documents/1/Resources/Images  |



 

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Только для \[ классических приложений Windows Vista\]<br/>                                    |
| Минимальная версия сервера<br/> | \[Только для настольных приложений Windows Server 2008\]<br/>                              |
| Header<br/>                   | <dl> <dt>Мксдк. h</dt> </dl> |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[Вывод на печать](printdocs-printing.md)
</dt> <dt>

[Escape-функции принтера](/previous-versions/windows/desktop/legacy/dd162843(v=vs.85))
</dt> <dt>

[**екстескапе**](/windows/desktop/api/Wingdi/nf-wingdi-extescape)
</dt> </dl>

 

