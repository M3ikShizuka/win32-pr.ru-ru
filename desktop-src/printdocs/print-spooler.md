---
description: Основным компонентом интерфейса печати является диспетчер очереди печати.
ms.assetid: 36ffb001-78e2-4fa0-8241-3891493ac02d
title: Очередь печати принтера
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4dfcc6ea2e46c06b5e51032a4c43f46df7f07c04
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104545591"
---
# <a name="print-spooler"></a>Очередь печати принтера

Основным компонентом интерфейса печати является диспетчер очереди печати. Диспетчер очереди печати — это исполняемый файл, управляющий процессом печати. Управление печатью предполагает получение расположения правильного драйвера принтера, загрузку этого драйвера, буферизацию вызовов функций высокого уровня в задание печати, планирование печати задания печати и т. д. Диспетчер очереди загрузки загружается при запуске системы и продолжит работу, пока операционная система не завершит работу.

Приложения, которые выводят на печать, создают контекст устройства печати (DC). Когда приложение создает контроллер домена, диспетчер очереди задач выполняет необходимые задачи, такие как определение расположения требуемого драйвера принтера, а затем его загрузка. Диспетчер очереди печати также определяет тип данных, используемый для записи задания печати.

Диспетчер очереди печати поддерживает следующие типы данных:

-   Расширенный метафайл (EMF).
-   Текст ASCII.
-   Необработанные данные, включающие такие типы данных принтеров, как PostScript, PCL и пользовательские типы данных.

Пользовательские типы данных можно добавить в Диспетчер очереди, установив дополнительные драйверы принтера и обработчики печати. Задание печати — это документ, хранящийся внутренним образом и закодированный с помощью одного из поддерживаемых типов данных, а задание печати может содержать одну или несколько страниц вывода. Задание печати может состоять из нескольких форм. Например, задание может состоять из одного конверта и трех страниц бумаги формата A4. Задание печати определяется (или задается в квадратных скобках) функциями [**стартдок**](/windows/desktop/api/Wingdi/nf-wingdi-startdoca) и [**енддок**](/windows/desktop/api/Wingdi/nf-wingdi-enddoc) .

Тип данных по умолчанию для задания печати — это расширенный метафайл. Запись EMF — это компактная структура, используемая для хранения команд вывода текста, команд растровой графики и т. д. Когда приложение вызывает [**стартдок**](/windows/desktop/api/Wingdi/nf-wingdi-startdoca), диспетчер очереди сообщений создает файл очереди и файл данных и начинает хранить записи EMF в файле очереди. Каждый раз, когда приложение вызывает одну из функций рисования GDI, создается одна или несколько новых записей EMF, которые сохраняются в файле очереди. Файлы очереди и данных создаются в каталоге операционной системы. Диспетчер очереди печати использует файл очереди для хранения записей EMF и использует файл данных для записи типа формы, типа данных для задания печати, целевого принтера и т. д. После успешной печати задания Диспетчер очереди печати удаляет эти файлы.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Метафайлы с улучшенными форматами](/windows/desktop/gdi/enhanced-format-metafiles)
</dt> </dl>

 

 
