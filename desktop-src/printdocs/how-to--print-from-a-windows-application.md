---
description: В этом разделе описывается, как выполнить печать из собственной программы Windows.
ms.assetid: D0AE8FF8-D02D-43D3-80CA-E13EAA894F87
title: Практические руководства. печать из программы Windows
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 84229823944d7f7104da359b953e579f1b21cdca
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105693600"
---
# <a name="how-to-print-from-a-windows-program"></a>Практические руководства. печать из программы Windows

В этом разделе описывается, как выполнить печать из собственной программы Windows.

## <a name="overview"></a>Обзор

Печать обычно является неотъемлемой частью собственной программы Windows. Таким образом, это не функция, которую можно легко добавить после написания программы. С другой стороны, если программа разработана для использования XPS-документов, то при наличии любого дополнительного кода для отрисовки содержимого документа для печати он не потребуется. XPS-документы приложения можно отправлять непосредственно на принтер, имеющий драйвер принтера XPSDrv.

Используйте [API документа XPS](/previous-versions/windows/desktop/dd316976(v=vs.85)) для создания содержимого документа и [API печати XPS](xps-printing.md) для отправки содержимого документа на принтер. API печати XPS обрабатывает содержимое документа для принтера назначения. Если на выбранном принтере имеется драйвер принтера XPSDrv, документ будет отправлен на принтер без дополнительного преобразования. Если на выбранном принтере установлен драйвер принтера на основе GDI, программа также может отправить содержимое на принтер, а API печати XPS преобразует содержимое документа таким образом, чтобы оно было совместимо с драйвером принтера на основе GDI. В любом случае обработка, выполняемая приложением, выполняется одинаково.

## <a name="printing-tasks"></a>Задачи печати

В следующих разделах описаны основные шаги печати содержимого программы.

1.  **Получение сведений о задании печати от пользователя.**

    Как правило, пользователь инициирует задание печати при выборе параметра Печать в меню, и программа отображает диалоговое окно Печать для получения сведений о задании печати. Пользователь обычно выбирает принтер, число копий и сведения о конфигурации принтера, такие как двусторонняя печать и сшивание.

    Сведения о том, как это сделать, см. в разделе [руководство. Получение сведений о задании печати от пользователя](preparing-to-print.md).

2.  **Создать индикатор хода выполнения.**

    Индикатор выполнения предоставляет пользователю отзыв о ходе выполнения задания печати. Индикатор хода выполнения может находиться в виде индикатора выполнения, который является частью диалогового окна, включающего кнопку **отмены** для задания, или индикатором выполнения в строке состояния в нижней части главного окна.

    Сведения о работе индикатора выполнения см. в разделе [инструкции. Отображение хода выполнения задания печати](cancel-dialog-box.md).

    Дополнительные сведения о том, как отобразить ход выполнения задания печати, см. в разделе рекомендации по [разработке пользовательского интерфейса приложения Windows](/windows/desktop/windows-application-ui-development) .

3.  **Запустите поток печати.**

    После того как программа собрал сведения о задании печати от пользователя, она может запустить поток печати, чтобы выполнить фактическую обработку документа для печати.

    Сведения о потоке печати см. [в разделе как запускать и прекращать поток печати](how-to--start-and-stop-a-printing-thread.md).

4.  **Прорисовка данных задания печати.**

    Поток печати визуализирует данные документа для печати. Эту обработку следует разбить на отдельные этапы обработки, чтобы пользователь мог прервать обработку и отменить задание, а также запретить потоку обработки блокировать другие потоки и процессы.

    Сведения о том, как отрисовывает данные задания печати, см. [в разделе как отобразить данные задания](how-to--render-the-print-job-data.md)печати.

5.  **Отслеживание хода выполнения задания печати.**

    По мере выполнения каждого шага обработки обновите индикатор выполнения для информирования об использовании. Вычислите этапы обработки, чтобы завершить выполнение запрошенного задания, а затем обновляет индикатор выполнения по мере выполнения этих шагов.

6.  **Закройте задание печати и завершите поток печати.**

    После того как программа отправила задание печати на принтер или пользователь отменил задание печати, необходимо закрыть задание печати и освободить ресурсы, используемые заданием печати.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Инструкции. Получение сведений о задании печати от пользователя](preparing-to-print.md)
</dt> </dl>

 

 
