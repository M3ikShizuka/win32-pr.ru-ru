---
description: Функция Финдфирстпринтерчанженотификатион создает объект уведомления об изменении и возвращает в объект маркер. Затем этот маркер можно использовать в вызове одной из функций ожидания для отслеживания изменений принтера или сервера печати.
ms.assetid: 4155ef5c-cd96-4960-919b-d9a495bb73a5
title: Функция Финдфирстпринтерчанженотификатион (Винспул. h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- FindFirstPrinterChangeNotification
api_type:
- DllExport
api_location:
- Spoolss.dll
ms.openlocfilehash: 2da6a2ae73aa5b987ea3b8f8789f81ed0b4cdf06
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127268363"
---
# <a name="findfirstprinterchangenotification-function"></a>Функция Финдфирстпринтерчанженотификатион

Функция **финдфирстпринтерчанженотификатион** создает объект уведомления об изменении и возвращает в объект маркер. Затем этот маркер можно использовать в вызове одной из функций ожидания для отслеживания изменений принтера или сервера печати.

Вызов **финдфирстпринтерчанженотификатион** указывает тип отслеживаемых изменений. Можно указать набор условий для отслеживания изменений, набор полей сведений о принтерах для мониторинга или и то, и другое.

Операция ожидания для обработчика уведомлений об изменениях выполняется, если одно из указанных изменений происходит в указанном принтере или на сервере печати. Затем вызывается функция [**финднекстпринтерчанженотификатион**](findnextprinterchangenotification.md) для получения сведений об изменении и сброса объекта уведомления об изменении для использования в следующей операции ожидания.

## <a name="syntax"></a>Синтаксис


```C++
HANDLE FindFirstPrinterChangeNotification(
  _In_     HANDLE hPrinter,
           DWORD  fdwFilter,
           DWORD  fdwOptions,
  _In_opt_ LPVOID pPrinterNotifyOptions
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*хпринтер* \[ окне\]
</dt> <dd>

Описатель для принтера или сервера печати, который требуется отслеживать. Используйте функцию [**опенпринтер**](openprinter.md) или [**аддпринтер**](addprinter.md) для получения маркера принтера.

</dd> <dt>

*фдвфилтер* 
</dt> <dd>

Условия, которые приведут к тому, что объект уведомления об изменении перейдет в сигнальное состояние. Уведомление об изменении возникает при выполнении одного или нескольких указанных условий. Параметр *фдвфилтер* может быть равен нулю, если *Ппринтернотифйоптионс* не равен **null**.

Этот параметр может принимать одно или несколько следующих значений.



| Значение                                                                                                                                                                                                              | Значение                                                                                                                                                                                                                                                                                                                                                                      |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="PRINTER_CHANGE_FORM"></span><span id="printer_change_form"></span><dl> <dt>**\_форма изменения \_ принтера**</dt> </dl>                                   | Уведомление об изменениях в форме. Можно задать общий флаг или один или несколько следующих флагов:<br/> <dl> <dd>\_ \_ Добавление формы изменения \_ принтера</dd> <dd>\_ \_ форма набора изменений \_ принтера</dd> <dd>\_ \_ форма удаления изменения \_ принтера</dd> </dl>                                                                              |
| <span id="PRINTER_CHANGE_JOB"></span><span id="printer_change_job"></span><dl> <dt>**\_Задание изменения \_ принтера**</dt> </dl>                                      | Уведомление об изменениях в задании. Можно задать общий флаг или один или несколько следующих флагов:<br/> <dl> <dd>\_ \_ Добавление задания изменения \_ принтера</dd> <dd>\_Задание по изменению \_ набора принтеров \_</dd> <dd>\_ \_ Задание удаления изменений \_ принтера</dd> <dd>\_ \_ Задание записи изменения \_ принтера</dd> </dl>                                  |
| <span id="PRINTER_CHANGE_PORT"></span><span id="printer_change_port"></span><dl> <dt>**\_порт изменения \_ принтера**</dt> </dl>                                   | Уведомление об изменениях в порте. Можно задать общий флаг или один или несколько следующих флагов:<br/> <dl> <dd>\_ \_ Добавление порта для изменения принтера \_</dd> <dd>\_Изменение принтера \_ Настройка \_ порта </dd> <dd>\_ \_ порт удаления для изменения принтера \_</dd> </dl>                                                                       |
| <span id="PRINTER_CHANGE_PRINT_PROCESSOR"></span><span id="printer_change_print_processor"></span><dl> <dt>**\_ \_ обработчик печати изменения \_ принтера**</dt> </dl> | Уведомление об изменениях в обработчике заданий печати. Можно задать общий флаг или один или несколько следующих флагов: <br/> <dl> <dd>\_Изменение принтера \_ Добавление \_ \_ обработчика печати </dd> <dd>\_ \_ \_ обработчик печати изменения принтера \_</dd> </dl>                                                                                        |
| <span id="PRINTER_CHANGE_PRINTER"></span><span id="printer_change_printer"></span><dl> <dt>**\_принтер изменения \_ принтера**</dt> </dl>                          | Уведомление об изменениях в принтере. Можно задать общий флаг или один или несколько следующих флагов:<br/> <dl> <dd>\_Изменение принтера \_ Добавление \_ принтера</dd> <dd>\_Настройка принтера \_ изменить \_ принтер</dd> <dd>\_Изменение принтера \_ Удаление \_ принтера</dd> <dd>принтер \_ \_ не смог изменить \_ подключение \_</dd> </dl> |
| <span id="PRINTER_CHANGE_PRINTER_DRIVER"></span><span id="printer_change_printer_driver"></span><dl> <dt>**ПРИНТЕР \_ изменить \_ \_ драйвер принтера**</dt> </dl>    | Уведомление об изменениях в драйвере принтера. Можно задать общий флаг или один или несколько следующих флагов:<br/> <dl> <dd>\_Изменение принтера \_ Добавление \_ \_ драйвера принтера</dd> <dd>изменение принтера " \_ \_ задать \_ \_ драйвер принтера"</dd> <dd>\_Изменение принтера \_ Удаление \_ \_ драйвера принтера</dd> </dl>                                   |
| <span id="PRINTER_CHANGE_ALL"></span><span id="printer_change_all"></span><dl> <dt>**\_изменение \_ всех принтеров**</dt> </dl>                                      | Уведомлять при возникновении любого из перечисленных выше изменений.<br/>                                                                                                                                                                                                                                                                                                                     |
| <span id="PRINTER_CHANGE_SERVER"></span><span id="printer_change_server"></span><dl> <dt>**\_сервер изменения \_ принтера**</dt> </dl>                             | Windows 7: уведомление о любых изменениях на сервере.<br/> Этот флаг не включен в отслеживаемые изменения путем установки значения " **\_ изменить \_ все** " для принтера.<br/>                                                                                                                                                                                                      |



 

Описание более конкретных флагов в приведенной выше таблице см. в описании функции [**финднекстпринтерчанженотификатион**](findnextprinterchangenotification.md) .

</dd> <dt>

*фдвоптионс* 
</dt> <dd>

Флаг, определяющий категорию принтеров, для которых будут работать уведомления.



| Значение                                                                                                                                                                                                                                                               | Значение                                                                                                                                      |
|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="PRINTER_NOTIFY_CATEGORY_ALL"></span><span id="printer_notify_category_all"></span><dl> <dt>**Принтер \_ УВЕДОМЛЯТЬ \_ категорию \_ обо всех**</dt> <dt>0x001000</dt> </dl> | [**Финднекстпринтерчанженотификатион**](findnextprinterchangenotification.md) возвращает уведомления для двумерных и трехмерных принтеров.<br/> |
| <span id="PRINTER_NOTIFY_CATEGORY_3D"></span><span id="printer_notify_category_3d"></span><dl> <dt>**Принтер \_ УВЕДОМЛЕНИЕ \_ категории \_ 3D**</dt> <dt>0x002000</dt> </dl>    | [**Финднекстпринтерчанженотификатион**](findnextprinterchangenotification.md) возвращает уведомления только для объемных принтеров.<br/>        |



 

Если этот флаг установлен в ноль (0), **финдфирстпринтерчанженотификатион** будет работать только для двумерных принтеров. Это значение по умолчанию.

</dd> <dt>

*ппринтернотифйоптионс* \[ в необязательное\]
</dt> <dd>

Указатель на структуру [**\_ \_ параметров уведомления принтера**](printer-notify-options.md) . Элемент **птипес** этой структуры является массивом из одного или нескольких [**\_ \_ параметров \_ уведомления принтера**](printer-notify-options-type.md) , каждый из которых указывает поле сведений о принтере для отслеживания. Уведомление об изменении возникает при изменении одного или нескольких указанных полей. Когда происходит изменение, функция [**финднекстпринтерчанженотификатион**](findnextprinterchangenotification.md) может получить сведения о новом принтере. Этот параметр может иметь **значение NULL** , если *фдвфилтер* не равен нулю.

Список полей, которые можно отслеживать, см. в разделе [**\_ Параметры уведомлений \_ принтера \_ тип**](printer-notify-options-type.md).

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Если функция выполнена, возвращаемое значение является обработчиком объекта уведомления об изменении, связанного с указанным принтером или сервером печати.

Если функция завершается ошибкой, возвращаемое значение является недопустимым \_ \_ значением Handle.

## <a name="remarks"></a>Remarks

> [!Note]  
> Это блокирующая или синхронная функция, которая может не возвращать значение немедленно. Скорость возврата этой функцией зависит от факторов времени выполнения, таких как состояние сети, Конфигурация сервера печати и факторы реализации драйвера принтера, которые трудно предсказать при написании приложения. Вызов этой функции из потока, который управляет взаимодействием с пользовательским интерфейсом, может привести к невозможности реагирования приложения.

 

Для наблюдения за принтером или сервером печати вызовите функцию **финдфирстпринтерчанженотификатион** , а затем используйте возвращенный обработчик объекта уведомления об изменении в вызове одной из [функций ожидания](/windows/desktop/Sync/wait-functions). Операция ожидания для объекта уведомления об изменении будет удовлетворена, когда объект уведомления об изменении переходит в сигнальное состояние. Система сообщает объекту, когда один или несколько изменений, указанных в *фдвфилтер* или *ппринтернотифйоптионс* , происходят на наблюдаемом принтере или сервере печати.

При вызове **финдфирстпринтерчанженотификатион** значение *фдвфилтер* должно быть ненулевым или *ппринтернотифйоптионс* не должно быть **null**. Если указаны оба значения, уведомления будут выполняться для обоих.

Если операция ожидания на объекте уведомления об изменении принтера удовлетворена, вызовите функцию [**финднекстпринтерчанженотификатион**](findnextprinterchangenotification.md) , чтобы определить причину уведомления. Для условия, заданного параметром *фдвфилтер*, **финднекстпринтерчанженотификатион** сообщает об изменении условия. Для поля сведений о принтере, указанного параметром *ппринтернотифйоптионс*, **финднекстпринтерчанженотификатион** сообщает об изменении поля или полей, а также о новых данных этих полей. **Финднекстпринтерчанженотификатион** также сбрасывает объект уведомления об изменении на несигнальное состояние, поэтому его можно использовать в другой операции ожидания, чтобы продолжить наблюдение за принтером или сервером печати.

За одним исключением не следует вызывать функцию [**финднекстпринтерчанженотификатион**](findnextprinterchangenotification.md) , если объект уведомления об изменении не находится в сигнальном состоянии. Если функция Wait возвращает значение \_ времени ожидания ожидания, объект изменения не находится в сигнальном состоянии. Вызовите функцию **финднекстпринтерчанженотификатион** только в том случае, если функция Wait завершилась без времени ожидания. Исключением является то  , что при вызове финднекстпринтерчанженотификатион \_ с \_ параметром "Обновить" параметры уведомления принтера \_ , заданные в аргументе *ппринтернотифйоптионс* .

Если объект уведомления об изменениях больше не нужен, закройте его, вызвав функцию [**финдклосепринтерчанженотификатион**](findcloseprinterchangenotification.md) .

Вызывающие объекты **финдфирстпринтерчанженотификатион** должны гарантировать, что обработчик принтера, переданный в **финдфирстпринтерчанженотификатион** , остается действительным до вызова [**финдклосепринтерчанженотификатион**](findcloseprinterchangenotification.md) . Если маркер принтера закрыт до получения маркера уведомления об изменении принтера, дальнейшие уведомления не будут доставлены.

**Финдфирстпринтерчанженотификатион** не будет отправлять уведомления об изменениях для трехмерных принтеров в дескрипторы сервера.

> [!Note]  
> в Windows XP с пакетом обновления 2 (sp2) и более поздних версий брандмауэр подключения к интернету (ICF) по умолчанию блокирует порты принтера, но можно включить исключение для общего доступа к файлам и принтерам. Если пользователь устанавливает подключение принтера к другому компьютеру и исключение не включено, пользователь не будет получать уведомления об изменении принтера с сервера. Администратор компьютера должен включить исключение.

 

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows 2000 Professional \[только классические приложения\]<br/>                                                |
| Минимальная версия сервера<br/> | Windows 2000 Server \[только классические приложения\]<br/>                                                      |
| Заголовок<br/>                   | <dl> <dt>винспул. h (включает Windows. h)</dt> </dl> |
| Библиотека<br/>                  | <dl> <dt>Винспул. lib</dt> </dl>                   |
| DLL<br/>                      | <dl> <dt>Spoolss.dll</dt> </dl>                    |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[Вывод на печать](printdocs-printing.md)
</dt> <dt>

[Функции API очереди печати принтера](printing-and-print-spooler-functions.md)
</dt> <dt>

[**финдклосепринтерчанженотификатион**](findcloseprinterchangenotification.md)
</dt> <dt>

[**финднекстпринтерчанженотификатион**](findnextprinterchangenotification.md)
</dt> <dt>

[**опенпринтер**](openprinter.md)
</dt> <dt>

[**\_Параметры уведомления \_ принтера**](printer-notify-options.md)
</dt> <dt>

[**\_ \_ тип параметров уведомления \_ принтера**](printer-notify-options-type.md)
</dt> </dl>

 

