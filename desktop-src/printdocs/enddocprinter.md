---
description: Функция Енддокпринтер завершает задание печати для указанного принтера.
ms.assetid: 13c713e8-cc24-4191-8b1e-967b9e20e541
title: Функция Енддокпринтер (Винспул. h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- EndDocPrinter
api_type:
- DllExport
api_location:
- Spoolss.dll
- Ext-MS-Win-Printer-WinSpool-l1-1-2.dll
- WinSpool.Drv
- Ext-MS-Win-Printer-WinSpool-L1-1-3.dll
ms.openlocfilehash: 8d3e2bc110e5ee9412bb1edb89779f896edb015a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105693142"
---
# <a name="enddocprinter-function"></a>Функция Енддокпринтер

Функция **енддокпринтер** завершает задание печати для указанного принтера.

## <a name="syntax"></a>Синтаксис


```C++
BOOL EndDocPrinter(
  _In_ HANDLE hPrinter
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*хпринтер* \[ окне\]
</dt> <dd>

Обработчик принтера, для которого должно быть завершено задание печати. Используйте функцию [**опенпринтер**](openprinter.md) или [**аддпринтер**](addprinter.md) для получения маркера принтера.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Если функция выполнена, возвращаемое значение будет ненулевым.

Если функция выполняется неудачно, возвращается нулевое значение.

## <a name="remarks"></a>Комментарии

> [!Note]  
> Это блокирующая или синхронная функция, которая может не возвращать значение немедленно. Скорость возврата этой функцией зависит от факторов времени выполнения, таких как состояние сети, Конфигурация сервера печати и факторы реализации драйвера принтера, которые трудно предсказать при написании приложения. Вызов этой функции из потока, который управляет взаимодействием с пользовательским интерфейсом, может привести к невозможности реагирования приложения.

 

Функция **енддокпринтер** возвращает ошибку, если задание печати не было запущено вызовом функции [**стартдокпринтер**](startdocprinter.md) .

Последовательность для задания печати выглядит следующим образом:

1.  Чтобы начать задание печати, вызовите [**стартдокпринтер**](startdocprinter.md).
2.  Чтобы начать каждую страницу, вызовите [**стартпажепринтер**](startpageprinter.md).
3.  Чтобы записать данные на страницу, вызовите [**вритепринтер**](writeprinter.md).
4.  Чтобы завершить каждую страницу, вызовите [**ендпажепринтер**](endpageprinter.md).
5.  Повторите 2, 3 и 4 для требуемого количества страниц.
6.  Чтобы завершить задание печати, вызовите **енддокпринтер**.

Если страница в выгруженном в очередь файле превышает приблизительно 350 МБ, может произойти сбой печати и сообщение об ошибке не отправляется. Например, это может произойти при печати больших EMF файлов. Ограничение размера страницы зависит от многих факторов, включая объем доступной виртуальной памяти, объем памяти, выделенной вызывающими процессами, и объем фрагментации в куче процесса.

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows 2000 Professional \[только классические приложения\]<br/>                                                |
| Минимальная версия сервера<br/> | Windows 2000 Server \[только классические приложения\]<br/>                                                      |
| Заголовок<br/>                   | <dl> <dt>Винспул. h (включение Windows. h)</dt> </dl> |
| Библиотека<br/>                  | <dl> <dt>Винспул. lib</dt> </dl>                   |
| DLL<br/>                      | <dl> <dt>Spoolss.dll</dt> </dl>                    |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[Вывод на печать](printdocs-printing.md)
</dt> <dt>

[Функции API очереди печати принтера](printing-and-print-spooler-functions.md)
</dt> <dt>

[**енддокпринтер**](enddocprinter.md)
</dt> <dt>

[**ендпажепринтер**](endpageprinter.md)
</dt> <dt>

[**стартдокпринтер**](startdocprinter.md)
</dt> <dt>

[**стартпажепринтер**](startpageprinter.md)
</dt> <dt>

[**вритепринтер**](writeprinter.md)
</dt> </dl>

 

 




