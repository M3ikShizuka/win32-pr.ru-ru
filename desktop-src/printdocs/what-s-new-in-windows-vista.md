---
description: Список программных интерфейсов для печати, появившихся в Windows Vista.
ms.assetid: 7a4eb5d7-b37d-4090-aea4-7274daa1e15c
title: Новые возможности печати в Windows Vista
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3b8648d57f48623e6db0f6311bb07ae24ac15d96
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105712241"
---
# <a name="whats-new-for-printing-in-windows-vista"></a>Новые возможности печати в Windows Vista

Список программных интерфейсов для печати, появившихся в Windows Vista.

Для управления билетами печати используются следующие функции и перечисления.



| Функция                                                               | Описание                                                                                                                                   | Header    | Библиотека     |
|------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------|-----------|-------------|
| [**птконвертпринттиккеттодевмоде**](/windows/desktop/api/prntvpt/nf-prntvpt-ptconvertprinttickettodevmode) | Преобразует билет печати в структуру [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) .                                                                            | Прнтвпт. h | Прнтвпт. lib |
| [**птконвертдевмодетопринттиккет**](/windows/desktop/api/prntvpt/nf-prntvpt-ptconvertdevmodetoprintticket) | Преобразует [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) в билет печати.                                                                                      | Прнтвпт. h | Прнтвпт. lib |
| [**птрелеасемемори**](/windows/desktop/api/prntvpt/nf-prntvpt-ptreleasememory)                             | Освобождает буферы, созданные определенными функциями управления билетами печати.                                                                        | Прнтвпт. h | Прнтвпт. lib |
| [**птмержеандвалидатепринттиккет**](/windows/desktop/api/prntvpt/nf-prntvpt-ptmergeandvalidateprintticket) | Проверяет и объединяет два билета печати в допустимый билет на печать.                                                                            | Прнтвпт. h | Прнтвпт. lib |
| [**птжетпринткапабилитиес**](/windows/desktop/api/prntvpt/nf-prntvpt-ptgetprintcapabilities)               | Возвращает учетную запись возможностей принтера.                                                                                                | Прнтвпт. h | Прнтвпт. lib |
| [**птопенпровидер**](/windows/desktop/api/prntvpt/nf-prntvpt-ptopenprovider)                               | Открывает поставщик билетов на печать.                                                                                                                | Прнтвпт. h | Прнтвпт. lib |
| [**птопенпровидерекс**](/windows/desktop/api/prntvpt/nf-prntvpt-ptopenproviderex)                           | Открывает поставщик билетов на печать, даже если он не поддерживает предпочтительную версию [схемы печати](./print-schema.md). | Прнтвпт. h | Прнтвпт. lib |
| [**птклосепровидер**](/windows/desktop/api/prntvpt/nf-prntvpt-ptcloseprovider)                             | Закрывает поставщик билетов на печать.                                                                                                               | Прнтвпт. h | Прнтвпт. lib |
| [**пткуерисчемаверсионсуппорт**](/windows/desktop/api/prntvpt/nf-prntvpt-ptqueryschemaversionsupport)     | Возвращает последнюю версию [схемы печати](./print-schema.md) , поддерживаемую указанным принтером.                        | Прнтвпт. h | Прнтвпт. lib |



 



| Перечисление                                        | Описание                                                                                                                                                                               | Header    |
|----------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------|
| [**едефаултдевмодетипе**](/windows/win32/api/prntvpt/ne-prntvpt-edefaultdevmodetype) | Позволяет вызывающим объектам указать, какой [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) используется в качестве источника значений по умолчанию, если в билете на печать не указаны все параметры, которые могут быть в **DEVMODE**. | Прнтвпт. h |
| [**епринттиккетскопе**](/windows/desktop/api/prntvpt/ne-prntvpt-eprintticketscope)     | Задает область действия билета на печать.                                                                                                                                                    | Прнтвпт. h |



 

Для установки драйверов принтера используются следующие функции.



| Функция                                                                   | Описание                                                                                                                                                                 | Header     | Библиотека      |
|----------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|--------------|
| [**корепринтердриверинсталлед**](coreprinterdriverinstalled.md)           | Сообщает, установлен ли основной драйвер принтера с указанными GUID, датой и версией.                                                                                | Винспул. h | Винспул. lib |
| [**делетепринтердриверпаккаже**](deleteprinterdriverpackage.md)           | Удаляет пакет драйвера принтера из хранилища драйверов.                                                                                                                     | Винспул. h | Винспул. lib |
| [**жеткорепринтердриверс**](getcoreprinterdrivers.md)                     | Возвращает идентификатор GUID, версию и дату указанных основных драйверов принтера и путь к их пакетам.                                                                      | Винспул. h | Винспул. lib |
| [**жетпринтердриверпаккажепас**](getprinterdriverpackagepath.md)         | Возвращает путь к указанному пакету драйвера принтера на сервере печати.                                                                                                    | Винспул. h | Винспул. lib |
| [**инсталлпринтердриверфромпаккаже**](installprinterdriverfrompackage.md) | Устанавливает драйвер принтера из пакета драйверов в хранилище драйверов сервера печати.                                                                                         | Винспул. h | Винспул. lib |
| [**уплоадпринтердриверпаккаже**](uploadprinterdriverpackage.md)           | Передает драйвер принтера в хранилище драйверов сервера печати, чтобы его можно было установить с помощью [**инсталлпринтердриверфромпаккаже**](installprinterdriverfrompackage.md). | Винспул. h | Винспул. lib |



 

Следующие функции, перечисления и структуры используются для печати и управления принтерами и подключениями принтеров.



| Функция                                               | Описание                                                                                                                                              | Header     | Библиотека      |
|--------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------|------------|--------------|
| [**AddPrinterConnection2**](addprinterconnection2.md) | Добавляет подключение к указанному принтеру для текущего пользователя.                                                                                         | Винспул. h | Винспул. lib |
| [**OpenPrinter2**](openprinter2.md)                   | Извлекает дескриптор указанного принтера или сервера печати или других типов дескрипторов в подсистеме печати при настройке некоторых параметров принтера. | Винспул. h | Винспул. lib |



 



| Перечисление                                            | Описание                                                                                       | Header     |
|--------------------------------------------------------|---------------------------------------------------------------------------------------------------|------------|
| [**\_ \_ флаги параметров принтера**](printer-option-flags.md) | Задает кэширование маркера для принтера, открытого с помощью [**OpenPrinter2**](openprinter2.md). | Винспул. h |



 



| Структура                                                         | Описание                                                                            | Header     |
|-------------------------------------------------------------------|----------------------------------------------------------------------------------------|------------|
| [**ОСНОВНОЙ \_ \_ драйвер принтера**](core-printer-driver.md)              | Представляет драйвер принтера, от которого зависят другие драйверы принтеров.              | Винспул. h |
| [**\_Сведения о драйвере \_ 8**](driver-info-8.md)                          | Представляет драйвер принтера.                                                           | Винспул. h |
| [**\_Сведения о форме \_ 2**](form-info-2.md)                              | Представляет сведения о локализуемой печатной форме.                                 | Винспул. h |
| [**\_Сведения о задании \_ 4**](job-info-4.md)                                | Представляет полный набор значений, связанных с заданием, и поддерживает 64 битовых файлов буферизации. | Винспул. h |
| [**\_ \_ Сведения о подключении принтера \_ 1**](printer-connection-info-1.md) | Представляет сведения о соединении с принтером.                                | Винспул. h |
| [**\_Параметры принтера**](printer-options.md)                       | Представляет параметры принтера.                                                            | Винспул. h |
| [**ПРИНТПРОЦЕССОР \_ Cap \_ 2**](printprocessor-caps-2.md)          | Представляет сведения о принтера.                                             | Винспул. h |



 

Следующие функции, перечисления и интерфейсы используются для реализации новой асинхронной системы уведомлений о печати.



| Функция                                                                             | Описание                                                                                                                                                                                       | Header     | Библиотека      |
|--------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|--------------|
| [**креатепринтасинкнотифичаннел**](/windows/desktop/api/prnasnot/nf-prnasnot-createprintasyncnotifychannel)               | Создает коммуникационный канал между компонентом печати, размещенным в диспетчере очереди, например драйвером печати или монитором порта, и приложением, которое должно получать уведомления от компонента. | Прнаснот. h | Винспул. lib |
| [**регистерфорпринтасинкнотификатионс**](/windows/desktop/api/prnasnot/nf-prnasnot-registerforprintasyncnotifications)     | Регистрирует приложение для получения уведомлений от компонентов, размещенных в диспетчере очереди, таких как драйверы принтеров, обработчики печати и мониторы портов.                                                    | Прнаснот. h | Винспул. lib |
| [**унрегистерфорпринтасинкнотификатионс**](/windows/desktop/api/prnasnot/nf-prnasnot-unregisterforprintasyncnotifications) | Включает приложение, зарегистрированное для получения уведомлений от компонентов печати, размещенных в диспетчере очереди, для завершения подписки на уведомления.                                         | Прнаснот. h | Винспул. lib |



 



| Перечисление                                                                    | Описание                                                                                                                                                                                                          | Header     |
|--------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|
| [**принтасинкнотификонверсатионстиле**](/windows/desktop/api/prnasnot/ne-prnasnot-printasyncnotifyconversationstyle) | Указывает, является ли связь между приложениями и компонентами, размещенными в диспетчере очереди печати, такими как драйверы принтеров, обработчики печати и мониторы портов, двунаправленной или однонаправленной.                          | Прнаснот. h |
| [**принтасинкнотиферрор**](/windows/desktop/api/prnasnot/ne-prnasnot-printasyncnotifyerror)                         | Указывает ошибку в асинхронной транзакции уведомления.                                                                                                                                                      | Прнаснот. h |
| [**принтасинкнотифюсерфилтер**](/windows/desktop/api/prnasnot/ne-prnasnot-printasyncnotifyuserfilter)               | Указывает, будут ли уведомления переключаться только на прослушивающие приложения, связанные с тем же пользователем, что и отправитель, размещенный в диспетчере очереди печати, или же они будут переключаться на более широкий набор прослушивающих приложений. | Прнаснот. h |



 



| Интерфейс и метод                                                                                                      | Описание                                                                                                                                                   | Header     | Библиотека      |
|---------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------|------------|--------------|
| [**Ипринтасинкнотификаллбакк:: Чаннелклосед**](/windows/desktop/api/prnasnot/nf-prnasnot-iprintasyncnotifycallback-channelclosed)    | Используется одним из элементов коммуникационного канала для уведомления другого участника о закрытии канала.                                                    | Прнаснот. h | Винспул. lib |
| [**Ипринтасинкнотификаллбакк:: Оневентнотифи**](/windows/desktop/api/prnasnot/nf-prnasnot-iprintasyncnotifycallback-oneventnotify)    | Вызывается диспетчером очереди печати для оповещения прослушивателя о том, что уведомление доступно в указанном канале.                                                      | Прнаснот. h | Винспул. lib |
| [**Ипринтасинкнотифичаннел:: Клосечаннел**](/windows/desktop/api/prnasnot/nf-prnasnot-iprintasyncnotifychannel-closechannel)         | Закрывает канал связи.                                                                                                                               | Прнаснот. h | Винспул. lib |
| [**Ипринтасинкнотифичаннел:: SendNotification**](/windows/desktop/api/prnasnot/nf-prnasnot-iprintasyncnotifychannel-sendnotification) | Отправляет уведомление от компонента, размещенного диспетчером очереди печати, в одно или несколько прослушивающих приложений или отправляет ответ из приложения обратно в компонент. | Прнаснот. h | Винспул. lib |
| [**Ипринтасинкнотифидатаобжект:: Аккуиредата**](/windows/desktop/api/prnasnot/nf-prnasnot-iprintasyncnotifydataobject-acquiredata)  | Указывает, что приложения прослушивают данные уведомлений, а также размер и тип данных.                                                                   | Прнаснот. h | Винспул. lib |
| [**Ипринтасинкнотифидатаобжект:: Релеаседата**](/windows/desktop/api/prnasnot/nf-prnasnot-iprintasyncnotifydataobject-releasedata)  | Освобождает память, используемую данными, инкапсулированными в [**ипринтасинкнотифидатаобжект**](/windows/desktop/api/prnasnot/nn-prnasnot-iprintasyncnotifydataobject).                                  | Прнаснот. h | Винспул. lib |



 

Следующие перечисления и структуры используются для вызова конвертера документов XPS Microsoft (МКСДК), который записывает документы XPS в устройство или файл.



| Перечисление                                | Описание                                                            | Header |
|--------------------------------------------|------------------------------------------------------------------------|--------|
| [**MxdcS0PageEnums**](mxdcs0pageenums.md) | Указывает типы ресурсов, например шрифты или изображения, на странице XPS. | Мксдк. h |



 



| Структура                                                          | Описание                                                                                                                                    | Header |
|--------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------|--------|
| [**мксдцескапехеадер**](mxdcescapeheader.md)                       | Представляет инструкцию для МКСДК.                                                                                                         | Мксдк. h |
| [**мксдкжетфиленамедата**](mxdcgetfilenamedata.md)                 | Представляет полный путь и имя для выходного файла МКСДК.                                                                                     | Мксдк. h |
| [**мксдкпринттиккетескапе**](mxdcprintticketescape.md)             | Представляет сочетание [**мксдцескапехеадер**](mxdcescapeheader.md) и [**мксдкпринттиккетпасссраугх**](mxdcprintticketpassthrough.md). | Мксдк. h |
| [**мксдкпринттиккетпасссраугх**](mxdcprintticketpassthrough.md)   | Представляет билет на печать, который будет связан с документом XPS.                                                                        | Мксдк. h |
| [**MxdcS0PageData**](mxdcs0pagedata.md)                           | Представляет страницу в формате XPS, которая передается в выходной файл МКСДК без какой-либо обработки.                                                  | Мксдк. h |
| [**MxdcS0PagePassthroughEscape**](mxdcs0pagepassthroughescape.md) | Представляет сочетание [**мксдцескапехеадер**](mxdcescapeheader.md) и [**MxdcS0PageData**](mxdcs0pagedata.md).                         | Мксдк. h |
| [**MxdcS0PageResourceEscape**](mxdcs0pageresourceescape.md)       | Представляет сочетание [**мксдцескапехеадер**](mxdcescapeheader.md) и [**MxdcS0PageResource**](mxdcs0pageresourceescape.md).           | Мксдк. h |
| [**MxdcS0PageResource**](mxdcs0pageresourceescape.md)             | Представляет ресурс, например шрифт или изображение, который включается в МКСДК на странице XPS.                                                   | Мксдк. h |



 

 

 
