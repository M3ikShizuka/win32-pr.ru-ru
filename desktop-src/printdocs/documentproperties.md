---
description: Функция DocumentProperties извлекает или изменяет сведения об инициализации принтера или отображает страницу свойств конфигурации принтера для указанного принтера.
ms.assetid: e89a2f6f-2bac-4369-b526-f8e15028698b
title: Функция DocumentProperties (Винспул. h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- DocumentProperties
- DocumentPropertiesA
- DocumentPropertiesW
api_type:
- DllExport
api_location:
- Winspool.drv
- Ext-MS-Win-Printer-WinSpool-l1-1-2.dll
- Ext-MS-Win-Printer-WinSpool-L1-1-3.dll
ms.openlocfilehash: 349a085cc8f55f391b33dd5048d23a35fdac3c2b33b3771290bcecd9fdbcfc8e
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118235111"
---
# <a name="documentproperties-function"></a>Функция DocumentProperties

Функция **DocumentProperties** извлекает или изменяет сведения об инициализации принтера или отображает страницу свойств конфигурации принтера для указанного принтера.

## <a name="syntax"></a>Синтаксис


```C++
LONG DocumentProperties(
  _In_  HWND     hWnd,
  _In_  HANDLE   hPrinter,
  _In_  LPTSTR   pDeviceName,
  _Out_ PDEVMODE pDevModeOutput,
  _In_  PDEVMODE pDevModeInput,
  _In_  DWORD    fMode
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*HWND* \[ окне\]
</dt> <dd>

Маркер родительского окна страницы свойств конфигурации принтера.

</dd> <dt>

*хпринтер* \[ окне\]
</dt> <dd>

Маркер объекта принтера. Используйте функцию [**опенпринтер**](openprinter.md) или [**аддпринтер**](addprinter.md) для получения маркера принтера.

</dd> <dt>

*пдевиценаме* \[ окне\]
</dt> <dd>

Указатель на строку, завершающуюся нулем, которая указывает имя устройства, для которого отображается страница свойств конфигурации принтера.

</dd> <dt>

*пдевмодеаутпут* \[ заполняет\]
</dt> <dd>

Указатель на структуру [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) , которая получает данные конфигурации принтера, указанные пользователем.

</dd> <dt>

*пдевмодеинпут* \[ окне\]
</dt> <dd>

Указатель на структуру [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) , которую операционная система использует для инициализации элементов управления страницы свойств.

Этот параметр используется только в том случае, если флаг **DM \_ в \_ буфере** установлен в параметре *фмоде* . Если **DM \_ в \_ буфере** не задан, операционная система использует для принтера [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea)по умолчанию.

</dd> <dt>

*фмоде* \[ окне\]
</dt> <dd>

Операции, выполняемые функцией. Если этот параметр равен нулю, функция **DocumentProperties** возвращает число байтов, необходимых структуре данных [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) драйвера принтера. В противном случае используйте одну или несколько из следующих констант для создания значения для этого параметра. Однако обратите внимание, что для изменения параметров печати приложение должно указать по крайней мере одно входное значение и одно выходное значение.



| Значение                                                                                                                                                          | Значение                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|----------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="DM_IN_BUFFER"></span><span id="dm_in_buffer"></span><dl> <dt>**DM \_ в \_ буфере**</dt> </dl>    | Входное значение. Перед запросом, копированием или обновлением функция объединяет текущие параметры печати драйвера принтера с параметрами в структуре [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) , заданной параметром *пдевмодеинпут* . Функция обновляет структуру только для тех элементов, которые указаны в элементе **дмфиелдс** структуры **DEVMODE** . Это значение также определяется как **DM \_ Modify**. В случае конфликта во время слияния параметры в структуре **DEVMODE** , заданной параметром *пдевмодеинпут* , переопределяют текущие параметры печати драйвера принтера.<br/> |
| <span id="DM_IN_PROMPT"></span><span id="dm_in_prompt"></span><dl> <dt>**DM \_ в \_ запросе**</dt> </dl>    | Входное значение. Функция представляет страницу свойств настройки печати драйвера принтера, а затем изменяет параметры структуры данных [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) принтера на значения, указанные пользователем. Это значение также определяется как **\_ строка DM**.<br/>                                                                                                                                                                                                                                                                                                         |
| <span id="DM_OUT_BUFFER"></span><span id="dm_out_buffer"></span><dl> <dt>**\_выходной \_ буфер DM**</dt> </dl> | Выходное значение. Функция записывает текущие параметры печати драйвера принтера, включая закрытые данные, в структуру данных [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) , указанную параметром *пдевмодеаутпут* . Вызывающий объект должен выделить буфер достаточно большим для хранения данных. Если двоичные **наборы \_ \_ буферов DM** отключены, параметр *пдевмодеаутпут* может иметь **значение NULL**. Это значение также определяется как **DM \_ Copy**.<br/>                                                                                                                                          |



 

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Если параметр *фмоде* равен нулю, то возвращаемое значение представляет собой размер буфера, необходимого для хранения данных инициализации драйвера принтера. Обратите внимание, что этот буфер может быть больше, чем структура [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) , если драйвер принтера добавляет закрытые данные в структуру.

Если функция отображает страницу свойств, возвращается значение либо **идок** , либо **идканцел**, в зависимости от выбранной пользователем кнопки.

Если функция не отображает страницу свойств и завершается успешно, возвращается значение **идок**.

Если функция завершается ошибкой, возвращаемое значение меньше нуля.

## <a name="remarks"></a>Remarks

> [!Note]  
> Это блокирующая или синхронная функция, которая может не возвращать значение немедленно. Скорость возврата этой функцией зависит от факторов времени выполнения, таких как состояние сети, Конфигурация сервера печати и факторы реализации драйвера принтера, которые трудно предсказать при написании приложения. Вызов этой функции из потока, который управляет взаимодействием с пользовательским интерфейсом, может привести к невозможности реагирования приложения.

 

Строку, на которую указывает параметр *пдевиценаме* , можно получить путем вызова функции [**PrintOut**](getprinter.md) .

Структура [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) , которая фактически используется драйвером принтера, содержит независимую от устройства часть (как определено выше), за которой следует часть, относящаяся к драйверу, которая зависит от размера и содержимого с каждым драйвером и версией драйвера. Из-за этого зависимости от драйвера очень важно, чтобы приложения запрашивают драйвер для правильного размера структуры **DEVMODE** перед выделением для него буфера.

**Чтобы изменить параметры печати, которые являются локальными для приложения, приложение должно выполнить следующие действия:**

1.  Получите число байтов, необходимых для полной структуры [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) , вызвав **DocumentProperties** и указав ноль в параметре *фмоде* .
2.  Выделите память для полной структуры [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) .
3.  Получите текущие параметры принтера, вызвав **DocumentProperties**. Передайте указатель на структуру [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) , выделенную на шаге 2, в качестве параметра *пдевмодеаутпут* и укажите значение **\_ из \_ буфера DM out** .
4.  Измените соответствующие члены возвращенной структуры [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) и укажите, какие члены были изменены, задав соответствующие биты в элементе **дмфиелдс** **DEVMODE**.
5.  Вызовите **DocumentProperties** и передайте измененную структуру [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) обратно в качестве параметров *пдевмодеинпут* и *пдевмодеаутпут* и укажите значения **\_ в полях \_ buffer** и **DM \_ out \_** (в сочетании с оператором OR). Структура **DEVMODE** , возвращаемая третьим вызовом **DocumentProperties** , может использоваться в качестве аргумента при вызове функции [**креатедк**](/windows/desktop/api/wingdi/nf-wingdi-createdca) .

Чтобы создать маркер для контекста устройства принтера с помощью текущих параметров принтера, необходимо вызвать **DocumentProperties** дважды, как описано выше. Первый вызов получает размер полного [**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea) , а второй вызывает инициализацию **DEVMODE** с использованием текущих параметров принтера. Передайте инициализированный **DEVMODE** в [**креатедк**](/windows/desktop/api/wingdi/nf-wingdi-createdca) , чтобы получить маркер контекста устройства принтера.

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows 2000 Professional \[только классические приложения\]<br/>                                                |
| Минимальная версия сервера<br/> | Windows 2000 Server \[только классические приложения\]<br/>                                                      |
| Заголовок<br/>                   | <dl> <dt>винспул. h (включает Windows. h)</dt> </dl> |
| Библиотека<br/>                  | <dl> <dt>Винспул. lib</dt> </dl>                   |
| DLL<br/>                      | <dl> <dt>Винспул. drv</dt> </dl>                   |
| Имя в кодировке Юникод и ANSI<br/>   | **Документпропертиесв** (Юникод) и **документпропертиеса** (ANSI)<br/>                           |



## <a name="see-also"></a>См. также статью

<dl> <dt>

[Вывод на печать](printdocs-printing.md)
</dt> <dt>

[Функции API очереди печати принтера](printing-and-print-spooler-functions.md)
</dt> <dt>

[**адванцеддокументпропертиес**](advanceddocumentproperties.md)
</dt> <dt>

[**креатедк**](/windows/desktop/api/wingdi/nf-wingdi-createdca)
</dt> <dt>

[**DEVMODE**](/windows/win32/api/wingdi/ns-wingdi-devmodea)
</dt> <dt>

[**Наложение**](getprinter.md)
</dt> <dt>

[**опенпринтер**](openprinter.md)
</dt> </dl>

 

