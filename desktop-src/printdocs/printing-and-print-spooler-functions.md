---
description: API диспетчера очереди печати содержит функции и структуры данных, которые используются приложениями для управления диспетчером очереди печати Windows, принтерами и заданиями печати, которыми он управляет.
ms.assetid: d859f84d-af0e-4b8b-b7fa-d7b1fc35ed39
title: Функции API очереди печати принтера
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: df751b11206ebf26d2d0e8fd88f61ede8447dad1
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127570574"
---
# <a name="print-spooler-api-functions"></a>Функции API очереди печати принтера

API диспетчера очереди печати содержит функции и структуры данных, которые используются приложениями для управления диспетчером очереди печати Windows, принтерами и заданиями печати, которыми он управляет.

Функции API диспетчера очереди печати делятся на следующие группы:

-   [Функции заданий печати](#print-job-functions)
-   [Функции пользовательского интерфейса принтера](#printer-user-interface-functions)
-   [Функции принтера](#printer-functions)
-   [Функции уведомлений об изменениях принтера](#printer-change-notification-functions)
-   [Функции форм принтера](#printer-form-functions)
-   [Функции диспетчера очереди печати](#print-spooler-api-functions)

## <a name="print-job-functions"></a>Функции заданий печати

Эти функции отправляют задания печати на принтер, контролируя задания печати и управляют их в диспетчере очереди печати.



| Функция                                                                      | Описание                                                                                                                                                                                                                                             |
|-------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**AddJob**](addjob.md)<br/>                                           | Функция [**AddJob**](/windows/desktop/printdocs/addjob) добавляет задание печати в список заданий печати, которые могут быть запланированы диспетчером очереди печати. Функция возвращает имя файла, который можно использовать для хранения задания. <br/>                                      |
| [**клосепринтер**](closeprinter.md)<br/>                               | Функция [**клосепринтер**](/windows/desktop/printdocs/closeprinter) закрывает указанный объект принтера. <br/>                                                                                                                                                      |
| [**документевент**](documentevent.md)<br/>                             | Функция [**документевент**](/windows/desktop/printdocs/documentevent) является обработчиком событий, связанных с печатью документа. <br/>                                                                                                                     |
| [**DocumentProperties**](documentproperties.md)<br/>                   | Функция [**DocumentProperties**](/windows/desktop/printdocs/documentproperties) извлекает или изменяет сведения об инициализации принтера или отображает страницу свойств конфигурации принтера для указанного принтера. <br/>                                        |
| [**енддокпринтер**](enddocprinter.md)<br/>                             | Функция [**енддокпринтер**](/windows/desktop/printdocs/enddocprinter) завершает задание печати для указанного принтера. <br/>                                                                                                                                             |
| [**ендпажепринтер**](endpageprinter.md)<br/>                           | Функция [**ендпажепринтер**](/windows/desktop/printdocs/endpageprinter) уведомляет Диспетчер очереди печати о том, что приложение находится в конце страницы в задании печати. <br/>                                                                                               |
| [**енумжобс**](enumjobs.md)<br/>                                       | Функция [**енумжобс**](/windows/desktop/printdocs/enumjobs) извлекает сведения об указанном наборе заданий печати для указанного принтера. <br/>                                                                                                                |
| [**жетжоб**](getjob.md)<br/>                                           | Функция [**жетжоб**](/windows/desktop/printdocs/getjob) извлекает сведения об указанном задании печати. <br/>                                                                                                                                                    |
| [**опенпринтер**](openprinter.md)<br/>                                 | Функция [**опенпринтер**](/windows/desktop/printdocs/openprinter) извлекает дескриптор указанного принтера или сервера печати или других типов дескрипторов в подсистеме печати. <br/>                                                                               |
| [**OpenPrinter2**](openprinter2.md)<br/>                               | Извлекает дескриптор указанного принтера, сервера печати или других типов дескрипторов в подсистеме печати при настройке некоторых параметров принтера.<br/>                                                                                      |
| [**репортжобпроцессингпрогресс**](reportjobprocessingprogress.md)<br/> | Сообщает службе диспетчера очереди печати, находится ли задание печати XPS в очереди печати или на этапе отрисовки и какая часть обработки в данный момент выполняется.<br/>                                                                               |
| [**ScheduleJob**](schedulejob.md)<br/>                                 | Функция [**ScheduleJob**](/windows/desktop/printdocs/schedulejob) запрашивает, что диспетчер очереди печати запланирует печать указанного задания печати. <br/>                                                                                                                |
| [**сетжоб**](setjob.md)<br/>                                           | Функция [**сетжоб**](/windows/desktop/printdocs/setjob) приостанавливает, возобновляет, отменяет или перезапускает задание печати на указанном принтере. Можно также использовать функцию **сетжоб** , чтобы задать параметры задания печати, такие как приоритет задания печати и имя документа. <br/> |
| [**стартдокпринтер**](startdocprinter.md)<br/>                         | Функция [**стартдокпринтер**](/windows/desktop/printdocs/startdocprinter) уведомляет Диспетчер очереди печати, что документ должен быть помещен в очередь для печати. <br/>                                                                                                           |
| [**стартпажепринтер**](startpageprinter.md)<br/>                       | Функция [**стартпажепринтер**](/windows/desktop/printdocs/startpageprinter) уведомляет Диспетчер очереди печати, что страница будет напечатана на указанном принтере. <br/>                                                                                                 |



 

## <a name="printer-user-interface-functions"></a>Функции пользовательского интерфейса принтера

Эти функции отображают пользовательский интерфейс, позволяющий пользователю выбрать или настроить принтер.



| Функция                                                                    | Описание                                                                                                                                                                                                                                                                                                                                                        |
|-----------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**адванцеддокументпропертиес**](advanceddocumentproperties.md)<br/> | Функция [**адванцеддокументпропертиес**](/windows/desktop/printdocs/advanceddocumentproperties) отображает диалоговое окно настройки принтера для указанного принтера, позволяя пользователю настроить этот принтер. <br/>                                                                                                                                                      |
| [**конфигурепорт**](configureport.md)<br/>                           | Функция [**конфигурепорт**](/windows/desktop/printdocs/configureport) отображает диалоговое окно настройки порта для порта на указанном сервере. <br/>                                                                                                                                                                                                                     |
| [**коннекттопринтердлг**](connecttoprinterdlg.md)<br/>               | Функция [**коннекттопринтердлг**](/windows/desktop/printdocs/connecttoprinterdlg) отображает диалоговое окно, позволяющее пользователям просматривать принтеры в сети и подключаться к ним. Если пользователь выбирает принтер, функция пытается создать соединение с ним; Если подходящий драйвер не установлен на сервере, пользователю предоставляется возможность создать принтер локально. <br/> |
| [**принтерпропертиес**](printerproperties.md)<br/>                   | Функция [**принтерпропертиес**](/windows/desktop/printdocs/printerproperties) отображает страницу свойств принтера для указанного принтера. <br/>                                                                                                                                                                                                                    |



 

## <a name="printer-functions"></a>Функции принтера

Эти функции добавляют и настраивают принтеры, используемые диспетчером очереди печати.



| Функция                                                              | Описание                                                                                                                                                                                                                                                                                                                                                                                              |
|-----------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**абортпринтер**](abortprinter.md)<br/>                       | Функция [**абортпринтер**](/windows/desktop/printdocs/abortprinter) удаляет файл очереди принтера, если принтер настроен для работы в очереди. <br/>                                                                                                                                                                                                                                                                  |
| [**аддпринтер**](addprinter.md)<br/>                           | Функция [**аддпринтер**](/windows/desktop/printdocs/addprinter) добавляет принтер в список поддерживаемых принтеров для указанного сервера. <br/>                                                                                                                                                                                                                                                                       |
| [**аддпринтерконнектион**](addprinterconnection.md)<br/>       | Функция **аддпринтерконнектион** добавляет подключение к указанному принтеру для текущего пользователя. <br/>                                                                                                                                                                                                                                                                                       |
| [**AddPrinterConnection2**](addprinterconnection2.md)<br/>     | Добавляет подключение к указанному принтеру для текущего пользователя и задает сведения о подключении.<br/>                                                                                                                                                                                                                                                                                             |
| [**делетепринтер**](deleteprinter.md)<br/>                     | Функция [**делетепринтер**](/windows/desktop/printdocs/deleteprinter) удаляет указанный объект принтера. <br/>                                                                                                                                                                                                                                                                                                    |
| [**делетепринтерконнектион**](deleteprinterconnection.md)<br/> | Функция [**делетепринтерконнектион**](/windows/desktop/printdocs/deleteprinterconnection) удаляет подключение к принтеру, который был установлен с помощью вызова [**аддпринтерконнектион**](addprinterconnection.md) или [**коннекттопринтердлг**](connecttoprinterdlg.md). <br/>                                                                                                                                      |
| [**делетепринтердата**](deleteprinterdata.md)<br/>             | Функция [**делетепринтердата**](/windows/desktop/printdocs/deleteprinterdata) удаляет указанные данные конфигурации для принтера. Данные конфигурации принтера состоят из набора именованных и типизированных значений. Функция **делетепринтердата** удаляет одно из этих значений, указанное по имени значения. <br/>                                                                                                     |
| [**делетепринтердатаекс**](deleteprinterdataex.md)<br/>         | Функция [**делетепринтердатаекс**](/windows/desktop/printdocs/deleteprinterdataex) удаляет указанное значение из данных конфигурации для принтера. Данные конфигурации принтера состоят из набора именованных и типизированных значений, хранящихся в иерархии разделов реестра. Функция удаляет указанное значение в указанном ключе. <br/>                                                                        |
| [**делетепринтеркэй**](deleteprinterkey.md)<br/>               | Функция [**делетепринтеркэй**](/windows/desktop/printdocs/deleteprinterkey) удаляет указанный ключ и все его подразделы для указанного принтера. <br/>                                                                                                                                                                                                                                                               |
| [**енумпринтердата**](enumprinterdata.md)<br/>                 | Функция [**енумпринтердата**](/windows/desktop/printdocs/enumprinterdata) перечисляет данные конфигурации для указанного принтера. <br/>                                                                                                                                                                                                                                                                               |
| [**енумпринтердатаекс**](enumprinterdataex.md)<br/>             | Функция [**енумпринтердатаекс**](/windows/desktop/printdocs/enumprinterdataex) перечисляет все имена значений и данные для указанного принтера и ключа. <br/>                                                                                                                                                                                                                                                             |
| [**енумпринтеркэй**](enumprinterkey.md)<br/>                   | Функция [**енумпринтеркэй**](/windows/desktop/printdocs/enumprinterkey) перечисляет подразделы указанного ключа для указанного принтера. <br/>                                                                                                                                                                                                                                                                     |
| [**енумпринтерс**](enumprinters.md)<br/>                       | Функция [**енумпринтерс**](/windows/desktop/printdocs/enumprinters) перечисляет доступные принтеры, серверы печати, домены или поставщики печати. <br/>                                                                                                                                                                                                                                                                 |
| [**флушпринтер**](flushprinter.md)<br/>                       | Функция [**флушпринтер**](/windows/desktop/printdocs/flushprinter) отправляет буфер на принтер, чтобы очистить его из переходного состояния. <br/>                                                                                                                                                                                                                                                                 |
| [**жетдефаултпринтер**](getdefaultprinter.md)<br/>             | Функция [**жетдефаултпринтер**](/windows/desktop/printdocs/getdefaultprinter) извлекает имя принтера принтера по умолчанию для текущего пользователя на локальном компьютере. <br/>                                                                                                                                                                                                                                    |
| [**Наложение**](getprinter.md)<br/>                           | Функция [**PrintOut**](/windows/desktop/printdocs/getprinter) получает сведения о указанном принтере. <br/>                                                                                                                                                                                                                                                                                               |
| [**жетпринтердата**](getprinterdata.md)<br/>                   | Функция [**жетпринтердата**](/windows/desktop/printdocs/getprinterdata) получает данные конфигурации для указанного принтера или сервера печати. <br/>                                                                                                                                                                                                                                                                |
| [**жетпринтердатаекс**](getprinterdataex.md)<br/>               | Функция [**жетпринтердатаекс**](/windows/desktop/printdocs/getprinterdataex) получает данные конфигурации для указанного принтера или сервера печати. **Жетпринтердатаекс** может извлекать значения, хранящиеся в функции [**сетпринтердата**](setprinterdata.md) . Кроме того, **жетпринтердатаекс** может извлекать значения, хранящиеся в указанном ключе, с помощью функции [**сетпринтердатаекс**](setprinterdataex.md) . <br/> |
| [**исвалиддевмоде**](isvaliddevmode.md)<br/>                   | Функция [**исвалиддевмоде**](isvaliddevmode.md) проверяет допустимость содержимого структуры DEVMODE. <br/>                                                                                                                                                                                                                                                                           |
| [**реадпринтер**](readprinter.md)<br/>                         | Функция [**реадпринтер**](/windows/desktop/printdocs/readprinter) извлекает данные с указанного принтера. <br/>                                                                                                                                                                                                                                                                                                   |
| [**ресетпринтер**](resetprinter.md)<br/>                       | Функция [**ресетпринтер**](/windows/desktop/printdocs/resetprinter) указывает тип данных и значения режима устройства, которые будут использоваться для печати документов, отправляемых функцией [**стартдокпринтер**](startdocprinter.md) . Эти значения можно переопределить с помощью функции [**сетжоб**](setjob.md) после начала печати документа. <br/>                                                                  |
| [**SetDefaultPrinter**](setdefaultprinter.md)<br/>             | Функция [**SetDefaultPrinter**](/windows/desktop/printdocs/setdefaultprinter) задает имя принтера принтера по умолчанию для текущего пользователя на локальном компьютере. <br/>                                                                                                                                                                                                                                         |
| [**сетпорт**](setport.md)<br/>                                 | Функция [**сетпорт**](/windows/desktop/printdocs/setport) задает состояние, связанное с портом принтера. <br/>                                                                                                                                                                                                                                                                                                      |
| [**сетпринтер**](setprinter.md)<br/>                           | Функция [**сетпринтер**](/windows/desktop/printdocs/setprinter) задает данные для указанного принтера или задает состояние указанного принтера путем приостановки печати, возобновления печати или очистки всех заданий печати. <br/>                                                                                                                                                                                           |
| [**сетпринтердата**](setprinterdata.md)<br/>                   | Функция [**сетпринтердата**](/windows/desktop/printdocs/setprinterdata) задает данные конфигурации для принтера или сервера печати. <br/>                                                                                                                                                                                                                                                                             |
| [**сетпринтердатаекс**](setprinterdataex.md)<br/>               | Функция [**сетпринтердатаекс**](/windows/desktop/printdocs/setprinterdataex) задает данные конфигурации для принтера или сервера печати. Функция сохраняет данные конфигурации в разделе реестра принтера. <br/>                                                                                                                                                                                            |
| [**вритепринтер**](writeprinter.md)<br/>                       | Функция [**вритепринтер**](writeprinter.md) уведомляет Диспетчер очереди печати, что данные должны быть записаны на указанный принтер. <br/>                                                                                                                                                                                                                                                           |



 

## <a name="printer-change-notification-functions"></a>Функции уведомлений об изменениях принтера

Эти функции позволяют приложению получать уведомления об изменениях в состоянии принтера.



| Функция                                                                                    | Описание                                                                                                                                                                                                                                                                                                                                                                            |
|---------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**финдклосепринтерчанженотификатион**](findcloseprinterchangenotification.md)<br/> | Функция [**финдклосепринтерчанженотификатион**](/windows/desktop/printdocs/findcloseprinterchangenotification) закрывает объект уведомления об изменении, созданный путем вызова функции [**финдфирстпринтерчанженотификатион**](findfirstprinterchangenotification.md) . Этот объект больше не будет отслеживать принтер или сервер печати, связанный с объектом уведомления об изменении. <br/> |
| [**финдфирстпринтерчанженотификатион**](findfirstprinterchangenotification.md)<br/> | Функция [**финдфирстпринтерчанженотификатион**](/windows/desktop/printdocs/findfirstprinterchangenotification) создает объект уведомления об изменении и возвращает в объект маркер. Затем этот маркер можно использовать в вызове одной из функций ожидания для отслеживания изменений принтера или сервера печати. <br/>                                                                              |
| [**финднекстпринтерчанженотификатион**](findnextprinterchangenotification.md)<br/>   | Функция [**финднекстпринтерчанженотификатион**](findnextprinterchangenotification.md) извлекает сведения о последнем уведомлении об изменении для объекта уведомления о изменении, связанного с принтером или сервером печати. Вызывайте эту функцию, если выполняется операция ожидания объекта уведомления об изменении. <br/>                                           |
| [**фрипринтернотифинфо**](freeprinternotifyinfo.md)<br/>                           | Функция [**фрипринтернотифинфо**](/windows/desktop/printdocs/freeprinternotifyinfo) освобождает выделенный системой буфер, созданный функцией [**финднекстпринтерчанженотификатион**](findnextprinterchangenotification.md) . <br/>                                                                                                                                                                |



 

## <a name="printer-form-functions"></a>Функции форм принтера

Эти функции управляют формами, используемыми принтером.



| Функция                                    | Описание                                                                                                                                    |
|---------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------|
| [**аддформ**](addform.md)<br/>       | Функция [**аддформ**](/windows/desktop/printdocs/addform) добавляет форму в список доступных форм, которые можно выбрать для указанного принтера. <br/> |
| [**делетеформ**](deleteform.md)<br/> | Функция [**делетеформ**](/windows/desktop/printdocs/deleteform) удаляет имя формы из списка поддерживаемых форм. <br/>                                |
| [**енумформс**](enumforms.md)<br/>   | Функция [**енумформс**](/windows/desktop/printdocs/enumforms) перечисляет формы, поддерживаемые указанным принтером. <br/>                               |
| [**Форма**](getform.md)<br/>       | Функция функции- [**формы**](/windows/desktop/printdocs/getform) получает сведения об указанной форме. <br/>                                              |
| [**сетформ**](setform.md)<br/>       | Функция [**сетформ**](/windows/desktop/printdocs/setform) задает сведения о форме для указанного принтера. <br/>                                       |



 

## <a name="print-spooler-functions"></a>Функции диспетчера очереди печати

Эти функции взаимодействуют с диспетчером очереди печати на низком уровне.



| Функция                                                          | Описание                                                                                                                                                                                            |
|-------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**клосеспулфилехандле**](closespoolfilehandle.md)<br/>   | Функция [**клосеспулфилехандле**](/windows/desktop/printdocs/closespoolfilehandle) закрывает обработчик файла очереди, связанного с текущим заданием печати, отправленным приложением. <br/>                    |
| [**коммитспулдата**](commitspooldata.md)<br/>             | Функция [**коммитспулдата**](/windows/desktop/printdocs/commitspooldata) уведомляет Диспетчер очереди печати о том, что указанный объем данных записан в указанный файл очереди и готов к отображению. <br/> |
| [**жетпринтексекутиондата**](getprintexecutiondata.md)<br/> | [**Жетпринтексекутиондата**](getprintexecutiondata.md) извлекает текущий контекст печати.<br/>                                                                                             |
| [**жетспулфилехандле**](getspoolfilehandle.md)<br/>       | Функция [**жетспулфилехандле**](/windows/desktop/printdocs/getspoolfilehandle) Извлекает маркер для файла очереди, связанного с текущим заданием, отправленным приложением. <br/>                        |



 

 

