---
title: Вопросы программирования (планировщик задач)
description: При разработке приложений, использующих планировщик задач 1,0, учитывайте следующие вопросы программирования. Приложение должно убедиться, что служба планировщик задач запущена, прежде чем пытаться выполнить вызовы с помощью API планировщик задач. При извлечении строк убедитесь, что вы вызываете CoTaskMemFree, чтобы освободить каждую строку после того, как она больше не нужна. При извлечении массивов строк убедитесь, что сначала выпустите каждую строку в массиве, а затем Освободите сам массив. При создании или изменении рабочего элемента, включая триггеры, связанные с рабочим элементом, необходимо вызвать IPersistFile Save, чтобы сохранить рабочий элемент на диске. После использования любого интерфейса, предоставляемого планировщик задач API, убедитесь, что для освобождения интерфейса вызовите метод IUnknown Release. Интерфейс IUnknown поддерживается каждым объектом планировщик задач.
ms.assetid: b9e1806c-acfa-4d44-a371-91bad788648c
keywords:
- Запуск планировщик задач
- рекомендации по программированию планировщик задач
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 599652f4a25f3d99020eda0846c41904ee76e5cf
ms.sourcegitcommit: 8fa6614b715bddf14648cce36d2df22e5232801a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/10/2020
ms.locfileid: "105672439"
---
# <a name="programming-considerations-task-scheduler"></a>Вопросы программирования (планировщик задач)

При разработке приложений, использующих планировщик задач 1,0, учитывайте следующие вопросы программирования.

-   Приложение должно убедиться, что служба планировщик задач запущена, прежде чем пытаться выполнить вызовы с помощью API планировщик задач.
-   При извлечении строк убедитесь, что вы вызываете [**CoTaskMemFree**](/windows/win32/api/combaseapi/nf-combaseapi-cotaskmemfree) , чтобы освободить каждую строку после того, как она больше не нужна. При извлечении массивов строк убедитесь, что сначала выпустите каждую строку в массиве, а затем Освободите сам массив.
-   При создании или изменении рабочего элемента, включая триггеры, связанные с рабочим элементом, обязательно вызовите [**IPersistFile:: Save**](/windows/win32/api/objidl/nf-objidl-ipersistfile-save) , чтобы сохранить рабочий элемент на диске.
-   После использования любого интерфейса, предоставляемого планировщик задач API, убедитесь, что вызывается метод [**IUnknown:: Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) , чтобы освободить интерфейс. [**Интерфейс IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) поддерживается каждым объектом планировщик задач.

Раздел using документации по планировщик задач содержит многочисленные примеры, которые следуют этим рекомендациям. В таблице ниже приводятся ссылки на некоторые из этих примеров.

| Пример         | См.                                                                                        |
|---------------------------|--------------------------------------------------------------------------------------------|
| Освобождение строк         | [Получение примеров свойств рабочего элемента](retrieving-work-item-property-examples.md)       |
| Сохранение рабочих элементов на диск | [Примеры настройки свойств рабочих элементов](setting-work-item-property-examples.md)             |
| Освобождение интерфейсов      | [Создание задачи с помощью примера Невворкитем](creating-a-task-using-newworkitem-example.md) |



 

 

 
