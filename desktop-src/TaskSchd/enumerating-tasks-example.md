---
title: Пример перечисления задач
description: Чтобы перечислить задачи, необходимо вызвать перечисление Итасксчедулер, чтобы создать объект перечисления. Затем используйте интерфейс Иенумворкитемс объекта перечисления, чтобы перечислить задачи в папке "запланированные задания".
ms.assetid: 65a8a8af-f4d8-4948-8dd4-b592f1381bfe
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cd929ebd7d8e9f1a3c372ce212d63dcb29df82b7
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "105672353"
---
# <a name="enumerating-tasks-example"></a>Пример перечисления задач

Чтобы перечислить задачи, необходимо вызвать [**итасксчедулер:: Enum**](/windows/desktop/api/Mstask/nf-mstask-itaskscheduler-enum) , чтобы создать [*объект перечисления*](e.md). Затем используйте интерфейс [**иенумворкитемс**](/windows/desktop/api/Mstask/nn-mstask-ienumworkitems) объекта перечисления, чтобы перечислить задачи в папке "запланированные задания".

Следующая процедура описывает, как перечислить задачи в папке «Назначенные задания».

**Перечисление задач в папке «Назначенные задания»**

1.  Вызовите функцию [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) , чтобы инициализировать библиотеку COM и [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) для получения объекта планировщик задач. (В этом примере предполагается, что служба планировщик задач запущена).
2.  Вызовите [**итасксчедулер:: Enum**](/windows/desktop/api/Mstask/nf-mstask-itaskscheduler-enum) , чтобы получить объект перечисления.
3.  Чтобы получить задачи, вызовите метод [**иенумворкитемс:: Next**](/windows/desktop/api/Mstask/nf-mstask-ienumworkitems-next) . (В этом примере предпринимается попытка получить пять задач при каждом вызове.)
4.  Обработка возвращенных задач. (Этот пример просто выводит на экран имя каждой задачи.
5.  Ресурсы выпуска. Вызовите [**CoTaskMemFree**](/windows/win32/api/combaseapi/nf-combaseapi-cotaskmemfree) , чтобы освободить память, используемую для имен.



| Пример кода                                                         | См.                                                                             |
|-------------------------------------------------------------------------------|---------------------------------------------------------------------------------|
| Перечисление всех задач в папке "запланированные задания" на локальном компьютере | [Пример кода C/C++. Перечисление задач](c-c-code-example-enumerating-tasks.md) |



 

## <a name="related-topics"></a>См. также

<dl> <dt>

[Примеры планировщик задач 1,0](task-scheduler-1-0-examples.md)
</dt> </dl>

 

 