---
title: Таскфолдер. Регистертаск, метод
description: Для создания скрипта регистрирует (создает) новую задачу в папке с помощью XML для определения задачи.
ms.assetid: 9bf5c59b-5aa1-42b3-a307-f583cdf59a39
keywords:
- планировщик задач метода Регистертаск
- Планировщик задач метода Регистертаск, объект Таскфолдер
- Планировщик задач объекта Таскфолдер, метод Регистертаск
topic_type:
- apiref
api_name:
- TaskFolder.RegisterTask
api_location:
- taskschd.dll
api_type:
- COM
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: bdc0ed00ec736a90f716d895199812899d972930
ms.sourcegitcommit: a1494c819bc5200050696e66057f1020f5b142cb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2020
ms.locfileid: "103989112"
---
# <a name="taskfolderregistertask-method"></a>Таскфолдер. Регистертаск, метод

Для создания скрипта регистрирует (создает) новую задачу в папке с помощью XML для определения задачи.

## <a name="syntax"></a>Синтаксис


```VB
TaskFolder.RegisterTask( _
  ByVal path, _
  ByVal xmlText, _
  ByVal flags, _
  ByVal userId, _
  ByVal password, _
  ByVal logonType, _
  [ ByVal sddl ], _
  ByRef pTask _
)
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*путь* \[ окне\]
</dt> <dd>

Имя данной задачи. Если это значение равно **Nothing**, задача будет зарегистрирована в корневой папке задач, а имя задачи будет иметь значение GUID, созданное службой планировщик задач.

Имя задачи не может начинаться или заканчиваться символом пробела. Символ "." нельзя использовать для указания текущей папки задач и ".." символы нельзя использовать для указания родительской папки задач в пути.

</dd> <dt>

*xmltext* \[ окне\]
</dt> <dd>

Описание задачи в формате XML.

В следующих разделах содержатся задачи, определенные с помощью XML.

-   [Пример триггера времени (XML)](time-trigger-example--xml-.md)
-   [Пример триггера события (XML)](/previous-versions//aa446889(v=vs.85))
-   [Пример ежедневного триггера (XML)](daily-trigger-example--xml-.md)
-   [Пример триггера регистрации (XML)](registration-trigger-example--xml-.md)
-   [Пример еженедельного триггера (XML)](weekly-trigger-example--xml-.md)
-   [Пример триггера LOGON (XML)](logon-trigger-example--xml-.md)
-   [Пример триггера Boot (XML)](boot-trigger-example--xml-.md)

</dd> <dt>

*Флаги* \[ окне\]
</dt> <dd>

Константа [**\_ создания задачи**](/windows/desktop/api/taskschd/ne-taskschd-task_creation) .



| Значение                                                                                                                                                                                                                                                                                 | Значение                                                                                                                                                                                                                                                                                                                                                   |
|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="TASK_VALIDATE_ONLY"></span><span id="task_validate_only"></span><dl> <dt>**Задача \_ ПРОВЕРЯТЬ \_ только**</dt> <dt>0x1</dt> </dl>                                                | Планировщик задач проверяет синтаксис XML, который описывает задачу, но не регистрирует задачу. Эту константу нельзя сочетать с **\_ созданием \_ или \_ обновлением** значений задач " **\_ создать**", " **\_ обновление задачи**" или "задача".<br/>                                                                                                                  |
| <span id="TASK_CREATE"></span><span id="task_create"></span><dl> <dt>**Задача \_ СОЗДАТЬ**</dt> <dt>0x2</dt> </dl>                                                                      | Планировщик задач регистрирует задачу в качестве новой задачи.<br/>                                                                                                                                                                                                                                                                                           |
| <span id="TASK_UPDATE"></span><span id="task_update"></span><dl> <dt>**Задача \_ Обновление**</dt> <dt>0x4</dt> </dl>                                                                      | Планировщик задач регистрирует задачу в качестве обновленной версии существующей задачи. При обновлении задачи с триггером регистрации задача будет выполнена после обновления.<br/>                                                                                                                                                            |
| <span id="TASK_CREATE_OR_UPDATE"></span><span id="task_create_or_update"></span><dl> <dt>**Задача \_ Создание \_ или \_ Обновление**</dt> <dt>0x6</dt> </dl>                                      | Планировщик задач либо регистрирует задачу в качестве новой задачи, либо в виде обновленной версии, если задача уже существует. Эквивалентно \_ \| обновлению задачи Create Task \_ .<br/>                                                                                                                                                                                    |
| <span id="TASK_DISABLE"></span><span id="task_disable"></span><dl> <dt>**Задача \_ Отключение**</dt> <dt>0x8</dt> </dl>                                                                   | Планировщик задач отключает существующую задачу.<br/>                                                                                                                                                                                                                                                                                                 |
| <span id="TASK_DONT_ADD_PRINCIPAL_ACE"></span><span id="task_dont_add_principal_ace"></span><dl> <dt>**Задача \_ НЕ \_ Добавить \_ субъект \_ ACE**</dt> <dt></dt> </dl>                  | Планировщик задач не допускает добавления записи управления доступом (ACE) для участника контекста. При вызове функции **таскфолдер. регистертаск** с этим флагом для обновления задачи служба Планировщик задач не добавляет ACE для нового участника контекста и не удаляет ACE из старого участника контекста.<br/> |
| <span id="TASK_IGNORE_REGISTRATION_TRIGGERS"></span><span id="task_ignore_registration_triggers"></span><dl> <dt>**Задача \_ ИГНОРИРОВАТЬ \_ \_ триггеры регистрации**</dt> <dt>0x20</dt> </dl> | Планировщик задач создает задачу, но игнорирует триггеры регистрации в задаче. При игнорировании триггеров регистрации задача не будет выполняться при регистрации, если триггер, основанный на времени, не приводит к его выполнению при регистрации.<br/>                                                                                               |



 

</dd> <dt>

*UserID* \[ окне\]
</dt> <dd>

Учетные данные пользователя, которые используются для регистрации задачи.

> [!Note]  
> Если задача определена как задача планировщик задач 1,0, не используйте в этом параметре userId имя группы (а не определенное имя пользователя). Задача определяется как задача планировщик задач 1,0, если атрибут Version элемента Task в XML-файле задачи имеет значение 1,1.

 

</dd> <dt>

*пароль* \[ окне\]
</dt> <dd>

Пароль для userId, который используется для регистрации задачи. При \_ \_ \_ использовании типа входа учетной записи службы входа в систему пароль должен быть пустым значением **типа Variant** , таким как **VT \_ null** или **VT \_ Empty**.

</dd> <dt>

*logonType* \[ окне\]
</dt> <dd>

Определяет, какой метод входа используется для выполнения зарегистрированной задачи.



| Значение                                                                                                                                                                                                                                                                                                     | Значение                                                                                                                                                                                                                                                                                               |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="TASK_LOGON_NONE"></span><span id="task_logon_none"></span><dl> <dt>**Задача \_ \_Нет подключения**</dt> <dt>0</dt> </dl>                                                                               | Метод logon не указан. Используется для учетных данных, не относящихся к NT. <br/>                                                                                                                                                                                                                           |
| <span id="TASK_LOGON_PASSWORD"></span><span id="task_logon_password"></span><dl> <dt>**Задача \_ \_Пароль для входа**</dt> <dt>1</dt> </dl>                                                                   | Используйте пароль для входа пользователя. Пароль должен указываться во время регистрации.<br/>                                                                                                                                                                                                |
| <span id="TASK_LOGON_S4U"></span><span id="task_logon_s4u"></span><dl> <dt>**Задача \_ Вход в систему \_ S4U**</dt> <dt>2</dt> </dl>                                                                                  | Использовать существующий интерактивный токен для выполнения задачи. Пользователь должен войти в систему, используя службу для входа пользователя (S4U). При использовании имени входа S4U система не хранит пароль и не имеет доступа к сети или к зашифрованным файлам.<br/>                                             |
| <span id="TASK_LOGON_INTERACTIVE_TOKEN"></span><span id="task_logon_interactive_token"></span><dl> <dt>**Задача \_ \_Интерактивный \_ маркер входа**</dt> <dt>3</dt> </dl>                                       | Пользователь уже должен войти в систему. Задача будет запущена только в существующем интерактивном сеансе.<br/>                                                                                                                                                                                              |
| <span id="TASK_LOGON_GROUP"></span><span id="task_logon_group"></span><dl> <dt>**Задача \_ \_Группа входа**</dt> <dt>4</dt> </dl>                                                                            | Активация группы. Поле **groupId** указывает группу.<br/>                                                                                                                                                                                                                               |
| <span id="TASK_LOGON_SERVICE_ACCOUNT"></span><span id="task_logon_service_account"></span><dl> <dt>**Задача \_ \_ \_ Учетная запись службы входа**</dt> <dt>5</dt> </dl>                                             | Указывает, что в качестве контекста безопасности для выполнения задачи используется локальная система, локальная служба или учетная запись сетевой службы.<br/>                                                                                                                                                              |
| <span id="TASK_LOGON_INTERACTIVE_TOKEN_OR_PASSWORD"></span><span id="task_logon_interactive_token_or_password"></span><dl> <dt>**Задача \_ \_Интерактивный \_ маркер входа \_ или \_ пароль**</dt> <dt>6</dt> </dl> | Сначала используйте интерактивный токен. Если пользователь не вошел в систему (интерактивный маркер недоступен), то используется пароль. При регистрации задачи необходимо указать пароль. Этот флаг не рекомендуется для новых задач, так как он менее надежен, чем \_ пароль для входа в систему \_ .<br/> |



 

</dd> <dt>

*SDDL* \[ в необязательное\]
</dt> <dd>

Дескриптор безопасности, связанный с зарегистрированной задачей. Вы можете указать список управления доступом (ACL) в дескрипторе безопасности задачи, чтобы разрешить или запретить определенным пользователям и группам доступ к задаче.

> [!Note]  
> Если локальной системной учетной записи запрещен доступ к задаче, то служба планировщик задач может получить непредвиденные результаты.

 

</dd> <dt>

*птаск* \[ заполняет\]
</dt> <dd>

Объект [**регистередтаск**](registeredtask.md) , представляющий новую задачу.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Этот метод не возвращает значение.

## <a name="remarks"></a>Комментарии

Для задачи, которая содержит действие «окно сообщения», появится окно сообщения, если задача активирована, а задача имеет интерактивный тип входа в систему. Чтобы установить для параметра Тип входа в интерактивный режим, укажите значение 3 (**\_ \_ Интерактивный \_ маркер входа в систему**) или 4 (**\_ \_ Группа входа** в систему) в свойстве [**LogonType**](principal-logontype.md) участника задачи или в параметре *LogonType* **таскфолдер. регистертаск** или [**таскфолдер. регистертаскдефинитион**](taskfolder-registertaskdefinition.md).

Только член группы "Администраторы" может создать задачу с триггером загрузки.

Вы можете успешно зарегистрировать задачу с группой, указанной в параметре *UserID* , и 3 (**\_ \_ Интерактивный \_ токен входа задачи**), указанный в параметре *logonType* **таскфолдер. регистертаск** или [**таскфолдер. регистертаскдефинитион**](taskfolder-registertaskdefinition.md), но задача не будет запущена.

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Только для \[ классических приложений Windows Vista\]<br/>                                          |
| Минимальная версия сервера<br/> | \[Только для настольных приложений Windows Server 2008\]<br/>                                    |
| Библиотека типов<br/>             | <dl> <dt>Тасксчд. tlb</dt> </dl> |
| DLL<br/>                      | <dl> <dt>Taskschd.dll</dt> </dl> |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[Планировщик заданий](task-scheduler-start-page.md)
</dt> <dt>

[**регистередтаск**](registeredtask.md)
</dt> <dt>

[**таскфолдер**](taskfolder.md)
</dt> </dl>

 

