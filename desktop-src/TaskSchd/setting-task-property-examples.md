---
title: Примеры свойств задач
description: Чтобы задать свойства задачи, вызовите Итасксчедулер Activate, чтобы получить интерфейс объекта Task, а затем вызовите соответствующий метод ITask, чтобы задать интересующее вас свойство задачи.
ms.assetid: df438bff-1ce1-4336-93ee-1e6cab1f1ddd
keywords:
- Задание свойств задачи планировщик задач
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2fcb05031961e38314cbc7cd12c20c1d863f54af
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "105681670"
---
# <a name="setting-task-property-examples"></a>Примеры свойств задач

Чтобы задать свойства задачи, вызовите метод [**итасксчедулер:: Activate**](/windows/desktop/api/Mstask/nf-mstask-itaskscheduler-activate) , чтобы получить интерфейс объекта Task, а затем вызовите соответствующий метод [**ITask**](/windows/desktop/api/Mstask/nn-mstask-itask) , чтобы задать интересующее вас свойство задачи.

В примерах кода, приведенных в нижней части страницы, показано, как задать свойства, уникальные для объектов Task. Сведения о других свойствах [*рабочих элементов*](w.md) , которые также применяются к задачам, см. в разделе [Определение свойств рабочего элемента](setting-work-item-property-examples.md).

> [!Note]  
> В следующем примере кода все интерфейсы освобождаются после того, как они больше не нужны.

 

В следующих примерах измененный объект задачи всегда сохраняется на диск с помощью вызова [**IPersistFile:: Save**](/windows/win32/api/objidl/nf-objidl-ipersistfile-save). (Интерфейс [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile) является СТАНДАРТНЫМ COM-интерфейсом, наследуемым объектом Task.)

В следующей процедуре описывается задание свойства задачи.

**Задание свойства задачи**

1.  Вызовите функцию [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) , чтобы инициализировать библиотеку COM и [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) для получения объекта планировщик задач. (В этих примерах предполагается, что служба планировщик задач запущена).
2.  Вызовите метод [**итасксчедулер:: Activate**](/windows/desktop/api/Mstask/nf-mstask-itaskscheduler-activate) , чтобы получить интерфейс [**ITask**](/windows/desktop/api/Mstask/nn-mstask-itask) объекта Task. (Обратите внимание, что в этом примере возвращается задача "задача тестирования".)
3.  Вызовите соответствующий метод [**ITask**](/windows/desktop/api/Mstask/nn-mstask-itask) , чтобы задать интересующее вас свойство.
4.  Вызовите метод [**IPersistFile:: Save**](/windows/win32/api/objidl/nf-objidl-ipersistfile-save) , чтобы сохранить измененный объект задачи на диск.



| Пример кода                                                                                                                                | См.                                                                                             |
|------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------|
| Задание имени приложения, связанного с известной задачей                                                                                     | [Пример кода C/C++: Задание имени приложения](c-c-code-example-setting-application-name.md)   |
| Установка максимального времени выполнения известной задачи                                                                                                         | [Пример кода C/C++: Настройка Максрунтиме](c-c-code-example-setting-maxruntime.md)               |
| Очистка всех параметров командной строки, связанных с известной задачей                                                                                    | [Пример кода C/C++: Задание параметров задачи](c-c-code-example-setting-task-parameters.md)     |
| В этом примере задается приоритет задачи теста, а затем задача сохраняется. В этом примере предполагается, что тестовая задача уже существует на локальном компьютере. | [Пример кода C/C++: Настройка приоритета задачи](c-c-code-example-setting-task-priority.md)         |
| Задание [*рабочего каталога*](w.md) для известной задачи                                                                  | [Пример кода C/C++: Настройка рабочего каталога](c-c-code-example-setting-working-directory.md) |



 

## <a name="related-topics"></a>См. также

<dl> <dt>

[Примеры планировщик задач 1,0](task-scheduler-1-0-examples.md)
</dt> </dl>

 

 