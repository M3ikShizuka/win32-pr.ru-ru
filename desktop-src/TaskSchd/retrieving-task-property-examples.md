---
title: Получение примеров свойств задачи
description: Чтобы получить свойства задачи, вызовите Итасксчедулер Activate, чтобы получить интерфейс объекта Task, а затем вызовите соответствующий метод ITask, чтобы получить интересующее вас свойство задачи.
ms.assetid: 9ec9d836-c735-4a32-96b1-3dbd0a31b22a
keywords:
- получение свойств задачи планировщик задач
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7e2b42bc8044171834b6d99e97c41e3f5c7048ff
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104338692"
---
# <a name="retrieving-task-property-examples"></a>Получение примеров свойств задачи

Чтобы получить свойства задачи, вызовите метод [**итасксчедулер:: Activate**](/windows/desktop/api/Mstask/nf-mstask-itaskscheduler-activate) , чтобы получить интерфейс объекта Task, а затем вызовите соответствующий метод [**ITask**](/windows/desktop/api/Mstask/nn-mstask-itask) , чтобы получить интересующее вас свойство задачи. В примерах кода, приведенных в нижней части страницы, показано, как получить различные свойства задачи.

В примерах кода, приведенных в нижней части страницы, показано, как получить свойства, уникальные для объектов Task. Сведения о других свойствах [*рабочих элементов*](w.md) , которые также применяются к задачам, см. в разделе [Получение примеров рабочих элементов](retrieving-work-item-property-examples.md).

> [!Note]  
> В следующем примере кода все интерфейсы освобождаются после того, как они больше не нужны.

 

Обратите внимание, что при извлечении свойства строки (например, имени приложения, параметров или рабочего каталога) необходимо вызвать [CoTaskMemFree](/windows/win32/api/combaseapi/nf-combaseapi-cotaskmemfree) , чтобы освободить память, выделенную для возвращаемой строки.

В следующей процедуре описывается получение свойства задачи.

**Получение свойства задачи**

1.  Вызовите функцию [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) , чтобы инициализировать библиотеку COM и [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) для получения объекта планировщик задач. (В этих примерах предполагается, что служба планировщик задач запущена).
2.  Вызовите метод [**итасксчедулер:: Activate**](/windows/desktop/api/Mstask/nf-mstask-itaskscheduler-activate) , чтобы получить интерфейс [**ITask**](/windows/desktop/api/Mstask/nn-mstask-itask) объекта Task. (Обратите внимание, что в этом примере возвращается задача "задача тестирования".)
3.  Вызовите соответствующий метод [**ITask**](/windows/desktop/api/Mstask/nn-mstask-itask) , чтобы получить интересующее вас свойство.
4.  При необходимости обработайте свойство. (Эти примеры напечатают свойство на экране.)
5.  Если возвращаемое свойство является строкой, вызовите [CoTaskMemFree](/windows/win32/api/combaseapi/nf-combaseapi-cotaskmemfree) , чтобы освободить память, выделенную для возвращаемой строки.



| Пример кода                                                                                                                           | См.                                                                                                                     |
|-------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------|
| Получение имени приложения, связанного с заданной задачей                                                                             | [Пример кода C/C++: получение имени приложения задачи](c-c-code-example-retrieving-the-task-application-name.md)   |
| Получение максимального времени, в течение которого может выполняться задача и отображение этого числа на экране                                                 | [Пример кода C/C++: получение Максрунтиме задачи](c-c-code-example-retrieving-the-task-maxruntime.md)               |
| Получение строки параметра, которая выполняется при выполнении задачи и отображение этой строки на экране                                  | [Пример кода C/C++. получение параметров задачи](c-c-code-example-retrieving-task-parameters.md)                       |
| Получение [*уровня приоритета*](p.md) задачи                                                                    | [Пример кода C/C++: получение приоритета задачи](c-c-code-example-retrieving-task-priority.md)                           |
| Получение [*рабочего каталога*](w.md) задачи и отображение пути к рабочему каталогу на экране | [Пример кода C/C++: получение рабочего каталога задачи](c-c-code-example-retrieving-the-task-working-directory.md) |



 

## <a name="related-topics"></a>См. также

<dl> <dt>

[Примеры планировщик задач 1,0](task-scheduler-1-0-examples.md)
</dt> </dl>

 

 