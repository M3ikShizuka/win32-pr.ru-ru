---
title: TaskService. Connect, метод
description: Для создания сценариев подключается к удаленному компьютеру и связывает все последующие вызовы в этом интерфейсе с удаленным сеансом.
ms.assetid: 206087df-307c-4ba9-9e83-915f5287f281
keywords:
- Метод Connect планировщик задач
- Метод Connect планировщик задач, объект TaskService
- Планировщик задач объекта TaskService, метод Connect
topic_type:
- apiref
api_name:
- TaskService.Connect
api_location:
- taskschd.dll
api_type:
- COM
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 1db5f13e20da825cbdaf45ae399279687f6ff4aa
ms.sourcegitcommit: a1494c819bc5200050696e66057f1020f5b142cb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2020
ms.locfileid: "103988418"
---
# <a name="taskserviceconnect-method"></a>TaskService. Connect, метод

Для создания сценариев подключается к удаленному компьютеру и связывает все последующие вызовы в этом интерфейсе с удаленным сеансом. Если параметр serverName пуст, то этот метод будет выполняться на локальном компьютере. Если userId не указан, используется текущий токен.

## <a name="syntax"></a>Синтаксис


```VB
TaskService.Connect( _
  [ ByVal serverName ], _
  [ ByVal user ], _
  [ ByVal domain ], _
  [ ByVal password ] _
)
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*имя сервера* \[ в необязательное\]
</dt> <dd>

Имя компьютера, к которому необходимо подключиться. Если параметр serverName пуст, то этот метод будет выполняться на локальном компьютере.

</dd> <dt>

*пользователь* \[ в необязательное\]
</dt> <dd>

Имя пользователя, используемое во время подключения к компьютеру. Если пользователь не указан, используется текущий токен.

</dd> <dt>

*домен* \[ в необязательное\]
</dt> <dd>

Домен пользователя, указанный в параметре *User* .

</dd> <dt>

*пароль* \[ в необязательное\]
</dt> <dd>

Пароль, используемый для подключения к компьютеру. Если имя пользователя и пароль не указаны, используется текущий токен.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Этот метод не возвращает значение.

## <a name="remarks"></a>Комментарии

Метод **TaskService. Connect** следует вызывать до вызова любого из других методов [**TaskService**](taskservice.md) .

Если метод Connect завершается неудачей, можно получить Идентификатор ошибки, чтобы найти значение ошибки. В следующей таблице перечислены идентификаторы ошибок и их описания.



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Идентификатор ошибки</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0x80070005</td>
<td>Отказано в доступе для подключения к службе планировщик задач.</td>
</tr>
<tr class="even">
<td>0x80041315</td>
<td>Служба планировщик задач не запущена.</td>
</tr>
<tr class="odd">
<td>0x8007000e</td>
<td>Приложению не хватает памяти для выполнения операции, или <em>пользователь</em>, <em>пароль</em>или <em>домен</em> имеют по крайней мере одно значение NULL и одно из значений, отличных от NULL.</td>
</tr>
<tr class="even">
<td>53</td>
<td>Эта ошибка возвращается в следующих ситуациях.
<ul>
<li>Имя компьютера, указанное в параметре <em>ServerName</em> , не существует.</li>
<li>При попытке подключиться к компьютеру под управлением Windows Server 2003 или Windows XP на удаленном компьютере не включено исключение брандмауэра для общего доступа к файлам и принтерам, или служба удаленного реестра не запущена.</li>
<li>При попытке подключиться к компьютеру под управлением Windows Vista на удаленном компьютере не включено исключение брандмауэра Управление удаленными задачами и отключено исключение брандмауэра для общего доступа к файлам и принтерам, либо служба удаленного реестра не запущена.</li>
</ul></td>
</tr>
<tr class="odd">
<td>50</td>
<td>Параметры <em>пользователя</em>, <em>пароля</em>или <em>домена</em> не могут быть указаны при подключении к удаленному компьютеру Windows XP или Windows Server 2003 с компьютера под управлением Windows Vista.</td>
</tr>
</tbody>
</table>



 

При подключении к удаленному компьютеру с ОС Windows Vista из Windows Vista необходимо разрешить удаленное исключение для удаленного управления назначенными задачами на удаленном компьютере. Чтобы разрешить это исключение, нажмите кнопку Пуск, панель управления, безопасность, разрешить программу через брандмауэр Windows, а затем установите флажок Удаленное управление назначенными задачами. Затем нажмите кнопку ОК в диалоговом окне Параметры брандмауэра Windows.

При подключении к удаленному компьютеру Windows XP или Windows Server 2003 с компьютера под управлением Windows Vista необходимо разрешить исключение брандмауэра для общего доступа к файлам и принтерам на удаленном компьютере. Чтобы разрешить это исключение, нажмите кнопку Пуск, панель управления, дважды щелкните Брандмауэр Windows, перейдите на вкладку исключения и выберите исключение брандмауэра для общего доступа к файлам и принтерам. Затем нажмите кнопку ОК в диалоговом окне Брандмауэр Windows. Служба удаленного реестра также должна быть запущена на удаленном компьютере.

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Только для \[ классических приложений Windows Vista\]<br/>                                          |
| Минимальная версия сервера<br/> | \[Только для настольных приложений Windows Server 2008\]<br/>                                    |
| Библиотека типов<br/>             | <dl> <dt>Тасксчд. tlb</dt> </dl> |
| DLL<br/>                      | <dl> <dt>Taskschd.dll</dt> </dl> |



 

 





