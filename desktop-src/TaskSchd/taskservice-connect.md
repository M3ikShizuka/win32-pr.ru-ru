---
title: TaskService. метод Подключение
description: Для создания сценариев подключается к удаленному компьютеру и связывает все последующие вызовы в этом интерфейсе с удаленным сеансом.
ms.assetid: 206087df-307c-4ba9-9e83-915f5287f281
keywords:
- метод Подключение планировщик задач
- метод Подключение планировщик задач, объект TaskService
- планировщик задач объекта TaskService, метод Подключение
topic_type:
- apiref
api_name:
- TaskService.Connect
api_location:
- taskschd.dll
api_type:
- COM
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 1e8d9491fb66d8e79b18efed363d4eb4f21bc6c5
ms.sourcegitcommit: 9b5faa61c38b2d0c432b7f2dbee8c127b0e28a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2021
ms.locfileid: "122472350"
---
# <a name="taskserviceconnect-method"></a>TaskService. метод Подключение

Для создания сценариев подключается к удаленному компьютеру и связывает все последующие вызовы в этом интерфейсе с удаленным сеансом. Если параметр serverName пуст, то этот метод будет выполняться на локальном компьютере. Если userId не указан, используется текущий токен.

## <a name="syntax"></a>Синтаксис


```VB
TaskService.Connect( _
  [ ByVal serverName ], _
  [ ByVal user ], _
  [ ByVal domain ], _
  [ ByVal password ] _
)
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*имя сервера* \[ в необязательное\]
</dt> <dd>

Имя компьютера, к которому необходимо подключиться. Если параметр serverName пуст, то этот метод будет выполняться на локальном компьютере.

</dd> <dt>

*пользователь* \[ в необязательное\]
</dt> <dd>

Имя пользователя, используемое во время подключения к компьютеру. Если пользователь не указан, используется текущий токен.

</dd> <dt>

*домен* \[ в необязательное\]
</dt> <dd>

Домен пользователя, указанный в параметре *User* .

</dd> <dt>

*пароль* \[ в необязательное\]
</dt> <dd>

Пароль, используемый для подключения к компьютеру. Если имя пользователя и пароль не указаны, используется текущий токен.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Этот метод не возвращает значение.

## <a name="remarks"></a>Комментарии

перед вызовом любого из других методов [**TaskService**](taskservice.md) следует вызвать метод **TaskService. Подключение** .

если метод Подключение завершается сбоем, можно получить идентификатор ошибки, чтобы найти значение ошибки. В следующей таблице перечислены идентификаторы ошибок и их описания.




| Идентификатор ошибки | Описание | 
|------------------|-------------|
| 0x80070005 | Отказано в доступе для подключения к службе планировщик задач. | 
| 0x80041315 | Служба планировщик задач не запущена. | 
| 0x8007000e | Приложению не хватает памяти для выполнения операции, или <em>пользователь</em>, <em>пароль</em>или <em>домен</em> имеют по крайней мере одно значение NULL и одно из значений, отличных от NULL. | 
| 53 | Эта ошибка возвращается в следующих ситуациях.<ul><li>Имя компьютера, указанное в параметре <em>ServerName</em> , не существует.</li><li>если вы пытаетесь подключиться к компьютеру Windows Server 2003 или Windows XP, а на удаленном компьютере не включено исключение брандмауэра для общего доступа к файлам и принтерам или служба удаленного реестра не запущена.</li><li>если вы пытаетесь подключиться к компьютеру Windows Vista, а на удаленном компьютере не включено исключение брандмауэра для управления удаленными запланированными задачами и включено исключение брандмауэра для общего доступа к файлам и принтерам, либо служба удаленного реестра не запущена.</li></ul> | 
| 50 | параметры <em>пользователя</em>, <em>пароля</em>или <em>домена</em> не могут быть указаны при подключении к удаленному компьютеру Windows XP или Windows Server 2003 с компьютера Windows Vista. | 




 

если вы подключаетесь к удаленному компьютеру Windows Vista из Windows Vista, необходимо разрешить удаленное управление назначенными задачами исключение брандмауэра на удаленном компьютере. чтобы разрешить это исключение, нажмите кнопку пуск, панель управления, безопасность, разрешите программу через брандмауэр Windows и установите флажок удаленное управление назначенными задачами. затем нажмите кнопку ок в диалоговом окне Windows Параметры брандмауэра.

при подключении к удаленному компьютеру Windows XP или Windows Server 2003 с компьютера Windows Vista необходимо разрешить исключение брандмауэра для общего доступа к файлам и принтерам на удаленном компьютере. чтобы разрешить это исключение, нажмите кнопку пуск, панель управления, дважды щелкните Windows брандмауэр, перейдите на вкладку исключения и выберите исключение брандмауэра для общего доступа к файлам и принтерам. затем нажмите кнопку ок в диалоговом окне Windows брандмауэре. Служба удаленного реестра также должна быть запущена на удаленном компьютере.

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows \[Только классические приложения Vista\]<br/>                                          |
| Минимальная версия сервера<br/> | Windows Только для \[ настольных приложений сервера 2008\]<br/>                                    |
| Библиотека типов<br/>             | <dl> <dt>Тасксчд. tlb</dt> </dl> |
| DLL<br/>                      | <dl> <dt>Taskschd.dll</dt> </dl> |



 

 





