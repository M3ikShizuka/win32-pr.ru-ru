---
title: Получение примеров свойств рабочего элемента
description: Чтобы получить свойства рабочего элемента, вызовите Итасксчедулер Activate, чтобы получить интерфейс объекта рабочего элемента, а затем вызовите соответствующий метод, чтобы получить интересующее вас свойство задачи.
ms.assetid: d9723dea-1a82-4993-b4d0-bc7d944e775f
keywords:
- получение свойств рабочего элемента планировщик задач
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3519f3f995e4a5c49a58f0c8be590b34a82381bfd534b61bac6ff8aba05de33c
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119059982"
---
# <a name="retrieving-work-item-property-examples"></a>Получение примеров свойств рабочего элемента

Чтобы получить свойства рабочего элемента, вызовите [**итасксчедулер:: Activate**](/windows/desktop/api/Mstask/nf-mstask-itaskscheduler-activate) , чтобы получить интерфейс объекта рабочего элемента, а затем вызовите соответствующий метод, чтобы получить интересующее вас свойство задачи. В настоящее время единственными допустимыми рабочими элементами являются задачи.

В примерах кода, приведенных в нижней части этой страницы, показано, как получить свойства, которые применяются ко всем рабочим элементам. Другие свойства, которые являются уникальными для задач, см. в разделе [Задание примеров свойств задачи](setting-task-property-examples.md).

> [!Note]  
> В следующем примере кода все интерфейсы освобождаются после того, как они больше не нужны.

 

Обратите внимание, что при извлечении свойства строки (например, комментария к рабочему элементу) необходимо вызвать [**CoTaskMemFree**](/windows/win32/api/combaseapi/nf-combaseapi-cotaskmemfree) , чтобы освободить память, выделенную для возвращаемой строки.

В следующей процедуре описывается получение свойства задачи.

**Получение свойства задачи**

1.  Вызовите функцию [**CoInitialize**](/windows/win32/api/objbase/nf-objbase-coinitialize) , чтобы инициализировать библиотеку COM и [**CoCreateInstance**](/windows/win32/api/combaseapi/nf-combaseapi-cocreateinstance) для получения объекта планировщик задач. (В этих примерах предполагается, что служба планировщик задач запущена).
2.  Вызовите метод [**итасксчедулер:: Activate**](/windows/desktop/api/Mstask/nf-mstask-itaskscheduler-activate) , чтобы получить интерфейс [**ITask**](/windows/desktop/api/Mstask/nn-mstask-itask) объекта Task. (Обратите внимание, что в настоящее время задачи являются единственным допустимым типом рабочего элемента.)
3.  Вызовите соответствующий метод, чтобы получить интересующее вас свойство.
4.  При необходимости обработайте свойство. (В этих примерах просто распечатывается свойство на экране.)
5.  Если возвращаемое свойство является строкой, вызовите [**CoTaskMemFree**](/windows/win32/api/combaseapi/nf-combaseapi-cotaskmemfree) , чтобы освободить память, выделенную для возвращаемой строки.



| Пример кода                                                                        | См.                                                                                                                       |
|----------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------|
| Получение сведений об учетной записи известной задачи                                           | [Пример кода C/C++: получение сведений об учетной записи задачи](c-c-code-example-retrieving-task-account-information.md)       |
| Получение строки комментария известной задачи                                                | [Пример кода C/C++: получение комментария к задаче](c-c-code-example-retrieving-a-task-comment.md)                           |
| Получение имени создателя задачи и отображение ее на экране               | [Пример кода C/C++: получение создателя задачи](c-c-code-example-retrieving-the-task-creator.md)                       |
| Получение последнего кода выхода, возвращенного известной задачей                                       | [Пример кода C/C++: получение кода завершения задачи](c-c-code-example-retrieving-task-exit-code.md)                           |
| Получение времени ожидания простоя задачи и отображение ее на экране                    | [Пример кода C/C++: получение времени ожидания задачи](c-c-code-example-retrieving-task-idle-wait-time.md)                 |
| Получение времени последнего выполнения задачи и его отображение на экране                    | [Пример кода C/C++: получение времени Мострецентрун задачи](c-c-code-example-retrieving-the-task-mostrecentrun-time.md) |
| Извлечение при следующем запланированном запуске задачи и отображении этого времени на экране | [Пример кода C/C++: получение времени Некструн задачи](c-c-code-example-retrieving-the-task-nextrun-time.md)             |
| Получение времени выполнения задачи и отображение их на экране                       | [Пример кода C/C++: получение времени выполнения задачи](c-c-code-example-retrieving-task-run-times.md)                           |
| Получение текущего состояния задачи и отображение ее на экране                    | [Пример кода C/C++: получение состояния задачи](c-c-code-example-retrieving-task-status.md)                                 |



 

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Примеры планировщик задач 1,0](task-scheduler-1-0-examples.md)
</dt> </dl>

 

 