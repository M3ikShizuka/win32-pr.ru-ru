---
title: Автоматическое обслуживание (планировщик задач)
description: действие обслуживания относится к приложению или процессу, которое помогает поддерживать работоспособность и производительность Windows пк.
ms.assetid: 1D38341B-15AA-422F-AED1-647FCDE69E2E
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 43fe72159ac5fd14c2dcc80126e572fa1475ed52ffd5710b74621cf00ad40a39
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119139307"
---
# <a name="automatic-maintenance"></a>Автоматическое обслуживание

действие обслуживания относится к приложению или процессу, которое помогает поддерживать работоспособность и производительность Windows пк. обслуживание включает в себя обновление Windows операционной системы (ос) и приложений, проверка безопасности и выполнение проверок на наличие вредоносных программ. Windows автоматическое управление (WAM) — это набор улучшений API планировщик задач, которые можно использовать для связывания приложений с расписанием обслуживания Windows. В частности, WAM позволяет добавлять действия, требующие регулярного планирования, но не имеющие точных требований к времени. Вместо этого WAM полагается на операционную систему, чтобы выбрать подходящее время для активации задачи в течение дня. Система выбирает эти моменты в зависимости от минимального воздействия на пользователя, производительности ПК и эффективности энергопотребления.

## <a name="how-scheduled-maintenance-works"></a>Как работает плановое обслуживание

Задачи обслуживания планировщик задач — это уступающей задачи, выполняемые при простое компьютера и питании от сети. Одна из основных целей задач обслуживания заключается в том, чтобы снизить влияние на ПК, планируя обслуживание только в том случае, если ПК подключен к питанию от сети и простою (т. е. Если вы не используете или не выполнили шаг с компьютером). Идея обслуживания сегодня заключается в том, чтобы компьютер работал с минимальными нарушениями работы пользователя. Поэтому для использования этих периодов простоев в этом разделе мы улучшили час обслуживания в старом стиле (мы поговорим подробнее об этом в разделе « **&mdash; ежедневное пробуждение автоматического обслуживания** » ниже). Хотя часы обслуживания по-прежнему можно использовать, выполнение оппортунистической обслуживания лучше для обеспечения работоспособности системы.

Ваша задача может быть недоступна, если компьютер не тратит много времени на время простоя и при питании от сети. Убедитесь, что ваш сценарий по-прежнему предоставит пользователю значение, даже если оно отложено. Если пользователь активно использует компьютер, система откладывает обслуживание до последующего времени. Система также приостанавливает выполнение любой задачи обслуживания, если пользователь возвращается к использованию компьютера.

Система перезапускает приостановленную задачу обслуживания во время следующего периода простоя; Однако система не приостанавливает ни одну задачу, помеченную как критическая. Вместо этого система позволяет выполнить критическую задачу, независимо от действий пользователя.

Из-за особенностей планирования некоторые запланированные задачи могут не завершиться: возможно, имеется слишком много запланированных событий, которые помещаются в течение периода обслуживания в 1 час, или, возможно, компьютер просто не был включен. В таких случаях можно определить задачу с крайним сроком. Крайний срок определяется как повторяющийся период времени, в течение которого система должна успешно выполнять задачу по крайней мере один раз.

Если задача пропустила крайний срок, планировщик обслуживания по-прежнему будет пытаться выполнить эту задачу в течение периода обслуживания. Кроме того, планировщик не будет ограничиваться обычным временем в 1 час. Вместо этого планировщик увеличивает длительность периода обслуживания, чтобы завершить отложенную задачу.

После того, как система завершит задачу (даже с кодом ошибки ошибки), попытка считается успешной. После успешной попытки планировщик сбрасывается до регулярного расписания обслуживания и попытается выполнить задачу в течение следующего периода.

## <a name="automatic-maintenancemdashdaily-wakeup"></a>&mdash;Ежедневное пробуждение автоматического обслуживания

в Windows 7 задача обслуживания выполняется исключительно в течение *часа обслуживания*, по умолчанию — до 3 AM и настраивается с помощью групповая политика. Компьютер будет выходить из режима ожидания, выполнять задачи обслуживания и вернуться в спящий режим. Этот ежедневный сеанс был ограничен максимальным продолжительностью в 1 час на попытку. Это позволит системе выполнять обслуживание ежедневно, начиная с 3 AM по умолчанию. Обратите внимание, что пользователь может повторно запланировать время активации обслуживания, настроив эти параметры.

С появлением ноутбуков и значительных затрат на время работы от аккумулятора компьютеры больше не настроены на разрешение пробуждения S3 в большинстве случаев и обычно дозе в режим гибернации как можно скорее, чтобы сэкономить батарею. В ответ на эти изменения планировщик задач (> Win7) запускает задачи обслуживания, когда они загружаются, а компьютер находится в состоянии простоя и находится на питании от сети.

Этот параметр можно настроить на панели управления.

Откройте **Панель управления**  >  **система и** Управление безопасностью  >  **и обслуживание**  >  **Автоматическое обслуживание**.

В зависимости от того, как настроены ваши компьютеры и задачи, ежедневное поведение пробуждения может не произойти в сегодняшний день, как ожидалось в результате этой новой конфигурации. Сначала можно определить, поддерживает ли компьютер режим S3 или протокол CS (с подключением).
Это можно сделать, открыв командную строку Power Shell с повышенными привилегиями и выполнив следующую команду.

```console
powercfg /a
```

Час обслуживания, если компьютер настроен правильно, все равно работает, но если нет,
  - Проверьте параметры BIOS для параметров пробуждения. 
  - Проверьте, включен ли параметр Разрешить таймер пробуждения в окне "Параметры электропитания".
    последовательно выберите пункты **панель управления**  >  **оборудование и звук**  >  **параметры электропитания**  >  **изменить план Параметры**  >  **изменить дополнительные параметры питания** > щелкните **режим сна**  >  **разрешить таймер пробуждения**.
  - Проверьте, настроена ли для запланированной задачи Следующая настройка.
      * Маинтенанцесеттингс: для задачи необходимо настроить период, крайний срок.
      * Включено: задача должна быть включена.
      * Вакеторун: задаче должно быть разрешено пробудить компьютер.
  - Для планирования пробуждения из CS необходимо, чтобы компьютер АОАК.
  - Для планирования пробуждения на компьютерах S3
      * Проверьте, перешла ли компьютер в режим S3 при питании от сети.
      * Система должна **Включить Wake** в групповая политика для обслуживания.
 
Подключенный ждущий режим — это состояние системы, которое может войти в систему, совместимую с АОАК.

Ознакомьтесь с различиями между современными ждущими и S3 в разделе [современные резервные VS и S3](/windows-hardware/design/device-experiences/modern-standby-vs-s3).

## <a name="defining-an-automatic-maintenance-task"></a>Определение задачи автоматического обслуживания

Любую планировщик задачную задачу можно преобразовать в задачу обслуживания. Для этого необходимо убедиться, что приложение можно приостановить. Затем необходимо расширить определение задачи с помощью новых элементов [**маинтенанцесеттингс**](taskschedulerschema-maintenancesettings-maintenancesettingstype-element.md) и [**алловстартондеманд**](taskschedulerschema-allowstartondemand-settingstype-element.md) .

Основная проблема при создании задачи обслуживания заключается в том, что система может приостановить и перезапустить задачу. Скорее всего, система будет приостанавливать задачу обслуживания несколько раз; Поэтому необходимо убедиться, что приложение может сохранить свое собственное состояние, а затем возобновить его в произвольный момент времени. Это гарантирует, что система не будет многократно выполнять одну и ту же часть задачи.

После того как вы убедитесь, что приложение может быть приостановлено и возобновлено надлежащим образом, можно использовать элементы **маинтенанцесеттингс** и **алловстартондеманд** , чтобы определить расписание. **Маинтенанцесеттингс** определяется в соответствии с периодом, крайним сроком и исключительные права.

-   Этот **период** является обязательным и определяет, как часто должна выполняться задача. Обычно это определяется в рамках многодневного цикла, например "один раз в 5 дней". Период должен составлять по крайней мере один день, то есть вы не можете запланировать выполнение задачи несколько раз в день.
-   **Крайний срок** является необязательным и определяет, сколько времени планировщик может завершить задачу, прежде чем уведомлять пользователя или выполнять аварийное обслуживание. Крайний срок должен быть больше периода, что означает, что система должна иметь возможность выполнять задачу по крайней мере один раз перед уведомлением пользователя.
-   Кроме того, задача обслуживания может быть определена как *монопольная*. Монопольная задача выполняется отдельно от других задач обслуживания. Обычно монопольная задача — это одна из задач, использующая большой объем ресурсов, таких как большое количество времени ЦП или монопольный доступ к базе данных. Система завершает все неисключительные задачи обслуживания перед запуском монопольной задачи. Поэтому задачу следует объявлять как исключительную только при необходимости.

В отличие от этого, **алловстартондеманд** просто указывает, что система или пользователь может запустить задачу в любое время. Это позволяет системе запускать задачу во время регулярного обслуживания. В противном случае необходимо задать уникальный триггер для задачи.
