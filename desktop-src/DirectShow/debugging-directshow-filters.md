---
description: Многие из средств отладки, описываемых в этом разделе, реализуются в библиотеке базовых классов DirectShow. Дополнительные сведения см. в разделе базовые классы DirectShow.
ms.assetid: 40b4f2ab-e629-41a0-b979-d74ac5fe83a2
title: Отладка фильтров DirectShow
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1198e17f438d57775ea0f74d5920f63dc4761743
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/06/2021
ms.locfileid: "104538069"
---
# <a name="debugging-directshow-filters"></a>Отладка фильтров DirectShow

Многие из средств отладки, описываемых в этом разделе, реализуются в библиотеке базовых классов DirectShow. Дополнительные сведения см. в разделе [базовые классы DirectShow](directshow-base-classes.md).

## <a name="assertion-checking"></a>Проверка утверждения

Используйте проверку утверждения. Утверждения могут проверять предположения, которые вы вносите в код в отношении предусловий и постусловий. DirectShow предоставляет несколько макросов утверждения. Дополнительные сведения см. в разделе [макросы Assert и точка останова](assert-and-breakpoint-macros.md).

## <a name="object-names"></a>Имена объектов

В отладочных сборках имеется глобальный список объектов, производных от класса [**кбасеобжект**](cbaseobject.md) . По мере создания объектов они добавляются в список. Когда они уничтожаются, они удаляются из списка. Чтобы отобразить список этих объектов, вызовите функцию [**дбгдумпобжектрегистер**](dbgdumpobjectregister.md) .

Метод-конструктор для базового класса [**кбасеобжект**](cbaseobject.md) (и большинства производных от него классов) содержит параметр для имени объекта. Присвойте объектам уникальные имена для их распознавания. При объявлении имени используйте макрос [**Name**](name.md) , чтобы имя было выделено только в отладочных сборках. В розничных сборках имя принимает **значение NULL**.

## <a name="debug-logging"></a>Ведение журнала отладки

Функция [**дбглог**](dbglog.md) отображает сообщения отладки по мере выполнения программы. Эта функция используется для трассировки выполнения приложения или фильтра. Можно регистрировать коды возврата, значения переменных и любые другие важные сведения.

Каждое сообщение отладки имеет тип, например \_ Трассировка журнала или ошибка журнала \_ , и уровень отладки, указывающий важность сообщения. Сообщения с более низким уровнем отладки более важны, чем более высокие уровни.

В следующем примере гипотетический фильтр отключает ПИН-код от массива закрепления. Если попытки отключения завершились неуспешнее, фильтр отображает \_ сообщение трассировки журнала. Если попытка не удалась, отображается \_ сообщение об ошибке журнала:


```C++
hr = m_PinArray[iPin]->Disconnect();
if (FAILED(hr))
{
    DbgLog((
        LOG_ERROR, 
        1, 
        TEXT("Could not disconnect pin %d. HRESULT = %#x", 
        iPin, 
        hr
        ));
 
   // Error handling code (not shown).
}
DbgLog((LOG_TRACE, 3, TEXT("Disconnected pin %d"), iPin));
```



При отладке можно задать уровень отладки для каждого типа сообщений. Кроме того, каждый модуль (DLL или исполняемый файл) поддерживает собственные уровни отладки. При тестировании фильтра Повысьте уровень отладки для библиотеки DLL, содержащей фильтр.

Дополнительные сведения см. в разделе [отладочные функции вывода](debug-output-functions.md).

## <a name="critical-sections"></a>Критические разделы

Чтобы упростить отслеживание взаимоблокировок, включите утверждения, которые определяют, владеет ли вызывающий код заданный критический раздел. Функции [**критчеккин**](critcheckin.md) и [**критчеккаут**](critcheckout.md) указывают, владеет ли вызывающий поток критическим разделом. Как правило, эти функции вызываются внутри макроса Assert.

Можно также использовать функцию [**дбглокктраце**](dbglocktrace.md) для трассировки при удержании или освобождении критических секций.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Отладка в DirectShow](debugging-in-directshow.md)
</dt> </dl>

 

 



