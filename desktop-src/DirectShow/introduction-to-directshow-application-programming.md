---
description: Введение в программирование приложений DirectShow
ms.assetid: 21a72efa-95df-4754-8304-ad56965a914d
title: Введение в программирование приложений DirectShow
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f6218a346a7eb9711259c025aef09133ef2e58f6
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/06/2021
ms.locfileid: "104416640"
---
# <a name="introduction-to-directshow-application-programming"></a>Введение в программирование приложений DirectShow

В этой статье рассказывается о базовой терминологии и концепциях, используемых в DirectShow. После прочтения этого раздела вы будете готовы написать свое первое приложение DirectShow.

**Фильтры и графы фильтров**

Стандартный блок DirectShow — это программный компонент, называемый *фильтром*. Фильтр — это программный компонент, который выполняет некоторую операцию в потоке мультимедиа. Например, фильтры DirectShow могут

-   чтение файлов
-   получение видео с устройства видеозаписи
-   декодирование различных форматов потоков, таких как видео MPEG-1
-   Передача данных в графический или звуковой адаптер

Фильтры получают входные данные и выдают выходные данные. Например, если фильтр декодирует видео MPEG-1, входные данные являются потоком в кодировке MPEG, а выходные данные — серией несжатых видеокадров.

В DirectShow приложение выполняет любую задачу, подключив цепочки фильтров друг к другу, чтобы выход из одного фильтра стал входным для другого. Набор подключенных фильтров называется *графом фильтра*. Например, на следующей диаграмме показан граф фильтра для воспроизведения AVI-файла.

![Фильтрация графа для воспроизведения файла AVI](images/avi-filter-graph.png)

Фильтр источника файлов считывает AVI с жесткого диска. Фильтр-разделитель AVI анализирует файл в два потока: сжатый поток видео и аудиопоток. Фильтр распаковки AVI декодирует кадры видео. Фильтр модуля обработки видео выводит кадры на экран с помощью DirectDraw или GDI. Фильтр устройства DirectSound по умолчанию воспроизводит аудиопоток, используя DirectSound.

Приложению не требуется управлять всеми этими потоками данных. Вместо этого фильтры контролируются компонентом высокого уровня, который называется диспетчером графа фильтров. Приложение выполняет высокоуровневые вызовы API, такие как "Run" (для перемещения данных через граф) или "останавливаться" (для завершения потока данных). Если требуется больший контроль над операциями потока, можно получить доступ к фильтрам напрямую через интерфейсы COM. Диспетчер графов фильтров также передает в приложение уведомления о событиях.

Диспетчер графов фильтров также выполняет другие задачи: он предоставляет приложениям методы для построения графа фильтра путем соединения фильтров. (DirectShow также предоставляет различные вспомогательные объекты, упрощающие этот процесс. Они тщательно описаны в документации.)

**Написание приложения DirectShow**

В общих чертах есть три задачи, которые должны выполняться в любом приложении DirectShow. Они показаны на следующей схеме.

![Типичное приложение DirectShow](images/fgm.png)

1.  Приложение создает экземпляр диспетчера графа фильтров.
2.  Приложение использует диспетчер графа фильтров для создания графа фильтра. Точный набор фильтров в графе будет зависеть от приложения.
3.  Приложение использует диспетчер графа фильтров для управления графом фильтра и потоковых данных с помощью фильтров. В ходе этого процесса приложение также будет реагировать на события из диспетчера графа фильтров.

После завершения обработки приложение освобождает диспетчер графов фильтров и все фильтры.

DirectShow основана на модели COM; Диспетчер графов фильтров и фильтры являются объектами COM. Перед началом программирования DirectShow необходимо иметь общее представление о программировании клиента COM. Доступно множество книг по программированию COM.

Чтобы приступить к работе с DirectShow, прочитайте статью [как воспроизвести файл](how-to-play-a-file.md), который представляет собой простое консольное приложение для воспроизведения видеофайла. В разделе, [посвященном DirectShow](about-directshow.md) , описывается архитектура DirectShow более подробно, а в разделе [Использование DirectShow](using-directshow.md) изучаются основные сценарии, поддерживаемые DirectShow, такие как захват, редактирование видео, воспроизведение DVD-дисков и телевидение.

 

 



