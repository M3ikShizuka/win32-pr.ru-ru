---
description: Flow данных в навигаторе DVD
ms.assetid: 14f9cfa3-5ef6-419c-9196-2e4060549c03
title: Flow данных в навигаторе DVD
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 56e649edfacf0a1fad56cfbe8e73a5e1e9aaf099b9c17463858bf776ab06605c
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118953363"
---
# <a name="data-flow-in-the-dvd-navigator"></a>Flow данных в навигаторе DVD

В навигаторе DVD есть методы остановки и приостановки воспроизведения. Эти методы аналогичны (но не идентичны) методам **остановки** и **приостановки** в [**имедиаконтрол**](/windows/desktop/api/Control/nn-control-imediacontrol). Вот разница между ними:

-   Методы **IDvdControl2** изменяют то, что читает DVD-навигатор с диска. Они не изменяют состояние графа.
-   Методы **имедиаконтрол** изменяют состояние графа. Они не изменяют то, что читает DVD-навигатор с диска. (Существует одно важное исключение, описанное в следующем разделе, связанное с методом « **останавливаться** ».)

Например, метод [**IDvdControl2::P Аусе**](/windows/desktop/api/Strmif/nf-strmif-idvdcontrol2-pause) выдает команду в приложении J "Pause \_ On", но не приостанавливает граф фильтра. Метод [**имедиаконтрол::P Аусе**](/windows/desktop/api/Control/nf-control-imediacontrol-pause) , с другой стороны, приостанавливает граф, но не выдает никаких команд DVD.

В общем случае используйте методы **имедиаконтрол::P Аусе** и **останавливают** вместо соответствующих методов **IDvdControl2** . Методы **имедиаконтрол** имеют очень небольшие задержки, в то время как методы **IDvdControl2** могут иметь задержку до двух секунд.

Остановка воспроизведения

Поведение [**имедиаконтрол:: останавливаться**](/windows/desktop/api/Control/nf-control-imediacontrol-stop) зависит от флага, который можно задать с помощью метода [**IDvdControl2:: SetOption**](/windows/desktop/api/Strmif/nf-strmif-idvdcontrol2-setoption) .

-   Если \_ флаг РЕСЕТОНСТОП DVD имеет **значение false**, **имедиаконтрол:: Stop** останавливает граф, но не изменяет домен навигатора DVD. При повторном вызове метода воспроизведение продолжается с текущей позицией.
-   Если \_ РЕСЕТОНСТОП DVD имеет **значение true**, **имедиаконтрол:: останавливается** приводит к сбросу DVD-навигатора. При вызове [**имедиаконтрол:: Run**](/windows/desktop/api/Control/nf-control-imediacontrol-run) еще раз Навигатор DVD воспроизводится из первого домена воспроизведения, как будто DVD-диск впервые вставлен в первый раз.

\_По умолчанию флаг DVD ресетонстоп имеет **значение true** для совместимости с более старыми приложениями. Однако обычно следует переопределить значение по умолчанию и установить для флага значение **false**. Причина заключается в том, что определенные события могут привести к прекращению графа во время воспроизведения. Например, если разрешение экрана изменяется, граф фильтра останавливается, повторно подключает модуль подготовки отчетов и перезагружается. Если \_ РЕСЕТОНСТОП DVD имеет **значение true**, воспроизведение будет перезапущено с начала диска. Это, вероятно, не то, что ждет пользователь.

Поэтому в начале приложения необходимо вызвать **SetOption** с DVD \_ ресетонстоп, установленным в значение **false**. Если вы хотите отключить воспроизведение и возобновить его из того же расположения, вызовите **имедиаконтрол:: останавливаться** или **имедиаконтрол::P Аусе**. Если вы хотите отключить воспроизведение и сбросить диск, вызовите **SetOption** с DVD- \_ ресетонстоп, равным **true**; затем вызовите **имедиаконтрол:: останавливаться**; наконец, снова вызовите **SetOption** и сбросьте DVD \_ ресетонстоп в **значение false**.

Приостановка воспроизведения

Если передать DVD-навигатор команде во время приостановки графа, команда может не завершиться, пока граф не будет запущен снова. В некоторых случаях это может вызвать взаимоблокировку в приложении. Чтобы избежать взаимоблокировок, необходимо выполнить два правила.

-   При приостановке не выдается более одной асинхронной команды DVD.
-   Во время приостановки не блокируйте поток пользовательского интерфейса приложения или поток, который изменяет состояние графа.

Второе правило стоит изучить более подробно. Ниже приведены некоторые особые сценарии, которые могут вызвать взаимоблокировку:

-   **Сценарий**. при приостановке приложение создает команду DVD с флагом блокировки. Это может привести к взаимоблокировке, если поток, который выдает команду DVD, является тем же потоком, который выдает команду Run. Команда DVD блокируется до тех пор, пока граф не будет запущен, но граф не сможет выполняться до завершения команды.

    **Рекомендация**: выполните команду DVD в отдельном рабочем потоке или не используйте флаг блокировки.

-   **Сценарий**. при приостановке приложение создает команду DVD, а затем вызывает [**Идвдкмд:: ваитфоренд**](/windows/desktop/api/Strmif/nf-strmif-idvdcmd-waitforend) в объекте Command. Эта ситуация эквивалентна предыдущему примеру. Если вызвать **Wait** из потока пользовательского интерфейса, поток пользовательского интерфейса не сможет запустить граф до тех пор, пока метод **Wait** не разблокируется, но метод **Wait** не будет разблокирован до выполнения графа.

    **Рекомендация**: вызов **Wait** в рабочем потоке.

-   **Сценарий**. пока граф работает, приложение создает команду DVD с флагом блокировки, а затем вызывает Pause из другого потока. Это возможный конфликт, так как граф может быть приостановлен до выдачи команды. Если один из двух потоков является потоком пользовательского интерфейса, может возникнуть взаимоблокировка, похожая на два предыдущих примера. В этом примере показана важность написания поточно-ориентированного кода, если приложение использует несколько потоков.

    **Рекомендация**. Если вы используете рабочие потоки, убедитесь, что код является потокобезопасным.

-   **Сценарий**. при приостановке приложение отключает команду Run из пользовательского интерфейса, а затем выдает команду для асинхронного DVD-диска. Этот вариант не является строго взаимоблокировкой, так как поток приложения все еще выполняется. Однако пользователю не удастся запустить граф, поэтому команда не будет выполнена.

    **Рекомендация**. при приостановке всегда оставляйте включенную команду выполнения.

Поиск DVD-диска в указанное время

Чтобы точно найти указанное время на диске, вызовите [**имедиаконтрол:: Run**](/windows/desktop/api/Control/nf-control-imediacontrol-run). Затем вызовите [**IDvdControl2::P лайаттиме**](/windows/desktop/api/Strmif/nf-strmif-idvdcontrol2-playattime), указав время и настроив  \_ \_ Сброс флага dwFlags на DVD-диск \_ .

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[DVD-приложения](dvd-applications.md)
</dt> </dl>

 

 



