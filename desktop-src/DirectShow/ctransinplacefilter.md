---
description: 'Класс Ктрансинплацефилтер предназначен для фильтров преобразования на месте, которые представляют собой фильтры, которые изменяют входные данные, а не копируют данные между буферами. Чтобы использовать этот класс, сделайте новый класс производным от Ктрансинплацефилтер и реализуйте следующие методы:'
ms.assetid: 3d6d5436-f280-4e36-96e4-40161e8115c2
title: Класс Ктрансинплацефилтер (Трансип. h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- CTransInPlaceFilter
api_type:
- COM
api_location:
- Strmbase.lib
- Strmbase.dll
- Strmbasd.lib
- Strmbasd.dll
ms.openlocfilehash: 5f59dd312adbb95797caf695aecea082f296df5b
ms.sourcegitcommit: c8ec1ded1ffffc364d3c4f560bb2171da0dc5040
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2021
ms.locfileid: "105676055"
---
# <a name="ctransinplacefilter-class"></a>Класс Ктрансинплацефилтер

![Иерархия классов ктрансинплацефилтер](images/tsip03.png)

`CTransInPlaceFilter`Класс предназначен для фильтров преобразования на месте, которые представляют собой фильтры, которые изменяют входные данные, а не копируют данные между буферами. Чтобы использовать этот класс, сделайте новый класс производным от `CTransInPlaceFilter` и реализуйте следующие методы:

-   [**Ктрансформфилтер:: Чеккинпуттипе**](ctransformfilter-checkinputtype.md)
-   [**Ктрансинплацефилтер:: Transform**](ctransinplacefilter-transform.md)

Этот класс использует класс [**ктрансинплацеинпутпин**](ctransinplaceinputpin.md) для входного ПИН-кода и класс [**ктрансинплацеаутпутпин**](ctransinplaceoutputpin.md) для выходного ПИН-кода. Как правило, переопределение этих классов закрепления не требуется. Фильтр создает оба ПИН-кода в методе [**ктрансинплацефилтер:: жетпин**](ctransinplacefilter-getpin.md) . Если вы переопределяете классы закрепления, необходимо переопределить **жетпин** , чтобы создать пользовательские ПИН-коды.

Этот класс спроектирован таким образом, чтобы тип входных данных всегда совпадал с типом выходных данных. Когда это возможно, фильтр использует один распределитель для обоих подключений.

## <a name="preferred-media-types"></a>Предпочтительные типы носителей

Если выходной ПИН-код уже подключен, закрепление ввода предоставляет предпочтительные типы подчиненного фильтра. (На самом деле он просто возвращает объект перечислителя подчиненного фильтра.) В противном случае он не имеет предпочтительных типов. Выходной ПИН-код имеет такое же поведение, но в обратную: Если входной ПИН-код уже подключен, закрепление вывода предоставляет предпочтительные типы вышестоящего фильтра. В противном случае нет предпочтительных типов

## <a name="pin-connections"></a>Закрепление подключений

При подключении одного ПИН-кода фильтр обычно повторно подключается к другому ПИН-коду, чтобы убедиться, что оба контакта используют один и тот же тип носителя и один распределитель. (Механизм повторного подключения ПИН-кодов описан в разделе [Повторное подключение ПИН](reconnecting-pins.md)-кодов). Возможны два сценария: сначала подключается входной ПИН-код, либо сначала подключается выходной ПИН-код.

Предположим, что сначала подключается входной ПИН-код. Выполняются следующие действия.

1.  Входной ПИН-код вызывает метод [**чеккинпуттипе**](ctransformfilter-checkinputtype.md) фильтра для проверки типа мультимедиа.
2.  Вышестоящий фильтр выбирает распределитель. На этом этапе входной ПИН-код не имеет требований к распределительу и принимает все распределителя для подключения. Если вышестоящий фильтр запрашивает распределителя, ПИН-код создает новый. По причинам, описанным в скором времени, этот распределитель не будет использоваться в окончательном соединении. Он предоставляется только для того, чтобы помочь завершить этот этап процесса подключения.

Позже, когда закрепление будет подключено:

1.  Закрепление вывода вызывает метод [**чеккинпуттипе**](ctransformfilter-checkinputtype.md) фильтра для проверки типа мультимедиа. Он также вызывает [**Ипин:: куерякцепт**](/windows/desktop/api/Strmif/nf-strmif-ipin-queryaccept) в вышестоящем фильтре. Это гарантирует, что входной ПИН-код может изменить тип носителя на совпадающий.
2.  Закрепление вывода вызывает метод [**чеккинпуттипе**](ctransformfilter-checkinputtype.md) фильтра для проверки типа мультимедиа. Он также вызывает [**Ипин:: куерякцепт**](/windows/desktop/api/Strmif/nf-strmif-ipin-queryaccept) в вышестоящем фильтре. Это гарантирует, что входной ПИН-код может изменить тип носителя на совпадающий.
3.  Закрепление вывода вызывает метод [**чеккинпуттипе**](ctransformfilter-checkinputtype.md) фильтра для проверки типа мультимедиа. Он также вызывает [**Ипин:: куерякцепт**](/windows/desktop/api/Strmif/nf-strmif-ipin-queryaccept) в вышестоящем фильтре. Это гарантирует, что входной ПИН-код может изменить тип носителя на совпадающий.
4.  На этот [**раз метод метода**](ctransinplaceinputpin-getallocator.md) [**жеталлокаторрекуирементс**](ctransinplaceinputpin--getallocatorrequirements.md) для ПИН-кода возвращает нисходящий распределитель. Входной ПИН-код принимает любой распределитель, выбранный вышестоящим фильтром.
5.  На этот [**раз метод метода**](ctransinplaceinputpin-getallocator.md) [**жеталлокаторрекуирементс**](ctransinplaceinputpin--getallocatorrequirements.md) для ПИН-кода возвращает нисходящий распределитель. Входной ПИН-код принимает любой распределитель, выбранный вышестоящим фильтром.

Теперь рассмотрим противоположный сценарий, где выходным закреплением является первый ПИН-код для подключения.

1.  Закрепление вывода вызывает метод [**чеккинпуттипе**](ctransformfilter-checkinputtype.md) фильтра для проверки типа мультимедиа.
2.  Он выбирает распределитель, предложив использование распределителя подчиненного фильтра.

Затем, когда входной ПИН-код подключается:

1.  Входной ПИН-код проверяет тип мультимедиа, вызывая [**чеккинпуттипе**](ctransformfilter-checkinputtype.md) для фильтра и вызывая [**куерякцепт**](/windows/desktop/api/Strmif/nf-strmif-ipin-queryaccept) для выходного ПИН-кода подчиненного фильтра.
2.  Если тип входных данных не соответствует выходному типу, фильтр повторно подключится к выходному закрепления.
3.  Вышестоящий фильтр выбирает распределитель. Метод метода [**распределителе**](ctransinplaceinputpin-getallocator.md) входного контакта возвращает нисходящий распределитель, а входной ПИН-код принимает любой распределитель, выделенный вышестоящим фильтром.
4.  Фильтр использует тот же распределитель для подчиненного соединения, что может переопределять исходный нисходящий распределитель.

Эта последовательность событий немного меняется, если любой из задействованных распределительов доступен только для чтения, так как подчиненный распределитель должен быть доступен для записи. В этом случае фильтр может использовать два отдельных распределителя.

Дополнительные сведения об использовании этого класса см. в разделе [написание фильтров преобразования](writing-transform-filters.md).



| Защищенные переменные членов                                                        | Описание                                                                      |
|-----------------------------------------------------------------------------------|----------------------------------------------------------------------------------|
| [**m \_ бмодифиесдата**](ctransinplacefilter-m-bmodifiesdata.md)                   | Указывает, изменяет ли фильтр образец данных.                           |
| Защищенные методы                                                                 | Описание                                                                      |
| [**Копировать**](ctransinplacefilter-copy.md)                                          | Копирует пример носителя.                                                           |
| [**InputPin**](ctransinplacefilter-inputpin.md)                                  | Извлекает указатель на входной ПИН-код фильтра.                                   |
| [**OutputPin**](ctransinplacefilter-outputpin.md)                                | Извлекает указатель на закрепление вывода фильтра.                                  |
| [**типесматч**](ctransinplacefilter-typesmatch.md)                              | Определяет, соответствует ли входной тип носителя выходному типу носителя.           |
| [**усингдифференталлокаторс**](ctransinplacefilter--usingdifferentallocators.md) | Определяет, используют ли контакты ввода и вывода различные распределителя.     |
| Открытые методы                                                                    | Описание                                                                      |
| [**ктрансинплацефилтер**](ctransinplacefilter-ctransinplacefilter.md)            | Метод конструктора.                                                              |
| [**жетпин**](ctransinplacefilter-getpin.md)                                      | Извлекает ПИН-код.                                                                 |
| [**жетмедиатипе**](ctransinplacefilter-getmediatype.md)                          | Извлекает предпочтительный тип мультимедиа для выходного контакта.                             |
| [**деЦидебуфферсизе**](ctransinplacefilter-decidebuffersize.md)                  | Задает требования к буферу выходного контакта.                                       |
| [**чекктрансформ**](ctransinplacefilter-checktransform.md)                      | Проверяет, совместим ли входной тип носителя с выходным типом носителя.      |
| [**комплетеконнект**](ctransinplacefilter-completeconnect.md)                    | Завершает подключение ПИН-кода.                                                      |
| [**Получать**](ctransinplacefilter-receive.md)                                    | Получает пример носителя, обрабатывает его и доставляет в подчиненный фильтр. |
| Чистые виртуальные методы                                                              | Описание                                                                      |
| [**Преобразование**](ctransinplacefilter-transform.md)                                | Преобразует образец на месте.                                                    |



 

## <a name="requirements"></a>Требования



| Требование | Значение |
|--------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Header<br/>  | <dl> <dt>Трансип. h (включение Streams. h)</dt> </dl>                                                                                   |
| Библиотека<br/> | <dl> <dt>Стрмбасе. lib (розничные сборки); </dt> <dt>Стрмбасд. lib (отладочные сборки)</dt> </dl> |



 

 




