---
description: Советы по устранению неполадок
ms.assetid: e87ad3bd-07ae-4b9d-b465-2ce4688bdd83
title: Советы по устранению неполадок
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2c0280702c7ce2131d1252ec75b8bee4be231e29
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105663544"
---
# <a name="troubleshooting-tips"></a>Советы по устранению неполадок

Следующие советы помогут избежать взаимоблокировок и сбоев в приложении DirectShow.

**Глобальные объекты**

Глобальный объект C++ не должен создавать объекты DirectShow в своем методе-конструкторе или освобождать их в методе деструктора. Это может привести к неограниченному блокированию приложения по следующей причине:

Потоки не могут выйти из функции точки входа в DLL. Ядро 32 содержит блокировку глобального процесса во время функции точки входа, а блокировка предотвращает выход из потока. Так как некоторые объекты DirectShow являются собственными потоками, они могут блокироваться при их освобождении из функции точки входа в DLL. Если приложение имеет глобальный объект C++, Библиотека DLL среды выполнения C вызывает деструктор объекта при выгрузке библиотеки DLL. Если деструктор освобождает объекты DirectShow, он может блокироваться в результате.

По тем же причинам библиотека DLL не должна создавать или освобождать объекты DirectShow в своей подподпрограмме точки входа.

**Освобождение интерфейсов**

Необходимо освободить все указатели интерфейса DirectShow, пока приложение все еще обрабатывает сообщения, до того, как оно завершит цикл обработки сообщений. В противном случае могут отображаться различные утверждения, так как некоторые объекты DirectShow отправляют сообщения во время выполнения подпрограмм очистки.

(Если вы используете класс ATL **квиндовимпл** , не следует ждать, пока **онфиналмессаже** освободит интерфейсы. Вместо этого Освободите их при обработке сообщения о \_ закрытии WM.)

**Счетчики ссылок**

Когда отладочная версия Quartz.dll выгружается, она проверяет наличие у объектов DirectShow счетчиков ссылок, которые не были освобождены. В этом случае создается утверждение:


```C++
g_cFGObjects == 0 
```



Если это утверждение не выполняется, это означает, что приложение вызвало утечку счетчика ссылок. Проверьте код и убедитесь, что выпускают все указатели интерфейса.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Отладка в DirectShow](debugging-in-directshow.md)
</dt> </dl>

 

 



