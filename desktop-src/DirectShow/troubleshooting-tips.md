---
description: Советы по устранению неполадок
ms.assetid: e87ad3bd-07ae-4b9d-b465-2ce4688bdd83
title: Советы по устранению неполадок
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 83fe361af291c29f8784235066f341d940ab38205cd3b8238896011f85021a9b
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118651246"
---
# <a name="troubleshooting-tips"></a>Советы по устранению неполадок

следующие советы помогут избежать взаимоблокировок или сбоев в приложении DirectShow.

**Глобальные объекты**

глобальный объект C++ не должен создавать DirectShow объекты в своем методе-конструкторе или освобождать их в методе деструктора. Это может привести к неограниченному блокированию приложения по следующей причине:

Потоки не могут выйти из функции точки входа в DLL. Ядро 32 содержит блокировку глобального процесса во время функции точки входа, а блокировка предотвращает выход из потока. так как некоторые DirectShow объекты являются собственными потоками, они могут блокироваться при их освобождении из функции точки входа в DLL. Если приложение имеет глобальный объект C++, Библиотека DLL среды выполнения C вызывает деструктор объекта при выгрузке библиотеки DLL. если деструктор освобождает DirectShow объекты, он может блокироваться в результате.

по тем же причинам библиотека DLL не должна создавать или освобождать DirectShow объекты в своей подподпрограмме точки входа.

**Освобождение интерфейсов**

необходимо освободить все указатели интерфейса DirectShow, пока приложение все еще обрабатывает сообщения, до того, как оно завершит цикл обработки сообщений. в противном случае могут отображаться различные утверждения, так как некоторые DirectShow объекты отправляют сообщения во время выполнения подпрограмм очистки.

(Если вы используете класс ATL **квиндовимпл** , не следует ждать, пока **онфиналмессаже** освободит интерфейсы. Вместо этого Освободите их при обработке сообщения о \_ закрытии WM.)

**Счетчики ссылок**

когда отладочная версия Quartz.dll выгружается, она проверяет наличие в DirectShowных объектах счетчиков ссылок, которые не были освобождены. В этом случае создается утверждение:


```C++
g_cFGObjects == 0 
```



Если это утверждение не выполняется, это означает, что приложение вызвало утечку счетчика ссылок. Проверьте код и убедитесь, что выпускают все указатели интерфейса.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Отладка в DirectShow](debugging-in-directshow.md)
</dt> </dl>

 

 



