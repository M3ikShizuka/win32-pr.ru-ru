---
description: Загрузка файла проекта
ms.assetid: f8d142bd-e51d-4714-893b-8e3d02506891
title: Загрузка файла проекта
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8f9a710795a29481740bf85390cc7122cc801a22
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/06/2021
ms.locfileid: "104262380"
---
# <a name="loading-a-project-file"></a>Загрузка файла проекта

\[Этот API не поддерживается и может быть изменен или недоступен в будущем.\]

Чтобы загрузить файл проекта, необходимы два компонента: средство синтаксического анализа XML и пустая временная шкала. Средство синтаксического анализа XML считывает файл XML-проекта и создает каждый объект, определенный в файле. Затем он вставляет объекты на временную шкалу и задает все атрибуты временной шкалы, например частоту кадров по умолчанию. В следующем примере кода загружается файл.


```C++
HRESULT         hr;
IAMTimeline     *pTL = NULL;
IXml2Dex        *pXML = NULL; 
hr = CoCreateInstance(CLSID_AMTimeline, NULL, CLSCTX_INPROC_SERVER, 
            IID_IAMTimeline, (void**)&pTL);
hr = CoCreateInstance(CLSID_Xml2Dex, NULL, CLSCTX_INPROC_SERVER, 
            IID_IXml2Dex, (void**)&pXML);
BSTR bstrFile = SysAllocStringLen(OLESTR("C:\\example.xtl"), 15);
hr = pXML->ReadXMLFile(pTL, bstrFile); 
SysFreeString(bstrFile);
pXML->Release();
```



Средство синтаксического анализа предоставляет интерфейс [**IXml2Dex**](ixml2dex.md) , который содержит методы для загрузки и сохранения файлов проекта. Временная шкала предоставляет интерфейс [**иамтимелине**](iamtimeline.md) , который содержит методы для управления временной шкалой и создания новых объектов временной шкалы. Вызовите функцию **CoCreateInstance** для создания каждого компонента, как показано ниже. Помните, что, создавая новый экземпляр, вы увеличиваете счетчик ссылок в интерфейсе. Чтобы избежать утечек памяти, всегда освобождайте интерфейс при работе с ним. В этом примере указатель на **IXml2Dex** больше не нужен, поэтому интерфейс можно освободить. Указатель на **иамтимелине** по-прежнему необходим для предварительного просмотра временной шкалы.

Метод [**IXml2Dex:: реадксмлфиле**](ixml2dex-readxmlfile.md) считывает указанный файл и заполняет временную шкалу объектами, определенными в файле. Имя файла указывается с помощью значения **BSTR** . Чтобы сократить пример, имя файла в примере задается в виде литеральной строки. Как правило, его можно получить из диалогового окна открытия файла или аналогичного объекта.

Если метод **ReadXml** успешно выполнен, он возвращает код успешного выполнения. В противном случае возвращается код ошибки, такой как VFW \_ E \_ Недопустимый \_ \_ Формат файла. Всегда проверяйте возвращаемое значение, чтобы правильно обработать состояние ошибки. Опять же, для краткости пример кода не проверяет наличие ошибок.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Загрузка и предварительный просмотр проекта](loading-and-previewing-a-project.md)
</dt> </dl>

 

 



