---
description: Возможности видео
ms.assetid: 305bd009-f58e-4dcc-9b70-252de87dc86d
title: Возможности видео
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4841f5f33b39adc6bd12775e07085e14886d250cd59c988884ae7ca8a6a21b80
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119290862"
---
# <a name="video-capabilities"></a>Возможности видео

Метод [**иамстреамконфиг:: жетстреамкапс**](/windows/desktop/api/Strmif/nf-strmif-iamstreamconfig-getstreamcaps) предоставляет возможности видео в виде массивов пар " [**\_ \_ тип мультимедиа**](/windows/win32/api/strmif/ns-strmif-am_media_type) " и " [**\_ \_ Конфигурация \_ потока видео**](/windows/win32/api/strmif/ns-strmif-video_stream_config_caps) ". Его можно использовать для предоставления всех форматов и разрешений, поддерживаемых на ПИН-коде, как описано ниже.

Примеры **жетстреамкапс** см. в статье [возможности](audio-capabilities.md)работы с аудио.

Предположим, что карта захвата поддерживает формат JPEG при любых разрешениях между 160 x 120 пикселей и 320 x 240 пикселей включительно. Разница между поддерживаемыми разрешениями в данном случае заключается в том, что вы добавляете или вычитаете один пиксел из каждого поддерживаемого разрешения, чтобы получить следующее поддерживаемое разрешение. Это различие в поддерживаемых разрешениях называется степенью гранулярности.

Предположим, что ваша карта также поддерживает размер 640 x 480. Ниже показано одно и то же разрешение и приведенный выше диапазон разрешений (все размеры находятся в диапазоне от 160 x 120 пикселей до 320 x 240 пикселей).

![разрешение от 160 x 120 до 320 x 240 пикселей, а также 640 x 480](images/strmcap1.png)

Кроме того, предположим, что он поддерживает 24-разрядный формат RGB при разрешении между 160 x 120 и 320 x 240, но с гранулярностью в 8. На следующем рисунке показаны некоторые допустимые размеры в этом случае.

![разрешение от 160 x 120 до 320 до 240 с детализацией = 8](images/strmcap3.png)

Чтобы разместить его другим способом и вывести дополнительные разрешения, в списке допустимых разрешений будут использоваться следующие.

-   160 x 120
-   168 x 120
-   168 x 128
-   176 x 128
-   176 x 136
-   ... Дополнительные разрешения...
-   312 x 232
-   320 x 240

Используйте **жетстреамкапс** для предоставления таких форматов и возможностей измерений, предлагая тип мультимедиа 320 x 240 JPEG (если это ваш размер по умолчанию или предпочтительный), с минимальными возможностями 160 x 120, максимальными возможностями 320 x 240 и степенью детализации 1. Следующая пара, которую вы предоставляете с помощью **жетстреамкапс** , — это тип носителя 640 x 480 JPEG, связанный с минимумом 640 x 480 и не более 640 x 480 и степенью гранулярности 0. Третья пара включает тип мультимедиа 320 x 240, 24-разрядный RGB с минимальными возможностями 160 x 120, максимальные возможности 320 x 240 и гранулярность 8. Таким образом можно публиковать почти все форматы и возможности, которые может поддерживать ваша карта. Приложение, которое должно иметь представление о том, какие форматы сжатия вы предоставляете, может получить все пары и создать список всех уникальных подтипов типов мультимедиа.

Фильтр получает источник типа мультимедиа и целевые прямоугольники из элементов **рксаурце** и **рктаржет** структуры [**видеоинфохеадер**](/previous-versions/windows/desktop/api/amvideo/ns-amvideo-videoinfoheader) соответственно. Фильтры не обязательно должны поддерживать исходный и целевой прямоугольники.

Прямоугольник обрезки, описанный в документации по [**иамстреамконфиг**](/windows/desktop/api/Strmif/nn-strmif-iamstreamconfig) , аналогичен прямоугольнику **рксаурце** структуры **видеоинфохеадер** для выходного контакта.

Прямоугольник вывода, описанный в документации по **иамстреамконфиг** , аналогичен элементам **бивидс** и **бихеигхт** структуры **битмапинфохеадер** (см. [DV-данные в формате AVI](dv-data-in-the-avi-file-format.md)).

Если закрепление вывода фильтра подключено к типу мультимедиа с непустым исходным и целевым прямоугольниками, то фильтр необходим для растяжения исходного подпрямоугольника входного формата в целевой подпрямоугольник формата вывода. Исходный подпрямоугольник хранится в элементе **инпутсизе** структуры [**\_ CAPS в \_ конфигурации \_ потока видео**](/windows/win32/api/strmif/ns-strmif-video_stream_config_caps) .

Например, рассмотрим следующий сценарий сжатия видео: входной образ имеет формат RGB и имеет размер 160 x 120 пикселей. Левый верхний угол исходного прямоугольника имеет координаты в координатах (20, 20), а правый нижний угол — в (30, 30). Выходное изображение имеет формат MPEG и имеет размер 320 x 240. Левый верхний угол прямоугольника находится в точке (0, 0), а правый нижний угол — в (100 100). В этом случае фильтр должен взять 10 x 10 битов растрового изображения источника RGB 160 x 120 и заполнить верхнюю область 100 x 100 точечного рисунка 320 x 240, не затрагивая остальную часть точечного рисунка 320 x 240. Этот сценарий показан на следующем рисунке.

![растяжение подпрямоугольника](images/strmcap4.png)

Фильтр может не поддерживать это и может не подключаться к типу мультимедиа, где **рксаурце** и **рктаржет** не являются пустыми.

Структура **видеоинфохеадер** предоставляет сведения о возможностях скорости передачи данных в фильтре. Например, предположим, что вы подключились к следующему фильтру с определенным типом мультимедиа (напрямую или с помощью типа мультимедиа, переданного функцией [**кмедиатипе:: сетформат**](cmediatype-setformat.md) ). Взгляните на элемент **двбитрате** этой структуры формата **видеоинфохеадер** , чтобы узнать, в какой скорости данных следует сжимать видео. Если умножить количество единиц времени на кадр в **авгтимеперфраме** структуры **видеоинфохеадер** на скорость передачи данных в элементе **двбитрате** и разделить на 10 000 000 (количество единиц в секунду), можно определить, сколько байт каждого кадра должно быть. Вы можете создать рамку меньшего размера, но не больше ее. Чтобы определить частоту кадров для видеокомпрессора или фильтра записи, используйте **авгтимеперфраме** из типа носителя выходного контакта.

 

 



