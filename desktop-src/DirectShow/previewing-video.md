---
description: Предварительный просмотр видео
ms.assetid: 9b401de1-910a-41f7-bf80-dda73ee4a204
title: Предварительный просмотр видео (DirectShow)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ae0a8f0d0a422794c4e887693e80391a99bd8d70
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/06/2021
ms.locfileid: "104567242"
---
# <a name="previewing-video-directshow"></a>Предварительный просмотр видео (DirectShow)

Чтобы создать диаграмму предварительного просмотра видео, вызовите метод [**ICaptureGraphBuilder2:: RenderStream**](/windows/desktop/api/Strmif/nf-strmif-icapturegraphbuilder2-renderstream) следующим образом:


```C++
ICaptureGraphBuilder2 *pBuild; // Capture Graph Builder
// Initialize pBuild (not shown).

IBaseFilter *pCap; // Video capture filter.

/* Initialize pCap and add it to the filter graph (not shown). */

hr = pBuild->RenderStream(&PIN_CATEGORY_PREVIEW, &MEDIATYPE_Video, 
    pCap, NULL, NULL);
```



В этом примере предполагается следующее:

-   *пбуилд* был инициализирован, как описано в разделе [о построителе графов записи](about-the-capture-graph-builder.md).
-   *ПКАП* был инициализирован путем создания экземпляра фильтра записи и его добавления в граф фильтра, как описано в разделе [Выбор устройства записи](selecting-a-capture-device.md).

Первый параметр метода [**ICaptureGraphBuilder2:: RenderStream**](/windows/desktop/api/Strmif/nf-strmif-icapturegraphbuilder2-renderstream) задает категорию закрепления. для предварительного просмотра диаграммы используйте **\_ \_ Предварительный просмотр категории закрепления**. Второй параметр указывает тип носителя, в качестве основного GUID типа. Для видео используйте **\_ Формат MEDIATYPE**. DV-устройства доставляют аудио и видео с чередованием, для которых используется тип носителя с **\_ чередованием**. (Дополнительные сведения о записи DV см. [в статье Digital Video In DirectShow](digital-video-in-directshow.md).)

Третий параметр является указателем на интерфейс [**ибасефилтер**](/windows/desktop/api/Strmif/nn-strmif-ibasefilter) фильтра захвата. В этом примере следующие два параметра не требуются. Они используются для указания дополнительных фильтров, которые могут потребоваться для визуализации потока. Установка последнего параметра в **значение NULL** приводит к тому, что построитель диаграмм будет выбирать модуль подготовки отчетов по умолчанию для потока на основе типа носителя. Для видео Построитель графов записи всегда использует фильтр модуля [подготовки](video-renderer-filter.md) отчетов в качестве модуля подготовки отчетов по умолчанию.

> [!Note]  
> В Windows XP и более поздних версиях, хотя модуль подготовки видео (VMR) является модулем подготовки видео по умолчанию для методов [**играфбуилдер**](/windows/desktop/api/Strmif/nn-strmif-igraphbuilder) , он не является модулем подготовки отчетов по умолчанию для метода [**RenderStream**](/windows/desktop/api/Strmif/nf-strmif-icapturegraphbuilder2-renderstream) . На любой платформе в построителе графов записи всегда используется старый фильтр модуля подготовки отчетов, если не указано иное.

 

Хотя Категория PIN-кодов указана **как \_ \_ Предварительная версия категории ПИН**-кода, она не имеет значения, имеет ли фильтр предварительный ПИН-код, он может иметь ПИН-код видеопорта или просто ПИН-код захвата. В любом случае построитель графов записи автоматически создает правильный граф.

На следующей диаграмме показана самая простая диаграмма для предварительного просмотра видео.

![Диаграмма предварительного просмотра видео](images/vidcap01.png)

На этой схеме фильтр записи имеет предварительный ПИН-код для предварительного просмотра, который подключается непосредственно к модулю подготовки видео.

Если фильтр записи имеет только ПИН-код записи, построитель графа записи добавляет фильтр [Smart tee](smart-tee-filter.md) , который разделяет поток на поток записи и предварительный просмотр потока. Это описано более подробно в статье [объединение видеороликов и предварительной версии](combining-video-capture-and-preview.md).

В некоторых случаях поток видео должен проходить через фильтр микшера наложения. Если это так, метод [**RenderStream**](/windows/desktop/api/Strmif/nf-strmif-icapturegraphbuilder2-renderstream) автоматически добавит его в граф.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Объединение видеозаписей и предварительной версии](combining-video-capture-and-preview.md)
</dt> <dt>

[Видеозапись](video-capture.md)
</dt> </dl>

 

 



