---
description: Режим с окнами VMR (совместимость)
ms.assetid: e9fb1c83-860a-44c1-9633-c86f5d0fdadd
title: Режим с окнами VMR (совместимость)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7312274881642d15b844e0fa950f72e52f92db8f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104567498"
---
# <a name="vmr-windowed-compatibility-mode"></a>Режим с окнами VMR (совместимость)

VMR разработан для совместимости со всеми существующими приложениями DirectShow. При использовании с существующим приложением VMR работает в оконном режиме с одним потоком видео, также называемым режимом совместимости. Этот режим предоставляется, так как VMR-7 является модулем подготовки отчетов по умолчанию в Windows XP и поэтому автоматически используется в вызовах [интеллектуальных методов соединения](intelligent-connect.md) , таких как [**Играфбуилдер:: renderFile**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-renderfile). Если приложение использует интеллектуальное подключение и требует только базовых возможностей рендеринга, Специальный код для корректной отрисовки с помощью VMR-7 в Windows XP не требуется.

VMR-9 также работает в режиме окон и совместимости по умолчанию. Однако VMR-9 никогда не является модулем подготовки видео по умолчанию. Чтобы использовать VMR-9 в приложении, необходимо явно добавить его в граф фильтра. По этой причине, поскольку режим без окон обеспечивает лучшую функциональность по сравнению с оконным режимом, использование VMR-9 в режиме окон и совместимости не имеет смысла.

**Использование VMR-7 в режиме окон и совместимости**

Для установки и управления VMR-7 в режиме окон и совместимости специальное программирование не требуется. Просто создайте граф фильтра с помощью стандартных вызовов построения графа, и VMR-7 будет по умолчанию использовать этот режим.

В режиме окон и совместимости VMR-7 создает собственное окно для показа видео. Для этого загружается компонент диспетчера окон, который предоставляет интерфейсы [**ивидеовиндов**](/windows/desktop/api/Control/nn-control-ivideowindow) и [**ибасиквидео**](/windows/desktop/api/Control/nn-control-ibasicvideo) . Приложение может запрашивать диспетчер графа фильтров для этих интерфейсов точно так же, как и старый фильтр модуля подготовки отчетов видео. Дополнительные сведения см. [в разделе Использование оконного режима](using-windowed-mode.md).

На следующем рисунке показан фильтр VMR-7 в режиме окон и совместимости.

![VMR в режиме совместимости](images/vmr-compat-mode.png)

Чтобы обеспечить максимальный уровень совместимости, окно видео имеет то же имя класса, которое было создано старым фильтром модуля подготовки отчетов, и большая часть кода диспетчера окон из старого модуля подготовки видео по-прежнему используется фильтром VMR. В режиме окон и совместимости VMR использует не больше системных ресурсов, чем у старого модуля подготовки видео. Поскольку VMR-7 имеет только один входной поток в режиме «в Windows» или «совместимость», он не загружает компоненты микшера или компоновщика.

По умолчанию VMR растягивает изображение, чтобы заполнить окно видео. Чтобы сохранить пропорции источника, вызовите метод [**ивмраспектратиоконтрол:: сетаспектратиомоде**](/windows/desktop/api/Strmif/nf-strmif-ivmraspectratiocontrol-setaspectratiomode) с \_ \_ \_ флагом поля VMR армоде Letter.

> [!Note]  
> Приложения MFC, которые размещают окно видео в дочернем окне, должны определять пустой \_ обработчик сообщений WM ерасебкгнд, иначе область видеоизображения не будет правильно перерисовываться.

 

**Использование VMR-7 в режиме окон и совместимости с несколькими потоками**

В режиме «в Windows» и «совместимость» VMR-7 по умолчанию создает один закрепление ввода и отключает режим смешения. Чтобы включить режим смешения, необходимо настроить VMR перед его подключением. Дополнительные сведения см. [в разделе VMR с несколькими потоками (режим смешения)](vmr-with-multiple-streams--mixing-mode.md). В режиме смешения VMR загружает компоненты смешения и композиции, требующие больше системных ресурсов.

**Использование VMR-9 в оконном режиме**

Так как VMR-9 не является модулем подготовки отчетов по умолчанию, он не имеет режима совместимости. Вместо этого VMR-9 по умолчанию принимает оконный режим с четырьмя входными контактами. Этот режим можно использовать для смешивания до четырех потоков видео. Если необходимо смешать большее количество потоков, необходимо настроить его, как описано в [VMR с несколькими потоками (режим смешения)](vmr-with-multiple-streams--mixing-mode.md). В противном случае VMR-9 в оконном режиме ведет себя точно так же, как VMR-7 в режиме окон и совместимости.

 

 



