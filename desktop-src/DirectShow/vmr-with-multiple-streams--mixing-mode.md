---
description: VMR с несколькими потоками (режим смешения)
ms.assetid: 053edb70-8631-4fe4-a137-2fe54e02ab9e
title: VMR с несколькими потоками (режим смешения)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a21a954b0ad78afbceabf0fde493f920961b90dd
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105673981"
---
# <a name="vmr-with-multiple-streams-mixing-mode"></a>VMR с несколькими потоками (режим смешения)

VMR может визуализировать несколько входных потоков. В этой конфигурации, именуемой режимом смешения, VMR загружает микшер и компоновщик для смешения и смешения перед отрисовкой. Режим смешения можно использовать, когда VMR находится в оконном режиме или в режиме без окон.

Режим смешения требует, чтобы графический драйвер поддерживал \_ флаги возможностей ддкапс блтфауркк и ддкапс \_ блтстретч (преобразование цветового пространства и растяжение блиттинг, соответственно). Почти все новые графические драйверы обладают этими возможностями. Кроме того, драйвер должен поддерживать создание целевых объектов рендеринга Direct3D для текущей глубины отображаемого пикселя. Некоторые устройства не поддерживают операции Direct3D, если для экрана задано значение 24 бита на пиксель. Дополнительные сведения см. в документации по DirectX Graphics SDK.

> [!Note]  
> Когда VMR смешивает несколько видеопотоков, граф фильтра не выполняет поиск правильно. Если необходимо найти несколько видеопотоков, необходимо создать отдельные графы фильтров, которые используют один и тот же пользовательский объект распределителя-Presenter.

 

**Настройка VMR-7 для нескольких потоков**

Чтобы отобразить несколько входных потоков с помощью VMR-7, выполните следующие действия.

1.  Перед подключением любого из входных ПИН-кодов VMR вызовите метод [**ивмрфилтерконфиг:: сетнумберофстреамс**](/windows/desktop/api/Strmif/nf-strmif-ivmrfilterconfig-setnumberofstreams) с числом потоков. Это заставляет VMR загрузить микшер и компоновщик и создать указанное число входных ПИН-кодов.
2.  Вызовите метод [**ивмрфилтерконфиг:: сетрендерингпрефс**](/windows/desktop/api/Strmif/nf-strmif-ivmrfilterconfig-setrenderingprefs) , чтобы указать различные параметры отрисовки.
3.  Подключите контакты к вышестоящим фильтрам. Самый простой способ сделать это — вызвать метод [**играфбуилдер:: renderFile**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-renderfile) для каждого входного потока. Если закрепление вывода в вышестоящем фильтре (обычно в декодере) и в закреплении ввода на VMR не может согласовать соединение, будет создан новый экземпляр VMR с параметрами по умолчанию. Это приведет к созданию нового окна с «ActiveMovie» в строке заголовка. Чтобы предотвратить это, приложение должно всегда проверять, используется ли правильный экземпляр VMR, вызывая метод, например [**Ипин:: коннектедто**](/windows/desktop/api/Strmif/nf-strmif-ipin-connectedto). Другой вариант — Добавить фильтр источника, а затем подключить ПИН-код с помощью **играфбуилдер:: Connect**.
4.  Используйте интерфейс [**ивмрмиксерконтрол**](/windows/desktop/api/Strmif/nn-strmif-ivmrmixercontrol) на VMR для управления параметрами каждого потока, например альфа-значения, порядка Z и прямоугольника вывода.
5.  Запустите граф фильтра.

**Настройка VMR-9 для нескольких потоков**

По умолчанию VMR-9 создает четыре входных контакта. Если вы хотите смешивать более четырех потоков видео, вызовите [**IVMRFilterConfig9:: сетнумберофстреамс**](/previous-versions/windows/desktop/api/Vmr9/nf-vmr9-ivmrfilterconfig9-setnumberofstreams) , прежде чем подключать любые входные ПИН-коды. Используйте интерфейс [**IVMRMixerControl9**](/previous-versions/windows/desktop/api/Vmr9/nn-vmr9-ivmrmixercontrol9) , чтобы задать параметры потока, такие как альфа, Z-порядок и расположение.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Использование режима смешения VMR](using-vmr-mixing-mode.md)
</dt> </dl>

 

 



