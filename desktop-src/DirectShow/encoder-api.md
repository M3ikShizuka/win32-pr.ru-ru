---
description: API кодировщика
ms.assetid: 3d19152f-17a3-4576-a2a2-5b827d9ca8d1
title: API кодировщика
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 386b964f44dc4dc69896ead34bbe0d0177b198a1
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127169996"
---
# <a name="encoder-api"></a>API кодировщика

API кодировщика предоставляет единообразный интерфейс для настройки кодировщиков программного обеспечения и оборудования. Приложения могут использовать API кодировщика для настройки кодировщика и хранения параметров конфигурации. Поставщики кодировщиков могут использовать API кодировщика для предоставления возможностей кодировщика. Несмотря на то, что API кодировщика предназначен в основном для кодировщиков, это достаточно, так как декодеры могут его поддерживать.

API кодировщика предоставляется приложениям через интерфейс [**икодекапи**](/windows/desktop/api/Strmif/nn-strmif-icodecapi) , который предоставляется фильтром кодировщика. фильтр кодировщика может быть собственным DirectShow фильтром, аппаратным кодировщиком или объектом мультимедиа DirectX (DMO).

-   фильтры программного обеспечения. кодировщик, реализованный как собственный фильтр DirectShow, должен напрямую предоставлять [**икодекапи**](/windows/desktop/api/Strmif/nn-strmif-icodecapi) .
-   Аппаратные кодировщики. устройство кодирования предоставляется через один или несколько Австреам минидриверс, которые представлены в пользовательском режиме Кспрокси. Кспрокси преобразует вызовы метода [**икодекапи**](/windows/desktop/api/Strmif/nn-strmif-icodecapi) в наборы свойств KS. Дополнительные сведения см. в документации по DDK.
-   дмос: DMO должен предоставлять интерфейс [**икодекапи**](/windows/desktop/api/Strmif/nn-strmif-icodecapi) . DirectShow приложения могут запрашивать фильтр оболочки DMO, который предоставляет интерфейс, выполнив статистическую обработку DMO. приложения, не основанные на DirectShow, могут запрашивать DMO напрямую.

### <a name="encoder-capabilties"></a>Кодировщик предложения

Кодировщик может зарегистрировать список возможностей высокого уровня, сохранив их в системном реестре. Каждая возможность идентифицируется по идентификатору GUID. Чтобы перечислить возможности конкретного кодировщика, выполните следующие действия.

1.  Создайте моникер, представляющий фильтр кодировщика. (См. раздел [Использование перечислителя системных устройств](using-the-system-device-enumerator.md).)
2.  Запросите моникер фильтра для интерфейса [**ижеткапабилитиескэй**](/windows/desktop/api/Strmif/nn-strmif-igetcapabilitieskey) .
3.  Вызовите [**ижеткапабилитиескэй:: жеткапабилитиескэй**](/windows/desktop/api/Strmif/nf-strmif-igetcapabilitieskey-getcapabilitieskey). Метод возвращает маркер раздела реестра, содержащего список возможностей фильтра.
4.  Вызовите функцию **реженумвалуе** , чтобы перечислить значения для возвращаемого ключа.

Если вы разработке кодировщик, создайте записи реестра для возможностей при регистрации фильтра. Для фильтров программного обеспечения создайте ключ с именем **capabilities** , который находится рядом с ключами **FilterData** и **FriendlyName** . Как правило, эти сведения добавляются после вызова [**AMovieDllRegisterServer2**](amoviedllregisterserver2.md) для регистрации стандартных данных фильтра. дополнительные сведения см. [в статье регистрация DirectShow фильтров](how-to-register-directshow-filters.md). Кроме того, можно создать ключ **капабилитиеслокатион** , содержащий строку с расположением ключа **возможностей** в реестре. Строка должна начинаться с "HKLM \\ ", "HKCR \\ " или "HKCU \\ ", чтобы указать поддерево реестра. Для самонастраивающийся устройств файлы установки драйвера должны создать ключ **возможностей** , смежный с ключом **FriendlyName** фильтра, или использовать ключ **капабилитиеслокатион** , как описано в разделе Фильтры программного обеспечения.

После создания ключа **возможностей** Создайте значение для каждого GUID возможности. Имя значения должно быть строковым форматом идентификатора GUID в форме `{xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}` . Каждый тип значения должен быть одним из следующих:

-   Одно числовое значение. Используйте значение **типа DWORD** .
-   GUID. Используйте форму строки GUID.
-   Числовые пары. Используйте строку с формой "a, b" для представления пар значений, таких как ширина и высота, числитель и знаменатель для дробей.
-   Массивы значений. Используйте несколько строк (**reg \_ SZ \_ Multi**), чтобы представить более одного значения.

В следующем примере показана структура реестра для фильтра программного обеспечения.


```C++
\HKCR\CLSID\Filter Category\Instance\Filter CLSID\Capabilities\
    
Values: 
    
    guid1: 1234 (REG_DWORD)   
    
    guid2: "{xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}" (REG_SZ)
    
    guid3: "2","4","6" (REG_SZ_MULTI)
    
    guid4: "720,480" (REG_SZ) 
```



### <a name="encoder-profiles"></a>Профили кодировщика

*Профиль кодировщика* — это фиксированный список параметров конфигурации, которые можно применить к кодировщику во время выполнения. Профили не зависят от кодировщика; приложение может выбрать кодировщик, затем выбрать профиль и применить параметры профиля к кодировщику. Профили определяются по идентификатору GUID и должны храниться в следующем расположении в реестре:


```C++
\HKLM\Software\Microsoft\EncoderProfiles\Profile GUID\
```



где *GUID профиля*

строковый формат идентификатора GUID, определяющего профиль. Создайте значения для каждого параметра. Также создайте строковое значение с именем FriendlyName, данные которого определяют профиль (например, "Ловбандвидсвидео").

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Разработка кодировщика и декодера](encoder-and-decoder-development.md)
</dt> </dl>

 

 



