---
description: Воспроизведение веб-потока ASF в DirectShow
ms.assetid: c7818c62-24af-4eac-84b8-f76be4ca6c09
title: Воспроизведение веб-потока ASF в DirectShow
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2d14a83d2baf9c11aa824f5d6358f62790c16b30
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/06/2021
ms.locfileid: "104341935"
---
# <a name="asf-web-stream-playback-in-directshow"></a>Воспроизведение веб-потока ASF в DirectShow

Microsoft DirectShow поддерживает веб-потоки в сценариях воспроизведения файлов с помощью фильтра [чтения WM ASF](wm-asf-reader-filter.md) , но для записи и сохранения потока необходимо написать собственный фильтр DirectShow.

> [!Note]  
> Для воспроизведения веб-потоков в содержимом, которое передается с сервера, на котором работают службы Windows Media, используйте элемент управления ActiveX® Windows Media 9 Series, внедренный в веб-страницу.

 

При наличии файла, содержащего потоки типа ВММЕДИАТИПЕ \_ филетрансфер, средство чтения WM ASF создаст для него закрепление вывода. Блоком формата будет структура [**\_ \_ формата ВМТ**](/previous-versions/windows/desktop/api/wmsdkidl/ns-wmsdkidl-wmt_webstream_format) в виде потока. (Эта структура описана в документации пакета Windows Media Format SDK.) Если подчиненный фильтр недоступен для работы с этим типом мультимедиа, ПИН-код останется неподключенным, но он по-прежнему будет воспроизводить аудио-и видеопотоки.

Каждый пример носителя в веб-потоке содержит [**структуру \_ \_ \_ заголовков ВМТ для примера потока**](/previous-versions/windows/desktop/api/wmsdkidl/ns-wmsdkidl-wmt_webstream_sample_header) , которая описана в документации по пакету SDK Windows Media Format. Структура имеет переменную длину в зависимости от длины ее элемента **всзурл** . Указатель на образец данных изначально указывает на эту структуру, и необходимо передвинуть указатель за пределы структуры, чтобы получить доступ к реальным данным в потоке.

Фильтр обработчика веб-потока должен основываться на классе [**кбасерендерер**](cbaserenderer.md) . В методе [**кбасерендерер::D орендерсампле**](cbaserenderer-dorendersample.md) фильтру необходимо будет проанализировать структуру для получения сведений о веб-потоке, а затем выполнить соответствующее действие. Как правило, это предполагает сохранение файла на диск, а затем вызов функций [**креатеурлкачинтри**](/windows/desktop/api/wininet/nf-wininet-createurlcacheentrya) и [**коммитурлкачинтрив**](/windows/desktop/api/wininet/nf-wininet-commiturlcacheentryw) или [**коммитурлкачинтря**](/windows/desktop/api/wininet/nf-wininet-commiturlcacheentrya) для помещения файлов в кэш Internet Explorer. Фильтр должен обрабатывать составные файлы, то есть файлы, размер которых больше одного образца, а также обрабатывать команды рендеринга, которые задаются членом **ВМТ \_ \_ \_ . ВСАМПЛЕТИПЕ в образце потока** . Фильтр отправляет в приложение [**событие \_ EC \_ OLE**](ec-ole-event.md) , а также текст **\_ заголовка ВМТ \_ \_ . всзурл** , который содержит имя файла для подготовки к просмотру. Затем приложение вызывает отображение указанной страницы в браузере. Если веб-поток создан правильно, файл должен уже находиться в кэше.

Дополнительные сведения о формате ВМТ в \_ \_ виде потока и в \_ \_ \_ заголовке ВМТ Stream см. в документации по пакету SDK для Windows Media Format.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Чтение файлов ASF в DirectShow](reading-asf-files-in-directshow.md)
</dt> </dl>

 

 
