---
description: Настройка модуля записи ASF
ms.assetid: 5708c4a0-6197-4a42-adfd-01c6dfe86302
title: Настройка модуля записи ASF
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5e3d28b3b6178a383909f53a98fef98a5c3e69297f71615010f505d28b77375a
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119871704"
---
# <a name="configuring-the-asf-writer"></a>Настройка модуля записи ASF

При создании фильтра [модуля записи WM ASF](wm-asf-writer-filter.md) он автоматически настраивается с помощью профиля вмпрофиле \_ V80 \_ 256Video. в этом профиле используются кодеки Windows media Audio и Windows media Video 8, которые не являются последними кодеками Windows Media 9. рекомендуется создать настраиваемый профиль, использующий кодеки Windows Media 9, и настроить модуль записи WM ASF с помощью настраиваемого профиля, как описано в разделе [настройка профилей и других свойств ASF-файлов](configuring-profiles-and-other-asf-file-properties.md). Перед настройкой фильтра необходимо добавить фильтр модуля записи WM ASF в граф фильтра, а затем настроить фильтр перед его подключением к другим фильтрам.

Все входные данные должны иметь отметку времени, и все входные ПИН-коды должны быть подключены, прежде чем можно будет запустить или приостановить фильтр. Таким образом, если вы настроите фильтр с профилем, который содержит аудиопоток и поток видео, фильтр создаст звук и ПИН-код входного видео, и оба контакта должны быть подключены, прежде чем можно будет запустить фильтр. поскольку пакет SDK для Windows Media Format требует, чтобы поток аудио работал, модуль записи WM ASF всегда должен иметь входной пин-код, даже если он предназначен для фиктивного потока, то есть звукового потока с низкими разрядами.

Добавление модулей обработки данных

Вы можете настроить поток профиля для модулей обработки данных, например коды времени SMPTE до или после подключения фильтра, при условии, что выполняется следующий порядок операций:

1.  Добавьте в поток одно или несколько расширений модулей данных с помощью **IWMStreamConfig2:: адддатаунитекстенсион**.
2.  Вызовите **ивмпрофиле:: реконфигстреам** , чтобы обновить профиль.
3.  Вызовите [**иконфигасфвритер:: конфигурефилтерусингпрофиле**](/previous-versions/windows/desktop/api/Dshowasf/nf-dshowasf-iconfigasfwriter-configurefilterusingprofile) с обновленным объектом Profile.
4.  Найдите ПИН-код входного видео и вызовите его метод [**иамвмбуфферпасс:: сетнотифи**](/previous-versions/windows/desktop/api/Dshowasf/nf-dshowasf-iamwmbufferpass-setnotify) , чтобы зарегистрировать определяемый приложением интерфейс [**иамвмбуфферпасскаллбакк**](/previous-versions/windows/desktop/api/Dshowasf/nn-dshowasf-iamwmbufferpasscallback) .

При запуске графа метод [**иамвмбуфферпасскаллбакк:: notify**](/previous-versions/windows/desktop/api/Dshowasf/nf-dshowasf-iamwmbufferpasscallback-notify) будет вызываться для каждого кадра, и вы сможете получить и задать свойства в образце с помощью его методов интерфейса **INSSBuffer3** .

> [!Note]  
> В некоторых сценариях с интенсивным использованием процессора, таких как инверсный чересстрочности, модуль записи WM ASF может потребовать больше буферов вывода, чем может поддерживать некоторые нисходящие фильтры. Например, декодер DV не принимает более одного буфера для выходного ПИН-кода, и это справедливо для распаковки AVI в определенных условиях. При возникновении проблем при попытке подключения к этим фильтрам или, возможно, при запуске графа, может потребоваться написать промежуточный фильтр, который принимает любое количество буферов на выходном ПИН-коде.

 

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Создание файлов ASF в DirectShow](creating-asf-files-in-directshow.md)
</dt> </dl>

 

 



