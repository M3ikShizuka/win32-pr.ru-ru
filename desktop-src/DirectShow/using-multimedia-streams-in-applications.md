---
description: Использование потоков мультимедиа в приложениях
ms.assetid: 73cfe89b-df46-445a-92c7-2f7323672441
title: Использование потоков мультимедиа в приложениях
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f30dab204bc7b0bddbdc293708daecbe0558e8f9
ms.sourcegitcommit: c16214e53680dc71d1c07111b51f72b82a4512d8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/03/2021
ms.locfileid: "103999923"
---
# <a name="using-multimedia-streams-in-applications"></a>Использование потоков мультимедиа в приложениях

> [!Note]  
> Эти API-интерфейсы являются устаревшими. Приложения должны использовать [**образец фильтра захвата**](sample-grabber-filter.md) или реализовать настраиваемый фильтр для получения данных из графа фильтра DirectShow.

 

Интерфейсы потоковой передачи мультимедиа значительно упрощают процесс манипулирования данными мультимедиа за счет удаления зависимости от конкретных характеристик оборудования или программного обеспечения и предоставления поддержки всех форматов мультимедиа Microsoft DirectX®. Потоки применяют данные к очень высокому уровню. приложения могут даже перемещать данные из одного потока в другой, не зная никаких сведений о формате данных.

Чтобы создать поток мультимедиа, выполните следующие действия.

1.  Создайте поток мультимедиа. Метод создания и инициализации потока зависит от архитектуры. DirectShow поддерживает интерфейс [**иаммултимедиастреам**](/previous-versions/windows/desktop/api/amstream/nn-amstream-iammultimediastream) , который используется для инициализации потока. Другие реализации внутрипроцессного сервера [**имултимедиастреам**](/previous-versions/windows/desktop/api/mmstream/nn-mmstream-imultimediastream) будут созданы и инициализированы с помощью различных механизмов.
2.  После инициализации объекта потока мультимедиа приложение будет использовать **QueryInterface** для получения интерфейса **имултимедиастреам** для объекта. Используйте этот интерфейс для определения свойств потока и перечисления самих потоков. Вы можете получить конкретный поток, вызвав метод [**имултимедиастреам:: жетмедиастреам**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-imultimediastream-getmediastream) с конкретным идентификатором цели. МСПИД \_ примаривидео и мспид \_ примаряудио, которые представляют основные видеопотоки и звуковые потоки, являются наиболее часто используемыми идентификаторами целей.
3.  Вызовите метод **IUnknown:: QueryInterface** для интерфейса, относящегося к типу мультимедиа потока. Например, если необходимо отобразить видеопоток, то можно получить его интерфейс [**идиректдравмедиастреам**](/previous-versions/windows/desktop/api/ddstream/nn-ddstream-idirectdrawmediastream) . Интерфейсы для конкретных носителей определяют дополнительные методы, необходимые для полного использования возможностей формата.
4.  Создайте один или несколько выборок из потоковых данных. Каждый поток мультимедиа поддерживает метод [**имедиастреам:: креатешаредсампле**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-imediastream-createsharedsample) для создания образца. Полученный пример поддерживает интерфейс [**истреамсампле**](/previous-versions/windows/desktop/api/mmstream/nn-mmstream-istreamsample) , который обеспечивает контроль над образцом и его характеристиками. Как правило, поток мультимедиа поддерживает метод образца создания, зависящий от формата, который является более мощным, чем вышеупомянутые методы **истреамсампле** . **Идиректдравмедиастреам**, например, может создавать образцы, присоединенные к нужной поверхности DirectDraw и прямоугольнику обрезки. Однако в некоторых ситуациях необходимо выполнять обработку данных, не зная о своем формате данных. Если требуется потоковая передача данных независимо от их формата, используйте метод **имедиастреам:: креатешаредсампле** для создания образцов данных.
5.  После создания всех требуемых примеров потока Запустите поток, вызвав метод [**имултимедиастреам:: setState**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-imultimediastream-setstate) и передав в \_ качестве параметра флаг запуска стреамстате.
6.  Вызовите метод [**истреамсампле:: Update**](/previous-versions/windows/desktop/api/mmstream/nf-mmstream-istreamsample-update) , чтобы обновить пример потока. При выходе из метода **истреамсампле:: Update** можно получить доступ к данным примера. Если требуется активировать определенное событие или вызов функции при возврате обновления, передайте соответствующие указатели методу **истреамсампле:: Update** .

Дополнительные сведения об интерфейсах потоковой передачи мультимедиа см. в разделе [потоковая передача мультимедиа](multimedia-streaming.md).

 

 



