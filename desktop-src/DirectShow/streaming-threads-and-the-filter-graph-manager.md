---
description: Потоковая передача потоков и диспетчер графа фильтров
ms.assetid: b490b72a-ab34-46e6-8dc6-a7bb07cfc7b1
title: Потоковая передача потоков и диспетчер графа фильтров
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 28a8c5b8fa972a8118563ae8f9e73d480ac15e80
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105674057"
---
# <a name="streaming-threads-and-the-filter-graph-manager"></a>Потоковая передача потоков и диспетчер графа фильтров

Когда диспетчер графа фильтров останавливает граф, он ожидает завершения работы всех потоков потоковой передачи. Это имеет следующие последствия для фильтров:

-   Фильтр не должен вызывать методы в диспетчере графов фильтров из потоковой передачи.

    Диспетчер графов фильтров использует критическую секцию для синхронизации собственных операций. Если поток потоковой передачи пытается сохранить этот критический раздел, это может привести к взаимоблокировке. Например: Предположим, что другой поток останавливает граф. Этот поток принимает блокировку графа фильтра и ожидает, пока фильтр не завершит доставку данных. Если фильтр ожидает блокировки, он никогда не будет останавливаться, что приведет к взаимоблокировке.

-   Фильтр не должен ни выполнять **AddRef** , ни **QueryInterface** диспетчер графов фильтра из потоковой передачи.

    Если фильтр содержит счетчик ссылок в диспетчере графов фильтров (через **AddRef** или **QueryInterface**), он может стать последним объектом для хранения счетчика ссылок. Когда фильтр вызывает **выпуск**, диспетчер графа фильтров уничтожает себя. Внутри своей подпрограммы очистки диспетчер графа фильтров пытается прекратить граф, что приведет к ожиданию завершения потока потоковой передачи. Однако он ожидает в потоке потоковой передачи, поэтому поток потоковой передачи не может завершиться. Результатом является взаимоблокировка.

 

 



