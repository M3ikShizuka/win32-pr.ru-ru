---
description: потоки потоковой передачи и диспетчер Graph фильтра
ms.assetid: b490b72a-ab34-46e6-8dc6-a7bb07cfc7b1
title: потоки потоковой передачи и диспетчер Graph фильтра
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3501f984880fad22399cbda8710acaf2be1d6c4223e07a4c0f6e4c180d0699cc
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119329774"
---
# <a name="streaming-threads-and-the-filter-graph-manager"></a>потоки потоковой передачи и диспетчер Graph фильтра

когда диспетчер Graph фильтра останавливает граф, он ожидает завершения работы всех потоков потоковой передачи. Это имеет следующие последствия для фильтров:

-   фильтр не должен вызывать методы в фильтре Graph Manager из потока потоковой передачи.

    фильтр Graph Manager использует критическую секцию для синхронизации собственных операций. Если поток потоковой передачи пытается сохранить этот критический раздел, это может привести к взаимоблокировке. Например: Предположим, что другой поток останавливает граф. Этот поток принимает блокировку графа фильтра и ожидает, пока фильтр не завершит доставку данных. Если фильтр ожидает блокировки, он никогда не будет останавливаться, что приведет к взаимоблокировке.

-   фильтр не должен ни выполнять **AddRef** , ни **QueryInterface** Graph Manager из потоковой передачи.

    если фильтр содержит счетчик ссылок для фильтра Graph Manager (через **AddRef** или **QueryInterface**), он может стать последним объектом для хранения счетчика ссылок. когда фильтр вызывает **выпуск**, фильтр Graph Manager уничтожает себя. внутри своей подпрограммы cleanup диспетчер Graph Manager пытается прекратить граф, что приводит к ожиданию завершения потока потоковой передачи. Однако он ожидает в потоке потоковой передачи, поэтому поток потоковой передачи не может завершиться. Результатом является взаимоблокировка.

 

 



