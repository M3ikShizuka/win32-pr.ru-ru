---
description: Фильтр модуля подготовки отчетов видео
ms.assetid: 7719ed9d-e3b9-4c84-b587-4e120b5cabf8
title: Фильтр модуля подготовки отчетов видео
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5ca3becb4fbdbb52a9968481aade07d14d963828
ms.sourcegitcommit: 63753fcfb0afbbe5ec283fb8316e62c2dc950f66
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/22/2021
ms.locfileid: "107908422"
---
# <a name="video-renderer-filter"></a>Фильтр модуля подготовки отчетов видео

Фильтр модуля подготовки отчетов видео является надежным модулем подготовки видео, предназначенным для всех целей.

> [!Note]  
> В Windows XP и более поздних версиях модулем подготовки видео по умолчанию является [Фильтр модуля подготовки видео "Микширование 7](video-mixing-renderer-filter-7.md) " (VMR-7). Фильтр VMR-7 и модуль подготовки видео имеют понятное имя "модуль подготовки видео". На более ранних платформах модуль подготовки видео является модулем подготовки отчетов по умолчанию. См. раздел [Выбор правильного модуля подготовки](choosing-the-right-renderer.md)отчетов.

 

Модуль подготовки видео использует поверхности DirectDraw и оверлея, если видеоадаптер поддерживает их. Диспетчер графов фильтров предоставляет интерфейс [**ивидеовиндов**](/windows/desktop/api/Control/nn-control-ivideowindow) , который позволяет приложениям устанавливать и извлекать свойства модуля подготовки видео. При использовании новых видеоадаптеров модуль подготовки отчетов поддерживает полноэкранную отрисовку. В противном случае диспетчер графов фильтров автоматически переключается на [полноэкранный](full-screen-renderer-filter.md) фильтр модуля подготовки отчетов в полноэкранном режиме. Дополнительные сведения см. в разделе [**ивидеовиндов::p UT \_ фуллскринмоде**](/windows/desktop/api/Control/nf-control-ivideowindow-put_fullscreenmode) .

-   \[! Существенно\]  
    > Как правило, окно видео этого фильтра обрабатывает сообщения в рабочем потоке, созданном диспетчером графа фильтров. Однако. Если приложение непосредственно создает фильтр с помощью **CoCreateInstance**, окно видео обрабатывает сообщения в потоке приложения. В этом случае поток приложения должен иметь цикл обработки сообщений для отправки сообщений в окно видео. Кроме того, поток не должен завершать работу до завершения окончательного вызова **выпуска** для модуля подготовки видео, который происходит при завершении работы диспетчера графа фильтра. В противном случае приложение может привести к взаимоблокировке.

     



| Метка | Значение |
|------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Интерфейсы фильтра                        | [**Ибасефилтер**](/windows/desktop/api/Strmif/nn-strmif-ibasefilter), [**ибасиквидео**](/windows/desktop/api/Control/nn-control-ibasicvideo), [**IBasicVideo2**](/windows/desktop/api/Control/nn-control-ibasicvideo2), [**идиректдраввидео**](/previous-versions/windows/desktop/api/Amvideo/nn-amvideo-idirectdrawvideo), [**икспропертисет**](ikspropertyset.md), [**имедиапоситион**](/windows/desktop/api/Control/nn-control-imediaposition), [**имедиасикинг**](/windows/desktop/api/Strmif/nn-strmif-imediaseeking), [**IQualityControl**](/windows/desktop/api/Strmif/nn-strmif-iqualitycontrol), [**IQualProp**](/previous-versions/windows/desktop/api/Amvideo/nn-amvideo-iqualprop), [**IVideoWindow**](/windows/desktop/api/Control/nn-control-ivideowindow) |
| Типы носителей входных закрепления                    | Форматы видео без сжатия.                                                                                                                                                                                                                                                                                                                                                                              |
| Интерфейсы входных закрепления                     | [**Имеминпутпин**](/windows/desktop/api/Strmif/nn-strmif-imeminputpin), [**иоверлай**](/windows/desktop/api/Strmif/nn-strmif-ioverlay), [**Ипин**](/windows/desktop/api/Strmif/nn-strmif-ipin), [**ипинконнектион**](/windows/desktop/api/Strmif/nn-strmif-ipinconnection), [**икуалитиконтрол**](/windows/desktop/api/Strmif/nn-strmif-iqualitycontrol)                                                                                                                                                                                                                           |
| Типы носителей для выходного ПИН-кода                   | Не применяется                                                                                                                                                                                                                                                                                                                                                                                          |
| Интерфейсы выходного ПИН-кода                    | Не применяется                                                                                                                                                                                                                                                                                                                                                                                          |
| Фильтровать CLSID                             | \_ВИДЕОРЕНДЕРЕР CLSID                                                                                                                                                                                                                                                                                                                                                                                     |
| CLSID страницы свойств                      | Нет страницы свойств.                                                                                                                                                                                                                                                                                                                                                                                        |
| Исполняемый объект                               | quartz.dll                                                                                                                                                                                                                                                                                                                                                                                               |
| [Заслуживают](merit.md)                       | Windows XP и более поздние версии: **\_ маловероятно**                                                                                                                                                                                                                                                                                                                                                                |
| [Категория фильтра](filter-categories.md) | **\_ЛЕГАЦИАМФИЛТЕРКАТЕГОРИ CLSID**                                                                                                                                                                                                                                                                                                                                                                        |



 

## <a name="remarks"></a>Комментарии

В отладочной версии Quartz.dll, если \_ уровень отладки трассировки журнала равен 5 или выше, модуль подготовки отчетов отображает штампы времени каждого кадра в окне видео. Эти номера не отображаются в розничной версии библиотеки DLL. Дополнительные сведения см. в разделе [отладочные функции вывода](debug-output-functions.md).

Следующие примечания предназначены для разработчиков фильтров:

Модуль подготовки видео принимает форматы YUV, если видеоадаптер поддерживает поверхности наложения YUV. Однако при первом подключении к вышестоящему фильтру для модуля подготовки видео требуется формат RGB, соответствующий глубине цвета текущих параметров монитора. Например, если текущим параметром дисплея является 24-разрядный цвет, то вышестоящий фильтр должен иметь возможность предоставлять 24-битное видео RGB. Когда граф фильтра переключается в состояние которых запущены, модуль подготовки видео согласовывает динамическое изменение формата с соответствующим цветовым пространством YUV.

При соединении с типом RGB модуль подготовки видео гарантирует, что он сможет использовать GDI в случае, если DirectDraw недоступен. Он переключается на GDI, если другое приложение использует видеопамять, если прямоугольник видео размещает два монитора в системе с несколькими мониторами или если прямоугольник видео полностью скрыт другим окном.

> [!Note]  
> Модуль подготовки видео не выполняет этот тип изменения динамического формата и не требует типа мультимедиа RGB, так как он никогда не использует GDI для отрисовки.

 

Для согласования изменения формата модуль подготовки видео вызывает [**Ипин:: куерякцепт**](/windows/desktop/api/Strmif/nf-strmif-ipin-queryaccept) с новым типом носителя. Если вышестоящий фильтр возвращает значение \_ ОК, модуль подготовки отчетов присоединяет новый носитель к следующему примеру. Вышестоящий фильтр должен вызвать [**имедиасампле:: жетмедиатипе**](/windows/desktop/api/Strmif/nf-strmif-imediasample-getmediatype) для каждого образца. Если **жетмедиатипе** возвращает значение, отличное от **null** , оно указывает на изменение формата, а вышестоящий фильтр — на переключение типов вывода. (Не переключайте типы в метод **куерякцепт** .) Вышестоящий фильтр должен принимать по крайней мере основные типы RGB, и в идеале он должен поддерживать общие типы YUV. Во время потоковой передачи модуль подготовки видео может переключаться между типами YUV и RGB любое количество раз. Модуль подготовки видео не принимает изменения динамического формата, инициированные вышестоящим фильтром.

Когда модуль обработки видео рисуется на поверхности наложения DirectDraw, он выделяет один буфер для входного ПИН-кода. Если вышестоящий фильтр пытается принудительно установить соединение с помощью нескольких буферов, модуль подготовки видео не сможет использовать область наложения.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Фильтры DirectShow](directshow-filters.md)
</dt> </dl>

 

 



