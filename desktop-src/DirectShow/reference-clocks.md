---
description: Эталонные часы
ms.assetid: 43f1a4d6-dbed-4940-a301-d863ddd34bce
title: Эталонные часы
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 64ad0a262b36ce78c6a2f355b30b3c6876c7e78a7807970592b6f15287c0e2c8
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119697114"
---
# <a name="reference-clocks"></a>Эталонные часы

одна из функций фильтра Graph Manager — синхронизировать все фильтры в графе с теми же часами, которые называются *ссылочным временем*.

Любой объект, предоставляющий интерфейс [**иреференцеклокк**](/windows/desktop/api/Strmif/nn-strmif-ireferenceclock) , может использоваться в качестве эталонного времени. контрольные часы могут предоставляться фильтром DirectShow — обычно модулем подготовки звука, который имеет доступ к аппаратному таймеру. в качестве резервного варианта фильтр Graph Manager может использовать системное время.

В номинальной величине эталонное значение измеряет время в 100-наносекундных интервалах, хотя фактическая точность часов может быть меньше. Чтобы получить текущее время часов, вызовите метод [**иреференцеклокк:: OnTime**](/windows/desktop/api/Strmif/nf-strmif-ireferenceclock-gettime) . Базовый показатель часов — время, с которого он начинает подсчитаться, зависит от реализации, поэтому значение, возвращаемое методомического **времени** , не является значимым. Важность — это Дельта, начиная с момента начала работы графа.

Хотя точность ссылочного времени может быть различной, время, возвращаемое [**методом Times**](/windows/desktop/api/Strmif/nf-strmif-ireferenceclock-gettime) , гарантированно увеличивается монотонно. Иными словами, время часы никогда не переходят назад. Если эталонный таймер создает часы из аппаратного источника, а аппаратные часы переходят назад (например, при наличии корректировки для часов) **, метод Times** должен возвращать Последнее сообщаемое время до тех пор, пока аппаратные часы не будут перехватываться. Дополнительные сведения см. в разделе [**класс кбасереференцеклокк**](cbasereferenceclock.md).

**Эталонный таймер по умолчанию**

фильтр Graph Manager автоматически выбирает эталонный таймер при выполнении графа. Для выбора часов используется следующий алгоритм:

-   Если приложение выбрало часы (см. ниже), используйте это время.
-   Если граф содержит фильтр активного источника, поддерживающий [**иреференцеклокк**](/windows/desktop/api/Strmif/nn-strmif-ireferenceclock), используйте этот фильтр. Определение активного источника см. в разделе [Динамические источники](live-sources.md).
-   Если граф не содержит фильтров источника Live, используйте любой фильтр в графе, который поддерживает [**иреференцеклокк**](/windows/desktop/api/Strmif/nn-strmif-ireferenceclock), начиная с модулей подготовки отчетов и рабочего потока. Предпочитать подключенные фильтры по неподключенным фильтрам. (Если граф выполняет визуализацию аудиопотока, этот шаг обычно выбирает фильтр модуля подготовки звука.)
-   Если ни один из фильтров не предоставляет подходящее время, используйте [системные часы](system-reference-clock.md), которые основаны на системном времени.

**Задание ссылочного времени**

приложение может выбрать часы, вызвав метод [**имедиафилтер:: сетсинксаурце**](/windows/desktop/api/Strmif/nf-strmif-imediafilter-setsyncsource) в фильтре Graph Manager. Это следует делать только в том случае, если есть конкретная причина для того, чтобы предпочитать другие часы.

можно указать, что фильтр Graph Manager не должен использовать эталонный таймер, вызвав [**сетсинксаурце**](/windows/desktop/api/Strmif/nf-strmif-imediafilter-setsyncsource) со значением **NULL**. Например, это можно сделать для быстрой обработки образцов как можно быстрее. чтобы восстановить ссылочное время по умолчанию, вызовите метод [**ифилтерграф:: сетдефаултсинксаурце**](/windows/desktop/api/Strmif/nf-strmif-ifiltergraph-setdefaultsyncsource) для фильтра Graph Manager.

каждый раз при изменении ссылочного времени диспетчер Graph Manager уведомляет каждый фильтр, вызывая его метод [**имедиафилтер:: сетсинксаурце**](/windows/desktop/api/Strmif/nf-strmif-imediafilter-setsyncsource) . Приложения никогда не должны вызывать этот метод для фильтров.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[настройка часов Graph](setting-the-graph-clock.md)
</dt> <dt>

[Время и часы в DirectShow](time-and-clocks-in-directshow.md)
</dt> </dl>

 

 



