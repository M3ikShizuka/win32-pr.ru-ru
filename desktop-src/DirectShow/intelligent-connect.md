---
description: Интеллектуальное подключение
ms.assetid: 938ba1b0-822e-4871-8786-b7eeee243867
title: Интеллектуальное подключение
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 12aead305867ccec1f1f1f0cbd76c652ba3ec412
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/06/2021
ms.locfileid: "104495480"
---
# <a name="intelligent-connect"></a>Интеллектуальное подключение

Интеллектуальное соединение — это механизм, используемый диспетчером графа фильтров для построения графов фильтра. Он состоит из нескольких связанных алгоритмов, которые выбирают фильтры и добавляют их в граф фильтра.

Прочтите этот раздел, если у вас возникли проблемы с построением определенного графа фильтра и хотите устранить проблему, или если вы пишете собственный фильтр и хотите сделать его доступным для автоматического построения графа.

Интеллектуальное соединение включает следующие методы [**играфбуилдер**](/windows/desktop/api/Strmif/nn-strmif-igraphbuilder) :

-   [**Играфбуилдер:: Аддсаурцефилтер**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-addsourcefilter)
-   [**Играфбуилдер:: Render**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-render)
-   [**Играфбуилдер:: RenderFile**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-renderfile)
-   [**Играфбуилдер:: Connect**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-connect)

### <a name="igraphbuilderaddsourcefilter"></a>Играфбуилдер:: Аддсаурцефилтер

Метод [**играфбуилдер:: аддсаурцефилтер**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-addsourcefilter) добавляет фильтр источника, который может визуализировать указанный файл. Сначала он ищет в реестре и соответствует протоколу (например `https://` ,), расширению имени файла или набору предварительно определенных *байтов проверки*, которые представляют собой байты в определенном смещении в файле, соответствующем определенным шаблонам. Дополнительные сведения см. [в разделе Регистрация пользовательского типа файлов](registering-a-custom-file-type.md). Предполагая, что метод находит соответствующий фильтр источника, он создает экземпляр этого фильтра, добавляет его к графу и вызывает метод [**ифилесаурцефилтер:: Load**](/windows/desktop/api/Strmif/nf-strmif-ifilesourcefilter-load) фильтра с именем файла.

### <a name="igraphbuilderrender"></a>Играфбуилдер:: Render

Метод [**играфбуилдер:: Render**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-render) создает подраздел диаграммы. Он начинается с неподключенного выходного контакта и работает нисходящим образом, добавляя новые фильтры по мере необходимости. Начальный фильтр уже должен быть в графе. На каждом шаге метод **Render** выполняет поиск фильтра, который может подключиться к предыдущему фильтру. Поток может быть разветвлен, если фильтр соединения имеет несколько выходных закрепления. Поиск останавливается, когда у каждого потока есть модуль подготовки отчетов. Если метод **Render** зависает, он может выполнить резервное копирование и повторить попытку, используя другой набор фильтров.

Для подключения каждого выходного контакта метод [**Render**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-render) выполняет следующие действия:

1.  Если ПИН-код поддерживает интерфейс [**истреамбуилдер**](/windows/desktop/api/Strmif/nn-strmif-istreambuilder) , диспетчер графа фильтров делегирует весь процесс методу [**Истреамбуилдер:: Render**](/windows/desktop/api/Strmif/nf-strmif-istreambuilder-render) контакта. При предоставлении доступа к этому интерфейсу ПИН-код принимает ответственность за построение оставшейся части графа в модуле подготовки отчетов. Однако этот интерфейс поддерживается очень небольшими ПИН-контактами.
2.  Диспетчер графов фильтров пытается использовать фильтры, кэшированные в памяти, если таковые имеются. В рамках интеллектуального процесса подключения диспетчер графов фильтров может кэшировать фильтры из предыдущих шагов процесса. (Также см. статью [динамическое построение графа](dynamic-graph-building.md).)
3.  Если граф фильтра содержит фильтры с неподключенными входными контактами, диспетчер графов фильтров попытается выполнить их далее. Можно принудительно применить определенный фильтр в методе [**Render**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-render) , добавив этот фильтр к графу перед вызовом **Render**.
4.  Начиная с Windows 7, DirectShow имеет список предпочтительных фильтров для определенных подтипов носителей. Если для отображаемого типа мультимедиа используется предпочтительный фильтр, диспетчер графа фильтров попытается выполнить фильтр далее. Приложение может изменить список предпочтительных фильтров с помощью интерфейса [**иамплугинконтрол**](/windows/desktop/api/Strmif/nn-strmif-iamplugincontrol) . Изменения в списке влияют на текущий процесс приложения и удаляются после завершения процесса.
5.  Наконец, если подходящий фильтр не найден, диспетчер графов фильтра выполняет поиск в реестре с помощью метода [**IFilterMapper2:: енумматчингфилтерс**](/windows/desktop/api/Strmif/nf-strmif-ifiltermapper2-enummatchingfilters) . Он пытается сопоставить предпочтительные типы выходных данных с типами носителей, перечисленными в реестре.

    Каждый фильтр зарегистрирован с недоступностью, числовым значением, *указывающим, насколько* предпочтительным является фильтр, относительно других фильтров. Метод [**енумматчингфилтерс**](/windows/desktop/api/Strmif/nf-strmif-ifiltermapper2-enummatchingfilters) Возвращает фильтры в порядке их следования, при **\_ этом \_ не следует \_ использовать** + 1. Он не учитывает фильтры с **\_ \_ недоступностью, но не \_ использует** или меньше. Фильтры также группируются по категориям, определяемым по GUID. Сами категории имеют свои преимущества, и метод **енумматчингфилтерс** игнорирует любую категорию с недостаточной степенью их **\_ \_ \_ использования** , даже если фильтры в этой категории имеют более высокие значения.

    Начиная с Windows 7, DirectShow имеет список заблокированных фильтров для определенных подтипов носителей. Диспетчер графов фильтров пропускает фильтры в этом списке. Приложение может изменить список заблокированных фильтров с помощью интерфейса [**иамплугинконтрол**](/windows/desktop/api/Strmif/nn-strmif-iamplugincontrol) . Изменения в этом списке влияют на текущий процесс приложения и удаляются после завершения процесса.

Для суммирования метод [**Render**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-render) пытается выполнить фильтры в следующем порядке:

1.  Используйте [**истреамбуилдер**](/windows/desktop/api/Strmif/nn-strmif-istreambuilder).
2.  Попробуйте использовать кэшированные фильтры.
3.  Фильтры Try в графе.
4.  Windows 7 или более поздней версии: попробуйте использовать предпочтительный фильтр для типа носителя, если он есть.
5.  Поиск фильтров в реестре.

### <a name="igraphbuilderrenderfile"></a>Играфбуилдер:: RenderFile

Метод [**играфбуилдер:: renderFile**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-renderfile) создает граф воспроизведения по умолчанию на основе имени файла. На внутреннем уровне этот метод использует [**аддсаурцефилтер**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-addsourcefilter) для нахождение правильного фильтра источника и [**отрисовки**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-render) для построения остальной части графа.

### <a name="igraphbuilderconnect"></a>Играфбуилдер:: Connect

Метод [**играфбуилдер:: Connect**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-connect) подключает выходной контакт к входному ПИН-коду. При необходимости этот метод добавляет промежуточные фильтры, используя разновидность алгоритма, описанного для метода [**Render**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-render) :

1.  Попробуйте прямое подключение между фильтрами без промежуточных фильтров.
2.  Попробуйте использовать кэшированные фильтры.
3.  Фильтры Try в графе.
4.  Windows 7 или более поздней версии: попробуйте использовать предпочтительный фильтр для типа носителя, если он есть.
5.  Поиск фильтров в реестре.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Фильтровать категории](filter-categories.md)
</dt> <dt>

[Заслуживают](merit.md)
</dt> <dt>

[Имитация построения графа с помощью Графедит](simulating-graph-building-with-graphedit.md)
</dt> <dt>

[Построение графа фильтра](building-the-filter-graph.md)
</dt> </dl>

 

 



