---
description: Драйвер МСДВ
ms.assetid: 146ca753-fe41-49d3-8b1c-077e10a28192
title: Драйвер МСДВ
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6b7c1bda24980abe84a11613126476ccfe35380d
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/06/2021
ms.locfileid: "104416432"
---
# <a name="msdv-driver"></a>Драйвер МСДВ

МСДВ — это драйвер Microsoft WDM (WDM) для видеокамер DV. Драйвер отображается как фильтр DirectShow, когда устройство подключено к сети. Он перечисляется в двух категориях фильтров:

-   CLSID \_ видеоинпутдевицекатегори ("источники видеозаписей")
-   \_Кскатегори \_ отрисовка ("устройства рендеринга потоковой передачи WDM")

Понятное имя фильтра — `Microsoft DV Camera and VCR` или локализованный эквивалент. В некоторых устройствах свойство **Description** содержит описание конкретной модели, которую можно использовать вместо универсального понятного имени. Дополнительные сведения см. [в разделе Выбор устройства записи](selecting-a-capture-device.md).

МСДВ имеет два выходных контакта. Один ПИН-код предоставляет кадры DV, которые содержат чередующиеся аудио-и видеоданные. Другой ПИН-код предоставляет кадры только для видео без звука. МСДВ не может выполнять потоковую передачу обоих ПИН-кодов одновременно, поэтому одновременно может быть подключен только один выходной контакт. Дополнительные сведения о записи видео с устройства DV см. в разделе [запись DV в файл](capture-dv-to-file.md).

![запись данных DV с устройства](images/dv-filters4.png)

Большинство видеокамер с цифровой видеомагнитофоной имеют подединицу записи видеомагнитофонов (Втр), которая может передавать данные с ленты на компьютер. Для приложения запись с ленты работает так же, как и запись видео в реальном времени. Единственное отличие заключается в том, что приложение должно управлять внешним транспортом ленты — запуском и остановкой ленты, перемотки назад и т. д. Для этой цели МСДВ предоставляет интерфейсы [**иамекстдевице**](/windows/desktop/api/Strmif/nn-strmif-iamextdevice), [**иамексттранспорт**](/windows/desktop/api/Strmif/nn-strmif-iamexttransport)и [**иамтимекодереадер**](/windows/desktop/api/Strmif/nn-strmif-iamtimecodereader) . Дополнительные сведения об управлении Втр см. в разделе [Управление ВИДЕОкамерой](controlling-a-dv-camcorder.md).

Можно также передать DV с компьютера на видеокамеру. Затем видео можно просмотреть на экране портативной видеокамеры или записать на ленту. Для поддержки этой функции МСДВ имеет входной ПИН-код, который может принимать поток с чередованием. Когда входной ПИН-код подключен, МСДВ выступает в качестве фильтра модуля подготовки отчетов вместо фильтра записи. МСДВ не поддерживает поиск в этом режиме. Дополнительные сведения о отправке DV на устройство см. [в разделе Передача DV из файла на ленту](transmit-dv-from-file-to-tape.md).

![Передача DV данных на устройство](images/dv-filters5.png)

Обратите внимание, что входные и выходные контакты не могут быть подключены одновременно, так как устройство не может выполнять потоковую передачу одновременно в обоих направлениях.

Во многих видеокамерах переключение между режимом Втр и режимом камеры приводит к отключению устройства. Поэтому DirectShow может потерять устройство, когда пользователь переключает режимы. Сведения о событиях удаления устройств см. в разделе [уведомление об удалении устройства](device-removal-notification.md).

## <a name="remarks"></a>Комментарии

Сведения о форматах DV, поддерживаемых драйвером МСДВ, см. в статье [**подтипы видео DV**](dv-video-subtypes.md).

Некоторые советы по созданию графов фильтра с помощью МСДВ:

-   Нельзя использовать [**играфбуилдер:: Render**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-render) для отрисовки выходного ПИН-кода в мсдв. (Диспетчер графов фильтров пытается подключить выходной закрепление к входному ПИН-коду МСДВ, который завершается ошибкой.) Вместо этого используйте [**играфбуилдер:: Connect**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-connect) или [**ICaptureGraphBuilder2:: RenderStream**](/windows/desktop/api/Strmif/nf-strmif-icapturegraphbuilder2-renderstream).
-   Если граф фильтра содержит МСДВ, МСДВ должен предоставлять эталонные часы для графа. Начиная с DirectX 8,0, диспетчер графа фильтров автоматически выбирает МСДВ в качестве эталонного времени. В более ранних версиях необходимо вызвать метод [**имедиафилтер:: сетсинксаурце**](/windows/desktop/api/Strmif/nf-strmif-imediafilter-setsyncsource) в диспетчере графов фильтров. Дополнительные сведения о часах см. в статье [время и часы в DirectShow](time-and-clocks-in-directshow.md).
-   В зависимости от устройства некоторые методы в **иамекстдевице**, **иамексттранспорт** и **иамтимекодереадер** могут возвращать коды ошибок Windows вместо значений **HRESULT** . Ниже перечислены возможные коды ошибок.

    | Код ошибки              | Описание                                                                                      |
    |-------------------------|--------------------------------------------------------------------------------------------------|
    | \_время ожидания ошибки          | Истекло время ожидания для команды внешнего устройства.                                                        |
    | Ошибка \_ req \_ не \_ акцеп  | Устройство не приняло эту команду внешнего устройства.                                          |
    | Ошибка \_ не \_ поддерживается   | Устройство не поддерживает эту команду внешнего устройства.                                        |
    | запрос на ошибку \_ \_ прерван | Команда внешнего устройства прервана. Возможно, устройство было удалено, или произошла сброс шины. |

    

     

### <a name="device-information"></a>Сведения об устройстве

В Windows Millennium Edition и Windows XP моникер устройства DV-фильтра поддерживает свойство **Description** в дополнение к свойству **FriendlyName** . Это свойство возвращает описание устройства, взятое из INF-файла, которое обычно содержит фирменное название устройства. Однако это свойство не поддерживается для всех моделей устройств.

Дополнительные сведения об моникерах устройств см. [в разделе Использование перечислителя системных устройств](using-the-system-device-enumerator.md).

### <a name="clock-times"></a>Время суток

Драйвер МСДВ использует часы шины 1394, содержащиеся в пакетах данных 1394, чтобы получить данные о часах. Эти значения используются для отметки времени образцами DV Media. Так как часы этого источника не являются часами компьютерной системы, время в конечном итоге будет отменяться от системных часов системы. Как отмечалось выше, по умолчанию диспетчер графов фильтров выберет МСДВ в качестве времени ссылки на граф.

Интерфейс [**иамдроппедфрамес**](/windows/desktop/api/Strmif/nn-strmif-iamdroppedframes) сообщает текущую меру драйвера о пропущенных кадрах. Это значение может быть идеально синхронизировано с фактическим числом удаленных кадров в заданный момент времени. Если фреймы удалены, это означает, что система не сбалансирована (объем данных в производстве превышает потребление). Например, жесткий диск пользователя может быть недостаточно быстрым для поддержки скорости записи DV.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Фильтры DirectShow](directshow-filters.md)
</dt> <dt>

[Цифровое видео в DirectShow](digital-video-in-directshow.md)
</dt> </dl>

 

 



