---
description: Очистки
ms.assetid: 868218c4-3e1a-4da0-89fa-30a9848da0e8
title: Очистки
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1e70f610a68b2ca81afff736b3e7402d80e5d5675e429d1715ebebf5b640a362
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118401748"
---
# <a name="flushing"></a>Очистки

Пока граф фильтра работает, можно перемещать произвольные объемы данных через граф. Некоторые из них могут находиться в очередях, ожидающих доставки. Бывают случаи, когда графу фильтра необходимо как можно быстрее удалить эти ожидающие данные и заменить их новыми данными. Например, после команды Seek фильтр источника создает образцы из новой позицией в источнике. Чтобы максимально сокращать задержку, нисходящие фильтры должны отбросить все выборки, созданные до команды Seek. Процесс удаления примеров называется *очисткой*. Он обеспечивает более высокую скорость реагирования графа, когда события изменяют нормальный поток данных.

По модели извлечения, в отличие от модели отправки, очистка обрабатывается немного иначе. Эта статья начинается с описания модели push-уведомлений. Затем описываются различия в модели извлечения.

Запись на диск происходит в два этапа.

-   Во-первых, фильтр источника вызывает [**Ипин:: бегинфлуш**](/windows/desktop/api/Strmif/nf-strmif-ipin-beginflush) для входного контакта подчиненного фильтра. Нисходящий фильтр начинает отклонять выборки из вышестоящего. Он также удаляет все удерживаемые примеры и отправляет вызов **бегинфлуш** в следующий фильтр.
-   Когда фильтр источника готов к отправке новых данных, он вызывает [**Ипин:: ендфлуш**](/windows/desktop/api/Strmif/nf-strmif-ipin-endflush) для входного ПИН-кода. Это сигнализирует подчиненному фильтру о том, что он может получать новые образцы. Нисходящий фильтр отправляет вызов **ендфлуш** следующему фильтру.

В методе **бегинфлуш** входной ПИН-код выполняет следующие действия:

1.  Вызывает **бегинфлуш** для подчиненных входных контактов.
2.  Отклоняет все последующие вызовы, которые продают потоковые данные, включая **Receive** и **EndOfStream**.
3.  Разблокирует все вышестоящее фильтры, которые заблокированы в ожидании выборки из распределителя фильтра. Некоторые фильтры отменяют свои распределителя для этой цели.
4.  Завершает работу из всех ожиданий, блокирующих потоковую передачу. Например, фильтр модуля подготовки отчетов блокируется при приостановке. Они также блокируются, когда они ожидают отрисовку образца в правильном потоке. Фильтр должен разблокировать, чтобы образцы, помещенные в очередь, могли быть доставлены и отклонены. Этот шаг гарантирует, что все вышестоящее фильтры в конечном итоге разблокируются.

В методе **ендфлуш** входной ПИН-код выполняет следующие действия:

1.  Ожидает, пока все образцы в очереди не будут удалены.
2.  Освобождает все буферизованные данные. Иногда этот шаг можно выполнить в методе **бегинфлуш** . Однако **бегинфлуш** не синхронизируется с потоком потоковой передачи. Фильтр не должен обрабатывать или буферизовать дополнительные данные между вызовом **бегинфлуш** и вызовом **ендфлуш**.
3.  Удаляет все ожидающие \_ уведомления EC о завершении.
4.  Вызывает **ендфлуш** .

На этом этапе фильтр может снова принять выборки. Все выборки гарантированно будут более новыми, чем очистка.

В модели извлечения фильтр анализатора запускает очистку, а не фильтр источника. Он не только вызывает **Ипин:: бегинфлуш** и **Ипин:: ендфлуш** в подчиненном фильтре, но также вызывает [**Иасинкреадер:: Бегинфлуш**](/windows/desktop/api/Strmif/nf-strmif-iasyncreader-beginflush) и [**иасинкреадер:: ендфлуш**](/windows/desktop/api/Strmif/nf-strmif-iasyncreader-endflush) на *выходном* контактном фильтре источника. Если фильтр источника имеет ожидающие запросы на чтение, то он будет удален.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Очистка данных](flushing-data.md)
</dt> </dl>

 

 



