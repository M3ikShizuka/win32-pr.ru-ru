---
description: Исходные и целевые прямоугольники в модулях подготовки видео
ms.assetid: fdddbffb-c44f-4364-9e2e-b721ba39c74f
title: Исходные и целевые прямоугольники в модулях подготовки видео
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 556aea6aad22e5ea6df61c74ed0a46d2e3984d67
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/06/2021
ms.locfileid: "104537556"
---
# <a name="source-and-target-rectangles-in-video-renderers"></a>Исходные и целевые прямоугольники в модулях подготовки видео

В структурах форматов видео [**видеоинфо**](/previous-versions/windows/desktop/api/amvideo/ns-amvideo-videoinfo), [**видеоинфохеадер**](/previous-versions/windows/desktop/api/amvideo/ns-amvideo-videoinfoheader)и [**VIDEOINFOHEADER2**](/previous-versions/windows/desktop/api/dvdmedia/ns-dvdmedia-videoinfoheader2) есть три размера. В этой статье объясняется, что они представляют, и как они работают.

Во-первых, в этих структурах имеется размер **бмихеадер** . Элемент **бмихеадер** представляет собой структуру [**битмапинфохеадер**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfoheader) с собственными элементами Width и Height, **бмихеадер. бивидс** и **бмихеадер. бихеигхт**.

Во-вторых, в элементе **рксаурце** этих структур есть прямоугольник. и наконец, в элементе **рктаржет** этих структур есть прямоугольник.

Предположим, что у вас есть два фильтра: A и B, и что эти фильтры соединены друг с другом (слева или вверх, а б — в правой или нисходящей) с определенным типом видеоклипа.

Буферы, которые проходят между фильтрами A и B, имеют размер (**бмихеадер. бивидс**, **бмихеадер. бихеигхт**). Фильтр должен принимать часть входного видео, определенную **рксаурце** , и растягивать его для заполнения **рктаржет** части буфера. Часть входного видео, используемая для использования, зависит от того, как **рксаурце** сравнивается с размером (**бивидс**, **бихеигхт**) типа носителя, который фильтрует A и B в первоначальном соединении с. Если **рксаурце** является пустым, то фильтр A использует все входное видео. Если **рктаржет** является пустым, фильтр заполняет весь выходной буфер.

Например, пусть фильтр A получает данные видео, 160 x 120 пикселей. Предположим также, что фильтр A подключен к фильтру б со следующим типом носителя.

-   (**бивидс**, **бихеигхт**): 320, 240
-   **рксаурце**: (0, 0, 0, 0)
-   **рктаржет**: (0, 0, 0, 0)

Это означает, что фильтр будет растягивать видео, получаемое по 2 в направлениях x и y, и заполнить выходной буфер 320 x 240.

В качестве другого примера предположим, что фильтр A получает видео-данные 160 x 120 и подключен к фильтру B со следующим типом носителя.

-   (**бивидс**, **бихеигхт**): 320, 240
-   **рксаурце**: (0, 0, 160, 240)
-   **рктаржет**: (0, 0, 0, 0)

Элемент **рксаурце** задается относительно размера подключенного буфера 320, 240. Так как указанный **рксаурце** (0, 0, 160, 240) — левая половина буфера, фильтр A примет левую половину его входного видео или часть (0, 0, 80, 120) и растягивает видео до размера (320, 240) (на 4 в направлении x и на 2 в направлении по оси y) и заполнит буфер вывода 320 x 240.

Теперь предположим, что фильтру A вызывает [**кбасеаллокатор::-buffer**](cbaseallocator-getbuffer.md), а возвращаемый пример носителя имеет присоединенный к нему тип мультимедиа, что означает, что фильтр б хочет фильтровать A, чтобы предоставить другой размер или тип видео, чем было предоставлено ранее. Предположим, что новый тип носителя:

-   (**бивидс**, **бихеигхт**): 640, 480
-   **рксаурце**: (0, 0, 160, 120)
-   **рктаржет**: (0, 0, 80, 60)

Это означает, что пример носителя имеет буфер размером 640 x 480. Элемент **рксаурце** относится к исходному подключенному типу носителя (320, 240), а не к новому типу носителя (640, 480), поэтому **рксаурце** указывает, что левый верхний угол (25%) входного видео для использования. Эта часть входного видео помещается в верхнюю левую (80, 60) пикселях выходного буфера 640 x 480, как указано в **рктаржет** (0, 0, 80, 60). Поскольку фильтр A получает видео 160 x 120, левый верхний угол входного видео — это элемент (80, 60), тот же размер выходного растрового изображения и не требуется растяжение.

Фильтр не помещает данные в другие Пиксели выходного буфера и оставляет эти биты нетронутыми. Элемент **рксаурце** ограничен **бивидс** и **бихеигхт** исходного типа подключенного носителя между фильтрами A и B, а **рктаржет** ограничен новыми **бивидс** и **бихеигхт** в примере носителя. В предыдущем примере **рксаурце** не удалось выйти за пределы границ (0, 0, 320, 240), и **рктаржет** не удалось выйти за пределы границ (0, 0, 640, 480).

 

 



