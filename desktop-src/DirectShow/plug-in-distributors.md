---
description: Распространители подключаемых модулей
ms.assetid: 80ff713d-f704-40d3-9317-cbf33d932207
title: Распространители подключаемых модулей
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f7817e5e31b29444cc596b0be583be2198adc018
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/06/2021
ms.locfileid: "105682234"
---
# <a name="plug-in-distributors"></a>Распространители подключаемых модулей

Подключаемые модули распространителей (PID) позволяют расширить функциональные возможности диспетчера графа фильтров. Подключаемый модуль распространителя — это COM-объект, который выполняет статистическую обработку диспетчером графов фильтра во время выполнения. Приложения получают доступ к PID с помощью диспетчера графа фильтров.

Когда диспетчер графов фильтров запрашивает интерфейс, который он не поддерживает, он выполняет поиск раздела в реестре в следующем формате:


```C++
HKEY_CLASSES_ROOT\Interface\IID\Distributor
```



`IID` Строка, содержащая идентификатор интерфейса. Если запись реестра существует, значение записи определяет идентификатор класса (CLSID) PID, который поддерживает интерфейс. Диспетчер графов фильтров выполняет статистическое вычисление PID и возвращает указатель интерфейса, который выступает в роли внешнего **IUnknown** для PID. Когда приложение вызывает методы интерфейса, оно фактически вызывает их в PID. Тем не менее существование идентификатора процесса является прозрачным для приложения.

Термин *распространитель* основан на том, что PID может запрашивать внешний указатель **IUnknown** для интерфейсов в диспетчере графов фильтров. Вызывая метод [**ифилтерграф:: енумфилтерс**](/windows/desktop/api/Strmif/nf-strmif-ifiltergraph-enumfilters) , PID может перечислить фильтры в графе и распределить вызовы методов к этим фильтрам. Таким образом, PID может служить одной контрольной точкой, чтобы приложение вызывало методы для фильтров.

Когда диспетчер графов фильтров выполняет статистическое вычисление PID, он запрашивает идентификатор процесса для интерфейса [**идистрибуторнотифи**](/windows/desktop/api/Strmif/nn-strmif-idistributornotify) . Если идентификатор процесса поддерживает этот интерфейс, диспетчер графа фильтров использует его для уведомления PID об изменениях в графе:

-   Когда граф фильтра переключается между запусками, приостановленными и остановленными состояниями, он вызывает [**идистрибуторнотифи:: Run**](/windows/desktop/api/Strmif/nf-strmif-idistributornotify-run), [**идистрибуторнотифи::P Аусе**](/windows/desktop/api/Strmif/nf-strmif-idistributornotify-pause)или [**идистрибуторнотифи:: остановка**](/windows/desktop/api/Strmif/nf-strmif-idistributornotify-stop).
-   Если задано значение ссылочного времени, диспетчер графа фильтров вызывает [**идистрибуторнотифи:: сетсинксаурце**](/windows/desktop/api/Strmif/nf-strmif-idistributornotify-setsyncsource).
-   Когда фильтры добавляются или удаляются, или закрепление соединений изменяется, диспетчер графа фильтров вызывает [**идистрибуторнотифи:: нотифиграфчанже**](/windows/desktop/api/Strmif/nf-strmif-idistributornotify-notifygraphchange).

Чтобы реализовать пользовательский идентификатор процесса, создайте COM-объект, поддерживающий агрегирование. Он должен поддерживать интерфейс, который диспетчер графов фильтров еще не поддерживает. При необходимости он может поддерживать интерфейс **идистрибуторнотифи** .

Если идентификатор процесса получает указатели интерфейса от диспетчера графа фильтров, он должен немедленно освободить их. В противном случае он может создать циклическое число ссылок, которое может препятствовать удалению диспетчера графов фильтров. Наличие счетчика ссылок в диспетчере графов фильтров не требуется в любом случае, поскольку диспетчер графа фильтров управляет временем существования PID.

Так как PID разработан специально для агрегирования диспетчером графа фильтров, может потребоваться применить его в методе конструктора PID. Проверьте, имеет ли  внешний указатель IUnknown **значение NULL**, и, если да, возвращайте код ошибки VFW \_ E " \_ требуется \_ владелец". (См. раздел [коды ошибок и успешности](error-and-success-codes.md).) Кроме того, чтобы предотвратить агрегирование PID другими объектами, можно запросить внешний указатель **IUnknown** для интерфейса [**играфбуилдер**](/windows/desktop/api/Strmif/nn-strmif-igraphbuilder) . Возвращает код ошибки, если объект не предоставляет **играфбуилдер**.

 

 



