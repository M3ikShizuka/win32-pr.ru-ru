---
description: Данные DV в формате AVI
ms.assetid: ae1ec184-afc3-4ec1-9b92-f53656293446
title: Данные DV в формате AVI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 65f1393bfe4bbee4d080d90755f33cfa7f4a7fa4
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/06/2021
ms.locfileid: "104495546"
---
# <a name="dv-data-in-the-avi-file-format"></a>Данные DV в формате AVI

Корпорация Майкрософт указала формат хранения данных цифрового видео (DV) в AVI-файлах. Соответствие этой спецификации обеспечит совместимость файлов AVI, созданных в этом формате, с будущими версиями архитектуры Digital Video для Виндовсплатформ.

В этой статье описывается формат файлов AVI, содержащих данные DV. Определенные Фаурккс (коды из четырех символов) для потоков с чередованием DV и DV Streaming/декомпрессора. Структура формата потока для DV-данных определена. Указаны два способа хранения данных DV в формате AVI.

Предполагается, что читатель знаком с форматом данных DV. (Этот формат определяется в *спецификации цифровой видеомагнитофона*, также называемой синей книгой.)

Существует два типа видеофайлов в формате AVI: AVI-файлы, которые содержат один поток данных DV, называемый файлами *типа 1* ; и AVI-файлы, содержащие DV-видео в виде потока VID и DV Audio как потоки "аудс", называются файлами *типа 2* .

**AVI-файлы, содержащие один поток данных DV (тип 1)**

Чередующиеся DV-данные могут храниться в собственном формате в виде одного потока в файле AVI Metallica. Это имеет преимущество использования минимального объема хранилища данных для DV. Основное недостатком является то, что этот формат файла не обратно совместим с видео для Windows, так как он не содержит видео «VID» или «аудс». Поддержка обеспечивается для потока с чередованием DV с использованием видеофильтров [DV мультиплексор](dv-muxer-filter.md) и [DV](dv-splitter-filter.md) , поставляемых с DirectShow.

DV-данные могут храниться в одном потоке в файле AVI Metallica путем указания иавс (с чередованием аудио-и видеопотоков) FOURCC (код с четырьмя символами) в элементе **фкктипе** , а также любого из двхд в элементе **двсл** в фрагменте заголовка потока фаурккс. Количество кадров в секунду для потока видео должно быть указано в элементах **дврате** и **двскале** , а общее число видеоблоков в блоке "Мови" в элементе **двленгс** .

Обработчик потока "двсд" FOURCC указывает, что данные DV определены в части 2 *спецификации цифровых видеомагнитофонов*. Видео имеет формат 525 строк с частотой 29,97 Гц (525-60) или 625 строки с частотой 25,00 Гц (625-50).

Обработчик потока "двхд" FOURCC указывает, что данные DV определены в части 3 *спецификации цифровых видеомагнитофонов*. Видео имеет формат 1125 строк с частотой 30,00 Гц (1125-60) или 1250 строки с частотой 25,00 Гц (1250-50).

Обработчик потока "двсл" FOURCC указывает, что данные DV определены в части 6 *спецификации цифровых видеомагнитофонов*. Видео имеет формат SD (Security) с высоким уровнем сжатия (SDL).

> [!Note]  
> Оставшаяся часть этой статьи содержит определения для потоков "двсд".

 

После фрагмента заголовка потока должен следовать фрагмент формата потока [**двинфо**](/windows/desktop/api/strmif/ns-strmif-dvinfo) .

Фактические данные DV хранятся \# \# в виде фрагментов "DC" в блоке "Мови" ( \# \# в формате представляет идентификатор потока). Каждый блок содержит один кадр данных: 10 или 12 цифр DV DIF для систем 525-60 или 625-50 соответственно. Формат последовательности DIF DV SD (' двсд '), определяемый в части 2 *спецификации цифровой видеомагнитофона*.

В следующем примере показана форма AIFF Metallica для файла AVI с одним потоком данных DV, развернутой с помощью завершенных фрагментов заголовка.


```C++
00000000 RIFF (0FAE35D4) 'AVI '
0000000C     LIST (00000106) 'hdrl'
00000018         avih (00000038)
                     dwMicroSecPerFrame    : 33367
                     dwMaxBytesPerSec      : 3728000
                     dwPaddingGranularity  : 0
                     dwFlags               : 0x810 HASINDEX | TRUSTCKTYPE
                     dwTotalFrames         : 2192
                     dwInitialFrames       : 0
                     dwStreams             : 1
                     dwSuggestedBufferSize : 120000
                     dwWidth               : 720
                     dwHeight              : 480
                     dwReserved            : 0x0
00000058         LIST (0000006C) 'strl'
00000064             strh (00000038)
                         fccType               : 'iavs'
                         fccHandler            : 'dvsd'
                         dwFlags               : 0x0
                         wPriority             : 0
                         wLanguage             : 0x0 undefined
                         dwInitialFrames       : 0
                         dwScale               : 100 (29.970 Frames/Sec)
                         dwRate                : 2997
                         dwStart               : 0
                         dwLength              : 2192
                         dwSuggestedBufferSize : 120000
                         dwQuality             : 0
                         dwSampleSize          : 0
                         rcFrame               : 0,0,720,480
000000A4             strf (00000020)
                         dwDVAAuxSrc     : 0x........
                         dwDVAAuxCtl     : 0x........
                         dwDVAAuxSrc1    : 0x........
                         dwDVAAuxCtl1    : 0x........
                         dwDVVAuxSrc     : 0x........
                         dwDVVAuxCtl     : 0x........
                         dwDVReserved[2] : 0,0
000000CC     LIST (0FADAC00) 'movi'
0FADACD4     idx1 (00008900)
```



**AVI-файлы, содержащие видеопотоки DV и DV Audio (тип 2)**

Чередующиеся DV-данные можно разделить на видеопоток, а один — на четыре звуковых потока в файле AVI Metallica. Это имеет преимущество обратной совместимости с видео для Windows, так как оно содержит поток стандартного видео "VID" и, по крайней мере, один стандартный поток звука "аудс", основной недостаток заключается в том, что этот формат файла требует, чтобы аудиоданные были избыточно сохранены в виде звуковых потоков. Поток "Video" фактически является машинным потоком данных с чередованием. Однако в качестве стандартного потока VID с типом обработчика "двсд" используется [видеодекодер DV](dv-video-decoder-filter.md) . Этот формат также требует использования фильтра [разделителя DV](dv-splitter-filter.md) для разбиения "записанных" файлов перед их записью в виде AVI.

DV-данные могут храниться в виде видеопотока с отдельным числом звуковых потоков в файле AVI Metallica. Поток видео указывается с помощью заголовка стандартного видеопотока (значение элемента **фкктипе** — "VID"). Элемент **фкчандлер** указан как "двсд", "двхд" или "двсл". Количество кадров в секунду для потока видео должно быть указано в элементах **дврате** и **двскале** , а общее число видеоблоков в блоке "Мови" в элементе **двленгс** .

В этом файле AVI, который содержит DV-видео в виде потока VID и DV Audio в виде потоков "аудс" DV, фрагмент формата видеопотока является стандартной структурой [**битмапинфохеадер**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfoheader) . Фрагмент формата потока можно дополнительно расширить для включения фрагмента [**двинфо**](/windows/desktop/api/strmif/ns-strmif-dvinfo) , увеличивая размер фрагмента в формате потока от 40 байт (размер структуры **битмапинфохеадер** ) до 72 байт (размер **битмапинфохеадер** плюс **двинфо** структуры) и сразу после структуры данных **битмапинфохеадер** с помощью структуры данных **двинфо** .

Аудио-поток (ы) указан со стандартным заголовком аудиопотока (значение элемента **фкктипе** — "аудс"). Элемент **фкчандлер** не используется для звуковых потоков.

Видеоданные DV хранятся в виде \# \# фрагментов "DC", как определено в предыдущем ОПИСАНии AVI-файла с одной DV-видеоданными, а звуковые данные хранятся в виде \# \# фрагментов "WB" в блоке "Мови".

> [!Note]  
> *Спецификация цифровой видеомагнитофона* может быть недоступна в некоторых языках и странах.

 

В следующем примере показана форма AIFF Metallica для AVI-файла, содержащего DV-видео в виде потока VID и DV Audio в виде потоков "аудс", развернутых с помощью завершенных фрагментов заголовка (включая дополнительные данные [**двинфо**](/windows/desktop/api/strmif/ns-strmif-dvinfo) , следующие за [**битмапинфо**](/windows/win32/api/wingdi/ns-wingdi-bitmapinfo) во вложенном фрагменте "стрф" для потока "VID").


```C++
00000000 RIFF (103E2920) 'AVI '
0000000C     LIST (00000146) 'hdrl'
00000018         avih (00000038)
                     dwMicroSecPerFrame    : 33367
                     dwMaxBytesPerSec      : 3728000
                     dwPaddingGranularity  : 0
                     dwFlags               : 0x810 HASINDEX | TRUSTCKTYPE
                     dwTotalFrames         : 2192
                     dwInitialFrames       : 0
                     dwStreams             : 2
                     dwSuggestedBufferSize : 120000
                     dwWidth               : 720
                     dwHeight              : 480
                     dwReserved            : 0x0
00000058         LIST (00000094) 'strl'
00000064             strh (00000038)
                         fccType               : 'vids'
                         fccHandler            : 'dvsd'
                         dwFlags               : 0x0
                         wPriority             : 0
                         wLanguage             : 0x0 undefined
                         dwInitialFrames       : 0
                         dwScale               : 100 (29.970 Frames/Sec)
                         dwRate                : 2997
                         dwStart               : 0
                         dwLength              : 2192
                         dwSuggestedBufferSize : 120000
                         dwQuality             : 0
                         dwSampleSize          : 0
                         rcFrame               : 0,0,720,480
000000A4             strf (00000048)
                         biSize          : 40
                         biWidth         : 720
                         biHeight        : 480
                         biPlanes        : 1
                         biBitCount      : 24
                         biCompression   : 0x64737664 'dvsd'
                         biSizeImage     : 120000
                         biXPelsPerMeter : 0
                         biYPelsPerMeter : 0
                         biClrUsed       : 0
                         biClrImportant  : 0
                         dwDVAAuxSrc     : 0x........
                         dwDVAAuxCtl     : 0x........
                         dwDVAAuxSrc1    : 0x........
                         dwDVAAuxCtl1    : 0x........
                         dwDVVAuxSrc     : 0x........
                         dwDVVAuxCtl     : 0x........
                         dwDVReserved[2] : 0,0
000000F4         LIST (0000005E) 'strl'
00000100             strh (00000038)
                         fccType               : 'auds'
                         fccHandler            : '    '
                         dwFlags               : 0x0
                         wPriority             : 0
                         wLanguage             : 0x0 undefined
                         dwInitialFrames       : 0
                         dwScale               : 1 (32000.000 Samples/Sec)
                         dwRate                : 32000
                         dwStart               : 0
                         dwLength              : 2340474
                         dwSuggestedBufferSize : 4272
                         dwQuality             : 0
                         dwSampleSize          : 4
                         rcFrame               : 0,0,0,0
00000140             strf (00000012)
                         wFormatTag      : 1 PCM
                         nChannels       : 2
                         nSamplesPerSec  : 32000
                         nAvgBytesPerSec : 128000
                         nBlockAlign     : 4
                         wBitsPerSample  : 16
                         cbSize          : 0
00000814     LIST (103D0EF4) 'movi'
103D1710     idx1 (00011210)
```



## <a name="related-topics"></a>См. также

<dl> <dt>

[Формат файла AVI](avi-file-format.md)
</dt> </dl>

 

 
