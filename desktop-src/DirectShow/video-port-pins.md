---
description: ПИН-коды порта видео
ms.assetid: a6be24e5-7937-48f1-abeb-3f29c3deeafd
title: ПИН-коды порта видео
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4d13ab4ad63995dd38460bf29064035c9c1802dc
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "103911052"
---
# <a name="video-port-pins"></a>ПИН-коды порта видео

Устройство записи с видеопортом оборудования может использовать расширения видеопортов (впе) в Microsoft® DirectX®. Если да, то фильтр записи будет иметь ПИН-код для порта видео (президента). Данные видео не передаются с закрепления вице-президента через граф фильтра. Вместо этого видеокадры создаются на оборудовании и отправляются непосредственно в видеопамять. ПИН-код президента позволяет отправлять управляющие сообщения на оборудование.

Важно подключить ПИН-код президента, даже если приложение выполняет только запись файлов без предварительной версии. Если оставить ПИН-код неподключенным, граф будет работать неправильно. Это отличается от предварительного просмотра ПИН-кодов, которые не должны быть подключены.

Различные модули подготовки видео DirectShow обеспечивают разную поддержку ПИН-кодов вице-президента:

-   Модуль подготовки видео. Подключите ПИН-код президента, чтобы закрепить 0 в фильтре [микшера наложения](overlay-mixer-filter.md) , и подключите Фильтр микшера наложения к модулю подготовки видео.
-   VMR-7. подключение к фильтру [диспетчера видеопортов](video-port-manager.md) и подключение диспетчера видеопортов к фильтру VMR-7.
-   VMR-9. Вы не можете использовать VMR-9, если у устройства есть свой вице-президент, так как Direct3D 9 не поддерживает видеопорты. Используйте модуль подготовки видео или VMR-7.

Для сценариев видеопортов рекомендуется использовать микшер наложения и модуль подготовки видео для диспетчера видеопортов и VMR-7, так как не все драйверы поддерживают диспетчер видеопортов. Как правило, микшер наложения является наиболее надежным вариантом для видеопортов.

Метод [**ICaptureGraphBuilder2:: RenderStream**](/windows/desktop/api/Strmif/nf-strmif-icapturegraphbuilder2-renderstream) автоматически вставляет микшер оверлея при наличии ПИН-кода президента. Если вы создаете граф без использования этого метода, проверьте ПИН-код видеопорта в фильтре записи и, если он существует, подключите его к фильтру микшера наложения, как показано на следующей схеме.

![Подключение ПИН-кода к видеопорту к фильтру микшера наложения.](images/vidcap11.png)

Для поиска ПИН-кода президента в фильтре записи можно использовать метод [**ICaptureGraphBuilder2:: финдпин**](/windows/desktop/api/Strmif/nf-strmif-icapturegraphbuilder2-findpin) :


```C++
hr = pBuild->FindPin(
    pCap,                    // Pointer to the capture filter.
    PINDIR_OUTPUT,           // Look for an output pin.
    &PIN_CATEGORY_VIDEOPORT, // Look for a video port pin.
    NULL,                    // Any media type.
    FALSE,                   // Pin can be connected.
    0,                       // Retrieve the first matching pin.
    &pVPPin                  // Receives a pointer to the pin.
);
```



После добавления микшера наложения на граф вызовите **финдпин** еще раз, чтобы найти ПИН-код 0 в микшере наложения. ПИН-код 0 всегда является первым входным закреплением фильтра.


```C++
pBuild->FindPin(pOvMix, PINDIR_INPUT, NULL, NULL, TRUE, 0, &pOVPin);
```



Соедините два контакта, вызвав [**играфбуилдер:: Connect**](/windows/desktop/api/Strmif/nf-strmif-igraphbuilder-connect).


```C++
pGraph->Connect(pVPPin, pOvPin);
```



Затем подключите выходное крепление микшера наложения к фильтру модуля подготовки видео. Видео можно скрыть, вызвав методы [**ивидеовиндов::p UT \_ автоотображения**](/windows/desktop/api/Control/nf-control-ivideowindow-put_autoshow) и [**ивидеовиндов::P UT \_ Visible**](/windows/desktop/api/Control/nf-control-ivideowindow-put_visible) в диспетчере графов фильтров.

Для ТВ-тюнеров фильтр записи может также иметь ВБИ PIN (закрепить \_ категорию \_ видеопорт \_ ВБИ). Если да, подключите этот ПИН-код к фильтру [распределителя ВБИ Surface](vbi-surface-allocator.md) . Дополнительные сведения см. в разделе [Просмотр скрытых субтитров](viewing-closed-captions.md).

## <a name="related-topics"></a>См. также

<dl> <dt>

[Разделы, посвященные расширенному записи](advanced-capture-topics.md)
</dt> <dt>

[Использование микшера наложения в видеозаписи](using-the-overlay-mixer-in-video-capture.md)
</dt> </dl>

 

 



