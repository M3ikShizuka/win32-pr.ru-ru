---
description: Сбор сведений о Fine-Tuning
ms.assetid: 0d9ea896-e0a9-411b-9a10-e366e3686a34
title: Сбор сведений о Fine-Tuning
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 27d191f677acc9306202bce141ef8f6683b43c61
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/06/2021
ms.locfileid: "105662015"
---
# <a name="collecting-fine-tuning-information"></a>Сбор сведений о Fine-Tuning

Несмотря на то, что частоты кабелей обычно должны быть точными, частота широковещательной передачи может быть увеличена или снижена на несколько кГц на станции вещания, чтобы снизить потенциальные помехи с соседними каналами.

Когда фильтр ТВ-тюнера подстраивается к каналу, он сканирует наиболее точный сигнал. Чтобы сохранить эти сведения в реестре для последующих операций настройки, выполните следующие действия.

1.  Вызовите [**иамтунер:: чаннелминмакс**](/windows/desktop/api/Strmif/nf-strmif-iamtuner-channelminmax) , чтобы определить диапазон частотных записей в текущей таблице частоты.
2.  Вызовите метод [**иамтунер::p \_ UT**](/windows/desktop/api/Strmif/nf-strmif-iamtuner-put_channel) один раз для каждого индекса частоты в диапазоне.
3.  Вызовите метод [**иамтвтунер:: стореаутотуне**](/windows/desktop/api/Strmif/nf-strmif-iamtvtuner-storeautotune) , чтобы сохранить сведения о точной настройке в реестре. Сведения хранятся в разделе реестра для текущего пространства настройки.

В следующем коде показаны следующие шаги.


```C++
long lMin = 0, lMax = 0;
hr = pTuner->ChannelMinMax(&lMin, &lMax);
if (SUCCEEDED(hr))
{
    for (long i = lMin; i <= lMax; i++)
    {
        pTuner->put_Channel(i, AMTUNER_SUBCHAN_DEFAULT,
            AMTUNER_SUBCHAN_DEFAULT)
    }
    pTuner->StoreAutoTune();
}
```



В более ранних версиях фильтра ТВ-тюнера для точной настройки рекомендуется метод [**иамтвтунер:: автонастройка**](/windows/desktop/api/Strmif/nf-strmif-iamtvtuner-autotune) . Однако этот метод игнорирует любые переопределения частоты, поэтому его использование больше не рекомендуется. Следующий код эквивалентен методу **автонастройки** , но правильно работает с переопределениями частоты:


```C++
HRESULT MyAutoTune(IAMTVTuner *pTuner, long lIndex, long *plFoundSignal)
{
    long SignalStrength = AMTUNER_NOSIGNAL;
    HRESULT hr;
    hr = pTuner->put_Channel(lIndex, AMTUNER_SUBCHAN_DEFAULT, AMTUNER_SUBCHAN_DEFAULT);
    if (NOERROR == hr)
        pTuner->SignalPresent(&SignalStrength);
    *plFoundSignal = (SignalStrength != AMTUNER_NOSIGNAL);
        return hr;
}
```



При получении широковещательной рассылки не всегда можно получить горизонтальную блокировку, хотя изображение отображается. В этих случаях оборудование тюнера будет иметь частотную блокировку, но декодер не будет иметь горизонтальную блокировку. Это условие может быть обнаружено при использовании метода [**размещения \_ канала**](/windows/desktop/api/Strmif/nf-strmif-iamtuner-put_channel) или [**автонастройки**](/windows/desktop/api/Strmif/nf-strmif-iamtvtuner-autotune) с помощью проверки кода возврата.



| Значение    | Описание                                                                                                                                                                               |
|----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| \_ОК    | Операция настройки прошла удачно, и тюнер получил блокировку частоты.                                                                                                                          |
| S \_ false | Во время операции настройки ошибки не возникали, но тюнеру не удалось получить частоту блокировки. Очень маловероятно, что в результате выполнения этой операции отображается отображаемый канал. |



 

Любой другой код возврата указывает на то, что произошла ошибка.

Возвращаемое значение \_ ОК не гарантирует, что декодер будет горизонтальной блокировкой. Метод [**автонастройки**](/windows/desktop/api/Strmif/nf-strmif-iamtvtuner-autotune) обновляет параметр *фаундсигнал* , чтобы указать, была ли достигнута горизонтальная блокировка. Метод [**иамтунер:: сигналпресент**](/windows/desktop/api/Strmif/nf-strmif-iamtuner-signalpresent) возвращает одну и ту же информацию.

Однако если возвращаемое значение — S \_ (ОК), приложение может пропустить параметр *фаундсигнал* , так как этот тюнер сообщает о частоте блокировки. Существует вероятность того, что на помехах будет блокироваться частота, но эту возможность следует взвесить на возможность пропуска просматриваемых каналов.

## <a name="registry-conversion"></a>Преобразование реестра

Для поддержки переопределений частоты внутренний формат раздела реестра, содержащего сведения о тонкой настройке, изменился. Исходный формат по-прежнему поддерживается для обратной совместимости, но не поддерживает переопределения частоты.

Старый формат реестра преобразуется в новый формат всякий раз, когда вызывается метод [**иамтвтунер:: стореаутотуне**](/windows/desktop/api/Strmif/nf-strmif-iamtvtuner-storeautotune) . Если приложение добавляет переопределения частоты, оно должно вызывать метод **стореаутотуне** для преобразования в новый формат реестра. Перед вызовом **стореаутотуне** не нужно сохранять сведения о точной настройке.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Международная Настройка аналогового ТВ](international-analog-tv-tuning.md)
</dt> </dl>

 

 



