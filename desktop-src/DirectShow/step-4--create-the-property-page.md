---
description: Реализуйте страницу свойств как часть создания страницы свойств фильтра для настраиваемого фильтра DirectShow.
ms.assetid: ed71f26b-0812-4be8-96a4-b9f5dde45540
title: Шаг 4. Создание страницы свойств
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d32cd9eacc98af5f273897a3837390ab5cc75f7a
ms.sourcegitcommit: 5d4e99f4c8f42f5f543e52cb9beb9fb13ec56c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/19/2021
ms.locfileid: "112406857"
---
# <a name="step-4-create-the-property-page"></a>Шаг 4. Создание страницы свойств

На этом этапе фильтр поддерживает все, что требуется для страницы свойств. Следующим шагом является реализация самой страницы свойств. Начните с создания производного класса от **кбасепропертипаже**. В следующем примере показана часть объявления, включающая некоторые переменные закрытых членов, которые будут использоваться далее в примере:


```C++
class CGrayProp : public CBasePropertyPage
{
private:
    ISaturation *m_pGray;    // Pointer to the filter's custom interface.
    long        m_lVal       // Store the old value, so we can revert.
    long        m_lNewVal;   // New value.
public:
    /* ... */
};
```



Затем создайте ресурс диалогового окна в редакторе ресурсов, а также строковый ресурс для заголовка диалогового окна. Строка будет отображаться на вкладке страницы свойств. Эти два идентификатора ресурсов являются аргументами для конструктора **кбасепропертипаже** :


```C++
CGrayProp::CGrayProp(IUnknown *pUnk) : 
  CBasePropertyPage(NAME("GrayProp"), pUnk, IDD_PROPPAGE, IDS_PROPPAGE_TITLE),
  m_pGray(0)
{ }
```



На следующем рисунке показан ресурс диалогового окна для страницы «пример свойства».

![диалоговое окно страницы свойств](images/proppage.png)

Теперь все готово для реализации страницы свойств. Ниже приведены методы переопределения **кбасепропертипаже** .

-   **OnConnect** вызывается, когда клиент создает страницу свойств. Он задает для фильтра указатель **IUnknown** .
-   **OnActivate** вызывается при создании диалогового окна.
-   **Онрецеивемессаже** вызывается, когда диалоговое окно получает сообщение окна.
-   **Онаппличанжес** вызывается, когда пользователь фиксирует изменения свойства, нажав кнопку **ОК** или **Применить** .
-   **Ondisconnectие** вызывается, когда пользователь закрывает страницу свойств.

В оставшейся части этого руководства описывается каждый из этих методов.

Далее. [Шаг 5. Сохранить указатель на фильтр](step-5--store-a-pointer-to-the-filter.md).

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Создание страницы свойств фильтра](creating-a-filter-property-page.md)
</dt> </dl>

 

 



