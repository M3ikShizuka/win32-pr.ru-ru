---
description: Можно использовать установщик Windows для обнаружения отсутствующих компонентов или файлов, а затем переустановить компоненты, содержащие отсутствующие компоненты.
ms.assetid: b197c9d0-fcc2-4ca7-a870-e1af82343455
title: Установка отсутствующего компонента
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c9bbfd38517e850a7f4e83c9c84075d92fea2290
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105650696"
---
# <a name="installing-a-missing-component"></a>Установка отсутствующего компонента

Можно использовать установщик Windows для обнаружения отсутствующих компонентов или файлов, а затем переустановить компоненты, содержащие отсутствующие компоненты. Поскольку установщик устанавливает компоненты, а не компоненты, сначала необходимо разрешить компоненту, к которому принадлежит отсутствующий файл, а затем установить компонент, содержащий этот компонент. Если с компонентом связана несколько компонентов, установщик устанавливает компонент, требующий наименьшего места на диске.

При вызове [**мсижеткомпонентпас**](/windows/desktop/api/Msi/nf-msi-msigetcomponentpatha)можно проверить наличие файла ключа компонента. Однако по-прежнему могут отсутствовать другие файлы, принадлежащие компоненту. В этом сценарии вызовите [**мсиинсталлмиссингфиле**](/windows/desktop/api/Msi/nf-msi-msiinstallmissingfilea). Затем установщик разрешается в тот компонент, которому принадлежит файл, и устанавливает компонент, связанный с компонентом, для которого требуется наименьшее место на диске.

Если функция [**мсижеткомпонентпас**](/windows/desktop/api/Msi/nf-msi-msigetcomponentpatha) неожиданно завершается сбоем, необходимо установить все отсутствующие компоненты.

В следующей процедуре показано, как установить недостающие компоненты.

**Обнаружение и установка отсутствующего компонента**

1.  Вызовите [**мсижеткомпонентпас**](/windows/desktop/api/Msi/nf-msi-msigetcomponentpatha) , чтобы убедиться в наличии файла ключа компонента. Однако даже если файл ключа компонента существует, все равно возможно, что отсутствуют другие файлы, принадлежащие компоненту.
2.  Если компонент, связанный с компонентом, неизвестен, вызовите функцию [**мсиинсталлмиссингкомпонент**](/windows/desktop/api/Msi/nf-msi-msiinstallmissingcomponenta) .
3.  Если функция, связанная с компонентом, известна, вызовите функцию [**мсиконфигурефеатуре**](/windows/desktop/api/Msi/nf-msi-msiconfigurefeaturea) или [**мсипровидекомпонент**](/windows/desktop/api/Msi/nf-msi-msiprovidecomponenta) .
4.  Вызовите [**мсиинсталлмиссингфиле**](/windows/desktop/api/Msi/nf-msi-msiinstallmissingfilea) , если приложению не удается открыть файл.

 

 



