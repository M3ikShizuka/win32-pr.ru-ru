---
description: Метод Форматрекорд объекта Session возвращает форматированную строку из шаблона и данные записи.
ms.assetid: 2018ac75-ea18-4256-8d56-0527069ce24b
title: Session. Форматрекорд, метод
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- Session.FormatRecord
api_type:
- COM
api_location:
- Msi.dll
ms.openlocfilehash: f58aabc0bd222b22ee74cb0b431ce8051ed6bad546d963160c922bd86dee2383
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119629154"
---
# <a name="sessionformatrecord-method"></a>Session. Форматрекорд, метод

Метод **форматрекорд** объекта [**Session**](session-object.md) Возвращает форматированную строку из шаблона и данные записи.

## <a name="syntax"></a>Синтаксис


```JScript
Session.FormatRecord(
  record
)
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*record* 
</dt> <dd>

Обязательный объект **Record** , содержащий шаблон и данные для форматирования. Строка шаблона должна быть задана в поле 0, за которым следуют все параметры данных, на которые указывают ссылки.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Этот метод не возвращает значение.

## <a name="remarks"></a>Remarks

Метод **форматрекорд** использует следующий процесс форматирования.

Параметры для [форматирования](formatted.md) заключаются в квадратные скобки \[ .. \] . Можно выполнить итерацию квадратных скобок, так как подстановки разрешаются из внутренней области.

Если часть строки заключена в фигурные скобки {} и не содержит квадратных скобок, часть остается без изменений, включая фигурные скобки.

Если часть строки заключена в фигурные скобки и содержит одно или несколько имен свойств, и если все свойства найдены, текст (с разрешенными подстановками) отображается без фигурных скобок. Если какое бы то ни было свойство не найдено, все тексты фигурных скобок и фигурных скобок удаляются.

**Форматирование строк с помощью метода Форматрекорд**

1.  Числовые параметры заменяются путем замены маркера значением соответствующего поля записи с отсутствующими или нулевыми значениями, не создающими никакого текста.
2.  Строка, которая обрабатывается в результате замены параметров, не относящихся от записи, соответствующими значениями, как указано в следующих описаниях.
    -   Если обнаружена подстрока формы « \[ PropertyName \] », она заменяется значением свойства.
    -   При обнаружении подстроки вида " \[ % environmentvariable \] " значение переменной среды подставляется.
    -   Если подстрока формы \[ \# *филекэй* \] найдена, она заменяется полным путем к файлу со значением *филекэй* , используемым в качестве ключа в [таблице File](file-table.md). Значение \[ \# *филекэй* \] остается пустым и не заменяется путем, пока установщик не выполнит действие [костинитиализе](costinitialize-action.md), [филекост Action](filecost-action.md)и [костфинализе](costfinalize-action.md). Значение \[ \# *филекэй* \] зависит от состояния установки компонента, которому принадлежит файл. Если компонент запускается из источника, значением является путь к исходному расположению файла. Если компонент выполняется локально, значение представляет собой путь к целевому расположению файла после установки. Если компонент отсутствует, путь будет пустым. Дополнительные сведения о проверке состояния установки компонентов см. [в разделе Проверка установки компонентов, компонентов и файлов](checking-the-installation-of-features-components-files.md).
    -   Если подстрока формы \[ *$componentkey* \] найдена, она заменяется каталогом установки компонента со значением *компоненткэй* , используемым в качестве ключа в [таблице Component](component-table.md). Значение \[ $ *компоненткэй* \] остается пустым и не заменяется каталогом, пока установщик не выполнит действие [костинитиализе](costinitialize-action.md), [филекост Action](filecost-action.md)и [костфинализе](costfinalize-action.md). Значение \[ $ *компоненткэй* \] зависит от состояния установки компонента. Если компонент запускается из источника, значение является исходным каталогом файла. Если компонент выполняется локально, значение является целевым каталогом после установки. Если компонент отсутствует, значение остается пустым. Дополнительные сведения о проверке состояния установки компонентов см. [в разделе Проверка установки компонентов, компонентов и файлов](checking-the-installation-of-features-components-files.md).
    -   Если подстрока формы " \[ \\ c \] " найдена, она заменяется символом без дальнейшей обработки. Сохраняется только первый символ после обратной косой черты; все остальное удаляется.

## <a name="requirements"></a>Требования



| Требование | Значение |
|--------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Версия<br/> | Windows установщик 5,0 на Windows Server 2012, Windows 8, Windows Server 2008 R2 или Windows 7. Windows установщик 4,0 или установщик Windows 4,5 на Windows Server 2008 или Windows Vista. Windows установщик на Windows Server 2003 или Windows XP<br/> |
| DLL<br/>     | <dl> <dt>Msi.dll</dt> </dl>                                                                                                                                                                      |
| IID<br/>     | IID \_ ISession определяется как 000C109E-0000-0000-C000-000000000046<br/>                                                                                                                                                                             |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[Формате](formatted.md)
</dt> <dt>

[Типы данных столбцов](column-data-types.md)
</dt> </dl>

 

 




