---
description: Пользовательское действие может вызвать функцию, определенную в библиотеке динамической компоновки (DLL), написанной на языке C или C++.
ms.assetid: 605c7b97-70bd-467a-9438-47b05d8b6b5d
title: Библиотеки Dynamic-Link (установщик Windows)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a5f9ff0113d97d219220a4f42030c1563f16ce7b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104080919"
---
# <a name="dynamic-link-libraries-windows-installer"></a>Библиотеки Dynamic-Link (установщик Windows)

Пользовательское действие может вызвать функцию, определенную в библиотеке динамической компоновки (DLL), написанной на языке C или C++. Библиотека DLL может существовать как файл, установленный во время текущей установки, или как временный двоичный поток, исходящий из [двоичной таблицы](binary-table.md) базы данных установки.

Обратите внимание, что все вызываемые функции, включая пользовательские действия в библиотеках DLL, должны указывать \_ \_ соглашение о вызовах STDCALL. Например, для вызова CustomAction используется следующее.


```C++
#include <windows.h>
#include <msi.h>
#include <Msiquery.h>
#pragma comment(lib, "msi.lib")

UINT __stdcall CustomAction(MSIHANDLE hInstall)
```



Дополнительные сведения см. [в разделе доступ к текущему сеансу установщика из пользовательского действия](accessing-the-current-installer-session-from-inside-a-custom-action.md) .

Следующие типы настраиваемых действий вызывают библиотеку динамической компоновки.



| Тип настраиваемого действия                                 | Описание                               |
|----------------------------------------------------|-------------------------------------------|
| [Тип настраиваемого действия 1](custom-action-type-1.md)   | DLL-файл, хранящийся в потоке двоичных таблиц. |
| [Тип настраиваемого действия 17](custom-action-type-17.md) | DLL-файл, установленный с продуктом.        |



 

> [!Note]  
> Чтобы использовать COM, необходимо вызвать [**CoInitializeEx**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializeex) в настраиваемом действии. Не завершайте работу, если обнаруживается, что поток уже инициализирован. Например, поток инициализируется в установке на компьютере, но не в установке на уровне пользователя.

 

См. [сводный список всех типов настраиваемых действий](summary-list-of-all-custom-action-types.md) для сводки всех типов настраиваемых действий и их кодирования в [таблицу CustomAction](customaction-table.md).

 

 
