---
description: сведения о локализации можно добавить в базу данных установки с помощью редактора таблиц баз данных, например Orca, поставляемого с установщик Windows SDK, или путем вызова функций базы данных из приложения.
ms.assetid: cc1eb336-5dec-40cc-8aa5-564cd167855d
title: Обработка кодовых страниц строк параметров
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 37555b905c60cb8f4727ccb723435d28b24d41d3aca1fc7026e34b799e25414a
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119328343"
---
# <a name="code-page-handling-of-parameter-strings"></a>Обработка кодовых страниц строк параметров

сведения о локализации можно добавить в базу данных установки с помощью редактора таблиц баз данных, например Orca, поставляемого с установщик Windows SDK, или путем вызова [функций базы данных](database-functions.md) из приложения. Будьте внимательны, чтобы передавать только строковые параметры, использующие кодовую страницу локализованной базы данных. Если строковый параметр содержит символы, которые не могут быть представлены кодовой страницей базы данных, установщик возвращает ошибку при вызове [**мсидатабасеимпорт**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta). Список страниц с числовыми кодовыми номерами см. в разделе [Локализация таблиц ошибок и актионтекст](localizing-the-error-and-actiontext-tables.md).

Дополнительные сведения см. в разделе [Определение кодовой страницы базы данных установки](determining-an-installation-database-s-code-page.md).

## <a name="adding-localization-information-to-a-database"></a>Добавление сведений о локализации в базу данных

При добавлении сведений о локализации в базу данных эта кодовая страница должна поддерживаться операционной системой. Она не обязательно должна быть текущей кодовой страницей системы. [**Исвалидкодепаже**](/windows/desktop/api/winnls/nf-winnls-isvalidcodepage) должен возвращать **значение true** для кодовой страницы базы данных. Поскольку система преобразует строки ANSI в Юникод, возникает ошибка, если текущая кодовая страница пользователя не совпадает с кодовой страницей базы данных.

вызов версии ANSI установщик Windows API преобразует локализованную строку в юникод с помощью текущей системной кодовой страницы. При фиксации базы данных строка Юникода преобразуется в ANSI с помощью кодовой страницы базы данных. Если текущая системная кодовая страница отличается от кодовой страницы локализованной строки, результат может быть потерянным и неверно преобразован строкой.

В следующей процедуре показано, как сохранить данные локализации.

**Хранение данных локализации**

1.  Задайте кодовую страницу для базы данных в виде кодовой страницы локализованной строки.
2.  Преобразуйте строку ANSI в Юникод с помощью функции [**MultiByteToWideChar**](/windows/desktop/api/stringapiset/nf-stringapiset-multibytetowidechar) и укажите кодовую страницу для локализованных данных.
3.  чтобы добавить локализованные данные, вызовите версию API установщик Windows для юникода с помощью строки юникода.
4.  Зафиксируйте изменения локализации в базе данных с помощью [**мсидатабасекоммит**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasecommit).

Также можно добавить сведения о локализации в базу данных установки, импортировав и экспортировав текстовые архивные файлы ASCII. Дополнительные сведения см. в разделе [Обработка кодовых страниц импортированных и экспортированных таблиц](code-page-handling-of-imported-and-exported-tables.md).

 

 
