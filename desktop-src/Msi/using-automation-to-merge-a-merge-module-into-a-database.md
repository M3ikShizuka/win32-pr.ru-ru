---
description: Модули слияния предоставляют стандартный метод для предоставления общих компонентов установщик Windows и настройки логики для приложений.
ms.assetid: 63ced106-12e3-4483-8bfe-22c54fe7a204
title: Использование службы автоматизации для слияния модуля слияния в базу данных
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f3e28b8cfc1716cdbb296fd0a1410787ae55bb62
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105673429"
---
# <a name="using-automation-to-merge-a-merge-module-into-a-database"></a>Использование службы автоматизации для слияния модуля слияния в базу данных

[Модули слияния](merge-modules.md) предоставляют стандартный метод для предоставления общих [*компонентов*](c-gly.md)установщик Windows и настройки логики для приложений.

Модули слияния должны быть объединены в пакет установки с помощью средства слияния. Рекомендуется получить свободно распространяемое средство слияния или приобрести один из средств слияния, доступных из независимых поставщиков программного обеспечения, например, можно использовать [Mergemod.dll](merge-module-automation.md).

В следующей процедуре показано, как объединить модуль слияния в базу данных установщик Windows с помощью [службы автоматизации модуля слияния](merge-module-automation.md).

**Объединение модуля в базу данных**

1.  Откройте файл журнала с помощью метода [**опенлог**](merge-openlog.md) .

    Этот шаг необходим только в том случае, если необходимо создать файл журнала или добавить существующий файл журнала для процесса слияния.

2.  Откройте базу данных установки [. msi](windows-installer-file-extensions.md) с помощью метода [**опендатабасе**](merge-opendatabase.md) [**объекта Merge**](merge-object.md).

    Этот шаг является обязательным.

    Открываемая база данных должна получить модуль слияния.

3.  Откройте модуль [MSM](windows-installer-file-extensions.md) MERGE с помощью метода [**опенмодуле**](merge-openmodule.md) .

    Этот шаг является обязательным.

    Это модуль слияния, который объединяется с базой данных. Модуль необходимо открыть, прежде чем его можно будет объединить с базой данных установки.

4.  Объедините модуль в базу данных установки, вызвав метод [**Merge**](merge-object.md) или [**мержеекс**](merge-mergeex.md) .

    Этот шаг является обязательным.

    Метод [**Merge**](merge-object.md) или метод [**мержеекс**](merge-mergeex.md) можно вызывать только один раз для слияния определенного сочетания файлов [. msi](windows-installer-file-extensions.md) и. msm.

    > [!Note]  
    > Метод [**мержеекс**](merge-mergeex.md) доступен только в [Mergemod.dll версии 2,0](merge-module-automation.md) или более поздней и только при использовании интерфейса [**IMsmMerge2**](/windows/desktop/api/Mergemod/nn-mergemod-imsmmerge2) .

     

5.  Получите свойство [**Errors**](merge-errors.md) и изучите коллекцию объектов [**Error**](error-object.md) , которые она возвращает для конфликтов слияния или других ошибок.

    Необходимо устранить все ошибки.

    Извлечение является необратимым, и несколько экземпляров коллекции ошибок могут быть получены путем многократного считывания свойства [**Errors**](merge-errors.md) .

6.  Свяжите компоненты модуля слияния с функциями с помощью метода [**Connect**](merge-connect.md) .

    Этот шаг необходим только в том случае, если у вас есть компоненты и вы хотите добавить компоненты для слияния в базу данных установки.

    Перед вызовом этого метода должна существовать функция. Дополнительные сведения см. [в разделе Подключение модуля слияния к нескольким компонентам](connecting-a-merge-module-to-multiple-features.md).

7.  При необходимости извлеките исходные файлы из модуля, выполнив одно или несколько из следующих действий:
    -   Используйте [**екстрактфилес**](merge-extractfiles.md) или [**екстрактфилесекс**](merge-extractfilesex.md) для извлечения файлов из внедренного CAB-файла, а затем скопируйте в указанный каталог.
        > [!Note]  
        > Для [**екстрактфилесекс**](merge-extractfilesex.md) требуется [Mergemod.dll версии 2,0](merge-module-automation.md) или более поздней.

         

    -   Используйте [**екстракткаб**](merge-extractcab.md) для извлечения файлов из внедренного CAB-файла, а затем сохраните в указанном файле.
    -   Используйте [**креатесаурцеимаже**](merge-createsourceimage.md) для извлечения файлов из модуля, а затем после слияния скопируйте в исходное изображение на диске.
        > [!Note]  
        > [**Креатесаурцеимаже**](merge-createsourceimage.md) доступен только в [Mergemod.dll версии 2,0](merge-module-automation.md) или более поздней.

         
8.  Закройте текущий открытый модуль слияния с помощью метода [**клосемодуле**](merge-closemodule.md) .

    Этот шаг является обязательным.

9.  Закройте открытую базу данных установки с помощью метода [**клоседатабасе**](merge-closedatabase.md) .

    Этот шаг является обязательным.

    При закрытии базы данных удаляются все сведения о зависимостях, но не затрагиваются все ошибки, которые не извлекаются.

10. Закройте текущий файл журнала с помощью метода [**клоселог**](merge-closelog.md) .

    Этот шаг необходим, если открыт файл журнала.

После слияния модуля с базой данных с помощью [Mergemod.dll](merge-module-automation.md)необходимо обновить [таблицу мультимедиа](media-table.md) , чтобы описать нужный макет исходного изображения. Процесс слияния, предоставляемый Mergemod.dll, не обновляет таблицу мультимедиа, так как потребитель модуля слияния может выбрать различные способы размещения исходного изображения.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Выпущенные версии, средства и распространяемые пакеты](released-versions-tools-and-redistributables.md)
</dt> </dl>

 

 



