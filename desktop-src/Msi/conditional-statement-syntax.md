---
description: В этом разделе описывается синтаксис условных операторов, используемых функцией Мсиевалуатекондитион и таблицами последовательности действий. Дополнительные сведения см. в разделе Примеры синтаксиса условных инструкций.
ms.assetid: 6f1657f9-063b-4d57-ad76-95e3dbe25786
title: Синтаксис условных операторов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f0548a71756faff654bfe2b49e14c0581a6248a5
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103909027"
---
# <a name="conditional-statement-syntax"></a>Синтаксис условных операторов

В этом разделе описывается синтаксис условных операторов, используемых функцией [**мсиевалуатекондитион**](/windows/desktop/api/Msiquery/nf-msiquery-msievaluateconditiona) и [таблицами последовательности](using-a-sequence-table.md)действий. Дополнительные сведения см. в разделе [Примеры синтаксиса условных инструкций](examples-of-conditional-statement-syntax.md).

## <a name="summary-of-conditional-statement-syntax"></a>Сводка синтаксиса условных инструкций

В этой таблице и следующем списке приведено краткое описание синтаксиса, используемого в условных выражениях.



| Элемент                | Синтаксис                                                                                                          |
|---------------------|-----------------------------------------------------------------------------------------------------------------|
| значение               | \|символьное \| целое число                                                                                    |
| оператор сравнения | < \| > \| <= \| >= \| = \| <>                                                                 |
| Слово                | \|Сравнение значений — значение оператора \| (выражение)\|                                                    |
| Логический фактор      | термин \| **не** является термином                                                                                            |
| Логическое выражение        | Логический фактор логического \| **и** термина                                                                   |
| expression          | Логическое \| выражение Boolean-Term **или** Expression                                                                  |
| символ              | Свойство \| % Environment: переменная \| $Component-Action \| ? компонент-State \| &компонент-действие \| ! состояние компонента |



 

-   В именах символов и значениях учитывается регистр.
-   В именах переменных среды регистр не учитывается.
-   Текст литерала должен быть заключен в кавычки ("Text").
    > [!Note]  
    > Литеральный текст, содержащий кавычки, нельзя использовать в условных инструкциях, так как в литеральном тексте нет escape-символа для кавычек. Для сравнения с текстовым литералом, содержащим кавычки, текст литерала должен быть размещен в свойстве. Например, чтобы убедиться, что свойство SERVERNAME не содержит кавычек, определите свойство с именем QUOTEs в [таблице свойств](property-table.md) со значением "и измените условие на" not ServerName><Quotes ".

     

-   Несуществующие значения свойств рассматриваются как пустые строки.
-   Числовые значения с плавающей запятой не поддерживаются.
-   Операторы и приоритеты аналогичны тем, что основаны на языках BASIC и SQL.
-   Арифметические операторы не поддерживаются.
-   Для переопределения приоритета операторов можно использовать круглые скобки.
-   В операторах регистр не учитывается.
-   Для сравнения строк символ тильды "~", предваряющий оператор, выполняет сравнение без учета регистра.
-   Сравнение целого числа со значением строки или свойства, которое не может быть преобразовано в целое число, всегда равно **мсиевалуатекондитионфалсе**, за исключением оператора сравнения "<>", который возвращает **мсиевалуатекондитионтруе**.

## <a name="access-prefixes"></a>Префиксы доступа

В следующей таблице приведены префиксы, используемые для доступа к различным сведениям об установщике системы и установщика для использования в условных выражениях.



| Тип символа          | Prefix | Значение                                                     |
|----------------------|--------|-----------------------------------------------------------|
| Свойство установщика   | (нет) | Значение таблицы свойств ([Property](property-table.md)). |
| Переменная среды | %      | Значение переменной среды.                            |
| Ключ таблицы компонента  | $      | Состояние действия компонента.                            |
| Ключ таблицы компонента  | ?      | Установленное состояние компонента.                         |
| Ключ таблицы функций    | &      | Состояние действия компонента.                              |
| Ключ таблицы функций    | !      | Состояние установки компонента.                           |



 

## <a name="logical-operators"></a>Логические операторы

В следующей таблице показаны логические операторы в условных выражениях в порядке убывания приоритета.



| Оператор | Значение                                                 |
|----------|---------------------------------------------------------|
| Not      | Префикс унарного оператора; Инвертирует состояние следующего термина. |
| И      | Значение TRUE, если оба условия имеют значение TRUE.                            |
| либо       | Значение TRUE, если одно или оба условия имеют значение TRUE.                  |
| Xor      | Значение TRUE, если оба условия имеют значение TRUE.             |
| Eqv      | TRUE, если оба условия имеют значение TRUE или оба условия имеют значение FALSE.    |
| Imp      | Значение TRUE, если левый термин имеет значение FALSE или правое выражение имеет значение TRUE.       |



 

## <a name="comparative-operators"></a>Сравнительные операторы

В следующей таблице показаны операторы сравнения, используемые в условных выражениях. Эти операторы сравнения могут находиться только между двумя значениями.



| Оператор | Значение                                                     |
|----------|-------------------------------------------------------------|
| =        | Значение TRUE, если значение left равно значению right.                 |
| <> | TRUE, если левое значение не равно значению right.             |
| >     | Значение TRUE, если значение left больше значения right.             |
| >=    | Значение TRUE, если значение left больше или равно значению right. |
| <     | Значение TRUE, если значение Left меньше значения right.                |
| <=    | Значение TRUE, если значение Left меньше или равно значению right.    |



 

## <a name="substring-operators"></a>Операторы substring

В следующей таблице показаны операторы подстроки, используемые в условных выражениях. Операторы подстроки могут находиться между двумя строковыми значениями.



| Оператор | Значение                                           |
|----------|---------------------------------------------------|
| >< | Значение TRUE, если левая строка содержит правую строку.    |
| << | Значение TRUE, если левая строка начинается с правой строки. |
| >> | Значение TRUE, если левая строка заканчивается на правую строку.   |



 

## <a name="bitwise-numeric-operators"></a>Битовые числовые операторы

В следующей таблице показаны побитовые операторы сравнения в условных выражениях. Эти операторы могут находиться между двумя целочисленными значениями.



| Оператор | Значение                                                                      |
|----------|------------------------------------------------------------------------------|
| >< | Побитовое и, TRUE, если левое и правое целые числа имеют общие биты.    |
| << | Значение true, если старшие 16-разряды левого целого числа равны значению правого целого числа. |
| >> | Значение true, если младшие 16 разрядов левого целого числа равны значению правого целого числа.  |



 

## <a name="feature-and-component-state-values"></a>Значения состояния компонентов и компонентов

В следующей таблице показано, где можно использовать символы операторов и компонентов.



| Станции <state> | Допустимый синтаксис                                                                                                                                         |
|------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| $component действие      | В таблице [условие](condition-table.md) и в таблицах [последовательности](using-a-sequence-table.md) после действия [костфинализе](costfinalize-action.md) . |
| Действие &компонента        | В таблице [условие](condition-table.md) и в таблицах [последовательности](using-a-sequence-table.md) после действия [костфинализе](costfinalize-action.md) . |
| ! состояние компонента         | В таблице [условие](condition-table.md) и в таблицах [последовательности](using-a-sequence-table.md) после действия [костфинализе](costfinalize-action.md) . |
| ? состояние компонента       | В таблице [условие](condition-table.md) и в таблицах [последовательности](using-a-sequence-table.md) после действия [костфинализе](costfinalize-action.md) . |



 

В следующей таблице показаны значения компонентов и состояния компонентов, используемые в условных выражениях. Эти состояния не задаются, пока не будет вызван [**мсисетинсталллевел**](/windows/desktop/api/Msiquery/nf-msiquery-msisetinstalllevel) , напрямую или с помощью действия [костфинализе](costfinalize-action.md) .



| Состояние                    | Значение | Значение                                                         |
|--------------------------|-------|-----------------------------------------------------------------|
| INSTALLSTATE \_ неизвестный    | -1    | Не предпринимать никаких действий с функцией или компонентом.              |
| INSTALLSTATE \_ объявлено | 1     | Объявленный компонент. Это состояние недоступно для компонентов. |
| \_отсутствует InstallState     | 2     | Отсутствует компонент или компонент.                            |
| INSTALLSTATE \_ локальный      | 3     | Компонент или компонент на локальном компьютере.                     |
| \_источник InstallState     | 4     | Компонент или компонент запускается из источника.                       |



 

Например, условное выражение "&Мифеатуре = 3" принимает значение true, только если Мифеатуре меняется от текущего состояния к состоянию, установленному на локальном компьютере, INSTALLSTATE \_ Local.

Обратите внимание, что не следует зависеть от условия $Component 1 = 3, чтобы проверить, установлена ли на компьютере Component1 локально. Это может привести к сбою, если Component1 установлен более чем одним продуктом. После того как Component1 установлен локально с помощью product1, установщик оценивает условие $Component 1 = 3 как false во время установки Product2. Это обусловлено тем, что установщик определяет версию компонента, используя путь к ключу компонента, и помечает компонент для установки, если его версия больше или равна установленному компоненту.

Обратите внимание, что установщик не выполняет прямое сравнение типа данных [версии](version.md) в условных инструкциях. Например, нельзя использовать сравнительные операторы для сравнения версий, таких как "01,10" и "1,010", в условном операторе. Вместо этого используйте допустимый метод для поиска версии, как описано в разделе [Поиск существующих приложений, файлов, записей реестра или INI-файлов](searching-for-existing-applications-files-registry-entries-or--ini-file-entries.md), а затем задайте свойство.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Использование свойств в условных инструкциях](using-properties-in-conditional-statements.md)
</dt> </dl>

 

 



