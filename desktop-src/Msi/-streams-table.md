---
description: В \_ таблице Streams перечислены внедренные потоки данных OLE. Это временная таблица, созданная только в том случае, если на нее ссылается инструкция SQL.
ms.assetid: 1e30472d-6ba5-410a-a81b-07ed225dcb69
title: Таблица _Streams
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b9607097b32acc8a3c2350a00db0b9721a4aa353
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105662987"
---
# <a name="_streams-table"></a>\_Таблица потоков

В \_ таблице Streams перечислены внедренные потоки данных OLE. Это временная таблица, созданная только в том случае, если на нее ссылается инструкция SQL.



| Столбец | Type                 | Ключ | Допускает значения NULL |
|--------|----------------------|-----|----------|
| Имя   | [Text](text.md)     | Да   | Нет        |
| Данные   | [Двоичный](binary.md) | Нет   | Да        |



 

## <a name="columns"></a>Столбцы

<dl> <dt>

<span id="Name"></span><span id="name"></span><span id="NAME"></span>Безымян
</dt> <dd>

Уникальный ключ, определяющий поток. Максимальная длина имени — 62 символов.

</dd> <dt>

<span id="Data"></span><span id="data"></span><span id="DATA"></span>Data
</dt> <dd>

Неформатированные двоичные данные.

</dd> </dl>

## <a name="remarks"></a>Комментарии

Чтобы скопировать поток данных OLE (например, объект типа [binary](binary.md) данных) из файла в базу данных, создайте запись в \_ таблице Streams и введите имя потока данных в столбец имя этой записи и скопируйте данные из файла в столбец данных с помощью [**мсирекордсетстреам**](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstreama). Используйте [**мсивиевмодифи**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) для вставки новой записи в таблицу.

Для чтения потока двоичных данных, внедренного в базу данных, используйте SQL-запрос для поиска и получения записи, содержащей двоичные данные. Используйте [**мсирекордреадстреам**](/windows/desktop/api/Msiquery/nf-msiquery-msirecordreadstream) для считывания двоичных данных в буфер.

Чтобы переместить поток двоичных данных из одной базы данных в другую, сначала экспортируйте данные в файл. Используйте SQL-запрос для поиска потока данных в файле и используйте [**мсирекордсетстреам**](/windows/desktop/api/Msiquery/nf-msiquery-msirecordsetstreama) для копирования данных из файла в столбец данных \_ таблицы Streams второй базы данных. Это гарантирует, что каждая база данных будет иметь собственную копию двоичных данных. Вы не можете перемещать двоичные данные из одной базы данных в другую, просто получая запись с данными из первой базы данных и вставляя ее во вторую базу данных.

Чтобы удалить поток данных, выберите запись и задайте для столбца данных значение null, прежде чем обновлять запись. Другой способ — удалить запись из таблицы, удалив ее с помощью [**мсивиевмодифи**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) или простого SQL-запроса. Поток не следует получать в записи, если поток удаляется из таблицы.

Чтобы переименовать поток данных OLE, обновите столбец "имя" записи.

Если для этой таблицы размещается удержание с помощью SQL (ALTER TABLE <table> УДЕРЖАНИЕ) или добавление столбца с УДЕРЖАНИЕм, таблица должна быть освобождена с помощью функции FREE. Потоки не записываются, пока таблица не будет освобождена или зафиксирована.

 

 



