---
description: Установщик Windows может восстанавливать, заменять и проверять файлы, содержащиеся в приложении. Частичная или полная переустановка приложения может потребоваться, если какие-либо файлы или записи реестра, связанные с любым компонентом, отсутствуют или повреждены.
ms.assetid: fab23ab9-f1ab-4743-b883-cffc29b0124b
title: Переустановка компонента или приложения
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 645f7dbf95204d96202c71a120eafb6e6e054ac6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104156459"
---
# <a name="reinstalling-a-feature-or-application"></a>Переустановка компонента или приложения

Установщик Windows может восстанавливать, заменять и проверять файлы, содержащиеся в приложении. Частичная или полная переустановка приложения может потребоваться, если какие-либо файлы или записи реестра, связанные с любым компонентом, отсутствуют или повреждены.

При повторной установке компонента или приложения все службы, переменные среды и настраиваемые действия, относящиеся к компоненту или приложению, также будут переустановлены. Обратите внимание, что это означает, что все изменения, внесенные в переменные среды между исходной установкой и переустановкой, теряются.

В следующем списке содержатся методы переустановки компонента или продукта. Два первых метода были автоматизированы установщиком:

-   Исправьте, замените или проверьте файлы, вызвав функцию [**мсиреинсталлфеатуре**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea) .
-   Переустановите весь продукт, вызвав функцию [**мсиреинсталлпродукт**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta) .
-   Переустановите, замените или проверьте файлы с помощью кнопки управления пользовательским интерфейсом установщика, выполнив [повторную установку таблице ControlEvent событие](reinstall-controlevent.md).
-   Переустановите, замените или проверьте файлы из командной строки, задав свойство [**REINSTALL**](reinstall.md) и свойство [**REINSTALLMODE**](reinstallmode.md) .

Дополнительные сведения о переустановке компонента или приложения см. в разделе [устойчивость](resiliency.md).

**Повторная установка продукта с помощью установщика**

-   Вызовите [**мсиреинсталлпродукт**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta).

**Повторная установка компонента с помощью установщика**

-   Вызовите [**мсиреинсталлфеатуре**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea).

**Переустановка продукта или компонента с помощью пользовательского интерфейса установщика**

1.  Добавьте кнопку в указанное диалоговое окно, добавив запись в [таблицу управления](control-table.md).
2.  Добавьте [таблице ControlEvent событие ReinstallMode](reinstallmode-controlevent.md) в таблицу таблице ControlEvent событие, используя поля диалогового окна \_ и элемента управления, \_ ссылающиеся на элемент управления Button, созданный на шаге 1. В поле argument (аргумент) введите строку, содержащую буквы, соответствующие нужным режимам переустановки (допустимые значения для этого поля идентичны параметрам, принятым для свойства [**REINSTALLMODE**](reinstallmode.md) ). Значение в столбце упорядочения для этого события должно быть равно 1.
3.  Добавьте событие [REINSTALL таблице ControlEvent событие](reinstall-controlevent.md) в [таблицу таблице ControlEvent событие](controlevent-table.md), еще раз ссылаясь на тот же элемент управления Button. Как правило, поле аргумента для этого события — все, чтобы принудительно переустановить все компоненты, но можно указать здесь имя конкретной функции. Значение в столбце упорядочения для этого события должно быть равно 2.
4.  Добавьте еще одно событие, привязанное к тому же элементу управления Button, чтобы начать переустановку. Это может быть событие EndDialog (с аргументом Return). Однако, как правило, здесь будет использоваться событие Невдиалог для перехода к и **вы действительно хотите переустановить его?** диалоговое окно подтверждения. Значение в столбце упорядочения для этого события должно быть равно 3.

    При необходимости можно создать [**несколько кнопок переустановки для**](reinstall.md) одного диалогового окна, позволяя пользователю выбрать тип переустановки. В этом случае каждая кнопка создается, как описано в предыдущей процедуре, с другим параметром [ReinstallMode таблице ControlEvent событие](reinstallmode-controlevent.md) для каждой кнопки.

После установки определенного продукта (с некоторыми или всеми компонентами продукта) переустановку можно выполнить в командной строке:

**Переустановка продукта или компонента из командной строки**

1.  В командной строке укажите свойство [**REINSTALL**](reinstall.md) .
2.  В командной строке укажите свойство [**REINSTALLMODE**](reinstallmode.md) .

    Указание этих свойств позволяет пользователю переустановить любую или все компоненты продукта. Также можно указать тип переустановки. Например, можно указать, что следует заменить только те файлы, которые полностью отсутствуют, или только поврежденные файлы (например, любой исполняемый файл, контрольная сумма которого не совпадает с фактическим содержимым файла).

 

 



