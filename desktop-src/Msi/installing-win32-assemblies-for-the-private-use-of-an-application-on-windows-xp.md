---
description: Процедура, описанная в этом разделе, определяет, как создать пакет установщик Windows для установки сборки Win32.
ms.assetid: 2d4bc2be-cce6-45e6-b6a7-7ff96d28eb96
title: Установка сборок Win32 для закрытого использования приложения в Windows XP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e807e22c9c5dea67ece5ead0ded95f06ab203689
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105682790"
---
# <a name="installing-win32-assemblies-for-the-private-use-of-an-application-on-windows-xp"></a>Установка сборок Win32 для закрытого использования приложения в Windows XP

Процедура, описанная в этом разделе, определяет, как создать пакет установщик Windows для установки сборки Win32. Пакет устанавливает сборку и файл манифеста приложения в созданную им папку, которую использует приложение. Манифест приложения определяет зависимость приложения от закрытой сборки. После установки пакета закрытая сборка становится доступной для монопольного использования приложения. Зависимость сборки, заданная в манифесте приложения, переопределяет (для этого приложения) любые другие глобальные зависимости сборок, указанные в файлах манифеста сборки.

Прежде чем продолжить, лучше понять, как создать пакет установщик Windows без сборок. Дополнительные сведения см. [в примере установки](an-installation-example.md).

**Установка закрытой сборки в Windows XP**

1.  Определите компонент установщик Windows, включающий сборку Win32 и файл манифеста приложения. Этот компонент может содержать другие ресурсы, которые всегда должны устанавливаться или удаляться вместе со сборкой. Остальные шаги этой процедуры описывают, как создать базу данных установки для установки этого компонента.
2.  Добавьте строку в [таблицу Component](component-table.md) для компонента, содержащего сборку Win32 и файл манифеста приложения. Введите допустимый установщик Windows [GUID](guid.md) для этого кода компонента. Дополнительные сведения см. в разделе [изменение кода компонента](changing-the-component-code.md) и [что произойдет, если правила компонентов будут разорваны?](what-happens-if-the-component-rules-are-broken.md)
3.  Установщик копирует файл манифеста сборки в папку, содержащую файл, указанный в поле файлового \_ приложения [таблицы мсиассембли](msiassembly-table.md).
4.  Добавьте строку в [таблицу феатурекомпонентс](featurecomponents-table.md) для привязки компонента к установщик Windows функции. Дополнительные сведения см. в разделе [компоненты и компоненты](components-and-features.md). Установщик Windowsная функция должна быть частью функции приложения, которую может распознать пользователь. Сборка активируется, когда эта функция выбрана пользователем или произошла ошибка в приложении. Если сборка определяет дополнительную функцию, добавьте дополнительную строку в [таблицу функций](feature-table.md) для атрибутов компонентов. Этот шаг не является обязательным при создании модуля слияния.
5.  Для параллельных сборок, сведения о привязке и активации, например классы COM, интерфейсы и библиотеки типов, хранятся в файлах манифеста, а не в реестре. Закрытые сборки хранят эти сведения в манифесте сборки. В системах, поддерживающих параллельные сборки, установщик пропускает обработку любых сведений о компоненте, который указан в [таблице расширения](extension-table.md), [таблице команд](verb-table.md), [таблице typelib](typelib-table.md), [таблице MIME](mime-table.md), [таблице классов](class-table.md), [таблице кодов ProgID](progid-table.md)и [таблице AppID](appid-table.md). Сведения о привязке и активации можно указать в таблицах для использования в системах, которые не поддерживают совместное использование сборок параллельно.
6.  Параллельная установка не регистрирует сборку глобально. Установщик пропускает самостоятельную регистрацию компонента, если в [таблицу селфрег](selfreg-table.md)указаны какие-либо сведения о самостоятельной регистрации. Сведения о самостоятельной регистрации можно указать в таблице Селфрег для самостоятельной регистрации компонента в системах, которые не поддерживают совместное использование сборок параллельно.
7.  Добавьте любые другие сведения о реестре, за исключением привязки и активации, или самостоятельной регистрации компонента в [таблице реестра](registry-table.md), [таблице Ремоверегистри](removeregistry-table.md)и [таблице окружения](environment-table.md).
8.  Установщик пропускает [таблицу исолатедкомпонент](isolatedcomponent-table.md) для этого компонента в операционных системах, поддерживающих совместное использование. Введите сведения в эту таблицу, если необходимо, чтобы сборка была закрыта в системах, поддерживающих локальные файлы.
9.  Добавьте строку в [таблицу мсиассембли](msiassembly-table.md) для компонента, содержащего сборку Win32. Введите значение 1 в поле Attributes таблицы Мсиассембли, чтобы указать, что это сборка Win32. Введите ключ закрытой сборки в \_ поле файл приложения [таблицы мсиассембли](msiassembly-table.md). Добавьте [действие мсипублишассемблиес](msipublishassemblies-action.md) в [таблицу Инсталлексекутесекуенце](installexecutesequence-table.md) или [таблицу адвтексекутесекуенце](advtexecutesequence-table.md). Добавьте [действие мсиунпублишассемблиес](msiunpublishassemblies-action.md) в таблицу инсталлексекутесекуенце. Создайте папку для сборки и файла манифеста в [таблице Directory](directory-table.md). Эта папка должна находиться в корневом каталоге приложения и содержать файл, указанный в поле файлового \_ приложения [таблицы мсиассембли](msiassembly-table.md). Во время установки приложения установщик разрешает [таблицу каталогов](directory-table.md) для пути к этой папке. Дополнительные сведения см. [в разделе Использование таблицы Directory](using-the-directory-table.md).
10. Добавьте строки в [таблицу мсиассемблинаме](msiassemblyname-table.md) для компонента. Добавьте по одной строке для каждой пары "имя — значение", указанной в разделе "assemblyIdentity" манифеста. Дополнительные сведения см. в разделе [мсиассемблинаме Table](msiassemblyname-table.md).

 

 



