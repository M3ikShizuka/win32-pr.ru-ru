---
description: При создании пакета установки можно использовать функцию Мсивиевмодифи или метод View. Modify, чтобы убедиться, что введенные данные синтаксически верны.
ms.assetid: c960e9df-dcd6-44d2-8662-40a1dea81f45
title: Внутренняя проверка
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 44184a87f7d8bd28b3603d81bb83ae28ec68471e6c9c849bf9322dc5e968c886
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "120043304"
---
# <a name="internal-validation"></a>Внутренняя проверка

При создании пакета установки можно использовать функцию [**мсивиевмодифи**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) или метод View. Modify, чтобы убедиться, что введенные данные синтаксически верны. Дополнительные сведения см. в разделе [**метод Modify**](view-modify.md). На самом низком уровне столбец таблицы базы данных может хранить целые числа (короткие или длинные), строки или двоичные данные. Однако для пакета установки требуются определенные целые числа или строки в определенных таблицах. Эти спецификации хранятся в [ \_ таблице проверки](-validation-table.md). Например, столбец FileName [таблицы File](file-table.md) представляет собой строковый столбец, но в частности, он хранит имя файла. Поэтому не только следует, чтобы ваша запись была строкой, но также должна соответствовать требованиям к именам файлов.

Различные значения перечисления проверки, используемые с функцией [**мсивиевмодифи**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewmodify) , позволяют выполнять немедленную проверку на разных уровнях. \_ \_ Перечисление полей мсимодифи Validate можно использовать для проверки отдельных полей записи. Внешние ключи не проверяются. МСИМОДИФИ \_ Validate enum проверяет всю строку и включает проверку внешнего ключа. При вставке новой строки в таблицу используйте МСИМОДИФИ \_ проверить \_ новое перечисление, чтобы убедиться, что вы добавляете допустимые данные, а также используете уникальные первичные ключи. Вставка завершается ошибкой, если первичные ключи не являются уникальными. Если вызов **мсивиевмодифи** с одним из перечислений проверки возвращает ошибку, можно выполнить повторные вызовы [**мсивиевжетеррор**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewgeterrora) для диагностики проблемы. **Мсивиевжетеррор** указывает столбец, в котором произошла ошибка, а также значение перечисления, помогающее устранить проблему. Дополнительные сведения см. в разделе [**метод метода WebMethod**](view-geterror.md).

Можно также использовать внутреннюю проверку, чтобы убедиться, что другие авторы правильно вводят данные в настраиваемую таблицу. Добавьте каждый из столбцов настраиваемой таблицы в \_ таблицу проверки, используя имя настраиваемой таблицы и имя столбца в качестве первичного ключа. Введите описание или назначение каждого столбца в столбце Описание \_ таблицы проверки. Введите применимые требования для каждого столбца с помощью значений NULL, MinValue, MaxValue, Кэйтабле, KeyColumn, Category и Set.

-   Если столбец допускает значения NULL, введите "Y". Если это не так, введите "N".
-   Если столбец представляет собой целочисленный столбец и может содержать диапазон целых чисел, введите этот диапазон с помощью столбцов MinValue и MaxValue.
-   Внешние ключевые столбцы идентифицируются с помощью столбцов Кэйтабле и KeyColumn.
-   Для строковых столбцов укажите категорию, например имя файла, GUID или идентификатор. Дополнительные сведения см. в разделе [типы данных столбцов](column-data-types.md).
-   Если данные могут быть связаны только с конкретным числом значений (String или Integer), используйте столбец Set для перечисления допустимых значений.

Ниже приведен список столбцов (в дополнение к таблице, столбцу и описанию) в \_ таблице проверки, которые могут быть заполнены, если столбец имеет указанный тип. (Обратите внимание, что не нужно заполнять все столбцы.)



| Тип    | Столбцы                                                          |
|---------|------------------------------------------------------------------|
| Целочисленный тип | Nullable, MinValue, MaxValue, Кэйтабле, KeyColumn, Set           |
| Строковый тип  | Nullable, Кэйтабле, KeyColumn, Category, Set, MinValue, MaxValue |
| Двоичные данные  | Nullable, Категория (категория должна быть "binary")                   |



 

В средах разработки может использоваться МСИМОДИФИ \_ Validate \_ Delete. В этом перечислении предполагается, что необходимо удалить строку. Проверка поля или внешнего ключа не выполняется. Это перечисление фактически выполняет обратную проверку внешнего ключа. Он проверяет \_ таблицу проверки на наличие ссылок в столбцах кэйтабле и KeyColumn таблицы, к которой принадлежит строка "Deleted". Если имеются столбцы, содержащие таблицу, содержащую строку "Deleted", в качестве возможного внешнего ключа, она циклически проходит по этому столбцу, чтобы проверить, не ссылаются ли значения на ссылочные значения в строке "удалено". Возврат ошибки означает разрыв реляционной целостности базы данных путем удаления строки.

 

 



