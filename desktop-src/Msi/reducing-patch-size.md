---
description: Начиная с версии установщик Windows 3,0, авторы исправлений могут использовать базовый план продукта, кэшированный установщиком, для более простого обслуживания приложений с меньшими разностными исправлениями.
ms.assetid: ab5b193d-79ce-4ed4-af53-89a4197197c1
title: Уменьшение размера исправления
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4fa365e831ab8685073347dc254bac58269135f1
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105673670"
---
# <a name="reducing-patch-size"></a>Уменьшение размера исправления

Начиная с версии установщик Windows 3,0, авторы исправлений могут использовать базовый план продукта, кэшированный установщиком, для более простого обслуживания приложений с меньшими разностными исправлениями. Во многих случаях [*разностное обновление*](d-gly.md) , которое доставляет сведения об обслуживании в приложение, может быть значительно меньше, чем полное обновление или пакет установки, доставляющие одну и ту же информацию.

**Установщик Windows 2,0:** Не поддерживается. Начиная с установщик Windows 3,0, установщик выборочно сохраняет базовые сведения о файлах при их обновлении.

Установщик Windows предоставляет три метода для обновления и обслуживания приложений: [небольшие обновления](small-updates.md), [незначительные](minor-upgrades.md)обновления и [основные обновления](major-upgrades.md). Небольшое обновление также называется обновлением с исправлением QFE, а дополнительное обновление также называется обновлением пакета обновления (SP). Типичное крупное обновление удаляет предыдущее приложение и устанавливает новое приложение. Установщик Windows может доставлять данные обслуживания в приложения в виде [установочного пакета](installation-package.md) (MSI-файла) или [пакета исправлений](patch-packages.md) (MSP-файл).

Пакет исправлений установщик Windows, который доставляет сведения об обслуживании для небольшого или незначительного обновления, обычно намного меньше, чем эквивалентный пакет установки, доставляющий те же сведения об обслуживании. Рекомендуется использовать пакеты исправлений для распространения небольших и незначительных обновлений. Рекомендуется использовать установочный пакет для распространения крупного обновления.

Установщик Windows исправления (MSP-файлы) могут создаваться либо из полных файлов, либо из-за различий в файлах (также называемых разностными файлами). Установщик Windowsное исправление, созданное на основе различий файлов, может быть намного меньше, чем соответствующее обновление полного файла. Все версии установщик Windows могут использовать как исправления полных файлов, так и разностные исправления.

Начиная с версии установщик Windows 3,0 установщик выборочно сохраняет базовые сведения о файлах при их обновлении. Сведения о первоначальном базовом приложении (RTM-версии) и последнем незначительном обновлении (пакет обновления) сохраняются в частном расположении при установке приложения или при получении незначительного обновления.

Для минимального размера базового кэша Установщик выполняет следующие действия.

-   Для каждого приложения поддерживается не более двух базовых планов: базовый план первоначально выпущенного файла (RTM) и базовый план файла в самом последнем незначительном обновлении (пакет обновления).
-   Файл не добавляется в кэш, пока не будет исправлен. Базовый кэш — это копирование при записи.
-   Если приложение никогда не обновлялось, в базовом кэше нет файлов.
-   Если последнее обслуживание приложения было незначительным (пакет обновления), приложение находится на базовом уровне и на компьютере может присутствовать не более двух копий файла. Одна копия файла находится в целевом каталоге установки. Другая копия может находиться в базовом кэше RTM.
-   Если последнее обслуживание приложения было небольшим обновлением (QFE), приложение не находится на базовом уровне и на компьютере может присутствовать не более трех копий файла. Первая копия файла находится в целевом каталоге установки. Вторая копия файла находится в базовом кэше RTM. Последняя копия файла находится в самом последнем базовом кэше.
-   Базовый кэш приложения удаляется при удалении продукта.

Начиная с версии установщик Windows 3,0, установщик может использовать базовый кэш при применении исправлений к приложению. Базовые сведения можно использовать для применения разностного исправления или для возврата файла к предыдущей версии во время удаления исправления. Это позволяет авторам исправлений использовать преимущества небольших разностных исправлений. Если установщик обнаруживает, что разностное обновление не может быть применено к целевому файлу, установщик может попытаться использовать файл, сохраненный в базовом кэше, в качестве отправной точки. Установщик выполняет запрос только к исходному источнику установки только после того, как попытаться все возможности в кэше.

Соблюдение следующих рекомендаций может помочь авторам исправлений использовать исправления установщик Windows версии 3,0 и базовый кэш для создания меньших разностных исправлений:

-   Исправления автора, включающие [таблицу мсипатчсекуенце](msipatchsequence-table.md). Эта таблица необходима для использования базового кэша и доступна начиная с версии установщик Windows 3,0.
-   Не устанавливайте политику, запрещающую базовое кэширование. Значение политики [макспатчкачесизе](maxpatchcachesize.md) указывает максимальный процент дискового пространства, который можно использовать. Если для политики Макспатчкачесизе задано значение 0, в базовом кэше не сохраняются никакие дополнительные файлы. Если политика не задана, по умолчанию можно использовать не более 10% места на диске. Если общий размер кэша достигает максимального процента дискового пространства, дополнительные файлы не сохраняются. Политика не влияет на уже сохраненные файлы. Даже если кэширование отключено, установщик может использовать существующие базовые кэши продукта.
-   Если первое примененное исправление включает [таблицу мсипатчсекуенце](msipatchsequence-table.md), для приложения включено кэширование.
-   Если какое-либо обновление в транзакции обслуживания не включает [таблицу мсипатчсекуенце](msipatchsequence-table.md), кэширование включается для приложения только в том случае, если к продукту успешно применено небольшое обновление (пакет обновления), включающее таблицу мсипатчсекуенце.
-   Создайте пакет исправлений с помощью средств создания исправлений, таких как [Msimsp.exe](msimsp-exe.md) и [PATCHWIZ.DLL](patchwiz-dll.md).
-   Всегда нацеливание исправлений для RTM-версии приложения или незначительного обновления (пакета обновления) приложения. Целевыми объектами, указанными в [таблице таржетимажес](targetimages-table-patchwiz-dll-.md) файла свойств создания исправления (PCP), должны быть точки проверки продукта, определенные в первых трех полях свойства [**ProductVersion**](productversion.md) .
-   Никогда не нацеливание на исправления в небольших образах обновлений. Целевые объекты для сборки исправления не должны содержать предыдущие образы обновления небольших обновлений.

 

 



