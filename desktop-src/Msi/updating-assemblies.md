---
description: В этом разделе приведены рекомендации по обновлению сборок с помощью установщик Windows исправлений.
ms.assetid: 60c70d48-aae2-4ea5-a880-ac9e2c83c28c
title: Обновление сборок
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 35b185a9943ba20c81a1fa3431dd590eb05648c9
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104081609"
---
# <a name="updating-assemblies"></a>Обновление сборок

В этом разделе приведены рекомендации по обновлению сборок с помощью установщик Windows исправлений.

Авторы обновлений сборок могут использовать следующие рекомендации, которые применяются ко всем типам сборок:

-   Рекомендуемым методом для обновления сборки является изменение строгого имени сборки в [таблице мсиассемблинаме](msiassemblyname-table.md). Новая версия сборки может предоставляться новым компонентом или тем же компонентом, который предоставляет старую версию.
-   Если новая версия сборки предоставляется тем же компонентом, не изменяйте тип сборки с платформа .NET Framework сборки на сборку Win32 или наоборот.
-   Если все приложения в системе должны использовать обновленную сборку, следует развернуть сборку политики. Сборка политики может перенаправлять приложения в системе для использования новой версии сборки. Сборки политик должны быть предоставлены путем создания нового компонента.
-   Для удаления обновлений сборки требуется установщик Windows 3,0 или более поздней версии. Дополнительные сведения см. в разделе [Удаление исправлений](removing-patches.md).
-   Новая версия сборки должна содержать те же или более старшие версии файлов из ранее выпущенных сборок.
-   Установщик Windows 3,0 может обслуживать платформа .NET Framework и сборки Win32 с помощью полной замены файла или меньшего разностного обновления. Дополнительные сведения см. в разделе [уменьшение размера исправления](reducing-patch-size.md).
-   Если обновление изменяет строгое имя сборки, таблица [мсипатчолдассемблифиле](msipatcholdassemblyfile-table.md) и таблица [мсипатчолдассемблинаме](msipatcholdassemblyname-table.md) являются обязательными, если у пакета исправлений нет таблицы [мсипатчсекуенце](msipatchsequence-table.md) . Таблица Мсипатчолдассемблифиле и таблица Мсипатчолдассемблинаме не требуются, если пакет исправлений содержит сведения о последовательности исправлений в таблице Мсипатчсекуенце.
-   Перед снятием нового исправления следует проверить его, применив к нему все ранее выпущенные исправления.

## <a name="updating-win32-assemblies"></a>Обновление сборок Win32

При обновлении сборок Win32 используйте следующие рекомендации.

-   Измените строгое имя новой сборки, указанной в [таблице мсиассемблинаме](msiassemblyname-table.md).
-   Если вы хотите, чтобы приложение всегда использовало новую версию сборки, не влияя на версию сборки, используемую другими приложениями в системе, используйте тот же компонент для размещения новой версии сборки, которая использовалась для старой версии сборки. Используйте тот же ComponentId в таблице [Component](component-table.md) . После исправления приложения оно содержит только ссылку на новую версию сборки. Старая версия сборки может остаться в новой версии в глобальном кэше сборок. Это не влияет на другие приложения в системе, которые используют старую версию сборки. Если один и тот же компонент используется как для новой, так и для старой версий сборки, обновление может быть небольшим разностным исправлением.
-   Если новая версия сборки несовместима со всеми системами, в которых требуется установить приложение, можно установить новую и старую версии сборки в виде параллельных сборок. Чтобы установить обе версии сборки параллельно, создайте новый компонент, который будет содержать новую версию сборки. Компонент ComponentId в таблице [Component](component-table.md) для нового компонента должен отличаться от ComponentID компонента с старой версией. После исправления приложения оно содержит ссылки на обе версии сборки. Затем приложение можно направить в совместимую версию сборки с помощью манифеста. Если для новых и старых версий сборки используются разные компоненты, то обновление использует полную замену файлов.

## <a name="updating-net-framework-assemblies"></a>Обновление сборок платформа .NET Framework

При обновлении сборок платформа .NET Framework используйте следующие рекомендации.

-   Измените строгое имя новой сборки, указанной в [таблице мсиассемблинаме](msiassemblyname-table.md).
-   Если вы хотите, чтобы приложение всегда использовало новую версию сборки, не влияя на версию сборки, используемую другими приложениями в системе, измените строгое имя новой сборки, которая указана в [таблице мсиассемблинаме](msiassemblyname-table.md), и используйте тот же компонент для размещения новой версии сборки, которая использовалась для старой версии сборки. Используйте тот же ComponentId в таблице [Component](component-table.md) . После исправления приложения оно содержит только ссылку на новую версию сборки. Старая версия сборки может остаться в новой версии в глобальном кэше. Это не влияет на другие приложения в системе, которые используют старую версию сборки. Если один и тот же компонент используется как для новой, так и для старой версий сборки, обновление может быть небольшим разностным исправлением.
-   Если новая версия сборки несовместима со всеми системами, в которых требуется установить приложение, можно установить новую и старую версии сборки в виде параллельных сборок. Чтобы установить обе версии сборки параллельно, измените строгое имя новой сборки, указанной в [таблице мсиассемблинаме](msiassemblyname-table.md), и создайте новый компонент, содержащий новую версию сборки. Компонент ComponentId в таблице [Component](component-table.md) для нового компонента должен отличаться от ComponentID компонента, имеющего старую версию. После исправления приложения оно содержит ссылки на обе версии сборки. Затем приложение может быть направлено в совместимую версию сборки с помощью манифеста. Если для новых и старых версий сборки используются разные компоненты, то обновление использует полную замену файлов.
-   Обновление на месте перезаписывает копию платформа .NET Framework сборки в глобальный кэш сборок. Этот тип обновления сборки не изменяет строгое имя сборки. Изменяется только значение в поле FileVersion [таблицы мсиассемблинаме](msiassemblyname-table.md) . Для обновления на месте платформа .NET Framework сборки требуется платформа .NET Framework 1,1 с пакетом обновления 1 (SP1) или более поздней версии.
    > [!Note]  
    > Тип обновления на месте перезаписывает копию сборки в глобальном кэше и может разрушить работу других приложений, если новая версия сборки не полностью совместима с обратной совместимостью. Рекомендуемым методом для обновления сборки является изменение строгого имени сборки в [таблице мсиассемблинаме](msiassemblyname-table.md).

     

 

 



