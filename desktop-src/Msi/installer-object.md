---
description: Сначала должен быть создан объект установщика для загрузки поддержки автоматизации, необходимой для доступа COM к функциям установщика. Этот объект предоставляет оболочки для создания объектов верхнего уровня и доступа к их методам.
ms.assetid: fefc3e39-073e-4869-86b7-27d20a3b337b
title: Объект установщика
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- Installer
api_type:
- COM
api_location:
- Msi.dll
ms.openlocfilehash: 7c0900f381a4d5887816a9e581d22eeb5ecb4a2b680d14aecc88646bf4ec72ca
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119327984"
---
# <a name="installer-object"></a>Объект установщика

Сначала должен быть создан объект **установщика** для загрузки поддержки автоматизации, необходимой для доступа COM к функциям установщика. Этот объект предоставляет оболочки для создания объектов верхнего уровня и доступа к их методам.

Вы можете создать объект **установщика** из ProgID "Виндовсинсталлер. Installer".

## <a name="members"></a>Элементы

Объект **установщика** имеет следующие типы членов:

-   [Методы](#methods)
-   [Свойства](#properties)

### <a name="methods"></a>Методы

Объект **установщика** содержит следующие методы.



| Метод                                                                   | Описание                                                                                                                                                                                     |
|:-------------------------------------------------------------------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**аддсаурце**](installer-addsource.md)                                 | Добавляет источник в список допустимых сетевых источников в списке.<br/>                                                                                                                |
| [**адвертисепродукт**](installer-advertiseproduct.md)                   | Объявляет пакет установки.<br/>                                                                                                                                                  |
| [**адвертисескрипт**](installer-advertisescript.md)                     | Объявляет пакет установки. <br/>                                                                                                                                                 |
| [**апплимултиплепатчес**](installer-applymultiplepatches.md)           | Применяет один или несколько исправлений к продуктам, которые могут получить исправление. Задает для свойства [**Patch**](patch.md) путь к предоставленным пакетам исправлений.<br/>                          |
| [**апплипатч**](installer-applypatch.md)                               | Вызывает установку и задает для свойства [**Patch**](patch.md) путь к пакету исправлений для каждого продукта, указанного пакетом исправлений, в качестве права на получение исправления.<br/> |
| [**клеарсаурцелист**](installer-clearsourcelist.md)                     | Удаляет все сетевые источники из источника.<br/>                                                                                                                                     |
| [**коллектусеринфо**](installer-collectuserinfo.md)                     | Вызывает последовательность мастера пользовательского интерфейса, которая собирает и хранит сведения о пользователе и код продукта.<br/>                                                                        |
| [**конфигурефеатуре**](installer-configurefeature.md)                   | Настраивает установленное состояние компонента продукта.<br/>                                                                                                                                 |
| [**конфигурепродукт**](installer-configureproduct.md)                   | Устанавливает или удаляет продукт.<br/>                                                                                                                                                    |
| [**креатеадвертисескрипт**](installer-createadvertisescript.md)         | Создает скрипт объявления.<br/>                                                                                                                                                       |
| [**Макрокоманд**](installer-createrecord.md)                           | Возвращает новый объект [**Record**](record-object.md) с запрошенным числом полей.<br/>                                                                                            |
| [**EnableLog**](installer-enablelog.md)                                 | Включает ведение журнала для выбранного типа сообщений для всех последующих сеансов установки в пространстве текущего процесса.<br/>                                                                  |
| [**екстрактпатчксмлдата**](installer-extractpatchxmldata.md)             | Извлекает сведения из исправления в виде XML-строки.<br/>                                                                                                                                  |
| [**FileHash**](installer-filehash.md)                                   | Принимает путь к файлу и возвращает 128-разрядный хэш этого файла.<br/>                                                                                                                    |
| [**филесигнатуреинфо**](installer-filesignatureinfo.md)                 | Принимает путь к файлу и возвращает **SAFEARRAY** байтов, представляющих хэш-код или закодированный сертификат.<br/>                                                                   |
| [**FileSize**](installer-filesize.md)                                   | Возвращает размер указанного файла.<br/>                                                                                                                                              |
| [**FileVersion**](installer-fileversion.md)                             | Возвращает строку версии или строку языка указанного пути.<br/>                                                                                                                 |
| [**форцесаурцелистресолутион**](installer-forcesourcelistresolution.md) | Заставляет установщик выполнять поиск действительного источника продукта в списке источников, если в следующий раз источник не требуется.<br/>                                                                        |
| [**инсталлпродукт**](installer-installproduct.md)                       | Открывает пакет установщика и инициализирует сеанс установки.<br/>                                                                                                                  |
| [**ластерроррекорд**](installer-lasterrorrecord.md)                     | Возвращает объект [**Record**](record-object.md) , содержащий параметры ошибки для самой последней ошибки из функции, которая вызвала запись об ошибке.<br/>                          |
| [**опендатабасе**](installer-opendatabase.md)                           | Открывает существующую базу данных или создает новую.<br/>                                                                                                                                     |
| [**опенпаккаже**](installer-openpackage.md)                             | Открывает пакет установщика для использования с функциями, которые обращаются к базе данных продукта и подсистеме установки.<br/>                                                                               |
| [**опенпродукт**](installer-openproduct.md)                             | Открывает пакет установщика для установленного продукта с использованием кода продукта.<br/>                                                                                                          |
| [**провидеассембли**](installer-provideassembly.md)                     | Возвращает установленный путь к сборке.<br/>                                                                                                                                           |
| [**провидекомпонент**](installer-providecomponent.md)                   | Возвращает полный путь к компоненту и выполняет все необходимые установки.<br/>                                                                                                             |
| [**провидекуалифиедкомпонент**](installer-providequalifiedcomponent.md) | Возвращает полный путь к компоненту и выполняет все необходимые установки.<br/>                                                                                                             |
| [**RegistryValue**](installer-registryvalue.md)                         | Считывает сведения об указанном разделе реестра value.<br/>                                                                                                                           |
| [**реинсталлфеатуре**](installer-reinstallfeature.md)                   | Переустанавливает компоненты или устраняет проблемы с установленными компонентами.<br/>                                                                                                                    |
| [**реинсталлпродукт**](installer-reinstallproduct.md)                   | Переустанавливает продукт или устраняет проблемы установки в установленном продукте.<br/>                                                                                                      |
| [**ремовепатчес**](installer-removepatches.md)                         | Удаляет один или несколько исправлений для продуктов, которые могут получить исправление. <br/>                                                                                                              |
| [**усефеатуре**](installer-usefeature.md)                               | Увеличивает значение счетчика использования для определенной функции и возвращает состояние установки для этой функции.<br/>                                                                             |



 

### <a name="properties"></a>Свойства

Объект **установщика** имеет следующие свойства.



| Свойство                                                                    | Тип доступа           | Описание                                                                                                                                                                                                                                            |
|:----------------------------------------------------------------------------|:----------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**клиентсекс**](installer-components.md)<br/>                        |                       | Возвращает объект [**рекордлист**](recordlist-object.md) , в котором перечислены продукты, использующие указанный установленный компонент.<br/> **[установщик Windows 4,5 и более ранних версий](not-supported-in-windows-installer-4-5.md):** Не поддерживается.<br/>       |
| [**компонентклиентс**](installer-componentclients.md)<br/>           |                       | Возвращает объект [**стринглист**](stringlist-object.md) , перечисляющий набор клиентов указанного компонента.<br/>                                                                                                                           |
| [**компонентпас**](installer-componentpath.md)<br/>                 |                       | Возвращает полный путь к установленному компоненту.<br/>                                                                                                                                                                                            |
| [**компонентпасекс**](installer-componentpathex.md)<br/>             |                       | Возвращает объект [**рекордлист**](recordlist-object.md) , предоставляющий полный путь к указанному установленному компоненту. <br/> **[установщик Windows 4,5 и более ранних версий](not-supported-in-windows-installer-4-5.md):** Не поддерживается.<br/>       |
| [**компоненткуалифиерс**](installer-componentqualifiers.md)<br/>     |                       | Возвращает объект [**стринглист**](stringlist-object.md) , перечисляющий набор зарегистрированных квалификаторов для указанного компонента.<br/>                                                                                                          |
| [**Компоненты**](installer-components.md)<br/>                       |                       | Возвращает объект [**стринглист**](stringlist-object.md) , перечисляющий набор установленных компонентов для всех продуктов.<br/>                                                                                                                      |
| [**компонентсекс**](installer-componentsex.md)<br/>                   |                       | Возвращает объект [**рекордлист**](recordlist-object.md) , в котором перечислены установленные компоненты.<br/> **[установщик Windows 4,5 и более ранних версий](not-supported-in-windows-installer-4-5.md):** Не поддерживается.<br/>                                    |
| [**Среда**](installer-environment.md)<br/>                     | Чтение/запись<br/> | Строковое значение для переменной среды текущего процесса.<br/>                                                                                                                                                                        |
| [**феатурепарент**](installer-featureparent.md)<br/>                 |                       | Указывает родительский компонент компонента.<br/>                                                                                                                                                                                                  |
| [**Функции**](installer-features.md)<br/>                           |                       | Возвращает объект [**стринглист**](stringlist-object.md) , перечисляющий набор опубликованных компонентов для указанного продукта.<br/>                                                                                                               |
| [**феатурестате**](installer-featurestate.md)<br/>                   |                       | Возвращает состояние установки компонента.<br/>                                                                                                                                                                                                   |
| [**феатуреусажекаунт**](installer-featureusagecount.md)<br/>         |                       | Возвращает количество раз, когда была использована функция.<br/>                                                                                                                                                                                 |
| [**феатуреусажедате**](installer-featureusagedate.md)<br/>           |                       | Возвращает дату последнего использования указанного компонента.<br/>                                                                                                                                                                                  |
| [**FileAttributes**](installer-fileattributes.md)<br/>               |                       | Возвращает число, представляющее комбинированные атрибуты файла для указанного пути к файлу или папке.<br/>                                                                                                                                  |
| [**Обновлений**](installer-patches.md)<br/>                             |                       | Возвращает объект [**стринглист**](stringlist-object.md) , содержащий все исправления, примененные к продукту.<br/>                                                                                                                              |
| [**патчесекс**](installer-patchesex.md)<br/>                         |                       | Перечисляет коллекцию объектов [**Patch**](patch-object.md) .<br/>                                                                                                                                                                           |
| [**патчфилес**](installer-patchfiles.md)<br/>                       |                       | Возвращает объект [**стринглист**](stringlist-object.md) , содержащий список файлов, которые могут быть обновлены указанным списком исправлений.<br/>                                                                                                 |
| [**патчинфо**](installer-patchinfo.md)<br/>                         |                       | Возвращает сведения об исправлении.<br/>                                                                                                                                                                                                          |
| [**патчтрансформс**](installer-patchtransforms.md)<br/>             |                       | Возвращает разделенный точками с запятой список преобразований, которые находятся в указанном пакете исправлений и применяются к указанному продукту.<br/>                                                                                                            |
| [**продуктелеватед**](installer-productelevated.md)<br/>             |                       | Возвращает значение true, если продукт является управляемым, или значение false, если продукт не является управляемым.<br/>                                                                                                                                                              |
| [**ProductInfo**](installer-productinfo.md)<br/>                     |                       | Возвращает значение указанного атрибута для установленного или опубликованного продукта.<br/>                                                                                                                                                         |
| [**продуктинфофромскрипт**](installer-productinfofromscript.md)<br/> |                       | Возвращает значение указанного атрибута, хранящегося в скрипте объявления.<br/>                                                                                                                                                         |
| [**Продуктов**](installer-products.md)<br/>                           |                       | Возвращает объект [**стринглист**](stringlist-object.md) , перечисляющий набор всех продуктов, установленных или объявленных для текущего пользователя и компьютера. <br/>                                                                                     |
| [**продуктсекс**](installer-productsex.md)<br/>                       |                       | Перечисляет коллекцию объектов [**Product**](product-object.md) .<br/>                                                                                                                                                                       |
| [**ProductState**](installer-productstate-property.md)<br/>          |                       | Возвращает сведения о состоянии установки для продукта.<br/>                                                                                                                                                                                        |
| [**куалифиердескриптион**](installer-qualifierdescription.md)<br/>   |                       | Возвращает текстовую строку, описывающую полный компонент.<br/>                                                                                                                                                                               |
| [**релатедпродуктс**](installer-relatedproducts.md)<br/>             |                       | Возвращает объект [**стринглист**](stringlist-object.md) , перечисляющий набор всех продуктов, установленных или объявленных для текущего пользователя и компьютера с указанным свойством [**UpgradeCode**](upgradecode.md) в своей таблице свойств.<br/> |
| [**шорткуттаржет**](installer-shortcuttarget.md)<br/>               |                       | Проверяет ярлык и возвращает его продукт, имя функции и компонент, если они доступны.<br/>                                                                                                                                                       |
| [**SummaryInformation**](installer-summaryinformation.md)<br/>       |                       | Возвращает объект [**суммаринфо**](summaryinfo-object.md) , который может использоваться для проверки, обновления и добавления свойств в поток сводных данных пакета или преобразования.<br/>                                                              |
| [**Duilevel**](installer-uilevel.md)<br/>                             | Чтение/запись<br/> | Указывает тип пользовательского интерфейса, используемого при открытии и обработке последующих пакетов в пределах текущего пространства процесса.<br/>                                                                                                           |
| [**Версия**](installer-version.md)<br/>                             |                       | возвращает строковое представление текущей версии установщик Windows.<br/>                                                                                                                                                              |



 

## <a name="requirements"></a>Requirements (Требования)



| Требование | Значение |
|--------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Версия<br/> | Windows установщик 5,0 на Windows Server 2012, Windows 8, Windows Server 2008 R2 или Windows 7. Windows установщик 4,0 или установщик Windows 4,5 на Windows Server 2008 или Windows Vista. Windows установщик на Windows Server 2003 или Windows XP<br/> |
| DLL<br/>     | <dl> <dt>Msi.dll</dt> </dl>                                                                                                                                                                      |
| IID<br/>     | IID \_ иинсталлер определен как 000C1090-0000-0000-C000-000000000046<br/>                                                                                                                                                                           |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[Использование интерфейса автоматизации](using-the-automation-interface.md)
</dt> <dt>

[Windows Примеры сценариев для установщика](windows-installer-scripting-examples.md)
</dt> </dl>

 

 




