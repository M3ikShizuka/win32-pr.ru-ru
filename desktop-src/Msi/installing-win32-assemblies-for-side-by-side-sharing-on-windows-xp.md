---
description: ниже описано, как создать пакет установщик Windows для установки сборки Win32.
ms.assetid: 1234e904-fc7f-4eb7-8c50-0c959bbf5261
title: Установка сборок Win32 для параллельного совместного доступа
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c62607b37a9abd26ce031d922e67fa3f48963193af054e1d71c6903474220e82
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119500704"
---
# <a name="installing-win32-assemblies-for-side-by-side-sharing"></a>Установка сборок Win32 для параллельного совместного доступа

ниже описано, как создать пакет установщик Windows для установки сборки Win32. Пакет устанавливает параллельную сборку в папку WinSxS для общего использования приложения. После установки пакета общая сборка становится доступной глобально для любого приложения, которое определяет зависимость от сборки в файле манифеста сборки. Установщик не выполняет глобальную регистрацию параллельной сборки в системе.

Обратите внимание, что вы можете установить общие параллельные сборки с помощью [модулей слияния](merge-modules.md).

прежде чем продолжить, необходимо понять, как создать пакет установщик Windows без сборок. Пример создания простой установки см. [в примере установки](an-installation-example.md).

**Параллельная установка общей сборки**

1.  определите компонент установщик Windows, включающий сборку Win32. Этот компонент может содержать другие ресурсы, которые всегда должны устанавливаться или удаляться вместе со сборкой. Все остальные компоненты приложения могут быть созданы так же, как и для установки без сборок. Добавьте строку в [таблицу Component](component-table.md) для компонента, содержащего сборку Win32. введите допустимый установщик Windows [GUID](guid.md) для этого кода компонента. Не используйте файл манифеста в качестве пути к ключу для этого компонента.
2.  добавьте строку в [таблицу феатурекомпонентс](featurecomponents-table.md) для привязки компонента к установщик Windows функции. Дополнительные сведения см. в разделе [компоненты и компоненты](components-and-features.md). установщик Windows функция должна быть частью функциональных возможностей приложения, распознаваемых пользователем. Сборка активируется, когда эта функция выбрана пользователем или произошла ошибка в приложении. Если сборка определяет дополнительную функцию, добавьте дополнительную строку в [таблицу функций](feature-table.md) для атрибутов компонента. Этот шаг не требуется при создании модуля слияния.
3.  Для параллельных сборок, сведений о привязке и активации, таких как классы COM, интерфейсы и библиотеки типов, хранятся в файлах манифеста, а не в реестре. Общие сборки хранят эти сведения в манифесте сборки. В системах, поддерживающих параллельные сборки, установщик пропускает обработку любых сведений о компоненте, который был задан в [таблице расширения](extension-table.md), [таблице команд](verb-table.md), [таблице typelib](typelib-table.md), [таблице MIME](mime-table.md), [таблице классов](class-table.md), таблице кодов [ProgID](progid-table.md)и [таблице AppID](appid-table.md). Сведения о привязке и активации могут быть указаны в этих таблицах для использования в системах, которые не поддерживают совместное использование сборок параллельно.
4.  Параллельная установка не регистрирует глобально сборку. установщик пропускает ее, если в [таблицу селфрег](selfreg-table.md)введены какие-либо сведения о собственной регистрации. Сведения о самостоятельной регистрации можно указать в таблице Селфрег для самостоятельной регистрации компонента в системах, которые не поддерживают совместное использование сборок параллельно.
5.  Добавьте любые другие сведения о реестре, за исключением привязки и активации, или самостоятельной регистрации компонента в [таблице реестра](registry-table.md), [таблице Ремоверегистри](removeregistry-table.md)и [таблице окружения](environment-table.md).
6.  Так как это общая сборка, не создает локальный файл. Не включайте сведения для этого компонента в [таблицу исолатедкомпонент](isolatedcomponent-table.md). Установщик пропускает таблицу Исолатедкомпонент для этого компонента в операционных системах, поддерживающих совместное использование. Добавьте сведения в таблицу Исолатедкомпонент, если хотите, чтобы сборка была закрыта в системах, поддерживающих локальные файлы.
7.  Чтобы обеспечить параллельный общий доступ, сборка Win32 должна быть установлена в папку WinSxS. Это достигается за счет того, что \_ для сборки остается столбец Application File в [таблице мсиассембли](msiassembly-table.md) со значением NULL. Это указывает установщику установить сборку в папку WinSxS, а не в папку компонента. Добавьте строку в [таблицу мсиассембли](msiassembly-table.md) для компонента, содержащего сборку Win32. Введите значение 1 в поле Attributes таблицы Мсиассембли, чтобы указать, что это сборка Win32. Для общей сборки оставьте \_ поле приложение файла пустым. Добавьте [действие мсипублишассемблиес](msipublishassemblies-action.md) в [таблицу Инсталлексекутесекуенце](installexecutesequence-table.md) или [таблицу адвтексекутесекуенце](advtexecutesequence-table.md). Добавьте [действие мсиунпублишассемблиес](msiunpublishassemblies-action.md) в таблицу инсталлексекутесекуенце.
8.  Добавьте строки в [таблицу мсиассемблинаме](msiassemblyname-table.md) для компонента. Добавьте по одной строке для каждой пары "имя — значение", указанной в разделе "assemblyIdentity" манифеста. Пример см. в разделе [мсиассемблинаме Table](msiassemblyname-table.md).

 

 



