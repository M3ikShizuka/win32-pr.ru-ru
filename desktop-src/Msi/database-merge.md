---
description: Метод Merge объекта Database выполняет слияние эталонной базы данных с базовой базой данных.
ms.assetid: 777060cf-c672-49d5-a1a8-8674fdc4bde4
title: Database. Merge, метод
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- Database.Merge
api_type:
- COM
api_location:
- Msi.dll
ms.openlocfilehash: 0a1d93ba6a9a4dc0304daba11c5868b77ece43b9
ms.sourcegitcommit: c8ec1ded1ffffc364d3c4f560bb2171da0dc5040
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2021
ms.locfileid: "105652045"
---
# <a name="databasemerge-method"></a>Database. Merge, метод

Метод **Merge** объекта [**Database**](database-object.md) выполняет слияние эталонной базы данных с базовой базой данных.

## <a name="syntax"></a>Синтаксис


```JScript
Database.Merge(
  reference,
  errorTable
)
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*reference* 
</dt> <dd>

Требуемый объект [**базы данных**](database-object.md) для слияния с базой данных.

</dd> <dt>

*еррортабле* 
</dt> <dd>

Необязательное имя таблицы, содержащей имена таблиц, содержащих конфликты слияния, число конфликтующих строк в таблице, а также ссылку на таблицу с конфликтом слияния.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Этот метод не возвращает значение.

## <a name="remarks"></a>Комментарии

Функцию [**мсидатабасемерже**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasemergea) и метод **Merge** объекта [**Database**](database-object.md) нельзя использовать для слияния модулей, входящих в пакет установки. Их не следует использовать для слияния [модулей слияния](merge-modules.md) в пакет установщик Windows. Чтобы включить модуль слияния в пакет установки, авторы пакетов установки должны следовать рекомендациям, описанным в разделе [применение модулей слияния](applying-merge-modules.md) .

Метод **Merge** не копирует встроенные CAB- [файлы](cabinet-files.md) или [встроенные преобразования](embedded-transforms.md) из эталонной базы данных в целевую базу данных. Внедренные потоки данных, перечисленные в таблице [двоичной таблицы](binary-table.md) или [значка](icon-table.md) , копируются из эталонной базы данных в целевую базу данных. Хранилища, внедренные в эталонную базу данных, не копируются в целевую базу данных.

Если таблица не указана, общее сообщение об ошибке содержит количество таблиц, содержащих конфликты слияния. Любая таблица может быть передана, но все остальные столбцы должны допускать значение null, так как операция обновления [таблицы ошибок](error-table.md) завершается ошибкой, если столбец не допускает значения NULL. Вновь созданную таблицу можно также передать, так как метод **Merge** автоматически создает используемые столбцы при обнаружении конфликтов слияния. Для представления конфликтов слияния используются два столбца. Первый столбец — это имя таблицы и первичный ключевой столбец. Второй столбец — это число строк в этой таблице, которые содержат ошибки слияния.

Если таблицы с одинаковыми именами в обеих базах данных не совпадают в количестве первичных ключей, типах столбцов, количестве столбцов или именах столбцов, метод **Merge** завершается ошибкой и отправляет сообщение об ошибке, сообщающее, что произошло.

Чтобы Таблица ошибок оставалась неизменной, обработчик ошибок должен зафиксировать базу данных, к которой принадлежит таблица ошибок. Однако эту фиксацию следует выполнять после использования третьего столбца для получения ссылок на таблицы, в которых возникли конфликты слияния.

В случае сбоя метода можно получить расширенные сведения об ошибке с помощью метода [**ластерроррекорд**](installer-lasterrorrecord.md) .

## <a name="requirements"></a>Требования



| Требование | Значение |
|--------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Версия<br/> | Установщик Windows 5,0 в Windows Server 2012, Windows 8, Windows Server 2008 R2 или Windows 7. Установщик Windows 4,0 или установщик Windows 4,5 на Windows Server 2008 или Windows Vista. установщик Windows в Windows Server 2003 или Windows XP<br/> |
| DLL<br/>     | <dl> <dt>Msi.dll</dt> </dl>                                                                                                                                                                      |
| IID<br/>     | IID \_ идатабасе определяется как 000C109D-0000-0000-C000-000000000046<br/>                                                                                                                                                                            |



 

 




