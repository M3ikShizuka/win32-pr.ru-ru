---
description: Чтобы включить функции установщика, приложение должно вызвать ряд функций при инициализации.
ms.assetid: cfeaf9b9-f772-49f9-8b6f-e7fd0c93cc9f
title: Инициализация приложения
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 221c5d97f0febb23ba73f98605ee6ec0e853940c
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127171815"
---
# <a name="initializing-an-application"></a>Инициализация приложения

Чтобы включить функции установщика, приложение должно вызвать ряд функций при инициализации. Дополнительные сведения см. в разделе [механизм установки](installation-mechanism.md). Следующие шаги описывают использование установщика для инициализации приложения.

**Инициализация приложения**

1.  Вызовите функцию [**мсижетпродукткоде**](/windows/desktop/api/Msi/nf-msi-msigetproductcodea) , чтобы приложение могла идентифицировать себя в установщике.

    Код продукта является обязательным параметром для многих функций установщика.

2.  Вызовите функцию [**мсижетусеринфо**](/windows/desktop/api/Msi/nf-msi-msigetuserinfoa) , чтобы получить сведения о пользователе при первом запуске приложения.

    Если вызов [**мсижетусеринфо**](/windows/desktop/api/Msi/nf-msi-msigetuserinfoa) завершается неудачей, вызовите функцию [**мсиколлектусеринфо**](/windows/desktop/api/Msi/nf-msi-msicollectuserinfoa) , чтобы получить сведения о пользователе.

3.  При необходимости Отобразите пользовательский интерфейс по умолчанию, вызвав функцию [**мсисетинтерналуи**](/windows/desktop/api/Msi/nf-msi-msisetinternalui) .

    Чтобы создать собственный пользовательский интерфейс, зарегистрируйте его с помощью установщика, вызвав функцию [**мсисетекстерналуи**](/windows/desktop/api/Msi/nf-msi-msisetexternaluia) .

4.  Вызовите функцию [**мсиенаблелог**](/windows/desktop/api/Msi/nf-msi-msienableloga) , чтобы задать уровень ведения журнала.
5.  Предоставление пользователю доступных функций путем перечисления функций приложения. Перечисление компонентов можно выполнить следующими способами.
    -   Запросите функции установщика. Например, перед рисованием кнопки или пункта меню приложение вызывает функцию [**мсикуерифеатурестате**](/windows/desktop/api/Msi/nf-msi-msiqueryfeaturestatea) , чтобы установщик мог проверить доступность этой функции.
    -   Перечислить все доступные компоненты одновременно, вызвав функцию [**мсиенумфеатурес**](/windows/desktop/api/Msi/nf-msi-msienumfeaturesa) . Чтобы использовать эту функцию, приложение должно многократно вызывать **мсиенумфеатурес** при увеличении индекса.
6.  Получите подробные сведения о текущей установке, вызвав следующие функции перечисления многократно, увеличивая переменную индекса для каждого вызова:

    -   Вызовите функцию [**мсиенумпродуктс**](/windows/desktop/api/Msi/nf-msi-msienumproductsa) для перечисления продуктов, зарегистрированных в установщике.
    -   Вызовите функцию [**мсиенумкомпонентс**](/windows/desktop/api/Msi/nf-msi-msienumcomponentsa) для перечисления компонентов.
    -   Вызовите функцию [**мсиенумкомпоненткуалифиерс**](/windows/desktop/api/Msi/nf-msi-msienumcomponentqualifiersa) , чтобы перечислить квалификаторы компонента.
    -   Вызовите функцию [**мсиенумклиентс**](/windows/desktop/api/Msi/nf-msi-msienumclientsa) , чтобы перечислить продукты для определенного компонента.

    Если возвращаемое значение функции перечисления является \_ успешным, то по-прежнему есть больше элементов для перечисления и функция должна вызываться повторно с увеличивающейся переменной индекса. Если возвращаемое значение не содержит \_ \_ больше \_ элементов, то все элементы были перечислены, и функция не должна вызываться повторно.

 

 



