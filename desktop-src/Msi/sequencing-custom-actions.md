---
description: Настраиваемые действия планируются в таблицах последовательности таким же образом, как стандартные действия.
ms.assetid: 1aea75b1-a498-405e-9208-91672455496b
title: Виртуализация настраиваемых действий
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ad7c24fb91247a36880cb808c9b8e10437312cf7
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127260915"
---
# <a name="sequencing-custom-actions"></a>Виртуализация настраиваемых действий

Настраиваемые действия планируются в таблицах последовательности таким же образом, как стандартные действия.

**Планирование настраиваемого действия в таблице последовательности**

1.  Введите имя настраиваемого действия (первичный ключ пользовательской программы [CustomAction](customaction-table.md)) в столбец Action таблицы [Sequence](sequence-table-detailed-example.md) .
2.  Введите последовательность настраиваемого действия относительно других действий в таблице в столбец Sequence таблицы [Sequence](sequence-table-detailed-example.md) . Дополнительные сведения о таблицах последовательностей см. в разделе [Использование таблицы последовательностей](using-a-sequence-table.md).
3.  Чтобы условно пропустить действие, введите условное выражение в столбец Условие таблицы [Sequence](sequence-table-detailed-example.md) . Установщик пропускает это действие, если выражение принимает значение FALSE.

Как и в случае со стандартными действиями, настраиваемые действия, запланированные в [инсталлуисекуенце](installuisequence-table.md) или [админуисекуенце](adminuisequence-table.md) , выполняются только в том случае, если для внутреннего пользовательского интерфейса задан полный уровень. Уровень пользовательского интерфейса задается с помощью функции [**мсисетинтерналуи**](/windows/desktop/api/Msi/nf-msi-msisetinternalui) .

Стандартные и настраиваемые действия, запланированные в таблицах [инсталлексекутесекуенце](installexecutesequence-table.md), [админексекутесекуенце](adminexecutesequence-table.md)или [адвтексекутесекуенце](advtexecutesequence-table.md) , не делают изменения в системе. Вместо этого Установщик помещает в очередь записи выполнения в скрипте для последующего выполнения во время работы службы установки. Если служба установки отсутствует, действия, запланированные в этих таблицах, выполняются в том же контексте, что и последовательность пользовательского интерфейса.

Если сервер установщика не зарегистрирован, пользовательские действия выполняются на стороне клиента. Если сервер зарегистрирован и использует режим полного пользовательского интерфейса, настраиваемые действия выполняются на стороне сервера.

При использовании полного пользовательского интерфейса с сервером начальные действия, выполняемые перед действием [инсталлвалидате](installvalidate-action.md) , выполняются на клиенте, чтобы обеспечить полное взаимодействие. Затем выполнение переключается на сервер, который повторяет эти действия и выполняет действия по выполнению скрипта. За ним следует возврат клиенту для получения окончательных действий.

Обратите внимание, что если продукт удаляется из-за того, что его компонент Top имеет значение отсутствует, свойство [**Remove**](remove.md) может не совпадать со значением ALL до действия [инсталлвалидате](installvalidate-action.md) . Это означает, что любое пользовательское действие, зависящее от Remove = ALL, должно быть упорядочено после действия Инсталлвалидате. Пользовательское действие может проверить удаление, чтобы определить, был ли установлен продукт полностью удален.

настраиваемые действия, которые ссылаются на установленный файл в качестве источника, например тип настраиваемого действия 17 (DLL), тип настраиваемого действия 18 (EXE), тип настраиваемого действия 21 (JScript) и тип настраиваемого действия 22 (VBScript), должны соответствовать следующим ограничениям последовательности.

-   Пользовательское действие должно быть упорядочено после действия [костфинализе](costfinalize-action.md) , чтобы можно было разрешить путь к файлу, на который указывает ссылка.
-   Если исходный файл еще не установлен на компьютере, отложенные (в скрипте) настраиваемые действия должны быть упорядочены после [инсталлфилес](installfiles-action.md).
-   Если исходный файл еще не установлен на компьютере, пользовательские действия нондеферред должны быть упорядочены после действия [инсталлинитиализе](installinitialize-action.md) .

следующие ограничения последовательности применяются к настраиваемым действиям, которые изменяют или обновляют пакет установщик Windows.

-   Если пользовательское действие изменяет пакет, например, добавляя строки в таблицу, действие должно быть упорядочено до действия [инсталлинитиализе](installinitialize-action.md) .
-   Если пользовательское действие вносит изменения, которые повлияют на стоимость, она должна быть упорядочена перед действием [костинитиализе](costfinalize-action.md) .
-   Если пользовательское действие изменяет состояние установки компонентов или компонентов, оно должно быть упорядочено перед действием [инсталлвалидате](installvalidate-action.md) .

 

 



