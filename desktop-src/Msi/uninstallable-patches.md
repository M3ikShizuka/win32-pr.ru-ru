---
description: Возможность удаления исправления зависит от того, как было создано исправление, от версии установщик Windows, используемой для установки исправления, и от изменений, внесенных исправлением в приложение.
ms.assetid: 95a5365c-e2ae-4e35-9aeb-67d04e67c7df
title: Неустанавливаемые исправления
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6ad46d85318378ed81d2278d3ea1290152723704
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104539874"
---
# <a name="uninstallable-patches"></a>Неустанавливаемые исправления

Возможность удаления исправления зависит от того, как было создано исправление, от версии установщик Windows, используемой для установки исправления, и от изменений, внесенных исправлением в приложение. Если исправление не удаляется, единственным способом удаления исправления является удаление всего приложения и его повторная установка без применения исправления.

Вы можете вызвать удаление исправлений, применяемых с установщик Windows версии 3,0, с помощью [параметров командной строки](command-line-options.md), функции [**Мсиремовепатчес**](/windows/desktop/api/Msi/nf-msi-msiremovepatchesa) или [**метода ремовепатчес**](installer-removepatches.md) , как описано в разделе [Удаление исправлений](uninstalling-patches.md) . Установщик Windows проверяет, что все исправления, перечисленные для удаления в свойстве [**мсипатчремове**](msipatchremove.md) , удалены. Если у пользователя нет прав для удаления исправления, это значит, что исправление неизвестно для продукта, политика исправления не позволяет удалить или исправление было помечено как недоступное, установщик возвращает ошибку, указывающую на неудачную транзакцию установки.

**Установщик Windows 2,0:** Не поддерживается. Исправления, примененные с помощью более ранней версии установщик Windows, чем установщик Windows 3,0, не могут быть удалены.

## <a name="patches-that-are-not-uninstallable"></a>Неудаляемые исправления

Исправление (MSP-файл), применяемое к установленному приложению, не может быть удалено в следующих случаях. Единственный способ удалить исправление, которое не может быть удалено, — это удалить исправленное приложение, а затем переустановить приложение без повторного применения исправления. В этом случае необходимо повторно применить все исправления, которые не нужно удалять из приложения.

-   Исправления, примененные с помощью версии установщик Windows, которая меньше установщик Windows 3,0, не могут быть удалены.
-   Исправления, применяемые к приложениям, установленным на компьютере с политикой [дисаблепатчунинсталл](disablepatchuninstall.md) , заданной администратором, не могут быть удалены. После установки этой [политики компьютера](machine-policies.md)никакие исправления на компьютере не могут быть удалены даже администратором.
-   Исправления, не имеющие таблицы [мсипатчметадата](msipatchmetadata-table.md) в базе данных, не могут быть удалены.
-   Исправления, не содержащие следующую строку в таблице [мсипатчметадата](msipatchmetadata-table.md) , не могут быть удалены. Обновление не может быть удалено для других значений компании, свойства и значения.

    | Company | Свойство     | Значение |
    |---------|--------------|-------|
    | Заканчивающ  | алловремовал | 1     |

    

     

-   Исправление было применено к приложению, установленному в контексте, для которого у пользователя недостаточно прав для удаления исправлений. В следующей таблице указаны недопустимые слова, указывающие, что администратор или пользователь без прав администратора не может удалить исправления из исправленных приложений, установленных в этом контексте. Слово «Allowed» (разрешено) в этой таблице означает, что привилегии не запрещают администратору или пользователю без прав администратора удалять исправления, однако по любой причине, описанной в этом разделе, по-прежнему может быть невозможно удалить обновление.

    | Контекст установки приложения        | Удаление исправления администратором | Удаление исправления без прав администратора                                                                                                                                                                                                                                                                             |
    |-----------------------------------------|----------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | Per-Machine                             | Допускается                          | Как правило, единственное исключение не допускается, если исправление было применено с помощью исправления (LUA). Исправление, отмеченное как исправление LUA, удаляется либо администраторами, либо без прав администратора. Исправление LUA доступно только для пакетов, установленных на компьютере с носителя и требующих специальной разработки.<br/> |
    | Per-User, не управляемый для текущего пользователя   | Разрешено                          | Разрешено                                                                                                                                                                                                                                                                                                          |
    | Неуправляемый Per-User для другого пользователя | Не разрешено                      | Не разрешено                                                                                                                                                                                                                                                                                                      |
    | Per-User, управляемый для текущего пользователя       | Допускается                          | Не разрешено                                                                                                                                                                                                                                                                                                      |
    | Per-User, управляемый для другого пользователя     | Не разрешено                      | Не разрешено                                                                                                                                                                                                                                                                                                      |

    

     

-   [Основное обновление](major-upgrades.md) , применяемое исправлением, не может быть удалено. Основное обновление приложения должно выполняться путем установки обновленного приложения (MSI-файла), а не исправления.
-   Исправления, применяемые к административной установке, не могут быть удалены. Установка исправлений для административных установок не рекомендуется. Текущий набор исправлений следует применить к компьютеру пользователя после того, как пользователь установит приложение из административного образа. Это может препятствовать тому, что [код пакета](package-codes.md) , кэшированный на компьютере пользователя, не станет отличаться от кода пакета в административной установке. Если код пакета, кэшированный на компьютере пользователя, отличается от того, который был в административной установке, переустановите приложение из административной установки, а затем Исследуйте обновление клиентского компьютера.
-   Когда исправление добавляет новое содержимое в любую из таблиц в следующем списке, установщик Windows помечает исправление как неудаляемое. При установке исправления можно добавить в установку новые файлы, сборки, записи реестра, компоненты или компоненты, добавив новые строки в таблицы базы данных, которые не включены в этот список.

    -   [AppId](appid-table.md)
    -   [BindImage](bindimage-table.md)
    -   [Класс](class-table.md)
    -   [ComPlus](complus-table.md)
    -   [CreateFolder](createfolder-table.md)
    -   [дупликатефиле](duplicatefile-table.md)
    -   [Среда](environment-table.md)
    -   [Расширение](extension-table.md)
    -   [Шрифт](font-table.md)
    -   [инифиле](inifile-table.md)
    -   [исолатедкомпонент](isolatedcomponent-table.md)
    -   [локкпермиссионс](lockpermissions-table.md)
    -   [мсилоккпермиссионсекс](msilockpermissionsex-table.md)
    -   [MIME](mime-table.md)
    -   [MoveFile](movefile-table.md)
    -   [мсисервицеконфиг](msiserviceconfig-table.md)
    -   [мсисервицеконфигфаилуреактионс](msiserviceconfigfailureactions-table.md)
    -   [одбкаттрибуте](odbcattribute-table.md)
    -   [одбкдатасаурце](odbcdatasource-table.md)
    -   [одбкдривер](odbcdriver-table.md)
    -   [одбксаурцеаттрибуте](odbcsourceattribute-table.md)
    -   [одбктранслатор](odbctranslator-table.md)
    -   [ID](progid-table.md)
    -   [публишкомпонент](publishcomponent-table.md)
    -   [ремовеинифиле](removeinifile-table.md)
    -   [селфрег](selfreg-table.md)
    -   [ServiceControl](servicecontrol-table.md)
    -   [сервицеинсталл](serviceinstall-table.md)
    -   [Экспорт Typelib](typelib-table.md)
    -   [Команда](verb-table.md)
    -   [!Note]  
        > Если исправление добавляет новое содержимое в таблицы [ремовефиле](removefile-table.md) или [ремоверегистри](removeregistry-table.md) , установщик Windows не помечает исправление как неудаляемое. Однако исправление не удаляется, если ресурс для удаления нового содержимого еще не существует в исходном пакете установки. Например, если исправление добавляет новую строку в таблицу Ремовефиле, то удаленный файл нельзя восстановить путем удаления исправления, если он является внешним по отношению к [таблице файлов](file-table.md). Файл должен быть создан в таблице файлов исходного пакета, а также применены исправления для удаления исправления.

         

## <a name="related-topics"></a>См. также

<dl> <dt>

[Последовательность исправлений](sequencing-patches.md)
</dt> <dt>

[Удаление исправлений](removing-patches.md)
</dt> <dt>

[Удаление исправлений](uninstalling-patches.md)
</dt> <dt>

[Настраиваемые действия при удалении исправлений](patch-uninstall-custom-actions.md)
</dt> <dt>

[**мсипатчремове**](msipatchremove.md)
</dt> <dt>

[**мсиенумаппликатионсекс**](/windows/desktop/api/Msi/nf-msi-msienumproductsexa)
</dt> <dt>

[**мсижетпатчинфоекс**](/windows/desktop/api/Msi/nf-msi-msigetpatchinfoexa)
</dt> <dt>

[**мсиремовепатчес**](/windows/desktop/api/Msi/nf-msi-msiremovepatchesa)
</dt> </dl>

 

 




