---
description: 'Пользователи и приложения с правами администратора могут использовать функции установщик Windows для инвентаризации установщик Windows приложений, компонентов, компонентов и исправлений, установленных в системе. Начиная с установщик Windows&\# 160; 3.0, пользователи и приложения с правами администратора могут перечислять установщик Windowsные приложения, компоненты, компоненты и исправления, установленные в системе всеми пользователями. Администраторы и приложения могут получать сведения о продукте или исправлении для конкретного пользователя или всех пользователей в системе. Приложения могут получать состояние компонента или компонента для конкретного пользователя. Функции инвентаризации, доступные начиная с установщик Windows&\# 160; 3.0, могут ограничить область элементов, которые будут найдены контекстом установки и контекстом пользователя. Существует три возможных контекста установки: "на пользователя", "на компьютер" и "на пользователя". Контекстом пользователя может быть определенный пользователь или все пользователи в системе. Версии функций инвентаризации установщик Windows более ранние, чем установщик Windows&\# 160; 3.0, могут перечислять только элементы, установленные в системе в контексте компьютера или в контексте текущего пользователя для каждого пользователя. Это ограничение предотвращает полную инвентаризацию всех установщик Windows продуктов и исправлений, установленных в системе пользователями, отличными от текущего пользователя. Перечисление Продуктсенумератинг Патчесобтаининг продукт Информатионобтаининг Patch Информатионобтаининг состояние компонента InformationObtaining сведения о состоянии компонента'
ms.assetid: ef95c3c8-b4c8-4305-8aa2-07ec74b3121b
title: Использование установщик Windows для инвентаризации продуктов и исправлений
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7915a8a58954c2e07a3dae9536ed7bae399e416b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104540242"
---
# <a name="using-windows-installer-to-inventory-products-and-patches"></a>Использование установщик Windows для инвентаризации продуктов и исправлений

Пользователи и приложения с правами администратора могут использовать функции установщик Windows для инвентаризации установщик Windows приложений, компонентов, компонентов и исправлений, установленных в системе.

Начиная с установщик Windows 3,0, пользователи и приложения с правами администратора могут перечислять установщик Windows приложения, компоненты, компоненты и исправления, установленные в системе всеми пользователями. Администраторы и приложения могут получать сведения о продукте или исправлении для конкретного пользователя или всех пользователей в системе. Приложения могут получать состояние компонента или компонента для конкретного пользователя.

Функции инвентаризации, доступные начиная с установщик Windows 3,0, могут ограничивать область элементов, которые будут найдены по контексту установки и контексту пользователя. Существует три возможных контекста установки: "на пользователя", "на компьютер" и "на пользователя". Контекстом пользователя может быть определенный пользователь или все пользователи в системе.

Версии функций инвентаризации установщик Windows, предшествующие установщик Windows 3,0, могут перечислять только элементы, установленные в системе в контексте компьютера или в контексте текущего пользователя для каждого пользователя. Это ограничение предотвращает полную инвентаризацию всех установщик Windows продуктов и исправлений, установленных в системе пользователями, отличными от текущего пользователя.

-   [Перечисление продуктов](#enumerating-products)
-   [Перечисление исправлений](#enumerating-patches)
-   [Получение сведений о продукте](#obtaining-product-information)
-   [Получение сведений об исправлениях](#obtaining-patch-information)
-   [Получение сведений о состоянии компонента](#obtaining-component-state-information)
-   [Получение сведений о состоянии компонента](#obtaining-feature-state-information)

## <a name="enumerating-products"></a>Перечисление продуктов

Используйте функцию [**мсиенумпродуктсекс**](/windows/desktop/api/Msi/nf-msi-msienumproductsexa) для перечисления установщик Windows приложений, установленных в системе. Эта функция может найти все установки на компьютере и пользовательские установки приложений (управляемые и неуправляемые) для текущего пользователя и других пользователей в системе. Используйте параметр *двконтекст* , чтобы указать, какой именно контекст установки должен быть найден. Можно указать любое сочетание возможных контекстов установки или любой из них. Используйте параметр *сзусерсид* , чтобы указать пользовательский контекст приложений для поиска.

## <a name="enumerating-patches"></a>Перечисление исправлений

Используйте функцию [**мсиенумпатчесекс**](/windows/desktop/api/Msi/nf-msi-msienumpatchesexa) для поиска исправлений, примененных к приложению. Эта функция может находить исправления, примененные к конкретному приложению, или ко всем приложениям в системе. Эта функция может найти исправления, применяемые ко всем установкам на компьютере, и установка приложений для отдельных пользователей (управляемое и неуправляемое) для текущего пользователя и других пользователей в системе.

Можно использовать контекст установки и контекст пользователя, чтобы ограничить перечисление исправлений определенным контекстом или во всех контекстах. Используйте параметр *двконтекст* , чтобы указать, какой именно контекст установки должен быть найден. Можно указать любое сочетание возможных контекстов установки или любой из них. Используйте параметр *сзусерсид* , чтобы указать пользовательский контекст приложений для поиска.

**Перечисление исправлений, примененных ко всем продуктам, объявленным или установленным всеми пользователями в системе**

-   Вызовите функцию [**мсиенумпатчесекс**](/windows/desktop/api/Msi/nf-msi-msienumpatchesexa) .
    -   Используйте значение **null** в качестве значения параметра *сзпродукткоде* .
    -   Используйте "s-1-1-0" в качестве значения параметра *сзусерсид* .
    -   Используйте "МСИИНСТАЛЛКОНТЕКСТ \_ ALL" в качестве значения параметра *двконтекст* .

**Перечисление исправлений, примененных ко всем продуктам, объявленным или установленным всеми пользователями в системе**

1.  Вызовите функцию [**мсиенумпродуктсекс**](/windows/desktop/api/Msi/nf-msi-msienumproductsexa) .

    -   Используйте значение **null** в качестве значения параметра *сзпродукткоде* .
    -   Используйте "s-1-1-0" в качестве значения параметра *сзусерсид* .
    -   Используйте "МСИИНСТАЛЛКОНТЕКСТ \_ ALL" в качестве значения параметра *двконтекст* .

    Функция предоставляет код продукта, контекст пользователя и контекст установки для каждого найденного приложения.

2.  Для каждого приложения, перечисленного на шаге 1, вызовите [**мсиенумпатчесекс**](/windows/desktop/api/Msi/nf-msi-msienumpatchesexa) для перечисления исправлений.

    Используйте коды продуктов, контексты пользователей и контексты установки, полученные из [**мсиенумпродуктсекс**](/windows/desktop/api/Msi/nf-msi-msienumproductsexa) , для значений *сзпродукткоде*, *сзусерсид* и *двконтекст*, а также для каждого вызова функции **мсиенумпродуктсекс** .

## <a name="obtaining-product-information"></a>Получение сведений о продукте

Используйте функцию [**мсижетпродуктинфоекс**](/windows/desktop/api/Msi/nf-msi-msigetproductinfoexa) для получения сведений о приложениях, объявленных или установленных в системе, а также о свойствах, которые могут быть получены. Эта функция может получать сведения для экземпляра приложения, установленного под учетной записью пользователя, отличной от текущего пользователя, но не может запросить экземпляр продукта, объявленный в неуправляемом контексте для каждого пользователя, для учетной записи пользователя, отличной от текущего пользователя.

Можно указать контекст установки и контекст пользователя, чтобы ограничить сведения о приложениях, установленных в определенном контексте. Используйте параметр *двконтекст* , чтобы указать, какой именно контекст установки должен быть найден. Можно указать только один из возможных контекстов установки. Используйте параметр *сзусерсид* , чтобы указать пользовательский контекст приложений для поиска.

## <a name="obtaining-patch-information"></a>Получение сведений об исправлениях

Приложение может вызвать функцию [**мсижетпатчинфоекс**](/windows/desktop/api/Msi/nf-msi-msigetpatchinfoexa) , чтобы запросить сведения о применении исправления к указанному экземпляру продукта. Такие свойства, как **локалпаккаже**, [**Transform**](transforms.md)и **State** , можно получить с помощью этой функции. Не все значения свойств гарантированно доступны для неуправляемых приложений для отдельных пользователей, если пользователь в данный момент не вошел в систему на компьютере. Можно указать только один из возможных контекстов установки.

Можно указать контекст установки и контекст пользователя, чтобы ограничить сведения об исправлениях, применяемых к приложениям, установленным в определенном контексте. Используйте параметр *двконтекст* , чтобы указать, какой именно контекст установки должен быть найден. Можно указать только один из возможных контекстов установки. Используйте параметр *сзусерсид* , чтобы указать пользовательский контекст приложений для поиска.

## <a name="obtaining-component-state-information"></a>Получение сведений о состоянии компонента

Приложения могут вызывать функцию [**мсикуерикомпонентстате**](/windows/desktop/api/Msi/nf-msi-msiquerycomponentstatea) для получения установленного состояния компонента. Эта функция определяет, установлен ли компонент локально или установлен для запуска из источника. Функция может запросить компонент экземпляра приложения, установленного под учетными записями пользователей, отличными от текущего пользователя, при условии, что продукт не объявлен в контексте неуправляемого пользователя для учетной записи пользователя, отличной от текущего пользователя.

Можно указать контекст установки и контекст пользователя, чтобы получить состояние компонентов для приложений, установленных в определенном контексте. Используйте параметр *двконтекст* , чтобы указать, какой именно контекст установки должен быть найден. Можно указать только один из возможных контекстов установки. Используйте параметр *сзусерсид* , чтобы указать пользовательский контекст приложений для поиска.

## <a name="obtaining-feature-state-information"></a>Получение сведений о состоянии компонента

Приложения могут вызывать функцию [**мсикуерифеатурестатикс**](/windows/desktop/api/Msi/nf-msi-msiqueryfeaturestateexa) для получения установленного состояния для компонента продукта. Эта функция определяет, будет ли компонент объявлен, установлен локально или установлен для запуска из источника. Функцию можно использовать для запроса любой функции экземпляра приложения, установленного под учетной записью компьютера, или любого контекста под текущей учетной записью пользователя или контекста, управляемого для каждого пользователя, в любой учетной записи пользователя, отличной от текущего пользователя. Эта функция не может запрашивать приложение, установленное в неуправляемом контексте "на пользователя" для учетной записи пользователя, отличной от текущего пользователя. Можно указать только один из возможных контекстов установки.

Можно указать контекст установки и контекст пользователя, чтобы получить сведения о состоянии компонентов для приложений, установленных в определенном контексте. Используйте параметр *двконтекст* , чтобы указать, какой именно контекст установки должен быть найден. Можно указать только один из возможных контекстов установки. Используйте параметр *сзусерсид* , чтобы указать пользовательский контекст приложений для поиска.

 

 



