---
description: Модули слияния (MSM-файлы) могут быть созданы для хранения атрибутов, настраиваемых потребителем модуля слияния.
ms.assetid: 461436f0-3a91-4a49-934a-f975bf13df40
title: Настраиваемые модули слияния
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 716688d947ae84279dc3409bf97abe4eb58a69d0
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105664592"
---
# <a name="configurable-merge-modules"></a>Настраиваемые модули слияния

Модули слияния (MSM-файлы) могут быть созданы для хранения атрибутов, настраиваемых потребителем модуля слияния. Это позволяет настроить модуль слияния во время слияния пакета установки и модуля, установленного конечным пользователем. Для настраиваемых модулей слияния требуется Mergemod.dll версии 2,0, но они могут запускаться в любой версии установщик Windows.

Реализация настраиваемых модулей слияния состоит из двух частей. Во-первых, при создании модуля слияния (MSM-файл) автор модуля слияния добавляет в базу данных модуля сведения, указывающие, какие элементы могут быть изменены, и как эти элементы могут быть настроены пользователем модуля. Автор добавляет записи в [таблицы базы данных модуля слияния](merge-module-database-tables.md) , зарезервированные для настраиваемой информации ([Модулеконфигуратион Table](moduleconfiguration-table.md) и [модулесубститутион Table](modulesubstitution-table.md)), обновляет [ \_ таблицу проверки](-validation-table.md)и добавляет записи для настраиваемых таблиц модулей слияния в [таблицу модулеигноретабле](moduleignoretable-table.md). Дополнения к таблице Модулеигноре необходимы для обеспечения совместимости модуля с Mergemod.dll версиями, предшествующими 2,0.

Во-вторых, при объединении модуля в пакет установки (MSI-файл) конечный пользователь модуля использует средство слияния. Средство слияния вызывает Mergemod.dll, чтобы предоставить сведения о конфигурации в модуле средству настройки клиента. Средство настройки может взаимодействовать с конечным пользователем, но не является обязательным для предоставления всех возможных параметров конфигурации. Если пользователь отклоняет выбор для настраиваемого элемента, модуль может предоставить значение по умолчанию. После того как пользователь предоставит выбранное средство настройки, средство слияния вызывает Mergemod.dll для выполнения слияния.

Настраиваемые модули слияния полностью совместимы с инструментами, предшествующими Mergemod.dll версии 2,0. В этих случаях средство использует значения по умолчанию в модуле.

Дополнительные сведения см. [в разделе Использование настраиваемых модулей слияния](using-configurable-merge-modules.md).

 

 



