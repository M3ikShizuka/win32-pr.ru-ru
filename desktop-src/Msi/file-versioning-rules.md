---
description: Ядро любого установщика — это фактическая установка файлов.
ms.assetid: e6f6d6a5-bdb0-4866-8d2c-56313d92c94c
title: Правила управления версиями файлов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c8dfda6a909450ba45cc213016a159bbbc8f9a54b958c7d4e37d051fd86935ad
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119828984"
---
# <a name="file-versioning-rules"></a>Правила управления версиями файлов

Ядро любого установщика — это фактическая установка файлов. Определение необходимости установки файла — сложный процесс. На самом верхнем уровне это определение зависит от того, отмечен ли компонент, к которому относится файл, помечен для установки. После определения того, что файл должен быть скопирован, процесс усложняется, если в целевой папке существует другой файл с таким же именем. В таких ситуациях для определения требуется набор правил, включающих следующие свойства:

-   Версия
-   Дата
-   Язык

Установщик использует эти правила только при попытке установить файл в расположение, которое уже содержит файл с тем же именем. в этом случае установщик Windows использует следующие правила: все остальные элементы равны, чтобы определить, следует ли установить.

Самая высокая версия — WINS — все остальные элементы равны, файл с самой высокой версией WINS, даже если файл на компьютере имеет самую новую версию.

Файлы с версиями Win — файл с версиями устанавливается поверх неверсии файла.

Предпочтение языку продукта. Если устанавливаемый файл имеет язык, отличный от языка на компьютере, следует предпочитать файл с языком, соответствующим устанавливаемому продукту. Независимые от языка файлы обрабатываются как еще один язык, поэтому устанавливаемый продукт является предпочтительным.

Несовпадение нескольких языков. После того, как разрабатываются все общие языки между устанавливаемым файлом и файлом на компьютере, все остальные языки используются в соответствии с тем, что требуется для установки продукта.

Сохранить языки надмножества — сохранить файл, поддерживающий несколько языков, независимо от того, находится ли он на компьютере или устанавливается.

Необновленные файлы — это пользовательские данные. Если дата изменения позже даты создания файла на компьютере, не следует устанавливать этот файл, так как пользовательские настройки будут удалены. Если измененные и созданные даты совпадают, установите файл. Если Дата создания позже измененной даты, файл считается неизмененным, а затем устанавливается файл.

Установка [вспомогательного файла](companion-files.md) зависит не от его собственных сведений о версиях файлов, но и от управления версиями его сопутствующего родителя. В случае сопутствующих файлов установка пропускается только в том случае, если родительский файл имеет более позднюю версию. Обратите внимание, что файл, который является ключевым путем для своего компонента, не должен быть сопутствующим файлом, так как в результате логика управления версиями файла пути к ключу определяется сопутствующим родительским файлом.

Неподдерживаемые файлы с использованием [сопутствующих файлов](companion-files.md)— неподдерживаемый файл, связанный с файлами с версиями с помощью сопровождающего механизма, соответствует правилам для файла с версией. Единственным исключением является то, что файл с версией на компьютере и устанавливаемый файл с установленными версиями имеют одинаковую версию и язык, но сопутствующий файл отсутствует на компьютере. В этом случае устанавливаемый вспомогательный файл используется несмотря на то, что используется файл с версией на компьютере. Кроме того, если свойство [**REINSTALLMODE**](reinstallmode.md) содержит параметры перезаписи старых версий ("o" или "e"), а версия сопутствующего файла совпадает с файлом, уже установленным на компьютере, устанавливается Необновленный файл с использованием сопутствующего файла.

Правила являются глобальными — правила определения того, когда следует устанавливать файл, находятся в одном месте в установщике и являются глобальными, то есть они применяются ко всем файлам одинаково.

Примеры форматов, используемых для версий файлов, см. в разделе Тип данных [версии](version.md) . Дополнительные сведения см. в разделе [Замена существующих файлов](replacing-existing-files.md) или [Управление версиями файлов по умолчанию](default-file-versioning.md).

 

 



