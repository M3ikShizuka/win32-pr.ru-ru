---
description: Свойство Феатуревалидстатес объекта Session возвращает целое число, представляющее битовые флаги с каждым соответствующим битом, представляющим допустимое состояние установки для указанного компонента.
ms.assetid: 8a1f6911-b0a6-4fac-ba77-df4f1b7d15e2
title: Свойство Session. Феатуревалидстатес
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- Session.FeatureValidStates
api_type:
- COM
api_location:
- Msi.dll
ms.openlocfilehash: 2c6b7e2683ea9c3e82684f77057319fb359429036cd43192fa9793ff7490386e
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119629214"
---
# <a name="sessionfeaturevalidstates-property"></a>Свойство Session. Феатуревалидстатес

Свойство **феатуревалидстатес** объекта [**Session**](session-object.md) возвращает целое число, представляющее битовые флаги с каждым соответствующим битом, представляющим допустимое состояние установки для указанного компонента.

Это свойство доступно только для чтения.

## <a name="syntax"></a>Синтаксис


```JScript
propVal = Session.FeatureValidStates
```



## <a name="property-value"></a>Значение свойства

Обязательное строковое имя элемента компонента, для которого должны быть получены допустимые состояния установки.

## <a name="remarks"></a>Remarks

Возвращаемое значение состоит из битовых флагов, как показано ниже. Бит 0. Если задано, local является допустимым состоянием. Бит 1. Если задано, источник является допустимым состоянием.

Свойство **феатуревалидстатес** успешно работает только после того, как установщик вызывал действия [костинитиализе](costinitialize-action.md) и [костфинализе](costfinalize-action.md) .

**Феатуревалидстатес** определяет срок действия состояния, запрашивая все компоненты, связанные с указанным компонентом, без учета текущего установленного состояния любого компонента.

Возможные допустимые состояния для функции определяются следующим образом.

-   Если компонент не содержит компонентов, INSTALLSTATE \_ Local и InstallState \_ Source являются допустимыми состояниями для функции.
-   Если хотя бы один компонент компонента имеет атрибут Мсидбкомпонентаттрибутеслокалонли или Мсидбкомпонентаттрибутесоптионал, INSTALLSTATE \_ local является допустимым состоянием для этой функции.
-   Если хотя бы один компонент компонента имеет атрибут Мсидбкомпонентаттрибутессаурцеонли или Мсидбкомпонентаттрибутесоптионал, INSTALLSTATE \_ source является допустимым состоянием для этой функции.
-   Если файл компонента, относящегося к компоненту, исправлен или находится в сжатом источнике, INSTALLSTATE \_ source не включается в качестве допустимого состояния для этой функции.
-   \_Объявление InstallState не является допустимым, если компонент запретил объявление (мсидбфеатуреаттрибутесдисалловадвертисе) или компонент требует поддержки платформы для объявления (мсидбфеатуреаттрибутеснаунсуппортедадвертисе), а платформа не поддерживает ее.
-   INSTALLSTATE \_ отсутствует — допустимое состояние для функции, если его атрибуты не включают мсидбфеатуреаттрибутесуидисалловабсент.
-   Допустимые состояния дочерних компонентов, помеченных для выполнения родительского компонента (Мсидбфеатуреаттрибутесфолловпарент), основаны на действии родительского компонента или установленном состоянии.

Если свойство завершается неудачно, можно получить расширенные сведения об ошибке с помощью метода [**ластерроррекорд**](installer-lasterrorrecord.md) .

## <a name="requirements"></a>Requirements (Требования)



| Требование | Значение |
|--------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Версия<br/> | Windows установщик 5,0 на Windows Server 2012, Windows 8, Windows Server 2008 R2 или Windows 7. Windows установщик 4,0 или установщик Windows 4,5 на Windows Server 2008 или Windows Vista. Windows установщик на Windows Server 2003 или Windows XP<br/> |
| DLL<br/>     | <dl> <dt>Msi.dll</dt> </dl>                                                                                                                                                                      |
| IID<br/>     | IID \_ ISession определяется как 000C109E-0000-0000-C000-000000000046<br/>                                                                                                                                                                             |



 

 




