---
description: Свойство Феатуререкуестстате — это свойство для чтения и записи объекта Session.
ms.assetid: ba19603b-ac81-4a8b-81ca-ad5f28974599
title: Свойство Session. Феатуререкуестстате
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- Session.FeatureRequestState
api_type:
- COM
api_location:
- Msi.dll
ms.openlocfilehash: c1198f96dde27ec4056ad099f1bb4a3eed591fdd3d390c843cec42af82d4140e
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119629224"
---
# <a name="sessionfeaturerequeststate-property"></a>Свойство Session. Феатуререкуестстате

Свойство **феатуререкуестстате** — это свойство для чтения и записи объекта [**Session**](session-object.md) . Его можно использовать для получения текущего состояния действия функции или запроса изменений в действии функции и ее подкомпонентов. Эта функция должна называться в таблице [Feature](feature-table.md) . Если запрашивается изменение состояния действия компонента, также может быть изменено состояние действия всех компонентов измененного компонента. Состояние действия компонентов, совместно используемых несколькими компонентами, будет изменено в соответствии с новым состоянием действия функции (см. примечания). Свойство **феатуререкуестстате** можно также использовать для настройки всех компонентов одновременно, указав ключевое слово ALL вместо имени конкретного компонента.

Это свойство доступно для чтения и записи.

## <a name="syntax"></a>Синтаксис


```JScript
propVal = Session.FeatureRequestState
Session.FeatureRequestState = propVal 
```



## <a name="property-value"></a>Значение свойства

Обязательная строка, указывающая имя настраиваемого компонента. Чтобы задать для всех компонентов требуемое состояние запроса, используйте зарезервированное слово без учета регистра: ALL.

## <a name="remarks"></a>Remarks

Перед вызовом **феатуререкуестстате** необходимо вызвать метод [**сетинсталллевел**](session-setinstalllevel.md) .

Если текущее состояние компонента запрашивается, свойство **феатуререкуестстате** возвращает одно из следующих значений.



| Имя состояния выбора         | Значение                                                               |
|------------------------------|-----------------------------------------------------------------------|
| Мсиинсталлстатеункновн =-1  | Для функции не предпринимается никаких действий. Это эквивалентно значению NULL.       |
| Мсиинсталлстатеадвертисед = 1 | Функция должна быть объявлена.                                          |
| Мсиинсталлстатеабсент = 2    | Компонент будет удален.                                             |
| Мсиинсталлстателокал = 3     | Компонент должен быть установлен в качестве локальной для запуска.                              |
| Мсиинсталлстатесаурце = 4    | Компонент должен быть установлен в качестве запуска с исходным кодом.                        |
| Мсиинсталлстатедефаулт = 5   | Компонент должен быть переустановлен с текущим состоянием действия функции. |



 

Например, следующий пример получает текущее состояние "Мифеатуре" из настраиваемого действия VBScript.


```VB
Dim iRequestState
iRequestState = Session.FeatureRequestState("MyFeature")
```



Если настраивается состояние компонента, свойству **феатуререкуестстате** должно быть присвоено одно из следующих значений.



| Имя состояния выбора          | Значение                                 |
|-------------------------------|-----------------------------------------|
| Мсиинсталлстатеадвертисед = 1 | Объявите функцию.                  |
| Мсиинсталлстатеабсент = 2     | Удалите компонент.                     |
| Мсиинсталлстателокал = 3      | Установите компонент в качестве локального запуска.       |
| Мсиинсталлстатесаурце = 4     | Установите компонент в качестве запуска из источника. |



 

Например, следующие запросы из настраиваемого действия VBScript, которые должны быть установлены для локального запуска на компьютере.


```VB
Session.FeatureRequestState("MyFeature")=3
```



При вызове **феатуререкуестстате** установщик пытается установить состояние действия каждого компонента, привязанного к указанному компоненту, в указанное состояние, как можно лучше. Однако существуют распространенные ситуации, когда запрос не может быть полностью одобрен. Например, если функция привязана к двум компонентам, компоненту A и компоненту б, через таблицу [феатурекомпонентс](featurecomponents-table.md) и компонент a имеет атрибут **мсидбкомпонентаттрибутеслокалонли** , а компонент b имеет атрибут **мсидбкомпонентаттрибутессаурцеонли** . В этом случае, если **феатуререкуестстате** вызывается с запрошенным состоянием либо мсиинсталлстателокал, либо мсиинсталлстатесаурце, запрос не может быть учтен для обоих компонентов. В этом случае оба компонента можно включить с компонентом A, для которого задано значение Мсиинсталлстателокал, а для компонента B — значение Мсиинсталлстатесаурце.

Если несколько компонентов связаны с одним компонентом, Последнее состояние действия этого компонента определяется следующим образом: если хотя бы один вызов компонента для установки компонента выполняется локально, он устанавливается Мсиинсталлстателокал. Если по крайней мере один из функций вызывает запуск компонента с исходного носителя, он устанавливается Мсиинсталлстатесаурце. Если по крайней мере один вызов функции для удаления компонента, действие имеет состояние Мсиинсталлстатеабсент. Дополнительные сведения о выборе компонентов для установки см. в таблице [Feature](feature-table.md) .

Если свойство завершается неудачно, можно получить расширенные сведения об ошибке с помощью метода [**ластерроррекорд**](installer-lasterrorrecord.md) .

## <a name="requirements"></a>Требования



| Требование | Значение |
|--------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Версия<br/> | Windows установщик 5,0 на Windows Server 2012, Windows 8, Windows Server 2008 R2 или Windows 7. Windows установщик 4,0 или установщик Windows 4,5 на Windows Server 2008 или Windows Vista. Windows установщик на Windows Server 2003 или Windows XP<br/> |
| DLL<br/>     | <dl> <dt>Msi.dll</dt> </dl>                                                                                                                                                                      |
| IID<br/>     | IID \_ ISession определяется как 000C109E-0000-0000-C000-000000000046<br/>                                                                                                                                                                             |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**Сеанс**](session-object.md)
</dt> <dt>

[Компонент](feature-table.md)
</dt> </dl>

 

 




