---
description: Метод Modify объекта View изменяет строку базы данных с измененным объектом Record, полученным методом FETCH.
ms.assetid: c3c500aa-070f-41d7-90f7-db979452d24f
title: Метод представления. Modify
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- View.Modify
api_type:
- COM
api_location:
- Msi.dll
ms.openlocfilehash: b4dc97f2e3b5f85d472cfcbfad6017ce4e051e4b
ms.sourcegitcommit: c8ec1ded1ffffc364d3c4f560bb2171da0dc5040
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2021
ms.locfileid: "105652001"
---
# <a name="viewmodify-method"></a>Метод представления. Modify

Метод **Modify** объекта [**View**](view-object.md) изменяет строку базы данных с измененным объектом [**Record**](record-object.md) , полученным методом [**Fetch**](view-fetch.md) .

## <a name="syntax"></a>Синтаксис


```JScript
View.Modify(
  action,
  record
)
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*action* 
</dt> <dd>

Требуемое действие, выполняемое над строкой базы данных. Это действие является одним из показанных в следующей таблице.



| Имя действия                                                                                                                                                                                                                                                                                                     | Значение                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="msiViewModifySeek"></span><span id="msiviewmodifyseek"></span><span id="MSIVIEWMODIFYSEEK"></span><dl> <dt>**мсивиевмодифисик**</dt> <dt>— 1</dt> </dl>                                            | Обновляет сведения в указанной записи без изменения ее расположения в результирующем наборе и не влияет на последующие операции выборки. Затем запись может использоваться для последующего обновления, удаления и обновления. Все первичные ключевые столбцы таблицы должны быть в запросе, а в записи должно быть по крайней мере столько полей, сколько имеет запрос. Поиск нельзя использовать с многотабличными запросами. См. примечания. Этот режим нельзя использовать с представлением, содержащим объединения.<br/>                                                                             |
| <span id="msiViewModifyRefresh"></span><span id="msiviewmodifyrefresh"></span><span id="MSIVIEWMODIFYREFRESH"></span><dl> <dt>**мсивиевмодифирефреш**</dt> <dt>0</dt> </dl>                                 | Обновляет сведения в записи. Сначала необходимо вызвать метод [**Fetch**](view-fetch.md) с той же записью. Не выполняется для удаленной строки. Работает с записями для чтения и записи и только для чтения.<br/>                                                                                                                                                                                                                                                                                                                                                     |
| <span id="msiViewModifyInsert"></span><span id="msiviewmodifyinsert"></span><span id="MSIVIEWMODIFYINSERT"></span><dl> <dt>**мсивиевмодифинсерт**</dt> <dt>1</dt> </dl>                                     | Вставляет запись. Завершается ошибкой, если существует строка с теми же первичными ключами. Завершается с базой данных только для чтения. Этот режим нельзя использовать с представлением, содержащим объединения.<br/>                                                                                                                                                                                                                                                                                                                                                                                          |
| <span id="msiViewModifyUpdate"></span><span id="msiviewmodifyupdate"></span><span id="MSIVIEWMODIFYUPDATE"></span><dl> <dt>**мсивиевмодифюпдате**</dt> <dt>2</dt> </dl>                                     | Обновляет существующую запись. Только не первичные ключи. Сначала необходимо вызвать метод [**Fetch**](view-fetch.md) с той же записью. Завершается сбоем с удаленной записью. Работает только с записями, предназначенными для чтения и записи.<br/>                                                                                                                                                                                                                                                                                                                                                     |
| <span id="msiViewModifyAssign"></span><span id="msiviewmodifyassign"></span><span id="MSIVIEWMODIFYASSIGN"></span><dl> <dt>**мсивиевмодифяссигн**</dt> <dt>3</dt> </dl>                                     | Записывает текущие данные в курсоре в строку таблицы. Обновляет запись, если первичные ключи соответствуют существующей строке и вставляются, если они не совпадают. Завершается с базой данных только для чтения. Этот режим нельзя использовать с представлением, содержащим объединения.<br/>                                                                                                                                                                                                                                                                                                                 |
| <span id="msiViewModifyReplace"></span><span id="msiviewmodifyreplace"></span><span id="MSIVIEWMODIFYREPLACE"></span><dl> <dt>**мсивиевмодифиреплаце**</dt> <dt>4</dt> </dl>                                 | Обновляет или удаляет и вставляет запись в таблицу. Сначала необходимо вызвать метод [**Fetch**](view-fetch.md) с той же записью. Обновляет запись, если первичные ключи не изменяются. Удаляет старую строку и вставляет новый, если первичные ключи изменились. Завершается с базой данных только для чтения. Этот режим нельзя использовать с представлением, содержащим объединения.<br/>                                                                                                                                                                                                           |
| <span id="msiViewModifyMerge"></span><span id="msiviewmodifymerge"></span><span id="MSIVIEWMODIFYMERGE"></span><dl> <dt>**мсивиевмодифимерже**</dt> <dt>5</dt> </dl>                                         | Вставляет или проверяет запись в таблице. Вставляет, если первичные ключи не совпадают ни с одной строкой, и при условии соответствия. Завершается ошибкой, если запись не соответствует данным в таблице. Завершается ошибкой, если имеется запись с дублирующимся ключом, который не идентичен. Работает только с записями, предназначенными для чтения и записи. Этот режим нельзя использовать с представлением, содержащим объединения.<br/>                                                                                                                                                                                                |
| <span id="msiViewModifyDelete"></span><span id="msiviewmodifydelete"></span><span id="MSIVIEWMODIFYDELETE"></span><dl> <dt>**мсивиевмодифиделете**</dt> <dt>6</dt> </dl>                                     | Удаляет строку из таблицы. Сначала необходимо вызвать метод [**Fetch**](view-fetch.md) с той же записью. Завершается ошибкой, если строка была удалена. Работает только с записями, предназначенными для чтения и записи. Этот режим нельзя использовать с представлением, содержащим объединения.<br/>                                                                                                                                                                                                                                                                                                             |
| <span id="msiViewModifyInsertTemporary"></span><span id="msiviewmodifyinserttemporary"></span><span id="MSIVIEWMODIFYINSERTTEMPORARY"></span><dl> <dt>**мсивиевмодифинсерттемпорари**</dt> <dt>7</dt> </dl> | Вставляет временную запись. Сведения не являются постоянными. Завершается ошибкой, если существует строка с таким же первичным ключом. Работает только с записями, предназначенными для чтения и записи. Этот режим нельзя использовать с представлением, содержащим объединения.<br/>                                                                                                                                                                                                                                                                                                                                           |
| <span id="msiViewModifyValidate"></span><span id="msiviewmodifyvalidate"></span><span id="MSIVIEWMODIFYVALIDATE"></span><dl> <dt>**мсивиевмодифивалидате**</dt> <dt>8</dt> </dl>                             | Проверяет запись. Не проверяется по объединениям. Сначала необходимо вызвать метод [**Fetch**](view-fetch.md) с той же записью. Получение ошибок проверки с помощью метода с методом WITH [**Error**](view-geterror.md) . Работает с записями, предназначенными только для чтения и записи. Этот режим нельзя использовать с представлением, содержащим объединения.<br/>                                                                                                                                                                                                                                         |
| <span id="msiViewModifyValidateNew"></span><span id="msiviewmodifyvalidatenew"></span><span id="MSIVIEWMODIFYVALIDATENEW"></span><dl> <dt>**мсивиевмодифивалидатенев**</dt> <dt>9</dt> </dl>                 | Проверяет новую запись. Не проверяется по объединениям. Проверяет наличие повторяющихся ключей. Получает ошибки проверки, вызывая метод метода вызывали [**ошибку**](view-geterror.md) . Требует вызова метода [**мсидатабасе. OpenView**](database-openview.md) с изменением значения. Работает с записями, предназначенными только для чтения и записи. Этот режим нельзя использовать с представлением, содержащим объединения.<br/>                                                                                                                                                                                 |
| <span id="msiViewModifyValidateField"></span><span id="msiviewmodifyvalidatefield"></span><span id="MSIVIEWMODIFYVALIDATEFIELD"></span><dl> <dt>**мсивиевмодифивалидатефиелд**</dt> <dt>10</dt> </dl>        | Проверяет поля выбранной или новой записи. Может проверять одно или несколько полей неполной записи. Получает ошибки проверки, вызывая метод метода вызывали [**ошибку**](view-geterror.md) . Работает с записями, предназначенными только для чтения и записи. Этот режим нельзя использовать с представлением, содержащим объединения.<br/>                                                                                                                                                                                                                                                             |
| <span id="msiViewModifyValidateDelete"></span><span id="msiviewmodifyvalidatedelete"></span><span id="MSIVIEWMODIFYVALIDATEDELETE"></span><dl> <dt>**мсивиевмодифивалидатеделете**</dt> <dt>11</dt> </dl>    | Проверяет запись, которая будет удалена позже. Сначала необходимо вызвать метод [**Fetch**](view-fetch.md) с той же записью. Завершается ошибкой, если другая строка ссылается на первичные ключи этой строки. Проверка на наличие первичных ключей этой строки в свойствах или строках не проверяется. Не проверяет, является ли столбец внешним ключом для нескольких таблиц. Получите ошибки проверки, вызвав метод с методомической [**ошибки**](view-geterror.md) . Работает с записями, предназначенными только для чтения и записи. Этот режим нельзя использовать с представлением, содержащим объединения.<br/> |



 

</dd> <dt>

*record* 
</dt> <dd>

Обязательный. Объект [**Record**](record-object.md) , полученный методом [**Fetch**](view-fetch.md) с измененными данными поля.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Этот метод не возвращает значение.

## <a name="remarks"></a>Комментарии

Этот метод должен вызываться после метода [**EXECUTE**](view-execute.md) .

Чтобы выполнить любую инструкцию SQL, необходимо создать представление. Однако представление, в котором не создается результирующий набор, например CREATE TABLE или INSERT INTO, не может использоваться с методом **Modify** для обновления таблиц, если это представление.

Значения Мсивиевмодифивалидате, Мсивиевмодифивалидатенев, Мсивиевмодифивалидатефиелд и Мсивиевмодифивалидатеделете метода **Modify** не выполняют фактических обновлений; они гарантируют допустимость данных в записи. Для использования этих действий требуется, чтобы база данных содержала [ \_ таблицу проверки](-validation-table.md) .

Невозможно получить запись, содержащую двоичные данные из одной базы данных, а затем использовать эту запись для вставки данных в совершенно другую базу данных. Чтобы переместить двоичные данные из одной базы данных в другую, необходимо экспортировать данные в файл и затем импортировать их в новую базу данных с помощью метода [**сетстреам**](record-setstream.md) объекта [**Record**](record-object.md) . Это гарантирует, что каждая база данных будет иметь собственную копию двоичных данных.

> [!Note]  
> Настраиваемые действия могут добавлять, изменять или удалять временные строки, столбцы или таблицы из базы данных. Настраиваемые действия не могут изменять постоянные данные в базе данных, например данные, которые являются частью базы данных, хранящейся на диске. Дополнительные сведения см. в разделе [доступ к текущему сеансу установщика из настраиваемого действия](accessing-the-current-installer-session-from-inside-a-custom-action.md).

 

В случае сбоя метода можно получить расширенные сведения об ошибке с помощью метода [**ластерроррекорд**](installer-lasterrorrecord.md) .

## <a name="requirements"></a>Требования



| Требование | Значение |
|--------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Версия<br/> | Установщик Windows 5,0 в Windows Server 2012, Windows 8, Windows Server 2008 R2 или Windows 7. Установщик Windows 4,0 или установщик Windows 4,5 на Windows Server 2008 или Windows Vista. установщик Windows в Windows Server 2003 или Windows XP<br/> |
| DLL<br/>     | <dl> <dt>Msi.dll</dt> </dl>                                                                                                                                                                      |
| IID<br/>     | IID \_ IView определен как 000C109C-0000-0000-C000-000000000046<br/>                                                                                                                                                                                |



 

 




