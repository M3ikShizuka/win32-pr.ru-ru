---
description: Список возможных причин, по которым установщик Windows удалению не удалось удалить все файлы приложения.
ms.assetid: 0a856f0f-a829-478e-a83b-dade7b05b4f2
title: Удаление потерянных файлов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0d5eeceb45c2139d146c32bdf9917e41885688df
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105663575"
---
# <a name="removing-stranded-files"></a>Удаление потерянных файлов

Если файл, который должен быть удален с компьютера пользователя, остается установленным после удаления, установщик может не удалить компонент, содержащий этот файл, по одной или нескольким из следующих причин:

-   Бит Мсидбкомпонентаттрибутесперманент был задан для компонента в столбце Attributes [таблицы Component](component-table.md).
-   Не было указано значение для компонента в столбце ComponentId таблицы Component.
-   Компонент используется другим приложением или компонентом, который по-прежнему установлен.
-   В таблице [условий](condition-table.md) указано условие, которое включает функцию во время установки и отключает эту функцию во время удаления.
-   Файл ключа для компонента содержит предыдущее число ссылок в разделе **HKLM** \\ **Software** \\ **Microsoft** \\ **Windows** \\ **CurrentVersion** \\ **SharedDLLs**.
-   Компонент устанавливается в системную папку, а любой файл в компоненте имеет предыдущее число ссылок в разделе **HKLM** \\ **Software** \\ **Microsoft** \\ **Windows** \\ **CurrentVersion** \\ **SharedDLLs**.
-   Установщик Windows не удаляет файлы или разделы реестра, защищенные [Защита ресурсов Windows](../wfp/windows-resource-protection-portal.md) (WRP). Дополнительные сведения см. [в разделе использование установщик Windows и защита ресурсов Windows](windows-resource-protection-on-windows-vista.md). В Windows Server 2003, Windows XP и Windows 2000 установщик не удаляет файлы, защищенные с помощью защиты файлов Windows (WFP). Если файл пути ключа или ключ реестра компонента защищены с помощью WFP или WRP, установщик не удаляет компонент.
    > [!Note]  
    > Поскольку установщик Windows не устанавливает, не обновляет или не удаляет ресурсы, защищенные WRP, не следует включать защищенные ресурсы в пакет установки. Вместо этого используйте только [поддерживаемые механизмы замены ресурсов](../wfp/supported-file-replacement-mechanisms.md) , описанные в разделе [Защита ресурсов Windows](../wfp/windows-resource-protection-portal.md) .

     

 

 
