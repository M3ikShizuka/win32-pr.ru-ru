---
description: В таблице Модулесубститутион указаны настраиваемые поля базы данных модуля, а также шаблон для конфигурации каждого поля.
ms.assetid: 8e94c31f-b3a7-4f3a-aec4-32b0e1dd5400
title: Таблица Модулесубститутион
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a66fbbb0898a254b181d02eca78f33709f8c0e037de140a37893ea3887af6390
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118628594"
---
# <a name="modulesubstitution-table"></a>Таблица Модулесубститутион

В таблице Модулесубститутион указаны настраиваемые поля базы данных модуля, а также шаблон для конфигурации каждого поля. Пользователь или средство слияния может запросить эту таблицу, чтобы определить, какие операции конфигурации следует выполнить. Эта таблица не объединяется с целевой базой данных.

Следующие таблицы не могут содержать настраиваемые поля и не должны быть перечислены в этой таблице:

Таблица Модулесубститутион

[Таблица Модулеконфигуратион](moduleconfiguration-table.md)

[Таблица Модуликсклусион](moduleexclusion-table.md)

[Таблица ModuleSignature](modulesignature-table.md)

Таблица Модулесубститутион содержит следующие столбцы.



| Столбец | Type                         | Ключ | Допускает значения NULL |
|--------|------------------------------|-----|----------|
| Таблица  | [Идентификатор](identifier.md) | Д   | Нет        |
| Строка    | [Text](text.md)             | Д   | Нет        |
| Столбец | [Идентификатор](identifier.md) | Д   | Нет        |
| Значение  | [Text](text.md)             | Нет   | Д        |



 

## <a name="columns"></a>Столбцы

<dl> <dt>

<span id="Table"></span><span id="table"></span><span id="TABLE"></span>Таблица
</dt> <dd>

В этом столбце указывается имя таблицы, изменяемой в базе данных модуля.

</dd> <dt>

<span id="Row"></span><span id="row"></span><span id="ROW"></span>Строки
</dt> <dd>

В этом поле указываются первичные ключи целевой строки в таблице, которая указана в столбце Таблица. Несколько первичных ключей разделяются точкой с запятой. Целевые строки выбираются для изменения перед внесением изменений в целевую таблицу. Если одна запись в таблице Модулесубститутион изменяет поле первичного ключа целевой строки, другие записи в таблице Модулесубститутион применяются на основе исходных данных первичного ключа, а не в результате замены первичного ключа. Порядок подстановки строк не определен.

Значения в этом столбце всегда находятся в [специальном формате кмсм](cmsm-special-format.md). Литеральную точку с запятой (";") или знак равенства ("=") можно добавить путем добавления символа обратной косой черты. '\\'. Значение NULL для ключа обозначается значением NULL, начальной точкой с запятой, двумя последовательными точками с запятой или точкой с запятой в конце, в зависимости от того, является ли значение NULL единственным, первым, средним или последним ключевым значением столбца Key.

</dd> <dt>

<span id="Column"></span><span id="column"></span><span id="COLUMN"></span>Рубрик
</dt> <dd>

Это поле указывает целевой столбец в строке, названной в столбце строка. Если несколько строк в таблице Модулесубститутион изменяют различные столбцы той же целевой строки, то перед вставкой измененной строки в базу данных выполняются все подстановки столбцов. Порядок подстановки столбцов не определен.

</dd> <dt>

<span id="Value"></span><span id="value"></span><span id="VALUE"></span>Значений
</dt> <dd>

Этот столбец содержит строку, которая предоставляет шаблон форматирования для данных, подставляемых в целевое поле, определяемое таблицей, строкой и столбцом. При обнаружении строки подстановки вида \[ = элемент а \] строка, включая символы квадратной скобки, заменяется значением настраиваемого элемента a. Настраиваемый элемент «item a» указывается в столбце «имя» [таблицы модулеконфигуратион](moduleconfiguration-table.md) , а его значение предоставляется средством слияния. Если средство слияния отклоняет предоставление значения для любого элемента в строке замены, заменяется значение по умолчанию, заданное в столбце DefaultValue таблицы Модулеконфигуратион. Если строка ссылается на элемент, не наявляющийся в таблице Модулеконфигуратион, происходит сбой слияния.

-   В этом столбце используется [Специальный формат кмсм](cmsm-special-format.md). В таблицу можно добавить литеральную точку с запятой (";") или знак равенства ("="), представив префикс обратной косой черты. '\\'.
-   Поле значения может содержать несколько строк подстановки. Например, конфигурация элементов "Food1" и "Food2" в строке: " \[ = Food1 \] хорошо, но \[ = Food2 \] лучше, так как \[ = Food2 больше \] нутритиаус".
-   Строки замены не должны быть вложенными. Недопустимый шаблон " \[ = AB \[ = CDE \] \] ".
-   Если поле значения имеет значение null, а целевое поле не допускает значения NULL, то слияние завершается ошибкой и создается объект ошибки типа Мсмеррорбаднуллсубститутион и добавляется в список ошибок. Дополнительные сведения см. в разделе Типы ошибок, описанные в [**\_ функции Get Type**](/windows/win32/api/mergemod/nf-mergemod-imsmerror-get_type).
-   Если значение поля value равно значению NULL GUID: {00000000-0000-0000-0000-000000000000} , то идентификатор GUID NULL заменяется именем функции перед тем, как строка будет объединена в модуль. Дополнительные сведения см. [в разделе ссылки на функции в модулях слияния](referencing-features-in-merge-modules.md).
-   Шаблон в поле значение вычисляется перед вставкой в целевое поле. Подстановка в строку выполняется перед заменой каких-либо функций.
-   Если в столбце значение вычисляется только строка, сопоставленная только с целыми числами (с необязательным символом + или-), строка преобразуется в целое число перед подстановкой в целевое поле [типа целочисленного формата](integer-format-types.md). Если в шаблоне вычисляется строка, которая не состоит только из целых символов (и необязательно + или-), результат не может быть заменен на конечное поле целого числа. Попытка вставить нецелое число в поле целого числа приводит к сбою слияния и добавлению объекта ошибки Мсмеррорбадсубститутионтипе в список ошибок.
-   Если целевой столбец, указанный в полях таблица и столбец, является [типом текстового формата](text-format-types.md), а вычисление поля значения приводит к [типу целочисленного формата](integer-format-types.md), десятичное представление числа вставляется в текстовое поле Target.
-   Если целевое поле имеет [тип целочисленного формата](integer-format-types.md), и поле значения состоит из списка элементов в [формате битового](bitfield-format-types.md)массива без разделителей, значение в целевом поле объединяется с помощью побитового оператора **and** с обратным значением побитового **или** из всех значений маски из элементов, а затем объединяется с помощью побитового оператора **or** с каждым из элементов Integer или битового поля, маскированного соответствующими значениями маски. По сути, это явно устанавливает биты из свойств в указанные значения, но оставляет все остальные биты только в ячейке.
-   Если поле значения имеет [тип формата ключа](key-format-types.md)и является ключом в таблице, использующей несколько первичных ключей, то за именем элемента может следовать точка с запятой и целочисленное значение, указывающее на Отсчитываемый от 1 индекс в наборе значений, которые вместе образуют первичный ключ. Если целое число не указано, используется значение 1. Например, в [таблице элементов управления](control-table.md) есть два первичных ключевых столбца, диалоговое окно \_ и элемент управления. Значение элемента «Item1», которое является ключом в таблице элементов управления, будет иметь вид «Диалогнаме; Контролнаме ", где Диалогнаме — это значение в таблице Dialog \_ , а контролнаме — значение в столбце Control. Чтобы заменить только Контролнаме, следует использовать строку подстановки \[ = Item1; 2 \] .

</dd> </dl>

## <a name="remarks"></a>Remarks

Таблица Модулесубститион используется [настраиваемыми модулями слияния](configurable-merge-modules.md). Для создания настраиваемого модуля слияния требуется Mergemod.dll версии 2,0 или более поздней.

Чтобы обеспечить совместимость с версиями Mergemod.dll более ранними, чем версия 2,0, [таблицы модулеконфигуратион](moduleconfiguration-table.md) и модулесубститутион должны быть добавлены в [таблицу модулеигноретабле](moduleignoretable-table.md) каждого модуля.

 

 
