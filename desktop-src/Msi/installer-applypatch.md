---
description: Для каждого продукта, указанного пакетом обновления в качестве право на получение исправления, метод Апплипатч объекта Installer вызывает установку и задает для свойства PATCH путь к пакету обновления.
ms.assetid: eee93b6d-f45b-40ae-8e17-cfe6f46b66f4
title: Метод Installer. Апплипатч
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- Installer.ApplyPatch
api_type:
- COM
api_location:
- Msi.dll
ms.openlocfilehash: c4bcb1ba1dc988f3c28188b4b448dba611b83c6cffbe7f942710569ac089776f
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118633231"
---
# <a name="installerapplypatch-method"></a>Метод Installer. Апплипатч

Для каждого продукта, указанного пакетом обновления в качестве право на получение исправления, метод **апплипатч** объекта [**Installer**](installer-object.md) вызывает установку и задает для свойства [**Patch**](patch.md) путь к пакету обновления.

## <a name="syntax"></a>Синтаксис


```JScript
Installer.ApplyPatch(
  PatchPackage,
  InstallPackage,
  InstallType,
  CommandLine
)
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*патчпаккаже* 
</dt> <dd>

Указывает путь к пакету исправлений.

</dd> <dt>

*инсталлпаккаже* 
</dt> <dd>

Если для *инсталлтипе* задано значение Мсиинсталлтипенетворкимаже, *инсталлпаккаже* указывает путь к продукту, для которого устанавливается исправление. Если для *инсталлтипе* задано значение мсиинсталлтипедефаулт, а *инсталлпаккаже* имеет значение 0, установщик применяет исправление ко всем соответствующим продуктам, перечисленным в пакете исправлений.

Если *инсталлтипе* имеет значение мсиинсталлтипесинглеинстанце, установщик применяет исправление к продукту, указанному в *инсталлпаккаже*. В этом случае другие подходящие продукты, перечисленные в пакете исправлений, игнорируются, а параметр *инсталлпаккаже* содержит строку с завершающим нулем, представляющую код продукта экземпляра для исправления. для этого типа установки требуется версия установщик Windows, поставляемая с Windows Server 2003 или более поздней версии или установщик Windows XP SP1 или более поздней версии.

</dd> <dt>

*InstallType* 
</dt> <dd>

Этот параметр указывает тип установки для исправления. Параметр *инсталлтипе* игнорируется, если *инсталлпаккаже* опущен.



| Значение                                                                                                                                                                                                                                            | Значение                                                                                                                                                                                                                                                                                                                                                                                                                   |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="msiInstallTypeNetworkImage"></span><span id="msiinstalltypenetworkimage"></span><span id="MSIINSTALLTYPENETWORKIMAGE"></span><dl> <dt>**мсиинсталлтипенетворкимаже**</dt> </dl> | Указывает административную установку. В этом случае для *инсталлпаккаже* необходимо задать путь к пакету. Значение 1 для Мсиинсталлтипенетворкимаже указывает административную установку.<br/>                                                                                                                                                                                                                    |
| <span id="msiInstallTypeDefault"></span><span id="msiinstalltypedefault"></span><span id="MSIINSTALLTYPEDEFAULT"></span><dl> <dt>**мсиинсталлтипедефаулт**</dt> </dl>                     | Ищет в системе продукты для исправления. В этом случае *инсталлпаккаже* должно быть пустой строкой.<br/>                                                                                                                                                                                                                                                                                                                 |
| <span id="msiInstallSingleInstance"></span><span id="msiinstallsingleinstance"></span><span id="MSIINSTALLSINGLEINSTANCE"></span><dl> <dt>**мсиинсталлсинглеинстанце**</dt> </dl>         | Исправление продукта, указанного параметром *инсталлпаккаже*. *Инсталлпаккаже* — это код продукта экземпляра для исправления. для этого типа установки требуется версия установщик Windows, поставляемая с Windows Server 2003 или более поздней версии или установщик Windows XP SP1 или более поздней версии. Дополнительные сведения см. в разделе [Установка нескольких экземпляров продуктов и исправлений](installing-multiple-instances-of-products-and-patches.md).<br/> |



 

</dd> <dt>

*CommandLine* 
</dt> <dd>

Задает параметры свойств, заданные в командной строке. См. раздел "Примечания".

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Этот метод не возвращает значение.

## <a name="remarks"></a>Remarks

Так как разделителем списков для преобразований, источников и исправлений является точка с запятой, этот символ не следует использовать для имен файлов и путей.

Свойство [**REINSTALL**](reinstall.md) требуется при применении [небольшого обновления](small-updates.md) или исправления [незначительного обновления](minor-upgrades.md) . Без этого свойства исправление регистрируется в системе, но не может обновлять файлы.

**установщик Windows 2,0:** При применении [небольшого обновления](small-updates.md) или исправления [незначительного обновления](minor-upgrades.md) необходимо задать свойство [**переустановки**](reinstall.md) в командной строке. Для исправлений, не использующих [Пользовательский тип действия 51](custom-action-type-51.md) для автоматической установки свойств **REINSTALL** и [**REINSTALLMODE**](reinstallmode.md) , необходимо явно задать свойство **REINSTALL** с параметром *commandline* . Задайте свойство **REINSTALL** , чтобы получить список функций, затронутых исправлением, или используйте практическую настройку по умолчанию (REINSTALL = ALL). Значение свойства **REINSTALLMODE** по умолчанию — "omus".

**установщик Windows 3,0 и более поздних версий:** начиная с версии установщик Windows 3,0, свойство [**reinstall**](reinstall.md) настраивается установщиком и не требуется задавать в командной строке.

## <a name="requirements"></a>Requirements (Требования)



| Требование | Значение |
|--------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Версия<br/> | Windows установщик 5,0 на Windows Server 2012, Windows 8, Windows Server 2008 R2 или Windows 7. Windows установщик 4,0 или установщик Windows 4,5 на Windows Server 2008 или Windows Vista. Windows установщик 3,0 или более поздней версии на Windows Server 2003 или Windows XP.<br/> |
| DLL<br/>     | <dl> <dt>Msi.dll</dt> </dl>                                                                                                                                                                                    |
| IID<br/>     | IID \_ иинсталлер определен как 000C1090-0000-0000-C000-000000000046<br/>                                                                                                                                                                                         |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**мсиапплипатч**](/windows/desktop/api/Msi/nf-msi-msiapplypatcha)
</dt> <dt>

[Сведения о свойствах](about-properties.md)
</dt> <dt>

[не поддерживается в установщик Windows 2,0 и более ранних версиях](not-supported-in-windows-installer-version-2-0.md)
</dt> </dl>

 

 




