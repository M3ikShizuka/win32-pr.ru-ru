---
description: Пользователи и приложения с правами администратора могут получать и изменять сведения о сети, URL-адресах и источнике мультимедиа для установщик Windows приложений и исправлений в системе.
ms.assetid: e8c66bad-f594-4926-b3b4-c8b245dcfa83
title: Управление источниками установки
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d7fc45253af20ae5f9792ee3a5ec7dd318c80295
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105674307"
---
# <a name="managing-installation-sources"></a>Управление источниками установки

Пользователи и приложения с правами администратора могут получать и изменять сведения о сети, URL-адресах и источнике мультимедиа для установщик Windows приложений и исправлений в системе.

**Установщик Windows 2,0:** Не поддерживается. Администраторы не могут читать, переупорядочивать или заменять записи в исходном списке и не могут изменять или извлекать свойства исходного списка. Можно управлять сетевыми источниками, но не URL-адресами или источниками мультимедиа. Администраторы могут управлять списками источников только для приложений на уровне компьютера или приложений, установленных в качестве каждого пользователя для текущего пользователя. Это не позволяет администраторам использовать версии, предшествующие установщик Windows версии 3,0, от управления информацией списка источников для всех пользователей в системе.

**Установщик Windows 3,0 и более поздних версий:** Пользователи и приложения с правами администратора могут получать и изменять сведения о списке источников для установщик Windows приложений и исправлений, установленных в системе для всех пользователей. Функции списка источников можно использовать для управления списками источников и свойствами исходного списка для сети, URL-адресов и источников мультимедиа. Установщик может переупорядочить списки источников данных из внешнего процесса.

Пользователи и приложения с правами администратора могут считывать и изменять следующие типы сведений о списке источников:

-   Списки источников для приложений и исправлений, установленных для всех пользователей в системе.
-   Списки источников для источников исправлений, которые существуют отдельно от источников приложений.
-   Список источников для URL-адресов и источников мультимедиа, которые существуют отдельно от сетевых источников.
-   Свойства исходного списка, такие как [**медиапаккажепас**](mediapackagepath.md), [**DiskPrompt**](diskprompt.md), **ластуседсаурце**, **ластуседтипе** и **PackageName**.

Функции списков источников могут ограничивать область списков источников, найденных, путем указания контекста установки и контекста пользователя. Существует три возможных контекста установки: на пользователя (неуправляемый), на компьютере и на уровне пользователя. Контекст пользователя может быть определенным пользователем или всеми пользователями в системе.

Пользователи, не являющиеся администраторами, не могут изменять исходный список экземпляра приложения или исправления, который существует в контексте другого пользователя (управляемого или неуправляемого). Администраторы, не являющиеся администраторами, могут изменять исходные списки экземпляра приложения или исправления, установленные в следующих контекстах:

-   Собственный контекст для каждого пользователя (неуправляемый).
-   Контекст компьютера, но только в том случае, если политики [дисаблебровсе](disablebrowse.md), [алловлоккдовнбровсе](allowlockdownbrowse.md)и [AlwaysInstallElevated](alwaysinstallelevated.md) позволяют им просматривать источник приложения или исправления.
-   Собственный контекст, управляемый для каждого пользователя, но только в том случае, если политики [дисаблебровсе](disablebrowse.md), [алловлоккдовнбровсе](allowlockdownbrowse.md)и [AlwaysInstallElevated](alwaysinstallelevated.md) позволяют им просматривать источник приложения или исправления.

Администраторы могут изменять любой исходный список, который не может быть изменен администратором. Кроме того, администраторы и приложения с правами администратора могут изменять списки источников приложения или исправления, установленные в следующих контекстах:

-   Контекст для каждого компьютера.
-   Собственные пользовательские и управляемые контексты для каждого пользователя (неуправляемые).
-   Управляемый пользователем контекст другого пользователя.

> [!Note]  
> Пользователи и приложения с правами администратора не могут изменять исходный список экземпляра приложения или исправления, установленного в контексте другого пользователя (не управляемого) для каждого пользователя.

 

## <a name="managing-network-and-url-sources-for-products-and-patches"></a>Управление сетью и источниками URL-адресов для продуктов и исправлений

Используйте функцию [**мсисаурцелистаддсаурцеекс**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddsourceexa) для добавления или изменения порядка исходного списка сетевых и URL-источников для исправления или приложения в определенном контексте. Используйте параметр *двконтекст* , чтобы указать контекст установки. Используйте параметр *сзусерсид* , чтобы указать контекст пользователя.

Используйте функцию [**мсисаурцелистаддсаурцеекс**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddsourceexa) , чтобы создать список источников для исправления, которое еще не было применено к каким-либо приложениям в указанном контексте. Это может быть полезно при регистрации исправления для повышения привилегий. Дополнительные сведения о регистрации повышенных привилегий для исправления см. в статье об [установке исправлений Per-User управляемых приложениях](patching-per-user-managed-applications.md).

Используйте функцию [**мсисаурцелистклеарсаурце**](/windows/desktop/api/Msi/nf-msi-msisourcelistclearsourcea) для удаления существующего источника для приложения или исправления в указанном контексте. Удаление текущего источника для приложения или исправления приводит к тому, что установщик будет искать исходный список источника при следующей необходимости в источнике.

Используйте функцию [**мсисаурцелистенумсаурцес**](/windows/desktop/api/Msi/nf-msi-msisourcelistenumsourcesa) для перечисления источников в исходном списке указанного исправления или приложения.

## <a name="managing-media-sources-for-products-and-patches"></a>Управление источниками мультимедиа для продуктов и исправлений

Используйте функцию [**мсисаурцелистаддмедиадиск**](/windows/desktop/api/Msi/nf-msi-msisourcelistaddmediadiska) для добавления или обновления сведений о диске источника носителя зарегистрированного приложения или исправления. Каждая запись уникально идентифицируется с помощью идентификатора диска. Если диск уже существует, он будет обновлен с учетом новой метки тома и значений в строке диска. Если диск не существует, то создается новая запись диска с новыми значениями.

Используйте функцию [**мсисаурцелистклеармедиадиск**](/windows/desktop/api/Msi/nf-msi-msisourcelistclearmediadiska) для удаления существующего зарегистрированного диска в источнике носителя для приложения или исправления в определенном контексте.

Используйте функцию [**мсисаурцелистенуммедиадискс**](/windows/desktop/api/Msi/nf-msi-msisourcelistenummediadisksa) для перечисления списка дисков, зарегистрированных в источнике мультимедиа для приложения или исправления.

## <a name="retrieval-and-modification-of-source-list-information"></a>Получение и изменение сведений о списке источников

Используйте функции [**мсисаурцелистжетинфо**](/windows/desktop/api/Msi/nf-msi-msisourcelistgetinfoa) и [**мсисаурцелистсетинфо**](/windows/desktop/api/Msi/nf-msi-msisourcelistsetinfoa) , чтобы получить или изменить сведения о списке источников для приложения или исправления в определенном контексте. Используйте параметр *двконтекст* , чтобы указать контекст установки. Используйте параметр *сзусерсид* , чтобы указать контекст пользователя.

Можно получить доступ к свойствам исходного списка, таким как [**медиапаккажепас**](mediapackagepath.md), [**DiskPrompt**](diskprompt.md), **ластуседсаурце**, **ластуседтипе** и **PackageName** .

> [!Note]  
> Свойство списка источников **ластуседтипе** может быть прочитано только. Его нельзя задать напрямую с помощью функции [**мсисаурцелистсетинфо**](/windows/desktop/api/Msi/nf-msi-msisourcelistsetinfoa) .

 

## <a name="clearing-the-complete-source-list-or-forcing-a-source-resolution"></a>Очистка полного списка источников или принудительное разрешение источника

Используйте функцию [**мсисаурцелистклеараллекс**](/windows/desktop/api/Msi/nf-msi-msisourcelistclearallexa) , чтобы удалить все существующие источники заданного типа источника для указанного приложения или экземпляра исправления. Регистрация исправления также удаляется, если это исправление не установлено ни одним приложением в том же контексте. Используйте параметр *двконтекст* , чтобы указать контекст установки. Используйте параметр *сзусерсид* , чтобы указать контекст пользователя.

Используйте [**мсисаурцелистфорцересолутионекс**](/windows/desktop/api/Msi/nf-msi-msisourcelistforceresolutionexa) , чтобы очистить последнюю использованную запись источника для приложения или исправления в указанном контексте. Эта функция удаляет регистрацию свойства с именем **ластуседсаурце**. Эта функция не влияет на список зарегистрированных источников. Очистка регистрации **ластуседсаурце** приводит к тому, что установщик выполняет разрешение источника для зарегистрированных источников в следующий раз, когда ему потребуется источник.

 

 



