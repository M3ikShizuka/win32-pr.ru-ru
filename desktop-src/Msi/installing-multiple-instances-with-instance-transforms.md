---
description: В этом разделе приводятся рекомендации по установке или переустановке нескольких экземпляров, использующих преобразования экземпляра.
ms.assetid: cf9076b1-5674-4ba8-9890-e981221d7b03
title: Установка нескольких экземпляров с преобразованиями экземпляров
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8a25b2cba8fd91316d62692d278345e0f7d9751f018e1c33239412988bfe118a
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "120074904"
---
# <a name="installing-multiple-instances-with-instance-transforms"></a>Установка нескольких экземпляров с преобразованиями экземпляров

В этом разделе приводятся рекомендации по установке или переустановке нескольких экземпляров, использующих преобразования экземпляра.

-   При установке нового экземпляра с преобразованием экземпляра Включите свойство **мсиневинстанце** и задайте **мсиневинстанце**= 1.
-   При установке нового экземпляра с преобразованием экземпляра Включите свойство Transforms и установите первое преобразование в списке преобразований в преобразование экземпляра, которое изменяет код продукта. Все преобразования настройки должны следовать за преобразованием экземпляра в начале этого списка.
-   Самым простым способом запуска установки обслуживания и переустановки экземпляра является ссылка на код продукта экземпляра. При запуске установки обслуживания с помощью пути к пакету необходимо также указать код продукта экземпляра. В командной строке используйте параметр/n {код продукта}. Из кода или скрипта используйте свойство **мсиинстанцегуид** .

В следующем примере показано, как установить новый экземпляр из командной строки, в которой преобразование экземпляра предваряется двоеточием, указывающим, что преобразование внедрено в пакет.

**msiexec/I mypackage.msi преобразования =: instance. MST МСИНЕВИНСТАНЦЕ = 1/QB**

В следующем примере показано, как установить новый экземпляр с помощью [**мсиинсталлпродукт**](/windows/desktop/api/Msi/nf-msi-msiinstallproducta).

``` syntax
UINT uiStat = MsiInstallProduct(_T("path to mypackage.msi"), _T("TRANSFORMS=:instance.mst MSINEWINSTANCE=1"));
```

В следующем примере показано, как установить новый экземпляр из скрипта.

``` syntax
Dim Installer As Object
Set Installer = CreateObject("WindowsInstaller.Installer")
Installer.InstallProduct "path to mypackage.msi", "TRANSFORMS=:instance.mst MSINEWINSTANCE=1"
```

В следующем примере переустанавливается экземпляр без повторного кэширования пакета. На экземпляр ссылается его код продукта {00000001-0002-0000-0000-624474736554} .

**msiexec/I {00000001-0002-0000-0000-624474736554} REINSTALL = ALL REINSTALLMODE = omus/QB**

В следующем примере переустанавливается экземпляр и повторно кэшируется пакет из командной строки. На экземпляр ссылается путь пакета. Если продукт изначально установлен с преобразованием экземпляра, необходимо указать только параметр/n {код продукта}.

**msiexec/I c: \\ newpath \\mypackage.msi/N {00000001-0002-0000-0000-624474736554} REINSTALL = ALL REINSTALLMODE = vomus REINSTALL/QB**

В следующем примере переустанавливается экземпляр и кэшируется пакет с помощью **мсиинсталлпродукт**. На экземпляр ссылается путь пакета. Используйте свойство **мсиинстанцегуид** для предоставления кода продукта экземпляра.

``` syntax
UINT uiStat = MsiInstallProduct(_T("path to mypackage.msi"), _T("MSIINSTANCEGUID={00000001-0002-0000-0000-624474736554}  REINSTALL=ALL REINSTALLMODE=vomus"));
```

В следующем примере переустанавливается экземпляр и кэшируется пакет с помощью скрипта. Используйте свойство **мсиинстанцегуид** для предоставления кода продукта экземпляра.

``` syntax
Dim Installer As Object
Set Installer = CreateObject("WindowsInstaller.Installer")
Installer.InstallProduct "path to mypackage.msi", "MSIINSTANCEGUID={00000001-0002-0000-0000-624474736554}  REINSTALL=ALL REINSTALLMODE=vomus"
```

В следующем примере показано, как объявить экземпляр с помощью командной строки.

**msiexec/жм mypackage.msi/t: instance. MST/c/QB**

В следующем примере показано, как установить, чтобы объявить экземпляр с помощью **мсиадвертисепродуктекс**.

``` syntax
UINT uiStat = MsiAdvertiseProductEx(_T("path to mypackage.msi"), NULL, _T(":instance.mst"), 0, 0, MSIADVERTISEOPTIONS_INSTANCE);
```

В следующем примере показано, как применить исправление к экземпляру из командной строки. Если продукт изначально был установлен с преобразованием экземпляра, необходимо включить параметр/n {код продукта}.

**msiexec/p мипатч. MSP/n {00000001-0002-0000-0000-624474736554} /QB**

В следующем примере показано, как применить исправление к экземпляру установки с помощью [**мсиапплипатч**](/windows/desktop/api/Msi/nf-msi-msiapplypatcha).

``` syntax
UINT uiStat = MsiApplyPatch(_T("path to mypatch.msp"), _T("{00000001-0002-0000-0000-624474736554}"), INSTALLTYPE_SINGLE_INSTANCE, _T("REINSTALL=ALL REINSTALLMODE=omus"));
```

Дополнительные сведения см. в разделе [Установка нескольких экземпляров продуктов и исправлений](installing-multiple-instances-of-products-and-patches.md) и [Создание нескольких экземпляров с помощью преобразований экземпляров](authoring-multiple-instances-with-instance-transforms.md).

 

 



