---
description: параметры командной строки для msiexec.exe для установщик Windows 3,0 и более ранних версий. Содержит таблицу, в которой показаны параметры, параметры и описания. Примеры установки продуктов и других задач.
ms.assetid: a70d8cc8-af47-4472-aabc-97481d97080d
title: Параметры командной строки
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c72592046bdd30429d373f23f1d2cb39bc9497ee
ms.sourcegitcommit: c276a8912787b2cda74dcf54eb96df961bb1188b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2021
ms.locfileid: "122630910"
---
# <a name="command-line-options"></a>Параметры командной строки

Исполняемая программа, которая интерпретирует пакеты и устанавливает продукты, Msiexec.exe. Обратите внимание, что в процессе msiexec также устанавливается уровень ошибок, соответствующий [кодам системных ошибок](/windows/desktop/Debug/system-error-codes). Параметры командной строки не учитывают регистр.

параметры командной строки в следующей таблице доступны в установщик Windows 3,0 и более ранних версиях. также доступны [стандартные параметры Command-Line установщика](standard-installer-command-line-options.md) , начиная с установщик Windows 3,0.



<table>
<colgroup>
<col  />
<col  />
<col  />
</colgroup>
<thead>
<tr class="header">
<th>Параметр</th>
<th>Параметры</th>
<th>Значение</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>/I</strong></td>
<td><em>Пакет | ProductCode</em></td>
<td>Устанавливает или настраивает продукт.<br/></td>
</tr>
<tr class="even">
<td><strong>/f</strong></td>
<td>[p | o | e | d | c | a | u | m | s | v] <em>Пакетная</em> | <em>Код продукта</em></td>
<td>Восстанавливает продукт. Этот параметр игнорирует все значения свойств, указанные в командной строке. Список аргументов по умолчанию для этого параметра — "omus". Этот параметр использует тот же список аргументов, что и свойство <a href="reinstallmode.md"><strong>REINSTALLMODE</strong></a> .<br/> p — Переустановка только в случае отсутствия файла.<br/> o — переустановка, если файл отсутствует или установлена более старая версия.<br/> e — переустанавливает, если файл отсутствует или установлена эквивалентная или старая версия.<br/> d — переустановка, если файл отсутствует или установлена другая версия.<br/> c — переустанавливает, если файл отсутствует или сохраненная контрольная сумма не соответствует вычисленному значению. Исправляет только те файлы, которые имеют <strong>мсидбфилеаттрибутесчекксум</strong> в столбце Attributes таблицы <a href="file-table.md">File</a> .<br/> a — принудительная переустановка всех файлов.<br/> u — Перезапись всех необходимых записей реестра для конкретного пользователя.<br/> m — перезаписывает все необходимые записи реестра для конкретного компьютера.<br/> s — перезаписывает все существующие ярлыки.<br/> v — выполняется из источника и повторно кэшируется в локальном пакете. Не используйте параметр <strong>v</strong> REINSTALL для первой установки приложения или компонента.<br/></td>
</tr>
<tr class="odd">
<td><strong>/a</strong></td>
<td><em>Пакет</em></td>
<td><a href="administrative-installation.md">Административный вариант установки</a> . Устанавливает продукт в сети.<br/></td>
</tr>
<tr class="even">
<td><strong>/x</strong></td>
<td><em>Пакет | ProductCode</em></td>
<td>Удаляет продукт.</td>
</tr>
<tr class="odd">
<td><strong>/j</strong></td>
<td>[u | m] <em>Пакет</em><br/> [u | m] <em>Список преобразований</em> <em>пакета</em><strong>/t</strong><br/> <em>или диспетчер конфигурации служб</em><br/> [u | m] <em></em><strong></strong><em>LanguageID</em> /g пакета<br/></td>
<td>Объявляет продукт. Этот параметр игнорирует все значения свойств, указанные в командной строке.<br/> u — объявление для текущего пользователя.<br/> m — объявление для всех пользователей компьютера.<br/> g — идентификатор языка.<br/> t — применение преобразования к объявленному пакету.<br/></td>
</tr>
<tr class="even">
<td><strong>/L</strong></td>
<td>[i | w | e | a | r | u | c | m | o | p | v | x | + |! | *] <em>Файл журнала</em></td>
<td>Записывает сведения о ведении журнала в файл журнала по указанному существующему пути. Путь к расположению файла журнала уже должен существовать. Установщик не создает структуру каталогов для файла журнала. Флаги указывают, какие сведения следует записывать в журнал. Если флаги не указаны, по умолчанию используется значение "ивеармо".<br/> i — сообщения о состоянии.<br/> w — некритические предупреждения.<br/> e — все сообщения об ошибках.<br/> a — запуск действий.<br/> записи, относящиеся к действию r.<br/> запросы u-User.<br/> c — начальные параметры пользовательского интерфейса.<br/> m-недостаточно памяти или Неустранимая информация о выходе.<br/> o — сообщения о нехватке места на диске.<br/> свойства p-Terminal.<br/> v — подробный вывод.<br/> x — дополнительные отладочные сведения. <strong>установщик Windows 2,0:</strong> Не поддерживается. параметр x доступен в установщик Windows версии 3.0.3790.2180 и более поздних.<br/> <br/> + - Добавить к существующему файлу.<br/> ! — Записать каждую строку в журнал.<br/> &quot;*&quot; — Шаблон — заносить в журнал все сведения, кроме параметров v и x. Чтобы включить параметры v и x, укажите &quot; /l* VX &quot; .<br/>
<blockquote>
[!Note]<br />
дополнительные сведения о всех методах, доступных для настройки режима ведения журнала, см. в разделе " <a href="normal-logging.md">нормальное ведение журнала</a> " раздела <a href="windows-installer-logging.md">установщик Windows logging</a> .
</blockquote>
<br/></td>
</tr>
<tr class="odd">
<td><strong>/m</strong></td>
<td><em>файлов</em>
<blockquote>
[!Note]<br />
Длина <em>имени файла</em> не должна превышать восьми символов.
</blockquote>
<br/></td>
<td>Создает MIF-файл состояния SMS. Должен использоваться с параметрами Install (-i), Remove (-x), административной установки (-a) или REINSTALL (-f). ISMIF32.DLL устанавливается как часть SMS и должна находиться в пути.<br/> Поля MIF-файла состояния заполняются следующими сведениями:<br/> Изготовитель — <a href="author-summary.md"> <strong>Автор</strong></a><br/> <a href="revision-number-summary.md"> <strong>Номер редакции</strong> продукта</a><br/> Версия — <a href="subject-summary.md"> <strong>субъект</strong></a><br/> Языковой стандарт — <a href="template-summary.md"> <strong>шаблон</strong></a><br/> Серийный номер не задан<br/> Установка — Установка по ISMIF32.DLL в &quot; значение DateTime&quot;<br/> Инсталлстатус — &quot; успешное выполнение &quot; или &quot; сбой&quot;<br/> Описание — сообщения об ошибках в следующем порядке: 1) сообщения об ошибках, созданные установщиком. 2) ресурс из Msi.dll, если установка не может быть инициирована или пользователь выходит из системы. 3) файл системных сообщений об ошибках. 4) отформатированное сообщение: &quot; Ошибка установщика% i &quot; , где% i-ошибка возвращена из Msi.dll.<br/></td>
</tr>
<tr class="even">
<td><strong>/p</strong></td>
<td><em>Патчпаккаже [;P atchpackage2</em> ]</td>
<td>Применяет исправление. Чтобы применить исправление к установленному административному образу, необходимо объединить следующие параметры:<br/> /p <em> <PatchPackage> [;p atchpackage2] </em> /a<em><Package></em><br/></td>
</tr>
<tr class="odd">
<td><strong>/q</strong></td>
<td>n | b | r | f</td>
<td>Задает <a href="user-interface-levels.md">уровень пользовательского интерфейса</a>.<br/> вопрос, Qn-нет пользовательского интерфейса<br/> QB — <a href="b-gly.md"><em>базовый пользовательский интерфейс</em></a>. Используйте QB! , чтобы скрыть кнопку <strong>Отмена</strong> .<br/> QR- <a href="r-gly.md"><em>сокращенный пользовательский интерфейс</em></a> без модальных диалоговых окон, отображаемых в конце установки.<br/> КФ — <a href="f-gly.md"><em>полный пользовательский интерфейс</em></a> и все создатели модальных диалоговых окон <a href="fatalerror-dialog.md">FatalError</a>, <a href="userexit-dialog.md">усерексит</a>или <a href="exit-dialog.md">Exit</a> .<br/> Qn + — нет пользовательского интерфейса, кроме модального диалогового окна, отображаемого в конце.<br/> QB + — <a href="b-gly.md"><em>базовый пользовательский интерфейс</em></a> с модальным диалоговым окном, отображаемым в конце. Если пользователь отменяет установку, модальное окно не отображается. Используйте QB +! или QB! +, чтобы скрыть кнопку <strong>Отмена</strong> .<br/> QB — <a href="b-gly.md"><em>базовый пользовательский интерфейс</em></a> без модальных диалоговых окон. Обратите внимание, что/QB + — не является поддерживаемым уровнем пользовательского интерфейса. Используйте QB-! или QB!-, чтобы скрыть кнопку <strong>"Отмена"</strong> .<br/> Обратите внимание, что! параметр доступен с установщик Windows 2,0 и работает только с базовым интерфейсом пользователя. Он недопустим для полного пользовательского интерфейса.<br/></td>
</tr>
<tr class="even">
<td><strong>/?</strong> или <strong>/h</strong></td>
<td> </td>
<td>отображает сведения об авторских правах для установщик Windows.<br/></td>
</tr>
<tr class="odd">
<td><strong>/y</strong></td>
<td><em>модуль</em></td>
<td>Вызывает системную функцию <strong>DllRegisterServer</strong> для самостоятельной регистрации модулей, переданных в командной строке. Укажите полный путь к библиотеке DLL. Например, для MY_FILE.DLL в текущей папке можно использовать:<br/> <strong>msiexec/y .\MY_FILE.DLL</strong><br/> Этот параметр используется только для данных реестра, которые не могут быть добавлены с помощью таблиц реестра файла .msi.<br/></td>
</tr>
<tr class="even">
<td><strong>/z</strong></td>
<td><em>модуль</em></td>
<td>Вызывает системную функцию <strong>DllUnRegisterServer</strong> для отмены регистрации модулей, переданных в командной строке. Укажите полный путь к библиотеке DLL. Например, для MY_FILE.DLL в текущей папке можно использовать: <br/> <strong>msiexec/z .\MY_FILE.DLL</strong><br/> Этот параметр используется только для данных реестра, которые не могут быть удалены с помощью таблиц реестра файла .msi.<br/></td>
</tr>
<tr class="odd">
<td><strong>/c</strong></td>

<td>Объявляет новый экземпляр продукта. Должен использоваться в сочетании с/т. доступно начиная с версии установщик Windows, которая поставляется с Windows Server 2003 и Windows XP с пакетом обновления 1 (SP1).<br/></td>
</tr>
<tr class="even">
<td><strong>параметра</strong></td>
<td><em>ProductCode</em></td>
<td>Указывает конкретный экземпляр продукта. Используется для указания экземпляра, установленного с помощью поддержки нескольких экземпляров посредством преобразования кода продукта. доступно начиная с версии установщик Windows, поставляемой с Windows Server 2003 и Windows XP с пакетом обновления 1 (SP1). <br/></td>
</tr>
</tbody>
</table>



 

Параметры/i,/x,/f \[ p \| o \| e \| d \| c \| a \| u \| m \| s \| v \] ,/j \[ u \| m \] ,/a,/p,/y и/z не следует использовать вместе. Единственным исключением из этого правила является то, что [Установка исправления административной установки](administrative-installation.md) требует использования и/p, и/a ". Параметры/t,/c и/g следует использовать только с/ж. Параметры/l и/q можно использовать с параметрами/i,/x,/f \[ p \| o \| e \| d \| c \| a \| u \| m \| s \| v \] ,/j \[ u \| \] ,/a и использованием/p. Параметр/n можно использовать с/i,/f,/x и использованием/p.

Чтобы установить продукт из: \\Example.msi, установите продукт следующим образом:

**msiexec/i A: \\Example.msi**

С помощью командной строки можно изменять только [открытые свойства](public-properties.md) . Все имена свойств в командной строке обрабатываются как прописные, но значение чувствительно к регистру. При вводе свойства **MyProperty** в командной строке установщик переопределяет значение свойства MyProperty, а не значение свойства **MyProperty** в таблице свойств. Дополнительные сведения см. в разделе [о свойствах](about-properties.md).

Чтобы установить продукт со СВОЙСТВом, имеющим значение VALUE, используйте следующий синтаксис в командной строке. Свойство можно разместить в любом месте, кроме параметра и его аргумента.

Правильный синтаксис:

**msiexec/i A: \\Example.msi свойство = значение**

Неправильный синтаксис:

**msiexec/i свойство = значение A: \\Example.msi**

Значения свойств, являющиеся строковыми литералами, должны заключаться в кавычки. Включите в строку все пробелы между метками.

**msiexec/i A: \\Example.msi свойство = "внедренные пробелы"**

Чтобы очистить открытое свойство с помощью командной строки, задайте для его значения пустую строку.

**msiexec/i A: \\Example.msi свойство = ""**

Для разделов набора текста, разделенных литеральными кавычками, следует заключать раздел во вторую пару кавычек.

**msiexec/i A: \\Example.msi свойство = "Embedded" "Quotes" "пробел"**

В следующем примере показана сложная Командная строка.

**msiexec/i testdb.msi ИНСТАЛЛЛЕВЕЛ = 3/l \* MSI. log COMPANYNAME = "Acme" "Widgets" "и" "приспособлений." "**

В следующем примере показаны параметры объявления. Обратите внимание, что в параметрах регистр не учитывается.

**msiexec/жм msisample.msi/T Transform. MST/ЛИМЕ logfile.txt**

В следующем примере показано, как установить новый экземпляр продукта для объявления. Этот продукт создан для поддержки нескольких преобразований экземпляров.

**msiexec/жм msisample.msi/T: instance1. MST; Настройка. MST/c/ЛИМЕ logfile.txt**

В следующем примере показано, как исправить экземпляр продукта, установленного с помощью преобразований нескольких экземпляров.

**msiexec/p мсипатч. MSP; msipatch2. MSP/n {00000001-0002-0000-0000-624474736554} /QB**

При применении исправлений к конкретному продукту параметры/i и/p не могут быть указаны одновременно в командной строке. В этом случае можно применить исправления к продукту следующим образом.

**msiexec/i A: \\Example.msi Patch = мсипатч. MSP; msipatch2. MSP/QB**

Свойство [**Patch**](patch.md) не может быть задано в командной строке, если используется параметр/p. Если свойство **Patch** задано при использовании параметра/p, значение свойства **Patch** игнорируется и переписывается.

 

