---
description: Мсивиевжетколумнинфо и свойство ColumnInfo объекта View используют следующий формат для описания определений столбцов базы данных.
ms.assetid: 77379664-26f2-4c1d-8c44-d9be2376efa9
title: Формат определения столбца
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6e43e7f70c942fda32bf5003571fa687250e971d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104264860"
---
# <a name="column-definition-format"></a>Формат определения столбца

[**Мсивиевжетколумнинфо**](/windows/desktop/api/Msiquery/nf-msiquery-msiviewgetcolumninfo) и [**свойство ColumnInfo**](view-columninfo.md) объекта [**View**](view-object.md) используют следующий формат для описания определений столбцов базы данных. Каждый столбец описывается строкой в соответствующем поле записи, возвращаемом функцией или свойством. Строка определения состоит из одной буквы, представляющей тип данных, за которой следует ширина столбца (в символах, если применимо, байтов в противном случае). Нулевая ширина означает неограниченную ширину (например, длинные текстовые поля и потоки). Прописная буква означает, что в столбце разрешены значения NULL.



| Дескриптор столбца | Строка определения                 |
|-------------------|-----------------------------------|
| #d0?                | Строка, переменная длина (? = 1-255) |
| сна                | Строка, переменная длина           |
| i2                | Короткое целое                     |
| i4                | Long integer                      |
| v0                | Двоичный поток                     |
| модуле?                | Временная строка (? = 0-255)        |
| б?                | Временное целое число (? = 0, 1, 2, 4)     |
| O0                | Временный объект                  |



 

Строки, используемые для описания столбцов, имеют следующую связь со строками запросов SQL, используемыми CREATE и ALTER. Дополнительные сведения см. в разделе [синтаксис SQL](sql-syntax.md).



| Возвращаемое значение | Синтаксис SQL                |
|----------------|---------------------------|
| сна             | лонгчар                  |
| объединения             | ЛОНГЧАР ДЛЯ ЛОКАЛИЗАЦИИ      |
| #d0 \#           | CHAR ( \# )                  |
| #d0 \#           | CHARACTER ( \# )             |
| н \#           | ТИП CHAR ( \# ) — локализуемый      |
| н \#           | подлежит \# локализации символ () |
| i2             | SHORT                     |
| i2             | INT                       |
| i2             | INTEGER                   |
| i4             | LONG                      |
| v0             | OBJECT                    |



 

Если буква не прописная, то инструкция SQL должна быть добавлена со значением NOT NULL.



| Возвращаемое значение | Синтаксис SQL        |
|----------------|-------------------|
| сна             | ЛОНГЧАР NOT NULL |



 

Установщик не ограничивает длину столбцов на значение, заданное в формате определения столбца. Если данные, введенные в поле, превышают указанную длину столбца, пакет не проходит [проверку пакета](package-validation.md). Чтобы пройти проверку в этом случае, необходимо изменить либо данные, либо схему базы данных. Единственный способ изменить длину столбца стандартной таблицы — это экспортировать таблицу с помощью [**мсидатабасикспорт**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseexporta), отредактировать экспортированный файл IDT, а затем импортировать таблицу с помощью [**мсидатабасеимпорт**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta). Авторы не могут изменять типы данных столбцов, допустимость значений NULL или атрибуты локализации любых столбцов в стандартных таблицах. Авторы могут создавать пользовательские таблицы со столбцами, имеющими атрибуты столбцов.

При использовании [**мсидатабасемерже**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasemergea) для слияния эталонной базы данных в целевую базу данных имена столбцов, число первичных ключей и типы данных столбцов должны совпадать. **Мсидатабасемерже** игнорирует атрибуты локализации и длины столбцов. Если столбец в базе данных-образце имеет длину 0 или больше, чем длина этого столбца в целевой базе данных, **мсидатабасемерже** увеличивает длину столбца в целевой базе данных до длины в базе данных-образце.

При использовании Mergmod.dll версии 2,0 приложение модуля слияния в MSI-файл никогда не изменяет длину столбцов или типы столбцов существующей таблицы базы данных. Однако приложение модуля слияния может изменить схему существующей таблицы базы данных, если модуль добавляет новые столбцы в таблицу, для которой допускается добавление столбцов. При использовании Mergemod.dll версии, меньшей версии 2,0, приложение модуля слияния никогда не изменяет длину столбцов и никогда не изменяет схему целевой базы данных.

 

 



