---
description: Пользовательские действия, написанные на JScript или Visual Basic, Scripting Edition (VBScript) могут вызывать необязательную функцию. Эти функции должны возвращать одно из значений, приведенных в следующей таблице.
ms.assetid: f05d0b94-e79e-440e-9f2b-99fe0e9e2646
title: Возвращаемые значения настраиваемых действий JScript и VBScript
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cae96ecba320914b7b00dfa718deffdd56ae7eaf
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105662706"
---
# <a name="return-values-of-jscript-and-vbscript-custom-actions"></a>Возвращаемые значения настраиваемых действий JScript и VBScript

Пользовательские действия, написанные на JScript или Visual Basic, Scripting Edition (VBScript) могут вызывать необязательную функцию. Эти функции должны возвращать одно из значений, приведенных в следующей таблице.



| Возвращаемое значение              | Значение        | Описание                                                                                                |
|---------------------------|--------------|------------------------------------------------------------------------------------------------------------|
| мсидоактионстатусноактион | 0            | Действие не выполнено.                                                                                       |
| мсидоактионстатуссукцесс  | ИДОК = 1     | Действие успешно выполнено.                                                                             |
| мсидоактионстатусусерексит | ИДКАНЦЕЛ = 2 | Преждевременное завершение пользователем.                                                                             |
| мсидоактионстатусфаилуре  | ИДАБОРТ = 3  | Неустранимая ошибка. Возвращается при возникновении ошибки во время синтаксического анализа или выполнения JScript или VBScript. |
| мсидоактионстатуссуспенд  | ИДРЕТРИ = 4  | Приостановленная последовательность будет возобновлена позже.                                                                    |
| мсидоактионстатусфинишед | ИДИГНОРЕ = 5 | Пропустить оставшиеся действия. Не является ошибкой.                                                                      |



 

Обратите внимание, что установщик Windows преобразует возвращаемые значения из всех действий при записи возвращаемого значения в файл журнала. Например, если возвращаемое значение действия отображается как 1 (одно) в файле журнала, это означает, что действие вернуло Мсидоактионстатуссукцесс. Дополнительные сведения об этом переводе см. в разделе [ведение журнала возвращаемых значений действий](logging-of-action-return-values.md).

Чтобы вернуть значение, отличное от "успешно" из настраиваемого действия скрипта, необходимо использовать цель функции для настраиваемого действия. Целевая функция указывается в столбце Target [таблицы CustomAction](customaction-table.md).

В следующем примере скрипта показано, как вернуть значение Success или Failure из настраиваемого действия VBScript.


```VB
Function MyVBScriptCA()

    If Session.Property("CustomErrorStatus") <> "0" Then
        'return error
        MyVBScriptCA = 3
        Exit Function
    End If

    ' return success
    MyVBScriptCA = 1
    Exit Function

End Function
```



Если этот сценарий VBScript был внедрен в [двоичную таблицу](binary-table.md) установочного пакета как MyCA.vbs, для скрипта будет использоваться следующая запись [CustomAction](customaction-table.md) :



| Действие         | Тип | Источник   | Назначение       |
|----------------|------|----------|--------------|
| микустомактион | 6    | MyCA.vbs | мивбскриптка |



 

 

 



