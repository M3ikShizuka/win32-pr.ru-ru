---
description: Метод Message объекта Session выполняет все включенные операции ведения журнала и откладывает выполнение объекта обработчика пользовательского интерфейса, связанного с ядром. Ведение журнала может быть выборочно включено для различных типов сообщений. См. метод EnableLog.
ms.assetid: 09053700-a641-4970-bf55-d7c81f345257
title: Session. Message, метод
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- Session.Message
api_type:
- COM
api_location:
- Msi.dll
ms.openlocfilehash: 6d14d59e801afcdf69bec2f1169d5c5b14469e8b13ac3f4c593955c7e235c7b4
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119629144"
---
# <a name="sessionmessage-method"></a>Session. Message, метод

Метод **Message** объекта [**Session**](session-object.md) выполняет все включенные операции ведения журнала и откладывает выполнение объекта обработчика пользовательского интерфейса, связанного с ядром. Ведение журнала может быть выборочно включено для различных типов сообщений. См. метод [**EnableLog**](installer-enablelog.md) .

Если поле записи 0 содержит строку форматирования, оно используется для форматирования данных в других полях. Иначе, если сообщение является ошибкой, предупреждением или пользовательским сообщением, предпринимается попытка найти в таблице ошибок шаблон сообщения для текущей базы данных, используя номер ошибки, найденный в поле 1 записи для типов сообщений и возвращаемых значений.

## <a name="syntax"></a>Синтаксис


```JScript
Session.Message(
  kind,
  record
)
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*особого* 
</dt> <dd>

Параметр *Kind* должен иметь одно из следующих значений. Чтобы отобразить окно сообщения с кнопками и значками, Вычислите значение *типа* , добавив стандартные стили окна сообщения, используемые [**MessageBox**](/windows/win32/api/winuser/nf-winuser-messagebox) и [**мессажебоксекс**](/windows/win32/api/winuser/nf-winuser-messageboxexa) , в **мсимессажетипиррор**, **мсимессажетипеварнинг** или **мсимессажетипеусер**. Дополнительные сведения см. в разделе "Примечания" ниже.



| Константа                                                                                                                                                                                                                                                                                                                 | Значение                                                                                                                                      |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="msiMessageTypeFatalExit"></span><span id="msimessagetypefatalexit"></span><span id="MSIMESSAGETYPEFATALEXIT"></span><dl> <dt>**мсимессажетипефаталексит**</dt> <dt>&H00000000</dt> </dl>                     | Преждевременное завершение, возможно, Неустранимая память.<br/>                                                                              |
| <span id="msiMessageTypeError"></span><span id="msimessagetypeerror"></span><span id="MSIMESSAGETYPEERROR"></span><dl> <dt>**мсимессажетипиррор**</dt> <dt>&H01000000</dt> </dl>                                     | Форматированное сообщение об ошибке, \[ 1 \] — номер сообщения в [таблице ошибок](error-table.md).<br/>                                               |
| <span id="msiMessageTypeWarning"></span><span id="msimessagetypewarning"></span><span id="MSIMESSAGETYPEWARNING"></span><dl> <dt>**мсимессажетипеварнинг**</dt> <dt>&H02000000</dt> </dl>                             | Форматированное предупреждающее сообщение, \[ 1 \] — номер сообщения в [таблице ошибок](error-table.md).<br/>                                             |
| <span id="msiMessageTypeUser_"></span><span id="msimessagetypeuser_"></span><span id="MSIMESSAGETYPEUSER_"></span><dl> <dt> **мсимессажетипеусер**</dt> <dt>&H03000000</dt> </dl>                                     | Сообщение запроса пользователя, \[ 1 \] — номер сообщения в [таблице ошибок](error-table.md).<br/>                                                  |
| <span id="msiMessageTypeInfo"></span><span id="msimessagetypeinfo"></span><span id="MSIMESSAGETYPEINFO"></span><dl> <dt>**мсимессажетипеинфо**</dt> <dt>&H04000000</dt> </dl>                                         | Информативное сообщение для журнала, которое не должно отображаться.<br/>                                                                                 |
| <span id="msiMessageTypeFilesInUse"></span><span id="msimessagetypefilesinuse"></span><span id="MSIMESSAGETYPEFILESINUSE"></span><dl> <dt>**мсимессажетипефилесинусе**</dt> <dt>&H05000000</dt> </dl>                 | Список используемых файлов, которые необходимо заменить.<br/>                                                                                    |
| <span id="msiMessageTypeResolveSource"></span><span id="msimessagetyperesolvesource"></span><span id="MSIMESSAGETYPERESOLVESOURCE"></span><dl> <dt>**мсимессажетипересолвесаурце**</dt> <dt>&H06000000</dt> </dl>     | Запрос на определение допустимого исходного расположения.<br/>                                                                                     |
| <span id="msiMessageTypeOutOfDiskSpace"></span><span id="msimessagetypeoutofdiskspace"></span><span id="MSIMESSAGETYPEOUTOFDISKSPACE"></span><dl> <dt>**мсимессажетипеаутофдискспаце**</dt> <dt>&H07000000</dt> </dl> | Недостаточно места для сообщения на диске.<br/>                                                                                                  |
| <span id="msiMessageTypeActionStart"></span><span id="msimessagetypeactionstart"></span><span id="MSIMESSAGETYPEACTIONSTART"></span><dl> <dt>**мсимессажетипеактионстарт**</dt> <dt>&H08000000</dt> </dl>             | Начало действия, \[ 1 \] имя действия, \[ 2 \] Описание, \[ 3 \] шаблона для сообщений актиондата.<br/>                                    |
| <span id="msiMessageTypeActionData"></span><span id="msimessagetypeactiondata"></span><span id="MSIMESSAGETYPEACTIONDATA"></span><dl> <dt>**мсимессажетипеактиондата**</dt> <dt>&H09000000</dt> </dl>                 | Данные действия. Поля записей соответствуют шаблону сообщения АКТИОНСТАРТ.<br/>                                                     |
| <span id="msiMessageTypeProgress"></span><span id="msimessagetypeprogress"></span><span id="MSIMESSAGETYPEPROGRESS"></span><dl> <dt>**мсимессажетипепрогресс**</dt> <dt>&H0A000000</dt> </dl>                         | Сведения о индикаторе выполнения. См. Описание полей записи ниже.<br/>                                                             |
| <span id="msiMessageTypeCommonData_"></span><span id="msimessagetypecommondata_"></span><span id="MSIMESSAGETYPECOMMONDATA_"></span><dl> <dt> **мсимессажетипекоммондата**</dt> <dt>&H0B000000</dt> </dl>             | Чтобы включить кнопку Cancel, установите \[ 1 \] – 2, а \[ 2 — \] 1. <br/> Отключение кнопки "Отмена" с параметром \[ 1 \] на 2 и \[ 2 \] до 0<br/> |



 

</dd> <dt>

*record* 
</dt> <dd>

Обязательный объект [**Record**](record-object.md) , содержащий поле, относящееся к сообщению.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение



| Константа                                                                                              | Значение         |
|-------------------------------------------------------------------------------------------------------|---------------|
| <dl> <dt>**мсимессажестатусеррор**</dt> </dl>  | –1<br/> |
| <dl> <dt>**мсимессажестатусноне**</dt> </dl>   | 0<br/>  |
| <dl> <dt>**мсимессажестатусок**</dt> </dl>     | 1<br/>  |
| <dl> <dt>**мсимессажестатусканцел**</dt> </dl> | 2<br/>  |
| <dl> <dt>**мсимессажестатусаборт**</dt> </dl>  | 3<br/>  |
| <dl> <dt>**мсимессажестатусретри**</dt> </dl>  | 4<br/>  |
| <dl> <dt>**мсимессажестатусигноре**</dt> </dl> | 5<br/>  |
| <dl> <dt>**мсимессажестатусес**</dt> </dl>    | 6<br/>  |
| <dl> <dt>**мсимессажестатусно**</dt> </dl>     | 7<br/>  |



 

## <a name="remarks"></a>Remarks

**Поля записей сообщений**

Ниже описаны определения полей записей, когда Мсимессажетипепрогресс передается как тип сообщений.

Поле 1 указывает тип сообщения о ходе выполнения. Значение других полей зависит от значения в этом поле. Ниже приведены возможные значения, которые можно задать в поле 1.



| Название сообщения     | Значение | Описание поля 1                                                                                                 |
|------------------|-------|---------------------------------------------------------------------------------------------------------------------|
| мастерресет      | 0     | Сбрасывает индикатор выполнения и устанавливает ожидаемое общее число тактов на полосе.                                         |
| ActionInfo       | 1     | Предоставляет сведения, связанные с сообщениями о ходе выполнения, которые должны быть отправлены текущим действием.                                 |
| ProgressReport   | 2     | Увеличивает индикатор выполнения.                                                                                        |
| прогрессаддитион | 3     | Позволяет действию (например, CustomAction) добавлять такты к ожидаемому общему количеству хода выполнения индикатора выполнения. |



 

Значение поля 2 зависит от значения в поле 1, как показано ниже.



| Значение поля 1 | Описание поля 2                                                                                        |
|---------------|------------------------------------------------------------------------------------------------------------|
| 0             | Ожидаемое общее число тактов на индикаторе выполнения.                                                        |
| 1             | Число тактов, на которое перемещается индикатор выполнения для каждого сообщения Актиондата. Это поле игнорируется, если поле 3 равно 0. |
| 2             | Число тактов, на которое переместился индикатор выполнения.                                                                |
| 3             | Число тактов, которое нужно добавить к общему ожидаемому прогрессу.                                                         |



 

Значение поля 3 зависит от значения в поле 1, как показано ниже.



| Значение поля 1 | Значение поля 3 | Описание поля 3                                                                                             |
|---------------|---------------|-----------------------------------------------------------------------------------------------------------------|
| 0             | 0             | Пересылка индикатора выполнения (слева направо)                                                                            |
|               | 1             | Обратный индикатор выполнения (справа налево)                                                                           |
| 1             | 0             | Текущее действие будет отсылать явные сообщения Прогрессрепорт.                                                  |
|               | 1             | Увеличение индикатора выполнения на число тактов, указанное в поле 2, каждый раз, когда отправляется сообщение Актиондата. |
| 2             | Не используется        |                                                                                                                 |
| 3             | Не используется        |                                                                                                                 |



 

Значение поля 4 зависит от значения в поле 1, как показано ниже.



| Значение поля 1 | Значение поля 4 | Описание поля 4                                                                                                                                 |
|---------------|---------------|-----------------------------------------------------------------------------------------------------------------------------------------------------|
| 0             | 0             | Выполнение выполняется. В этом случае пользовательский интерфейс может вычислить и отобразить оставшееся время.                                                      |
|               | 1             | Создание скрипта выполнения. В этом случае пользовательский интерфейс может отобразить сообщение, в течение которого установщик завершит подготовку установки. |
| 1             | Не используется        |                                                                                                                                                     |
| 2             | Не используется        |                                                                                                                                                     |
| 3             | Не используется        |                                                                                                                                                     |



 

**Отображение окон сообщений**

Чтобы отобразить окно сообщения с кнопками и значками, Вычислите значение *типа* , добавив стандартные стили окна сообщения, используемые **MessageBox** и **мессажебоксекс** , в **мсимессажетипиррор**, **мсимессажетипеварнинг** или **мситипеусер**. Доступные параметры кнопки отправки для VBScript: Вбоконли (МБ \_ ОК), вбокканцел (МБ \_ окканцел), ВБАБОРТРЕТРИГНОРЕ (МБ \_ Абортретригноре), вбесноканцел (МБ \_ есноканцел), vbYesNo (МБ \_ ДАНЕТ) и vbRetryCancel (МБ \_ RETRYCANCEL). Доступные варианты значков для VBScript: Вбкритикал (МБ \_ иконеррор), вбкуестион (МБ \_ иконкуестион), ВБЕКСКЛАМАТИОН (МБ \_ Иконварнинг) и вбинформатион (МБ \_ ICONINFORMATION).

Например, следующий вызов отправляет сообщение **мсимессажетипиррор** с помощью значка вбекскламатион и кнопок вбесно.


```VB
Session.Message &H01000034, record
```



Если пользовательское действие вызывает метод **Message** , пользовательское действие должно уметь обрабатывать отмену пользователем и возвращать **мсидоактионстатусусерексит**.

## <a name="requirements"></a>Требования



| Требование | Значение |
|--------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Версия<br/> | Windows установщик 5,0 на Windows Server 2012, Windows 8, Windows Server 2008 R2 или Windows 7. Windows установщик 4,0 или установщик Windows 4,5 на Windows Server 2008 или Windows Vista. Windows установщик на Windows Server 2003 или Windows XP<br/> |
| DLL<br/>     | <dl> <dt>Msi.dll</dt> </dl>                                                                                                                                                                      |
| IID<br/>     | IID \_ ISession определяется как 000C109E-0000-0000-C000-000000000046<br/>                                                                                                                                                                             |



 

 
