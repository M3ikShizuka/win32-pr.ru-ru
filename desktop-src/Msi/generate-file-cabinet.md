---
description: файл WiMakCab.vbs VBScript предоставляется в Windows SDK компонентов для установщик Windows разработчиков. в этом примере показано, как использовать скрипт для создания cab-файлов из базы данных установщик Windows.
ms.assetid: 26671cb9-a200-4520-8b52-4cff3f71a2f2
title: Создать CAB-файл
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c2ca9e30822d0683aa09dc015ec2fd98d1f598c70e0fd63fd00f66a6bcdf3edf
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119581495"
---
# <a name="generate-file-cabinet"></a>Создать CAB-файл

файл WiMakCab.vbs VBScript предоставляется в [Windows SDK компонентов для установщик Windows разработчиков](platform-sdk-components-for-windows-installer-developers.md). в этом примере показано, как использовать скрипт для создания cab-файлов из базы данных установщик Windows.

В этом примере демонстрируются следующее:

-   [**Метод опендатабасе (объект установщика)**](installer-opendatabase.md) и [**метод ластерроррекорд**](installer-lasterrorrecord.md) [**объекта установщика**](installer-object.md)
-   [**Метод Commit**](database-commit.md), [**метод OpenView**](database-openview.md) и [**свойство SummaryInformation (объект базы данных)**](database-summaryinformation.md) [**объекта базы данных**](database-object.md)
-   Метод [**Fetch**](view-fetch.md), [**метод Execute**](view-execute.md) и [**метод Modify**](view-modify.md) [**объекта View**](view-object.md)
-   [**Свойство StringData**](record-stringdata.md) и [**свойство IntegerData**](record-integerdata.md) [**объекта Record**](record-object.md)
-   [**Метод DoAction**](session-doaction.md), [**свойство Property (объект Session)**](session-session.md)и [**свойство Mode**](session-mode.md) [**объекта Session**](session-object.md)

чтобы использовать этот пример, вам потребуется CScript.exe или WScript.exe версию сервера сценариев Windows. Чтобы использовать CScript.exe для запуска этого образца, введите команду в командной строке, используя следующий синтаксис. Если первый аргумент имеет значение/?, отображается справка. или, если указано слишком мало аргументов. Чтобы перенаправить выходные данные в файл, завершите командную строку с помощью VBS > \[ *путь к файлу* \] . Пример возвращает значение 0 для успешного выполнения, 1, если вызывается Справка, и 2 в случае сбоя сценария.

**cscript WiMakCab.vbs \[ путь к \] \[ базовому имени базы данных \] \[ необязательные исходные расположения\]**

Чтобы создать CAB-файл, Makecab.exe должен находиться в пути. служебная программа Makecab.exe входит в состав [Windows SDK компонентов для установщик Windows разработчиков](platform-sdk-components-for-windows-installer-developers.md). Обратите внимание, что образец не обновляет [таблицу мультимедиа](media-table.md) для обработки нескольких ящиков. Чтобы заменить встроенный CAB-файл, включите параметры:/R/C/U/Е.

Укажите путь к базе данных установщика. Он должен находиться в корне исходного дерева. Укажите базовое имя для создаваемых CAB-файлов с учетом регистра. Если тип источника — сжатый, все файлы открываются в корне. Следующие параметры могут быть указаны в любой точке командной строки.



| Параметр              | Описание                                                                                                                               |
|---------------------|-------------------------------------------------------------------------------------------------------------------------------------------|
| параметр не указан |                                                                                                                                           |
| /C                  | Выполнить сжатие. Если параметр/C не указан, WiMakCab.vbs создает файл DDF.                                                        |
| /L                  | Использовать сжатие LZX вместо MSZIP                                                                                                      |
| /F                  | Ограничить размер шкафа размером 1,44 МБ, а не компакт-диском                                                                              |
| /U                  | Обновление базы данных для ссылки на созданный CAB-файл                                                                                    |
| /E                  | Внедрение CAB-файла в пакет установщика в виде потока                                                                               |
| /S                  | Использование порядковых номеров в таблице файлов, упорядоченной по каталогам                                                                             |
| /R                  | Вернитесь к установке, не являющейся CAB-файлом, удалите CAB-файл, если указан параметр/E (при выборе параметра/R удаляется свойство со сжатым битом Суммаринфо 15 & 2). |



 

дополнительные примеры сценариев см. в разделе [установщик Windows примеры сценариев](windows-installer-scripting-examples.md). примеры служебных программ, не требующих Windows сервера сценариев, см. в разделе [средства разработки установщик Windows](windows-installer-development-tools.md).

 

 



