---
description: Обычно транзитивные компоненты используются для подготовки продукта к переустановке во время обновления системы.
ms.assetid: 73677573-945f-4646-89d8-93e28f7856fe
title: Использование транзитивных компонентов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 35982aafd486a62ce8560e507b8b6caf88e32591
ms.sourcegitcommit: de72a1294df274b0a71dc0fdc42d757e5f6df0f3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/05/2021
ms.locfileid: "104000020"
---
# <a name="using-transitive-components"></a>Использование транзитивных компонентов

Обычно транзитивные компоненты используются для подготовки продукта к переустановке во время обновления системы. Автор пакета установки указывает, какие компоненты должны быть перепутаны во время обновления системы, так как у них есть перемещаемый атрибут. Когда пользователь позднее обновляет систему, продукт необходимо переустановить. При этой переустановке установщик удаляет более ранние компоненты и устанавливает более поздние компоненты без необходимости установки всего продукта.

**Включение двух транзитивных компонентов в установочный пакет**

1.  Включите оба транзитивных компонента в установочный пакет.
2.  Создавайте оба транзитных компонента в [таблице компонентов](component-table.md) так же, как обычные компоненты. Каждый транзитный компонент должен иметь собственный уникальный идентификатор GUID, указанный в столбце ComponentId.
3.  Включите бит **мсидбкомпонентаттрибутестранситиве** в столбец Attributes таблицы Component для каждого перемещаемого компонента. Если этот бит задан, установщик повторно вычисляет значение инструкции в столбце Condition при переустановке.

    Если значение было ранее false и изменилось на true, установщик установит компонент.

    Если значение было ранее true и изменилось на false, установщик удаляет компонент, даже если этот компонент содержит другие продукты в качестве клиентов.

    > [!Note]  
    > Если не установлен транзитный бит, компонент остается включенным после установки, даже если условное выражение принимает значение false при последующем обслуживании продукта. Условия должны основываться только на состояниях компьютеров. Не используйте с условиями на основе пользовательских состояний или свойств, заданных в командной строке, так как это может привести к тому, что установщик потребует переустановки продукта для каждого использования другим пользователем.

     

4.  Введите дополнительные условные выражения в поля условия в таблице элементов управления таким, что при изменении условия для первого транзитного компонента на значение false условие для второго транзитного компонента изменится на true. Это приводит к удалению первого компонента и установке второго компонента после переустановки приложения.

Переустановка продукта необходима для переключения транзитивных компонентов. Таким образом, авторы пакетов должны предоставить пользователям метод для переустановки продукта и настройки режимов свойства [**REINSTALLMODE**](reinstallmode.md) . Существует три основных способа запуска повторной установки.

-   Запустите и настройте переустановку через пользовательский интерфейс путем создания пакета, использующего [*полный пользовательский*](f-gly.md)интерфейс.
-   Запустите переустановку из командной строки с помощью команды **msiexec/f** и выберите режимы из списка для [параметра командной строки](command-line-options.md) **/f** .
-   Вызовите приложение [**мсиреинсталлпродукт**](/windows/desktop/api/Msi/nf-msi-msireinstallproducta) или [**мсиреинсталлфеатуре**](/windows/desktop/api/Msi/nf-msi-msireinstallfeaturea).

Этот бит следует использовать только с условиями, основанными на состояниях компьютеров. Не используйте с условиями на основе пользовательских состояний или свойств, заданных в командной строке, так как это может привести к тому, что установщик потребует переустановки продукта для каждого использования другим пользователем.

> [!Note]
> Если для компонента не задано значение транзитного бита в столбце атрибуты, компонент остается включенным после установки, даже если условный оператор в столбце Condition имеет значение false при последующем обслуживании продукта.
> 
> В большинстве случаев, если приложение содержит транзитивные компоненты, установщик Windows требует от источника приложения восстановить или обновить приложение. В таких случаях компакт-диск восстановления системы, поставляемый производителем оборудования, не работает, и необходимо предоставить фактический источник установки для приложения.

 

 

 



