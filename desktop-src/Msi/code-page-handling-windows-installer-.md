---
description: Установщик Windows сохраняет все строки базы данных в одном общем пуле строк, чтобы уменьшить размер базы данных и повысить производительность. Список страниц с числовыми кодовыми номерами см. в разделе Локализация таблиц ошибок и Актионтекст.
ms.assetid: 5d413fb7-99da-49f3-ace3-ec285df2e634
title: Обработка кодовой страницы (установщик Windows)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6db2788a1bfc6bdb49ec1402d5bba8a1a2594b30
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105662591"
---
# <a name="code-page-handling-windows-installer"></a>Обработка кодовой страницы (установщик Windows)

Установщик Windows сохраняет все строки базы данных в одном общем пуле строк, чтобы уменьшить размер базы данных и повысить производительность. Список страниц с числовыми кодовыми номерами см. в разделе [Локализация таблиц ошибок и актионтекст](localizing-the-error-and-actiontext-tables.md).

Дополнительные сведения см. в статье [Определение кодовой страницы базы данных установки](determining-an-installation-database-s-code-page.md).

Установщик Windows использует [**исвалидкодепаже**](/windows/desktop/api/winnls/nf-winnls-isvalidcodepage) , чтобы определить, является ли кодовая страница допустимой.

### <a name="localizing-a-windows-installer-package"></a>Локализация пакета установщик Windows

Локализация пакета установщик Windows может привести к изменению сведений в таблицах базы данных, экспорту таблиц в текстовые архивные файлы ANSI, а затем импорту архивных файлов в локализованную базу данных. Также можно добавить изменения локализации в базу данных с помощью редактора таблиц базы данных или [функций базы данных](database-functions.md). Важно задать кодовую страницу для локализованной базы данных перед внесением изменений в локализацию в базу данных. Не устанавливайте кодовую страницу базы данных после локализации базы данных, так как это может привести к повреждению дополнительных символов. Дополнительные сведения см. [в разделе Установка кодовой страницы базы данных](setting-the-code-page-of-a-database.md).

Рекомендуемый подход к обработке кодовых страниц заключается в создании нейтральной базы данных, которая содержит только символы, которые можно преобразовать в любую кодовую страницу. Дополнительные сведения см. в разделе [Создание базы данных с нейтральной кодовой страницей](creating-a-database-with-a-neutral-code-page.md).

При добавлении сведений о локализации в файлы архива базы данных можно использовать [**мсидатабасикспорт**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseexporta) для экспорта таблиц из базы данных, содержащей изменения локализации, в текстовые архивные файлы ANSI, а затем импортировать их в базу данных, локализованную с помощью [**мсидатабасеимпорт**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabaseimporta). Кодовая страница экспортированного файла архива всегда совпадает с ее родительской базой данных. Кодовые страницы импортируемого файла и базы данных, получающей файл, должны быть идентичными, или хотя бы одна из двух кодовых страниц должна быть нейтральной. Дополнительные сведения см. в разделе [Обработка кодовых страниц импортированных и экспортированных таблиц](code-page-handling-of-imported-and-exported-tables.md).

Если вы добавляете сведения о локализации в текстовый редактор или [функции базы данных](database-functions.md) , будьте внимательны при передаче строковых параметров в установщик Windows API, который использует кодовую страницу локализованной базы данных. Если строковый параметр содержит символы, не представленные кодовой страницей базы данных, при вызове [**мсидатабасекоммит**](/windows/desktop/api/Msiquery/nf-msiquery-msidatabasecommit)возникает ошибка. Дополнительные сведения см. в разделе [Обработка кодовых страниц строк параметров](code-page-handling-of-parameter-strings.md).

Если один пакет используется для установки нескольких языковых версий продукта, то преобразование, используемое для локализации строк, также может изменить кодовую страницу базы данных.

 

 
