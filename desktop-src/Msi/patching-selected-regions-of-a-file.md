---
description: При внесении исправлений в файлы с переменным содержимым может потребоваться хранить выбранные регионы целевого файла, чтобы предотвратить потерю критически важных данных.
ms.assetid: 4a610588-556e-489f-ac14-73e5e6b776fe
title: Исправление выбранных регионов файла
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 778df4b0cc98eeacd1106929b18c7461c6fa9e70
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105650616"
---
# <a name="patching-selected-regions-of-a-file"></a>Исправление выбранных регионов файла

При внесении исправлений в файлы с переменным содержимым может потребоваться хранить выбранные регионы целевого файла, чтобы предотвратить потерю критически важных данных. Например, некоторые приложения отделяют сведения о пользователях в исполняемый файл. Поскольку содержимое целевого файла может зависеть от компьютера, на котором установлено приложение, становится трудно определить, является ли конкретный файл допустимым целевым объектом для данного исправления. Сведения о пользователях, записанные в целевой файл, также могут быть перезаписаны с помощью исправления.

При создании файла свойств создания исправления (PCP) с [Msimsp.exe](msimsp-exe.md) и [PATCHWIZ.DLL](patchwiz-dll.md)можно указать, что во время установки исправления сведения в определенных регионах целевого файла будут игнорироваться. Можно также указать, что сведения в других регионах целевого файла будут сохранены и скопированы в расположение смещения в обновленном файле. Вы указываете, какие регионы целевого файла следует игнорировать, и какие регионы следует хранить при создании таблиц [Таржетфилес оптионалдата](targetfiles-optionaldata-table-patchwiz-dll-.md), [екстерналфилес](externalfiles-table-patchwiz-dll-.md)и [фамилифилеранжес](familyfileranges-table-patchwiz-dll-.md) .

Используйте столбец Ретаиноффсетс таблицы [Таржетфилес оптионалдата](targetfiles-optionaldata-table-patchwiz-dll-.md) и столбцы Ретаиноффсетс и Ретаинленгсс таблицы [фамилифилеранжес](familyfileranges-table-patchwiz-dll-.md) , чтобы скопировать диапазон данных из целевого файла в диапазон смещения в обновленном файле. Информация в этом диапазоне сохраняется. Укажите длину диапазона, используя столбцы Ретаинленгсс таблицы Фамилифилеранжес. Длина сохраняемого диапазона одинакова в целевом и обновленном файлах. Укажите смещение диапазона в целевом файле с помощью столбца Ретаиноффсетс таблицы Таржетфилес Оптионалдата. Укажите смещение диапазона в обновленном файле с помощью столбца Ретаиноффсетс таблицы Фамилифилеранжес. Таким образом, диапазон сохраняемого целевого файла является значением Ретаиноффсетс в таблице Таржетфилес Оптионалдата и Ретаинленгсс. Эти сведения копируются в файл обновления в диапазоне, заданном значением Ретаиноффсетс в таблицах Фамилифилеранжес и Ретаинленгсс. Можно указать несколько диапазонов, но порядок их длин должен совпадать с порядком смещений.

Используйте таблицу [Таржетфилес оптионалдата](targetfiles-optionaldata-table-patchwiz-dll-.md) для пропуска диапазона целевого файла. Сведения в этом диапазоне целевого файла по-прежнему могут быть перезаписаны исправлением. Укажите смещение диапазона в столбце Игнореоффсетс и его длину в столбце Игнореленгсс. Можно указать несколько диапазонов, но порядок их длин должен совпадать с порядком смещений.

Значения в столбцах length и offset могут быть десятичными или шестнадцатеричными. [PATCHWIZ.DLL](patchwiz-dll.md) считает значение шестнадцатеричным, если оно имеет префикс 0x. Столбцы являются строковыми столбцами, поэтому PATCHWIZ.DLL преобразует значения в ULONG. Столбец length указывает длину в байтах.

 

 



