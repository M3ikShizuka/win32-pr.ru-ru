---
description: Instmsi.exe является распространяемым пакетом для установки установщик Windows&\# 160; 2.0 и более ранних версий установщик Windows. См. установщик Windows распространяемые пакеты для распространяемых компонентов для установщик Windows&\# 160; 3.0 и более поздних версий.
ms.assetid: 74ea4530-3a73-4169-b0b7-f0272229192d
title: Instmsi.exe
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 229d748cda68731627a6af2af992e321755b5ca2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105684236"
---
# <a name="instmsiexe"></a>Instmsi.exe

Instmsi.exe — это распространяемый пакет для установки установщик Windows 2,0 и более ранних версий установщик Windows. См. [установщик Windows распространяемых](windows-installer-redistributables.md) компонентов для распространяемых компонентов для установщик Windows 3,0 и более поздних версий.

Дополнительные сведения о версии установщик Windows, поставляемой с операционной системой, см. в разделе [выпущенные версии установщик Windows](released-versions-of-windows-installer.md).

Некоторые распространяемые пакеты не следует запускать в определенных версиях операционной системы. В следующей таблице описывается, какие Инстмси совместимы с операционной системой.



| Если Instmsi.exe устанавливает эту версию установщик Windows | Instmsi.exe может выполняться в этих операционных системах                    | Instmsi.exe не должны выполняться в этих операционных системах                                        |
|---------------------------------------------------------------|----------------------------------------------------------------------|-----------------------------------------------------------------------------------------------|
| Установщик Windows версии 1,0                                 | Windows 95, Windows 98, Windows NT 4.0 + SP3                           | Windows Me, Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008 |
| Установщик Windows версии 1,1                                 | Windows 95, Windows 98, Windows NT 4.0 + SP3                           | Windows Me, Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008 |
| Установщик Windows версии 1,2                                 | Windows 95, Windows 98, Windows Me, Windows NT 4.0 + SP3               | Windows 2000, Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008             |
| Установщик Windows версии 2,0                                 | Windows 95, Windows 98, Windows Me, Windows NT 4.0 + SP6, Windows 2000 | Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008                           |



 

Например, приложение, которое повторно распространяет установщик Windows версии 1,1, должно проверить, является ли операционная система Windows NT 4,0 SP3 или Windows 98/95 перед запуском распространяемого пакета. Приложения, использующие распространяемый пакет, также гарантируют, что версия ANSI установщик Windows установлена в Windows 98/95 и установлена ли версия Юникода в Windows NT или Windows 2000. Обратите внимание, что некоторые приложения переименованы версию Юникода в Инстмсив.

## <a name="syntax"></a>Синтаксис

 *Параметры* инстмси

## <a name="command-line-options"></a>Параметры командной строки

Параметры командной строки не учитывают регистр.



| Параметр                     | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
|----------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| /q                         | Для использования приложениями, которые распространяют установщик Windows в составе приложения начальной загрузки. Пользователь не видит пользовательский интерфейс. Приложение начальной загрузки должно проверить код возврата, чтобы определить, требуется ли перезагрузка для завершения установки установщик Windows.                                                                                                                                                                                                                          |
| /t                         | Используется только в целях отладки.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| /c: "мсиинст/делайребут"  | Параметр отложенной перезагрузки. Не позволяет Инстмси запрашивать у пользователя перезагрузку, даже если ей пришлось заменить файлы, которые использовались во время установки. Если Инстмси вызывается с этим параметром, то при необходимости \_ \_ \_ замены файлов, которые использовались, требуется перезагрузка после успешного выполнения. Если не нужно заменять файлы, которые использовались, он возвращает ошибку \_ успешно. Доступно в Инстмси для установщик Windows 2,0 или более поздней версии. Дополнительные сведения о отложенных перезагрузках см. в разделе "Примечания".<br/> |
| /c: "мсиинст/делайребутк" | Скрытая версия параметра отложенной перезагрузки. Он не предоставляет пользователю пользовательский интерфейс. В противном случае поведение идентично предыдущему параметру. Доступно в Инстмси для установщик Windows 2,0 или более поздней версии. Дополнительные сведения о отложенных перезагрузках см. в разделе "Примечания".<br/>                                                                                                                                                                                                                           |
| /?                         | Вывод справки.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |



 

## <a name="remarks"></a>Комментарии

[Начальная](bootstrapping.md) Загрузка приложений, использующих Instmsi.exe для установки установщик Windows с другим приложением, может потребовать дополнительной перезагрузки системы. В дополнение к перезагрузкам, необходимым для установки приложения, это может привести к дополнительной перезагрузке.

Параметр отложенной перезагрузки рекомендуется использовать только для разработчиков, которые хотят устранить дополнительную перезагрузку, вызванную использованием Instmsi.exe с приложением установки, устанавливающим файлы, которые используются.

Разработчики должны выполнить следующие действия в приложении установки, чтобы использовать параметр отложенной перезагрузки. Этот параметр недоступен в Instmsi.exe версиях, в которых установлены версии установщика Windows, предшествующие версии 2,0:

**Использование параметра отложенной перезагрузки**

1.  Вызовите Instmsi.exe с помощью одной из параметров командной строки с отложенной перезагрузкой.
2.  Обработайте возвращенные ошибки \_ или успешную \_ \_ перезагрузку при успешном выполнении \_ , так как это означает успешное выполнение.
3.  Получите путь к папке, содержащей недавно установленные установщик Windows двоичные файлы, из значения Инсталлерлокатион в разделе:

    **HKey \_ \_** \\  \\  \\  \\  \\ **Программа установки** Microsoft Windows CurrentVersion по на локальном компьютере

    Это значение имеет тип **reg \_ SZ**.

4.  Задайте в качестве текущего каталога путь, полученный на шаге 3.
5.  Вызов msiexec в пакете приложения и выполнение другого кода установки, относящегося к приложению. Если приложение установки использует [**мсиинсталлпродукт**](/windows/desktop/api/Msi/nf-msi-msiinstallproducta), приложение должно загрузить MSI.DLL из расположения, полученного на шаге 3.
    > [!Note]  
    > Приложения, вызывающие **LoadLibrary** для нового MSI.DLL в расположении, полученном на шаге 3, должны убедиться в том, что более старая версия MSI.DLL еще не загружена в процессе. Если в процессе была загружена более старая версия MSI.DLL, ее необходимо выгрузить из адресного пространства процесса до вызова **LoadLibrary** для нового MSI.DLL.

     

6.  Если шаг (5) не требует перезагрузки, а если \_ в шаге (1) была возвращена ошибка успешная \_ перезагрузка Instmsi.exe \_ , то пользователю предлагается перезагрузить компьютер для завершения установки двоичных файлов установщик Windows в системе. Однако если в шаге (5) происходит перезагрузка, никаких дополнительных действий не требуется.

Instmsi.exe доступен в [Windows SDK компонентах для установщик Windows разработчиков](platform-sdk-components-for-windows-installer-developers.md).

## <a name="related-topics"></a>См. также

<dl> <dt>

[Начальной загрузки](bootstrapping.md)
</dt> <dt>

[Начальная загрузка со скачиванием из Интернета](internet-download-bootstrapping.md)
</dt> <dt>

[Выпущенные версии, средства и распространяемые пакеты](released-versions-tools-and-redistributables.md)
</dt> <dt>

[Средства разработки установщик Windows](windows-installer-development-tools.md)
</dt> </dl>

 

 




