---
description: Объект базы данных обращается к базе данных установщика.
ms.assetid: 97765884-3e1c-486a-932c-6430b113fac8
title: Объект базы данных
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- Database
api_type:
- COM
api_location:
- Msi.dll
ms.openlocfilehash: 5b47e4678d9475abe90c4b55d6adb514314dcc0e
ms.sourcegitcommit: c8ec1ded1ffffc364d3c4f560bb2171da0dc5040
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/22/2021
ms.locfileid: "105669351"
---
# <a name="database-object"></a>Объект базы данных

Объект **базы данных** обращается к базе данных установщика.

Объект **базы данных** освобождается, когда либо выводится из области, либо когда связанная с ним объектная переменная имеет значение null. Метод [**commit**](database-commit.md) должен быть вызван до освобождения объекта **базы данных** для записи всех постоянных изменений. Если метод **commit** не вызывается, установщик выполняет неявный откат при уничтожении объекта.

Для доступа к данным клиент может использовать следующую процедуру.

**Запрос последовательности API**

1.  Получите объект **базы данных** , вызвав [**Опендатабасе**](installer-opendatabase.md) или объект [**установщика**](installer-object.md) .
2.  Запустите запрос с помощью строки SQL, вызвав метод [**OpenView**](database-openview.md) объекта **Database** .
3.  Задайте параметры запроса в объекте [**Record**](record-object.md) и выполните запрос к базе данных, вызвав метод [**EXECUTE**](view-execute.md) объекта [**View**](view-object.md) . В результате получается результат, который можно извлечь или обновить.
4.  Повторно вызывайте метод [**Fetch**](view-fetch.md) объекта [**представления**](view-object.md) , чтобы вернуть объекты [**записи**](record-object.md) .
5.  Обновите строки базы данных объекта [**записи**](record-object.md) , полученные методом [**Fetch**](view-fetch.md) , с помощью метода [**Modify**](view-modify.md) объекта [**View**](view-object.md) .
6.  Выпустите запрос и все невыбранные записи, вызвав метод [**Close**](view-close.md) объекта [**View**](view-object.md) .
7.  Сохраните обновления базы данных, вызвав метод [**commit**](database-commit.md) объекта **Database** .

## <a name="members"></a>Элементы

Объект **базы данных** имеет следующие типы членов:

-   [Методы](#methods)
-   [Свойства](#properties)

### <a name="methods"></a>Методы

Объект **базы данных** содержит следующие методы.



| Метод                                                                    | Описание                                                                                                                                                               |
|:--------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**апплитрансформ**](database-applytransform.md)                         | Применяет преобразование к этой базе данных.<br/>                                                                                                                        |
| [**Сохраните**](database-commit.md)                                         | Завершает постоянную форму базы данных.<br/>                                                                                                                 |
| [**креатетрансформсуммаринфо**](database-createtransformsummaryinfo.md) | Создает и заполняет поток сводных данных существующего файла преобразования.<br/>                                                                            |
| [**енаблеуипревиев**](database-enableuipreview.md)                       | Упрощает создание диалоговых окон и объявлений, предоставляя поддержку, необходимую для просмотра диалоговых окон пользовательского интерфейса, хранящихся в базе данных установщика.<br/> |
| [**Экспорт**](database-export.md)                                         | Копирует структуру и данные из указанной таблицы в текстовый файл архива.<br/>                                                                                   |
| [**Преобразование**](database-generatetransform.md)                   | Создает преобразование.<br/>                                                                                                                                           |
| [**Импорт**](database-import.md)                                         | Импортирует таблицу базы данных из текстового файла архива.<br/>                                                                                                             |
| [**AutoMerge**](database-merge.md)                                           | Объединяет эталонную базу данных с базовой базой данных.<br/>                                                                                                          |
| [**OpenView**](database-openview.md)                                     | Возвращает объект [**представления**](view-object.md) , представляющий запрос, заданный строкой SQL.<br/>                                                                 |



 

### <a name="properties"></a>Свойства

У объекта **базы данных** есть эти свойства.



| Свойство                                                                               | Описание                                                                                                                                                      |
|:---------------------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**датабасестате**](database-databasestate.md)<br/>                             | Возвращает состояние сохраняемости базы данных.<br/>                                                                                                        |
| [**PrimaryKeys**](database-primarykeys.md)<br/>                                 | Возвращает объект [**Record**](record-object.md) , содержащий имя таблицы и имена столбцов (в том состоят первичные ключи).<br/>                        |
| [**SummaryInformation (объект Database)**](database-summaryinformation.md)<br/> | Возвращает объект [**суммаринфо**](summaryinfo-object.md) , который может использоваться для проверки, обновления и добавления свойств в поток сводных данных.<br/> |
| [**таблеперсистент**](database-tablepersistent.md)<br/>                         | Возвращает состояние сохраняемости таблицы.<br/>                                                                                                           |



 

## <a name="requirements"></a>Требования



| Требование | Значение |
|--------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Версия<br/> | Установщик Windows 5,0 в Windows Server 2012, Windows 8, Windows Server 2008 R2 или Windows 7. Установщик Windows 4,0 или установщик Windows 4,5 на Windows Server 2008 или Windows Vista. установщик Windows в Windows Server 2003 или Windows XP<br/> |
| DLL<br/>     | <dl> <dt>Msi.dll</dt> </dl>                                                                                                                                                                      |
| IID<br/>     | IID \_ идатабасе определяется как 000C109D-0000-0000-C000-000000000046<br/>                                                                                                                                                                            |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[Примеры сценариев установщик Windows](windows-installer-scripting-examples.md)
</dt> </dl>

 

 




