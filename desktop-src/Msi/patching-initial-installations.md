---
description: Исправление установщик Windows (MSP) можно применить при первой установке приложения с помощью свойства PATCH.
ms.assetid: 2c4b9d5a-34fb-4a0b-b530-30bf238468fd
title: Установка исправлений первоначальных установок
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fa85e15da18f7342f38cf82228bc31b6e3085f09
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "103999589"
---
# <a name="patching-initial-installations"></a>Установка исправлений первоначальных установок

Исправление установщик Windows (MSP) можно применить при первой установке приложения с помощью свойства [**Patch**](patch.md) .

Чтобы применить исправление при первом установке приложения, необходимо установить свойство [**Patch**](patch.md) в командной строке. Укажите полный путь к исправлению в командной строке в виде пары "свойство-значение" PATCH = {*путь к исправлению*} ".

Обратите внимание, что указание свойства [**Patch**](patch.md) в командной строке переопределяет проверки применимости исправления, выполняемые при использовании [**Мсиапплипатч**](/windows/desktop/api/Msi/nf-msi-msiapplypatcha) или [параметра командной строки](command-line-options.md)/p.

Если исправление применяется с помощью [**мсиапплипатч**](/windows/desktop/api/Msi/nf-msi-msiapplypatcha) или [параметра командной строки](command-line-options.md)/p, установщик сравнивает приложения, установленные в настоящее время на компьютере, со списком кодов продуктов, доступных для получения исправления, в свойстве [**Сводка шаблона**](template-summary.md) .

При установке свойства [**Patch**](patch.md) в командной строке для установки при первой установке приложения, подходящие для получения исправления, определяются условиями проверки для преобразований, внедренных в пакет исправлений. Рекомендуемым методом для создания пакета исправлений является использование средства создания исправлений, такого как [Msimsp.exe](msimsp-exe.md) и [PATCHWIZ.DLL](patchwiz-dll.md). Условия проверки для преобразований в исправлении берутся из столбца Продуктвалидатефлагс таблицы [таржетимажес](targetimages-table-patchwiz-dll-.md) в файле свойств создания исправления (PCP).

Исправление можно применить при первом запуске приложения с помощью командной строки, другого приложения или сценария.

Ниже показаны предварительные исправления из командной строки.

**msiexec/i** *package.msi* **исправление =**_"c: \\ Directory \\ patch. MSP"_

Ниже показаны предварительные исправления из другого приложения.

``` syntax
UINT uiStat = MsiInstallProduct(_T("package.msi"), _T("PATCH=c:\directory\patch.msp"));
```

Ниже показаны предварительные исправления из сценария.


```VB
Dim Installer as Object
Set Installer = CreateObject("WindowsInstaller.Installer")
Installer.InstallProduct "package.msi", "PATCH=c:\directory\patch.msp"
```



* * Установщик Windows 3,0 и более поздних версий: * *

Начиная с версии установщик Windows 3,0, при первой установке приложения можно применить несколько исправлений. Задайте для свойства [**Patch**](patch.md) разделенный точками с запятой список полных путей исправления. Ниже показаны предварительные исправления нескольких исправлений из командной строки.

**msiexec/i** *package.msi* **исправление =**_"c: \\ Directory \\ patch. MSP; c: \\ Directory \\ Patch2. MSP; c: \\ Directory \\ patch3. MSP"_

 

 



