---
description: Модуль слияния может быть применен к файлу .msi для добавления каталогов в установку, но не может заменить или удалить существующие каталоги.
ms.assetid: 5b808aa2-b2b2-4703-bd57-0b5e1e73b306
title: Создание таблиц каталога для модуля слияния
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f90768dff191b729d482f8ddd58a821a6ed440e79fcd1453ff412aaf7b8a76fb
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "120086274"
---
# <a name="authoring-merge-module-directory-tables"></a>Создание таблиц каталога для модуля слияния

Модуль слияния может быть применен к файлу .msi для добавления каталогов в установку, но не может заменить или удалить существующие каталоги. В [таблице Directory](directory-table.md) указывается структура каталогов, которые модуль слияния предоставляет для целевой установки. Таблица каталогов необходима в каждом модуле слияния.

При создании таблицы Directory в модуле слияния следуйте приведенным ниже рекомендациям. Дополнительные сведения см. в разделе [Таблица каталогов](directory-table.md) и [Использование таблицы Directory](using-the-directory-table.md).

-   Структура каталогов, добавленная модулем слияния, должна иметь один корневой каталог. Корень должен иметь имя TARGETDIR. Пользователь может изменить значение параметра TARGETDIR во время слияния, чтобы указать, куда присоединить структуру каталогов модуля к дереву каталогов целевого объекта.
-   Таблицы модулей слияния, отличные от таблицы каталога, не должны напрямую ссылаться на расположения каталогов для TARGETDIR. Расположение такой ссылки изменяется при изменении значения параметра TARGETDIR пользователем.
-   Таблицы в модуле слияния должны ссылаться на расположение дочернего каталога TARGETDIR или другого каталога в дереве модуля слияния. Выполните следующие действия, чтобы указать TARGETDIR в качестве родителя каталога в модуле слияния. Введите каталог в столбец Directory и введите TARGETDIR в \_ родительский столбец каталога. Используйте нотацию "." в столбце Дефаултдир, чтобы указать, что этот каталог расположен в TARGETDIR без подкаталога. Дополнительные сведения см. [в разделе Использование таблицы Directory](using-the-directory-table.md).
-   Имена каталогов, добавляемых модулем слияния, должны использовать соглашения об именовании, описанные в разделе [именование первичных ключей в базах данных модулей слияния](naming-primary-keys-in-merge-module-databases.md). К ним относятся каталоги, предопределенные свойствами, такими как свойство [**системфолдер**](systemfolder.md) и свойство [**ProgramFilesFolder**](programfilesfolder.md) .
-   Добавьте [*идентификатор GUID*](g-gly.md) для каждой записи в таблице Directory (за исключением TARGETDIR.) сюда входят записи таблицы каталогов, указывающие установщик Windows свойства [**системфолдер**](systemfolder.md) , например системфолдер. 00000000 0000 0000 0000 \_ \_ \_ \_ 000000000000. Mergemod.dll библиотеки добавляет настраиваемые действия для задания свойства **системфолдер** .
-   При включении предопределенного каталога в модуль слияния средство слияния автоматически добавляет в целевую базу данных [Пользовательский тип действия 51](custom-action-type-51.md) . Автор модуля слияния должен убедиться, что [Таблица CustomAction](customaction-table.md) также включена. Таблица CustomAction может быть пустой, но эта таблица должна существовать в целевой базе данных и гарантировать, что измененные стандартные каталоги записываются в правильные расположения. Например, если системный каталог включен в модуль слияния, автор модуля слияния должен убедиться в существовании пользовательской таблицы действий.

    Обратите внимание, что алгоритм сопоставления для создания следующих настраиваемых действий типа 51 проверяет, что имя каталога начинается с одного из предопределенных свойств [**системфолдер**](systemfolder.md) . Он не проверяет, совпадает ли имя каталога со свойством каталога. Любой каталог, начинающийся с одного из этих стандартных имен папок, получает настраиваемое действие типа 51, даже если остальная часть имени не является идентификатором GUID. Авторы должны соблюдать осторожность, чтобы это не создавало ложных положительных совпадений и непредвиденное создание настраиваемых действий в производных первичных ключах, начинающихся с одного из свойств **системфолдер** .

Ниже приведен пример таблицы каталога в модуле слияния и ожидаемых разрешенных каталогов.



| Каталог                                              | \_Родительский каталог                                | дефаултдир  |
|--------------------------------------------------------|--------------------------------------------------|-------------|
| TARGETDIR                                              |                                                  | SourceDir   |
| Dir00. BC82E350 \_ C7FC \_ 11D1 \_ A848-006097ABDE17        | TARGETDIR                                        | .: MMM \_ PROG |
| Системфолдер. BC82E350 \_ C7FC \_ 11D1 \_ A848-006097ABDE17 | TARGETDIR                                        | Ммм \_ sys    |
| Dir02. BC82E350 \_ C7FC \_ 11D1 \_ A848-006097ABDE17        | Dir00. BC82E350 \_ C7FC \_ 11D1 \_ A848 \_ 006097ABDE17 | OCX для MFC \_    |



 

Предполагается, что модуль слияния с указанной выше таблицей каталогов будет иметь следующую структуру каталогов.



| Каталог                                              | Целевой объект                                     | Источник                                               |
|--------------------------------------------------------|--------------------------------------------|------------------------------------------------------|
| Dir00. BC82E350 \_ C7FC \_ 11D1 \_ A848-006097ABDE17        | \[Точка установки модуля слияния\]\\         | \[Исходная точка модуля слияния — \] \\ \_ PROG           |
| Системфолдер. BC82E350 \_ C7FC \_ 11D1 \_ A848-006097ABDE17 | \[системфолдер\]\\                         | \[Исходная точка модуля слияния ( \] \\ МММ) \_ sys            |
| Dir02. BC82E350 \_ C7FC \_ 11D1 \_ A848-006097ABDE17        | \[\] \\ Библиотека OCX для точки установки модуля \_ слияния | \[Исходная точка модуля слияния, модуль \] \\ MMM для \_ \\ MFC \_ OCX |



 

 

 



