---
description: Начиная с установщик Windows&\# 160; version&\# 160; 3.0, можно создавать и устанавливать исправления, которые могут быть удалены отдельно и в любом порядке, не удаляя и не переустанавливая все приложение и другие исправления.
ms.assetid: 2ad30ac9-eac9-49cf-98ae-5c053a0b500a
title: Удаление исправлений
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7cd54db3bde3a356a0c3adb299555248bbc87a0b
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105650897"
---
# <a name="removing-patches"></a>Удаление исправлений

Начиная с версии установщик Windows 3,0 можно создавать и устанавливать исправления, которые можно удалить отдельно и в любом порядке, не удаляя и не переустанавливая все приложение и другие исправления. Установщик Windows 3,0 также позволяет создавать [пакеты исправлений](patch-packages.md) с помощью [таблицы мсипатчсекуенце](msipatchsequence-table.md) , содержащей сведения о последовательности исправлений. В версиях установщик Windows более ранних, чем установщик Windows 3,0, единственным методом удаления отдельных исправлений из приложения является удаление всего исправленного приложения, а затем его повторная установка без повторного применения удаляемых исправлений.

Возможность удаления исправления зависит от того, как было создано исправление, от версии установщик Windows, используемой для установки исправления, и от изменений, внесенных исправлением в приложение. Если исправление не удаляется, единственным способом удаления исправления является удаление всего приложения и его повторная установка без применения исправления.

Можно удалить один или несколько исправлений с помощью параметра командной строки, интерфейса сценариев или путем вызова [**мсиремовепатчес**](/windows/desktop/api/Msi/nf-msi-msiremovepatchesa) из другого приложения. Дополнительные сведения об удалении исправлений см. в разделе Удаление [исправлений](uninstalling-patches.md) .

Значение свойства [**мсипатчремове**](msipatchremove.md) содержит список исправлений для удаления. Для каждого исправления в списке установщик проверяет, что установка исправления недоступна. Если у пользователя нет прав для удаления исправления, это значит, что исправление неизвестно для продукта, политика исправления не позволяет удалить или исправление было помечено как недоступное, установщик возвращает ошибку, указывающую на неудачную транзакцию установки. Дополнительные сведения о том, что определяет, не удается удалить исправление, см. в разделе [неустанавливаемые исправления](uninstallable-patches.md) .

После того как исправление будет проверено как съемное, установщик удалит исправление из последовательности приложений исправления. Дополнительные сведения о том, как установщик Windows 3,0 определяет, какую последовательность следует использовать при применении исправлений, см. в статье [виртуализация исправлений](sequencing-patches.md). Обратите внимание, что удаление исправлений из последовательности может привести к тому, что исправления будут помечены как устаревшие или замененные на активные.

Все исправления, выбранные для удаления, перечислены в свойстве [**MsiPatchRemovalList**](msipatchremovallist.md) . Это свойство является закрытым, которое задается установщиком и может использоваться в условных выражениях или запрашиваться [настраиваемыми действиями](custom-actions.md). Свойство содержит список идентификаторов GUID кода исправления для удаляемых исправлений. Настраиваемое действие может определить, применяется ли состояние установки исправления, устарело или заменено путем вызова свойства [**мсижетпатчинфоекс**](/windows/desktop/api/Msi/nf-msi-msigetpatchinfoexa) или [**патчпроперти**](patch-patchproperty.md) [объекта Patch](patch-object.md).

После удаления исправления состояние приложения будет таким же, как если бы исправление не устанавливалось. Если это возможно, установщик ограничит процесс до подмножества компонентов, затрагиваемых удаляемым исправлением. Установщик автоматически устанавливает свойство [**REINSTALL**](reinstall.md) в список затронутых компонентов. Файлы, добавленные исправлением, удаляются, а файлы, которые были изменены с помощью исправления, перезаписываются. Файлы и записи реестра восстанавливаются до версии, ожидаемой продуктом за вычетом исправления. Компоненты и компоненты, добавленные с помощью исправления, отменяют регистрацию в приложении. Обратите внимание, что дополнительное содержимое, добавленное исправлением, может остаться на компьютере пользователя, если содержимое используется другим исправлением, которое по-прежнему применимо.

Если файл общего компонента обновляется с помощью исправления, это изменение затрагивает все приложения, которые совместно используют этот компонент. После удаления исправления это изменение затрагивает все приложения, которые совместно используют этот компонент. Это означает, что удаление исправления одним приложением может восстановить файл общего компонента до более ранней версии, чем требуется другим приложением. Это может исправить первое приложение, но приведет к прекращению работы второго приложения. В этом случае второе приложение можно восстановить путем переустановки второго приложения с помощью методов, описанных в разделах [Переустановка компонента или приложения](reinstalling-a-feature-or-application.md). При этом будет восстановлена исправленная версия файла.

## <a name="related-topics"></a>См. также

<dl> <dt>

[**мсиенумаппликатионсекс**](/windows/desktop/api/Msi/nf-msi-msienumproductsexa)
</dt> <dt>

[**мсижетпатчинфоекс**](/windows/desktop/api/Msi/nf-msi-msigetpatchinfoexa)
</dt> <dt>

[**мсипатчремове**](msipatchremove.md)
</dt> <dt>

[**мсиремовепатчес**](/windows/desktop/api/Msi/nf-msi-msiremovepatchesa)
</dt> <dt>

[Последовательность исправлений](sequencing-patches.md)
</dt> <dt>

[Настраиваемые действия при удалении исправлений](patch-uninstall-custom-actions.md)
</dt> <dt>

[Неустанавливаемые исправления](uninstallable-patches.md)
</dt> <dt>

[Удаление исправлений](uninstalling-patches.md)
</dt> </dl>

 

 



