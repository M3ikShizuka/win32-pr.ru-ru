---
description: Невозможно устранить все обстоятельства, при которых приложению обновления может потребоваться доступ к исходному источнику установки.
ms.assetid: f7028c55-e4a5-4596-af7a-728c9f4f367e
title: Предотвращение необходимости доступа к исходному источнику установки исправления
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7b5dcadae12b733d76dee8c3acd5ec6af6169c47cfd8c7eeb22ad9693a75859a
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118376793"
---
# <a name="preventing-a-patch-from-requiring-access-to-the-original-installation-source"></a>Предотвращение необходимости доступа к исходному источнику установки исправления

Невозможно устранить все обстоятельства, при которых приложению обновления может потребоваться доступ к исходному источнику установки.

Придерживайтесь следующих моментов, чтобы максимально потребовать, чтобы исправление потребовало доступа к исходному источнику:

-   Используйте исправления только для целых файлов. Это избавляет от необходимости создавать двоичные исправления для всех ранее выпущенных версий файла. Обратите внимание, что обычно исправления файлов имеют больший размер, чем двоичные исправления. Можно легко установить исправление в виде полного исправления файла, создав свойство Инклудевхолефилесонли со значением 1 (одно) в файле свойств создания исправления (PCP).
-   Убедитесь, что ни одно из настраиваемых действий не имеет доступа к исходному расположению источника.
-   Убедитесь, что действие Ресолвесаурце является условным, чтобы оно выполнялось только при необходимости, или вообще не представлено.
-   Заполнение [таблицы мсифилехаш](msifilehash-table.md) для всех файлов с неверсиями. средство установщик Windows SDK, Msifiler.exe, может легко сделать это за вас.
-   Убедитесь, что все файлы имеют правильные сведения о версии и языке. средство установщик Windows SDK, Msifiler.exe, может легко сделать это за вас.

## <a name="source-requirements-when-patching"></a>Требования к источнику при установке исправлений

Для применения исправления в следующих случаях может потребоваться доступ к исходным источникам установки.

-   Это исправление применяется к компоненту, который в данный момент выполняется из источника. В этом случае функция перемещается из состояния запуска от исходного кода в локальное состояние.
-   Исправление применяется к компоненту, который имеет отсутствующий или поврежденный файл.
-   Исправление применяется к файлу в компоненте, который также содержит файлы без версий без записей Мсифилехаш. Заполненная [Таблица мсифилехаш](msifilehash-table.md) необходима для предотвращения ненужного повторного копирования файлов с неверсиями из исходного расположения.
-   Исправление было применено с REINSTALLMODE АМУС или емус. Этот параметр опасен, так как он выполняет операции копирования файлов независимо от версии файла. Это может привести к ревинг файлов, и почти всегда требуется источник. Рекомендуемое значение REINSTALLMODE — omus.
-   Отсутствует кэшированный пакет для продукта. Для применения исправления требуется кэшированный пакет. Кэшированный пакет хранится в папке установщика% WINDIR% \\ .
-   Пакет создан для выполнения вызова [действия ресолвесаурце](resolvesource-action.md). Это действие обычно следует избегать или подделать соответствующим образом, поскольку его выполнение всегда приводит к получению доступа к источнику.
-   У пакета есть пользовательское действие, которое пытается получить доступ к источнику каким-либо образом. Наиболее распространенный пример — это настраиваемое действие параллельной установки типа 23.
    > [!Note]  
    > Параллельные установки не рекомендуются для установки приложений, предназначенных для выпуска в общедоступной версии. Сведения о параллельных установках см. в разделе [одновременная установка](concurrent-installations.md).

     

-   Пакет исправлений состоит из двоичных исправлений, которые не применяются к текущей версии файла на компьютере.

рассмотрим следующий пример, где установщик Windows требуется доступ к исходному источнику при применении исправления:

1.  Установите ОКОНЧАТЕЛЬНую версию примера продукта.
2.  Примените исправление Qfe1. MSP к компьютеру. Этот патч версии 1,0 Example.dll до версии 1,1.
3.  Предоставляется новое исправление, Qfe2. MSP, которое обновляет Example.dll до версии 1,2 и устаревшие Qfe1. MSP. Однако это исправление было создано только для целевой версии 1,0 Example.dll, поскольку оно было создано с помощью RTM-версии продукта. Example.dll версии 1,2 включает исправление, содержащееся в Example.dll версии 1,1, но файл MSP был создан между образами RTM и QFE2. таким образом, когда к компьютеру применяется Qfe2. msp, установщик Windows должен получить доступ к исходному источнику. Двоичное исправление для Example.dll не может применяться к версии 1,1; Он может применяться только к версии 1,0. Это приведет к повторному копированию версии 1,0 Example.dll из исходного расположения источника, чтобы исправление можно было применить успешно.

## <a name="source-requirements-when-removing-a-patch"></a>Требования к источнику при удалении исправления

для удаления исправления может потребоваться доступ к исходным источникам установки, если установщик Windows не сохранила базовые сведения об этом исправлении. начиная с установщик Windows 3,0, установщик выборочно сохраняет базовые сведения о файлах при их обновлении. Дополнительные сведения о базовом кэше см. в разделе [уменьшение размера исправления](reducing-patch-size.md) .

 

 



