---
description: Windows Сокеты обеспечивают многоадресное обнаружение прослушивателей (MLD) на IPv6 и протокол IGMP на IPv4 для многоадресных приложений с помощью параметров сокета и запросов IOCTL.
ms.assetid: a5de4273-e86e-4f13-b068-256cb38706d4
title: MLD и IGMP с использованием сокетов Windows
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9b2c550cf2c1463f5b646efc286c05010274d3cb44e13b9559302452bccb81c9
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119051652"
---
# <a name="mld-and-igmp-using-windows-sockets"></a>MLD и IGMP с использованием сокетов Windows

Windows Сокеты обеспечивают многоадресное обнаружение прослушивателей (MLD) на IPv6 и протокол IGMP на IPv4 для многоадресных приложений с помощью параметров сокета и запросов IOCTL. На этой странице описываются параметры сокета, обеспечивающие многоадресное программирование, и описывается их использование. Определения каждого параметра сокета см. на странице [параметров сокетов](socket-options.md) .

Дополнительные сведения об использовании IOCTL для многоадресной рассылки см. в подразделе [многоадресная рассылка на основе финального состояния](final-state-based-multicast-programming.md) далее в этом разделе.

в Windows Vista и более поздних версиях набор параметров сокетов доступен для многоадресного программирования, поддерживающего адреса IPv6 и IPv4. Эти параметры сокета не зависят от IP-адреса и могут использоваться как в IPv6, так и в IPv4. В IPv6 эти параметры сокета используют MLDv2. В IPv4 эти параметры сокета используют IGMPv3. эти параметры, независимые от IP, являются предпочтительными вариантами сокетов для многоадресного программирования в Windows Vista и более поздних версиях. Windows Сокеты используют следующие параметры сокета: 

| Параметр сокета               | Тип аргумента                                            |
|-----------------------------|----------------------------------------------------------|
| \_источник блока \_ мкаст        | [**Группа \_ ИСХОДная структура \_ требований**](/windows/desktop/api/Ws2ipdef/ns-ws2ipdef-group_source_req) |
| МКАСТ \_ Присоединение \_ группы          | [**Группа \_ Структура REQ**](/windows/desktop/api/Ws2ipdef/ns-ws2ipdef-group_req)                |
| МКАСТ \_ Присоединение к \_ исходной \_ группе  | [**Группа \_ ИСХОДная структура \_ требований**](/windows/desktop/api/Ws2ipdef/ns-ws2ipdef-group_source_req) |
| МКАСТ \_ покинуть \_ группу         | [**Группа \_ Структура REQ**](/windows/desktop/api/Ws2ipdef/ns-ws2ipdef-group_req)                |
| МКАСТ \_ покинуть \_ исходную \_ группу | [**Группа \_ ИСХОДная структура \_ требований**](/windows/desktop/api/Ws2ipdef/ns-ws2ipdef-group_source_req) |
| МКАСТ \_ разблокировать \_ источник      | [**Группа \_ ИСХОДная структура \_ требований**](/windows/desktop/api/Ws2ipdef/ns-ws2ipdef-group_source_req) |



 

Набор параметров сокетов доступен для многоадресного программирования, поддерживающего только IPv6-адреса. Эти параметры сокета используют MLDv1 или MLDv2. Версия используемого MLD зависит от версии Windows. MLDv2 поддерживается в Windows Vista и более поздних версиях. Windows Сокеты используют следующие параметры сокета: 

| Параметр сокета          | Тип аргумента                             |
|------------------------|-------------------------------------------|
| \_Добавление \_ ЧЛЕНСТВА в IPv6  | [**Структура \_ мрек IPv6**](/windows/desktop/api/Ws2ipdef/ns-ws2ipdef-ipv6_mreq) |
| \_Удаление \_ ЧЛЕНСТВА в IPv6 | [**Структура \_ мрек IPv6**](/windows/desktop/api/Ws2ipdef/ns-ws2ipdef-ipv6_mreq) |



 

Набор параметров сокетов доступен для многоадресного программирования, поддерживающего только IPv4-адреса. Эти параметры сокета используют IGMPv3 или IGMPv2. Используемая версия протокола IGMP зависит от версии Windows. IGMPv3 поддерживается в Windows Vista и более поздних версиях. Windows Сокеты используют следующие параметры сокета:

| Параметр сокета                | Тип аргумента                                        |
|------------------------------|------------------------------------------------------|
| \_Добавление \_ ЧЛЕНСТВА в IP          | Структура [**IP \_ мрек**](/windows/desktop/api/Ws2ipdef/ns-ws2ipdef-ip_mreq)                |
| IP- \_ Добавление членства в \_ источнике \_  | [**Структура \_ \_ источника IP-мрек**](/windows/desktop/api/Ws2ipdef/ns-ws2ipdef-ip_mreq_source) |
| Источник IP- \_ блока \_            | [**Структура \_ \_ источника IP-мрек**](/windows/desktop/api/Ws2ipdef/ns-ws2ipdef-ip_mreq_source) |
| членство в IP-адресе \_ \_         | Структура [**IP \_ мрек**](/windows/desktop/api/Ws2ipdef/ns-ws2ipdef-ip_mreq)                |
| \_членство в \_ источнике IP-адресов \_ | [**Структура \_ \_ источника IP-мрек**](/windows/desktop/api/Ws2ipdef/ns-ws2ipdef-ip_mreq_source) |
| \_источник разблокировки IP-адреса \_          | [**Структура \_ \_ источника IP-мрек**](/windows/desktop/api/Ws2ipdef/ns-ws2ipdef-ip_mreq_source) |



 

Когда IGMPv3 доступен, параметры IP-адресов, источников IP-адресов и источников разблокировки IP-адресов \_ \_ \_ \_ \_ \_ \_ \_ \_ \_ более эффективны, так как маршрутизатор может обрабатывать фильтрацию. Если доступен только IGMPv2, узел должен поддерживать фильтрацию.

Большинство приложений, скорее всего, попадают в две категории: любой источник и управляемый код.

-   Приложения с **любым исходным кодом** принимают все источники по умолчанию, позволяя отключать отдельные источники по мере необходимости. Примером приложения с любым исходным кодом является вызов видеоконференций, который позволяет всем получателям участвовать.
-   Приложения с **управляемым исходным кодом** ограничивают источники для определенного списка, например радиостанции Интернета или вещания важных событий. Процесс использования параметров сокета несколько отличается для каждого из них.

в Windows Vista и более поздних версиях для приложений с исходным кодом применяются следующие шаги.

- Чтобы присоединиться к группе, используйте **\_ \_ группу мкаст Join** .  
- При необходимости используйте **\_ \_ источник блока мкаст** для отключения заданного источника.  
- Используйте **мкаст \_ Unblock \_ Source** для повторного разрешения заблокированного источника, если это необходимо.  
- Используйте **мкаст \_ покинуть \_ группу** , чтобы выйти из группы.  

в Windows Vista и более поздних версиях для приложений с управляемым исходным кодом применяются следующие шаги.

- Используйте **\_ \_ \_ группу источников мкаст Join** для объединения каждой пары "Группа-источник".  
- Используйте **мкаст \_ покинуть \_ исходную \_ группу** , чтобы выйти из каждой группы или источника, или используйте **мкаст \_ покинуть \_ группу** , чтобы оставить все источники, если один и тот же адрес группы используется всеми источниками.  

Для приложений с исходным кодом применяются следующие шаги.

- Использовать **IP-адрес \_ Добавить \_ членство** для приподключения к группе (**IPv6 \_ Добавление \_ членства** для IPv6).  
- Используйте **\_ \_ источник блока IP** для отключения заданного источника, если это необходимо.  
- Используйте **\_ \_ источник разблокировки IP** для повторного разрешения заблокированного источника, если это необходимо.  
- Используйте **\_ \_ членство в IP-адресе** , чтобы выйти из группы (**\_ удалить \_ членство IPv6** для IPv6).  

Для приложений с управляемым исходным кодом применяются следующие шаги.

- Используйте **IP-адрес \_ Добавить \_ \_ членство в источнике** для объединения каждой пары "Группа-источник".  
- Используйте **\_ \_ \_ членство в источнике IP-адресов** , чтобы выйти из каждой группы или источника, или используйте **\_ \_ членство в IP-** адресе, чтобы оставить все источники, если один и тот же объект группы используется всеми источниками.  

Порядок, в котором установлены эти параметры сокета, имеет связанные правила. Сведения и сведения об устранении неполадок в параметрах многоадресных сокетов см. в разделе [режим многоадресного сокета](multicast-socket-option-behavior.md).
