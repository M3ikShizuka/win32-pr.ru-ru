---
description: Нестандартные данные (OOB) — это логически независимый канал передачи, связанный с парой сокетов подключенных потоков.
ms.assetid: 30f667cd-5be9-45f2-9d55-bff04834078f
title: Независимые от протокола данные о независимых аппаратных единицах в SPI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b53e5c7c5c8c8ad7a5985ec101dd157370c5f32f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104541511"
---
# <a name="protocol-independentout-of-band-data-in-the-spi"></a>Независимые от протокола данные о независимых аппаратных единицах в SPI

Нестандартные данные (OOB) — это логически независимый канал передачи, связанный с парой сокетов подключенных потоков. Данные OOB могут быть переданы пользователю независимо от обычных данных. Абстракция определяет, что средства данных OOB должны поддерживать надежную доставку по крайней мере одного блока данных OOB за раз. Этот блок данных может содержать по крайней мере один байт данных, и по крайней мере один блок данных OOB может быть отложенной доставкой пользователя в любой момент времени. Для протоколов связи, которые поддерживают аппаратный сигнал (то есть TCP, где срочные данные поступают последовательно с обычными данными), система обычно извлекает данные OOB из потока обычных данных и сохраняет их отдельно (при этом пропуска в обычном потоке данных). Это позволяет пользователям выбирать между получением данных OOB по порядку и их получением из последовательности без необходимости буферизации всех промежуточных данных. Можно просматривать данные OOB.

Пользователь может определить, ожидают ли какие-либо данные OOB, ожидающие чтения, с помощью функции [**вспиоктл**](/previous-versions/windows/hardware/network/ff566296(v=vs.85)) (сиокатмарк). Для протоколов, в которых понятие положения блока данных OOB в обычных потоках данных имеет смысл (т. е. TCP), поставщик услуг Windows Sockets будет поддерживать концептуальный маркер, указывающий позицию последнего байта данных OOB в потоке обычных данных. Это не является обязательным для реализации функции **вспиоктл** (сиокатмарк) — требуется только присутствие или отсутствие данных OOB.

Для протоколов, в которых концепция положения блока данных OOB в нормальных потоках данных имеет смысл, приложение может предпочесть обрабатывать нестандартные данные встроенным образом как часть обычного потока данных. Это достигается путем установки параметра сокета \_ убинлине (см. раздел [**вспиоктл**](/previous-versions/windows/hardware/network/ff566296(v=vs.85))). Для других протоколов, в которых блоки данных OOB действительно не зависят от обычного потока данных, попытка установки \_ убинлине приведет к ошибке. Приложение может использовать команду СИОКАТМАРК Вспиоктл, чтобы определить наличие непрочтенных данных OOB, предшествующих метке. Например, он может использовать его для повторной синхронизации с одноранговым узлом, гарантируя, что все данные в потоке данных будут отброшены при необходимости.

WITH \_ убинлине Disabled (по умолчанию):

-   Поставщик услуг Winsock уведомляет клиента о событии с ДЕМОном \_ OOB, если клиент, зарегистрированный для уведомления с [**вспасинкселект**](/previous-versions/windows/desktop/legacy/ms742267(v=vs.85)), точно так же, как и \_ прочитанный, используется для уведомления о присутствии обычных данных. Это значит, что демон \_ OOB публикуется, когда приводятся данные OOB, а данные OOB ранее не помещаются в очередь, а также когда данные считываются с помощью \_ флага OOB, а некоторые данные OOB остаются для чтения после возврата операции чтения. Сообщения ДЕМОна \_ чтения не размещаются для данных OOB.
-   Поставщик службы Winsock возвращает из [**вспселект**](/previous-versions/windows/desktop/legacy/ms742289(v=vs.85)) с соответствующим набором сокетов *ексцептфдс* , если данные OOB поставлены в очередь на сокете.
-   Клиент может вызвать [**вспрекв**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) с сообщением \_ OOB для чтения блока срочных данных в любое время. Блок данных OOB переходит в очередь.
-   Клиент может вызвать [**вспрекв**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) без сообщения \_ OOB для чтения потока обычных данных. Блок данных OOB не будет отображаться в потоке данных с обычными данными. Если данные OOB остаются после любого вызова **вспрекв**, поставщик услуг уведомляет клиента с помощью демона \_ OOB или *ексцептфдс* при использовании [**вспселект**](/previous-versions/windows/desktop/legacy/ms742289(v=vs.85)).
-   Для протоколов, в которых данные OOB имеют позицию в потоке обычных данных, одна операция [**вспрекв**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) не будет охватывать эту позицию. Один **вспрекв** вернет обычные данные перед меткой, а второй **вспрекв** — для начала чтения данных после метки.

При \_ включенном убинлине:

-   \_Стандартные сообщения OOB не отправляются для данных OOB. для функций [**Вспселект**](/previous-versions/windows/desktop/legacy/ms742289(v=vs.85)) и [**вспасинкселект**](/previous-versions/windows/desktop/legacy/ms742267(v=vs.85)) данные OOB обрабатываются как обычные данные и указываются путем установки сокета в *реадфдс* или путем отправки сообщения об прочитанном экземпляре фильтра \_ соответственно.
-   Клиент может не вызывать [**вспрекв**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) с \_ флагом сообщения OOB, установленным для чтения блока данных OOB — код ошибки всаеинвал будет возвращен.
-   Клиент может вызвать [**вспрекв**](/previous-versions/windows/hardware/network/ff566309(v=vs.85)) без \_ установленного флага OOB. Все данные OOB будут доставляться в правильном порядке в потоке обычных данных. Данные OOB никогда не будут смешиваться с обычными данными — для получения данных OOB необходимо три запроса на чтение. Первый возвращает обычные данные до блока данных OOB, второй возвращает данные OOB, третий — обычные данные, следующие за данными OOB. Иными словами, границы блоков данных OOB сохраняются.

Подпрограммы [**вспасинкселект**](/previous-versions/windows/desktop/legacy/ms742267(v=vs.85)) особенно хорошо подходят для обработки уведомлений о присутствии данных OOB, когда убинлине отключен \_ .

 

 
