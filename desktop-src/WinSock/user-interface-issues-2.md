---
description: Одним из наиболее очевидных изменений из IPv4 в IPv6 является размер IP-адреса. Многие пользовательские интерфейсы предоставляют диалоговые окна, позволяющие пользователю ввести IP-адрес, как содержащиеся на следующем рисунке.
ms.assetid: e2d7fd41-297a-400b-ae59-5d67db2be6f6
title: Проблемы с пользовательским интерфейсом для IPv6-приложений Winsock
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 03305073687cdd77e17c529d70ffe5959df40960
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127346871"
---
# <a name="user-interface-issues-for-ipv6-winsock-applications"></a>Проблемы с пользовательским интерфейсом для IPv6-приложений Winsock

Одним из наиболее очевидных изменений из IPv4 в IPv6 является размер IP-адреса. Многие пользовательские интерфейсы предоставляют диалоговые окна, позволяющие пользователю ввести IP-адрес, как содержащиеся на следующем рисунке.

![поле общего IPv4-адреса в пользовательском интерфейсе](images/portingguide001.jpg)

Адресация в IPv6 из-за многих факторов, таких как длина, сложность и значимость разделов в адресном пространстве IPv6, не пригодногося на изменение или спецификацию пользователями. Таким образом, необходимость в предоставлении пользователям возможности указывать свой адрес уменьшается. Кроме того, из-за сложности, связанной с адресацией IPv6, предоставление администраторам возможности указывать сведения об адресе IPv6, скорее всего, не будет происходить на уровне каждого узла.

Отображение адреса IPv6 в пользовательском интерфейсе не является представлением, поэтому разработчики должны учитывать вариативность в размере IPv6-адреса при изменении приложения для поддержки IPv6.

В оставшейся части этого раздела обсуждается разница между предсказуемостью IPv4-адреса и соображениями длины адреса IPv6. В этом разделе предполагается, что IPv6-адреса отображаются в шестнадцатеричном представлении.

Адреса IPv4 могут быть предсказуемыми по размеру, так как они жестко подчиняются десятичной нотации, как показано в следующем примере адреса:

``` syntax
10.10.256.1
```

Адреса IPv6 не настолько предсказуемы, так как соглашение IPv6-адресов позволяет использовать двойные двоеточия (::) для представления ряда нулей. Таким образом, следующие представления адресов IPv6 приравниваются к одному и тому же IPv6-адресу:

``` syntax
1040:0:0:0:0:0:0:1
1040::1
```

Возможность представления ряда нулей с двойным двоеточием приводит к непредсказуемой длине любого конкретного IPv6, что требует от программистов учитывать эту возможность при создании пользовательского интерфейса для отображения адресов IPv6. Конечно, разработчики должны убедиться, что пользовательский интерфейс способен отображать IP-адреса, которые не используют двойные двоеточия для представления ряда нулей (первый адрес ниже), а также могут отображать самый длинный адрес IPv6 (второй адрес ниже, с внедренным IPv4-адресом) при создании пользовательского интерфейса с поддержкой IPv6. Обратите внимание, что Добавление идентификатора области (ID) к следующему адресу приведет к увеличению его длины на примерно 11 символов:

``` syntax
21DA:00D3:0010:2F3B:02AA:00FF:FE28:9C5A
0000:0000:0000:0000:0000:ffff:123.123.123.123
```

Еще одно важное замечание состоит в том, что адреса на основе имен являются более подходящими, чем IPv6-адреса на основе номеров. Если адреса на основе имен более уместны, следует учитывать, что соглашения об именах должны быть встроены в пользовательский интерфейс, включая любую входную проверку ошибок, соответствующую задаче.

Существуют и другие сложности, связанные с отображением IPv6-адресов, которые необходимо учитывать разработчикам при изменении их приложения, а также при проектировании представлений адресов IPv6 в пользовательском интерфейсе. Ниже приведены некоторые из этих соображений.

-   Должен ли адрес содержать все последовательности нулей или использовать нотацию с двойным двоеточием?
-   Лучше ли использовать представление адреса на основе чисел или представление на основе имени?
-   Пользователь заинтересован в различии определенного аспекта схемы адресации, например префикс подсети, идентификатор области или другие подполя?
-   Пользователь заинтересован в определении других аспектов адреса, например идентификатора TLA, идентификатора NLA или идентификатора SLA?
-   Будет ли пользовательский интерфейс способен определять внедренные IPv6-адреса и, если да, как они будут обрабатываться и отображаться? Будет ли получено различие между IPv4-совместимыми адресами и IPv6-адресами, сопоставленными с IPv4, при отображении сведений об адресе пользователю?

Существуют и другие рекомендации, и разработчикам следует тщательно учитывать их аудиторию при разработке пользовательских интерфейсов IP-адресов.

Рекомендации

-   При изменении приложения для поддержки IPv6 разработчики должны учитывать соответствующий подход к каждому пользовательскому интерфейсу. Убедитесь, что пользовательский интерфейс содержит достаточную длину для того, чтобы отображать IPv6-адреса принудительно, а определяет, является ли этот адрес числом или именем на основе имени.
-   Везде, где это возможно, используйте существующие вспомогательные функции Winsock и IP при использовании IPv6-адресов вместо повторной реализации этой логики. Например, функции [**RtlIpv6AddressToString**](/windows/win32/api/ip2string/nf-ip2string-rtlipv6addresstostringa), [**RtlIpv6AddressToStringEx**](/windows/win32/api/ip2string/nf-ip2string-rtlipv6addresstostringexw), [**RtlIpv6StringToAddress**](/windows/win32/api/ip2string/nf-ip2string-rtlipv6stringtoaddressa)и [**RtlIpv6StringToAddressEx**](/windows/win32/api/ip2string/nf-ip2string-rtlipv6stringtoaddressexw) можно использовать для преобразования между IPv6-адресами и строковыми представлениями этих IPv6-адресов.

Код, чтобы избежать

-   Элементы пользовательского интерфейса, которые зависят от адреса IPv4, должны тщательно пропускаться, и часть этой тщательности должна включать сведения о том, подходит ли предоставленная информация (в IPv4) для IPv6.
-   Возможность указывать IP-адрес также должна зависеть от того, используется ли протокол IPv4 или доступен протокол IPv6. Если доступен протокол IPv6, можно ли указать адреса на основе номера (шестнадцатеричного) или адреса на основе имен?

Задачи кодирования

**Изменение существующей базы кода с IPv4 на IPv4 и совместимость с IPv6**

1.  Выполните визуальную проверку пользовательского интерфейса, чтобы найти любой элемент, зависящий от определенной длины для строки IP-адреса. Элементы управления с легко идентифицируемой четырьмя разделами десятичной нотации легко распознаются, а другие — нет. Возможно, там есть места, где могут отображаться IP-адреса, например в диалоговых окнах, где адрес IPv6 может не отображаться.
2.  При обнаружении любого из этих элементов управления сопротивляются, подходит ли он для вывода адреса при использовании IPv6. Если возможно использование IPv4 или IPv6, убедитесь, что пользовательский интерфейс может разместить или. Замените или дополните все элементы управления, используя элементы управления пользовательского интерфейса, которые могут отображать весь IPv6-адрес.
3.  Перед тестированием пользовательского интерфейса убедитесь, что изменения, включающие отображение IPv6-адресов, поддерживают предполагаемое удобство использования при использовании IPv4-адресов. Кроме того, проверьте адреса протокола, например информационные диалоговые окна, чтобы убедиться, что они должным образом обрабатывали IPv6-адреса.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[рекомендации по IPv6 для приложений Windows sockets](ipv6-guide-for-windows-sockets-applications-2.md)
</dt> <dt>

[Изменение структур данных для IPv6 Winsock Аппикатионс](changing-data-structures-2.md)
</dt> <dt>

[Сокеты с двумя стеками для IPv6-приложений Winsock](dual-stack-sockets.md)
</dt> <dt>

[Вызовы функций для IPv6-приложений Winsock](function-calls-2.md)
</dt> <dt>

[Использование жестко закодированных IPv4-адресов](use-of-hardcoded-ipv4-addresses-2.md)
</dt> <dt>

[Базовые протоколы для IPv6-приложений Winsock](underlying-protocols-2.md)
</dt> </dl>

 

 
