---
description: Как упоминалось ранее, функция Всажоинлеаф используется для присоединение конечного узла к сеансу MultiPoint.
ms.assetid: eaa1593a-36eb-4d92-a3d9-91566fc0216b
title: Использование Всажоинлеаф
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: dd13b6d82960f74135fa519a1284a1274b878e18c32f59d9c2b8c46ebd592c3f
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "120121024"
---
# <a name="using-wsajoinleaf"></a>Использование Всажоинлеаф

Как упоминалось ранее, функция [**всажоинлеаф**](/windows/desktop/api/Winsock2/nf-winsock2-wsajoinleaf) используется для присоединение конечного узла к сеансу MultiPoint. **Всажоинлеаф** имеет те же параметры и семантику, что и [**всаконнект**](/windows/desktop/api/Winsock2/nf-winsock2-wsaconnect) , за исключением того, что она возвращает дескриптор сокета (как в [**всаакцепт**](/windows/desktop/api/Winsock2/nf-winsock2-wsaaccept)) и имеет дополнительный параметр *dwFlags* .

Параметр *dwFlags* используется для указания того, будет ли сокет действовать только как отправитель, только как получатель или как и то, и другое. *В этой* функции для входных параметров можно использовать только сокеты MultiPoint. Если сокет MultiPoint находится в неблокирующем режиме, возвращаемый дескриптор сокета не может использоваться до тех пор, пока \_ не будет получено соответствующее указание на подключение фильтра. Корневое приложение в сеансе MultiPoint может вызвать [**всажоинлеаф**](/windows/desktop/api/Winsock2/nf-winsock2-wsajoinleaf) один или несколько раз, чтобы добавить несколько конечных узлов, однако одновременно может выполняться не более одного запроса на подключение MultiPoint.

Дескриптор сокета, возвращаемый функцией [**всажоинлеаф**](/windows/desktop/api/Winsock2/nf-winsock2-wsajoinleaf) , зависит от того, является ли дескриптор входного сокета, корнем *c,* \_ или \_ конечным листом c. При использовании с \_ корневым сокетом c параметр *Name* обозначает добавляемый конечный узел, а возвращаемый дескриптор сокета — конечный сокет c, \_ соответствующий вновь добавленному конечному узлу. Он не предназначен для использования в обмене данными MultiPoint, но используется для получения появления "демо \_ -# xxx" (например, \_ "Демон закрытия") для соединения, которое существует для конкретного листа c \_ . Некоторые реализации MultiPoint также могут разрешить использование этого сокета для побочных сеансов между корнем и отдельным конечным узлом. \_Для этого сокета получено уведомление о закрытии, если соответствующий конечный узел вызывает [**функции closesocket**](/windows/desktop/api/winsock/nf-winsock-closesocket) для удаления сеанса MultiPoint. В симметричном виде вызов **функции closesocket** на \_ оконечном сокете c, возвращенном из **всажоинлеаф** , приводит к тому, что сокет в соответствующем конечном узле получает \_ уведомление о закрытии демона.

При вызове [**всажоинлеаф**](/windows/desktop/api/Winsock2/nf-winsock2-wsajoinleaf) с \_ конечным сокетом c параметр *Name* содержит адрес корневого приложения (для схемы корневого элемента управления) или существующий сеанс MultiPoint (неадминистративная схема управления), а возвращаемый дескриптор сокета совпадает с дескриптором входного сокета. В схеме с корневым контролем корневое приложение помещает свой \_ корневой сокет c в режим прослушивания, вызывая [**Listen**](/windows/desktop/api/Winsock2/nf-winsock2-listen). Стандартное \_ уведомление о принятии запроса на выступающий доставляется, когда конечный узел запрашивает присоединение к сеансу MultiPoint. Корневое приложение использует обычные функции [**Accept**](/windows/desktop/api/Winsock2/nf-winsock2-accept) / [**всаакцепт**](/windows/desktop/api/Winsock2/nf-winsock2-wsaaccept) , чтобы признать новый конечный узел. Значение, возвращаемое либо **Accept** , либо **всаакцепт** , является также \_ дескриптором конечного сокета c, как и возвращенные из **всажоинлеаф**. Для размещения схем MultiPoint, которые допускают соединения, инициированные как с помощью корневого, так и для конечной точки, допускается \_ Использование корневого сокета c, который уже находится в режиме прослушивания, в качестве входных данных для **всажоинлеаф**.

Корневое приложение MultiPoint обычно отвечает за упорядоченный дисмантлинг сеанса MultiPoint. Такое приложение может использовать [**Shutdown**](/windows/desktop/api/winsock/nf-winsock-shutdown) или [**функции closesocket**](/windows/desktop/api/winsock/nf-winsock-closesocket) на \_ корневом сокете c для выполнения всех связанных \_ конечных сокетов c, включая те, которые были возвращены из [**всажоинлеаф**](/windows/desktop/api/Winsock2/nf-winsock2-wsajoinleaf) и соответствующих \_ конечных сокетов c в удаленных КОНЕЧных узлах для получения \_ уведомления о закрытии демона.

 

 



