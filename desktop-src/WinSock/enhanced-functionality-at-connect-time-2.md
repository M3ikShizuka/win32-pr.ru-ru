---
description: Сокеты Windows 2 предлагают расширенный набор операций, которые могут возникать коинЦидент для установления подключения через сокет. Требования к поставщику услуг для реализации этих функций описаны ниже.
ms.assetid: fbc7055e-ea25-4d17-8039-f0fef300353c
title: Улучшенная функциональность во время подключения
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d33c6d7ee928fe7e97f535363e9e842285eef7fe
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104145076"
---
# <a name="enhanced-functionality-at-connect-time"></a>Улучшенная функциональность во время подключения

Сокеты Windows 2 предлагают расширенный набор операций, которые могут возникать коинЦидент для установления подключения через сокет. Требования к поставщику услуг для реализации этих функций описаны ниже.

## <a name="conditional-acceptance"></a>Условное принятие

Как было сказано ранее, [**вспакцепт**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspaccept) вызывает предоставляемую клиентом функцию условия, которая использует входные параметры для предоставления сведений о ожидающем запросе на подключение. Эта информация может использоваться клиентом для принятия или отклонения запроса на подключение на основе информации вызывающего объекта, такой как идентификатор вызывающего объекта, качество обслуживания и т. д. Если функция условия возвращает параметр CF \_ Accept, то создается новый сокет с теми же свойствами, что и у прослушивающего сокета, и возвращается новый обработчик для нового сокета. Если функция условия возвращает значение CF \_ Reject, запрос на соединение должен быть отклонен. Если функция условия возвращает значение CF \_ , принятие или отклонение не может быть сделано немедленно, и поставщик услуг должен оставить запрос на соединение в очереди невыполненной работы. Клиент должен вызвать **вспакцепт** снова, когда он готов принять решение, и организовать функцию условия, чтобы она возвращала либо \_ отклонить CF Accept, либо CF \_ . Хотя отложенный запрос на подключение находится в верхней части очереди невыполненной работы, поставщик услуг не выдает никаких дальнейших указаний для ожидающих запросов на подключение.

## <a name="exchanging-user-data-at-connect-time"></a>Обмен данными пользователя во время подключения

Некоторые протоколы позволяют обмениваться небольшим количеством пользовательских данных во время подключения. Если эти данные были получены с подключенного узла, они помещаются в буфер поставщика услуг, а указатель на этот буфер вместе со значением длины передается клиенту Winsock SPI посредством входных параметров функции условия [**вспакцепт**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpwspaccept) . Если клиент Winsock SPI имеет ответные данные для возврата к узлу подключения, он может скопировать его в буфер, предоставленный поставщиком услуг. Указатель на этот буфер и целое число, указывающие размер буфера, также предоставляются в качестве входных параметров функции условия (если поддерживается протоколом).

## <a name="establishing-socket-groups"></a>Установка групп сокетов

Все использование групп сокетов зарезервировано.

 

 



