---
description: В следующих таблицах описаны \_ параметры сокета IPv6 иппрото, применяемые к сокетам, созданным для семейства адресов IPv6 (AF \_ INET6). Дополнительные сведения о получении и настройке параметров сокета см. на страницах справочника по функциям жетсоккопт и сетсоккопт.
ms.assetid: 65f8f7a4-757b-43a3-9d47-b115754c89d6
title: Параметры сокета IPPROTO_IPV6
ms.topic: article
ms.date: 10/07/2019
ms.openlocfilehash: 0a6612e9d494325a40cf7b00803dbd13ead68def094383cb3faa50e0160ef932
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "120097754"
---
# <a name="ipproto_ipv6-socket-options"></a>\_Параметры сокета иппрото IPv6

В следующих таблицах описаны параметры сокета **\_ IPv6 иппрото** , применяемые к сокетам, созданным для семейства адресов IPv6 (AF \_ INET6). Дополнительные сведения о получении и настройке параметров сокета см. на страницах справочника по функциям [**жетсоккопт**](/windows/desktop/api/winsock/nf-winsock-getsockopt) и [**сетсоккопт**](/windows/desktop/api/winsock/nf-winsock-setsockopt) .

Для перечисления протоколов и обнаружения поддерживаемых свойств для каждого установленного протокола используйте функцию [**всаенумпротоколс**](/windows/desktop/api/Winsock2/nf-winsock2-wsaenumprotocolsa), [**всценумпротоколс**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscenumprotocols)или [**WSCEnumProtocols32**](/windows/desktop/api/Ws2spi/nf-ws2spi-wscenumprotocols32) .

Для некоторых параметров сокета требуется больше объяснений, чем может передать таблица. такие параметры содержат ссылки на дополнительные сведения.

## <a name="options"></a>Параметры

| Параметр | get | set | Тип оптвал | Описание |
|-|-|-|-|-|
| \_исходное поступление IP-адресов, \_ \_ Если | Да | Да | DWORD (логическое значение) | Указывает, должна ли функция [**LPFN_WSARECVMSG (всареквмсг)**](/windows/win32/api/mswsock/nc-mswsock-lpfn_wsarecvmsg) возвращать необязательные данные элемента управления, содержащие исходный интерфейс прибытия, где пакет был получен для сокетов датаграмм. Этот параметр используется с технологиями туннелирования IPv6 (например, 6to4, ISATAP и туннели Teredo), которые обеспечивают назначение адресов и автоматическое туннелирование "узел-узел" для трафика IPv6 одноадресной рассылки, когда узлы IPv6 должны перемещаться по IP4-сетям для доступа к другим сетям IPv6. Пакеты IPv6 отправляются c туннелированием в пакетах IPv4. Этот параметр позволяет вернуть исходный интерфейс IPv4, где пакет был получен, в структуре [**всамсг**](/windows/desktop/api/Ws2def/ns-ws2def-wsamsg) .  |
| IPV6_ADD_IFLIST | | Да | DWORD (IF_INDEX) | Добавляет индекс интерфейса в ИФЛИСТ, связанный с параметром **IP_IFLIST** . |
| \_Добавление \_ ЧЛЕНСТВА в IPv6 | | Да | [**\_мрек IPv6**](/windows/desktop/api/Ws2ipdef/ns-ws2ipdef-ipv6_mreq) | Присоедините сокет к указанной группе многоадресной рассылки в указанном интерфейсе.  Этот параметр допустим только для датаграмм и необработанных сокетов (тип сокета должен быть Сокк \_ дграм или Сокк \_ RAW). |
| IPV6_DEL_IFLIST | | Да | DWORD (IF_INDEX) | Удаляет индекс интерфейса из ИФЛИСТ, связанного с параметром **IP_IFLIST** . Записи могут быть удалены только приложением, поэтому имейте в виду, что записи могут стать устаревшими после удаления интерфейса. |
| \_Удаление \_ ЧЛЕНСТВА в IPv6 | | Да | [**\_мрек IPv6**](/windows/desktop/api/Ws2ipdef/ns-ws2ipdef-ipv6_mreq) | Оставить указанную группу многоадресной рассылки с указанного интерфейса.  Этот параметр допустим только для датаграмм и необработанных сокетов (тип сокета должен быть Сокк \_ дграм или Сокк \_ RAW). |
| IPV6_GET_IFLIST | Да | | DWORD [] (IF_INDEX []) | Возвращает текущую ИФЛИСТ, связанную с параметром **IP_IFLIST** . Возвращает ошибку, если **IP_IFLIST** не включена. |
| \_ХДРИНКЛ IPv6 | Да | Да | DWORD (логическое значение) | Указывает, что приложение предоставляет заголовок IPv6 для всех исходящих данных. Если для параметра *оптвал* в вызове [**сетсоккопт**](/windows/desktop/api/winsock/nf-winsock-setsockopt)задано значение **1** , параметр включен. Если *оптвал* имеет значение **0**, этот параметр отключен. По умолчанию эта политика отключена. Этот параметр допустим только для датаграмм и необработанных сокетов (тип сокета должен быть Сокк \_ дграм или Сокк \_ RAW). Поставщик услуг TCP/IP, поддерживающий Сокк \_ RAW, также должен поддерживать IPv6 \_ хдринкл. |
| \_ХОПЛИМИТ IPv6 | Да | Да | DWORD (логическое значение) | Указывает, что сведения о прыжке (TTL) должны возвращаться в функции [**LPFN_WSARECVMSG (всареквмсг)**](/windows/win32/api/mswsock/nc-mswsock-lpfn_wsarecvmsg) . Если *оптвал* имеет значение **1** при вызове [**сетсоккопт**](/windows/desktop/api/winsock/nf-winsock-setsockopt), этот параметр включен. Если задано значение **0**, параметр отключен.  Этот параметр допустим только для датаграмм и необработанных сокетов (тип сокета должен быть Сокк \_ дграм или Сокк \_ RAW). |
| IPV6_IFLIST | Да | Да | DWORD (логическое значение) | Возвращает или задает **IP_IFLISTное** состояние сокета. Если этот параметр имеет значение true, получение датаграммы ограничено интерфейсами, которые находятся в ИФЛИСТ. Датаграммы, полученные в других интерфейсах, игнорируются. ИФЛИСТ начинает быть пустым. Для изменения ИФЛИСТ используйте **IP_ADD_IFLIST** и **IP_DEL_IFLIST** . |
| \_Группа присоединений IPv6 \_ | | Да | [**\_мрек IPv6**](/windows/desktop/api/Ws2ipdef/ns-ws2ipdef-ipv6_mreq) | То же, что и \_ Добавление членства в IPv6 \_ |
| \_Группа выхода \_ IPv6 | | Да | [**\_мрек IPv6**](/windows/desktop/api/Ws2ipdef/ns-ws2ipdef-ipv6_mreq) | То же, что и \_ Удаление \_ членства IPv6 |
| \_MTU IPv6 | Да | | DWORD | Возвращает оценку системы по пути MTU. Сокет должен быть подключен. |
| \_Обнаружение IPv6 MTU \_ | Да | Да | DWORD (**\_ состояние пмтуд**) | Возвращает или задает состояние обнаружения MTU пути для сокета. Значение по умолчанию — **IP- \_ пмтудиск \_ не \_ задано**. Для сокетов потока **\_ \_ не \_ задан IP-Пмтудиск** , и **IP- \_ пмтудиск \_** выполняет обнаружение PMTU. **IP-адрес \_ ПМТУДИСК \_ не** and **IP \_ ПМТУДИСК \_ зонд** отключит обнаружение MTU пути. Для сокетов датаграмм, если задано **значение \_ IP \_ пмтудиск** , попытки отправить пакеты, превышающие MTU, будут приводить к ошибке. Если задано значение **IP \_ пмтудиск \_ не**, пакеты будут фрагментироваться в соответствии с интерфейсом MTU. Если задано значение **IP- \_ пмтудиск \_ зонда**, попытки отправить пакеты, превышающие MTU интерфейса, приведут к ошибке.  |
| \_Многоадресные \_ ПЕРЕХОДы IPv6 | Да | Да | DWORD | Возвращает или задает значение TTL, связанное с трафиком многоадресной рассылки IPv6 на сокете. Недопустимо задавать TTL значение больше 255.  Этот параметр допустим только для датаграмм и необработанных сокетов (тип сокета должен быть Сокк \_ дграм или Сокк \_ RAW). |
| \_Многоадресная рассылка IPv6, \_ Если | Да | Да | DWORD | Возвращает или задает исходящий интерфейс для отправки трафика многоадресной рассылки IPv6. Этот параметр не изменяет интерфейс по умолчанию для получения трафика многоадресной рассылки IPv6. Этот параметр важен для многосетевых компьютеров.  Входное значение для установки этого параметра является 4-байтовым индексом интерфейса нужного исходящего интерфейса в порядке байтов узла. Для получения сведений об индексе интерфейса можно использовать функцию [**жетадаптерсаддрессес**](/windows/win32/api/iphlpapi/nf-iphlpapi-getadaptersaddresses) . Если *оптвал* имеет значение **null** при вызове [**сетсоккопт**](/windows/desktop/api/winsock/nf-winsock-setsockopt), используется интерфейс IPv6 по умолчанию. Если *оптвал* равен нулю, для отправки многоадресного трафика указывается интерфейс по умолчанию для получения многоадресной рассылки.  При получении этого параметра *оптвал* возвращает текущий индекс интерфейса по умолчанию для отправки многоадресного трафика IPv6 в порядке байтов узла. |
| \_Цикл многоадресной рассылки IPv6 \_ | Да | Да | DWORD (логическое значение) | Указывает, что данные многоадресной рассылки, отправляемые через сокет, будут выведены в буфер приема сокетов, если он также присоединен к целевой группе многоадресной рассылки. Если *оптвал* имеет значение **1** при вызове [**сетсоккопт**](/windows/desktop/api/winsock/nf-winsock-setsockopt), этот параметр включен. Если задано значение **0**, параметр отключен.  Этот параметр допустим только для датаграмм и необработанных сокетов (тип сокета должен быть Сокк \_ дграм или Сокк \_ RAW). |
| [\_ПКТИНФО IPv6](ipv6-pktinfo.md) | Да | Да | DWORD (логическое значение) | Указывает, что сведения о пакете должны возвращаться функцией [**LPFN_WSARECVMSG (всареквмсг)**](/windows/win32/api/mswsock/nc-mswsock-lpfn_wsarecvmsg) . |
| [\_Уровень защиты \_ IPv6](ipv6-protection-level.md) | Да | Да | INT | Включает ограничение сокета до указанной области, например адреса с одинаковой локальной ссылкой или локальным префиксом сайта. Предоставляет различные уровни ограничений и параметры по умолчанию. Дополнительные сведения см. в разделе [ \_ \_ уровень защиты IPv6](ipv6-protection-level.md) . |
| \_РЕКВИФ IPv6 | Да | Да | DWORD (логическое значение) | Указывает, должен ли стек IP-адресов заполнять буфер управления сведениями о том, какой интерфейс получил пакет с сокетом датаграммы. Если это значение равно true, функция [**LPFN_WSARECVMSG (всареквмсг)**](/windows/win32/api/mswsock/nc-mswsock-lpfn_wsarecvmsg) вернет необязательные данные элемента управления, содержащие интерфейс, в котором пакет был получен для сокетов датаграмм. Этот параметр позволяет вернуть в структуру [**всамсг**](/windows/desktop/api/Ws2def/ns-ws2def-wsamsg) интерфейс IPv6, в котором был получен пакет.  Этот параметр допустим только для датаграмм и необработанных сокетов (тип сокета должен быть Сокк \_ дграм или Сокк \_ RAW). |
| \_РЕКВТКЛАСС IPv6 | Да | Да | DWORD (логическое значение) | Указывает, должен ли стек IP-адресов заполнять буфер управления сообщением, содержащим поле заголовка IPv6 класса трафика в полученной датаграмме. Если это значение равно true, функция [**LPFN_WSARECVMSG (всареквмсг)**](/windows/win32/api/mswsock/nc-mswsock-lpfn_wsarecvmsg) вернет необязательные данные элемента управления, содержащие значение поля заголовка IPv6 класса трафика полученной датаграммы.  Этот параметр позволяет возвратить поле заголовка IPv6 класса трафика полученной датаграммы в структуру [**всамсг**](/windows/desktop/api/Ws2def/ns-ws2def-wsamsg) . Тип возвращаемого сообщения будет ткласс IPV6 \_ . Будут возвращены все биты DSCP и ECN поля класса трафика.  Этот параметр допустим только для сокетов датаграмм (тип сокета должен быть Сокк \_ дграм).  |
| \_Одноадресные \_ ПРЫЖКи IPv6 | Да | Да | DWORD | Возвращает или задает текущее значение TTL, связанное с сокетом IPv6 для одноадресного трафика. Недопустимо задавать TTL значение больше 255. |
| \_Одноадресная рассылка IPv6, \_ Если | Да | Да | DWORD (если \_ индекс) | Возвращает или задает исходящий интерфейс для отправки трафика IPv6. Этот параметр не изменяет интерфейс по умолчанию для получения трафика IPv6. Этот параметр важен для многосетевых компьютеров.  Входное значение для установки этого параметра является 4-байтовым индексом интерфейса нужного исходящего интерфейса в порядке байтов узла. Для получения сведений об индексе интерфейса можно использовать функцию [**жетадаптерсаддрессес**](/windows/win32/api/iphlpapi/nf-iphlpapi-getadaptersaddresses) . Если *оптвал* равен нулю, для интерфейса по умолчанию для отправки IPv6-трафика устанавливается значение не указано.  При получении этого параметра *оптвал* возвращает текущий индекс интерфейса по умолчанию для отправки IPv6-трафика в порядке байтов узла. |
| IPV6_USER_MTU | Да | Да | DWORD | Возвращает или задает верхнюю границу на уровне IP MTU (в байтах) для данного сокета. Если значение превышает оценку MTU для пути (которое можно получить на подключенном сокете путем запроса параметра **IPV6_MTU** Socket), то параметр не действует. Если значение меньше, то исходящие пакеты, превышающие это, будут фрагментированы или не будут отправлены в зависимости от значения **IPV6_DONTFRAG**. Значение по умолчанию — **IP_UNSPECIFIED_USER_MTU** (максулонг). Для обеспечения безопасности типов следует использовать функции [**всажетипусермту**](/windows/win32/api/ws2tcpip/nf-ws2tcpip-wsagetipusermtu) и [**всасетипусермту**](/windows/win32/api/ws2tcpip/nf-ws2tcpip-wsasetipusermtu) вместо прямого использования параметра сокета. |
| \_V6ONLY IPv6 | Да | Да | DWORD (логическое значение) | Указывает, что сокет, созданный для \_ семейства адресов AF INET6, ограничен только связью с IPv6. Сокеты, созданные для \_ семейства адресов AF INET6, могут использоваться для обмена данными по протоколам IPv6 и IPv4. Некоторым приложениям может потребоваться ограничить использование сокета, созданного для \_ семейства адресов INET6, только для обмена данными по протоколу IPv6. если это значение не равно нулю (по умолчанию для Windows), сокет, созданный для \_ семейства адресов AF INET6, можно использовать для отправки и получения только пакетов IPv6. Если это значение равно нулю, сокет, созданный для \_ семейства адресов AF INET6, можно использовать для отправки и получения пакетов по адресу IPv6 или IPv4-адресу. Обратите внимание, что возможность взаимодействия с адресами IPv4 требует использования адресов, сопоставленных по IPv4. Этот параметр сокета поддерживается в Windows Vista и более поздних версиях. |

## <a name="windows-support-for-ipproto_ipv6-socket-options"></a>Windows поддержка \_ параметров сокета IPV6 иппрото

| Параметр | Windows 8 | Windows Server 2012 | Windows 7 | Windows Server 2008 | Windows Vista |
|-|-|-|-|-|-|
| \_исходное поступление IP-адресов, \_ \_ Если | x | x | x | | |
| IPV6_ADD_IFLIST | начиная с Windows 10, версия 1803 | | | | |
| \_Добавление \_ ЧЛЕНСТВА в IPv6 | x | x | x | x | x |
| IPV6_DEL_IFLIST | начиная с Windows 10, версия 1803 | | | | |
| \_Удаление \_ ЧЛЕНСТВА в IPv6 | x | x | x | x | x |
| IPV6_GET_IFLIST | начиная с Windows 10, версия 1803 | | | | |
| \_ХДРИНКЛ IPv6 | x | x | x | x | x |
| \_ХОПЛИМИТ IPv6 | x | x | x | x | x |
| IPV6_IFLIST | начиная с Windows 10, версия 1803 | | | | |
| \_Группа присоединений IPv6 \_ | x | x | x | x | x |
| \_Группа выхода \_ IPv6 | x | x | x | x | x |
| \_Многоадресные \_ ПЕРЕХОДы IPv6 | x | x | x | x | x |
| \_Многоадресная рассылка IPv6, \_ Если | x | x | x | x | x |
| \_Цикл многоадресной рассылки IPv6 \_ | x | x | x | x | x |
| \_ПКТИНФО IPv6 | x | x | x | x | x |
| [\_Уровень защиты \_ IPv6](ipv6-protection-level.md) | x | x | x | x | x |
| \_РЕКВИФ IPv6 | x | x | x | x | x |
| \_Одноадресные \_ ПРЫЖКи IPv6 | x | x | x | x | x |
| \_Одноадресная рассылка IPv6, \_ Если | x | x | x | x | x |
| \_V6ONLY IPv6 | x | x | x | x | x |

<br/>

| Параметр | Windows Server 2003 | Windows XP |
|-|-|-|
| \_исходное поступление IP-адресов, \_ \_ Если | | |
| IPV6_ADD_IFLIST | | |
| \_Добавление \_ ЧЛЕНСТВА в IPv6 | x | x |
| IPV6_DEL_IFLIST | | |
| \_Удаление \_ ЧЛЕНСТВА в IPv6 | x | x |
| IPV6_GET_IFLIST | | |
| IPV6 \_ хдринкл x | x |
| IPV6 \_ хоплимит x | x |
| IPV6_IFLIST | | |
| \_Группа присоединений IPv6 \_ | x | x |
| \_Группа выхода \_ IPv6 | x | x |
| \_Многоадресные \_ ПЕРЕХОДы IPv6 | x | x |
| \_Многоадресная рассылка IPv6, \_ Если | x | x |
| \_Цикл многоадресной рассылки IPv6 \_ | x | x |
| \_ПКТИНФО IPv6 | x | x |
| [\_Уровень защиты \_ IPv6](ipv6-protection-level.md) | x | x |
| \_РЕКВИФ IPv6 | | |
| \_Одноадресные \_ ПРЫЖКи IPv6 | x | x |
| \_Одноадресная рассылка IPv6, \_ Если | | |
| \_V6ONLY IPv6 | | |

## <a name="remarks"></a>Remarks

в пакете Microsoft Windows Software Development Kit (SDK), выпущенном для Windows Vista и более поздних версий, организация файлов заголовков изменилась, а **иппрото уровень \_ IPV6** определен в файле заголовка *Ws2def. h* , который автоматически включается в заголовочный файл *Winsock2. h* . Параметры сокета **иппрото \_ IPv6** определяются в файле заголовка *Ws2ipdef. h* , который автоматически включается в заголовочный файл *Ws2tcpip. h* . Файлы заголовков *Ws2def. h* и *Ws2ipdef. h* никогда не следует использовать напрямую.

\_ \_ \_ если параметр сокета поддерживается на Windows Server 2008 R2, а также в Windows 7, используется первоначальное получение IP-адреса.

## <a name="requirements"></a>Requirements (Требования)

| Требование | Значение |
|-|-|
| Заголовок | <dl> <dt>Ws2def. h (включает Winsock2. h);</dt> <dt>Winsock2. h на Windows Server 2003 и Windows XP</dt> </dl> |
