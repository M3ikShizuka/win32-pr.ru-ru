---
description: в этом разделе приводятся рекомендации по переносу широковещательного приложения IPv6 в возможности многоадресной рассылки, доступные с помощью сокетов Windows.
ms.assetid: 12e491fd-650f-43b4-afa1-9f37b1c30240
title: Перенос широковещательных приложений на IPv6
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bb54fec87be2aa6174de603d2c3e4d0e640156902002b1e87fab149a70e3d1ee
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119641704"
---
# <a name="porting-broadcast-applications-to-ipv6"></a>Перенос широковещательных приложений на IPv6

в этом разделе приводятся рекомендации по переносу широковещательного приложения IPv6 в возможности многоадресной рассылки, доступные с помощью сокетов Windows.

## <a name="comparing-ipv4-to-ipv6"></a>Сравнение IPv4 и IPv6

Наиболее важным моментом при подготовке широковещательного приложения IPv4 к IPv6 является следующее: в протоколе IPv6 не реализована концепция вещания. Вместо этого протокол IPv6 использует многоадресную рассылку.

Многоадресная рассылка для IPv6 может эмулировать традиционные возможности вещания, доступные в IPv4. Настройка параметра сокета [ \_ добавления \_ членства в IPv6](ipproto-ipv6-socket-options.md) с IPv6-адресом, установленным в область локальной связи все узлы адрес (FF02:: 1), эквивалентен широковещательной рассылке широковещательных адресов IPv4 с помощью параметра [so \_ широковещания](socket-options.md) Socket. Этот адрес иногда называют *многоузловой группой многоадресной рассылки*. Для приложений, которые просто хотят эмулировать вещание для IPv6, этот подход является эквивалентным. Однако одно важное отличие от протокола IPv6 состоит в том, что многоадресность групп многоадресной рассылки по умолчанию не принимается (широковещательные пакеты IPv4 принимаются по умолчанию). Программисты приложений должны использовать \_ \_ параметр сокета добавления членства IPv6, чтобы обеспечить многоадресную рассылку из любого источника, включая адрес многоузловой группы многоадресной рассылки.

> [!Note]  
> В IPv6 выбор интерфейса указывается в структуре аргумента, передаваемой параметру сокета многоадресной рассылки или IOCTL.

 

Но для более мощных, более надежных, более избирательных и более управляемых передач на нескольких узлах разработчики приложений должны рассмотреть возможность перехода на модель многоадресной рассылки.

## <a name="moving-to-multicast"></a>Переход на многоадресную рассылку

При использовании многоадресной рассылки программисты приложений могут выборочно выбирать отдельную пару «источник-группа», что позволяет использовать модель выборочного приема. Обнаружение многоадресного прослушивателя (MLD) на IPv6 и версия 3 протокола управления группами Интернета (IGMPv3) в IPv4 поддерживают программирование многоадресной рассылки. Кроме того, многоадресная рассылка позволяет приложениям специально блокировать (или разблокировать) отправители в группе, а также дополнительно защищать приложения от мошеннических вещательных систем. Эта возможность доступна для IPv4 (требуется IGMPv3), а также для IPv6 (требуется MLDv2).

Существует два основных сценария для программистов приложений, использующих многоадресную рассылку: перенос из широковещательных (или многоадресных) приложений в IPv6 и создание новых многоадресных приложений IPv6.

Для переноса существующих приложений существует два варианта перехода на многоадресную рассылку IPv6: с помощью параметров сокета и с помощью IOCTL.

-   Использование параметров сокета — это подход на основе изменений, который позволяет разработчикам изменять свойства сокета по мере необходимости (например, блокировать или разблокирование отправителя, Добавление нового источника и т. д.). Этот подход более интуитивен и является рекомендуемым подходом. дополнительные сведения о подходе на основе изменений к многоадресному программированию см. в разделе [MLD и IGMP с использованием сокетов Windows](igmp-and-windows-sockets.md).
-   Использование IOCTL — это подход на основе финального состояния, поскольку он позволяет разработчикам предоставлять полностью настроенное состояние сокета, включая списки включения и исключения, с одним вызовом. Дополнительные сведения о подходе на основе финального состояния см. в разделе [многоадресное программирование на основе финального состояния](final-state-based-multicast-programming.md).

Для тех, кто создает новые многоадресные приложения IPv6, рекомендуется использовать параметры сокета вместо использования IOCTL.

Существует еще один подход к созданию многоадресных приложений с использованием протокола IPv6, что влечет за собой использование функции [**всажоинлеаф**](/windows/desktop/api/Winsock2/nf-winsock2-wsajoinleaf) . Хотя использование функции **всажоинлеаф** не рекомендуется, существуют ситуации, которые могут надиктовать ее использование. например, недостаток использования параметров сокета на Windows Server 2003 и более ранних версий заключается в том, что они относятся к версии протокола IP. в этих старых версиях Windows разные параметры сокетов должны быть для IPv6 и IPv4. в Windows Vista и более поздних версиях поддерживаются новые варианты сокетов, которые можно использовать как с IPv4, так и с IPv6. функция **всажоинлеаф** , напротив, является версией протокола IP и протоколом, а значит, может быть полезным подходом к созданию приложения, которое должно работать с несколькими версиями IP-адресов на Windows Server 2003 и более ранних версиях. Использование функции **всажоинлеаф** может быть более подходящим в некоторых ситуациях, когда требуется протокол и независимый от IP-версии.

 

 



