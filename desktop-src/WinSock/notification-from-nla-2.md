---
description: NLA может предоставлять своим клиентам уведомления об изменениях сетевого расположения. Механизм, используемый для запроса уведомлений о событиях изменения, представляет собой сочетание функций Всалукупсервицебегин, Всанспиоктл и Всалукупсервиценекст.
ms.assetid: fed5a90d-0bc5-46e7-b3d3-edc4b303d305
title: Уведомление от NLA
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5c8e7309fe6845d822702ffd81448999e2472ebdd37a6949812f622110ee9d42
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118822669"
---
# <a name="notification-from-nla"></a>Уведомление от NLA

NLA может предоставлять своим клиентам уведомления об изменениях сетевого расположения. Механизм, используемый для запроса уведомлений о событиях изменения, представляет собой сочетание функций [**всалукупсервицебегин**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina), [**всанспиоктл**](/windows/desktop/api/Winsock2/nf-winsock2-wsanspioctl)и [**всалукупсервиценекст**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta) .

Чтобы получать уведомления об изменениях от NLA, клиент должен сначала вызвать [**всалукупсервицебегин**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina) , чтобы получить допустимый маркер поиска SP в NLA. Затем клиент может вызвать [**всалукупсервиценекст**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta) или [**всанспиоктл**](/windows/desktop/api/Winsock2/nf-winsock2-wsanspioctl) в любом порядке. чтобы зарегистрироваться для получения уведомлений, вызовите функцию **всанспиоктл** с \_ \_ контрольным кодом SIO NSP notify, \_ заданным в параметре *двконтролкоде* .

Функция [**всалукупсервиценекст**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta) возвращает WSA \_ E в \_ \_ качестве разделителя множеств. Если клиент зарегистрировался для уведомления с помощью функции [**всанспиоктл**](/windows/desktop/api/Winsock2/nf-winsock2-wsanspioctl) , а **ВСАЛУКУПСЕРВИЦЕНЕКСТ** возвращает значение \_ WSA \_ E \_ , вызов **всалукупсервиценекст** снова показывает, произошло ли изменение:

-   Если изменения не происходили с момента предыдущего WSA \_ \_ , то \_ WSA e больше \_ не \_ \_ возвращается.
-   Если произошло изменение или произошло изменение и выполняется вызов опроса, вызов функции [**всалукупсервиценекст**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicenexta) возвращает сети в виде структур [**всакуерисет**](/windows/desktop/api/Winsock2/ns-winsock2-wsaquerysetw) с одним из следующих флагов, заданных в элементе **дваутпутфлагс** :

    <dl> Результат \_ \_ добавлен  
    Результат \_ \_ изменен  
    Результат \_ \_ удален  
    </dl>

Уведомление об изменении предоставляется для всех полей, измененных с момента получения маркера поиска NLA с помощью вызова функции [**всалукупсервицебегин**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupservicebegina) , или с момента последнего перечисления, которое привело к \_ \_ \_ ошибке WSA E. Когда предоставляются все измененные сведения о сетевом расположении, WSA \_ E больше \_ не \_ возвращается. Клиенты могут в любой момент повторно выдавать вызов функции [**всанспиоктл**](/windows/desktop/api/Winsock2/nf-winsock2-wsanspioctl) для одного и того же обработчика запроса, по одному, с \_ \_ \_ установленным флагом изменения уведомления SIO NSP. Эта возможность позволяет клиенту перезапускать обработчик запросов на постоянной основе, тем самым освобождая разработчика клиенту от необходимости поддерживать информацию о состоянии изменений самостоятельно. Когда клиенту больше не требуются уведомления об изменениях, он должен закрыть обработчик запроса с помощью функции [**всалукупсервицеенд**](/windows/desktop/api/Winsock2/nf-winsock2-wsalookupserviceend) .

 

 



