---
description: При установке нового класса службы необходимо подготовить и предоставить структуру ВСАСЕРВИЦЕКЛАССИНФО. Эта структура также состоит из подструктур, содержащих ряд параметров, которые применяются к конкретным пространствам имен.
ms.assetid: fb225e0c-a0c7-44e1-80fb-7b924b371afa
title: Структуры данных класса службы в SPI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 53eb2fd61c5ec6295b65128048bc9fe477ae63f78f89bfba4be73798002ead88
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118993573"
---
# <a name="service-class-data-structures-in-the-spi"></a>Структуры данных класса службы в SPI

При установке нового класса службы необходимо подготовить и предоставить структуру [**всасервицеклассинфо**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) . Эта структура также состоит из подструктур, содержащих ряд параметров, которые применяются к конкретным пространствам имен.

![Схема, показывающая структуру ВСАСЕРВИЦЕКЛАССИНФО, подструктуры и параметры, которые применяются к конкретным пространствам имен.](images/ovrvw3-3.png)

Для каждого класса службы существует одна структура [**всасервицеклассинфо**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) . В структуре **всасервицеклассинфо** уникальный идентификатор класса службы содержится в **лпсервицеклассид**, а на связанную отображаемую строку ссылается **лпсервицекласснаме**.

Элемент **лпклассинфос** в структуре [**всасервицеклассинфо**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) ссылается на массив структур [**всансклассинфо**](/windows/desktop/api/Winsock2/ns-winsock2-wsansclassinfow) , каждый из которых предоставляет именованный и типизированный параметр, который применяется к указанному пространству имен. Примеры значений для элемента **лпсзнаме** : SAPID, TCPPORT, удппорт и т. д. Эти строки обычно относятся к пространству имен, определенному в **двнамеспаце**. Типичными значениями для **дввалуетипе** могут быть REG \_ DWORD, REG \_ SZ и т. д. Элемент **дввалуесизе** указывает длину элемента данных, на который указывает **лпвалуе**.

Вся коллекция данных, представленная в структуре [**всасервицеклассинфо**](/windows/desktop/api/Winsock2/ns-winsock2-wsaserviceclassinfow) , предоставляется каждому поставщику пространства имен через [**нспинсталлсервицекласс**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnspinstallserviceclass). Затем каждый отдельный поставщик пространства имен сифтс через список структур [**всансклассинфо**](/windows/desktop/api/Winsock2/ns-winsock2-wsansclassinfow) и содействует применимые к нему сведения. Эта архитектура также позволяет представить будущее существование специального поставщика пространства имен, сохраняющего все сведения о схеме класса службы для всех пространств имен. 32.dll Ws2 \_ будет запрашивать у этого поставщика данные **всасервицеклассинфо** , необходимые для предоставления поставщикам пространства имен, когда [**нсплукупсервицебегин**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnsplookupservicebegin) вызывается для инициации запроса и когда [**нспсетсервице**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnspsetservice) вызывается для регистрации службы. Поставщик пространства имен не должен полагаться на эту возможность в течение времени, а вместо этого должен иметь специфические для поставщика средства для получения необходимых сведений о схеме класса службы. В отсутствие поставщика, хранящего все схемы класса службы для всех пространств имен, \_32.dll Ws2 будет использовать [**нспжетсервицеклассинфо**](/windows/desktop/api/Ws2spi/nc-ws2spi-lpnspgetserviceclassinfo) для получения такой информации от каждого отдельного поставщика пространства имен.

 

 



