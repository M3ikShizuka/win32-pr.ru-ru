---
title: Адреса Teredo
ms.assetid: e2e185c2-e53d-471d-aedb-54d75f9db0bb
description: 'Дополнительные сведения: адреса Teredo'
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bc08a53da2f710423d948e9479df2aeb08f20178
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104349645"
---
# <a name="teredo-addresses"></a>Адреса Teredo

Адрес Teredo состоит из следующих компонентов:

-   **Префикс Teredo**

    Первые 32 бит предназначены для префикса Teredo, который одинаков для всех адресов Teredo. В Windows XP и Windows Server 2003 изначально использовался префикс Teredo 3FFE: 831F::/32. Префикс, определенный для Teredo в RFC 4380, — это 2001::/32, а — префикс, используемый Teredo в Windows Vista и Windows Server 2008. Компьютеры под управлением Windows XP и Windows Server 2003 будут использовать префикс 2001::/32 Teredo при обновлении с бюллетенем по безопасности Microsoft MS06-064.

-   **IPv4-адрес сервера Teredo**

    Следующие 32 бит содержат общедоступный IPv4-адрес сервера Teredo, который помог настроить этот адрес Teredo. Дополнительные сведения см. в разделе «Начальная настройка для клиентов Teredo» этой статьи.

-   **Флаги**

    Следующие 16 битов для зарезервированы для флагов Teredo. Для клиентов Teredo на основе Windows XP единственным определенным флагом является бит высокого порядка, известный как флаг конуса. Флаг конуса устанавливается, когда клиент Teredo находится за конусным NAT. Определение того, является ли NAT, подключенный к Интернету, проконусным NAT происходит во время начальной настройки клиента Teredo. Дополнительные сведения см. в разделе «Начальная настройка для клиентов Teredo» этой статьи.

    Для клиентов Teredo на основе Windows Vista и Windows Server 2008 неиспользуемые биты в поле Flags обеспечивают уровень защиты от просмотра адресов пользователями-злоумышленниками. 16 бит в поле Flags для клиентов Teredo на основе Windows Vista и Windows Server 2008 состоит из следующих компонентов: КРААААУГ АААААААА. Бит C предназначен для флага конуса. Бит R зарезервирован для будущего использования. Бит U предназначен для флага универсального или локального (значение 0). Бит G — это флаг отдельных или групп (значение 0). Биты задаются в виде 12-битного случайного числа. Используя случайное число для битов, пользователь-злоумышленник, который определил оставшуюся часть адреса Teredo, записывая начальный обмен конфигурацией пакетов между клиентом Teredo и сервером Teredo, должен попробовать до 4 096 (212) различных адресов, чтобы определить адрес клиента Teredo во время сканирования адреса.

-   **Незамаскированный внешний порт**

    Следующие 16 бит хранят скрытую версию внешнего порта UDP, соответствующую всем трафикам Teredo для этого клиента Teredo. Когда клиент Teredo отправляет первоначальный пакет серверу Teredo, исходный UDP-порт пакета сопоставляется NAT с другим внешним UDP-портом. Клиент Teredo поддерживает это сопоставление портов, чтобы оно оставалось в таблице преобразования NAT. Таким образом, весь трафик Teredo для узла использует один и тот же внешний, сопоставленный UDP-порт. Внешний UDP-порт определяется сервером Teredo с исходного UDP-порта входящего первого пакета, отправленного клиентом Teredo, и отправляется обратно клиенту Teredo.

    Внешний порт скрыт, Ксоринг внешний порт с 0xFFFF. Например, скрытая версия внешнего порта 5000 в шестнадцатеричном формате — EC77 (5000 = 0x1388, 0x1388 XOR 0xFFFF = 0xEC77). Маскировка внешнего порта не домешает NAT перевести внешний порт в полезные данные пересылаемых пакетов.

-   **Непонятный внешний адрес**

    Последние 32 бит хранят скрытую версию внешнего IPv4-адреса, соответствующего всем трафикам Teredo для этого клиента Teredo. Как и внешний порт, когда клиент Teredo отправляет первоначальный пакет серверу Teredo, исходный IP-адрес пакета сопоставляется NAT с другим внешним (общедоступным) адресом. Клиент Teredo поддерживает это сопоставление адресов, чтобы оно оставалось в таблице преобразования NAT. Таким образом, весь трафик Teredo для узла использует один внешний, сопоставленный общедоступный IPv4-адрес. Внешний IPv4-адрес определяется сервером Teredo с исходного IPv4-адреса входящего исходного пакета, отправленного клиентом Teredo, и отправляется обратно клиенту Teredo.

    Внешний адрес скрыт, Ксоринг внешний адрес с 0xFFFFFFFF. Например, скрытая версия общедоступного IPv4-адреса 131.107.0.1 в шестнадцатеричном формате — 7C94: ФФФЕ (131.107.0.1 = 0x836B0001, 0x836B0001 XOR 0xFFFFFFFF = 0x7C94FFFE). Маскировка внешнего адреса не домешает NAT перевести внешний адрес в полезную нагрузку пересылаемых пакетов.

 

 




