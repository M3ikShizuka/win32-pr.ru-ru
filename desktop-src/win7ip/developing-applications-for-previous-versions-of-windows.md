---
title: Разработка приложений для предыдущих версий Windows
description: Объясняет, что нужно сделать для разработки приложений, работающих в предыдущих версиях Windows, и воспользоваться преимуществами API, которые поддерживаются в обновлении платформы для Windows Vista и обновления платформы для Windows Server 2008.
ms.assetid: 9c46f894-e5cd-46a1-81c8-f63b09504735
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 299d4c61b0e2b931c3833934c843bf964fc3fa7c
ms.sourcegitcommit: 7b8f6151ebe247536304866459b2973276271d4d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/06/2021
ms.locfileid: "104424158"
---
# <a name="developing-applications-for-previous-versions-of-windows"></a>Разработка приложений для предыдущих версий Windows

Объясняет, что нужно сделать для разработки приложений, работающих в предыдущих версиях Windows, и воспользоваться преимуществами API, которые поддерживаются в обновлении платформы для Windows Vista и обновления платформы для Windows Server 2008.

## <a name="required-downloads"></a>Необходимые загрузки

Загрузка и установка пакетов, описанных в следующих разделах, необходима для разработки приложений, использующих API, которые представлены в пакете средств разработки программного обеспечения Microsoft Windows (SDK) для Windows 7.

### <a name="microsoft-windows-sdk"></a>Microsoft Windows SDK

Windows SDK для Windows 7 требуется для создания приложений, использующих API, поддерживаемых в обновлении платформы для Windows Vista и обновления платформы для Windows Server 2008.

Дополнительные ресурсы и сведения, такие как файлы для загрузки, сообщения на форуме и блог группы Windows SDK, см. в [центре разработчиков Windows SDK](https://msdn.microsoft.com/bb980924.aspx) ( https://msdn.microsoft.com/bb980924.aspx) .

### <a name="net-framework"></a>.NET Framework

Пакет обновления 1 (SP1) для платформа .NET Framework 3,5 необходим для создания приложений, использующих API-интерфейсы, поддерживаемые обновлением платформы для Windows Vista и обновления платформы для Windows Server 2008.

Дополнительные ресурсы и сведения см. в [центре платформа .NET Framework Developer Center](https://msdn.microsoft.com/netframework/default.aspx) ( https://msdn.microsoft.com/netframework/default.aspx) .

### <a name="directx-sdk-required-when-using-direct3d"></a>При использовании Direct3D требуется пакет SDK для DirectX

При создании приложений, использующих Direct3D, [пакет SDK для DirectX](/previous-versions/windows/apps/hh452744(v=win.10)) ( https://msdn.microsoft.com/directx/aa937788.aspx) необходим для создания приложений, использующих API, которые поддерживаются обновлением платформы для Windows Vista и обновлением платформы для Windows Server 2008.

### <a name="update-your-development-computer"></a>Обновление компьютера разработчика

Убедитесь, что на компьютере разработчика установлены все последние обновления от Центр обновления Windows.

При разработке приложений в предыдущей версии Windows необходимо получить обновление платформы для Windows Vista или обновление платформы для Windows Server 2008 с Центр обновления Windows. Установка любого из этих обновлений позволит вам воспользоваться преимуществами нового API, предоставляемого Windows SDK для Windows 7.

Дополнительные сведения о получении обновлений из Центр обновления Windows см. в статье базы [знаний об обновлении платформы для Windows Vista (KB 971644)](https://support.microsoft.com/kb/971644) ( https://support.microsoft.com/kb/971644) .

## <a name="development-environment"></a>Среда разработки

### <a name="set-the-build-target-to-windows-7"></a>Установка целевого объекта сборки в Windows 7

Все приложения, использующие библиотеки в обновлении платформы для Windows Vista, должны быть основаны на целевой платформе Windows 7.

Установка параметра WINVER в значение целевой платформы Windows 7 позволяет разрабатывать приложения, использующие API, поддерживаемые с обновлением платформы для Windows Vista или обновлением платформы для Windows Server 2008 на компьютере разработки под управлением Windows Vista.

Целевую платформу можно задать для Windows 7 либо в исходном коде, либо с помощью параметра/D в компиляторе Visual Studio.

В следующем примере показано, как задать WINVER в исходном коде.


```C++
#define WINVER 0x0601
```



В следующем примере показано, как задать WINVER с помощью параметра компилятора/D.

``` syntax
/DWINVER=0x0601
```

## <a name="application-deployment"></a>Развертывание приложения

Если вы создаете приложение с помощью заголовков и библиотек, предоставляемых Windows SDK для Windows 7, поддерживаемые API-интерфейсы будут выполняться в любой версии Windows с обновлением платформы для Windows Vista или на установленном обновлении платформы для Windows Server 2008.

> [!Note]  
> Поведение, производительность или требования для некоторых интерфейсов API, которые поддерживаются при обновлении платформы для Windows Vista или обновления платформы для Windows Server 2008, могут различаться в разных версиях Windows. Дополнительные сведения о конкретном API, поддерживаемом обновлениями, см. в разделе [об обновлении платформы для Windows Vista](platform-update-for-windows-vista-overview.md).

 

### <a name="no-redistributable-components"></a>Нет распространяемых компонентов

Приложению не требуется устанавливать распространяемые компоненты, такие как библиотеки DLL или другие файлы времени выполнения.

### <a name="requires-updated-end-user-computer"></a>Требуется обновленный End-User компьютер

Поскольку обновление платформы для Windows Vista и обновление платформы для Windows Server 2008 размещаются на Центр обновления Windows, конечные пользователи с включенным автоматическим обновлением, скорее всего, уже имеют эти обновления, а также необходимые пакеты обновления.

Если на компьютере конечного пользователя отсутствует обновление платформы для Windows Vista или обновление платформы для Windows Server 2008 и для приложения требуются API-интерфейсы, поддерживаемые с этими обновлениями, приложение может не быть запущено на компьютере конечного пользователя или во время выполнения могут возникать ошибки.

Во избежание проблем, которые могут быть вызваны неактуальностью компьютера пользователя, необходимо убедиться, что на компьютере пользователя имеется обновление платформы для Windows Vista или обновление платформы для Windows Server 2008 во время установки приложения. Вы можете использовать [API центр обновления Windows агента](/windows/desktop/Wua_Sdk/portal-client) , чтобы проверить компьютер конечного пользователя на наличие установленных обновлений. Вы также можете использовать API агента Центр обновления Windows, чтобы скачать и установить необходимые обновления во время установки приложения, если пользователь еще не установил обновления.

Пример установщика, демонстрирующий использование [API агента Центр обновления Windows](/windows/desktop/Wua_Sdk/portal-client), см. в разделе [развертывание Direct3D 11 для разработчиков игр](../direct3darticles/direct3d11-deployment.md) в [пакете SDK DirectX](/previous-versions/windows/apps/hh452744(v=win.10)) ( https://msdn.microsoft.com/directx/aa937788.aspx) .

Несмотря на то, что пример установщика D3D11InstallHelper, обсуждаемый в [развертывании Direct3D 11 для разработчиков игр](../direct3darticles/direct3d11-deployment.md), был написан для приложений, использующих Direct3D 11, он предоставляет хороший пример взаимодействия с [API агента Центр обновления Windows](/windows/desktop/Wua_Sdk/portal-client) для инициирования и контроля загрузки и установки обновлений, размещенных в центр обновления Windows. Для компиляции этого примера может потребоваться Windows SDK для Windows 7. Дополнительные сведения о примере D3D11InstallHelper, включая известные проблемы, см. в [пакете SDK DirectX](/previous-versions/windows/apps/hh452744(v=win.10)) ( https://msdn.microsoft.com/directx/aa937788.aspx) заметки о выпуске для августа 2009 г.). обновление платформы для Windows Vista

## <a name="related-topics"></a>См. также

<dl> <dt>

[Обновление платформы для Windows Vista](platform-update-for-windows-vista-portal.md)
</dt> <dt>

**Разделы общих сведений**
</dt> <dt>

[Сведения об обновлении платформы для Windows Vista](platform-update-for-windows-vista-overview.md)
</dt> <dt>

[Статья базы знаний об обновлении платформы для Windows Vista (KB 971644)](https://support.microsoft.com/kb/971644)
</dt> </dl>

 

 