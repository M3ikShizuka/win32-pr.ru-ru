---
title: Вопросы безопасности пользовательский интерфейс Windows
description: В этом разделе содержатся сведения о вопросах безопасности в пользовательском интерфейсе Windows.
ms.assetid: D560E59A-D6C8-40a9-AABB-DE5A47C94E6E
keywords:
- Пользовательский интерфейс Windows, безопасность
- безопасность для пользовательского интерфейса Windows
- Безопасность строк
- ввод пользователя, проверка
- Проверка входных данных пользователя
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 71b714de3ab12cb10d6e5d9a2e251c34eeeff7a5
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104070428"
---
# <a name="security-considerations-windows-user-interface"></a>Вопросы безопасности: Пользовательский интерфейс Windows

В этом разделе содержатся сведения о вопросах безопасности в пользовательском интерфейсе Windows. В этом разделе не приводятся все, что необходимо знать о проблемах безопасности. Вместо этого используйте его в качестве отправной точки и ссылки для этой области технологий.

Благодаря увеличению взаимодействия компьютеров разработчики теперь должны быть связаны с безопасностью приложений. Однако безопасность также повышает безопасность и надежность приложений. Поэтому это еще один способ, который разработчик может обеспечить хорошее взаимодействие с пользователем. В следующих разделах рассматриваются некоторые потенциальные проблемы безопасности при использовании пользовательского интерфейса Windows.

-   [Рекомендации по строкам](#string-considerations)
-   [Ввод данных пользователем](#user-input)
-   [Оповещения системы безопасности](#security-alerts)
-   [См. также](#related-topics)

## <a name="string-considerations"></a>Рекомендации по строкам

Многие функции, сообщения и макросы используют строки в своих параметрах. Однако часто строки не проверяются на завершение значений NULL или для длины. Связанная проблема заключается в неправильном вычислении длины строки или буфера. В любом случае это может привести к переполнению буфера или усечению данных, что может негативно повлиять на работу приложения. Дополнительные сведения о переполнении буфера и других вопросах безопасности см. в статье *написание безопасного кода* с помощью Майкла Ховарда и Дэвида Леблана, Microsoft Press, 2002.

Для безопасного управления строками необходимо выполнить следующие действия.

-   Проверьте строки на наличие завершения null или для соответствующей длины.
-   Следите за тем, чтобы определить длину строки или буфера, особенно если она содержит значения **TCHAR** .
-   Если вы создаете строку или используете строку, которая использовалась ранее, инициализируйте ее нулем или вставьте нулевой признак конца, если это уместно.

Кроме того, при работе со строками рассмотрите возможность использования функций [стрсафе](/windows/desktop/menurc/strsafe-ovw) . Эти функции предназначены для безопасного управления строками.

## <a name="user-input"></a>Ввод данных пользователем

Пользовательский интерфейс Windows имеет дело с получением информации от пользователей и реагированию на них. Однако пользователи, которые вводят неверные данные, могут нарушить работу приложения, независимо от того, планируется ли это сделать. Таким же условием является то, что все входные данные должны быть проверены.

Основной задачей являются строковые данные, которые рассматриваются в разделе [рекомендации по строкам](#string-considerations). Однако перед использованием приложения все типы входных данных должны быть проверены. Еще одна проблема заключается в том, что данные проверяются в одной точке, но изменяются до их использования, например при получении сообщений, которые выдают длину текста. Поэтому, если есть вероятность, что данные могут измениться, следует проверить данные непосредственно перед их использованием.

## <a name="security-alerts"></a>Оповещения системы безопасности

В следующей таблице перечислены функции, которые при неправильном использовании могут поставить под угрозу безопасность приложений.



| Функция                                                                                                                                                   | Меры по снижению риска                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**жетатомнаме**](/windows/desktop/api/winbase/nf-winbase-getatomnamea)                                                                                                               | Будьте внимательны при указании размера буфера.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| [**глобалжетатомнаме**](/windows/desktop/api/winbase/nf-winbase-globalgetatomnamea)                                                                                                   | Глобальные строковые атомы доступны для любого приложения. Однако если другое приложение не работает, оно может неспособно обменять счетчики ссылок и удалять их. Вместо этого следует использовать глобальные целочисленные атомы.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| [**имперсонатеддеклиентвиндов**](/windows/desktop/api/dde/nf-dde-impersonateddeclientwindow)                                                                                 | В случае сбоя функции последующие клиентские запросы выполняются в контексте безопасности вызывающего процесса. Это может быть проблемой, если вызывающий процесс выполняется как учетная запись с высоким уровнем привилегий. Таким образом, если вызов завершается с ошибкой или вызывает ошибку, выполнение запроса клиента не продолжается.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**ддеимперсонатеклиент**](/windows/desktop/api/ddeml/nf-ddeml-ddeimpersonateclient)                                                                                             | В случае сбоя функции последующие клиентские запросы выполняются в контексте безопасности вызывающего процесса. Это может быть проблемой, если вызывающий процесс выполняется как учетная запись с высоким уровнем привилегий. Таким образом, если вызов завершается с ошибкой или вызывает ошибку, выполнение запроса клиента не продолжается.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**жетклипбоардформатнаме**](/windows/desktop/api/winuser/nf-winuser-getclipboardformatnamea)                                                                                         | Неправильное вычисление правильного размера буфера *лпсзформатнаме* , особенно если приложение используется в версиях ANSI и Юникод, может привести к переполнению буфера. Кроме того, обратите внимание, что строка усекается, если она длиннее, чем параметр *кчмакскаунт* , что может привести к потерям информации.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| [**жетменустринг**](/windows/desktop/api/winuser/nf-winuser-getmenustringa)                                                                                                           | Параметр *лпстринг* является буфером **TCHAR** , а *нмакскаунт* — длиной строки меню в **TCHAR** s. Неправильное изменение размера этих параметров может привести к длине строки меню в символах. Неправильное изменение размера этих параметров может привести к усечению строки, что приведет к потере данных.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| [**Жетстрингтипеа**](/windows/desktop/api/winnls/nf-winnls-getstringtypea), [**жетстрингтипикс**](/windows/win32/api/stringapiset/nf-stringapiset-getstringtypeexw), [**жетстрингтипев**](/windows/desktop/api/stringapiset/nf-stringapiset-getstringtypew) | Чтобы избежать переполнения буфера, правильно задайте размер буфера *лпчартипе* .                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya)                                                                                                                       | Неправильное использование **LoadLibrary** может нарушить безопасность приложения, загрузив НЕПРАВИЛЬНУЮ библиотеку DLL.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| [**лоадстринг**](/windows/desktop/api/winuser/nf-winuser-loadstringa)                                                                                                                 | Неверное использование включает в себя указание неправильного размера в параметре *нбуффермакс* . Например, sizeof (*лпбуффер*) предоставляет размер буфера в байтах, что может привести к переполнению буфера для версии Юникода функции. Ситуации переполнения буфера являются причиной многих проблем безопасности в приложениях. В этом случае использование `sizeof(lpBuffer)/sizeof(TCHAR)` предоставляет правильный размер буфера.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**лстркат**](/windows/desktop/api/winbase/nf-winbase-lstrcata)                                                                                                                       | Эта функция использует структурированную обработку исключений (SEH) для перехвата нарушений доступа и других ошибок. Когда эта функция перехватывает ошибки SEH, она возвращает **значение NULL** без значения NULL, завершая строку и без значения NULL, без значений NULL, завершая строку и не уведомляя вызывающую ошибку. Вызывающий объект не является надежным, чтобы предположить, что недостаток места является условием ошибки. Первый аргумент *lpString1* должен быть достаточно большим для хранения *lpString2* и закрывающего " \\ 0", в противном случае может произойти переполнение буфера. Переполнение буфера может привести к атаке типа "отказ в обслуживании" для приложения, если возникает нарушение прав доступа. В худшем случае переполнение буфера может позволить злоумышленнику внедрить исполняемый код в процесс, особенно если *lpString1* является буфером на основе стека. Рассмотрите возможность использования одного из следующих вариантов. [**Стрингкбкат**](/windows/desktop/api/strsafe/nf-strsafe-stringcbcata) или [**стрингкчкат**](/windows/desktop/api/strsafe/nf-strsafe-stringcchcata).                                                                                                                                                                                       |
| [**лстркпи**](/windows/desktop/api/winbase/nf-winbase-lstrcpya)                                                                                                                       | Эта функция использует структурированную обработку исключений (SEH) для перехвата нарушений доступа и других ошибок. Когда эта функция перехватывает ошибки SEH, она возвращает **значение NULL** без значения NULL, завершая строку и без значения NULL, без значений NULL, завершая строку и не уведомляя вызывающую ошибку. Вызывающий объект не является надежным, чтобы предположить, что недостаток места является условием ошибки. Первый аргумент *lpString1* должен быть достаточно большим для хранения *lpString2* и закрывающего " \\ 0", в противном случае может произойти переполнение буфера. Переполнение буфера может привести к атаке типа "отказ в обслуживании" для приложения, если возникает нарушение прав доступа. В худшем случае переполнение буфера может позволить злоумышленнику внедрить исполняемый код в процесс, особенно если *lpString1* является буфером на основе стека. Вместо этого рекомендуется использовать [**стрингкчкопи**](/windows/desktop/api/strsafe/nf-strsafe-stringcchcopya) .                                                                                                                                                                                                                                                               |
| [**лстркпин**](/windows/desktop/api/winbase/nf-winbase-lstrcpyna)                                                                                                                     | Эта функция использует структурированную обработку исключений (SEH) для перехвата нарушений доступа и других ошибок. Когда эта функция перехватывает ошибки SEH, она возвращает **значение NULL** без значения NULL, завершая строку и без значения NULL, без значений NULL, завершая строку и не уведомляя вызывающую ошибку. Вызывающий объект не является надежным, чтобы предположить, что недостаток места является условием ошибки. Если *lpString1* недостаточно велик для хранения скопированной строки, может произойти переполнение буфера. Кроме того, при копировании всей строки Обратите внимание, что [sizeof](https://msdn.microsoft.com/library/0w557fh7(VS.71).aspx) возвращает число байтов, а не **WCHAR**, что **sizeof** возвращает число байтов, а не символов, что является неправильным для версии Юникода этой функции. Переполнение буфера может привести к атаке типа "отказ в обслуживании" для приложения, если возникает нарушение прав доступа. В худшем случае переполнение буфера может позволить злоумышленнику внедрить исполняемый код в процесс, особенно если *lpString1* является буфером на основе стека. Вместо этого рекомендуется использовать [**стрингкчкопи**](/windows/desktop/api/strsafe/nf-strsafe-stringcchcopya) . |
| [**lstrlen**](/windows/desktop/api/winbase/nf-winbase-lstrlena)                                                                                                                       | [**lstrlen**](/windows/desktop/api/winbase/nf-winbase-lstrlena) предполагает, что *лпстринг* является строкой, завершающейся нулем. Если это не так, это может привести к переполнению буфера или атаке типа "отказ в обслуживании" для вашего приложения. Рассмотрите возможность использования одного из следующих вариантов. [**Стрингкбленгс**](/windows/desktop/api/strsafe/nf-strsafe-stringcblengtha) или [**стрингкчленгс**](/windows/desktop/api/strsafe/nf-strsafe-stringcchlengtha).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| [**вспринтф**](/windows/desktop/api/winuser/nf-winuser-wsprintfa)                                                                                                                     | Строка, возвращаемая в *лпаут* , не гарантированно завершается нулем. Кроме того, Избегайте формата "% s", что может привести к переполнению буфера. Если возникает нарушение прав доступа, это приводит к отказу в обслуживании приложения. В худшем случае злоумышленник может внедрить исполняемый код. Рассмотрите возможность использования одного из следующих вариантов. [**Стрингкбпринтф**](/windows/desktop/api/strsafe/nf-strsafe-stringcbprintfa), [**стрингкбпринтфекс**](/windows/desktop/api/strsafe/nf-strsafe-stringcbprintfexa), [**стрингкбвпринтф**](/windows/desktop/api/strsafe/nf-strsafe-stringcbvprintfa), [**стрингкбвпринтфекс**](/windows/desktop/api/strsafe/nf-strsafe-stringcbvprintfexa), [**стрингкчпринтф**](/windows/desktop/api/strsafe/nf-strsafe-stringcchprintfa), [**StringCchPrintfEx**](/windows/desktop/api/strsafe/nf-strsafe-stringcchprintfexa), [**StringCchVPrintf**](/windows/desktop/api/strsafe/nf-strsafe-stringcchvprintfa)или [**StringCchVPrintfEx**](/windows/desktop/api/strsafe/nf-strsafe-stringcchvprintfexa).                                                                                                                                                                                                                                                                                                                                         |
| [**ввспринтф**](/windows/desktop/api/winuser/nf-winuser-wvsprintfa)                                                                                                                   | Строка, возвращаемая в *лпаутпут* , не гарантированно завершается нулем. Кроме того, старайтесь не использовать формат% s, что может привести к переполнению буфера. Это может привести к отказу в обслуживании, если это приводит к нарушению прав доступа, или злоумышленник может внедрить исполняемый код. Рассмотрите возможность использования одного из следующих вариантов. [**Стрингкбпринтф**](/windows/desktop/api/strsafe/nf-strsafe-stringcbprintfa), [**стрингкбпринтфекс**](/windows/desktop/api/strsafe/nf-strsafe-stringcbprintfexa), [**стрингкбвпринтф**](/windows/desktop/api/strsafe/nf-strsafe-stringcbvprintfa), [**стрингкбвпринтфекс**](/windows/desktop/api/strsafe/nf-strsafe-stringcbvprintfexa), [**стрингкчпринтф**](/windows/desktop/api/strsafe/nf-strsafe-stringcchprintfa), [**StringCchPrintfEx**](/windows/desktop/api/strsafe/nf-strsafe-stringcchprintfexa), [**StringCchVPrintf**](/windows/desktop/api/strsafe/nf-strsafe-stringcchvprintfa)или [**StringCchVPrintfEx**](/windows/desktop/api/strsafe/nf-strsafe-stringcchvprintfexa).                                                                                                                                                                                                                                                                                                                                                      |



 

## <a name="related-topics"></a>См. также

<dl> <dt>

[Microsoft Security](https://www.microsoft.com/security/)
</dt> <dt>

[Безопасность и идентификация](/windows/desktop/security)
</dt> <dt>

[Индекс руководства по безопасности](/previous-versions/msp-n-p/ff650055(v=pandp.10))
</dt> <dt>

[Материалы по безопасности TechNet](https://www.microsoft.com/technet/security/default.mspx)
</dt> <dt>

[Рекомендации по использованию API безопасности](/windows/desktop/SecBP/best-practices-for-the-security-apis)
</dt> </dl>

 

 