---
description: Функция экспорта Рекогнизефраме указывает, распознается ли фрагмент данных как протокол, обнаруженный анализатором. Функция экспорта Рекогнизефраме должна быть реализована для каждого средства синтаксического анализа, поддерживаемого библиотекой DLL средства синтаксического анализа.
ms.assetid: 3f835f58-b011-4329-b9b2-ff865a1f0ae5
title: Функция обратного вызова Рекогнизефраме (Netmon. h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- RecognizeFrame
api_type:
- UserDefined
api_location:
- Netmon.h
ms.openlocfilehash: b9f8fcbfccdb306038b7b654e947ff1a11654267012c7527799d8633ed8a9410
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119889704"
---
# <a name="recognizeframe-callback-function"></a>Функция обратного вызова Рекогнизефраме

Функция экспорта **рекогнизефраме** указывает, распознается ли фрагмент данных как протокол, обнаруженный анализатором. Функция экспорта **рекогнизефраме** должна быть реализована для каждого средства синтаксического анализа, ПОДДЕРЖИВАЕМого библиотекой DLL средства синтаксического анализа.

## <a name="syntax"></a>Синтаксис


```C++
LPBYTE RecognizeFrame(
  _In_    HFRAME      hFrame,
  _In_    LPBYTE      lpFrame,
  _In_    LPBYTE      lpProtocol,
  _In_    DWORD       MacType,
  _In_    DWORD       BytesLeft,
  _In_    HPROTOCOL   hPreviousProtocol,
  _In_    DWORD       nPreviousProtocolOffset,
  _Out_   LPDWORD     ProtocolStatusCode,
  _Out_   LPHPROTOCOL phNextProtocol,
  _Inout_ PDWORD_PTR  lpInstData
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*хфраме* \[ окне\]
</dt> <dd>

Обработчик для фрейма, содержащего данные.

</dd> <dt>

*лпфраме* \[ окне\]
</dt> <dd>

Указатель на первый байт кадра. Указатель предоставляет способ просмотра данных, распознаваемых другими анализаторами.

</dd> <dt>

*лппротокол* \[ окне\]
</dt> <dd>

Указатель на начало неутвержденных данных. Как правило, необработанные данные расположены в середине кадра, так как перед этим анализатором были запрошены данные предыдущим синтаксическим анализатором. Синтаксический анализатор должен сначала протестировать необработанные данные.

</dd> <dt>

*MacType* \[ окне\]
</dt> <dd>

Значение MAC первого протокола в кадре. Как правило, значение *MacType* используется, когда анализатор должен распознать первый протокол в кадре. Значение *MacType* может быть одним из следующих:



| Значение                                                                                                                                                                         | Значение                 |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------|
| <span id="MAC_TYPE_ETHERNET"></span><span id="mac_type_ethernet"></span><dl> <dt>**\_тип Mac \_ Ethernet**</dt> </dl>    | 802.3 <br/>       |
| <span id="MAC_TYPE_TOKENRING"></span><span id="mac_type_tokenring"></span><dl> <dt>**\_тип Mac \_ токенринг**</dt> </dl> | 802.5 <br/>       |
| <span id="MAC_TYPE_FDDI"></span><span id="mac_type_fddi"></span><dl> <dt>**\_тип Mac \_ FDDI**</dt> </dl>                | ANSI X3T 9,5 <br/> |



 

</dd> <dt>

*Битеслефт* \[ окне\]
</dt> <dd>

Оставшееся число байтов от расположения в кадре до конца кадра.

</dd> <dt>

*хпревиауспротокол* \[ окне\]
</dt> <dd>

Обработчик предыдущего протокола.

</dd> <dt>

*нпревиауспротоколоффсет* \[ окне\]
</dt> <dd>

Смещение предыдущего протокола в начале кадра.

</dd> <dt>

*Протоколстатускоде* \[ заполняет\]
</dt> <dd>

Индикатор состояния протокола. Библиотека DLL средства синтаксического анализа должна иметь один из следующих кодов состояния.



| Значение                                                                                                                                                                                                              | Значение                                                                                                                                                                                                                                                                                                       |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="PROTOCOL_STATUS_RECOGNIZED"></span><span id="protocol_status_recognized"></span><dl> <dt>**\_ \_ распознанное состояние протокола**</dt> </dl>              | Средство синтаксического анализа распознает данные, но не знает, какой протокол следует за ним. После задания кода возвратите указатель на оставшиеся неутвержденные данные, которые следуют за распознаваемым протоколом. Для продолжения синтаксического анализа сетевой монитор использует [*следующий набор*](f.md) протокола. <br/> |
| <span id="PROTOCOL_STATUS_NOT_RECOGNIZED"></span><span id="protocol_status_not_recognized"></span><dl> <dt>**\_состояние протокола \_ не \_ распознано**</dt> </dl> | Синтаксический анализатор не распознает данные. После задания этого кода верните указатель на начало данных с помощью указателя, который параметр *лппротокол* передает в библиотеку DLL средства синтаксического анализа. Сетевой монитор использует *следующий набор* предыдущих протоколов для продолжения синтаксического анализа. <br/>                |
| <span id="PROTOCOL_STATUS_CLAIMED"></span><span id="protocol_status_claimed"></span><dl> <dt>**\_состояние протокола \_ затребовано**</dt> </dl>                       | Средство синтаксического анализа распознает данные и заявляет оставшиеся данные. После задания кода возвратите **значение NULL** для сетевой монитор, чтобы завершить синтаксический анализ кадра. <br/>                                                                                                                                           |
| <span id="PROTOCOL_STATUS_NEXT_PROTOCOL"></span><span id="protocol_status_next_protocol"></span><dl> <dt>**протокол \_ состояния \_ следующий \_ протокол**</dt> </dl>    | Средство синтаксического анализа распознает данные и знает, какой протокол следует за ним. После задания кода задайте параметр *фнекстпротокол* и возвратите указатель на оставшиеся неутвержденные данные, которые следуют за распознаваемым протоколом. Сетевой монитор продолжит анализ кадра. <br/>                               |



 

</dd> <dt>

*фнекстпротокол* \[ заполняет\]
</dt> <dd>

Указатель на маркер следующего протокола. Этот параметр задается, когда протокол определяет протокол, который следует за протоколом. Чтобы получить маркер следующего протокола, вызовите функцию [жетпротоколфромтабле](getprotocolfromtable.md) .

</dd> <dt>

*лпинстдата* \[ в, out\]
</dt> <dd>

На входе — указатель на данные экземпляра из предыдущего протокола.

На выходе — указатель на данные экземпляра для текущего протокола. Длина данных экземпляра не может превышать значение типа DWORD \_ .

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Если функция выполнена успешно, возвращаемое значение является указателем на первый байт после распознанных данных средства синтаксического анализа. Если средство синтаксического анализа заявляет все оставшиеся данные, возвращается значение **null**.

Если функция завершается неудачно, возвращаемое значение является начальным указателем, который передается параметром *лппротокол* .

## <a name="remarks"></a>Remarks

Функция **рекогнизефраме** определяет, распознает ли синтаксический анализатор необработанные данные, начиная с указателя *лппротокол* .

-   Если протокол распознает данные, функция **рекогнизефраме** возвращает указатель на оставшиеся данные или возвращает **значение NULL** , если текущий протокол является последним в кадре.
-   Если протокол не распознает данные, функция **рекогнизефраме** возвращает указатель, передаваемый в библиотеку DLL средства синтаксического анализа в параметре *лппротокол* .

> [!Note]  
> *Рекогнизефраме* можно вызвать до вызова функции [*Register*](register-parser.md) для регистрации свойств протокола. По этой причине реализация функции *рекогнизефраме* не зависит от каких бы то ни было свойств или структур, созданных или инициализированных во время реализации функции **Register** протокола.

 

**Установленный набор и следовать за ним**

Средство синтаксического анализа может использовать переданный набор или следовать за набором, чтобы определить сетевой монитор протокола, который следует за распознанными данными.

-   Если информация доступна в распознанных данных, средство синтаксического анализа использует его для получения маркера к следующему протоколу, а затем передает этот обработчик в сетевой монитор.
-   Если информация недоступна, средство синтаксического анализа не передает маркер, а сетевой монитор использует синтаксический анализатор, чтобы определить, какой протокол следует использовать.

**Передача сведений между протоколами**

Используйте параметр *лпинстдата* для передачи сведений между протоколами. На входе можно получить сведения из предыдущего протокола. На выходе можно передать сведения в следующий протокол.

Данные экземпляра могут быть любыми данными, размер которых меньше или равен DWORD или \_ указателем на данные, например необработанные данные кадра, которые не должны выделяться или освобождаться анализатором.



| Дополнительные сведения о                                        | См.                                                                                                                       |
|-----------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------|
| Какие анализаторы и как они работают с сетевой монитор. | [Средства синтаксического анализа](parsers.md)                                                                                                    |
| Какие точки входа включены в библиотеку DLL средства синтаксического анализа.        | [Архитектура библиотеки DLL средства синтаксического анализа](parser-dll-architecture.md)                                                                    |
| Реализация **рекогнизефраме**  включает пример. | [Реализация Рекогнизефраме](implementing-recognizeframe.md)                                                            |
| Как указать переданный набор и следовать за набором.              | [Указание](specifying-a-handoff-set.md)переданного набора,[указывающего следующий набор](specifying-a-follow-set.md)<br/> |



 

## <a name="requirements"></a>Requirements (Требования)



| Требование | Значение |
|-------------------------------------|-------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows 2000 Professional \[только классические приложения\]<br/>                          |
| Минимальная версия сервера<br/> | Windows 2000 Server \[только классические приложения\]<br/>                                |
| Заголовок<br/>                   | <dl> <dt>Netmon. h</dt> </dl> |



## <a name="see-also"></a>См. также

<dl> <dt>

[жетпротоколфромтабле](getprotocolfromtable.md)
</dt> </dl>

 

 




