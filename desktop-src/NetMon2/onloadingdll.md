---
description: Загружает библиотеку DLL монитора.
ms.assetid: 6de2750f-3f12-4c0a-af8d-3ebd227fa123
title: Функция Онлоадингдлл (Netmon. h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- OnLoadingDLL
api_type:
- HeaderDef
api_location:
- Netmon.h
ms.openlocfilehash: b2d9d728065818b1e94fa436f4d1e9b62dbeb5cd
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105673361"
---
# <a name="onloadingdll-function"></a>Функция Онлоадингдлл

Функция **онлоадингдлл** ЗАГРУЖАЕТ библиотеку DLL монитора.

## <a name="syntax"></a>Синтаксис


```C++
HRESULT OnLoadingDLL(
  _Inout_ HBLOB hFilterBlob,
  _In_    DWORD *pCreateFlags,
  _Out_   char  **ppDefaultName,
  _Out_   char  **ppDescription,
  _Out_   char  **ppDefaultScript,
  _Out_   char  **ppDefaultConfig
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*хфилтерблоб* \[ в, out\]
</dt> <dd>

Большой двоичный объект, используемый МКСВК для сопоставления монитора с доступными сетевыми картами. Этот параметр всегда содержит запрос для интерфейса [ИРТК](irtc.md) , поэтому большинству мониторов не нужно добавлять записи в большой двоичный объект. Однако пользовательский монитор может добавлять дополнительные критерии фильтрации (например, тип MAC должен быть Ethernet).

</dd> <dt>

*пкреатефлагс* \[ окне\]
</dt> <dd>

Флаги, указывающие, как МКСВК управляет созданием монитора. Этот параметр должен иметь одно из следующих значений:



| Значение                                                                                                                                                                                                            | Значение                                                                                                                                                       |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="MCS_CREATE_ONE_PER_NETCARD"></span><span id="mcs_create_one_per_netcard"></span><dl> <dt>**\_Создание MCS \_ \_ по одной \_ сетевой плате**</dt> </dl>          | МКСВК гарантирует, что для каждой сетевой карты существует только один экземпляр этого монитора. Второй экземпляр может быть создан только в том случае, если первый из них уничтожается.<br/> |
| <span id="MCS_CREATE_CONFIGS_BY_DEFAULT"></span><span id="mcs_create_configs_by_default"></span><dl> <dt>**\_Создание \_ КОНФИГУРАЦИй MCS \_ по \_ умолчанию**</dt> </dl> | Если у монитора есть внутренняя конфигурация по умолчанию, МКСВК не требует от пользователя настройки монитора до создания экземпляра.<br/>  |



 

</dd> <dt>

*ппдефаултнаме* \[ заполняет\]
</dt> <dd>

Указатель на указатель на адрес имени монитора по умолчанию. При создании экземпляров монитора МКСВК использует имя по умолчанию.

Например, если имя по умолчанию — "монитор маршрутизатора", первый экземпляр монитора будет "монитор маршрутизатора 1", второй — "RouterMonitor2" и т. д. Если возвращается **значение NULL** , мксвк использует имя библиотеки DLL.

</dd> <dt>

*ппдескриптион* \[ заполняет\]
</dt> <dd>

Указатель на указатель на адрес описания монитора. Описание передается средству управления монитором, которое использует описание для указания пользователю о том, что монитор существует. Этот параметр может возвращать **значение NULL**.

</dd> <dt>

*ппдефаултскрипт* \[ заполняет\]
</dt> <dd>

Указатель на указатель на адрес скрипта HTML-формы по умолчанию, используемого для настройки монитора. Несмотря на то, что экземпляры монитора могут изменять собственный сценарий, большинство мониторов просто загружают сценарий один раз из файла. Значение *ппдефаултскрипт* может быть **равно NULL**. Тем не менее, либо монитор не может быть настроен извне, либо должен предоставить скрипт позже. В этом случае более эффективно указать скрипт по умолчанию.

</dd> <dt>

*ппдефаултконфиг* \[ заполняет\]
</dt> <dd>

Адрес строки по умолчанию, используемой для настройки монитора при его создании. Этому параметру можно присвоить **значение NULL**.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Если функция выполнена успешно, возвращается значение S ОК, что совпадает с параметром \_ "ошибка".

Если функция завершилась неудачно, МКСВК пропускает указанный монитор из всех списков; После этого невозможно создать монитор этого типа.

## <a name="remarks"></a>Комментарии

Функция **онлоадингдлл** вызывается мксвк при первой загрузке библиотеки DLL. Затем библиотека DLL предоставляет значения по умолчанию, которые будут использоваться МКСВК при создании экземпляра монитора.

Монитору необходимо выделить всю необходимую память для строк, возвращаемых в МКСВК. При возврате МКСВК создает копии всех строк и не пытается освободить возвращаемые строки.

Монитор должен использовать вспомогательные функции больших двоичных объектов для изменения фильтра BLOB.

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|-------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows 2000 Professional \[только классические приложения\]<br/>                          |
| Минимальная версия сервера<br/> | Windows 2000 Server \[только классические приложения\]<br/>                                |
| Заголовок<br/>                   | <dl> <dt>Netmon. h</dt> </dl> |



 

 




