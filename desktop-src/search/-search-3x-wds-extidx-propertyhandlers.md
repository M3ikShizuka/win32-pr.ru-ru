---
description: Microsoft Windows Search использует обработчики свойств для извлечения значений свойств из элементов и использует схему системы свойств, чтобы определить, как должно индексироваться конкретное свойство.
ms.assetid: b475329a-1ed7-43a4-8e11-3700889a4ce9
title: Разработка обработчиков свойств для поиска Windows
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7ac96e47738040321025b7f600e2c91109b08d51
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104262944"
---
# <a name="developing-property-handlers-for-windows-search"></a>Разработка обработчиков свойств для поиска Windows

Microsoft Windows Search использует обработчики свойств для извлечения значений свойств из элементов и использует схему системы свойств, чтобы определить, как должно индексироваться конкретное свойство. Для чтения и индексации значений свойств обработчики свойств вызываются вне процесса поиска Windows для повышения безопасности и надежности. В отличие от этого, обработчики свойств вызываются проводником Windows в процессе чтения и записи значений свойств.

Этот раздел дополняет раздел [системы свойств](../properties/building-property-handlers.md) информацией, относящейся к службе поиска Windows, и содержит следующие разделы.

-   [Разработка решений для обработчиков свойств](#design-decisions-for-property-handlers)
    -   [Решения для свойств](#property-decisions)
    -   [Поддержка полнотекстовых каталогов](#full-text-support)
    -   [Рекомендации по Имплементататион операционной системы](#operating-system-implementatation-considerations)
-   [Запись файлов описания свойств](#writing-property-description-files)
-   [Реализация обработчиков свойств](#implementing-property-handlers)
    -   [IInitializeWithStream](#iinitializewithstream)
    -   [ипропертисторе](#ipropertystore)
    -   [ипропертисторекапабилитиес](#ipropertystorecapabilities)
-   [Проверка индексации элементов](#ensuring-your-items-get-indexed)
-   [Установка и регистрация обработчиков свойств](#installing-and-registering-property-handlers)
-   [Тестирование и устранение неполадок обработчиков свойств](#testing-and-troubleshooting-property-handlers)
    -   [Тесты установки и установки](#installation-and-setup-tests)
    -   [Устранение неполадок обработчиков свойств](#troubleshooting-property-handlers)
-   [Использование обработчиков свойств System-Supplied](#using-system-supplied-property-handlers)
-   [См. также](#related-topics)

 

## <a name="design-decisions-for-property-handlers"></a>Разработка решений для обработчиков свойств

Реализация обработчиков свойств включает следующие шаги.

1.  Принятие решений по проектированию в отношении свойств, которые вы хотите поддерживать.
2.  Создание файла описания свойства (. пропдеск) для свойств, которые еще не находятся в системе свойств.
3.  Реализация и тестирование обработчика свойств.
4.  Установка и регистрация обработчиков свойств и файлов описания свойств.
5.  Тестирование установки и регистрации обработчика свойств.

Прежде чем начать, необходимо принять во внимание следующие вопросы по проектированию:

-   Какие свойства имеют или должны поддерживать формат файла?
-   Эти свойства уже включены в схему системы?
-   Можно ли использовать существующий обработчик свойств, предоставляемый системой?
-   Какие свойства могут отображаться для конечных пользователей?
-   Какие свойства могут изменять пользователи?
-   Должна ли поддержка полнотекстового поиска происходить из обработчика свойств или фильтра?
-   Требуется ли поддержка устаревших приложений? Если да, то что я реализую?

> [!Note]  
> Прежде чем продолжить, см. раздел [Использование обработчиков свойств System-Supplied](#using-system-supplied-property-handlers) , чтобы узнать, можно ли использовать предоставляемый системой обработчик свойств, сохранив как ресурсы времени, так и время разработки.

 

После принятия этих решений можно написать формальные описания пользовательских свойств, чтобы система поиска Windows могла начать индексирование файлов и свойств. Эти формальные описания представляют собой XML-файлы, описанные в [схеме описание свойства](/previous-versions//cc144127(v=vs.85)).

### <a name="property-decisions"></a>Решения для свойств

Принимая во внимание, какие свойства следует поддерживать, необходимо выяснить, какие именно индексированные пользователи должны выполнять поиск. Например, вы можете найти 100 потенциально полезных свойств для типа файлов, но пользователи могут заинтересовать Поиск только в нескольких случаях. Кроме того, может потребоваться, чтобы пользователи отображали разные, более крупные или меньшие группы этих свойств в проводнике Windows и позволяли пользователям изменять только подмножество отображаемых свойств.

Тип файлов может поддерживать любые определяемые пользователем свойства, а также набор системных свойств. Перед созданием пользовательского свойства проверьте [системные свойства](https://msdn.microsoft.com/library/bb763010(VS.85).aspx) , чтобы узнать, является ли свойство, которое требуется поддерживать, уже определенным системным свойством. Всегда Обеспечьте поддержку наиболее важных системных свойств.

Для разработки свойств рекомендуется использовать матрицу:



| Имя свойства | Является индексируемым? | Может ли быть воспроизведен? | Является редактируемым? |
|---------------|---------------|-----------------|--------------|
| property1     | Да             | Да               | Нет            |
| свойство...   | Да             | Да               | Нет            |
| пропертин     | Нет             | Нет               | Нет            |



 

Для каждого из этих свойств необходимо определить, какие атрибуты должны иметься, а затем описать их в XML-файлах описания свойств (. пропдеск). Атрибуты включают в себя тип данных свойства, метку, строку справки и многое другое. Для индексируемых свойств следует обратить особое внимание на следующие атрибуты свойств, найденные в XML-элементе [сеарчинфо](../properties/propdesc-schema-searchinfo.md)   файла описания свойств.



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>attribute</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ининвертединдекс</td>
<td>Необязательный элемент. Указывает, должно ли значение свойства строки разбиваться на слова и каждое слово, хранящееся в инвертированном индексе. Инвертированный индекс обеспечивает эффективный поиск слов и фраз по значению свойства с помощью CONTAINS или FREETEXT (например, SELECT... ГДЕ содержит &quot; сометекст &quot; ). Если задано значение <strong>false</strong>, поиск выполняется по всей строке. Большинство строковых свойств должно иметь значение <strong>true</strong>. свойства, не являющиеся строковыми, должны иметь значение <strong>false</strong>. Значение по умолчанию — <strong>false</strong>.</td>
</tr>
<tr class="even">
<td>Столбец</td>
<td>Необязательный элемент. Указывает, должно ли свойство храниться в базе данных Windows Search как столбец. Сохранение свойства в виде столбца включает извлечение, сортировку, группирование и фильтрацию (то есть использование любого предиката, кроме CONTAINS или FREETEXT) для значения всего столбца. Свойства, отображаемые пользователю, должны иметь значение <strong>true</strong> , если оно не является очень большим текстовым свойством (например, текстом документа), которое будет искаться в инвертированном индексе. Значение по умолчанию — <strong>false</strong>.</td>
</tr>
<tr class="odd">
<td>исколумнспарсе</td>
<td>Необязательный элемент. Указывает, принимает ли свойство пробел, если значение равно <strong>null</strong>. Свойство без разрежения для каждого элемента занимает место, даже если значение равно <strong>null</strong>. Если свойство является многозначным, этот атрибут всегда имеет <strong>значение true</strong>. Этот атрибут должен иметь значение <strong>false</strong> только в том случае, если для каждого элемента имеется какое-либо из значений. Значение по умолчанию — <strong>true</strong>.</td>
</tr>
<tr class="even">
<td>колумниндекстипе</td>
<td>Необязательный элемент. Для оптимизации запросов система поиска Windows может создавать вторичные индексы для свойств, имеющих<strong>значение IsTrue = true</strong>. Это требует больше обработки и места на диске во время индексирования, но повышает производительность при выполнении запросов. Если свойство планируется сортировать, группировать или фильтровать (то есть с помощью =,! =, <, >, LIKE, СОВПАДЕНИй) часто от пользователей, для этого атрибута следует задать значение &quot; ondisk &quot; . Значение по умолчанию — &quot; нотиндексед &quot; . Допустимы следующие значения.
<ul>
<li>Нотиндексед: не создан вторичный индекс.</li>
<li>На жестком диске. Создайте и сохраните вторичный индекс на диске.</li>
</ul></td>
</tr>
<tr class="odd">
<td>maxSize</td>
<td>Необязательный элемент. Указывает максимальный размер, допустимый для значения свойства, хранящегося в базе данных поиска Windows. Это ограничение применяется к элементам индвидуал вектора, а не к вектору в целом. Значения, превышающие этот размер, усекаются. Значение по умолчанию — &quot; 128 &quot; (байт).<br/> В настоящее время при вычислении объема данных, принимаемых из файла, Поиск Windows не использует параметр maxSize. Вместо этого в средстве поиска Windows используется ограничение на размер файла и Максгровфактор (Размер файла N * Максгровфактор), считанные из реестра в HKEY_LOCAL_MACHINE->Software->Microsoft->Windows Search->диспетчере сбора — >Максгровфактор. Максгровфактор по умолчанию — четыре (4). Следовательно, если тип файла является небольшим в общем размере, но имеет большие свойства, Поиск Windows может не принимать все данные свойства, которые вы хотите выпустить. Однако вы можете увеличить Максгровфактор в соответствии со своими потребностями. <br/></td>
</tr>
</tbody>
</table>



 

> [!Note]  
> Для атрибута Колумниндекстипе преимущество более быстрых запросов должно быть в сравнении с увеличением времени индексирования и затратами на пространство, которые могут повлечь дополнительные индексы. Однако эта стоимость оплачивается только для тех элементов, которые имеют значение, отличное от **null** , поэтому для большинства свойств этот атрибут можно задать равным "ondisk".

 

### <a name="full-text-support"></a>Поддержка полнотекстовых каталогов

Как правило, полнотекстовый поиск поддерживается компонентами, называемыми [фильтрами](-search-3x-wds-extidx-filters.md). Однако для текстовых типов файлов с несложными форматами файлов обработчики свойств могут предоставлять эту функцию с меньшим объемом усилий при разработке. Ознакомьтесь с разделом [Full-Text Content](../properties/building-property-handlers-property-handlers.md) , чтобы сравнить функциональные возможности обработчика фильтров и свойств, чтобы решить, что лучше всего подходит для вашего типа файлов. Важно то, что фильтры могут обрабатывали несколько идентификаторов языка (LCID) для каждого файла, а обработчики свойств — нет.

> [!Note]  
> Так как обработчики свойств не могут поблочировать содержимое, так как фильтры могут, большие файлы (даже если они являются несложными форматами файлов) должны быть полностью загружены в память.

 

### <a name="operating-system-implementatation-considerations"></a>Рекомендации по Имплементататион операционной системы

### <a name="implementation-information-for-windows-7"></a>Сведения о реализации Windows 7

В Windows 7 и более поздних версиях существует новое поведение при регистрации обработчика свойства, [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter)или нового расширения. При установке нового обработчика свойств и (или) **IFilter** файлы с соответствующими расширениями автоматически индексируются.

В Windows 7 рекомендуется устанавливать [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) вместе с соответствующими обработчиками свойств, а **IFilter** регистрироваться перед обработчиком свойства. Регистрация обработчика свойств инициирует немедленную повторную индексацию ранее индексированных файлов, не требуя предварительной перезагрузки, и использует преимущества всех ранее зарегистрированных IFilter (-ов) для индексации содержимого.

Если установлен только интерфейс [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) без соответствующего обработчика свойства, то автоматическая повторная индексация происходит либо после перезапуска службы индексирования, либо после перезагрузки системы.

Для флагов описания свойств, характерных для Windows 7, см. следующие справочные разделы:

-   [жетпропертисторефлагс](/windows/win32/api/propsys/ne-propsys-getpropertystoreflags)
-   [\_тип COLUMNINDEX \_ пропдеск](/windows/win32/api/propsys/ne-propsys-propdesc_columnindex_type)
-   [\_ \_ Флаги сеарчинфо пропдеск](/windows/win32/api/propsys/ne-propsys-propdesc_searchinfo_flags)

### <a name="implementation-information-for-windows-vista-and-earlier"></a>Сведения о реализации Windows Vista и более ранних версий

До выхода Windows Vista фильтры поддерживали синтаксический анализ и перечисление содержимого файлов и свойств. С появлением системы свойств обработчики свойств обрабатывали свойства файла, а фильтры обрабатывали содержимое файла. Для Windows Vista необходимо разработать только частичную реализацию интерфейса [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter)в координации с обработчиком свойств, как описано в разделе рекомендации [по созданию обработчиков фильтров в службе поиска Windows](-search-3x-wds-extidx-filters.md).

Хотя система свойств также включена в установку Windows Search для Windows XP, сторонние и устаревшие приложения могут потребовать, чтобы фильтры обрабатывали как содержимое, так и свойства. Поэтому при разработке на платформе Windows XP необходимо предоставить полную реализацию фильтра, а также обработчик свойств для типа файла или пользовательского свойства.

 

## <a name="writing-property-description-files"></a>Запись файлов описания свойств

Структура XML-файлов описания свойств (. пропдеск) описана в разделе [пропертидескриптион](../properties/propdesc-schema-propertydescription.md) . Определенный интерес для поиска — атрибуты элемента [сеарчинфо](../properties/propdesc-schema-searchinfo.md) . После выбора свойств для поддержки необходимо создать и зарегистрировать файлы описания свойств для каждого свойства. При регистрации пропдеск файлов они включаются в список свойств схемы и становятся именами столбцов в хранилище свойств поисковой системы.

Вы можете зарегистрировать описания пользовательских свойств с помощью функции [псрегистерпропертисчема](/windows/win32/api/propsys/nf-propsys-psregisterpropertyschema) , API-оболочки, вызывающей ипропертисистем:: регистерпропертисчема подсистемы схемы. Эта функция информирует подсистему схемы добавления файлов схемы описания свойств (. пропдеск), используя пути к файлам. пропдеск на локальном компьютере, обычно каталог установки приложения в разделе "Program Files". Как правило, установка или приложение (например, установщик обработчика свойств) будут вызывать этот метод после установки пропдеск-файлов.

 

## <a name="implementing-property-handlers"></a>Реализация обработчиков свойств

Разработка обработчика свойств включает реализацию следующих интерфейсов:

-   Иинитиалзевисстреам: обеспечивает инициализацию обработчика свойств на основе потока.
-   Ипропертисторе: перечисляет, возвращает и задает значения свойств.
-   Ипропертисторекапабилитиес: необязательный. Определяет, могут ли пользователи изменять свойство из пользовательского интерфейса.

### <a name="iinitializewithstream"></a>IInitializeWithStream

Как описано в разделе [система свойств](../properties/building-property-handlers.md) , настоятельно рекомендуется реализовать обработчики свойств с **IInitializeWithStream** для инициализации на основе потоков. Если вы решили не реализовывать IInitializeWithStream, обработчик свойств должен отказаться от выполнения в процессе изоляции, установив флаг Дисаблепроцессисолатион в разделе реестра обработчика свойств. Отключение изоляции процессов обычно предназначено только для устаревших обработчиков свойств и должно быть стренуауслио без какого-либо нового кода.

### <a name="ipropertystore"></a>ипропертисторе

Чтобы создать обработчик свойства, необходимо реализовать интерфейс [**ипропертисторе**](/windows/win32/api/propsys/nn-propsys-ipropertystore) со следующими методами.



| Метод   | Описание                                                         |
|----------|---------------------------------------------------------------------|
| Commit   | Сохраняет изменение свойства в файле.                                |
| GetAt    | Извлекает ключ свойства из массива свойств элемента.        |
| GetCount | Возвращает число свойств, присоединенных к файлу.                 |
| GetValue | Извлекает данные для определенного свойства.                             |
| SetValue | Задает новое значение свойства или заменяет или удаляет существующее значение. |



 

 

 

Важные рекомендации по реализации этого интерфейса включены в документацию по [**ипропертисторе**](/windows/win32/api/propsys/nn-propsys-ipropertystore) .

> [!Note]  
> Если обработчик свойств создает несколько значений для одного и того же свойства для заданного элемента, в каталог сохраняется только Последнее значение.

 

 

### <a name="ipropertystorecapabilities"></a>ипропертисторекапабилитиес

При необходимости обработчики свойств могут реализовать этот интерфейс, чтобы запретить пользователю изменять определенные свойства. Эти свойства обычно могут быть изменены на странице сведений и на панели, но их редактирование запрещено в обработчике реализующего свойства. Правильная реализация этого интерфейса обеспечивает более удобный пользовательский интерфейс, чем альтернатива — простую ошибку времени выполнения из оболочки.

 

## <a name="ensuring-your-items-get-indexed"></a>Проверка индексации элементов

Теперь, когда вы реализовали обработчик свойств, необходимо убедиться, что элементы обработчика зарегистрированы для получения индекса. Для инициации повторного индексирования можно использовать [Диспетчер каталогов](-search-3x-wds-mngidx-catalog-manager.md) . Кроме того, можно использовать [Диспетчер области сканирования](-search-3x-wds-extidx-csm.md) для настройки правил по умолчанию, указывающих URL-адреса, которые должен обходить индексатор. Другой вариант — выполнить пример кода переиндексации в [примерах пакета SDK для Windows Search](https://www.microsoft.com/downloads/details.aspx?FamilyID=645300AE-5E7A-4CE7-95F0-49793F8F76E8).

Дополнительные сведения см. в разделе [Использование диспетчера каталогов](-search-3x-wds-mngidx-catalog-manager.md) и [диспетчера области сканирования](-search-3x-wds-extidx-csm.md).

 

## <a name="installing-and-registering-property-handlers"></a>Установка и регистрация обработчиков свойств

При реализации обработчика свойств необходимо зарегистрировать его и расширение имени файла, связанное с обработчиком. В следующем примере показаны разделы и значения реестра, необходимые для этого.

```
HKEY_CLASSES_ROOT
   CLSID
      {<CLSID for property handler>}
         (Default) = <Property Handler Name>
         InProcServer32
            (Default) = <full path to property handler dll>
            ThreadingModel = <your threading model>
```

```
HKEY_LOCAL_MACHINE
   SOFTWARE
      Microsoft
         Windows
            CurrentVersion
               PropertySystem
                  PropertyHandlers
                     <.fileextention>
                        (Default) = {<CLSID for property handler>}
```

 

## <a name="testing-and-troubleshooting-property-handlers"></a>Тестирование и устранение неполадок обработчиков свойств

В следующем списке приведены рекомендации по типам выполняемых тестов.

-   Проверка получения выходных данных из каждого отдельного свойства, поддерживаемого типом файла.
-   Используйте большие значения свойств, например крупные метатаг в HTML-документах.
-   Убедитесь, что обработчик свойств не получает дескрипторы файлов, отредактировав его после получения выходных данных из обработчика свойств или с помощью такого средства, как oh.exe до и после перечисления свойств файла.
-   Проверьте все типы файлов, связанные с обработчиком свойств. Например, убедитесь, что фильтр HTML работает с типами файлов HTM и HTML.
-   Тестирование с поврежденными файлами. Корректное завершение обработчика свойств.
-   Если приложение поддерживает шифрование, проверьте, что обработчик свойства не выводит зашифрованный текст.
-   Если обработчик свойств поддерживает полнотекстовый поиск:
    -   Используйте в содержимом файлов несколько специальных символов Юникода и проверьте их выходные данные.
    -   Протестируйте обработку очень больших документов, чтобы убедиться, что обработчик свойств работает правильно.

### <a name="installation-and-setup-tests"></a>Тесты установки и установки

Наконец, необходимо протестировать подпрограммы установки и удаления.

-   Установка должна быть восстановлена после неудачных установок (например, после отмены и повторного запуска программы установки).
-   Удаление должно удалить все файлы, связанные с обработчиком свойств.
-   Удаление не должно удалять файлы, отличные от тех, которые связаны с установкой обработчика свойств.
-   Разделы реестра, связанные с обработчиком свойств, должны быть удалены при удалении.
-   Удаление должно работать, даже если файлы удаляются из каталога установки.

### <a name="troubleshooting-property-handlers"></a>Устранение неполадок обработчиков свойств

Ниже приведены некоторые распространенные ошибки, возникающие при разработке обработчиков свойств.

-   Установка файлов. пропдеск или библиотек DLL в каталоге пользователя.
-   Регистрация компонентов с использованием относительных путей.
-   Регистрация компонентов в разделе HKEY \_ текущий \_ пользователь, а не на \_ локальном компьютере hKey \_ .
-   Не удается задать Дисаблепроцессисолатион для обработчиков, не являющихся потоками.
-   Размещение тестового файла в неиндексированном расположении.

Если у вас возникают проблемы с работой обработчика свойств с индексатором, вот несколько советов по устранению неполадок:

-   Убедитесь, что описания свойств (пропдеск-файлы) помечены как "IsTrue" = "**true**", "View" = "**true**", а для "IsTrue" — "**true**" соответственно.
-   Убедитесь, что пропдеск-файлы находятся в глобальном расположении.
-   Убедитесь, что пропдеск файлы зарегистрированы с помощью абсолютных путей.
-   Убедитесь, что в журнале событий не записаны сбои при регистрации файла. пропдеск.
-   Убедитесь, что библиотеки DLL находятся в глобальном расположении (а не в вашем профиле пользователя).
-   Убедитесь, что библиотеки DLL зарегистрированы в \_ разделе \_ \\ классы программного обеспечения для локального компьютера hKey \\ .
-   Убедитесь, что библиотеки DLL зарегистрированы с использованием полных путей (или строки с РАСШИРЕНИЕМ \_ \_ SZ, которые расширяются до абсолютных путей с помощью переменных среды, известных системной учетной записью).
-   Убедитесь, что обработчик свойств работает в проводнике Windows.
-   Хотя мы рекомендуем использовать IInitializeWithStream, при необходимости использования IInitializeWithFile или Иинитиализевиситем убедитесь, что вы указали Дисаблепроцессисолатион.
-   Убедитесь, что в панели управления параметры индексирования список типов файлов указан в виде индексированного типа файлов.
-   Убедитесь, что тестовый файл находится в индексированном расположении.
-   Убедитесь, что тестовый файл был изменен со времени установки обработчика свойств.

Если тестовый файл находится в индексированном расположении, а индексатор уже выполнил обход содержимого этого расположения, необходимо изменить файл каким-либо образом, чтобы запустить повторное индексирование файла.

 

## <a name="using-system-supplied-property-handlers"></a>Использование обработчиков свойств System-Supplied

Windows включает ряд обработчиков свойств, предоставляемых системой, которые можно использовать, если формат файла совместим. При определении нового расширения файла, использующего один из этих форматов, можно использовать предоставляемые системой обработчики, зарегистрировав идентификатор класса обработчика (CLSID) для расширения файла.

Для регистрации системных обработчиков свойств для типа формата файла можно использовать идентификатор CLSID, приведенный в следующей таблице.



| Формат          | CLSID                                  |
|-----------------|----------------------------------------|
| Докфиле OLE     | {8d80504a-0826-40c5-97e1-ebc68f953792} |
| Сохранение игрового XML   | {ECDD6472-2B9B-4b4b-AE36-F316DF3C8D60} |
| Обработчик XPS/OPC | {45670FA8-ED97-4F44-BC93-305082590BFB} |
| XML             | {c73f6f30-97a0-4ad1-a08f-540d4e9bc7b9} |



 

Перед созданием пользовательского свойства необходимо убедиться, что не определено системное свойство, которое можно использовать. Вы можете перечислить определяемые системой свойства, вызвав [**псенумератепропертидескриптионс**](/windows/win32/api/propsys/nf-propsys-psenumeratepropertydescriptions) или используя средство командной строки prop.exe.

Системная схема определяет, как эти свойства взаимодействуют с индексатором, и вы не можете изменить это свойство. Кроме того, приложение, используемое для создания, изменения и сохранения типа файлов, должно также соответствовать определенному поведению. Например, если приложение реализует безусловное сохранение (при этом во время редактирования создается временный файл, а затем Реплацефиле () используется для замены новой версии старой), она должна переносить все свойства из исходного файла в новый файл. Сбой означает, что файл теряет свойства, добавленные пользователями или другими приложениями.

 

**Пример**

Ниже показана регистрация предоставляемого системой обработчика Докфиле OLE для типа файла с. Расширение Оледокфиле.

```
HKEY_CLASSES_ROOT
   SystemFileAssociations
      .OLEDocFile
         shellex
            {BB2E617C-0920-11d1-9A0B-00C04FC2D6C1}
               (Default) = {9DBD2C50-62AD-11d0-B806-00C04FD706EC}
```

Ниже показано, как зарегистрировать сведения о списке свойств, чтобы получить свойства. Файлы Оледокфиле отображаются на вкладке и области сведений.

```
HKEY_CLASSES_ROOT
   SystemFileAssociations
      .OLEDocFile
         ExtendedTileInfo = prop:System.ItemType;System.Size;System.DateModified;System.Author;System.OfflineAvailability
         FullDetails = prop:System.PropGroup.Description;System.Title;System.Subject;
System.Keywords;System.Category;System.Comment;System.PropGroup.Origin;
System.Author;System.Document.LastAuthor;System.Document.RevisionNumber;
System.Document.Version;System.ApplicationName;System.Company;System.Document.Manager;
System.Document.DateCreated;System.Document.DateSaved;System.Document.DatePrinted;
System.Document.TotalEditingTime;System.PropGroup.Content;System.ContentStatus;
System.ContentType;System.Document.PageCount;System.Document.WordCount;
System.Document.CharacterCount;System.Document.LineCount;
System.Document.ParagraphCount;System.Document.Template;System.Document.Scale;
System.Document.LinksDirty;System.Language;System.PropGroup.FileSystem;
System.ItemNameDisplay;System.ItemType;System.ItemFolderPathDisplay;
System.DateCreated;System.DateModified;System.Size;System.FileAttributes;
System.OfflineAvailability;System.OfflineStatus;System.SharedWith;
System.FileOwner;System.ComputerName
         InfoTip = prop:System.ItemType;System.Size;System.DateModified;System.Document.PageCoun
         PerceivedType = document
         PreviewDetails = prop:*System.DateModified;System.Author;System.Keywords;
*System.Size;System.Title;System.Comment;System.Category;
*System.Document.PageCount;System.ContentStatus;System.ContentType;
*System.OfflineAvailability;*System.OfflineStatus;System.Subject;
*System.DateCreated;*System.SharedWith
```

 

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

**Reference**
</dt> <dt>

[Сопоставления свойств](-search-3x-wds-propertymappings.md)
</dt> <dt>

**Зрения**
</dt> <dt>

[Рекомендации по созданию обработчиков фильтров в поиске Windows](-search-3x-wds-extidx-filters.md)
</dt> <dt>

[Процесс индексирования](-search-indexing-process-overview.md)
</dt> <dt>

[Разработка обработчиков протоколов](-search-3x-wds-phaddins.md)
</dt> <dt>

[Определяемые системой свойства для пользовательских форматов файлов](-shell-systemdefinedpropertiesforfileformats.md)
</dt> <dt>

**Другие ресурсы**
</dt> <dt>

[Система свойств](../properties/building-property-handlers.md)
</dt> <dt>

[Свойства системы](https://msdn.microsoft.com/library/bb763010(VS.85).aspx)
</dt> <dt>

[Примеры пакета SDK для Windows Search](https://www.microsoft.com/downloads/details.aspx?FamilyID=645300AE-5E7A-4CE7-95F0-49793F8F76E8)
</dt> </dl>

 

 
