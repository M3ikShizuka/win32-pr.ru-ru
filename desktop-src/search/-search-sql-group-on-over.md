---
description: Группа в...
ms.assetid: 37f027c1-c2af-4d62-8b5f-918499fc2d7c
title: ГРУППИРОВАТЬ ПО... ПОВЕРХ... Баланс
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 94d7087305f0a5a86f0288ed92ec4bda5b8c882c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104144089"
---
# <a name="group-on--over--statement"></a>ГРУППИРОВАТЬ ПО... ПОВЕРХ... Баланс

Группа в... Поверх... Инструкция возвращает иерархический набор строк, в котором результаты поиска делятся на группы на основе указанного столбца и необязательных диапазонов группирования. При группировке по столбцу [System. Kind](../properties/props-system-kind.md) результирующий набор делится на несколько групп: один для документов, один для обмена данными и т. д. При группировании по [System. size](../properties/props-system-size.md) и group Range 100 КБ результирующий набор делится на три группы: элементы размером < 100 КБ, элементы размером >= 100 КБ и элементы без значения размера. Можно также объединять группирования с функциями.

В этом разделе рассматриваются следующие темы:

-   [Синтаксис](#syntax)
-   [Диапазоны групп](#group-ranges)
-   [Группы меток](#labeling-groups)
-   [Упорядочение групп](#ordering-groups)
-   [Вложенные группы](#nesting-groups)
-   [Группирование по свойствам вектора](#grouping-on-vector-properties)
-   [Дополнительные примеры](#more-examples)
-   [См. также](#related-topics)

## <a name="syntax"></a>Синтаксис

Группа в... ПОВЕРХ... Инструкция имеет следующий синтаксис:


```
GROUP ON <column> ['['<group ranges>']']] 
[AGGREGATE <aggregate_function>] 
[ORDER BY <column> [<direction>]] | [ORDER IN GROUP '<group name>' BY <column> [<direction>]]
    OVER (GROUP ON... | SELECT... ] )
```



где диапазоны группирования определяются следующим образом:


```
<group ranges> := <range limit> [/'<label>'] | <range limit> [/'<label>'], <group ranges>
<range limit> := (<number> | <date> | '<string>' | BEFORE('<string>') | AFTER('<string>')) 
```



Группа по <column> может быть обычным или [идентификатором](-search-sql-identifiers.md) с разделителями для свойства в хранилище свойств.

Необязательный <group ranges> — это список из одного или нескольких значений (число, дата или строка), используемых для деления результатов на группы. <range limit>Определяет точку деления в возвращенном результирующем наборе и <label> определяет понятную пользователю метку для группы. Результирующий набор можно разделить на количество групп по мере необходимости.

Первая группа результатов включает элементы с минимально возможным значением для указанного свойства вплоть до, но не включая первый предел диапазона. На эту группу можно ссылаться с помощью ключевого слова MINVALUE. К второй группе можно обратиться как к самому спецификатору ограничения диапазона, так и к элементам, значение которых для указанного свойства больше или равно ограничению диапазона. Все элементы, не имеющие значения для указанного свойства, возвращаются последними и могут называться ключевым словом **null** .

Например, ограничение диапазона, равное "2006-01-01" для свойства [System. DateCreated](../properties/props-system-datecreated.md) , делит результирующий набор на элементы с датами до 2006-01-01 (Группа MinValue), элементы с датами в или после 2006-01-01 (группа 2006-01-01) и элементы без даты (группа со **значением NULL** ).

В каждой группе результаты сортируются по значениям в столбце ГРУППИРОВАТЬ по по умолчанию. Необязательное предложение [ORDER BY](-search-sql-orderby.md) может содержать описатель направления либо ASC для возрастания (с низким уровнем до высокого), либо DESC для нисходящего (от высокого до низкого), а предложение [Order в Group By](-search-sql-orderingroup.md) может упорядочивать каждую группу с помощью различных правил. Дополнительные сведения см. в разделе [Упорядочение групп](#ordering-groups) ниже.

## <a name="group-ranges"></a>Диапазоны групп

В следующей таблице показано, как результаты делятся на группы на основе ограничений диапазона.



| Пример ( <column> \[ диапазоны групп \] )        | Результат                                                                                                                                                                                                                                                                         |
|--------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| System. size \[ 1000, 5000\]                       | Результаты группируются в четыре сегмента: **MinValue**: Size < 1000<br/> **1000:** 1000 <= размер < 5000<br/> **5000:** Размер >= 5000<br/> **Значение NULL:** Нет значения для размера<br/>                                                                      |
| System. Author \[ до (m '), после (' r ')\]         | Результаты группируются в четыре сегмента: **MinValue:** Author < символ перед "m"<br/> **m:** символ перед "m" <= автор < символ после "r"<br/> **r:** символ после "r" <= Author<br/> **Значение NULL:** Нет значения для автора<br/>      |
| System. Author \[ MinValue/' a to l ', ' m '/m-z '\] | Результаты группируются в три сегмента: **a в l:** Author < "m"<br/> от **m до z:** "m" <= Author <br/> **Значение NULL:** Нет значения для автора<br/>                                                                                                               |
| System. DateCreated \[ ' 2005-1-01 ', ' 2006-6-01 '\]   | Результаты группируются в четыре сегмента:<br/> **MinValue:** DateCreated < 2005-1-01<br/> **2005-1-01:** 2005-1-01 <= DateCreated < 2006-6-01<br/> **2006-1-01:** DateCreated >= 2006-6-01<br/> **Значение NULL:** Нет значения для DateCreated<br/> |



 

 

> [!IMPORTANT]
>
> Неверной `GROUP ON System.Author['m','z','a']`
>
> Правильно: `GROUP ON System.Author['a','m','z']`

 

 

## <a name="labeling-groups"></a>Группы меток

Чтобы улучшить удобочитаемость, можно пометить группы с помощью следующего синтаксиса:


```
GROUP ON <column> [<range limit>/'<label>',<range limit>/'<label>']
```



Метка отделяется от ограниченного диапазона символом косой черты и заключается в одинарные кавычки. Если метка не указана, имя группы будет строкой ограничения диапазона.

Ниже приведен пример групп меток.


```
GROUP ON System.Size [(MINVALUE/'Small','100')/'Medium','50000'/'Large']
    OVER (SELECT System.Size FROM SystemIndex)
```



В Windows 7 или более поздней версии можно также использовать универсальную \[ другую \] метку для объединения нескольких диапазонов группирования. Результаты из всех групп, указанных с помощью этой метки, будут объединены в одну группу с этой меткой. Эта группа результатов возвращается после всех остальных групп, за исключением группы **со значением NULL** . Группа **null** содержит результаты для элементов, которые не имеют значения для указанного свойства. До Windows 7 \[ другая \] Метка рассматривается как любая другая метка группы.

Следующий код является примером использования \[ другой \] метки для групп, которые будут созданы в Windows 7 или более поздней версии:


```
GROUP ON System.Author ['0', 'A'/'[OTHER]', 'I', 'Q', 'W'/'[OTHER]', 'Y']
    OVER (SELECT System.DateCreated FROM SystemIndex)
```



В следующей таблице показаны группы, которые будут созданы с помощью предыдущего кода группирования в Windows 7 или более поздней версии.



| Группа     | System.Author | System. имя_файла |
|-----------|---------------|-----------------|
| 0         | 1Bill         | Lorem.docx      |
| Q         | Дама         | Ipsum.docx      |
|           | Robin         | dolor.docx      |
| Да         | зара          | amet.docx       |
| \[ИНОЙ\] | абнер         | nonummy.docx    |
|           | Владимир           | laoreet.docx    |
|           | ксариа         | magna.docx      |
| **NULL**  |               | aliquam.docx    |



 

## <a name="ordering-groups"></a>Упорядочение групп

Существует три способа упорядочивания элементов в группах:

-   Порядок по умолчанию: если не указано иное, результаты упорядочиваются по значениям в столбце ГРУППИРОВАТЬ в порядке возрастания.
-   ORDER BY: в предложении ORDER BY можно указать убывающий порядок. Результаты необходимо упорядочить по столбцу GROUP ON.
-   ПОРЯДОК в группе: можно указать другой порядок для каждой группы. Если вы выполняете группировку по [System. Kind](../properties/props-system-kind.md), вы можете [](../properties/props-system-author.md) упорядочивать документы по System. Author [. исполнителя](../properties/props-system-music-artist.md).

Дополнительные сведения о сортировке результатов см. на страницах справочника [по предложениям ORDER BY](-search-sql-orderby.md) и [Order on Group](-search-sql-orderingroup.md) .

## <a name="nesting-groups"></a>Вложенные группы

Можно вкладывать группы с несколькими предложениями GROUP ON. Порядок, указанный в запросе, непосредственно отражается в иерархии выходных групп, как показано в следующем примере.


```
GROUP ON <System.Kind> 
      OVER (GROUP ON <System.Author> 
                  OVER (SELECT <System.DateCreated>))
```





| System. Kind    | System.Author | System. DateCreated |
|----------------|---------------|--------------------|
| документов      | вилла         | 2006-01-02         |
|                |               | 2006-01-05         |
|                | зара          | 2007-06-02         |
|                |               | 2007-09-10         |
| IP-адресу (DIP) | абнер         | 2006-04-16         |
|                | Жан          | 2007-02-20         |
|                | вилла         | 2006-10-15         |
|                | зара          | 2008-01-02         |



 

 

## <a name="grouping-on-vector-properties"></a>Группирование по свойствам вектора

Группирование по свойствам вектора, свойствам, которые могут содержать одно или несколько значений одновременно, по умолчанию сравнивает векторные значения по отдельности. Например, если имеется один документ, Lorem.docx с свойством System. Author как «Сереса; Зара "и другой документ, Ipsum.docx с свойством System. Author как" Зара ", запрос возвращает результирующий набор в двух группах, как показано ниже:


```
GROUP ON <System.Author> 
      OVER (SELECT <System.FileName>)
```





| System.Author | System. имя_файла |
|---------------|-----------------|
| сереса       | Lorem.docx      |
| зара          | Lorem.docx      |
|               | Ipsum.docx      |



 

Как видите, группирование по свойствам Vector возвращает дублирующиеся строки. Lorem.docx появляется дважды, так как у него есть два автора.

 

## <a name="more-examples"></a>Другие примеры


```
GROUP ON System.Photo.ISOSpeed [0,10,100] 
      OVER (SELECT System.ItemName, System.Size, System.ItemUrl FROM SystemIndex)
            
GROUP ON System.DateCreated['2005/01/01 00:00:00', '2005/12/30 23:00:00'] 
      OVER (SELECT System.ItemName, System.Size, System.ItemUrl FROM SystemIndex)
            
GROUP ON System.Author ORDER BY System.Author DESC 
      OVER (GROUP ON System.DateCreated ORDER BY System.DateCreated ASC 
                  OVER (SELECT System.FileName, System.DateCreated, System.Size FROM SystemIndex 
                        WHERE CONTAINS(*, 'text')))

GROUP ON System.ItemName [before('a'), 'a', before ('c'), 'd', after('d')] 
      OVER (SELECT System.ItemName, System.ItemUrl FROM SystemIndex ORDER BY System.ItemName)                        
                        
GROUP ON System.ItemNameDisplay ['a' / 'col_a','c' / 'col_c'] 
      OVER (SELECT System.ItemNameDisplay FROM SystemIndex 
            ORDER BY System.ItemNameDisplay)

GROUP ON System.Size[1,2] 
      OVER (GROUP ON System.Author['a','f','mc','x'] 
                  OVER (GROUP ON System.DateCreated['2005/07/25 07:00:00', '2005/08/25 07:00:00']
                        ORDER BY System.DateCreated DESC 
                              OVER (SELECT System.FileName FROM SystemIndex 
                                    WHERE CONTAINS('text'))))   
```



## <a name="related-topics"></a>См. также

<dl> <dt>

[Агрегатные функции](-search-sql-aggregates.md)
</dt> <dt>

[Предложение ORDER BY](-search-sql-orderby.md)
</dt> <dt>

[ORDER в предложении GROUP](-search-sql-orderingroup.md)
</dt> </dl>

 

 
