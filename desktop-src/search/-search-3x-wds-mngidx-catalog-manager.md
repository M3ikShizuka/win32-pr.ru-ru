---
description: Интерфейсы Исеарчкаталогманажер и ISearchCatalogManager2 предоставляют методы для управления каталогом поиска, например вызывают повторную индексацию или настройку времени ожидания.
ms.assetid: 8dad7012-d610-4398-8e86-cd319db8c360
title: Использование диспетчера каталогов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1295cc9cc76fb334b4687b876fa1959a22e33235
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105673213"
---
# <a name="using-the-catalog-manager"></a>Использование диспетчера каталогов

Интерфейсы [**исеарчкаталогманажер**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager) и [**ISearchCatalogManager2**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager2) предоставляют методы для управления каталогом поиска, например вызывают повторную индексацию или настройку времени ожидания. Хотя поиск Windows использует только один каталог, этот интерфейс был разработан таким образом, чтобы обеспечить более высокий контроль за управление несколькими каталогами независимо друг от друга. Интерфейс управляет каталогом следующими способами.

- Доступ к другим интерфейсам — получение других интерфейсов, связанных с поиском, требуемых диспетчером области сканирования, уведомлениями об изменении данных и интерфейсом [**исеарчкуерихелпер**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) .
- Содержимое каталога — гарантируется, что новые данные индексируются и что другие приложения и компоненты работают надлежащим образом путем принудительной повторной индексации всего каталога или его части или путем сброса всего каталога.
- Свойства каталога — задание свойств, определяющих, как каталог управляет временем ожидания при подключении к обработчикам протоколов и как диакритические знаки обрабатываются при поиске.
- Состояние каталога — получение сведений о каталоге, включая состояние, размер и текущее состояние действия.

Этот раздел организован следующим образом:

- [Доступ к связанным интерфейсам](#accessing-related-interfaces)
- [Управление содержимым каталога](#managing-the-catalog-contents)
- [Управление состоянием каталога](#managing-catalog-status)
- [Управление свойствами каталога](#managing-catalog-properties)
- [Запуск в режиме с повышенными правами](#running-in-elevated-mode)
- [См. также](#related-topics)

## <a name="accessing-related-interfaces"></a>Доступ к связанным интерфейсам

Для использования некоторых полезных интерфейсов на платформе Windows Search требуется экземпляр диспетчера каталогов. Чтобы создать диспетчер каталога для указанного каталога, вызовите метод [**исеарчманажер::-catalog**](/windows/desktop/api/Searchapi/nf-searchapi-isearchmanager-getcatalog) . Затем можно использовать методы диспетчера каталога для создания экземпляров и возврата интерфейсов, основанных на указанном каталоге.

| Метод                                                                                               | Описание                                                                                                                                                                                                                                                                                                                                                                        |
|------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**жеткуерихелпер**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-getqueryhelper)                               | Возвращает экземпляр интерфейса [**исеарчкуерихелпер**](/windows/desktop/api/Searchapi/nn-searchapi-isearchqueryhelper) для текущего каталога, позволяющий легко создавать запросы.                                                                                                                                                                                                                         |
| [**жеткравлскопеманажер**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-getcrawlscopemanager)                   | Возвращает экземпляр [**исеарчкравлскопеманажер**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcrawlscopemanager) для этого каталога поиска, чтобы позволить разработчикам изменять область обхода содержимого индексатора поиска Windows.                                                                                                                                                                                    |
| [**жетитемсчанжедсинк**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-getitemschangedsink)                     | Возвращает экземпляр интерфейса [**исеарчитемсчанжедсинк**](/windows/desktop/api/Searchapi/nn-searchapi-isearchitemschangedsink) , который используется клиентскими приложениями для уведомления индексатора об изменениях, когда клиенту требуется информация о состоянии индексирования элемента для поддержки уведомлений, управляемых поставщиком. Дополнительные сведения см. [в разделе уведомление об изменениях в индексе](-search-3x-wds-notifyingofchanges.md) . |
| [**жетперсистентитемсчанжедсинк**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-getpersistentitemschangedsink) | Возвращает экземпляр [**исеарчперсистентитемсчанжедсинк**](/windows/desktop/api/Searchapi/nn-searchapi-isearchpersistentitemschangedsink), который используется клиентскими приложениями для уведомления индексатора об изменениях, когда клиенту не требуется информация о состоянии индексирования (управляемые индексатором уведомления). Дополнительные сведения см. [в разделе уведомление об изменениях в индексе](-search-3x-wds-notifyingofchanges.md) .            |

## <a name="managing-the-catalog-contents"></a>Управление содержимым каталога

Существует две основные задачи, связанные с управлением каталогом: повторное индексирование всех или некоторых URL-адресов в области обхода индексатора и сброс всех базовых каталогов. При повторном индексировании URL-адресов старые данные остаются в каталоге до или до тех пор, пока они не будут заменены новыми данными. При сбросе каталога весь каталог перестраивается, и все URL-адреса в области обхода будут повторно индексироваться. Этот процесс может занять много времени и использоваться только в качестве последнего средства для решения таких проблем, как, возможно, поврежденный индекс.

При установке нового приложения, обработчика протокола или фильтра приложение установки должно добавить его каталог или корень в область обхода содержимого, чтобы убедиться, что индексатор включает расположение данных этого приложения. Если данные не отображаются в каталоге после того, как индексатор обработает область обхода содержимого, необходимо сначала убедиться, что расположение данных включено в область обхода содержимого. Его можно добавить с помощью пользовательского интерфейса для параметров поиска Windows или [диспетчера области обхода содержимого](-search-3x-wds-extidx-csm.md). Если расположение находится в области сканирования, можно вручную выполнить повторную индексацию всех URL-адресов в области обхода или подмножества индексатора, используя следующие методы интерфейса [**исеарчкаталогманажер**](/windows/desktop/api/Searchapi/nn-searchapi-isearchcatalogmanager) .

| Повторное индексирование метода                                                                                                                                                                                                                | Описание                                                                                                                                                                                                                                                          |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**Исеарчкаталогманажер:: переиндексировать**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-reindex)                                                                                                                                                   | Повторно индексирует все URL-адреса в каталоге. Старые сведения останутся до тех пор, пока не будут заменены новыми данными.                                                                                                                                                         |
| [**Исеарчкаталогманажер:: Реиндексматчингурлс**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-reindexmatchingurls)<br/> [**Исеарчкаталогманажер:: Реиндекссеарчрут**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-reindexsearchroot)<br/> | Повторно индексирует URL-адреса, которые соответствуют шаблону или начинаются с определенного корня (например, file:///C: \\ имя_папки \\ субфолдернаме \\ ). Это полезно для пересканирования всех элементов в определенном каталоге или с определенным расширением, как при установке приложения. |
| [**приоритизематчингурлс**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager2-prioritizematchingurls)                                                                                                                                           | Инструктирует индексатор для определения приоритета элементов индексирования с URL-адресами, которые соответствуют заданному шаблону, для выполнения других задач индексирования.                                                                                                                                    |

**Сброс индекса.** Вы можете сбросить весь индекс с помощью вызова [**исеарчкаталогманажер:: Reset**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-reset). При этом восстанавливается базовый каталог путем перестроения баз данных и выполнения полного индекса всех URL-адресов в области обхода. Этот процесс может занять много времени и использоваться только в качестве последнего средства для решения таких проблем, как, возможно, поврежденный индекс.

> [!IMPORTANT]
> Из-за замедления индексирования, которые могут быть вызваны этими методами, их следует тщательно использовать при попытке определить проблемы с индексированием или каталогом. Во-первых, убедитесь, что корни поиска и правила области добавлены в Диспетчер области обхода содержимого, а затем убедитесь, что ФАНЦИ бит (атрибут файла не индексировано) задан для файлов и папок правильно. Если вы подтвердили, что эти данные верны, попробуйте Реиндекссеарчрут сначала и повторите индексацию. Если ни одна из этих функций не работает, попробуйте выполнить сброс в качестве последнего средства.

Дополнительные сведения см. в разделе [уведомление индекса изменений](-search-3x-wds-notifyingofchanges.md)и [запрос индекса с помощью исеарчкуерихелпер](-search-3x-wds-qryidx-searchqueryhelper.md) .

## <a name="managing-catalog-status"></a>Управление состоянием каталога

Диспетчер каталога можно использовать для получения сведений о состоянии каталога для приложений, которые хотят настроить управление каталогом (например, пользовательское приложение "состояние каталога"). Но диспетчер каталогов обычно не требуется для большинства сценариев разработки, связанных с поиском. Обычно используются для приложения мониторинга "состояние каталога" или приложения в стиле панели управления.

В следующей таблице описаны методы Исеарчкаталогманажер, используемые для управления состоянием каталога.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Метод</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-urlbeingindexed"><strong>урлбеингиндексед</strong></a></td>
<td>Возвращает URL-адрес, который индексируется в данный момент. Этот метод будет полезен при попытке определить, был ли индексатор &quot; зависнуть &quot; в элементе.</td>
</tr>
<tr class="even">
<td><a href="/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-numberofitems"><strong>нумберофитемс</strong></a></td>
<td>Возвращает число элементов в каталоге.</td>
</tr>
<tr class="odd">
<td><a href="/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-numberofitemstoindex"><strong>нумберофитемстоиндекс</strong></a></td>
<td>Извлекает следующие сведения о индексируемых элементах:
<ul>
<li>Плинкременталкаунт — число элементов, которые будут индексироваться в следующем инкрементном индексе</li>
<li>Плнотификатионкуеуе — число элементов в очереди уведомлений. Эта информация будет полезна для приложения уведомления, которое потребовало бы проверить, получает ли индексатор уведомления, отправляемые приложением.</li>
<li>Плхигхприоритикуеуе — число элементов в очереди с высоким приоритетом. Сначала индексируются элементы в Плхигхприоритикуеуе.</li>
</ul></td>
</tr>
<tr class="even">
<td><a href="/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-getcatalogstatus"><strong>жеткаталогстатус</strong></a></td>
<td>Возвращает состояние каталога и возвращает значение перечисления, которое предоставляет текущее состояние. Ниже приведены возможные состояния каталога.
<ul>
<li>Бездействие: индексирование не требуется.</li>
<li>Приостановлено: индексирование приостановлено (например, из-за низкого заряда батареи или высокой загрузки ЦП).</li>
<li>Восстановление. Индексация восстанавливается.</li>
<li>Полный обход содержимого: индексатор выполняет полный обход области сканирования.</li>
<li>Добавочное сканирование: индексатор выполняет добавочное сканирование.</li>
<li>Обработка уведомлений: индексатор обрабатывает уведомления.</li>
<li>Завершение работы: индексатор завершает работу.</li>
</ul></td>
</tr>
<tr class="odd">
<td><a href="/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-get_name"><strong>get_Name</strong></a></td>
<td>Возвращает имя текущего каталога, указанного в методе <a href="/windows/desktop/api/Searchapi/nf-searchapi-isearchmanager-getcatalog"><strong>исеарчманажер::-catalog</strong></a> . В настоящее время поддерживается только каталог Системиндекс.</td>
</tr>
</tbody>
</table>

## <a name="managing-catalog-properties"></a>Управление свойствами каталога

Существует три свойства каталога, которыми можно управлять с помощью диспетчера каталогов.

- **Чувствительность диакритических знаков.** Диакритические знаки — это буквы, добавленные к буквам для обозначения слова или произношения. Это свойство определяет, является ли каталог чувствительным к диакритическим знакам, и важен, если вы или ваш пользователь намерены Поиск и индексирование текста на нескольких языках. Например, если этому свойству присвоено значение **false**, каталог будет считаться "Resume" и "ресумé", как если бы они были одним и тем же словом.
- **Время ожидания подключения истекло.** Это свойство представляет количество времени ожидания ответа соединения от сервера или хранилища данных, представленного в структуре [**\_ сведений о времени ожидания**](/windows/desktop/api/Searchapi/ns-searchapi-timeout_info) . Это свойство можно использовать для точной настройки службы поиска Windows.
- **Время ожидания данных** Это свойство представляет время ожидания транзакции с данными между индексатором и обработчиком протокола или фильтром, как представлено в структуре [**\_ сведений о времени ожидания**](/windows/desktop/api/Searchapi/ns-searchapi-timeout_info) . Если это время прошло, процесс из управляющей программы фильтрации завершается, чтобы предотвратить взаимоблокировки и другие проблемы с ресурсами.

Последние два свойства предназначены в первую очередь для использования в будущем. Каждое из этих свойств имеет `get` `put` методы и.

| Метод                                                                                                                                                                                                          | Описание                                                                                                                                                                                                                                     |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**получить \_ диакритиксенситивити**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-get_diacriticsensitivity) /<br/> [**разместить \_ диакритиксенситивити**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-put_diacriticsensitivity)<br/> | Значение TRUE, если каталог должен отличать слова диакритическими знаками. **Значение false** , если каталог должен игнорировать диакритические знаки. Изменение этого свойства требует перестроения индекса, так как ключи индекса могут стать недопустимыми.                       |
| [**получить \_ ConnectTimeout**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-get_connecttimeout) /<br/> [**разместить \_ ConnectTimeout**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-put_connecttimeout)<br/>                         | Время в секундах, в течение которого индексатор должен ожидать ответа соединения от сервера или хранилища данных. Слишком большое значение может привести к задержкам, если количество сайтов не отвечает. Слишком низкое значение параметра может привести к тому, что обход некоторых сайтов не будет выполнен. |
| [**получение \_ времени ожидания**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-get_datatimeout) /<br/> [**добавить \_ время ожидания**](/windows/desktop/api/Searchapi/nf-searchapi-isearchcatalogmanager-put_datatimeout)<br/>                                     | Время в секундах, в течение которого индексатор должен ожидать транзакцию данных.                                                                                                                                                                      |

## <a name="running-in-elevated-mode"></a>Запуск в режиме с повышенными правами

Любой вызов метода, который обновляет Системиндекс, требует, чтобы приложение было запущено с повышенными правами. В противном случае приложение завершится с ошибкой отказа в доступе.

## <a name="related-topics"></a>См. также


[Управление индексом](-search-3x-wds-mngidx-overview.md)

[Интерфейсы для управления индексом](interfaces-for-managing-the-index.md)

[Использование диспетчера поиска](-search-3x-wds-mngidx-searchmanager.md)

[Использование диспетчера области сканирования](-search-3x-wds-extidx-csm.md)
