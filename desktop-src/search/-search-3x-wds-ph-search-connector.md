---
description: Windows Обозреватель управляет созданием соединителя поиска для обработчика протокола с помощью записей разделов реестра. в реестре как разработчики, так и сторонние лица могут включить новые и устаревшие обработчики протоколов для участия в Windows 7 поиска.
ms.assetid: 79abdcbc-ba60-43bd-9895-18ee8b6c5829
title: Создание соединителя поиска для обработчика протокола
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cec9c7830f61c0dcbf6682e6dfaea0feb30ebfa5
ms.sourcegitcommit: 61a4c522182aa1cacbf5669683d9570a3bf043b2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/26/2021
ms.locfileid: "122881689"
---
# <a name="creating-a-search-connector-for-a-protocol-handler"></a>Создание соединителя поиска для обработчика протокола

Windows Обозреватель управляет созданием соединителя поиска для обработчика протокола с помощью записей разделов реестра. в реестре как разработчики, так и сторонние лица могут включить новые и устаревшие обработчики протоколов для участия в Windows 7 поиска.

Этот раздел организован следующим образом:

-   [сведения о соединителях поиска для обработчиков протоколов в Windows 7](#about-search-connectors-for-protocol-handlers-in-windows-7)
-   [Включение обработчиков протоколов для участия в поиске](#enabling-protocol-handlers-to-participate-in-search)
    -   [Идет отключение создания соединителя поиска для обработчика протоколов](#disabling-protocol-handler-search-connector-creation)
    -   [Настройка имени, описания или Фолдертипе для соединителя поиска обработчика протокола](#customizing-the-name-description-or-foldertype-for-a-protocol-handler-search-connector)
    -   [Использование перенаправления строк реестра](#using-registry-string-redirection)
    -   [Восстановление удаленного соединителя поиска обработчиков протоколов](#restoring-a-deleted-protocol-handler-search-connector)
-   [Дополнительные ресурсы](#additional-resources)
-   [См. также](#related-topics)

## <a name="about-search-connectors-for-protocol-handlers-in-windows-7"></a>сведения о соединителях поиска для обработчиков протоколов в Windows 7

в Windows 7 поиск в меню " **пуск** " или в обозревателе Windows включает в себя только файлы в индексируемых расположениях, а также элементы нефайловой системы, такие как удаленные хранилища данных или элементы обработчика протоколов, у которых есть соединитель поиска. В дополнение к включению элементов обработчика протоколов в области поиска в меню " **Пуск** " и "оболочка" соединитель поиска позволяет меню " **Пуск** " Группировать элементы обработчика протокола в **результатах меню "Пуск"** , в результате чего пользователь может щелкнуть заголовок группы и просмотреть результаты только из обработчика протокола. Кроме того, пользователь может перейти в папку **Поиск** , открыть файл соединителя поиска и выполнить поиск, содержащий только элементы конкретного обработчика протокола, связанного с этим соединителем поиска.

когда пользователь впервые запускает приложение, которое регистрирует обработчик протокола, Windows Explorer создает файл соединителя поиска (. сеарчконнектор-ms) для обработчика протокола в папке " **поиск** " пользователя. Приложения с обработчиками протоколов могут отключить это поведение или настроить имя и описание соединителя поиска для обработчика протокола.

> [!Note]  
> Расположение папки " **Поиск** " пользователя:% UserProfile% \\ операций поиска или FOLDERID \_ саведсеарчес. Идентификатор GUID для FOLDERID \_ саведсеарчес — {7d1d3a04-Debb-4115-95cf-2f29da2920da}.

 

Windows Обозреватель управляет созданием соединителя поиска для обработчика протокола с помощью записей разделов реестра, описанных в следующих разделах:

-   [Включение обработчиков протоколов для участия в поиске](#enabling-protocol-handlers-to-participate-in-search)
-   [Идет отключение создания соединителя поиска для обработчика протоколов](#disabling-protocol-handler-search-connector-creation)
-   [Настройка имени, описания или Фолдертипе для соединителя поиска обработчика протокола](#customizing-the-name-description-or-foldertype-for-a-protocol-handler-search-connector)
-   [Восстановление удаленного соединителя поиска обработчиков протоколов](#restoring-a-deleted-protocol-handler-search-connector)

> [!Note]  
> Нет программных средств для создания соединителя поиска для обработчика протокола. Они должны быть настроены в реестре.

 

## <a name="enabling-protocol-handlers-to-participate-in-search"></a>Включение обработчиков протоколов для участия в поиске

Разделы реестра и их возможные значения описаны в следующей таблице. Обработчик протокола может заполнить некоторые или все из этих разделов реестра, в которых &lt; протокол &gt; заменяется фактическим именем его протокола, например MAPI, File или CSC.



| Раздел реестра                                                                                                                 | Возможные значения                                                                                                                     | Type       | Комментарии                                                                                                                                                                                                                                                                                                                                                  |
|------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------|------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| HKEY \_ локальный \_ компьютер \\ программное обеспечение \\ Microsoft \\ Windows Search \\ \\ &lt; &gt; \\ версия протокола фсеарчконнекторс                     | Не существует (по умолчанию). В противном случае — 1 или больше.                                                                               | REG \_ DWORD | Это значение используется для обнаружения изменений в регистрации шаблона расположения для корней поиска, которые уже были обработаны. Если не существует, по умолчанию используется значение 0. кроме того, можно увеличить версию, чтобы сообщить Windows Explorer, что необходимо повторно создать соединитель поиска, так как установлен более новая версия обработчика протокола. |
| HKEY \_ локальный \_ компьютер \\ программное обеспечение \\ Microsoft \\ Windows поиск по \\ \\ &lt; протоколу фсеарчконнекторс &gt; \\ доноткреатесеарчконнекторс | Не существует (по умолчанию). В противном случае устанавливается значение 1.                                                                                         | REG \_ DWORD | Если он не существует, создайте файл. сеарчконнектор-MS в папке поиска. Если значение равно 1, пометьте как обработанное и не предпринимайте никаких действий.                                                                                                                                                                                                                                   |
| HKEY \_ локальный \_ компьютер \\ программное обеспечение \\ Microsoft \\ Windows поиск \\ \\ &lt; по протоколу фсеарчконнекторс &gt; \\ \\ описание        | Локализуемое строка, содержащая описание соединителя поиска.                                                              | REG \_ SZ    | Необязательный элемент. Он используется в элементе Description файла сеарчконнектор-MS.                                                                                                                                                                                                                                                                          |
| HKEY \_ локальный \_ компьютер \\ программное обеспечение \\ Microsoft \\ Windows поиск \\ \\ &lt; &gt; \\ по умолчанию для протокола фсеарчконнекторс \\               | Локализованная строка для имени соединителя поиска. Используется в качестве имени файла сеарчконнектор-MS.                                    | REG \_ SZ    | Каждое расположение должно иметь уникальное имя. При отсутствии этого значения будет использоваться отображаемое имя, предоставленное [интерфейсом ишеллфолдер](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) обработчика протокола.                                                                                                                             |
| HKEY \_ локальный \_ компьютер \\ программное обеспечение \\ Microsoft \\ Windows поиск \\ \\ &lt; по протоколу фсеарчконнекторс &gt; \\ по умолчанию \\ фолдертипе         | Идентификатор GUID, определяющий [фолдертипеид](../shell/foldertypeid.md) , применяемый к соединителю поиска. | REG \_ SZ    | Необязательный элемент. Используется в элементе Фолдертипе файла сеарчконнектор-MS для указания шаблонов, которые должны использоваться для отображения результатов. Например, значение идентификатора GUID для документов ФОЛДЕРТИПЕИД \_ .                                                                                                                                                            |



 

### <a name="disabling-protocol-handler-search-connector-creation"></a>Идет отключение создания соединителя поиска для обработчика протоколов

если приложение предоставляет элементы через обработчик протокола для использования в самом приложении и нежелательно предоставлять эти элементы через оболочку (в меню « **пуск** » и в обозревателе Windows Explorer), необходимо отключить создание соединителя поиска для обработчика протокола.

Чтобы отключить создание соединителя поиска, задайте для Доноткреатесеарчконнекторс значение 0x00000001 (1), как показано в следующем примере раздела реестра.

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows Search
            PHSearchConnectors
               <protocol>
                  DoNotCreateSearchConnectors
```

Если Доноткреатесеарчконнекторс имеет значение 1, рекомендуется предоставить свойство [System. Shell. омитфромвиев](/windows/desktop/properties/props-system-shell-omitfromview) для каждого элемента, предоставляемого обработчиком протокола, и присвоить этому свойству значение **true**. Это предотвратит отображение элементов обработчика протокола в группе **файлы** меню " **Пуск** ".

если доноткреатесеарчконнекторс имеется и имеет нулевое значение, Windows Explorer создаст соединитель поиска для обработчика протокола, и элементы обработчика протокола будут возвращены в меню " **пуск** " и в результатах поиска в обозревателе Windows.

### <a name="customizing-the-name-description-or-foldertype-for-a-protocol-handler-search-connector"></a>Настройка имени, описания или Фолдертипе для соединителя поиска обработчика протокола

Имя соединителя поиска используется не только для обнаружения соединителя поиска в папке searchs, но и для результатов поиска в **меню "** **Пуск** " в заголовке группы. Поэтому важно указать описательное имя для соединителя поиска. если в разделе реестра не указано имя, по умолчанию Windows Explorer использует имя, предоставленное [интерфейсом ишеллфолдер](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) , для корня поиска обработчика протокола и пустого описания. Имя по умолчанию можно переопределить с помощью записи раздела реестра без необходимости переименования интерфейса Ишеллфолдер. Хотя это не так видно, как имя соединителя поиска, можно также переопределить Описание соединителя поиска, предоставив собственное описание.

Чтобы переопределить имя или описание по умолчанию, задайте записи, как показано в следующем примере реестра.

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows Search
            PHSearchConnectors
               <protocol>
                  Default
                     Name
                     Description
```

Кроме того, для записи Фолдертипе можно задать один из идентификаторов GUID [фолдертипеид](../shell/foldertypeid.md) . Значение должно быть фактическим идентификатором GUID, а не именем. Например, {94d6ddcc-4A68-4175-a374-bd584a510b78}, а не ФОЛДЕРТИПЕИД \_ Music. идентификатор GUID для фолдертипеид можно получить в файле заголовка шлгуид. h в [Windows SDK](https://msdn.microsoft.com/windowsvista/bb980924.aspx).

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows Search
            PHSearchConnectors
               <protocol>
                  Default
                     FolderType = {94d6ddcc-4a68-4175-a374-bd584a510b78}
```

### <a name="using-registry-string-redirection"></a>Использование перенаправления строк реестра

Можно использовать [перенаправленную строку](../intl/using-registry-string-redirection.md) , чтобы обеспечить локализацию имени, которое вы хотите указать для соединителя поиска. Можно включить локализуемые строки в разделы реестра Name и Description вместо того, чтобы вводить фактическую строку в реестр.

Чтобы включить локализуемое строку для значений имени или описания, задайте значение, как показано в следующем примере раздела реестра.

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows Search
            PHSearchConnectors
               <protocol>
                  Name = @dllname.dll,-resourceID
```

Локализуемое строка имеет следующий формат:

-   @dllname.dll,-resourceID, где:
    -   @dllname.dll путь к библиотеке DLL, содержащей строковый ресурс.
    -   resourceID — это целочисленный идентификатор ресурса строкового ресурса.

Формат косвенной строки и косвенная строка, добавленная с помощью модификатора версии, описаны в [функции шлоадиндиректстринг](/windows/win32/api/shlwapi/nf-shlwapi-shloadindirectstring).

### <a name="restoring-a-deleted-protocol-handler-search-connector"></a>Восстановление удаленного соединителя поиска обработчиков протоколов

Так как соединители поиска являются файлами на компьютере пользователя, они могут быть удалены по ошибке. Чтобы восстановить все соединители поиска удаленных обработчиков протоколов, восстановите библиотеки по умолчанию. для этого откройте обозреватель Windows, щелкните правой кнопкой мыши папку **библиотеки** и выберите **восстановить библиотеки по умолчанию**.

![снимок экрана с командой меню "восстановить библиотеки по умолчанию"](images/libraries.png)

## <a name="additional-resources"></a>Дополнительные ресурсы

-   [Интерфейса IShellItem::/DisplayName](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellitem-getdisplayname)
-   [СИГДН \_ нормалдисплай](/windows/win32/api/shobjidl_core/ne-shobjidl_core-sigdn)

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

**Зрения**
</dt> <dt>

[Основные сведения о обработчиках протоколов](-search-3x-wds-extidx-prot-implementing.md)
</dt> <dt>

[Разработка обработчиков протоколов](-search-3x-wds-phaddins.md)
</dt> <dt>

[Уведомление индекса изменений](-search-3x-wds-notifyingofchanges.md)
</dt> <dt>

[Добавление значков и контекстных меню](-search-3x-wds-ph-ui-extensions.md)
</dt> <dt>

[Пример кода: расширения оболочки для обработчиков протоколов](-search-3x-wds-ph-ui-samplecode.md)
</dt> <dt>

[Установка и регистрация обработчиков протоколов](-search-3x-wds-ph-install-registration.md)
</dt> <dt>

[Обработчики протокола отладки](-search-ws-protocolhandlertesting.md)
</dt> </dl>

 

 
