---
description: Проводник Windows управляет созданием соединителя поиска для обработчика протокола с помощью записей разделов реестра. В реестре как разработчики, так и сторонние лица могут включать новые и устаревшие обработчики протоколов для участия в поиске Windows 7.
ms.assetid: 79abdcbc-ba60-43bd-9895-18ee8b6c5829
title: Создание соединителя поиска для обработчика протокола
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 57b43fd7eac53ca2c89d6c8b0d2cd36fd813e63a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104144173"
---
# <a name="creating-a-search-connector-for-a-protocol-handler"></a>Создание соединителя поиска для обработчика протокола

Проводник Windows управляет созданием соединителя поиска для обработчика протокола с помощью записей разделов реестра. В реестре как разработчики, так и сторонние лица могут включать новые и устаревшие обработчики протоколов для участия в поиске Windows 7.

Этот раздел организован следующим образом:

-   [Сведения о соединителях поиска для обработчиков протоколов в Windows 7](#about-search-connectors-for-protocol-handlers-in-windows-7)
-   [Включение обработчиков протоколов для участия в поиске](#enabling-protocol-handlers-to-participate-in-search)
    -   [Идет отключение создания соединителя поиска для обработчика протоколов](#disabling-protocol-handler-search-connector-creation)
    -   [Настройка имени, описания или Фолдертипе для соединителя поиска обработчика протокола](#customizing-the-name-description-or-foldertype-for-a-protocol-handler-search-connector)
    -   [Использование перенаправления строк реестра](#using-registry-string-redirection)
    -   [Восстановление удаленного соединителя поиска обработчиков протоколов](#restoring-a-deleted-protocol-handler-search-connector)
-   [Дополнительные ресурсы](#additional-resources)
-   [См. также](#related-topics)

## <a name="about-search-connectors-for-protocol-handlers-in-windows-7"></a>Сведения о соединителях поиска для обработчиков протоколов в Windows 7

В Windows 7 Поиск в меню « **Пуск** » или в проводнике Windows включает в себя только файлы в индексируемых расположениях, а также элементы нефайловой системы, такие как удаленные хранилища данных или элементы обработчика протоколов, у которых есть соединитель поиска. В дополнение к включению элементов обработчика протоколов в области поиска в меню " **Пуск** " и "оболочка" соединитель поиска позволяет меню " **Пуск** " Группировать элементы обработчика протокола в **результатах меню "Пуск"** , в результате чего пользователь может щелкнуть заголовок группы и просмотреть результаты только из обработчика протокола. Кроме того, пользователь может перейти в папку **Поиск** , открыть файл соединителя поиска и выполнить поиск, содержащий только элементы конкретного обработчика протокола, связанного с этим соединителем поиска.

Когда пользователь впервые запускает приложение, которое регистрирует обработчик протокола, проводник Windows создает файл соединителя поиска (. Сеарчконнектор-MS) для обработчика протокола в папке " **Поиск** " пользователя. Приложения с обработчиками протоколов могут отключить это поведение или настроить имя и описание соединителя поиска для обработчика протокола.

> [!Note]  
> Расположение папки " **Поиск** " пользователя:% UserProfile% \\ операций поиска или FOLDERID \_ саведсеарчес. Идентификатор GUID для FOLDERID \_ саведсеарчес — {7d1d3a04-Debb-4115-95cf-2f29da2920da}.

 

Проводник Windows управляет созданием соединителя поиска для обработчика протокола с помощью записей разделов реестра, описанных в следующих разделах:

-   [Включение обработчиков протоколов для участия в поиске](#enabling-protocol-handlers-to-participate-in-search)
-   [Идет отключение создания соединителя поиска для обработчика протоколов](#disabling-protocol-handler-search-connector-creation)
-   [Настройка имени, описания или Фолдертипе для соединителя поиска обработчика протокола](#customizing-the-name-description-or-foldertype-for-a-protocol-handler-search-connector)
-   [Восстановление удаленного соединителя поиска обработчиков протоколов](#restoring-a-deleted-protocol-handler-search-connector)

> [!Note]  
> Нет программных средств для создания соединителя поиска для обработчика протокола. Они должны быть настроены в реестре.

 

## <a name="enabling-protocol-handlers-to-participate-in-search"></a>Включение обработчиков протоколов для участия в поиске

Разделы реестра и их возможные значения описаны в следующей таблице. Обработчик протокола может заполнить некоторые или все из этих разделов реестра <protocol> , где заменяется фактическим именем его протокола, например MAPI, File или CSC.



| Раздел реестра                                                                                                                 | Возможные значения                                                                                                                     | Тип       | Комментарии                                                                                                                                                                                                                                                                                                                                                  |
|------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------|------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| HKey \_ локальный \_ компьютер \\ программное обеспечение \\ Microsoft \\ Windows Search \\ фсеарчконнекторс \\ <protocol> \\ версия                     | Не существует (по умолчанию). В противном случае — 1 или больше.                                                                               | REG \_ DWORD | Это значение используется для обнаружения изменений в регистрации шаблона расположения для корней поиска, которые уже были обработаны. Если не существует, по умолчанию используется значение 0. Кроме того, можно увеличить версию, чтобы сообщить проводнику Windows о необходимости повторного создания соединителя поиска, поскольку установлен более новая версия обработчика протокола. |
| HKey \_ локальный \_ компьютер \\ программное обеспечение \\ Microsoft \\ Windows Search \\ фсеарчконнекторс \\ <protocol> \\ доноткреатесеарчконнекторс | Не существует (по умолчанию). В противном случае устанавливается значение 1.                                                                                         | REG \_ DWORD | Если он не существует, создайте файл. сеарчконнектор-MS в папке поиска. Если значение равно 1, пометьте как обработанное и не предпринимайте никаких действий.                                                                                                                                                                                                                                   |
| HKey \_ локальный \_ компьютер \\ программное обеспечение \\ Microsoft \\ Windows Search \\ фсеарчконнекторс \\ <protocol> \\ Описание по умолчанию \\        | Локализуемое строка, содержащая описание соединителя поиска.                                                              | REG \_ SZ    | Необязательный элемент. Он используется в элементе Description файла сеарчконнектор-MS.                                                                                                                                                                                                                                                                          |
| HKey \_ локальный \_ компьютер \\ программное обеспечение \\ Microsoft \\ Windows Search \\ фсеарчконнекторс \\ <protocol> \\ имя по умолчанию \\               | Локализованная строка для имени соединителя поиска. Используется в качестве имени файла сеарчконнектор-MS.                                    | REG \_ SZ    | Каждое расположение должно иметь уникальное имя. При отсутствии этого значения будет использоваться отображаемое имя, предоставленное [интерфейсом ишеллфолдер](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) обработчика протокола.                                                                                                                             |
| HKey \_ локальный \_ компьютер \\ программное обеспечение \\ Microsoft \\ Windows Search \\ фсеарчконнекторс \\ <protocol> \\ по умолчанию \\ фолдертипе         | Идентификатор GUID, определяющий [фолдертипеид](../shell/foldertypeid.md) , применяемый к соединителю поиска. | REG \_ SZ    | Необязательный элемент. Используется в элементе Фолдертипе файла сеарчконнектор-MS для указания шаблонов, которые должны использоваться для отображения результатов. Например, значение идентификатора GUID для документов ФОЛДЕРТИПЕИД \_ .                                                                                                                                                            |



 

### <a name="disabling-protocol-handler-search-connector-creation"></a>Идет отключение создания соединителя поиска для обработчика протоколов

Если приложение предоставляет элементы через обработчик протокола для использования в самом приложении и нежелательно предоставлять эти элементы через оболочку (в меню « **Пуск** » и в проводнике Windows), необходимо отключить создание соединителя поиска для обработчика протокола.

Чтобы отключить создание соединителя поиска, задайте для Доноткреатесеарчконнекторс значение 0x00000001 (1), как показано в следующем примере раздела реестра.

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows Search
            PHSearchConnectors
               <protocol>
                  DoNotCreateSearchConnectors
```

Если Доноткреатесеарчконнекторс имеет значение 1, рекомендуется предоставить свойство [System. Shell. омитфромвиев](/windows/desktop/properties/props-system-shell-omitfromview) для каждого элемента, предоставляемого обработчиком протокола, и присвоить этому свойству значение **true**. Это предотвратит отображение элементов обработчика протокола в группе **файлы** меню " **Пуск** ".

Если Доноткреатесеарчконнекторс имеется и имеет значение 0, проводник Windows создаст соединитель поиска для обработчика протокола, а элементы обработчика протокола будут возвращены в меню " **Пуск** " и в результатах поиска проводника Windows.

### <a name="customizing-the-name-description-or-foldertype-for-a-protocol-handler-search-connector"></a>Настройка имени, описания или Фолдертипе для соединителя поиска обработчика протокола

Имя соединителя поиска используется не только для обнаружения соединителя поиска в папке searchs, но и для результатов поиска в **меню "** **Пуск** " в заголовке группы. Поэтому важно указать описательное имя для соединителя поиска. Если в разделе реестра не указано имя, по умолчанию проводник Windows использует имя, предоставленное [интерфейсом ишеллфолдер](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder) , для корня поиска обработчика протокола и пустого описания. Имя по умолчанию можно переопределить с помощью записи раздела реестра без необходимости переименования интерфейса Ишеллфолдер. Хотя это не так видно, как имя соединителя поиска, можно также переопределить Описание соединителя поиска, предоставив собственное описание.

Чтобы переопределить имя или описание по умолчанию, задайте записи, как показано в следующем примере реестра.

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows Search
            PHSearchConnectors
               <protocol>
                  Default
                     Name
                     Description
```

Кроме того, для записи Фолдертипе можно задать один из идентификаторов GUID [фолдертипеид](../shell/foldertypeid.md) . Значение должно быть фактическим идентификатором GUID, а не именем. Например, {94d6ddcc-4A68-4175-a374-bd584a510b78}, а не ФОЛДЕРТИПЕИД \_ Music. Идентификатор GUID для ФОЛДЕРТИПЕИД можно получить в файле заголовка Шлгуид. h в [Windows SDK](https://msdn.microsoft.com/windowsvista/bb980924.aspx).

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows Search
            PHSearchConnectors
               <protocol>
                  Default
                     FolderType = {94d6ddcc-4a68-4175-a374-bd584a510b78}
```

### <a name="using-registry-string-redirection"></a>Использование перенаправления строк реестра

Можно использовать [перенаправленную строку](../intl/using-registry-string-redirection.md) , чтобы обеспечить локализацию имени, которое вы хотите указать для соединителя поиска. Можно включить локализуемые строки в разделы реестра Name и Description вместо того, чтобы вводить фактическую строку в реестр.

Чтобы включить локализуемое строку для значений имени или описания, задайте значение, как показано в следующем примере раздела реестра.

```
HKEY_LOCAL_MACHINE
   Software
      Microsoft
         Windows Search
            PHSearchConnectors
               <protocol>
                  Name = @dllname.dll,-resourceID
```

Локализуемое строка имеет следующий формат:

-   @dllname.dll,-resourceID, где:
    -   @dllname.dll путь к библиотеке DLL, содержащей строковый ресурс.
    -   resourceID — это целочисленный идентификатор ресурса строкового ресурса.

Формат косвенной строки и косвенная строка, добавленная с помощью модификатора версии, описаны в [функции шлоадиндиректстринг](/windows/win32/api/shlwapi/nf-shlwapi-shloadindirectstring).

### <a name="restoring-a-deleted-protocol-handler-search-connector"></a>Восстановление удаленного соединителя поиска обработчиков протоколов

Так как соединители поиска являются файлами на компьютере пользователя, они могут быть удалены по ошибке. Чтобы восстановить все соединители поиска удаленных обработчиков протоколов, восстановите библиотеки по умолчанию. Для этого откройте проводник Windows, щелкните правой кнопкой мыши папку **библиотеки** и выберите **восстановить библиотеки по умолчанию**.

![снимок экрана с командой меню "восстановить библиотеки по умолчанию"](images/libraries.png)

## <a name="additional-resources"></a>Дополнительные ресурсы

-   [Интерфейса IShellItem::/DisplayName](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ishellitem-getdisplayname)
-   [СИГДН \_ нормалдисплай](/windows/win32/api/shobjidl_core/ne-shobjidl_core-sigdn)

## <a name="related-topics"></a>См. также

<dl> <dt>

**Зрения**
</dt> <dt>

[Основные сведения о обработчиках протоколов](-search-3x-wds-extidx-prot-implementing.md)
</dt> <dt>

[Разработка обработчиков протоколов](-search-3x-wds-phaddins.md)
</dt> <dt>

[Уведомление индекса изменений](-search-3x-wds-notifyingofchanges.md)
</dt> <dt>

[Добавление значков и контекстных меню](-search-3x-wds-ph-ui-extensions.md)
</dt> <dt>

[Пример кода: расширения оболочки для обработчиков протоколов](-search-3x-wds-ph-ui-samplecode.md)
</dt> <dt>

[Установка и регистрация обработчиков протоколов](-search-3x-wds-ph-install-registration.md)
</dt> <dt>

[Обработчики протокола отладки](-search-ws-protocolhandlertesting.md)
</dt> </dl>

 

 
