---
description: Результаты запроса включают строки, возвращаемые запросом, и значение ранга для каждой строки, если столбец Rank включен в предложение SELECT.
ms.assetid: 8655eec4-5151-4f82-b485-4dbef947df0d
title: РАНЖИРОВАНие по предложению
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 33daf4865b0f7f08689802822d8c0d5b4d38702a1cb1f813563564e001811a6e
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118462443"
---
# <a name="rank-by-clause"></a>РАНЖИРОВАНие по предложению

Результаты запроса включают строки, возвращаемые запросом, и значение ранга для каждой строки, если столбец Rank включен в предложение SELECT. Значения ранжирования рассчитываются поисковой системой и возвращаются в виде целых чисел в диапазоне от 0 до 1000. Чтобы повысить осмысленность результатов ранжирования, запрос может управлять вычислением необработанных значений ранжирования в предложении RANK BY.

Этот раздел организован следующим образом:

-   [РАНЖИРОВАНие по предложению](#rank-by-clause)
-   [WEIGHT, функция](#weight-function)
-   [Функция ПРИВЕДЕНия](#coercion-function)

## <a name="rank-by-clause"></a>РАНЖИРОВАНие по предложению

Синтаксис для предложения RANK BY выглядит следующим образом:


```
WHERE ( <search_condition> ) 
RANK BY [ ( ] <rank_specification> [ ) ]
```



Предложение RANK BY применяется к \_ условию поиска, непосредственно предшествующему ему, фактически задающему более низкий или более высокий ранг строк, возвращаемых условием поиска, чем строки, возвращенные другим условием поиска. Обязательные круглые скобки, окружающие \_ условие поиска. Круглые скобки, окружающие спецификацию ранга, являются необязательными.

К одному условию можно применить более одного предложения RANK BY. Дополнительные предложения RANK можно включить один за другим с помощью круглых скобок.

> [!Note]  
> Полнотекстовые предикаты возвращают значения ранга в диапазоне от 0 до 1000. Значения ранга для всех документов, совпадающих с неполнотекстовым предикатом, — 1000. Изменения ранговых значений должны учитывать эти сведения.

 

Спецификация Rank в \_ предложении ранкби определяет одну или несколько функций, применяемых к значениям ранга. Функция WEIGHT применяет множитель к необработанному значению ранга для возвращаемой строки. Чем меньше множитель, тем меньше результирующее значение ранга. Функцию ПРИВЕДЕНия можно использовать для умножения, добавления в или задания определенного значения ранга для возвращаемой строки. Каждая спецификация ранжирования может включать либо нуль, либо одну функцию веса, а также ноль или более функций ПРИВЕДЕНия. Если в предложении РАНЖИРОВАНия включены функции веса и ПРИВЕДЕНия, функция WEIGHT должна быть первой.

## <a name="weight-function"></a>WEIGHT, функция

Синтаксис функции WEIGHT:


```
WEIGHT ( <weight_multipler> ) 
```



Множитель должен быть десятичным числом от 0,001 до 1,000. Необработанное значение ранга, возвращаемое предикатом условия поиска, умножается на коэффициент веса, чтобы задать новое значение ранга.

В следующем примере функция WEIGHT предоставляет документам слово «Сереса» в System.Docумент. Ластаусор поле половины значение ранга документов с "Сереса" в поле System. author:


```
WHERE CONTAINS ( System.Author,'"Theresa"' ) 
         RANK BY WEIGHT ( 1.000 )
      OR
      CONTAINS ( System.Document.LastAuthor,'"Theresa"' ) 
         RANK BY WEIGHT ( 0.500 ) 
```



 

> [!Note]  
> Функции взвешивания столбцов предикатов CONTAINS и FREETEXT поддерживают сокращенный формат с помощью двоеточия между поисковым условием и множителем ("программное обеспечение": 0,25). Предложение RANK BY не поддерживает сокращенную форму.

 

При использовании РАНЖИРОВАНия по ВЕСУ существует ограничение: оно не работает с предложениями CONTAINS, которые используют логические условия. Например, следующий пример не разрешен:


```
CONTAINS ( System.Author,'"Theresa" OR "Teresa"' ) RANK BY WEIGHT ( 0.400 )
```



## <a name="coercion-function"></a>Функция ПРИВЕДЕНия

Функцию приведения рангов можно использовать для изменения возвращаемого значения ранга путем сложения или умножения или присвоения ему определенного значения.

Синтаксис функции ПРИВЕДЕН ниже.


```
COERCION ( <coercion_operation> , <coercion_value> )
```



Значение приведения является целочисленным значением.

В следующей таблице описаны доступные параметры операции приведения.



| Операция приведения | Описание                                                                                    | Диапазон значений  |
|--------------------|------------------------------------------------------------------------------------------------|--------------|
| ABSOLUTE           | Возвращаемое значение ранга — это значение, указанное в значении приведения.                          | от 0 до 1000    |
| ADD                | Возвращаемое значение ранга является суммой необработанного значения ранга и указанного значения приведения.     | от 0,001 до 1,0 |
| MULTIPLY           | Возвращаемое значение ранга — это произведение необработанного значения ранга и указанного значения приведения. | от 0,001 до 1,0 |



 

 

> [!IMPORTANT]
> Поиск может возвращать значения ранга только в диапазоне от 0 до 1000.

 

 

В следующем примере функция ПРИВЕДЕНия используется для установки для всех документов с именем "Computer", равным 1000, при сокращении на один квартал ранг документов, содержащих как "Computer", так и "программное обеспечение" в заголовке.


```
WHERE CONTAINS ( System.Title, 'computer' )
        RANK BY COERCION ( ABSOLUTE , 1000 )
        OR 
       CONTAINS ( System.Title, '"computer" AND "software"' )
        RANK BY COERCION ( MULTIPLY, 0.750 ) 
```



 

 



