---
description: чтобы индексировать содержимое и свойства новых форматов файлов и хранилищ данных, Microsoft Windows Search должен быть расширен с помощью надстроек.
ms.assetid: 04ddcd97-c358-44d2-9092-a035436c50c9
title: Windows Search как платформа разработки
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 19041ac23c90006cc2f1b2f6146cb20a6b972fc2
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127363316"
---
# <a name="windows-search-as-a-development-platform"></a>Windows Search как платформа разработки

чтобы индексировать содержимое и свойства новых форматов файлов и хранилищ данных, Microsoft Windows Search должен быть расширен с помощью надстроек.

прежде чем сторонние разработчики новых форматов файлов и хранилищ данных смогут получить эти форматы и хранилища в результатах запроса в Windows Explorer, разработчик должен выполнить три следующих действия:

-   Реализуйте источник данных оболочки для расширения пространства имен оболочки.
-   Предоставляйте элементы в хранилище данных (если они добавляют новое хранилище данных, так как их необходимо проиндексировать).
-   разрабатывайте обработчик протокола, чтобы Windows поиск мог получить доступ к данным для индексирования.

Этот раздел организован следующим образом:

-   [Начало работы](#getting-started)
-   [Общие сведения о сценариях разработки для поиска](#overview-of-search-development-scenarios)
    -   [Добавление нового хранилища данных](#adding-a-new-data-store)
    -   [Добавление нового формата файла](#adding-a-new-file-format)
    -   [использование результатов поиска Windows](#consuming-windows-search-results)
-   [Общие сведения о обработчиках](#overview-of-handlers)
-   [Рекомендации по установщику для надстройки](#add-in-installer-guidelines)
-   [Примечание для разработчиков](#note-to-implementers)
-   [Дополнительные ресурсы](#additional-resources)
-   [Связанные темы](#related-topics)

## <a name="getting-started"></a>Начало работы

прежде чем приступить к созданию приложения поиска Windows, помните, что предпочтительным способом сделать это с помощью источника данных оболочки. Источник данных оболочки расширяет пространство имен оболочки и предоставляет элементы в хранилище данных. элементы в хранилище данных могут индексироваться системой поиска Windows с помощью обработчика протокола. этот непрямой подход к доступу Windows поиска путем реализации источника данных оболочки является предпочтительным, так как он обеспечивает доступ к полной функциональности оболочки. Это позволяет обеспечить разумное взаимодействие с пользователем.

если необходимо, чтобы результаты запроса отображались в Windows Explorer, необходимо реализовать источник данных оболочки, прежде чем можно будет создать обработчик протокола для расширения индекса. Однако, если все запросы будут программно (например, OLE DB) и интерпретироваться кодом приложения, а не оболочкой, пространство имен оболочки по-прежнему является предпочтительным, но не является обязательным.

обработчик протокола необходим для Windows получения сведений о содержимом файла, например о элементах в базах данных или пользовательских типах файлов. хотя Windows поиск может индексировать имя и свойства файла, Windows не имеет сведений о содержимом файла. в результате такие элементы нельзя индексировать или предоставлять в оболочке Windows. Реализуя пользовательский обработчик протокола, вы можете предоставить эти элементы. Список обработчиков, определяемых сценарием разработчика, которые вы пытаетесь достичь, см. в разделе [Обзор обработчиков](#overview-of-handlers).

## <a name="overview-of-search-development-scenarios"></a>Общие сведения о сценариях разработки для поиска

ниже перечислены наиболее распространенные сценарии разработки Windows поиска.

-   [Добавление нового хранилища данных](#adding-a-new-data-store)
-   [Добавление нового формата файла](#adding-a-new-file-format)
-   [использование результатов поиска Windows](#consuming-windows-search-results)

### <a name="adding-a-new-data-store"></a>Добавление нового хранилища данных

хранилище данных оболочки необходимо для Windows поиска, только если вы добавляете новое хранилище данных для индексирования. Хранилище данных — это репозиторий данных, которые могут быть предоставлены модели программирования оболочки в качестве контейнера с помощью источника данных оболочки. затем элементы в хранилище данных могут индексироваться системой поиска Windows с помощью обработчика протокола. Обработчик протокола реализует протокол для доступа к источнику содержимого в собственном формате. Интерфейсы [**исеарчпротокол**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol) и [**ISearchProtocol2**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol2) используются для реализации пользовательского обработчика протокола, чтобы расширить источники данных, которые могут быть проиндексированы. Сведения о создании источника данных оболочки см. в разделе [реализация базовых интерфейсов объекта папки](/previous-versions/windows/desktop/legacy/cc144093(v=vs.85)).

### <a name="adding-a-new-file-format"></a>Добавление нового формата файла

При добавлении нового пользовательского формата файла необходимо разработать обработчик фильтра или обработчик свойства, но не то и другое. Фильтр является реализацией интерфейса [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) . Он открывает файлы определенного типа, а также фильтрует свойства и фрагменты текста для индексатора. Фильтры связаны с типами файлов, как отмечены расширениями имен файлов, типами MIME или идентификаторами классов (CLSID). Хотя один фильтр может работать с несколькими типами файлов, каждый тип файлов работает только с одним фильтром.

обработчик свойств преобразует данные, хранящиеся в файле, в структурированную схему, которая распознается и доступна для Windows Explorer, Windows поиска и других приложений. Затем эти системы могут взаимодействовать с обработчиком свойств для записи и чтения свойств в файл и из него. Переведенные данные включают в себя представление Details, инфотипс, область сведений, страницы свойств и т. д. Каждый обработчик свойств связан с определенным типом файла, определяемым расширением имени файла. Для этого необходим обработчик свойства.

-   Отображение свойств неиндексированного элемента в пользовательском интерфейсе.
-   Поддержка записи свойств.

### <a name="consuming-windows-search-results"></a>использование результатов поиска Windows

в следующих разделах описаны несколько способов использования Windows результатов поиска.

-   [Запрос данных](#querying-data)
-   [Запрос к удаленным хранилищам данных (федеративный поиск)](#querying-remote-data-stores-federated-search)
-   [Индексирование файлов и элементов](#indexing-files-and-items)
-   [Индексирование хранилища данных](#indexing-a-data-store)
-   [Управление процессом индексирования](#managing-the-indexing-process)
-   [интеграция системы свойств Windows с приложениями поиска Windows](#integrating-the-windows-property-system-with-windows-search-applications)

### <a name="querying-data"></a>Запросы к данным

разработчики, которые пишут приложения поверх объединенных Windows поиска и Windows системы свойств могут получать доступ к файлам и элементам независимо от типа приложения или файла. Существуют два способа доступа приложений к данным индексатора.

-   приложения напрямую взаимодействуют с OLE DB, отправляя Windows поиска язык SQL (SQL) в поставщик Windows поиска OLE DB для получения результатов. запросы могут быть созданы вручную или с помощью интерфейса [**исеарчкуерихелпер**](/windows/win32/api/Searchapi/nn-searchapi-isearchqueryhelper) для создания SQL из ключевых слов поиска и расширенного синтаксиса запросов (акс).
-   Приложения работают на уровне оболочки. Преимущество уровня оболочки заключается в том, что он также поддерживает другие источники, такие как grep. Однако недостаток заключается в том, что не все функции индексатора доступны.

другой вариант — использовать протоколы search-ms://и search://, которые выполняют поиск на основе URL-адресов с помощью обозревателя Windows. Этот параметр обеспечивает очень тонкую разработку, но не возвращает результаты или выбор пользователей из представления результатов в вызывающее приложение. Кроме того, как и другие протоколы, сторонние приложения поиска могут использовать протоколы Search-MS://и search://, если приложения соответствуют требуемому набору функций. дополнительные сведения о запросах см. [в разделе обработка запросов в Windows поиск](querying-process--windows-search-.md) и [запрос индекса программным способом](-search-3x-wds-qryidx-overview.md).

### <a name="querying-remote-data-stores-federated-search"></a>Запрос к удаленным хранилищам данных (федеративный поиск)

в Windows 7 и более поздних версиях федеративный поиск предлагает новый поставщик поиска, который запрашивает удаленные хранилища данных через веб-серверы через протокол [OpenSearch](https://github.com/dewitt/opensearch) и перечисляет результаты в виде XML-каналов RSS или Atom. Соединители поиска — это соединения пространств имен, имитирующие поведение папки с помощью поставщика поиска. дополнительные сведения о федерации поиска с удаленными хранилищами данных в Windows 7 см. [в разделе федеративный поиск в Windows](-search-federated-search-overview.md).

### <a name="indexing-files-and-items"></a>Индексирование файлов и элементов

индексируемое содержимое основано на файлах и типах данных, поддерживаемых в надстройках, включенных в Windows поиска, а также правилах включения и исключения по умолчанию для папок в файловой системе. например, фильтры, включенные в windows Search, поддерживают более 200 распространенных типов данных, включая документы Microsoft Office, Microsoft Outlook электронной почте (в сочетании с обработчиком протокола MAPI), обычные текстовые файлы, HTML и многие другие. Полный список типов файлов, которые поддерживаются изначально, см. в разделе [что входит в индекс](-search-3x-wds-included-in-index.md).

индекс можно расширить с помощью обработчиков свойств и фильтров для предоставления содержимого и свойств новых форматов файлов индексу и Windows Explorer. Фильтры являются реализацией интерфейса [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter) . Существует два вида фильтров: один, взаимодействующий с отдельными элементами, такими как файлы, и другой, взаимодействующий с контейнерами, такими как папки. Фильтры являются многозначными в том смысле, что они поддерживают Фрагментирование данных, текстовое содержимое, некоторые свойства и несколько языков.

Напротив, обработчики свойств имеют более конкретную цель: для предоставления свойств определенных типов файлов, определяемых расширениями имен файлов. Обработчик свойства для типа файла может включать свойства Get и Set, а также может перечислить свойства, связанные с этим типом файла. В отличие от фильтров обработчики свойств не поддерживают чуккинг данные или текстовое содержимое, а обработчики свойств не могут определить, в каком языке находится свойство текста, если только они не поддерживают запись свойств.

### <a name="indexing-a-data-store"></a>Индексирование хранилища данных

Индекс можно расширить с помощью обработчиков протоколов, чтобы обеспечить доступ к собственным хранилищам данных. Например, для файлов и элементов, содержащихся в хранилищах данных, отличных от файловой системы (например, в базах данных и хранилищах электронной почты), требуется, чтобы обработчик протокола сопоставлялся с URL-адреса в поток. Обработчики протоколов также могут определить правильные фильтры, используемые для извлечения информации из потока. Фильтры перечисляет URL-адреса хранилища данных. После этого элементы по отдельности индексируются с помощью надлежащего фильтра и обработчика свойств. Дополнительные сведения см. [в разделе Расширение индекса](-search-3x-wds-extidx-overview.md).

### <a name="managing-the-indexing-process"></a>Управление процессом индексирования

разработчики приложений могут управлять областью и частотой индексирования Windows поиска с помощью различных интерфейсов управления. Эти интерфейсы включают в себя функции добавления и удаления каталогов, которые индексатор проверяет на наличие изменений, вручную уведомляет индекс изменений данных, проверяет состояние индексатора и принудительную повторную индексацию некоторых или всех данных. Дополнительные сведения см. [в разделе Управление индексом](-search-3x-wds-mngidx-overview.md).

### <a name="integrating-the-windows-property-system-with-windows-search-applications"></a>интеграция системы свойств Windows с приложениями поиска Windows

система свойств Windows — это расширяемая система чтения и записи определений данных, которая обеспечивает единообразный способ представления метаданных об элементах оболочки. система свойств Windows в Windows Vista и более поздних версий позволяет хранить и извлекать метаданные для элементов оболочки. Элемент оболочки — это любой отдельный фрагмент содержимого, например файл, папка, электронная почта или контакт. Свойство — это отдельный элемент метаданных, связанный с элементом оболочки. Значения свойств выражаются в виде структуры [**пропвариант**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant) .

Широкий список общих свойств включается для ряда распространенных типов элементов, таких как фотографии, музыка, документы, сообщения, контакты и файлы. Разработчики также могут вводить собственные свойства платформы, если ни одно из существующих свойств не соответствует их потребностям. дополнительные сведения об интеграции приложений с системой свойств Windows см. в разделе [разработка обработчиков свойств](-search-3x-wds-extidx-propertyhandlers.md).

## <a name="overview-of-handlers"></a>Общие сведения о обработчиках

Обработчик — это объект модели COM, предоставляющий функциональные возможности для элемента оболочки. Большинство источников данных оболочки предлагают расширяемую систему для привязки обработчиков к элементам. Например, папка «файловая система» использует систему взаимосвязей для поиска обработчиков определенного типа файлов. Для каждого типа файлов требуется специальный обработчик. Для типа файла Adobe Acrobat .pdf требуется один обработчик фильтра, например, для формата файла .doc требуется другой обработчик фильтра и т. д.

Разные обработчики имеют определенную унифицированность. в Windows Vista и более поздних версиях все обработчики должны использовать один из следующих интерфейсов для инициализации обработчика: [**IInitializeWithStream**](/windows/win32/api/propsys/nn-propsys-iinitializewithstream), [**иинитиализевиситем**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iinitializewithitem)или [**иитинитиализевисфиле**](/windows/win32/api/propsys/nn-propsys-iinitializewithfile).

В следующей таблице перечислены задачи разработчика высокого уровня, тип обработчика, необходимый для каждой задачи, а также ссылка на концептуальную информацию о том, как выполнять каждую задачу.



| Задача                                                                                                                                                            | Обработчик                          | Концептуальные сведения                                                                                                                                                                                 |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Доступ к свойствам файла для индексирования                                                                                                                 | Обработчик свойства                 | [Разработка обработчиков свойств](-search-3x-wds-extidx-propertyhandlers.md)<br/> [Определяемые системой свойства для пользовательских форматов файлов](-shell-systemdefinedpropertiesforfileformats.md)<br/> |
| Добавление форматов буфера обмена для объекта данных ([**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject)) элемента (объекты данных используются в сценариях перетаскивания и копирования и вставки). | Обработчик объекта данных              | [Создание обработчиков данных](/previous-versions/windows/desktop/legacy/cc144163(v=vs.85))                                                                                                                                                          |
| Добавление команд для элемента, который обычно отображается в контекстном меню                                                                                         | Обработчик контекстного меню            | [Создание обработчиков контекстного меню](../shell/context-menu-handlers.md)<br/> [Настройка контекстного меню с помощью динамических команд](../shell/shortcut-menu-using-dynamic-verbs.md)<br/>                         |
| Связывание типа файла с указанным значком                                                                                                                    | Обработчик значков                     | [Создание обработчиков значков](../shell/how-to-create-icon-handlers.md)                                                                                                                                                          |
| Создание страниц свойств с изображениями и элементами управления пользовательского интерфейса, которые допускают пользовательское взаимодействие с типом файла                                                          | Обработчик страницы свойств           | [Обработчики страницы свойств](/previous-versions/windows/desktop/legacy/cc144106(v=vs.85))                                                                                                                                                    |
| Включение типа элемента для поддержки сценариев перетаскивания и копирования и вставки                                                                                         | Удалить обработчик                     | [Передача объектов оболочки с помощью перетаскивания и буфера обмена](/previous-versions/windows/desktop/legacy/bb776905(v=vs.85))                                                                                                                      |
| Извлечение фрагментов текста и свойств документа для индексирования                                                                                                  | Обработчик фильтра                   | [Разработка обработчиков фильтров](-search-ifilter-conceptual.md)                                                                                                                                           |
| Индексирование нового типа файла                                                                                                                                        | Обработчик фильтра, обработчик свойств | [Разработка обработчиков фильтров](-search-ifilter-conceptual.md)<br/> [Разработка обработчиков свойств](-search-3x-wds-extidx-propertyhandlers.md)<br/>                                          |
| Индексирование содержимого хранилища данных                                                                                                                           | Обработчик протокола                 | [Разработка обработчиков протоколов](-search-3x-wds-phaddins.md)                                                                                                                                            |
| предварительный просмотр упрощенного представления элемента оболочки на панели предварительного просмотра Windows Explorer                                                                             | Обработчик просмотра                  | [Обработчики просмотра](../shell/preview-handlers.md)                                                                                                                                                             |
| Предоставление всплывающего текста при наведении указателя мыши на объект пользовательского интерфейса                                                                                                      | Обработчик подсказок                  | [Создание обработчиков расширений оболочки](../shell/handlers.md) (Настройка всплывающих подсказков)                                                                                                                            |
| Предоставление статического изображения для представления элемента оболочки                                                                                                              | Обработчик эскизов                | [Обработчики эскизов](/previous-versions/windows/desktop/legacy/cc144118(v=vs.85))                                                                                                                                                        |



 

В следующей таблице перечислены обработчики и интерфейсы для реализации каждого типа обработчика.



| Обработчик                | Интерфейсы                                                                                                                                                                                                                                                                                                                                                                |
|------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Удалить обработчик           | [**Интерфейс IDropTarget**](/windows/win32/api/oleidl/nn-oleidl-idroptarget), [**идроптаржеселпер**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-idroptargethelper), [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile), [**ишеллекстинит**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit)                                                                                                                                                                                                      |
| Обработчик объекта данных    | [**IDataObject**](/windows/win32/api/objidl/nn-objidl-idataobject), [ **IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile)                                                                                                                                                                                                                                                                                                  |
| Обработчик фильтра         | [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter)<br/>                                                                                                                                                                                                                                                                                                                             |
| Обработчик значков           | [**иекстрактикон**](/windows/win32/api/shlobj_core/nn-shlobj_core-iextracticona)<br/> Необязательно: [**IPersist**](/windows/win32/api/objidl/nn-objidl-ipersist), [**IPersistFile**](/windows/win32/api/objidl/nn-objidl-ipersistfile)<br/>                                                                                                                                                                                                                                 |
| Обработчик подсказок        | [**икуеринфо**](/windows/win32/api/shlobj_core/nn-shlobj_core-iqueryinfo)                                                                                                                                                                                                                                                                                                                                        |
| Обработчик просмотра        | [**IPreviewHandler**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipreviewhandler)                                                                                                                                                                                                                                                                                                                              |
| Обработчик свойства       | [**ипропертисторе**](/windows/win32/api/propsys/nn-propsys-ipropertystore)                                                                                                                                                                                                                                                                                                                           |
| Обработчик протокола       | [**IFilter**](/windows/win32/api/filter/nn-filter-ifilter), [**исеарчпротокол**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol), [**иурлакцессор**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor)<br/> Необязательно: [**ISearchProtocol2**](/windows/win32/api/Searchapi/nn-searchapi-isearchprotocol2), [**IUrlAccessor2**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor2), [**IUrlAccessor3**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor3), [**IUrlAccessor4**](/windows/win32/api/Searchapi/nn-searchapi-iurlaccessor4)<br/> |
| Обработчик страницы свойств | [**Ишеллекстинит**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit), [ **ишеллпропшитекст**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellpropsheetext)                                                                                                                                                                                                                                                                              |
| Обработчик контекстного меню  | [**IContextMenu**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-icontextmenu), [**иексплореркомманд**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-iexplorercommand), [**ишеллекстинит**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellextinit)                                                                                                                                                                                                                                          |
| Обработчик эскизов      | [**исумбнаилпровидер**](/windows/win32/api/thumbcache/nn-thumbcache-ithumbnailprovider)                                                                                                                                                                                                                                                                                                                        |



 

> [!Note]  
> Обработчик свойств иногда ковн как обработчик метаданных. Источник данных оболочки иногда называют расширением пространства имен оболочки. Обработчик типа файлов иногда называют обработчиком расширения оболочки или расширением оболочки.

 

Дополнительные сведения о создании обработчиков см. в разделе [Создание обработчиков расширений оболочки](../shell/handlers.md). дополнительные сведения о свойствах см. в разделе [система свойств Windows](../properties/windows-properties-system.md).

## <a name="add-in-installer-guidelines"></a>Рекомендации по установщику для надстройки

При создании установщика надстройки следуйте приведенным ниже рекомендациям.

-   Установщик должен использовать установщик EXE или MSI.
-   Необходимо указать заметки о выпуске.
-   Для каждой установленной надстройки необходимо создать запись « **Установка и удаление программ** ».
-   Установщик должен задействовать все параметры реестра для конкретного типа файлов или хранить данные, распознаваемые текущей надстройкой.
-   Если предыдущая надстройка перезаписывается, установщик должен уведомить пользователя.
-   Если более новая надстройка перезаписала предыдущую надстройку, пользователь должен иметь возможность восстановить функциональность предыдущей надстройки и сделать ее надстройкой по умолчанию для этого типа файлов или хранилища.

## <a name="note-to-implementers"></a>Примечание для разработчиков

Перед созданием фильтра или обработчика свойств разработчики должны учитывать следующее:

-   эти обработчики являются встроенными расширениями, которые загружаются в неуправляемые процессы, такие как процесс управляющей программы фильтрации, Windows Explorer (поиск grep) и сторонние узлы, такие как Windows почта).
-   Необходимо написать безопасный код, который достаточно надежен для выполнения произвольного повреждения форм формата файлов, созданных для атаки на систему.
-   Надстройка не должна утечек ресурсов, которые будут вызывать проблемы для ведущих процессов.
-   Надстройка не должна завершаться сбоем, так как это также приведет к сбою хост-процесса и замедлить процесс фильтрации.
-   Поскольку эти обработчики выполняются в фоновом системном процессе, они должны быстро выполняться с минимальным объемом ресурсов ЦП и операций ввода-вывода, чтобы удовлетворить требования к производительности системы.

Таким же разработчикам нужно написать эти надстройки с опытом создания кода системного уровня.

## <a name="additional-resources"></a>Дополнительные ресурсы

-   Сведения о создании источника данных оболочки см. в разделе [реализация базовых интерфейсов объекта папки](/previous-versions/windows/desktop/legacy/cc144093(v=vs.85)).
-   Сведения об источниках данных, которые должны использовать объект представления системной папки по умолчанию (Дефвиев) оболочки, см. в разделе [Реализация представления папок](../lwef/nse-folderview.md), функции [**шкреатешеллфолдервиев**](/windows/win32/api/shlobj_core/nf-shlobj_core-shcreateshellfolderview) и [**СФВ \_ CREATE**](/windows/win32/api/shlobj_core/ns-shlobj_core-sfv_create) Structure. Источники данных, использующие объект представления системных папок по умолчанию (Дефвиев) оболочки, должны реализовывать следующий набор интерфейсов: [**ишеллфолдер**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder), [**IShellFolder2**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ishellfolder2), [**иперсистфолдер**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder), [**IPersistFolder2**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder2)и (необязательно) [**IPersistFolder3**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ipersistfolder3). Если в реализации **ишеллфолдер** не используется **Шкреатешеллфолдервиев** для создания дефвиев, то для объекта представления оболочки может потребоваться [**ифолдервиев**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifolderview).
-   [**Исеарчфолдеритемфактори**](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory) является основным интерфейсом для потребителей источника данных оболочки, известного как дбфолдер. Дополнительные сведения о Дбфолдер см. в описании инструкции STR \_ Parse \_ со \_ свойствами константы в [**строковых ключах контекста привязки**](../shell/str-constants.md). См. также [массивы ассоциаций](/previous-versions/windows/desktop/legacy/ee872122(v=vs.85)) и [**Ипропертисистем:: жетпропертидескриптионлистфромстринг**](/windows/win32/api/propsys/nf-propsys-ipropertysystem-getpropertydescriptionlistfromstring).
-   Дополнительные сведения о OLE DB см. в разделе [Общие сведения о программировании OLE DB](https://msdn.microsoft.com/library/5d8sd9we(VS.71).aspx). сведения о поставщике данных платформа .NET Framework для OLE DB см. в документации по [пространству имен System. Data. OleDb](/dotnet/api/system.data.oledb?view=dotnet-plat-ext-3.1) .
-   сведения о поддерживаемых сообществом платах сообщений в технологиях поиска см. в разделе [Windows: поиск форумов](https://social.msdn.microsoft.com/Forums/windowsdesktopsearchdevelopment/threads) на сайте MSDN.
-   связанные примеры кода см. в разделе [Windows поиск примеров кода](-search-samples-ovw.md).

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Обзор Windows Search](-search-3x-wds-overview.md)
</dt> <dt>

[языки, поддерживаемые при поиске Windows](-search-3x-wds-language-support.md)
</dt> <dt>

[Использование управляемого кода с данными оболочки и Windows Search](-search-3x-wds-managed-code.md)
</dt> <dt>

[Windows Поиск по руководству разработчика](-search-developers-guide-entry-page.md)
</dt> </dl>

 

 
