---
description: Windows Поиск — это платформа для поиска на рабочем столе, которая обладает возможностями мгновенного поиска для большинства распространенных типов файлов и типов данных, и сторонние разработчики могут расширить эти возможности на новые типы файлов и типы данных.
ms.assetid: 6da601c6-3742-40ad-99f2-8817f7f642b3
title: Обзор Windows Search
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9a38b757936e9f960d71ac5d1a9759208b4b580af2526e23d4e5d88cde41a206
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119033132"
---
# <a name="windows-search-overview"></a>Обзор Windows Search

Windows Поиск — это платформа для поиска на рабочем столе, которая обладает возможностями мгновенного поиска для большинства распространенных типов файлов и типов данных, и сторонние разработчики могут расширить эти возможности на новые типы файлов и типы данных.

Этот раздел организован следующим образом:

-   [Введение](#introduction)
    -   [Служба Windows Search](#windows-search-service)
    -   [Платформа разработки](#development-platform)
    -   [Пользовательский интерфейс](#user-interface)
-   [Технические предварительные требования](#technical-prerequisites)
    -   [Загрузка и содержимое пакета SDK](#sdk-download-and-contents)
-   [Windows Документация по пакету SDK для поиска](#windows-search-sdk-documentation)
-   [журнал поиска Windows](#history-of-windows-search)
-   [Дополнительные ресурсы](#additional-resources)
-   [Связанные темы](#related-topics)

## <a name="introduction"></a>Введение

Windows поиск является стандартным компонентом Windows 7 и Windows Vista и включен по умолчанию. Windows поиск заменяет Windows поиска на рабочем столе (WDS), который был доступен в качестве надстройки для Windows XP и Windows Server 2003.

Windows Поиск состоит из трех компонентов:

-   [Служба поиска Windows](#windows-search-service) (Windows SharePoint Services)
-   [Платформа разработки](#development-platform)
-   [Пользовательский интерфейс](#user-interface)

### <a name="windows-search-service"></a>Служба Windows Search

Windows SharePoint Services упорядочивает извлеченные функции коллекции документов. протокол поиска Windows позволяет клиенту взаимодействовать с сервером, на котором размещается Windows SharePoint Services, как выдавать запросы, так и управлять сервером индексирования с помощью администратора. при обработке файлов Windows SharePoint Services анализирует набор документов, извлекает полезную информацию, а затем упорядочивает извлеченные сведения, чтобы свойства этих документов могли быть эффективно возвращены в ответ на запросы.

коллекция документов, которые можно запрашивать, состоит из каталога, который является единицей организации высшего уровня в Windows поиска. Каталог представляет набор индексированных документов, которые можно запросить. Каталог состоит из таблицы свойств с текстом или значением и соответствующим расположением (языковой стандарт), хранящимся в столбцах таблицы. Каждая строка таблицы соответствует отдельному документу в области каталога, а каждый столбец таблицы соответствует свойству. Каталог может содержать инвертированный индекс (для быстрого сопоставления слов) и кэш свойств (для быстрого извлечения значений свойств).

процесс индексатора реализуется как служба Windows, работающая в учетной записи LocalSystem, и всегда работает для всех пользователей (даже если никто из пользователей не вошел в систему), что позволяет выполнять следующие действия при поиске Windows.

-   Поддерживать один индекс, который является общим для всех пользователей.
-   Поддержание ограничений безопасности при доступе к содержимому.
-   Обработка удаленных запросов с клиентских компьютеров в сети.

Служба поиска предназначена для защиты пользовательского интерфейса и производительности системы при индексировании. Следующие условия приводят к снижению или приостановке индексирования службой.

-   Высокая загрузка ЦП процессами, не связанными с поиском.
-   Высокая скорость системных операций ввода-вывода, включая операции чтения и записи файлов, операции ввода-вывода файлов подкачки и сопоставления файлового ввода-вывода.
-   Нехватка доступной памяти.
-   Низкое время работы батареи.
-   Недостаточно места на диске, где хранится индекс.

### <a name="development-platform"></a>Платформа разработки

предпочтительный способ доступа к api поиска и создания Windows приложений поиска — через источник данных оболочки. Источник данных оболочки — это компонент, который используется для расширения пространства имен оболочки и предоставления элементов в хранилище данных. Хранилище данных — это репозиторий данных. Хранилище данных может быть предоставлено модели программирования оболочки в качестве контейнера, использующего источник данных оболочки. элементы в хранилище данных могут индексироваться системой поиска Windows с помощью обработчика протокола.

Например, [исеарчфолдеритемфактори](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory) — это компонент, который может создавать экземпляры источника данных папки поиска, т. е. "виртуальный" источник данных, предоставляемый оболочкой, который может выполнять запросы к другим источникам данных в пространстве имен оболочки и перечислять результаты. Это можно сделать либо с помощью индексатора, либо путем перечисления и проверки элементов в указанных областях вручную. Этот интерфейс позволяет настроить параметры поиска с помощью методов, которые создают и изменяют папки поиска. Если методы этого интерфейса не вызываются, вместо них используются значения по умолчанию.

доступ к возможностям поиска Windows неявным образом через модель данных оболочки является предпочтительным, так как предоставляет доступ к полной функциональности оболочки на уровне модели данных оболочки. например, можно задать область поиска в библиотеке (которая является функцией, доступной в Windows 7 и более поздних версиях), чтобы использовать папки библиотеки в качестве области запроса. Windows Затем Поиск объединяет результаты поиска из этих расположений, если они находятся в разных индексах (если папки находятся на разных компьютерах). На уровне данных оболочки также создается более полное представление свойств элементов, синтезирование некоторых значений свойств. он также предоставляет доступ к функциям поиска для хранилищ данных, которые не индексируются с помощью Windows поиска. Например, можно выполнять поиск устройств хранения универсальной последовательной шины (USB), портативных устройств, использующих протокол MTP, или сервера протокол FTP (FTP) через источники данных оболочки, обеспечивающие доступ к этим системам хранения. Это обеспечивает лучшую работу пользователей.

Windows поиск содержит кэш значений свойств, которые используются в реализации Windows Служба поиска (Windows SharePoint Services). эти значения свойств можно запрашивать программно с помощью Windows поставщика OLE DB поиска или с помощью [исеарчфолдеритемфактори](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory), который представляет элементы в результатах поиска и представлениях на основе запросов. Windows Затем Поиск собирает и сохраняет свойства, созданные обработчиками фильтров или обработчиками свойств при индексировании такого элемента, как документ Word. Это хранилище отбрасывается и перестраивается при перестроении индекса.

сторонние разработчики могут создавать приложения, которые используют данные в индексе через программные запросы, и могут расширять данные в индексе для настраиваемых типов файлов и элементов, индексируемых Windowsным поиском. если необходимо отобразить результаты запроса в обозревателе Windows, необходимо реализовать источник данных оболочки, прежде чем можно будет создать обработчик протокола для расширения индекса. Однако если все запросы являются программными (например, OLE DB) и интерпретируется кодом приложения, а не оболочкой, пространство имен оболочки по-прежнему является предпочтительным, но не является обязательным.

обработчик протокола необходим для Windows получения сведений о содержимом файлов, таких как элементы в базах данных или пользовательские типы файлов. хотя Windows поиск может индексировать имя и свойства файла, Windows не содержит сведений о содержимом файла. в результате такие элементы нельзя индексировать или предоставлять в оболочке Windows. Реализуя пользовательский обработчик протокола, вы можете предоставить эти элементы. список обработчиков, определяемых сценарием разработчика, которые вы пытаетесь получить, см. в разделе "обзор обработчиков" статьи [Windows поиск в качестве платформы разработки](-search-3x-wds-development-ovr.md).

> [!Note]  
> Источник данных оболочки иногда называют расширением пространства имен оболочки. Обработчик иногда называют расширением оболочки или обработчиком расширения оболочки.

 

### <a name="user-interface"></a>Пользовательский интерфейс

в Windows Vista и более поздних версиях Windows поиск интегрирован во все окна проводника Windows для мгновенного доступа к поиску. Это позволяет пользователям быстро искать файлы и элементы по имени файла, свойствам и полнотекстовому содержимому. Кроме того, результаты можно отфильтровать для уточнения поиска. ниже приведены некоторые дополнительные возможности Windows поиска.

-   Поле мгновенного поиска в каждом окне позволяет мгновенно фильтровать все элементы, которые в настоящее время находятся в представлении. поля быстрого поиска отображаются в меню для поиска программ или файлов, а также в правом верхнем углу всех окон проводника Windows для фильтрации отображаемых результатов. мгновенный поиск также интегрируется в некоторые другие Windows функции, такие как проигрыватель Windows Media, для поиска связанных файлов.
-   Документы можно пометить ключевыми словами, чтобы сгруппировать их по настраиваемым критериям, определенным пользователем. Теги — это элементы метаданных, которые назначаются пользователем или приложениями для облегчения поиска файлов на основе ключевых слов, которые могут отсутствовать в имени или содержимом элемента. Например, набор изображений можно пометить как "назначение отпуска (отпуск 2009"), чтобы быстро получить их позже, выполнив поиск любого из включаемых слов.
-   расширенные заголовки столбцов в представлениях обозревателя Windows позволяют сортировать и группировать документы различными способами. Например, файлы можно сортировать по имени, дате изменения, типу, размеру и тегам. Документы также могут быть сгруппированы в соответствии с любым из этих свойств, и при необходимости каждая группа может быть отфильтрована (скрыта или отображена).
-   Документы могут быть упорядочены по имени, дате изменения, типу, размеру и тегам. Стеки включают все документы с указанным свойством и находятся в любой вложенной папке выбранной папки.
-   поиск можно сохранить (для последующего извлечения), нажав кнопку **сохранить поиск** в области поиска в Windows Explorer. Результаты будут динамически повторно заполнены на основе исходных критериев при открытии сохраненного поиска. Инструкции см. [в разделе Сохранение результатов поиска](https://windows.microsoft.com/windows-vista/Save-your-search-results).
-   обработчики предварительного просмотра и обработчики эскизов позволяют пользователям просматривать документы в Windows Explorer без необходимости открывать приложение, которое их создало.

## <a name="technical-prerequisites"></a>Технические предварительные требования

прежде чем приступить к чтению документации по пакету SDK для Windows поиска, необходимо получить фундаментальное представление о следующих понятиях:

-   Как реализовать источник данных оболочки.
-   Реализация обработчика.
-   Как работать в машинном коде.

Источник данных оболочки — это компонент, который используется для расширения пространства имен оболочки и предоставления элементов в хранилище данных. В прошлом источник данных оболочки назывался расширением пространства имен оболочки. Обработчик — это объект модели COM, предоставляющий функциональные возможности для элемента оболочки. список обработчиков, определяемых сценарием разработчика, которые вы пытаетесь получить, см. в разделе "обзор обработчиков" статьи [Windows поиск в качестве платформы разработки](-search-3x-wds-development-ovr.md).

дополнительные сведения о сборке взаимодействия пакета SDK для Windows для работы с COM-объектами, предоставляемыми Windowsным поиском и другими программами, использующими управляемый код, см. в разделе [использование управляемого кода с данными оболочки и Windows поиск](-search-3x-wds-managed-code.md). Однако обратите внимание, что фильтры, обработчики свойств и обработчики протоколов должны быть написаны в машинном коде. Это происходит из-за потенциальных проблем с управлением версиями среды CLR при работе нескольких надстроек. разработчики, не знакомые с C++, могут начать работу с [центром Visual C++ Developer Center](https://msdn.microsoft.com/vstudio//default.aspx) и [Windows начало работы разработки](../desktop-programming.md).

### <a name="sdk-download-and-contents"></a>Загрузка и содержимое пакета SDK

помимо соответствия указанным техническим требованиям, необходимо также загрузить [Windows SDK](https://msdn.microsoft.com/windowsvista/bb980924.aspx) , чтобы получить Windows библиотеки поиска. [примеры пакета SDK для Windows поиска](https://www.microsoft.com/downloads/details.aspx?FamilyID=645300AE-5E7A-4CE7-95F0-49793F8F76E8) содержат полезные примеры кода и сборку взаимодействия для разработки с управляемым кодом. дополнительные сведения об использовании примеров кода см. в разделе [Windows поиск примеров кода](-search-3x-wds-sampleentry.md).

## <a name="windows-search-sdk-documentation"></a>Windows Документация по пакету SDK для поиска

содержимое документации пакета SDK для Windows поиска выглядит следующим образом:

-   [Windows Search как платформа разработки](-search-3x-wds-development-ovr.md)

    описание основных сценариев разработки в Windows поиске. Предоставляет список обработчиков, определяемых сценарием разработки, которые вы пытаетесь достичь, рекомендациями установщика надстроек и примечаниями по реализации.

-   [Windows Поиск по руководству разработчика](-search-developers-guide-entry-page.md)

    Содержит пояснения для [управления индексом](-search-3x-wds-mngidx-overview.md), [выполнения запросов к индексу программным путем](-search-3x-wds-qryidx-overview.md), [расширения индекса](-search-3x-wds-extidx-overview.md)и [расширения языковых ресурсов](extending-language-resources-in-windows-search.md).

-   [Windows Поиск ссылки](-search-reference-entry-page.md)

    документирует следующие категории интерфейсов поиска Windows: [обработчики протоколов](-search-protocol-handlers-interfaces-entry-page.md), [запросы](-search-querying-interfaces-entry-page.md), [область обхода содержимого](-search-crawl-scope-interfaces-entry-page.md), надстройки [данных](-search-data-addins-interfaces-entry-page.md), [управление индексами](-search-index-mgt-interfaces-entry-page.md)и [уведомления](-search-notifications-interfaces-entry-page.md). Справочная документация также содержит [константы и перечисления](-search-constants-and-enumerations-entry-page.md), [структуры](-search-structures-entry-page.md), [сопоставления свойств](-search-3x-wds-propertymappings.md)и [сохраненный формат файла поиска](-search-savedsearchfileformat.md).

-   [Windows Поиск примеров кода](-search-samples-ovw.md)

    Описывает доступные примеры кода API поиска.

-   [Федеративный поиск в Windows](-search-federated-search-overview.md)

    описание поддержки Windows 7 для службы федерации поиска в удаленных хранилищах данных с помощью технологий OpenSearch, которые позволяют пользователям получать доступ к удаленным данным и взаимодействовать с ними в обозревателе Windows.

-   [Связанные технологии поиска](-search-3x-wds-sampleentry.md)

    содержит список технологий, связанных с поиском Windows: поиск Enterprise, SharePoint Enterprise поиск и устаревшие приложения, такие как Windows Desktop Search 2. x и Platform SDK: служба индексирования.

-   [Windows Глоссарий поиска](search-glossary.md)

    определяет ключевые термины, используемые в технологиях поиска Windows и оболочки.

## <a name="history-of-windows-search"></a>журнал поиска Windows

Windows поиск заменяет Windows поиска на рабочем столе (WDS), который был доступен в качестве надстройки для Windows XP и Windows Server 2003. службы WDS заменили устаревшую службу индексирования предыдущих версий Windows с улучшениями производительности, удобства использования и расширяемости. Новая платформа разработки поддерживает требования, которые создают более безопасную и стабильную систему. хотя новая платформа запросов несовместима с Microsoft Windows Desktop Search (WDS) 2. x, фильтры и обработчики протоколов, написанные для предыдущих версий WDS, можно обновить для работы с Windowsным поиском. Windows Поиск также поддерживает новую систему свойств. Дополнительные сведения о фильтрах, обработчиках свойств и обработчиках протоколов см. [в разделе Расширение индекса](-search-3x-wds-extidx-overview.md).

Windows поиск встроен в Windows Vista и более поздних версий и доступен в качестве распространяемого обновления для WDS 2. x для поддержки следующих операционных систем:

-   32-разрядные версии Windows XP с пакетом обновления 2 (SP2).
-   все версии Windows XP на основе x64.
-   Windows Сервер 2003 с пакетом обновления 1 (SP1) и более поздней версии.
-   все версии Windows Server 2003, основанные на x64.

для запуска приложений, написанных для Windows поиска, в системах под управлением этих операционных систем должен быть установлен Windowsный поиск. дополнительные сведения см. в [статье базы знаний 917013: описание Windows поиск настольных систем 3,01, а также пакет многоязычный пользовательский интерфейс для Windows панели поиска 3,01](https://support.microsoft.com/kb/917013).

## <a name="additional-resources"></a>Дополнительные ресурсы

-   Сведения о создании источника данных оболочки см. в разделе [реализация базовых интерфейсов объекта папки](/previous-versions//bb776815(v=vs.85)).
-   Дополнительные сведения о [исеарчфолдеритемфактори](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory) и источнике данных папки DB см. в описании инструкции str \_ Parse \_ с \_ константой Properties в [строковых ключах привязки](../shell/str-constants.md). См. также [массивы ассоциаций](/previous-versions/windows/desktop/legacy/ee872122(v=vs.85)) и [Ипропертисистем:: жетпропертидескриптионлистфромстринг](/windows/win32/api/propsys/nf-propsys-ipropertysystem-getpropertydescriptionlistfromstring).
-   Дополнительные сведения о OLE DB см. в разделе [Общие сведения о программировании OLE DB](/cpp/data/oledb/ole-db-programming-overview?view=vs-2019). сведения о поставщике данных платформа .NET Framework для OLE DB см. в документации по [пространству имен System. Data. OleDb](/dotnet/api/system.data.oledb?view=dotnet-plat-ext-3.1&preserve-view=true) .
-   общие сведения о обработчиках типов файлов (также известных как обработчики расширений оболочки и обработчики поиска) см. в разделе [Windows поиск в качестве платформы разработки](-search-3x-wds-development-ovr.md).
-   сведения о технологиях поиска, поддерживаемых сообществом, см. в [статье форум MSDN: Windows разработка средств поиска на рабочем столе](https://social.msdn.microsoft.com/Forums/windowsdesktopsearchdevelopment/threads).
-   связанные примеры кода см. в разделе [Windows поиск примеров кода](-search-samples-ovw.md).

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Windows Search как платформа разработки](-search-3x-wds-development-ovr.md)
</dt> <dt>

[языки, поддерживаемые при поиске Windows](-search-3x-wds-language-support.md)
</dt> <dt>

[Использование управляемого кода с данными оболочки и Windows Search](-search-3x-wds-managed-code.md)
</dt> </dl>

 

 
