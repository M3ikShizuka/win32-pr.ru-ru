---
description: Windows Search — это платформа для поиска на рабочем столе, которая обладает возможностями мгновенного поиска для большинства распространенных типов файлов и типов данных, и сторонние разработчики могут расширить эти возможности на новые типы файлов и типы данных.
ms.assetid: 6da601c6-3742-40ad-99f2-8817f7f642b3
title: Обзор Windows Search
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cee4cde62ce663c47ab4cafac0c74ca220fe6faf
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103896950"
---
# <a name="windows-search-overview"></a>Обзор Windows Search

Windows Search — это платформа для поиска на рабочем столе, которая обладает возможностями мгновенного поиска для большинства распространенных типов файлов и типов данных, и сторонние разработчики могут расширить эти возможности на новые типы файлов и типы данных.

Этот раздел организован следующим образом:

-   [Введение](#introduction)
    -   [Служба Windows Search](#windows-search-service)
    -   [Платформа разработки](#development-platform)
    -   [Пользовательский интерфейс](#user-interface)
-   [Технические предварительные требования](#technical-prerequisites)
    -   [Загрузка и содержимое пакета SDK](#sdk-download-and-contents)
-   [Документация по пакету SDK для поиска Windows](#windows-search-sdk-documentation)
-   [Журнал поиска Windows](#history-of-windows-search)
-   [Дополнительные ресурсы](#additional-resources)
-   [См. также](#related-topics)

## <a name="introduction"></a>Введение

Windows Search — это стандартный компонент Windows 7 и Windows Vista, который по умолчанию включен. Служба поиска Windows заменяет Поиск на рабочем столе Windows (WDS), который был доступен в качестве надстройки для Windows XP и Windows Server 2003.

Поиск Windows состоит из трех компонентов:

-   [Служба поиска Windows](#windows-search-service) (WSS)
-   [Платформа разработки](#development-platform)
-   [Пользовательский интерфейс](#user-interface)

### <a name="windows-search-service"></a>Служба Windows Search

WSS упорядочивает извлеченные функции коллекции документов. Протокол Windows Search позволяет клиенту взаимодействовать с сервером, на котором размещается WSS, выдавать запросы и разрешать администратору управлять сервером индексирования. При обработке файлов WSS анализирует набор документов, извлекает полезную информацию, а затем упорядочивает извлеченные сведения, чтобы свойства этих документов могли быть эффективно возвращены в ответ на запросы.

Коллекция документов, которые можно запрашивать, состоит из каталога, который является единицей организации верхнего уровня в поиске Windows. Каталог представляет набор индексированных документов, которые можно запросить. Каталог состоит из таблицы свойств с текстом или значением и соответствующим расположением (языковой стандарт), хранящимся в столбцах таблицы. Каждая строка таблицы соответствует отдельному документу в области каталога, а каждый столбец таблицы соответствует свойству. Каталог может содержать инвертированный индекс (для быстрого сопоставления слов) и кэш свойств (для быстрого извлечения значений свойств).

Процесс индексатора реализуется как служба Windows, работающая в учетной записи LocalSystem, и всегда работает для всех пользователей (даже если никто из пользователей не вошел в систему), что позволяет службе поиска Windows выполнять следующие действия:

-   Поддерживать один индекс, который является общим для всех пользователей.
-   Поддержание ограничений безопасности при доступе к содержимому.
-   Обработка удаленных запросов с клиентских компьютеров в сети.

Служба поиска предназначена для защиты пользовательского интерфейса и производительности системы при индексировании. Следующие условия приводят к снижению или приостановке индексирования службой.

-   Высокая загрузка ЦП процессами, не связанными с поиском.
-   Высокая скорость системных операций ввода-вывода, включая операции чтения и записи файлов, операции ввода-вывода файлов подкачки и сопоставления файлового ввода-вывода.
-   Нехватка доступной памяти.
-   Низкое время работы батареи.
-   Недостаточно места на диске, где хранится индекс.

### <a name="development-platform"></a>Платформа разработки

Предпочтительный способ доступа к API поиска и создания приложений Windows Search — через источник данных оболочки. Источник данных оболочки — это компонент, который используется для расширения пространства имен оболочки и предоставления элементов в хранилище данных. Хранилище данных — это репозиторий данных. Хранилище данных может быть предоставлено модели программирования оболочки в качестве контейнера, использующего источник данных оболочки. Элементы в хранилище данных могут индексироваться системой поиска Windows с помощью обработчика протокола.

Например, [исеарчфолдеритемфактори](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory) — это компонент, который может создавать экземпляры источника данных папки поиска, т. е. "виртуальный" источник данных, предоставляемый оболочкой, который может выполнять запросы к другим источникам данных в пространстве имен оболочки и перечислять результаты. Это можно сделать либо с помощью индексатора, либо путем перечисления и проверки элементов в указанных областях вручную. Этот интерфейс позволяет настроить параметры поиска с помощью методов, которые создают и изменяют папки поиска. Если методы этого интерфейса не вызываются, вместо них используются значения по умолчанию.

Доступ к возможности поиска Windows осуществляется косвенно с помощью модели данных оболочки, так как она обеспечивает доступ к полным функциональным возможностям оболочки на уровне модели данных оболочки. Например, можно задать область поиска в библиотеке (которая является функцией, доступной в Windows 7 и более поздних версиях), чтобы использовать папки библиотеки в качестве области запроса. После этого Поиск Windows выполняет статистическую обработку результатов поиска из этих расположений, если они находятся в разных индексах (если папки находятся на разных компьютерах). На уровне данных оболочки также создается более полное представление свойств элементов, синтезирование некоторых значений свойств. Он также предоставляет доступ к функциям поиска для хранилищ данных, которые не индексируются в Windows Search. Например, можно выполнять поиск устройств хранения универсальной последовательной шины (USB), портативных устройств, использующих протокол MTP, или сервера протокол FTP (FTP) через источники данных оболочки, обеспечивающие доступ к этим системам хранения. Это обеспечивает лучшую работу пользователей.

В Windows Search имеется кэш значений свойств, используемых в реализации Служба поиска Windows (WSS). Эти значения свойств можно запрашивать программным способом с помощью поставщика OLE DB поиска Windows или с помощью [исеарчфолдеритемфактори](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory), который представляет элементы в результатах поиска и представлениях на основе запросов. Затем поиск Windows собирает и сохраняет свойства, созданные обработчиками фильтров или обработчиками свойств при индексировании элемента, такого как документ Word. Это хранилище отбрасывается и перестраивается при перестроении индекса.

Сторонние разработчики могут создавать приложения, которые используют данные в индексе через программные запросы, и могут расширять данные в индексе для пользовательских файлов и типов элементов, индексируемых службой поиска Windows. Если необходимо отобразить результаты запроса в проводнике Windows, необходимо реализовать источник данных оболочки, прежде чем можно будет создать обработчик протокола для расширения индекса. Однако если все запросы являются программными (например, OLE DB) и интерпретируется кодом приложения, а не оболочкой, пространство имен оболочки по-прежнему является предпочтительным, но не является обязательным.

Для получения сведений о содержимом файлов, таких как элементы в базах данных или пользовательские типы файлов, необходим обработчик протокола. Хотя поиск Windows может индексировать имя и свойства файла, Windows не содержит сведений о содержимом файла. В результате такие элементы не могут индексироваться или быть представлены в оболочке Windows. Реализуя пользовательский обработчик протокола, вы можете предоставить эти элементы. Список обработчиков, определяемых сценарием разработчика, которые вы пытаетесь получить, см. в разделе «Обзор обработчиков» в [Windows Search как платформа разработки](-search-3x-wds-development-ovr.md).

> [!Note]  
> Источник данных оболочки иногда называют расширением пространства имен оболочки. Обработчик иногда называют расширением оболочки или обработчиком расширения оболочки.

 

### <a name="user-interface"></a>Пользовательский интерфейс

В Windows Vista и более поздних версиях служба поиска Windows интегрирована во все окна проводника Windows для мгновенного доступа к поиску. Это позволяет пользователям быстро искать файлы и элементы по имени файла, свойствам и полнотекстовому содержимому. Кроме того, результаты можно отфильтровать для уточнения поиска. Ниже приведены некоторые дополнительные возможности службы "Поиск Windows".

-   Поле мгновенного поиска в каждом окне позволяет мгновенно фильтровать все элементы, которые в настоящее время находятся в представлении. В меню "Пуск" отображаются поля быстрого поиска для поиска программ или файлов, а также в правом верхнем углу всех окон проводника Windows для фильтрации отображаемых результатов. Мгновенный поиск также интегрируется в некоторые другие функции Windows, например проигрыватель Windows Media, для поиска связанных файлов.
-   Документы можно пометить ключевыми словами, чтобы сгруппировать их по настраиваемым критериям, определенным пользователем. Теги — это элементы метаданных, которые назначаются пользователем или приложениями для облегчения поиска файлов на основе ключевых слов, которые могут отсутствовать в имени или содержимом элемента. Например, набор изображений можно пометить как "назначение отпуска (отпуск 2009"), чтобы быстро получить их позже, выполнив поиск любого из включаемых слов.
-   Расширенные заголовки столбцов в представлениях проводника Windows позволяют сортировать и группировать документы различными способами. Например, файлы можно сортировать по имени, дате изменения, типу, размеру и тегам. Документы также могут быть сгруппированы в соответствии с любым из этих свойств, и при необходимости каждая группа может быть отфильтрована (скрыта или отображена).
-   Документы могут быть упорядочены по имени, дате изменения, типу, размеру и тегам. Стеки включают все документы с указанным свойством и находятся в любой вложенной папке выбранной папки.
-   Поиск можно сохранить (для последующего извлечения), нажав кнопку **сохранить поиск** в панели поиска в проводнике Windows. Результаты будут динамически повторно заполнены на основе исходных критериев при открытии сохраненного поиска. Инструкции см. [в разделе Сохранение результатов поиска](https://windows.microsoft.com/windows-vista/Save-your-search-results).
-   Обработчики предварительного просмотра и обработчики эскизов позволяют пользователям просматривать документы в проводнике Windows без необходимости открывать приложение, которое их создало.

## <a name="technical-prerequisites"></a>Технические предварительные требования

Прежде чем приступить к ознакомлению с документацией по пакету SDK для поиска Windows, необходимо получить фундаментальное представление о следующих понятиях:

-   Как реализовать источник данных оболочки.
-   Реализация обработчика.
-   Как работать в машинном коде.

Источник данных оболочки — это компонент, который используется для расширения пространства имен оболочки и предоставления элементов в хранилище данных. В прошлом источник данных оболочки назывался расширением пространства имен оболочки. Обработчик — это объект модели COM, предоставляющий функциональные возможности для элемента оболочки. Список обработчиков, определяемых сценарием разработчика, которые вы пытаетесь получить, см. в разделе «Обзор обработчиков» в [Windows Search как платформа разработки](-search-3x-wds-development-ovr.md).

Дополнительные сведения о сборке взаимодействия пакета SDK для Windows Search для работы с COM-объектами, предоставляемыми службой "Поиск Windows" и другими программами, использующими управляемый код, см. в разделе [использование управляемого кода с данными оболочки и Windows Search](-search-3x-wds-managed-code.md). Однако обратите внимание, что фильтры, обработчики свойств и обработчики протоколов должны быть написаны в машинном коде. Это происходит из-за потенциальных проблем с управлением версиями среды CLR при работе нескольких надстроек. Разработчики, не знакомые с C++, могут начать работу с [центром Visual C++ разработчиков](https://msdn.microsoft.com/vstudio//default.aspx) и [Начало работы разработки Windows](../desktop-programming.md).

### <a name="sdk-download-and-contents"></a>Загрузка и содержимое пакета SDK

Помимо соответствия указанным техническим требованиям, необходимо также загрузить [Windows SDK](https://msdn.microsoft.com/windowsvista/bb980924.aspx) для получения библиотек Windows Search. [Примеры пакета SDK для Windows Search](https://www.microsoft.com/downloads/details.aspx?FamilyID=645300AE-5E7A-4CE7-95F0-49793F8F76E8) содержат полезные примеры кода и сборку взаимодействия для разработки с управляемым кодом. Дополнительные сведения об использовании примеров кода см. в статье [примеры кода для поиска Windows](-search-3x-wds-sampleentry.md).

## <a name="windows-search-sdk-documentation"></a>Документация по пакету SDK для поиска Windows

Содержимое документации пакета SDK для Windows Search выглядит следующим образом:

-   [Windows Search как платформа разработки](-search-3x-wds-development-ovr.md)

    Описание основных сценариев разработки в Windows Search. Предоставляет список обработчиков, определяемых сценарием разработки, которые вы пытаетесь достичь, рекомендациями установщика надстроек и примечаниями по реализации.

-   [Руководством разработчика Windows Search](-search-developers-guide-entry-page.md)

    Содержит пояснения для [управления индексом](-search-3x-wds-mngidx-overview.md), [выполнения запросов к индексу программным путем](-search-3x-wds-qryidx-overview.md), [расширения индекса](-search-3x-wds-extidx-overview.md)и [расширения языковых ресурсов](extending-language-resources-in-windows-search.md).

-   [Справочник по поиску Windows](-search-reference-entry-page.md)

    Документирует следующие категории интерфейсов Windows Search: [обработчики протоколов](-search-protocol-handlers-interfaces-entry-page.md), [запросы](-search-querying-interfaces-entry-page.md), [область обхода содержимого](-search-crawl-scope-interfaces-entry-page.md), надстройки [данных](-search-data-addins-interfaces-entry-page.md), [Управление индексами](-search-index-mgt-interfaces-entry-page.md)и [уведомления](-search-notifications-interfaces-entry-page.md). Справочная документация также содержит [константы и перечисления](-search-constants-and-enumerations-entry-page.md), [структуры](-search-structures-entry-page.md), [сопоставления свойств](-search-3x-wds-propertymappings.md)и [сохраненный формат файла поиска](-search-savedsearchfileformat.md).

-   [Примеры кода для поиска Windows](-search-samples-ovw.md)

    Описывает доступные примеры кода API поиска.

-   [Федеративный поиск в Windows](-search-federated-search-overview.md)

    Описание поддержки Windows 7 для службы федерации поиска в удаленных хранилищах данных с помощью технологий OpenSearch, позволяющих пользователям получать доступ к удаленным данным и взаимодействовать с ними в проводнике Windows.

-   [Связанные технологии поиска](-search-3x-wds-sampleentry.md)

    Список технологий, связанных с поиском Windows: корпоративный поиск, корпоративный поиск SharePoint и устаревшие приложения, такие как Windows Desktop Search 2. x и Platform SDK: служба индексирования.

-   [Глоссарий поиска Windows](search-glossary.md)

    Определяет ключевые термины, используемые в технологиях поиска Windows и оболочки.

## <a name="history-of-windows-search"></a>Журнал поиска Windows

Служба поиска Windows заменяет Поиск на рабочем столе Windows (WDS), который был доступен в качестве надстройки для Windows XP и Windows Server 2003. Службы WDS заменили устаревшую службу индексирования предыдущих версий Windows, улучшая производительность, удобство использования и расширяемость. Новая платформа разработки поддерживает требования, которые создают более безопасную и стабильную систему. Хотя новая платформа запросов несовместима с Microsoft Windows Desktop Search (WDS) 2. x, фильтры и обработчики протоколов, написанные для предыдущих версий WDS, можно обновить для работы с Windows Search. Поиск Windows также поддерживает новую систему свойств. Дополнительные сведения о фильтрах, обработчиках свойств и обработчиках протоколов см. [в разделе Расширение индекса](-search-3x-wds-extidx-overview.md).

Windows Search встроена в Windows Vista и более поздние версии и доступна в качестве распространяемого обновления для WDS 2. x для поддержки следующих операционных систем:

-   32-разрядные версии Windows XP с пакетом обновления 2 (SP2).
-   Все версии Windows XP на базе x64.
-   Windows Server 2003 с пакетом обновления 1 (SP1) и более поздней версии.
-   Все 64-разрядные версии Windows Server 2003.

Для запуска приложений, написанных для Windows Search, в системах под управлением этих операционных систем должен быть установлен Windows Search. Дополнительные сведения см. [в статье базы знаний 917013: описание Windows Desktop search 3,01 и пакет многоязыкового интерфейса пользователя для Windows Desktop search 3,01](https://support.microsoft.com/kb/917013).

## <a name="additional-resources"></a>Дополнительные ресурсы

-   Сведения о создании источника данных оболочки см. в разделе [реализация базовых интерфейсов объекта папки](/previous-versions//bb776815(v=vs.85)).
-   Дополнительные сведения о [исеарчфолдеритемфактори](/windows/win32/api/shobjidl_core/nn-shobjidl_core-isearchfolderitemfactory) и источнике данных папки DB см. в описании инструкции str \_ Parse \_ с \_ константой Properties в [строковых ключах привязки](../shell/str-constants.md). См. также [массивы ассоциаций](/previous-versions/windows/desktop/legacy/ee872122(v=vs.85)) и [Ипропертисистем:: жетпропертидескриптионлистфромстринг](/windows/win32/api/propsys/nf-propsys-ipropertysystem-getpropertydescriptionlistfromstring).
-   Дополнительные сведения о OLE DB см. в разделе [Общие сведения о программировании OLE DB](/cpp/data/oledb/ole-db-programming-overview?view=vs-2019). Сведения о поставщике данных платформа .NET Framework для OLE DB см. в документации по [пространству имен System. Data. OLEDB](/dotnet/api/system.data.oledb?view=dotnet-plat-ext-3.1&preserve-view=true) .
-   Общие сведения о обработчиках типов файлов (также известных как обработчики расширений оболочки и обработчики поиска) см. в разделе [Поиск Windows в качестве платформы разработки](-search-3x-wds-development-ovr.md).
-   Сведения о технологиях поиска, поддерживаемые сообществом, см. в [статье форум MSDN: Разработка Windows Desktop Search](https://social.msdn.microsoft.com/Forums/windowsdesktopsearchdevelopment/threads).
-   Связанные примеры кода см. в разделе [примеры кода для поиска Windows](-search-samples-ovw.md).

## <a name="related-topics"></a>См. также

<dl> <dt>

[Windows Search как платформа разработки](-search-3x-wds-development-ovr.md)
</dt> <dt>

[Языки, поддерживаемые службой поиска Windows](-search-3x-wds-language-support.md)
</dt> <dt>

[Использование управляемого кода с данными оболочки и Windows Search](-search-3x-wds-managed-code.md)
</dt> </dl>

 

 
