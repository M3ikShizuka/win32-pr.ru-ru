---
description: Корпорация Майкрософт предоставляет средство разбиения по словам и парадигматические модули для нескольких языков. В этом разделе описывается, как реализовать и использовать пользовательские средства разбиения по словам и парадигматические модули для языков, а также языковые стандарты, предоставляемые корпорацией Майкрософт.
ms.assetid: 47768691-7071-440e-bfbf-975713880c00
title: Реализация средств разбиения по словам и парадигматические модули
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4bd4f4e3210e7f4e17bb035115fd694656cc6e6d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104072642"
---
# <a name="implementing-a-word-breaker-and-stemmer"></a>Реализация средств разбиения по словам и парадигматические модули

Корпорация Майкрософт предоставляет средство разбиения по словам и парадигматические модули для нескольких языков. В этом разделе описывается, как реализовать и использовать пользовательские средства разбиения по словам и парадигматические модули для языков, а также языковые стандарты, предоставляемые корпорацией Майкрософт.

> [!Note]
> По состоянию на июль 2018 в Windows Server 2019 было внесено изменение безопасности, которое предотвращает загрузку библиотек DLL без подписи Майкрософт с SearchIndexer.exe. В результате Windows Server 2019 больше не поддерживает подписанные пользовательские разделители слов, не относящиеся к Майкрософт. 

Этот раздел организован следующим образом:

-   [Регистрация библиотеки DLL ресурсов языка](#registering-a-language-resource-dll)
-   [Регистрация языка](#registering-a-language-resource-dll)
-   [Реализация слова колба](#implementing-a-word-beaker)
    -   [Вордсинк и Фрасесинк](#wordsink-and-phrasesink)
    -   [Разрывы](#breaks)
    -   [Масштабируемость, Перформанци и безопасность](#scalability-performancy-and-security)
-   [Реализация парадигматические модули](#implementing-a-stemmer)
    -   [Масштабируемость, Перформанци и безопасность](#scalability-performancy-and-security)
-   [См. также](#related-topics)

## <a name="registering-a-language-resource-dll"></a>Регистрация библиотеки DLL ресурсов языка

Каждая библиотека DLL ресурсов языка должна реализовывать и экспортировать следующие точки входа. Библиотека DLL может быть зарегистрирована в любой папке.

-   DllMain является стандартной точкой входа для библиотеки DLL.
-   Функция DllRegisterServer регистрирует библиотеку DLL в реестре, например `regsvr32.exe %SystemRoot%\MyFolder\wordbreaker.dll`
-   DllCanUnloadNow позволяет клиентам вызывать эту точку входа через модель COM, чтобы определить, возможно ли выгрузить DLL-файл ресурсов языка.
-   DllUnRegisterServer удаляет библиотеку DLL из реестра.

## <a name="registering-a-language"></a>Регистрация языка

Реестр содержит зависящие от языка записи для индексируемого языка, и эти записи управляют частями процессов индексирования и запросов, зависящих от языка. Эти записи реестра можно найти в следующем разделе реестра.

```
HKEY_LOCAL_MACHINE
   SYSTEM
      CurrentControlSet
         ContentIndex
            Control
               Language
                  
```

## <a name="implementing-a-word-beaker"></a>Реализация слова колба

Средства разбиения по словам реализуют [**ивордбреакер**](/windows/desktop/api/Indexsrv/nn-indexsrv-iwordbreaker). Метод [**ивордбреакер:: бреактекст**](/windows/desktop/api/Indexsrv/nf-indexsrv-iwordbreaker-breaktext) выполняет обработку и синтаксический анализ текста. Для реализации компонента средства разбиения по словам необходимо использовать эвристику языка для вашего языка. Сюда входят сведения о синтаксисе и морфологи. Также может потребоваться список слов для исключения или включения. Вы создаете файл пропускаемых слов для языкового стандарта из списка исключенных слов. Дополнительные сведения о лингвистических аспектах и о том, как эти рекомендации влияют на реализации разбиения по словам, см. в разделе [соглашения о лингвистических и Юникоде](linguistic-and-unicode-considerations.md).

Основной целью [**ивордбреакер:: бреактекст**](/windows/desktop/api/Indexsrv/nf-indexsrv-iwordbreaker-breaktext) является обработка текста непрерывно из [**\_ исходного текста**](/windows/win32/api/indexsrv/ns-indexsrv-text_source) до тех пор, пока не будет обработан весь текст или пока средство разбиения по словам не обнаружит ошибку. В этом цикле обработки данных **ивордбреакер:: бреактекст** вызывает синтаксический анализ и служебные методы, выполняющие определенные задачи для этого процесса. Например, немецкий средство разбиения по словам может обрабатывать составные слова, а французское средство разбиения по словам может обрабатывать [диакритические знаки](surface-form-normalization.md) или [клитикс](surface-form-normalization.md). Конкретные функции, выполняемые программой разбиения по словам, и стратегия, используемая для выполнения этих задач, полностью зависят от требований этого языка.

При разбиении текста средство разбиения по словам определяет "альтернативные" формы для слов, которые могут иметь несколько представлений. Между создаваемыми словами не подразумевается Семантическая связь. На самом деле, исходное слово может не включаться в список альтернатив. Альтернативные формы сохраняются в том же положении в индексе, что и исходное слово, чтобы указать, что они идентичны.

Если документ включен в индекс, каждому слову присваивается целочисленное значение, представляющее смещение или расстояние слова от начала документа. Относительное расстояние между словами в запросе сравнивается со смещением, хранящимся в полнотекстовом индексе. Запрос "Where является документом Кайл" соответствует любому документу с "Where" в смещении n, "равно" в n + 1, "Кайл" в n + 2 и "Document" в n + 3. «Где Кайл документ в базе данных?» представляется следующим образом:



|       |     |                        |          |       |     |     |                               |
|-------|-----|------------------------|----------|-------|-----|-----|-------------------------------|
| Where | is  | Кайл Кайл<br/> | документ | подан | in  | мыши | база данных БД<br/> |



 

В этом примере средство разбиения по словам сохраняет альтернативные формы для "Кайл" ("Кайл") и "Database" (база данных) в индексе. Средство разбиения по словам создает и сохраняет альтернативные слова в процессе создания индекса при следующих условиях.

-   Если альтернативное слово, скорее всего, будет отображаться в запросе как одно слово
-   Если средство извлечения корней, скорее всего, не порождает исходное слово из альтернативы

Создание альтернативных форм-слов увеличивает число способов представления и сопоставления запросов с предложением, как показано в следующих вариантах:

1.  Где находится документ Кайл в базе данных
2.  Где находится документ Кайл в базе данных
3.  Где находится документ Кайл в базе данных
4.  Где хранится документ Кайл в базе данных

### <a name="wordsink-and-phrasesink"></a>Вордсинк и Фрасесинк

Средства разбиения по словам используют объекты [**ивордсинк**](iwordsink.md) и [**ифрасесинк**](/windows/win32/api/indexsrv/nn-indexsrv-iphrasesink) для накопления и хранения всех слов и фраз, извлеченных из текста. Средство разбиения по словам хранит слова в форме, как можно ближе к исходной форме Word в документе. **Ифрасесинк** сохраняет фразы во время выполнения запроса. Фразы повышают релевантность результатов запроса, поскольку более длинные последовательности слов являются реже и предоставляют более широкие различия, чем небольшие фразы. Когда индексатор помещает фразу в **ифрасесинк** во время запроса, он создает экземпляр средство разбиения по словам, чтобы разбить фразу на слова. Затем индексатор вычисляет фразу, проверяя, находятся ли слова в фразе рядом друг с другом в индексе. Например, если в индексе в позициях *x*, *x*+ 1, *x*+ 2 и *x*+ 3 встречается "abcd", совпадение с фразой будет возникать, если в запросе отправляется любая смежная подстрока "abcd". Эта стратегия эффективна для разделителей слов на основе символов, которые разбивают фразы и длинные слова во время создания индекса и создают фразы во время запроса.

### <a name="breaks"></a>Разрывы

Разрывы — это пробелы между словами. Пробелы, пунктуация, форматирование или только природа самого языка могут вызвать разрывы. Индексатор использует четыре разных типа разрывов: конец слова (ЕОВ), конец предложения (EOS), конец абзаца (потенциал) и конец главы (EOC). Разрыв ЕОВ является разрывом по умолчанию. После каждого маркера каждый разрыв обозначает Разное семантическое расстояние между словами на обеих сторонах. Слова, разделенные ЕОВ, имеют строгую семантическую связь, за которой следуют EOS, потенциал и EOC. Несколько вызовов [**ивордсинк::P утбреак**](iwordsink-putbreak.md) являются кумулятивными и аналогичны вставке пустых слов или предложений.

### <a name="scalability-performancy-and-security"></a>Масштабируемость, Перформанци и безопасность

Способ, которым средство разбиения по словам реагирует на одновременные вызовы, в основном определяется выбором модели потоков. Индексатор является однопотоковым приложением. Чтобы средства разбиения по словам работали в однопотоковой среде, средства разбиения по словам должны быть написаны с помощью потоковой модели "Free" или "both". Средства разбиения по словам не должны регистрироваться в COM с помощью потоковой модели "апартамента".

Мы советуем, чтобы средство разбиения по словам не мешало глобальным состояниям и сохранить данные в экземпляре для программы разбиения по словам. Единственным содержимым, которое должно храниться в реализации средство разбиения по словам, являются параметры *фкуери* и *улмакстокенсизе*. Средства разбиения по словам должны быть не более чем в два раза медленнее, чем тест, установленный средством разбиения по словам для английского языка. Производительность средства разбиения по словам также должна быть улучшена с увеличением возможностей оборудования.

Средство разбиения по словам для индексатора выполняется в контексте безопасности локальной системы. Они должны быть написаны для корректного управления буферами и их правильного стека. Все копии строк должны иметь явные проверки для защиты от переполнения буфера. Следует всегда проверять выделенный размер буфера и проверять размер данных в соответствии с размером буфера. Средство разбиения по словам не может предположить, что текст, передаваемый методу [**ивордбреакер:: бреактекст**](/windows/desktop/api/Indexsrv/nf-indexsrv-iwordbreaker-breaktext) , имеет правильный формат. Дополнительные сведения об устранении неполадок средства разбиения по словам см. в разделе [Устранение неполадок языковых ресурсов и](troubleshooting-language-resources.md)рекомендаций.

## <a name="implementing-a-stemmer"></a>Реализация парадигматические модули

Парадигматические модули реализуют интерфейс [**истеммер**](/windows/desktop/api/Indexsrv/nn-indexsrv-istemmer) . Метод [**истеммер:: женератевордформс**](/windows/desktop/api/Indexsrv/nf-indexsrv-istemmer-generatewordforms) создает список слов с определенными словами для конкретного входного слова. Чтобы реализовать компонент извлечения корней, необходимо иметь эвристику языка для вашего языка. Сюда входят сведения о морфологи. Также может потребоваться список слов для исключения или включения. Дополнительные сведения о лингвистических аспектах и о том, как эти вопросы влияют на реализации парадигматические модули, см. в статье [особенности лингвистических и Юникода](linguistic-and-unicode-considerations.md).

Рекомендуется, чтобы парадигматические модули не создавали женитиве или, например, для слов. Например, «Дэвид» не создается в качестве альтернативной формы для «Дэвид». Средство разбиения по словам создает как «Дэвид», так и «Дэвид» при анализе «Дэвид».

Парадигматические модули используют объект [ивордформсинк](/windows/desktop/api/Indexsrv/nn-indexsrv-iwordformsink) для сбора списка альтернативных слов. [**Ивордформсинк::P утворд**](iwordformsink-putword.md) создает окончательное слово из парадигматические модули. Во всех случаях это последнее слово, совпадающее с входным словом из [**истеммер:: женератевордформс**](/windows/desktop/api/Indexsrv/nf-indexsrv-istemmer-generatewordforms). Например, при наличии слова «дорожки» средство извлечения корней формирует следующие формы: «Swimming», «плавание», «купание», «свам» и «свум» с помощью вызовов [**ивордформсинк::P уталтворд**](iwordformsink-putphrase.md). Средство извлечения корней создает "дорожки" через **ивордформсинк::P утворд**.

### <a name="scalability-performancy-and-security"></a>Масштабируемость, Перформанци и безопасность

Парадигматические модули, такие как средство разбиения по словам, должны использовать модель бесплатного потокового взаимодействия и регистрироваться в модели COM, для которых задана модель потоковой обработки "Free" или "both". Поиск Windows вызывает отдельные экземпляры парадигматические модули из разных потоков одновременно. Таким образом, парадигматические модули должны иметь минимальные данные экземпляра.

Точность парадигматические связи оказывает значительное влияние на релевантность запроса. Если средство извлечения корней текста неправильно выдает текст, запросы могут возвращать непредсказуемые и неточные результаты. Парадигматические модули должны обслуживать сотни запросов в секунду без негативного влияния на производительность запросов. Производительность системы извлечения корней должна улучшиться благодаря увеличению возможностей оборудования. Сведения об устранении неполадок парадигматические модули см. в разделе [Устранение неполадок и рекомендации по использованию языковых ресурсов](troubleshooting-language-resources.md).

Парадигматические модули для поиска Windows выполняются в локальном контексте безопасности. Они должны быть написаны для корректного управления буферами и их правильного стека. Все копии строк должны иметь явные проверки для защиты от переполнения буфера. Следует всегда проверять выделенный размер буфера и проверять размер данных в соответствии с размером буфера.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Расширение языковых ресурсов](extending-language-resources-in-windows-search.md)
</dt> <dt>

[Основные сведения о компонентах ресурсов языка](understanding-language-resource-components.md)
</dt> <dt>

[Рекомендации по лингвистическим правилам и Юникоду](linguistic-and-unicode-considerations.md)
</dt> <dt>

[Устранение неполадок в языковых ресурсах и рекомендациях](troubleshooting-language-resources.md)
</dt> </dl>

 

 
