---
description: Функции необработанного шифрования обеспечивают резервное копирование зашифрованных файлов.
ms.assetid: 00f9b00e-305d-4554-8b43-7061228c92c3
title: Резервное копирование и восстановление зашифрованных файлов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 34308dbfc0f67a1fcf9a70f1f7a5878434018494fa1450d308fa493af78226ca
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119766184"
---
# <a name="backup-and-restore-of-encrypted-files"></a>Резервное копирование и восстановление зашифрованных файлов

Шифрованная файловая система (EFS) (EFS) фильтрует Открытие зашифрованного файла таким образом, чтобы приложение, которое открыло файл, получило доступ к незашифрованным сведениям, если, конечно, у него есть правильные учетные данные для доступа к файлу и получить ключ, необходимый для расшифровки файла. Последующие операции чтения в этом файле будут давать незашифрованный текст. Это очень желательно для обычного доступа к зашифрованным файлам и обеспечивает прозрачность шифрования и расшифровки файлов. Однако это мешает резервному копированию зашифрованных файлов, поскольку при попытке резервного копирования с помощью стандартных вызовов файлового ввода-вывода, таких как [**CreateFile**](/windows/desktop/api/FileAPI/nf-fileapi-createfilea), [**ReadFile**](/windows/desktop/api/FileAPI/nf-fileapi-readfile)и [**WriteFile**](/windows/desktop/api/FileAPI/nf-fileapi-writefile), файлы с резервным копированием будут иметь версию обычного текста.

Для решения этой проблемы предоставляются функции необработанного шифрования. Приложения резервного копирования являются основным предполагаемым пользователем для этих функций. Необработанные функции шифрования отличаются от других функций файловой системы тем, что функции Open, Read и Write предоставляют доступ к необработанным зашифрованным потокам данных, а также разрешают чтение и запись $EFS потока. Таким образом, вызывающему объекту функций необработанного шифрования не требуется доступ к криптографическим ключам, которые расшифровываются файл. Следующие интерфейсы API необработанного шифрования доступны для использования с приложениями резервного копирования и восстановления: 

| API необработанного шифрования                                     | Описание                                                                                                                                                                                                                                                                   |
|--------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**опененкриптедфилерав**](/windows/desktop/api/WinBase/nf-winbase-openencryptedfilerawa)   | Откройте зашифрованный файл с доступом к данным в зашифрованном формате. Если вызывающий объект не имеет доступа к ключу для файла, вызывающему объекту необходимо [себаккуппривилеже](/windows/desktop/SecAuthZ/authorization-constants) экспортировать зашифрованные файлы или сересторепривилеже для импорта зашифрованных файлов. |
| [**клосинкриптедфилерав**](/windows/desktop/api/WinBase/nf-winbase-closeencryptedfileraw) | Закрытие зашифрованного файла, открытого с помощью [ **опененкриптедфилерав**](/windows/desktop/api/WinBase/nf-winbase-openencryptedfilerawa)                                                                                                                                                                                      |
| [**реаденкриптедфилерав**](/windows/desktop/api/WinBase/nf-winbase-readencryptedfileraw)   | Чтение зашифрованного файла, оставляемого данными в зашифрованном формате                                                                                                                                                                                                                   |
| [**вритинкриптедфилерав**](/windows/desktop/api/WinBase/nf-winbase-writeencryptedfileraw) | Запись зашифрованного файла, оставляемого данными в зашифрованном формате                                                                                                                                                                                                                  |
| [**импорткаллбакк**](/windows/desktop/api/WinBase/nc-winbase-pfe_import_func)               | Определяемый приложением обратный вызов для использования с [ **вритинкриптедфилерав**](/windows/desktop/api/WinBase/nf-winbase-writeencryptedfileraw)                                                                                                                                                                              |
| [**експорткаллбакк**](/windows/desktop/api/WinBase/nc-winbase-pfe_export_func)               | Определяемый приложением обратный вызов для использования с [ **реаденкриптедфилерав**](/windows/desktop/api/WinBase/nf-winbase-readencryptedfileraw)                                                                                                                                                                                |



 

 

 
