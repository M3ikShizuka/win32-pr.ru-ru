---
description: В этом разделе обсуждаются альтернативы использованию транзакционного API NTFS (TxF) в общих сценариях использования.
ms.assetid: 9ee26e7e-990e-4cd3-8180-f0fcaac2b752
title: Альтернативы использованию транзакционной NTFS
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: cc69974f27abfba0323ea4d3f16a720e5e99e69d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105683184"
---
# <a name="alternatives-to-using-transactional-ntfs"></a>Альтернативы использованию транзакционной NTFS

-   [Выделяет](#abstract)
-   [Введение](#introduction)
-   [Альтернативы для TxF по сценарию](#alternatives-to-txf-by-scenario)
-   [Приложения обновляют один файл с данными, подобными документу](#applications-updating-a-single-file-with-document-like-data)
-   [Приложения, выполняющие обновление нескольких файлов и (или) в кусте реестра](#applications-performing-updates-to-multiple-files-andor-to-the-registry-hive)
-   [Приложения, управляющие набором структурированных данных](#applications-managing-a-set-of-structured-data)
-   [Приложения с транзакциями, включающими файлы на локальном томе NTFS и таблицах во внешней базе данных SQL](#applications-with-transactions-involving-files-on-a-local-ntfs-volume-and-tables-in-an-external-sql-database)
-   [Закрывается рекомендуемое действие &](/windows)

## <a name="abstract"></a>Аннотация

Корпорация Майкрософт настоятельно рекомендует разработчикам исследовать использование обсуждаемых альтернатив (или в некоторых случаях исследовать другие альтернативы) вместо внедрения платформы API, которая может быть недоступна в будущих версиях Windows.

## <a name="introduction"></a>Введение

Система TxF появилась в Windows Vista как средство для появления атомарных файловых транзакций в Windows. Он позволяет разработчикам Windows иметь транзакционную атомарность для файловых операций в транзакциях с одним файлом, в транзакциях, включающих несколько файлов, а также в транзакциях, охватывающих несколько источников, таких как реестр (через TxR) и базы данных (например, SQL). Несмотря на то, что TxF является мощным набором интерфейсов API, в этой платформе API было чрезвычайно ограниченный интерес разработчика, так как Windows Vista в основном обусловлен ее сложностью и различными нюансами, которые разработчики должны учитывать в процессе разработки приложений. В результате корпорация Майкрософт рассматривает нерекомендуемые API TxF в будущей версии Windows, чтобы сконцентрировать усилия на разработке и обслуживании на других функциях и интерфейсах API, которые имеют больше возможностей для большей части клиентов. В следующем разделе приводятся примеры альтернативных методов для достижения аналогичных результатов, так как TxF может быть в нескольких типах сценариев приложений.

## <a name="alternatives-to-txf-by-scenario"></a>Альтернативы для TxF по сценарию

С учетом описанных выше ограничений разработчики должны исследовать альтернативы для TxF, чтобы охватить сценарии приложений, которые не соответствуют TxF. Здесь описаны некоторые из предлагаемых альтернативных вариантов использования TxF для разработчиков. Обратите внимание, что этот список не является ни исчерпывающим, ни полным.

## <a name="applications-updating-a-single-file-with-document-like-data"></a>Приложения обновляют один файл с данными, подобными документу

Многие приложения, работающие с данными, сходными с документами, обычно загружают весь документ в память, работают с ним, а затем записывают его обратно, чтобы сохранить изменения. Требуемая Атомарность здесь заключается в том, что изменения либо полностью применены, либо вообще не применяются, так как непротиворечивое состояние приведет к повреждению файла. Обычным подходом является запись документа в новый файл, а затем замена исходного файла на новый. Один из способов сделать это с помощью API [**реплацефиле**](/windows/desktop/api/WinBase/nf-winbase-replacefilea) .

## <a name="applications-performing-updates-to-multiple-files-andor-to-the-registry-hive"></a>Приложения, выполняющие обновление нескольких файлов и (или) в кусте реестра

Существует множество приложений, которым необходимо выполнить атомарное обновление набора файлов и реестра. Чаще всего этот сценарий достигается с помощью приложения установщика, такого как установщик Windows. Дополнительные сведения о установщик Windows см. в разделе [установщик Windows](/windows/desktop/Msi/windows-installer-portal).

## <a name="applications-managing-a-set-of-structured-data"></a>Приложения, управляющие набором структурированных данных

Многие приложения управляют некоторым набором собственных структур данных различных типов как средства хранения данных. Значительная сложность этих приложений — это процесс поддержания целостности внутренних указателей и ссылок в случае сбоя во время операции обновления. Создание механизма для этого, по крайней мере, является «жесткой проблемой», поэтому большинство приложений полагаются на истинный сервер базы данных для управления набором данных.

Ниже приведены два предложения по управлению структурированными данными.

-   Корпорация Майкрософт предоставляет в Windows папку "Входящие" подсистемы ESE, которая позволяет приложениям выполнять операции обновления и получения данных транзакций. Дополнительные сведения о подсистеме расширенного хранилища (ESE) см. в разделе <https://msdn.microsoft.com/library/gg269259.aspx> .
-   Для приложений, которым требуется более мощный, надежный и масштабируемый поставщик баз данных, рекомендуется использовать функцию FILESTREAM, доступную в Microsoft SQL Server. Дополнительные сведения о SQL FILESTREAM см. в разделе <https://technet.microsoft.com/library/bb933993.aspx> .

## <a name="applications-with-transactions-involving-files-on-a-local-ntfs-volume-and-tables-in-an-external-sql-database"></a>Приложения с транзакциями, включающими файлы на локальном томе NTFS и таблицах во внешней базе данных SQL

Существуют классы приложений, которые либо имеют большие объемы набора данных, либо должны иметь атомарность транзакций в операции, включающей внешнюю базу данных и локальное хранилище. В этом сценарии настоятельно рекомендуется, чтобы разработчики рассматривали использование SQL FILESTREAM для выполнения транзакционных файловых операций. Дополнительные сведения о SQL FILESTREAM см. в разделе <https://technet.microsoft.com/library/bb933993.aspx> .

## <a name="closing--recommended-action"></a>Закрывается рекомендуемое действие &

TxF — это сложный и набор интерфейсов API, которые обычно не используются сторонними приложениями. Благодаря возможности, что эти API могут быть недоступны в будущих версиях Windows, и что существует более простое альтернативное средство для выполнения многих сценариев, для которых была разработана система TxF, корпорация Майкрософт настоятельно рекомендует разработчикам исследовать эти альтернативные средства вместо создания зависимости от TxF в своих приложениях.

 

 
