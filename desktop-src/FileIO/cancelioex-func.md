---
description: Помечает все необработанные операции ввода-вывода для указанного маркера файла. Функция отменяет только операции ввода-вывода в текущем процессе, независимо от того, какой поток создал операцию ввода-вывода.
ms.assetid: a2ce13b8-7da6-4848-848d-901d9667c2e3
title: Функция Канцелиоекс (Иоапи. h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- CancelIoEx
api_type:
- DllExport
api_location:
- Kernel32.dll
- API-MS-Win-Core-io-l1-1-0.dll
- KernelBase.dll
- MinKernelBase.dll
- API-MS-Win-Core-io-l1-1-1.dll
- api-ms-win-downlevel-kernel32-l1-1-0.dll
ms.openlocfilehash: 3726bf221073f33d87481d7a6bb6f2f4fd459812616975fba38d9a9a8f0334ec
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119582614"
---
# <a name="cancelioex-function"></a>Функция Канцелиоекс

Помечает все необработанные операции ввода-вывода для указанного маркера файла. Функция отменяет только операции ввода-вывода в текущем процессе, независимо от того, какой поток создал операцию ввода-вывода.

## <a name="syntax"></a>Синтаксис


```C++
BOOL WINAPI CancelIoEx(
  _In_     HANDLE       hFile,
  _In_opt_ LPOVERLAPPED lpOverlapped
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*hFile* \[ окне\]
</dt> <dd>

Маркер файла.

</dd> <dt>

*лповерлаппед* \[ в необязательное\]
</dt> <dd>

Указатель на структуру данных с [**ПЕРЕкрытием**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) , содержащую данные, используемые для асинхронного ввода-вывода.

Если этот параметр имеет **значение NULL**, все запросы ввода-вывода для параметра *hFile* отменяются.

Если этот параметр не равен **null**, только определенные запросы ввода-вывода, выданные для файла с указанной структурой *лповерлаппед* OVERLAPPED, помечаются как отмененные. Это означает, что можно отменить один или несколько запросов, а функция [**канцелио**](cancelio.md) отменяет все необработанные запросы к файлу.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Если функция выполняется успешно, возвращается ненулевое значение. Запрошена операция отмены для всех ожидающих операций ввода-вывода, выданных вызывающим процессом для указанного маркера файла. Приложение не должно освобождать или повторно использовать структуру [**OVERLAPPED**](/windows/desktop/api/minwinbase/ns-minwinbase-overlapped) , связанную с отмененными операциями ввода-вывода, пока они не будут завершены. Поток может использовать функцию [**GetOverlappedResult**](/windows/desktop/api/ioapiset/nf-ioapiset-getoverlappedresult) , чтобы определить, когда завершаются операции ввода-вывода.

Если функция завершается ошибкой, возвращается значение 0 (ноль). Чтобы получить расширенные сведения об ошибке, вызовите функцию [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) .

Если эта функция не может найти запрос на отмену, возвращаемое значение равно 0 (нулю), а [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) возвращает **ошибку \_ не \_ удалось**.

## <a name="remarks"></a>Remarks

Функция **канцелиоекс** позволяет отменять запросы в потоках, отличных от вызывающего потока. Функция [**канцелио**](cancelio.md) отменяет запросы только в том же потоке, который вызвал функцию **канцелио** . **Канцелиоекс** отменяет только что необработанные операции ввода-вывода для маркера, он не изменяет состояние маркера. Это означает, что вы не можете полагаться на состояние маркера, так как вы не можете определить, завершилась ли операция успешно или отменена.

Если для указанного маркера файла выполняются ожидающие операции ввода-вывода, функция **канцелиоекс** помечает их для отмены. Большинство типов операций могут быть отменены немедленно. другие операции могут продолжать выполнение до того, как они будут фактически отменены, а вызывающий будет уведомлен. Функция **канцелиоекс** не ждет завершения всех отмененных операций.

Если этот файл связан с портом завершения, пакет завершения ввода-вывода не помещается в очередь порта, если синхронная операция была успешно отменена. Для асинхронных операций, которые все еще ожидают, операция отмены будет ставить в очередь пакет завершения ввода-вывода.

Операция, для которой выполняется отмена, завершена с одним из трех состояний; чтобы определить состояние завершения, необходимо проверить состояние завершения. Три состояния:

-   Операция выполнена нормально. Это может произойти, даже если операция была отменена, так как запрос отмены мог быть не отправлен вовремя, чтобы отменить операцию.
-   Операция была отменена. Функция [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) возвращает **сообщение об ошибке " \_ операция была \_ прервана**".
-   Операция завершилась с другой ошибкой. Функция [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror) возвращает соответствующий код ошибки.

в Windows 8 и Windows Server 2012 эта функция поддерживается следующими технологиями.



| Технология                                           | Поддерживается      |
|------------------------------------------------------|----------------|
| Протокол SMB 3,0<br/>   | Да<br/> |
| Прозрачная отработка отказа SMB 3,0 (ОТРАБОТКА отказа)<br/>        | Да<br/> |
| SMB 3,0 с масштабируемыми файловыми ресурсами (SO)<br/>   | Да<br/> |
| Общий том кластераная файловая система (CsvFS)<br/> | Да<br/> |
| Восстанавливаемая файловая система (ReFS)<br/>              | Да<br/> |



 

## <a name="requirements"></a>Requirements (Требования)



| Требование | Значение |
|-------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows \[Приложения UWP для классических приложений Vista \|\]<br/>                                                                                                                                                                                                                   |
| Минимальная версия сервера<br/> | Windows \[Приложения UWP для классических приложений сервера 2008 \|\]<br/>                                                                                                                                                                                                             |
| Заголовок<br/>                   | <dl> <dt>иоапи. h (включает Windows. h);</dt> <dt>винбасе. h на Windows server 2008 R2, Windows 7, Windows Server 2008 и Windows Vista (включая Windows. h)</dt> </dl> |
| Библиотека<br/>                  | <dl> <dt>Kernel32.lib</dt> </dl>                                                                                                                                                                                 |
| DLL<br/>                      | <dl> <dt>Kernel32.dll</dt> </dl>                                                                                                                                                                                 |



## <a name="see-also"></a>См. также

<dl> <dt>

[**канцелио**](cancelio.md)
</dt> <dt>

[**канцелсинчронаусио**](cancelsynchronousio-func.md)
</dt> <dt>

[Отмена ожидающих операций ввода-вывода](canceling-pending-i-o-operations.md)
</dt> <dt>

[Функции управления файлами](file-management-functions.md)
</dt> <dt>

[Синхронный и асинхронный ввод-вывод](synchronous-and-asynchronous-i-o.md)
</dt> </dl>

 

