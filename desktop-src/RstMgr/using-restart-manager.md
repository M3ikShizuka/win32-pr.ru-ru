---
title: Использование диспетчера перезапуска
description: В следующих разделах описывается использование API диспетчера перезапуска.
ms.assetid: 78448d5e-20f6-45b6-b833-7d7791e5e4c6
keywords:
- Перезапустите диспетчер перезапуска диспетчера, с помощью
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6e4ac72edb9f2395bbd67236806c3ab3029372cc
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "103890961"
---
# <a name="using-restart-manager"></a>Использование диспетчера перезапуска

В следующих разделах описывается использование API диспетчера перезапуска. Приложения и службы также должны следовать [рекомендациям для приложений и служб](guidelines-for-applications-and-services.md).

## <a name="using-the-microsoft-windows-installer"></a>Использование установщик Windows Майкрософт

[Microsoft установщик Windows](/windows/desktop/Msi/windows-installer-portal) версии 4,0 — это служба установки приложений Windows Vista или windows Server 2008. Приложения, использующие установщик Windows версии 4,0 для установки и обслуживания, автоматически используют диспетчер перезапуска для уменьшения числа перезапусков системы. Пользовательские установщики также могут вызывать API диспетчера перезапуска для завершения работы и перезапуска приложений и служб непосредственно во избежание перезагрузки системы. В случаях, когда перезапуск системы недоступен, установщики могут использовать функцию [**инитиатешутдовн**](/windows/desktop/api/winreg/nf-winreg-initiateshutdowna) или [**ExitWindowsEx**](/windows/desktop/api/winuser/nf-winuser-exitwindowsex) , чтобы запланировать ее таким образом, чтобы минимизировать перерывы в работе пользователя. Интерактивные установщик Windows пакеты должны реализовывать пользовательский интерфейс, который включает в себя диалоговое окно [мсирмфилесинусе](/windows/desktop/Msi/msirmfilesinuse-dialog) . Дополнительные сведения см. в разделе [использование установщик Windows с диспетчером перезапуска](/windows/desktop/Msi/using-windows-installer-with-restart-manager) в документации по пакету SDK для установщик Windows.

## <a name="using-the-restart-manager-api-with-custom-installers"></a>Использование API диспетчера перезапуска с пользовательскими установщиками

Пользовательские установщики или пакет установщик Windows, содержащий настраиваемые действия, вызывающие перезагрузку системы, могут использовать API диспетчера перезапуска для завершения работы и перезапуска приложений и служб.

-   Все операции, выполняемые с помощью API диспетчера перезапуска, должны быть связаны с сеансом. В системе одновременно может быть открыто не более 64 сеансов диспетчера перезапуска на каждый сеанс пользователя. Основной установщик запускается и завершает сеанс диспетчера перезапуска. Дополнительные сведения об использовании диспетчера перезапуска с одним установщиком см. в разделе [Использование диспетчера перезапуска с основным установщиком](using-restart-manager-with-a-primary-installer.md).
-   При необходимости в процессе установки один или несколько вторичных установщиков могут быть присоединены к сеансу диспетчера перезапуска и могут выполняться как внутри процесса, так и вне процесса основного установщика. Вторичным установщикам требуется, чтобы ключ сеанса был предоставлен основным установщиком для приподключения к сеансу. Дополнительные сведения и пример использования вторичных установщиков см. в статье [Использование диспетчера перезапуска с дополнительными установщиками](using-restart-manager-with-a-secondary-installer.md).
-   Интерактивные установщики должны реализовывать пользовательский интерфейс, включающий в себя диалоговое окно [мсирмфилесинусе](/windows/desktop/Msi/msirmfilesinuse-dialog) , которое может попросить пользователей закрыть приложения и службы. Дополнительные сведения см. в разделе [использование установщик Windows с диспетчером перезапуска](/windows/desktop/Msi/using-windows-installer-with-restart-manager) в документации по пакету SDK для установщик Windows.
-   Установщики могут вызывать API диспетчера перезапуска для изменения, отмены и получения состояния текущей операции диспетчера перезапуска. Дополнительные сведения см. в следующих разделах: [Получение состояния операции диспетчера перезапуска](getting-the-status-of-a-restart-manager-operation.md) и [Отмена текущей операции диспетчера перезапуска](canceling-the-current-restart-manager-operation.md).
-   Установщики не должны отключать перенаправление файловой системы перед вызовом API диспетчера перезапуска. Некоторые 32-разрядные установщики, выполняемые в 64-разрядной версии Windows, могут не зарегистрировать файл в каталоге% WINDIR% \\ System32.

 

 