---
description: Чтобы определить тип события устройства при обработке \_ сообщения WM девицечанже, изучите параметр wParam.
ms.assetid: 17078548-879d-4a11-a268-27d1f30180ab
title: Типы событий устройств
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 35ece6b810ba4d1310638bbfbdcdcaa7f67f79d8
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127164436"
---
# <a name="device-event-types"></a>Типы событий устройств

Чтобы определить тип события устройства при обработке сообщения [**WM \_ девицечанже**](wm-devicechange.md) , изучите параметр *wParam* . Значение параметра *wParam* определяет значение данных, относящихся к событию, в параметре *lParam* . В общем случае данные, относящиеся к конкретному событию, идентифицируют устройство и предоставляют дополнительные сведения о событии. Формат этих данных зависит от типа устройства, но первые несколько байтов всегда имеют тот же формат, что и структура [**\_ \_ HDR-вещания для разработки**](/windows/desktop/api/Dbt/ns-dbt-dev_broadcast_hdr) . Чтобы определить формат данных, проверьте элемент **дбч \_ типа устройства** .

Система передает событие устройства типа [ДБТ \_ девицеарривал](dbt-devicearrival.md) (то есть сообщение [**WM \_ девицечанже**](wm-devicechange.md) с параметром *wParam* , установленным в ДБТ \_ девицеарривал) всякий раз, когда устройство вставлено и доступно для использования. Обычно приложения проверяют тип устройства и начинают использовать устройство немедленно, если оно подходит.

Система передает событие [ДБТ \_ девицекуериремове](dbt-devicequeryremove.md) Device, чтобы запросить разрешение на удаление устройства. Чтобы определить, требуется ли устройство, приложение может отобразить диалоговое окно, предлагающее пользователю ввести инструкции. Если приложение определяет, что ему требуется устройство, оно может отклонить этот запрос и отменить удаление, возвращая ШИРОКОВЕЩАТЕЛЬный \_ запрос \_ Deny. Если приложению не требуется устройство, оно должно возвращать **значение true**. Система немедленно отправляет сообщение [ДБТ \_ девицекуериремовефаилед](dbt-devicequeryremovefailed.md) , если какое-либо приложение или драйвер отменили предыдущий запрос на удаление устройства.

Система передает событие [ДБТ \_ девицеремовепендинг](dbt-deviceremovepending.md) Device в виде последнего предупреждения перед удалением устройства. На этом этапе приложение не может отменить удаление, поэтому, если оно использует устройство, оно должно подготовиться к его удалению, чтобы предотвратить потери данных. Это особенно важно при удалении сетевого подключения. Приложение должно определить, подключены ли к нему какие либо открытые файлы или каналы. Это можно сделать, сравнив идентификатор сетевого ресурса в данных сообщения, относящихся к конкретному событию, с идентификаторами ресурсов, полученными ранее для файлов и каналов. Система передает событие устройства [ДБТ \_ девицеремовекомплете](dbt-deviceremovecomplete.md) , когда устройство было удалено и больше не доступно.

Система передает событие [ДБТ \_ куеричанжеконфиг](dbt-querychangeconfig.md) Device, чтобы запросить разрешение на изменение текущей конфигурации (закрепление или Отстыковка). Любое приложение может вернуть ШИРОКОВЕЩАТЕЛЬный \_ запрос \_ Deny, чтобы отклонить запрос и отменить изменение. Если приложение отклоняет запрос, система отправляет сообщение [ДБТ \_ конфигчанжеканцелед](dbt-configchangecanceled.md) . Если текущая конфигурация изменилась из-за закрепления или отстыковки, система отправляет сообщение [ДБТ \_ конфигчанжед](dbt-configchanged.md) .

Система передает событие [ДБТ \_ девицетипеспеЦифик](dbt-devicetypespecific.md) Device при возникновении определенного события устройства.

Драйверы могут создавать собственные типы пользовательских событий. Пользовательские события отправляются только в приложение, которое зарегистрировано для уведомления о событиях устройства на определенном устройстве и может инициироваться только драйверами режима ядра. Дополнительные сведения см. в разделе [ДБТ \_ CUSTOMEVENT](dbt-customevent.md).

 

 



