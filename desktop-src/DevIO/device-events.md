---
description: Приложения, включая службы, могут регистрироваться для получения уведомлений о событиях устройства.
ms.assetid: c89da4ac-57dd-4d95-ac86-3eb137dee0bc
title: События устройства (Иоевент. h)
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: a44e6160ef3a59821e5d2b2a3d4e42ee1d14d5c2fb7deda689fb1c9c3186b428
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119076258"
---
# <a name="device-events-ioeventh"></a>События устройства (Иоевент. h)

Приложения, включая службы, могут регистрироваться для получения уведомлений о событиях устройства. Например, служба каталога может получить уведомление о том, что тома подключены или отключены, чтобы можно было настроить пути к файлам на томе. Система уведомляет приложение о том, что произошло событие устройства, отправив приложению сообщение [**\_ девицечанже WM**](wm-devicechange.md) . Система уведомляет службу о том, что произошло событие устройства, вызывая функцию обработчика событий службы [**хандлерекс**](/windows/desktop/api/winsvc/nc-winsvc-lphandler_function_ex).

Чтобы получить уведомления о событиях устройства, вызовите функцию [**регистердевиценотификатион**](/windows/desktop/api/Winuser/nf-winuser-registerdevicenotificationa) с помощью [**структуры \_ \_ обработчика вещания для dev**](/windows/desktop/api/Dbt/ns-dbt-dev_broadcast_handle) . Не забудьте задать для **элемента \_ Handle дбч** маркер устройства, полученный из функции [**CreateFile**](/windows/desktop/api/fileapi/nf-fileapi-createfilea) . Кроме того, присвойте элементу **\_ типа устройства Дбч** значение **ДБТ \_ девтип \_**. Функция возвращает маркер уведомления устройства. Обратите внимание, что это не то же самое, что и маркер тома.

Когда приложение получает уведомление, если тип события — [ДБТ \_ CUSTOMEVENT](dbt-customevent.md), возможно, вы получили одно из событий устройства, определенных в иоевент. h. Чтобы определить, произошло ли одно из этих событий, выполните следующие действия.

1.  Рассматривайте данные события как структуру [**\_ \_ HDR**](/windows/desktop/api/Dbt/ns-dbt-dev_broadcast_hdr) -данных для разработки. Убедитесь, что для элемента **\_ типа устройства дбч** задано значение **ДБТ \_ девтип \_ Handle**.
2.  Если **дбч \_ типа устройства** **ДБТ \_ девтип \_**, то данные события являются указателем на структуру [**\_ \_ обработчика вещания для разработки**](/windows/desktop/api/Dbt/ns-dbt-dev_broadcast_handle) .
3.  Сравните элемент **\_ евентгуид Дбч** с **идентификаторами GUID**, перечисленными в следующей таблице, с помощью функции [**исекуалгуид**](/windows/win32/api/guiddef/nf-guiddef-isequalguid) .

<dl> <dt>

<span id="GUID_IO_CDROM_EXCLUSIVE_LOCK"></span><span id="guid_io_cdrom_exclusive_lock"></span>**GUID \_ операций ввода-вывода с \_ \_ монопольной \_ блокировкой**
</dt> <dd> <dl> <dt>

bc56c139-7a10-47ee-a294-4c6a38f0149a
</dt> <dt>



Устройство чтения компакт-дисков заблокировано для монопольного доступа.

**Windows Server 2003 и Windows XP:** Для поддержки этого значения требуется IMAPI 2,0. Дополнительные сведения см. в разделе API для создания [образов](/windows/desktop/imapi/portal).


</dt> </dl> </dd> <dt>

<span id="GUID_IO_CDROM_EXCLUSIVE_UNLOCK"></span><span id="guid_io_cdrom_exclusive_unlock"></span>**GUID \_ операций ввода-вывода с \_ \_ эксклюзивным доступом \_**
</dt> <dd> <dl> <dt>

a3b6d27d-5e35-4885-81e5-ee18c00ed779
</dt> <dt>



Устройство чтения компакт-дисков, заблокированное для монопольного доступа, было разблокировано.

**Windows Server 2003 и Windows XP:** Для поддержки этого значения требуется IMAPI 2,0. Дополнительные сведения см. в разделе API для создания [образов](/windows/desktop/imapi/portal).


</dt> </dl> </dd> <dt>

<span id="GUID_IO_DEVICE_BECOMING_READY"></span><span id="guid_io_device_becoming_ready"></span>**\_устройство ввода-вывода GUID \_ \_ становится \_ готовым**
</dt> <dd> <dl> <dt>

d07433f0-a98e-11d2-917a-00a0c9068ff3
</dt> <dt>



Выполняется регулятор мультимедиа.


</dt> </dl> </dd> <dt>

<span id="GUID_IO_DEVICE_EXTERNAL_REQUEST"></span><span id="guid_io_device_external_request"></span>**\_ \_ \_ внешний запрос устройства ввода-вывода GUID \_**
</dt> <dd> <dl> <dt>

d07433d0-a98e-11d2-917a-00a0c9068ff3
</dt> <dt>



Существует несколько возможных причин этого события. Дополнительные сведения см. в разделе Спецификация T10 MMC команды уведомления о состоянии события в [https://www.t10.org/](https://www.t10.org/) .


</dt> </dl> </dd> <dt>

<span id="GUID_IO_MEDIA_ARRIVAL"></span><span id="guid_io_media_arrival"></span>**\_ \_ Получение носителя с идентификатором GUID ввода-вывода \_**
</dt> <dd> <dl> <dt>

d07433c0-a98e-11d2-917a-00a0c9068ff3
</dt> <dt>



На устройство добавлен съемный носитель. Элемент **\_ данных дбч** является указателем на структуру [**\_ \_ \_ контекста изменения мультимедиа класса**](/windows/desktop/api/WinIoCtl/ns-winioctl-class_media_change_context) . Элемент **NewState** предоставляет сведения о состоянии. Например, значение **медиаунаваилабле** указывает, что носитель недоступен (например, из-за активного сеанса записи).

**Windows XP:** Элемент **\_ данных дбч** — это значение типа **ulong** , представляющее количество изменений мультимедиа с момента запуска системы.


</dt> </dl> </dd> <dt>

<span id="GUID_IO_MEDIA_EJECT_REQUEST"></span><span id="guid_io_media_eject_request"></span>**\_запрос на \_ \_ Извлечение носителя GUID ввода-вывода \_**
</dt> <dd> <dl> <dt>

d07433d1-a98e-11d2-917a-00a0c9068ff3
</dt> <dt>



Устройство съемного носителя получило от пользователя запрос на извлечение указанного слота или носителя.


</dt> </dl> </dd> <dt>

<span id="GUID_IO_MEDIA_REMOVAL"></span><span id="guid_io_media_removal"></span>**GUID \_ операции \_ \_ удаления носителя**
</dt> <dd> <dl> <dt>

d07433c1-a98e-11d2-917a-00a0c9068ff3
</dt> <dt>



Съемный носитель был удален с устройства или недоступен. Элемент **\_ данных дбч** является указателем на структуру [**\_ \_ \_ контекста изменения мультимедиа класса**](/windows/desktop/api/WinIoCtl/ns-winioctl-class_media_change_context) . Элемент **NewState** предоставляет сведения о состоянии. Например, значение **медиаунаваилабле** указывает, что носитель недоступен (например, из-за активного сеанса записи).

**Windows XP:** Элемент **\_ данных дбч** — это значение типа **ulong** , представляющее количество изменений мультимедиа с момента запуска системы.


</dt> </dl> </dd> <dt>

<span id="GUID_IO_VOLUME_CHANGE"></span><span id="guid_io_volume_change"></span>**GUID \_ \_ изменение тома ввода-вывода \_**
</dt> <dd> <dl> <dt>

7373654a-812a-11d0-bec7-08002be2092f
</dt> <dt>



Метка тома изменена.


</dt> </dl> </dd> <dt>

<span id="GUID_IO_VOLUME_CHANGE_SIZE"></span><span id="guid_io_volume_change_size"></span>**\_Размер GUID \_ для \_ изменения тома ввода-вывода \_**
</dt> <dd> <dl> <dt>

3a1625be-ad03-49f1-8ef8-6bbac182d1fd
</dt> <dt>



Изменился размер файловой системы на томе.

**Windows Server 2003 и Windows XP:** Это значение не поддерживается.


</dt> </dl> </dd> <dt>

<span id="GUID_IO_VOLUME_DISMOUNT"></span><span id="guid_io_volume_dismount"></span>**GUID \_ \_ отключения тома ввода-вывода \_**
</dt> <dd> <dl> <dt>

d16a55e8-1059-11d2-8ffd-00a0c9a06d32
</dt> <dt>



Выполняется попытка отключения тома. Необходимо закрыть все дескрипторы файлов и каталогов на томе. Этому событию не обязательно предшествует событие **\_ \_ \_ блокировки тома ввода-вывода GUID** .


</dt> </dl> </dd> <dt>

<span id="GUID_IO_VOLUME_DISMOUNT_FAILED"></span><span id="guid_io_volume_dismount_failed"></span>**\_ \_ \_ Сбой отключения тома ввода-вывода GUID \_**
</dt> <dd> <dl> <dt>

e3c5b178-105d-11d2-8ffd-00a0c9a06d32
</dt> <dt>



Сбой при отключении тома. Это часто происходит из-за того, что другой процесс не ответил на уведомление об отключении **\_ \_ тома \_ ввода-вывода GUID** , закрывая необработанные дескрипторы. Из-за сбоя отключения вы можете повторно открыть любые дескрипторы для соответствующего тома.


</dt> </dl> </dd> <dt>

<span id="GUID_IO_VOLUME_FVE_STATUS_CHANGE"></span><span id="guid_io_volume_fve_status_change"></span>**\_ \_ \_ \_ изменение состояния ФВЕ тома ввода-вывода GUID \_**
</dt> <dd> <dl> <dt>

062998b2-ee1f-4b6a-b857-e76cbbe9a6da
</dt> <dt>



Состояние шифрование диска BitLocker тома изменилось. Это событие сообщает, когда BitLocker включен или отключен, или когда шифрование начинается, завершается, приостанавливается или возобновляется.

**Windows Server 2003 и Windows XP:** Это значение не поддерживается.


</dt> </dl> </dd> <dt>

<span id="GUID_IO_VOLUME_LOCK"></span><span id="guid_io_volume_lock"></span>**GUID \_ \_ Блокировка тома \_ IO**
</dt> <dd> <dl> <dt>

50708874-c9af-11D1-8fef-00a0c9a06d32
</dt> <dt>



Другой процесс пытается заблокировать том. Необходимо закрыть все дескрипторы файлов и каталогов на томе.


</dt> </dl> </dd> <dt>

<span id="GUID_IO_VOLUME_LOCK_FAILED"></span><span id="guid_io_volume_lock_failed"></span>**\_ \_ \_ сбой блокировки тома ввода-вывода GUID \_**
</dt> <dd> <dl> <dt>

ae2eed10-0ba8-11d2-8ffb-00a0c9a06d32
</dt> <dt>



Сбой при попытке заблокировать том. Это часто происходит из-за того, что другому процессу не удалось ответить на событие **\_ \_ \_ блокировки тома ввода-вывода GUID** , закрыв необработанные дескрипторы. Так как блокировка не удалась, вы можете повторно открыть любые дескрипторы соответствующего тома.


</dt> </dl> </dd> <dt>

<span id="GUID_IO_VOLUME_MOUNT"></span><span id="guid_io_volume_mount"></span>**GUID \_ \_ Подключение тома \_ IO**
</dt> <dd> <dl> <dt>

b5804878-1a96-11d2-8ffd-00a0c9a06d32
</dt> <dt>



Том был подключен другим процессом. Вы можете открыть один или несколько дескрипторов.


</dt> </dl> </dd> <dt>

<span id="GUID_IO_VOLUME_NAME_CHANGE"></span><span id="guid_io_volume_name_change"></span>**\_ \_ \_ изменение имени тома ввода-вывода GUID \_**
</dt> <dd> <dl> <dt>

2de97f83-4c06-11d2-a532-00609713055a
</dt> <dt>



Имя тома было изменено.


</dt> </dl> </dd> <dt>

<span id="GUID_IO_VOLUME_NEED_CHKDSK"></span><span id="guid_io_volume_need_chkdsk"></span>**для \_ тома ввода-вывода GUID \_ \_ требуется \_ chkdsk**
</dt> <dd> <dl> <dt>

799a0960-0a0b-4e03-ad88-2fa7c6ce748a
</dt> <dt>



Файловая система обнаружила повреждение тома. Приложение должно запустить программу CHKDSK на томе или уведомить пользователя о необходимости.

**Windows Server 2003 и Windows XP:** Это значение не поддерживается.


</dt> </dl> </dd> <dt>

<span id="GUID_IO_VOLUME_PHYSICAL_CONFIGURATION_CHANGE"></span><span id="guid_io_volume_physical_configuration_change"></span>**\_ \_ \_ \_ изменение физической конфигурации тома ввода-вывода GUID \_**
</dt> <dd> <dl> <dt>

2de97f84-4c06-11d2-a532-00609713055a
</dt> <dt>



Физическое описывающего или текущее физическое состояние тома изменилось.


</dt> </dl> </dd> <dt>

<span id="GUID_IO_VOLUME_PREPARING_EJECT"></span><span id="guid_io_volume_preparing_eject"></span>**GUID при подготовке к отслеживанию \_ тома ввода-вывода \_ \_ \_**
</dt> <dd> <dl> <dt>

c79eb16e-0dac-4e7a-a86c-b25ceeaa88f6
</dt> <dt>



Файловая система готовит диск для извлечения. Например, файловая система останавливает операцию форматирования в фоновом режиме или закрывает сеанс на носителе с однократным входом.

**Windows Server 2003 и Windows XP:** Это значение не поддерживается.


</dt> </dl> </dd> <dt>

<span id="GUID_IO_VOLUME_UNIQUE_ID_CHANGE"></span><span id="guid_io_volume_unique_id_change"></span>**\_ \_ \_ изменение уникального \_ идентификатора GUID тома ввода-вывода \_**
</dt> <dd> <dl> <dt>

af39da42-6622-41f5-970b-139d092fa3d9
</dt> <dt>



Уникальный идентификатор тома был изменен. Дополнительные сведения о уникальном идентификаторе см. в разделе [**ioctl \_ маунтдев \_ запрос \_ уникального \_ идентификатора**](/windows-hardware/drivers/ddi/content/mountdev/ni-mountdev-ioctl_mountdev_query_unique_id).

**Windows server 2008, Windows Vista, Windows Server 2003 и Windows XP:** это значение не поддерживается до Windows Server 2008 R2 и Windows 7.


</dt> </dl> </dd> <dt>

<span id="GUID_IO_VOLUME_UNLOCK"></span><span id="guid_io_volume_unlock"></span>**GUID \_ \_ разблокировки тома ввода-вывода \_**
</dt> <dd> <dl> <dt>

9a8c3d68-d0cb-11d1-8fef-00a0c9a06d32
</dt> <dt>



Том был разблокирован другим процессом. Вы можете открыть один или несколько дескрипторов.


</dt> </dl> </dd> <dt>

<span id="GUID_IO_VOLUME_WEARING_OUT"></span><span id="guid_io_volume_wearing_out"></span>**GUID \_ \_ людьми тома ввода-вывода \_ \_**
</dt> <dd> <dl> <dt>

873113ca-1486-4508-82ac-c3b2e5297aaa
</dt> <dt>



Носитель людьми. Это событие отправляется, когда файловая система определяет, что частота ошибок в томе слишком высока, или почти исчерпано пространство для замены дефектов.

**Windows Server 2003 и Windows XP:** Это значение не поддерживается.


</dt> </dl> </dd> </dl>

## <a name="remarks"></a>Remarks

События **\_ \_ \_ \_ сбоя** тома ввода-вывода GUID и отключения тома ввода-вывода с кодами GUID отправляются, так же как и событие сбоя блокировки тома ввода- **\_ вывода \_ \_ GUID** и **\_ \_ \_ \_ Блокировка тома ввода-вывода GUID** . **\_ \_ \_** События **\_ \_ \_ блокировки** тома **ввода-вывода GUID и \_ \_ \_ отключения** томов ввода-вывода GUID указывают на попытку выполнения операции. Необходимо принять воееся уведомление о событии и зафиксировать выполняемые действия. **\_ \_ \_ \_ Сбой отключения тома ввода-вывода GUID** и события **\_ \_ \_ \_ сбоя блокировки тома ввода-вывода GUID** указывают на сбой попытки выполнения операции. Затем вы можете использовать запись для отмены действий, выполненных в ответ на операцию.

Элемент **\_ хдевнотифи дбч** структуры [**\_ \_ Handle для dev**](/windows/desktop/api/Dbt/ns-dbt-dev_broadcast_handle) указывает на затронутое устройство. Обратите внимание, что это маркер уведомления устройства, возвращенный [**регистердевиценотификатион**](/windows/desktop/api/Winuser/nf-winuser-registerdevicenotificationa), а не маркер тома. Чтобы выполнить операции с томом, сопоставьте этот обработчик с соответствующим маркером тома.

## <a name="requirements"></a>Requirements (Требования)



| Требование | Значение |
|-------------------------------------|--------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows XP<br/>                                                                |
| Минимальная версия сервера<br/> | Windows Server 2003<br/>                                                       |
| Заголовок<br/>                   | <dl> <dt>Иоевент. h</dt> </dl> |



 

