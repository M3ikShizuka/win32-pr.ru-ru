---
description: Процесс может отслеживать набор событий, происходящих в ресурсе связи. Например, приложение может использовать функцию отслеживания событий, чтобы определить, когда состояние изменения сигнала CTS (Clear-To-Send) и DSR (Ready Data-Set) изменится.
ms.assetid: 5d2a7bf3-a972-474b-b8ca-da3351f1e59c
title: События связи
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 466bd5076405427c7c348c1df3706cb7b5c3edc4
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104141522"
---
# <a name="communications-events"></a>События связи

Процесс может отслеживать набор событий, происходящих в ресурсе связи. Например, приложение может использовать функцию отслеживания событий, чтобы определить, когда состояние изменения сигнала CTS (Clear-To-Send) и DSR (Ready Data-Set) изменится.

Процесс может отслеживать события на данном ресурсе связи с помощью функции [**сеткомммаск**](/windows/desktop/api/Winbase/nf-winbase-setcommmask) для создания маски событий. Чтобы определить текущую маску события для коммуникационного ресурса, процесс может использовать функцию [**жеткомммаск**](/windows/desktop/api/Winbase/nf-winbase-getcommmask) . Следующие значения указывают события, которые можно отслеживать.



| Значение           | Значение                                                                                                                                                                                                                                           |
|-----------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **\_нарушение EV**   | Обнаружен разрыв на входе.                                                                                                                                                                                                                    |
| **EV \_ CTS**     | Состояние сигнала CTS (Clear-To-Send) изменилось.                                                                                                                                                                                                     |
| **EV \_ DSR**     | Состояние сигнала DSR (Data-Set-Ready) изменилось.                                                                                                                                                                                                    |
| **\_Ошибка EV**     | Произошла ошибка состояния строки. Ошибки состояния строки: **CE \_ Frame**, **CE \_**, **\_ ркспарити и CE**.                                                                                                                                        |
| **Звонок в EV \_**    | Обнаружен индикатор вызова.                                                                                                                                                                                                                    |
| **RLSD (EV) \_**    | Состояние сигнала "RLSD (получение-строка-сигнал)" изменилось.                                                                                                                                                                                       |
| **\_РКСЧАР EV**  | Символ получен и помещен во входной буфер.                                                                                                                                                                                          |
| **\_РКСФЛАГ EV**  | Символ события был получен и помещен во входной буфер. Символ события указывается в структуре [**DCB**](/windows/desktop/api/Winbase/ns-winbase-dcb) устройства, которая применяется к последовательному порту с помощью функции [**сеткоммстате**](/windows/desktop/api/Winbase/nf-winbase-setcommstate) . |
| **\_ТКСЕМПТИ EV** | Последний символ в выходном буфере отправлен.                                                                                                                                                                                                 |



 

После указания набора событий процесс использует функцию [**ваиткоммевент**](/windows/desktop/api/Winbase/nf-winbase-waitcommevent) для ожидания одного из событий. **Ваиткоммевент** можно использовать синхронно или в качестве перекрывающейся операции. Дополнительные сведения о выполнении функции в качестве перекрывающихся операций см. в разделе [Синхронизация](/windows/desktop/Sync/synchronization).

При возникновении одного из событий, указанных в маске событий, процесс завершает операцию ожидания и устанавливает переменную маски события для указания типа обнаруженного события. Если [**сеткомммаск**](/windows/desktop/api/Winbase/nf-winbase-setcommmask) вызывается для коммуникационного ресурса, пока ожидается ожидание для этого ресурса, [**ваиткоммевент**](/windows/desktop/api/Winbase/nf-winbase-waitcommevent) возвращает ошибку.

Функция [**ваиткоммевент**](/windows/desktop/api/Winbase/nf-winbase-waitcommevent) обнаруживает события, произошедшие с момента последнего вызова метода [**сеткомммаск**](/windows/desktop/api/Winbase/nf-winbase-setcommmask) или **ваиткоммевент**. Например, если указать событие **EV \_ рксчар** в качестве события, удовлетворяющего ожиданиям, вызов **ваиткоммевент** будет удовлетворен, если в входном буфере драйвера были получены символы, полученные с момента последнего вызова **ваиткоммевент** или **сеткомммаск**. Поэтому, учитывая следующий псевдокод, все символы, полученные между T1 и T2, будут соответствовать следующему вызову **ваиткоммевент**.


```C++
while (!bFinished) 
{ 
    WaitCommEvent(args)
 
T1: // Read bytes 
    // Process bytes 

T2: 
}
```



При наблюдении за событием, происходящим при изменении состояния сигнала (CTS, DSR и т. д.), [**ваиткоммевент**](/windows/desktop/api/Winbase/nf-winbase-waitcommevent) сообщает об изменении, но не о текущем состоянии. Для запроса текущего состояния CTS (Clear-To-Send), DSR (готовность к набору данных), RLSD (Receive-Line-SignalR-Detect) и сигналов индикатора кольца процесс может использовать функцию [**жеткомммодемстатус**](/windows/desktop/api/Winbase/nf-winbase-getcommmodemstatus) .

 

 
