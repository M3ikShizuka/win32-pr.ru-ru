---
description: Сферовые карты среды или географические карты — это специальные текстуры, которые содержат изображение сцены вокруг объекта или эффекты освещения объекта.
ms.assetid: b4a8defc-876f-4a23-a12e-e7423a1e8f89
title: Сопоставление сферического окружения (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e9b0e7aaa123478ecc7cc327dca0b13a8aae3d0c
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127145537"
---
# <a name="spherical-environment-mapping-direct3d-9"></a>Сопоставление сферического окружения (Direct3D 9)

Сферовые карты среды или географические карты — это специальные текстуры, которые содержат изображение сцены вокруг объекта или эффекты освещения объекта. В отличие от сопоставлений в кубических средах, карты сфер не представляют собой окружающую окружение объекта напрямую. В разделе изображение чайник в [сопоставлении среды (Direct3D 9)](environment-mapping.md) показаны эффекты отражения, которые можно достичь с помощью сопоставления сфер. Геообъектная схема — это 2D-представление полного (в 360 градусов) представления сцены вокруг объекта, как показано на следующем рисунке.

![Иллюстрация геообъектной схемы внутри здания](images/spheremap.png)

## <a name="texture-coordinates-for-spherical-environment-maps"></a>координаты текстуры для сферической среды Карты

Координаты текстуры, указываемые для каждой вершины, получающей сопоставление среды, должны обращаться к текстуре в качестве функции отраженного искажения, созданного в кривизне поверхности. Приложения должны вычислять эти координаты текстуры для каждой вершины, чтобы добиться желаемого результата. Один простой и эффективный способ создания координат текстуры использует нормаль вершины в качестве входных данных. Хотя существует несколько методов, в приложениях, выполняющих сопоставление сред с картами Sphere, часто встречается следующее уравнение.

![уравнение вычисления координат текстуры для геообъектной гиперкарты](images/spheremap-formula.png)

В этих формулах вы и v используете вычисленные координаты текстуры, а N<sub>x</sub> и n<sub>Y</sub> — это компоненты X и y вершинного пространства камеры. Формула проста, но эффективна. Если у обычного компонента есть положительный компонент x, нормальная точка накладывается вправо, а координата u корректируется соответствующим образом. Аналогично для координаты v: положительный y означает, что нормальная точка вверх. Противоположное значение верно для отрицательных значений в каждом компоненте.

Если нормальные точки находятся непосредственно на камере, в результирующих координатах не должно быть искажений. Смещение + 0,5 для обеих координат помещает точку нулевого искажения в центр геообъектической схемы, а вершинный нормаль (0, 0, z) — в эту точку. Эта формула не учитывает z-компонент нормали, но приложения, использующие эту формулу, могут оптимизировать вычисления, пропуская вершины с обычным элементом z. Это работает для объектов с плоским затенением, так как в пространстве камеры, если обычные точки из камеры (положительное значение z), вершина исключается при подготовке объекта к просмотру. Для объектов, затененных по методу Гуро, обычная точка может указывать на сторону от камеры (положительный x), а треугольник, содержащий вершину, по-прежнему может быть видимым. Если вы не Вычислите вы и v для этой вершины, то, возможно, он все еще используется, что приведет к непредвиденному поведению.

## <a name="applying-spherical-environment-maps"></a>применение сферического окружения Карты

Вы применяете соответствие среды к объектам так же, как и для любой другой текстуры, настроив текстуру на соответствующую стадию текстуры с помощью метода [**IDirect3DDevice9:: сеттекстуре**](/windows/desktop/api) . Задайте для первого параметра индекс требуемой стадии текстуры и задайте для второго параметра адрес интерфейса [**IDirect3DDevice9**](/windows/win32/api/d3d9helper/nn-d3d9helper-idirect3ddevice9) , возвращаемого при создании текстуры для карты среды. Для достижения требуемых эффектов смешения текстур можно задать цветовую и альфа-операции смешения и аргументы.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Сопоставление окружения](environment-mapping.md)
</dt> </dl>

 

 
