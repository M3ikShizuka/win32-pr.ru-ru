---
description: Управление текстурами — это процесс определения текстур, необходимых для отрисовки в определенный момент времени, и обеспечения загрузки этих текстур в видеопамять.
ms.assetid: ea6d64ee-f570-49eb-b5fd-67fcde3f8ddc
title: Автоматическое управление текстурами (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d0eb14eede197661bc127a062229ebed31274ae8
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103896310"
---
# <a name="automatic-texture-management-direct3d-9"></a>Автоматическое управление текстурами (Direct3D 9)

Управление текстурами — это процесс определения текстур, необходимых для отрисовки в определенный момент времени, и обеспечения загрузки этих текстур в видеопамять. Как и в случае с любым алгоритмом, схемы управления текстурами различаются по сложности, но любой подход к управлению текстурами включает следующие ключевые задачи.

-   Отслеживание объема доступной памяти текстуры.
-   Вычисление текстур, необходимых для подготовки к просмотру, а не.
-   Определение, какие существующие ресурсы текстуры можно загрузить с помощью другого изображения текстуры, и какие поверхности должны быть уничтожены и заменены новыми ресурсами текстуры.

Direct3D реализует управление текстурами, поддерживаемое системой, чтобы обеспечить оптимальную производительность для загрузки текстур. Ресурсы текстуры, которыми управляет Direct3D, называются управляемыми текстурами.

Диспетчер текстуры отслеживает текстуры с меткой времени, которая определяет время последнего использования текстуры. Затем он использует алгоритм наименее недавно использовавшийся, чтобы определить, какие текстуры следует удалить. Приоритеты текстур используются в качестве отсчетных прерываний, если две текстуры предназначены для удаления из памяти. Если две текстуры имеют одинаковое значение приоритета, то будет удалена текстура с наименьшим использованием. Однако если две текстуры имеют одинаковую отметку времени, сначала удаляется текстура с более низким приоритетом.

Вы запрашиваете автоматическое управление текстурой для поверхностей текстуры при их создании. Чтобы получить управляемую текстуру в приложении C++, создайте ресурс текстуры, вызвав [**IDirect3DDevice9:: креатетекстуре**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createtexture) и указав D3DPOOL, \_ управляемую для параметра pool. Вы не можете указать, где должна быть создана текстура. \_При создании управляемой текстуры нельзя использовать флаги D3DPOOL по умолчанию или D3DPOOL \_ системмем. После создания управляемой текстуры можно вызвать метод [**IDirect3DDevice9:: сеттекстуре**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-settexture) , чтобы задать для него этап на текстуре устройства отрисовки каскадом.

Можно назначить приоритет управляемым текстурам, вызвав метод [**IDirect3DResource9:: SetPriority**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dresource9-setpriority) для поверхности текстуры.

Direct3D автоматически скачивает текстуры в видеопамяти по мере необходимости. Система может кэшировать управляемые текстуры в локальной или нелокальной видеопамяти в зависимости от доступности нелокальной видеопамяти или других факторов. Расположение кэша управляемых текстур не передается в ваше приложение, и эти сведения не требуются для использования автоматического управления текстурами. Если приложение использует больше текстур, чем может уместиться в видеопамяти, Direct3D удаляет старые текстуры из видеопамяти, чтобы освободить место для новых текстур. Если вы снова используете удаленную текстуру, система использует исходную поверхность текстуры системной памяти для перезагрузки текстуры в кэш видеопамяти. Хотя перезагрузка текстуры необходима, она также снижает производительность приложения.

Можно динамически изменить исходную копию в памяти системы путем обновления или блокировки ресурса текстуры. Когда система обнаруживает "грязную" поверхность — после завершения обновления или при разблокировании, диспетчер текстур автоматически обновляет копию текстуры в видеопамяти. Снижение производительности похоже на повторную загрузку удаленной текстуры.

При вводе нового уровня в игру приложению может потребоваться сбросить все управляемые текстуры из видеопамяти (путем вызова [**IDirect3DDevice9:: евиктманажедресаурцес**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-evictmanagedresources)).

Дополнительные сведения об управлении ресурсами см. в разделе [Управление ресурсами (Direct3D 9)](managing-resources.md).

## <a name="related-topics"></a>См. также

<dl> <dt>

[Текстуры Direct3D](direct3d-textures.md)
</dt> </dl>

 

 
