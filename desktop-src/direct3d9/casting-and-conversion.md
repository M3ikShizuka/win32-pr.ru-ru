---
description: При передаче значений между ведущим приложением и параметром Effect данные записываются ожидаемым образом, когда исходный тип данных (в ведущем приложении) соответствует целевому типу данных (в параметре Effect).
ms.assetid: 4f3ef14a-7d67-45fe-9282-541221815d1f
title: Приведение и преобразование
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0a9ca806caba09796acc4d0f966926edb9b6a37cf0ab2d40656e7d99f92d5b46
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118097129"
---
# <a name="casting-and-conversion"></a>Приведение и преобразование

При передаче значений между ведущим приложением и параметром Effect данные записываются ожидаемым образом, когда исходный тип данных (в ведущем приложении) соответствует целевому типу данных (в параметре Effect). Если типы данных различаются, то приведение выполняется, когда исходные данные переупорядочиваются в соответствии с местом назначения.

ДКССАС определяет следующие правила преобразования типов. Это надмножество правил преобразования типа Effect (FX) и HLSL. ДКССАС также определяет некоторые [модификаторы значений параметров](#parameter-value-modifiers) , которые могут влиять на значение, которое передается из ведущего приложения в привязанный параметр.

## <a name="type-casting"></a>Приведение типа

В следующей таблице приведен список приведений, которые будут происходить при передаче одного типа данных в другой тип данных:



| Тип источника                                  | Тип назначения                             | Поведение                                                                                                                                                                                                                                                                                                                                                                                                 |
|----------------------------------------------|----------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| FLOAT                                        | INT                                          | Округление к нулю.                                                                                                                                                                                                                                                                                                                                                                                      |
| float, int                                   | bool                                         | Значения, не равные 0, на основе сравнения "не равно" и "0" (int) или 0,0 (float) — считаются истинными, в противном случае значение считается ложным.                                                                                                                                                                                                                                         |
| INT                                          | FLOAT                                        |                                                                                                                                                                                                                                                                                                                                                                                                          |
| bool                                         | int, float                                   | Значение false преобразуется в ноль. Значение true преобразуется в один.                                                                                                                                                                                                                                                                                                                                                     |
| texture1D, texture2D, texture3D, Текстурекубе | текстура                                      | Целевая текстура считается исходным типом текстуры.                                                                                                                                                                                                                                                                                                                                               |
| строка                                       | texture1D, texture2D, texture3D, Текстурекубе | Строковое значение рассматривается как адрес ресурса и разрешается таким же образом, как и [заметка инициализации параметра](parameter-initialization-annotation.md). Если адрес ресурса не может быть разрешен, приведение недопустимо, и ведущие приложения должны возвращать ошибку. Если ресурс разрешается правильно, тип выражения рассматривается как тот же тип, что и разрешенный ресурс. |



 

## <a name="class-casting"></a>Приведение класса

В дополнение к правилам приведения типов, описанным выше, ДКССАС определяет набор правил приведения, необходимых для преобразования типов классов. Матрицы столбцов (N x 1), матрицы строк (1 x N) и числовые структуры рассматриваются как векторы.

Параметры матрицы эффектов и переменные матрицы HLSL могут определять, является ли значение матрицей типа "строка — основная" или "столбец-основная". Однако интерфейсы API DirectX всегда обрабатывают [**D3DMATRIX**](d3dmatrix.md) и [**D3DXMATRIX**](d3dxmatrix.md) как строки.



| Исходный класс | Целевой класс | Поведение                                                                                                                                                                                                                                                                                                                                        |
|--------------|-------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| скалярная       | скалярная            | Примените приведение типов.                                                                                                                                                                                                                                                                                                                             |
| скалярная       | Вектор            | Реплицирует скалярное значение источника в каждый компонент вектора назначения после применения поведения приведения типов и преобразования, описанных в разделе приведение типов.                                                                                                                                                                             |
| скалярная       | Матрица            | Реплицирует скалярное значение источника в каждый компонент целевой матрицы после применения поведения приведения типов и преобразования, описанных в разделе приведение типов.                                                                                                                                                                             |
| скалярная       | Объект            | Недопустимое приведение. Ведущие приложения должны возвращать ошибку.                                                                                                                                                                                                                                                                                           |
| скалярная       | Структура         | Допустим, только если целевая структура содержит только числовые элементы. При допустимости реплицирует скалярное значение источника в каждый компонент целевой структуры после применения поведения приведения типов и преобразования, описанных в разделе приведение типов.                                                                                        |
| Вектор       | скалярная            | Скаляр назначения получает значение первого компонента исходного вектора после применения поведения приведения типов и преобразования, описанных в разделе [приведение типов](#type-casting).                                                                                                                                                       |
| Вектор       | Вектор            | Недопустимое приведение, если вектор назначения содержит больше компонентов, чем исходный вектор. Вектор назначения получает самые левые значения исходного вектора после применения поведения приведения типов и преобразования, описанных в разделе [приведение типов](#type-casting). Оставшиеся справа самые компоненты исходного вектора теряются.             |
| Вектор       | Матрица            | Недопустимое приведение, если только вектор источника не имеет того же числа компонентов, что и Целевая матрица. Если приведение является допустимым, применяется поведение приведения вектора к вектору.                                                                                                                                                             |
| Вектор       | Объект            | Недопустимое приведение. Ведущие приложения должны возвращать ошибку.                                                                                                                                                                                                                                                                                           |
| Вектор       | Структура         | Допустим, только если целевая структура содержит только числовые элементы и не содержит больше элементов, чем у исходного вектора есть компоненты. Элементы целевой структуры получают самые левые компоненты исходного вектора после применения поведения приведения типов и преобразования, описанных в разделе [приведение типов](#type-casting).      |
| Матрица       | скалярная            | Скаляр назначения получает значение верхнего левого значения исходной матрицы после применения поведения приведения типов и преобразования, описанных в разделе [приведение типов](#type-casting).                                                                                                                                                 |
| Матрица       | Вектор            | Недопустимое приведение, если только исходная матрица не имеет того же числа компонентов, что и целевой вектор. Если приведение допустимо, применяется приведенное выше поведение преобразования вектора в вектор.                                                                                                                                                       |
| Матрица       | Матрица            | Недопустимое приведение, если Целевая матрица содержит больше компонентов, чем исходная матрица. Целевая матрица получает верхние левые значения исходной матрицы после применения поведения приведения типов и преобразования, описанных в разделе [приведение типов](#type-casting). Оставшиеся нижние и правые компоненты исходной матрицы теряются. |
| Матрица       | Объект            | Недопустимое приведение. Ведущие приложения должны возвращать ошибку.                                                                                                                                                                                                                                                                                           |
| Матрица       | Структура         | Размер структуры должен быть равен размеру матрицы, а все компоненты структуры должны быть числовыми.                                                                                                                                                                                                                          |
| Объект       | скалярная            | Недопустимое приведение. Ведущие приложения должны возвращать ошибку.                                                                                                                                                                                                                                                                                           |
| Объект       | Вектор            | Недопустимое приведение. Ведущие приложения должны возвращать ошибку.                                                                                                                                                                                                                                                                                           |
| Объект       | Матрица            | Недопустимое приведение. Ведущие приложения должны возвращать ошибку.                                                                                                                                                                                                                                                                                           |
| Объект       | Объект            | Допустим, если типы объектов идентичны и в соответствии с поведением, определенным в [приведении типов](#type-casting).                                                                                                                                                                                                                   |
| Структура    | скалярная            | Допустим, если исходная структура содержит хотя бы один числовой элемент. Скаляр назначения получает значение первого числового элемента исходной структуры после применения поведения приведения типов и преобразования, описанных в разделе [приведение типов](#type-casting).                                                                                |
| Структура    | Вектор            | Исходная структура должна быть не меньше размера вектора. Первые компоненты должны быть в числовом масштабе до размера целевого вектора.                                                                                                                                                                                                    |
| Структура    | Матрица            | Исходная структура должна быть не меньше размера вектора. Первые компоненты должны быть в числовом масштабе до размера целевого вектора.                                                                                                                                                                                                    |
| Структура    | Структура         | Целевая структура не должна быть больше исходной структуры. Для всех соответствующих компонентов источника и назначения должны существовать Допустимые приведения.                                                                                                                                                                                       |



 

## <a name="parameter-value-modifiers"></a>Модификаторы значения параметра

Заметки модификатора параметров добавляют дополнительные сведения в параметр, чтобы данные параметра можно было правильно интерпретировать. Например, вектор может быть выражен с нормализованными данными, а длина может измеряться в дюймах. Заметки модификатора значения параметра выражают эти дополнительные сведения, чтобы ведущие приложения могли правильно преобразовывать значения при передаче данных в параметр Effect.

Это модификаторы параметров:



| Заметки модификатора значения параметра | Описание                                    |
|--------------------------------------|------------------------------------------------|
| [саснормализе](#sasnormalize)        | Укажите, является ли вектор нормализованным. |
| [сасунитс](#sasunits)                | Укажите единицы измерения для параметра.  |



 

### <a name="sasnormalize"></a>саснормализе

Заметка Саснормализе указывает, что связанный параметр должен быть нормализованным значением при каждом назначении. Эта заметка влияет только на параметры float2, float3 и float4.


```
string SasNormalize = "Value";
```



где значение равно true или false.

Пример:


```
float3 UpNormal
<
  bool SasNormalize = "True";
>;
```



### <a name="sasunits"></a>сасунитс

Данные параметра effect находятся в следующих единицах:


```
string SasUnits = "Value";
```



где value является одним из следующих:



| Тип измерения     | Значение        | Описание                    |
|----------------------|--------------|--------------------------------|
| Нет единиц             | пустая строка | Нет единиц                       |
| Расстояние             | ММ           | Миллиметры                    |
|                      | cm           | Сантиметры                    |
|                      | m            | Приборов                         |
|                      | km           | Километры                     |
| Angle                | rad          | Radians                        |
| Время                 | ms           | Миллисекунды                   |
|                      | секунд          | Секунды                        |
|                      | мин.          | Минуты                        |
|                      | ч           | Часы                          |
| Линейная скорость      | мм/с       | Миллиметры в секунду         |
|                      | cm/с       | Сантиметров в секунду         |
|                      | м/с        | Количество метров в секунду              |
|                      | м/ч         | Количество метров в час                |
|                      | км/ч        | Километры в час            |
| Линейное ускорение  | mm/с ²      | Число миллиметров в секунду в квадрате |
|                      | cm/сек ²      | Сантиметров в секунду в квадрате |
|                      | м/с ²       | Число метрах в секунду в квадрате      |
|                      | m/HR ²        | Метры в час в квадрате        |
|                      | км/час ²       | Число километров в квадрате в часах    |
| Angular Скорость     | RAD/с      | Радиан в секунду             |
| Angular Ускоритель | RAD/с ²     | Радиан в секунду в квадрате     |
| Область                 | mm ²          | Миллиметры в квадрате            |
|                      | cm ²          | Сантиметры в квадрате            |
|                      | м²           | Квадратный метры в квадрате                 |
|                      | км²          | Километры в квадрате             |
| Громкость               | ³ мм          | Кубные миллиметры              |
|                      | км³          | Кубные сантиметры              |
|                      | м³           | Куб в Кубе                   |
|                      | км ³          | Куб в километры               |



 

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Справочник по стандарту DirectX для заметок и семантик](dx9-graphics-reference-effects-dxsas.md)
</dt> </dl>

 

 



