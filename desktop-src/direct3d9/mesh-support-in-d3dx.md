---
description: Сведения о поддержке сеток в D3DX. D3DX — это служебная Библиотека, которая предоставляет вспомогательные службы. Это уровень выше компонента Direct3D.
ms.assetid: 7892370f-0807-4ab7-b7cd-a7e1182e3f9c
title: Поддержка сеток в D3DX (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a1600b372432d59357a7431c70ce70ce2958002c
ms.sourcegitcommit: 5d4e99f4c8f42f5f543e52cb9beb9fb13ec56c5f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/19/2021
ms.locfileid: "112408137"
---
# <a name="mesh-support-in-d3dx-direct3d-9"></a>Поддержка сеток в D3DX (Direct3D 9)

D3DX — это служебная Библиотека, которая предоставляет вспомогательные службы. Это уровень выше компонента Direct3D.

## <a name="meshes"></a>Сетки

D3DX реализует конструкцию сетки для загрузки, обработки и визуализации содержимого файла. x. Сетка, по сути, представляет собой коллекцию вершин, определяющих определенную геометрию, и набор индексов, определяющих грани. Существует несколько типов сетки.

[**ID3DXBaseMesh**](id3dxbasemesh.md) предоставляет основные принципы. [**ID3DXMesh**](id3dxmesh.md) наследует от ID3DXBaseMesh и добавляет оптимизацию сетки с помощью кэша вершин на уровне микросхемы. [**ID3DXSkinInfo**](id3dxskininfo.md) обеспечивает поддержку сеток в обложках.

[**ID3DXBaseMesh**](id3dxbasemesh.md) предоставляет методы для управления объектами сетки [**ID3DXMesh**](id3dxmesh.md) , которые наследуются от базовой сетки, и выполнения запросов к ним. Сюда входят операции с соседями, получение геометрического буфера, операции блокировки (вершина и индекс), копирование, отрисовка, грани и сведения о вершинах.

> [!Note]  
> Интерфейсы ID3DXPMesh и ID3DXSPMesh (для поддержки прогрессивных и упрощенных сеток, соответственно), доступные в более ранних версиях Direct3D 9, были удалены.

 

## <a name="mesh-architecture"></a>Архитектура сети

Сетка содержит данные для сложной модели. Это абстрактный контейнер данных, который содержит ресурсы, такие как текстуры и материалы, а также атрибуты, такие как данные о положении и соседические данные. Существует несколько операций с сеткой, которые улучшают производительность рисования и внешний вид поверхности. Кроме того, существует ряд других концепций сетки, которые влияют на функциональность операций сетки. Понимание этих концепций сетки позволяет повысить производительность сетки.

## <a name="mesh-object-data"></a>Данные объекта сетки

Сетка содержит буфер вершин, буфер индексов и буфер атрибутов.

-   Буфер вершин содержит данные вершин, которые являются вершинами сетки.
-   Буфер индексов содержит индексы вершин для доступа к буферу вершин. Это позволяет уменьшить размер буфера вершин, уменьшая дублирование вершин. Буфер индексов используется только в индексированной сетке. Например, если сетка состоит из списка треугольников, то буфер индексов не используется.
-   Буфер атрибутов содержит данные атрибутов. Атрибуты — это свойства вершин сетки без определенного порядка. Сетка D3DX хранит атрибуты в группе DWORD для каждой грани.

### <a name="attribute-tables"></a>Таблицы атрибутов

Таблица атрибутов представляет собой краткое представление содержимого буфера атрибутов. Таблицы атрибутов можно создать путем вызова одного из методов optimize с помощью D3DXMESHOPT \_ аттрсорт, заключив буфер атрибутов и заполняя его данными или вызвав сетаттрибутетабле. Сетка содержит таблицу атрибутов, когда сетка переупорядочивается по группам. Это происходит при вызове метода optimize при условии, что задан параметр сортировки атрибута (D3DXMESHOPT \_ аттрсорт или более поздней версии). Сетки D3DX используют индексированные списки треугольников и, таким образом, рисуются с помощью [**IDirect3DDevice9::D равиндекседпримитиве**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-drawindexedprimitive).

Таблицы атрибутов создаются в результате вызова optimize. Эти лица не обязательно должны быть смежными, так как оптимизация будет переупорядочена друг к друга. Например, руки в отделе кадров могут использовать один и тот же атрибут. Идентификатор помогает сортировать лица по группам. Сетки из файлов. x автоматически генерируют атрибуты для свойств «материал» и «текстура». Чтобы получить хорошую производительность, необходимо вызвать метод optimize (АТТРСОРТ) или более эффективное действие optimize (ВЕРТЕКСКАЧЕ). Функции Load пытаются представлять данные в точном формате, в котором они были сохранены. Если используется сетка на основе буфера вершин или буфера, то API-интерфейс сетки предоставляет функции оптимизации и преобразования в виде обложки с небольшими издержками.

Типы оптимизации являются кумулятивными, начиная с наименьшего оптимального (D3DXMESHOPT \_ Compact) до наиболее оптимального (D3DXMESHOPT \_ игноревертс). D3DXMESHOPT \_ стрипреордер выполняет сжатие и сортировку атрибутов. D3DXMESHOPT \_ вертекскаче рекомендуется всегда, даже на устройствах без истинного кэша вершин.

## <a name="application-data"></a>Данные приложений

Данные приложения — это данные сетки, управляемые приложением. Между данными вершин сетки и данными, управляемыми этими буферами, существует тесная связь.

В буфере материалов содержится n материалов. Материалы возвращаются функцией Load при загрузке файла. x. Каждое подмножество может иметь собственные материалы и текстуры. Буфер материалов является статическим.

В буфере соседства содержатся сведения о краях, фрагментах и смежных лицах. Некоторые операции с сеткой зависят от того, какие лица находятся рядом друг с другом. Эти сведения, называемые смежными данными, хранятся в смежном буфере. Он не является частью сети, но поддерживается приложением и должен предоставляться методам сетки при необходимости.

Буфер экземпляра Effects содержит список экземпляров эффектов. Экземпляр действия сохраняет состояние. Эти сведения о состоянии используются для инициализации конвейера. Экземпляр Effect содержит пары "имя-значение" в результате.

## <a name="advanced-mesh-topics"></a>Дополнительные статьи по сетке

Оптимизированные сети основаны на базовых функциях сетки и добавляют возможности оптимизации кэша вершин с помощью двух методов: optimize, который создает новую сетку, и Оптимизеинплаце, которая изменяет исходную сетку.

D3DXGeneratePMesh использует алгоритм упрощения D3DX для создания прогрессивной сетки из входной сетки. D3DXSimplifyMesh создает стандартную сетку заданного уровня детализации из входной сетки с помощью того же алгоритма упрощения. Пользователь имеет контроль над метрикой ошибок, используемой с помощью весовых коэффициентов, указанных для каждого компонента вершины, и весовых коэффициентов, указанных для каждой вершины. Весовые коэффициенты для каждого компонента умножаются на эти компоненты, которые вычисляются при пограничных свертывании. Вес на вершину умножается на значение метрики ошибки, определенное для удаления этой вершины. Например, если вы никогда не хотите удалять вершину, задайте для этого веса определенной вершины большое значение. И наоборот, если вы хотите, чтобы она была удалена ранее, присвойте ей небольшое значение (меньше 1).

[**ID3DXSkinInfo**](id3dxskininfo.md) поддерживает символы с обложками. Символ обложки определяется набором сеток и набором костей, влияющих на вершины сеток. Кости представлены в виде иерархии преобразований. Для каждой сетки имеется матрица для каждой кости, влияющей на нее, которая преобразует сетку в локальное пространство координат кости. Эта матрица является преобразованием пространства костей для сетки. Это определяется в момент, когда скелет связан с сеткой в процессе разработки.

### <a name="skinning"></a>скиннинга;

Выбор обложки — это способ преобразования вершин сетки с помощью костей. Кости обычно упорядочиваются в иерархическую структуру, похожую на кости в кадре. Вершины объектов затем связываются с костями, например присоединяя обложку к костям. При преобразовании костей также преобразуется обложка.

В сетках с обложками используются кости, влияющие на ряд вершин. Данные преобразования костей передаются пользователем, чтобы повлиять на то, как SRT кости. Сетка использует преобразованные кости, чтобы повлиять на вершины, связанные с костями. Палитры — это массивы преобразований SRT. Палитры часто реализуются как матрицы, но они могут содержать значения SRT.

### <a name="progressive-mesh-trimming"></a>Прогрессивная обрезка сетки

Области данных с низким уровнем детализации могут позволить себе потерять вершины, не изменяющие отображаемый внешний вид поверхности. Это особенно справедливо для объектов, так как они перемещаются дальше с камеры. Это называется уровнем детализации. У пользователей есть элементы управления прорисовкой на уровне API для установки уровня детализации для повышения эффективности отрисовки.

Прогрессивные объекты сетки начинаются с большого числа лиц и используют упрощение для уменьшения числа лиц. Прогрессивная последовательная сетка называется независимой от представления последовательной сеткой (ВИПМ).

Другим способом уменьшения числа сторон является усечение. Это фактически удаляет вершины и грани из сетки. Обрезка может быть выполнена в верхней части (для ограничения максимального числа граней) или в нижней части (для ограничения минимального числа лиц). Обрезка улучшает производительность отрисовки, однако для сохранения качества визуального элемента следует использовать осторожность. Обрезка показана в примере пакета SDK для последовательной сетки.

Для областей с высокой степенью видимости разрешение можно увеличить с помощью последовательного уровня детализации (плод). Это способ разбиения одного лица на два лица.

### <a name="patch-meshes"></a>Сетки исправлений

Также поддерживаются два специализированных типа сеток исправлений: обновления прямоугольников и треугольников. Сетка исправлений прямоугольника — это сетка исправлений, точки управления которой располагаются в виде поворота, прямоугольной последовательности. Для создания высокозаказных поверхностей используются обновления прямоугольников и треугольников. Они не так часто используются в качестве сеток треугольников.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[D3DX](d3dx.md)
</dt> </dl>

 

 
