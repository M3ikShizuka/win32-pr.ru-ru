---
description: В материалах описывается, как многоугольники отражают освещение или отображаются для эмиссии освещения в трехмерной сцене.
ms.assetid: vs|directx_sdk|~\materials.htm
title: Материалы (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5e8140de30243c7a0f7290715da3d0720cd15cea769bd78cbf66893c0082062d
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118092961"
---
# <a name="materials-direct3d-9"></a>Материалы (Direct3D 9)

В материалах описывается, как многоугольники отражают освещение или отображаются для эмиссии освещения в трехмерной сцене. Свойства материала. подробные сведения о порождаемом диффузии, отражении окружающей среды, светлых излучений и характеристиках отражения. Direct3D использует структуру [**D3DMATERIAL9**](d3dmaterial9.md) для получения всех сведений о свойствах материалов. За исключением отраженного свойства, каждое свойство описывается как цвет RGBA, который показывает, какая часть красной, зеленой и синей частей данного типа освещения отражается, и коэффициент альфа-смешения.

## <a name="diffuse-and-ambient-reflection"></a>Рассеянное и внешнее отражение

Элементы диффузной и внешней среды структуры [**D3DMATERIAL9**](d3dmaterial9.md) описывают, как материал отражает внешний и рассеянный свет в сцене. Поскольку большинство сцен содержат гораздо больше света, чем внешний свет, Рассеянное отражение играет наибольшую часть в определении цвета. Кроме того, так как рассеянный свет является направленным, то его угол влияет на общую интенсивность отражения. Рассеянное отражение очень большое, когда свет размещает вершину параллельно с нормальной вершиной. При увеличении угла уменьшается воздействие размытого отражения. Интенсивность освещения — это косинус угла между входящими источниками и нормальными вершинами, как показано на следующем рисунке.

![Иллюстрация величины отраженного освещения](images/incident.png)

Отражение окружения, как и внешний свет, является ненаправленным. Отражение окружения оказывает меньшее влияние на видимый цвет отображаемого объекта, но он влияет на общий цвет и является наиболее заметным, когда немалое освещение отразится на материале. Внешнее отражение материала затронет внешний свет, заданный для сцены, вызывая метод [**IDirect3DDevice9:: сетрендерстате**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setrenderstate) с \_ флагом окружения D3DRS.

Рассеянное и внешнее отражение работают вместе для определения воспринимаемого цвета объекта и обычно являются идентичными значениями. Например, чтобы визуализировать синий объект кристаллине, необходимо создать материал, отражающий только синий компонент рассеянного и внешнего света. При помещении в комнату с белым освещением кристалл отображается синим цветом. Однако в комнате, которая имеет только красный свет, тот же кристалл кажется черним, так как его материал не отражает красный свет.

## <a name="emission"></a>Вывода

Материалы можно использовать, чтобы сделать готовый к просмотру объект самолуминаус. Элемент эмиссионный структуры [**D3DMATERIAL9**](d3dmaterial9.md) используется для описания цвета и прозрачности порожденного освещения. Излучение влияет на цвет объекта и может, например, сделать темный материал ярче и частично перенять излучаемый цвет.

Свойство эмиссионный материала можно использовать для добавления иллюзии, что объект порождает освещение, без затрат на вычислительные издержки, возникающие при добавлении освещения в сцену. В случае синего кристалла свойство эмиссионный полезно, если нужно сделать так, чтобы Crystal отображался светло, но не приводить освещение к другим объектам в сцене. Помните, что материалы со свойствами эмиссионный не создают освещение, которое может быть отражено другими объектами в сцене. Чтобы добиться этого отраженного освещения, необходимо поместить дополнительный источник в сцену.

## <a name="specular-reflection"></a>Отраженное отражение

Отраженное отражение создает выделения для объектов, делая их блестящими. Структура [**D3DMATERIAL9**](d3dmaterial9.md) содержит два элемента, описывающих цвет отраженного выделения, а также общий коэффициента блеска материала. Вы устанавливаете цвет отраженных светов, устанавливая для элемента отражения нужный цвет RGBA, наиболее распространенные цвета — белые или светло-серые. Значения, заданные в элементе управления "член электропитания", насколько остры отраженные эффекты.

Отраженные блики могут создавать значительные эффекты. Повторное рисование на синем аналоговом устройстве. более высокое значение питания создает визуальные блики, что делает кристалл довольно блестящим. Меньшие значения увеличивают область действия, создавая тусклое отражение, которое делает Crystal Фрости. Чтобы сделать объект действительно матовым, установите для элемента питания значение 0, а для параметра цвет в отражении — черный. Поэкспериментируйте с различными уровнями отражения, чтобы получить реалистичный внешний вид для ваших нужд. На следующем рисунке показаны две идентичные модели. В левой части используется отражающая степень отражения 10; модель справа не имеет отраженного отражения.

![Иллюстрация моделей отраженного отражения](images/spechigh.png)

## <a name="setting-material-properties"></a>Задание свойств материала

Устройства рендеринга Direct3D могут быть отображены одновременно с одним набором свойств материала.

В приложении C++ вы задаете свойства материала, используемые системой, подготавливая структуру [**D3DMATERIAL9**](d3dmaterial9.md) , а затем вызывая метод [**IDirect3DDevice9:: сетматериал**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setmaterial) .

Чтобы подготовить структуру [**D3DMATERIAL9**](d3dmaterial9.md) для использования, установите сведения о свойствах в структуре, чтобы создать желаемый результат во время подготовки к просмотру. В следующем примере кода настраивается структура **D3DMATERIAL9** для фиолетовых материалов с четкими белыми отражающими светами.


```
D3DMATERIAL9 mat;

// Set the RGBA for diffuse reflection.
mat.Diffuse.r = 0.5f;
mat.Diffuse.g = 0.0f;
mat.Diffuse.b = 0.5f;
mat.Diffuse.a = 1.0f;

// Set the RGBA for ambient reflection.
mat.Ambient.r = 0.5f;
mat.Ambient.g = 0.0f;
mat.Ambient.b = 0.5f;
mat.Ambient.a = 1.0f;

// Set the color and sharpness of specular highlights.
mat.Specular.r = 1.0f;
mat.Specular.g = 1.0f;
mat.Specular.b = 1.0f;
mat.Specular.a = 1.0f;
mat.Power = 50.0f;

// Set the RGBA for emissive color.
mat.Emissive.r = 0.0f;
mat.Emissive.g = 0.0f;
mat.Emissive.b = 0.0f;
mat.Emissive.a = 0.0f;
```



После подготовки структуры [**D3DMATERIAL9**](d3dmaterial9.md) необходимо применить свойства, вызвав метод [**IDirect3DDevice9:: сетматериал**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setmaterial) устройства отрисовки. Этот метод принимает адрес подготовленной структуры **D3DMATERIAL9** в качестве единственного параметра. При необходимости можно вызвать **IDirect3DDevice9:: сетматериал** с новыми сведениями для обновления свойств материала устройства. В следующем примере кода показано, как это может выглядеть в коде.


```
// This code example uses the material properties defined for 
// the mat variable earlier in this topic. The pd3dDev is assumed
// to be a valid pointer to an IDirect3DDevice9 interface.
HRESULT hr;
hr = pd3dDev->SetMaterial(&mat);
if(FAILED(hr))
{
    // Code to handle the error goes here.
}
```



При создании устройства Direct3D текущий материал автоматически устанавливается в значение по умолчанию, как показано в следующей таблице.



| Член   | Значение                |
|----------|----------------------|
| Диффузное  | (R:0, G:0, B:0, A:0) |
| Отражающее | (R:0, G:0, B:0, A:0) |
| Окружающее  | (R:0, G:0, B:0, A:0) |
| Эмиссионное | (R:0, G:0, B:0, A:0) |
| Питание    | (0,0)                |



 

## <a name="retrieving-material-properties"></a>Получение свойств материалов

Вы получаете свойства материала, которые в настоящее время использует устройство отрисовки, вызывая метод [**IDirect3DDevice9::-Material**](/windows/desktop/api) для устройства. В отличие от метода [**IDirect3DDevice9:: сетматериал**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setmaterial) , **IDirect3DDevice9:: Material** не требует подготовки. Метод **IDirect3DDevice9::** D3DMATERIAL9 принимает адрес структуры [](d3dmaterial9.md) и заполняет предоставленную структуру данными, описывающими текущие свойства материала, перед возвратом.


```
// For this example, the pd3dDev variable is assumed to 
// be a valid pointer to an IDirect3DDevice9 interface.
HRESULT hr;
D3DMATERIAL9 mat;

hr = pd3dDev->GetMaterial(&mat);
if(FAILED(hr))
{
    // Code to handle the error goes here.
}
```



> [!Note]  
> Если приложение не указывает свойства материала для подготовки к просмотру, система использует материал по умолчанию. Материал по умолчанию отражает все освещение светло-белого цвета, например без внешнего или отраженного отражения и не имеет цвета эмиссионный.

 

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Индикаторы и материалы](lights-and-materials.md)
</dt> </dl>

 

 
