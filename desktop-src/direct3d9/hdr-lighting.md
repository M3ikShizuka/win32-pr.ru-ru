---
description: Освещение в реальном мире содержит очень высокий динамический диапазон (HDR) значений светимости.
ms.assetid: 537700e2-802d-4fd1-b026-142d6f4f0559
title: Освещение HDR (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5f397ccef2b1fa315e64861453b13f0f6fddfe77
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127457625"
---
# <a name="hdr-lighting-direct3d-9"></a>Освещение HDR (Direct3D 9)

Освещение в реальном мире содержит очень высокий динамический диапазон (HDR) значений светимости. Реальный мир имеет около 10 заказов динамического диапазона (DR) для значений светимости, которые распределяются по спектру оттенков по яркости. С другой стороны, экран компьютера имеет очень ограниченный цвет отображения (или диапазон значений светимости): примерно два порядка динамических диапазонов. Задача создания изображений, визуализированных в режиме HDR, заключается в сопоставлении реальных значений HDR с ограниченным охватом экрана компьютера.

Сопоставление тонов — это методика, используемая DirectX для сопоставления информации HDR с более ограниченным диапазоном. Сопоставление тонов, применяемое к отрисовке CGI, может значительно увеличить объем отображаемых сведений об освещении, позволяя получить подробные сведения о самых темных областях и обеспечить контрастность областей, которые настолько яркие, они будут записаны. Итоговые сцены отображаются с гораздо более видимыми сведениями о освещении.

[Пример хдрлигхтинг](https://msdn.microsoft.com/library/Ee417769(v=VS.85).aspx) — это пример пакета SDK, демонстрирующий освещение в виде HDR-освещения.

## <a name="tone-mapping"></a>Сопоставление тонов

Сопоставление тонов обычно имитирует оптическое явлений, которое не может быть вызвано аварийным восстановлением монитора. Например, фларес или цветут (в основном это свойства lenses), синий сдвиг, происходящий в человеческих глазах с низкими причинами, и другие адаптации, которые являются результатом биохимии глаз. Если аварийное восстановление отображения было достаточно большим, сопоставление тонов не будет необходимым, за исключением художественных эффектов или некоторых свойств линзы или устройства с загрузкой платы (ККД).

При сопоставлении тонов ряд значений светимости в сцене делится на набор зон. Каждая зона охватывает диапазон значений светимости.

HDR использует следующие термины:

-   Зона — диапазон значений светимости
-   Средняя серая-средняя область яркости сцены
-   Динамическое отношение диапазона к наибольшей освещенности сцены до наименьшей освещенности сцены
-   Основные ключевые меры освещения сцены: это может быть от светлого к умеренному до темного

Чтобы вычислить светимость из значений RGB, используйте следующую команду:


```
L = 0.27R + 0.67G + 0.06B;
```



Светимость по среднему логарифму является полезной аппроксимацией для ключа сцены. Общее уравнение выглядит следующим образом:

L<sub>w</sub> = exp \[ 1/N ( \[ Журнал Sum (Дельта + L<sub>w</sub>(x, y)) \] ) \]

Где:

-   L<sub>w</sub> — средний уровень освещенности журнала
-   N — число пикселей в изображении
-   Дельта — небольшой фактор, позволяющий избежать проблем с черными пикселями
-   L<sub>w</sub>(x, y) — светимость мировой области для пикселя (x, y)

Чтобы преобразовать это значение в среднее-серое, ниже приведен оператор масштабирования светимости:

L (x, y) = a \* l<sub>w</sub>(x, y)/L<sub>w</sub>

Где:

-   L (x, y) — масштабируемая светимость для Pixel (x, y)
-   значение ключа-изображения после применения масштабирования

И, наконец, вот простой оператор сопоставления тонов для сжатия высокой освещенности:

L<sub>d</sub>(x, y) = L (x, y)/(1 + L (x, y))

Где:

-   L<sub>d</sub>(x, y) — сжатая и масштабируемая светимость для пикселей (x, y)
-   значение ключа-изображения после применения масштабирования

Этот оператор масштабирует высокую освещенность на 1/д и низкую светимость на 1. Дополнительные сведения см. в следующем документе.

Реинхард, Эрик, Mike контрастной, Питер Ширлэй и Джеймс Ферверда. [«Фотографическое воспроизведение цифровых изображений»](https://www.cs.utah.edu/~reinhard/cdrom/tonemap.pdf). ACM транзакции на графике (ТОГ), материалы из 29-годовой конференции по компьютерной графике и интерактивным методикам (СИГГРАФ), PP. 267-276. Нью Йорк, Москва: ACM Press, 2002.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Дополнительные разделы](advanced-topics.md)
</dt> </dl>

 

 



