---
description: Использование сжатых текстур (Direct3D 9)
ms.assetid: 60892a8b-93f4-43ba-87ef-d5c7cc6fb8c6
title: Использование сжатых текстур (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 643b0618043f12ff3e1a84b806c86edb780ad929
ms.sourcegitcommit: a47bd86f517de76374e4fff33cfeb613eb259a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/06/2021
ms.locfileid: "103806851"
---
# <a name="using-compressed-textures-direct3d-9"></a>Использование сжатых текстур (Direct3D 9)

## <a name="determining-support-for-compressed-textures"></a>Определение поддержки для сжатых текстур

Чтобы проверить адаптер, укажите любой формат пикселей, использующий DXT1, DXT2, DXT3, DXT4 или DXT5. Если [**IDirect3D9:: чеккдевицеформат**](/windows/desktop/api) возвращает D3D \_ ОК, устройство может создать текстуру непосредственно из сжатой текстурной поверхности, использующей этот формат. Если это так, можно использовать сжатые поверхности текстуры непосредственно с Direct3D, вызвав метод [**IDirect3DDevice9:: сеттекстуре**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-settexture) . В следующем примере кода показано, как определить, поддерживает ли адаптер формат сжатой текстуры.


```
BOOL IsCompressedTextureFormatOk( D3DFORMAT TextureFormat, 
                                  D3DFORMAT AdapterFormat ) 
{
    HRESULT hr = pD3D->CheckDeviceFormat( D3DADAPTER_DEFAULT,
                                          D3DDEVTYPE_HAL,
                                          AdapterFormat,
                                          0,
                                          D3DRTYPE_TEXTURE,
                                          TextureFormat);

    return SUCCEEDED( hr );
}
```



Если устройство не поддерживает ускорение текстур из сжатых поверхностей текстуры, вы по-прежнему можете хранить данные текстуры в сжатой области формата, но перед тем, как их можно будет использовать для текстурирования, необходимо преобразовать все сжатые текстуры в поддерживаемый формат.

## <a name="creating-compressed-textures"></a>Создание сжатых текстур

После создания устройства, поддерживающего формат сжатой текстуры на адаптере, можно создать сжатый ресурс текстуры. Вызовите метод [**IDirect3DDevice9:: креатетекстуре**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-createtexture) и укажите формат сжатой текстуры для параметра format.

Перед загрузкой изображения в объект текстуры извлеките указатель на поверхность текстуры, вызвав метод [**IDirect3DTexture9:: жетсурфацелевел**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dtexture9-getsurfacelevel) .

Теперь можно использовать любую функцию D3DXLoadSurfacexxx для загрузки изображения на поверхность, полученную с помощью [**IDirect3DTexture9:: жетсурфацелевел**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dtexture9-getsurfacelevel). Эти функции обработают преобразование в форматы и из сжатых текстур текстуры.

Вы можете создавать и преобразовывать сжатые файлы текстур (DDS) с помощью редактора текстур DirectX (Dxtex.exe), предоставляемого с пакетом SDK DirectX. Вы можете получить Dxtex.exe и узнать о нем из пакета SDK DirectX. Сведения о пакете SDK для DirectX см. в разделе [где находится пакет DirectX SDK?](../directx-sdk--august-2009-.md).

Преимущество такого поведения заключается в том, что приложение может скопировать содержимое сжатой области в файл, не подчисляя объем хранилища, необходимый для поверхности определенной ширины и высоты в определенном формате.

В следующей таблице показаны пять типов сжатых текстур. Дополнительные сведения о хранении данных см. в разделе [форматы сжатых текстур (Direct3D 9)](compressed-texture-formats.md). Эти сведения понадобятся только при написании собственных подпрограмм сжатия.



| FOURCC | Описание        | Альфа-канал был предварительно умножен? |
|--------|--------------------|----------------------|
| DXT1   | Непрозрачный/1-разрядный альфа | Н/Д                  |
| DXT2   | Явное альфа-канал     | Да                  |
| DXT3   | Явное альфа-канал     | Нет                   |
| DXT4   | Альфа-канал с интерполяцией | Да                  |
| DXT5   | Альфа-канал с интерполяцией | Нет                   |



 

При переносе данных из формата нонпремултиплиед в предварительно умноженный формат Direct3D масштабирует цвета на основе альфа-значений. Передача данных из предварительно умноженного формата в формат нонпремултиплиед не поддерживается. При попытке переместить данные из предварительно умноженного альфа-источника в назначение нонпремултиплиед Alpha метод возвращает D3DERR \_ инвалидкалл. При переносе данных из предварительно умноженного альфа-источника в место назначения, не имеющее альфа-канала, исходные компоненты цвета, которые были масштабированы по альфа, копируются как есть.

## <a name="decompressing-compressed-texture-surfaces"></a>Распаковка поверхностей сжатой текстуры

Как и при сжатии текстурной поверхности, распаковка сжатой текстуры выполняется с помощью Direct3D-копирования служб.

Чтобы скопировать сжатую текстурную поверхность в несжатую текстуру, используйте функцию [**D3DXLoadSurfaceFromSurface**](d3dxloadsurfacefromsurface.md). Эта функция обрабатывает сжатие в и из сжатых и несжатых поверхностей.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Сжатые ресурсы текстуры](compressed-texture-resources.md)
</dt> </dl>

 

 
