---
description: Эта таблица сопоставляет коды ФВФ со структурой D3DVERTEXELEMENT9.
ms.assetid: de865481-2a08-4d25-967c-8e68b7affe8d
title: Сопоставление кодов ФВФ с объявлением Direct3D 9 (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ff8ef4d5e8e29c4c7f6af8d82b650b4898c57d900b92b8dd45ca2368bb9eacce
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118799080"
---
# <a name="mapping-fvf-codes-to-a-direct3d-9-declaration-direct3d-9"></a>Сопоставление кодов ФВФ с объявлением Direct3D 9 (Direct3D 9)

Эта таблица сопоставляет коды ФВФ со структурой [**D3DVERTEXELEMENT9**](d3dvertexelement9.md) .



| фвф                                                   | Тип данных                                                           | Использование                                                                         | Индекс использования |
|-------------------------------------------------------|---------------------------------------------------------------------|-------------------------------------------------------------------------------|-------------|
| D3DFVF \_ XYZ                                           | D3DDECLTYPE \_ FLOAT3                                                 | D3DDECLUSAGEное \_ расположение                                                        | 0           |
| D3DFVF \_ ксизрхв                                        | D3DDECLTYPE \_ FLOAT4                                                 | D3DDECLUSAGE \_ позиций                                                       | 0           |
| D3DFVF \_ ксизв                                          | D3DDECLTYPE \_ FLOAT4                                                 | D3DDECLUSAGEное \_ расположение                                                        | 0           |
| D3DFVF \_ XYZB5 и D3DFVF \_ ластбета \_ UBYTE4            | D3DVSDT \_ FLOAT3, D3DVSDT \_ FLOAT4, D3DVSDT \_ UBYTE4                   | D3DDECLUSAGE \_ , D3DDECLUSAGE \_ БЛЕНДВЕИГХТ, D3DDECLUSAGE \_ блендиндицес | 0           |
| D3DFVF \_ XYZB5 и D3DFVF \_ ластбета \_ D3DCOLOR          | D3DVSDT \_ FLOAT3, D3DVSDT \_ FLOAT4, D3DVSDT \_ D3DCOLOR                 | D3DDECLUSAGE \_ , D3DDECLUSAGE \_ БЛЕНДВЕИГХТ, D3DDECLUSAGE \_ блендиндицес | 0           |
| D3DFVF \_ XYZB5                                         | D3DDECLTYPE \_ FLOAT3, D3DDECLTYPE \_ FLOAT4, D3DDECLTYPE \_ FLOAT1       | D3DDECLUSAGE \_ , D3DDECLUSAGE \_ БЛЕНДВЕИГХТ, D3DDECLUSAGE \_ блендиндицес | 0           |
| D3DFVF \_ ксизбн (n = 1.. 4)                                | D3DDECLTYPE \_ FLOAT3, D3DDECLTYPE \_ флоатн                            | D3DDECLUSAGE \_ , D3DDECLUSAGE \_ блендвеигхт                             | 0           |
| D3DFVF \_ ксизбн (n = 1.. 4) и D3DFVF \_ ластбета \_ UBYTE4   | D3DDECLTYPE \_ FLOAT3, D3DDECLTYPE \_ float (n-1), D3DDECLTYPE \_ UBYTE4   | D3DDECLUSAGE \_ , D3DDECLUSAGE \_ БЛЕНДВЕИГХТ, D3DDECLUSAGE \_ блендиндицес | 0           |
| D3DFVF \_ ксизбн (n = 1.. 4) и D3DFVF \_ ластбета \_ D3DCOLOR | D3DDECLTYPE \_ FLOAT3, D3DDECLTYPE \_ float (n-1), D3DDECLTYPE \_ D3DCOLOR | D3DDECLUSAGE \_ , D3DDECLUSAGE \_ БЛЕНДВЕИГХТ, D3DDECLUSAGE \_ блендиндицес | 0           |
| D3DFVF, \_ Обычная                                        | D3DDECLTYPE \_ FLOAT3                                                 | D3DDECLUSAGE, \_ Обычная                                                          | 0           |
| D3DFVF \_ псизе                                         | D3DDECLTYPE \_ FLOAT1                                                 | D3DDECLUSAGE \_ псизе                                                           | 0           |
| D3DFVF \_ диффузный                                       | D3DDECLTYPE \_ D3DCOLOR                                               | \_Цвет D3DDECLUSAGE                                                           | 0           |
| \_Зеркальное отражение D3DFVF                                      | D3DDECLTYPE \_ D3DCOLOR                                               | \_Цвет D3DDECLUSAGE                                                           | 1           |
| D3DFVF \_ текскурдсизем (n)                              | D3DDECLTYPE \_ флоатм                                                 | D3DDECLUSAGE \_ текскурд                                                        | n           |



 

## <a name="vertex-declarations-with-d3ddeclusage_positiont"></a>Объявления вершин с D3DDECLUSAGE \_ положением

Присутствие элемента вершины с (D3DUSAGE \_ положением, 0) используется для указания устройству, что поступающие данные вершин уже были в процессе обработки вершин (например, фвф с D3DFVF \_ ксизрхв Bit Set). Во время рисования, если в объявлении текущего набора есть элемент с \_ семантикой (D3DUSAGE позиции, 0), вся обработка вершин пропускается (так же, как если установлено фвф с D3DFVF \_ ксизрхв бит).

Существуют некоторые ограничения на объявления вершин с (D3DDECLUSAGE \_ положением, 0):

-   В таких объявлениях можно использовать только нуль потока.
-   Элементы вершины должны быть отсортированы путем увеличения смещения потока.
-   Смещение потока должно быть совмещено с параметром DWORD.
-   Одна и та же пара (использование, индекс использования) должна быть указана только один раз.
-   \_Можно использовать только метод D3DDECLMETHOD по умолчанию.
-   Другие элементы вершин не могут иметь \_ семантику (D3DDECLUSAGE положением, 0).

Кроме того, существуют некоторые ограничения на такое объявление, связанные с версией драйвера устройства. Эти ограничения действуют, поскольку Direct3D отправляет такие объявления непосредственно в драйвер без выполнения каких-либо преобразований.

## <a name="vertex-declarations-without-d3ddeclusage_positiont"></a>Объявления вершин без D3DDECLUSAGE \_ положением

Среда выполнения проверяет создание объявлений. Ниже приведены общие правила, в которых объявления являются допустимыми.

-   Все элементы вершины для потока должны быть последовательными и отсортированными по смещению.
-   Смещение потока должно быть совмещено с параметром DWORD.
-   Одна и та же пара (использование, индекс использования) должна быть указана только один раз.
-   Если параметр D3DDEVCAPS2 \_ вертекселементсканшарестреамоффсет установлен, то
    -   Несколько элементов вершин могут совместно использовать одно и то же смещение в потоке.
    -   Элементы вершины могут иметь разные типы, которые могут иметь разные размеры.
    -   Элементы вершины могут перекрываться произвольно. Например, один элемент может начинаться в расположении потока, который в то же время находится в середине другого элемента.
    -   Элементы вершины могут иметь смещение потока в любом порядке.
-   Число элементов вершин не может быть больше 64.
-   Усажеиндекс должен находиться в диапазоне \[ 0-15 \] .
-   Объявление, используемое с API Дравпримитиве, не должно иметь элементов вершин, отличных от D3DDECLMETHOD \_ по умолчанию, D3DDECLMETHOD \_ ЛУКУППРЕСАМПЛЕД или D3DDECLMETHOD \_ Lookup.
-   Объявление, содержащее D3DDECLMETHOD \_ Lookup или лукуппресамплед, должно использоваться только с программируемым конвейером вершин.
-   Объявление, используемое с API Дравректпатч/Дравтрипатч, не может иметь элементы вершины с D3DDECLMETHOD \_ лукуппресамплед или D3DDECLMETHOD \_ Lookup.
-   Объявление должно содержать только один элемент с \_ методом D3DDECLMETHOD Lookup или D3DDECLMETHOD \_ лукуппресамплед.
-   Объявление с D3DDECLMETHOD \_ Lookup или D3DDECLMETHOD \_ лукуппресамплед не должно содержать элементы, отличные от D3DDECLMETHOD \_ по умолчанию, поскольку сопоставление замещения выполняется только для N-патчей.
-   Элементы вершины с D3DDECLMETHOD \_ Lookup или D3DDECLMETHOD \_ лукуппресамплед можно использовать только с семантикой (D3DDECLUSAGE \_ Sample, n) и наоборот.
-   Если элемент вершины с методом D3DDECLMETHOD \_ Lookup имеет индекс потока и смещение уже существующего элемента вершины, этот элемент вершины должен иметь тот же тип данных.
-   Элемент вершины с \_ методом D3DDECLMETHOD Lookup должен иметь \_ тип данных D3DDECLTYPE FLOAT2/3/4
-   Элементы вершин с типами D3DDECLMETHOD \_ кроссув, D3DDECLMETHOD \_ ПАРТИАЛУ и D3DDECLMETHOD \_ партиалв должны иметь смещение элемента вершины с совместимым типом данных.
-   Элемент вершины с методом D3DDECLMETHOD \_ UV или D3DDECLMETHOD \_ лукуппресамплед должен иметь тип D3DDECLTYPE \_ неиспользуемые, нулевой индекс потока и нулевое смещение потока.
-   Объявления с методами D3DDECLMETHOD \_ UV, D3DDECLMETHOD \_ ПАРТИАЛУ и D3DDECLMETHOD \_ партиалв можно использовать только с дравректпатч.
-   D3DDECLUSAGE использования \_ тессфактор следует использовать только с типом данных D3DDECLTYPE \_ FLOAT1 и индексом использования 0.
-   Если объявление используется для тесселяции (Дравректпатч, Дравтрипатч, N-патчs), тип данных должен быть меньше или равен D3DDECLTYPE \_ SHORT4.
-   Объявления, содержащие методы, которые требуют определенных возможностей устройства (например, сопоставление замещения, RT-патчи), могут быть созданы только в том случае, если устройство поддерживает их.
-   Объявление вершины, используемое для рисования точек и линий, не может иметь методы, отличные от D3DDECLMETHOD \_ по умолчанию.
-   Объявления, которые могут быть созданы, также зависят от возможностей драйвера.

## <a name="driver-considerations"></a>Рекомендации по драйверам

### <a name="pre-direct3d-9-drivers"></a>Драйверы, предшествующие Direct3D 9

-   Входное объявление должно быть преобразовано в допустимое ФВФ (имеют одинаковый порядок элементов вершин и их типов данных).
-   Пробелы в координатах текстуры не допускаются. Это означает, что если имеется элемент вершины с (D3DDECLUSAGE \_ текскурд, n), то также должен быть элемент вершины с (D3DDECLUSAGE \_ текскурд, n-1).

### <a name="direct3d-9-drivers-without-pixel-shader-version-3-support"></a>Драйверы Direct3D 9 без поддержки Pixel Shader версии 3

-   Входное объявление должно быть преобразовано в допустимое ФВФ (имеют одинаковый порядок элементов вершин и их типов данных).
-   Допускаются пробелы в координатах текстуры.

### <a name="direct3d-9-drivers-with-pixel-shader-version-3-support"></a>Драйверы Direct3D 9 с поддержкой Pixel Shader версии 3

Допускаются более общие объявления.

-   Элементы вершины могут быть в произвольном порядке и могут иметь любые типы данных.
-   Несколько элементов вершин могут совместно использовать одно и то же смещение потока и иметь другой тип в одно и то же время, если D3DDEVCAPS2 \_ вертекселементсканшарестреамоффсет задано устройством.

## <a name="vertex-declaration-usage-with-the-programmable-vertex-pipeline"></a>Использование объявления вершин с программируемым конвейером вершин

-   Во время рисования Direct3D ищет ту же комбинацию "использование-индекс использования" в текущем объявлении вершины и в текущей функции шейдера вершин. При обнаружении сочетания в качестве места назначения для элемента Vertex используется регистр из функции шейдера ДКЛ.
-   Если элемент вершины в объявлении текущей вершины имеет использование, которое не найдено в текущем шейдере вершин, этот элемент не обрабатывается.
-   При использовании версий шейдеров вершин, меньших 2,0, вся семантика, упомянутая в коде шейдера, должна присутствовать в объявлении, привязанном во время рисования. При использовании шейдеров вершин 2,0 и выше это ограничение, которое позволяет приложениям использовать разные объявления вершин с одним и тем же шейдером вершин, не существует. Это полезно, когда шейдер вершин считывает входные данные на основе статических условий. Регистры шейдеров вершин не инициализированы, так как они будут иметь неопределенные значения.

При использовании с аппаратной обработкой вершин в драйвере DirectX 8 существуют дополнительные ограничения.

-   Элементы вершин не могут перекрываться или совместно использовать одно и то же смещение.
-   Типы данных ограничиваются тем, что может понять драйвер DirectX 8.

Креатевертексдекларатион может завершиться ошибкой, если указанное объявление не может быть преобразовано в объявление в стиле DirectX 8. Для устройства в смешанном режиме эта ошибка произойдет во время рисования, \* так как это единственный момент, когда может быть известно, используется ли шейдер с аппаратной или программной обработкой вершин.

## <a name="vertex-declaration-usage-with-the-fixed-function-pipeline"></a>Использование объявления вершин с фиксированным конвейером функции

Можно использовать только объявления, которые соответствуют следующим правилам:

-   Между элементами вершины не должно быть промежутков (пропуск не допускается в объявлении DirectX 8, который используется для конвейера фиксированной функции).
-   Необходимо указать семантику (D3DDECLUSAGE \_ позицией, 0) и иметь \_ тип данных D3DDECLTYPE FLOAT3.
-   Элемент вершины с методом D3DDECLMETHOD \_ UV должен указывать Usage D3DDECLUSAGE \_ ТЕКСКУРД или D3DDECLUSAGE \_ блендвеигхт.
-   Элемент Vertex с методом D3DDECLMETHOD \_ партиалу, \_ партиалв или \_ кроссув может использоваться только с D3DDECLUSAGE \_ положением, \_ нормальным, \_ блендвеигхт или \_ текскурд и должен использовать input type D3DDECLTYPE \_ FLOAT3.

Если объявление используется с аппаратной обработкой вершин в драйвере DirectX 8, среда выполнения Direct3D преобразует ее в объявление в стиле DirectX 8 со следующими правилами:

-   Элементы вершины не могут совместно использовать одно и то же смещение в потоке и не могут перекрываться.
-   Тип данных должен быть меньше или равен D3DDECLTYPE \_ SHORT4.
-   Допустимы только следующие методы: D3DDECLMETHOD \_ Default, D3DDECLMETHOD \_ КРОССУВ и D3DDECLMETHOD \_ UV.
-   [Сопоставление между объявлением Direct3D 9 и объявлением Direct3D 8 (Direct3D 9)](mapping-between-a-directx-9-declaration-and-directx-8.md) показывает, какая семантика Direct3D 9 может быть преобразована в объявление в стиле DirectX 8. Использование и Усажеиндекс преобразуются в значение регистра.
-   Если в объявлении есть n элементов вершины, а 0-m (m < n) сопоставляется с ФВФ (элементы, описанные в [сопоставлении между объявлением Direct3D и КОДАМИ фвф (Direct3D 9)](mapping-between-a-directx-9-declaration-and-fvf-codes.md)), а m + 1 — нет, то:
    -   Если любой из m + 2 до n-1 элементов вершин сопоставляется с ФВФ/dx8decl, объявление является недопустимым.
    -   Элементы от 0 до m преобразуются (средой выполнения для DirectX 8 и старых драйверов, а также драйверами Direct3D 9) с использованием [сопоставления между объявлением Direct3D и КОДАМИ фвф (Direct3D 9)](mapping-between-a-directx-9-declaration-and-fvf-codes.md), m + 1, m + 2 до тех пор, пока n-1 не сопоставляется с последовательным текскурд (k), текскурд (k + 1), начиная с любого текскурд в элемент
    -   Тип данных в сопоставленном текскурд предполагается как float \[ 1234 \] Замена любого типа данных, который содержит текущий элемент (но тот же размер). Таким образом, существующий тип данных может быть не [сопоставлен между объявлением Direct3D и Фвф кодами (Direct3D 9)](mapping-between-a-directx-9-declaration-and-fvf-codes.md).
    -   Если k достигнет значения 8, объявление недопустимо для ФВФ/dx8decl.
    -   Если возникли какие-либо сопоставления с текскурдс, то все объявление должно не иметь элементов с методом создания, отличным от значения по умолчанию, или объявление недопустимо для ФВФ/dx8decl.

## <a name="using-vertex-declarations-with-processvertices"></a>Использование объявлений вершин с Процессвертицес

Объявление вершины можно использовать для описания выходных данных Процессвертицес. Такое объявление должно соответствовать следующим правилам.

-   Необходимо использовать только поток 0.
-   Допускаются только \_ методы D3DDECLMETHOD по умолчанию.
-   \_Можно использовать только типы данных D3DDECLTYPE флоатн или D3DDECLTYPE \_ D3DCOLOR.
-   Элементы вершины не могут совместно использовать одно и то же смещение или перекрытие друг с другом.
-   Элементы вершины с (D3DDECLUSAGE \_ положением, 0) или ( \_ Расположение D3DDECLUSAGE, 0) не являются обязательными.
-   Элементы вершин с (D3DDECLUSAGE \_ положением, 0) и (D3DDECLUSAGE \_ положением, 0) не могут присутствовать в одном объявлении.
-   При использовании такого объявления текущий шейдер вершин должен иметь значение версии 3,0 или выше.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Объявление вершины](vertex-declaration.md)
</dt> </dl>

 

 



