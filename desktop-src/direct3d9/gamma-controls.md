---
description: Элементы управления гаммы позволяют изменить способ отображения содержимого поверхности системой, не влияя на содержимое самой поверхности.
ms.assetid: 74f106be-8f47-4875-9908-32ff35912968
title: Элементы управления гамма (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5074f60199364ba86a0b5ad743fcc03121351cad0ac071d9231beef7c7156f9d
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119122211"
---
# <a name="gamma-controls-direct3d-9"></a>Элементы управления гамма (Direct3D 9)

Элементы управления гаммы позволяют изменить способ отображения содержимого поверхности системой, не влияя на содержимое самой поверхности. Эти элементы управления можно рассматривать как очень простые фильтры, которые Direct3D применяют к данным, когда они оставляют поверхность, и до отрисовки на экране.

Элементы управления гаммы являются свойством цепочки буферов. Элементы управления гаммы позволяют динамически менять уровни красного, зеленого и синего уровней поверхности, сопоставленные с фактическими уровнями, отображаемыми системой. Задавая уровни гаммы, можно вызвать вспышку экрана пользователя во Flash Colors — красный цвет при воссоздании символа пользователя, зеленый, когда символ берет на себя новый элемент, и т. д. без копирования новых изображений в буфер кадров для достижения этого результата. Кроме того, можно изменить цветовые уровни, чтобы применить цветовой сдвиг к изображениям в обратном буфере.

Всегда существует по крайней мере одна цепочка буферов (неявная цепочка подкачки) для каждого устройства, так как Direct3D 9 имеет одну цепочку подкачки в качестве свойства устройства. Так как гамма-шкала является свойством цепочки буферов, цветовая гамма может применяться, когда цепочка буферов перемещается в окно. Гамма-шкала вступает в силу немедленно. Отсутствует ожидание операции вертикальной синхронизации.

Методы [**сетгаммарамп**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setgammaramp) и [**жетгаммарамп**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-getgammaramp) позволяют управлять уровнями пандуса, влияющими на цветовые компоненты красного, зеленого и синего цветов пикселей, до того, как они будут отправлены в цифровой преобразователь (DAC) для отображения.

## <a name="gamma-ramp-levels"></a>Уровни гамма-пандус

В Direct3D термин "гамма-шкала" описывает набор значений, которые сопоставляют уровень определенного компонента цвета — красный, зеленый, синий — для всех пикселов в буфере кадров до новых уровней, полученных DAC для отображения. Повторное сопоставление выполняется тремя таблицами поиска, по одному для каждого компонента цвета.

Вот как это работает: Direct3D принимает пиксель из буфера кадров и оценивает отдельные компоненты красного, зеленого и синего цветов. Каждый компонент представлен значением от 0 до 65535. Direct3D принимает исходное значение и использует его для индексации массива из 256 элементов (пандус), где каждый элемент содержит значение, заменяющее исходный. Direct3D выполняет этот процесс поиска и замены для каждого цветового компонента каждого пикселя в буфере кадров, тем самым изменяя окончательные цвета для всех экранных пикселей.

Можно визуализировать значения пандуса, выполнив их графику, как показано на следующих двух диаграммах. На левой диаграмме показана шкала, которая не изменяет цвета. На правой диаграмме показана шкала, которая накладывает отрицательный сдвиг на компонент цвета, к которому он применяется.

![графики значений гамма-шкалы](images/gammalv.png)

Элементы массива для графа слева содержат значения, идентичные их индексу-0 в элементе с индексом 0 и 65535 в индексе 255. Этот тип пандус является значением по умолчанию, так как перед отображением входные значения не изменяются. Правильная диаграмма предоставляет больше вариантов; его пандус содержит значения в диапазоне от 0 в первом элементе до 32768 в последнем элементе с одинаковым диапазоном значений между. В результате на экране отображается отключенный компонент цвета, использующий эту шкалу. Вы не ограничены использованием линейных диаграмм; Если при необходимости приложение может назначить произвольное сопоставление. Можно даже задать для записей все нули, чтобы полностью удалить компонент цвета из экрана.

## <a name="setting-and-retrieving-gamma-ramp-levels"></a>Установка и получение уровней гамма-шкалы

Уровни цветовой гаммы — это фактические таблицы, используемые Direct3D для соответствия компонентов цвета буфера кадров с новыми уровнями, которые будут отображены. Можно задать и получить уровни пандуса для основной поверхности, вызвав методы [**сетгаммарамп**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setgammaramp) и [**жетгаммарамп**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-getgammaramp) . **Сетгаммарамп** принимает два параметра, а **жетгаммарамп** принимает один параметр. Для **сетгаммарамп** первым параметром является либо D3DSGR \_ калибровка, либо D3DSGR \_ без \_ калибровки. Второй параметр, Прамп, является указателем на структуру [**D3DGAMMARAMP**](d3dgammaramp.md) . Структура **D3DGAMMARAMP** содержит массивы из 3 256 элементов, каждый из которых содержит красный, зеленый и синий цветовые гамма. **Жетгаммарамп** имеет один параметр, который принимает указатель на тип **D3DGAMMARAMP** , который будет заполнен текущей гаммой шкалы.

Можно включить \_ значение калибровки D3DSGR для первого параметра [**сетгаммарамп**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3ddevice9-setgammaramp) , чтобы вызвать калибратора при задании новых уровней гаммы. Калибровка цветовых гамм влияет на определенные затраты на обработку и не следует часто использовать. Задание калибровки гамма-шкалы обеспечивает единообразное и абсолютное значение гаммы для пользователя, независимо от адаптера дисплея и монитора.

Не все системы поддерживают гамма-калибровку. Чтобы определить, поддерживается ли гамма-калибровка, вызовите [**жетдевицекапс**](/windows/desktop/api)и изучите элемент Caps2 связанной структуры [**D3DCAPS9**](/windows/desktop/api/D3D9Caps/ns-d3d9caps-d3dcaps9) после того, как метод вернет значение. Если установлен \_ флаг возможностей D3DCAPS2 канкалибратегамма, то поддерживается гамма-калибровка.

При установке новых уровней пандус учитывайте, что уровни, заданные в массивах, используются только в том случае, если приложение находится в полноэкранном и монопольном режиме. Всякий раз, когда приложение меняется в нормальный режим, уровни пандуса откладываются, снова вступают в действие, когда приложение перейдет в полноэкранный режим.

Если устройство не поддерживает цветовые гаммы в текущем режиме представления цепочки буферов (полноэкранный или оконный), значение ошибки не возвращается. Приложения могут проверить \_ биты возможностей D3DCAPS2 фуллскрингамма и D3DCAPS2 \_ канкалибратегамма в элементе CAPS2 типа D3DCAPS9, чтобы определить возможности устройства и установить калибратора.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Поверхности Direct3D](direct3d-surfaces.md)
</dt> </dl>

 

 
