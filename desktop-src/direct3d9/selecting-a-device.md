---
description: Приложения могут запрашивать оборудование для обнаружения поддерживаемых типов устройств Direct3D. В этом разделе содержатся сведения о главных задачах, связанных с перечислением видеоадаптеров и выбором устройств Direct3D.
ms.assetid: d140b90c-3a20-49f4-883b-662b6c05dcea
title: Выбор устройства (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f63428e15948e15790364f310d55989a9bbc7339846f7db5d301e316bee4d872
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119044252"
---
# <a name="selecting-a-device-direct3d-9"></a>Выбор устройства (Direct3D 9)

Приложения могут запрашивать оборудование для обнаружения поддерживаемых типов устройств Direct3D. В этом разделе содержатся сведения о главных задачах, связанных с перечислением видеоадаптеров и выбором устройств Direct3D.

Приложение должно выполнить ряд задач, чтобы выбрать подходящее устройство Direct3D. Обратите внимание, что следующие шаги предназначены для полноэкранного приложения. в большинстве случаев оконное приложение может пропускать большинство этих шагов.

1.  Изначально приложение должно перечислить видеоадаптеры в системе. Адаптер — это физический компонент оборудования. Обратите внимание, что графическая карта может содержать больше одного адаптера, как в случае с двумя наконечниками. Приложения, не имеющие поддержки нескольких мониторов, могут проигнорировать этот шаг и передать D3DADAPTER \_ по умолчанию методу [**IDirect3D9:: енумадаптермодес**](/windows/win32/api/d3d9/nf-d3d9-idirect3d9-enumadaptermodes) на шаге 2.
2.  Для каждого адаптера приложение перечисляет поддерживаемые режимы экрана, вызывая [**IDirect3D9:: енумадаптермодес**](/windows/win32/api/d3d9/nf-d3d9-idirect3d9-enumadaptermodes).
3.  При необходимости приложение проверяет наличие аппаратного ускорения в каждом перечислимом режиме путем вызова [**IDirect3D9:: чеккдевицетипе**](/windows/win32/api/d3d9/nf-d3d9-idirect3d9-checkdevicetype), как показано в следующем примере кода. Обратите внимание, что это только одно из возможных применений для **IDirect3D9:: чеккдевицетипе**; Дополнительные сведения см. в разделе [Определение аппаратной поддержки (Direct3D 9)](determining-hardware-support.md).
    ```
    D3DPRESENT_PARAMETERS Params;
    // Initialize values for D3DPRESENT_PARAMETERS members. 

    Params.BackBufferFormat = D3DFMT_X1R5G5B5; 

    if(FAILED(m_pD3D->CheckDeviceType(Device.m_uAdapter, 
                      Device.m_DevType, 
                      Params.BackBufferFormat, Params.BackBufferFormat, 
                      FALSE))) 
        return E_FAIL;
    ```

    

4.  Приложение проверяет требуемый уровень функциональности для устройства на этом адаптере, вызывая метод [**IDirect3D9:: жетдевицекапс**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3d9-getdevicecaps) . Возможность, возвращаемая этим методом, гарантированно будет постоянной для устройства во всех режимах экрана, проверенных с помощью [**IDirect3D9:: чеккдевицетипе**](/windows/win32/api/d3d9/nf-d3d9-idirect3d9-checkdevicetype).
5.  Устройства всегда могут быть отображены на поверхности формата перечисленного режима отображения, поддерживаемого устройством. Если требуется, чтобы приложение отображалось на поверхности другого формата, оно может вызвать [**IDirect3D9:: чеккдевицеформат**](/windows/win32/api/d3d9/nf-d3d9-idirect3d9-checkdeviceformat). Если устройство может подготовиться к просмотру в формате, то гарантируется, что все возможности, возвращаемые [**IDirect3D9:: жетдевицекапс**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3d9-getdevicecaps) , применимы.
6.  Наконец, приложение может определить, поддерживаются ли Многовыборочные приемы, такие как сглаживание с полными сценами, для формата отрисовки с помощью метода [**IDirect3D9:: чеккдевицемултисамплетипе**](/windows/win32/api/d3d9/nf-d3d9-idirect3d9-checkdevicemultisampletype) .

После выполнения описанных выше действий приложение должно иметь список режимов экрана, в которых он может действовать. Последним шагом является проверка наличия достаточного объема доступной для устройства памяти для размещения необходимого количества буферов и сглаживания. Этот тест необходим, так как использование памяти для сочетания режима и многопримерной комбинации невозможно предсказать без проверки. Более того, некоторые архитектуры видеоадаптеров могут не иметь постоянного объема памяти, доступной для устройств. Это означает, что приложение должно иметь возможность сообщать о сбоях нехватки памяти при переходе в полноэкранный режим. Как правило, приложение должно удалить полноэкранный режим из списка режимов, которые он предлагает пользователю, или попытаться использовать меньше памяти, уменьшая количество задних буферов или используя менее сложный метод множественной выборки.

Оконное приложение выполняет аналогичный набор задач.

1.  Он определяет прямоугольник рабочего стола, покрываемый клиентской областью окна.
2.  Он перечисляет адаптеры, ищут адаптер, монитор которого охватывает клиентскую область. Если клиентская область принадлежит более чем одному адаптеру, то приложение может выбрать один из них для каждого адаптера или для одного адаптера и передать пикселы с одного устройства на другое в презентации. Приложение также может проигнорировать два предыдущих шага и использовать адаптер D3DADAPTER \_ по умолчанию. Обратите внимание, что это может привести к более медленной работе, когда окно помещается на дополнительный монитор.
3.  Приложение должно вызывать [**IDirect3D9:: чеккдевицетипе**](/windows/win32/api/d3d9/nf-d3d9-idirect3d9-checkdevicetype) , чтобы определить, может ли устройство поддерживать отрисовку в обратном буфере указанного формата в режиме рабочего стола. [**IDirect3D9:: жетадаптердисплаймоде**](/windows/win32/api/d3d9/nf-d3d9-idirect3d9-getadapterdisplaymode) можно использовать для определения формата отображения рабочего стола, как показано в следующем примере кода.
    ```
    D3DPRESENT_PARAMETERS Params;
    // Initialize values for D3DPRESENT_PARAMETERS members. 

    // Use the current display mode.
    D3DDISPLAYMODE mode;

    if(FAILED(m_pD3D->GetAdapterDisplayMode(Device.m_uAdapter , &mode)))
        return E_FAIL;

    Params.BackBufferFormat = mode.Format;

    if(FAILED(m_pD3D->CheckDeviceType(Device.m_uAdapter, Device.m_DevType, 
    Params.BackBufferFormat, Params.BackBufferFormat, FALSE)))
        return E_FAIL;
    ```

    

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Устройства Direct3D](direct3d-devices.md)
</dt> </dl>

 

 
