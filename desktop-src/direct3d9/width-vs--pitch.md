---
description: Хотя термины Width и тон часто используются неформально, они имеют очень важную и разные значения. В результате вы должны понимать смысл каждого из них и как интерпретировать значения, используемые Direct3D для их описания.
ms.assetid: 2f99881b-f95d-470f-b14d-8300ad930e2a
title: Ширина и шаг (Direct3D 9)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 8de1c697ec4c9278a78a5539818b30038d99fc9d59d96af7f22ee87c33949abf
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "120095522"
---
# <a name="width-vs-pitch-direct3d-9"></a>Ширина и шаг (Direct3D 9)

Хотя термины Width и тон часто используются неформально, они имеют очень важную и разные значения. В результате вы должны понимать смысл каждого из них и как интерпретировать значения, используемые Direct3D для их описания.

Direct3D использует структуру [**D3DSURFACE \_ DESC**](d3dsurface-desc.md) для передачи информации, описывающей поверхность. Помимо прочего, эта структура определена как содержащая сведения об измерениях поверхности, а также о том, как эти измерения представлены в памяти. Структура использует элементы Height и Width для описания логических измерений поверхности. Оба элемента измеряются в пикселях. Таким образом, значения высоты и ширины для поверхности 640 x 480 одинаковы, независимо от того, является ли это 8-разрядной или 24-разрядной поверхностью RGB.

При блокировке поверхности с помощью метода [**IDirect3DSurface9:: локкрект**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dsurface9-lockrect) метод заполняет структуру [**D3DLOCKED \_ Rect**](d3dlocked-rect.md) , содержащую шаг поверхности, и указатель на заблокированные биты. Значение в элементе «шаг» описывает тон памяти поверхности, также называемый STRIDE. Шаг — это расстояние в байтах между двумя адресами памяти, представляющими начало одной строки точечного рисунка, и начало следующей строки. Так как шаг измеряется в байтах, а не в пикселях, 640x480x8 поверхность имеет очень разное значение высоты, чем поверхность с теми же размерами, но с другим форматом пикселей. Кроме того, значение высоты иногда отражает байты, зарезервированные Direct3D в качестве кэша, поэтому неважно предположить, что высота — это просто ширина, умноженная на число байтов на пиксель. Вместо этого Визуализируйте разницу между шириной и шагом, как показано на следующей схеме.

![Схема высоты и ширины для одного и того же переднего буфера, заднего буфера и кэша](images/pitch.png)

На этой схеме передний буфер и задний буфер являются 640x480x8, а кэш — 384x480x8.

При непосредственном доступе к поверхностям Следите за тем, чтобы память, выделенная для измерений поверхности, оставалась в памяти, зарезервированной для кэша. Кроме того, при блокировке только части поверхности необходимо остаться внутри прямоугольника, указанного при блокировке поверхности. Несоблюдение этих рекомендаций приведет к непредсказуемым результатам. При отрисовке непосредственно в памяти поверхности всегда используйте шаг, возвращаемый методом [**IDirect3DSurface9:: локкрект**](/windows/win32/api/d3d9helper/nf-d3d9helper-idirect3dsurface9-lockrect) . Не следует вылагать шаг на основе только режима экрана. Если приложение работает на некоторых видеоадаптерах, но выглядит неискаженным, это может быть причиной проблемы.

Дополнительные сведения см. в разделе [доступ к памяти Surface напрямую (Direct3D 9)](accessing-surface-memory-directly.md).

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Поверхности Direct3D](direct3d-surfaces.md)
</dt> </dl>

 

 
