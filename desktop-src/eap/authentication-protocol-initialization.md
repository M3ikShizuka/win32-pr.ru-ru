---
title: Инициализация протокола проверки подлинности
description: Безопасное подключение EAP инициализируется между клиентом и сервером аналогичным образом для клиентов RAS и Wireless (802.1 X).
ms.assetid: 1cd5bfc9-2ba3-477c-9bbb-73578a5623c2
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e5d53643718f747e1f39aaf68393f92a0577455041ec765ca19bea710f2c3aca
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118984464"
---
# <a name="authentication-protocol-initialization"></a>Инициализация протокола проверки подлинности

Безопасное подключение EAP инициализируется между клиентом и сервером аналогичным образом для клиентов RAS и Wireless (802.1 X).

## <a name="client"></a>Клиент

Когда клиент пытается установить соединение, служба проверки подлинности получает [сведения об удостоверении](obtaining-identity-information.md) для пользователя. Если в реестре для этого протокола проверки подлинности указано значение **\_ \_ \_ \_ намедлг EAP** Call Call Invoke, а для этого параметра установлено значение 0, то служба проверки подлинности вызывает [**расеапжетидентити**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapgetidentity). Эта функция обычно отображает пользовательский интерфейс, который позволяет сведениям об удостоверениях иметь тип, характерный для протокола проверки подлинности. Например, сертификат или числовой идентификатор. Если **параметр \_ RAS \_ EAP \_ Invoke \_ намедлг** отсутствует или имеет значение 1, то служба проверки подлинности отображает стандартное диалоговое окно системного имени пользователя.

Когда служба проверки подлинности получает сведения об удостоверении для пользователя, она вызывает реализацию [**расеапбегин**](/previous-versions/windows/desktop/legacy/aa363520(v=vs.85))протокола проверки подлинности. Этот вызов позволяет протоколу проверки подлинности выделять и инициализировать рабочий буфер, который служба передает при последующих вызовах [**расеапмакемессаже**](/previous-versions/windows/desktop/legacy/aa363532(v=vs.85)) и [**расеапенд**](/previous-versions/windows/desktop/legacy/aa363521(v=vs.85)). Рабочий буфер непрозрачен для службы и никогда не обращается к содержимому буфера работ. Если протокол проверки подлинности создает отдельный рабочий буфер для каждого сеанса EAP, Рабочий буфер является сеансом и потокобезопасным. Так как протокол проверки подлинности выделяет память для рабочего буфера, протокол проверки подлинности также должен освободить эту память с помощью функции [**расеапфримемори**](/previous-versions/windows/desktop/api/Raseapif/nf-raseapif-raseapfreememory) .

В вызове [**расеапбегин**](/previous-versions/windows/desktop/legacy/aa363520(v=vs.85))служба также передает [**\_ \_ входную структуру PPP EAP**](/windows/desktop/api/Raseapif/ns-raseapif-ppp_eap_input) , содержащую указатели на сведения о конфигурации соединения, и сведения об удостоверении для пользователя. Служба всегда передает значение для члена **Псзидентити** **PPP \_ EAP \_ input**. Однако член **псзпассворд** [**\_ \_ входа PPP EAP**](/windows/desktop/api/Raseapif/ns-raseapif-ppp_eap_input) может иметь **значение NULL**.

В [**\_ \_ входной структуре PPP EAP**](/windows/desktop/api/Raseapif/ns-raseapif-ppp_eap_input) член **фаусентикатор** указывает, вызывается ли протокол проверки подлинности (на клиенте) или как средство проверки подлинности (на сервере).

## <a name="server"></a>Сервер

На сервере член **бинитиалид** [**\_ \_ входа PPP EAP**](/windows/desktop/api/Raseapif/ns-raseapif-ppp_eap_input) указывает идентификатор, используемый сервером для первого пакета EAP. Сервер увеличивает этот идентификатор для последующих пакетов.

Кроме того, на сервере указатель **пусераттрибутес** в [**\_ \_ входных данных протокола PPP EAP**](/windows/desktop/api/Raseapif/ns-raseapif-ppp_eap_input) указывает на массив атрибутов типа [**\_ \_ атрибута \_ проверки подлинности RAS**](/windows/win32/api/raseapif/ne-raseapif-ras_auth_attribute_type) . Это атрибуты пользователя, полученные от клиента.

Если вызов [**расеапбегин**](/previous-versions/windows/desktop/legacy/aa363520(v=vs.85)) возвращает любое значение, кроме **ошибки No \_ Error**, то сеанс отключается. Возвращенная ошибка заносится в журнал (на сервере) или отображается пользователю (на клиенте).

 

 