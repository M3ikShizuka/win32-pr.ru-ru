---
title: Схема и алгоритм профиля модели цветового оформления WCS
description: Схема и алгоритм профиля модели цветового оформления WCS
ms.assetid: 017588fe-cec9-4178-a912-7950cefc036c
keywords:
- Windows Система цветовой системы (WCS), профиль модели цветового оформления (CAMP)
- WCS (Windows цветовая система), профиль модели цветового оформления (CAMP)
- Управление цветом изображений, профиль модели цветового оформления (CAMP)
- Управление цветом, профиль модели цветового оформления (CAMP)
- цвет, профиль модели цветового оформления (CAMP)
- Windows Система цветовой системы (WCS), профили
- WCS (Windows цветовая система), профили
- Управление цветом изображений, профили
- Управление цветом, профили
- цвета, профили
- Профиль модели цветового оформления (CAMP)
- CAMP (профиль модели цветового оформления)
- схемы, профиль модели цветового оформления (CAMP)
- алгоритмы, профиль модели цветового оформления (CAMP)
- Профиль модели цветового оформления WCS
ms.localizationpriority: high
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 042cf74d264a7b5d40fdc30fec44784680a67b95363b579d0c7bebc7ececcedb
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "120090110"
---
# <a name="wcs-color-appearance-model-profile-schema-and-algorithm"></a>Схема и алгоритм профиля модели цветового оформления WCS

[Обзор](#overview)

[Архитектура профиля модели цветового оформления (CAMP)](#color-appearance-model-profile-architecture)

[Схема CAMP](#the-camp-schema)

[Элементы схемы CAMP](#the-camp-schema-elements)

[Алгоритм CAMP](#the-camp-algorithm)

### <a name="overview"></a>Обзор

Эта схема используется для указания содержимого профиля модели цветового представления (CAMP). Связанные базовые алгоритмы описаны в следующих разделах.

CAMP состоит из XML-тегов, которые предоставляют переменные значения для переменных модели внешнего вида CIECAM02 базового цвета. Сведения о диапазонах для параметров приведены в спецификации модели определения основного цвета и рекомендации по CIECAM02.

### <a name="color-appearance-model-profile-architecture"></a>Архитектура профиля модели цветового отображения

![Схема, на которой показана архитектура профиля CAMP, созданная с помощью тегов X M L.](images/camp-image002new.png)

### <a name="the-camp-schema"></a>Схема CAMP


```C++
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema
  xmlns:cam="http://schemas.microsoft.com/windows/2005/02/color/ColorAppearanceModel"
  xmlns:wcs="http://schemas.microsoft.com/windows/2005/02/color/WcsCommonProfileTypes"
  targetNamespace="http://schemas.microsoft.com/windows/2005/02/color/ColorAppearanceModel"
  xmlns:xs="http://www.w3.org/2001/XMLSchema"
  elementFormDefault="qualified"
  attributeFormDefault="unqualified"
  blockDefault="#all"
  version="1.0">

  <xs:annotation>
    <xs:documentation>
      Color Appearance Model profile schema.
      Copyright (C) Microsoft. All rights reserved.
    </xs:documentation>
  </xs:annotation>

  <xs:import namespace="http://schemas.microsoft.com/windows/2005/02/color/WcsCommonProfileTypes" />

  <xs:annotation>
    <xs:documentation>
      ColorAppearanceModel element contains viewing conditions
      parameters based on CIECAM02.
    </xs:documentation>
  </xs:annotation>
  <xs:element name="ColorAppearanceModel">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="ProfileName" type="wcs:MultiLocalizedTextType"/>
        <xs:element name="Description" type="wcs:MultiLocalizedTextType" minOccurs="0"/>
        <xs:element name="Author" type="wcs:MultiLocalizedTextType" minOccurs="0"/>
        <xs:element name="ViewingConditions">
          <xs:complexType>
            <xs:sequence>
              <xs:choice>
                <xs:element name="WhitePoint" type="wcs:NonNegativeCIEXYZType"/>
                <xs:element name="WhitePointName">
                  <xs:simpleType>
                    <xs:restriction base="xs:string">
                      <xs:enumeration value="D50"/>
                      <xs:enumeration value="D65"/>
                      <xs:enumeration value="A"/>
                      <xs:enumeration value="F2"/>
                    </xs:restriction>
                  </xs:simpleType>
                </xs:element>
              </xs:choice>
              <xs:element name="Background" type="wcs:NonNegativeCIEXYZType"/>
              <xs:choice>
                <xs:element name="ImpactOfSurround" type="xs:float"/>
                <xs:element name="Surround">
                  <xs:simpleType>
                    <xs:restriction base="xs:string">
                      <xs:enumeration value="Average"/>
                      <xs:enumeration value="Dim"/>
                      <xs:enumeration value="Dark"/>
                    </xs:restriction>
                  </xs:simpleType>
                </xs:element>
              </xs:choice>
              <xs:element name="LuminanceOfAdaptingField" type="xs:float"/>
              <xs:element name="DegreeOfAdaptation" type="xs:float"/>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="NormalizeToMediaWhitePoint" minOccurs="0">
          <xs:simpleType>
            <xs:restriction base="xs:string">
              <xs:enumeration value="True"/>
              <xs:enumeration value="False"/>
            </xs:restriction>
          </xs:simpleType>
        </xs:element>
      </xs:sequence>
      <xs:attribute name="ID" type="xs:string" use="optional" />
    </xs:complexType>
  </xs:element>
</xs:schema>
```



## <a name="the-camp-schema-elements"></a>Элементы схемы CAMP

## <a name="colorappearancemodel"></a>колораппеаранцемодел

Этот элемент является последовательностью:

1.  Строка имени файла,
2.  Необязательная строка описания
3.  Необязательная строка автора
4.  Элемент Виевингкондитионс.

**Условия проверки:** Каждый вложенный элемент проверяется по собственному типу. Длина строк ограничена 10 000 символами.

## <a name="namespace"></a>Пространство имен

xmlns: Камера = " http://schemas.microsoft.com/windows/2005/02/color/ColorAppearanceModel "

targetNamespace = " http://schemas.microsoft.com/windows/2005/02/color/ColorAppearanceModel "

## <a name="version"></a>Версия

версия &gt; 0,1 или &lt; = "1,0" с первым выпуском Windows Vista.

**Условия проверки:** Любое значение версии &lt; = 2,0 также допустимо для поддержки некритических изменений в формате.

## <a name="documentation"></a>Документация

Схема профиля модели цветового оформления.

(C) корпорация Майкрософт (Microsoft Corporation). All rights reserved.

**Условия проверки:** Каждый вложенный элемент проверяется по собственному типу.

## <a name="surroundtype"></a>сурраундтипе

Этот элемент является либо перечислением "среднего", "Dim", либо "темного" параметров CIECAM02, либо фактическим количественным параметром из рекомендации CIECAM02 c, влиянием окружающего элемента.

**Условия проверки:** Параметр c может находиться в диапазоне от 0,525 до 0,69.

## <a name="viewingconditions"></a>виевингкондитионс

Этот элемент состоит из следующих вложенных элементов:



| Элемент                    | Тип           |
|----------------------------|----------------|
| вхитепоинт                 | вхитепоинттипе |
| Историческая справка                 | Циексиз         |
| Окружа                   | сурраундтипе   |
| луминанцеофадаптингфиелд   | FLOAT          |
| дегриофадаптатион         | FLOAT          |
| нормализетомедиавхитепоинт | Логическое        |



 

**Условия проверки:** Вложенные элементы ЦИЕКСИЗ проверяются с помощью Ноннегативексизтипе. Луминанцеофадаптингфиелд имеет максимум 10, 000cd/m ^ 2. Дегриофадаптатион может находиться в диапазоне от 0,0 до 1,0. Значение Нормализетомедиавхитепоинт может быть либо "true", либо "false". Если вложенный элемент Нормализетомедиавхитепоинт отсутствует, по умолчанию он имеет значение true. См. подраздел о следующем алгоритме CAMP.

## <a name="whitepointtype"></a>вхитепоинттипе

Этот элемент является либо перечислением ЦИЕ источника освещения ("D50", "D65", "A," или "F2"), либо вложенным элементом ЦИЕКСИЗ.

**Условия проверки:** Каждый вложенный элемент проверяется по собственному типу.

## <a name="ciexyztype"></a>Циексизтипе

Элемент Циексизтипе состоит из трех Ноннегативефлоаттипеных элементов с плавающей запятой одиночной точности с именами "X", "Y" и "Z". Эти измерения могут быть абсолютными (не относительными) ЦИЕКСИЗ 1931 отражающими значениями или абсолютными (не относительными) ЦИЕКСИЗ 1931 прямыми (передаваемые) значениями в Канделас на единицы измерения с квадратом.

**Условия проверки:** Это означает, что допустимы только реальные значения, а отрицательные значения измерения ЦИЕКСИЗ недопустимы. Так как эти значения являются абсолютными, значения могут иметь более широкий диапазон, чем 1,0 f. Разумное ограничение для любого значения X, Y или Z будет произвольно установлено в 10000.0 f.

 

### <a name="the-camp-algorithm"></a>Алгоритм CAMP

Модель цветового оформления (камера) основана на уравнениях модели отображения цвета ЦИЕ CIECAM02.

Этот класс реализует моделирование цветового представления. Обратите внимание, что камера WCS *не может быть* заменяемой, например, с помощью подключаемого модуля. Задача разработки должна иметь только одну модель отображения цвета. Камера основана на рекомендациях CIECAM02.

CIECAM02 можно использовать двумя способами. В направлении «от + до-отображения» оно обеспечивает сопоставление пространства ЦИЕ XYZ с цветом. В направлении, сопоставленном с цветами, оно преобразуется обратно в пространство XYZ. Цветовой стиль соответствует освещениям, J, чрома, C и оттенок, h. Эти три значения образуют цилиндрическую систему координат. Часто бывает удобнее работать в прямоугольной системе координат, поэтому вычислить a = C COS h и b = C Sin h, чтобы предоставить CIECAM02 Jab.

Можно использовать значения яркости, превышающие 100. Комитет ЦИЕ, который настроил CIECAM02, не содержал поведение оси освещенности для входных значений с яркостью выше принятой белой точки; то есть, для входных значений Y больше, чем принятое значение Y белой точки. Эксперимент показывает, что уравнения светимости в CIECAM02 ведут себя так, как такие значения. Освещение увеличивается экспоненциально и следует за тем же экспонентой (примерно 1/3).

Иногда пользователям нужно изменить способ вычисления степени адаптации (D). Структура WCS позволяет пользователям управлять этим вычислением, изменяя значение Дегриофадаптатион в параметрах условий просмотра.

Чтобы обеспечить более согласованное соответствие требованиям ICC пользователей к ожиданиям, Дегриофадаптатион в Camp по умолчанию — 1,0. Это дает лучшие результаты во всех случаях, кроме Минкд Absolute, где может потребоваться разрешить WCS вычислить Дегриофадаптатион (через Дегриофадаптатион =-1).

Вместо использования окружающего значения "среднее", "Dim" и "темное" предоставляется непрерывное значение, вычисленное на основе значения c. Значение c должно быть числом в диапазоне от 0,525 до 0,69.

Из *c*, *NC* и *F* можно вычислить, используя линейную интерполяцию кусочно-между значениями, которые уже предоставлены для "среднего", "Dim" и "темного". Эта модель показывает, что показано на рисунке 1 ЦИЕ 159:2004, спецификации CIECAM02.



| дегриофадаптион                     | Поведение                                                                       |
|--------------------------------------|--------------------------------------------------------------------------------|
| -1.0                                 | ![Показывает формулу для поведения по умолчанию C I E C и M 02.](images/camp-image006.png)Это поведение CIECAM02 по умолчанию.<br/> |
| 0,0 &lt; = дегриофадаптион &lt; = 1,0 | *D* = дегриофадаптатион (значение, предоставленное пользователем)                      |



 

В реализацию также добавлен определенный объем проверки ошибок. Следующие числа уравнений используются в определении ЦИЕ 159:2004 CIECAM02.

**колориметриктоаппеаранцеколорс**

Входные значения проверяются на разумность: если X или Z &lt; 0,0 или Y &lt; -1,0, то значением HRESULT является E \_ INVALIDARG. Если-1,0 &lt; = Y &lt; 0,0, то для J, C и h устанавливается значение 0,0.

Существуют определенные внутренние условия, которые могут выдавать результаты ошибки. Вместо создания таких результатов внутренние результаты обрезаются для получения значений в диапазоне. Это происходит для спецификаций цветов, которые были бы темными и невероятными: в уравнении 7,23, если &lt; 0, a = 0. В уравнении 7,26, если t &lt; 0, t = 0.

**аппеаранцетоколориметрикколорс**

Входные значения проверяются на разумность. Если C &lt; 0, c &gt; 300 или J &gt; 500, то значением HRESULT является E \_ INVALIDARG.

*R "<sub>a;</sub>*, *G"<sub>a;</sub>* и *B "<sub>a;</sub>*(уравнения 8,19-8,21) обрезаются до диапазона 399,9.

Для всех профилей модели цветового оформления (Camp) подсистема WCS будет проверять принятые белые точки. Если значение Y не равно 100,0, то принятая белая точка будет масштабироваться таким образом, что Y равняется 100,0. То же масштабирование будет применено к значению фона. Коэффициент масштабирования — 100,0/Адоптедвхитепоинт. Y. Один и тот же коэффициент масштабирования применяется к каждому из X, Y и Z. Если поле Нормализетомедиавхитепоинт имеет значение «true» или отсутствует в CAMP, то механизм также масштабирует все входные цвета устройства в Девицетоколориметрик, чтобы значение Y белой точки носителя устройства совпадало с 100,0. Цвета устройств, поступающие из Колориметриктодевице, будут масштабироваться по мультипликативные в обратном масштабе этого коэффициента масштабирования. Если для флага Нормализетомедиавхитепоинт задано значение false, то данные не масштабируются.

Для некоторых задач имеет смысл масштабировать значения, поступающие от Девицетоколориметрик. Гиперболические освещение на белой панели на самом деле разработаны для светимости белого цвета 100,0. Единственное место, где происходит разница в абсолютной освещенности (или иллуминанце), зависит от освещенности поля адаптации. Таким образом, Камера должна быть инициализирована с белой точкой Y из 100,0. Но если в качестве принятой белой точки используется средняя точка в модели устройства, все цвета, поступающие от устройства, должны масштабироваться соответствующим образом, или белый список устройств не будет иметь значение J 100,0. Поэтому значения Y должны масштабироваться в измерениях. Значения измерений можно масштабировать до инициализации модели устройства. Затем результаты уже будут находиться в правильном диапазоне. Но это может усложнить тестирование модели устройства, так как поступающие значения требуют масштабирования. Для задач, в которых средняя белая точка устройства считается истинным белым, желательно нормализацию с помощью белой точки носителя устройства.

Камера инициализируется непосредственно из CAMP. Это позволяет разработчикам гибко выполнять инициализацию, основываясь на задаче, которую они хотят выполнить. В некоторых задачах наблюдатели игнорируют любые чрома в белых точках мультимедиа, так как они ясно узнают, что исходный и конечный носители являются белыми. В таких случаях разработчикам нужно будет инициализировать прямую и обратную видеорегистраторов с соответствующими белыми точками мультимедиа. В некоторых случаях наблюдатели могут сравнивать цвет фона мультимедиа. В таких случаях рекомендуется использовать одну и ту же шкалу для обоих устройств, и, возможно, нежелательно, чтобы масштабировать значения для каждого устройства на среднем белом месте. Затем различные значения тристимулус мультимедиа приведут к различным значениям внешнего вида в CIECAM02.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Основные понятия управления цветом](basic-color-management-concepts.md)
</dt> <dt>

[Схемы и алгоритмы цветовой системы Windows](windows-color-system-schemas-and-algorithms.md)
</dt> </dl>

 

 





