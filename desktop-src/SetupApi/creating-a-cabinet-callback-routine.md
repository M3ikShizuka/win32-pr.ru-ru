---
description: Так как API установки не предоставляет подпрограмму обратного вызова CAB-файла по умолчанию, необходимо предоставить подпрограмму. Подпрограммы обратного вызова, необходимые функции Сетупитератекабинет, должны иметь ту же форму, что и, на которую указывает Филекаллбакк.
ms.assetid: 45a2690e-1db6-4a09-a141-9e68ebc2a6d8
title: Создание подпрограммы обратного вызова CAB-файла
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1f25d59515a6afdd68cef4458868fbfb62335aed
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104264815"
---
# <a name="creating-a-cabinet-callback-routine"></a>Создание подпрограммы обратного вызова CAB-файла

Так как API установки не предоставляет подпрограмму обратного вызова CAB-файла по умолчанию, необходимо предоставить подпрограмму. Подпрограммы обратного вызова, необходимые функции [**сетупитератекабинет**](/windows/desktop/api/Setupapi/nf-setupapi-setupiteratecabineta) , должны иметь ту же форму, что и, на которую указывает [филекаллбакк](/windows/win32/api/setupapi/nc-setupapi-psp_file_callback_a).

Ниже приведен синтаксис, который [**сетупитератекабинет**](/windows/desktop/api/Setupapi/nf-setupapi-setupiteratecabineta) использует для отправки уведомления в подпрограммы обратного вызова.

``` syntax
MsgHandler(          //the specified callback routine
    Context,         //context used by the callback routine
    Notification,    //cabinet notification
    Param1,          //additional notification information
    Param2           //additional notification information
);
```

Параметр *контекста* является указателем void на переменную контекста или структуру, которую может использовать подпрограммы обратного вызова для хранения информации, которая должна сохраняться между последовательными вызовами подпрограммы обратного вызова.

Реализация этого контекста задается подделом обратного вызова и никогда не указывается или не изменяется с помощью [**сетупитератекабинет**](/windows/desktop/api/Setupapi/nf-setupapi-setupiteratecabineta).

Параметр *уведомления* является целым числом без знака и может принимать одно из следующих значений.



| Уведомление                                                        | Описание                                        |
|---------------------------------------------------------------------|----------------------------------------------------|
| [**СПФИЛЕНОТИФИ \_ филикстрактед**](spfilenotify-fileextracted.md)   | Файл был извлечен из CAB-файла.      |
| [**СПФИЛЕНОТИФИ \_ филеинкабинет**](spfilenotify-fileincabinet.md)   | В CAB-файле обнаружен файл.              |
| [**СПФИЛЕНОТИФИ \_ нидневкабинет**](spfilenotify-neednewcabinet.md) | Текущий файл продолжает работу в следующем CAB-файле. |



 

Последние два параметра, *param1* и *Param2*, являются также целыми числами без знака и содержат дополнительные сведения, относящиеся к уведомлению. Дополнительные сведения об уведомлениях, отправляемых [**сетупитератекабинет**](/windows/desktop/api/Setupapi/nf-setupapi-setupiteratecabineta), см. в разделе [уведомления о CAB-файлах](cabinet-file-notifications.md).

\_ \_ Процедура обратного вызова для уведомления о файле SP \_ возвращает целое число без знака. Подпрограммы обратного вызова CAB-файла должны возвращать одно из следующих значений в зависимости от уведомления.

Для уведомления СПФИЛЕНОТИФИ \_ Филеинкабинет [**сетупитератекабинет**](/windows/desktop/api/Setupapi/nf-setupapi-setupiteratecabineta) ожидает, что подпрограммы обратного вызова возвращают одно из следующих значений.



| Значение         | Значение                   |
|---------------|---------------------------|
| прервать ФИЛЕОП \_ | Прервать обработку CAB-файлов. |
| ФИЛЕОП \_ доит  | Извлеките текущий файл. |
| ФИЛЕОП \_ пропустить  | Пропустить текущий файл.    |



 

Для СПФИЛЕНОТИФИ \_ нидневкабинет и спфиленотифи \_ Филикстрактед уведомлений **сетупитератекабинет** ожидает, что подпрограммы обратного вызова возвращают одно из следующих значений.



| Значение      | Значение                                                                                                                                                                                                                           |
|------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| БЕЗ \_ ошибок  | Ошибок не обнаружено, продолжить обработку CAB-файла.                                                                                                                                                                        |
| Ошибка \_ xxx | Произошла ошибка указанного типа. Функция [**сетупитератекабинет**](/windows/desktop/api/Setupapi/nf-setupapi-setupiteratecabineta) вернет **значение false**, а указанный код ошибки будет возвращен вызовом [**GetLastError**](/windows/desktop/api/errhandlingapi/nf-errhandlingapi-getlasterror). |



 

Если подпрограммы обратного вызова возвращают ФИЛЕОП \_ доит, подпрограммы также должны предоставлять полный целевой путь. Дополнительные сведения см. в разделе [**спфиленотифи \_ филеинкабинет**](spfilenotify-fileincabinet.md).

 

 
