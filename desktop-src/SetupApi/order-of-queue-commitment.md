---
description: 'Когда функция Сетупкоммитфилекуеуе фиксирует очередь файлов, она обрабатывает операции с файлами в следующем порядке: операции удаления файлов, операции переименования файлов и, наконец, операции копирования файлов.'
ms.assetid: 23aae815-ff1a-435d-b14d-3c62a3355a1b
title: Порядок обязательств по очереди
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9a7ff3cc211b2a2d253dd307ca83113b536a3d9eaf21b7b2cec5bc977f585026
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119665543"
---
# <a name="order-of-queue-commitment"></a>Порядок обязательств по очереди

Когда функция [**сетупкоммитфилекуеуе**](/windows/desktop/api/Setupapi/nf-setupapi-setupcommitfilequeuea) фиксирует очередь файлов, она обрабатывает операции с файлами в следующем порядке: операции удаления файлов, операции переименования файлов и, наконец, операции копирования файлов. В следующей структуре показан жизненный цикл процесса фиксации очереди.

 

-   Запуск вложенной очереди удаления
    -   Запуск операции удаления файла <--REPEAT для каждого
    -   завершение операции удаления файла <--удаление из очереди файла
-   завершение вложенной очереди удаления

<!-- -->

-   запустить вложенную очередь переименования
    -   Запуск операции переименования файла <--REPEAT для каждого
    -   завершение операции удаления файла <--переименование файла в очереди
-   завершить вложенную очередь переименования

<!-- -->

-   Запуск субкуе копирования
    -   Запуск операции копирования файла <--REPEAT для каждого
    -   завершение операции копирования файла <--копирование файлов в очереди
    -   завершение вложенной очереди копирования
-   завершение очереди

 

На каждом шаге или при возникновении ошибки функция [**сетупкоммитфилекуеуе**](/windows/desktop/api/Setupapi/nf-setupapi-setupcommitfilequeuea) отправляет уведомление в подпрограммы обратного вызова. Подпрограмма обратного вызова может использовать информацию, отправленную очередью, для отслеживания хода установки и, при необходимости, взаимодействия с пользователем.

Например, если операции копирования файлов требуется исходный файл, который был недоступен по текущему пути, [**сетупкоммитфилекуеуе**](/windows/desktop/api/Setupapi/nf-setupapi-setupcommitfilequeuea) отправит уведомление о спфиленотифи \_ нидмедиа в подпрограммы обратного вызова, а также сведения о файлах и носителях. Подпрограмма обратного вызова может использовать эти сведения для создания диалогового окна, предлагающего пользователю вставить следующий диск путем вызова [ **сетуппромптфордиск**](/windows/desktop/api/Setupapi/nf-setupapi-setuppromptfordiska)

Подпрограмма обратного вызова очереди по умолчанию, [**сетупдефаулткуеуекаллбакк**](/windows/desktop/api/Setupapi/nf-setupapi-setupdefaultqueuecallbacka), включена в API установки. Эта подпрограммы обрабатывает уведомления очереди и создает для установки диалоговые окна ошибок и индикаторы выполнения. Вы можете использовать подпрограммы обратного вызова очереди по умолчанию, если она есть, или написать подпрограммы обратного вызова фильтра для выполнения подмножества уведомлений и передачи других параметров в подпрограммы обратного вызова очереди по умолчанию.

Если ни одна из функций подпрограммы обратного вызова не подходит для ваших нужд, можно написать автономную подпрограммы обратного вызова, которая не вызывает подпрограммы обратного вызова очереди по умолчанию.

Дополнительные сведения о подфункциях обратного вызова очереди см. в разделе подпрограммы [обратного вызова очереди по умолчанию](default-queue-callback-routine.md)и [создании подпрограммы обратного вызова пользовательской очереди](creating-a-custom-queue-callback-routine.md).

 

 



