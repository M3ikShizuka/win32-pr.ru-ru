---
description: В дополнение к использованию обратного вызова по умолчанию очереди можно написать собственную подпрограммы обратного вызова.
ms.assetid: 68781565-71a2-43bf-ad01-7c1cdc514f7b
title: Создание пользовательской подпрограммы обратного вызова очереди
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f0602e32ef97ea962ca91375318bb563c0809da0dc4877aa6c9439644b52408e
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118887514"
---
# <a name="creating-a-custom-queue-callback-routine"></a>Создание пользовательской подпрограммы обратного вызова очереди

В дополнение к использованию обратного вызова по умолчанию очереди можно написать собственную подпрограммы обратного вызова. Эта функция должна иметь ту же форму, что и [*филекаллбакк*](/windows/win32/api/setupapi/nc-setupapi-psp_file_callback_a). Это полезно, если необходима подпрограммы обратного вызова для обработки уведомления другими способами, чем предоставлено подпрограммыми обратного вызова очереди по умолчанию.

Если необходимо изменить только небольшую часть поведения подпрограммы обратного вызова очереди по умолчанию, можно создать пользовательскую подпрограммы обратного вызова для фильтрации уведомлений, обработки только тех, которые требуют специального поведения и вызова [**сетупдефаулткуеуекаллбакк**](/windows/desktop/api/Setupapi/nf-setupapi-setupdefaultqueuecallbacka) для других.

Например, если вы хотите выполнить пользовательскую обработку ошибок удаления файла, можно создать пользовательскую функцию обратного вызова *микаллбакк*. Эта функция перехватывает и обрабатывает уведомления [**спфиленотифи \_ делетиррор**](spfilenotify-deleteerror.md) и вызывает функцию обратного вызова очереди по умолчанию для всех остальных уведомлений. *Микаллбакк* возвращает значение для уведомлений об ошибках удаления. Для всех остальных уведомлений *микаллбакк* передает любое значение подпрограммы обратного вызова очереди по умолчанию, возвращаемой в очередь.

Этот поток управления показан на следующей схеме.

![стрелки и поля, отображающие поток данных для пользовательского функции обратного вызова](images/callback.png)

> [!IMPORTANT]
> Если пользовательская функция обратного вызова вызывает подпрограммы обратного вызова очереди по умолчанию, она должна передать указатель void, возвращенный [**сетупинитдефаулткуеуекаллбакк**](/windows/desktop/api/Setupapi/nf-setupapi-setupinitdefaultqueuecallback) или [**сетупинитдефаулткуеуекаллбаккекс**](/windows/desktop/api/Setupapi/nf-setupapi-setupinitdefaultqueuecallbackex) , в подпрограммы обратного вызова по умолчанию.

 

 

 
