---
description: Публикуется в приложении, когда пользователь отменяет действия по записи в журнал. Сообщение публикуется с нулевым маркером окна.
ms.assetid: 7515acb5-4526-40f7-abb7-822a073ac7dc
title: Сообщение WM_CANCELJOURNAL (Winuser. h)
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 3a5676472d12c8cef2a03e508eca6bb742596a36
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105702583"
---
# <a name="wm_canceljournal-message"></a>\_Сообщение КАНЦЕЛЖАУРНАЛ WM

Публикуется в приложении, когда пользователь отменяет действия по записи в журнал. Сообщение публикуется с **нулевым** маркером окна.


```C++
#define WM_CANCELJOURNAL                0x004B
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*wParam* 
</dt> <dd>

Этот параметр не используется.

</dd> <dt>

*lParam* 
</dt> <dd>

Этот параметр не используется.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Тип: **void**

Это сообщение не возвращает значение. Она должна обрабатываться из главного цикла приложения или процедуры обработки [**сообщений**](/windows/win32/api/winuser/nf-winuser-getmessage) , а не из оконной процедуры.

## <a name="remarks"></a>Комментарии

Записи журнала и режимы воспроизведения — это режимы, установленные в системе, позволяющие приложению последовательно записывать или воспроизводить ввод данных пользователем. Система переходит в эти режимы, когда приложение устанавливает процедуру-обработчик [*жаурналрекордпрок*](/previous-versions/windows/desktop/legacy/ms644983(v=vs.85)) или [*жаурналплайбаккпрок*](/previous-versions/windows/desktop/legacy/ms644982(v=vs.85)) . Если система находится в одном из этих режимов ведения журнала, приложения должны переключаться на чтение входных данных из очереди ввода. Если какое-либо приложение прекращает чтение входных данных, пока система находится в режиме ведения журнала, другие приложения вынуждены ожидать.

Чтобы обеспечить надежную систему, которая не может быть недоступна для какого-либо приложения, система автоматически отменяет все действия по внесению в журнал, когда пользователь нажимает клавиши CTRL + ESC или CTRL + ALT + DEL. Затем система отсоединяет все процедуры-обработчики ведения журнала и отправляет сообщение **\_ канцелжаурнал WM** с **нулевым** маркером окна в приложение, которое устанавливает обработчик ведения журнала.

Сообщение **WM \_ Канцелжаурнал** имеет **нулевой** обработчик окна, поэтому его нельзя отправить в оконную процедуру. Существует два способа, с помощью которых приложение может видеть **сообщение \_ канцелжаурнал WM** : Если приложение выполняется в собственном главном цикле, оно должно перехватить сообщение между вызовом метода [**или**](/windows/win32/api/winuser/nf-winuser-getmessage) [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) и его вызовом [**DispatchMessage**](/windows/win32/api/winuser/nf-winuser-dispatchmessage). Если приложение не выполняется в собственном главном цикле, оно должно установить процедуру-обработчик [*жетмсгпрок*](/previous-versions/windows/desktop/legacy/ms644981(v=vs.85)) (с помощью вызова [**сетвиндовшукекс**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) , указывающего тип обработчика **\_ сообщений** , который отслеживает сообщение).

Когда приложение видит сообщение **WM \_ канцелжаурнал** , оно может предположить две вещи: пользователь намеренно отменил запись журнала или режим воспроизведения, и система уже отключила какие-либо процедуры записи журнала или обработчика воспроизведения.

Обратите внимание, что сочетания клавиш, упомянутые выше (CTRL + ESC или CTRL + ALT + DEL), приводят к отмене ведения журнала системой. Если какое-либо приложение не отвечает, они дают пользователю возможность восстановления. Код виртуального ключа [**VK \_ Cancel**](../inputdev/virtual-key-codes.md) (обычно реализованный в виде сочетания клавиш Ctrl + Break) — это то, что должно отслеживать приложение, настоящее в режиме записи в журнале, в качестве сигнала, который пользователь хочет отменить действие ведения журнала. Разница заключается в том, что наблюдение за **VK \_ Cancel** является рекомендуемым поведением для ведения журнала приложений, в то время как CTRL + ESC или Ctrl + Alt + Del приводит к отмене ведения журнала независимо от поведения приложения журнала.

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|----------------------------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows 2000 Professional \[только классические приложения\]<br/>                                               |
| Минимальная версия сервера<br/> | Windows 2000 Server \[только классические приложения\]<br/>                                                     |
| Заголовок<br/>                   | <dl> <dt>Winuser. h (включение Windows. h)</dt> </dl> |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

**Ссылки**
</dt> <dt>

[*жаурналплайбаккпрок*](/previous-versions/windows/desktop/legacy/ms644982(v=vs.85))
</dt> <dt>

[*жаурналрекордпрок*](/previous-versions/windows/desktop/legacy/ms644983(v=vs.85))
</dt> <dt>

[*жетмсгпрок*](/previous-versions/windows/desktop/legacy/ms644981(v=vs.85))
</dt> <dt>

[**сетвиндовшукекс**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa)
</dt> <dt>

**Зрения**
</dt> <dt>

[Обработчики](hooks.md)
</dt> </dl>

 

 
