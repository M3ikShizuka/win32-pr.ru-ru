---
description: В этом разделе обсуждаются обработчики. Обработчик — это точка в механизме обработки системных сообщений, в которой приложение может установить подпрограммы для мониторинга трафика сообщений.
ms.assetid: vs|winui|~\winui\windowsuserinterface\windowing\hooks.htm
title: Обработчики
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 74057d25e3152c8782c2be364688bb971b08ddf5
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104272084"
---
# <a name="hooks"></a>Обработчики

Обработчик — это точка в механизме обработки сообщений системы, где приложение может установить подпрограммы для отслеживания трафика сообщений в системе и обработать определенные типы сообщений до того, как они достигли целевой процедуры окна.

### <a name="in-this-section"></a>в этом разделе



| Имя                                 | Описание                                                         |
|--------------------------------------|---------------------------------------------------------------------|
| [Общие сведения о обработчике](about-hooks.md)     | Описывает, как использовать перехватчики.<br/>                      |
| [Использование перехватчиков](using-hooks.md)       | Демонстрирует выполнение задач, связанных с обработчиками.<br/> |
| [Ссылка на обработчик](hook-reference.md) | Содержит справочник по API.<br/>                              |



 

### <a name="hook-functions"></a>Функции-ловушки



| Имя                                               | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|----------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**каллмсгфилтер**](/windows/win32/api/winuser/nf-winuser-callmsgfiltera)             | Передает указанное сообщение и код обработчика процедурам-обработчикам, связанным с [**\_ сисмсгфилтер**](about-hooks.md) и **\_ предмсгфилтерными** процедурами-обработчиками.<br/>                                                                                                                                                                                                                                                                                                                                                                                      |
| [**каллнекссукекс**](/windows/win32/api/winuser/nf-winuser-callnexthookex)           | Передает сведения о обработчике в следующую процедуру-обработчик в текущей цепочке прерываний. Процедура-обработчик может вызвать эту функцию до или после обработки сведений о обработчике. <br/>                                                                                                                                                                                                                                                                                                                                                                                                         |
| [*каллвндпрок*](/previous-versions/windows/desktop/legacy/ms644975(v=vs.85))                   | Определяемая приложением или библиотекой функция обратного вызова, используемая с функцией [**сетвиндовшукекс**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) . Система вызывает эту функцию перед вызовом окна процедуры для обработки сообщения, отправленного в поток.<br/>                                                                                                                                                                                                                                                                                                                                               |
| [*каллвндретпрок*](/windows/win32/api/winuser/nc-winuser-hookproc)             | Определяемая приложением или библиотекой функция обратного вызова, используемая с функцией [**сетвиндовшукекс**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) . Система вызывает эту функцию после вызова функции [**SendMessage**](/windows/win32/api/winuser/nf-winuser-sendmessage) . Процедура-обработчик может проверить сообщение; Он не может изменить его. <br/>                                                                                                                                                                                                                                                                                         |
| [*кбтпрок*](/previous-versions/windows/desktop/legacy/ms644977(v=vs.85))                           | Определяемая приложением или библиотекой функция обратного вызова, используемая с функцией [**сетвиндовшукекс**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) . Система вызывает эту функцию перед активацией, созданием, уничтожением, свертыванием, разворачиванием, перемещением или изменением размера окна. перед завершением системной команды; перед удалением события мыши или клавиатуры из очереди системных сообщений; Перед настройкой фокуса клавиатуры; или перед синхронизацией с системной очередью сообщений. Приложение для обучения на основе компьютеров (CBT) использует эту процедуру-обработчик для получения полезных уведомлений от системы. <br/> |
| [*дебугпрок*](/previous-versions/windows/desktop/legacy/ms644978(v=vs.85))                       | Определяемая приложением или библиотекой функция обратного вызова, используемая с функцией [**сетвиндовшукекс**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) . Система вызывает эту функцию перед вызовом процедур-обработчиков, связанных с обработчиком любого типа. Система передает сведения о обработчике, вызываемом в процедуру обработчика [*дебугпрок*](/previous-versions/windows/desktop/legacy/ms644978(v=vs.85)) , которая проверяет сведения и определяет, следует ли разрешить вызов обработчика. <br/>                                                                                                                                                  |
| [*фореграундидлепрок*](/previous-versions/windows/desktop/legacy/ms644980(v=vs.85))     | Определяемая приложением или библиотекой функция обратного вызова, используемая с функцией [**сетвиндовшукекс**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) . Система вызывает эту функцию всякий раз, когда основной поток собирается стать бездействующим. <br/>                                                                                                                                                                                                                                                                                                                                                                   |
| [*жетмсгпрок*](/previous-versions/windows/desktop/legacy/ms644981(v=vs.85))                     | Определяемая приложением или библиотекой функция обратного вызова, используемая с функцией [**сетвиндовшукекс**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) . Система вызывает эту функцию при извлечении сообщения из очереди сообщений приложения функцией [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) или функции WITH [**Message**](/windows/win32/api/winuser/nf-winuser-getmessage) . Перед возвратом полученного сообщения вызывающему объекту система передает сообщение в процедуру-обработчик. <br/>                                                                                                                                                        |
| [*жаурналплайбаккпрок*](/previous-versions/windows/desktop/legacy/ms644982(v=vs.85))   | Определяемая приложением или библиотекой функция обратного вызова, используемая с функцией [**сетвиндовшукекс**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) . Как правило, приложение использует эту функцию для воспроизведения ряда сообщений мыши и клавиатуры, записанных ранее с помощью процедуры-обработчика [*жаурналрекордпрок*](/previous-versions/windows/desktop/legacy/ms644983(v=vs.85)) . При условии, что процедура обработчика [*жаурналплайбаккпрок*](/previous-versions/windows/desktop/legacy/ms644982(v=vs.85)) установлена, обычная мышь и ввод с клавиатуры отключаются. <br/>                                                                                                                       |
| [*жаурналрекордпрок*](/previous-versions/windows/desktop/legacy/ms644983(v=vs.85))       | Определяемая приложением или библиотекой функция обратного вызова, используемая с функцией [**сетвиндовшукекс**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) . Функция записывает сообщения, которые система удаляет из очереди системных сообщений. Позже приложение может использовать процедуру-обработчик [*жаурналплайбаккпрок*](/previous-versions/windows/desktop/legacy/ms644982(v=vs.85)) для воспроизведения сообщений. <br/>                                                                                                                                                                                                                                               |
| [*кэйбоардпрок*](/previous-versions/windows/desktop/legacy/ms644984(v=vs.85))                 | Определяемая приложением или библиотекой функция обратного вызова, используемая с функцией [**сетвиндовшукекс**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) . Система вызывает эту функцию всякий [**раз, когда**](/windows/win32/api/winuser/nf-winuser-getmessage) приложение вызывает функцию [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) и для обработки используется сообщение клавиатуры ([**WM \_ KEYUP**](/windows/desktop/inputdev/wm-keyup) или [**WM \_ KeyDown**](/windows/desktop/inputdev/wm-keydown)). <br/>                                                                                                                                                                         |
| [*ловлевелкэйбоардпрок*](/previous-versions/windows/desktop/legacy/ms644985(v=vs.85)) | Определяемая приложением или библиотекой функция обратного вызова, используемая с функцией [**сетвиндовшукекс**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) . Система вызывает эту функцию каждый раз, когда будет отправлено новое событие ввода с клавиатуры в очередь входных потоков.<br/>                                                                                                                                                                                                                                                                                                                                     |
| [*ловлевелмаусепрок*](/previous-versions/windows/desktop/legacy/ms644986(v=vs.85))       | Определяемая приложением или библиотекой функция обратного вызова, используемая с функцией [**сетвиндовшукекс**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) . Система вызывает эту функцию каждый раз, когда будет отправлено новое событие ввода-вывода мыши в очередь входных потоков.<br/>                                                                                                                                                                                                                                                                                                                                        |
| [*MessageProc*](/previous-versions/windows/desktop/legacy/ms644987(v=vs.85))                   | Определяемая приложением или библиотекой функция обратного вызова, используемая с функцией [**сетвиндовшукекс**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) . Система вызывает эту функцию после возникновения события ввода в диалоговом окне, окне сообщения, меню или полосе прокрутки, но до обработки сообщения, созданного событием ввода. Процедура-обработчик может отслеживать сообщения для диалогового окна, окна сообщения, меню или полосы прокрутки, созданной определенным приложением или всеми приложениями.<br/>                                                                                                                       |
| [*маусепрок*](/previous-versions/windows/desktop/legacy/ms644988(v=vs.85))                       | Определяемая приложением или библиотекой функция обратного вызова, используемая с функцией [**сетвиндовшукекс**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) . Система вызывает эту функцию всякий [**раз, когда**](/windows/win32/api/winuser/nf-winuser-getmessage) приложение вызывает функцию [**PeekMessage**](/windows/win32/api/winuser/nf-winuser-peekmessagea) и для обработки сообщений мыши. <br/>                                                                                                                                                                                                                                                           |
| [**сетвиндовшукекс**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa)       | Устанавливает определяемую приложением процедуру-обработчик в цепочку обработчиков. Необходимо установить процедуру-обработчик для мониторинга системы для определенных типов событий. Эти события связаны либо с конкретным потоком, либо со всеми потоками, настольными в том же рабочем столе, что и вызывающий поток.<br/>                                                                                                                                                                                                                                                                                                           |
| [*шеллпрок*](/previous-versions/windows/desktop/legacy/ms644991(v=vs.85))                       | Определяемая приложением или библиотекой функция обратного вызова, используемая с функцией [**сетвиндовшукекс**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) . Функция получает уведомления о событиях оболочки от системы.<br/>                                                                                                                                                                                                                                                                                                                                                                                      |
| [*сисмсгпрок*](/previous-versions/windows/desktop/legacy/ms644992(v=vs.85))                     | Определяемая приложением или библиотекой функция обратного вызова, используемая с функцией [**сетвиндовшукекс**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) . Система вызывает эту функцию после возникновения события ввода в диалоговом окне, окне сообщения, меню или полосе прокрутки, но до обработки сообщения, созданного событием ввода. Функция может отслеживать сообщения для любого диалогового окна, окна сообщения, меню или полосы прокрутки в системе. <br/>                                                                                                                                                                    |
| [**унхуквиндовшукекс**](/windows/win32/api/winuser/nf-winuser-unhookwindowshookex) | Удаляет процедуру-обработчик, установленную в цепочке перехватчиков функцией [**сетвиндовшукекс**](/windows/win32/api/winuser/nf-winuser-setwindowshookexa) . <br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |



 

### <a name="hook-notifications"></a>Уведомления о ловушках



| Имя                                          | Описание                                                                                                                                                                         |
|-----------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**WM \_ канцелжаурнал**](wm-canceljournal.md) | Публикуется в приложении, когда пользователь отменяет действия по записи в журнал. Сообщение публикуется с **нулевым** маркером окна. <br/>                              |
| [**WM \_ куеуесинк**](wm-queuesync.md)         | Отправляется приложением CBT для разделения сообщений, вводимых пользователем, от других сообщений, отправленных с помощью процедуры [**\_ жаурналплайбакк**](about-hooks.md) . <br/> |



 

### <a name="hook-structures"></a>Структуры обработчиков



| Имя                                           | Описание                                                                                                                                                                                                                 |
|------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**CBT \_ креатевнд**](/windows/win32/api/winuser/ns-winuser-cbt_createwnda)        | Содержит сведения, передаваемые в процедуру **\_ CBT** -обработчика [*кбтпрок*](/previous-versions/windows/desktop/legacy/ms644977(v=vs.85))перед созданием окна.<br/>                                                                                               |
| [**кбтактиватеструкт**](/windows/win32/api/winuser/ns-winuser-cbtactivatestruct) | Содержит сведения, передаваемые в процедуру **\_ CBT** -обработчика, [*кбтпрок*](/previous-versions/windows/desktop/legacy/ms644977(v=vs.85))перед активацией окна. <br/>                                                                                            |
| [**квпретструкт**](/windows/win32/api/winuser/ns-winuser-cwpretstruct)           | Определяет параметры сообщения, передаваемые в **процедуру \_ каллвндпрокрет** -обработчика, [*каллвндретпрок*](/windows/win32/api/winuser/nc-winuser-hookproc). <br/>                                                                                       |
| [**квпструкт**](/windows/win32/api/winuser/ns-winuser-cwpstruct)                 | Определяет параметры сообщения, передаваемые в **процедуру \_ каллвндпрок** -обработчика, [*каллвндпрок*](/previous-versions/windows/desktop/legacy/ms644975(v=vs.85)). <br/>                                                                                                |
| [**дебугхукинфо**](/windows/win32/api/winuser/ns-winuser-debughookinfo)         | Содержит отладочную информацию, переданную в процедуру-ловушку **\_ отладки** [*дебугпрок*](/previous-versions/windows/desktop/legacy/ms644978(v=vs.85)). <br/>                                                                                                          |
| [**евентмсг**](/windows/win32/api/winuser/ns-winuser-eventmsg)                   | Содержит сведения об аппаратном сообщении, отправленном в очередь системных сообщений. Эта структура используется для хранения сведений о сообщении для функции обратного вызова [*жаурналплайбаккпрок*](/previous-versions/windows/desktop/legacy/ms644982(v=vs.85)) . <br/> |
| [**кбдллхукструкт**](/windows/win32/api/winuser/ns-winuser-kbdllhookstruct)     | Содержит сведения о событии ввода с помощью клавиатуры низкого уровня. <br/>                                                                                                                                                    |
| [**маусехукструкт**](/windows/win32/api/winuser/ns-winuser-mousehookstruct)     | Содержит сведения о событии мыши, переданном в какую-либо процедуру обработчика **\_ мыши** , [*маусепрок*](/previous-versions/windows/desktop/legacy/ms644988(v=vs.85)). <br/>                                                                                                |
| [**маусехукструктекс**](/windows/win32/api/winuser/ns-winuser-mousehookstructex) | Содержит сведения о событии мыши, переданном в какую-либо процедуру обработчика **\_ мыши** , [*маусепрок*](/previous-versions/windows/desktop/legacy/ms644988(v=vs.85)). <br/>                                                                                                |
| [**мсллхукструкт**](/windows/win32/api/winuser/ns-winuser-msllhookstruct)       | Содержит сведения о событии ввода мыши низкого уровня. <br/>                                                                                                                                                       |



 

## <a name="related-topics"></a>См. также

<dl> <dt>

[**сетвиневенсук**](/windows/desktop/api/winuser/nf-winuser-setwineventhook)
</dt> </dl>

 

