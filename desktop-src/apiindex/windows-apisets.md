---
description: Наборы API — это функциональные группы API-интерфейсов Win32 в основной операционной системе. Они предоставляют архитектурное разделение от библиотеки DLL узла, в которой определен заданный API Win32, и функциональную группу, к которой принадлежит API.
title: Наборы API Windows
ms.topic: article
ms.date: 10/14/2020
ms.openlocfilehash: 15c8e6ad8124abf06e6ab3c2a8ca2bcd83772855
ms.sourcegitcommit: db89157e3be911fdce2e543e99faa31fb2403bc8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/18/2020
ms.locfileid: "104488616"
---
# <a name="windows-api-sets"></a>Наборы API Windows

Все версии Windows 10 совместно используют общую основу компонентов операционной системы, которая называется *основной ОС* (в некоторых контекстах эта общая основа также называется *OneCore*). В основных компонентах ОС API Win32 организованы в функциональные группы, которые называются *наборами API*.

Целью набора API является предоставление архитектурного разделения от библиотеки DLL узла, в которой реализован данный API Win32, и функционального контракта, к которому принадлежит API. Разделение, предоставляемое наборами API между реализацией и контрактами, предоставляет разработчикам множество преимуществ для инженеров. В частности, использование наборов API в коде может улучшить совместимость со всеми устройствами Windows 10.

Наборы API специально предназначены для следующих сценариев:

- Хотя все возможности API Win32 поддерживаются на компьютерах, только подмножество API Win32 доступно на других устройствах Windows 10, таких как HoloLens, Xbox и другие устройства под управлением Windows 10 раз. Имя набора API предоставляет механизм запросов, позволяющий четко определить, доступен ли API на любом конкретном устройстве.

- Некоторые реализации API Win32 существуют в библиотеках DLL с разными именами на разных устройствах Windows 10. Использование имен наборов API вместо имен библиотек DLL при обнаружении API доступности и отложенной загрузки API обеспечивает правильный маршрут к реализации независимо от того, где фактически реализован API.

Дополнительные сведения см. в разделе [Операция загрузчика набора API](api-set-loader-operation.md) и [Определение доступности набора API](detect-api-set-availability.md).

## <a name="linking-to-umbrella-libraries"></a>Связывание с библиотеками "тег"

Чтобы упростить ограничение кода интерфейсами API Win32, которые поддерживаются в основной ОС, мы предоставляем ряд *библиотек*-кодов. Например, Библиотека с именем OneCore. lib предоставляет экспорты для подмножества API-интерфейсов Win32, общих для всех устройств Windows 10.

API-интерфейсы в библиотеке-области могут быть реализованы в разных модулях. Библиотека «тег» абстрагирует эти сведения от вас, делая код более переносимым в разных версиях и устройствах Windows 10. Вместо связывания с библиотеками, такими как Kernel32. lib и advapi32. lib, просто Свяжите свое классическое приложение или драйвер с библиотекой-символами-разработчиками, которая содержит набор основных API ОС, которые вас интересуют.

Дополнительные сведения см. в разделе [библиотеки подсистемы Windows](windows-umbrella-libraries.md).

## <a name="api-set-contract-names"></a>Имена контрактов набора API

Наборы API идентифицируются строгим именем контракта, которое соответствует стандартным соглашениям, распознаваемым загрузчиком библиотеки. 

- Имя должно начинаться с строки **API** или **ext-**. 
    - Имена, начинающиеся с **API** , представляют интерфейсы API, которые гарантированно существуют во всех версиях Windows 10.
    - Имена, начинающиеся с **ext** , представляют интерфейсы API, которые могут не существовать во всех версиях Windows 10.
- Имя должно заканчиваться последовательностью **l \<n\> - \<n\> - \<n\>**, где **n** состоит из десятичных цифр.
- Текст имени может быть буквенно-цифровым символом или тире ( **-** ).
- Регистр букв в имени не учитывается.

Ниже приведены некоторые примеры имен контрактов для наборов API.

- **API-MS-Win-Core-UMS-L1-1-0**
- **Ext-MS-Win-com-ole32-L1-1-5**
- **Ext-MS-Win-NTuser-Window-L1-1-0**
- **Ext-MS-Win-NTuser-Window-L1-1-1**

Имя набора API можно использовать в контексте операции загрузчика, например [LoadLibrary](/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibrarya) или [P/Invoke](/dotnet/standard/native-interop/pinvoke) , вместо имени модуля DLL, чтобы обеспечить правильный маршрут к реализации независимо от того, где фактически реализован API на текущем устройстве. Однако при этом необходимо добавить String **. dll** в конце имени контракта. Это требование для правильной работы загрузчика и не считается частью имени контракта. Хотя имена контрактов похожи на имена библиотек DLL в этом контексте, они имеют фундаментальные отличия от имен модулей DLL и не ссылаются непосредственно на файл на диске.

За исключением добавления строки **. dll** в операции загрузчика, имена контрактов набора API должны рассматриваться как неизменяемые идентификаторы, соответствующие определенной версии контракта.

## <a name="identifying-api-sets-for-win32-apis"></a>Определение наборов API для API-интерфейсов Win32

Чтобы определить, принадлежит ли конкретный API Win32 набору API, ознакомьтесь с таблицей требований в справочной документации по API. Если API принадлежит к набору API, в таблице требований в статье перечислены имя набора API и версия Windows, в которой API впервые появился в наборе API. Примеры API-интерфейсов, принадлежащих набору API, см. в следующих статьях:

- [алловсетфореграундвиндов](/windows/win32/api/winuser/nf-winuser-allowsetforegroundwindow)
- [финдвиндовсекс](/windows/win32/api/winuser/nf-winuser-findwindowexa)
- [жетклассфиле](/windows/win32/api/objbase/nf-objbase-getclassfile)

## <a name="in-this-section"></a>Содержание раздела

* [Операция загрузчика набора API](api-set-loader-operation.md)
* [Определение доступности набора API](detect-api-set-availability.md)
* [Общие библиотеки Windows](windows-umbrella-libraries.md)