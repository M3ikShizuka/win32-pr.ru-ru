---
title: Сообщение WM_GESTURE (Winuser. h)
description: Передает сведения о жесте.
ms.assetid: 4167aeb0-2c31-4b7b-ad1b-e6d37da09ef8
keywords:
- WM_GESTURE сообщений Windows Touch
topic_type:
- apiref
api_name:
- WM_GESTURE
api_location:
- winuser.h
api_type:
- HeaderDef
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 1d1184d1f54d110f84630a727decb91ad28e6c08
ms.sourcegitcommit: a1494c819bc5200050696e66057f1020f5b142cb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2020
ms.locfileid: "104415813"
---
# <a name="wm_gesture-message"></a>\_Сообщение жеста WM

Передает сведения о жесте.

## <a name="parameters"></a>Параметры

<dl> <dt>

*wParam* 
</dt> <dd>

Предоставляет сведения, идентифицирующие команду жеста и значения аргумента, относящиеся к жесту. Эти сведения являются теми же данными, которые передаются в члене **улларгументс** структуры [**GESTUREINFO**](/windows/win32/api/winuser/ns-winuser-gestureinfo) .

</dd> <dt>

*lParam* 
</dt> <dd>

Предоставляет описатель для сведений, идентифицирующих команду жеста и значения аргумента, относящиеся к жесту. Эти сведения извлекаются путем вызова [**жетжестуреинфо**](/windows/desktop/api/winuser/nf-winuser-getgestureinfo).

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Если приложение обрабатывает это сообщение, оно должно возвращать значение 0.

Если приложение не обрабатывает сообщение, оно должно вызвать [дефвиндовпрок](/windows/win32/api/winuser/nf-winuser-defwindowproca). Это приведет к утечке памяти в приложении, поскольку дескриптор сенсорного ввода не будет закрыт, а связанная память процесса не будет освобождена.

## <a name="remarks"></a>Комментарии

В следующей таблице перечислены поддерживаемые команды жестов.



| Идентификатор жеста            | Значение (*ДВИД*) | Описание                                                                                                                                                                                                                                                                          |
|-----------------------|----------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **\_Начало GID**        | 1              | Указывает, что начинается универсальный жест.                                                                                                                                                                                                                                            |
| **\_конец GID**          | 2              | Указывает на завершение универсального жеста.                                                                                                                                                                                                                                                     |
| **\_масштаб GID**         | 3              | Указывает на начало и перемещение масштаба, а также на отмену масштабирования. Первое сообщение **команды \_ масштабирования GID** начинает масштаб, но не приводит к его уменьшению. Вторая команда **GID \_ Zoom** активирует масштаб относительно состояния, содержащегося в первом **\_ масштабе GID**.                                    |
| **\_сдвиг GID**          | 4              | Указывает на начало перемещения или сдвиг. Первая команда **" \_ сдвиг GID** " указывает на начало Pan, но не выполняет панорамирование. Во втором сообщении команды **GID \_ Pan** приложение начнет панорамирование.                                                                            |
| **\_поворот GID**       | 5              | Указывает поворот перемещения или начало. Первое сообщение-команда **\_ смены GID** указывает на перемещение или поворот начала, но не будет вращаться. Второе сообщение-команда **\_ смены GID** активирует операцию вращения относительно состояния, содержащегося в первом **\_ повернутом GID**. |
| **GID \_ твофинжертап** | 6              | Указывает жест касания двумя пальцами.                                                                                                                                                                                                                                                    |
| **GID \_ прессандтап**  | 7              | Указывает жест нажатия и касания.                                                                                                                                                                                                                                                 |



 

> [!Note]  
> Чтобы включить поддержку устаревшей версии, сообщения с командами **\_ конечного** жеста **\_ Begin** и GID должны быть перенаправлены с помощью [дефвиндовпрок](/windows/win32/api/winuser/nf-winuser-defwindowproca).

 

В следующей таблице указаны аргументы жеста, передаваемые в параметрах *lParam* и *wParam* .



| Идентификатор жеста            | жесты        | *улларгумент*                                                                                                                                                                                                                                                                                                                                                                                            | *птслокатион* в структуре [**GestureInfo**](/windows/desktop/api/winuser/nf-winuser-getgestureinfo)                                                  |
|-----------------------|----------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------|
| **\_масштаб GID**         | Увеличить/уменьшить    | Указывает расстояние между двумя точками.                                                                                                                                                                                                                                                                                                                                                           | Указывает центр масштабирования.                                                                                 |
| **\_сдвиг GID**          | Сдвиг            | Указывает расстояние между двумя точками.                                                                                                                                                                                                                                                                                                                                                           | Указывает текущее расположение панорамы.                                                                        |
| **\_поворот GID**       | Повернуть (сведение) | Указывает угол поворота, если установлен флаг **GF \_ Begin** . В противном случае это изменение угла с момента начала вращения. Это подписывается для обозначения направления вращения. Чтобы получить и задать значение угла, используйте угол [**\_ поворота GID \_ \_ от \_ ARGUMENT**](/windows/desktop/api/winuser/nf-winuser-gid_rotate_angle_from_argument) и [**GID \_ угла поворота в макросах \_ \_ \_ аргументов**](/windows/desktop/api/winuser/nf-winuser-gid_rotate_angle_to_argument) . | Указывает центр вращения, который является стационарной точкой, вокруг которой вращается целевой объект. |
| **GID \_ твофинжертап** | Касание с двумя пальцами | Указывает расстояние между двумя пальцами.                                                                                                                                                                                                                                                                                                                                                          | Указывает центр двух пальцев.                                                                          |
| **GID \_ прессандтап**  | Нажмите и коснитесь  | Указывает разницу между первым пальцем и вторым пальцем. Это значение хранится в младших 32 битах *улларгумент* в структуре **Point** .                                                                                                                                                                                                                                             | Указывает, на какой должности поступает первый палец.                                                       |



 

> [!Note]  
> Все расстояния и положения задаются в координатах физического экрана.

 

> [!Note]  
> Параметры *ДВИД* и *улларгумент* следует рассматривать как сопровождающие \_ \* команды GID и не должны изменяться приложениями.

 

## <a name="examples"></a>Примеры

В следующем коде показано, как получить сведения о жесте, связанные с этим сообщением.

> [!Note]  
> Следует всегда пересылать необработанные сообщения [дефвиндовпрок](/windows/win32/api/winuser/nf-winuser-defwindowproca) и закрывать входной маркер жеста для сообщений, обрабатываемых с помощью вызова [**клосежестуреинфохандле**](/windows/desktop/api/winuser/nf-winuser-closegestureinfohandle). В этом примере поведение обработчика жестов по умолчанию будет подавлено, так как дескриптор ТАУЧИНПУТ закрывается в каждом из вариантов жестов. Если вы удалили варианты в приведенном выше коде для необработанных сообщений, обработчик жестов по умолчанию будет обрабатывать сообщения, пересылаемые в [дефвиндовпрок](/windows/win32/api/winuser/nf-winuser-defwindowproca) в случае по умолчанию.

 


```C++
  LRESULT DecodeGesture(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam){
    // Create a structure to populate and retrieve the extra message info.
    GESTUREINFO gi;  
    
    ZeroMemory(&gi, sizeof(GESTUREINFO));
    
    gi.cbSize = sizeof(GESTUREINFO);

    BOOL bResult  = GetGestureInfo((HGESTUREINFO)lParam, &gi);
    BOOL bHandled = FALSE;

    if (bResult){
        // now interpret the gesture
        switch (gi.dwID){
           case GID_ZOOM:
               // Code for zooming goes here     
               bHandled = TRUE;
               break;
           case GID_PAN:
               // Code for panning goes here
               bHandled = TRUE;
               break;
           case GID_ROTATE:
               // Code for rotation goes here
               bHandled = TRUE;
               break;
           case GID_TWOFINGERTAP:
               // Code for two-finger tap goes here
               bHandled = TRUE;
               break;
           case GID_PRESSANDTAP:
               // Code for roll over goes here
               bHandled = TRUE;
               break;
           default:
               // A gesture was not recognized
               break;
        }
    }else{
        DWORD dwErr = GetLastError();
        if (dwErr > 0){
            //MessageBoxW(hWnd, L"Error!", L"Could not retrieve a GESTUREINFO structure.", MB_OK);
        }
    }
    if (bHandled){
        return 0;
    }else{
        return DefWindowProc(hWnd, message, wParam, lParam);
    }
  }
```



## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|----------------------------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | \[Только классические приложения Windows 7\]<br/>                                                               |
| Минимальная версия сервера<br/> | Только классические приложения Windows Server 2008 R2 \[\]<br/>                                                  |
| Header<br/>                   | <dl> <dt>Winuser. h (включение Windows. h)</dt> </dl> |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[Уведомления](notifications.md)
</dt> <dt>

[Инструкции по программированию жестов сенсорного ввода Windows](guide-multi-touch-gestures.md)
</dt> </dl>

 

