---
title: Основные сведения об архитектуре
description: этот обзор архитектуры предоставляет контекст для API Windows touch для технологий планшета и сенсорного ввода и объясняет, как он соответствует более крупной архитектуре Windows 7.
ms.assetid: b284e96f-0998-408c-ae84-92a3acdc3014
keywords:
- Windows Обзор архитектуры Touch
- Windows Сенсорный ввод, манипуляции
- Windows Касание, сообщения
- Windows Сенсорный ввод, инерция
- Windows Касание, жесты
- жесты, сведения
- манипуляции, о
- инерция, сведения
- процессор манипуляции, обзор архитектуры
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 36b5ce003c88a66e96072fa9f96bc6ae73bd91cb39f53e03ab3748dd14a194d1
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119448672"
---
# <a name="architectural-overview"></a>Основные сведения об архитектуре

этот обзор архитектуры предоставляет контекст для API Windows touch для технологий планшета и сенсорного ввода и объясняет, как он соответствует более крупной архитектуре Windows 7.

## <a name="messages-for-windows-touch-input-and-gestures"></a>сообщения для Windows сенсорный ввод и жесты

функции обмена сообщениями для Windows Touch включены путем прослушивания и интерпретации сообщений во время выполнения. на следующем рисунке показано, как сообщения формируются из оборудования и отправляются в приложения с Windows 7.

![Иллюстрация, показывающая, как Windows 7 отправляет сообщения от оборудования Мультисенсорная в приложение](images/wm-multitouch-messaging.png)

В крайнем левом столбце иллюстрации сенсорно-чувствительное оборудование получает входные данные от пользователя. Затем драйвер взаимодействует между оборудованием и операционной системой. Затем ОС создает сообщение [**\_ жеста**](wm-gesture.md) [**WM \_ Touch**](wm-touchdown.md) или WM, которое затем отправляется в HWND приложения. Затем приложение обновляет пользовательский интерфейс, учитывая сведения, инкапсулированные в сообщении.

По умолчанию приложения получают жесты. если приложение не регистрируется для Windows сенсорный ввод сообщений с помощью функции [**регистертаучвиндов**](/windows/desktop/api/winuser/nf-winuser-registertouchwindow) , уведомления для жестов ([**сообщения \_ жестов WM**](wm-gesture.md) ) создаются Windows и отправляются в это окно приложения. если окно приложения регистрируется для получения сенсорных сообщений, уведомления для Windows сенсорного ввода (сообщения [**WM \_ touch**](wm-touchdown.md) ) отправляются в это окно приложения. Windows Сообщения касания и жесты являются жадными в том смысле, что после совершения касания или начала работы над окном приложения все сообщения отправляются в это приложение до тех пор, пока жест не завершится или не будет выполнено основное касание.

для поддержки прежних версий Windows интерпретирует [**сообщения \_ жестов WM**](wm-gesture.md) , если они передаются вверх, а затем отправляют или разписывают соответствующие сообщения, сопоставленные с этим жестом. Чтобы избежать нарушения поддержки устаревшей версии, убедитесь, что вы пересылаете \_ сообщения ЖЕСТОВ WM с помощью [дефвиндовпрок](/windows/win32/api/winuser/nf-winuser-defwindowproca). дополнительные сведения о поддержке устаревших версий можно найти в разделе [общие сведения о Windows сенсорных жестов](windows-touch-gestures-overview.md).

## <a name="manipulations-and-inertia"></a>Манипуляции и инерция

Windows Сенсорные программисты должны уметь интерпретировать жесты из нескольких источников способом, который имеет смысл для жеста. Корпорация Майкрософт предоставляет API манипуляции для выполнения этих вычислений. Манипуляции — это фактические жесты со связанными с ними значениями, описывающими весь жест. После подключения входных данных к обработчику манипуляции можно получить сведения, относящиеся к действиям, которые пользователь делает с объектом. На следующем рисунке показан один из способов использования манипуляций.

![Иллюстрация, показывающая сообщения Windows Touch, переданные обработчику манипуляции объекта, который обрабатывает события с помощью \- интерфейса иманипулатионевентс](images/manipulation-arch.png)

В верхнем левом углу экрана пользователь затронул экран, который создает сенсорные сообщения. Эти сообщения содержат координаты x и y-координаты, используемые для определения объекта, наданного фокус. Объект в фокусе содержит обработчик манипуляции. Затем в сообщении [**WM \_ Touch**](wm-touchdown.md) с флагом **таучевентф \_ up** выбирается объект в фокусе пользователя, выполняется ссылка на обработчик манипуляций, а сообщение отправляется обработчику манипуляции. Последующие сообщения **WM \_ Touch** , связанные с этим контактом, отправляются в обработчик манипуляции до тех пор, пока не будет получено сообщение **WM \_ Touch** с флагом **таучевентф \_ up** , а выбранный объект не является разыменованным. В нижней правой части иллюстрации показан приемник событий манипуляции, реализующий интерфейс [**\_ иманипулатионевентс**](/windows/win32/api/manipulations/nn-manipulations-_imanipulationevents) , для обработки событий манипуляции, которые вызываются во время создания сенсорных сообщений. Приемник событий может выполнять обновления интерфейса на основе событий манипуляции во время их возникновения.

в Windows Touch applications часто приходится внедрять простую физику, чтобы объекты плавно приступили к прекращению, а не внезапно останавливаться, когда они больше не затрагиваются. Корпорация Майкрософт предоставляет API инерции для выполнения вычислений для этой простой физикы, что позволяет приложению работать так же, как и другие приложения. Это также экономит усилия, необходимые для создания надежных физических функций. На следующем рисунке показано, как можно использовать инерцию.

![Иллюстрация, демонстрирующая передачу сообщений Windows Touch в интерфейс IInertiaProcessor объекта, который вызывает события с помощью \- интерфейса иманипулатионевентс](images/inertia-arch.png)

Обратите внимание на сходства между инерцией и манипуляцией. Единственное различие между ними заключается в том, что в случае инерции интерпретируемые сообщения передаются в Процессор инерции, а не в обработчик манипуляции, и обработчик инерции создает события. В верхнем левом углу экрана в сообщении [**WM \_ Touch**](wm-touchdown.md) с флагом **таучевентф \_ up** сообщения Touch используются для обозначения объекта в фокусе, который содержит процессор инерции и обработчик манипуляции. Последующие сообщения **WM \_ Touch** отправляются в обработчик манипуляций, а обработчик манипуляции ВЫПОЛНЯЕТ обновления пользовательского интерфейса приложения. После завершения манипуляции значения скорости из манипуляции используются для настройки процессора инерции. Как показано в среднем столбце, метод [**Process**](/windows/desktop/api/manipulations/nf-manipulations-iinertiaprocessor-process) или [**процесстиме**](/windows/desktop/api/manipulations/nf-manipulations-iinertiaprocessor-processtime) вызывается в интерфейсе [**IInertiaProcessor**](/windows/desktop/api/manipulations/nn-manipulations-iinertiaprocessor) с помощью таймера или другого цикла в отдельном потоке, пока вызовы не указывают, что процессор завершает обработку. Хотя эти вызовы выполняются, создаются события манипуляции, которые обрабатываются приемником событий манипуляции на основе интерфейса [**\_ иманипулатионевентс**](/windows/win32/api/manipulations/nn-manipulations-_imanipulationevents) . В нижней правой части иллюстрации этот приемник событий выполняет обновления пользовательского интерфейса приложения на основе событий манипуляции, когда они происходят через обработчики событий в приемнике событий.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Руководство по программированию](programming-guide.md)
</dt> </dl>

 

 