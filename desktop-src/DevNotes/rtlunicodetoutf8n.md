---
description: Преобразует указанную строку Юникода в новую символьную строку, используя 8-разрядную кодовую страницу формата преобразования Юникода (UTF-8).
ms.assetid: ecd63eee-bf86-42b5-93d8-3c7871aa6324
title: Функция RtlUnicodeToUTF8N (WDM. h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- RtlUnicodeToUTF8N
api_type:
- DllExport
api_location:
- Ntdll.dll
ms.openlocfilehash: 46153dd152ed5a45a65de50ca214fbb24a6dc2ac
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104141251"
---
# <a name="rtlunicodetoutf8n-function"></a>Функция RtlUnicodeToUTF8N

Преобразует указанную строку Юникода в новую символьную строку, используя 8-разрядную кодовую страницу формата преобразования Юникода (UTF-8).

## <a name="syntax"></a>Синтаксис


```C++
NTSTATUS WINAPI RtlUnicodeToUTF8N(
  _Out_     PCHAR  UTF8StringDestination,
  _In_      ULONG  UTF8StringMaxByteCount,
  _Out_opt_ PULONG UTF8StringActualByteCount,
  _In_      PCWSTR UnicodeStringSource,
  _In_      ULONG  UnicodeStringByteCount
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*UTF8StringDestination* \[ заполняет\]
</dt> <dd>

Указатель на выделенный вызывающим объектом буфер для получения переведенной строки.

</dd> <dt>

*UTF8StringMaxByteCount* \[ окне\]
</dt> <dd>

Максимальное число байтов, записываемых в *UTF8StringDestination*. Если это значение приводит к усечению переведенной строки, **RtlUnicodeToUTF8N** возвращает состояние ошибки.

</dd> <dt>

*UTF8StringActualByteCount* \[ out, необязательно\]
</dt> <dd>

Указатель на переменную, выделенную вызывающим объектом, которая получает длину переведенной строки в байтах. Этот параметр является необязательным и может иметь **значение NULL**. Если строка усекается, возвращаемое число подсчитывает фактическое число усеченных строк.

</dd> <dt>

*Уникодестрингсаурце* \[ окне\]
</dt> <dd>

Указатель на строку источника Юникода для перевода.

</dd> <dt>

* Уникодестрингбитекаунт * \[ в\]
</dt> <dd>

Указывает число байтов в исходной строке Юникода, на которое указывает параметр *уникодестрингсаурце* .

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

**RtlUnicodeToUTF8N** возвращает одно из следующих значений NTSTATUS:



| Код возврата                                                                                                  | Описание                                                                                                     |
|--------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------|
| <dl> <dt>**СОСТОЯНИЕ " \_ успешно"**</dt> </dl>               | Строка Юникода была преобразована в UTF-8.<br/>                                                           |
| <dl> <dt>**СОСТОЯНИЕ \_ \_ \_ несопоставленных**</dt> </dl>     | Обнаружен и заменен Недопустимый входной символ. Это состояние считается состоянием успеха.<br/> |
| <dl> <dt>**\_Недопустимый \_ параметр Status**</dt> </dl>    | Оба указателя на *UTF8StringDestination* и *UTF8StringActualByteCount* имеют **значение NULL**.<br/>              |
| <dl> <dt>**СОСТОЯНИЕ " \_ Недопустимый \_ параметр \_ 4"**</dt> </dl> | *Уникодестрингсаурце* имеет **значение NULL**.<br/>                                                              |
| <dl> <dt>**\_БУФЕР состояния \_ слишком \_ мал**</dt> </dl>    | *UTF8StringDestination* был усечен.<br/>                                                               |



 

## <a name="remarks"></a>Комментарии

Хотя *UTF8StringActualByteCount* является необязательным и может иметь **значение NULL**, вызывающие объекты должны предоставлять для него хранилище, так как полученная длина может использоваться для определения успешности преобразования. Эта подпрограммы не изменяет исходную строку. Он возвращает строку в кодировке UTF-8, завершающуюся нулем, если заданный *уникодестрингсаурце* включает завершающий нуль, а если заданный *UTF8StringMaxByteCount* не вызвал усечение.

Если выходные данные усекаются и обнаружен недопустимый входной символ, функция возвращает буфер состояния, что \_ \_ Ошибка слишком \_ мала.

Если *UTF8StringDestination* имеет значение **null** , функция возвратит требуемое число байтов для размещения переведенной строки без усечения в *UTF8StringActualByteCount*.

Вызывающие объекты **RtlUnicodeToUTF8N** должны выполняться на уровне подготовки к уровню IRQL < \_ .

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|--------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | \[Только классические приложения Windows 7\]<br/>                                           |
| Минимальная версия сервера<br/> | Только классические приложения Windows Server 2008 R2 \[\]<br/>                              |
| Header<br/>                   | <dl> <dt>WDM. h</dt> </dl>     |
| DLL<br/>                      | <dl> <dt>Ntdll.dll</dt> </dl> |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**RtlUTF8ToUnicodeN**](rtlutf8tounicoden.md)
</dt> </dl>

 

 




