---
description: Создает указанный раздел реестра в автономном кусте реестра. Если ключ уже существует, функция открывает его.
ms.assetid: 40e7468d-e781-4945-9023-580c06088b87
title: Функция Оркреатекэй (Оффрег. h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- ORCreateKey
api_type:
- DllExport
api_location:
- Offreg.dll
ms.openlocfilehash: b7ea5a365a9c5bdcb478ce47443a713ed5bc091666b54de880dc478708e4c36c
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119749694"
---
# <a name="orcreatekey-function"></a>Функция Оркреатекэй

Создает указанный раздел реестра в автономном кусте реестра. Если ключ уже существует, функция открывает его.

## <a name="syntax"></a>Синтаксис


```C++
DWORD ORCreateKey(
  _In_      ORHKEY               Handle,
  _In_      PCWSTR               lpSubKey,
  _In_opt_  PWSTR                lpClass,
  _In_opt_  DWORD                dwOptions,
  _In_opt_  PSECURITY_DESCRIPTOR pSecurityDescriptor,
  _Out_     PORHKEY              phkResult,
  _Out_opt_ PDWORD               pdwDisposition
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*Обработчик* \[ окне\]
</dt> <dd>

Маркер открытого раздела реестра в автономном кусте реестра.

</dd> <dt>

*лпсубкэй* \[ окне\]
</dt> <dd>

Указатель на строку в Юникоде, содержащую имя подраздела, который открывается или создается этой функцией. Параметр *лпсубкэй* должен задавать подраздел ключа, определяемого параметром *Handle* . Он может иметь глубину до 32 уровней в дереве реестра. Дополнительные сведения о именах ключей см. [в разделе Структура реестра](../sysinfo/structure-of-the-registry.md).

Этот параметр не может иметь **значение NULL**.

Имена ключей не чувствительны к регистру.

</dd> <dt>

*лпкласс* \[ в необязательное\]
</dt> <dd>

Класс (тип объекта) этого ключа. Этот параметр можно игнорировать. Этот параметр может принимать значение **NULL**.

</dd> <dt>

*двоптионс* \[ в необязательное\]
</dt> <dd>

Этот параметр может иметь значение 0 или одно из следующих значений.



| Значение                                                                                                                                                                                                                                                          | Значение                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="REG_OPTION_CREATE_LINK"></span><span id="reg_option_create_link"></span><dl> <dt>**Reg \_ ПАРАМЕТР \_ Create \_ Link**</dt> <dt>0x00000002L</dt> </dl>    | Ключ является символьной ссылкой. Целевой путь назначается значению L "Симболиклинквалуе" ключа. Целевой путь должен быть абсолютным путем к реестру. Если этот параметр задан, также должен быть установлен **\_ параметр REG \_ без \_ постоянного режима** . <br/> Если параметр *лпсубкэй* указывает существующий ключ, он должен быть создан с помощью **\_ команды реестра \_ Create \_ Link**.<br/> Символьные ссылки реестра следует использовать только в том случае, если это совершенно необходимо для совместимости приложений. <br/> |
| <span id="REG_OPTION_NON_VOLATILE"></span><span id="reg_option_non_volatile"></span><dl> <dt>**Reg \_ \_ \_ Неизменяемый параметр "**</dt> <dt>0x00000000</dt> " </dl> | Ключ не является временным; Это значение по умолчанию. Информация хранится в файле и сохраняется при перезапуске системы. Функция [**орсавехиве**](orsavehive.md) сохраняет ключи, которые не являются временными.<br/>                                                                                                                                                                                                                                                                   |



 

</dd> <dt>

*псекуритидескриптор* \[ в необязательное\]
</dt> <dd>

Указатель на структуру [ \_ дескриптора безопасности](/windows/win32/api/winnt/ns-winnt-security_descriptor) , содержащую дескриптор безопасности для нового ключа. Если *псекуритидескриптор* имеет **значение NULL**, ключ получает дескриптор безопасности по умолчанию. Списки управления доступом в дескрипторе безопасности по умолчанию для ключа наследуются от его прямого родительского ключа.

</dd> <dt>

*фкресулт* \[ заполняет\]
</dt> <dd>

Указатель на переменную, которая получает маркер для открытого или созданного ключа. Используйте функцию [**орклосекэй**](orclosekey.md) , чтобы закрыть ключ после завершения использования маркера.

</dd> <dt>

*пдвдиспоситион* \[ out, необязательно\]
</dt> <dd>

Указатель на переменную, которая получает одно из следующих значений метода обработки.



| Значение                                                                                                                                                                                                                                                          | Значение                                                                 |
|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------|
| <span id="REG_CREATED_NEW_KEY"></span><span id="reg_created_new_key"></span><dl> <dt>**Reg \_ СОЗДАН \_ новый \_ ключ**</dt> <dt>0x00000001</dt> </dl>             | Ключ не существовал и был создан.<br/>                       |
| <span id="REG_OPENED_EXISTING_KEY"></span><span id="reg_opened_existing_key"></span><dl> <dt>**Reg \_ ОТКРЫТ \_ существующий \_ ключ**</dt> <dt>0x00000002L</dt> </dl> | Ключ существовал и был просто открыт без изменения.<br/> |



 

Если *пдвдиспоситион* имеет **значение NULL**, сведения о расположении не возвращаются.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Если функция завершается успешно, возвращается значение ошибки \_ Success.

Если функция завершается ошибкой, возвращаемое значение является ненулевым кодом ошибки, определенным в файле Winerror. h. [](/windows/win32/api/winbase/nf-winbase-formatmessage) \_ \_ \_ Для получения обобщенного описания ошибки можно использовать функцию FormatMessage с флагом формата Message от System.

Если параметр *двоптионс* установлен с параметром **реестра \_ \_ Create \_ Link** , но **\_ параметр REG \_ volatile имеет \_ неизменяемое** значение, или если возвращаемый маркер является обработчиком корневого ключа Hive, функция возвращает ошибку \_ Недопустимый \_ параметр.

## <a name="remarks"></a>Remarks

Ключ, создаваемый функцией **оркреатекэй** , не имеет значений. Приложение может использовать функцию [**орсетвалуе**](orsetvalue.md) для установки значений ключей.

Функцию **оркреатекэй** нельзя использовать для создания корневого ключа в кусте реестра вне сети. Используйте функцию [**оркреатехиве**](orcreatehive.md) для создания корневого ключа и получения маркера для ключа.

Автономный реестр не поддерживает сохранение отдельных ключей. Используйте функцию [**орсавехиве**](orsavehive.md) для сохранения ключа и его подразделов в кусте Hive.

## <a name="requirements"></a>Requirements (Требования)



| Требование | Значение |
|----------------------------|---------------------------------------------------------------------------------------|
| Распространяемые компоненты<br/> | Windows Библиотека автономных разделов реестра версии 1,0 или более поздней<br/>                      |
| Заголовок<br/>          | <dl> <dt>Оффрег. h</dt> </dl>   |
| DLL<br/>             | <dl> <dt>Offreg.dll</dt> </dl> |



## <a name="see-also"></a>См. также

<dl> <dt>

[**орклосекэй**](orclosekey.md)
</dt> <dt>

[**оркреатехиве**](orcreatehive.md)
</dt> <dt>

[**орделетекэй**](ordeletekey.md)
</dt> <dt>

[**орсавехиве**](orsavehive.md)
</dt> <dt>

[\_дескриптор безопасности](/windows/win32/api/winnt/ns-winnt-security_descriptor)
</dt> </dl>

 

 
