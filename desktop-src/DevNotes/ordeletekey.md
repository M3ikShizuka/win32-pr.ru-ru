---
description: Удаляет подраздел и его значения из автономного куста реестра.
ms.assetid: 651795d3-4328-4281-9a7f-ba75b4ec4da1
title: Функция Орделетекэй (Оффрег. h)
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- ORDeleteKey
api_type:
- DllExport
api_location:
- Offreg.dll
ms.openlocfilehash: 9f3be934eca97d88f4dfeb1b1576d9fcd06f5681351a2e85d8ae7f6ba31e8860
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119571934"
---
# <a name="ordeletekey-function"></a>Функция Орделетекэй

Удаляет подраздел и его значения из автономного куста реестра.

## <a name="syntax"></a>Синтаксис


```C++
DWORD ORDeleteKey(
  _In_     ORHKEY Handle,
  _In_opt_ PCWSTR lpSubKey
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*Обработчик* \[ окне\]
</dt> <dd>

Маркер открытого раздела реестра в автономном кусте реестра. Этот маркер возвращается функцией [**оркреатекэй**](orcreatekey.md) или [**оропенкэй**](oropenkey.md) .

</dd> <dt>

*лпсубкэй* \[ в необязательное\]
</dt> <dd>

Имя удаляемого ключа. Он должен быть подразделом ключа, который *обрабатывает* определение, но не может иметь подразделы.

Если подраздел не существует, функция возвращает ошибку \_ не \_ найдено.

Если этот параметр имеет **значение NULL**, функция удаляет ключ, заданный параметром *Handle* . Если ключ, заданный параметром *Handle* , является корневым ключом Hive, функция возвращает ошибку " \_ Недопустимый \_ параметр".

Имена ключей не чувствительны к регистру.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Если функция завершается успешно, возвращается значение ошибки \_ Success.

Если функция завершается ошибкой, возвращаемое значение является ненулевым кодом ошибки, определенным в файле Winerror. h. [](/windows/win32/api/winbase/nf-winbase-formatmessage) \_ \_ \_ Для получения обобщенного описания ошибки можно использовать функцию FormatMessage с флагом формата Message от System. Ниже перечислены возможные коды ошибок.

-   Если указанный подраздел не существует, функция возвращает \_ файл ошибки \_ не \_ найден.
-   Если указанный подраздел является корневым ключом куста реестра, функция возвращает ошибку " \_ Недопустимый \_ параметр".
-   Если в указанном подразделе есть подразделы, функция возвращает \_ ключ ошибки \_ с \_ дочерними элементами.

## <a name="remarks"></a>Remarks

Если указанный раздел реестра существует, он помечается как удаленный. Удаленный ключ не удаляется до тех пор, пока последний его маркер не будет закрыт.

Удаляемый ключ не должен иметь подразделов. Чтобы удалить ключ и все его подразделы, используйте функцию [**оренумкэй**](orenumkey.md) , чтобы перечислить подразделы и удалить их по отдельности.

Для удаленного ключа может быть вызвана только функция [**орклосекэй**](orclosekey.md) ; все остальные операции в автономном реестре завершаются ошибкой. Если удаленный ключ был явно создан путем вызова [**оркреатекэй**](orcreatekey.md), ресурсы, связанные с этим ключом, освобождаются при закрытии последнего маркера удаленного ключа.

## <a name="requirements"></a>Требования



| Требование | Значение |
|----------------------------|---------------------------------------------------------------------------------------|
| Распространяемые компоненты<br/> | Windows Библиотека автономных разделов реестра версии 1,0 или более поздней<br/>                      |
| Заголовок<br/>          | <dl> <dt>Оффрег. h</dt> </dl>   |
| DLL<br/>             | <dl> <dt>Offreg.dll</dt> </dl> |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**орклосекэй**](orclosekey.md)
</dt> <dt>

[**оркреатекэй**](orcreatekey.md)
</dt> <dt>

[**оренумкэй**](orenumkey.md)
</dt> <dt>

[**оропенкэй**](oropenkey.md)
</dt> </dl>

 

 
