---
description: Представляет заголовок в виде многосекционной области.
ms.assetid: 0fad0e93-b940-4b52-be16-c5f177884dfb
title: Структура MULTI_SECTOR_HEADER
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- MULTI_SECTOR_HEADER
api_type:
- NA
api_location: ''
ms.openlocfilehash: ab21e17b83ae25286d2775d9dbd97dfd4cf493bc
ms.sourcegitcommit: c7add10d695482e1ceb72d62b8a4ebd84ea050f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "103807061"
---
# <a name="multi_sector_header-structure"></a>\_Структура заголовка с несколькими секторами \_

\[Эта структура допустима только для томов NTFS версии 3; Он может быть изменен в будущих версиях.\]

Представляет заголовок в виде многосекционной области.

## <a name="syntax"></a>Синтаксис


```C++
typedef struct _MULTI_SECTOR_HEADER {
  UCHAR  Signature[4];
  USHORT UpdateSequenceArrayOffset;
  USHORT UpdateSequenceArraySize;
} MULTI_SECTOR_HEADER, *PMULTI_SECTOR_HEADER;
```



## <a name="members"></a>Члены

<dl> <dt>

**Образец**
</dt> <dd>

Сигнатура. Это значение является удобным для пользователя.

</dd> <dt>

**упдатесекуенцеаррайоффсет**
</dt> <dd>

Смещение массива последовательностей обновления от начала этой структуры. Массив последовательности обновления должен заканчиваться до последнего значения USHORT в первом секторе.

</dd> <dt>

**упдатесекуенцеаррайсизе**
</dt> <dd>

Размер массива последовательностей обновления в байтах.

</dd> </dl>

## <a name="remarks"></a>Комментарии

Обратите внимание, что для этой структуры нет связанного файла заголовка.

Это определение структуры допустимо только для основной версии 3 и дополнительной версии 0 или 1, как сообщается [**фсктл \_ Получение \_ \_ \_ данных тома NTFS**](/windows/win32/api/winioctl/ni-winioctl-fsctl_get_ntfs_volume_data).

Многосекторный заголовок и массив последовательностей обновления обеспечивают обнаружение неполных передач на нескольких секторах для устройств, размер физического сектора которых больше или равен индексу Stride (512) или не переносит секторы в неупорядоченном виде. Если существует устройство, размер сектора которого меньше, чем шаг порядкового номера, и иногда передает секторы вне последовательности, то массив последовательности обновления не будет обеспечивать абсолютное обнаружение незавершенных передач. Порядковый номер имеет небольшое количество, чтобы обеспечить абсолютную защиту для всех известных жестких дисков. Это значение не меньше или может быть чрезмерным временем выполнения или небольшими затратами времени.

Массив последовательностей обновления состоит из массива значений *n* **UShort** , где *n* — размер защищаемой структуры, разделенной порядковым номером STRIDE. Первое слово содержит порядковый номер обновления, который является циклическим счетчиком количества операций, содержащихся в структуре, записанной на диск. Далее представлены *n* сохраненных значений **UShort** , которые были перезаписаны порядковым номером обновления во время последнего занесения содержащей его структуры на диск.

Каждый раз, когда защищенная структура собирается записываться на диск, Последнее слово в каждом порядковом номере STRIDE сохраняется в соответствующую ему точку в массиве порядковых номеров, а затем перезаписывается следующим порядковым номером обновления. После записи или при считывании структуры сохраненное слово из массива порядковых номеров восстанавливается до фактической его расположения в структуре. Перед восстановлением сохраненных слов при чтении все порядковые номера в конце каждого шага сравниваются с фактическим порядковым номером в начале массива. Если какое-либо из этих сравнений не равно, обнаружено неудачное Многосекторное перемещение.

Размер массива определяется размером содержащей его структуры. Массив последовательностей обновления должен быть включен в конец заголовка структуры, с которой он защищается из-за его размера переменной. Пользователь должен убедиться, что для содержащей структуры зарезервировано правильное место: (размер структуры/512 + 1) \* sizeof (UShort).

## <a name="see-also"></a>См. также раздел

<dl> <dt>

[Основная таблица файлов](master-file-table.md)
</dt> </dl>

 

 
