---
title: Ведение журнала W3C
description: Расширенное ведение журнала W3C — это тип ведения журнала на стороне сервера, который может быть включен в сеансе сервера или группе URL-адресов.
ms.assetid: a08b8f9e-2247-43c6-b253-81f72001d8d2
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b253daebae22a2b99e152451cff360c7b633ca64
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "103789774"
---
# <a name="w3c-logging"></a>Ведение журнала W3C

Расширенное ведение журнала W3C — это тип ведения журнала на стороне сервера, который может быть включен в сеансе сервера или группе URL-адресов. Если ведение журнала W3C включено в группе URL-адресов, ведение журнала выполняется только для запросов, направляемых в группу URL-адресов. Для каждой группы URL-адресов, настроенной для включения ведения журнала W3C, создается отдельный файл журнала.

Если ведение журнала W3C включено в сеансе сервера, оно работает как централизованная форма ведения журнала для всех групп URL-адресов в сеансе сервера. Для всех групп URL-адресов в сеансе сервера поддерживается один файл журнала.

В следующей таблице перечислены поля, которые могут регистрироваться с помощью API-интерфейса сервера HTTP. Таблица содержит подмножество констант [**\_ \_ поля журнала HTTP**](http-log-field--constants.md) . Некоторые из перечисленных ниже полей автоматически создаются API HTTP-сервера внутренним образом и не содержатся в структуре [**\_ \_ \_ данных полей журнала HTTP**](/windows/desktop/api/Http/ns-http-http_log_fields_data) . Столбец «выглядит как» содержит текст, который отображается в файле журнала. Данные в таблице находятся в порядке возникновения в записи файла журнала.

Поля, не помеченные как "HTTP-интерфейс API сервера", должны передаваться внутри структуры [**\_ \_ \_ данных полей журнала HTTP**](/windows/desktop/api/Http/ns-http-http_log_fields_data) приложением. Приложение может создать эти поля из переданной структуры [**HTTP- \_ запроса**](/previous-versions/windows/desktop/legacy/aa364545(v=vs.85)) .



| Поле                            | Отображается как      | Описание                                                                                                                                | \_ \_ Элемент данных полей журнала HTTP \_ | \_ \_ Константы для полей журнала HTTP      |
|----------------------------------|-----------------|--------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|----------------------------------|
| Дата                             | дата            | Дата, когда произошло действие.                                                                                                   | API HTTP-сервера создан.     | \_ \_ Дата поля журнала \_ http           |
| Время                             | time            | Время, в течение которого произошло действие, в формате UTC.                                                             | API HTTP-сервера создан.     | \_время для \_ поля \_ журнала HTTP           |
| Имя службы и номер экземпляра | s-sitename      | Имя службы Интернета и номер экземпляра, запущенные на клиенте.                                                              | ServiceName                    | \_ \_ имя сайта для поля журнала \_ HTTP \_     |
| Server Name (Имя сервера)                      | s-ComputerName  | Имя сервера, на котором была создана запись файла журнала.                                                                          | ServerName                     | \_ \_ имя компьютера для поля журнала \_ HTTP \_ |
| IP-адрес сервера                | s — IP-адрес            | IP-адрес сервера, на котором была создана запись файла журнала.                                                                    | ServerIp                       | \_ \_ \_ \_ IP-адрес сервера для поля журнала HTTP     |
| Метод                           | CS-Method       | Запрашиваемая команда, например метод GET.                                                                                             | Метод                         | \_ \_ метод поля журнала \_ http         |
| Ресурс URI                         | CS-URI — ресурс     | Целевой объект команды, например Default.htm.                                                                                          | UriStem                        | \_ресурс- \_ \_ URI поля журнала HTTP \_      |
| Запрос URI                        | CS-URI-запрос    | Запрос, если таковой имеется, который клиент пытался выполнить. Запрос универсального кода ресурса (URI) требуется только для динамических страниц. | UriQuery                       | \_ \_ запрос URI для поля журнала \_ HTTP \_     |
| Порт сервера                      | s-Port          | Номер порта сервера, настроенного для службы.                                                                                 | ServerPort                     | \_ \_ \_ порт сервера полей журнала \_ http   |
| Имя пользователя                        | CS-username     | Имя пользователя, прошедшего проверку подлинности, который получил доступ к серверу. Анонимные пользователи обозначаются дефисом.                                    | Имя пользователя                       | \_ \_ имя пользователя для поля журнала \_ HTTP \_     |
| IP-адрес клиента                | c-ip            | IP-адрес отправившего запрос клиента.                                                                                        | ClientIp                       | \_ \_ \_ \_ IP-адрес клиента для поля журнала HTTP     |
| Версия протокола                 | CS-Version      | Версия протокола HTTP, используемая клиентом.                                                                                            | API HTTP-сервера создан.     | \_ \_ версия поля журнала \_ http        |
| Агент пользователя                       | CS (User-Agent)  | Тип браузера, используемый клиентом.                                                                                                     | UserAgent                      | \_ \_ Агент пользователя для поля журнала \_ HTTP \_    |
| Куки-файл                           | CS (файл cookie)      | Содержимое отправленного или полученного файла cookie, если таковое имеется.                                                                                        | Куки-файл                         | \_ \_ файл cookie поля журнала HTTP \_         |
| Referrer                         | CS (Источник ссылки)    | Сайт, который последний раз посещал пользователь. Этот сайт предоставил ссылку на текущий сайт.                                                        | Referrer                       | \_ \_ Источник ссылки для поля журнала HTTP \_       |
| Узел                             | CS-Host         | Имя заголовка узла, если оно есть.                                                                                                              | Узел                           | \_ \_ узел поля журнала \_ http           |
| Состояние HTTP                      | SC — состояние       | Код состояния HTTP.                                                                                                                      | ProtocolStatus                 | \_ \_ состояние поля журнала \_ http         |
| Подсостояние протокола               | SC — подсостояние    | Код ошибки подсостояния.                                                                                                                  | SubStatus                      | \_подсостояние \_ поля \_ журнала \_ http    |
| Состояние Win32                     | SC-Win32-Status | Код состояния Windows.                                                                                                                   | Win32Status                    | \_Поле журнала \_ HTTP \_ \_ состояние Win32  |
| Отправлено байт                       | SC — байты        | Число байт, отправленных сервером.                                                                                                    | API HTTP-сервера создан.     | \_ \_ \_ Отправлено байт для поля журнала \_ http    |
| Получено байт                   | CS-байт        | Число байтов, полученных и обработанных сервером.                                                                                  | API HTTP-сервера создан.     | \_байтов для \_ поля журнала HTTP \_ \_ recv    |
| Затраченное время                       | время съемки      | Количество времени, затраченное на выполнение действия (в миллисекундах).                                                                                  | API HTTP-сервера создан.     | \_ \_ \_ затраченное время для поля журнала \_ http    |
| Идентификатор потока                      | streamid          | Идентификатор потока.                                                                                  | API HTTP-сервера создан.     | \_ \_ \_ идентификатор потока полей журнала \_ http       |



 

Файл журнала — это настраиваемый текстовый формат ASCII. Префиксы полей в файле определяются следующим образом.

|     |                           |
|-----|---------------------------|
| s   | Действия сервера.           |
| c   | Действия клиента.           |
| SC  | Действия "сервер-клиент". |
| cs  | Действия "клиент-сервер". |



 

Приложение может выбрать один или несколько полей расширенного файла журнала W3C, однако не все поля будут содержать сведения. Для выбранных полей, для которых нет сведений, в качестве заполнителя отображается дефис (-). Если поле содержит непечатный символ, API сервера HTTP заменяет его знаком «плюс» (+) для сохранения формата файла журнала. Обычно это происходит при атаках с вирусами, например, когда злоумышленник отправляет символы возврата каретки и перевода строки, которые, если они не заменяются знаком плюс (+), приведут к нарушению формата файла журнала. Поля разделяются пробелами.

Если поле включено в группе URL-адресов или сеансе сервера, но не выбрано для запроса, он появится в файле журнала с дефисом (-) в качестве заполнителя.

Файлы журнала создаются при поступлении первого запроса в группу URL-адресов или сеанс сервера, при настройке ведения журнала они не создаются. В следующем примере показана первая запись файла журнала W3C с IP-адресом клиента, именем пользователя, IP-адресом сервера, портом сервера, методом, ресурсом URI, запросом URI, состоянием и агентом пользователя.

``` syntax
#Software: Microsoft HTTP Server API 2.0  
#Version: 1.0   // the log file version as it's described by "https://www.w3.org/TR/WD-logfile".
#Date: 2002-05-02 17:42:15  // when the first log file entry was recorded, which is when the entire log file was created.
#Fields: date time c-ip cs-username s-ip s-port cs-method cs-uri-stem cs-uri-query sc-status cs(User-Agent)
2002-05-02 17:42:15 172.22.255.255 - 172.30.255.255 80 GET /images/picture.jpg - 200 Mozilla/4.0+(compatible;MSIE+5.5;+Windows+2000+Server)
```

Поле с временным временем инициализируется, когда API HTTP-сервера получает первый байт перед синтаксическим анализом запроса. Штамп времени, когда происходит Последнее завершение отправки, останавливается. Время ожидания не отражает время по сети. Первый запрос к сайту показывает немного больше времени, чем другие аналогичные запросы, так как API сервера HTTP открывает файл журнала с первым запросом.

 

 