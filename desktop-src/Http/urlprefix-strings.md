---
title: Строки UrlPrefix
description: В API сервера HTTP UrlPrefix — это строка Юникода с расширенными символами (UTF-16) с канонической формой, которая указывает раздел пространства имен URL-адреса.
ms.assetid: 4f317bf6-ee6a-47a8-a531-78534217109d
keywords:
- UrlPrefix строки API сервера HTTP
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bddc484f26bc1b3de5d20196dadec9201d3ea272
ms.sourcegitcommit: 73417d55867c804274a55abe5ca71bcba7006119
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/20/2020
ms.locfileid: "103797203"
---
# <a name="urlprefix-strings"></a>Строки UrlPrefix

В API сервера HTTP *UrlPrefix* — это строка Юникода с расширенными символами (UTF-16) с канонической формой, которая указывает раздел пространства имен URL-адреса. Он используется для резервирования раздела пространства имен URL-адреса для учетной записи пользователя или регистрации раздела пространства имен URL-адреса для процесса.

## <a name="urlprefix-format"></a>Формат UrlPrefix

UrlPrefix имеет следующий синтаксис:

"схема://Host: порт/relativeURI"

Элементы схемы, узла и порта UrlPrefix должны быть представлены и не быть пустыми и должны соблюдать следующие правила.

<dl> <dt>

<span id="scheme"></span><span id="SCHEME"></span>Схема
</dt> <dd>

Значение должно быть либо HTTP, либо HTTPS, в нижнем регистре.

</dd> <dt>

<span id="host"></span><span id="HOST"></span>хост
</dt> <dd>

Необходимо указать полное доменное имя, строку литерала IPv4 или IPv6 или подстановочный знак. В отличие от схемы, которая должна быть строчной, часть узла не учитывает регистр. В зависимости от того, как указана его часть узла, UrlPrefix попадает в одну из четырех категорий маршрутизации, которые более подробно описаны ниже:

<dl> <dd>Строгий шаблон</dd> <dd>Явная</dd> <dd>Слабый шаблон с ограниченным IP-адресом</dd> <dd>Слабый шаблон</dd> </dl> </dd> <dt>

<span id="port"></span><span id="PORT"></span>порту
</dt> <dd>

Десятичная числовая строка, которая не начинается с нуля и представляет допустимый номер TCP-порта (от 1 до 65 535). Это значение не может быть подстановочным знаком.

</dd> <dt>

<span id="relativeURI"></span><span id="relativeuri"></span><span id="RELATIVEURI"></span>relativeURI
</dt> <dd>

Элемент relativeURI является необязательным, но при его наличии всегда должен следовать символ косой черты ("/"). Это строка префикса, указывающая поддерево в пространстве имен компьютера, указанное относительно значения схемы, узла и порта. В отличие от схемы, которая должна быть строчной, часть relativeURI не учитывает регистр.

</dd> </dl>

Примеры правильно сформированных Урлпрефиксес:

-   `https://www.adatum.com:80/vroot/`
-   `https://adatum.com:443/secure/database/`
-   `https://+:80/vroot/`

## <a name="host-specifier-categories"></a>Категории Host-Specifier

Для гибкости и простоты использования API сервера HTTP поддерживает четыре разных способа указания узлов. Четыре категории спецификаторов узлов перечислены ниже в порядке приоритета.

<dl> <dt>

<span id="Strong_wildcard__Plus_Sign_"></span><span id="strong_wildcard__plus_sign_"></span><span id="STRONG_WILDCARD__PLUS_SIGN_"></span>Строгий шаблон (знак "плюс")
</dt> <dd>

Если ведущий элемент UrlPrefix состоит из одного знака плюса (+), UrlPrefix сопоставляет все возможные имена узлов в контексте его схемы, порта и элемента relativeURI и попадает в категорию строгого шаблона.

Строгий шаблон полезен, если приложению требуется обслуживать запросы, адресованные одному или нескольким Релативеурис, независимо от того, как эти запросы поступают на компьютер или какой сайт они указал в заголовках узлов. Использование строгого подстановочного знака в этой ситуации позволяет избежать необходимости указывать исчерпывающий список узлов и/или IP-адресов.

</dd> <dt>

<span id="Explicit"></span><span id="explicit"></span><span id="EXPLICIT"></span>Прямая
</dt> <dd>

Явное имя узла, например полное доменное имя в элементе Host, помещает UrlPrefix в явную категорию. Этот тип ведущего элемента сопоставляется непосредственно с заголовками узлов входящих запросов.

Явные спецификации узлов полезны для приложений с несколькими сайтами, таких как веб-серверы, которые доставляют различные ресурсы в зависимости от сайта, на который был направлен запрос.

</dd> <dt>

<span id="IP-bound_weak_wildcard"></span><span id="ip-bound_weak_wildcard"></span><span id="IP-BOUND_WEAK_WILDCARD"></span>Слабый шаблон с ограниченным IP-адресом
</dt> <dd>

Когда IP-адрес отображается как ведущий элемент, UrlPrefix попадает в неограниченную IP-маску. Этот тип UrlPrefix соответствует любому имени узла для указанного IP-интерфейса с указанной схемой, портом и relativeURI и не соответствует строгому шаблону или явному UrlPrefix. IP-адрес принимает одну из двух форм в элементе Host:

<dl> <dt>

<span id="IPv4_Literal_String"></span><span id="ipv4_literal_string"></span><span id="IPV4_LITERAL_STRING"></span>Строка литерала IPv4
</dt> <dd>

Литерал IPv4 состоит из четырех десятичных чисел с точками в диапазоне 0-255, например 192.168.0.0.

</dd> <dt>

<span id="IPv6_Literal_String"></span><span id="ipv6_literal_string"></span><span id="IPV6_LITERAL_STRING"></span>Строка литерала IPv6
</dt> <dd>

Строка литерала IPv6 заключена в квадратные скобки и содержит шестнадцатеричные числа, разделенные двоеточиями. Например:: \[ : 1 \] или \[ 3FFE: FFFF:: 6ECB: 0101 \] .

</dd> </dl>

Спецификаторы узлов с слабым шаблоном с ограниченным IP-адресом предназначены для приложений, которые зависят от маршрута, принимаемого входящими запросами. Не следует полагаться на спецификаторы узлов с ограниченным использованием IP-адресов, чтобы обеспечить безопасность.

</dd> <dt>

<span id="Weak_wildcard__asterisk_"></span><span id="weak_wildcard__asterisk_"></span><span id="WEAK_WILDCARD__ASTERISK_"></span>Слабый символ-шаблон (звездочка)
</dt> <dd>

Когда в \* качестве ведущего элемента отображается звездочка (), UrlPrefix попадает в категорию слабых подстановочных знаков. Этот тип UrlPrefix соответствует любому имени узла, связанному с указанной схемой, портом и параметром relativeURI, который еще не совпал с слабым шаблоном UrlPrefix с нестрогим подстановочным знаком, явным образом или с IP-адресом.

В некоторых обстоятельствах эту спецификацию узла можно использовать по умолчанию, а также можно использовать для указания большого раздела пространства имен URL-адресов без использования многих Урлпрефиксес.

</dd> </dl>

## <a name="urlprefix-conflict-detection-during-reservation-and-registration"></a>Обнаружение конфликтов UrlPrefix во время резервирования и регистрации

В целях резервирования и регистрации четыре различные категории UrlPrefix обрабатываются отдельно, без ссылки на друг друга. Можно зарегистрировать конфликтующие Урлпрефиксес, если они находятся в разных категориях. Конфликт в пределах одной категории вызывает сбой попытки резервирования.

Например, можно зарезервировать как явные UrlPrefix `https://www.adatum.com:80/vroot/` , так и конфликтующие строгие подстановочные знаки UrlPrefix `https://+:80/vroot/` , так как они принадлежат разным категориям. Однако последующая попытка зарезервировать https://+:80/vroot/ другого пользователя завершится ошибкой, так как это приведет к конфликту с существующим резервированием в собственной категории.

## <a name="routing-behavior"></a>Поведение маршрутизации

При маршрутизации входящего HTTP-запроса API сервера HTTP начинается с категории строгого шаблона и сравнивает входящий URL-адрес с зарегистрированными и зарезервированными Урлпрефиксес в этой категории.

Если входящий URL-адрес совпадает с резервированием, но не с регистрацией, то API сервера HTTP не сможет выполнить запрос. Это предотвращает возможность получения запросов, не предназначенных для него, с более низким приоритетом. Состояние ошибки — 400 ("Недопустимый запрос"), а не 503 ("Служба недоступна"), так как возвращаемое значение 503 иногда ошибочно интерпретируется шлюзами балансировки нагрузки, как указано, что сервер перегружен.

Если в категории найдена соответствующая регистрация, запрос направляется в очередь запросов, связанную с этой регистрацией. Запрос всегда направляется в очередь, связанную с наиболее длинными UrlPrefix в категории.

Если в категории не найдено совпадений, API сервера HTTP переходит к явной категории и повторяет ту же процедуру. Чтобы суммировать, порядок, в котором анализируются категории, выглядит следующим образом:

1.  Строгий шаблон
2.  Явная
3.  IP-Bound слабый шаблон
4.  Слабый шаблон

Если в какой-либо из категорий совпадений не найдено, API сервера HTTP отправляет ответ с кодом состояния 400, указывая на то, что запрос не может быть перенаправлен.

## <a name="longest-match-rule"></a>Правило наиболее подходящие

В каждой категории UrlPrefix API сервера HTTP направляет запрос в очередь, связанную с самым длинным UrlPrefix. Например, предположим, что следующие две Урлпрефиксес зарегистрированы в разных очередях:

- `Queue1 https://www.adatum.com:80/`
- `Queue2 https://www.adatum.com:80/dir/sna/`

API сервера HTTP направляет запрос `https://www.adatum.com:80/default.htm` на Queue1 и запрос `https://www.adatum.com:80/dir/sna/snadefault.htm` на Queue2. Он направляет запрос `https://www.adatum.com:80/dir/app.htm` на Queue1, так как самое длинное полное соответствие заключается в `https://www.adatum.com:80/` UrlPrefix, а не в `https://www.adatum.com:80/dir/sna` UrlPrefix.

 

 




