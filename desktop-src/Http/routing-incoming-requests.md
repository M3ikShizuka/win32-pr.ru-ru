---
title: Маршрутизация входящих запросов
description: API сервера HTTP поддерживает базу данных маршрутизации, чтобы определить, какое приложение получает входящий запрос.
ms.assetid: 7c613137-66bd-4375-93cb-b5562823bc12
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: da483030441f3a9239eef153da59212166bce9eb
ms.sourcegitcommit: 73417d55867c804274a55abe5ca71bcba7006119
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/20/2020
ms.locfileid: "104414080"
---
# <a name="routing-incoming-requests"></a>Маршрутизация входящих запросов

API сервера HTTP поддерживает базу данных маршрутизации, чтобы определить, какое приложение получает входящий запрос. Таблица маршрутизации строится на основе базы данных резервирования и содержит записи резервирования, а также текущие регистрации. Когда выполняется регистрация или резервирование, оно помещается в контейнер базы данных маршрутизации, соответствующий типу узла, следующим образом:

-   \+ : регистрации портов помещаются в контейнер "строгий шаблон"

-   узел. регистрации портов помещаются в контейнер "explicit".

-   IP-адрес: регистрации портов помещаются в контейнер с слабым IP-адресом, связанным с системой

-   \* : регистрации портов помещаются в контейнер "слабый шаблон".

Эти шаги также указывают на порядок обработки входящих HTTP-запросов. Сначала необходимо использовать строгие резервирования с подстановочными знаками, а затем явно зарезервированные данные, а также слабый подстановочный знак, связанный с IP-адресом. Поиск прекращается при обнаружении совпадения, чтобы регистрация в любом из оставшихся контейнеров не была найдена.

Алгоритм маршрутизации API HTTP-сервера находит наилучшее соответствие для [UrlPrefix](urlprefix-strings.md) , выполняя поиск по записям регистрации и записям резервирования базы данных маршрутизации, начиная с контейнера с строгим шаблоном и заканчивая слабым контейнером шаблона. Наилучшее соответствие в контейнере — это самое длинное совпадение в относительной части URI UrlPrefix (при условии точного соответствия для частей адреса узла, порта и схемы). После обнаружения совпадения в контейнере алгоритм маршрутизации останавливает Поиск и пропускает все сегменты с более низким приоритетом.

Например, рассмотрим следующие регистрации (перечисленные в порядке убывания приоритета на основе типов контейнеров:

-   Регистрация: `https://+:80/vroot/` регистрируется приложением 1.

-   Регистрация: `https://adatum.com:80/` регистрируется приложением 2.

-   Регистрация: `https://\*:80/` регистрируется приложением 3.

Входящий запрос для `https://adatum.com:80/vroot/subdir/file.htm/` отправлен в приложение 1. Входящий запрос для `https://adatum.com:80/default.htm/` отправлен в приложение 2. Входящий запрос для `https://otheradatum.com:80/file.htm/` отправлен в приложение 3.

Если наиболее подходящее совпадение является записью резервирования, это означает, что приложение, которое должно получить запрос, не работает. Например, рассмотрим следующую регистрацию и резервирование:

-   Регистрация: `https://\*:80/vroot/` регистрируется приложением 1, пользователем а

-   Резервирование: `https://adatum.com:80/` зарезервировано для пользователя б

Входящий запрос для `https://adatum.com:80/vroot/file.htm/` не доставляется в приложение 1, так как наилучшее соответствие приводит к записи резервирования для пользователя б. В этом случае к резервированию с более высоким приоритетом применяются правила приоритета. Если нет активных процессов, которые были разрешены и зарегистрированы для запросов на обслуживание по полученному URL-адресу, запрос отклоняется с кодом состояния 400 (недопустимый запрос).

 

 




