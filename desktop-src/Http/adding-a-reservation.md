---
title: Добавление резервирования
description: База данных маршрутизации содержит список резервирований.
ms.assetid: c36e731c-6a0b-42a8-bc92-106a8e017b0d
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 358181cbe57a046f5af54f7adf17bdadb24c3ddc
ms.sourcegitcommit: 73417d55867c804274a55abe5ca71bcba7006119
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/20/2020
ms.locfileid: "104533587"
---
# <a name="adding-a-reservation"></a>Добавление резервирования

База данных маршрутизации содержит список резервирований. Список резервирования состоит из пользователей, которым разрешен доступ к пространству имен, а также уровня доступа для каждого пользователя, указанного под зарезервированием. При добавлении или удалении резервирований выполняется поиск базы данных маршрутизации для определения прав доступа.

Помимо проверки идентификатора пользователя, API сервера HTTP также проверяет наличие конфликтов в существующих резервированиях перед установкой нового резервирования.

**Добавление нового резервирования**

1.  Если номер порта в UrlPrefix содержит резервирования или регистрации для схемы, отличной от схемы в UrlPrefix, регистрация завершается ошибкой. Протоколы HTTP и HTTPS не поддерживаются в одном и том же порте.
2.  Выберите соответствующий контейнер для регистрации (см. раздел [Маршрутизация входящих запросов](routing-incoming-requests.md) ) в зависимости от типа узла. Остальные шаги зависят от этого контейнера.
3.  Выберите записи резервирования с компонентами схемы, узла и порта, которые соответствуют зарезервированному UrlPrefix. В этом случае нахождение записи с наиболее длинным соответствующим значением *relativeUri* , не равным значению параметра relativeUri в резервировании (т. е. *родительского узла*). Если запись существует, оцените права доступа на основе списка управления доступом, назначенного этой записи.
4.  Если родительский узел не найден, это резервирование с пустым параметром relativeUri или *корневым резервированием*. Предоставляйте права доступа только в том случае, если вызывающий объект зарегистрирован в учетных записях LocalSystem или Administrator.
5.  Если предоставлены права доступа, проверьте наличие повторяющихся резервирований. Если запись резервирования существует с той же схемой, портом, узлом и значением relativeUri, \_ то \_ возвращается код ошибки.
    > [!Note]  
    > Обновление существующей записи должно выполняться в два этапа: удалить запись и добавить новую.

     

Если указанные выше шаги выполнены, в базу данных резервирования будет введена новая запись резервирования.

> [!Note]  
> Новая запись создается с указанным ACL и не наследует списки ACL от *родительской* записи.

 

В следующих примерах иллюстрируется процесс резервирования.

-   Резервирование 1. `https://+:80/vroot/subdir/` администратор пользователя а, а также пользователь в и в контейнере "+".
-   Резервирование 2. `https://adatum.com:80/vroot/` Администратор для пользователя б проходит успешную команду и входит в контейнер "явный узел".
-   Резервирование 3. `https://adatum.com:80/vroot/subdir/otherdir/` пользователь б для пользователя C прошел из-за резервирования 2.
-   Резервирование 4. `https://+:80/vroot/subdir/otherdir/` пользователь A для пользователя E прошел из-за резервирования 1.
-   Резервирование 5. `https://adatum.com:80/vroot/subdir/otherdir/` пользователь A для пользователя E завершается ошибкой. Отказано в доступе из-за резервирования 2.
-   Резервирование 6. `https://+:80/vroot/subdir/` администратору для пользователя A не удается. Резервирование конфликтует с зарезервированным 1.
-   Резервирование 7. `https://adatum.com:80/newroot/` пользователь a для пользователя a завершается ошибкой. Отказано в доступе из-за неявного корневого резервирования `https://adatum.com:80/` для LocalSystem или администратора.

Резервирование может повлиять на набор URL-адресов в запросах, доставленных процессу, который ранее зарегистрировал UrlPrefix. Давайте рассмотрим следующий пример.

-   Регистрация: `https://adatum.com:80/vroot/` в приложении 1 для пользователя а.
-   Запрос `https://adatum.com:80/vroot/subdir/file.htm` отправляется в приложение 1.
-   Резервирование: `https://+:80/vroot/subdir/` для пользователя б.
-   Запрос для `https://adatum.com:80/vroot/subdir/file.htm` теперь отклонен.
-   Регистрация: `https://adatum.com:80/vroot/subdir/` в приложении 2 для пользователя б.
-   Запрос `https://adatum.com:80/vroot/subdir/file.htm` отправляется в приложение 2.

 

 




