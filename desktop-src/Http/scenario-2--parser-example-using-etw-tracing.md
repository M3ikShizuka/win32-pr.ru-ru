---
title: Пример синтаксического анализатора сценария 2 с использованием трассировки ETW
description: Чтобы создать отчет трассировки событий Windows для компонента API сервера HTTP, выполните шаги, показанные в \ 0034; Создание отчета трассировки событий Windows \ 0034; раздел сценария 1. пример времени ожидания HTTP с использованием трассировки ETW и команд Netsh, но воспроизвести ошибку, относящуюся к этому сценарию.
ms.assetid: 2ccd2927-8a64-40a8-a29b-4b680a942f7f
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 866c566973b660e4e665226fbf9b4a266b086b6b
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "104070016"
---
# <a name="scenario-2-parser-example-using-etw-tracing"></a>Сценарий 2. Пример средства синтаксического анализа с использованием трассировки ETW

Чтобы создать отчет трассировки событий Windows для компонента API сервера HTTP, выполните действия, как показано в подразделе "Создание отчета трассировки событий Windows" [сценария 1: время ожидания HTTP с помощью команд трассировки событий Windows и команды netsh](scenario-1--http-timeout-example-using-etw-tracing-and-netsh-commands.md), но Воспроизведите ошибку, относящуюся к этому сценарию. В этом примере доступ к веб-приложению осуществляется с клиентского компьютера, что приводит к отображению сообщения "400 недопустимый запрос" на стороне клиента. Эти действия выполняются на сервере, так как на нем размещается веб-приложение.

## <a name="viewing-the-trace-and-diagnosing"></a>Просмотр трассировки и диагностика

Полученный CSV-файл для трассировок можно просмотреть в Excel или в любом средстве, поддерживающем формат CSV. В таблице 2 ниже показаны фрагменты из образца файла трассировки (httptrace.csv). В отчете трассировки в столбце "уровень" отображается запись со значением "2", которое представляет ошибку. Как отмечалось выше, компонент API сервера HTTP соответствует уровням ETW, определенным в статье [сложный тип Complex левелтипе](../wes/eventmanifestschema-leveltype-complextype.md).

К уровням ETW относятся: 1 критическая; 2 ошибка; 3 предупреждение; 4. Информация; 5 подробный.

С этой ошибкой тип события (столбец типа) сообщает "Парсерекуестфаилед". В последующих столбцах для события Парсерекуестфаилед отображается запись "Инвалидхост". Эта запись означает, что идентифицированный узел в HTTP-запросе неверен в соответствии с протоколом HTTP. Обратите внимание, что столбец с записью "Инвалидхост" не включается в таблицу для краткости и не выдает отрывок несмежных столбцов.

Чтобы устранить эту проблему синтаксического анализа, необходимо исправить веб-клиент, чтобы он соответствовал стандарту HTTP RFC. 

| Имя события                    | Тип               | Идентификатор события | Версия | Канал | Level |
|-------------------------------|--------------------|----------|---------|---------|-------|
| евенттраце                    | Header             | 0        | 2       | 0       | 0     |
| Microsoft-Windows-Хттпсервице | аддурл             | 31       | 0       | 16      | 4     |
| Microsoft-Windows-Хттпсервице | коннконнект        | 21       | 0       | 16      | 4     |
| Microsoft-Windows-Хттпсервице | коннидассгн        | 22       | 0       | 16      | 4     |
| Microsoft-Windows-Хттпсервице | рекврек            | 1        | 0       | 16      | 4     |
| Microsoft-Windows-Хттпсервице | парсерекуестфаилед | 52       | 0       | 16      | 2     |
| Microsoft-Windows-Хттпсервице | логфилеврите       | 51       | 0       | 16      | 4     |



 

Таблица 2. Выдержка из образца отчета трассировки для проблемы синтаксического анализа

 

 