---
description: Идентификаторы событий однозначно идентифицируют определенное событие.
ms.assetid: 83a84db4-572b-48bd-bc0f-071b2089a5ca
title: Идентификаторы событий (ведение журнала событий)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 402337cb2c7e862785a88ec604c6382152736fd7
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104543055"
---
# <a name="event-identifiers-event-logging"></a>Идентификаторы событий (ведение журнала событий)

Идентификаторы событий однозначно идентифицируют определенное событие. Каждый [источник событий](event-sources.md) может определять свои собственные пронумерованные события и строки описания, с которыми они сопоставляются в файле сообщений. Средства просмотра событий могут предоставлять пользователю эти строки. Они должны помочь пользователю понять, что пошло не так, и предложить, какие действия следует предпринять. Направьте описание у пользователей, которое решает свои проблемы, а не для администраторов или специалистов службы поддержки. Дополнительные сведения см. в разделе [рекомендации по сообщениям об ошибках](/windows/desktop/Debug/error-message-guidelines).

## <a name="format"></a>Формат

На следующей схеме показан формат идентификатора события.

``` syntax
  3 3 2 2 2 2 2 2 2 2 2 2 1 1 1 1 1 1 1 1 1 1
  1 0 9 8 7 6 5 4 3 2 1 0 9 8 7 6 5 4 3 2 1 0 9 8 7 6 5 4 3 2 1 0
 +---+-+-+-----------------------+-------------------------------+
 |Sev|C|R|     Facility          |               Code            |
 +---+-+-+-----------------------+-------------------------------+
```

<dl> <dt>

<span id="Sev"></span><span id="sev"></span><span id="SEV"></span>Уровень серьезности
</dt> <dd>

серьезность. Уровень серьезности определяется следующим образом.

<dl> <dd>00 — успешное завершение</dd> <dd>01-информационная</dd> <dd>10 — предупреждение</dd> <dd>11 — ошибка</dd> </dl> </dd> <dt>

<span id="C"></span><span id="c"></span>Ц
</dt> <dd>

Бит клиента. Этот бит определяется следующим образом:

<dl> <dd>0 — системный код</dd> <dd>1. код клиента</dd> </dl> </dd> <dt>

<span id="R"></span><span id="r"></span>Cерверный
</dt> <dd>

Зарезервированный бит.

</dd> <dt>

<span id="Facility"></span><span id="facility"></span><span id="FACILITY"></span>Объектом
</dt> <dd>

Код устройства. Это значение может быть \_ равно null.

</dd> <dt>

<span id="Code"></span><span id="code"></span><span id="CODE"></span>Приведен
</dt> <dd>

Код состояния для средства.

</dd> </dl>

## <a name="message-definitions"></a>Определения сообщений

Сообщения определяются в файле сообщений о событиях. Строки описания в файле сообщений о событиях индексируются по идентификатору события, что позволяет Просмотр событий отображать текст, относящийся к конкретному событию, для любого события, основанного на идентификаторе события. Все описания локализованы и зависят от языка. Дополнительные сведения о создании файла сообщений см. в разделе [текстовые файлы сообщений](message-text-files.md).

Строки описания могут содержать заполнители строки вставки в форме%*n*, где %1 обозначает первую строку вставки и т. д. Например, ниже приведен пример записи в MC-файле:

``` syntax
MessageId=0x4
Severity=Error
Facility=System
SymbolicName=MSG_CMD_DELETE
Language=English
File %1 contains %2, which is in error.
.
```

В этом случае буфер, возвращенный [**реадевентлог**](/windows/desktop/api/Winbase/nf-winbase-readeventloga) , содержит строки вставки. Элемент **нумстрингс** структуры [**EVENTLOGRECORD**](/windows/desktop/api/Winnt/ns-winnt-eventlogrecord) указывает количество вставляемых строк. Элемент **стрингоффсет** структуры **EVENTLOGRECORD** указывает расположение первой вставляемой строки в буфере. Можно передать массив DWORD \_ ПТРС, указывающий на адрес каждой строки в буфере при вызове функции [**FormatMessage**](/windows/desktop/api/winbase/nf-winbase-formatmessage) , и вставит строки в сообщение.

Строка описания может также содержать заполнители для строк параметров из файла сообщений параметров. Заполнители имеют форму%%*n*, где% %1 заменяется строкой параметра с идентификатором 1 и т. д. Однако можно вставить строки параметров в строку сообщения, возвращаемую [**FormatMessage**](/windows/desktop/api/winbase/nf-winbase-formatmessage) . Как правило, метод **FormatMessage** вызывается для получения строки сообщения для события. Затем выполняется синтаксический анализ строки сообщения для параметров%%*n* . Если сообщение содержит один или несколько параметров, загрузите значение реестра **параметермессажефиле** для источника. Для каждого параметра в строке сообщения получите идентификатор и передайте его в **FormatMessage** , чтобы получить строку параметра. Замените параметр в строке сообщения строкой параметра, возвращаемой **FormatMessage** .

## <a name="insertion-strings"></a>Строки вставки

Строки вставки — это необязательные независящие от языка строки, используемые для заполнения значений заполнителей в строках описания. Поскольку строки не локализованы, крайне важно, чтобы эти заполнители использовались только для представления независимых от языка строк, таких как числовые значения, имена файлов, имена пользователей и т. д. Длина строки не должна превышать 32 КБ-1 символов.

Избегайте использования нескольких строк для создания более крупного описания. Строка вставки должна обрабатываться как данные, а не как текст. Например, в следующем примере pszString1 и pszString2 не должны использоваться в качестве вставляемых строк для Псздескриптион.

``` syntax
LPSTR pszString1 = "successfully"; 
LPSTR pszString2 = "not"; 
LPSTR pszDescription = "The user was %1 added to the database.";
```

В следующем примере можно использовать pszString1 или pszString2 для строки вставки в Псздескриптион.

``` syntax
LPSTR pszString1 = "c:\\testapp1.c"; 
LPSTR pszString2 = "c:\\testapp2.c"; 
LPSTR pszDescription = "Access denied. Attempted to open the file %1."
```

 

 
