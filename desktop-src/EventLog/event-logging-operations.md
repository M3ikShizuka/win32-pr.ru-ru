---
description: Функции Опеневентлог, Опенбаккупевентлог, Регистеревентсаурце, Дерегистеревентсаурце и Клосивентлог открывают и закрывают дескрипторы журнала событий.
ms.assetid: e42a66c2-2f1e-46f8-99c7-4701075c8ec3
title: Операции ведения журнала событий
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 065acd268788de8c9674baa1fe47a3b89a719d4c
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105683285"
---
# <a name="event-logging-operations"></a>Операции ведения журнала событий

Функции [**опеневентлог**](/windows/desktop/api/Winbase/nf-winbase-openeventloga), [**опенбаккупевентлог**](/windows/desktop/api/Winbase/nf-winbase-openbackupeventloga), [**регистеревентсаурце**](/windows/desktop/api/Winbase/nf-winbase-registereventsourcea), [**дерегистеревентсаурце**](/windows/desktop/api/Winbase/nf-winbase-deregistereventsource)и [**клосивентлог**](/windows/desktop/api/Winbase/nf-winbase-closeeventlog) открывают и закрывают дескрипторы журнала событий.

В следующей таблице показаны операции, которые можно выполнить с открытым журналом событий, и соответствующая функция для каждой операции.



| Операция | Функция                                                                                                                     |
|-----------|------------------------------------------------------------------------------------------------------------------------------|
| Резервное копирование    | [**баккупевентлог**](/windows/desktop/api/Winbase/nf-winbase-backupeventloga)                                                                                     |
| Clear     | [**клеаревентлог**](/windows/desktop/api/Winbase/nf-winbase-cleareventloga)                                                                                       |
| Монитор   | [**нотифичанжеевентлог**](/windows/desktop/api/Winbase/nf-winbase-notifychangeeventlog)                                                                         |
| Запрос     | [**Жетолдестевентлогрекорд**](/windows/desktop/api/Winbase/nf-winbase-getoldesteventlogrecord), [ **жетнумберофевентлогрекордс**](/windows/desktop/api/Winbase/nf-winbase-getnumberofeventlogrecords) |
| Чтение      | [**реадевентлог**](/windows/desktop/api/Winbase/nf-winbase-readeventloga)                                                                                         |
| запись     | [**репортевент**](/windows/desktop/api/Winbase/nf-winbase-reporteventa)                                                                                           |



 

Функции [**опеневентлог**](/windows/desktop/api/Winbase/nf-winbase-openeventloga) и [**репортевент**](/windows/desktop/api/Winbase/nf-winbase-reporteventa) принимают в качестве параметра необязательное имя сервера, что позволяет выполнять операции на удаленном сервере. Используйте [**опеневентлог**](/windows/desktop/api/Winbase/nf-winbase-openeventloga) для чтения или выполнения административных операций (резервное копирование, очистка, мониторинг и выполнение запросов) в журнале и использование [**регистеревентсаурце**](/windows/desktop/api/Winbase/nf-winbase-registereventsourcea) для записи в журнал.

Каждый вызов функции ведения журнала событий является атомарной операцией. При чтении из журнала событий возвращаются только целые записи событий. При записи в журнал событий каждая запись события гарантированно записывается последовательно как полная запись в журнале. В следующем списке описано, как служба ведения журнала событий обрабатывает особые условия.

-   Служба ведения журнала событий получает операцию чтения и операцию записи одновременно: Если значение позиции чтения находится в конце файла, то либо операция чтения завершается с ошибкой "конец файла" (если операция записи не была завершена), либо возвращается новая запись (если операция записи завершена).
-   Служба ведения журнала событий завершает операцию очистки перед получением операции чтения: операция чтения завершается сбоем с состоянием "конец файла".
-   Служба ведения журнала событий завершает операцию очистки перед получением операции записи: операция Clear усекает журнал, затем операция записи добавляет новую запись в начало журнала.

 

 



