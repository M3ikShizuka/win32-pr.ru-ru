---
title: Уровень совместимости приложений
description: Для запуска устаревших приложений в среде службы удаленных рабочих столов можно использовать службы удаленных рабочих столов уровень совместимости приложений.
ms.assetid: 6e61ed45-4fcb-4aee-b8cc-638a9b87ce00
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b3e7bbc5867e42951783d3666aa770cdcc45406f
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "105681692"
---
# <a name="application-compatibility-layer"></a>Уровень совместимости приложений

Для запуска устаревших приложений в среде службы удаленных рабочих столов можно использовать службы удаленных рабочих столов уровень совместимости приложений. Когда сервер узла сеансов удаленный рабочий стол (узел сеансов удаленных рабочих столов) загружает приложение, которое не поддерживает службы удаленных рабочих столов, оно также загружает библиотеку DLL, содержащую код совместимости. Чтобы использовать службы удаленных рабочих столов уровень совместимости приложений, можно установить флаг NOT TSAWARE при компиляции приложения.

Если ваше приложение службы удаленных рабочих столов осведомлено, можно избежать дополнительной нагрузки на загрузку этой дополнительной библиотеки DLL и выполнение кода совместимости.

Чтобы указать, что приложение службы удаленных рабочих столов осведомлено, установите флаг **" \_ образ \_ DLLCHARACTERISTICS \_ терминалов \_** " для образа в необязательном заголовке. Если вы используете компоновщик, который поставляется с Microsoft Visual C++, для установки этого флага можно использовать параметр компоновщика **TSAWARE** . Средство **dumpbin** , которое поставляется с Microsoft Visual C++, предоставляет параметр */headers* для определения состояния флага **TSAWARE** . Дополнительные сведения об использовании средства **dumpbin** см. в разделе [Справочник по DUMPBIN](/cpp/build/reference/dumpbin-reference?view=vs-2019).

Будьте внимательны при использовании флага **TSAWARE** , так как он позволяет приложению обходить любые службы удаленных рабочих столов оптимизации совместимости. Флаг **TSAWARE** следует использовать только в том случае, если вы уверены, что приложение предназначено для среды службы удаленных рабочих столов. Если приложение соответствует следующим критериям, можно безопасно использовать флаг "DLLCHARACTERISTICS Image" для работы с **\_ \_ \_ сервером \_ терминалов** .

-   Приложение не использует ini-файлы.
-   Во время установки приложение не выполняет запись в **hKey \_ текущего \_ пользователя** . Дополнительные сведения см. в разделе [Сохранение сведений о User-Specific](storing-user-specific-information.md).
-   Приложение не запускается как системная служба (то есть LUID = System).
-   Приложение не ждет монопольного доступа к системным каталогам Windows или. Это означает, что приложение не сохраняет временные или конфигурационные данные в Windows или других системных каталогах.
-   Приложение не выполняет запись в куст реестра для **локального компьютера hKey** для данных или конфигурации конкретного пользователя.
-   Это приложение соответствует другим рекомендациям по совместимости службы удаленных рабочих столов, упомянутым в настоящем документе.

 

 