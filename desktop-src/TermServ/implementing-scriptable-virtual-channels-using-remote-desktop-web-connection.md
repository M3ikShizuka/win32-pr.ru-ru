---
title: Реализация виртуальных каналов с использованием скриптов с помощью веб-подключение к удаленному рабочему столу
description: Примеры кода, демонстрирующие шаги для реализации виртуальных каналов с помощью сценариев с веб-подключение к удаленному рабочему столу.
ms.assetid: a482b84d-96b6-4f42-8841-7039a1882789
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6ba02fb745fb00d36d89011ce95255127caa9c9cf9c58873c5168df5114d72f7
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119990704"
---
# <a name="implementing-scriptable-virtual-channels-by-using-remote-desktop-web-connection"></a>Реализация виртуальных каналов с использованием скриптов с помощью веб-подключение к удаленному рабочему столу

В приведенной ниже процедуре и примерах кода показаны шаги для реализации сценариев с использованием скриптов с веб-подключение к удаленному рабочему столу. примеры написаны на Visual Basic scripting Edition и предполагают, что удаленный рабочий стол элемент управления ActiveX имеет имя «мсрдпклиент».

**Создание и развертывание виртуальных каналов, поддерживающих сценарии**

1.  Разверните серверную часть приложения и убедитесь, что оно выполняется на сервере узла сеансов удаленный рабочий стол (узел сеансов удаленных рабочих столов). Сведения о развертывании приложений виртуальных каналов на сервере см. в разделе [серверное приложение виртуальных каналов](virtual-channel-server-application.md).
2.  В клиентском скрипте вызовите [**имстскакс:: креатевиртуалчаннелс**](imstscax-createvirtualchannels.md), передав строку, содержащую список имен виртуальных каналов с разделителями-запятыми.

    ```VB
    MsRdpClient.CreateVirtualChannels("mychan1,mychan2")
    ```

    

    Сведения об ограничениях именования виртуальных каналов см. в разделе [Регистрация клиента для виртуального канала](virtual-channel-client-registration.md).

3.  вызовите [**имстскакс:: Подключение**](imstscax-connect.md) , чтобы создать подключение службы удаленных рабочих столов.

    ```VB
    MsRdpClient.connect
    ```

    

4.  Используйте метод [**имстскакс:: сендонвиртуалчаннел**](imstscax-sendonvirtualchannel.md) для отправки данных на сервер, передав строку, содержащую имя виртуального канала, и вторую строку, содержащую данные для передачи.

    ```VB
    MsRdpClient.SendOnVirtualChannel("mychan1","hello from the client")
    ```

    

5.  Получение данных с сервера в событии [**имстскаксевентс:: ончаннелрецеиведдата**](imstscaxevents-onchannelreceiveddata.md) .

    ```VB
    Sub MsRdpClient.OnChannelReceivedData(chanName,data)
    Msgbox("received data:" &data& "on virtual channel:" &chanName)
    End sub
    ```

    

 

 




