---
title: Использование элемента управления ActiveX удаленный рабочий стол с виртуальными каналами
description: Если вы включили приложение виртуальных каналов в развертывание службы удаленных рабочих столов, это приложение можно будет сделать доступным для клиентских компьютеров.
ms.assetid: df537ffb-41dd-400e-8a49-9d8a10734eda
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 026c8fa23f1498270bd0d2a29c5f48d50f0b2463
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "103888524"
---
# <a name="using-the-remote-desktop-activex-control-with-virtual-channels"></a>Использование элемента управления ActiveX удаленный рабочий стол с виртуальными каналами

Если вы включили приложение виртуальных каналов в развертывание службы удаленных рабочих столов, это приложение можно сделать доступным для клиентских компьютеров, которые обращаются к серверу узла сеансов удаленный рабочий стол (сервер узла сеансов удаленных рабочих столов) с помощью удаленный рабочий стол элемента управления ActiveX.

**Предоставление доступа к приложению виртуального канала**

1.  Разверните серверный модуль приложения и убедитесь, что он выполняется на сервере узла сеансов удаленных рабочих столов. На странице Подключение веб-приложения службы удаленных рабочих столов, работающего на веб-сервере, обратитесь к свойству **плугиндллс** интерфейса [**имстскадванцедсеттингс**](imstscadvancedsettings-interface.md) , чтобы указать имя библиотеки DLL виртуального канала. При наличии нескольких подключаемых модулей укажите имена библиотек DLL с разделителями-запятыми. Например, если подключаемый модуль виртуального канала имеет имя "MyPlugin.dll", используйте следующий код:

    ``` syntax
    MsRdpClient.AdvancedSettings.PluginDlls = "myplugin.dll"
    ```

    Используйте следующий код, если у вас есть две библиотеки DLL виртуального канала. В этом примере имена файлов DLL имеют значение "MyPlugin.dll" и "Vdriver.dll":

    ``` syntax
    MsRdpClient.AdvancedSettings.PluginDlls = "myplugin.dll,Vdriver.dll"
    ```

    По соображениям безопасности свойство **плугиндллс** принимает только именованный список библиотек DLL виртуальных каналов. Элемент управления возвращает ошибку, если указана любая форма файловой системы или путь в формате UNC. Кроме того, имена библиотек DLL должны содержать только алфавитно-цифровые символы.

2.  Убедитесь, что клиентский модуль установлен в каталоге% WINDIR% \\ System32.

API виртуальных каналов не допускает загрузку нескольких экземпляров одной и той же библиотеки виртуальных каналов в рамках одного процесса. В связи с этим при наличии нескольких экземпляров элемента управления ActiveX удаленный рабочий стол, выполняющихся в одном процессе, только первый экземпляр элемента управления сможет загрузить библиотеку DLL виртуального канала. Если вы разрабатываете приложение виртуального канала, которое должно поддерживать несколько экземпляров в рамках одного процесса, для реализации приложения виртуального канала необходимо использовать API [динамических виртуальных каналов](dynamic-virtual-channels.md) .

> [!Note]  
> По умолчанию удаленный рабочий стол элемент управления ActiveX загружает клиентские библиотеки DLL виртуальных каналов из каталога% WINDIR% \\ System32. Администратор может изменить каталог DLL подключаемого модуля клиента по умолчанию. Чтобы сделать это, измените раздел реестра **hKey \_ Local \_ Machine** \\ **Software** \\ **Microsoft** \\ **терминалов Client** \\ **вдллпас** на клиентском компьютере. Путь к каталогу не может быть указан в формате UNC.

 

 

 




