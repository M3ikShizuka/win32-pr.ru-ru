---
title: Класс MsRdpClient4a
description: Клиентский элемент управления Microsoft RDP (распространяемый пакет) — версия 5A.
ms.assetid: D025E5A2-9A04-44BC-BE6C-581E6B34ABCF
ms.tgt_platform: multiple
keywords:
- службы удаленных рабочих столов класса MsRdpClient4a
- Службы удаленных рабочих столов класс MsRdpClient4a, описание
topic_type:
- apiref
api_name:
- MsRdpClient4a
api_location:
- MsTscAx.dll
api_type:
- COM
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 656309444cbd39128f8c84753caebce4a12819bb
ms.sourcegitcommit: a1494c819bc5200050696e66057f1020f5b142cb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2020
ms.locfileid: "103988395"
---
# <a name="msrdpclient4a-class"></a>Класс MsRdpClient4a

Клиентский элемент управления Microsoft RDP (распространяемый пакет) — версия 5A

Этот класс реализует следующие интерфейсы.

-   [**IMsRdpClient4**](imsrdpclient4.md)
-   [**IMsRdpClient3**](imsrdpclient3.md)
-   [**IMsRdpClient2**](imsrdpclient2.md)
-   [**имсрдпклиент**](imsrdpclientshell2.md)
-   [**имстскакс**](imstscax-interface.md)
-   [**IDispatch**](/windows/win32/api/oaidl/nn-oaidl-idispatch)
-   [**имстскаксевентс**](imstscaxevents-interface.md)
-   [**имстскнонскриптабле**](imstscnonscriptable-interface.md)
-   [**имсрдпклиентнонскриптабле**](imsrdpclientnonscriptable-interface.md)
-   [**IMsRdpClientNonScriptable2**](imsrdpclientnonscriptable2.md)

**MsRdpClient4a** имеет следующие типы членов:

-   [Методы](#methods)
-   [Свойства](#properties)

### <a name="methods"></a>Методы

Класс **MsRdpClient4a** содержит следующие методы.



| Метод                                                                                      | Описание                                                                                                                                                                                                                                                                                   |
|:--------------------------------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**Подключение**](imstscax-connect.md)                                                         | Инициирует соединение с использованием свойств, заданных в данный момент в элементе управления.<br/>                                                                                                                                                                                                          |
| [**креатевиртуалчаннелс**](imstscax-createvirtualchannels.md)                             | Создает объект виртуального канала на стороне клиента для каждого указанного имени виртуального канала.<br/>                                                                                                                                                                                              |
| [**Отключение**](imstscax-disconnect.md)                                                   | Отключает активное подключение.<br/>                                                                                                                                                                                                                                                 |
| [**жетвиртуалчаннелоптионс**](imsrdpclient-getvirtualchanneloptions.md)                   | Извлекает параметры, заданные для виртуального канала.<br/>                                                                                                                                                                                                                                   |
| [**нотифиредиректдевицечанже**](imsrdpclientnonscriptable-notifyredirectdevicechange.md)  | Уведомляет модуль перенаправления устройств элемента управления ActiveX удаленный рабочий стол, что в системе произошло изменение устройства. Этот метод передает в элемент управления уведомления [**WM \_ девицечанже**](/windows/desktop/DevIO/wm-devicechange) .<br/>                                                        |
| [**онаусентикатионварнингдисмиссед**](imstscaxevents-onauthenticationwarningdismissed.md) | Вызывается после того, как элемент управления ActiveX отображает диалоговое окно проверки подлинности (например, диалоговое окно "Ошибка сертификата").<br/>                                                                                                                                                             |
| [**онаусентикатионварнингдисплайед**](imstscaxevents-onauthenticationwarningdisplayed.md) | Вызывается перед тем, как элемент управления ActiveX отображает диалоговое окно проверки подлинности (например, диалоговое окно "Ошибка сертификата").<br/>                                                                                                                                                            |
| [**онаутореконнектед**](imstscaxevents-onautoreconnected.md)                               | Вызывается при автоматическом повторном подключении клиентского элемента управления к удаленному сеансу.<br/>                                                                                                                                                                                                  |
| [**онаутореконнектинг**](-imstscaxevents--onautoreconnecting.md)                           | Вызывается, когда клиент находится в процессе автоматического повторного подключения к сеансу с сервером узла сеансов удаленных рабочих столов.<br/>                                                                                                                                                                      |
| [**OnAutoReconnecting2**](imstscaxevents-onautoreconnecting2.md)                           | Вызывается, когда клиент находится в процессе автоматического повторного подключения к сеансу с сервером узла сеансов удаленных рабочих столов.<br/>                                                                                                                                                                      |
| [**ончаннелрецеиведдата**](imstscaxevents-onchannelreceiveddata.md)                       | Вызывается, когда клиент получает данные в виртуальном канале, поддерживающем скрипт.<br/>                                                                                                                                                                                                              |
| [**онконфирмклосе**](imstscaxevents-onconfirmclose.md)                                     | Вызывается, когда клиент вызывает метод [**имсрдпклиент:: RequestClose**](imsrdpclient-requestclose.md) .<br/>                                                                                                                                                                           |
| [**Подключено**](imstscaxevents-onconnected.md)                                           | Вызывается, когда клиентский элемент управления находится в процессе установления соединения с сервером узла сеансов удаленных рабочих столов.<br/>                                                                                                                                                                       |
| [**Подключение**](imstscaxevents-onconnecting.md)                                         | Вызывается, когда клиентский элемент управления начинает подключаться к серверу в ответ на вызов [**имстскакс:: Connect**](imstscax-connect.md).<br/>                                                                                                                                               |
| [**онконнектионбарпуллдовн**](imstscaxevents-onconnectionbarpulldown.md)                   | Вызывается, когда пользователь перетаскивается на панель подключения.<br/>                                                                                                                                                                                                                       |
| [**ондевицесбуттонпрессед**](imstscaxevents-ondevicesbuttonpressed.md)                     | Вызывается при нажатии кнопки устройства на панели подключения.<br/>                                                                                                                                                                                                             |
| [**С отключением**](imstscaxevents-ondisconnected.md)                                     | Вызывается, когда клиентский элемент управления был отключен от сервера узла сеансов удаленных рабочих столов.<br/>                                                                                                                                                                                              |
| [**онентерфуллскринмоде**](imstscaxevents-onenterfullscreenmode.md)                       | Вызывается, когда клиент переходит в полноэкранный режим. Например, это событие вызывается при нажатии [пользователем сочетания клавиш](terminal-services-shortcut-keys.md) в полноэкранном режиме (Ctrl + Alt + Break).<br/>                                                                     |
| [**онфаталеррор**](imstscaxevents-onfatalerror.md)                                         | Вызывается, когда клиентский элемент управления обнаруживает неустранимую ошибку.<br/>                                                                                                                                                                                                                           |
| [**онфокусрелеасед**](imstscaxevents-onfocusreleased.md)                                   | Вызывается при нажатии сочетания клавиш для фокуса в выпуске. Например, это событие вызывается, когда пользователь нажимает клавишу CTRL + ALT + стрелка влево или сочетание клавиш CTRL + ALT + стрелка вправо.<br/>                                                                                             |
| [**онидлетимеаутнотификатион**](imstscaxevents-onidletimeoutnotification.md)               | Вызывается, когда пользователь не наводит мышь или клавиатуру в течение периода времени, заданного методом [**имсрдпклиентадванцедсеттингс::p UT \_ минутестоидлетимеаут**](imsrdpclientadvancedsettings-minutestoidletimeout.md) .<br/>                                                |
| [**онлеавефуллскринмоде**](imstscaxevents-onleavefullscreenmode.md)                       | Вызывается, когда клиент выходит из полноэкранного режима. Например, это событие вызывается при нажатии [пользователем сочетания клавиш](terminal-services-shortcut-keys.md) в полноэкранном режиме (Ctrl + Alt + Break).<br/>                                                                     |
| [**онлогинкомплете**](imstscaxevents-onlogincomplete.md)                                   | Вызывается, когда клиентский элемент управления успешно выполнил вход на сервер узла сеансов удаленных рабочих столов, следуя отображаемому в диалоговом окне входа в систему.<br/>                                                                                                                                      |
| [**онлогонеррор**](imstscaxevents-onlogonerror.md)                                         | Вызывается при возникновении ошибки входа в систему или другого события входа.<br/>                                                                                                                                                                                                                             |
| [**онмаусеинпутмодечанжед**](imstscaxevents-onmouseinputmodechanged.md)                   | Вызывается при изменении режима ввода с помощью мыши.<br/>                                                                                                                                                                                                                                      |
| [**оннетворкстатусчанжед**](imstscaxevents-onnetworkstatuschanged.md)                     | Вызывается при изменении состояния сети.<br/>                                                                                                                                                                                                                                        |
| [**онрецеиведтспубликкэй**](imstscaxevents-onreceivedtspublickey.md)                       | Вызывается во время последовательности подключения, когда клиент получает открытый ключ с сервера. Это событие вызывается, только если свойство **нотифитспубликкэй** имеет значение **Variant \_ true**.<br/>                                                                                              |
| [**онремотедесктопсизечанже**](imstscaxevents-onremotedesktopsizechange.md)               | Вызывается для указания того, что размер клиентского элемента управления в удаленном рабочем столе изменился в ответ на операцию клиентского управления.<br/>                                                                                                                                                |
| [**онремотепрограмдисплайед**](imstscaxevents-onremoteprogramdisplayed.md)                 | Вызывается при отображении программы RemoteApp.<br/>                                                                                                                                                                                                                                      |
| [**онремотепрограмресулт**](imstscaxevents-onremoteprogramresult.md)                       | Вызывается, когда программа RemoteApp возвращает результат в клиентский элемент управления.<br/>                                                                                                                                                                                                            |
| [**онремотевиндовдисплайед**](imstscaxevents-onremotewindowdisplayed.md)                   | Вызывается при отображении окна RemoteApp.<br/>                                                                                                                                                                                                                                       |
| [**онрекуестконтаинерминимизе**](imstscaxevents-onrequestcontainerminimize.md)             | Вызывается, когда пользователь нажимает кнопку **сворачивания** на панели подключения в полноэкранном режиме. Срабатывание этого события является запрос, в котором приложение контейнера свернется само по себе.<br/>                                                                                              |
| [**онрекуестгофуллскрин**](imstscaxevents-onrequestgofullscreen.md)                       | Вызывается, когда клиент запрашивает переключение в полноэкранный режим и вызывается метод [**имстскадванцедсеттингс::p UT \_ контаинерхандледфуллскрин**](imstscadvancedsettings-containerhandledfullscreen.md) , чтобы установить свойство **контаинерхандледфуллскрин** в ненулевое значение.<br/> |
| [**онрекуестлеавефуллскрин**](imstscaxevents-onrequestleavefullscreen.md)                 | Вызывается, когда клиент запрашивает, чтобы выйти из полноэкранного режима, а свойство [**имстскадванцедсеттингс::p UT \_ контаинерхандледфуллскрин**](imstscadvancedsettings-containerhandledfullscreen.md) установлено в ненулевое значение.<br/>                                                   |
| [**онсервицемессажерецеивед**](imstscaxevents-onservicemessagereceived.md)                 | Вызывается, когда клиент получает системное сообщение.<br/>                                                                                                                                                                                                                                  |
| [**онусернамеаккуиред**](imstscaxevents-onusernameacquired.md)                             | Вызывается, когда имя пользователя было получено элементом управления.<br/>                                                                                                                                                                                                                        |
| [**OnWarning**](imstscaxevents-onwarning.md)                                               | Вызывается, когда клиентский элемент управления обнаруживает неустранимое условие ошибки.<br/>                                                                                                                                                                                                    |
| [**RequestClose**](imsrdpclient-requestclose.md)                                           | Запрашивает корректное завершение работы клиентского элемента управления.<br/>                                                                                                                                                                                                                                |
| [**ресетпассворд**](imstscnonscriptable-resetpassword.md)                                  | Сбрасывает все состояния паролей в элементе управления.<br/>                                                                                                                                                                                                                                         |
| [**SendKeys**](imsrdpclientnonscriptable-sendkeys.md)                                      | Отправляет в элемент управления ряд нажатий клавиш. Нажатия клавиш находятся в форме кода сканирования, которая является данными клавиатуры из фактических физических ключей.<br/>                                                                                                                                       |
| [**сендонвиртуалчаннел**](imstscax-sendonvirtualchannel.md)                               | Отправляет данные на сервер узла сеансов удаленных рабочих столов по виртуальному каналу, созданному ранее с помощью метода [**имстскакс:: креатевиртуалчаннелс**](imstscax-createvirtualchannels.md) .<br/>                                                                                         |
| [**сетвиртуалчаннелоптионс**](imsrdpclient-setvirtualchanneloptions.md)                   | Задает параметры виртуального канала для клиентского элемента управления.<br/>                                                                                                                                                                                                                           |



 

### <a name="properties"></a>Свойства

Класс **MsRdpClient4a** имеет следующие свойства.



| Свойство                                                                                   | Тип доступа           | Описание                                                                                                                                                                                                  |
|:-------------------------------------------------------------------------------------------|:----------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**адванцедсеттингс**](imstscax-advancedsettings.md)<br/>                           | Только для чтения<br/>  | Указатель интерфейса [**имстскадванцедсеттингс**](imstscadvancedsettings-interface.md) .<br/>                                                                                                          |
| [**AdvancedSettings2**](imsrdpclient-advancedsettings2.md)<br/>                     | Только для чтения<br/>  | Указатель на интерфейс [**имсрдпклиентадванцедсеттингс**](imsrdpclientadvancedsettings-interface.md) , используемый для задания дополнительных параметров клиентского элемента управления.<br/>                                    |
| [**AdvancedSettings3**](imsrdpclient2-advancedsettings3.md)<br/>                    | Только для чтения<br/>  | Указатель на интерфейс [**IMsRdpClientAdvancedSettings2**](imsrdpclientadvancedsettings2.md) , используемый для задания дополнительных параметров клиентского элемента управления.<br/>                                            |
| [**AdvancedSettings4**](imsrdpclient3-advancedsettings4.md)<br/>                    | Только для чтения<br/>  | Указатель на интерфейс [**IMsRdpClientAdvancedSettings3**](imsrdpclientadvancedsettings3.md) , используемый для задания дополнительных параметров клиентского элемента управления.<br/>                                            |
| [**AdvancedSettings5**](imsrdpclient4-advancedsettings5.md)<br/>                    | Только для чтения<br/>  | Указатель интерфейса [**IMsRdpClientAdvancedSettings4**](imsrdpclientadvancedsettings4.md) .<br/>                                                                                                      |
| [**бинарипассворд**](imstscnonscriptable-binarypassword.md)<br/>                    | Чтение/запись<br/> | Данное свойство не поддерживается.<br/>                                                                                                                                                                   |
| [**бинарисалт**](imstscnonscriptable-binarysalt.md)<br/>                            | Чтение/запись<br/> | Данное свойство не поддерживается.<br/>                                                                                                                                                                   |
| [**Циферстренгс**](imstscax-cipherstrength.md)<br/>                               | Только для чтения<br/>  | Максимальная стойкость шифрования текущего элемента управления.<br/>                                                                                                                                           |
| [**клеартекстпассворд**](imstscnonscriptable-cleartextpassword.md)<br/>              | Только на запись<br/> | Удаленный рабочий стол пароль элемента управления ActiveX в текстовом формате.<br/>                                                                                                                                 |
| [**Clientareawidth**](imsrdpclient-colordepth.md)<br/>                                   | Чтение/запись<br/> | Глубина цвета текущего элемента управления.<br/>                                                                                                                                                               |
| [**Подключен**](imstscax-connected.md)<br/>                                         | Только для чтения<br/>  | Состояние соединения текущего элемента управления.<br/>                                                                                                                                                      |
| [**коннектедстатустекст**](imsrdpclient2-connectedstatustext.md)<br/>                | Чтение/запись<br/> | Текст, отображаемый в клиентской области элемента управления, когда элемент управления находится в состоянии Connected.<br/>                                                                                             |
| [**коннектингтекст**](imstscax-connectingtext.md)<br/>                               | Чтение/запись<br/> | Текст, отображаемый по центру элемента управления во время подключения элемента управления.<br/>                                                                                                                    |
| [**десктофеигхт**](imstscax-desktopheight.md)<br/>                                 | Чтение/запись<br/> | Высота текущего элемента управления (в пикселях) на начальном удаленном рабочем столе.<br/>                                                                                                                           |
| [**десктопвидс**](imstscax-desktopwidth.md)<br/>                                   | Чтение/запись<br/> | Ширина текущего элемента управления (в пикселях) на начальном удаленном рабочем столе.<br/>                                                                                                                            |
| [**дисконнектедтекст**](imstscax-disconnectedtext.md)<br/>                           | Чтение/запись<br/> | Текст, отображаемый по центру элемента управления до завершения соединения.<br/>                                                                                                                  |
| [**Домен**](imstscax-domain.md)<br/>                                               | Чтение/запись<br/> | Домен, в который входит текущий пользователь.<br/>                                                                                                                                                     |
| [**екстендеддисконнектреасон**](imsrdpclient-extendeddisconnectreason.md)<br/>       | Только для чтения<br/>  | Расширенные сведения о причине отключения клиентского элемента управления.<br/>                                                                                                                         |
| [**FullScreen**](imsrdpclient-fullscreen.md)<br/>                                   | Чтение/запись<br/> | Указывает, находится ли элемент управления в полноэкранном режиме.<br/>                                                                                                                                             |
| [**фуллскринтитле**](imstscax-fullscreentitle.md)<br/>                             | Только на запись<br/> | Заголовок окна, отображаемый, если элемент управления находится в полноэкранном режиме.<br/>                                                                                                                               |
| [**хоризонталскроллбарвисибле**](imstscax-horizontalscrollbarvisible.md)<br/>       | Только для чтения<br/>  | Указывает, отображает ли элемент управления горизонтальную полосу прокрутки.<br/>                                                                                                                              |
| [**портаблепассворд**](imstscnonscriptable-portablepassword.md)<br/>                | Чтение/запись<br/> | Данное свойство не поддерживается.<br/>                                                                                                                                                                   |
| [**портаблесалт**](imstscnonscriptable-portablesalt.md)<br/>                        | Чтение/запись<br/> | Данное свойство не поддерживается.<br/>                                                                                                                                                                   |
| [**секуредсеттингс**](imstscax-securedsettings.md)<br/>                             | Только для чтения<br/>  | Указатель интерфейса [**имстсксекуредсеттингс**](imstscsecuredsettings-interface.md) .<br/>                                                                                                             |
| [**SecuredSettings2**](imsrdpclient-securedsettings2.md)<br/>                       | Только для чтения<br/>  | Указатель на интерфейс [**имсрдпклиентсекуредсеттингс**](imsrdpclientsecuredsettings-interface.md) , используемый для задания защищенных параметров клиентского элемента управления.<br/>                                       |
| [**секуредсеттингсенаблед**](imstscax-securedsettingsenabled.md)<br/>               | Только для чтения<br/>  | Указывает, доступен ли интерфейс [**имстсксекуредсеттингс**](imstscsecuredsettings-interface.md) .<br/>                                                                                    |
| [**Сервером**](imstscax-server.md)<br/>                                               | Чтение/запись<br/> | Имя сервера, к которому подключен текущий элемент управления.<br/>                                                                                                                                 |
| [**стартконнектед**](imstscax-startconnected.md)<br/>                               | Чтение/запись<br/> | Указывает, будет ли элемент управления устанавливать соединение с сервером узла сеансов удаленных рабочих столов сразу после запуска.<br/>                                                                                      |
| [**уипарентвиндовхандле**](imsrdpclientnonscriptable2-uiparentwindowhandle.md)<br/> | Чтение/запись<br/> | Маркер окна, который будет родительским окном для элемента управления. Это позволяет корректно модальным окнам, отображаемым элементом управления, по отношению к любым окнам, отображаемым родительским приложением.<br/> |
| [**Имен**](imstscax-username.md)<br/>                                           | Чтение/запись<br/> | Учетные данные имени пользователя для входа.<br/>                                                                                                                                                                   |
| [**Версия**](imstscax-version.md)<br/>                                             | Только для чтения<br/>  | Номер версии текущего элемента управления.<br/>                                                                                                                                                        |
| [**вертикалскроллбарвисибле**](imstscax-verticalscrollbarvisible.md)<br/>           | Только для чтения<br/>  | Указывает, отображает ли элемент управления вертикальную полосу прокрутки.<br/>                                                                                                                                     |



 

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|----------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows Vista<br/>                                                               |
| Минимальная версия сервера<br/> | Windows Server 2008<br/>                                                         |
| Библиотека типов<br/>             | <dl> <dt>MsTscAx.dll</dt> </dl> |
| DLL<br/>                      | <dl> <dt>MsTscAx.dll</dt> </dl> |
| CLSID<br/>                    | \_MSRDPCLIENT4A CLSID определен как 54CE37E0-9834-41AE-9896-4DAB69DC022B<br/>     |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[удаленный рабочий стол классов элементов управления ActiveX](remote-desktop-activex-control-classes.md)
</dt> </dl>

 

