---
title: Активация сеанса в сеансе с моникером сеанса
description: Активация между сеансами (также называемая межсеансией активации) позволяет клиентскому процессу запускать (активировать) процесс локального сервера в указанном сеансе.
ms.assetid: d405c276-040b-4cde-aeb2-482a25e2867f
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 213627facdd2dee9e4ba7cc698d2be5455424b4394d295448a07aeb52788dd42
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119988134"
---
# <a name="session-to-session-activation-with-a-session-moniker"></a>Активация сеанса в сеансе с моникером сеанса

Активация между сеансами (также называемая межсеансией активации) позволяет клиентскому процессу запускать (активировать) процесс локального сервера в указанном сеансе. Эта функция доступна для приложений, настроенных для запуска в контексте безопасности интерактивного пользователя, также известного как режим активации "Интерактивный пользователь запуска от имени". Дополнительные сведения о контекстах безопасности см. в описании [контекста безопасности клиента](/windows/desktop/SecAuthZ/the-client-security-context).

Распределенная модель COM (DCOM) обеспечивает активацию объектов для каждого сеанса с помощью предоставленного системой [моникера сеанса](session-monikers.md). Другие предоставляемые системой моникеры включают [моникеры файлов](../com/file-monikers.md), [моникеры элементов](../com/item-monikers.md), универсальные [Составные моникеры](../com/composite-monikers.md), [средства защиты от](../com/anti-monikers.md)моникеров, [моникеры указателей](../com/pointer-monikers.md)и [моникеры URL-адресов](../com/url-monikers.md).

Чтобы иметь возможность использовать моникер сеанса, приложение DCOM должно быть настроено для запуска от имени интерактивного пользователя. Это можно задать с помощью средства администрирования "службы компонентов", просмотра свойств приложения DCOM и выбора **интерактивного пользователя** на вкладке **удостоверение** . Дополнительные сведения о возможных угрозах безопасности, связанных с настройкой DCOM-приложения для запуска в качестве интерактивного пользователя в среде службы удаленных рабочих столов, см. в разделе "удостоверение приложения (COM)" документации по COM в пакете SDK для платформы.

Если для запуска приложения выбран какой-либо другой тип пользователя, моникер сеанса будет игнорироваться приложением. Моникер сеанса также игнорируется серверными приложениями COM+. Дополнительные сведения о других способах выбора типа пользователя для запуска приложения см. в документации по COM в пакете Platform SDK.

Чтобы создать моникер сеанса, необходимо составить идентификатор сеанса службы удаленных рабочих столов сеанса с моникером класса, который указывает идентификатор класса сервера обработки.

**Создание моникера сеанса**

1.  Добавьте перед отображаемым именем моникера класса отображаемое имя моникера сеанса, используя следующий синтаксис:

    ``` syntax
    "Session:[digits]!clsid:[class id]"
    ```

    где *digits* представляет идентификатор сеанса, в котором будет запущен серверный процесс, и где *идентификатор класса* представляет идентификатор класса сервера. Обратите внимание, что идентификатор сеанса — это номер основания 10.

    для компьютеров, работающих под управлением Windows XP или более поздней версии, при использовании следующего синтаксиса COM отправляет активацию в текущий активный сеанс физической консоли, независимо от его идентификатора сеанса:

    ``` syntax
    "Session:Console!clsid:[class id]"
    ```

2.  После создания моникера сеанса можно передать результат в функцию [**мкпарседисплайнаме**](/windows/desktop/api/objbase/nf-objbase-mkparsedisplayname) или функцию [мкпарседисплайнамикс](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/ms775113(v=vs.85)) .

Моникер сеанса можно использовать так же, как и любой другой моникер.

Пример кода, демонстрирующий активацию локального серверного процесса в указанном сеансе, см. в разделе [Использование моникера сеанса](using-a-session-moniker.md).

Дополнительные сведения об активации объектов, предоставляемых системой моникерах и моникерах классов см. в документации по COM в пакете Platform SDK.

> [!Note]  
> Процессы, создаваемые во всех сеансах, имеют верхний предел размера блока среды. Это ограничение составляет около 4 КБ, но может быть больше или меньше в зависимости от того, какие другие сведения необходимы для создания процесса (например, имена файлов, каталоги и параметры для нового процесса).

 

 

 