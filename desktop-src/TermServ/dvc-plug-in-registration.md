---
title: Регистрация подключаемого модуля DVC
description: Описание синтаксиса для записи подключаемого модуля динамического виртуального канала (DVC) для клиента подключение к удаленному рабочему столу (RDC).
ms.assetid: cda4f8c9-867a-41ac-894a-4296d5912b2b
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 88d3660b4d9c704c9a59335cede886085f13414991dc2dc913185d407e0a3c54
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119515531"
---
# <a name="dvc-plug-in-registration"></a>Регистрация подключаемого модуля DVC

Подключаемый модуль динамического виртуального канала (DVC) регистрируется для использования клиентом подключение к удаленному рабочему столу (RDC) с помощью одного из следующих методов.

-   вызов метода [**имстскадванцедсеттингс::p ut \_ плугиндллс**](imstscadvancedsettings-plugindlls.md) ActiveX элемента управления протокол удаленного рабочего стола (RDP). Несколько записей должны быть разделены запятыми.
-   Запись подключаемого модуля находится в следующем расположении в реестре на компьютере, где запущен клиентский процесс подключение к удаленному рабочему столу (RDC):

    **HKey \_ Текущее \_ пользовательское** \\ **по** \\  \\  \\ **по умолчанию** клиент сервера терминалов Майкрософт \\ **надстройка** \\ **_уникальное имя подключаемого модуля_**

    > [!Note]  
    > Необходимо создать подраздел *имени подключаемого модуля Unique* , если он не существует. Уникальное имя подраздела *имени подключаемого модуля* — это произвольная строка, которая может опознать подключаемый модуль. Строка может быть любым сочетанием символов.

     

    В разделе *уникальное имя подключаемого модуля* необходимо добавить запись, которая идентифицирует подключаемый модуль.

    Имя записи = **имя**

    Тип данных = **reg \_ SZ** или **reg \_ expand \_ SZ**

В обоих случаях значение записи должно соответствовать одному из следующих форматов:

<dl> <dt>

<span id="Plug-inDLLName__CLSID_"></span><span id="plug-indllname__clsid_"></span><span id="PLUG-INDLLNAME__CLSID_"></span>"*Plug-индллнаме*: {*CLSID*}"
</dt> <dd>

подключаемый модуль не обязательно регистрируется в реестре Windows как объект модели com, но библиотека DLL реализуется как внутрипроцессный com-объект. Клиент RDC загрузит библиотеку DLL, указанную в параметре *Plug-индллнаме* , и получите COM-объект непосредственно с помощью *CLSID*.

</dd> <dt>

<span id="Plug-inDLLName"></span><span id="plug-indllname"></span><span id="PLUG-INDLLNAME"></span>"*Plug-индллнаме*"
</dt> <dd>

Библиотека DLL реализует функцию [**виртуалчаннелжетинстанце**](virtualchannelgetinstance.md) и экспортирует ее по имени. Клиент RDC будет использовать функцию **виртуалчаннелжетинстанце** для получения указателей на интерфейс [**ивтсплугин**](/windows/desktop/api/TsVirtualChannels/nn-tsvirtualchannels-iwtsplugin) для всех подключаемых модулей, реализованных библиотекой DLL.

</dd> <dt>

<span id="_CLSID_"></span><span id="_clsid_"></span>"{*CLSID*}"
</dt> <dd>

Клиент RDC создает экземпляр подключаемого модуля как обычный COM-объект, используя [**CoCreateInstance**](/windows/desktop/api/combaseapi/nf-combaseapi-cocreateinstance) с *идентификатором CLSID*.

</dd> </dl>

> [!Note]  
> *Plug-индллнаме* представляет полный путь и имя файла .dll. Если тип данных — **\_ \_ SZ**, путь может содержать неразвернутые переменные среды, которые расширяются во время выполнения.

 

Когда клиент подключение к удаленному рабочему столу (RDC) завершает свою инициализацию, он выполняет следующие действия для каждого зарегистрированного подключаемого модуля.

1.  Получите экземпляр интерфейса [**ивтсплугин**](/windows/desktop/api/TsVirtualChannels/nn-tsvirtualchannels-iwtsplugin) для каждого подключаемого модуля, используя один из методов, описанных выше.
2.  Вызовите метод [**Initialize**](/windows/desktop/api/TsVirtualChannels/nf-tsvirtualchannels-iwtsplugin-initialize) каждого интерфейса [**ивтсплугин**](/windows/desktop/api/TsVirtualChannels/nn-tsvirtualchannels-iwtsplugin) .
3.  Если клиент подключается несколько раз к одному и тому же или к другому серверу, может существовать несколько вызовов [**подключенных**](/windows/desktop/api/TsVirtualChannels/nf-tsvirtualchannels-iwtsplugin-connected) и [**отключенных**](/windows/desktop/api/TsVirtualChannels/nf-tsvirtualchannels-iwtsplugin-disconnected) методов.
4.  Последний вызов, который должен быть связан с подключаемым модулем, [**завершается**](/windows/desktop/api/TsVirtualChannels/nf-tsvirtualchannels-iwtsplugin-terminated). Это сигнал о том, что клиент подключение к удаленному рабочему столу (RDC) собирается выгрузить подключаемый модуль.

 

 