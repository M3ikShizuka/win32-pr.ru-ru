---
title: Хранение сведений, относящихся к пользователю
description: Приложения должны хранить данные пользователя в определенных пользователем расположениях отдельно от глобальной информации, которая относится ко всем пользователям.
ms.assetid: 32bd1d24-1d2e-4c0a-acdb-0cc67f275e6e
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 40c6236b7ba11a8b3149533e920b9b9413085d93
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104070168"
---
# <a name="storing-user-specific-information"></a>Хранение сведений, относящихся к пользователю

В среде службы удаленных рабочих столов приложения должны хранить сведения, относящиеся к пользователю, в пользовательских расположениях отдельно от глобальных сведений, которые применяются ко всем пользователям. Это правило применяется к информации, хранящейся в реестре, а также к информации, хранящейся в файлах. Как правило, не следует рассчитывать на то, что один компьютер эквивалентен одному пользователю.

Храните пользовательские данные реестра в разделе реестра **hKey \_ Current \_ User** . Службы удаленных рабочих столов загружает в раздел **hKey \_ текущего \_** пользователя куст реестра для текущего пользователя при входе пользователя в систему. Разумеется, службы удаленных рабочих столов управляет реестром для того, чтобы каждый вошедший в систему клиент обнаружил правильный куст пользователя в разделе **hKey \_ текущий \_ пользователь**. Дополнительные сведения о разделах реестра см. в разделах [Реестр безопасность и права доступа](/windows/desktop/SysInfo/registry-key-security-and-access-rights) и [кусты реестра](/windows/desktop/SysInfo/registry-hives).

В отличие от этого, все пользователи совместно используют куст **\_ локального \_ компьютера hKey** . Используйте **hKey \_ локальный \_ компьютер** для хранения сведений о компьютере, а не сведений, относящихся к пользователю.

Храните файлы предпочтений пользователя или другие пользовательские файлы в корневом каталоге пользователя или в каталоге, указанном пользователем. Это относится к временным файлам, используемым для хранения промежуточной информации (например, кэшированных данных), или для передачи данных в другое приложение. Временные файлы отдельных пользователей также должны храниться отдельно для каждого пользователя.

[](/windows/desktop/api/shlobj_core/nf-shlobj_core-shgetspecialfolderlocation) \_ Для получения расположения каталога личных файлов пользователя можно использовать функцию шжетспеЦиалфолдерлокатион с флагом CSid (личный). Для получения пути к каталогу Windows можно также использовать функцию [**жетвиндовсдиректори**](/windows/desktop/api/sysinfoapi/nf-sysinfoapi-getwindowsdirectorya) . В среде службы удаленных рабочих столов каталог Windows гарантированно является частным для каждого пользователя. Не храните файлы отдельных пользователей в системном каталоге, например WINDOWS или каталоге программы, например программных файлах.

Во избежание конфликтов между данными и предпочтениями пользователей приложения должны хранить временные данные отдельных пользователей в отдельных временных файлах. Временные файлы отдельных пользователей также предотвращают сбои приложений, вызванные конфликтом блокировки файлов. Чтобы указать путь для хранения временных данных, используйте функцию [**жеттемппас**](/windows/desktop/api/fileapi/nf-fileapi-gettemppatha) .

 

 