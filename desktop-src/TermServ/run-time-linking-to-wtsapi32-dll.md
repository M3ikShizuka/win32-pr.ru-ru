---
title: Run-Time связывания с Wtsapi32.dll
description: Приложение может использовать службы удаленных рабочих столов API для динамической привязки к Wtsapi32.dll во время выполнения. Для этого приложение должно вызвать функцию LoadLibrary для загрузки Wtsapi32.dll.
ms.assetid: b8227e65-be08-4045-a74e-dd3f398a7b9f
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c53a992955876bf812a87168d2c74b776cf0d4e6
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127374541"
---
# <a name="run-time-linking-to-wtsapi32dll"></a>Run-Time связывания с Wtsapi32.dll

Если приложение работает в среде, которая не является средой службы удаленных рабочих столов, но требуется, чтобы приложение предоставляющо дополнительные функциональные возможности при запуске в среде службы удаленных рабочих столов, приложение может использовать API службы удаленных рабочих столов для реализации дополнительных функций и динамически связываться с Wtsapi32.dll во время выполнения. Для этого приложение должно вызвать функцию [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) для загрузки Wtsapi32.dll. В случае сбоя вызова **LoadLibrary** приложение может выполняться с использованием базовых функций. Если **LoadLibrary** выполняется, приложение может вызвать функцию [**GetProcAddress**](/windows/desktop/api/libloaderapi/nf-libloaderapi-getprocaddress) для получения указателей на службы удаленных рабочих столов функции, которые необходимо вызвать.

Если приложение предназначено только для среды службы удаленных рабочих столов, динамическая компоновка не требуется. В этом случае можно включить Wtsapi32. h и связать с Wtsapi32. lib. Затем, если приложение запускается в среде, отличной от службы удаленных рабочих столов, она будет закрыта, так как отсутствует Wtsapi32.dll.

Сведения о том, как определить, выполняется ли приложение в среде службы удаленных рабочих столов, см. в разделе [Обнаружение среды службы удаленных рабочих столов](detecting-the-terminal-services-environment.md).

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Общие рекомендации по программированию](general-programming-guidelines.md)
</dt> </dl>

 

 