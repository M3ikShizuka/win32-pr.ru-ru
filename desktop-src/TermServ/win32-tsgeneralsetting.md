---
title: Класс Win32_TSGeneralSetting
description: Представляет общие параметры терминала, такие как уровень шифрования и транспортный протокол.
ms.assetid: a31d68c0-e446-4d78-85e0-5173e7870255
ms.tgt_platform: multiple
keywords:
- Класс Win32_TSGeneralSetting службы удаленных рабочих столов
- Службы удаленных рабочих столов класса Win32_TSGeneralSetting, описание
topic_type:
- apiref
api_name:
- Win32_TSGeneralSetting
- Win32_TSGeneralSetting.Caption
- Win32_TSGeneralSetting.Description
- Win32_TSGeneralSetting.InstallDate
- Win32_TSGeneralSetting.Name
- Win32_TSGeneralSetting.Status
- Win32_TSGeneralSetting.TerminalName
- Win32_TSGeneralSetting.CertificateName
- Win32_TSGeneralSetting.Certificates
- Win32_TSGeneralSetting.Comment
- Win32_TSGeneralSetting.MinEncryptionLevel
- Win32_TSGeneralSetting.PolicySourceMinEncryptionLevel
- Win32_TSGeneralSetting.PolicySourceSecurityLayer
- Win32_TSGeneralSetting.PolicySourceUserAuthenticationRequired
- Win32_TSGeneralSetting.SecurityLayer
- Win32_TSGeneralSetting.SSLCertificateSHA1Hash
- Win32_TSGeneralSetting.SSLCertificateSHA1HashType
- Win32_TSGeneralSetting.TerminalProtocol
- Win32_TSGeneralSetting.Transport
- Win32_TSGeneralSetting.UserAuthenticationRequired
- Win32_TSGeneralSetting.WindowsAuthentication
api_location:
- TSCfgWmi.dll
api_type:
- DllExport
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 172f18bbddd364d74dfcfb00e7e665628267af36
ms.sourcegitcommit: a1494c819bc5200050696e66057f1020f5b142cb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2020
ms.locfileid: "103802482"
---
# <a name="win32_tsgeneralsetting-class"></a>\_Класс Win32 тсженералсеттинг

Класс **WMI \_ Тсженералсеттинг для Win32** представляет общие параметры терминала, такие как уровень шифрования и транспортный протокол.

Следующий синтаксис упрощен из MOF-кода и включает все определенные и унаследованные свойства в алфавитном порядке. Справочные сведения о методах см. в таблице методов далее в этом разделе.

## <a name="syntax"></a>Синтаксис

``` syntax
[dynamic, provider("Win32_WIN32_TSGENERALSETTING_Prov"), ClassContext("local|hkey_local_machine\\SYSTEM\\CurrentControlSet\\Control\\TerminalServer\\WinStations"), AMENDMENT]
class Win32_TSGeneralSetting : Win32_TerminalSetting
{
  string   Caption;
  string   Description;
  datetime InstallDate;
  string   Name;
  string   Status;
  string   TerminalName;
  string   CertificateName;
  uint8    Certificates[];
  string   Comment;
  uint32   MinEncryptionLevel;
  uint32   PolicySourceMinEncryptionLevel;
  uint32   PolicySourceSecurityLayer;
  uint32   PolicySourceUserAuthenticationRequired;
  uint32   SecurityLayer;
  string   SSLCertificateSHA1Hash;
  uint32   SSLCertificateSHA1HashType;
  string   TerminalProtocol;
  string   Transport;
  uint32   UserAuthenticationRequired;
  uint32   WindowsAuthentication;
};
```

## <a name="members"></a>Члены

Класс **Win32 \_ тсженералсеттинг** имеет следующие типы членов:

-   [Методы](#methods)
-   [Свойства](#properties)

### <a name="methods"></a>Методы

Класс **Win32 \_ тсженералсеттинг** содержит следующие методы.



| Метод                                                                                        | Описание                                                                                                                                                             |
|:----------------------------------------------------------------------------------------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**сетенкриптионлевел**](win32-tsgeneralsetting-setencryptionlevel.md)                       | Задает уровень шифрования.<br/>                                                                                                                                   |
| [**сетсекуритилайер**](win32-tsgeneralsetting-setsecuritylayer.md)                           | Устанавливает для уровня безопасности один из параметров: "уровень безопасности RDP" (0), "Negotiate" (1) или "SSL" (2).<br/>                                                                   |
| [**сетусераусентикатионрекуиред**](setuserauthenticationrequired-win32-tsgeneralsetting.md) | Включает или отключает требование, которое пользователи должны пройти проверку подлинности во время соединения, задав значение свойства **усераусентикатионрекуиред** .<br/> |



 

### <a name="properties"></a>Свойства

Класс **Win32 \_ тсженералсеттинг** имеет следующие свойства.

<dl> <dt>

**Заголовок**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: только для чтения
</dt> <dt>

Квалификаторы: [**maxlen**](/windows/desktop/WmiSdk/standard-qualifiers) (64)
</dt> </dl>

Краткое описание (однострочная строка) объекта.

Это свойство наследуется от [**CIM \_ манажедсистемелемент**](cim-managedsystemelement.md).

</dd> <dt>

**CertificateName**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Отображаемое имя для имени субъекта личного сертификата локального компьютера.

</dd> <dt>

**Сертификаты**
</dt> <dd> <dl> <dt>

Тип данных: массив **Uint8**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Содержит сериализованное хранилище сертификатов, содержащее все сертификаты из хранилища **учетных записей пользователей** на компьютере, которые являются действительными сертификатами сервера для использования с протоколом SSL.

</dd> <dt>

**Комментарий**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: чтение и запись
</dt> </dl>

Описательное имя сочетания уровня сеанса и транспортного протокола.

</dd> <dt>

**Описание**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Описание объекта.

Это свойство наследуется от [**CIM \_ манажедсистемелемент**](cim-managedsystemelement.md).

</dd> <dt>

**InstallDate**
</dt> <dd> <dl> <dt>

Тип данных: **DateTime**
</dt> <dt>

Тип доступа: только для чтения
</dt> <dt>

Квалификаторы: [**маппингстрингс**](/windows/desktop/WmiSdk/standard-qualifiers) (MIF. \|Значение ComponentID \| 001,5 в DMTF
</dt> </dl>

Дата установки объекта. Отсутствие значения не означает, что объект не установлен.

Это свойство наследуется от [**CIM \_ манажедсистемелемент**](cim-managedsystemelement.md).

</dd> <dt>

**миненкриптионлевел**
</dt> <dd> <dl> <dt>

Тип данных: **UInt32**
</dt> <dt>

Тип доступа: только для чтения
</dt> <dt>

Квалификаторы: **низкий** ("только данные, отправленные с клиента на сервер, защищаются с помощью шифрования на основе силы стандартного ключа сервера. Данные, отправляемые с сервера на клиент, не защищены. "), **Medium** (" все данные, передаваемые между сервером и клиентом, защищаются с помощью шифрования на основе стандартной силы ключа сервера ")," **высокий** "(" все данные, передаваемые между сервером и клиентом "защищены с помощью максимальной силы ключа сервера на основе шифрования").
</dt> </dl>

Минимальный уровень шифрования.

<dt>

<span id="Low"></span><span id="low"></span><span id="LOW"></span>

<span id="Low"></span><span id="low"></span><span id="LOW"></span>**Низкая** (1)


</dt> <dd>

Низкий уровень шифрования. С помощью 56-разрядного шифрования шифруются только данные, отправленные с клиента на сервер. Учтите, что данные, отправляемые с сервера клиенту, не шифруются.

</dd> <dt>

<span id="Medium___Client_Compatible"></span><span id="medium___client_compatible"></span><span id="MEDIUM___CLIENT_COMPATIBLE"></span>

<span id="Medium___Client_Compatible"></span><span id="medium___client_compatible"></span><span id="MEDIUM___CLIENT_COMPATIBLE"></span>**Средний/совместимый с клиентом** (2)


</dt> <dd>

Совместимый с клиентом уровень шифрования. Все данные, отправляемые от клиента серверу и от сервера к клиенту, шифруются по максимальному ключу, поддерживаемому клиентом.

</dd> <dt>

<span id="High"></span><span id="high"></span><span id="HIGH"></span>

<span id="High"></span><span id="high"></span><span id="HIGH"></span>**Высокий** (3)


</dt> <dd>

Высокий уровень шифрования. Все данные, отправленные с клиента на сервер и с сервера на клиент, шифруются с помощью надежного 128-разрядного шифрования. Клиенты, не поддерживающие этот уровень шифрования, не могут подключиться.

</dd> <dt>

<span id="FIPS_Compliant"></span><span id="fips_compliant"></span><span id="FIPS_COMPLIANT"></span>

<span id="FIPS_Compliant"></span><span id="fips_compliant"></span><span id="FIPS_COMPLIANT"></span>**FIPS-совместимый** (4)


</dt> <dd>

Шифрование, совместимое с FIPS. Все данные, отправляемые от клиента серверу и от сервера к клиенту, шифруются и расшифровываются с помощью алгоритмов шифрования FIPS, использующих криптографические модули (Майкрософт). FIPS — это стандартное право «требования безопасности для криптографических модулей». FIPS 140-1 (1994) и FIPS 140-2 (2001) описывают требования правительства для аппаратных и программных криптографических модулей, используемых в правительственных учреждениях США.

</dd> </dl>

</dd> <dt>

**Name**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Имя объекта.

Это свойство наследуется от [**CIM \_ манажедсистемелемент**](cim-managedsystemelement.md).

</dd> <dt>

**полицисаурцеминенкриптионлевел**
</dt> <dd> <dl> <dt>

Тип данных: **UInt32**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Указывает, настроено ли свойство **миненкриптионлевел** сервером по групповой политике или по умолчанию.

<dt>

0 (0x0)
</dt> <dd>

Сервер

</dd> <dt>

1 (0x1)
</dt> <dd>

Групповая политика

</dd> <dt>

2 (0x2)
</dt> <dd>

Значение по умолчанию

</dd> </dl>

</dd> <dt>

**полицисаурцесекуритилайер**
</dt> <dd> <dl> <dt>

Тип данных: **UInt32**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Указывает, настроено ли свойство **секуритилайер** сервером по групповой политике или по умолчанию.

<dt>

0 (0x0)
</dt> <dd>

Сервер

</dd> <dt>

1 (0x1)
</dt> <dd>

Групповая политика

</dd> <dt>

2 (0x2)
</dt> <dd>

Значение по умолчанию

</dd> </dl>

</dd> <dt>

**полицисаурцеусераусентикатионрекуиред**
</dt> <dd> <dl> <dt>

Тип данных: **UInt32**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Указывает, настроено ли свойство **усераусентикатионрекуиред** сервером по групповой политике или по умолчанию.

<dt>

0 (0x0)
</dt> <dd>

Сервер

</dd> <dt>

1 (0x1)
</dt> <dd>

Групповая политика

</dd> <dt>

2 (0x2)
</dt> <dd>

Значение по умолчанию

</dd> </dl>

</dd> <dt>

**секуритилайер**
</dt> <dd> <dl> <dt>

Тип данных: **UInt32**
</dt> <dt>

Тип доступа: только для чтения
</dt> <dt>

Квалификаторы: **рдпсекуритилайер** ("уровень безопасности RDP: обмен данными между серверанд, который клиент будет использовать как собственное шифрование RDP"), **согласовывать** ("наиболее безопасный уровень, поддерживаемый клиентом, будет использоваться. Если поддерживается, будет использоваться протокол TLS 1,0. "), **SSL** (" SSL (TLS 1,0) "будет использоваться для проверки подлинности сервера, а также форенкриптинг все данные, передаваемые между сервером и клиентом. Для этого параметра требуется, чтобы сервер имел сертификат, совместимый с SSL. "), **невтбд** (" новый уровень безопасности в LONGHORN ").
</dt> </dl>

Указывает уровень безопасности, используемый между клиентом и сервером.

<dt>

<span id="RDP_Security_Layer"></span><span id="rdp_security_layer"></span><span id="RDP_SECURITY_LAYER"></span>

<span id="RDP_Security_Layer"></span><span id="rdp_security_layer"></span><span id="RDP_SECURITY_LAYER"></span>**Уровень безопасности RDP** (1)


</dt> <dd>

При обмене данными между сервером и клиентом используется собственное шифрование RDP.

</dd> <dt>

<span id="Negotiate"></span><span id="negotiate"></span><span id="NEGOTIATE"></span>

<span id="Negotiate"></span><span id="negotiate"></span><span id="NEGOTIATE"></span>**Согласование** (2)


</dt> <dd>

Используется наиболее безопасный уровень, поддерживаемый клиентом. Если поддерживается, используется протокол SSL (TLS 1,0).

</dd> <dt>

<span id="SSL"></span><span id="ssl"></span>

<span id="SSL"></span><span id="ssl"></span>**SSL** (3)


</dt> <dd>

Протокол SSL (TLS 1,0) используется для проверки подлинности сервера и для шифрования всех данных, передаваемых между сервером и клиентом. Для этого параметра требуется, чтобы сервер имел сертификат, совместимый с SSL. Этот параметр несовместим со значением **миненкриптионлевел** , равное 1.

</dd> <dt>

<span id="NEWTBD"></span><span id="newtbd"></span>

<span id="NEWTBD"></span><span id="newtbd"></span>**Невтбд** (4)


</dt> <dd>

Новый уровень безопасности.

</dd> </dl>

</dd> <dt>

**SSLCertificateSHA1Hash**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: чтение и запись
</dt> </dl>

Указывает хэш SHA1 в шестнадцатеричном формате SSL-сертификата, который будет использоваться целевым сервером.

Отпечаток сертификата можно найти с помощью оснастки MMC "сертификаты" на вкладке "сведения" на странице свойств сертификата.

</dd> <dt>

**SSLCertificateSHA1HashType**
</dt> <dd> <dl> <dt>

Тип данных: **UInt32**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Указывает состояние свойства **SSLCertificateSHA1Hash** .

<dt>

0 (0x0)
</dt> <dd>

Недопустимый

</dd> <dt>

1 (0x1)
</dt> <dd>

Самозаверяющий по умолчанию

</dd> <dt>

2 (0x2)
</dt> <dd>

Применение групповой политики по умолчанию

</dd> <dt>

3 (0x3)
</dt> <dd>

Особые настройки

</dd> </dl>

</dd> <dt>

**Состояние**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: только для чтения
</dt> <dt>

Квалификаторы: [**maxlen**](/windows/desktop/WmiSdk/standard-qualifiers) (10)
</dt> </dl>

Текущее состояние объекта. Можно определить различные операционные и неоперационные состояния. Рабочие состояния включают: "ОК", "деградация" и "пред-ошибка" (элемент, например жесткий диск с поддержкой SMART, может работать правильно, но прогнозировать сбой в ближайшем будущем). Неработающие состояния включают: "ошибка", "Запуск", "остановка" и "служба". Последняя, «служба», может применяться во время зеркального копирования диска, перезагрузки списка разрешений пользователя или другой административной работы. Не вся такая работа выполняется в интерактивном состоянии, но управляемый элемент не является ни "ОК", ни одним из других состояний.

Это свойство наследуется от [**CIM \_ манажедсистемелемент**](cim-managedsystemelement.md).

<dt>



 ("ОК")


</dt> <dd></dd> <dt>



 ("Ошибка")


</dt> <dd></dd> <dt>



 ("Пониженное состояние")


</dt> <dd></dd> <dt>



 ("Неизвестно")


</dt> <dd></dd> <dt>



 ("Пред Fail")


</dt> <dd></dd> <dt>



 ("Запуск")


</dt> <dd></dd> <dt>



 ("Остановка")


</dt> <dd></dd> <dt>



 ("Служба")


</dt> <dd></dd> </dl>

</dd> <dt>

**терминалнаме**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Имя терминала.

Это свойство наследуется из [**Win32 \_ терминалсеттинг**](win32-terminalsetting.md).

</dd> <dt>

**терминалпротокол**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Имя протокола уровня сеанса; Например, Microsoft RDP 5,0.

</dd> <dt>

**Транспорт**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Тип транспорта, используемый в соединении; Например, TCP, NetBIOS или IPX/SPX.

</dd> <dt>

**усераусентикатионрекуиред**
</dt> <dd> <dl> <dt>

Тип данных: **UInt32**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Указывает тип проверки подлинности пользователя, используемой для удаленных соединений. Если задано значение 1, то **усераусентикатионрекуиред** требует проверки подлинности пользователя во время подключения, чтобы повысить защиту сервера от сетевых атак. Подключаться могут только клиенты [протокол удаленного рабочего стола](remote-desktop-protocol.md) (RDP), поддерживающие rdp версии 6,0 или выше. Чтобы избежать нарушений работы удаленных пользователей, перед включением свойства рекомендуется развернуть клиенты RDP, поддерживающие соответствующую версию протокола.

Чтобы включить или отключить это свойство, используйте метод [**сетусераусентикатионрекуиред**](setuserauthenticationrequired-win32-tsgeneralsetting.md) .

<dt>

<span id="FALSE"></span><span id="false"></span>

<span id="FALSE"></span><span id="false"></span>**False** (0)


</dt> <dd>

Проверка подлинности пользователя при подключении отключена.

</dd> <dt>

<span id="TRUE"></span><span id="true"></span>

<span id="TRUE"></span><span id="true"></span>**True** (1)


</dt> <dd>

Проверка подлинности пользователя при подключении включена.

</dd> </dl>

</dd> <dt>

**WindowsAuthentication**
</dt> <dd> <dl> <dt>

Тип данных: **UInt32**
</dt> <dt>

Тип доступа: чтение и запись
</dt> </dl>

Указывает, является ли соединение стандартным процессом проверки подлинности Windows или другим пакетом проверки подлинности, установленным в системе.

<dt>

<span id="FALSE"></span><span id="false"></span>

<span id="FALSE"></span><span id="false"></span>**False** (0)


</dt> <dd>

Не используется по умолчанию для стандартного процесса проверки подлинности Windows.

</dd> <dt>

<span id="TRUE"></span><span id="true"></span>

<span id="TRUE"></span><span id="true"></span>**True** (1)


</dt> <dd>

По умолчанию используется стандартный процесс проверки подлинности Windows.

</dd> </dl>

</dd> </dl>

## <a name="remarks"></a>Комментарии

Имейте в виду, что Windows станции, не связанные с сеансом консоли, не могут получить доступ к методам и свойствам этого класса. Если предпринимается попытка сделать это, указав "Console" в качестве значения свойства Терминалнаме, методы этого объекта будут возвращать **WBEM \_ E \_ не \_ поддерживаются**. Этот код ошибки также будет возвращен, если станция Windows пытается вызвать методы этого объекта для добавления или изменения свойств безопасности учетных записей LocalSystem, LocalService или NetworkService.

Чтобы подключиться к \\ корневому \\ \\ пространству имен CIMV2 терминалсервицес, уровень проверки подлинности должен включать в себя конфиденциальность пакетов. Для вызовов C/C++ это уровень проверки подлинности **AUTHN на \_ \_ \_ уровне \_ \_ безопасности RPC C уровня "PKT**". Для Visual Basic и написания сценариев это уровень проверки подлинности **вбемаусентикатионлевелпктприваци** или "пктприваци" со значением 6. В следующем примере Visual Basic Scripting Edition (VBScript) показано, как подключиться к удаленному компьютеру с использованием конфиденциальности пакетов.


```VB
strComputer = "RemoteServer1" 
Set objServices = GetObject( _
    "winmgmts:{authenticationLevel=pktPrivacy}!Root/CIMv2/TerminalServices")
```



Файлы MOF-файл (MOF) содержат определения для классов инструментарий управления Windows (WMI) (WMI). MOF-файлы не устанавливаются в составе пакета средств разработки программного обеспечения Microsoft Windows (SDK). Они устанавливаются на сервере при добавлении связанной роли с помощью диспетчер сервера. Дополнительные сведения о файлах MOF см. в разделе [MOF-файл (MOF)](/windows/desktop/WmiSdk/managed-object-format--mof-).

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows Vista<br/>                                                                |
| Минимальная версия сервера<br/> | Windows Server 2008<br/>                                                          |
| Пространство имен<br/>                | Корневой \\ CIMv2 \\ терминалсервицес<br/>                                                |
| MOF<br/>                      | <dl> <dt>Тскфгвми. mof</dt> </dl> |
| DLL<br/>                      | <dl> <dt>TSCfgWmi.dll</dt> </dl> |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**\_Терминалсеттинг Win32**](win32-terminalsetting.md)
</dt> </dl>

 

