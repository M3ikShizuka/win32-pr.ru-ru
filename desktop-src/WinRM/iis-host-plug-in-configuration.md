---
title: Конфигурация подключаемого модуля узла IIS
description: Конфигурация подключаемого модуля узла служба удаленного управления Windows (WinRM) службы IIS (IIS) предоставляет механизм размещения, позволяющий сторонним подключаемым модулям WinRM предоставлять данные управления в инфраструктуре WinRM.
ms.assetid: 234e6f7b-310f-499a-83e4-699ecf3816f0
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 714139c25836f5929ca6cfa3fe6797a90e80dde8
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "103987543"
---
# <a name="iis-host-plug-in-configuration"></a>Конфигурация подключаемого модуля узла IIS

Конфигурация подключаемого модуля узла служба удаленного управления Windows (WinRM) службы IIS (IIS) предоставляет механизм размещения, позволяющий сторонним подключаемым модулям WinRM предоставлять данные управления в инфраструктуре WinRM.

В следующих разделах описывается конфигурация подключаемого модуля узла IIS.

-   [Сведения о размещении IIS](#iis-hosting-details)
-   [Модель конфигурации узла IIS](#iis-host-configuration-model)
-   [Настройка и сведения о конфигурации узла IIS (WinRM)](/windows)
-   [Чтение конфигурации узла IIS](#reading-iis-host-configuration)
-   [Перечисление подключаемых модулей в службе WinRM](#enumerating-plug-ins-on-the-winrm-service)

## <a name="iis-hosting-details"></a>Сведения о размещении IIS

Приложение, которое настраивает и инициализирует процессор WinRM SOAP в службах IIS, будет принимать запросы непосредственно от клиента WinRM на другом компьютере с помощью протокола WS-Management. Приложение должно также настроить конечную точку HTTP, определяющую приложение, чтобы все запросы направлялись непосредственно в подключаемые модули конкретного приложения. Приложение также должно настраивать подключаемые модули для загрузки на узел IIS, а также необходимые механизмы авторизации и проверки подлинности. При использовании службы WinRM в службах IIS следует учитывать следующие факторы.

-   По умолчанию службы IIS не поддерживают проверку подлинности Kerberos. Однако для поддержки проверки подлинности Kerberos можно создать модуль IIS.
-   Служба IIS не будет принимать зашифрованные запросы службы WinRM по протоколу HTTP.
-   После настройки конечной точки IIS первый запрос, отправляемый с неявными учетными данными, завершится ошибкой. Однако все последующие запросы будут выполнены. Это известная проблема с сайтом IIS, настроенным с проверкой подлинности по умолчанию в режиме ядра. Если проблема связана с блокировкой, рекомендуется отключить проверку подлинности в режиме ядра.

## <a name="iis-host-configuration-model"></a>Модель конфигурации узла IIS

Все приложения, на которых размещается процессор протокола SOAP для WinRM в службах IIS, нуждаются в конфигурации, прежде чем они будут работать.

Каждая конфигурация приложения отличается от других приложений. Следующие наборы конфигураций необходимы, хотя, возможно, не все конфигурации необходимо изменить, и они выполняются с помощью основной службы WinRM:

-   Общая конфигурация приложения, включая время ожидания операций.
-   Подключаемый модуль авторизации для авторизации запросов LiveID или сопоставления учетной записи пользователя Windows с более универсальной учетной записью службы.
-   Подключаемые модули операции, размещаемые и используемые процессором WinRM SOAP для выполнения фактических запросов.

В службах IIS может потребоваться настроить следующие конфигурации:

-   Сведения о конечной точке [*прослушивателя*](windows-remote-management-glossary.md) , определяющие, какие порты и адреса прослушивают запросы и какие сертификаты SSL (SSL).
-   Сопоставление сертификата клиента для сопоставления сертификатов клиентов с учетными записями пользователей.
-   Конфигурация авторизации, чтобы ограничить доступ к виртуальному сайту.

Служба WinRM регистрирует порт 5985 с префиксом WSMan по умолчанию. Если включен прослушиватель совместимости HTTP, служба WinRM регистрирует порт 80 с префиксом WSMan по умолчанию. Поскольку службы IIS также прослушивают порт 80 по умолчанию, рекомендуется создавать [*прослушиватели*](windows-remote-management-glossary.md) на другом порте СЛУЖБАМИ узлов IIS.

Если для совместного использования порта в службах IIS и службы WinRM используется порт 80, необходимо выполнить следующую настройку.

-   Служба узла IIS должна включить WinRM для приложения на сайте.
-   Имя приложения необходимо добавить в универсальный код ресурса (URI). Например: https://servername/myapplication.

Каждое ведущее приложение IIS хранится в конфигурации IIS как файл web.config, находящийся в физическом каталоге, соответствующем настроенному виртуальному каталогу. В следующем разделе описано, как работает система конфигурации IIS и как ее можно расширить для поддержки конфигурации узла WinRM IIS.

### <a name="how-iis-configuration-works"></a>Как работает конфигурация IIS

Инфраструктура конфигурации IIS состоит из набора XML-файлов, используемых для хранения данных конфигурации, и набора файлов схемы, используемого для проверки данных, записываемых или считываемых через API администрирования IIS. На корневом уровне имеется файл ApplicationHost.config в том же каталоге, что и IIS (как правило,% WINDIR% \\ system32 \\ InetSrv \\ config). Это основной файл конфигурации для служб IIS, в котором хранятся список сайтов, приложений, виртуальных каталогов, общих параметров, ведения журнала, кэширования и т. д. Данные конфигурации делятся на и доступны как независимые сущности, называемые **разделами**.

Например, существуют отдельные **разделы** для сайтов, ведения журнала, кэширования и т. д. Все данные конфигурации, содержащиеся в ApplicationHost.config, применяются ко всем сайтам, приложениям и виртуальным каталогам, настроенным в IIS. На уровне виртуального каталога файл web.config определяет данные конфигурации конкретного приложения, возможно, путем переопределения других данных, уже определенных в ApplicationHost.config. Web.config файлы хранятся в корне (физический каталог), соответствующем сайту, приложению или виртуальному каталогу, к которому применяется конфигурация.

Дополнительные сведения о конфигурации IIS см. в следующих статьях:

-   [Схема параметров IIS 7,0](/previous-versions/iis/settings-schema/aa347559(v=vs.90))
-   [/арчиве/блогс/карлосаг/](/archive/blogs/carlosag/)
-   [https://www.iis.net/articles/view.aspx/IIS7/Use-IIS7-Administration-Tools/Using-XML-Configuration/Deep-Dive-into-IIS7](https://www.iis.net/learn/get-started/planning-your-iis-architecture/deep-dive-into-iis-configuration-with-iis-7-and-iis-8)

Схема конфигурации IIS, используемая для проверки данных конфигурации IIS, — это XML-файлы, хранящиеся в каталоге схемы IIS (как правило,% WINDIR% \\ system32 \\ InetSrv \\ config \\ Schema). Схема конфигурации IIS не является XSD. Конфигурация IIS поддерживает расширяемость. Новые разделы конфигурации можно интегрировать непосредственно в систему конфигурации IIS, а параметры системы конфигурации IIS можно изменять с помощью существующих API-интерфейсов администрирования.

Ниже приведены основные шаги, которые следует выполнить.

-   Определите новый раздел конфигурации в файле схемы XML.
-   Поместите файл в каталог схемы IIS 7 (% windir% \\ system32 \\ InetSrv \\ config \\ Schema).
-   Зарегистрируйте новый раздел в глобальном файле конфигурации IIS (ApplicationHost.config).

## <a name="iis-host-winrm-configuration-setup-and-details"></a>Настройка и сведения о конфигурации узла IIS (WinRM)

В этом разделе описаны шаги, которые необходимо выполнить во время установки для интеграции и инициализации конфигурации узла IIS. Здесь Конфигурация узла IIS относится к данным конфигурации, необходимым для запуска службы WinRM в службах IIS. Модуль WinRM IIS Extension — это дополнительный компонент, который устанавливается с помощью **Диспетчер сервера**.

Раздел конфигурации IIS, определяющий необходимую конфигурацию, называется **system.management.wsmanagement.config**. Как правило, конфигурация узла IIS определяется во время установки. Это можно сделать, создав файл web.config и добавив соответствующий XML-код. Для внесения любых изменений в файл web.config требуется перезапустить сайт, на котором размещена служба WinRM.

В следующей процедуре описывается настройка расширения IIS для WinRM подробно.

**Установка расширения WinRM для IIS**

1.  В разделе **Сводка компонентов** **Диспетчер сервера** щелкните **Добавить компоненты**.
2.  В мастере добавления компонентов выберите WinRM IIS Extension.
3.  Следуйте инструкциям мастера, включая установку необходимого программного обеспечения, если они указаны. Дополнительные сведения об использовании мастера добавления компонентов см. в **Диспетчер сервера** справке в Интернете.

### <a name="initializing-winrm-configuration-for-the-hosted-application"></a>Инициализация конфигурации WinRM для размещенного приложения

Этот шаг включает определение XML-файла конфигурации узла IIS в файле web.config. Этот файл находится в физическом каталоге, соответствующем виртуальному каталогу, в котором настроено размещенное приложение. XML-содержимое для раздела **system.management.wsmanagement.config** должно соответствовать схеме, определенной в WSManConfig \_schema.xml; в противном случае API-интерфейсы администрирования IIS не смогут их обработать. Ниже приведен пример XML-содержимого, которое может содержаться в файле web.config:


```XML
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
 <system.webServer>
  <system.management.wsmanagement.config>
   <OperationsConfiguration MaxEnvelopeSizeKB="150" 
                            MaxOperationTimeoutSeconds="60"  
                            MaxEnumerateIdleTimeoutSeconds="60"  
                            MaxSubscribeIdleTimeoutSeconds="60"  
                            MaxShellIdleTimeoutMinutes="15"
                            QuotaRefreshIntervalSeconds="900"
                            QuotaSystemWindowSeconds="2"
                            QuotaSystemWindowOperations-"1000"/>
    <PluginModules>
     <AuthorizationPlugin Name="Auth1" Filename="Auth.dll" SDKVersion="1" SupportsQuota="true"/>
     <OperationsPlugins>
      <Plugin Name="PL1" Filename="PL1.dll" SDKVersion="1" XmlRenderingType="text">
       <InitializationParameters>
        <Param name="myParam1" value="myValue1"/>
       </InitializationParameters>
       <Resources>
        <Resource ResourceUri="myUri1">
        <Capability Type="Shell"/>
        </Resource>
       </Resources>
      </Plugin>
      <Plugin Name="PL2" Filename="PL2.dll" SDKVersion="1" XmlRenderingType="text">
       <InitializationParameters/>
       <Resources>
        <Resource ResourceUri="myUri1">
         <Capability Type="Get"/>
         <Capability Type="Put"/>
         <Capability Type="Delete"/>
        </Resource>
       </Resources>
      </Plugin>
     </OperationsPlugins>
    </PluginModules>
   </OperationsConfiguration>
  </system.management.wsmanagement.config>
 </system.webServer>
</configuration>
```



В следующем списке описаны XML-элементы более подробно и за ним следует пример \_ файла wsmanconfigschema.xml.



| Элемент                                                        | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|----------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Оператионсконфигуратион/Максенвелопесизекб                      | Максимальный размер пакетов SOAP, которые будет обрабатывать служба WinRM. Значение по умолчанию — 150 КБ.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Оператионсконфигуратион/Максоператионтимеаутсекондс             | Максимальный интервал времени ожидания для всех операций. Это значение переопределяет любое значение, полученное в пакете SOAP. Если поставщик превышает это значение, время ожидания отправляется клиенту, и операция будет отменена. (Некоторые операции, например перечисления, могут оставаться открытым перечислением после истечения времени ожидания.) Значение по умолчанию — 60 секунд.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Оператионсконфигуратион/Максенумератионидлетимеаутсекондс       | Максимальный интервал времени ожидания для перечислений. Если время между запросами перечисления больше этого значения, перечисление отменяется, а ранее выданный контекст перечисления становится недействительным. Значение по умолчанию — 60 секунд.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Оператионсконфигуратион/Макссубскрибеидлетимеаутсекондс         | Максимальный интервал времени ожидания для операций подписки. Значение по умолчанию — 60 секунд.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| Оператионсконфигуратион/Максшеллидлетимеаутминутес             | Максимальное время в минутах, по истечении которого неактивная удаленная оболочка удаляется. Значение по умолчанию — 15 минут.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| Оператионсконфигуратион/Куотарефрешинтервалсекондс            | Интервал перед обновлением сведений о квоте для пользователя. Ожидающие запросы для указанного пользователя продолжают выполняться в предыдущем контексте авторизации и квоты до завершения обновления. Значение по умолчанию — 900 секунд.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Оператионсконфигуратион/Куотасистемвиндовсекондс               | Длительность скользящего окна регулирования системы. Значение по умолчанию — 2 секунды.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Оператионсконфигуратион/Куотасистемвиндовоператионс            | Количество операций, которые допускают через регулирование системы во время скользящего окна. Значение по умолчанию — 1000 операций.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| Плугинмодулес/Authorizationplugin задано                              | Этот узел является необязательным. Подключаемый модуль авторизации позволяет программным способом принимать или отклонять входящие пользователи, основанные на разных схемах проверки подлинности.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Плугинмодулес/Authorizationplugin задано/имя                         | Указывает отображаемое имя, используемое для подключаемого модуля. Если из подключаемого модуля возвращается ошибка, то это имя помещается в XML-код ошибки, который возвращается клиентскому приложению. Это имя может быть на любом языке.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| Плугинмодулес/Authorizationplugin задано/имя файла                     | Указывает имя файла подключаемого модуля авторизации. Все переменные среды, помещаемые в эту запись, будут расширены на основе удостоверения, под которым работает узел IIS, например сетевой службы. Значение по умолчанию для этой записи пустое, что означает, что подключаемый модуль авторизации не используется.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| Плугинмодулес/Authorizationplugin задано/Сдкверсион                   | Указывает версию пакета средств разработки программного обеспечения (SDK), для которого был написан определенный подключаемый модуль. Этот элемент должен иметь значение 1.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Плугинмодулес/Authorizationplugin задано/Суппортскуота                | Указывает, поддерживает ли подключаемый модуль авторизации квоты.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Плугинмодулес/Оператионсплугинс/имя                           | Указывает отображаемое имя, используемое для подключаемого модуля. Если из подключаемого модуля возвращается ошибка, то это имя помещается в XML-код ошибки, который возвращается клиентскому приложению. Это имя может быть на любом языке.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| Плугинмодулес/Оператионсплугинс/имя файла                       | Указывает имя файла подключаемого модуля операции. Все переменные среды, помещаемые в эту запись, будут развернуты в контексте пользователя при получении запроса. У каждого пользователя может быть другая версия одной и той же переменной среды, поэтому каждый пользователь может использовать другой подключаемый модуль. Эта запись не может быть пустой и должна указывать на допустимый подключаемый модуль.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Плугинмодулес/Оператионсплугинс/Сдкверсион                     | Указывает версию пакета SDK, для которого был записан определенный подключаемый модуль. Этот элемент должен иметь значение 1.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| Плугинмодулес/Оператионсплугинс/Ксмлрендерингтипе               | Настраивает формат, в котором XML передается в подключаемые модули через [**объект \_ данных WSMan**](/windows/desktop/api/Wsman/ns-wsman-wsman_data) . Для **ксмлрендерингтипе** задано значение Text. Входящие XML-данные содержатся в \_ \_ \_ текстовой структуре WSMan типа данных, которая представляет XML как **пквстр** буфер памяти.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| Плугинмодулес/Оператионсплугинс/Инитиализатионпараметерс       | Этот узел является необязательным и позволяет подключаемому модулю настроить дополнительный XML, который будет передан методу [**всманплугинстартуп**](/windows/desktop/api/Wsman/nc-wsman-wsman_plugin_startup) . Большинству подключаемых модулей эти дополнительные сведения не требуются, но если подключаемый модуль должен использоваться в нескольких сценариях, для которых требуется другая семантика времени выполнения, этот XML-код предоставит подключаемому модулю гибкость.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| Плугинмодулес/Оператионсплугинс/Resources                      | Указывает список [*URI ресурсов*](windows-remote-management-glossary.md) , поддерживаемых этим подключаемым модулем. Необходимо указать по меньшей мере одну запись **ResourceUri** ; в противном случае XML будет отклонен.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Плугинмодулес/Оператионсплугинс/Resources/Resource             | Представляет одну конфигурацию [*URI ресурса*](windows-remote-management-glossary.md) .                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| Плугинмодулес/Оператионсплугинс/Resources/Resource/ResourceUri | Указывает один [*URI ресурса*](windows-remote-management-glossary.md) либо в полной, либо в виде частичной строки соответствия на основе атрибута **ExactMatch** . Если **ExactMatch** отсутствует, по умолчанию используется **значение false**, означающее, что обработчик WinRM SOAP выполняет частичное сопоставление с началом *URI ресурса* , а при наличии совпадения передает его в подключаемый модуль. Атрибут **суппортсоптионс** можно указать, если этому *URI ресурса* разрешено передавать любые параметры. По умолчанию параметры не поддерживаются, и если они имеются в клиентском запросе, возвращается ошибка. Если параметры поддерживаются подключаемым модулем, то важно, чтобы подключаемый модуль возвращал правильную ошибку, если существует параметр, в котором подключаемый модуль не понимает, когда для флага **MustUnderstand** установлено значение **true**.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Плугинмодулес/Оператионсплугинс/ресурс/возможность            | Указывает возможность, доступную в этом [*URI ресурса*](windows-remote-management-glossary.md). Для каждого поддерживаемого типа операции будет существовать одна запись. Доступны следующие варианты:<br/> <dl> <dt><span id="Get"></span><span id="get"></span><span id="GET"></span>Получить</dt> <dd> Операции Get поддерживаются в [*URI ресурса*](windows-remote-management-glossary.md). Атрибут **суппортфрагмент** используется, если операция get поддерживает концепцию. Атрибут **суппортфилтеринг** является недопустимым и должен иметь значение **false**. Эта возможность недопустима для *URI ресурса* , если также поддерживаются операции оболочки.<br/> </dd> <dt><span id="Put"></span><span id="put"></span><span id="PUT"></span>PUT</dt> <dd> Операции размещения поддерживаются в [*URI ресурса*](windows-remote-management-glossary.md). Атрибут **суппортфрагмент** используется, если операция размещения поддерживает концепцию. Атрибут **суппортфилтеринг** является недопустимым и должен иметь значение **false**. Эта возможность недопустима для *URI ресурса* , если также поддерживаются операции оболочки.<br/> </dd> <dt><span id="Create"></span><span id="create"></span><span id="CREATE"></span>Создать</dt> <dd> Операции создания поддерживаются в [*URI ресурса*](windows-remote-management-glossary.md). Атрибут **суппортфрагмент** используется, если операция создания поддерживает концепцию. Атрибут **суппортфилтеринг** является недопустимым и должен иметь значение **false**. Эта возможность недопустима для *URI ресурса* , если также поддерживаются операции оболочки.<br/> </dd> <dt><span id="Delete"></span><span id="delete"></span><span id="DELETE"></span>Удалить</dt> <dd> Операции Delete поддерживаются в [*URI ресурса*](windows-remote-management-glossary.md). Атрибут **суппортфрагмент** используется, если операция удаления поддерживает концепцию. Атрибут **суппортфилтеринг** является недопустимым и должен иметь значение **false**. Эта возможность недопустима для *URI ресурса* , если также поддерживаются операции оболочки.<br/> </dd> <dt><span id="Invoke"></span><span id="invoke"></span><span id="INVOKE"></span>Вызвать</dt> <dd> Операции Invoke поддерживаются в [*URI ресурса*](windows-remote-management-glossary.md). Атрибут **суппортфрагмент** не поддерживается для операций Invoke и должен иметь значение **false**. Атрибут **суппортфилтеринг** является недопустимым и должен иметь значение **false**. Эта возможность недопустима для *URI ресурса* , если также поддерживаются операции оболочки.<br/> </dd> <dt><span id="Enumerate"></span><span id="enumerate"></span><span id="ENUMERATE"></span>Перечислить</dt> <dd> Операции перечисления поддерживаются в [*URI ресурса*](windows-remote-management-glossary.md). Атрибут **суппортфрагмент** не поддерживается для операций перечисления и должен иметь значение **false**. Атрибут **суппортфилтеринг** является допустимым, и если подключаемый модуль поддерживает фильтрацию, этот атрибут должен иметь значение **true**. Эта возможность недопустима для *URI ресурса* , если также поддерживаются операции оболочки.<br/> </dd> <dt><span id="Subscribe"></span><span id="subscribe"></span><span id="SUBSCRIBE"></span>Подписка.</dt> <dd> Операции подписки поддерживаются в [*URI ресурса*](windows-remote-management-glossary.md). Атрибут **суппортфрагмент** не поддерживается для операций подписки и должен иметь значение **false**. Атрибут **суппортфилтеринг** является недопустимым и должен иметь значение **false**. Эта возможность недопустима для *URI ресурса* , если также поддерживаются операции оболочки.<br/> </dd> <dt><span id="Shell"></span><span id="shell"></span><span id="SHELL"></span>Shell</dt> <dd> Операции оболочки поддерживаются в [*URI ресурса*](windows-remote-management-glossary.md). Атрибут **суппортфрагмент** не поддерживается для операций оболочки и должен иметь значение **false**. Атрибут **суппортфилтеринг** является недопустимым и должен иметь значение **false**. Эта возможность недопустима для *URI ресурса* , если также поддерживается любая другая операция. Если для *универсального кода ресурса (URI)* настроена возможность работы с оболочкой, то операции получения, размещения, создания, удаления, вызова и перечисления обрабатываются внутри службы WinRM для управления оболочками. В результате подключаемый модуль не может работать с самими операциями.<br/> </dd> </dl> |



 

### <a name="example-wsmanconfig_schemaxml-file"></a>Пример \_ файлаschema.xml WSManConfig

Во время настройки XML-файл с именем WSManConfig \_schema.xml, содержащий следующее содержимое, удаляется из каталога схемы IIS:


```XML
<configSchema>
 <sectionSchema name="system.webServer/system.management.wsmanagement.config">
  <element name="OperationsConfiguration">
   <attribute name="MaxEnvelopeSizeKB" 
              type="uint" 
              defaultValue="150" 
              validationType="integerRange" 
              validationParameter="32,4294967295"/>
   <attribute name="MaxOperationTimeoutSeconds" 
              type="uint" 
              defaultValue="60" 
              validationType="integerRange" 
              validationParameter="1,4294967295"/>
   <attribute name="MaxEnumerateIdleTimeoutSeconds" 
              type="uint" 
              defaultValue="60" 
              validationType="integerRange" 
              validationParameter="1,4294967295"/>
   <attribute name="MaxSubscribeIdleTimeoutSeconds" 
              type="uint" 
              defaultValue="60" 
              validationType="integerRange" 
              validationParameter="1,4294967295"/>
   <attribute name="MaxShellIdleTimeoutMinutes" 
              type="uint" 
              defaultValue="15" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
   <attribute name="QuotaRefreshIntervalSeconds" 
              type="uint" 
              defaultValue="900" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
   <attribute name="QuotaSystemWindowSeconds" 
              type="uint" 
              defaultValue="2" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
   <attribute name="QuotaSystemWindowOperations" 
              type="uint" 
              defaultValue="1000" 
              validationType="integerRange" 
              validationParameter="0,4294967295"/>
  </element>
  <element name="PluginModules">
   <collection addElement="AuthorizationPlugin">
    <attribute name="Name" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
    <attribute name="Filename" type="string" required="true" validationType="nonEmptyString"/>
    <attribute name="SDKVersion" type="uint" required="true"/>
    <attribute name="SupportsQuota" type="bool" defaultValue="false"/>
   </collection>
   <element name="OperationsPlugins">
    <collection addElement="Plugin">
     <attribute name="Name" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
     <attribute name="Filename" type="string" required="true" validationType="nonEmptyString"/>
     <attribute name="SDKVersion" type="uint" required="true"/>
     <attribute name="XmlRenderingType" type="enum" defaultValue="text">
      <enum name="text" value="1"/>
      <enum name="XmlReader" value="2"/>
     </attribute>
     <attribute name="Enabled" type="bool" defaultValue="true"/>
     <element name="InitializationParameters">
      <collection addElement="Param">
       <attribute name="Name" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
       <attribute name="Value" type="string" required="true" validationType="nonEmptyString"/>
      </collection>
     </element>
     <element name="Resources">
      <collection addElement="Resource">
       <attribute name="ResourceUri" type="string" isUniqueKey="true" required="true" validationType="nonEmptyString"/>
       <attribute name="SupportsOptions" type="bool" defaultValue="false"/>
       <attribute name="ExactMatch" type="bool" defaultValue="false"/>
       <collection addElement="Capability">
        <attribute name="Type" type="enum" isUniqueKey="true" required="true">
         <enum name="Get" value="1"/>
         <enum name="Put" value="2"/>
         <enum name="Create" value="3"/>
         <enum name="Delete" value="4"/>
         <enum name="Invoke" value="5"/>
         <enum name="Enumerate" value="6"/>
         <enum name="Subscribe" value="7"/>
         <enum name="Shell" value="8"/>
        </attribute>
        <attribute name="SupportsFragment" type="bool" default="false"/>
        <attribute name="SupportsFiltering" type="bool" default="false"/>
       </collection>
      </collection>
     </element>
    </collection>
   </element>
  </element>
 </sectionSchema>
</configSchema>
```



## <a name="reading-iis-host-configuration"></a>Чтение конфигурации узла IIS

Конфигурация узла IIS считывается во время процесса запуска процессора SOAP в размещенном приложении. Поскольку web.config файлы могут быть отредактированы вручную, и, следовательно, могут быть подвержены ошибкам проверки схемы, при считывании конфигурации возможны проблемы. Во время чтения или проверки конфигурации размещенное приложение не запускается и возвращает клиенту соответствующее сообщение об ошибке. Будет записано событие, содержащее подробное описание причины сбоя.

Ниже перечислены распространенные ошибки.

-   доступ запрещен
-   Недопустимый XML конфигурации
-   Нет настроенного подключаемого модуля (требуется по крайней мере один)

Стандартные подключаемые модули не настраиваются по умолчанию. Их необходимо явно настроить в файле web.config, прежде чем они начнут получать запросы.

## <a name="enumerating-plug-ins-on-the-winrm-service"></a>Перечисление подключаемых модулей в службе WinRM

Следующая команда показывает, как с помощью служебной программы WinRM определить, какие подключаемые модули доступны в службе WinRM: **WinRM Enumerate WinRM/config/plugin-Format: довольно**.

 

