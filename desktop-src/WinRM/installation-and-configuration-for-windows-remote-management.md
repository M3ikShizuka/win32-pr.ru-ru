---
title: установка и настройка для служба удаленного управления Windows
description: для выполнения сценариев служба удаленного управления Windows (winrm) и для выполнения операций с данными с помощью программы командной строки **winrm** служба удаленного управления Windows (winrm) должны быть установлены и настроены.
ms.date: 09/10/2021
ms.assetid: 81c40456-0003-46d0-8695-83bf77432056
ms.topic: article
ms.custom: contperf-fy21q1
ms.openlocfilehash: c8b1abf2052ee0e1f4a0508f661a502220a3fd7f
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "126974812"
---
# <a name="installation-and-configuration-for-windows-remote-management"></a>установка и настройка для служба удаленного управления Windows

для выполнения сценариев служба удаленного управления Windows (winrm) и для выполнения операций с данными с помощью программы командной строки **winrm** служба удаленного управления Windows (winrm) должны быть установлены и настроены.

Эти элементы также зависят от конфигурации WinRM.

- Windows средство командной строки [удаленной оболочки](./windows-remote-management-glossary.md#w) (**Winrs**).
- [Пересылка событий](./windows-remote-management-glossary.md#e).
- удаленное взаимодействие Windows PowerShell 2,0.

## <a name="where-winrm-is-installed"></a>Где установлен WinRM

служба WinRM автоматически устанавливается со всеми поддерживаемыми версиями Windows операционной системы.

## <a name="configuration-of-winrm-and-ipmi"></a>Настройка WinRM и IPMI

Эти компоненты [поставщика службы](/previous-versions/windows/desktop/ipmiprv/ipmi-provider) удаленного [управления (IPMI) и SNMP-интерфейса](./windows-remote-management-glossary.md#i) WMI устанавливаются вместе с операционной системой.

- служба WinRM запускается автоматически на Windows Server 2008 и выше (в Windows Vista необходимо запустить службу вручную).
- По умолчанию [прослушиватель](./windows-remote-management-glossary.md#l) WinRM не настроен. Даже если служба WinRM запущена, WS-Management [сообщения](./windows-remote-management-glossary.md#m) протокола, которые запрашивают данные, не могут быть получены или отправлены.
- Брандмауэр подключения к Интернету (ICF) блокирует доступ к портам.

Используйте `Winrm` команду, чтобы нахождение прослушивателей и адресов, введя в командной строке следующую команду.

```console
winrm e winrm/config/listener
```

Чтобы проверить состояние параметров конфигурации, введите следующую команду.

```console
winrm get winrm/config
```

## <a name="quick-default-configuration"></a>Быстрая настройка по умолчанию

Можно включить протокол WS-Management на локальном компьютере и настроить конфигурацию по умолчанию для удаленного управления с помощью команды `winrm quickconfig` .

`winrm quickconfig`Команда (или сокращенная версия `winrm qc` ) выполняет эти операции.

- Запускает службу WinRM и задает для типа запуска службы автоматический запуск.
- Настраивает прослушиватель для портов, которые отправляют и получают [сообщения](./windows-remote-management-glossary.md#m) протокола WS-Management с помощью HTTP или HTTPS по любому IP-адресу.
- Определяет исключения ICF для службы WinRM и открывает порты для HTTP и HTTPS.

> [!NOTE]
> `winrm quickconfig`Команда создает исключение брандмауэра только для текущего профиля пользователя. Если профиль брандмауэра изменился по какой-либо причине, следует запустить, `winrm quickconfig` чтобы включить исключение брандмауэра для нового профиля; в противном случае исключение может быть не включено.

Чтобы получить сведения о настройке конфигурации, введите `winrm help config` в командной строке.

### <a name="to-configure-winrm-with-default-settings"></a>Настройка WinRM с параметрами по умолчанию

1. Введите `winrm quickconfig` в командной строке.

   Если вы не используете учетную запись администратора локального компьютера, необходимо выбрать пункт **Запуск от имени администратора** в меню " **Пуск** " или использовать команду **runas** в командной строке.

2. Когда средство выводит на экран команду **сделать эти изменения \[ y/n \] ?**, введите **y**.

   Если настройка прошла успешно, отображаются следующие выходные данные.

   ``` syntax
   WinRM has been updated for remote management.

   WinRM service type changed to delayed auto start.
   WinRM service started.
   Created a WinRM listener on https://* to accept WS-Man requests to any IP on this machine.
   ```

3. Используйте параметры по умолчанию для клиентских и серверных компонентов WinRM или настройте их. Например, может потребоваться добавить определенные удаленные компьютеры в список TrustedHosts конфигурации клиента.

   Если невозможно установить взаимную проверку подлинности, следует настроить список надежных узлов. Kerberos допускает взаимную проверку подлинности, но не может использоваться &mdash; только в доменах рабочих групп. При настройке доверенных узлов для Рабочей группы рекомендуется сделать список максимально ограниченным.

4. Создайте прослушиватель HTTPS, введя команду `winrm quickconfig -transport:https` . Имейте в виду, что для работы транспорта HTTPS необходимо открыть порт 5986.

## <a name="listener-and-ws-management-protocol-default-settings"></a>Параметры по умолчанию прослушивателя и протокола WS-Management

Чтобы получить конфигурацию прослушивателя, введите `winrm enumerate winrm/config/listener` в командной строке. Прослушиватели определяются транспортом (HTTP или HTTPS) и адресом IPv4 или IPv6.

`winrm quickconfig` создает следующие параметры по умолчанию для прослушивателя. Можно создать более одного прослушивателя. Для получения дополнительных сведений введите `winrm help config` в командной строке.

### <a name="address"></a>Адрес

Задает адрес, для которого был создан данный прослушиватель.

### <a name="transport"></a>Транспортировка

Указывает транспорт для отправки и получения запросов и ответов протокола WS-Management. Значение должно быть либо *http* , либо *HTTPS*. Значение по умолчанию — *http*.

### <a name="port"></a>Порт

Задает TCP-порт, для которого создается данный прослушиватель.

**WinRM 2,0:** HTTP-порт по умолчанию — 5985.

### <a name="hostname"></a>Hostname (Имя узла)

Указывает имя узла компьютера, на котором запущена служба WinRM. Значением должно быть полное доменное имя, строка литерала IPv4 или IPv6 или символ-шаблон.

### <a name="enabled"></a>Активировано

Указывает, включен или отключен прослушиватель. По умолчанию используется значение *True*.

### <a name="urlprefix"></a>URLPrefix

Указывает URL-префикс для приема запросов HTTP или HTTPS. Это строка, содержащая только символы a – z, A – Z, 9-0, символ подчеркивания ( \_ ) и косую черту (/). Строка не должна начинаться с косой черты или заканчиваться ей (/). Например, если имя компьютера — *самплемачине*, то клиент WinRM будет указывать `https://SampleMachine/<*URLPrefix*>` в адресе назначения. Префикс URL-адреса по умолчанию — WSMan.

### <a name="certificatethumbprint"></a>CertificateThumbprint

Указывает отпечаток сертификата службы. Это значение представляет собой строку шестнадцатеричных значений из двух цифр, найденных в поле отпечатка сертификата. Эта строка содержит хэш SHA-1 сертификата. Сертификаты используются при проверке подлинности на основе сертификата клиента. Сертификаты могут быть сопоставлены только с локальными учетными записями пользователей и не работают с учетными записями домена.

### <a name="listeningon"></a>ListeningOn

Указывает адреса IPv4 и IPv6, используемые прослушивателем. Например: "111.0.0.1, 111.222.333.444,:: 1, 1000:2000:2c: 3: C19:9ec8: a715:5e24, 3FFE: 8311: FFFF: f70f: 0:5EFE: 111.222.333.444, FE80:: 5EFE: 111.222.333.444% 8, FE80:: C19:9ec8: a715:5e24% 6".

## <a name="protocol-default-settings"></a>Параметры протокола по умолчанию

Многие параметры конфигурации, такие как *максенвелопесизекб* или *соаптрацеенаблед*, определяют взаимодействие клиентских и серверных компонентов WinRM с протоколом WS-Management. В следующем списке описаны доступные параметры конфигурации.

### <a name="maxenvelopesizekb"></a>MaxEnvelopeSizekb

Указывает максимальный объем данных протокола доступа к объектам (в килобайтах). Значение по умолчанию — 150 КБ.

> [!NOTE]  
> Поведение не поддерживается, если для *максенвелопесизекб* задано значение больше 1039440.

### <a name="maxtimeoutms"></a>макстимеаутмс

Указывает максимальное время ожидания (в миллисекундах), которое может использоваться для любого запроса, кроме запросов на включение внесенных изменений. Значение по умолчанию — 60000.

### <a name="maxbatchitems"></a>MaxBatchItems

Задает максимальное количество элементов, которое может быть использовано в ответе Pull. Значение по умолчанию — 32000.

### <a name="maxproviderrequests"></a>MaxProviderRequests

Задает максимальное количество одновременных запросов, допускаемое службой. Значение по умолчанию — 25.

**WinRM 2,0:** Этот параметр является устаревшим и имеет значение только для чтения.

## <a name="winrm-client-default-configuration-settings"></a>Параметры конфигурации клиента WinRM по умолчанию

Клиентская версия WinRM имеет следующие параметры конфигурации по умолчанию.

### <a name="networkdelayms"></a>нетворкделаймс

Задает дополнительное время ожидания клиента в миллисекундах для поправки на сетевую задержку. Значение по умолчанию — 5000 миллисекунд.

### <a name="urlprefix"></a>URLPrefix

Указывает URL-префикс для приема запросов HTTP или HTTPS. Префикс URL-адреса по умолчанию — WSMan.

### <a name="allowunencrypted"></a>алловуненкриптед

Позволяет клиентскому компьютеру запрашивать передачу данных в незашифрованном виде. По умолчанию клиентский компьютер требует зашифрованный сетевой трафик, а этот параметр имеет *значение false*.

### <a name="basic"></a>Basic

Позволяет клиентскому компьютеру использовать обычную проверку подлинности. При использовании обычной проверки подлинности имя пользователя и пароль передаются серверу или прокси-серверу открытым текстом. Эта схема является наименее безопасным методом проверки подлинности. Значение по умолчанию равно *True*.

### <a name="digest"></a>Digest (дайджест)

Позволяет клиентскому компьютеру использовать дайджест-проверку подлинности. Дайджест-проверка подлинности проводится по принципу "запрос-ответ". В качестве запроса поступает строка данных, указанная сервером. Инициировать запрос дайджест-проверки подлинности может только клиентский компьютер. Клиентский компьютер отправляет запрос на сервер для проверки подлинности и получает строку токена с сервера. Затем клиентский компьютер отправляет запрос ресурса, включая имя пользователя и криптографический хэш пароля, в сочетании со строкой токена. Дайджест-проверка подлинности поддерживается для HTTP и для HTTPS. Клиентские скрипты и приложения оболочки WinRM могут указывать дайджест-проверку подлинности, но служба WinRM не принимает дайджест-проверку подлинности. Значение по умолчанию равно *True*.

> [!NOTE]
> Дайджест-проверка подлинности по протоколу HTTP не считается безопасной.

### <a name="certificate"></a>Сертификат

Позволяет клиенту использовать проверку подлинности на основе сертификата клиента. Проверка подлинности на основе сертификатов — это схема, в которой сервер проверяет подлинность клиента, идентифицируемого сертификатом X509. Значение по умолчанию равно *True*.

### <a name="kerberos"></a>Kerberos

Позволяет клиентскому компьютеру использовать проверку подлинности Kerberos. Проверка подлинности Kerberos подразумевает взаимную проверку подлинности клиента и сервера с использованием сертификатов Kerberos. Значение по умолчанию равно *True*.

### <a name="negotiate"></a>Согласование

Позволяет клиенту использовать проверку подлинности согласованием. При проверке подлинности с согласованием клиент отправляет серверу запрос на проверку подлинности. Сервер определяет, какой протокол использовать — Kerberos или NTLM. Протокол Kerberos выбирается для проверки подлинности учетной записи домена, а NTLM — для учетных записей локального компьютера. Имя пользователя должно быть указано в \\ \_ формате имени пользователя домена для пользователя домена. Имя пользователя должно быть указано в \_ формате "имя \\ пользователя сервера \_ " для локального пользователя на компьютере сервера. Значение по умолчанию равно *True*.

### <a name="credssp"></a>CredSSP

Позволяет клиенту использовать проверку подлинности с помощью поставщика поддержки безопасности учетных данных (CredSSP). CredSSP позволяет приложению делегировать учетные данные пользователя с клиентского компьютера на целевой сервер. По умолчанию *False*.

### <a name="defaultports"></a>дефаултпортс

Указывает порты, которые клиент будет использовать для HTTP или HTTPS.

**WinRM 2,0:** HTTP-порт по умолчанию — 5985, а HTTPS-порт по умолчанию — 5986.

### <a name="trustedhosts"></a>TrustedHosts

Указывает список доверенных удаленных компьютеров. В этот список необходимо добавить другие компьютеры в Рабочей группе или компьютерах в другом домене.

> [!Note]
> Компьютеры в списке TrustedHosts не проходят проверку подлинности. Клиент может отправить учетные данные на эти компьютеры.

Если для Трустедхост указан IPv6-адрес, адрес должен быть заключен в квадратные скобки, как показано в следующей команде WinRM Utility: `winrm set winrm/config/client '@{TrustedHosts ="[0:0:0:0:0:0:0:0]"}'` .

Чтобы получить дополнительные сведения о добавлении компьютеров в список TrustedHosts, введите `winrm help config` .

## <a name="winrm-service-default-configuration-settings"></a>Параметры конфигурации по умолчанию для службы WinRM

Версия службы WinRM имеет следующие параметры конфигурации по умолчанию.

### <a name="rootsddl"></a>RootSDDL

Указывает дескриптор безопасности, управляющий удаленным доступом к прослушивателю. Значение по умолчанию — "О:НСГ: BAD: P (A;; Общедоступный;;; BA) (A;; GR;;; ER) С:П (AU; FA; Общедоступный;;; WD) (AU; SA; ГВГКС;;; WD) ".

### <a name="maxconcurrentoperations"></a>максконкуррентоператионс

Максимальное количество одновременных операций. Значение по умолчанию — 100.

**WinRM 2,0:** Параметр Максконкуррентоператионс является устаревшим и имеет значение только для чтения. Этот параметр заменен на свойств maxconcurrentoperationsperuser.

### <a name="maxconcurrentoperationsperuser"></a>Свойств maxconcurrentoperationsperuser

Указывает максимальное количество одновременных операций, которые любой пользователь может удаленно открыть в одной системе. Значение по умолчанию — 1500.

### <a name="enumerationtimeoutms"></a>енумератионтимеаутмс

Указывает время ожидания простоя в миллисекундах между сообщениями о вытягиваниех. Значение по умолчанию — 60000.

### <a name="maxconnections"></a>MaxConnections

Указывает максимальное количество активных запросов, которые служба может обрабатывать одновременно. Значение по умолчанию — 300.

**WinRM 2,0:** Значение по умолчанию — 25.

### <a name="maxpacketretrievaltimeseconds"></a>макспаккетретриевалтимесекондс

Указывает максимальное время в секундах, необходимое службе WinRM для получения пакета. Значение по умолчанию — 120 секунд.

### <a name="allowunencrypted"></a>алловуненкриптед

Позволяет клиентскому компьютеру запрашивать передачу данных в незашифрованном виде. По умолчанию *False*.

### <a name="basic"></a>Basic

Позволяет службе WinRM использовать обычную проверку подлинности. По умолчанию *False*.

### <a name="certificate"></a>Сертификат

Позволяет службе WinRM использовать проверку подлинности на основе сертификата клиента. По умолчанию *False*.

### <a name="kerberos"></a>Kerberos

Позволяет службе WinRM использовать проверку подлинности Kerberos. Значение по умолчанию равно *True*.

### <a name="negotiate"></a>Согласование

Позволяет службе WinRM использовать проверку подлинности Negotiate. Значение по умолчанию равно *True*.

### <a name="credssp"></a>CredSSP

Позволяет службе WinRM использовать проверку подлинности с помощью поставщика поддержки безопасности учетных данных (CredSSP). По умолчанию *False*.

### <a name="cbthardeninglevel"></a>CbtHardeningLevel

Задает политику относительно требований к токенам привязки канала в запросах проверки подлинности. Значение по умолчанию — *ослабление*.

### <a name="defaultports"></a>дефаултпортс

Указывает порты, которые служба WinRM будет использовать как для HTTP, так и для HTTPS.

**WinRM 2,0:** HTTP-порт по умолчанию — 5985, а HTTPS-порт по умолчанию — 5986.

### <a name="ipv4filter-and-ipv6filter"></a>IPv4Filter и IPv6Filter

Указывает адреса IPv4 или IPv6, которые могут использоваться прослушивателями. Значения по умолчанию: IPv4Filter = \* и IPv6Filter = \* .

**IPv4:** Литеральная строка IPv4 состоит из четырех десятичных чисел с точками в диапазоне от 0 до 255. Например: 192.168.0.0.

**IPv6:** Строка литерала IPv6 заключена в квадратные скобки и содержит шестнадцатеричные числа, разделенные двоеточиями. Например:: \[ : 1 \] или \[ 3FFE: FFFF:: 6ECB: 0101 \] .

### <a name="enablecompatibilityhttplistener"></a>енаблекомпатибилитихттплистенер

Указывает, включен ли прослушиватель совместимости HTTP. Если этот параметр имеет *значение true*, прослушиватель будет прослушивать порт 80 в дополнение к порту 5985. По умолчанию *False*.

### <a name="enablecompatibilityhttpslistener"></a>енаблекомпатибилитихттпслистенер

Указывает, включен ли HTTPS-прослушиватель совместимости. Если этот параметр имеет *значение true*, прослушиватель будет прослушивать порт 443 в дополнение к порту 5986. По умолчанию *False*.

## <a name="winrs-default-configuration-settings"></a>Параметры конфигурации по умолчанию для Winrs

`winrm quickconfig` также настраивает параметры по умолчанию для **WinRS** .

### <a name="allowremoteshellaccess"></a>AllowRemoteShellAccess

Разрешает доступ к удаленным оболочкам. Если для этого параметра задано *значение false*, то новые подключения удаленной оболочки будут отклонены сервером. Значение по умолчанию равно *True*.

### <a name="idletimeout"></a>IdleTimeout

Задает максимальное время в миллисекундах, в течение которого удаленная оболочка будет оставаться открытой при отсутствии в ней пользовательской активности. По истечении заданного времени удаленная оболочка автоматически удаляется.

**WinRM 2,0:** Значение по умолчанию — 180000. Минимальное значение — 60000. Установка этого значения ниже 60000 не влияет на время ожидания.

### <a name="maxconcurrentusers"></a>MaxConcurrentUsers

Задает максимальное количество пользователей, могущих одновременно выполнять удаленные операции на одном и том же компьютере через удаленную оболочку. Новые подключения удаленной оболочки будут отклонены, если они превышают указанный предел. Значение по умолчанию — 5.

### <a name="maxshellruntime"></a>MaxShellRunTime

Указывает максимальное время в миллисекундах, в течение которого разрешено выполнение удаленной команды или сценария. Значение по умолчанию — 28800000.

**WinRM 2,0:** Параметр Максшеллрунтиме имеет значение только для чтения. Изменение значения Максшеллрунтиме не повлияет на удаленные оболочки.

### <a name="maxprocessespershell"></a>MaxProcessesPerShell

Задает максимальное количество процессов, которое разрешается запускать любой операции оболочки. 0 означает неограниченное количество процессов. Значение по умолчанию — 15.

### <a name="maxmemorypershellmb"></a>MaxMemoryPerShellMB

Указывает максимальный объем памяти, выделяемой на оболочку, включая дочерние процессы оболочки. Значение по умолчанию — 150 МБ.

### <a name="maxshellsperuser"></a>MaxShellsPerUser

Задает максимальное число одновременно существующих оболочек, которые пользователь может одновременно открыть на одном компьютере. Если этот параметр политики включен, пользователь не сможет открывать новые удаленные оболочки, если число превышает указанный предел. Если этот параметр политики отключен или не задан, будет установлен предел по умолчанию в 5 удаленных оболочек.

## <a name="configuring-winrm-with-group-policy"></a>Настройка WinRM с групповая политика

используйте редактор групповая политика для настройки Windows удаленной оболочки и WinRM для компьютеров в вашей организации.

### <a name="to-configure-with-group-policy"></a>Настройка с помощью групповая политика

1. Откройте окно командной строки с правами администратора.
2. В командной строке введите `gpedit.msc`. Откроется окно **Редактор объектов групповой политики** .
3. найдите **служба удаленного управления Windows** и **Windows удаленную оболочку** групповая политика объектов (GPO) в разделе **конфигурация компьютера \\ административные шаблоны \\ Windows компоненты**.
4. На вкладке **Расширенная** выберите параметр, чтобы просмотреть описание. Дважды щелкните параметр, чтобы изменить его.

## <a name="windows-firewall-and-winrm-20-ports"></a>Windows Порты брандмауэра и WinRM 2,0

Начиная с WinRM 2,0, порты прослушивателя по умолчанию, настроенные, `Winrm quickconfig` — это порт 5985 для транспорта HTTP и порт 5986 для HTTPS. Прослушиватели WinRM можно настроить для любого произвольного порта.

Если компьютер обновлен до WinRM 2,0, ранее настроенные прослушиватели переносятся и по-прежнему получают трафик.

## <a name="winrm-installation-and-configuration-notes"></a>Заметки об установке и настройке WinRM

Служба WinRM не зависит от других служб, кроме WinHttp. если служба iis Admin установлена на том же компьютере, могут отображаться сообщения, указывающие, что WinRM невозможно загрузить до службы IIS (IIS). Однако WinRM не зависит от IIS, &mdash; так как эти сообщения возникают из-за того, что служба IIS запускается до службы HTTP. Для WinRM требуется `WinHTTP.dll` регистрация.

Если на компьютере установлен клиент брандмауэра ISA2004, это может привести к тому, что клиент веб-служб для управления (WS-Management) перестает отвечать на запросы. Чтобы избежать этой проблемы, установите брандмауэр ISA2004 с пакетом обновления 1 (SP1).

Если для двух служб прослушивателя с разными IP-адресами настроен один и тот же номер порта и имя компьютера, служба WinRM прослушивает или получает сообщения только по одному адресу. Это обусловлено тем, что префиксы URL-адресов, используемые протоколом WS-Management, одинаковы.

## <a name="ipmi-driver-and-provider-installation-notes"></a>Заметки об установке драйвера и поставщика IPMI

Драйвер может не обнаружить наличие драйверов IPMI, которые не относятся к корпорации Майкрософт. Если драйвер не запускается, может потребоваться отключить его.

Если в BIOS системы отображаются ресурсы [контроллера управления основной платой (BMC)](./windows-remote-management-glossary.md#b) , то ACPI (Самонастраивающийся) обнаруживает оборудование BMC и автоматически устанавливает драйвер IPMI. Поддержка самонастраивающийся может отсутствовать во всех BMC. Если контроллер BMC обнаруживается самонастраивающийся, то перед установкой компонента управления оборудованием в диспетчер устройств появляется неизвестное устройство. При установке драйвера в диспетчер устройств появляется новый компонент, поддерживающий универсальное IPMI-устройство, совместимое с Microsoft ACPI.

Если система не обнаруживает BMC и не устанавливает драйвер автоматически, но во время установки был обнаружен контроллер BMC, необходимо создать устройство BMC. Для этого введите в командной строке следующую команду: `Rundll32 ipmisetp.dll, AddTheDevice` . После выполнения этой команды создается устройство IPMI, которое отображается в диспетчер устройств. Если удалить компонент управления оборудованием, устройство будет удалено.

Дополнительные сведения см. в разделе [Введение в Управление оборудованием](/previous-versions/windows/it-pro/windows-server-2003/cc785056(v=ws.10)).

Поставщик IPMI помещает классы оборудования в корневое [пространство имен](/windows/desktop/WmiSdk/gloss-n) **\\ оборудования** WMI. Дополнительные сведения о классах оборудования см. в разделе [поставщик IPMI](/previous-versions/windows/desktop/ipmiprv/ipmi-provider). Дополнительные сведения о *пространствах имен* WMI см. в разделе [Архитектура WMI](/windows/desktop/WmiSdk/wmi-architecture).

## <a name="wmi-plug-in-configuration-notes"></a>Примечания по конфигурации подключаемого модуля WMI

начиная с Windows 8 и Windows Server 2012 [подключаемые модули WMI](./windows-remote-management-glossary.md#w) имеют собственные конфигурации безопасности. Чтобы пользователь с обычным или энергопотреблением (не администратором) мог использовать *подключаемый модуль WMI*, необходимо включить доступ для этого пользователя после настройки [прослушивателя](./windows-remote-management-glossary.md#l) . Во-первых, необходимо настроить пользователя для удаленного доступа к [WMI](./windows-remote-management-glossary.md#w) с помощью одного из этих действий.

- Выполните команду `lusrmgr.msc` , чтобы добавить пользователя в **группу \_ \_ винрмремотевмиусерс** в окне **Локальные пользователи и группы** .
- Используйте программу командной строки **WinRM** для настройки дескриптора безопасности для [*пространства имен*](./windows-remote-management-glossary.md#n) [подключаемого модуля WMI](./windows-remote-management-glossary.md#w)следующим образом: `winrm configSDDL http://schemas.microsoft.com/wbem/wsman/1/wmi/ WmiNamespace` .

Когда появится пользовательский интерфейс, добавьте пользователя.

После настройки пользователя для удаленного доступа к [инструментарию WMI](./windows-remote-management-glossary.md#w)необходимо настроить *WMI* , чтобы разрешить пользователю доступ к подключаемому модулю. Для этого выполните команду, `wmimgmt.msc` чтобы изменить безопасность *WMI* для [пространства имен](./windows-remote-management-glossary.md#n) , к которому будет осуществляться доступ в окне **управления WMI** .

Большинство классов WMI для управления находятся в корневом пространстве имен **\\ CIMV2** .