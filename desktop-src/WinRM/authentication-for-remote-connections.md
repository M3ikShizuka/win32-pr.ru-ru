---
title: Проверка подлинности для удаленных подключений
description: Служба удаленного управления Windows обеспечивает безопасность связи между компьютерами за счет поддержки нескольких стандартных методов проверки подлинности и шифрования сообщений.
ms.assetid: 97a13b07-ae7a-4d2f-8841-77a22c91b204
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
topic_type:
- kbArticle
api_name: ''
api_type: ''
api_location: ''
ms.openlocfilehash: 0e9aa125f2ccf5d8c224eee645a6dba1ec2fd96e
ms.sourcegitcommit: 25c6d442ab55cbf0e065398a006b1d409349fffd
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/27/2020
ms.locfileid: "104069707"
---
# <a name="authentication-for-remote-connections"></a>Проверка подлинности для удаленных подключений

Служба удаленного управления Windows обеспечивает безопасность связи между компьютерами за счет поддержки нескольких стандартных методов проверки подлинности и шифрования сообщений.

## <a name="default-group-access"></a>Доступ к группе по умолчанию

Во время установки WinRM создает локальную группу **винрмремотевмиусерс \_ \_**. Затем служба WinRM запрещает удаленный доступ любому пользователю, который не является членом локальной группы администрирования или группы **винрмремотевмиусерс \_ \_** . Вы можете добавить локального пользователя, пользователя домена или группы домена в **винрмремотевмиусерс \_ \_** , введя **net localgroup винрмремотевмиусерс \_ \_ /Add <domain> \\ <username>** в командной строке. При необходимости можно использовать групповая политика, чтобы добавить пользователя в группу.

## <a name="default-authentication-settings"></a>Параметры проверки подлинности по умолчанию

Учетные данные, имя пользователя и пароль по умолчанию являются учетными данными для учетной записи пользователя, выполнившего вход в систему, которая выполняет скрипт.

**Переход к другой учетной записи на удаленном компьютере**

1.  Укажите учетные данные в объекте [**ConnectionOptions**](connectionoptions.md) или [**ивсманконнектионоптионс**](/windows/desktop/api/WSManDisp/nn-wsmandisp-iwsmanconnectionoptions) и укажите их в вызове [**CreateSession**](wsman-createsession.md) .
2.  Задайте **всманфлагкредусернамепассворд** в параметре *flags* в вызове [**CreateSession**](wsman-createsession.md) .

Следующий список содержит список действий, выполняемых при запуске скрипта или приложения с учетными данными по умолчанию.

-   [*Kerberos*](windows-remote-management-glossary.md) является методом проверки подлинности по умолчанию, если клиент находится в домене, а удаленная строка назначения не является одним из следующих: localhost, 127.0.0.1 или \[ :: 1 \] .
-   [*Negotiate*](windows-remote-management-glossary.md) является методом по умолчанию, если клиент находится не в домене, но удаленная строка назначения имеет одно из следующих значений: localhost, 127.0.0.1 или \[ :: 1 \] .

Если указать явные учетные данные для объекта [**ConnectionOptions**](connectionoptions.md) , то метод Negotiate является методом по умолчанию. Проверка подлинности согласования определяет, является ли текущий метод проверки подлинности Kerberos или NTLM в зависимости от того, находятся ли компьютеры в домене или рабочей группе. При подключении к удаленному целевому компьютеру с помощью локальной учетной записи учетной записи следует присвоить префикс имени компьютера. Например, myComputer \\ myUsername.

При указании метода Negotiate, дайджеста или обычной проверки подлинности и невозможности предоставить объект [**ConnectionOptions**](connectionoptions.md) , вы получите сообщение об ошибке, показывающее, что требуются явные учетные данные. Если протокол HTTPS не является транспортом, Целевой Удаленный компьютер должен быть настроен в списке доверенных узлов.

Дополнительные сведения о типах проверки подлинности, включенных в параметрах конфигурации по умолчанию, см. в разделе [Установка и настройка для служба удаленного управления Windows](installation-and-configuration-for-windows-remote-management.md).

## <a name="basic-authentication"></a>Обычная проверка подлинности

Чтобы явно установить [*обычную*](windows-remote-management-glossary.md) проверку подлинности в вызове [**WSMan. CreateSession**](wsman-createsession.md), установите флаги **всманфлагусебасик** и **всманфлагкредусернамепассворд** в параметре *flags* . Обычная проверка подлинности отключена в параметрах конфигурации по умолчанию для клиента WinRM и сервера WinRM.

## <a name="digest-authentication"></a>Дайджест-проверка подлинности

Чтобы явно установить [*дайджест*](windows-remote-management-glossary.md) -проверку подлинности в вызове [**WSMan. CreateSession**](wsman-createsession.md), установите флаг **всманфлагуседижест** в параметре *flags* . Дайджест не поддерживается. Его нельзя настроить для компонента сервера WinRM.

## <a name="negotiate-authentication"></a>Согласование проверки подлинности

Чтобы явно установить проверку подлинности [*согласования*](windows-remote-management-glossary.md) , также известную как встроенная проверка подлинности Windows, в вызове [**WSMan. CreateSession**](wsman-createsession.md)установите флаг **всманфлагусенеготиате** в параметре *flags* .

[Управление учетными записями пользователей (UAC)](https://support.microsoft.com/help/922708/how-to-use-user-account-control-uac-in-windows-vista) влияет на доступ к службе WinRM. Если в Рабочей группе используется проверка подлинности Negotiate, доступ к службе может получить только встроенная учетная запись администратора. Чтобы разрешить всем учетным записям в группе "Администраторы" доступ к службе, задайте следующее значение реестра:

**HKey \_ \_** \\ **Программное обеспечение** локального компьютера \\ политики **Microsoft** \\ **Windows** \\ **CurrentVersion** \\ **Политика** для \\ **системного** параметра \\ = 1

## <a name="kerberos-authentication"></a>Проверка подлинности Kerberos

Чтобы явно установить проверку подлинности [*Kerberos*](windows-remote-management-glossary.md) в вызове [**WSMan. CreateSession**](wsman-createsession.md), установите флаг **всманфлагусекерберос** в параметре *flags* . Как клиент, так и серверные компьютеры должны быть присоединены к домену. При использовании Kerberos в качестве метода проверки подлинности нельзя использовать IP-адрес в вызове [**WSMan. CreateSession**](wsman-createsession.md) или [**Ивсман:: CreateSession**](/windows/desktop/api/WSManDisp/nf-wsmandisp-iwsman-createsession).

## <a name="client-certificate-based-authentication"></a>Проверка подлинности на основе сертификата клиента

Чтобы установить проверку подлинности на основе сертификата клиента в вызове [**WSMan. CreateSession**](wsman-createsession.md), установите флаг **всманфлагусеклиентцертификате** в параметре *flags* .

Сначала необходимо включить проверку подлинности на основе сертификата как для клиента, так и для службы с помощью программы командной строки WinRM. Дополнительные сведения см. в разделе [Включение параметров проверки подлинности](#enabling-or-disabling-authentication-options). Кроме того, необходимо создать запись в таблице CertMapping на компьютере сервера WinRM. Это устанавливает сопоставление между одним или несколькими сертификатами и локальной учетной записью. После того как сертификат будет использован для проверки подлинности и авторизации, для операций, выполняемых службой WinRM, используется соответствующая локальная учетная запись.

Сопоставление можно создать для определенного URI ресурса. Чтобы получить дополнительные сведения, включая создание записи таблицы CertMapping, введите **WinRM Help CertMapping** в командной строке.

> [!Note]  
> Максимальный размер сертификата, используемого WinRM в этом контексте, — 16 КБ.

 

## <a name="enabling-or-disabling-authentication-options"></a>Включение или отключение параметров проверки подлинности

Параметр проверки подлинности по умолчанию при установке системы — Kerberos. Дополнительные сведения см. в разделе [Установка и настройка для служба удаленного управления Windows](installation-and-configuration-for-windows-remote-management.md).

Если для сценария или приложения требуется конкретный метод проверки подлинности, который не включен, необходимо изменить конфигурацию, чтобы включить такой тип проверки подлинности. Это изменение можно выполнить с помощью средства командной строки **WinRM** или групповая политика для **объекта Служба удаленного управления Windows групповая политика**. Вы также можете отключить определенные методы проверки подлинности.

**Включение или отключение проверки подлинности с помощью средства WinRM**

1.  Чтобы задать конфигурацию для клиента WinRM, используйте команду **WinRM Set** и укажите клиент. Например, следующая команда отключает дайджест-проверку подлинности для клиента.

    **WinRM set winrm/config/Client/auth @ {Digest = "false"}**

2.  Чтобы задать конфигурацию для сервера WinRM, используйте команду **WinRM Set** и укажите службу. Например, следующая команда включает проверку подлинности Kerberos для службы.

    **WinRM set winrm/config/Service/auth @ {Kerberos = "true"}**

## <a name="related-topics"></a>См. также

<dl> <dt>

[О служба удаленного управления Windows](about-windows-remote-management.md)
</dt> <dt>

[**WSMan. CreateSession**](wsman-createsession.md)
</dt> <dt>

[Использование служба удаленного управления Windows](using-windows-remote-management.md)
</dt> </dl>

 

 




