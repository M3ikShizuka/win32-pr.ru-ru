---
description: Как создать базовое вспомогательное приложение для IP-адресов.
ms.assetid: b53f1cf5-3659-407e-8279-5c94333f3017
title: Создание базового вспомогательного приложения IP-адресов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: baae961f8ffb6aa899e96fd05f0cb9f0c41469ee
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104350265"
---
# <a name="creating-a-basic-ip-helper-application"></a>Создание базового вспомогательного приложения IP-адресов

**Создание базового вспомогательного приложения IP-адресов**

1.  Создайте новый пустой проект.
2.  Добавьте пустой исходный файл C++ в проект.
3.  Убедитесь, что среда сборки ссылается на каталоги include, lib и src пакета средств разработки программного обеспечения (SDK) платформы.
4.  Убедитесь, что среда сборки ссылается на файл вспомогательной библиотеки IP-адресов Ифлпапи. lib и файл библиотеки Winsock WS2 \_ 32. lib.
    > [!Note]  
    > Некоторые основные функции Winsock используются для возврата значений IP-адресов и других сведений.

     

5.  Начните программировать вспомогательное приложение IP. Используйте API вспомогательной функции IP, включив файл заголовка модуля поддержки IP.

    ```C++
    #include <winsock2.h>
    #include <iphlpapi.h>
    #include <stdio.h>

    int main() {
      return 0;
    }
    
    ```

    

    > [!Note]
    >
    > Файл заголовка *ифлпапи. h* необходим для приложений, использующих вспомогательные функции IP. Файл заголовка *ифлпапи. h* автоматически включает другие файлы заголовков с структурами и перечислениями, используемыми вспомогательными функциями IP.
    >
    > Новые вспомогательные функции IP, появившиеся в Windows Vista и более поздних версиях, определены в файле заголовка *нетиоапи. h* , который автоматически включается в заголовочный файл *ифлпапи. h* . Файл заголовка *нетиоапи. h* никогда не должен использоваться напрямую.
    >
    > Многие структуры и перечисления, используемые вспомогательными функциями IP, определены в файлах заголовков *ипртрмиб. h*, *ипекспорт. h* и *иптипес. h* . Эти файлы заголовков автоматически включаются в файл заголовка *ифлпапи. h* и никогда не должны использоваться напрямую.
    >
    > В пакете средств разработки программного обеспечения Microsoft Windows (SDK), выпущенном для Windows Vista и более поздних версий, изменилась Организация файлов заголовков. Некоторые структуры теперь определены в файлах заголовков *ипмиб. h*, *ткпмиб. h* и *удпмиб. h* , а не в файле заголовка *ипртрмиб. h* . Файл заголовка *ипмиб. h* автоматически включает файл заголовка *Ifmib. h* . Обратите внимание, что эти файлы заголовков автоматически включаются в *ипртрмиб. h*, который автоматически включается в заголовочный файл *ифлпапи. h* .
    >
    > Для большинства приложений, использующих API-интерфейсы модуля поддержки IP, требуется заголовочный файл *Winsock2. h* для сокетов Windows 2,0. Если требуется файл заголовка *Winsock2. h* , \# необходимо поместить строку включения для этого файла перед \# строкой include для файла заголовка *ифлпапи. h* .
    >
    > Заголовочный файл *Winsock2. h* внутренне включает основные элементы из файла заголовков *Windows. h* , поэтому обычно \# в вспомогательных приложениях IP отсутствует строка include для файла заголовка *Windows. h* . Если \# для файла заголовка *Windows. h* требуется строка include, перед ней следует \# указать макрос define Win32 \_ экономичное \_ и \_ среднее. По историческим причинам заголовок *Windows. h* по умолчанию включает в себя файл заголовка *Winsock. h* для сокетов Windows 1,1. Объявления в файле заголовка *Winsock. h* для сокетов Windows 1,1 будут конфликтовать с объявлениями в файле заголовков *Winsock2. h* , который требуется для Windows Sockets 2,0. \_Макрос экономичного \_ и \_ среднего значения Win32 предотвращает включение заголовочного файла *Winsock. h* в заголовочный файл *Windows. h* . Пример, иллюстрирующий это, показан ниже.

     

    ```C++
    #ifndef WIN32_LEAN_AND_MEAN
    #define WIN32_LEAN_AND_MEAN
    #endif

    #include <windows.h>

    #include <winsock2.h>
    #include <iphlpapi.h>
    #include <stdio.h>

    int main() {
      return 0;
    }
    
    ```

    

    > [!Note]
    >
    > Это базовое вспомогательное приложение IP использует только некоторые структуры данных IP-адресов и IP-адрес для функций преобразования строк из сокетов Windows 2,0. Эти функции сокетов Windows можно использовать без вызова [**сбой WSAStartup**](/windows/desktop/api/winsock/nf-winsock-wsastartup) для инициализации ресурсов сокетов Windows и [**всаклеануп**](/windows/desktop/api/winsock/nf-winsock-wsacleanup) по завершении использования этих ресурсов.
    >
    > В вспомогательных приложениях IP, использующих другие функции Winsock, отличные от этих IP-адресов, для строковых функций необходимо вызвать функцию [**сбой WSAStartup**](/windows/desktop/api/winsock/nf-winsock-wsastartup) , чтобы инициализировать ресурсы сокетов Windows, прежде чем вызывать функции сокетов Windows и [**всаклеануп**](/windows/desktop/api/winsock/nf-winsock-wsacleanup) при завершении работы приложения с помощью ресурсов сокетов Windows.

     

    > [!Note]
    >
    > Файл заголовка *stdio. h* необходим для использования различных стандартных функций C в этом базовом вспомогательном приложении IP.

     

    Следующий шаг: [Получение сведений с помощью жетнетворкпарамс](retrieving-information-using-getnetworkparams.md)

 

 
