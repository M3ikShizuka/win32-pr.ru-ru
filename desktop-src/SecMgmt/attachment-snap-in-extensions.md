---
description: Расширение оснастки вложений — это компонент вложения, который отображает пользовательский интерфейс, зависящий от службы.
ms.assetid: 1cafa02f-f240-476c-8ce2-ba088afaf889
title: Расширения оснастки вложений
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c55267edcd30f32ad371a4aa276587b4eca06c57
ms.sourcegitcommit: de72a1294df274b0a71dc0fdc42d757e5f6df0f3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/05/2021
ms.locfileid: "105664843"
---
# <a name="attachment-snap-in-extensions"></a>Расширения оснастки вложений

Расширение оснастки вложений — это компонент вложения, который отображает пользовательский интерфейс, зависящий от службы. Расширение оснастки размещается в оснастках настройки безопасности. Обмен данными между расширением вложений и узлом оснастки осуществляется стандартными механизмами MMC, описанными в документации по [консоли управления (Майкрософт](/previous-versions/windows/desktop/mmc/microsoft-management-console-start-page) ).

Помимо интерфейсов, которые должен поддерживать расширение оснастки, чтобы быть расширением оснастки MMC, расширение оснастки вложения также должно поддерживать COM-интерфейс [**исцесвкаттачментперсистинфо**](/windows/desktop/api/Scesvc/nn-scesvc-iscesvcattachmentpersistinfo). Этот интерфейс реализует методы, которые указывают, существуют ли данные, относящиеся к службе, которые должны быть сохранены в базе данных безопасности, и, если это так, извлекают и сохраняют эти новые данные. Оснастки настройки безопасности вызывают методы этого интерфейса регулярно для обновления базы данных безопасности.

Оснастки настройки безопасности реализуют интерфейс [**исцесвкаттачментдата**](/windows/desktop/api/Scesvc/nn-scesvc-iscesvcattachmentdata), который предоставляет методы для получения данных, относящихся к службе, из базы данных безопасности. Расширения оснастки вложений могут вызывать методы этого интерфейса для получения данных из базы данных безопасности.

Эта архитектура показана на следующей схеме.

![расширения оснастки вложений](images/model2.png)

При создании расширения оснастки вложения необходимо установить и зарегистрировать его с помощью оснасток настройки безопасности. Это можно сделать, добавив ключи в реестр, как описано в разделе [Регистрация расширения оснастки вложений](registering-an-attachment-snap-in-extension.md). При запуске оснастки настройки безопасности она проверяет реестр и загружает все зарегистрированные расширения оснастки. Расширения отображаются в виде узлов в области безопасности для каждой службы в оснастке настройки безопасности.

> [!Note]
> Расширение оснастки вложений может расширять только узлы служб. Узел службы — это оснастка MMC, содержащая средства для администрирования служб, установленных в системе. Расширение оснастки вложения объявляет себя подчиненным для определенного типа узла служб, а затем для каждого вхождения этого типа узла консоль MMC автоматически добавляет соответствующие расширения оснастки.
> 
> Каждое расширение оснастки вложений владеет одним узлом области области и связанной областью результатов в MMC.

 

 

 
