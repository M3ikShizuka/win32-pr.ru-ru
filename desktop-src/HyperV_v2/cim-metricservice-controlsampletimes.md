---
description: Позволяет запустить сбор метрик точки во времени и указать предпочтительное время интервала выборки для периодического сбора данных.
ms.assetid: 3dd6dc16-a618-49ff-bbaf-cfa25c249cf1
title: Метод Контролсамплетимес класса CIM_MetricService
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- CIM_MetricService.ControlSampleTimes
api_type:
- COM
api_location:
- vmms.exe
ms.openlocfilehash: 2e32d184199ff7ddc63be5d1fcfcd4ea376dad89
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105683556"
---
# <a name="controlsampletimes-method-of-the-cim_metricservice-class"></a>Метод Контролсамплетимес \_ класса CIM метриксервице

Позволяет запустить сбор метрик точки во времени и указать предпочтительное время интервала выборки для периодического сбора данных.

При запуске выборки для дополнительных метрик можно использовать параметры, заданные этим методом.

## <a name="syntax"></a>Синтаксис


```mof
uint32 ControlSampleTimes(
  [in] datetime StartSampleTime,
  [in] datetime PreferredSampleInterval,
  [in] boolean  RestartGathering
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*Стартсамплетиме* \[ окне\]
</dt> <dd>

Момент времени, когда необходимо запустить выборку для метрик.

Значение 99990101000000.000000 + 000 указывает, что выборка должна начаться в следующий раз, когда она будет синхронизирована с полным временем. Выборка синхронизируется с полным часами (в секундах), так как интервал выборки от полуночи по модулю в секундах равен 0.

</dd> <dt>

*Преферредсамплеинтервал* \[ окне\]
</dt> <dd>

Предпочтительное время интервала выборки. Чтобы получить коррелированные метрики, рекомендуется выбрать интервал выборки таким образом, чтобы интервал выборки по модулю 3600 в секундах был равен 0.

Для определения того, учитывается ли запрошенное время интервала выборки, отвечает реализация службы метрик CIM.

Клиент CIM может проверить, учитывают ли поставщики метрик запрошенное время интервала выборки, извлекая связанные экземпляры Басеметрикдефинитион и проверяя содержимое [**CIM \_ басеметрикдефинитион**](cim-basemetricdefinition.md).**Свойство SampleInterval** .

</dd> <dt>

*Рестартгасеринг* \[ окне\]
</dt> <dd>

**Значение true** , чтобы запрос на сбор всех метрик, связанных со службой метрик, был повторно запущен с помощью этого вызова метода.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Возвращает значение 0 в случае успешного выполнения; в противном случае возвращает ошибку.

<dl> <dt>

**Успешно** (0)
</dt> <dt>

**Не поддерживается** (1)
</dt> <dt>

**Сбой** (2)
</dt> <dt>

**Метод зарезервирован** (..)
</dt> <dt>

**Зависит от поставщика** (32768.65 535)
</dt> </dl>

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|---------------------------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows 8.1<br/>                                                                                  |
| Минимальная версия сервера<br/> | Windows Server 2012 R2<br/>                                                                       |
| Пространство имен<br/>                | Корневая \\ виртуализация \\ версии 2<br/>                                                                     |
| MOF<br/>                      | <dl> <dt>Виндовсвиртуализатион. v2. mof</dt> </dl> |
| DLL<br/>                      | <dl> <dt>Vmms.exe</dt> </dl>                     |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**\_МЕТРИКСЕРВИЦЕ CIM**](cim-metricservice.md)
</dt> </dl>

 

 




