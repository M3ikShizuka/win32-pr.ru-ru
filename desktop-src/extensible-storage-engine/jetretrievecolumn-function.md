---
description: Дополнительные сведения о функции Жетретриевеколумн
title: Функция JetRetrieveColumn
TOCTitle: JetRetrieveColumn Function
ms:assetid: 1e55063f-6033-4416-a9a6-894032fed069
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269198(v=EXCHG.10)
ms:contentKeyID: 32765501
ms.date: 04/11/2016
ms.topic: reference
api_name:
- JetRetrieveColumn
topic_type:
- kbArticle
- apiref
api_type:
- COM
- DLLExport
api_location:
- ESENT.DLL
ROBOTS: INDEX,FOLLOW
ms.openlocfilehash: f8a9ce96be028329dea18f32459fbde88b80b75f
ms.sourcegitcommit: 4665ebce0c106bdb52eef36e544280b496b6f50b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/26/2021
ms.locfileid: "122985627"
---
# <a name="jetretrievecolumn-function"></a>Функция JetRetrieveColumn


_**Применимо к:** Windows | Windows Сервером_

## <a name="jetretrievecolumn-function"></a>Функция JetRetrieveColumn

Функция **жетретриевеколумн** извлекает значение одного столбца из текущей записи. Запись — это запись, связанная с записью индекса в текущем положении курсора. Кроме того, эта функция может извлекать столбец из записи, создаваемой в буфере копирования курсора. Эта функция также может получать данные столбца из записи индекса, которая ссылается на текущую запись. Помимо получения фактического значения столбца, **жетретриевеколумн** можно также использовать для получения размера столбца перед извлечением самих данных столбца, чтобы можно было соответствующим образом изменить размер буферов приложения.

```cpp
    JET_ERR JET_API JetRetrieveColumn(
      __in          JET_SESID sesid,
      __in          JET_TABLEID tableid,
      __in          JET_COLUMNID columnid,
      __out_opt     void* pvData,
      __in          unsigned long cbData,
      __out_opt     unsigned long* pcbActual,
      __in          JET_GRBIT grbit,
      __in_out_opt  JET_RETINFO* pretinfo
    );
```

### <a name="parameters"></a>Параметры

*сесид*

Сеанс, используемый для этого вызова.

*TableID*

Курсор, используемый для этого вызова.

*columnid*

[JET_COLUMNID](./jet-columnid.md) столбца для извлечения.

Можно указать значение *columnid* , равное 0 (нулю), которое само по себе не относится к какому-либо отдельному столбцу. Если задано значение *columnid* 0 (ноль), все столбцы с тегами, разреженные и Многозначные столбцы рассматриваются как один столбец. Это упрощает извлечение всех разреженных столбцов, имеющихся в записи.

*пвдата*

Выходной буфер, который получает значение столбца.

*cbData*

Максимальный размер выходного буфера в байтах.

*пкбактуал*

Получает фактический размер значения столбца в байтах.

Если этот параметр имеет **значение NULL**, фактический размер значения столбца не будет возвращен.

*грбит*

Группа битов, содержащая параметры, которые должны использоваться для этого вызова, в том числе ноль или более следующих:


| <p>Значение</p> | <p>Значение</p> | 
|--------------|----------------|
| <p>JET_bitRetrieveCopy</p> | <p>Этот флаг заставляет столбец извлечь измененное значение, а не исходное значение. Если значение не было изменено, то извлекается исходное значение. Таким образом, значение, которое еще не было вставлено или Обновлено, может быть получено во время операции вставки или обновления записи.</p> | 
| <p>JET_bitRetrieveFromIndex</p> | <p>Этот параметр используется для извлечения значений столбцов из индекса, если это возможно, без обращения к записи. Таким образом, необязательная Загрузка записей может быть продолжена, если нужные данные будут доступны из самих записей индекса. В случаях, когда исходное значение столбца не может быть получено из индекса из-за необратимых преобразований или усечения данных, доступ к записи будет осуществляться, а данные будут извлечены как обычные. Это параметр производительности, и его следует указывать только в том случае, если вероятно, что значение столбца может быть извлечено из индекса. Этот параметр не следует указывать, если текущим индексом является кластеризованный индекс, поскольку записи индекса для кластеризованного или первичного индекса являются записями. Этот бит не может быть установлен, если также задано JET_bitRetrieveFromPrimaryBookmark.</p> | 
| <p>JET_bitRetrieveFromPrimaryBookmark</p> | <p>Этот параметр используется для извлечения значений столбцов из закладки индекса и может отличаться от значения индекса, если столбец отображается как в первичном, так и в текущем индексе. Этот параметр не следует указывать, если текущий индекс является кластеризованным или первичным индексом. Этот бит не может быть установлен, если также задано JET_bitRetrieveFromIndex.</p> | 
| <p>JET_bitRetrieveTag</p> | <p>Этот параметр используется для получения порядкового номера значения столбца с несколькими значениями в претинфо- &gt; итагсекуенце. Поле Итагсекуенце обычно является входным для извлечения значений столбца с несколькими значениями из записи. Однако при извлечении значений из индекса также можно связать запись индекса с определенным порядковым номером и получить также этот порядковый номер. Получение порядкового номера может быть дорогостоящей операцией, и ее следует выполнять только при необходимости.</p> | 
| <p>JET_bitRetrieveNull</p> | <p>Этот параметр используется для извлечения значений <strong>null</strong> в столбцах с несколькими значениями. Если этот параметр не указан, значения <strong>null</strong> в столбцах с несколькими значениями будут пропускаться автоматически.</p> | 
| <p>JET_bitRetrieveIgnoreDefault</p> | <p>Этот параметр влияет только на столбцы с несколькими значениями и приводит к возвращению значения <strong>null</strong> , если запрошенный порядковый номер равен 1, а значения для столбца в записи не заданы.</p> | 
| <p>JET_bitRetrieveLongId</p> | <p>Этот флаг предназначен только для внутреннего использования и не предназначен для использования в приложении.</p> | 
| <p>JET_bitRetrieveLongValueRefCount</p> | <p>Этот флаг предназначен только для внутреннего использования и не предназначен для использования в приложении.</p> | 
| <p>JET_bitRetrieveTuple</p> | <p>Этот флаг разрешает извлечение сегмента кортежа в индексе. Этот бит должен быть указан с JET_bitRetrieveFromIndex.</p> | 



*претинфо*

Если *претинфо* имеет **значение NULL** , функция ведет себя так, как будто *итагсекуенце* равен 1 и *иблонгвалуе* 0 (нуль). Это приводит к извлечению столбца для получения первого значения многозначного столбца, а также для получения длинных данных со смещением 0 (нулем).

Этот параметр используется для предоставления одного или нескольких из следующих параметров:


| <p>Значение</p> | <p>Значение</p> | 
|--------------|----------------|
| <p>иблонгвалуе</p> | <p>Предоставляет двоичное смещение в длинном значении столбца при извлечении части значения столбца.</p> | 
| <p>итагсекуенце</p> | <p>Возвращает порядковый номер нужного значения столбца с несколькими значениями. Обратите внимание, что это поле задается только в том случае, если указано JET_bitRetrieveTag. В противном случае он не изменяется.</p> | 
| <p>колумниднексттагжед</p> | <p>Возвращает идентификатор возвращенного значения столбца при извлечении всех столбцов с тегами, разреженных и многозначных, с использованием передачи <em>columnid</em> 0 (нуль).</p> | 



### <a name="return-value"></a>Возвращаемое значение

Эта функция возвращает [JET_ERR](./jet-err.md) DataType с одним из следующих кодов возврата. дополнительные сведения о возможных ошибках подсистемы ESE см. в разделе [ошибки расширенных служба хранилища Engine](./extensible-storage-engine-errors.md) и [параметры обработки ошибок](./error-handling-parameters.md).


| <p>Код возврата</p> | <p>Описание</p> | 
|--------------------|--------------------|
| <p>JET_errSuccess</p> | <p>Операция выполнена успешно.</p> | 
| <p>JET_errBadColumnId</p> | <p>Указанный идентификатор столбца находится за пределами допустимых ограничений идентификатора столбца.</p> | 
| <p>JET_errBadItagSequence</p> | <p>Недопустимое значение порядкового номера столбца с несколькими значениями было передано в претинфо- &gt; итагсекуенце. Допустимые значения для порядковых номеров значений столбца с несколькими значениями: 1 или более. Значение 0 (ноль) недопустимо для этой функции.</p> | 
| <p>JET_errClientRequestToStopJetService</p> | <p>Невозможно выполнить операцию, так как все действия в экземпляре, связанном с сеансом, были прекращены в результате вызова <a href="gg269240(v=exchg.10).md">жетстопсервице</a>.</p> | 
| <p>JET_errColumnNotFound</p> | <p>Столбец, описываемый данным <em>columnid</em> , не существует в таблице.</p> | 
| <p>JET_errIndexTuplesCannotRetrieveFromIndex</p> | <p>Столбцы, индексируемые как подстроки, не могут быть извлечены из индекса, так как в каждой записи индекса обычно содержится только небольшая часть столбца.</p> | 
| <p>JET_errInstanceUnavailable</p> | <p>Невозможно выполнить операцию, поскольку экземпляр, связанный с сеансом, обнаружил неустранимую ошибку, которая требует, чтобы доступ ко всем данным был отозван для защиты целостности этих данных. эта ошибка будет возвращена только Windows XP и более поздних выпусках.</p> | 
| <p>JET_errInvalidBufferSize</p> | <p>В некоторых случаях буфер, заданный для столбца получения, должен иметь достаточный размер, чтобы вернуть любой объем значения столбца. Например, депонированные обновляемые столбцы настраиваются таким образом, чтобы они были согласованы в транзакционном контексте вызывающего сеанса, и эта корректировка требует наличия буфера, предоставленного вызывающим объектом. Если предоставлено недостаточное место в буфере, возвращается JET_errInvalidBufferSize и данные столбца не возвращаются.</p> | 
| <p>JET_errInvalidParameter</p> | <p>Один или несколько указанных параметров неверны. Это может произойти, если размер ретинфо. Кбструкт меньше, чем <a href="gg294049(v=exchg.10).md">JET_RETINFO</a>.</p> | 
| <p>JET_errInvalidgrbit</p> | <p>Указанные параметры неизвестны или являются недопустимым сочетанием известных битовых параметров.</p> | 
| <p>JET_errNoCurrentRecord</p> | <p>Курсор не располагается на записи. Это может произойти по различным причинам. Например, это произойдет, если курсор находится в данный момент после последней записи в текущем индексе.</p> | 
| <p>JET_errNotInitialized</p> | <p>Невозможно выполнить операцию, так как экземпляр, связанный с сеансом, еще не инициализирован.</p> | 
| <p>JET_errRestoreInProgress</p> | <p>Невозможно выполнить операцию, так как в экземпляре, связанном с сеансом, выполняется операция восстановления.</p> | 
| <p>JET_errSessionSharingViolation</p> | <p>Один и тот же сеанс нельзя использовать одновременно для нескольких потоков.</p><p><strong>Windows XP:</strong>  эта ошибка будет возвращена только Windows XP и более поздних выпусках.</p> | 
| <p>JET_errTermInProgress</p> | <p>Невозможно выполнить операцию, так как выполняется завершение работы экземпляра, связанного с сеансом.</p> | 
| <p>JET_wrnBufferTruncated</p> | <p>Не удалось получить значение полного столбца, так как размер данного буфера меньше размера столбца.</p> | 
| <p>JET_wrnColumnNull</p> | <p>Полученное значение столбца равно <strong>null</strong>.</p> | 



При успешном выполнении значение столбца для данного столбца копируется в заданный буфер. Значение меньше всех значений столбца копируется с предупреждением, JET_wrnBufferTruncated возвращается. Если было задано значение *пкбактуал* , возвращается фактический размер значения столбца. Обратите внимание, что значения **null** имеют нулевую длину и, таким словами, задают возвращаемый размер равным 0 (нулю). Если извлеченным столбцом был многозначный столбец, а JET_bitReturnTag *претинфо* был задан как параметр, то порядковый номер значения столбца возвращается в претинфо- \> итагсекуенце.

В случае сбоя положение курсора остается неизменным и данные не копируются в предоставленный буфер.

#### <a name="remarks"></a>Комментарии

Этот вызов используется только один раз для получения данных фиксированного или известного размера для столбцов, не являющихся многозначными. Однако, если данные столбца имеют неизвестный размер, этот вызов обычно используется дважды. Сначала вызывается метод, чтобы определить размер данных, чтобы он мог выделить необходимое дисковое пространство. Затем выполняется тот же вызов для получения данных столбца. Если фактическое число значений неизвестно, так как столбец является многозначным, вызов обычно используется три раза. Сначала необходимо получить количество значений, а затем дважды больше, чтобы выделить память и получить реальные данные.

Извлечение всех значений для многозначного столбца можно выполнить, повторно вызвав эту функцию с претинфо- \> итагсекуенце значением, начинающимся с 1 и увеличивая при каждом последующем вызове. Значение последнего столбца известно для извлечения при возвращении JET_wrnColumnNull из функции. Обратите внимание, что этот метод не может быть выполнен, если в последовательности значений столбца с несколькими значениями заданы явные значения **null** , так как эти значения будут пропущены. Если приложению требуется получить все значения столбцов с несколькими значениями, в том числе явно заданные в **null**, необходимо использовать [жетретриевеколумнс](./jetretrievecolumns-function.md) вместо **жетретриевеколумн**. Обратите внимание, что эта функция не возвращает число значений для многозначной функции, если задано значение *итагсекуенце* 0 (ноль). Только [жетретриевеколумнс](./jetretrievecolumns-function.md) возвращает количество значений значения столбца, если передано значение *итагсекуенце* 0 (нуль).

Если эта функция вызывается на уровне транзакции 0 (ноль), например, вызывающий сеанс не находится в транзакции, то транзакция открывается и закрывается в функции. Целью этого является возврат последовательных результатов в случае, если длинное значение охватывает страницы базы данных. Обратите внимание, что транзакция освобождается между вызовами функций и серией вызовов этой функции, если сеанс не находится в транзакции, может возвращать данные, обновленные после первого вызова этой функции.

Значение столбца по умолчанию будет извлечено, если для столбца не задано явно другое значение, если не задан параметр JET_bitRetrieveIgnoreDefault.

Получение значения столбца AutoIncrement из буфера копирования до вставки является распространенным средством идентификации записи, уникальной для компоновки при вставке нормализованных данных в несколько таблиц. Значение автоприращения выделяется при начале операции вставки и может быть извлечено из буфера копирования в любое время до завершения обновления.

При извлечении всех столбцов с тегами, многозначными и разреженными столбцами путем установки параметра *columnid* в значение 0 (ноль) столбцы извлекаются в порядке *columnid* с наименьшего значения *columnid* до высшего значения *columnid*. Каждый раз при получении значений столбцов возвращается тот же порядок значений столбцов. Порядок является детерминированным.

#### <a name="requirements"></a>Требования


| Требование | Применение |
|------------|----------|
| <p><strong>Клиент</strong></p> | <p>требуется Windows Vista, Windows XP или Windows 2000 Professional.</p> | 
| <p><strong>Server</strong></p> | <p>требуется Windows server 2008, Windows server 2003 или сервер Windows 2000.</p> | 
| <p><strong>Header</strong></p> | <p>Объявлено в ESENT. h.</p> | 
| <p><strong>Библиотека</strong></p> | <p>Используйте ESENT. lib.</p> | 
| <p><strong>КОМПОНОВКИ</strong></p> | <p>Требуется ESENT.dll.</p> | 



#### <a name="see-also"></a>См. также:

[JET_COLUMNID](./jet-columnid.md)  
[JET_ERR](./jet-err.md)  
[JET_SESID](./jet-sesid.md)  
[JET_TABLEID](./jet-tableid.md)  
[JET_RETINFO](./jet-retinfo-structure.md)  
[жетсетколумн](./jetretrievekey-function.md)  
[жетретриевеколумнс](./jetretrievecolumns-function.md)
