---
description: Дополнительные сведения о функции JetSetCurrentIndex4
title: Функция JetSetCurrentIndex4
TOCTitle: JetSetCurrentIndex4 Function
ms:assetid: 6076d02c-5701-4021-ba0a-da36bff166d1
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269262(v=EXCHG.10)
ms:contentKeyID: 32765564
ms.date: 04/11/2016
ms.topic: reference
api_name:
- JetSetCurrentIndex4W
- JetSetCurrentIndex4A
- JetSetCurrentIndex4
topic_type:
- apiref
- kbArticle
api_type:
- DLLExport
- COM
api_location:
- ESENT.DLL
ROBOTS: INDEX,FOLLOW
ms.openlocfilehash: 234b945e9ebe4421d348eab0e72556b544578b54
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105710871"
---
# <a name="jetsetcurrentindex4-function"></a>Функция JetSetCurrentIndex4


_**Применимо к:** Windows | Windows Server_

## <a name="jetsetcurrentindex4-function"></a>Функция JetSetCurrentIndex4

Функция **JetSetCurrentIndex4** используется для задания текущего индекса курсора. Текущий индекс курсора определяет, какие записи в таблице видимы для этого курсора, и порядок, в котором они отображаются, выбрав набор записей индекса, который будет использоваться для предоставления этих записей.

```cpp
    JET_ERR JET_API JetSetCurrentIndex4(
      __in          JET_SESID sesid,
      __in          JET_TABLEID tableid,
      __in_opt      JET_PCSTR szIndexName,
      __in_opt      JET_INDEXID* pindexid,
      __in          JET_GRBIT grbit,
      __in          unsigned long itagSequence
    );
```

### <a name="parameters"></a>Параметры

*сесид*

Сеанс, используемый для этого вызова.

*TableID*

Курсор, используемый для этого вызова.

*сзиндекснаме*

Имя индекса, выбранного для курсора. Если этот параметр имеет значение NULL или является пустой строкой, выбирается кластеризованный индекс. Если для таблицы определен первичный индекс, то этот индекс будет выбран, так как он совпадает с кластеризованным индексом. Если для таблицы не определен первичный индекс, будет выбран последовательный индекс. Последовательный индекс не имеет определения индекса. Дополнительные сведения см. в разделе [жеткреатеиндекс](./jetcreateindex-function.md) .

Если *pIndexID* не равно null, имя индекса будет игнорироваться, а индекс будет выбран по идентификатору индекса.

*pIndexID*

Идентификатор индекса, выбранного для курсора.

Идентификатор индекса является временным непрозрачным маркером, который можно использовать для быстрого выбора индекса. Этот идентификатор можно получить с помощью Жетжетиндексинфо или Жетжеттаблеиндексинфо с помощью параметра JET_IdxInfoIndexId.

Если *pIndexID* имеет значение null, то индекс будет выбран по имени индекса, а идентификатор индекса будет проигнорирован.

Если этот параметр отсутствует, предполагается, что его значение равно NULL.

*грбит*

Группа битов, содержащая параметры, которые должны использоваться для этого вызова, включая ноль или более следующих значений.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Значение</p></th>
<th><p>Значение</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>JET_bitMoveFirst</p></td>
<td><p>Этот параметр указывает, что курсор должен располагаться на первой записи указанного индекса. Если выбран кластеризованный индекс (первичный индекс или последовательный индекс), а текущий индекс является вторичным индексом, то JET_bitMoveFirst предполагается. Если текущий индекс выбран, этот параметр игнорируется и изменение положения курсора не выполняется.</p></td>
</tr>
<tr class="even">
<td><p>JET_bitNoMove</p></td>
<td><p>Этот параметр указывает, что курсор должен располагаться на записи индекса нового индекса, который соответствует записи, связанной с записью индекса, в текущей позиции курсора по старому индексу.</p>
<p>Если определение нового индекса содержит по крайней мере один ключевой столбец с несколькими значениями, то запись конечного индекса неоднозначно. В этом случае заданный <em>итагсекуенце</em> используется для выбора многозначного многозначного ключевого столбца, используемого для позиционирования курсора. Необходимо только передать один <em>итагсекуенце</em> даже в случае нескольких ключевых столбцов с несколькими значениями, так как ядро расширяет только все значения для наиболее значимого многозначного ключевого столбца. Дополнительные сведения см. в разделе <a href="gg294099(v=exchg.10).md">жеткреатеиндекс</a> .</p>
<p>Если указан JET_bitMoveFirst, этот параметр игнорируется.</p>
<p>Если текущий индекс выбран, этот параметр игнорируется и изменение положения курсора не выполняется. Если этот параметр отсутствует, предполагается, что его значение JET_bitMoveFirst.</p></td>
</tr>
</tbody>
</table>


*итагсекуенце*

Порядковый номер значения столбца с несколькими значениями, который будет использоваться для позиционирования курсора на новом индексе.

Этот параметр используется только в сочетании с JET_bitNoMove. Дополнительные сведения см. в описании этого параметра.

Если этот параметр отсутствует или имеет значение 0, предполагается, что оно равно 1.

### <a name="return-value"></a>Возвращаемое значение

Эта функция возвращает [JET_ERR](./jet-err.md) DataType с одним из следующих кодов возврата. Дополнительные сведения о возможных ошибках ESE см. в разделе [ошибки подсистемы хранилища](./extensible-storage-engine-errors.md) и [Параметры обработки ошибок](./error-handling-parameters.md).

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Код возврата</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>JET_errSuccess</p></td>
<td><p>Операция выполнена успешно.</p></td>
</tr>
<tr class="even">
<td><p>JET_errBadItagSequence</p></td>
<td><p>Вторичный индекс выбирается с параметром JET_bitNoMove и для первого многозначного ключевого столбца в определении нового индекса, соответствующего указанному порядковому номеру, отсутствует значение.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errClientRequestToStopJetService</p></td>
<td><p>Невозможно выполнить операцию, так как все действия в экземпляре, связанном с сеансом, были прекращены в результате вызова <a href="gg269240(v=exchg.10).md">жетстопсервице</a>.</p></td>
</tr>
<tr class="even">
<td><p>JET_errInstanceUnavailable</p></td>
<td><p>Невозможно выполнить операцию, поскольку экземпляр, связанный с сеансом, обнаружил неустранимую ошибку, которая требует, чтобы доступ ко всем данным был отозван для защиты целостности этих данных.</p>
<p>Эта ошибка будет возвращена только Windows XP и более поздних версий.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errInvalidIndexId</p></td>
<td><p>Содержимое идентификатора индекса недопустимо или устарело, и его необходимо обновить. Это может произойти для <strong>JetSetCurrentIndex4</strong> в следующих случаях:</p>
<ul>
<li><p>pIndexID- &gt; кбструкт не имеет ожидаемого размера (Windows Server 2003 и более поздних версий).</p></li>
<li><p>Работа обработчика была завершена, так как был получен идентификатор индекса.</p></li>
<li><p>Все курсоры, ссылающиеся на таблицу, содержащую индекс, соответствующий ИДЕНТИФИКАТОРу индекса, были закрыты и обработчик удалил определение индекса из кэша схемы.</p></li>
<li><p>Идентификатор индекса используется с курсором, открытым в неверной таблице.</p></li>
<li><p>Индекс был удален или еще не виден в сеансе.</p></li>
</ul></td>
</tr>
<tr class="even">
<td><p>JET_errInvalidName</p></td>
<td><p>Одно из указанных имен объектов недопустимо. Все имена объектов должны соответствовать одному и тому же набору правил. Ниже приведены эти правила.</p>
<ul>
<li><p>Имена объектов должны состоять из символов ASCII.</p></li>
<li><p>Имена объектов должны иметь длину по крайней мере один символ.</p></li>
<li><p>Длина имен объектов не может превышать JET_cbNameMost (64) символов.</p></li>
<li><p>Имена объектов не могут начинаться с пробела.</p></li>
<li><p>Имена объектов не могут содержать управляющие символы ASCII (0x00 – 0x1F).</p></li>
<li><p>Имена объектов не могут содержать восклицательный знак (!), точку (.), открывающую квадратную скобку ([) или правую квадратную скобку (]).</p></li>
<li><p>После проверки для имени объекта будет использоваться только часть строки вплоть до первого пробела (если таковая имеется). Это фактически означает, что имена объектов не могут содержать пробелы.</p></li>
</ul></td>
</tr>
<tr class="odd">
<td><p>JET_errInvalidParameter</p></td>
<td><p>Один из указанных параметров содержит непредвиденное значение или содержит значение, которое не имеет смысла при объединении со значением другого параметра. Это может произойти для <strong>JetSetCurrentIndex4</strong> , если <em>PINDEXID</em> не равен null, а pIndexID- &gt; кбструкт не имеет ожидаемого размера (Windows XP и более ранние выпуски).</p></td>
</tr>
<tr class="even">
<td><p>JET_errNoCurrentRecord</p></td>
<td><p>Вторичный индекс выбирается с параметром JET_bitNoMove и в новом индексе отсутствует запись индекса, соответствующая записи, связанной с записью индекса, в текущей позиции курсора по старому индексу.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errNotInitialized</p></td>
<td><p>Невозможно выполнить операцию, так как экземпляр, связанный с сеансом, еще не инициализирован.</p></td>
</tr>
<tr class="even">
<td><p>JET_errOutOfCursors</p></td>
<td><p>Подсистема исчерпала пул ресурсов, используемых для открытия курсоров. С помощью <a href="gg269201(v=exchg.10).md">JET_paramMaxCursors</a>можно управлять максимальным количеством курсоров, которые могут быть открыты в любой момент времени. Дополнительные сведения см. в разделе <a href="gg294044(v=exchg.10).md">жетсетсистемпараметер</a> . Это может произойти для <strong>JetSetCurrentIndex4</strong> , когда был выбран вторичный индекс, и обработчик не может открыть внутренний курсор для использования этого индекса.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errRestoreInProgress</p></td>
<td><p>Невозможно выполнить операцию, так как в экземпляре, связанном с сеансом, выполняется операция восстановления.</p></td>
</tr>
<tr class="even">
<td><p>JET_errSessionSharingViolation</p></td>
<td><p>Один и тот же сеанс нельзя использовать одновременно для нескольких потоков.</p>
<p>Эта ошибка будет возвращена только Windows XP и более поздних версий.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errTermInProgress</p></td>
<td><p>Невозможно выполнить операцию, так как выполняется завершение работы экземпляра, связанного с сеансом.</p></td>
</tr>
</tbody>
</table>


При успешном выполнении текущий индекс курсора задается равным запрошенному индексу. Теперь элементы индекса можно искать с помощью [жетсик](./jetseek-function.md) в соответствии с определением индекса запрошенного индекса. Элементы индекса можно также перечислить с помощью [жетмове](./jetmove-function.md) в порядке, указанном в определении индекса. Текущая позиция курсора либо установлена на первый элемент индекса (JET_bitMoveFirst), либо на конкретную запись индекса, связанную с текущей позицией курсора по старому индексу (JET_bitNoMove). Изменение состояния базы данных не выполняется.

В случае сбоя текущий индекс и текущая позиция курсора находятся в неопределенном состоянии. Изменение состояния базы данных не выполняется.

#### <a name="remarks"></a>Комментарии

Если указание идентификатора индекса устарело, то API просто завершается ошибкой. В данном случае откат к текстовому имени индекса отсутствует, как можно было бы ожидать. Эта резервная копия должна выполняться вручную вызывающим объектом API.

#### <a name="requirements"></a>Требования

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td><p><strong>Клиент</strong></p></td>
<td><p>Требуется Windows Vista, Windows XP или Windows 2000 Professional.</p></td>
</tr>
<tr class="even">
<td><p><strong>Server</strong></p></td>
<td><p>Требуется Windows Server 2008, Windows Server 2003 или Windows 2000 Server.</p></td>
</tr>
<tr class="odd">
<td><p><strong>Header</strong></p></td>
<td><p>Объявлено в ESENT. h.</p></td>
</tr>
<tr class="even">
<td><p><strong>Библиотека</strong></p></td>
<td><p>Используйте ESENT. lib.</p></td>
</tr>
<tr class="odd">
<td><p><strong>КОМПОНОВКИ</strong></p></td>
<td><p>Требуется ESENT.dll.</p></td>
</tr>
<tr class="even">
<td><p><strong>Юникод</strong></p></td>
<td><p>Реализуется как <strong>JetSetCurrentIndex4W</strong> (Юникод) и <strong>JetSetCurrentIndex4A</strong> (ANSI).</p></td>
</tr>
</tbody>
</table>


#### <a name="see-also"></a>См. также:

[JET_ERR](./jet-err.md)  
[JET_GRBIT](./jet-grbit.md)  
[JET_SESID](./jet-sesid.md)  
[JET_TABLEID](./jet-tableid.md)  
[JET_INDEXID](./jet-indexid-structure.md)  
[жеткреатеиндекс](./jetcreateindex-function.md)  
[жетжеткуррентиндекс](./jetgetcurrentindex-function.md)  
[жетжетиндексинфо](./jetgetindexinfo-function.md)  
[жетжеттаблеиндексинфо](./jetgettableindexinfo-function.md)  
[жетмове](./jetmove-function.md)  
[жетсик](./jetseek-function.md)  
[жетсетсистемпараметер](./jetsetsystemparameter-function.md)
