---
description: Дополнительные сведения о функции JetOpenTempTable3
title: Функция JetOpenTempTable3
TOCTitle: JetOpenTempTable3 Function
ms:assetid: 58d6e264-705e-402b-928f-96eefe5e9771
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269255(v=EXCHG.10)
ms:contentKeyID: 32765557
ms.date: 04/11/2016
ms.topic: reference
api_name:
- JetOpenTempTable3
topic_type:
- apiref
- kbArticle
api_type:
- COM
- DLLExport
api_location:
- ESENT.DLL
ROBOTS: INDEX,FOLLOW
ms.openlocfilehash: a1005f9804e0ccf9c4aa5080b3985906471b1386
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127241597"
---
# <a name="jetopentemptable3-function"></a>Функция JetOpenTempTable3


_**Применимо к:** Windows | Windows Сервером_

## <a name="jetopentemptable3-function"></a>Функция JetOpenTempTable3

Функция **JetOpenTempTable3** создает временную таблицу с одним индексом, который может использоваться для хранения и извлечения записей точно так же, как обычная таблица, созданная с помощью [жеткреатетаблеколумниндекс](./jetcreatetablecolumnindex-function.md). Однако временные таблицы выполняются гораздо быстрее, чем обычные таблицы, в связи с их постоянным характером. Они также могут использоваться для очень быстрой сортировки и удаления дубликатов наборов записей при обращении к ним только последовательно.

```cpp
    JET_ERR JET_API JetOpenTempTable3(
      __in          JET_SESID sesid,
      __in          const JET_COLUMNDEF* prgcolumndef,
      __in          unsigned long ccolumn,
      __in_opt      JET_UNICODEINDEX* pidxunicode,
      __in          JET_GRBIT grbit,
      __out         JET_TABLEID* ptableid,
      __out         JET_COLUMNID* prgcolumnid
    );
```

### <a name="parameters"></a>Параметры

*сесид*

Сеанс, используемый для этого вызова.

*пргколумндеф*

Определяет определения столбцов, которые должны быть созданы во временной таблице.

Существуют важные ограничения для параметров определения столбца, которые могут использоваться во временной таблице. Дополнительные сведения см. в разделе "Примечания".

В дополнение к обычным параметрам определения столбца можно также указать ноль или более следующих параметров, которые важны только в контексте временной таблицы.


| <p>Значение</p> | <p>Значение</p> | 
|--------------|----------------|
| <p>JET_bitColumnTTDescending</p> | <p>Этот параметр указывает, что порядок сортировки ключевого столбца для временной таблицы должен быть по убыванию, а не по возрастанию. Если этот параметр указан без JET_bitColumnTTKey то этот параметр игнорируется.</p> | 
| <p>JET_bitColumnTTKey</p> | <p>Этот параметр указывает, что столбец будет ключевым столбцом для временной таблицы.</p><p>Порядок определений столбцов с этим параметром, указанным во входном массиве, определяет приоритет каждого ключевого столбца для временной таблицы. Первое определение столбца в массиве с этим набором параметров будет наиболее значимым ключевым столбцом и т. д. Если запрошено больше ключевых столбцов, чем может поддерживать ядро СУБД, этот параметр игнорируется для неподдерживаемых ключевых столбцов.</p> | 



*кколумн*

См. *пргколумндеф*.

*пидксуникоде*

КОД локали и флаги нормализации, которые будут использоваться для сравнения данных любого ключевого столбца Юникода во временной таблице.

Если этот параметр отсутствует, то для сравнения всех ключевых столбцов Юникода во временной таблице будет использоваться код по умолчанию. По умолчанию используется языковой стандарт «Английский (США)».

Если этот параметр отсутствует, для сравнения данных любого ключевого столбца Юникода во временной таблице будут использоваться флаги нормализации по умолчанию. Флаги нормализации по умолчанию: NORM_IGNORECASE, NORM_IGNOREKANATYPE и NORM_IGNOREWIDTH.

*грбит*

Группа битов, содержащая параметры, которые должны использоваться для этого вызова, включая ноль или более следующих значений.


| <p>Значение</p> | <p>Значение</p> | 
|--------------|----------------|
| <p>JET_bitTTErrorOnDuplicateInsertion</p> | <p>Этот параметр запрашивает неудачную попытку вставки записи с тем же ключом индекса, что и ранее вставленная запись, с JET_errKeyDuplicate. Если этот параметр не запрошен, то дубликат может быть обнаружен немедленно, с ошибкой или автоматически удален позже в зависимости от стратегии, выбранной ядром СУБД для реализации временной таблицы на основе запрошенной функциональности.</p><p>Если эта функция не требуется, то лучше не запрашивать ее. Если эта функция не запрошена, то диспетчер временных таблиц может выбрать стратегию для управления временной таблицей, что приведет к повышению производительности.</p> | 
| <p>JET_bitTTForceMaterialization</p> | <p>Этот параметр заставляет диспетчер временных таблиц отказаться от любой попытки выбрать стратегию для управления временной таблицей, что приведет к повышению производительности.</p> | 
| <p>JET_bitTTForwardOnly</p> | <p>Этот параметр запрашивает создание временной таблицы только в том случае, если диспетчер временных таблиц может использовать реализацию, оптимизированную для промежуточных результатов запроса. Если любая характеристика временной таблицы не позволит использовать эту оптимизацию, операция завершится с JET_errCannotMaterializeForwardOnlySort.</p><p>Побочный результат этого параметра — Разрешить временной таблице содержать записи с повторяющимися ключами индекса. Дополнительные сведения см. в разделе JET_bitTTUnique.</p><p>этот параметр доступен только на Windows Server 2003 и более поздних выпусках.</p> | 
| <p>JET_bitTTIndexed</p> | <p>Этот параметр требует, чтобы временная таблица была достаточно гибкой, чтобы позволить использовать <a href="gg294103(v=exchg.10).md">жетсик</a> для поиска записей по ключу индекса.</p><p>Если эта функция не требуется, то лучше не запрашивать ее. Если эта функция не запрошена, то диспетчер временных таблиц может выбрать стратегию для управления временной таблицей, что приведет к повышению производительности.</p> | 
| <p>JET_bitTTUnique</p> | <p>Этот параметр запрашивает удаление записей с повторяющимися ключами индекса из окончательного набора записей во временной таблице.</p><p>до Windows сервера 2003 в ядре субд всегда предполагается, что этот параметр действует из-за того, что все кластеризованные индексы также должны быть первичным ключом и, таким же, должны быть уникальными. начиная с Windows Server 2003, теперь можно создать временную таблицу, которая не удаляет дубликаты, если также указан параметр JET_bitTTForwardOnly.</p><p>Невозможно понять, какие дубликаты будут выдаваться, и какие дубликаты будут отменены в целом. Однако при запросе параметра JET_bitTTErrorOnDuplicateInsertion первая запись с заданным ключом индекса для вставки во временную таблицу всегда будет выдаваться.</p> | 
| <p>JET_bitTTUpdatable</p> | <p>Этот параметр требует, чтобы временная таблица была достаточно гибкой, чтобы разрешить впоследствии изменять записи, которые были вставлены. Если эта функция не требуется, то лучше не запрашивать ее.</p><p>Если эта функция не запрошена, то диспетчер временных таблиц может выбрать стратегию для управления временной таблицей, что приведет к повышению производительности.</p> | 
| <p>JET_bitTTScrollable</p> | <p>Этот параметр требует, чтобы временная таблица была достаточно гибкой, чтобы разрешить сканирование записей в произвольном порядке и направлении с помощью <a href="gg294117(v=exchg.10).md">жетмове</a>.</p><p>Если эта функция не требуется, то лучше не запрашивать ее. Если эта функция не запрошена, то диспетчер временных таблиц может выбрать стратегию для управления временной таблицей, что приведет к повышению производительности.</p> | 
| <p>JET_bitTTSortNullsHigh</p> | <p>При выборе этого варианта значения ключевого столбца NULL сортируются ближе к концу индекса, чем значения ключевого столбца, отличные от NULL.</p> | 
| <p>JET_bitTTIntrinsicLVsOnly</p> | <p>Запросы на разрешение только внутренних значений типа long.</p><p><strong>Windows 7</strong>: <strong>JET_bitTTIntrinsicLVsOnly</strong> введен в Windows 7.</p> | 



*pTableID*

Выходной буфер, который получит новый курсор, Открытый во вновь созданной временной таблице.

*пргколумнид*

Выходной буфер, который будет принимать массив идентификаторов столбцов, сформированных во время создания временной таблицы.

Идентификаторы столбцов в этом массиве будут точно соответствовать входному массиву определений столбцов. В результате размер этого буфера должен соответствовать размеру входного массива.

### <a name="return-value"></a>Возвращаемое значение

Эта функция возвращает [JET_ERR](./jet-err.md) DataType с одним из следующих кодов возврата. дополнительные сведения о возможных ошибках подсистемы ESE см. в разделе [ошибки расширенных служба хранилища Engine](./extensible-storage-engine-errors.md) и [параметры обработки ошибок](./error-handling-parameters.md).


| <p>Код возврата</p> | <p>Описание</p> | 
|--------------------|--------------------|
| <p>JET_errSuccess</p> | <p>Операция выполнена успешно.</p> | 
| <p>JET_errCannotMaterializeForwardOnlySort</p> | <p>Произошел сбой <strong>JetOpenTempTable3</strong> , так как указана JET_bitTTForwardOnly, а временная таблица указана не может быть создана с помощью оптимизации "только вперед". эта ошибка будет возвращена только Windows Server 2003 и более поздних выпусках.</p> | 
| <p>JET_errClientRequestToStopJetService</p> | <p>Невозможно выполнить операцию, так как все действия в экземпляре, связанном с сеансом, были прекращены в результате вызова <a href="gg269240(v=exchg.10).md">жетстопсервице</a>.</p> | 
| <p>JET_errIndexInvalidDef</p> | <p>Не удалось создать индекс, так как было указано недопустимое определение индекса. <strong>JetOpenTempTable3</strong> будет возвращать эту ошибку в следующих случаях:</p><ul><li><p>Указан языковой стандарт, не зависящий от языка.</p></li><li><p>Указан недопустимый набор флагов нормализации.</p></li></ul><p>эта ошибка будет возвращена только Windows 2000.</p> | 
| <p>JET_errInstanceUnavailable</p> | <p>Невозможно выполнить операцию, поскольку экземпляр, связанный с сеансом, обнаружил неустранимую ошибку, которая требует, чтобы доступ ко всем данным был отозван для защиты целостности этих данных. эта ошибка будет возвращена только Windows XP и более поздних выпусках.</p> | 
| <p>JET_errInvalidCodePage</p> | <p>Элементу <strong>CP</strong> структуры <a href="gg294130(v=exchg.10).md">JET_COLUMNDEF</a> не задана допустимая кодовая страница. Единственными допустимыми значениями для текстовых столбцов являются английский (1252) и Unicode (1200). Значение 0 означает, что будет использоваться по умолчанию (английский, 1252).</p> | 
| <p>JET_errInvalidColumnType</p> | <p>Элементу <strong>колтип</strong> структуры <a href="gg294130(v=exchg.10).md">JET_COLUMNDEF</a> не был задан допустимый тип столбца.</p> | 
| <p>JET_errInvalidLanguageId</p> | <p>Не удалось создать индекс, поскольку была предпринята попытка использовать недопустимый код локали. КОД локали может быть либо полностью недопустимым, либо связанный языковой пакет не может быть установлен.</p> | 
| <p>JET_errInvalidLCMapStringFlags</p> | <p>Не удалось создать индекс, поскольку предпринята попытка использовать недопустимый набор флагов нормализации. эта ошибка будет возвращена только Windows XP и более поздних выпусках. в Windows 2000 недопустимые флаги нормализации приводят к JET_errIndexInvalidDef.</p> | 
| <p>JET_errInvalidSesid</p> | <p>Недопустимый обработчик сеанса или ссылается на закрытый сеанс. Эта ошибка не возвращается при всех обстоятельствах. Дескрипторы проверяются только на основе наилучшей силы.</p> | 
| <p>JET_errNotInitialized</p> | <p>Невозможно выполнить операцию, так как экземпляр, связанный с сеансом, еще не инициализирован.</p> | 
| <p>JET_errOutOfCursors</p> | <p>Не удалось выполнить операцию, так как подсистема не может выделить ресурсы, необходимые для открытия нового курсора. Ресурсы курсора настраиваются с помощью <a href="gg294044(v=exchg.10).md">жетсетсистемпараметер</a> с <a href="gg269201(v=exchg.10).md">JET_paramMaxCursors</a>.</p> | 
| <p>JET_errOutOfMemory</p> | <p>Не удалось выполнить операцию из-за нехватки памяти, выделенной для ее завершения.</p><p><strong>JetOpenTempTable3</strong> может возвращать JET_errOutOfMemory, если адресное пространство хост-процесса оказывается слишком фрагментированным. Временный диспетчер таблиц всегда выделяет 1 МБ адресного пространства для каждой временной таблицы, созданной независимо от объема сохраняемых данных.</p> | 
| <p>JET_errRestoreInProgress</p> | <p>Невозможно выполнить операцию, так как в экземпляре, связанном с сеансом, выполняется операция восстановления.</p> | 
| <p>JET_errSessionSharingViolation</p> | <p>Один и тот же сеанс нельзя использовать одновременно для нескольких потоков.</p><p>эта ошибка будет возвращена только Windows XP и более поздних выпусках.</p> | 
| <p>JET_errTermInProgress</p> | <p>Невозможно выполнить операцию, так как выполняется завершение работы экземпляра, связанного с сеансом.</p> | 
| <p>JET_errTooManyColumns</p> | <p>Предпринята попытка добавить в таблицу слишком много столбцов. Таблица может содержать не более JET_ccolFixedMost фиксированных столбцов, не более JET_ccolVarMost столбцов переменной длины и не более JET_ccolTaggedMost столбцов с тегами.</p> | 
| <p>JET_errTooManyOpenIndexes</p> | <p>Не удалось выполнить операцию, так как подсистема не может выделить ресурсы, необходимые для кэширования индексов таблицы. Количество индексов, схема которых может быть кэширована, настраивается с помощью <a href="gg294044(v=exchg.10).md">жетсетсистемпараметер</a> с <a href="gg269201(v=exchg.10).md">JET_paramMaxOpenTables</a>.</p> | 
| <p>JET_errTooManyOpenTables</p> | <p>Не удалось выполнить операцию, так как подсистема не может выделить ресурсы, необходимые для кэширования схемы таблицы. Количество таблиц, схема которых может быть кэширована, настраивается с помощью <a href="gg294044(v=exchg.10).md">жетсетсистемпараметер</a> с <a href="gg269201(v=exchg.10).md">JET_paramMaxOpenTables</a>.</p> | 
| <p>JET_errTooManySorts</p> | <p>Не удалось выполнить операцию, так как подсистема не может выделить ресурсы, необходимые для создания временной таблицы. Временные ресурсы таблицы настраиваются с помощью <a href="gg294044(v=exchg.10).md">жетсетсистемпараметер</a> с <a href="gg294140(v=exchg.10).md">JET_paramMaxTemporaryTables</a>.</p> | 



При успешном выполнении будет возвращен курсор, Открытый во вновь созданной временной таблице. Состояние временной базы данных будет подготовлено для размещения новой временной таблицы. Состояние всех обычных баз данных, используемых ядром СУБД, останется неизменным.

При сбое временная таблица не будет создана и курсор не будет возвращен. Состояние временной базы данных может быть изменено. Состояние всех обычных баз данных, используемых ядром СУБД, останется неизменным.

#### <a name="requirements"></a>Требования


| Требование | Значение |
|------------|----------|
| <p><strong>Клиент</strong></p> | <p>требуется Windows Vista, Windows XP или Windows 2000 Professional.</p> | 
| <p><strong>Server</strong></p> | <p>требуется Windows server 2008, Windows server 2003 или сервер Windows 2000.</p> | 
| <p><strong>Header</strong></p> | <p>Объявлено в ESENT. h.</p> | 
| <p><strong>Библиотека</strong></p> | <p>Используйте ESENT. lib.</p> | 
| <p><strong>DLL</strong></p> | <p>Требуется ESENT.dll.</p> | 



#### <a name="see-also"></a>См. также:

[ошибки расширенного обработчика служба хранилища](./extensible-storage-engine-errors.md)  
[Параметры обработки ошибок](./error-handling-parameters.md)  
[JET_COLUMNDEF](./jet-columndef-structure.md)  
[JET_COLUMNID](./jet-columnid.md)  
[JET_ERR](./jet-err.md)  
[JET_GRBIT](./jet-grbit.md)  
[JET_SESID](./jet-sesid.md)  
[JET_TABLEID](./jet-tableid.md)  
[JET_UNICODEINDEX](./jet-unicodeindex-structure.md)  
[жетклосетабле](./jetclosetable-function.md)  
[жеткреатетаблеколумниндекс](./jetcreatetablecolumnindex-function.md)  
[жетдупкурсор](./jetdupcursor-function.md)  
[жетмове](./jetmove-function.md)  
[жетопентемптабле](./jetopentemptable-function.md)  
[жетроллбакк](./jetrollback-function.md)  
[жетсик](./jetseek-function.md)  
[жетсетсистемпараметер](./jetsetsystemparameter-function.md)  
[Системные параметры](./extensible-storage-engine-system-parameters.md)
