---
description: Дополнительные сведения о функции Жетделете
title: Функция JetDelete
TOCTitle: JetDelete Function
ms:assetid: 807de5ba-2f4b-4779-ab29-a1f094beecc1
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269315(v=EXCHG.10)
ms:contentKeyID: 32765605
ms.date: 04/11/2016
ms.topic: reference
api_name:
- JetDelete
topic_type:
- apiref
- kbArticle
api_type:
- COM
- DLLExport
api_location:
- ESENT.DLL
ROBOTS: INDEX,FOLLOW
ms.openlocfilehash: 039ddcb0610b6a958e9c45be7e3a898631d2a0fc
ms.sourcegitcommit: 4665ebce0c106bdb52eef36e544280b496b6f50b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/26/2021
ms.locfileid: "122984957"
---
# <a name="jetdelete-function"></a>Функция JetDelete


_**Применимо к:** Windows | Windows Сервером_

## <a name="jetdelete-function"></a>Функция JetDelete

Функция **жетделете** удаляет текущую запись в таблице базы данных.

```cpp
    JET_ERR JET_API JetDelete(
      __in          JET_SESID sesid,
      __in          JET_TABLEID tableid
    );
```

### <a name="parameters"></a>Параметры

*сесид*

Контекст сеанса базы данных, который будет использоваться для вызова API.

*TableID*

Курсор в таблице базы данных. Текущая строка будет удалена.

### <a name="return-value"></a>Возвращаемое значение

Эта функция возвращает [JET_ERR](./jet-err.md) DataType с одним из следующих кодов возврата. дополнительные сведения о возможных ошибках подсистемы ESE см. в разделе [ошибки расширенных служба хранилища Engine](./extensible-storage-engine-errors.md) и [параметры обработки ошибок](./error-handling-parameters.md).


| <p>Код возврата</p> | <p>Описание</p> | 
|--------------------|--------------------|
| <p>JET_errSuccess</p> | <p>Операция выполнена успешно.</p> | 
| <p>JET_errCallbackFailed</p> | <p>Ошибка функции обратного вызова. Например, нарушения прав доступа в функциях обратного вызова перехватываются и преобразуются в JET_errCallbackFailed. эта ошибка будет возвращена только Windows XP и более поздних версий.</p> | 
| <p>JET_errClientRequestToStopJetService</p> | <p>Невозможно выполнить операцию, так как все действия в экземпляре, связанном с сеансом, были прекращены в результате вызова <a href="gg269240(v=exchg.10).md">жетстопсервице</a>.</p> | 
| <p>JET_errIllegalOperation</p> | <p>Курсор, указанный функцией <em>tableid</em> , не поддерживает удаление. См. раздел «Примечания».</p> | 
| <p>JET_errInstanceUnavailable</p> | <p>Невозможно выполнить операцию, поскольку экземпляр, связанный с сеансом, обнаружил неустранимую ошибку, которая требует, чтобы доступ ко всем данным был отозван для защиты целостности этих данных. эта ошибка будет возвращена только Windows XP и более поздних выпусках.</p> | 
| <p>JET_errNoCurrentRecord</p> | <p>Курсор, заданный параметром <em>tableid</em> , не находится в записи.</p> | 
| <p>JET_errNotInitialized</p> | <p>Невозможно выполнить операцию, так как экземпляр, связанный с сеансом, еще не инициализирован.</p> | 
| <p>JET_errRestoreInProgress</p> | <p>Невозможно выполнить операцию, так как в экземпляре, связанном с сеансом, выполняется операция восстановления.</p> | 
| <p>JET_errPermissionDenied</p> | <p>Ядро СУБД не имеет достаточных разрешений для удаления записи. Это может произойти, если файл базы данных был открыт с доступом только для чтения.</p> | 
| <p>JET_errRollbackError</p> | <p>Буфер обновления (см. <a href="gg269339(v=exchg.10).md">жетпрепареупдате</a>) существует, но не все изменения, внесенные в столбцы типа JET_coltypLongText и (или) столбцы типа JET_coltypLongBinary, могут быть отменены.</p> | 
| <p>JET_errSessionSharingViolation</p> | <p>Нельзя одновременно использовать один сеанс из нескольких потоков. эта ошибка будет возвращена только Windows XP и более поздних выпусках.</p> | 
| <p>JET_errTermInProgress</p> | <p>Невозможно выполнить операцию, так как выполняется завершение работы экземпляра, связанного с сеансом.</p> | 
| <p>JET_errTransReadOnly</p> | <p>Транзакция является транзакцией только для чтения и не поддерживает удаления.</p> | 
| <p>JET_errVersionStoreOutOfMemory</p> | <p>Не удалось выполнить операцию, так как недостаточно памяти для удержания транзакционных сведений об обновлении.</p> | 
| <p>JET_errWriteConflict</p> | <p>Другой сеанс ранее заблокировал запись для обновления. Обновление, которое попыталось этот сеанс, завершится ошибкой.</p> | 



В случае успеха валюта остается непосредственно перед следующей записью. Если удаленная запись была последней в таблице, то валюта остается в конце таблицы (то есть после новой записи). Если удаленная запись была единственной записью в таблице, то в качестве валюты устанавливается начало.

Соответствующие индексы обновляются автоматически.

Если обновление подготовлено (с помощью [жетпрепареупдате](./jetprepareupdate-function.md)), оно будет отменено. Буфер обновления будет сброшен.

В случае сбоя валюта остается неизменной. Если обновление подготовлено (см. [жетпрепареупдате](./jetprepareupdate-function.md)), буфер обновления может быть сброшен.

#### <a name="remarks"></a>Комментарии

Не все таблицы поддерживают удаление строк. Как правило, временная таблица не поддерживает удаление строк. Удаление записей может быть включено во временных таблицах по многим причинам:

  - JET_bitTTUpdatable был указан во время создания.

  - Большие временные таблицы могут поддерживать удаление, если они были созданы с помощью JET_bitTTScrollable или JET_bitTTIndexed. Пороговое значение, при достижении которого временная таблица становится "большим", в настоящее время составляет 64 килобайт, но может быть изменено в будущих выпусках.

Windows XP и более поздних версий. Функции обратного вызова могут вызываться **жетделете**, включая JET_cbtypBeforeDelete и JET_cbtypAfterDelete.

Важно понимать влияние выполнения большого количества операций обновления в рамках одной транзакции. Каждое обновление базы данных должно быть отслеживанием ядра СУБД в хранилище версий. Хранилище версий содержит активную запись всех различных версий каждой записи или записи индекса в базе данных, которые могут быть видны всем активным транзакциям. Эти версии используются для поддержки управления параллелизмом с несколькими версиями, используемого ядром СУБД для поддержки транзакций с использованием изоляции моментальных снимков. После того, как ядро СУБД исчерпало ресурсы, используемые для хранения этих версий, оно больше не сможет принять дальнейшие изменения до тех пор, пока некоторые транзакции не разрешают высвободить эти ресурсы. Если обработчик находится в этом состоянии, все обновления будут завершаться с JET_errVersionStoreOutOfMemory. Ресурсы, доступные ядру СУБД для хранения этих версий, можно контролировать с помощью [жетсетсистемпараметер](./jetsetsystemparameter-function.md) с *JET_paramMaxVerPages* и *JET_paramGlobalMinVerPages*.

#### <a name="requirements"></a>Требования


| Требование | Применение |
|------------|----------|
| <p><strong>Клиент</strong></p> | <p>требуется Windows Vista, Windows XP или Windows 2000 Professional.</p> | 
| <p><strong>Server</strong></p> | <p>требуется Windows server 2008, Windows server 2003 или сервер Windows 2000.</p> | 
| <p><strong>Header</strong></p> | <p>Объявлено в ESENT. h.</p> | 
| <p><strong>Библиотека</strong></p> | <p>Используйте ESENT. lib.</p> | 
| <p><strong>КОМПОНОВКИ</strong></p> | <p>Требуется ESENT.dll.</p> | 



#### <a name="see-also"></a>См. также:

[JET_ERR](./jet-err.md)  
[JET_SESID](./jet-sesid.md)  
[JET_TABLEID](./jet-tableid.md)  
[жетопентемптабле](./jetopentemptable-function.md)  
[жетпрепареупдате](./jetprepareupdate-function.md)  
[Системные параметры](./extensible-storage-engine-system-parameters.md)
