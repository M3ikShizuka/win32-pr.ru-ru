---
description: Дополнительные сведения о функции Жетопентемптабле
title: Функция JetOpenTempTable
TOCTitle: JetOpenTempTable Function
ms:assetid: 29261333-a1bc-4159-9046-c32c36f47410
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269211(v=EXCHG.10)
ms:contentKeyID: 32765514
ms.date: 04/11/2016
ms.topic: reference
api_name:
- JetOpenTempTable
topic_type:
- apiref
- kbArticle
api_type:
- COM
- DLLExport
api_location:
- ESENT.DLL
ROBOTS: INDEX,FOLLOW
ms.openlocfilehash: a94af3f142fb7449a95ddf67ad9a0d16f2e37c43
ms.sourcegitcommit: 4665ebce0c106bdb52eef36e544280b496b6f50b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/26/2021
ms.locfileid: "122982407"
---
# <a name="jetopentemptable-function"></a>Функция JetOpenTempTable


_**Применимо к:** Windows | Windows Сервером_

## <a name="jetopentemptable-function"></a>Функция JetOpenTempTable

Функция **жетопентемптабле** создает временную таблицу с одним индексом. Временная таблица хранит и извлекает записи так же, как обычная таблица, созданная с помощью [жеткреатетаблеколумниндекс](./jetcreatetablecolumnindex-function.md). Однако временные таблицы выполняются гораздо быстрее, чем обычные таблицы, в связи с их постоянным характером. Они также могут использоваться для очень быстрой сортировки и удаления дубликатов наборов записей при обращении к ним только последовательно.

```cpp
    JET_ERR JET_API JetOpenTempTable(
      __in          JET_SESID sesid,
      __in          const JET_COLUMNDEF* prgcolumndef,
      __in          unsigned long ccolumn,
      __in          JET_GRBIT grbit,
      __out         JET_TABLEID* ptableid,
      __out         JET_COLUMNID* prgcolumnid
    );
```

### <a name="parameters"></a>Параметры

*сесид*

Используемый сеанс.

*пргколумндеф*

Определения столбцов для столбцов, созданных во временной таблице.

Для параметров определения столбца, используемых во временной таблице, имеются **важные** ограничения. Дополнительные сведения см. в разделе "Примечания".

В дополнение к обычным параметрам определения столбца можно также указать ноль или более следующих параметров, которые важны только в контексте временной таблицы.


| <p>Значение</p> | <p>Значение</p> | 
|--------------|----------------|
| <p>JET_bitColumnTTDescending</p> | <p>Порядок сортировки ключевого столбца для временной таблицы должен быть по убыванию, а не по возрастанию. Если этот параметр указан без JET_bitColumnTTKey то этот параметр игнорируется.</p> | 
| <p>JET_bitColumnTTKey</p> | <p>Столбец будет ключевым столбцом для временной таблицы.</p><p>Порядок определений столбцов с этим параметром, указанным во входном массиве, определяет приоритет каждого ключевого столбца для временной таблицы. Первое определение столбца в массиве, для которого задан этот параметр, будет наиболее значимым ключевым столбцом и т. д. Если запрошено больше ключевых столбцов, чем может поддерживать ядро СУБД, этот параметр игнорируется для неподдерживаемых ключевых столбцов.</p> | 



*кколумн*

См. *пргколумндеф*.

*грбит*

Группа битов, задающая ноль или более следующих параметров.


| <p>Значение</p> | <p>Значение</p> | 
|--------------|----------------|
| <p>JET_bitTTErrorOnDuplicateInsertion</p> | <p>Любая попытка вставить запись с тем же ключом индекса, что и ранее вставленная запись, сразу же завершится с JET_errKeyDuplicate. Если этот параметр не запрашивается, то дубликат обнаруживается немедленно, завершается ошибкой или автоматически удаляется позже, в зависимости от стратегии, выбранной ядром СУБД для реализации временной таблицы в зависимости от запрошенной функциональности.</p><p>Если эта функция не требуется, то лучше не запрашивать ее. Если эта функция не запрошена, то диспетчер временных таблиц может выбрать стратегию для управления временной таблицей, что приведет к повышению производительности.</p> | 
| <p>JET_bitTTForceMaterialization</p> | <p>Заставляет диспетчер временных таблиц отменять поиск лучшей стратегии, используемой для управления временной таблицей, что приведет к повышенной производительности.</p> | 
| <p>JET_bitTTForwardOnly</p> | <p>Временная таблица создается только в том случае, если диспетчер временных таблиц может использовать реализацию, оптимизированную для промежуточных результатов запроса. Если любая характеристика временной таблицы не позволит использовать эту оптимизацию, операция завершится с JET_errCannotMaterializeForwardOnlySort.</p><p>Побочный результат этого параметра — Разрешить временной таблице содержать записи с повторяющимися ключами индекса. Дополнительные сведения см. в разделе JET_bitTTUnique.</p><p>этот параметр доступен только на Windows Server 2003 и более поздних выпусках.</p> | 
| <p>JET_bitTTIndexed</p> | <p>Этот параметр требует, чтобы временная таблица была достаточно гибкой, чтобы позволить использовать <a href="gg294103(v=exchg.10).md">жетсик</a> для поиска записей по ключу индекса.</p><p>Если эта функция не требуется, то лучше не запрашивать ее. Если эта функция не запрошена, то диспетчер временных таблиц может выбрать стратегию для управления временной таблицей, что приведет к повышению производительности.</p> | 
| <p>JET_bitTTUnique</p> | <p>Запросы, в которых записи с повторяющимися ключами индекса удаляются из окончательного набора записей во временной таблице.</p><p>до Windows сервера 2003 в ядре субд всегда предполагается, что этот параметр действует из-за того, что все кластеризованные индексы также должны быть первичным ключом и, таким же, должны быть уникальными. начиная с Windows Server 2003, теперь можно создать временную таблицу, которая не удаляет дубликаты, если также указан параметр JET_bitTTForwardOnly.</p><p>Невозможно выяснить, какие дубликаты будут выполнены, и какие дубликаты будут отменены в целом. Однако при запросе параметра JET_bitTTErrorOnDuplicateInsertion первая запись с заданным ключом индекса для вставки во временную таблицу всегда будет выполнена.</p> | 
| <p>JET_bitTTUpdatable</p> | <p>Требует, чтобы временная таблица была достаточно гибкой, чтобы разрешить впоследствии изменять ранее вставленные записи. Если эта функция не требуется, то лучше не запрашивать ее.</p><p>Если эта функция не запрошена, то диспетчер временных таблиц может выбрать стратегию для управления временной таблицей, что приведет к повышению производительности.</p> | 
| <p>JET_bitTTScrollable</p> | <p>Требует, чтобы временная таблица была достаточно гибкой, чтобы можно было просматривать записи в произвольном порядке и в направлении с помощью <a href="gg294117(v=exchg.10).md">жетмове</a>.</p><p>Если эта функция не является обязательной, лучше не запрашивать ее. Если эта функция не запрошена, то диспетчер временных таблиц может выбрать стратегию для управления временной таблицей, что приведет к повышению производительности.</p> | 
| <p>JET_bitTTSortNullsHigh</p> | <p>Запрашивает, что значения ключевого столбца NULL сортируются ближе к концу индекса, чем значения ключевого столбца, отличного от NULL.</p><p></p> | 
| <p>JET_bitTTIntrinsicLVsOnly</p> | <p>Запросы на разрешение только внутренних значений типа long.</p><p><strong>Windows 7</strong>: <strong>JET_bitTTIntrinsicLVsOnly</strong> введен в Windows 7.</p> | 



*pTableID*

Выходной буфер, который получает новый курсор, Открытый во вновь созданной временной таблице.

*пргколумнид*

Выходной буфер, который получает массив идентификаторов столбцов, созданных во время создания временной таблицы.

Идентификаторы столбцов в этом массиве будут точно соответствовать входному массиву определений столбцов. В результате размер этого буфера должен соответствовать размеру входного массива.

### <a name="return-value"></a>Возвращаемое значение

Эта функция возвращает [JET_ERR](./jet-err.md) DataType с одним из следующих кодов возврата. дополнительные сведения о возможных ошибках подсистемы ESE см. в разделе [ошибки расширенных служба хранилища Engine](./extensible-storage-engine-errors.md) и [параметры обработки ошибок](./error-handling-parameters.md).


| <p>Код возврата</p> | <p>Описание</p> | 
|--------------------|--------------------|
| <p>JET_errSuccess</p> | <p>Операция выполнена успешно.</p> | 
| <p>JET_errCannotMaterializeForwardOnlySort</p> | <p>Произошел сбой <strong>жетопентемптабле</strong> , так как указана JET_bitTTForwardOnly, а временная таблица указана не может быть создана с помощью оптимизации "только вперед". эта ошибка будет возвращена только Windows Server 2003 и более поздних выпусках.</p> | 
| <p>JET_errClientRequestToStopJetService</p> | <p>Невозможно выполнить операцию, так как все действия в экземпляре, связанном с сеансом, были прекращены в результате вызова <a href="gg269240(v=exchg.10).md">жетстопсервице</a>.</p> | 
| <p>JET_errIndexInvalidDef</p> | <p>Не удалось создать индекс, так как было указано недопустимое определение индекса.</p><p><strong>Жетопентемптабле</strong> будет возвращать эту ошибку в следующих случаях:</p><ul><li><p>Указан языковой стандарт, не зависящий от языка.</p></li><li><p>Указан недопустимый набор флагов нормализации.</p></li></ul><p>эта ошибка будет возвращена только Windows 2000.</p> | 
| <p>JET_errInstanceUnavailable</p> | <p>Невозможно выполнить операцию, поскольку экземпляр, связанный с сеансом, обнаружил неустранимую ошибку, которая требует, чтобы доступ ко всем данным был отозван для защиты целостности этих данных. эта ошибка будет возвращена только Windows XP и более поздних выпусках.</p> | 
| <p>JET_errInvalidCodePage</p> | <p>Поле CP <a href="gg294130(v=exchg.10).md">JET_COLUMNDEF</a> не было задано как допустимая кодовая страница. Единственными допустимыми значениями для текстовых столбцов являются английский (1252) и Unicode (1200). Значение 0 означает, что будет использоваться по умолчанию (английский, 1252).</p> | 
| <p>JET_errInvalidColumnType</p> | <p>Для поля <em>колтип</em> <a href="gg294130(v=exchg.10).md">JET_COLUMNDEF</a> не был задан допустимый тип столбца.</p> | 
| <p>JET_errInvalidLanguageId</p> | <p>Не удалось создать индекс, поскольку была предпринята попытка использовать недопустимый код локали. КОД локали может быть либо полностью недопустимым, либо связанный языковой пакет не может быть установлен.</p> | 
| <p>JET_errInvalidLCMapStringFlags</p> | <p>Не удалось создать индекс, поскольку предпринята попытка использовать недопустимый набор флагов нормализации. эта ошибка будет возвращена только Windows XP и более поздних выпусках. в Windows 2000 недопустимые флаги нормализации приводят к JET_errIndexInvalidDef.</p> | 
| <p>JET_errInvalidSesid</p> | <p>Недопустимый обработчик сеанса или ссылается на закрытый сеанс.</p><p><strong>Примечание</strong>  .  Эта ошибка не возвращается при всех обстоятельствах. Дескрипторы проверяются только на основе наилучшей силы.</p> | 
| <p>JET_errNotInitialized</p> | <p>Невозможно выполнить операцию, так как экземпляр, связанный с сеансом, еще не инициализирован.</p> | 
| <p>JET_errOutOfCursors</p> | <p>Не удалось выполнить операцию, так как подсистема не может выделить ресурсы, необходимые для открытия нового курсора. Ресурсы курсора настраиваются с помощью <a href="gg294044(v=exchg.10).md">жетсетсистемпараметер</a> с <a href="gg269201(v=exchg.10).md">JET_paramMaxCursors</a>.</p> | 
| <p>JET_errOutOfMemory</p> | <p>Не удалось выполнить операцию из-за нехватки памяти, выделенной для ее завершения.</p><p><strong>Жетопентемптабле</strong> может возвращать JET_errOutOfMemory, если адресное пространство хост-процесса оказывается слишком фрагментированным. Временный диспетчер таблиц всегда выделяет 1 МБ адресного пространства для каждой временной таблицы, созданной независимо от объема сохраняемых данных.</p> | 
| <p>JET_errRestoreInProgress</p> | <p>Невозможно выполнить операцию, так как в экземпляре, связанном с сеансом, выполняется операция восстановления.</p> | 
| <p>JET_errSessionSharingViolation</p> | <p>Один и тот же сеанс нельзя использовать одновременно для нескольких потоков.</p><p>эта ошибка будет возвращена только Windows XP и более поздних выпусках.</p> | 
| <p>JET_errTermInProgress</p> | <p>Невозможно выполнить операцию, так как выполняется завершение работы экземпляра, связанного с сеансом.</p> | 
| <p>JET_errTooManyColumns</p> | <p>Предпринята попытка добавить в таблицу слишком много столбцов. Таблица может содержать не более JET_ccolFixedMost фиксированных столбцов, не более JET_ccolVarMost столбцов переменной длины и не более JET_ccolTaggedMost столбцов с тегами.</p> | 
| <p>JET_errTooManyOpenIndexes</p> | <p>Не удалось выполнить операцию, так как подсистема не может выделить ресурсы, необходимые для кэширования индексов таблицы. Количество индексов, схема которых может быть кэширована, настраивается с помощью <a href="gg294044(v=exchg.10).md">жетсетсистемпараметер</a> с <a href="gg269201(v=exchg.10).md">JET_paramMaxOpenTables</a>.</p> | 
| <p>JET_errTooManyOpenTables</p> | <p>Не удалось выполнить операцию, так как подсистема не может выделить ресурсы, необходимые для кэширования схемы таблицы. Количество таблиц, схема которых может быть кэширована, настраивается с помощью <a href="gg294044(v=exchg.10).md">жетсетсистемпараметер</a> с <a href="gg269201(v=exchg.10).md">JET_paramMaxOpenTables</a>.</p> | 
| <p>JET_errTooManySorts</p> | <p>Не удалось выполнить операцию, так как подсистема не может выделить ресурсы, необходимые для создания временной таблицы. Временные ресурсы таблицы настраиваются с помощью <a href="gg294044(v=exchg.10).md">жетсетсистемпараметер</a> с <a href="gg294140(v=exchg.10).md">JET_paramMaxTemporaryTables</a>.</p> | 



При успешном выполнении будет возвращен курсор, Открытый во вновь созданной временной таблице. Состояние временной базы данных будет подготовлено для размещения новой временной таблицы. Состояние всех обычных баз данных, используемых ядром СУБД, останется неизменным.

При сбое временная таблица не будет создана и курсор не будет возвращен. Состояние временной базы данных может быть изменено. Состояние всех обычных баз данных, используемых ядром СУБД, останется неизменным.

#### <a name="remarks"></a>Комментарии

Временные таблицы не поддерживают полное дополнение параметров определения столбца, которые обычно поддерживаются ядром СУБД. На самом деле поддерживаются только JET_bitColumnFixed и JET_bitColumnTagged. Это означает, что невозможно создать столбец с автоматическим приращением, версией или многозначным столбцом во временной таблице. Наконец, столбцы депонированного обновления не поддерживаются, так как они не полезны во временной таблице, так как они могут использоваться только одним сеансом одновременно. При запросе любого из этих параметров они будут проигнорированы.

Временные таблицы не поддерживают значения по умолчанию. Если указано определение столбца, содержащее спецификацию значения по умолчанию, то эта спецификация будет пропущена.

Временные таблицы возвращаются вызывающему объекту в результате многих различных функций ESE. Например, [жетжетиндексинфо](./jetgetindexinfo-function.md) с параметром JET_IdxInfo, установленным в параметре *инфолевел* , возвращает временную таблицу, содержащую список всех ключевых столбцов в заданном индексе. Временные таблицы следуют тем же правилам жизненного цикла, что и обычные временные таблицы, как описано здесь.

Временные таблицы также используются внутренне ядром СУБД для многих задач. Наиболее важной из этих задач является создание индекса для существующей таблицы. Для сортировки ключей индекса, используемых для построения этого индекса, будет использоваться временная таблица.

Все временные таблицы хранятся во временной базе данных. Временная база данных — это специальный файл базы данных, который сохраняется в течение времени существования экземпляра ESE и удаляется при завершении работы или перезапуске этого экземпляра. Расположение временной базы данных можно настроить с помощью [жетсетсистемпараметер](./jetsetsystemparameter-function.md) с [JET_paramTempPath](./temporary-database-parameters.md). Размещение временной базы данных на диске относительно файлов журнала транзакций и файлов базы данных может быть важным, если приложение активно использует временные таблицы или часто создает индексы.

Жизненный цикл временной таблицы привязан к курсорам, ссылающимся на нее. Если все курсоры, ссылающиеся на временную таблицу, закрыты, либо неявно, либо явно, то временная таблица будет удалена. Если во время транзакции создается временная таблица и эта транзакция затем откатывается назад, то временная таблица будет удалена, так как все курсоры, на которые она ссылается, будут неявно закрыты. Новые курсоры могут ссылаться на временную таблицу только с помощью [жетдупкурсор](./jetdupcursor-function.md). В этом случае новые курсоры будут размещены на первой записи индекса временной таблицы. [Жетдупкурсор](./jetdupcursor-function.md) будет работать только на определенных этапах использования временной таблицы. Дополнительные сведения см. в разделе Примечания о возможностях курсора временной таблицы. Нельзя ссылаться на временную таблицу более чем за один сеанс за раз.

В [жетдупкурсор](./jetdupcursor-function.md) есть важная проблема, влияющая на временные таблицы. При попытке скопировать временную таблицу, которая находится в однонаправленном режиме, полученный курсор не будет правильно создан и будет работать неправильно. По-прежнему можно дублировать курсор по материализованным временным таблицам.

Временный диспетчер таблиц может выбрать реализацию временной таблицы тремя способами. Первый способ — сохранить таблицу в памяти. Эта стратегия является самой быстрой, но может использоваться только для небольших и простых временных таблиц. Второй способ — создать дисковую сортировку, которую можно использовать с помощью однонаправленного итератора. Эта стратегия может использоваться только в определенных обстоятельствах и является самым быстрым способом сортировки и удаления дубликатов из очень большого набора данных. Третий способ — создать дерево B + во временной базе данных для хранения временной таблицы. Эта стратегия является самой медленной, но наиболее универсальной и называется материализованным временным таблицей. Эти стратегии можно использовать в сочетании с целью обеспечения функциональности, запрошенной во временной таблице.

Если временная таблица не соматериализованны, она используется в первую очередь на двух основных этапах. Первый этап — это фаза вставки, в которой таблица заполняется начальным набором данных. На этом этапе допускается только вставка данных. Этот этап завершается, когда выполняется попытка переместить курсор с помощью [жетмове](./jetmove-function.md) или [жетсик](./jetseek-function.md). Второй этап — этап извлечения данных. На этом этапе данные, хранящиеся во временной таблице, могут быть извлечены в соответствии с возможностями, запрошенными при создании временной таблицы.

**Возможности курсора временной таблицы**

При материализации временной таблицы курсор имеет следующие возможности, но может быть дополнительно ограничен запрошенными параметрами:

  - [жетклосетабле](./jetclosetable-function.md)

  - [жетделете](./jetdelete-function.md)

  - [жетдупкурсор](./jetdupcursor-function.md)

  - [жетенумератеколумнс](./jetenumeratecolumns-function.md)

  - [жетескровупдате](./jetescrowupdate-function.md)

  - [жетжетбукмарк](./jetgetbookmark-function.md)

  - [жетжеткурсоринфо](./jetgetcursorinfo-function.md)

  - [жетжетлс](./jetgetls-function.md)

  - [жетжетрекордсизе](./jetgetrecordsize-function.md)

  - [жетжеттаблеинфо](./jetgettableinfo-function.md)

  - [жетготобукмарк](./jetgotobookmark-function.md)

  - [жетмакекэй](./jetmakekey-function.md)

  - [жетмове](./jetmove-function.md)

  - [жетпрепареупдате](./jetprepareupdate-function.md)

  - [жетретриевеколумн](./jetretrievecolumn-function.md)

  - [жетретриевеколумнс](./jetretrievecolumns-function.md)

  - [жетретриевекэй](./jetretrievekey-function.md)

  - [жетсик](./jetseek-function.md)

  - [жетсетколумн](./jetsetcolumn-function.md)

  - [жетсетколумнс](./jetsetcolumns-function.md)

  - [жетсетиндексранже](./jetsetindexrange-function.md)

  - [жетсетлс](./jetsetls-function.md)

  - [жетупдате](./jetupdate-function.md)

Если временная таблица не соблюдается и находится на стадии вставки, курсор имеет следующие возможности, но может быть дополнительно ограничен запрошенными параметрами:

  - [жетклосетабле](./jetclosetable-function.md)

  - [жетескровупдате](./jetescrowupdate-function.md)

  - [жетмакекэй](./jetmakekey-function.md)

  - [жетмове](./jetmove-function.md)
    
    **Примечание**  .  Вызывает переход на фазу извлечения.

  - [жетпрепареупдате](./jetprepareupdate-function.md)

  - [жетретриевекэй](./jetretrievekey-function.md)

  - [жетсик](./jetseek-function.md)
    
    **Примечание**  .  Вызывает переход на фазу извлечения.

  - [жетсетколумн](./jetsetcolumn-function.md)

  - [жетсетколумнс](./jetsetcolumns-function.md)

  - [жетупдате](./jetupdate-function.md)

Если временная таблица не материализованный и находится на этапе извлечения, то курсор имеет следующие возможности, но может быть дополнительно ограничен запрошенными параметрами:

  - [жетклосетабле](./jetclosetable-function.md)

  - [жетдупкурсор](./jetdupcursor-function.md)
    
    **Примечание**  .  При попытке скопировать временную таблицу, которая находится в однонаправленном режиме, полученный курсор не будет правильно создан и будет работать неправильно. По-прежнему можно дублировать курсор по материализованным временным таблицам.

  - [жетенумератеколумнс](./jetenumeratecolumns-function.md)

  - [жетжетбукмарк](./jetgetbookmark-function.md)

  - [жетжетлс](./jetgetls-function.md)

  - [жетжетрекордсизе](./jetgetrecordsize-function.md)

  - [жетжеттаблеинфо](./jetgettableinfo-function.md)

  - [жетготобукмарк](./jetgotobookmark-function.md)

  - [жетмакекэй](./jetmakekey-function.md)

  - [жетмове](./jetmove-function.md)

  - [жетретриевеколумн](./jetretrievecolumn-function.md)

  - [жетретриевеколумнс](./jetretrievecolumns-function.md)

  - [жетретриевекэй](./jetretrievekey-function.md)

  - [жетсик](./jetseek-function.md)

  - [жетсетиндексранже](./jetsetindexrange-function.md)

  - [жетсетлс](./jetsetls-function.md)

#### <a name="requirements"></a>Требования


| Требование | Применение |
|------------|----------|
| <p><strong>Клиент</strong></p> | <p>требуется Windows Vista, Windows XP или Windows 2000 Professional.</p> | 
| <p><strong>Server</strong></p> | <p>требуется Windows server 2008, Windows server 2003 или сервер Windows 2000.</p> | 
| <p><strong>Header</strong></p> | <p>Объявлено в ESENT. h.</p> | 
| <p><strong>Библиотека</strong></p> | <p>Используйте ESENT. lib.</p> | 
| <p><strong>КОМПОНОВКИ</strong></p> | <p>Требуется ESENT.dll.</p> | 



#### <a name="see-also"></a>См. также:

[JET_COLUMNDEF](./jet-columndef-structure.md)  
[JET_COLUMNID](./jet-columnid.md)  
[JET_ERR](./jet-err.md)  
[JET_GRBIT](./jet-grbit.md)  
[JET_SESID](./jet-sesid.md)  
[JET_TABLEID](./jet-tableid.md)  
[JET_UNICODEINDEX](./jet-unicodeindex-structure.md)  
[жетклосетабле](./jetclosetable-function.md)  
[жеткреатетаблеколумниндекс](./jetcreatetablecolumnindex-function.md)  
[жетдупкурсор](./jetdupcursor-function.md)  
[жетмове](./jetmove-function.md)  
[жетроллбакк](./jetrollback-function.md)  
[жетсик](./jetseek-function.md)  
[жетсетсистемпараметер](./jetsetsystemparameter-function.md)  
[Параметры временной базы данных](./temporary-database-parameters.md)
