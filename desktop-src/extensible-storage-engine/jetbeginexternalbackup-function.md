---
description: Дополнительные сведения о функции Жетбегинекстерналбаккуп
title: Функция Жетбегинекстерналбаккуп
TOCTitle: JetBeginExternalBackup Function
ms:assetid: 702e6cbf-4648-40f2-b2eb-6194759d4cde
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269292(v=EXCHG.10)
ms:contentKeyID: 32765584
ms.date: 04/11/2016
ms.topic: reference
api_name:
- JetBeginExternalBackup
topic_type:
- apiref
- kbArticle
api_type:
- COM
- DLLExport
api_location:
- ESENT.DLL
ROBOTS: INDEX,FOLLOW
ms.openlocfilehash: d410adb592c3d56d2f9880ec809749396318258a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105664453"
---
# <a name="jetbeginexternalbackup-function"></a>Функция Жетбегинекстерналбаккуп


_**Применимо к:** Windows | Windows Server_

## <a name="jetbeginexternalbackup-function"></a>Функция Жетбегинекстерналбаккуп

Функция **жетбегинекстерналбаккуп** инициирует внешнюю архивацию, пока ядро и база данных находятся в сети и активны. **Жетбегинекстерналбаккуп** является первым в серии функций, которые необходимо вызвать для выполнения успешной резервной копии (на основе не VSS).

Внешнюю резервную копию можно использовать для реализации полных, добавочных или разностных резервных копий.

Резервное копирование будет нечетким, в то время как резервная копия будет соответствовать одному моменту времени в журнале транзакций, но контролировать конкретный момент времени невозможно.

```cpp
    JET_ERR JET_API JetBeginExternalBackup(
      __in          JET_GRBIT grbit
    );
```

### <a name="parameters"></a>Параметры

*грбит*

Группа битов, задающих ноль или более следующих параметров.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Значение</p></th>
<th><p>Значение</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>JET_bitBackupAtomic</p></td>
<td><p>Этот флаг является устаревшим. Использование этого бита приведет к возвращению JET_errInvalidgrbit.</p></td>
</tr>
<tr class="even">
<td><p>JET_bitBackupIncremental</p></td>
<td><p>Создает добавочное резервное копирование, а не полное резервное копирование. Это означает, что резервное копирование выполняется только для файлов журнала с момента последнего полного или добавочного резервного копирования.</p></td>
</tr>
<tr class="odd">
<td><p>JET_bitBackupSnapshot</p></td>
<td><p>Зарезервировано для последующего использования. Определено для Windows XP.</p></td>
</tr>
</tbody>
</table>


### <a name="return-value"></a>Возвращаемое значение

Эта функция возвращает [JET_ERR](./jet-err.md) DataType с одним из следующих кодов возврата. Дополнительные сведения о возможных ошибках ESE см. в разделе [ошибки подсистемы хранилища](./extensible-storage-engine-errors.md) и [Параметры обработки ошибок](./error-handling-parameters.md).

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Код возврата</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>JET_errSuccess</p></td>
<td><p>Операция выполнена успешно.</p></td>
</tr>
<tr class="even">
<td><p>JET_errBackupInProgress</p></td>
<td><p>Если внешняя резервная копия или резервная копия моментального снимка уже находится в процессе, возвращается эта ошибка, пока не будет вызван <strong>жетбегинекстерналбаккуп</strong> (или один из вариантов). ESE допускает только одну оперативную архивацию за раз.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errBackupNotAllowedYet</p></td>
<td><p>Экземпляр или ядро СУБД либо находится в состоянии восстановления, либо на этапе завершения работы или прекращения.</p></td>
</tr>
<tr class="even">
<td><p>JET_errCheckpointCorrupt</p></td>
<td><p>Не удалось прочитать файл контрольных точек в полной резервной копии, или не удалось проверить файл.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errCheckpointFileNotFound</p></td>
<td><p>Не удалось найти файл контрольных точек в полной резервной копии.</p></td>
</tr>
<tr class="even">
<td><p>JET_errClientRequestToStopJetService</p></td>
<td><p>Операция не может быть завершена, так как все действия в экземпляре, связанном с сеансом, были прекращены в результате вызова <a href="gg269240(v=exchg.10).md">жетстопсервице</a>.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errInstanceUnavailable</p></td>
<td><p>Операция не может быть завершена, поскольку в экземпляре, связанном с сеансом, произошла неустранимая ошибка, которая требует, чтобы доступ ко всем данным был отозван для защиты целостности этих данных.</p>
<p><strong>Windows XP:  </strong> Это возвращаемое значение введено в Windows XP.</p></td>
</tr>
<tr class="even">
<td><p>JET_errInvalidBackup</p></td>
<td><p>Циклическое ведение журнала включено, а указанный тип резервного копирования — JET_bitBackupIncremental. Сведения о том, как управлять циклическим или нециклическим ведением журнала, см. в разделе <a href="gg269235(v=exchg.10).md">JET_paramCircularLog</a> <strong>ошибок в журнале транзакций</strong> .</p></td>
</tr>
<tr class="odd">
<td><p>JET_errInvalidgrbit</p></td>
<td><p>Один или несколько элементов <em>грбит</em> недопустимы.</p></td>
</tr>
<tr class="even">
<td><p>JET_errLoggingDisabled</p></td>
<td><p>Восстановление или ведение журнала отключено. Невозможно выполнить оперативную архивацию, если ведение журнала отключено. Дополнительные сведения о ведении журналов и восстановлении см. в разделе <a href="gg269235(v=exchg.10).md">JET_paramRecovery</a>.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errLogWriteFail</p></td>
<td><p>Модуль остановил запись на диск журнала из-за переполнения журнала или ошибок ввода-вывода на диск.</p></td>
</tr>
<tr class="even">
<td><p>JET_errMissingFullBackup</p></td>
<td><p>Было указано добавочное резервное копирование (с JET_bitBackupIncremental) и никогда не было полной резервной копии для одной из присоединенных баз данных для набора журналов.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errNotInitialized</p></td>
<td><p>Операция не может быть завершена, так как экземпляр, связанный с сеансом, еще не инициализирован.</p></td>
</tr>
<tr class="even">
<td><p>JET_errOutOfMemory</p></td>
<td><p>Не удалось выполнить операцию из-за нехватки памяти, выделенной для ее завершения.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errRestoreInProgress</p></td>
<td><p>Операция не может быть завершена, так как выполняется операция восстановления для экземпляра, связанного с сеансом.</p></td>
</tr>
<tr class="even">
<td><p>JET_errRunningInMultiInstanceMode</p></td>
<td><p>Операция завершилась с ошибкой, так как была предпринята попытка использовать модуль в устаревшем режиме (режим совместимости Windows 2000), где только один экземпляр поддерживается, если в действительности несколько экземпляров уже существуют.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errTermInProgress</p></td>
<td><p>Не удается выполнить операцию, так как выполняется завершение работы экземпляра, связанного с сеансом.</p></td>
</tr>
</tbody>
</table>


Если функция выполнена, инициируется внешнее резервное копирование и инициализируется обработчик состояния резервного копирования. Последующие API теперь можно вызывать для завершения внешней последовательности и потока резервного копирования или чтения файла базы данных, файла исправления базы данных (если поддерживается) и файла журнала. Событие может регистрироваться в том случае, если внешнее резервное копирование началось.

Если функция завершается ошибкой, сеанс резервного копирования не запускается. Если выполняется другой сеанс резервного копирования, он не будет отменен.

#### <a name="remarks"></a>Комментарии

Процесс внешнего резервного копирования (как запущенный **жетбегинекстерналбаккуп**) разрешается в оперативной резервной копии нечеткой транзакции для всего экземпляра на целевое устройство в виде потока. Резервная копия будет содержать все файлы базы данных, присоединенные к экземпляру с помощью [жетаттачдатабасе](./jetattachdatabase-function.md) (для полной резервной копии), а также связанные файлы исправлений базы данных (если они поддерживаются) и, наконец, файлы журнала транзакций, созданные в процессе резервного копирования. Конечным результатом будет набор файлов, которые могут быть восстановлены из потока, возможно, объединены с существующими файлами базы данных и журнала, и, наконец, восстановлены в стабильном состоянии.

Общий порядок операций с полной резервной копией состоит из следующих вызовов. Во-первых, для запуска процесса резервного копирования вызывается **жетбегинекстерналбаккуп** . Затем вызывается [жетжетаттачинфо](./jetgetattachinfo-function.md) для получения списка баз данных, присоединенных к экземпляру, для которого необходимо создать резервную копию. Для каждой из этих баз данных вызывается [жетопенфиле](./jetopenfile-function.md) , за которым следует ряд вызовов [жетреадфиле](./jetreadfile-function.md) , а затем вызов [жетклосефиле](./jetclosefile-function.md). Затем вызывается [жетжетлогинфо](./jetgetloginfo-function.md) для получения списка обновлений базы данных и файлов журналов для резервного копирования. Для каждого из этих файлов выполняется другая последовательность вызовов [жетопенфиле](./jetopenfile-function.md), [жетреадфиле](./jetreadfile-function.md)и [жетклосефиле](./jetclosefile-function.md) . Затем все нежелательные файлы журнала транзакций удаляются с помощью [жеттрункателог](./jettruncatelog-function.md). Наконец, резервное копирование завершается вызовом [жетендекстерналбаккуп](./jetendexternalbackup-function.md).

Также можно изменить этот набор шагов, чтобы выполнить добавочное резервное копирование экземпляра. Добавочное резервное копирование перечисляет и выполняет резервное копирование файлов журналов. Добавочное резервное копирование возможно только в том случае, если циклическое ведение журнала не включено.

Также можно изменить этот набор шагов, чтобы разрешить выполнение последующих разностных резервных копий экземпляра. Чтобы выполнить разностное резервное копирование, не вызывайте [жеттрункателог](./jettruncatelog-function.md) в предыдущей полной или добавочной резервной копии. Не вызывая [жеттрункателог](./jettruncatelog-function.md), вы включаете последующие резервные копии в соответствии с последним полным или добавочным резервным копированием. Разностное резервное копирование возможно только в том случае, если циклическое ведение журнала не включено.

Файл исправления базы данных — это специальный вспомогательный файл, который используется для хранения образов страниц базы данных при определенных обстоятельствах во время резервного копирования. Этот файл должен находиться в том же расположении, что и связанная с ним база данных во время операции восстановления. Этот файл используется только в Windows 2000. В результате все приложения, написанные для работы с Windows 2000 и другими выпусками, должны поддерживать файлы исправления базы данных, если они существуют, но также не должны завершаться ошибкой, если они отсутствуют.

#### <a name="requirements"></a>Требования

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td><p><strong>Клиент</strong></p></td>
<td><p>Требуется Windows Vista, Windows XP или Windows 2000 Professional.</p></td>
</tr>
<tr class="even">
<td><p><strong>Server</strong></p></td>
<td><p>Требуется Windows Server 2008, Windows Server 2003 или Windows 2000 Server.</p></td>
</tr>
<tr class="odd">
<td><p><strong>Header</strong></p></td>
<td><p>Объявлено в ESENT. h.</p></td>
</tr>
<tr class="even">
<td><p><strong>Библиотека</strong></p></td>
<td><p>Используйте ESENT. lib.</p></td>
</tr>
<tr class="odd">
<td><p><strong>КОМПОНОВКИ</strong></p></td>
<td><p>Требуется ESENT.dll.</p></td>
</tr>
</tbody>
</table>


#### <a name="see-also"></a>См. также:

[JET_ERR](./jet-err.md)  
[JET_GRBIT](./jet-grbit.md)  
[JET_INSTANCE](./jet-instance.md)  
[жетаттачдатабасе](./jetattachdatabase-function.md)  
[жетбегинекстерналбаккупинстанце](./jetbeginexternalbackupinstance-function.md)  
[жетклосефиле](./jetclosefile-function.md)  
[жетендекстерналбаккуп](./jetendexternalbackup-function.md)  
[JetEndExternalBackupInstance2](./jetendexternalbackupinstance2-function.md)  
[жетжетаттачинфо](./jetgetattachinfo-function.md)  
[жетжетлогинфо](./jetgetloginfo-function.md)  
[жетопенфиле](./jetopenfile-function.md)  
[жетреадфиле](./jetreadfile-function.md)  
[жетстопбаккуп](./jetstopbackup-function.md)  
[жеттрункателог](./jettruncatelog-function.md)
