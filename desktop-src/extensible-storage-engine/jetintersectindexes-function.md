---
description: Дополнительные сведения о функции Жетинтерсектиндексес
title: Функция JetIntersectIndexes
TOCTitle: JetIntersectIndexes Function
ms:assetid: 6e111d10-6882-46ac-a70b-7896662d3b5d
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269289(v=EXCHG.10)
ms:contentKeyID: 32765581
ms.date: 04/11/2016
ms.topic: reference
api_name:
- JetIntersectIndexes
topic_type:
- apiref
- kbArticle
api_type:
- COM
- DLLExport
api_location:
- ESENT.DLL
ROBOTS: INDEX,FOLLOW
ms.openlocfilehash: 4bdffa6f21a65ae7f438f87ea0d8d2adf4aed6a9
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105692125"
---
# <a name="jetintersectindexes-function"></a>Функция JetIntersectIndexes


_**Применимо к:** Windows | Windows Server_

## <a name="jetintersectindexes-function"></a>Функция JetIntersectIndexes

Функция **жетинтерсектиндексес** вычислит пересечение между несколькими наборами записей индекса из разных вторичных индексов в одной таблице. Эта операция полезна для поиска набора записей в таблице, соответствующих двум или более критериям, которые могут быть выражены с помощью диапазонов индексов.

```cpp
    JET_ERR JET_API JetIntersectIndexes(
      __in          JET_SESID sesid,
      __in          JET_INDEXRANGE* rgindexrange,
      __in          unsigned long cindexrange,
      __in_out      JET_RECORDLIST* precordlist,
      __in          JET_GRBIT grbit
    );
```

### <a name="parameters"></a>Параметры

*сесид*

Сеанс, используемый для этого вызова.

*ргиндексранже*

Указатель на массив структур [JET_IndexRange](./jet-indexrange-structure.md) . Каждая структура включает [JET_TABLEID](./jet-tableid.md) , для которой настроено удержание одного из диапазонов индексов для пересечение. Дополнительные сведения см. в разделе [JET_IndexRange](./jet-indexrange-structure.md).

*Циндексранже*

Число структур [JET_IndexRange](./jet-indexrange-structure.md) в массиве, которое содержится в параметре *ргиндексранже* .

*прекордлист*

Указатель на структуру [JET_RECORDLIST](./jet-recordlist-structure.md) . Эта структура будет заполнена достаточной информацией для обхода временной таблицы с результатами **жетинтерсектиндексес**.

Выходной буфер, который получает структуру [JET_RECORDLIST](./jet-recordlist-structure.md) . Структура содержит описание результирующего набора пересечения.

*грбит*

Зарезервировано для последующего использования.

### <a name="return-value"></a>Возвращаемое значение

Эта функция возвращает [JET_ERR](./jet-err.md) DataType с одним из следующих кодов возврата. Дополнительные сведения об ошибках ESE см. в разделе [Расширенные ошибки подсистемы хранилища](./extensible-storage-engine-errors.md) и [Параметры обработки ошибок](./error-handling-parameters.md).

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Код возврата</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>JET_errSuccess</p></td>
<td><p>Операция выполнена успешно.</p></td>
</tr>
<tr class="even">
<td><p>JET_errClientRequestToStopJetService</p></td>
<td><p>Невозможно выполнить операцию, так как все действия в экземпляре, связанном с сеансом, были прекращены в результате вызова <a href="gg269240(v=exchg.10).md">жетстопсервице</a>.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errInstanceUnavailable</p></td>
<td><p>Невозможно выполнить операцию, поскольку экземпляр, связанный с сеансом, обнаружил неустранимую ошибку, которая требует, чтобы доступ ко всем данным был отозван для защиты целостности этих данных.</p>
<p><strong>Windows XP:</strong>  Это возвращаемое значение введено в Windows XP.</p></td>
</tr>
<tr class="even">
<td><p>JET_errInvalidgrbit</p></td>
<td><p>Один из запрошенных параметров недопустим, используется неправильно или не реализован.</p>
<p>Эта ошибка возвращается функцией <strong>жетинтерсектиндексес</strong> , когда:</p>
<p><em>Грбит</em> , содержащийся в структуре <a href="gg269335(v=exchg.10).md">JET_IndexRange</a> , на которую указывает любой элемент в массиве <em>ргиндексранже</em> , не равно JET_bitRecordInIndex.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errInvalidParameter</p></td>
<td><p>Один из указанных параметров содержит непредвиденное значение или значение, которое не согласуется при объединении со значением другого параметра.</p>
<p>Эта ошибка возвращается <strong>жетинтерсектиндексес</strong> по следующим причинам:</p>
<ul>
<li><p>Параметр <em>прекордлист</em> имеет значение null.</p></li>
<li><p>Элемент <strong>кбструкт</strong> структуры <a href="gg269287(v=exchg.10).md">JET_RECORDLIST</a> , указанный в параметре <em>прекордлист</em> , не равен размеру структуры <a href="gg269287(v=exchg.10).md">JET_RECORDLIST</a> .</p></li>
<li><p>Параметр <em>Циндексранже</em> равен нулю.</p></li>
<li><p>Значение параметра <em>Циндексранже</em> больше 64.</p></li>
<li><p>Элемент <strong>кбструкт</strong> для любого элемента в массиве, заданном параметром <em>ргиндексранже</em> , не равен размеру структуры <a href="gg269335(v=exchg.10).md">JET_IndexRange</a> .</p></li>
<li><p>Элементы в массиве <em>ргиндексранже</em> содержат <a href="gg269182(v=exchg.10).md">JET_TABLEID</a>s из разных таблиц.</p></li>
<li><p>Элемент в массиве <em>ргиндексранже</em> содержит <a href="gg269182(v=exchg.10).md">JET_TABLEID</a> , который не позиционирован на вторичном индексе.</p></li>
<li><p>Один или несколько элементов в массиве <em>ргиндексранже</em> содержат <a href="gg269182(v=exchg.10).md">JET_TABLEIDы</a>, расположенные на одном и том же вторичном индексе.</p></li>
</ul></td>
</tr>
<tr class="even">
<td><p>JET_errInvalidSesid</p></td>
<td><p>Недопустимый обработчик сеанса или ссылается на закрытый сеанс.</p>
<p>Эта ошибка не возвращается при всех обстоятельствах. Дескрипторы проверяются только на основе наилучшей силы.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errNotInitialized</p></td>
<td><p>Невозможно выполнить операцию, так как экземпляр, связанный с сеансом, не был инициализирован.</p></td>
</tr>
<tr class="even">
<td><p>JET_errOutOfCursors</p></td>
<td><p>Не удалось выполнить операцию, так как подсистеме не удалось выделить ресурсы, необходимые для открытия нового курсора. Ресурсы курсора настраиваются путем вызова <a href="gg294044(v=exchg.10).md">жетсетсистемпараметер</a> с <em>JET_paramMaxCursors</em> , указанными в параметре <em>парамид</em> .</p></td>
</tr>
<tr class="odd">
<td><p>JET_errOutOfMemory</p></td>
<td><p>Не удалось выполнить операцию из-за нехватки памяти, выделенной для ее завершения.</p>
<p><strong>Жетинтерсектиндексес</strong> может возвращать JET_errOutOfMemory, если адресное пространство хост-процесса оказывается слишком фрагментированным. Временный диспетчер таблиц всегда выделяет 1 МБ адресного пространства для каждой временной таблицы, созданной независимо от объема сохраняемых данных. <strong>Жетинтерсектиндексес</strong> создаст одну временную таблицу для каждого <a href="gg269335(v=exchg.10).md">JET_IndexRange</a> , указанного в параметре <em>ргиндексранже</em> , и одну временную таблицу для выходных данных в <a href="gg269287(v=exchg.10).md">JET_RECORDLIST</a>.</p></td>
</tr>
<tr class="even">
<td><p>JET_errRestoreInProgress</p></td>
<td><p>Невозможно выполнить операцию, так как в экземпляре, связанном с сеансом, выполняется операция восстановления.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errSessionSharingViolation</p></td>
<td><p>Нельзя одновременно использовать один сеанс из нескольких потоков.</p>
<p><strong>Windows XP:</strong>  Это возвращаемое значение введено в Windows XP.</p></td>
</tr>
<tr class="even">
<td><p>JET_errTermInProgress</p></td>
<td><p>Невозможно выполнить операцию, так как выполняется завершение работы экземпляра, связанного с сеансом.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errTooManyOpenIndexes</p></td>
<td><p>Не удалось выполнить операцию, так как подсистеме не удалось выделить ресурсы, необходимые для кэширования индексов таблицы. Количество индексов, схема которых может быть кэширована, настраивается с помощью <a href="gg294044(v=exchg.10).md">жетсетсистемпараметер</a> с <em>JET_paramMaxOpenTables</em> , указанными в параметре <em>парамид</em> .</p></td>
</tr>
<tr class="even">
<td><p>JET_errTooManyOpenTables</p></td>
<td><p>Не удалось выполнить операцию, так как подсистеме не удалось выделить ресурсы, необходимые для кэширования схемы таблицы. Количество таблиц, схема которых может быть кэширована, настраивается с помощью <a href="gg294044(v=exchg.10).md">жетсетсистемпараметер</a> с <em>JET_paramMaxOpenTables</em> , указанными в параметре <em>парамид</em> .</p></td>
</tr>
<tr class="odd">
<td><p>JET_errTooManySorts</p></td>
<td><p>Не удалось выполнить операцию, так как подсистеме не удалось выделить ресурсы, необходимые для создания временной таблицы. Временные ресурсы таблицы настраиваются с помощью <a href="gg294044(v=exchg.10).md">жетсетсистемпараметер</a> с JET_paramMaxTemporaryTables, указанными в параметре <em>парамид</em> .</p></td>
</tr>
</tbody>
</table>


При успешном выполнении возвращается новая временная таблица, содержащая закладки записей, которые соответствуют критериям, представленным в описаниях диапазона входных индексов.

При сбое временная таблица, содержащая результаты, не будет создана. Состояние временной базы данных может быть изменено. Состояние всех обычных баз данных, используемых ядром СУБД, останется неизменным. Текущее расположение [JET_TABLEID](./jet-tableid.md)s, предоставленное этой функции, может быть изменено.

#### <a name="remarks"></a>Комментарии

**Жетинтерсектиндексес** можно использовать для эффективной фильтрации записей в таблице по нескольким критериям, если эти критерии могут быть выражены в виде вторичных индексов по этой таблице. Например, предположим, что у вас есть очень большая таблица, содержащая людей. Таблица может содержать столбцы с идентификатором пользователя, именем, фамилией и т. д. Предположим, что каждый из этих столбцов индексируется отдельно и первичный индекс таблицы находится по идентификатору пользователя. Если вы хотите найти всех, чье имя начинается с A, а фамилия начинается с G, выполните следующие действия.

1.  Откройте новый курсор в таблице и установите этот курсор для использования индекса над столбцом First Name. Затем настройте диапазон индексов для всех пользователей, "имя" которых начинается с "A", и создайте [JET_IndexRange](./jet-indexrange-structure.md) структуру, содержащую этот курсор.

2.  Повторите шаг 1 с новым курсором в индексе Last Name для всех пользователей, чье поле Last Name было запущено с "G".

3.  Передайте эти критерии в **жетинтерсектиндексес** , чтобы вычислить результат во временную таблицу.

4.  Просмотрите временную таблицу и извлеките каждую из записей, которые передают критерии по закладке.

Временная таблица, содержащая результирующий набор, представляет собой простую таблицу с одним столбцом, содержащим закладку каждой записи, которая передала все критерии, используемые для вычисления пересечения. Результирующий набор сортируется в том же порядке, что и первичный индекс, и не содержит повторяющихся записей. Приложение может перечислить результаты пересечения, перечисляя строки во временной таблице, извлекая закладку для каждого результата с помощью [жетретриевеколумн](./jetretrievecolumn-function.md), а затем просмотрев запись в базе данных, вызывая [жетготобукмарк](./jetgotobookmark-function.md) с этой закладкой для курсора, расположенного на первичном индексе.

Временная таблица, возвращаемая функцией **жетинтерсектиндексес** , может быть проверена только в прямом направлении. Он также должен быть закрыт через [жетклосетабле](./jetclosetable-function.md) после завершения проверки. Дополнительные сведения о временных таблицах и их работе см. в разделе [жетопентемпораритабле](./jetopentemporarytable-function.md).

**Жетинтерсектиндексес** обычно является эффективным и удобным способом фильтрации записей на основе нескольких индексированных критериев. Однако есть несколько важных советов, которые следует выполнить, чтобы максимально увеличить полезность этой функции. Если известно, что один из критериев имеет настолько строгое значение, что результирующий диапазон индексов содержит очень мало записей, то, вероятно, лучше просто проанализировать диапазон индексов и отфильтровать записи на уровне приложения. Кроме того, если известно, что у вас есть условия, которые гораздо менее точны, чем другие критерии пересечения, можно удалить эти менее четкие критерии из пересечения. Наконец, если известно, что один из критериев не является настолько ограничивающим, что результирующий диапазон индекса почти такой же большой, как и первичный индекс, маловероятно, что при пересечении с этим диапазоном индексов будет преимущество (уменьшение размера) результирующего набора. Во всех случаях следует выбирать условия таким образом, чтобы на входе можно было выбрать наименьшее количество возможных записей индекса и создать наиболее конкретный набор закладок на выходе для максимальной производительности.

#### <a name="requirements"></a>Требования

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td><p><strong>Клиент</strong></p></td>
<td><p>Требуется Windows Vista, Windows XP или Windows 2000 Professional.</p></td>
</tr>
<tr class="even">
<td><p><strong>Server</strong></p></td>
<td><p>Требуется Windows Server 2008, Windows Server 2003 или Windows 2000 Server.</p></td>
</tr>
<tr class="odd">
<td><p><strong>Header</strong></p></td>
<td><p>Объявлено в ESENT. h.</p></td>
</tr>
<tr class="even">
<td><p><strong>Библиотека</strong></p></td>
<td><p>Используйте ESENT. lib.</p></td>
</tr>
<tr class="odd">
<td><p><strong>КОМПОНОВКИ</strong></p></td>
<td><p>Требуется ESENT.dll.</p></td>
</tr>
</tbody>
</table>


#### <a name="see-also"></a>См. также:

[JET_ERR](./jet-err.md)  
[JET_GRBIT](./jet-grbit.md)  
[JET_SESID](./jet-sesid.md)  
[JET_TABLEID](./jet-tableid.md)  
[JET_IndexRange](./jet-indexrange-structure.md)  
[JET_RECORDLIST](./jet-recordlist-structure.md)  
[жетготобукмарк](./jetgotobookmark-function.md)  
[жетретриевеколумн](./jetretrievecolumn-function.md)  
[жетсетиндексранже](./jetsetindexrange-function.md)
