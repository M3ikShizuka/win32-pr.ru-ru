---
description: Дополнительные сведения о функции Жетсетколумн
title: Функция JetSetColumn
TOCTitle: JetSetColumn Function
ms:assetid: f8877519-86d5-4e59-95a8-1927c70cd6b4
ms:mtpsurl: https://msdn.microsoft.com/library/Gg294137(v=EXCHG.10)
ms:contentKeyID: 32765751
ms.date: 04/11/2016
ms.topic: reference
api_name:
- JetSetColumn
topic_type:
- apiref
- kbArticle
api_type:
- COM
- DLLExport
api_location:
- ESENT.DLL
ROBOTS: INDEX,FOLLOW
ms.openlocfilehash: 848d575f6fd8598aa3262273e9da3ce4cd1aaed12bcb2dc17e41e0d2f98bfdad
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118978864"
---
# <a name="jetsetcolumn-function"></a>Функция JetSetColumn


_**Применимо к:** Windows | Windows Сервером_

## <a name="jetsetcolumn-function"></a>Функция JetSetColumn

Функция **жетсетколумн** изменяет значение одного столбца в изменяемой записи, которое вставляется, или обновляет текущую запись. Он может перезаписать существующее значение, добавить новое значение в последовательность значений в столбце с несколькими значениями, удалить значение из последовательности значений в многозначном столбце или обновить все или часть длинного значения, столбца типа [JET_coltypLongText](./jet-coltyp.md) или [JET_coltypLongBinary](./jet-coltyp.md).

```cpp
    JET_ERR JET_API JetSetColumn(
      __in          JET_SESID sesid,
      __in          JET_TABLEID tableid,
      __in          JET_COLUMNID columnid,
      __in_opt      const void* pvData,
      __in          unsigned long cbData,
      __in          JET_GRBIT grbit,
      __in_opt      JET_SETINFO* psetinfo
    );
```

### <a name="parameters"></a>Параметры

*сесид*

Сеанс, используемый для этого вызова.

*TableID*

Курсор, используемый для этого вызова.

*columnid*

[JET_COLUMNID](./jet-columnid.md) извлекаемого столбца. Кроме того, может быть задано значение *columnid* , равное 0 (нулю). Если задано значение *columnid* 0 (ноль), все столбцы с тегами, разреженные и Многозначные столбцы рассматриваются как один столбец. Это упрощает извлечение всех разреженных столбцов, имеющихся в записи.

*пвдата*

Входной буфер, содержащий данные, используемые для значения столбца.

*cbData*

Размер входного буфера в байтах.

*грбит*

Группа битов, содержащая параметры, которые должны использоваться для этого вызова, в том числе ноль или более следующих:

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Значение</p></th>
<th><p>Значение</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>JET_bitSetAppendLV</p></td>
<td><p>Этот параметр используется для добавления данных в столбец типа <a href="gg269213(v=exchg.10).md">JET_coltypLongText</a> или <a href="gg269213(v=exchg.10).md">JET_coltypLongBinary</a>. Аналогичное поведение можно добиться, определив размер существующего длинного значения и указав <em>иблонгвалуе</em> в <em>псетинфо</em>. Однако проще использовать этот <em>грбит</em> , поскольку знание размера существующего значения столбца не требуется.</p></td>
</tr>
<tr class="even">
<td><p>JET_bitSetOverwriteLV</p></td>
<td><p>Этот параметр используется для замены существующего длинного значения новыми предоставленными данными. При использовании этого параметра, как будто существующее длинное значение было установлено равным 0 (нулю), перед установкой новых данных.</p></td>
</tr>
<tr class="odd">
<td><p>JET_bitSetRevertToDefaultValue</p></td>
<td><p>Этот параметр применим только к столбцам с тегами, разреженным или многозначным. Это приводит к тому, что столбец возвращает значение столбца по умолчанию при последующих операциях получения столбца. Все существующие значения столбцов удаляются.</p></td>
</tr>
<tr class="even">
<td><p>JET_bitSetSeparateLV</p></td>
<td><p>Этот параметр используется для принудительного хранения длинных значений, столбцов типа <a href="gg269213(v=exchg.10).md">JET_coltypLongText</a> или <a href="gg269213(v=exchg.10).md">JET_coltypLongBinary</a>, которые хранятся отдельно от оставшейся части данных записи. Обычно это происходит, когда размер длинного значения предотвращает сохранение его с помощью оставшихся данных записи. Однако этот параметр можно использовать для принудительного сохранения длинного значения. Обратите внимание, что значения long размером четыре байта меньше не могут быть разными. В таких случаях параметр игнорируется.</p></td>
</tr>
<tr class="odd">
<td><p>JET_bitSetSizeLV</p></td>
<td><p>Этот параметр используется для интерпретации входного буфера в виде целого числа байтов, устанавливаемого в качестве длины длинного значения, описываемого значением <em>columnid</em> , и если оно предоставлено, порядковый номер в псетинфо- &gt; итагсекуенце. Если указанный размер больше значения существующего столбца, столбец будет расширен с помощью нулей. Если размер меньше значения существующего столбца, то значение будет обрезано.</p></td>
</tr>
<tr class="even">
<td><p>JET_bitSetUniqueMultiValues</p></td>
<td><p>Этот параметр используется, чтобы обеспечить уникальность всех значений в столбце с несколькими значениями. Этот параметр сравнивает данные исходного столбца без преобразований с другими существующими значениями столбцов, и при обнаружении дубликата возвращается ошибка. Если указан этот параметр, то не могут быть также указаны JET_bitSetAppendLV, JET_bitSetOverwriteLV и JET_bitSetSizeLV.</p></td>
</tr>
<tr class="odd">
<td><p>JET_bitSetUniqueNormalizedMultiValues</p></td>
<td><p>Этот параметр используется, чтобы обеспечить уникальность всех значений в столбце с несколькими значениями. Этот параметр сравнивает ключевое нормализованное преобразование данных столбца с другими аналогично преобразованными значениями столбцов, и при обнаружении дубликата возвращается ошибка. Если указан этот параметр, то не могут быть также указаны JET_bitSetAppendLV, JET_bitSetOverwriteLV и JET_bitSetSizeLV.</p></td>
</tr>
<tr class="even">
<td><p>JET_bitSetZeroLength</p></td>
<td><p>Этот параметр используется для задания значения нулевой длины. Как правило, значение столбца устанавливается равным <strong>null</strong> путем передачи кбмакс 0 (нуль). Однако для некоторых типов, таких как <a href="gg269213(v=exchg.10).md">JET_coltypText</a>, значение столбца может быть равно 0 (нулевой) длине, а не <strong>null</strong>, и этот параметр используется для различения длины, <strong>равной null</strong> , и 0 (нуль).</p>
<p><strong>Примечание</strong>  .  В общем случае, если столбец является столбцом фиксированной длины, этот бит игнорируется, а для столбца устанавливается значение <strong>null</strong>. Однако если столбец является столбцом с фиксированной длиной, длина столбца устанавливается равным 0. Если столбец с меткой фиксированной длины имеет значение 0, попытки получить столбец с <a href="gg269198(v=exchg.10).md">жетретриевеколумн</a> или <a href="gg294135(v=exchg.10).md">жетретриевеколумнс</a> будут выполнены, но фактическая длина, возвращаемая в параметре <em>кбактуал</em> , равна 0.</p></td>
</tr>
<tr class="odd">
<td><p>JET_bitSetIntrinsicLV</p></td>
<td><p>Этот параметр используется для хранения всего длинного значения в записи.</p></td>
</tr>
<tr class="even">
<td><p>JET_bitSetCompressed</p></td>
<td><p>Этот параметр используется для попытки сжатия данных при хранении данных.</p>
<p><strong>Windows 7:</strong>  JET_bitSetCompressed представлен в Windows 7.</p></td>
</tr>
<tr class="odd">
<td><p>JET_bitSetUncompressed</p></td>
<td><p>Этот параметр используется для попыток сжатия при сохранении данных.</p>
<p><strong>Windows 7:</strong>  JET_bitSetUnCompressed представлен в Windows 7.</p></td>
</tr>
</tbody>
</table>


*псетинфо*

Указатель на необязательные входные параметры, которые могут быть установлены для этой функции с помощью структуры [JET_SETINFO](./jet-setinfo-structure.md) .

Если *псетинфо* имеет **значение NULL** , функция ведет себя так, как будто *итагсекуенце* равен 1 и *иблонгвалуе* 0 (нуль). Это приводит к тому, что набор столбцов устанавливает первое значение многозначного столбца, а также для задания длинных данных, начиная со смещения 0 (нуля).

Для этого параметра можно задать следующие параметры:

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Значение</p></th>
<th><p>Значение</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>иблонгвалуе</p></td>
<td><p>Двоичное смещение в длинное значение столбца, где должны начинаться наборы данных.</p></td>
</tr>
<tr class="even">
<td><p>итагсекуенце</p></td>
<td><p>Порядковый номер нужного значения столбца с несколькими значениями. Если <em>итагсекуенце</em> имеет значение 0 (ноль), то указанное значение должно быть добавлено к концу последовательности многозначных значений. Если указанный порядковый номер больше, чем последнее существующее Многозначное значение, то к концу последовательности значений добавляется указанное значение. Если порядковый номер соответствует существующему значению, то это значение заменяется заданным значением.</p></td>
</tr>
</tbody>
</table>


### <a name="return-value"></a>Возвращаемое значение

Эта функция возвращает [JET_ERR](./jet-err.md) DataType с одним из следующих кодов возврата. дополнительные сведения о возможных ошибках подсистемы ESE см. в разделе [ошибки расширенных служба хранилища Engine](./extensible-storage-engine-errors.md) и [параметры обработки ошибок](./error-handling-parameters.md).

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Код возврата</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>JET_errSuccess</p></td>
<td><p>Операция выполнена успешно.</p></td>
</tr>
<tr class="even">
<td><p>JET_errBadColumnId</p></td>
<td><p>Указанный идентификатор столбца находится за пределами допустимых ограничений идентификатора столбца.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errClientRequestToStopJetService</p></td>
<td><p>Невозможно выполнить операцию, так как все действия в экземпляре, связанном с сеансом, были прекращены в результате вызова <a href="gg269240(v=exchg.10).md">жетстопсервице</a>.</p></td>
</tr>
<tr class="even">
<td><p>JET_errColumnNotFound</p></td>
<td><p>Столбец, описываемый данным <em>columnid</em> , не существует в таблице.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errColumnNotUpdatable</p></td>
<td><p>Предпринята недопустимая попытка обновить значение Long во время операции вставки копирования удаление исходного обновления.</p></td>
</tr>
<tr class="even">
<td><p>JET_errColumnTooBig</p></td>
<td><p>Данные значений столбцов, заданных во входном буфере, превышают ограничение по размеру либо естественным для столбца фиксированной длины, либо настроены для текстовых или двоичных столбцов фиксированной длины. Эта ошибка также возвращается при передаче более 1024 байт данных для длинного столбца и установке флага JET_bitSetIntrinsicLV.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errInstanceUnavailable</p></td>
<td><p>Невозможно выполнить операцию, поскольку экземпляр, связанный с сеансом, обнаружил неустранимую ошибку, которая требует, чтобы доступ ко всем данным был отозван для защиты целостности этих данных.</p>
<p><strong>Windows XP:</strong>  эта ошибка будет возвращена только Windows XP и более поздних выпусках.</p></td>
</tr>
<tr class="even">
<td><p>JET_errInvalidBufferSize</p></td>
<td><p>Заданный размер данных значения столбца не соответствует типу данных фиксированной длины, который является естественным.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errInvalidColumnType</p></td>
<td><p>Предпринята недопустимая попытка обновить столбец автоинкремента во время операции вставки или обновления либо обновить столбец версии во время операции замены.</p></td>
</tr>
<tr class="even">
<td><p>JET_errInvalidgrbit</p></td>
<td><p>Указанные параметры неизвестны или являются недопустимым сочетанием известных битовых параметров.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errInvalidParameter</p></td>
<td><p>Заданный псетинфо- &gt; кбструкт не является допустимым размером для структуры <a href="gg294090(v=exchg.10).md">JET_SETINFO</a> .</p></td>
</tr>
<tr class="even">
<td><p>JET_errMultiValuedDuplicate</p></td>
<td><p>Операция задания столбца попыталась создать повторяющееся значение и указать либо JET_bitSetUniqueMultiValues, либо JET_bitSetUniqueNormalizedMultiValues.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errNotInitialized</p></td>
<td><p>Невозможно выполнить операцию, так как экземпляр, связанный с сеансом, еще не инициализирован.</p></td>
</tr>
<tr class="even">
<td><p>JET_errNotInTransaction</p></td>
<td><p>Предпринята недопустимая попытка обновить значение длинного столбца, если вызывающий сеанс не был в транзакции.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errNullInvalid</p></td>
<td><p>Предпринята недопустимая попытка установить<strong>ненулевое</strong> значение <strong>null</strong>для столбца.</p></td>
</tr>
<tr class="even">
<td><p>JET_errColumnIllegalNull</p></td>
<td><p>То же, что и JET_errNullInvalid.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errRecordTooBig</p></td>
<td><p>Значение столбца не может быть присвоено значению во входном буфере, так как оно привело к превышению ограничения на размер страницы. Столбцы типа <a href="gg269213(v=exchg.10).md">JET_coltypLongText</a> или <a href="gg269213(v=exchg.10).md">JET_coltypLongBinary</a> можно хранить отдельно от оставшихся данных записи. Однако другие столбцы должны храниться вместе с записью, что может привести к превышению ограничения на размер записи. Даже для длинных столбцов требуется 5-байтное пространство внутри записи в качестве компоновки, что также может привести к возвращению JET_errRecordTooBig.</p></td>
</tr>
<tr class="even">
<td><p>JET_errRestoreInProgress</p></td>
<td><p>Невозможно выполнить операцию, так как в экземпляре, связанном с сеансом, выполняется операция восстановления.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errSessionSharingViolation</p></td>
<td><p>Один и тот же сеанс нельзя использовать одновременно для нескольких потоков.</p>
<p><strong>Windows XP:</strong>  эта ошибка будет возвращена только Windows XP и более поздних выпусках.</p></td>
</tr>
<tr class="even">
<td><p>JET_errTermInProgress</p></td>
<td><p>Невозможно выполнить операцию, так как выполняется завершение работы экземпляра, связанного с сеансом.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errUpdateNotPrepared</p></td>
<td><p>Курсор в настоящее время не находится в процессе вставки новой записи или обновления существующей записи.</p></td>
</tr>
<tr class="even">
<td><p>JET_errVersionStoreOutOfMemory</p></td>
<td><p>Эта ошибка возникает, если настроенный размер хранилища версий недостаточно для хранения всех необработанных обновлений.</p></td>
</tr>
<tr class="odd">
<td><p>JET_wrnColumnMaxTruncated</p></td>
<td><p>Значение столбца во входном буфере превысило максимальную заданную длину для столбца переменной длины и было усечено.</p></td>
</tr>
</tbody>
</table>


При успешном завершении требуемая часть значения столбца для данного столбца задается данными, скопированными из входного буфера. Возможно, набор данных был усечен, если превышена максимальная длина, указанная для столбца переменной длины.

В случае сбоя положение курсора остается неизменным, и данные значения столбца не обновляются в буфере копирования.

#### <a name="remarks"></a>Remarks

Задание значений типа Long, значения для столбцов [JET_coltypLongBinary](./jet-coltyp.md) типов [JET_coltypLongText](./jet-coltyp.md) или [JET_coltypLongBinary](./jet-coltyp.md), должно выполняться только в том случае, если вызывающий сеанс находится в транзакции. Если вызывающий сеанс не находится в транзакции, изменения длинных значений, которые хранятся отдельно, могут быть зафиксированы полностью даже после отмены операции обновления. Если вызывающий сеанс находится в транзакции, то результаты обновления можно полностью откатить, отменив обновление и выполнив откат транзакции сеанса.

Обновления индекса не выполняются в результате операций **жетсетколумн** . Вместо этого индексы обновляются только после завершения всех изменений столбцов и вызова [жетупдате](./jetupdate-function.md) . Это позволяет наиболее эффективно обновлять индексы, если индексы содержат более одного изменяемого столбца.

Размер записи ограничен в зависимости от размера страницы базы данных. Все длинные значения в записи больше пяти байт будут храниться отдельно от записи, если данные в записи превышают предел в результате операции **жетсетколумн** . JET_errRecordTooBig об ошибке будет возвращен только после того, как все данные столбца записи отделяемых будут сохранены отдельно от записи, а запись по-прежнему превышает предельный размер записи.

#### <a name="requirements"></a>Requirements (Требования)

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td><p><strong>Клиент</strong></p></td>
<td><p>требуется Windows Vista, Windows XP или Windows 2000 Professional.</p></td>
</tr>
<tr class="even">
<td><p><strong>Сервер</strong></p></td>
<td><p>требуется Windows server 2008, Windows server 2003 или сервер Windows 2000.</p></td>
</tr>
<tr class="odd">
<td><p><strong>Header</strong></p></td>
<td><p>Объявлено в ESENT. h.</p></td>
</tr>
<tr class="even">
<td><p><strong>Библиотека</strong></p></td>
<td><p>Используйте ESENT. lib.</p></td>
</tr>
<tr class="odd">
<td><p><strong>КОМПОНОВКИ</strong></p></td>
<td><p>Требуется ESENT.dll.</p></td>
</tr>
</tbody>
</table>


#### <a name="see-also"></a>См. также

[JET_COLUMNID](./jet-columnid.md)  
[JET_ERR](./jet-err.md)  
[JET_SESID](./jet-sesid.md)  
[JET_TABLEID](./jet-tableid.md)  
[JET_SETINFO](./jet-setinfo-structure.md)  
[жетретриевеколумн](./jetretrievecolumn-function.md)  
[жетсетколумнс](./jetsetcolumns-function.md)
