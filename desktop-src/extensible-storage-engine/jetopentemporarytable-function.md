---
description: Дополнительные сведения о функции Жетопентемпораритабле
title: Функция Жетопентемпораритабле
TOCTitle: JetOpenTemporaryTable Function
ms:assetid: feacd0b8-2298-4ec6-aa59-0fede08474bc
ms:mtpsurl: https://msdn.microsoft.com/library/Gg294144(v=EXCHG.10)
ms:contentKeyID: 32765758
ms.date: 04/11/2016
ms.topic: reference
api_name:
- JetOpenTemporaryTable
topic_type:
- apiref
- kbArticle
api_type:
- COM
- DLLExport
api_location:
- ESENT.DLL
ROBOTS: INDEX,FOLLOW
ms.openlocfilehash: 2335f6d6426b321d5db55b4ed005c6220484d509
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105693349"
---
# <a name="jetopentemporarytable-function"></a>Функция Жетопентемпораритабле


_**Применимо к:** Windows | Windows Server_

## <a name="jetopentemporarytable-function"></a>Функция Жетопентемпораритабле

Функция **жетопентемпораритабле** создает переменную таблицы с одним индексом, который может использоваться для хранения и извлечения записей, как и обычная таблица, созданная с помощью [жеткреатетаблеколумниндекс](./jetcreatetablecolumnindex-function.md).

**Windows Vista:**  **Жетопентемпораритабле** появился в Windows Vista.

Временные таблицы работают быстрее обычных таблиц из-за их временной природы. Они могут быстро отсортировать и выполнить удаление дубликатов наборов записей, если доступ к ним осуществляется исключительно последовательно.

```cpp
    JET_ERR JET_API JetOpenTemporaryTable(
      __in          JET_SESID sesid,
      __in          JET_OPENTEMPORARYTABLE* popentemporarytable
    );
```

### <a name="parameters"></a>Параметры

*сесид*

Сеанс, который будет использоваться для этого вызова.

*попентемпораритабле*

Указатель на структуру [JET_OPENTEMPORARYTABLE](./jet-opentemporarytable-structure.md) , содержащую описание временной таблицы, создаваемой на входе. После успешного вызова структура содержит описатель для временной таблицы и идентификаторов столбцов.

### <a name="return-value"></a>Возвращаемое значение

Эта функция возвращает [JET_ERR](./jet-err.md) DataType с одним из следующих кодов возврата. Дополнительные сведения о возможных ошибках ESE см. в разделе [ошибки подсистемы хранилища](./extensible-storage-engine-errors.md) и [Параметры обработки ошибок](./error-handling-parameters.md).

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Код возврата</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>JET_errSuccess</p></td>
<td><p>Операция выполнена успешно.</p></td>
</tr>
<tr class="even">
<td><p>JET_errOutOfMemory</p></td>
<td><p>Не удалось выполнить операцию из-за нехватки памяти, выделенной для ее завершения.</p>
<p><strong>Жетопентемпораритабле</strong> может возвращать JET_errOutOfMemory, если адресное пространство хост-процесса оказывается слишком фрагментированным. Временный диспетчер таблиц выделит блок адресного пространства размером 1 МБ для каждой создаваемой временной таблицы независимо от объема хранимых данных.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errInvalidParameter</p></td>
<td><p>Один из указанных параметров содержал непредвиденное значение или сочетание нескольких значений параметров привело к непредвиденному результату.</p>
<p>Эта ошибка возвращается функцией <strong>жетопентемпораритабле</strong> при выполнении следующих условий:</p>
<ul>
<li><p>Элемент <strong>кбструкт</strong> структуры <a href="gg269206(v=exchg.10).md">JET_OPENTEMPORARYTABLE</a> не соответствует версии этой структуры, которая поддерживается этой версией ядра СУБД.</p></li>
<li><p>Элемент <strong>кбкэймост</strong> структуры <a href="gg269206(v=exchg.10).md">JET_OPENTEMPORARYTABLE</a> меньше JET_cbKeyMostMin.</p></li>
<li><p>Элемент <strong>кбкэймост</strong> структуры <a href="gg269206(v=exchg.10).md">JET_OPENTEMPORARYTABLE</a> больше, чем наибольшее поддерживаемое значение размера страницы базы данных для экземпляра (JET_paramDatabasePageSize). Дополнительные сведения см. в описании параметра JET_paramKeyMost в списке <a href="gg269241(v=exchg.10).md">информационных параметров</a> .</p></li>
<li><p>Элемент Кбварсегмак структуры <a href="gg269206(v=exchg.10).md">JET_OPENTEMPORARYTABLE</a> больше, чем элемент <strong>кбкэймост</strong> .</p></li>
</ul></td>
</tr>
<tr class="even">
<td><p>JET_errNotInitialized</p></td>
<td><p>Операция не может быть завершена, так как экземпляр, связанный с сеансом, еще не инициализирован.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errClientRequestToStopJetService</p></td>
<td><p>Операция не может быть завершена, так как все действия в экземпляре, связанном с сеансом, были прекращены в результате вызова <a href="gg269240(v=exchg.10).md">жетстопсервице</a>.</p></td>
</tr>
<tr class="even">
<td><p>JET_errInstanceUnavailable</p></td>
<td><p>Операция не может быть завершена, поскольку в экземпляре, связанном с сеансом, произошла неустранимая ошибка, которая требует, чтобы доступ ко всем данным был отозван для защиты целостности этих данных.</p>
<p><strong>Windows XP:</strong>  Эта ошибка будет возвращена только Windows XP и более поздних версий.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errTermInProgress</p></td>
<td><p>Не удается выполнить операцию, так как выполняется завершение работы экземпляра, связанного с сеансом.</p></td>
</tr>
<tr class="even">
<td><p>JET_errRestoreInProgress</p></td>
<td><p>Операция не может быть завершена, так как выполняется операция восстановления на экземпляре, связанном с сеансом.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errSessionSharingViolation</p></td>
<td><p>Один и тот же сеанс нельзя использовать одновременно для нескольких потоков.</p>
<p><strong>Windows XP:</strong>  Эта ошибка будет возвращена только Windows XP и более поздних версий.</p></td>
</tr>
<tr class="even">
<td><p>JET_errInvalidSesid</p></td>
<td><p>Недопустимый обработчик сеанса или ссылается на закрытый сеанс.</p>
<p><strong>Примечание</strong>  .  Эта ошибка не возвращается при всех обстоятельствах. Дескрипторы проверяются только на основе наилучшей силы.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errOutOfCursors</p></td>
<td><p>Не удалось выполнить операцию, так как подсистема не может выделить ресурсы, необходимые для открытия нового курсора. Ресурсы курсора настраиваются с помощью <a href="gg294044(v=exchg.10).md">жетсетсистемпараметер</a> с <a href="gg269201(v=exchg.10).md">JET_paramMaxCursors</a>.</p></td>
</tr>
<tr class="even">
<td><p>JET_errTooManySorts</p></td>
<td><p>Не удалось выполнить операцию, так как подсистема не может выделить ресурсы, необходимые для создания временной таблицы. Временные ресурсы таблицы настраиваются с помощью <a href="gg294044(v=exchg.10).md">жетсетсистемпараметер</a> с <a href="gg294140(v=exchg.10).md">JET_paramMaxTemporaryTables</a>.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errCannotMaterializeForwardOnlySort</p></td>
<td><p>Произошел сбой <strong>жетопентемпораритабле</strong> , так как указана JET_bitTTForwardOnly, и не удалось создать временную таблицу с использованием оптимизации "только вперед".</p>
<p><strong>Windows Server 2003:</strong>  Эта ошибка будет возвращена только в Windows Server 2003 и более поздних выпусках.</p></td>
</tr>
<tr class="even">
<td><p>JET_errTooManyColumns</p></td>
<td><p>Предпринята попытка добавить в таблицу слишком много столбцов. Таблица может содержать не более JET_ccolFixedMost фиксированных столбцов, не более JET_ccolVarMost столбцов переменной длины и не более JET_ccolTaggedMost столбцов с тегами.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errTooManyOpenTables</p></td>
<td><p>Не удалось выполнить операцию, так как подсистема не может выделить ресурсы, необходимые для кэширования схемы таблицы. Чтобы настроить число таблиц со схемами, которые могут быть кэшированы, используйте <a href="gg294044(v=exchg.10).md">жетсетсистемпараметер</a> с <a href="gg269201(v=exchg.10).md">JET_paramMaxOpenTables</a>.</p></td>
</tr>
<tr class="even">
<td><p>JET_errInvalidCodePage</p></td>
<td><p>Элементу <strong>CP</strong> структуры <a href="gg294130(v=exchg.10).md">JET_COLUMNDEF</a> не задана допустимая кодовая страница. Единственными допустимыми значениями для текстовых столбцов являются английский (1252) и Unicode (1200). Значение 0 означает, что будет использоваться по умолчанию (английский, 1252).</p></td>
</tr>
<tr class="odd">
<td><p>JET_errInvalidColumnType</p></td>
<td><p>Для элемента <strong>колтип</strong> <a href="gg294130(v=exchg.10).md">JET_COLUMNDEF</a> не был задан допустимый тип столбца.</p></td>
</tr>
<tr class="even">
<td><p>JET_errInvalidLanguageId</p></td>
<td><p>Не удалось создать индекс, поскольку была предпринята попытка использовать недопустимый код локали. КОД локали может быть либо полностью недопустимым, либо связанный с ним языковой пакет не может быть установлен.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errInvalidLCMapStringFlags</p></td>
<td><p>Не удалось создать индекс, поскольку предпринята попытка использовать недопустимый набор флагов нормализации.</p>
<p><strong>Windows XP:</strong>  Эта ошибка будет возвращена только Windows XP и более поздних версий.</p>
<p><strong>Windows 2000:</strong>  В Windows 2000 недопустимые флаги нормализации приводят к JET_errIndexInvalidDef.</p></td>
</tr>
<tr class="even">
<td><p>JET_errIndexInvalidDef</p></td>
<td><p>Не удалось создать индекс, так как было указано недопустимое определение индекса. <strong>Жетопентемпораритабле</strong> будет возвращать эту ошибку при следующих условиях:</p>
<ul>
<li><p>Указан языковой стандарт, не зависящий от языка.</p></li>
<li><p>Указан недопустимый набор флагов нормализации.</p></li>
</ul>
<p><strong>Windows 2000:</strong>  Эта ошибка будет возвращена только Windows 2000.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errTooManyOpenIndexes</p></td>
<td><p>Не удалось выполнить операцию, так как подсистема не может выделить ресурсы, необходимые для кэширования индексов таблицы. Чтобы настроить количество индексов, имеющих схемы, которые могут быть кэшированы, используйте <a href="gg294044(v=exchg.10).md">жетсетсистемпараметер</a> с <a href="gg269201(v=exchg.10).md">JET_paramMaxOpenTables</a>.</p></td>
</tr>
</tbody>
</table>


При успешном выполнении будет возвращен курсор, Открытый во вновь созданной временной таблице. Состояние временной базы данных будет подготовлено для размещения новой временной таблицы. Состояние всех обычных баз данных, используемых ядром СУБД, останется неизменным.

При сбое временная таблица не будет создана и курсор не будет возвращен. Состояние временной базы данных можно изменить. Состояние всех обычных баз данных, используемых ядром СУБД, останется неизменным.

#### <a name="remarks"></a>Комментарии

Временные таблицы не поддерживают полное дополнение параметров определения столбца, которые обычно поддерживаются ядром СУБД. На самом деле поддерживаются только JET_bitColumnFixed и JET_bitColumnTagged. Это означает, что невозможно создать столбец с автоматическим приращением, версией или многозначным столбцом во временной таблице. Наконец, столбцы депонированного обновления не поддерживаются, так как они могут использоваться только одним сеансом за раз. При запросе любого из этих параметров они будут проигнорированы.

Временные таблицы не поддерживают значения по умолчанию. Если указано определение столбца, содержащее спецификацию значения по умолчанию, то эта спецификация будет пропущена.

Временные таблицы возвращаются вызывающему объекту в результате многих различных функций ESE. Например, [жетжетиндексинфо](./jetgetindexinfo-function.md) с набором параметров JET_IdxInfo вернет временную таблицу, содержащую список всех ключевых столбцов в заданном индексе. Временные таблицы следуют тем же правилам жизненного цикла, что и обычные временные таблицы, как описано здесь.

Временные таблицы также используются внутренне ядром СУБД для многих задач. Наиболее важной из этих задач является создание индекса для существующей таблицы. Для сортировки ключей индекса, используемых для построения этого индекса, будет использоваться временная таблица.

Все временные таблицы хранятся во временной базе данных. Временная база данных — это специальный файл базы данных, который сохраняется в течение времени существования экземпляра ESE и удаляется при завершении работы или перезапуске этого экземпляра. Расположение временной базы данных можно настроить с помощью [жетсетсистемпараметер](./jetsetsystemparameter-function.md) с [JET_paramTempPath](./temporary-database-parameters.md). Размещение временной базы данных на диске относительно файлов журнала транзакций и файлов базы данных может быть важным, если приложение активно использует временные таблицы или часто создает индексы.

Жизненный цикл временной таблицы привязан к курсорам, ссылающимся на нее. Если все курсоры, ссылающиеся на временную таблицу, закрыты, либо неявно, либо явно, то временная таблица будет удалена. Если во время транзакции создается временная таблица и эта транзакция затем откатывается назад, то временная таблица будет удалена, так как все курсоры, на которые она ссылается, будут неявно закрыты. Новые курсоры могут ссылаться на временную таблицу только с помощью [жетдупкурсор](./jetdupcursor-function.md). В этом случае новые курсоры будут размещены на первой записи индекса временной таблицы. [Жетдупкурсор](./jetdupcursor-function.md) будет работать только на определенных этапах использования временной таблицы. Дополнительные сведения см. в разделе Примечания о возможностях курсора временной таблицы. Нельзя ссылаться на временную таблицу более чем за один сеанс за раз.

**Внимание!**  В [жетдупкурсор](./jetdupcursor-function.md) есть важная проблема, влияющая на временные таблицы. При попытке скопировать временную таблицу, которая находится в однонаправленном режиме, полученный курсор не будет правильно создан и будет работать неправильно. По-прежнему можно дублировать курсор по материализованным временным таблицам.

Временный диспетчер таблиц может реализовать временную таблицу тремя способами. Первый способ — сохранить таблицу в памяти. Эта стратегия самая высокая, но может использоваться только для небольших, простых и временных таблиц. Второй способ — создать дисковую сортировку, которую можно использовать с помощью однонаправленного итератора. Эта стратегия может использоваться только в определенных обстоятельствах и является самым быстрым способом сортировки и удаления дубликатов из очень большого набора данных. Третий способ — создать дерево B + во временной базе данных для хранения временной таблицы. Эта стратегия является самой медленной, но наиболее универсальной и называется материализованным временным таблицей. Эти стратегии можно использовать в сочетании с целью обеспечения функциональности, запрашиваемой во временной таблице.

Если временная таблица не соматериализованны, она используется главным образом в двух основных этапах. Первый этап — это фаза вставки, в которой таблица заполняется начальным набором данных. На этом этапе допускается только вставка данных. Этот этап завершается, когда выполняется попытка переместить курсор с помощью [жетмове](./jetmove-function.md) или [жетсик](./jetseek-function.md). Второй этап — этап извлечения данных. На этом этапе данные, хранящиеся во временной таблице, можно извлечь в соответствии с возможностями, которые были запрошены при создании временной таблицы.

**Возможности курсора временной таблицы**

При материализации временной таблицы курсор имеет следующие возможности, но может быть дополнительно ограничен запрашиваемыми параметрами:

  - [жетклосетабле](./jetclosetable-function.md)

  - [жетделете](./jetdelete-function.md)

  - [жетдупкурсор](./jetdupcursor-function.md)

  - [жетенумератеколумнс](./jetenumeratecolumns-function.md)

  - [жетескровупдате](./jetescrowupdate-function.md)

  - [жетжетбукмарк](./jetgetbookmark-function.md)

  - [жетжеткурсоринфо](./jetgetcursorinfo-function.md)

  - [жетжетлс](./jetgetls-function.md)

  - [жетжетрекордсизе](./jetgetrecordsize-function.md)

  - [жетжеттаблеинфо](./jetgettableinfo-function.md)

  - [жетготобукмарк](./jetgotobookmark-function.md)

  - [жетмакекэй](./jetmakekey-function.md)

  - [жетмове](./jetmove-function.md)

  - [жетпрепареупдате](./jetprepareupdate-function.md)

  - [жетретриевеколумн](./jetretrievecolumn-function.md)

  - [жетретриевеколумнс](./jetretrievecolumns-function.md)

  - [жетретриевекэй](./jetretrievekey-function.md)

  - [жетсик](./jetseek-function.md)

  - [жетсетколумн](./jetsetcolumn-function.md)

  - [жетсетколумнс](./jetsetcolumns-function.md)

  - [жетсетиндексранже](./jetsetindexrange-function.md)

  - [жетсетлс](./jetsetls-function.md)

  - [жетупдате](./jetupdate-function.md)

Если временная таблица не материализованный и находится на фазе вставки, то курсор имеет следующие возможности, но может быть дополнительно ограничен запрашиваемыми параметрами:

  - [жетклосетабле](./jetclosetable-function.md)

  - [жетескровупдате](./jetescrowupdate-function.md)

  - [жетмакекэй](./jetmakekey-function.md)

  - [жетмове](./jetmove-function.md)
    
    **Примечание**  .  Вызывает переход на фазу извлечения.

  - [жетпрепареупдате](./jetprepareupdate-function.md)

  - [жетретриевекэй](./jetretrievekey-function.md)

  - [жетсик](./jetseek-function.md)
    
    **Примечание**  .  Вызывает переход на фазу извлечения.

  - [жетсетколумн](./jetsetcolumn-function.md)

  - [жетсетколумнс](./jetsetcolumns-function.md)

  - [жетупдате](./jetupdate-function.md)

Если временная таблица не соблюдается и находится на этапе извлечения, курсор имеет следующие возможности, но может быть дополнительно ограничен запрашиваемыми параметрами:

  - [жетклосетабле](./jetclosetable-function.md)

  - [жетдупкурсор](./jetdupcursor-function.md)
    
    **Примечание**  .  При попытке скопировать временную таблицу, которая находится в однонаправленном режиме, полученный курсор не будет правильно создан и будет работать неправильно. По-прежнему можно дублировать курсор по материализованным временным таблицам.

  - [жетенумератеколумнс](./jetenumeratecolumns-function.md)

  - [жетжетбукмарк](./jetgetbookmark-function.md)

  - [жетжетлс](./jetgetls-function.md)

  - [жетжетрекордсизе](./jetgetrecordsize-function.md)

  - [жетжеттаблеинфо](./jetgettableinfo-function.md)

  - [жетготобукмарк](./jetgotobookmark-function.md)

  - [жетмакекэй](./jetmakekey-function.md)

  - [жетмове](./jetmove-function.md)

  - [жетретриевеколумн](./jetretrievecolumn-function.md)

  - [жетретриевеколумнс](./jetretrievecolumns-function.md)

  - [жетретриевекэй](./jetretrievekey-function.md)

  - [жетсик](./jetseek-function.md)

  - [жетсетиндексранже](./jetsetindexrange-function.md)

  - [жетсетлс](./jetsetls-function.md)

#### <a name="requirements"></a>Требования

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td><p><strong>Клиент</strong></p></td>
<td><p>Требуется Windows Vista.</p></td>
</tr>
<tr class="even">
<td><p><strong>Server</strong></p></td>
<td><p>Требуется Windows Server 2008.</p></td>
</tr>
<tr class="odd">
<td><p><strong>Header</strong></p></td>
<td><p>Объявлено в ESENT. h.</p></td>
</tr>
<tr class="even">
<td><p><strong>Библиотека</strong></p></td>
<td><p>Используйте ESENT. lib.</p></td>
</tr>
<tr class="odd">
<td><p><strong>КОМПОНОВКИ</strong></p></td>
<td><p>Требуется ESENT.dll.</p></td>
</tr>
</tbody>
</table>


#### <a name="see-also"></a>См. также:

[JET_ERR](./jet-err.md)  
[JET_SESID](./jet-sesid.md)  
[JET_OPENTEMPORARYTABLE](./jet-opentemporarytable-structure.md)  
[жетклосетабле](./jetclosetable-function.md)  
[жеткреатетаблеколумниндекс](./jetcreatetablecolumnindex-function.md)  
[жетдупкурсор](./jetdupcursor-function.md)  
[жетмове](./jetmove-function.md)  
[жетроллбакк](./jetrollback-function.md)  
[жетсик](./jetseek-function.md)  
[жетсетсистемпараметер](./jetsetsystemparameter-function.md)  
[Информационные параметры](./informational-parameters.md)  
[Параметры временной базы данных](./temporary-database-parameters.md)
