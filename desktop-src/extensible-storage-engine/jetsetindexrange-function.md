---
description: Дополнительные сведения о функции Жетсетиндексранже
title: Функция JetSetIndexRange
TOCTitle: JetSetIndexRange Function
ms:assetid: dac99576-707d-4713-9825-ddad1980723e
ms:mtpsurl: https://msdn.microsoft.com/library/Gg294112(v=EXCHG.10)
ms:contentKeyID: 32765726
ms.date: 04/11/2016
ms.topic: reference
api_name:
- JetSetIndexRange
topic_type:
- apiref
- kbArticle
api_type:
- COM
- DLLExport
api_location:
- ESENT.DLL
ROBOTS: INDEX,FOLLOW
ms.openlocfilehash: 883085633bebf25180c82f0f8917f6fa31fe7304
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104263234"
---
# <a name="jetsetindexrange-function"></a>Функция JetSetIndexRange


_**Применимо к:** Windows | Windows Server_

## <a name="jetsetindexrange-function"></a>Функция JetSetIndexRange

Функция **жетсетиндексранже** временно ограничивает набор записей индекса, которые курсор может проанализировать с помощью [жетмове](./jetmove-function.md) , начиная с текущего элемента индекса и заканчивая записью индекса, которая соответствует критериям поиска, заданным в ключе поиска в этом курсоре, и указанным критериям привязки. Ключ поиска должен быть ранее создан с помощью [жетмакекэй](./jetmakekey-function.md).

```cpp
    JET_ERR JET_API JetSetIndexRange(
      __in          JET_SESID sesid,
    __in          JET_TABLEID tableidSrc,
      __in          JET_GRBIT grbit
    );
```

### <a name="parameters"></a>Параметры

*сесид*

Сеанс, используемый для этого вызова.

*таблеидсрк*

Курсор, используемый для этого вызова.

*грбит*

Группа битов, содержащая параметры, которые должны использоваться для этого вызова, в том числе ноль или более следующих:

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Значение</p></th>
<th><p>Значение</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>JET_bitRangeInclusive</p></td>
<td><p>Это присутствие или отсутствие этого параметра указывает критерии границ диапазона индекса. При наличии этот параметр указывает, что предел диапазона индекса является инклюзивным. Если этот параметр отсутствует, это означает, что ограничение диапазона индекса является эксклюзивным. Если ограничение диапазона индекса является инклюзивным, то все записи индекса, соответствующие условиям поиска, включаются в диапазон.</p></td>
</tr>
<tr class="even">
<td><p>JET_bitRangeInstantDuration</p></td>
<td><p>Этот параметр запрашивает удаление диапазона индекса сразу после его установки. Все остальные аспекты операции остаются без изменений. Это полезно для проверки существования записей индекса, соответствующих условиям поиска.</p></td>
</tr>
<tr class="odd">
<td><p>JET_bitRangeRemove</p></td>
<td><p>Этот параметр запрашивает отмену существующего диапазона индекса в курсоре. После отмены диапазона индексов можно будет перемещаться за пределы диапазона индекса с помощью <a href="gg294117(v=exchg.10).md">жетмове</a>. Если диапазон индексов еще не действует, <strong>жетсетиндексранже</strong> завершится с JET_errInvalidOperation.</p>
<p>Если указан этот параметр, все остальные параметры игнорируются.</p></td>
</tr>
<tr class="even">
<td><p>JET_bitRangeUpperLimit</p></td>
<td><p>Если используется этот параметр, то ключ поиска в курсоре представляет критерий поиска для элемента индекса, ближайшего к концу индекса, который будет соответствовать диапазону индексов. Диапазон индекса будет установлен между текущей позицией курсора и этой записью индекса, чтобы можно было найти все совпадения путем прохода по индексу с помощью <a href="gg294117(v=exchg.10).md">жетмове</a> с JET_MoveNext или положительным смещением.</p>
<p>Этот параметр не имеет смысла использовать с ключом поиска, созданным с помощью <a href="gg269329(v=exchg.10).md">жетмакекэй</a> , с помощью параметра подстановочного знака, предназначенного для поиска записей индекса, ближайших к началу индекса.</p>
<p>Если этот параметр не указан, то поисковый ключ в курсоре представляет критерий поиска, ближайший к началу индекса, который будет соответствовать диапазону индексов. Диапазон индекса будет установлен между текущей позицией курсора и этой записью индекса, чтобы можно было найти все совпадения путем прохода назад по индексу с помощью <a href="gg294117(v=exchg.10).md">жетмове</a> с JET_MovePrevious или отрицательным смещением.</p>
<p>Не имеет смысла опускать этот параметр с помощью ключа поиска, созданного с помощью <a href="gg269329(v=exchg.10).md">жетмакекэй</a> , с помощью подстановочного знака, предназначенного для поиска записей индекса, ближайших к концу индекса.</p></td>
</tr>
</tbody>
</table>


### <a name="return-value"></a>Возвращаемое значение

Эта функция возвращает [JET_ERR](./jet-err.md) DataType с одним из следующих кодов возврата. Дополнительные сведения о возможных ошибках ESE см. в разделе [ошибки подсистемы хранилища](./extensible-storage-engine-errors.md) и [Параметры обработки ошибок](./error-handling-parameters.md).

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Код возврата</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>JET_errSuccess</p></td>
<td><p>Операция выполнена успешно.</p>
<p>Для <strong>жетсетиндексранже</strong>это означает, что либо существующий диапазон индексов был отменен, либо в диапазоне индекса есть хотя бы одна запись индекса.</p></td>
</tr>
<tr class="even">
<td><p>JET_errClientRequestToStopJetService</p></td>
<td><p>Невозможно выполнить операцию, так как все действия в экземпляре, связанном с сеансом, были прекращены в результате вызова <a href="gg269240(v=exchg.10).md">жетстопсервице</a>.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errInstanceUnavailable</p></td>
<td><p>Невозможно выполнить операцию, поскольку экземпляр, связанный с сеансом, обнаружил неустранимую ошибку, которая требует, чтобы доступ ко всем данным был отозван для защиты целостности этих данных.</p>
<p>Эта ошибка будет возвращена только Windows XP и более поздних версий.</p></td>
</tr>
<tr class="even">
<td><p>JET_errInvalidOperation</p></td>
<td><p>Эта ошибка будет возвращена функцией <strong>жетсетиндексранже</strong> при указании JET_bitRangeRemove и отсутствии диапазона индексов.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errKeyNotMade</p></td>
<td><p>Для курсора отсутствует текущий ключ поиска. <strong>Жетсетиндексранже</strong> требует, чтобы курсор имел допустимый ключ поиска, так как он будет использовать его для условий поиска, используемых для поиска записей индекса.</p></td>
</tr>
<tr class="even">
<td><p>JET_errNoCurrentIndex</p></td>
<td><p>Для курсора отсутствует текущий индекс. Это произойдет для <strong>жетсетиндексранже</strong> , если курсор находится на кластеризованном индексе таблицы, первичный индекс не определен. Установка диапазона индекса по такому индексу не поддерживается.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errNoCurrentRecord</p></td>
<td><p>Эта ошибка будет возвращена функцией <strong>жетсетиндексранже</strong> , чтобы указать, что в диапазоне индекса нет записей индекса.</p></td>
</tr>
<tr class="even">
<td><p>JET_errNotInitialized</p></td>
<td><p>Невозможно выполнить операцию, так как экземпляр, связанный с сеансом, еще не инициализирован.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errRestoreInProgress</p></td>
<td><p>Невозможно выполнить операцию, так как в экземпляре, связанном с сеансом, выполняется операция восстановления.</p></td>
</tr>
<tr class="even">
<td><p>JET_errSessionSharingViolation</p></td>
<td><p>Один и тот же сеанс нельзя использовать одновременно для нескольких потоков.</p>
<p>Эта ошибка будет возвращена только Windows XP и более поздних версий.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errTermInProgress</p></td>
<td><p>Невозможно выполнить операцию, так как выполняется завершение работы экземпляра, связанного с сеансом.</p></td>
</tr>
</tbody>
</table>


При успешном выполнении, если указан JET_bitRangeRemove, то диапазон индексов, действующий в данный момент, отменяется. Если JET_bitRangeRemove не указан и указан JET_bitRangeInstantDuration, диапазон индексов не действует. Если не указаны ни JET_bitRangeRemove, ни JET_bitRangeInstantDuration, то действует новый диапазон индекса. Этот диапазон индексов временно ограничивает набор записей индекса, которые курсор может проанализировать с помощью [жетмове](./jetmove-function.md) , начиная с текущей записи индекса и заканчивая записью индекса, которая соответствует критериям поиска. Позиции курсора останутся без изменений. Если для курсора был создан ключ поиска, то этот ключ поиска будет удален. Изменение состояния базы данных не выполняется.

В случае сбоя, если JET_errNoCurrentRecord не возвращается, диапазон индексов не действует. Если возвращается значение JET_errNoCurrentRecord, действует новый диапазон индекса. Этот диапазон индексов временно ограничивает набор записей индекса, которые курсор может проанализировать с помощью [жетмове](./jetmove-function.md) , начиная с текущей записи индекса и заканчивая записью индекса, которая соответствует критериям поиска. Позиции курсора останутся без изменений. Если был возвращен JET_errNoCurrentRecord и для курсора был создан ключ поиска, то этот ключ поиска будет удален. Изменение состояния базы данных не выполняется.

#### <a name="remarks"></a>Комментарии

Диапазон индексов является временным и автоматически отменяется, если в курсоре выполняется любая Навигация, отличная от [жетмове](./jetmove-function.md) .

Индексные диапазоны работают только в одном направлении. Если установлен верхний предел, то после достижения конца диапазона индекса будет предотвращено только перенаправление движения с использованием [жетмове](./jetmove-function.md) с JET_MoveNext или положительным смещением. В этом случае можно оставить диапазон индекса в этом случае, используя [жетмове](./jetmove-function.md) с JET_MovePrevious или отрицательным смещением. Аналогичная ситуация возникает для нижнего предела.

#### <a name="requirements"></a>Требования

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td><p><strong>Клиент</strong></p></td>
<td><p>Требуется Windows Vista, Windows XP или Windows 2000 Professional.</p></td>
</tr>
<tr class="even">
<td><p><strong>Server</strong></p></td>
<td><p>Требуется Windows Server 2008, Windows Server 2003 или Windows 2000 Server.</p></td>
</tr>
<tr class="odd">
<td><p><strong>Header</strong></p></td>
<td><p>Объявлено в ESENT. h.</p></td>
</tr>
<tr class="even">
<td><p><strong>Библиотека</strong></p></td>
<td><p>Используйте ESENT. lib.</p></td>
</tr>
<tr class="odd">
<td><p><strong>КОМПОНОВКИ</strong></p></td>
<td><p>Требуется ESENT.dll.</p></td>
</tr>
</tbody>
</table>


#### <a name="see-also"></a>См. также:

[JET_ERR](./jet-err.md)  
[JET_GRBIT](./jet-grbit.md)  
[JET_SESID](./jet-sesid.md)  
[JET_TABLEID](./jet-tableid.md)  
[жетмакекэй](./jetmakekey-function.md)  
[жетмове](./jetmove-function.md)  
[жетсетиндексранже]()  
[жетстопсервице](./jetstopservice-function.md)
