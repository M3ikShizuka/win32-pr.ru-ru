---
description: Дополнительные сведения о функции Жетсетсистемпараметер
title: Функция Жетсетсистемпараметер
TOCTitle: JetSetSystemParameter Function
ms:assetid: a244b5c9-6f6e-49d1-a6f7-9248feb9b92d
ms:mtpsurl: https://msdn.microsoft.com/library/Gg294044(v=EXCHG.10)
ms:contentKeyID: 32765643
ms.date: 04/11/2016
ms.topic: reference
api_name:
- JetSetSystemParameterA
- JetSetSystemParameterW
- JetSetSystemParameter
topic_type:
- apiref
- kbArticle
api_type:
- COM
- DLLExport
api_location:
- ESENT.DLL
ROBOTS: INDEX,FOLLOW
ms.openlocfilehash: c1d72fa8b5cda24435cec0f4ec5f0751862bc14c
ms.sourcegitcommit: 4665ebce0c106bdb52eef36e544280b496b6f50b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/26/2021
ms.locfileid: "122986547"
---
# <a name="jetsetsystemparameter-function"></a>Функция Жетсетсистемпараметер


_**Применимо к:** Windows | Windows Сервером_

## <a name="jetsetsystemparameter-function"></a>Функция Жетсетсистемпараметер

Функция **жетсетсистемпараметер** используется для установки множества параметров конфигурации ядра СУБД.

```cpp
    JET_ERR JET_API JetSetSystemParameter(
      __in_out_opt  JET_INSTANCE* pinstance,
      __in          JET_SESID sesid,
      __in          unsigned long paramid,
      __in          JET_API_PTR lParam,
      __in_opt      JET_PCSTR szParam
    );
```

### <a name="parameters"></a>Параметры

*пинстанце*

Указывает экземпляр, используемый для этого вызова.

**Windows 2000:**  для Windows 2000 этот параметр игнорируется и всегда должен иметь **значение NULL**.

**Windows XP:**  для Windows XP и более поздних выпусков этот параметр несколько перегружен. если ядро работает в устаревшем режиме (режим совместимости Windows 2000), где поддерживается только один экземпляр, этот параметр может иметь **значение NULL** или содержать фактический экземпляр, возвращаемый функцией [жетинит](./jetinit-function.md). В любом случае все параметры системного параметра считываются из одного экземпляра. Если ядро работает в режиме с несколькими экземплярами, этот параметр может иметь **значение NULL** или указатель на экземпляр, созданный с помощью [жетинит](./jetinit-function.md) или [жеткреатеиндекс](./jetcreateindex-function.md). Если этот параметр имеет **значение NULL** , то считывается параметр глобального системного параметра (или значение по умолчанию). Если этот параметр является экземпляром, то параметр системного параметра для этого экземпляра считывается.

Несмотря на то, что это технически параметр out, этот API никогда не изменяет содержимое предоставленного буфера.

*сесид*

Указывает сеанс, используемый для этого вызова.

Если этот параметр указан, то указанный экземпляр игнорируется, и будет использоваться экземпляр, связанный с сеансом.

*paramid*

Идентификатор системного параметра, который будет установлен. Полный список системных параметров и их свойств см. в разделе [Параметры системы](./extensible-storage-engine-system-parameters.md) .

*lParam*

Предоставляет значение, которое должно быть задано для выбранного системного параметра, если этот системный параметр имеет целочисленный тип.

*сзпарам*

Предоставляет значение для выбранного системного параметра, если этот системный параметр имеет строковый тип.

### <a name="return-value"></a>Возвращаемое значение

Эта функция возвращает [JET_ERR](./jet-err.md) DataType с одним из следующих кодов возврата. дополнительные сведения о возможных ошибках подсистемы ESE см. в разделе [ошибки расширенных служба хранилища Engine](./extensible-storage-engine-errors.md) и [параметры обработки ошибок](./error-handling-parameters.md).


| <p>Код возврата</p> | <p>Описание</p> | 
|--------------------|--------------------|
| <p>JET_errSuccess</p> | <p>Операция выполнена успешно.</p><p><strong>Windows Vista:</strong>  в Windows Vista и более поздних выпусках успешного выполнения может быть возвращено без изменения значения системного параметра. Дополнительные сведения см. в описании параметра JET_paramEnableAdvanced System в разделе " <a href="gg269346(v=exchg.10).md">Параметры meta</a> ".</p> | 
| <p>JET_errAlreadyInitialized</p> | <p>Экземпляр был инициализирован с помощью вызова <a href="gg294068(v=exchg.10).md">жетинит</a> , и эта операция не может быть выполнена в результате. Это может произойти для <strong>жетсетсистемпараметер</strong> при попытке настроить системный параметр после того, как изменение его значения не повлияет на состояние ядра СУБД.</p> | 
| <p>JET_errClientRequestToStopJetService</p> | <p>Невозможно выполнить операцию, так как все действия в экземпляре, связанном с сеансом, были прекращены в результате вызова <a href="gg269240(v=exchg.10).md">жетстопсервице</a>.</p> | 
| <p>JET_errIndexTuplesInvalidLimits</p> | <p>Указаны недопустимые параметры индекса кортежа. Эта ошибка может возвращаться <strong>жетсетсистемпараметер</strong> только при задании недопустимых значений <a href="gg294119(v=exchg.10).md">JET_paramIndexTuplesLengthMin</a>, <a href="gg294119(v=exchg.10).md">JET_paramIndexTuplesLengthMax</a>или <a href="gg294119(v=exchg.10).md">JET_paramIndexTuplesToIndexMax</a> .</p><p><strong>Windows XP и Windows Server 2003:</strong>  это может произойти только в Windows XP и Windows Server 2003.</p> | 
| <p>JET_errInitInProgress</p> | <p>Невозможно выполнить операцию, так как инициализируется экземпляр, связанный с сеансом.</p> | 
| <p>JET_errInstanceUnavailable</p> | <p>Невозможно выполнить операцию, поскольку экземпляр, связанный с сеансом, обнаружил неустранимую ошибку, которая требует, чтобы доступ ко всем данным был отозван для защиты целостности этих данных.</p><p><strong>Windows XP:</strong>  эта ошибка будет возвращена только Windows XP и более поздних выпусках.</p> | 
| <p>JET_errInvalidParameter</p> | <p>Один из указанных параметров содержит непредвиденное значение или содержит значение, которое не имеет смысла при объединении со значением другого параметра. Это может произойти для <strong>жетсетсистемпараметер</strong> в следующих случаях:</p><ul><li><p>Указанный идентификатор системного параметра является недопустимым или не поддерживается.</p></li><li><p>Предпринята попытка установить системный параметр с строковыми значениями, длина которого находилась вне допустимого диапазона для параметра.</p></li><li><p>Предпринята попытка установить системный параметр с символьным значением, где длина его абсолютного пути находилась вне допустимого диапазона для этого параметра.</p><p><strong>Windows Vista:</strong>  это может произойти только в Windows Vista и более поздних выпусках.</p></li><li><p>Предпринята попытка установить системный параметр с целочисленными значениями, который находится за пределами допустимого диапазона для параметра.</p></li><li><p>Предпринята попытка задать JET_paramUnicodeIndexDefault с <strong>нулевым</strong>указателем<a href="gg294097(v=exchg.10).md">JET_UNICODEINDEX</a> , недопустимым LCID или неподдерживаемым набором флагов LCMapString завершилось ошибкой.</p><p><strong>Windows Vista:</strong>  это может произойти только в Windows Vista и более поздних выпусках.</p></li><li><p>Невозможно задать указанный системный параметр, так как он доступен только для чтения.</p></li><li><p>Предпринята попытка установить системный параметр после вызова <a href="gg294068(v=exchg.10).md">жетинит</a> , ядро СУБД находится в режиме с одним экземпляром, а сеанс не был указан.</p><p><strong>Windows XP и Windows Server 2003:</strong>  это может произойти только в Windows XP и Windows Server 2003.</p></li><li><p>Указанный системный параметр является глобальным, и предпринята попытка установить для этого системного параметра значение конкретного экземпляра.</p><p><strong>Windows XP и Windows Server 2003:</strong>  это может произойти только в Windows XP и Windows Server 2003.</p></li><li><p>Указанный системный параметр доступен только для одного экземпляра, и предпринята попытка установить глобальное значение для этого системного параметра.</p><p><strong>Windows XP и Windows Server 2003:</strong>  это может произойти только в Windows XP и Windows Server 2003.</p></li></ul> | 
| <p>JET_errInvalidPath</p> | <p>Указан недопустимый путь к файловой системе. Эта ошибка может возвращаться <strong>жетсетсистемпараметер</strong> только при задании системных параметров, представляющих пути файловой системы. Например, <a href="gg269235(v=exchg.10).md">JET_paramSystemPath</a> может вернуть эту ошибку.</p> | 
| <p>JET_errNotInitialized</p> | <p>Невозможно выполнить операцию, так как экземпляр, связанный с сеансом, еще не инициализирован.</p> | 
| <p>JET_errRestoreInProgress</p> | <p>Невозможно выполнить операцию, так как в экземпляре, связанном с сеансом, выполняется операция восстановления.</p> | 
| <p>JET_errTermInProgress</p> | <p>Невозможно выполнить операцию, так как выполняется завершение работы экземпляра, связанного с сеансом.</p> | 
| <p>JET_errInvalidSesid</p> | <p>Недопустимый обработчик сеанса или ссылается на закрытый сеанс.</p><p>Эта ошибка не возвращается при всех обстоятельствах. Дескрипторы проверяются только на основе наилучшей силы.</p> | 
| <p>JET_errInvalidInstance</p> | <p>Недопустимый указатель экземпляра или ссылка на экземпляр, который был завершен.</p><p>Эта ошибка не возвращается при всех обстоятельствах. Дескрипторы проверяются только на основе наилучшей силы.</p><p><strong>Windows Vista:</strong>  эта ошибка будет возвращена только Windows Vista и более поздних выпусках.</p> | 



При успешном выполнении параметру System будет присвоено указанное значение.

При сбое параметр системного параметра останется неизменным.

#### <a name="remarks"></a>Комментарии

**Жетсетсистемпараметер** выполняет неплохое задание проверки выбранного параметра для каждого системного параметра. Необходимо соблюдать осторожность, чтобы не полагаться на эту проверку для применения правильных параметров. Обратите особое внимание на описание каждого системного параметра и следуйте этим рекомендациям для хорошего параметра системного параметра.

Существует набор системных параметров, которые всегда должны быть установлены, чтобы гарантировать, что ядро СУБД работает правильно. В частности, всегда следует устанавливать любые системные параметры, влияющие на физическую структуру файлов, используемых ядром СУБД. Дополнительные сведения см. в разделе [системные параметры](./extensible-storage-engine-system-parameters.md).

Каждый системный параметр имеет значение по умолчанию. Эти значения по умолчанию были изменены со временем и являются довольно произвольными. Настоятельно рекомендуется, чтобы приложение вычисляют все значения по умолчанию, чтобы убедиться, что они подходят. Если они не подходят, они должны быть настроены приложением. Это важно, так как многие из этих параметров могут значительно повлиять на надежность, производительность и использование ресурсов ядром СУБД.

#### <a name="requirements"></a>Требования


| Требование | Применение |
|------------|----------|
| <p><strong>Клиент</strong></p> | <p>требуется Windows Vista, Windows XP или Windows 2000 Professional.</p> | 
| <p><strong>Server</strong></p> | <p>требуется Windows server 2008, Windows server 2003 или сервер Windows 2000.</p> | 
| <p><strong>Header</strong></p> | <p>Объявлено в ESENT. h.</p> | 
| <p><strong>Библиотека</strong></p> | <p>Используйте ESENT. lib.</p> | 
| <p><strong>КОМПОНОВКИ</strong></p> | <p>Требуется ESENT.dll.</p> | 
| <p><strong>Юникод</strong></p> | <p>Реализуется как <strong>жетсетсистемпараметерв</strong> (Юникод) и <strong>жетсетсистемпараметера</strong> (ANSI).</p> | 



#### <a name="see-also"></a>См. также:

[JET_API_PTR](./jet-api-ptr.md)  
[JET_ERR](./jet-err.md)  
[JET_INSTANCE](./jet-instance.md)  
[JET_SESID](./jet-sesid.md)  
[жеткреатеинстанце](./jetcreateinstance-function.md)  
[жетжетсистемпараметер](./jetgetsystemparameter-function.md)  
[жетинит](./jetinit-function.md)  
[Системные параметры](./extensible-storage-engine-system-parameters.md)
