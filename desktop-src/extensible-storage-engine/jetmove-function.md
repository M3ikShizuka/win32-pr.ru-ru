---
description: Дополнительные сведения о функции Жетмове
title: Функция JetMove
TOCTitle: JetMove Function
ms:assetid: ded3cd21-8586-4d90-9efc-61213132d201
ms:mtpsurl: https://msdn.microsoft.com/library/Gg294117(v=EXCHG.10)
ms:contentKeyID: 32765731
ms.date: 04/11/2016
ms.topic: reference
api_name:
- JetMove
topic_type:
- apiref
- kbArticle
api_type:
- COM
- DLLExport
api_location:
- ESENT.DLL
ROBOTS: INDEX,FOLLOW
ms.openlocfilehash: 7e42cb2258d373f8c4edb96309c6db0853eab4fe
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104262862"
---
# <a name="jetmove-function"></a>Функция JetMove


_**Применимо к:** Windows | Windows Server_

## <a name="jetmove-function"></a>Функция JetMove

Функция **жетмове** размещает курсор в начале или в конце индекса и перебирает записи в этом индексе вперед или назад. Можно также переместить курсор вперед или назад по текущему индексу на указанное число записей индекса. Другой подход заключается в искусственном ограничении записей индекса, которые можно перечислить с помощью **жетмове** , настроив диапазон индексов в курсоре с помощью [жетсетиндексранже](./jetsetindexrange-function.md).

```cpp
    JET_ERR JET_API JetMove(
      __in          JET_SESID sesid,
      __in          JET_TABLEID tableid,
      __in          long cRow,
      __in          JET_GRBIT grbit
    );
```

### <a name="parameters"></a>Параметры

*сесид*

Сеанс, используемый для этого вызова.

*TableID*

Курсор, используемый для этого вызова.

*CRowset*

Произвольное смещение, которое указывает нужное перемещение курсора в текущем индексе.

Помимо стандартных смещений этот параметр также можно задать с помощью одного из следующих параметров.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Значение</p></th>
<th><p>Значение</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>JET_MoveFirst</p></td>
<td><p>Перемещает курсор к первой записи индекса в индексе (если она существует).</p>
<p><strong>Примечание</strong>   .   Для обозначения этого параметра используется литеральное значение-2147483648. Не используйте это значение в качестве обычного смещения или непредвиденного поведения.</p></td>
</tr>
<tr class="even">
<td><p>JET_MoveLast</p></td>
<td><p>Перемещает курсор к последнему элементу индекса в индексе (если он существует).</p>
<p><strong>Примечание</strong>   .   Для обозначения этого параметра используется литеральное значение 2147483647. Не используйте это значение в качестве обычного смещения или непредвиденного поведения.</p></td>
</tr>
<tr class="odd">
<td><p>JET_MoveNext</p></td>
<td><p>Перемещает курсор к следующей записи индекса в индексе (если она существует). Это значение точно равно обычному смещению + 1.</p></td>
</tr>
<tr class="even">
<td><p>JET_MovePrevious</p></td>
<td><p>Перемещает курсор к предыдущему элементу индекса в индексе (если он существует).</p>
<p>Это значение точно равно обычному смещению-1, или 0 (нуль).</p>
<p>Курсор остается в текущей логической позиции, и существует запись индекса, соответствующая логической позиции, которая будет протестирована.</p></td>
</tr>
</tbody>
</table>


*грбит*

Группа битов, задающих ноль или более следующих параметров.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Значение</p></th>
<th><p>Значение</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>JET_bitMoveKeyNE</p></td>
<td><p>Перемещает курсор вперед или назад по количеству записей индекса, необходимых для пропуска запрошенного количества значений ключа индекса, обнаруженных в индексе. Это влияет на свертывание записей индекса с повторяющимися значениями ключа в одну запись индекса. Как правило, смещение перемещает курсор на указанное число записей индекса независимо от их значений ключей.</p></td>
</tr>
</tbody>
</table>


### <a name="return-value"></a>Возвращаемое значение

Эта функция возвращает [JET_ERR](./jet-err.md) DataType с одним из следующих кодов возврата. Дополнительные сведения о возможных ошибках ESE см. в разделе [ошибки подсистемы хранилища](./extensible-storage-engine-errors.md) и [Параметры обработки ошибок](./error-handling-parameters.md).

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Код возврата</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>JET_errSuccess</p></td>
<td><p>Операция выполнена успешно. Для <strong>жетмове</strong>это означает, что запись индекса найдена в запрошенном расположении или смещении по текущему индексу.</p></td>
</tr>
<tr class="even">
<td><p>JET_errClientRequestToStopJetService</p></td>
<td><p>Операция не может быть завершена, так как все действия в экземпляре, связанном с сеансом, были прекращены в результате вызова <a href="gg269240(v=exchg.10).md">жетстопсервице</a>.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errInstanceUnavailable</p></td>
<td><p>Операция не может быть завершена, так как экземпляр, связанный с сеансом, обнаружил неустранимую ошибку, которая требует, чтобы доступ ко всем данным был отозван для защиты целостности этих данных.</p>
<p><strong>Windows XP:</strong>  Это возвращаемое значение введено в Windows XP.</p></td>
</tr>
<tr class="even">
<td><p>JET_errNoCurrentRecord</p></td>
<td><p>Курсор не находится на элементе индекса в данный момент. Для <strong>жетмове</strong>это означает, что запись индекса не была найдена в запрошенном месте или смещении по текущему индексу.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errNotInitialized</p></td>
<td><p>Операция не может быть завершена, так как экземпляр, связанный с сеансом, еще не инициализирован.</p></td>
</tr>
<tr class="even">
<td><p>JET_errRecordDeleted</p></td>
<td><p>Курсор в настоящее время логически позиционирован на записи индекса, соответствующей записи, которая была удалена.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errRestoreInProgress</p></td>
<td><p>Операция не может быть завершена, так как выполняется операция восстановления для экземпляра, связанного с сеансом.</p></td>
</tr>
<tr class="even">
<td><p>JET_errSessionSharingViolation</p></td>
<td><p>Один и тот же сеанс нельзя использовать одновременно для нескольких потоков.</p>
<p><strong>Windows XP:</strong>  Это возвращаемое значение введено в Windows XP.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errTermInProgress</p></td>
<td><p>Не удается выполнить операцию, так как выполняется завершение работы экземпляра, связанного с сеансом.</p></td>
</tr>
</tbody>
</table>


Если эта функция завершится с ошибкой, курсор будет размещен в записи индекса, соответствующей запрошенному расположению или смещению. Если запись подготовлена к обновлению, это обновление будет отменено. Если диапазон индекса действует, а JET_MoveFirst или JET_MoveLast был указан, то этот диапазон индексов будет отменен. Изменение состояния базы данных не выполняется.

Если эта функция завершается ошибкой, то позицию курсора остается неизменной, если не было возвращено JET_errNoCurrentRecord. В этом случае курсор будет размещен в том месте, где находится запись индекса, соответствующая запрошенному расположению или смещению. Курсор может быть перемещен относительно этой позиции, но по-прежнему не находится в допустимой записи индекса. Если запись подготовлена к обновлению, это обновление будет отменено. Если диапазон индекса действует, а JET_MoveFirst или JET_MoveLast был указан, то этот диапазон индексов будет отменен. Изменение состояния базы данных не выполняется.

#### <a name="remarks"></a>Комментарии

Курсор можно переместить в две специальные позиции с помощью **жетмове**, до первого и после последнего. Если курсор находится на первой записи индекса в таблице, а **жетмове** вызывается с JET_MovePrevious, вызов завершится с JET_errNoCurrentRecord и курсор будет логически размещается перед первой записью в индексе. Эта логическая позиция сохраняется, даже если другая запись индекса вставляется до первой записи в индексе. Аналогичная ситуация возникает в конце индекса после последней относительных событий. До первого и после последнего наиболее удобного использования при настройке диапазона элементов индекса для итерации с помощью **жетмове**, используя модель итератора, которая должна всегда перемещаться к следующему (или предыдущему) элементу перед использованием этого элемента.

Набор записей индекса, которые могут быть просмотрены **жетмове** , можно ограничить, настроив диапазон индексов в курсоре. Это полезно для приложений, которые перечисляют набор записей индекса, соответствующих простым критериям, которые могут быть выражены с помощью пары ключей поиска, созданных для этого индекса. Дополнительные сведения см. в разделе [жетсетиндексранже](./jetsetindexrange-function.md).

В выпусках до Windows Server 2003 с пакетом обновления 1 (SP1) существует проблема **жетмове** , которая возникает в некоторых специфических случаях, что влияет на правильное применение диапазона индексов, установленного функцией [жетсетиндексранже](./jetsetindexrange-function.md) . Если курсор находится перед первой записью индекса, а диапазон индексов задан с верхним пределом, которое меньше, чем первая запись индекса, следующий вызов **жетмове** будет ошибочно переходить к этой записи индекса вместо сбоя с JET_errNoCurrentRecord, как и ожидалось. Такая же ошибка произойдет в случае аналогичной ситуации, начиная с конца индекса. Такая ситуация может возникнуть в приложении, которое настраивает диапазон индексов и осуществляет переход к нему с помощью итератора, который должен запускаться перед первой записью индекса, которая является членом набора записей для перечисления, а не начиная с первой записи индекса этого набора. Эта ситуация также возникает в аналогичном случае, начиная с конца индекса. Решение заключается в том, чтобы приложение вручную проверяло, что полученная запись индекса находится внутри диапазона индексов, сравнивая ключ текущей записи индекса (полученный с помощью [жетретриевекэй](./jetretrievekey-function.md)) с ключом, представляющим конец текущего диапазона индекса (полученный с помощью [жетретриевекэй](./jetretrievekey-function.md) с помощью JET_bitRetrieveCopy).

Важно соблюдать осторожность при передаче вычисленных смещений в **жетмове**. Если вычисленное смещение меньше или равно JET_MoveFirst, то это смещение должно разбиваться на несколько частей, каждый из которых передается в **жетмове** отдельно, но в рамках одной транзакции, чтобы получить нужный результат. То же самое справедливо и для смещений, которые больше или равны JET_MoveNext. Маловероятно, что приложение будет передано в реальном мире, но при этом полезно иметь защиту от этого случая, учитывая очень другую семантику JET_MoveFirst и JET_MoveLast из обычного смещения.

Когда **жетмове** вызывается с очень большим смещением, например если для параметра CRowset задано значение 1000, **жетмове** проходит все 1000 записей индекса для достижения конечной позиции. В настоящее время API-интерфейс ESE не предоставляет эффективный способ перемещения непосредственно к заданной записи индекса по смещению, не продвигаясь по каждой записи индекса.

#### <a name="requirements"></a>Требования

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td><p><strong>Клиент</strong></p></td>
<td><p>Требуется Windows Vista, Windows XP или Windows 2000 Professional.</p></td>
</tr>
<tr class="even">
<td><p><strong>Server</strong></p></td>
<td><p>Требуется Windows Server 2008, Windows Server 2003 или Windows 2000 Server.</p></td>
</tr>
<tr class="odd">
<td><p><strong>Header</strong></p></td>
<td><p>Объявлено в ESENT. h.</p></td>
</tr>
<tr class="even">
<td><p><strong>Библиотека</strong></p></td>
<td><p>Используйте ESENT. lib.</p></td>
</tr>
<tr class="odd">
<td><p><strong>КОМПОНОВКИ</strong></p></td>
<td><p>Требуется ESENT.dll.</p></td>
</tr>
</tbody>
</table>


#### <a name="see-also"></a>См. также:

[JET_ERR](./jet-err.md)  
[JET_GRBIT](./jet-grbit.md)  
[JET_SESID](./jet-sesid.md)  
[JET_TABLEID](./jet-tableid.md)  
[жетретриевекэй](./jetretrievekey-function.md)  
[жетсетиндексранже](./jetsetindexrange-function.md)
