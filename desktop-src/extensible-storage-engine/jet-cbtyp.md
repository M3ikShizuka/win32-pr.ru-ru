---
description: 'Дополнительные сведения: JET_CBTYP'
title: JET_CBTYP
TOCTitle: JET_CBTYP
ms:assetid: babbfa11-01a7-477b-a525-cff27a983b60
ms:mtpsurl: https://msdn.microsoft.com/library/Gg294071(v=EXCHG.10)
ms:contentKeyID: 32765686
ms.date: 04/11/2016
ms.topic: reference
api_name: ''
topic_type:
- apiref
- kbArticle
api_type:
- COM
api_location: ''
ROBOTS: INDEX,FOLLOW
ms.openlocfilehash: b0a2d8551ea0ac47f10cbd189114dde36f72c8b0
ms.sourcegitcommit: 4665ebce0c106bdb52eef36e544280b496b6f50b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/26/2021
ms.locfileid: "122982957"
---
# <a name="jet_cbtyp"></a>JET_CBTYP


_**Применимо к:** Windows | Windows Сервером_

## <a name="jet_cbtyp"></a>JET_CBTYP

**JET_CBTYP** группа констант описывает все возможные точки в операции, которые ядро СУБД будет уведомлять приложение путем вызова функции обратного вызова [JET_CALLBACK](./jet-callback-callback-function.md) . Ядро СУБД передает одну из этих констант в параметр *кбтип* функции обратного вызова. Значение других параметров, передаваемых ядром СУБД в этом вызове, зависит от конкретного **JET_CBTYP** .

**Windows XP:**  **JET_CBTYP** группа констант введена в Windows XP.


| <p>Константа/значение</p> | <p>Описание</p> | 
|-----------------------|--------------------|
| <p>JET_cbtypNull<br />0x00000000</p> | <p>Этот обратный вызов зарезервирован и всегда считается недопустимым.</p> | 
| <p>JET_cbtypFinalize<br />0x00000001</p> | <p>Этот обратный вызов зарезервирован для будущего использования.</p> | 
| <p>JET_cbtypBeforeInsert<br />0x00000002</p> | <p>Этот обратный вызов выполняется непосредственно перед вставкой новой записи в таблицу с помощью вызова <a href="gg269288(v=exchg.10).md">жетупдате</a>.</p><p>Указатель функции для этой причины обратного вызова либо передается в <a href="gg269343(v=exchg.10).md">жеткреатетаблеколумниндекс</a> с помощью <a href="gg294146(v=exchg.10).md">JET_TABLECREATE</a> , либо настраивается во время выполнения с помощью <a href="gg269175(v=exchg.10).md">жетрегистеркаллбакк</a>. Дополнительные сведения см. в разделе <a href="gg294146(v=exchg.10).md">JET_TABLECREATE</a> или <a href="gg269175(v=exchg.10).md">жетрегистеркаллбакк</a>.</p><p>Параметры обратного вызова будут иметь следующие значения:</p><ul><li><p><em>сесид</em>: сеанс, в котором находится Вставляемая запись.</p></li><li><p><em>DBID</em>: идентификатор базы данных таблицы, содержащей вставляемую запись.</p></li><li><p><em>tableid</em>: курсор, подготовленный для вставки новой вставляемой записи. Важно отметить, что в данный момент значения всех столбцов версии или автоинкремента могут быть неправильными.</p></li><li><p><em>pvArg1</em>: <strong>null</strong></p></li><li><p><em>pvArg2</em>: <strong>null</strong></p></li><li><p><em>пвконтекст</em>: указатель контекста передается в <a href="gg269175(v=exchg.10).md">жетрегистеркаллбакк</a> или <strong>null</strong>.</p></li><li><p><em>улунусед</em>: <strong>null</strong> если функция обратного вызова возвращает ошибку, то операция, исходящий обратный вызов, завершится с ошибкой.</p></li></ul> | 
| <p>JET_cbtypAfterInsert<br />0x00000004</p> | <p>Этот обратный вызов выполняется сразу после вставки новой записи в таблицу с помощью вызова <a href="gg269288(v=exchg.10).md">жетупдате</a> , но до того, как <a href="gg269288(v=exchg.10).md">жетупдате</a> возвращается вызывающему объекту.</p><p>Указатель функции для этой причины обратного вызова либо передается в <a href="gg269343(v=exchg.10).md">жеткреатетаблеколумниндекс</a> с помощью <a href="gg294146(v=exchg.10).md">JET_TABLECREATE</a> , либо настраивается во время выполнения с помощью <a href="gg269175(v=exchg.10).md">жетрегистеркаллбакк</a>. Дополнительные сведения см. в разделе <a href="gg294146(v=exchg.10).md">JET_TABLECREATE</a> или <a href="gg269175(v=exchg.10).md">жетрегистеркаллбакк</a>.</p><p>Параметры обратного вызова будут иметь следующие значения:</p><ul><li><p><em>сесид</em>: сеанс, содержащий только что вставленную запись.</p></li><li><p><em>DBID</em>: идентификатор базы данных таблицы, содержащей только что вставленную запись.</p></li><li><p><em>tableid</em>: курсор на таблицу, в которую вставлена запись. Обратите внимание, что курсор по-прежнему находится в той же записи индекса, что и в обратном вызове перед вставкой. Обратите внимание, что эта запись индекса не может быть связана ни с одной из способов вставки записи.</p></li><li><p><em>pvArg1</em>: <strong>null</strong></p></li><li><p><em>pvArg2</em>: <strong>null</strong></p></li><li><p><em>пвконтекст</em>: указатель контекста передается в <a href="gg269175(v=exchg.10).md">жетрегистеркаллбакк</a> или <strong>null</strong>.</p></li><li><p><em>улунусед</em>: <strong>null</strong> если функция обратного вызова возвращает ошибку, она будет пропущена.</p></li></ul> | 
| <p>JET_cbtypBeforeReplace<br />0x00000008</p> | <p>Этот обратный вызов выполняется непосредственно перед существующей записью в таблице, измененной с помощью вызова <a href="gg269288(v=exchg.10).md">жетупдате</a>.</p><p>Указатель функции для этой причины обратного вызова либо передается в <a href="gg269343(v=exchg.10).md">жеткреатетаблеколумниндекс</a> с помощью <a href="gg294146(v=exchg.10).md">JET_TABLECREATE</a> , либо настраивается во время выполнения с помощью <a href="gg269175(v=exchg.10).md">жетрегистеркаллбакк</a>. Дополнительные сведения см. в разделе <a href="gg294146(v=exchg.10).md">JET_TABLECREATE</a> или <a href="gg269175(v=exchg.10).md">жетрегистеркаллбакк</a>.</p><p>Параметры обратного вызова будут иметь следующие значения:</p><ul><li><p><em>сесид</em>: сеанс с изменяемой записью.</p></li><li><p><em>DBID</em>: идентификатор базы данных таблицы, содержащей изменяемую запись.</p></li><li><p><em>tableid</em>: курсор, расположенный на записи индекса, связанной с изменяемой записью. Важно отметить, что в данный момент значения всех столбцов версии или автоинкремента могут быть неправильными.</p></li><li><p><em>pvArg1</em>: <strong>null</strong></p></li><li><p><em>pvArg2</em>: <strong>null</strong></p></li><li><p><em>пвконтекст</em>: указатель контекста передается в <a href="gg269175(v=exchg.10).md">жетрегистеркаллбакк</a> или <strong>null</strong>.</p></li><li><p><em>улунусед</em>: <strong>null</strong> если функция обратного вызова возвращает ошибку, то операция, исходящий обратный вызов, завершится с ошибкой.</p></li></ul> | 
| <p>JET_cbtypAfterReplace<br />0x00000010</p> | <p>Этот обратный вызов происходит сразу после того, как существующая запись в таблице была изменена вызовом <a href="gg269288(v=exchg.10).md">жетупдате</a> , но до <a href="gg269288(v=exchg.10).md">жетупдате</a> , возвращая ее вызывающему.</p><p>Указатель функции для этой причины обратного вызова либо передается в <a href="gg269343(v=exchg.10).md">жеткреатетаблеколумниндекс</a> с помощью <a href="gg294146(v=exchg.10).md">JET_TABLECREATE</a> , либо настраивается во время выполнения с помощью <a href="gg269175(v=exchg.10).md">жетрегистеркаллбакк</a>. Дополнительные сведения см. в разделе <a href="gg294146(v=exchg.10).md">JET_TABLECREATE</a> или <a href="gg269175(v=exchg.10).md">жетрегистеркаллбакк</a>.</p><p>Параметры обратного вызова будут иметь следующие значения:</p><ul><li><p><em>сесид</em>: сеанс с только что измененной записью.</p></li><li><p><em>DBID</em>: идентификатор базы данных таблицы, содержащей только что измененную запись.</p></li><li><p><em>tableid</em>: курсор, расположенный на элементе индекса, связанном с записью, которая была только что изменена.</p></li><li><p><em>pvArg1</em>: <strong>null</strong></p></li><li><p><em>pvArg2</em>: <strong>null</strong></p></li><li><p><em>пвконтекст</em>: указатель контекста передается в <a href="gg269175(v=exchg.10).md">жетрегистеркаллбакк</a> или <strong>null</strong>.</p></li><li><p><em>улунусед</em>: <strong>null</strong> если функция обратного вызова возвращает ошибку, она будет пропущена.</p></li></ul> | 
| <p>JET_cbtypBeforeDelete<br />0x00000020</p> | <p>Этот обратный вызов выполняется непосредственно перед удалением существующей записи в таблице путем вызова <a href="gg269315(v=exchg.10).md">жетделете</a>.</p><p>Указатель функции для этой причины обратного вызова либо передается в <a href="gg269343(v=exchg.10).md">жеткреатетаблеколумниндекс</a> с помощью <a href="gg294146(v=exchg.10).md">JET_TABLECREATE</a> , либо настраивается во время выполнения с помощью <a href="gg269175(v=exchg.10).md">жетрегистеркаллбакк</a>. Дополнительные сведения см. в разделе <a href="gg294146(v=exchg.10).md">JET_TABLECREATE</a> или <a href="gg269175(v=exchg.10).md">жетрегистеркаллбакк</a>.</p><p>Параметры обратного вызова будут иметь следующие значения:</p><ul><li><p><em>сесид</em>: сеанс, в котором находится удаляемая запись.</p></li><li><p><em>DBID</em>: идентификатор базы данных таблицы, содержащей удаляемую запись.</p></li><li><p><em>tableid</em>: курсор, расположенный на записи индекса, связанной с удаляемой записью.</p></li><li><p><em>pvArg1</em>: <strong>null</strong></p></li><li><p><em>pvArg2</em>: <strong>null</strong></p></li><li><p><em>пвконтекст</em>: указатель контекста передается в <a href="gg269175(v=exchg.10).md">жетрегистеркаллбакк</a> или <strong>null</strong>.</p></li><li><p><em>улунусед</em>: <strong>null</strong> если функция обратного вызова возвращает ошибку, то операция, исходящий обратный вызов, завершится с ошибкой.</p></li></ul> | 
| <p>JET_cbtypAfterDelete<br />0x00000040</p> | <p>Этот обратный вызов происходит сразу после удаления существующей записи в таблице с помощью вызова <a href="gg269315(v=exchg.10).md">жетделете</a> , но до того, как <a href="gg269315(v=exchg.10).md">жетделете</a> возвращается вызывающему объекту.</p><p>Указатель функции для этой причины обратного вызова либо передается в <a href="gg269343(v=exchg.10).md">жеткреатетаблеколумниндекс</a> с помощью <a href="gg294146(v=exchg.10).md">JET_TABLECREATE</a> , либо настраивается во время выполнения с помощью <a href="gg269175(v=exchg.10).md">жетрегистеркаллбакк</a>. Дополнительные сведения см. в разделе <a href="gg294146(v=exchg.10).md">JET_TABLECREATE</a> или <a href="gg269175(v=exchg.10).md">жетрегистеркаллбакк</a>.</p><p>Параметры обратного вызова будут иметь следующие значения:</p><ul><li><p><em>сесид</em>: сеанс, в котором есть только что удаленная запись.</p></li><li><p><em>DBID</em>: идентификатор базы данных таблицы, содержащей только что удаленную запись.</p></li><li><p><em>tableid</em>: курсор, расположенный на элементе индекса, связанном с записью, которая была только что удалена.</p></li><li><p><em>pvArg1</em>: <strong>null</strong></p></li><li><p><em>pvArg2</em>: <strong>null</strong></p></li><li><p><em>пвконтекст</em>: указатель контекста передается в <a href="gg269175(v=exchg.10).md">жетрегистеркаллбакк</a> или <strong>null</strong>.</p></li><li><p><em>улунусед</em>: <strong>null</strong></p></li></ul><p>Если обратный вызов возвращает ошибку, она будет пропущена.</p> | 
| <p>JET_cbtypUserDefinedDefaultValue<br />0x00000080</p> | <p>Этот обратный вызов выполняется, когда подсистеме требуется получить определенное пользователем значение столбца из приложения. Этот обратный вызов по сути является ограниченной реализацией <a href="gg269198(v=exchg.10).md">жетретриевеколумн</a> , которая оценивается приложением. Для определяемого пользователем значения по умолчанию может быть возвращено не более одного значения столбца.</p><p>Указатель функции для этой причины обратного вызова либо передается в <a href="gg294122(v=exchg.10).md">жетаддколумн</a> с помощью структуры <a href="gg269200(v=exchg.10).md">JET_USERDEFINEDDEFAULT</a> , либо передается <a href="gg269343(v=exchg.10).md">жеткреатетаблеколумниндекс</a> с помощью структуры <a href="gg269200(v=exchg.10).md">JET_USERDEFINEDDEFAULT</a> в структуре <a href="gg269252(v=exchg.10).md">JET_COLUMNCREATE</a> структуры <a href="gg294146(v=exchg.10).md">JET_TABLECREATE</a> .</p><p>Параметры обратного вызова будут иметь следующие значения:</p><ul><li><p><em>сесид</em>: сеанс, который вычисляет определяемое пользователем значение по умолчанию.</p></li><li><p><em>DBID</em>: идентификатор базы данных таблицы, которая содержит определенное пользователем значение по умолчанию</p></li><li><p><em>tableid</em>: курсор, расположенный на записи, для которой извлекается значение по умолчанию, определенное пользователем.</p></li><li><p><em>pvArg1</em>: выходной буфер для определяемого пользователем значения по умолчанию</p></li><li><p><em>pvArg2</em>: на входе — это размер выходного буфера. На выходе это фактический размер определяемого пользователем значения по умолчанию. в любом случае размер — это 32-разрядное целое число без знака.</p></li><li><p><em>пвконтекст</em>: указатель на буфер, содержащий пользовательские данные, указанные в структуре <a href="gg269200(v=exchg.10).md">JET_USERDEFINEDDEFAULT</a> при создании столбца, или значение null, если контекст не был предоставлен.</p></li><li><p><em>улунусед</em>: идентификатор столбца, для которого извлекается значение по умолчанию, определенное пользователем.</p></li></ul><p>Если функция обратного вызова возвращает ошибку, то операция, исходящий обратный вызов, завершится с такой ошибкой.</p><p>Если функция обратного вызова возвращает JET_wrnBufferTruncated, операция продолжится, но во время обратного вызова не будет получено все значение.</p><p>Если функция обратного вызова возвращает JET_wrnColumnNull, операция будет продолжена, но определенное пользователем значение по умолчанию для столбца будет равно NULL.</p> | 
| <p>JET_cbtypOnlineDefragCompleted<br />0x00000100</p> | <p>Этот обратный вызов происходит, когда оперативная дефрагментация базы данных, инициированной <a href="gg269317(v=exchg.10).md">жетдефрагмент</a> , была остановлена из-за завершения процесса или превышения предельного значения времени.</p><p>Указатель на функцию для этой причины обратного вызова передается в <a href="gg269317(v=exchg.10).md">жетдефрагмент</a>. Дополнительные сведения см. в разделе <a href="gg269317(v=exchg.10).md">жетдефрагмент</a>.</p><p>Параметры обратного вызова будут иметь следующие значения:</p><ul><li><p><em>сесид</em>: сеанс, используемый для выполнения оперативной дефрагментации базы данных или JET_sesidNil для потокового файла.</p></li><li><p><em>DBID</em>: идентификатор базы данных, дефрагментированной или JET_dbidNil для потокового файла.</p></li><li><p><em>tableid</em>: JET_tableidNil</p></li><li><p><em>pvArg1</em>: <strong>null</strong></p></li><li><p><em>pvArg2</em>: <strong>null</strong></p></li><li><p><em>пвконтекст</em>: <strong>null</strong></p></li><li><p><em>улунусед</em>: <strong>null</strong></p></li></ul><p>Если обратный вызов возвращает ошибку, она будет пропущена.</p> | 
| <p>JET_cbtypFreeCursorLS<br />0x00000200</p> | <p>этот обратный вызов происходит, когда приложению необходимо очистить контекстный обработчик для локального служба хранилища, связанного с курсором, который освобождается ядром субд. Дополнительные сведения см. в разделе <a href="gg269243(v=exchg.10).md">жетсетлс</a>.</p><p>Указатель на функцию для этой причины обратного вызова настроен с помощью <a href="gg294044(v=exchg.10).md">жетсетсистемпараметер</a> с <a href="gg269310(v=exchg.10).md">JET_paramRuntimeCallback</a>.</p><p>Параметры обратного вызова будут иметь следующие значения:</p><ul><li><p><em>сесид</em>: JET_sesidNil</p></li><li><p><em>DBID</em>: JET_dbidNil</p></li><li><p><em>tableid</em>: JET_tableidNil</p></li><li><p><em>pvArg1</em>: набор маркеров контекста с помощью <a href="gg269243(v=exchg.10).md">жетсетлс</a></p></li><li><p><em>pvArg2</em>: <strong>null</strong></p></li><li><p><em>пвконтекст</em>: <strong>null</strong></p></li><li><p><em>улунусед</em>: <strong>null</strong></p></li></ul><p>Если обратный вызов возвращает ошибку, она будет пропущена.</p> | 
| <p>JET_cbtypFreeTableLS<br />0x00000400</p> | <p>этот обратный вызов будет выполняться в результате необходимости в приложении очистить контекстный обработчик для локального служба хранилища, связанного с таблицей, которая освобождается ядром субд. Дополнительные сведения см. в разделе <a href="gg269243(v=exchg.10).md">жетсетлс</a>.</p><p>Указатель на функцию для этой причины обратного вызова настроен с помощью <a href="gg294044(v=exchg.10).md">жетсетсистемпараметер</a> с <a href="gg269310(v=exchg.10).md">JET_paramRuntimeCallback</a>.</p><p>Параметры обратного вызова будут иметь следующие значения:</p><ul><li><p><em>сесид</em>: JET_sesidNil</p></li><li><p><em>DBID</em>: JET_dbidNil</p></li><li><p><em>tableid</em>: JET_tableidNil</p></li><li><p><em>pvArg1</em>: набор маркеров контекста с помощью <a href="gg269243(v=exchg.10).md">жетсетлс</a>.</p></li><li><p><em>pvArg2</em>: <strong>null</strong></p></li><li><p><em>пвконтекст</em>: <strong>null</strong></p></li><li><p><em>улунусед</em>: <strong>null</strong></p></li></ul><p>Если обратный вызов возвращает ошибку, она будет пропущена.</p> | 



### <a name="requirements"></a>Требования


| Требование | Применение |
|------------|----------|
| <p><strong>Клиент</strong></p> | <p>требуется Windows Vista или Windows XP.</p> | 
| <p><strong>Server</strong></p> | <p>требуется Windows server 2008 или Windows server 2003.</p> | 
| <p><strong>Header</strong></p> | <p>Объявлено в ESENT. h.</p> | 



### <a name="see-also"></a>См. также:

[JET_CALLBACK](./jet-callback-callback-function.md)
