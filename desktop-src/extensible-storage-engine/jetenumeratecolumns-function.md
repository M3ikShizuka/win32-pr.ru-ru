---
description: Дополнительные сведения о функции Жетенумератеколумнс
title: Функция JetEnumerateColumns
TOCTitle: JetEnumerateColumns Function
ms:assetid: 8413d056-cdb1-420e-9dd3-7280ad510165
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269321(v=EXCHG.10)
ms:contentKeyID: 32765611
ms.date: 04/11/2016
ms.topic: reference
api_name:
- JetEnumerateColumns
topic_type:
- apiref
- kbArticle
api_type:
- COM
- DLLExport
api_location:
- ESENT.DLL
ROBOTS: INDEX,FOLLOW
ms.openlocfilehash: b913fb970232ca6f0fc21eb846df85e1db684f45
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104265532"
---
# <a name="jetenumeratecolumns-function"></a>Функция JetEnumerateColumns


_**Применимо к:** Windows | Windows Server_

## <a name="jetenumeratecolumns-function"></a>Функция JetEnumerateColumns

Функция **жетенумератеколумнс** эффективно извлекает набор столбцов и их значений из текущей записи курсора или буфера копирования этого курсора. Возвращаемые столбцы и значения могут быть ограничены списком идентификаторов столбцов, *итагсекуенце* числами и другими характеристиками. Этот интерфейс API извлечения столбца уникален в том, что он возвращает сведения в динамически выделяемой памяти, получаемой с [помощью предоставленного](/cpp/c-runtime-library/reference/realloc?view=vs-2019) пользователем обратного вызова, совместимого с переопределением. Эта новая гибкость позволяет эффективно получать данные столбцов с определенными характеристиками (например, размер и количество элементов), неизвестных вызывающему объекту. Это устраняет необходимость использования режимов обнаружения [жетретриевеколумн](./jetretrievecolumn-function.md) для определения этих характеристик, чтобы настроить окончательный вызов [жетретриевеколумн](./jetretrievecolumn-function.md) , который будет успешно получать нужные данные.

**Windows XP: жетенумератеколумнс** появился в Windows XP.

```cpp
    JET_ERR JET_API JetEnumerateColumns(
      __in          JET_SESID sesid,
      __in          JET_TABLEID tableid,
      __in          unsigned long cEnumColumnId,
      __in_opt      JET_ENUMCOLUMNID* rgEnumColumnId,
      __out         unsigned long* pcEnumColumn,
      __out         JET_ENUMCOLUMN** prgEnumColumn,
      __in          JET_PFNREALLOC pfnRealloc,
      __in          void* pvReallocContext,
      __in          unsigned long cbDataMost,
      __in          JET_GRBIT grbit
    );
```

### <a name="parameters"></a>Параметры

*сесид*

Сеанс, используемый для этого вызова.

*TableID*

Курсор, используемый для этого вызова.

*ценумколумнид*

Массив идентификаторов столбцов, каждый из которых имеет необязательный массив *итагсекуенце* чисел для перечисления.

Если *ценумколумнид* имеет значение 0 (ноль), то *рженумколумнид* игнорируется и значения всех столбцов перечисляются и возвращаются вызывающему объекту. Если элемент массива ИДЕНТИФИКАТОРов столбцов ссылается на нулевой столбец с ИДЕНТИФИКАТОРом 0 (ноль), то перечисление этого столбца пропускается и создается соответствующий слот в выходных данных с состоянием столбца JET_wrnColumnSkipped.

Если *ктагсекуенце* имеет значение 0 (ноль) для заданного элемента массива идентификаторов столбцов, *ргтагсекуенце* игнорируется, и все значения столбцов для этого идентификатора столбца перечисляются и возвращаются вызывающему объекту. Если элемент массива *итагсекуенце* Number ссылается на *итагсекуенце* число 0 (ноль), то перечисление этого числа *итагсекуенце* пропускается, а соответствующая ячейка в выходных данных будет формироваться со значением столбца status JET_wrnColumnSkipped.

*рженумколумнид*

См. *ценумколумнид*.

*пценумколумн*

Возвращает перечислимый массив столбцов и их значения в памяти, выделенной через предоставленный *итагсекуенце* -совместимый обратный вызов.

Если на входе запрашивается массив идентификаторов столбцов, порядок и размер выходного массива будут отражать порядок и размер входного массива. Аналогично, если массив номеров *итагсекуенце* запрашивается для определенного идентификатора столбца на входе, порядок и размер выходного массива значений столбцов для этого столбца будут отражать порядок и размер входного массива.

Для выходных параметров задано значение 0 (ноль) и **null** для любой ошибки, кроме JET_errBadColumnId и JET_errColumnNotFound. При возвращении этих ошибок выходные данные являются допустимыми и полными для всех идентификаторов столбцов, кроме затронутых. Коду состояния для каждого из затронутых идентификаторов столбцов присваивается одна из этих ошибок, чтобы вызывающий объект мог определить, какие идентификаторы столбцов были некорректными, и потенциально предпринять корректирующие действия.

*прженумколумн*

См. *пценумколумн*.

*пфнреаллок*

Определяет [совместимый](/cpp/c-runtime-library/reference/realloc?view=vs-2019) с перераспределением обратный вызов и Необязательный указатель контекста, используемый для выделения памяти для выходного массива столбцов и их значений.

*пвреаллокконтекст*

См. *пфнреаллок*.

*кбдатамост*

Устанавливает ограничение на объем данных, возвращаемых из длинного текстового или длинного двоичного столбца.

Этот параметр можно использовать, чтобы предотвратить перечисление слишком большого значения столбца. Обычно такое перечисление может привести к сбою вызова API с JET_errOutOfMemory. Если значение большого столбца усекается таким образом, значение столбца будет JET_wrnColumnTruncated.

*грбит*

Группа битов, задающая ноль или более следующих параметров.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Значение</p></th>
<th><p>Значение</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>JET_bitEnumerateCompressOutput</p></td>
<td><p>При перечислении значений столбцов все столбцы, для которых мы получаем все значения и которые имеют только одно значение столбца, отличного от NULL, могут быть возвращены в сжатом формате. Для таких столбцов будет задано значение JET_wrnColumnSingleValue, а размер значения столбца и объем памяти, содержащей значение столбца, будут возвращаться непосредственно в структуре <a href="gg294138(v=exchg.10).md">JET_ENUMCOLUMN</a> . Не гарантируется, что все подходящие столбцы сжимаются таким образом. Дополнительные сведения см. в разделе <a href="gg294138(v=exchg.10).md">JET_ENUMCOLUMN</a> .</p></td>
</tr>
<tr class="even">
<td><p>JET_bitEnumerateCopy</p></td>
<td><p>Этот параметр указывает, что необходимо перечислить измененные значения столбца записи, а не исходные значения столбца. Если значение столбца не было изменено, исходное значение столбца перечисляется. Таким образом, значение столбца, которое еще не было вставлено или Обновлено, может быть перечислено при вставке или обновлении записи.</p>
<p>Этот параметр идентичен JET_bitRetrieveCopy при использовании с <a href="gg269198(v=exchg.10).md">жетретриевеколумн</a> или <a href="gg294135(v=exchg.10).md">жетретриевеколумнс</a>.</p></td>
</tr>
<tr class="odd">
<td><p>JET_bitEnumerateIgnoreDefault</p></td>
<td><p>Если данный столбец отсутствует в записи, значение столбца не будет возвращено. Обычно в этом случае возвращается значение по умолчанию для столбца, если таковое имеется. Гарантируется, что если в столбце задано значение, отличное от значения по умолчанию, то будет возвращено другое значение (т. е. Если для столбца со значением по умолчанию явно задано значение <strong>null</strong> , то в качестве значения для этого столбца будет возвращено значение <strong>null</strong> ). Обратите внимание, что даже при запросе этого параметра по-прежнему можно увидеть значение столбца, которое должно быть равно значению по умолчанию. Для удаления значений столбцов, соответствующих значениям по умолчанию, никаких усилий не предпринимается.</p>
<p>Важно отметить, что этот параметр влияет на выходные данные <strong>жетенумератеколумнс</strong> при использовании с JET_bitEnumeratePresenceOnly или JET_bitEnumerateTaggedOnly.</p></td>
</tr>
<tr class="even">
<td><p>JET_bitEnumerateIgnoreUserDefinedDefault</p></td>
<td><p>Если данный столбец отсутствует в записи и имеет определенное пользователем значение по умолчанию, значение столбца не будет возвращено. Этот параметр предотвратит вызов функции обратного вызова, которая будет вычислять определенное пользователем значение по умолчанию для столбца, при перечислении значений для этого столбца.</p>
<p><strong>Windows Server 2003 и более ранние версии:  </strong> Для Windows Server 2003 и более ранних версий операция завершится ошибкой с JET_errCallbackFailed.</p>
<p><strong>Windows Server 2003 SP1:  </strong> Это возможное значение доступно только для Windows Server 2003 с пакетом обновления 1 (SP1) и более поздних операционных систем. Если это возможное значение указано и таблица содержит столбец с пользовательским значением по умолчанию, операция завершится с JET_errCallbackFailed.</p></td>
</tr>
<tr class="odd">
<td><p>JET_bitEnumeratePresenceOnly</p></td>
<td><p>Если для запрошенного столбца или значения столбца существует значение, отличное от NULL, связанные данные не возвращаются. Вместо этого связанное состояние для этого столбца или значения столбца будет установлено в значение JET_wrnColumnPresent. Если значение столбца или столбца равно <strong>null</strong> , JET_wrnColumnNull будут возвращены как обычно.</p></td>
</tr>
<tr class="even">
<td><p>JET_bitEnumerateTaggedOnly</p></td>
<td><p>При перечислении всех значений столбцов в записи (например, если <em>ценумколумнид</em> равен нулю) будут возвращены только значения столбцов с тегами. Этот параметр не допускается при перечислении определенного массива идентификаторов столбцов.</p></td>
</tr>
<tr class="odd">
<td><p>JET_bitEnumerateInRecordOnly</p></td>
<td><p><strong>Windows 7:  </strong> JET_bitEnumerateInRecordOnly введен в Windows 7.</p></td>
</tr>
</tbody>
</table>


### <a name="return-value"></a>Возвращаемое значение

Эта функция возвращает [JET_ERR](./jet-err.md) DataType с одним из следующих кодов возврата. Дополнительные сведения о возможных ошибках ESE см. в разделе [ошибки подсистемы хранилища](./extensible-storage-engine-errors.md) и [Параметры обработки ошибок](./error-handling-parameters.md).

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Код возврата</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>JET_errSuccess</p></td>
<td><p>Операция выполнена успешно.</p></td>
</tr>
<tr class="even">
<td><p>JET_errBadColumnId</p></td>
<td><p>Указанный идентификатор столбца находится за пределами допустимых ограничений идентификатора столбца. Эта ошибка будет возвращена <strong>жетенумератеколумнс</strong> , если были запрошены определенные идентификаторы столбцов, один из этих идентификаторов столбцов был недопустимым, а первый недопустимый идентификатор столбца завершился с ошибкой для своего кода состояния столбца.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errClientRequestToStopJetService</p></td>
<td><p>Невозможно выполнить операцию, так как все действия в экземпляре, связанном с сеансом, были прекращены в результате вызова <a href="gg269240(v=exchg.10).md">жетстопсервице</a>.</p></td>
</tr>
<tr class="even">
<td><p>JET_errColumnNotFound</p></td>
<td><p>Столбец, описываемый данным ИДЕНТИФИКАТОРом столбца, не существует в таблице. Эта ошибка будет возвращена <strong>жетенумератеколумнс</strong> , если были запрошены определенные идентификаторы столбцов, один из этих идентификаторов столбцов был недопустимым, а первый недопустимый идентификатор столбца завершился с ошибкой для своего кода состояния столбца.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errInstanceUnavailable</p></td>
<td><p>Невозможно выполнить операцию, поскольку экземпляр, связанный с сеансом, обнаружил неустранимую ошибку, которая требует, чтобы доступ ко всем данным был отозван для защиты целостности этих данных.</p>
<p><strong>Windows XP:  </strong> Эта ошибка будет возвращена только Windows XP и более поздних версий.</p></td>
</tr>
<tr class="even">
<td><p>JET_errInvalidgrbit</p></td>
<td><p>Один из запрошенных параметров недопустим или не реализован. Эта ошибка будет возвращена <strong>жетенумератеколумнс</strong> в следующих случаях:</p>
<ul>
<li><p>Указан JET_bitEnumerateLocal.</p></li>
<li><p>Указан недопустимый <em>грбит</em> .</p></li>
</ul></td>
</tr>
<tr class="odd">
<td><p>JET_errInvalidParameter</p></td>
<td><p>Один из указанных параметров содержит непредвиденное значение или содержит значение, которое не имеет смысла при объединении со значением другого параметра. Эта ошибка будет возвращена <strong>жетенумератеколумнс</strong> в следующих случаях:</p>
<ul>
<li><p><em>пценумколумн</em> имеет <strong>значение NULL</strong>.</p></li>
<li><p><em>прженумколумн</em> имеет <strong>значение NULL</strong>.</p></li>
<li><p><em>пфнреаллок</em> имеет <strong>значение NULL</strong>.</p></li>
</ul></td>
</tr>
<tr class="even">
<td><p>JET_errNoCurrentRecord</p></td>
<td><p>Курсор не располагается на записи. Это может произойти по различным причинам. Например, это произойдет, если курсор находится в данный момент после последней записи в текущем индексе.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errNotInitialized</p></td>
<td><p>Невозможно выполнить операцию, так как экземпляр, связанный с сеансом, еще не инициализирован.</p></td>
</tr>
<tr class="even">
<td><p>JET_errRecordDeleted</p></td>
<td><p>Курсор располагается на записи, которая была удалена. Это может произойти по различным причинам. Наиболее распространенной причиной является то, что сеанс не находится в транзакции, курсор был помещен в запись, эта запись была удалена, а затем курсор попытался ссылаться на эту запись.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errRestoreInProgress</p></td>
<td><p>Невозможно выполнить операцию, так как в экземпляре, связанном с сеансом, выполняется операция восстановления.</p></td>
</tr>
<tr class="even">
<td><p>JET_errSessionSharingViolation</p></td>
<td><p>Один и тот же сеанс нельзя использовать одновременно для нескольких потоков.</p>
<p><strong>Windows XP:  </strong> Эта ошибка будет возвращена только Windows XP и более поздних версий.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errTermInProgress</p></td>
<td><p>Невозможно выполнить операцию, так как выполняется завершение работы экземпляра, связанного с сеансом.</p></td>
</tr>
</tbody>
</table>


При успешном выполнении запрошенные данные будут возвращены в выходные буферы. Вызывающая сторона обязана освободить любую память, выделенную этим обратным вызовом, и возвратить ее в выходные буферы. Эта память должна быть освобождена с помощью указанного обратного вызова, совместимого с [перераспределениями](/cpp/c-runtime-library/reference/realloc?view=vs-2019) . Изменение состояния базы данных не выполняется.

При сбое ни один из запрошенных данных не будет возвращен. Память, выделенная во время вызова, будет освобождена автоматически с помощью указанного обратного вызова [, совместимого](/cpp/c-runtime-library/reference/realloc?view=vs-2019) с перераспределением. Изменение состояния базы данных не выполняется.

#### <a name="remarks"></a>Комментарии

Если перечисляются все значения столбцов в записи и вы не указали JET_bitEnumerateIgnoreDefaults то предположить, что столбец или значение столбца с кодом состояния JET_wrnColumnNull не будут отображаться. Этот код состояния можно увидеть, если столбец имеет значение по умолчанию и явно установил значение **null** или если столбец является неразреженным (например, фиксированный или переменный столбец).

Параметр *кбдатамост* не применяется ко всем значениям столбцов. Этот параметр усекает только длинные текстовые и длинные двоичные значения столбцов, которые настолько велики, что они хранились отдельно от записи.

Если **жетенумератеколумнс** возвращает данные в выходных параметрах, вызывающий объект отвечает за освобождение памяти в массиве, а также на любую память, на которую ссылаются указатели, внедренные в этот массив.

#### <a name="requirements"></a>Требования

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td><p><strong>Клиент</strong></p></td>
<td><p>Требуется Windows Vista или Windows XP.</p></td>
</tr>
<tr class="even">
<td><p><strong>Server</strong></p></td>
<td><p>Требуется Windows Server 2008 или Windows Server 2003.</p></td>
</tr>
<tr class="odd">
<td><p><strong>Header</strong></p></td>
<td><p>Объявлено в ESENT. h.</p></td>
</tr>
<tr class="even">
<td><p><strong>Библиотека</strong></p></td>
<td><p>Используйте ESENT. lib.</p></td>
</tr>
<tr class="odd">
<td><p><strong>КОМПОНОВКИ</strong></p></td>
<td><p>Требуется ESENT.dll.</p></td>
</tr>
</tbody>
</table>


#### <a name="see-also"></a>См. также:

[JET_ERR](./jet-err.md)  
[JET_GRBIT](./jet-grbit.md)  
[JET_SESID](./jet-sesid.md)  
[JET_TABLEID](./jet-tableid.md)  
[JET_ENUMCOLUMNID](./jet-enumcolumnid-structure.md)  
[JET_ENUMCOLUMN](./jet-enumcolumn-structure.md)  
[JET_ENUMCOLUMNVALUE](./jet-enumcolumnvalue-structure.md)  
[JET_PFNREALLOC](./jet-pfnrealloc-callback-function.md)  
[realloc](/cpp/c-runtime-library/reference/realloc?view=vs-2019)  
[жетретриевеколумн](./jetretrievecolumn-function.md)  
[жетретриевеколумнс](./jetretrievecolumns-function.md)
