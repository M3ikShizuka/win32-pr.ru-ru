---
description: 'Дополнительные сведения: ключ индекса'
title: Ключ индекса
TOCTitle: Index Key
ms:assetid: 104bdb1c-71ac-44f4-bbda-c553131aaad4
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269188(v=EXCHG.10)
ms:contentKeyID: 32765491
ms.date: 04/11/2016
ms.topic: article
ms.openlocfilehash: eff0812f363fa83d133ab087140d415d8e2dbad3
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104549789"
---
# <a name="index-key"></a>Ключ индекса


_**Применимо к:** Windows | Windows Server_

## <a name="index-key"></a>Ключ индекса

Индекс создается для данных в таблице с [жеткреатеиндекс](./jetcreateindex-function.md) или несколько индексов можно создать одновременно с помощью [JetCreateIndex2](./jetcreateindex2-function.md) , используя структуру [JET_INDEXCREATE](./jet-indexcreate-structure.md) . Индекс определяется в виде массива столбцов в порядке очередности. Этот массив столбцов также называется ключом индекса. Ключ индекса может быть определен как первичный индекс, если параметр JET_bitIndexPrimary задан в параметре *Грбит* [жеткреатеиндекс](./jetcreateindex-function.md) или [JET_INDEXCREATE](./jet-indexcreate-structure.md). Ключ индекса является пустой строкой, завершающейся нулем, как показано в следующем примере:

\+Col1 \\ 0-Col2 \\ 0 + Col3 \\ 0 \\ 0

Ключ в примере можно использовать для создания индекса более чем для трех столбцов в таблице. Каждый столбец, указанный в индексе, называется "сегментом индекса" или "ключевым столбцом". Сегмент индекса может быть как по возрастанию, так и по убыванию в плане его вклада в порядок. В приведенном выше примере имя первого столбца в индексе — col1. Значение + указывает, что col1 индексируется в возрастающем порядке. Столбец "– Before" указывает, что он индексируется в убывающем порядке.

Если в индексе имеются условные столбцы, то для указания того, как они индексируются, используется структура [JET_CONDITIONALCOLUMN](./jet-conditionalcolumn-structure.md) . Условный столбец может использоваться для управления присутствием или отсутствием записи индекса в индексе на основе значения в соответствующем условном столбце, не влияя на порядок сортировки индекса. Условный столбец может включать или исключать запись индекса из индекса, если значение этого условного столбца равно NULL для соответствующей записи.

По умолчанию максимальный размер ключа индекса задается JET_cbKeyMost константе, которая всегда составляет 255 байт нормализованных данных (в байтах данных, включая затраты на индексирование). Начиная с Windows Vista, максимальный размер ключа индекса можно задать с помощью структуры [JET_INDEXCREATE](./jet-indexcreate-structure.md) . Максимальный размер ключа индекса соответствует размеру страницы базы данных. Чтобы включить настраиваемый максимальный размер ключа, укажите параметр Jet_bitIndexKeyMost в элементе грбитс в [JET_INDEXCREATE](./jet-indexcreate-structure.md)и присвойте элементу **кбкэймост** одно из следующих значений:

  - JET_cbKeyMost2KBytePage: Если размер страницы базы данных составляет 2048 байт, максимальный размер ключа индекса может составлять от 255 до 500 минимум байт.

  - JET_cbKeyMost4KBytePage: Если размер страницы базы данных составляет 4096 байт, максимальный размер ключа индекса может составлять от 255 до 1000 минимум байт.

  - JET_cbKeyMost8KBytePage: Если размер страницы базы данных составляет 8196 байт, максимальный размер ключа индекса может составлять от 255 до 2000 минимум байт.

В примере на схеме ниже показана таблица, содержащая сведения о сотрудниках. Таблица содержит 6 столбцов, каждый из которых определяет определенный атрибут Employee. Запись в таблице содержит значения для сотрудника, например имя сотрудника в столбце 1 и идентификатор сотрудника в столбце 2. Первичный индекс, созданный для этой таблицы, упорядочивает данные в соответствии с именем сотрудника, а второй — с ИДЕНТИФИКАТОРом сотрудника. Имя и идентификатор индексируются в возрастающем порядке. Например, запись, содержащая имя Джонсон и идентификатор сотрудника 12345, будет указана перед записью с именем сотрудника Jones и ИДЕНТИФИКАТОРом 10000. Все записи для Jones хранятся в таблице вместе с идентификаторами сотрудников в возрастающем порядке, как показано в таблице.

![ESE_Documentation_IndexTable](images/Gg269188.ESE_Documentation_IndexTable(EXCHG.10).gif "ESE_Documentation_IndexTable")

Ключ в первичном индексе должен быть уникальным, но ключи в дополнительном индексе могут быть повторяющимися. Например, если индекс создан над фамилией и в базе данных есть два человека с Стивенс, то ESE возвращает ошибку Jet_errKeyDuplicate из [жетупдате](./jetupdate-function.md) или [JetUpdate2](./jetupdate2-function.md), когда приложение пытается вставить второй "Стивенс". Если фактический ключ больше, чем максимальный размер ключа, ключ усекается. Результаты усечения ключа осуществляют поиск и уникальность и должны управляться приложением. Например, если "Стивенс" и "Стевенсон" хранились в индексе по фамилии, а максимальный размер ключа был слишком мал для хранения "on" части "Стевенсон", то при усечении ключа будет обнаружено, что ядро СУБД объявило, что "Стивенс" и "Стевенсон" дублируются, даже если это не так. Приложение должно быть подготовлено для обработки подобных ситуаций во время поиска и обновления, если определение индекса и значения столбцов, которые он индексирует, имеют такое усечение ключа. Начиная с Windows Vista, приложения могут указать параметр Jet_bitIndexDisallowTruncation в [JET_INDEXCREATE](./jet-indexcreate-structure.md) или [жетмакекэй](./jetmakekey-function.md). При указании этого флага любое обновление индекса приведет к сбою усечения ключа с JET_errKeyTruncated. В противном случае ключи будут обрезаны без уведомления. Это позволит приложению работать без проблем для артефактов, вызванных усечением ключа, описанным выше.
