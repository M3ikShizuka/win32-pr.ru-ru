---
description: Дополнительные сведения о функции Жетупдате
title: Функция JetUpdate
TOCTitle: JetUpdate Function
ms:assetid: 6c9a53d0-46bc-403b-bdba-9020e023c14a
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269288(v=EXCHG.10)
ms:contentKeyID: 32765580
ms.date: 04/11/2016
ms.topic: reference
api_name:
- JetUpdate
topic_type:
- apiref
- kbArticle
api_type:
- DLLExport
- COM
api_location:
- ESENT.DLL
ROBOTS: INDEX,FOLLOW
ms.openlocfilehash: 3e02550fb40987906e21d588263daed9dc68aa5d
ms.sourcegitcommit: 9b5faa61c38b2d0c432b7f2dbee8c127b0e28a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2021
ms.locfileid: "122478250"
---
# <a name="jetupdate-function"></a>Функция JetUpdate


_**Применимо к:** Windows | Windows Сервером_

## <a name="jetupdate-function"></a>Функция JetUpdate

Функция **жетупдате** выполняет операцию обновления, включая вставку новой строки в таблицу или обновление существующей строки. Удаление строки таблицы выполняется путем вызова [жетделете](./jetdelete-function.md).

**Жетупдате** является последним шагом в выполнении вставки или обновления. Обновление начинается с вызова [жетпрепареупдате](./jetprepareupdate-function.md) , а затем путем вызова [жетсетколумн](./jetsetcolumn-function.md) или [жетсетколумнс](./jetsetcolumns-function.md) один или несколько раз для задания состояния записи. Наконец, для завершения операции обновления вызывается **жетупдате** . Индексы обновляются только в **жетупдате** или [JetUpdate2](./jetupdate2-function.md), а не во время [жетсетколумн](./jetsetcolumn-function.md) или [жетсетколумнс](./jetsetcolumns-function.md).

```cpp
    JET_ERR JET_API JetUpdate(
      __in          JET_SESID sesid,
      __in          JET_TABLEID tableid,
      __out_opt     void* pvBookmark,
      __in          unsigned long cbBookmark,
      __out_opt     unsigned long* pcbActual
    );
```

### <a name="parameters"></a>Параметры

*сесид*

Сеанс, используемый для этого вызова.

*TableID*

Курсор, используемый для этого вызова.

*пвбукмарк*

Указатель на возвращаемую закладку для вставленной строки.

*кббукмарк*

Размер буфера, на который указывает *пвбукмарк*.

*пкбактуал*

Возвращаемый размер закладки для вставляемой строки, возвращенной в *пвбукмарк*.

### <a name="return-value"></a>Возвращаемое значение

Эта функция возвращает [JET_ERR](./jet-err.md) DataType с одним из следующих кодов возврата. дополнительные сведения о возможных ошибках подсистемы ESE см. в разделе [ошибки расширенных служба хранилища Engine](./extensible-storage-engine-errors.md) и [параметры обработки ошибок](./error-handling-parameters.md).


| <p>Код возврата</p> | <p>Описание</p> | 
|--------------------|--------------------|
| <p>JET_errSuccess</p> | <p>Операция выполнена успешно.</p> | 
| <p>JET_errBufferTooSmall</p> | <p>Заданный буфер для закладки записи недостаточно велик для хранения закладки записи.</p> | 
| <p>JET_errClientRequestToStopJetService</p> | <p>Невозможно выполнить операцию, так как все действия в экземпляре, связанном с сеансом, были прекращены в результате вызова <a href="gg269240(v=exchg.10).md">жетстопсервице</a>.</p> | 
| <p>JET_errColumnIllegalNull</p> | <p>То же, что и JET_errNullInvalid.</p> | 
| <p>JET_errDiskFull</p> | <p>Операция обновления требует увеличения размера файла базы данных или выделения файла журнала, но диск, на котором находится файл базы данных или ряд журналов, заполнен. Кроме того, файл базы данных находится на томе в формате FAT32, а файл базы данных уже 4GBytes, ограничение на количество файлов для FAT32.</p> | 
| <p>JET_errInstanceUnavailable</p> | <p>Невозможно выполнить операцию, поскольку экземпляр, связанный с сеансом, обнаружил неустранимую ошибку, которая требует, чтобы доступ ко всем данным был отозван для защиты целостности этих данных.</p><p><strong>Windows XP:</strong>  эта ошибка будет возвращена только Windows XP и более поздних выпусках.</p> | 
| <p>JET_errInvalidParameter</p> | <p>Данный параметр <em>подготовки</em> в функции <a href="gg269339(v=exchg.10).md">жетпрепареупдате</a> не является допустимым флагом.</p> | 
| <p>JET_errKeyDuplicate</p> | <p>Ключ индекса для этой записи является дубликатом другого ключа индекса для другой записи, уже наданнымся в таблице, и индекс не допускает дублирования.</p> | 
| <p>JET_errKeyTruncated</p> | <p>Вставленная или обновленная запись имеет один или несколько индексов, для которых созданный ключ превысил максимально допустимый размер. В результате операция не смогла предотвратить усечение ключа.</p> | 
| <p>JET_errMultiValuedIndexViolation</p> | <p>Вставленная или обновленная запись имеет индексируемый многозначный столбец с двумя или более значениями, идентичными в пределах ключа максимальной длины, установленного для индекса. В результате запись содержит две идентичные записи в индексе, что недопустимо.</p> | 
| <p>JET_errNotInitialized</p> | <p>Невозможно выполнить операцию, так как экземпляр, связанный с сеансом, еще не инициализирован.</p> | 
| <p>JET_errNullInvalid</p> | <p>Один или несколько столбцов вставляемой записи или в обновленном состоянии заменяемой записи имеют <strong>значение NULL</strong> , что нарушает определенное ограничение для этих столбцов.</p> | 
| <p>JET_errNullKeyDisallowed</p> | <p>Один или несколько индексов не позволяют разрешить ключ <strong>null</strong> , а вставленное или обновленное состояние заменяемой записи нарушает это заданное ограничение.</p> | 
| <p>JET_errRecordPrimaryChanged</p> | <p>Операция замены записи обновила первичный ключ. Обновления первичных ключевых столбцов должны выполняться путем удаления существующей записи и вставки новой записи с нужными данными.</p> | 
| <p>JET_errRestoreInProgress</p> | <p>Невозможно выполнить операцию, так как в экземпляре, связанном с сеансом, выполняется операция восстановления.</p> | 
| <p>JET_errSessionSharingViolation</p> | <p>Один и тот же сеанс нельзя использовать одновременно для нескольких потоков.</p><p><strong>Windows XP:</strong>  эта ошибка будет возвращена только Windows XP и более поздних выпусках.</p> | 
| <p>JET_errTermInProgress</p> | <p>Невозможно выполнить операцию, так как выполняется завершение работы экземпляра, связанного с сеансом.</p> | 
| <p>JET_errTransReadOnly</p> | <p>Попытка обновления недействительна в пределах транзакции, доступной только для чтения. Транзакция только для чтения — это транзакция, которая была запущена с помощью вызова <a href="gg269268(v=exchg.10).md">JetBeginTransaction2</a> с JET_bitTransactionReadOnly.</p><p><strong>Windows XP:</strong>  эта ошибка будет возвращена только Windows XP и более поздних выпусках.</p> | 
| <p>JET_errUpdateNotPrepared</p> | <p><a href="gg269339(v=exchg.10).md">Жетпрепареупдате</a> был вызван с JET_prepCancel, но курсор не был в подготовленном состоянии.</p> | 
| <p>JET_errVersionStoreOutOfMemory</p> | <p>Не удалось выполнить операцию, так как недостаточно памяти для удержания транзакционных сведений об обновлении.</p> | 
| <p>JET_errWriteConflict</p> | <p>Другой сеанс ранее заблокировал запись для обновления. Обновление, которое попыталось этот сеанс, завершится ошибкой.</p> | 



При успешном выполнении операция открытия обновления курсора завершается. Если для таблицы определен автоматически увеличивающийся столбец, то это значение устанавливается для вставленных записей. Если для таблицы определен столбец версии, то его значение инициализируется для вновь вставленных записей или увеличивается каждый раз при замене записи. Обновляются все индексы, включая кластеризованные и некластеризованные индексы.

В случае сбоя изменения какого либо типа не вносятся в базу данных. Перед вставкой и до замены функции обратного вызова могут быть вызваны, но после вызовов INSERT и After replace не будут вызываться, так как Последнее не может привести к сбою обновления. Буфер копирования курсора остается в подготовленном состоянии, чтобы можно было постепенно устранить проблемы, вызвавшие ошибки, и повторить операцию обновления.

#### <a name="remarks"></a>Комментарии

Функции обратного вызова могут быть зарегистрированы для вызова до или после инструкции INSERT, а также до или после обновления.

Ограничения размера записи применяются [жетсетколумн](./jetsetcolumn-function.md), а не в общем **жетупдате**.

Важно понимать влияние выполнения большого количества операций обновления в рамках одной транзакции. Каждое обновление базы данных должно быть отслеживанием ядра СУБД в хранилище версий. Хранилище версий содержит активную запись всех различных версий каждой записи или записи индекса в базе данных, которые могут быть видны всем активным транзакциям. Эти версии используются для поддержки управления параллелизмом с несколькими версиями, используемого ядром СУБД для поддержки транзакций с использованием изоляции моментальных снимков. После того, как ядро СУБД исчерпало ресурсы, используемые для хранения этих версий, оно больше не сможет принять дальнейшие изменения до тех пор, пока некоторые транзакции не разрешают высвободить эти ресурсы. Если обработчик находится в этом состоянии, все обновления будут завершаться с JET_errVersionStoreOutOfMemory. Ресурсы, доступные ядру СУБД для хранения этих версий, можно контролировать с помощью [жетсетсистемпараметер](./jetsetsystemparameter-function.md) с [JET_paramMaxVerPages](./resource-parameters.md) и [JET_paramGlobalMinVerPages](./resource-parameters.md).

#### <a name="requirements"></a>Требования


| | | <p><strong>Клиент</strong></p> | <p>требуется Windows Vista, Windows XP или Windows 2000 Professional.</p> | | <p><strong>Сервер</strong></p> | <p>требуется Windows server 2008, Windows server 2003 или сервер Windows 2000.</p> | | <p><strong>Header</strong></p> | <p>Объявлено в ESENT. h.</p> | | <p><strong>Библиотека</strong></p> | <p>Используйте ESENT. lib.</p> | | <p><strong>КОМПОНОВКИ</strong></p> | <p>Требуется ESENT.dll.</p> | 



#### <a name="see-also"></a>См. также:

[JET_ERR](./jet-err.md)  
[JET_SESID](./jet-sesid.md)  
[JET_TABLEID](./jet-tableid.md)  
[жетделете](./jetdelete-function.md)  
[жетпрепареупдате](./jetprepareupdate-function.md)  
[жетрегистеркаллбакк](./jetregistercallback-function.md)  
[жетретриевеколумн](./jetretrievecolumn-function.md)  
[жетретриевеколумнс](./jetretrievecolumns-function.md)  
[жетсетколумн](./jetsetcolumn-function.md)  
[жетсетколумнс](./jetsetcolumns-function.md)  
[жетсетсистемпараметер](./jetsetsystemparameter-function.md)  
[Системные параметры](./extensible-storage-engine-system-parameters.md)
