---
description: Дополнительные сведения о функции Жетбаккуп
title: Функция JetBackup
TOCTitle: JetBackup Function
ms:assetid: afff995f-378a-4e67-b522-d5eafcbad57e
ms:mtpsurl: https://msdn.microsoft.com/library/Gg294058(v=EXCHG.10)
ms:contentKeyID: 32765673
ms.date: 04/11/2016
ms.topic: reference
api_name:
- JetBackupA
- JetBackup
- JetBackupW
topic_type:
- apiref
- kbArticle
api_type:
- DLLExport
- COM
api_location:
- ESENT.DLL
ROBOTS: INDEX,FOLLOW
ms.openlocfilehash: e17ee5029da8ac71b5421e44a3647494e676ba71
ms.sourcegitcommit: 4665ebce0c106bdb52eef36e544280b496b6f50b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/26/2021
ms.locfileid: "122982997"
---
# <a name="jetbackup-function"></a>Функция JetBackup


_**Применимо к:** Windows | Windows Сервером_

## <a name="jetbackup-function"></a>Функция JetBackup

Функция **жетбаккуп** создает резервную копию базы данных, пока база данных находится в режиме «в сети». эта функция в основном используется для обеспечения обратной совместимости с Windows 2000 и более ранними ядрами субд, в которых разрешен только один экземпляр базы данных. В этом случае активный экземпляр — это экземпляр, для которого создается резервная копия.

```cpp
    JET_ERR JET_API JetBackup(
      __in          JET_PCSTR szBackupPath,
      __in          JET_GRBIT grbit,
      __in          JET_PFNSTATUS pfnStatus
    );
```

### <a name="parameters"></a>Параметры

*сзбаккуппас*

Каталог, в котором хранится резервная копия. Если путь резервного копирования равен NULL, функция усекает журналы, если это возможно.

*грбит*

Группа битов, задающая ноль или более следующих параметров.


| <p>Значение</p> | <p>Значение</p> | 
|--------------|----------------|
| <p>JET_bitBackupAtomic</p> | <p>Создает полную резервную копию базы данных. Это позволяет сохранять существующую резервную копию в том же каталоге в случае сбоя новой резервной копии.</p> | 
| <p>JET_bitBackupIncremental</p> | <p>Создает добавочное резервное копирование, а не полное резервное копирование. Это означает, что резервное копирование выполняется только для файлов журнала с момента последнего полного или добавочного резервного копирования.</p> | 



*пфнстатус*

Указатель на функцию обратного вызова [JET_PFNSTATUS](./jet-pfnstatus-callback-function.md) , которая предоставляет сведения о ходе выполнения операции резервного копирования.

### <a name="return-value"></a>Возвращаемое значение

Функция возвращает один из [JET_ERR](./jet-err.md) кодов ошибок. Чаще всего возвращаются следующие. (полный список ошибок для этого API см. в разделе [коды ошибок расширенного обработчика служба хранилища](./extensible-storage-engine-error-codes.md).)


| <p>Код возврата</p> | <p>Описание</p> | 
|--------------------|--------------------|
| <p>JET_errSuccess</p> | <p>Операция выполнена успешно.</p> | 
| <p>JET_errBackupInProgress</p> | <p>Для того же экземпляра уже выполняется резервное копирование. Одновременно не разрешено несколько резервных копий.</p> | 
| <p>JET_errBackupNotAllowedYet</p> | <p>Экземпляр еще не готов для резервного копирования при инициализации.</p> | 
| <p>JET_errClientRequestToStopJetService</p> | <p>Операция не может быть завершена, так как все действия в экземпляре, связанном с сеансом, были прекращены в результате вызова <a href="gg269240(v=exchg.10).md">жетстопсервице</a>.</p> | 
| <p>JET_errInstanceUnavailable</p> | <p>Операция не может быть завершена, поскольку экземпляр, связанный с сеансом, обнаружил неустранимую ошибку, которая требует, чтобы доступ ко всем данным был отозван для защиты целостности этих данных.</p><p><strong>Windows XP:</strong> это возвращаемое значение вводится в Windows XP.</p> | 
| <p>JET_errInvalidBackup</p> | <p>Добавочное резервное копирование не разрешено, если включено циклическое ведение журнала.</p> | 
| <p>JET_errInvalidGrbit</p> | <p>Указаны недопустимые параметры.</p> | 
| <p>JET_errInvalidParameter</p> | <p>В API передан недопустимый параметр.</p> | 
| <p>JET_errInvalidPath</p> | <p>Конечный путь не существует.</p> | 
| <p>JET_errLoggingDisabled</p> | <p>Экземпляр работает без ведения журнала. Резервное копирование запрещено.</p> | 
| <p>JET_errLogReadVerifyFailure</p> | <p>Ошибка проверки контрольной суммы файла журнала.</p> | 
| <p>JET_errLogWriteFail</p> | <p>Ведение журнала для экземпляра является временным или постоянно отключено из-за непредвиденной ошибки.</p> | 
| <p>JET_errNotInitialized</p> | <p>Операция не может быть завершена, так как экземпляр, связанный с сеансом, еще не инициализирован.</p> | 
| <p>JET_errReadVerifyFailure</p> | <p>Ошибка проверки контрольной суммы на странице базы данных.</p> | 
| <p>JET_errRestoreInProgress</p> | <p>Операция не может быть завершена, так как выполняется операция восстановления для экземпляра, связанного с сеансом.</p> | 
| <p>JET_errSessionSharingViolation</p> | <p>Один и тот же сеанс нельзя использовать одновременно для нескольких потоков.</p><p><strong>Windows XP:</strong> это возвращаемое значение вводится в Windows XP.</p> | 
| <p>JET_errTermInProgress</p> | <p>Операция не может быть завершена, так как экземпляр, связанный с сеансом, завершает работу.</p> | 



Если функция выполнена, все файлы, необходимые для восстановления до момента резервного копирования, будут находиться в каталоге резервного копирования. Если это полная резервная копия, то файлы будут файлами базы данных и журналами, необходимыми для перевода базы данных в целостное состояние. Если это добавочное резервное копирование, в каталоги будут добавляться только файлы журналов, но уже существующие файлы (базы данных и файлы журналов) вместе с новыми файлами журналов будут восстановлены, чтобы вернуть базу данных в состояние, в котором она находилась в момент начала резервного копирования.

В качестве побочного результата резервного копирования файлы журнала, которые больше не нужны, будут обрезаны.

В то же время заголовки базы данных будут обновлены с учетом информации, которая была выполнена при последней архивации.

В случае сбоя функции в месте назначения каталога резервного копирования не будет файлов, поэтому восстановление будет невозможно. В то же время текущие файлы журнала не будут обрезаны.

#### <a name="remarks"></a>Комментарии

На различных шагах резервного копирования будут созданы записи журнала событий, включая имена файлов, усечение журнала и окончательный результат резервного копирования.

Добавочное резервное копирование возможно только после создания полной резервной копии. Кроме того, добавочное резервное копирование возможно только в том случае, если циклическое ведение журнала отключено. Рекомендуется, чтобы каталог резервного копирования не содержал никаких файлов, кроме тех, которые использовались в резервной копии или были добавлены при предыдущей успешной архивации.

Каталог резервного копирования должен существовать, если для экземпляра не задан параметр *JET_paramCreatePathIfNotExist* . Дополнительные сведения см. в разделе [системные параметры](./extensible-storage-engine-system-parameters.md).

резервная копия будет выполнять проверку контрольной суммы на всех используемых страницах базы данных и начиная с Windows Server 2003 и в файлах журнала. Это дает возможность оценить работоспособность базы данных даже для страниц, которые не считываются во время нормальной работы. Если такое повреждение будет обнаружено, произойдет сбой резервного копирования.

Во время резервного копирования текущий файл журнала будет завершен, и будет создан новый журнал. Таким образом, все необходимые файлы журнала могут быть скопированы, так как текущий журнал больше не будет использоваться.

Настоятельно рекомендуется не использовать резервную копию ни для каких целей, кроме резервного копирования и восстановления на уровне ядра. Это снизит вероятность получения ошибок во время операций резервного копирования и восстановления.

#### <a name="requirements"></a>Требования


| Требование | Применение |
|------------|----------|
| <p><strong>Клиент</strong></p> | <p>требуется Windows Vista, Windows XP или Windows 2000 Professional.</p> | 
| <p><strong>Server</strong></p> | <p>требуется Windows server 2008, Windows server 2003 или сервер Windows 2000.</p> | 
| <p><strong>Header</strong></p> | <p>Объявлено в ESENT. h.</p> | 
| <p><strong>Библиотека</strong></p> | <p>Используйте ESENT. lib.</p> | 
| <p><strong>КОМПОНОВКИ</strong></p> | <p>Требуется ESENT.dll.</p> | 
| <p><strong>Юникод</strong></p> | <p>Реализуется как <strong>жетбаккупв</strong> (Юникод) и <strong>жетбаккупа</strong> (ANSI).</p> | 



#### <a name="see-also"></a>См. также:

[расширяемые файлы служба хранилища Engine](./extensible-storage-engine-files.md)  
[JET_ERR](./jet-err.md)  
[JET_GRBIT](./jet-grbit.md)  
[JET_INSTANCE](./jet-instance.md)  
[JET_PFNSTATUS](./jet-pfnstatus-callback-function.md)  
[жетресторе](./jetrestore-function.md)  
[JetRestore2](./jetrestore2-function.md)  
[жетрестореинстанце](./jetrestoreinstance-function.md)  
[жетстопсервице](./jetstopservice-function.md)  
[Системные параметры](./extensible-storage-engine-system-parameters.md)
