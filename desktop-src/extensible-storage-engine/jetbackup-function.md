---
description: Дополнительные сведения о функции Жетбаккуп
title: Функция JetBackup
TOCTitle: JetBackup Function
ms:assetid: afff995f-378a-4e67-b522-d5eafcbad57e
ms:mtpsurl: https://msdn.microsoft.com/library/Gg294058(v=EXCHG.10)
ms:contentKeyID: 32765673
ms.date: 04/11/2016
ms.topic: reference
api_name:
- JetBackupA
- JetBackup
- JetBackupW
topic_type:
- apiref
- kbArticle
api_type:
- DLLExport
- COM
api_location:
- ESENT.DLL
ROBOTS: INDEX,FOLLOW
ms.openlocfilehash: f225053df36ebe98bc890a8e036d84ee31b6b154
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105713075"
---
# <a name="jetbackup-function"></a>Функция JetBackup


_**Применимо к:** Windows | Windows Server_

## <a name="jetbackup-function"></a>Функция JetBackup

Функция **жетбаккуп** создает резервную копию базы данных, пока база данных находится в режиме «в сети». Эта функция предназначена в первую очередь для обеспечения обратной совместимости с Windows 2000 и более ранними ядрами СУБД, в которых разрешен только один экземпляр базы данных. В этом случае активный экземпляр — это экземпляр, для которого создается резервная копия.

```cpp
    JET_ERR JET_API JetBackup(
      __in          JET_PCSTR szBackupPath,
      __in          JET_GRBIT grbit,
      __in          JET_PFNSTATUS pfnStatus
    );
```

### <a name="parameters"></a>Параметры

*сзбаккуппас*

Каталог, в котором хранится резервная копия. Если путь резервного копирования равен NULL, функция усекает журналы, если это возможно.

*грбит*

Группа битов, задающая ноль или более следующих параметров.

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Значение</p></th>
<th><p>Значение</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>JET_bitBackupAtomic</p></td>
<td><p>Создает полную резервную копию базы данных. Это позволяет сохранять существующую резервную копию в том же каталоге в случае сбоя новой резервной копии.</p></td>
</tr>
<tr class="even">
<td><p>JET_bitBackupIncremental</p></td>
<td><p>Создает добавочное резервное копирование, а не полное резервное копирование. Это означает, что резервное копирование выполняется только для файлов журнала с момента последнего полного или добавочного резервного копирования.</p></td>
</tr>
</tbody>
</table>


*пфнстатус*

Указатель на функцию обратного вызова [JET_PFNSTATUS](./jet-pfnstatus-callback-function.md) , которая предоставляет сведения о ходе выполнения операции резервного копирования.

### <a name="return-value"></a>Возвращаемое значение

Функция возвращает один из [JET_ERR](./jet-err.md) кодов ошибок. Чаще всего возвращаются следующие. (Полный список ошибок для этого API см. в разделе [расширенные коды ошибок подсистемы хранилища](./extensible-storage-engine-error-codes.md).)

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Код возврата</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>JET_errSuccess</p></td>
<td><p>Операция выполнена успешно.</p></td>
</tr>
<tr class="even">
<td><p>JET_errBackupInProgress</p></td>
<td><p>Для того же экземпляра уже выполняется резервное копирование. Одновременно не разрешено несколько резервных копий.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errBackupNotAllowedYet</p></td>
<td><p>Экземпляр еще не готов для резервного копирования при инициализации.</p></td>
</tr>
<tr class="even">
<td><p>JET_errClientRequestToStopJetService</p></td>
<td><p>Операция не может быть завершена, так как все действия в экземпляре, связанном с сеансом, были прекращены в результате вызова <a href="gg269240(v=exchg.10).md">жетстопсервице</a>.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errInstanceUnavailable</p></td>
<td><p>Операция не может быть завершена, поскольку экземпляр, связанный с сеансом, обнаружил неустранимую ошибку, которая требует, чтобы доступ ко всем данным был отозван для защиты целостности этих данных.</p>
<p><strong>Windows XP:  </strong> Это возвращаемое значение введено в Windows XP.</p></td>
</tr>
<tr class="even">
<td><p>JET_errInvalidBackup</p></td>
<td><p>Добавочное резервное копирование не разрешено, если включено циклическое ведение журнала.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errInvalidGrbit</p></td>
<td><p>Указаны недопустимые параметры.</p></td>
</tr>
<tr class="even">
<td><p>JET_errInvalidParameter</p></td>
<td><p>В API передан недопустимый параметр.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errInvalidPath</p></td>
<td><p>Конечный путь не существует.</p></td>
</tr>
<tr class="even">
<td><p>JET_errLoggingDisabled</p></td>
<td><p>Экземпляр работает без ведения журнала. Резервное копирование запрещено.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errLogReadVerifyFailure</p></td>
<td><p>Ошибка проверки контрольной суммы файла журнала.</p></td>
</tr>
<tr class="even">
<td><p>JET_errLogWriteFail</p></td>
<td><p>Ведение журнала для экземпляра является временным или постоянно отключено из-за непредвиденной ошибки.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errNotInitialized</p></td>
<td><p>Операция не может быть завершена, так как экземпляр, связанный с сеансом, еще не инициализирован.</p></td>
</tr>
<tr class="even">
<td><p>JET_errReadVerifyFailure</p></td>
<td><p>Ошибка проверки контрольной суммы на странице базы данных.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errRestoreInProgress</p></td>
<td><p>Операция не может быть завершена, так как выполняется операция восстановления для экземпляра, связанного с сеансом.</p></td>
</tr>
<tr class="even">
<td><p>JET_errSessionSharingViolation</p></td>
<td><p>Один и тот же сеанс нельзя использовать одновременно для нескольких потоков.</p>
<p><strong>Windows XP:  </strong> Это возвращаемое значение введено в Windows XP.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errTermInProgress</p></td>
<td><p>Операция не может быть завершена, так как экземпляр, связанный с сеансом, завершает работу.</p></td>
</tr>
</tbody>
</table>


Если функция выполнена, все файлы, необходимые для восстановления до момента резервного копирования, будут находиться в каталоге резервного копирования. Если это полная резервная копия, то файлы будут файлами базы данных и журналами, необходимыми для перевода базы данных в целостное состояние. Если это добавочное резервное копирование, в каталоги будут добавляться только файлы журналов, но уже существующие файлы (базы данных и файлы журналов) вместе с новыми файлами журналов будут восстановлены, чтобы вернуть базу данных в состояние, в котором она находилась в момент начала резервного копирования.

В качестве побочного результата резервного копирования файлы журнала, которые больше не нужны, будут обрезаны.

В то же время заголовки базы данных будут обновлены с учетом информации, которая была выполнена при последней архивации.

В случае сбоя функции в месте назначения каталога резервного копирования не будет файлов, поэтому восстановление будет невозможно. В то же время текущие файлы журнала не будут обрезаны.

#### <a name="remarks"></a>Комментарии

На различных шагах резервного копирования будут созданы записи журнала событий, включая имена файлов, усечение журнала и окончательный результат резервного копирования.

Добавочное резервное копирование возможно только после создания полной резервной копии. Кроме того, добавочное резервное копирование возможно только в том случае, если циклическое ведение журнала отключено. Рекомендуется, чтобы каталог резервного копирования не содержал никаких файлов, кроме тех, которые использовались в резервной копии или были добавлены при предыдущей успешной архивации.

Каталог резервного копирования должен существовать, если для экземпляра не задан параметр *JET_paramCreatePathIfNotExist* . Дополнительные сведения см. в разделе [системные параметры](./extensible-storage-engine-system-parameters.md).

Резервная копия выполнит проверку контрольной суммы на всех используемых страницах базы данных и начиная с Windows Server 2003, а также с файлами журналов. Это дает возможность оценить работоспособность базы данных даже для страниц, которые не считываются во время нормальной работы. Если такое повреждение будет обнаружено, произойдет сбой резервного копирования.

Во время резервного копирования текущий файл журнала будет завершен, и будет создан новый журнал. Таким образом, все необходимые файлы журнала могут быть скопированы, так как текущий журнал больше не будет использоваться.

Настоятельно рекомендуется не использовать резервную копию ни для каких целей, кроме резервного копирования и восстановления на уровне ядра. Это снизит вероятность получения ошибок во время операций резервного копирования и восстановления.

#### <a name="requirements"></a>Требования

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td><p><strong>Клиент</strong></p></td>
<td><p>Требуется Windows Vista, Windows XP или Windows 2000 Professional.</p></td>
</tr>
<tr class="even">
<td><p><strong>Server</strong></p></td>
<td><p>Требуется Windows Server 2008, Windows Server 2003 или Windows 2000 Server.</p></td>
</tr>
<tr class="odd">
<td><p><strong>Header</strong></p></td>
<td><p>Объявлено в ESENT. h.</p></td>
</tr>
<tr class="even">
<td><p><strong>Библиотека</strong></p></td>
<td><p>Используйте ESENT. lib.</p></td>
</tr>
<tr class="odd">
<td><p><strong>КОМПОНОВКИ</strong></p></td>
<td><p>Требуется ESENT.dll.</p></td>
</tr>
<tr class="even">
<td><p><strong>Юникод</strong></p></td>
<td><p>Реализуется как <strong>жетбаккупв</strong> (Юникод) и <strong>жетбаккупа</strong> (ANSI).</p></td>
</tr>
</tbody>
</table>


#### <a name="see-also"></a>См. также:

[Расширяемые файлы подсистемы хранилища](./extensible-storage-engine-files.md)  
[JET_ERR](./jet-err.md)  
[JET_GRBIT](./jet-grbit.md)  
[JET_INSTANCE](./jet-instance.md)  
[JET_PFNSTATUS](./jet-pfnstatus-callback-function.md)  
[жетресторе](./jetrestore-function.md)  
[JetRestore2](./jetrestore2-function.md)  
[жетрестореинстанце](./jetrestoreinstance-function.md)  
[жетстопсервице](./jetstopservice-function.md)  
[Системные параметры](./extensible-storage-engine-system-parameters.md)
