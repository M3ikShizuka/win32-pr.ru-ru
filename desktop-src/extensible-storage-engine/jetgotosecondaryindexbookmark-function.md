---
description: Дополнительные сведения о функции Жетготосекондариндексбукмарк
title: Функция Жетготосекондариндексбукмарк
TOCTitle: JetGotoSecondaryIndexBookmark Function
ms:assetid: 06983b1e-503a-469b-9be5-b37e7551de67
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269180(v=EXCHG.10)
ms:contentKeyID: 32765483
ms.date: 04/11/2016
ms.topic: reference
api_name:
- JetGotoSecondaryIndexBookmark
topic_type:
- apiref
- kbArticle
api_type:
- DLLExport
- COM
api_location:
- ESENT.DLL
ROBOTS: INDEX,FOLLOW
ms.openlocfilehash: ca8b05c0eeac88521d03b95a94f7d2363d5746e9
ms.sourcegitcommit: 9b5faa61c38b2d0c432b7f2dbee8c127b0e28a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2021
ms.locfileid: "122468951"
---
# <a name="jetgotosecondaryindexbookmark-function"></a>Функция Жетготосекондариндексбукмарк


_**Применимо к:** Windows | Windows Сервером_

## <a name="jetgotosecondaryindexbookmark-function"></a>Функция Жетготосекондариндексбукмарк

Функция **жетготосекондариндексбукмарк** устанавливает курсор на запись индекса, связанную с закладкой вторичного индекса. Закладку вторичного индекса необходимо использовать с тем же индексом для той же таблицы, из которой она была первоначально извлечена. Закладку вторичного индекса для записи индекса можно получить с помощью **жетготосекондариндексбукмарк**.

**Windows xp:****жетготосекондариндексбукмарк** появился в Windows XP.  

```cpp
    JET_ERR JET_API JetGotoSecondaryIndexBookmark(
      __in          JET_SESID sesid,
      __in          JET_TABLEID tableid,
      __in          void* pvSecondaryKey,
      __in          unsigned long cbSecondaryKey,
      __in_opt      void* pvPrimaryBookmark,
      __in          unsigned long cbPrimaryBookmark,
      __in          const JET_GRBIT grbit
    );
```

### <a name="parameters"></a>Параметры

*сесид*

Сеанс, используемый для этого вызова.

*TableID*

Курсор, используемый для этого вызова.

*пвсекондарикэй*

Буфер, содержащий вторичный ключ, используемый для позиционирования курсора.

*кбсекондарикэй*

Размер вторичного ключа в буфере.

*пвпримарибукмарк*

Буфер, содержащий закладку первичного ключа, используемую для позиционирования курсора.

*кбпримарибукмарк*

Размер закладки первичного ключа в буфере.

*грбит*

Группа битов, которая задает ноль или более следующих параметров.


| <p>Значение</p> | <p>Значение</p> | 
|--------------|----------------|
| <p>JET_bitBookmarkPermitVirtualCurrency</p> | <p>В случае, если запись индекса больше не может быть найдена, курсор будет расположен слева, где была найдена Эта запись индекса. Операция по-прежнему завершится ошибкой с JET_errRecordDeleted; Тем не менее, можно перейти к следующей или предыдущей записи индекса относительно записи индекса, которая сейчас отсутствует.</p> | 



### <a name="return-value"></a>Возвращаемое значение

Эта функция возвращает [JET_ERR](./jet-err.md) DataType с одним из следующих кодов возврата. дополнительные сведения о возможных ошибках подсистемы ESE см. в разделе [ошибки расширенных служба хранилища Engine](./extensible-storage-engine-errors.md) и [параметры обработки ошибок](./error-handling-parameters.md).


| <p>Код возврата</p> | <p>Описание</p> | 
|--------------------|--------------------|
| <p>JET_errSuccess</p> | <p>Операция выполнена успешно.</p> | 
| <p>JET_errClientRequestToStopJetService</p> | <p>Операция не может быть завершена, так как все действия в экземпляре, связанном с сеансом, были прекращены в результате вызова <a href="gg269240(v=exchg.10).md">жетстопсервице</a>.</p> | 
| <p>JET_errInstanceUnavailable</p> | <p>Операция не может быть завершена, так как в экземпляре, связанном с сеансом, произошла неустранимая ошибка, которая требует, чтобы доступ ко всем данным был отозван для защиты целостности этих данных.</p><p><strong>Windows XP:</strong>  это возвращаемое значение вводится в Windows XP.</p> | 
| <p>JET_errInvalidBookmark</p> | <p>Указана недопустимая закладка вторичного индекса. Эта ошибка могла произойти из-за того, что вторичный ключ равен нулю или указатель буфера вторичного ключа имеет <strong>значение NULL</strong>. Эта ошибка возникает из-за того, что</p><ul><li><p>Текущий вторичный индекс не имеет ограничения уникальности, а размер указанной закладки равен нулю.</p></li><li><p>Указатель буфера закладки имеет <strong>значение NULL</strong>.</p></li></ul> | 
| <p>JET_errNoCurrentIndex</p> | <p>Курсор в данный момент не находится во вторичном индексе. Не имеет смысла переходить к закладке вторичного индекса, если в данный момент курсор не использует вторичный индекс. <a href="gg294053(v=exchg.10).md">Жетготобукмарк</a> следует использовать, если курсор не находится на вторичном индексе.</p> | 
| <p>JET_errNotInitialized</p> | <p>Операция не может быть завершена, так как экземпляр, связанный с сеансом, еще не инициализирован.</p> | 
| <p>JET_errRecordDeleted</p> | <p>Не удалось найти запись индекса, связанную с закладкой вторичного индекса.</p> | 
| <p>JET_errRestoreInProgress</p> | <p>Операция не может быть завершена, так как выполняется операция восстановления на экземпляре, связанном с сеансом.</p> | 
| <p>JET_errSessionSharingViolation</p> | <p>Один и тот же сеанс нельзя использовать одновременно для нескольких потоков.</p><p><strong>Windows XP:</strong>  это возвращаемое значение вводится в Windows XP.</p> | 
| <p>JET_errTermInProgress</p> | <p>Не удается выполнить операцию, так как выполняется завершение работы экземпляра, связанного с сеансом.</p> | 



Если эта функция выполнена, курсор будет размещен в записи индекса, связанной с закладкой дополнительного индекса. Если запись подготовлена к обновлению, это обновление будет отменено. Если действует диапазон индексов, то диапазон индексов будет отменен. Если для использования курсора был создан ключ поиска, этот ключ поиска будет удален. Изменение состояния базы данных не выполняется.

Если эта функция завершается ошибкой, то позицию курсора остается неизменной, если не будет возвращен JET_errRecordDeleted и не будет указан JET_bitBookmarkPermitVirtualCurrency. В этом случае курсор будет размещен в том месте, где была бы запись индекса, связанная с заданной закладкой вторичного индекса. Курсор можно переместить относительно этой позиции, но по-прежнему не находится в допустимой записи индекса.

Если запись подготовлена к обновлению, это обновление будет отменено. Если действует диапазон индексов, то диапазон индексов будет отменен. Если для использования курсора был создан ключ поиска, этот ключ поиска будет удален. В любом случае изменение состояния базы данных не выполняется.

#### <a name="requirements"></a>Требования


| | | <p><strong>Клиент</strong></p> | <p>требуется Windows Vista или Windows XP.</p> | | <p><strong>Сервер</strong></p> | <p>требуется Windows server 2008 или Windows server 2003.</p> | | <p><strong>Header</strong></p> | <p>Объявлено в ESENT. h.</p> | | <p><strong>Библиотека</strong></p> | <p>Используйте ESENT. lib.</p> | | <p><strong>КОМПОНОВКИ</strong></p> | <p>Требуется ESENT.dll.</p> | 



#### <a name="see-also"></a>См. также:

[JET_ERR](./jet-err.md)  
[JET_GRBIT](./jet-grbit.md)  
[JET_SESID](./jet-sesid.md)  
[JET_TABLEID](./jet-tableid.md)  
[жетжетсекондариндексбукмарк](./jetgetsecondaryindexbookmark-function.md)  
[жетготобукмарк](./jetgotobookmark-function.md)  
[жетстопсервице](./jetstopservice-function.md)
