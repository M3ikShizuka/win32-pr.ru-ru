---
description: Дополнительные сведения о функции JetSetCurrentIndex2
title: Функция JetSetCurrentIndex2
TOCTitle: JetSetCurrentIndex2 Function
ms:assetid: da94465e-bd35-45c2-9ccc-1d2e8c34aa9a
ms:mtpsurl: https://msdn.microsoft.com/library/Gg294110(v=EXCHG.10)
ms:contentKeyID: 32765725
ms.date: 04/11/2016
ms.topic: reference
api_name:
- JetSetCurrentIndex2W
- JetSetCurrentIndex2A
- JetSetCurrentIndex2
topic_type:
- apiref
- kbArticle
api_type:
- COM
- DLLExport
api_location:
- ESENT.DLL
ROBOTS: INDEX,FOLLOW
ms.openlocfilehash: 814813e90446161942775e5c1a26611ed834886f
ms.sourcegitcommit: 9b5faa61c38b2d0c432b7f2dbee8c127b0e28a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2021
ms.locfileid: "122472490"
---
# <a name="jetsetcurrentindex2-function"></a>Функция JetSetCurrentIndex2


_**Применимо к:** Windows | Windows Сервером_

## <a name="jetsetcurrentindex2-function"></a>Функция JetSetCurrentIndex2

Функция **JetSetCurrentIndex2** задает текущий индекс курсора, который определяет, какие записи в таблице видимы для данного курсора, и порядок, в котором они отображаются, выбрав набор записей индекса, который будет использоваться для предоставления этих записей.

```cpp
    JET_ERR JET_API JetSetCurrentIndex2(
      __in          JET_SESID sesid,
      __in          JET_TABLEID tableid,
      __in_opt      JET_PCSTR szIndexName,
      __in          JET_GRBIT grbit
    );
```

### <a name="parameters"></a>Параметры

*сесид*

Сеанс, используемый для этого вызова.

*TableID*

Курсор, используемый для этого вызова.

*сзиндекснаме*

Имя индекса, выбранного для курсора.

Если этот параметр имеет значение NULL или является пустой строкой, выбирается кластеризованный индекс. Если для таблицы определен первичный индекс, то этот индекс будет выбран, так как он совпадает с кластеризованным индексом. Если для таблицы не определен первичный индекс, будет выбран последовательный индекс. Последовательный индекс не имеет определения индекса. Дополнительные сведения см. в разделе [жеткреатеиндекс](./jetcreateindex-function.md) .

Если *pIndexID* не равно null, имя индекса будет игнорироваться, а индекс будет выбран по идентификатору индекса.

*грбит*

Группа битов, содержащая параметры, которые должны использоваться для этого вызова, включая ноль или более следующих значений.


| <p>Значение</p> | <p>Значение</p> | 
|--------------|----------------|
| <p>JET_bitMoveFirst</p> | <p>Этот параметр указывает, что курсор должен располагаться на первой записи указанного индекса. Если выбран кластеризованный индекс (первичный индекс или последовательный индекс), а текущий индекс является вторичным индексом, то JET_bitMoveFirst предполагается. Если текущий индекс выбран, этот параметр игнорируется и изменение положения курсора не выполняется.</p> | 
| <p>JET_bitNoMove</p> | <p>Этот параметр указывает, что курсор должен располагаться на записи индекса нового индекса, который соответствует записи, связанной с записью индекса, в текущей позиции курсора по старому индексу.</p><p>Если определение нового индекса содержит по крайней мере один ключевой столбец с несколькими значениями, то запись конечного индекса неоднозначно. В этом случае заданный <em>итагсекуенце</em> используется для выбора многозначного многозначного ключевого столбца, используемого для позиционирования курсора. Необходимо только передать один <em>итагсекуенце</em> даже в случае нескольких ключевых столбцов с несколькими значениями, так как ядро расширяет только все значения для наиболее значимого многозначного ключевого столбца. Дополнительные сведения см. в разделе <a href="gg294099(v=exchg.10).md">жеткреатеиндекс</a> .</p><p>Если указан JET_bitMoveFirst, этот параметр игнорируется.</p><p>Если текущий индекс выбран, этот параметр игнорируется и изменение положения курсора не выполняется. Если этот параметр отсутствует, предполагается, что его значение JET_bitMoveFirst.</p> | 



### <a name="return-value"></a>Возвращаемое значение

Эта функция возвращает [JET_ERR](./jet-err.md) DataType с одним из следующих кодов возврата. дополнительные сведения о возможных ошибках подсистемы ESE см. в разделе [ошибки расширенных служба хранилища Engine](./extensible-storage-engine-errors.md) и [параметры обработки ошибок](./error-handling-parameters.md).


| <p>Код возврата</p> | <p>Описание</p> | 
|--------------------|--------------------|
| <p>JET_errSuccess</p> | <p>Операция выполнена успешно.</p> | 
| <p>JET_errBadItagSequence</p> | <p>Вторичный индекс выбирается с параметром JET_bitNoMove и для первого многозначного ключевого столбца в новом определении индекса, соответствующего указанному порядковому номеру, отсутствует значение.</p> | 
| <p>JET_errClientRequestToStopJetService</p> | <p>Невозможно выполнить операцию, так как все действия в экземпляре, связанном с сеансом, были прекращены в результате вызова <a href="gg269240(v=exchg.10).md">жетстопсервице</a>.</p> | 
| <p>JET_errInstanceUnavailable</p> | <p>Невозможно выполнить операцию, поскольку экземпляр, связанный с сеансом, обнаружил неустранимую ошибку, которая требует, чтобы доступ ко всем данным был отозван для защиты целостности этих данных.</p><p>эта ошибка будет возвращена только Windows XP и более поздних выпусках.</p> | 
| <p>JET_errInvalidIndexId</p> | <p>Содержимое идентификатора индекса недопустимо или устарело, и его необходимо обновить. Это может произойти для <strong>JetSetCurrentIndex2</strong> в следующих случаях:</p><ul><li><p>pindexid- &gt; кбструкт не имеет ожидаемого размера (Windows Server 2003 и более поздних версий).</p></li><li><p>Работа обработчика была завершена, так как был получен идентификатор индекса.</p></li><li><p>Все курсоры, ссылающиеся на таблицу, содержащую индекс, соответствующий ИДЕНТИФИКАТОРу индекса, были закрыты и подсистема удалила определение индекса из кэша схемы.</p></li><li><p>Идентификатор индекса используется с курсором, открытым в неверной таблице.</p></li><li><p>Индекс был удален или еще не виден в сеансе.</p></li></ul> | 
| <p>JET_errInvalidName</p> | <p>Одно из указанных имен объектов недопустимо. Все имена объектов должны соответствовать одному и тому же набору правил. Ниже приведены эти правила.</p><ul><li><p>Имена объектов должны состоять из символов ASCII.</p></li><li><p>Имена объектов должны иметь длину по крайней мере один символ.</p></li><li><p>Длина имен объектов не может превышать JET_cbNameMost (64) символов.</p></li><li><p>Имена объектов не могут начинаться с пробела.</p></li><li><p>Имена объектов не могут содержать управляющие символы ASCII (0x00 – 0x1F).</p></li><li><p>Имена объектов не могут содержать восклицательный знак (!), точку (.), открывающую квадратную скобку ([) или правую квадратную скобку (]).</p></li><li><p>После проверки для имени объекта будет использоваться только часть строки вплоть до первого пробела (если таковая имеется). Это фактически означает, что имена объектов не могут содержать пробелы.</p></li></ul> | 
| <p>JET_errInvalidParameter</p> | <p>Один из указанных параметров содержит непредвиденное значение или содержит значение, которое не имеет смысла при объединении со значением другого параметра. это может произойти для <strong>JetSetCurrentIndex2</strong> , когда <em>pindexid</em> не равен NULL, а pindexid- &gt; кбструкт не имеет ожидаемого размера (Windows XP и более ранних выпусков).</p> | 
| <p>JET_errNoCurrentRecord</p> | <p>Вторичный индекс выбирается с параметром JET_bitNoMove и в новом индексе отсутствует запись индекса, соответствующая записи, связанной с записью индекса, в текущей позиции курсора по старому индексу.</p> | 
| <p>JET_errNotInitialized</p> | <p>Невозможно выполнить операцию, так как экземпляр, связанный с сеансом, еще не инициализирован.</p> | 
| <p>JET_errOutOfCursors</p> | <p>Подсистема исчерпала пул ресурсов, используемых для открытия курсоров. С помощью <a href="gg269201(v=exchg.10).md">JET_paramMaxCursors</a>можно управлять максимальным количеством курсоров, которые могут быть открыты в любой момент времени. Дополнительные сведения см. в разделе <a href="gg294044(v=exchg.10).md">жетсетсистемпараметер</a> . Это может произойти для <strong>JetSetCurrentIndex2</strong> , когда был выбран вторичный индекс, и обработчик не может открыть внутренний курсор для использования этого индекса.</p> | 
| <p>JET_errRestoreInProgress</p> | <p>Невозможно выполнить операцию, так как в экземпляре, связанном с сеансом, выполняется операция восстановления.</p> | 
| <p>JET_errSessionSharingViolation</p> | <p>Один и тот же сеанс нельзя использовать одновременно для нескольких потоков.</p><p>эта ошибка будет возвращена только Windows XP и более поздних выпусках.</p> | 
| <p>JET_errTermInProgress</p> | <p>Невозможно выполнить операцию, так как выполняется завершение работы экземпляра, связанного с сеансом.</p> | 



При успешном выполнении текущий индекс курсора задается равным запрошенному индексу. Теперь элементы индекса можно искать с помощью [жетсик](./jetseek-function.md) в соответствии с определением индекса запрошенного индекса. Элементы индекса можно также перечислить с помощью [жетмове](./jetmove-function.md) в порядке, указанном в определении индекса. Текущая позиция курсора либо установлена на первый элемент индекса (JET_bitMoveFirst), либо на конкретную запись индекса, связанную с текущей позицией курсора по старому индексу (JET_bitNoMove). Изменение состояния базы данных не выполняется.

В случае сбоя текущий индекс и текущая позиция курсора находятся в неопределенном состоянии. Изменение состояния базы данных не выполняется.

#### <a name="remarks"></a>Комментарии

Если указание идентификатора индекса устарело, то API просто завершается ошибкой. В данном случае откат к текстовому имени индекса отсутствует, как можно было бы ожидать. Эта резервная копия должна выполняться вручную вызывающим объектом API.

#### <a name="requirements"></a>Требования


| | | <p><strong>Клиент</strong></p> | <p>требуется Windows Vista, Windows XP или Windows 2000 Professional.</p> | | <p><strong>Сервер</strong></p> | <p>требуется Windows server 2008, Windows server 2003 или сервер Windows 2000.</p> | | <p><strong>Header</strong></p> | <p>Объявлено в ESENT. h.</p> | | <p><strong>Библиотека</strong></p> | <p>Используйте ESENT. lib.</p> | | <p><strong>КОМПОНОВКИ</strong></p> | <p>Требуется ESENT.dll.</p> | | <p><strong>Юникод</strong></p> | <p>Реализуется как <strong>JetSetCurrentIndex2W</strong> (Юникод) и <strong>JetSetCurrentIndex2A</strong> (ANSI).</p> | 



#### <a name="see-also"></a>См. также:

[JET_ERR](./jet-err.md)  
[JET_GRBIT](./jet-grbit.md)  
[JET_SESID](./jet-sesid.md)  
[JET_TABLEID](./jet-tableid.md)  
[JET_INDEXID](./jet-indexid-structure.md)  
[жеткреатеиндекс](./jetcreateindex-function.md)  
[жетжеткуррентиндекс](./jetgetcurrentindex-function.md)  
[жетжетиндексинфо](./jetgetindexinfo-function.md)  
[жетжеттаблеиндексинфо](./jetgettableindexinfo-function.md)  
[жетмове](./jetmove-function.md)  
[жетсетсистемпараметер](./jetsetsystemparameter-function.md)  
[жетсик](./jetseek-function.md)  
[жетстопсервице](./jetstopservice-function.md)
