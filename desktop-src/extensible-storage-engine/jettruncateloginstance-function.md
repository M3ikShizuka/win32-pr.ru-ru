---
description: Дополнительные сведения о функции Жеттрункателогинстанце
title: Функция Жеттрункателогинстанце
TOCTitle: JetTruncateLogInstance Function
ms:assetid: 9b6852c6-a991-4d7b-bc54-49092f788751
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269352(v=EXCHG.10)
ms:contentKeyID: 32765639
ms.date: 04/11/2016
ms.topic: reference
api_name:
- JetTruncateLogInstance
topic_type:
- apiref
- kbArticle
api_type:
- COM
- DLLExport
api_location:
- ESENT.DLL
ROBOTS: INDEX,FOLLOW
ms.openlocfilehash: 4fdf8f7c47baab70426ddf03cdbc666a13c08f3d
ms.sourcegitcommit: 9b5faa61c38b2d0c432b7f2dbee8c127b0e28a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2021
ms.locfileid: "122477860"
---
# <a name="jettruncateloginstance-function"></a>Функция Жеттрункателогинстанце


_**Применимо к:** Windows | Windows Сервером_

## <a name="jettruncateloginstance-function"></a>Функция Жеттрункателогинстанце

Функция **жеттрункателогинстанце** используется во время резервного копирования, инициированного [жетбегинекстерналбаккуп](./jetbeginexternalbackup-function.md) , чтобы удалить все файлы журнала транзакций, которые больше не понадобятся после успешного завершения текущей резервной копии.

**Windows xp:****жеттрункателогинстанце** появился в Windows XP.  

```cpp
    JET_ERR JET_API JetTruncateLogInstance(
      __in          JET_INSTANCE instance
    );
```

### <a name="parameters"></a>Параметры

*вхождение*

Экземпляр, используемый для этого вызова.

для Windows 2000, вариант API, который принимает этот параметр, недоступен, так как поддерживается только один экземпляр. В этом случае подразумевается использование этого одного глобального экземпляра.

для Windows XP и более поздних выпусков вариант API, который не принимает этот параметр, может вызываться только в том случае, если модуль находится в устаревшем режиме (режим совместимости Windows 2000), где поддерживается только один экземпляр. В противном случае операция завершится ошибкой с JET_errRunningInMultiInstanceMode.

### <a name="return-value"></a>Возвращаемое значение

Эта функция возвращает [JET_ERR](./jet-err.md) DataType с одним из следующих кодов возврата. дополнительные сведения о возможных ошибках подсистемы ESE см. в разделе [ошибки расширенных служба хранилища Engine](./extensible-storage-engine-errors.md) и [параметры обработки ошибок](./error-handling-parameters.md).


| <p>Код возврата</p> | <p>Описание</p> | 
|--------------------|--------------------|
| <p>JET_errSuccess</p> | <p>Операция выполнена успешно.</p> | 
| <p>JET_errBackupAbortByServer</p> | <p><strong>Windows Server 2003:</strong>  это возвращаемое значение введено в Windows Server 2003.</p><p>Не удалось выполнить операцию, так как текущая Внешняя резервная копия была прервана вызовом <a href="gg294067(v=exchg.10).md">жетстопбаккуп</a>.</p> | 
| <p>JET_errClientRequestToStopJetService</p> | <p>Операция не может быть завершена, так как все действия в экземпляре, связанном с сеансом, были прекращены в результате вызова <a href="gg269240(v=exchg.10).md">жетстопсервице</a>.</p> | 
| <p>JET_errInstanceUnavailable</p> | <p>Операция не может быть завершена, так как экземпляр, связанный с сеансом, обнаружил неустранимую ошибку, которая требует, чтобы доступ ко всем данным был отозван для защиты целостности этих данных. эта ошибка будет возвращена только Windows XP и более поздних выпусках.</p> | 
| <p>JET_errInvalidBackupSequence</p> | <p>Не удалось выполнить операцию резервного копирования, так как она была вызвана вне последовательности. <a href="gg269263(v=exchg.10).md">Жеттрункателог</a> возвращает эту ошибку, если имеются необработанные дескрипторы файлов, созданные с помощью <a href="gg269249(v=exchg.10).md">жетопенфиле</a> для экземпляра.</p> | 
| <p>JET_errInvalidParameter</p> | <p>Один из указанных параметров содержал непредвиденное значение, или сочетание нескольких параметров привело к непредвиденному результату. Это может произойти для <a href="gg269263(v=exchg.10).md">жеттрункателог</a> , если указанный экземпляр является недопустимым.</p> | 
| <p>JET_errNoBackup</p> | <p>Не удалось выполнить операцию, так как не выполняется внешняя архивация.</p> | 
| <p>JET_errNotInitialized</p> | <p>Операция не может быть завершена, так как экземпляр, связанный с сеансом, еще не инициализирован.</p> | 
| <p>JET_errRestoreInProgress</p> | <p>Операция не может быть завершена, так как выполняется операция восстановления на экземпляре, связанном с сеансом.</p> | 
| <p>JET_errRunningInMultiInstanceMode</p> | <p>операция завершилась с ошибкой, так как была предпринята попытка использовать модуль в устаревшем режиме (Windows 2000), где поддерживается только один экземпляр, если в действительности несколько экземпляров уже существуют.</p> | 
| <p>JET_errTermInProgress</p> | <p>Не удается выполнить операцию, так как выполняется завершение работы экземпляра, связанного с сеансом.</p> | 



Если эта функция завершается успешно, набор файлов журнала транзакций, который больше не потребуется после успешного завершения текущего резервного копирования, удаляется. Конечный автомат резервного копирования будет дополнительно таким, что резервная копия файлов базы данных больше не разрешается. Только файлы исправления базы данных и файлы журнала транзакций могут быть открыты для резервного копирования за пределами этой точки.

Если эта функция завершается с ошибкой, резервный автомат может быть расширен таким, что резервная копия файлов базы данных больше не разрешается. Может быть удалено некоторое количество файлов журнала транзакций, которое меньше требуемого числа, но они всегда будут удаляться от старых к самым старым.

#### <a name="requirements"></a>Требования


| | | <p><strong>Клиент</strong></p> | <p>требуется Windows Vista или Windows XP.</p> | | <p><strong>Сервер</strong></p> | <p>требуется Windows server 2008 или Windows server 2003.</p> | | <p><strong>Header</strong></p> | <p>Объявлено в ESENT. h.</p> | | <p><strong>Библиотека</strong></p> | <p>Используйте ESENT. lib.</p> | | <p><strong>КОМПОНОВКИ</strong></p> | <p>Требуется ESENT.dll.</p> | 



#### <a name="see-also"></a>См. также:

[расширяемые файлы служба хранилища Engine](./extensible-storage-engine-files.md)  
[JET_ERR](./jet-err.md)  
[JET_INSTANCE](./jet-instance.md)  
[жетбегинекстерналбаккуп](./jetbeginexternalbackup-function.md)  
[жетопенфиле](./jetopenfile-function.md)  
[жетстопбаккуп](./jetstopbackup-function.md)  
[жетстопсервице](./jetstopservice-function.md)
