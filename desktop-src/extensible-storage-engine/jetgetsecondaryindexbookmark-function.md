---
description: Дополнительные сведения о функции Жетжетсекондариндексбукмарк
title: Функция Жетжетсекондариндексбукмарк
TOCTitle: JetGetSecondaryIndexBookmark Function
ms:assetid: 6953eda4-9420-4814-80f4-eb9e3e5540d8
ms:mtpsurl: https://msdn.microsoft.com/library/Gg269285(v=EXCHG.10)
ms:contentKeyID: 32765577
ms.date: 04/11/2016
ms.topic: reference
api_name:
- JetGetSecondaryIndexBookmark
topic_type:
- apiref
- kbArticle
api_type:
- COM
- DLLExport
api_location:
- ESENT.DLL
ROBOTS: INDEX,FOLLOW
ms.openlocfilehash: d86b875037982a18ebb9d488c3a05b3123002b06
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105712069"
---
# <a name="jetgetsecondaryindexbookmark-function"></a>Функция Жетжетсекондариндексбукмарк


_**Применимо к:** Windows | Windows Server_

## <a name="jetgetsecondaryindexbookmark-function"></a>Функция Жетжетсекондариндексбукмарк

Функция **жетжетсекондариндексбукмарк** извлекает специальную закладку для записи вторичного индекса в текущем положении курсора. Эту закладку можно использовать для эффективного перемещения курсора обратно к той же записи индекса с помощью [жетготосекондариндексбукмарк](./jetgotosecondaryindexbookmark-function.md). Это наиболее полезно при изменении расположения вторичного индекса, который содержит дублирующиеся ключи или содержит несколько записей индекса для одной и той же записи.

**Windows XP: жетжетсекондариндексбукмарк** появился в Windows XP.

```cpp
    JET_ERR JET_API JetGetSecondaryIndexBookmark(
      __in          JET_SESID sesid,
      __in          JET_TABLEID tableid,
      __out_opt     void* pvSecondaryKey,
      __in          unsigned long cbSecondaryKeyMax,
      __out_opt     unsigned long* pcbSecondaryKeyActual,
      __out_opt      void* pvPrimaryBookmark,
      __in          unsigned long cbPrimaryBookmarkMax,
      __out_opt     unsigned long* pcbPrimaryKeyActual,
      __in          const JET_GRBIT grbit
    );
```

### <a name="parameters"></a>Параметры

*сесид*

Сеанс, используемый для этого вызова.

*TableID*

Курсор, используемый для этого вызова.

*пвсекондарикэй*

Выходной буфер, который получает вторичный ключ.

*кбсекондарикэймакс*

Максимальный размер (в байтах) выходного буфера для вторичного ключа.

*пкбсекондарикэйактуал*

Получает фактический размер вторичного ключа в байтах.

Если этот параметр имеет значение NULL, фактический размер вторичного ключа не будет возвращен.

Если выходной буфер слишком мал, фактический размер вторичного ключа будет по-прежнему возвращен. Это означает, что это число будет больше, чем размер выходного буфера.

*пвпримарибукмарк*

Выходной буфер, получающий закладку первичного ключа.

*кбпримарибукмаркмакс*

Максимальный размер (в байтах) выходного буфера для закладки первичного ключа.

*пкбпримарикэйактуал*

Получает фактический размер закладки первичного ключа (в байтах).

Если этот параметр имеет значение NULL, фактический размер закладки первичного ключа не будет возвращен.

Если выходной буфер слишком мал, то фактический размер закладки первичного ключа будет по-прежнему возвращен. Это означает, что это число будет больше, чем размер выходного буфера.

*грбит*

Зарезервировано для последующего использования.

### <a name="return-value"></a>Возвращаемое значение

Эта функция возвращает [JET_ERR](./jet-err.md) DataType с одним из следующих кодов возврата. Дополнительные сведения о возможных ошибках ESE см. в разделе [ошибки подсистемы хранилища](./extensible-storage-engine-errors.md) и [Параметры обработки ошибок](./error-handling-parameters.md).

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th><p>Код возврата</p></th>
<th><p>Описание</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>JET_errSuccess</p></td>
<td><p>Операция выполнена успешно.</p></td>
</tr>
<tr class="even">
<td><p>JET_errBufferTooSmall</p></td>
<td><p>Операция успешно завершена, но один из буферов вывода слишком мал для получения запрошенных данных.</p>
<p>Выходной буфер заполнен объемом заданной закладки. При запросе также возвращается фактический размер закладки.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errClientRequestToStopJetService</p></td>
<td><p>Невозможно выполнить операцию, так как все действия в экземпляре, связанном с сеансом, были прекращены в результате вызова <a href="gg269240(v=exchg.10).md">жетстопсервице</a>.</p></td>
</tr>
<tr class="even">
<td><p>JET_errInstanceUnavailable</p></td>
<td><p>Невозможно выполнить операцию, поскольку экземпляр, связанный с сеансом, обнаружил неустранимую ошибку, которая требует, чтобы доступ ко всем данным был отозван для защиты целостности этих данных. Эта ошибка будет возвращена только Windows XP и более поздних версий.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errNoCurrentIndex</p></td>
<td><p>Курсор в данный момент не находится во вторичном индексе.</p>
<p>Получение закладки вторичного индекса не имеет смысла, когда курсор в данный момент не использует вторичный индекс. <a href="gg269221(v=exchg.10).md">Жетжетбукмарк</a> следует использовать, если курсор не находится на вторичном индексе.</p></td>
</tr>
<tr class="even">
<td><p>JET_errNoCurrentRecord</p></td>
<td><p>Курсор не располагается на записи.</p>
<p>Это может произойти по различным причинам. Например, это произойдет, если курсор находится в данный момент после последней записи в текущем индексе.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errNotInitialized</p></td>
<td><p>Невозможно выполнить операцию, так как экземпляр, связанный с сеансом, еще не инициализирован.</p></td>
</tr>
<tr class="even">
<td><p>JET_errRestoreInProgress</p></td>
<td><p>Невозможно выполнить операцию, так как в экземпляре, связанном с сеансом, выполняется операция восстановления.</p></td>
</tr>
<tr class="odd">
<td><p>JET_errSessionSharingViolation</p></td>
<td><p>Один и тот же сеанс нельзя использовать одновременно для нескольких потоков. Эта ошибка будет возвращена только Windows XP и более поздних версий.</p></td>
</tr>
<tr class="even">
<td><p>JET_errTermInProgress</p></td>
<td><p>Невозможно выполнить операцию, так как выполняется завершение работы экземпляра, связанного с сеансом.</p></td>
</tr>
</tbody>
</table>


При успешном выполнении закладка вторичного индекса для записи индекса в текущей позиции курсора будет возвращена в выходных буферах. Изменение состояния базы данных не выполняется.

В случае сбоя состояние буферов вывода и фактический размер закладки вторичного индекса будут неопределенными, если не была возвращена JET_errBufferTooSmall. В случае, если возвращается JET_errBufferTooSmall, выходные буферы будут содержать столько закладок вторичного индекса, сколько будет помещаться в предоставленное пространство, и фактический размер закладки вторичного индекса будет неточным. В любом случае изменение состояния базы данных не выполняется.

#### <a name="remarks"></a>Комментарии

Закладки обычно должны рассматриваться как непрозрачные фрагменты данных. Для использования внутренней структуры этих данных не нужно предпринимать никаких попыток. Однако следующие свойства могут быть известны всем закладкам ESENT:

  - Закладка однозначно определяет запись в заданной таблице.

  - Закладка записи не изменится в течение времени существования этой записи.

  - Закладка записи совпадает с ключом записи на первичном индексе таблицы, содержащей эту запись. Если для этой таблицы не определен первичный индекс, ядро СУБД создаст собственную закладку для записи.

  - Закладки можно сравнить друг с другом с помощью [memcmp](/previous-versions/visualstudio/visual-studio-6.0/aa246467(v=vs.60)) , чтобы установить их относительное упорядочение в первичном индексе по таблице исходных записей. Если для этой таблицы не определен первичный индекс, то относительный порядок закладок от этой таблицы не имеет смысла.

  - Нет смысла сравнивать закладки записей из разных таблиц друг с другом.

  - Длина закладки всегда меньше или равна JET_cbBookmarkMost (256) байт до Windows Vista. В Windows Vista и более поздних выпусках закладки могут быть более крупными. Максимальный размер закладки равен текущему значению JET_paramKeyMost + 1.

Обычно ключи обрабатываются как непрозрачные фрагменты данных. Для использования внутренней структуры этих данных не нужно предпринимать никаких попыток. Однако следующие свойства могут быть известны всем ключам ESENT:

  - Ключи можно сравнить друг с другом с помощью [memcmp](/previous-versions/visualstudio/visual-studio-6.0/aa246467(v=vs.60)) , чтобы установить их относительное упорядочение в исходном индексе по таблице записей исходного индекса.

  - Нет смысла сравнивать ключи индексов из разных индексов друг с другом.

  - Длина ключа всегда меньше или равна JET_cbKeyMost (255) байт до Windows Vista. В Windows Vista и более поздних выпусках ключи могут быть больше. Максимальный размер ключа равен текущему значению JET_paramKeyMost.

#### <a name="requirements"></a>Требования

<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td><p><strong>Клиент</strong></p></td>
<td><p>Требуется Windows Vista или Windows XP.</p></td>
</tr>
<tr class="even">
<td><p><strong>Server</strong></p></td>
<td><p>Требуется Windows Server 2008 или Windows Server 2003.</p></td>
</tr>
<tr class="odd">
<td><p><strong>Header</strong></p></td>
<td><p>Объявлено в ESENT. h.</p></td>
</tr>
<tr class="even">
<td><p><strong>Библиотека</strong></p></td>
<td><p>Используйте ESENT. lib.</p></td>
</tr>
<tr class="odd">
<td><p><strong>КОМПОНОВКИ</strong></p></td>
<td><p>Требуется ESENT.dll.</p></td>
</tr>
</tbody>
</table>


#### <a name="see-also"></a>См. также:

[JET_ERR](./jet-err.md)  
[JET_GRBIT](./jet-grbit.md)  
[JET_SESID](./jet-sesid.md)  
[JET_TABLEID](./jet-tableid.md)  
[жетжетбукмарк](./jetgetbookmark-function.md)  
[жетготосекондариндексбукмарк](./jetgotosecondaryindexbookmark-function.md)  
[жетретриевекэй](./jetretrievekey-function.md)  
[memcmp](/previous-versions/visualstudio/visual-studio-6.0/aa246467(v=vs.60))
