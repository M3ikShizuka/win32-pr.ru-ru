---
description: Вы можете импортировать и экспортировать симметричные ключи и асимметричные ключи с помощью CNG. Вы также можете использовать функции экспорта и импорта ключей для перемещения ключей между компьютерами.
ms.assetid: 37bda1e0-5dd2-455c-9627-4e7e1b0e04d3
title: Импорт и экспорт ключей
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0a4b6c26069911d771697bf06f7464aa14ab7f099e4a0e06991d2fd992efa44a
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118907705"
---
# <a name="key-import-and-export"></a>Импорт и экспорт ключей

Вы можете импортировать и экспортировать [*симметричные ключи*](/windows/desktop/SecGloss/s-gly) и асимметричные ключи с помощью CNG. Вы также можете использовать функции экспорта и импорта ключей для перемещения ключей между компьютерами.

## <a name="symmetric-keys"></a>симметричные ключи;

Чтобы импортировать или экспортировать симметричные (или сеансовые) ключи, в которых один и тот же ключ используется для шифрования и расшифровки некоторых данных, можно использовать функции [**бкриптимпорткэй**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptimportkey) и [**BCryptExportKey**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptexportkey) . Как правило, сначала выполняется экспорт ключа с помощью функции **BCryptExportKey** перед импортом с помощью функции **бкриптимпорткэй** . Функции предназначены для включения шифрования экспортированных и импортированных ключей с помощью параметров *хекспорткэй* и *химпорткэй* . Однако реализация этих функций корпорацией Майкрософт не поддерживает шифрование экспортированных и импортированных ключей.

## <a name="asymmetric-keys"></a>асимметричные ключи;

Чтобы импортировать асимметричные (или [*открытые/закрытые*](/windows/desktop/SecGloss/p-gly)) пары ключей, в которых используется один ключ для шифрования, а другой используется для расшифровки некоторых данных, можно использовать любую из функций [**BCryptImportKeyPair**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptimportkeypair) или [**нкриптимпорткэй**](/windows/desktop/api/Ncrypt/nf-ncrypt-ncryptimportkey) . Поставщик CNG должен кодировать пару ключей, используя поддерживаемый тип [*BLOB-объекта ключа*](/windows/desktop/SecGloss/k-gly) . [**BCryptExportKey**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptexportkey) можно использовать для создания большого двоичного объекта с закодированным ключом. [структуры CNG](cng-structures.md) описывают ключевые типы и структуры больших двоичных объектов, которые поддерживает поставщик служба хранилища Microsoft key.

Чтобы [**BCryptExportKey**](/windows/desktop/api/Bcrypt/nf-bcrypt-bcryptexportkey) создать сохраненную пару ключей, BLOB-объект входного ключа должен содержать [*закрытый ключ*](/windows/desktop/SecGloss/p-gly). [*Открытые ключи*](/windows/desktop/SecGloss/p-gly) не сохраняются.

Имя ключа и политика экспорта не являются частью структуры [*большого двоичного объекта*](/windows/desktop/SecGloss/b-gly) , определенной в [структурах CNG](cng-structures.md). Однако если большой двоичный объект имеет непрозрачный тип большого двоичного объекта (например, образ памяти внутреннего ключа), то BLOB-объект может содержать имя ключа и свойства политики экспорта.

В следующей процедуре описывается импорт сохраненного закрытого ключа с его свойствами.

**Импорт постоянного ключа**

1.  Создайте постоянный ключ с помощью функции [**нкрипткреатеперсистедкэй**](/windows/desktop/api/Ncrypt/nf-ncrypt-ncryptcreatepersistedkey) .
2.  Задайте необходимые свойства для объекта ключа с помощью функции [**нкриптсетпроперти**](/windows/desktop/api/Ncrypt/nf-ncrypt-ncryptsetproperty) .
3.  Установите BLOB-объект ключа импорта в качестве свойства для ключа с типом большого двоичного объекта в качестве имени свойства.
4.  Завершите импорт сохраненного ключа с помощью функции [**нкриптфинализекэй**](/windows/desktop/api/Ncrypt/nf-ncrypt-ncryptfinalizekey) .

 

 
