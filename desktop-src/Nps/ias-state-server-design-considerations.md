---
title: Рекомендации по проектированию сервера состояний
description: В зависимости от проекта может потребоваться сервер для наблюдения за пользователями, которые в настоящее время вошли в сеть.
ms.assetid: 2f8d268b-5518-4ad2-aed6-5971c913db6d
ms.tgt_platform: multiple
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b39fa2460fbad5ffedd4a517da588cc0c951f734926c1219d750e28f71734c24
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119889484"
---
# <a name="state-server-design-considerations"></a>Рекомендации по проектированию сервера состояний

> [!Note]  
> служба проверки подлинности в интернете (IAS) переименовала сервер политики сети (NPS), начиная с Windows Server 2008. Содержимое этого раздела относится как к IAS, так и к NPS. По всему тексту NPS используется для ссылки на все версии службы, включая версии, изначально называемые IAS.

 

В зависимости от проекта может потребоваться сервер для наблюдения за пользователями, которые в настоящее время вошли в сеть. Основная проблема с сервером состояний заключается в том, что данные в базе данных сервера состояний синхронизируются с тем, кто на самом деле вошел в систему. Если данные на сервере состояний не синхронизированы, пользователи могут пройти проверку в случае нескольких сеансов, если им не разрешено делать это. Кроме того, пользователи, не имеющие нескольких сеансов, могут случайно получить штраф.

При реализации сервера состояний следует учитывать следующее:

-   Сервер состояний должен принимать решение в сети через несколько секунд. По этой причине серверу состояний требуется масштабируемая инфраструктура, поддерживающая множество обновлений и запросов в секунду. Реляционные базы данных не подходят для таких больших запросов с одновременными обновлениями. Реляционные базы данных в основном создаются для обеспечения единообразия данных и обеспечения единообразного представления данных для всех потребителей. Они не предназначены для быстрого обновления.
-   Согласованность транзакций при обновлениях между несколькими объектами не имеет значения. Это связано с тем, что сервер состояний может допускать небольшое окно возможности. Тем не менее, согласованность транзакций одного обновления важна, чтобы снизить вероятность того, что сервер состояний будет находиться в несогласованном состоянии, если один из серверов RADIUS завершит работу в середине обновления.
-   Сохраняемость (сохранение состояния сети в постоянное хранилище) не имеет значения, так как постоянная информация будет быстро несинхронизирована с фактическим состоянием сети.
-   Если в сети поддерживаются ISDN или другие формы многоканального подключения, сервер состояний должен иметь возможность обрабатывать сценарии, использующие эти функции.

Одна из возможных архитектур — реализовать библиотеку DLL расширения проверки подлинности и библиотеку DLL расширения авторизации. Каждая из этих библиотек DLL может взаимодействовать по сети с базой данных. Библиотека DLL расширения авторизации может обновить базу данных, указав сведения о том, кто в данный момент вошел в сеть. Библиотека DLL расширения проверки подлинности может запрашивать эти сведения в базе данных, чтобы принять решение о принятии или отклонении запроса на проверку подлинности конкретного пользователя. Если пользователь уже вошел в систему, запрос отклоняется.

Преимущество обновления библиотеки DLL расширения авторизации в базе данных сервера состояний — это то, что библиотека DLL расширения авторизации имеет доступ к дополнительным сведениям о прошедшем проверку подлинности пользователе. Библиотека DLL расширения авторизации имеет доступ ко всем атрибутам авторизации из механизма авторизации NPS. Например, некоторые пользователи могут иметь разрешения, позволяющие им иметь несколько сеансов. Сервер состояний должен рассматривать таких пользователей как особый случай.

 

 




