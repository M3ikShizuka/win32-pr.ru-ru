---
title: Установка изображения курсора
description: Установка изображения курсора
ms.assetid: FB223131-19AE-41DD-87DE-73992AE2A0CA
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4723289155bc7898f6f49e188ad972ca152332c82994b57c79af493c8fe6b572
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119896914"
---
# <a name="setting-the-cursor-image"></a>Установка изображения курсора

*Курсор* является небольшим изображением, которое показывает расположение мыши или другого указывающего устройства. Многие приложения изменяют изображение курсора для предоставления пользователю обратной связи. Хотя это и не является обязательным, оно добавляет к вашему приложению хороший набор польскостей.

Windows предоставляет набор стандартных изображений курсоров, называемых *системными курсорами*. К ним относятся стрелка, рука, I-образный, Песочные часы (теперь это вращающийся круг) и другие. В этом разделе описывается использование системных курсоров. Для более сложных задач, таких как создание пользовательских курсоров, см. раздел [курсоры](/windows/desktop/menurc/cursors).

Курсор можно связать с классом окна, задав элемент **хкурсор** структуры [**вндкласс**](/windows/win32/api/winuser/ns-winuser-wndclassa) или [**вндклассекс**](/windows/win32/api/winuser/ns-winuser-wndclassexa) . В противном случае курсором по умолчанию является стрелка. Когда указатель мыши перемещается над окном, окно получает сообщение [**WM \_ сеткурсор**](/windows/desktop/menurc/wm-setcursor) (если мышь не захвачена другим окном). На этом этапе происходит одно из следующих событий:

-   Приложение задает курсор, а процедура окна возвращает **значение true**.
-   Приложение не выполняет никаких действий и [**передает \_ сеткурсор WM**](/windows/desktop/menurc/wm-setcursor) в [**дефвиндовпрок**](/windows/desktop/api/winuser/nf-winuser-defwindowproca).

Чтобы установить курсор, программа выполняет следующие действия:

1.  Вызывает [**лоадкурсор**](/windows/desktop/api/winuser/nf-winuser-loadcursora) для загрузки курсора в память. Эта функция возвращает маркер в курсор.
2.  Вызывает [**сеткурсор**](/windows/desktop/api/winuser/nf-winuser-setcursor) и передает маркеру курсора.

В противном случае, если приложение передает [**WM \_ Сеткурсор**](/windows/desktop/menurc/wm-setcursor) в [**дефвиндовпрок**](/windows/desktop/api/winuser/nf-winuser-defwindowproca), функция **дефвиндовпрок** использует следующий алгоритм для задания изображения курсора:

1.  Если окно имеет родителя, перешлите сообщение [**\_ сеткурсор WM**](/windows/desktop/menurc/wm-setcursor) в родительский объект, чтобы он обрабатывал.
2.  В противном случае, если окно содержит курсор класса, установите курсор на курсор класса.
3.  Если курсор класса отсутствует, установите курсор на курсор со стрелкой.

Функция [**лоадкурсор**](/windows/desktop/api/winuser/nf-winuser-loadcursora) может загрузить пользовательский курсор из ресурса или одного из системных курсоров. В следующем примере показано, как установить курсор на курсор системы.


```C++
    hCursor = LoadCursor(NULL, cursor);
    SetCursor(hCursor);
```



При изменении курсора изображение курсора сбрасывается при следующем перемещении мыши, если только вы не перехватите сообщение [**\_ сеткурсор WM**](/windows/desktop/menurc/wm-setcursor) и не настроите курсор снова. В следующем коде показано, как работать с **WM \_ сеткурсор**.


```C++
    case WM_SETCURSOR:
        if (LOWORD(lParam) == HTCLIENT)
        {
            SetCursor(hCursor);
            return TRUE;
        }
        break;
```



Этот код сначала проверяет младшие 16 бит *lParam*. Если `LOWORD(lParam)` равно **хтклиент**, то это означает, что курсор находится над клиентской областью окна. В противном случае курсор находится над неклиентской областью. как правило, курсор устанавливается только для клиентской области и позволяет Windows установить курсор для неклиентской области.

## <a name="next"></a>Следующая

[Ввод данных пользователем: Расширенный пример](user-input--extended-example.md)

 

 