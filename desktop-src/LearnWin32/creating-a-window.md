---
title: Создание окна
description: Создание окна
ms.assetid: e036519f-26b5-436c-b909-bb280d758e81
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: eea5ec39187b389405d3c6d8eca475944278a3d5
ms.sourcegitcommit: 95685061d5b0333bbf9e6ebd208dde8190f97005
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/28/2021
ms.locfileid: "108103972"
---
# <a name="creating-a-window"></a>Создание окна

## <a name="window-classes"></a>Классы окон

*Класс окна* определяет набор поведений, которые могут встречаться в нескольких окнах. Например, в группе кнопок каждая кнопка имеет аналогичное поведение, когда пользователь нажимает кнопку. Конечно, кнопки не полностью идентичны; Каждая кнопка отображает собственную текстовую строку и имеет собственные экранные координаты. Данные, уникальные для каждого окна, называются *данными экземпляра*.

Каждое окно должно быть связано с классом окна, даже если программа создает только один экземпляр этого класса. Важно понимать, что класс окна не является "классом" в смысле C++. Вместо этого это структура данных, используемая внутри операционной системы. Классы окон регистрируются в системе во время выполнения. Чтобы зарегистрировать новый класс окна, начните с заполнения структуры [**вндкласс**](/windows/win32/api/winuser/ns-winuser-wndclassa) :

```C++
// Register the window class.
const wchar_t CLASS_NAME[]  = L"Sample Window Class";

WNDCLASS wc = { };

wc.lpfnWndProc   = WindowProc;
wc.hInstance     = hInstance;
wc.lpszClassName = CLASS_NAME;
```

Необходимо задать следующие члены структуры:

- **лпфнвндпрок** — это указатель на определяемую приложением функцию, называемую *процедурой окна* или «процедурой окна». Процедура окна определяет большую часть поведения окна. Далее мы рассмотрим процедуру Windows. Сейчас просто рассматривайте это как прямую ссылку.
- **HINSTANCE** — это обработчик экземпляра приложения. Получите это значение из параметра *HINSTANCE* объекта **wWinMain**.
- **лпсзкласснаме** — это строка, идентифицирующая класс окна.

Имена классов являются локальными для текущего процесса, поэтому имя должно быть уникальным только в пределах процесса. Однако стандартные элементы управления Windows также имеют классы. При использовании любого из этих элементов управления необходимо выбрать имена классов, которые не конфликтуют с именами классов элементов управления. Например, класс окна для элемента управления Button называется "Button".

Структура [**вндкласс**](/windows/win32/api/winuser/ns-winuser-wndclassa) содержит другие элементы, не показанные здесь. Можно задать для них нулевое значение, как показано в этом примере, или заполнить их в. Эта структура подробно описана в документации MSDN.

Затем передайте адрес структуры [**вндкласс**](/windows/win32/api/winuser/ns-winuser-wndclassa) в функцию [**registerClass**](/windows/desktop/api/winuser/nf-winuser-registerclassa) . Эта функция регистрирует класс окна в операционной системе.

```C++
RegisterClass(&wc);
```

## <a name="creating-the-window"></a>Создание окна

Чтобы создать новый экземпляр окна, вызовите функцию [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) :

```C++
HWND hwnd = CreateWindowEx(
    0,                              // Optional window styles.
    CLASS_NAME,                     // Window class
    L"Learn to Program Windows",    // Window text
    WS_OVERLAPPEDWINDOW,            // Window style

    // Size and position
    CW_USEDEFAULT, CW_USEDEFAULT, CW_USEDEFAULT, CW_USEDEFAULT,

    NULL,       // Parent window    
    NULL,       // Menu
    hInstance,  // Instance handle
    NULL        // Additional application data
    );

if (hwnd == NULL)
{
    return 0;
}
```

Вы можете ознакомиться с подробными описаниями параметров в MSDN, но вот краткий обзор:

- Первый параметр позволяет указать некоторые необязательные поведения для окна (например, прозрачные окна). Присвойте этому параметру значение 0 для поведения по умолчанию.
- `CLASS_NAME` имя класса окна. Определяет тип создаваемого окна.
- Текст окна используется различными способами для различных типов окон. Если окно содержит заголовок, текст отображается в заголовке окна.
- Стиль окна — это набор флагов, определяющих некоторый вид окна. Константа **WS \_ оверлаппедвиндов** фактически является несколько флагов в сочетании с побитовой **или**. Вместе эти флаги предоставляют окну строку заголовка, границу, системное меню, а также кнопки **сворачивания** и **развертывания** . Этот набор флагов является наиболее распространенным стилем для окна приложения верхнего уровня.
- Для расположения и размера константа **во вт. \_ уседефаулт** означает использование значений по умолчанию.
- Следующий параметр задает родительское окно или окно-владелец для нового окна. Если вы создаете дочернее окно, задайте родительский элемент. Для окна верхнего уровня задайте **значение NULL**.
- Для окна приложения следующий параметр определяет меню для окна. В этом примере не используется меню, поэтому значение равно **null**.
- *HINSTANCE* — это обработчик экземпляра, описанный выше. (См. статью [WinMain: точка входа приложения](winmain--the-application-entry-point.md).)
- Последний параметр является указателем на произвольные данные типа **void \***. Это значение можно использовать для передачи структуры данных в оконную процедуру. Мы покажем один из возможных способов использования этого параметра в разделе [Управление состоянием приложения](managing-application-state-.md).

[**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) возвращает маркер в новое окно или нуль, если функция завершается ошибкой. Чтобы отобразить окно, т. е. сделать окно видимым, передайте в функцию [**ShowWindow**](/windows/desktop/api/winuser/nf-winuser-showwindow) маркер окна:

```C++
ShowWindow(hwnd, nCmdShow);
```

Параметр *HWND* — это дескриптор окна, возвращаемый функцией [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa). Параметр *нкмдшов* можно использовать для сворачивания или разворачивания окна. Операционная система передает это значение в программу с помощью функции **wWinMain** .

Ниже приведен полный код для создания окна. Помните, что `WindowProc` все еще является прямым объявлением функции.

```C++
// Register the window class.
const wchar_t CLASS_NAME[]  = L"Sample Window Class";

WNDCLASS wc = { };

wc.lpfnWndProc   = WindowProc;
wc.hInstance     = hInstance;
wc.lpszClassName = CLASS_NAME;

RegisterClass(&wc);

// Create the window.

HWND hwnd = CreateWindowEx(
    0,                              // Optional window styles.
    CLASS_NAME,                     // Window class
    L"Learn to Program Windows",    // Window text
    WS_OVERLAPPEDWINDOW,            // Window style

    // Size and position
    CW_USEDEFAULT, CW_USEDEFAULT, CW_USEDEFAULT, CW_USEDEFAULT,

    NULL,       // Parent window    
    NULL,       // Menu
    hInstance,  // Instance handle
    NULL        // Additional application data
    );

if (hwnd == NULL)
{
    return 0;
}

ShowWindow(hwnd, nCmdShow);
```

Поздравляем, вы создали окно! Сейчас окно не содержит никакого содержимого или взаимодействует с пользователем. В реальном приложении GUI окно будет реагировать на события пользователя и операционной системы. В следующем разделе описывается, как сообщения в окне предоставляют такую сортировку.

### <a name="next"></a>Следующая

[Сообщения окна](window-messages.md)
