---
title: Использование COM в приложении Windows
description: В модуле 1 этой серии показано, как создать окно и отреагировать на сообщения окон, такие как WM \_ Paint и WM \_ Close. В модуле 2 представлена объектная модель компонента (COM).
ms.assetid: 6e867618-4d02-4c17-b7ea-dc7290507689
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: c8c03f16937846c4479a70e16141f1b50bde3efc
ms.sourcegitcommit: ebd3ce6908ff865f1ef66f2fc96769be0aad82e1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2020
ms.locfileid: "103791364"
---
# <a name="module-2-using-com-in-your-windows-based-program"></a>Модуль 2. Использование COM в программе Windows-Based

В [модуле 1](your-first-windows-program.md) этой серии показано, как создать окно и отреагировать на сообщения окон, такие как [**WM \_ Paint**](/windows/desktop/gdi/wm-paint) и [**WM \_ Close**](/windows/desktop/winmsg/wm-close). В модуле 2 представлена объектная модель компонента (COM).

COM — это спецификация для создания многократно используемых программных компонентов. Многие функции, которые будут использоваться в современной программе на базе Windows, полагаются на модель COM, как показано ниже.

-   Графика (Direct2D)
-   Текст (DirectWrite)
-   Оболочка Windows
-   Элемент управления ленты
-   Анимация пользовательского интерфейса

(Некоторые технологии в этом списке используют подмножество COM и, следовательно, не являются "чистыми" COM.)

У COM есть репутация, которую трудно изучить. И потому, что написание нового программного модуля для поддержки COM может быть непростой задачей. Но если ваша программа является исключительно *потребителем* com, вы можете обнаружить, что модель COM проще понять, чем вы планируете.

Этот модуль показывает, как вызывать интерфейсы API на основе COM в программе. В нем также описываются некоторые причины разработки модели COM. Если вы понимаете, почему модель COM разработана как есть, ее можно программировать более эффективно. Вторая часть модуля описывает некоторые рекомендуемые методы программирования для COM.

COM был представлен в 1993 для поддержки связывания и внедрения объектов (OLE) 2,0. Иногда люди считают, что COM и OLE одинаковы. Это может быть еще одна причина, по которой трудно изучить Модель COM. OLE 2,0 построена на основе COM, но вам не нужно знать OLE для понимания COM.

COM — это *двоичный стандарт*, а не стандартный язык: он определяет двоичный интерфейс между приложением и программным компонентом. Как двоичный стандарт, модель COM не зависит от языка, хотя она сопоставляется естественным образом с определенными конструкциями C++. Этот модуль будет сосредоточиться на трех основных целях COM:

-   Отделение реализации объекта от его интерфейса.
-   Управление жизненным циклом объекта.
-   Обнаружение возможностей объекта во время выполнения.

## <a name="in-this-section"></a>Содержание раздела

-   [Что такое COM-интерфейс?](what-is-a-com-interface-.md)
-   [Инициализация библиотеки COM](initializing-the-com-library.md)
-   [Коды ошибок в COM](error-codes-in-com.md)
-   [Создание объекта в COM](creating-an-object-in-com.md)
-   [Пример. диалоговое окно "Открыть"](example--the-open-dialog-box.md)
-   [Управление жизненным циклом объекта](managing-the-lifetime-of-an-object.md)
-   [Запрос объекта для интерфейса](asking-an-object-for-an-interface.md)
-   [Выделение памяти в COM](memory-allocation-in-com.md)
-   [Методики программирования COM](com-coding-practices.md)
-   [Обработка ошибок в COM](error-handling-in-com.md)

## <a name="related-topics"></a>См. также

<dl> <dt>

[Знакомство с программой для Windows в C++](learn-to-program-for-windows.md)
</dt> </dl>

 

 