---
description: '\#Матрица m&215; n представляет собой набор чисел, упорядоченных по m строкам и n столбцам. На следующем рисунке показаны несколько матриц.'
ms.assetid: 62215ae0-b095-42b2-911c-aa7607a8b61a
title: Матричное представление преобразований
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0577cae38c401e842cff2ff14179594f9118dfd2
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127065883"
---
# <a name="matrix-representation-of-transformations"></a>Матричное представление преобразований

Матрица размером *m × n* представляет собой набор чисел, упорядоченных по *m* строкам и *n* столбцам. На следующем рисунке показаны несколько матриц.

![Иллюстрация, демонстрирующая шесть матриц различных измерений](images/aboutgdip05-art04.png)

Можно добавить две матрицы одного размера, добавив отдельные элементы. На следующем рисунке показаны два примера добавления матрицы.

![Иллюстрация, показывающий, как выполнить добавление матрицы](images/aboutgdip05-art05.png)

Матрицу размером *m × n* можно умножить на матрицу *n × p* , а результатом будет матрица *m × p* . Число столбцов в первой матрице должно совпадать с количеством строк во второй матрице. Например, матрицу размером 4 × 2 можно умножить на матрицу размером 2 × 3, чтобы создать матрицу размером 4 × 3.

Точки в плоскости, а также строки и столбцы матрицы можно рассматривать как векторы. Например, (2, 5) — это вектор с двумя компонентами, а (3, 7, 1) — вектор с тремя компонентами. Скалярное произведение двух векторов определяется следующим образом:

(a, б) • (c, d) = AC + BD

(a, b, c) • (d, e, f) = AD + быть + CF

Например, точка произведения (2, 3) и (5, 4) имеет значение (2) (5) + (3) (4) = 22. Скалярное произведение (2, 5, 1) и (4, 3, 1) равно (2) (4) + (5) (3) + (1) (1) = 24. Обратите внимание, что скалярное произведение двух векторов является числом, а не другим вектором. Также обратите внимание, что можно вычислить значение с точкой, только если два вектора имеют одинаковое число компонентов.

Позвольте A (i, j) быть записью в матрице A **в строке i** и j **th** . Например, A (3, 2) — это запись в матрице A в строке 3 на рабочем **столе** и в столбце 2 **ND** . Предположим, что A, B и C являются матрицами, а AB = C. Записи в языке C рассчитываются следующим образом:

C (i, j) = (строка i из A) • (столбец j из B)

На следующем рисунке показано несколько примеров перемножения матриц.

![Иллюстрация, показывающая, как выполнить умножение матрицы](images/aboutgdip05-art06.png)

Если вы считаете, что точка в плоскости является матрицей размером 1 × 2, можно преобразовать эту точку, умножив ее на матрицу размером 2 × 2. На следующем рисунке показано несколько преобразований, примененных к точке (2, 1).

![Иллюстрация, в которой показано, как использовать умножение матрицы для масштабирования, вращения или отражения точки в плоскости](images/aboutgdip05-art07.png)

Все преобразования, показанные на предыдущем рисунке, являются линейными преобразованиями. Некоторые другие преобразования, такие как перевод, не являются линейными и не могут быть выражены умножением матрицы 2 × 2. Предположим, что вы хотите начать с точки (2, 1), повернуть ее 90 градусов, перевести 3 единицы в направлении x и перевести 4 единицы в направлении по оси y. Это можно сделать, выполнив умножение матрицы, за которым следует Добавление матрицы.

![Иллюстрация, показывающая, как умножение и сложение матрицы могут поворачивать точку и преобразовывать ее дважды](images/aboutgdip05-art08.png)

Линейное преобразование (умножение матрицы 2 × 2), за которым следует перевод (сложение матрицы размером 1 × 2), называется аффинное преобразованием. Альтернатива хранению аффинных преобразований в паре матриц (одна для линейной части и другая для перевода) заключается в хранении всего преобразования в матрице размером 3 × 3. Чтобы сделать эту работу, точка на плоскости должна храниться в матрице размером 1 × 3 с фиктивной третьей координатой. Обычная методика — сделать все 3 Координаты равными 1. Например, точка (2, 1) представлена матрицей \[ 2 1 1 \] . На следующем рисунке показано аффинное преобразование (поворот 90 градусов; сдвиг на три единицы в направлении по оси x, 4 единицы в направлении оси y), выраженный в виде умножения на одну матрицу размером 3 × 3.

![Иллюстрация, показывающая, как перемножение матрицы может выполнить аффинное преобразование](images/aboutgdip05-art09.png)

В предыдущем примере точка (2, 1) сопоставляется с точкой (2, 6). Обратите внимание, что третий столбец матрицы размером 3 × 3 содержит числа 0, 0, 1. Это всегда будет иметь место для матрицы аффинного преобразования, 3 × 3. Важные числа — это шесть чисел в столбцах 1 и 2. Верхняя левая часть матрицы 2 × 2 представляет линейную часть преобразования, а первые две записи в третьей строке представляют перевод.

![Иллюстрация, показывающая, что первые два столбца наиболее важны для матрицы 3x3 с аффинное преобразованием](images/aboutgdip05-art10.png)

в Windows GDI+ можно сохранить аффинное преобразование в объекте [**матрицы**](/windows/desktop/api/gdiplusmatrix/nl-gdiplusmatrix-matrix) . Поскольку третий столбец матрицы, представляющий аффинное преобразование, всегда имеет значение (0, 0, 1), при построении объекта **Matrix** в первых двух столбцах указывается только шесть чисел. Оператор `Matrix myMatrix(0.0f, 1.0f, -1.0f, 0.0f, 3.0f, 4.0f);` конструирует матрицу, показанную на предыдущем рисунке.

## <a name="composite-transformations"></a>Составные преобразования

Составное преобразование — это последовательность преобразований, в одну за которой следуют другие. Рассмотрим матрицы и преобразования в следующем списке:

-   Матрица A-вращение на повороте на 90 градусов
-   Матрица B. масштабирование по коэффициенту 2 в направлении x
-   Матрица C переводом 3 единицы по оси y

Если начать с точки (2, 1), представленной матрицей \[ 2 1 1 \] , и умножить ее на, то B, затем на C, точка (2, 1) пройдет три преобразования в указанном порядке.

\[2 1 1 \] ABC = \[ – 2 5 1\]

Вместо того чтобы хранить три части составного преобразования в трех отдельных матрицах, можно умножить, B и C, чтобы получить одну матрицу размером 3 × 3, которая хранит все составное преобразование. Предположим, ABC = D. Затем точка, умноженная на D, дает тот же результат, что и точка, умноженная на, а затем на B, а затем на C.

\[2 1 1 \] D = \[ – 2 5 1\]

На следующем рисунке показаны матрицы A, B, C и D.

![Иллюстрация, демонстрирующая выполнение нескольких преобразований путем умножения составляющих матриц](images/aboutgdip05-art12.png)

Тот факт, что матрица составного преобразования может быть сформирована путем умножения отдельных матриц преобразования, означает, что любая последовательность аффинных преобразований может храниться в одном объекте [**матрицы**](/windows/desktop/api/gdiplusmatrix/nl-gdiplusmatrix-matrix) .

> [!Note]  
> Порядок составного преобразования важен. Как правило, поворот, масштабирование, преобразование не не отличается от масштабирования, затем поворота и преобразования. Аналогично, важен порядок умножения матриц. Как правило, ABC не совпадает с БПЗ.

 

Класс [**Matrix**](/windows/desktop/api/gdiplusmatrix/nl-gdiplusmatrix-matrix) предоставляет несколько методов для создания составного преобразования: [**Matrix:: перемножения**](/windows/desktop/api/Gdiplusmatrix/nf-gdiplusmatrix-matrix-multiply), [**Matrix:: вращение**](/windows/desktop/api/Gdiplusmatrix/nf-gdiplusmatrix-matrix-rotate), [**Матрица:: ротатеат**](/windows/desktop/api/Gdiplusmatrix/nf-gdiplusmatrix-matrix-rotateat), [**Матрица:: масштаб**](/windows/desktop/api/Gdiplusmatrix/nf-gdiplusmatrix-matrix-scale), [**Матрица:. сдвиг**](/windows/desktop/api/Gdiplusmatrix/nf-gdiplusmatrix-matrix-shear)и [**Матрица:: сдвиг**](/windows/desktop/api/Gdiplusmatrix/nf-gdiplusmatrix-matrix-translate). В следующем примере создается матрица составного преобразования, которая сначала поворачивает 30 градусов, затем масштабируется по коэффициенту 2 в направлении y, а затем преобразует 5 единиц в направлении x.


```
Matrix myMatrix;
myMatrix.Rotate(30.0f);
myMatrix.Scale(1.0f, 2.0f, MatrixOrderAppend);
myMatrix.Translate(5.0f, 0.0f, MatrixOrderAppend);
```



На следующем рисунке показана матрица.

![Иллюстрация, на которой показана матрица со значениями, выраженными в виде тригонометрических функций, и матрица с приблизительными значениями этих функций](images/aboutgdip05-art13.png)

 

 



