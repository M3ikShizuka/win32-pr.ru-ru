---
description: Один объект Matrix может хранить одно преобразование или последовательность преобразований.
ms.assetid: 1dc68ff8-6b17-4934-82da-ab2fc612aafa
title: Значение порядка преобразований
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 1a7350d63456902ff47183faa08170b3b2fef481
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104984424"
---
# <a name="why-transformation-order-is-significant"></a>Значение порядка преобразований

Один объект [**Matrix**](/windows/desktop/api/gdiplusmatrix/nl-gdiplusmatrix-matrix) может хранить одно преобразование или последовательность преобразований. Последнее называется *составным*  *преобразованием*. Матрица составного преобразования получается путем умножения матриц отдельных преобразований.

В составном преобразовании важен порядок отдельных преобразований. Например, если сначала повернуть, затем масштабировать, а затем преобразовать, вы получите другой результат, чем при первом переводе, при повороте, а затем при масштабировании. В Windows GDI+ составные преобразования строятся слева направо. Если S, R и T являются матрицами масштабирования, вращения и перевода соответственно, то продукт SRT (в таком порядке) является матрицей составного преобразования, которое сначала масштабируется, затем поворачивается, а затем преобразуется. Матрица, формируемая продуктом SRT, отличается от матрицы, созданной ТРСом продукта.

Один из причин важен в том, что преобразования, такие как вращение и масштабирование, выполняются по отношению к источнику системы координат. Масштабирование объекта, центрированного по отношению к источнику, приводит к другому результату, чем масштабирование объекта, перемещенного из источника. Аналогично, поворот объекта, центрированного по отношению к источнику, приводит к результату, отличному от поворота объекта, который был перемещен от источника.

Следующий пример сочетает масштабирование, поворот и преобразование (в этом порядке) для формирования составного преобразования. Аргумент [* * * * матриксордераппенд *](/windows/desktop/api/Gdiplusenums/ne-gdiplusenums-matrixorder) * * *, передаваемый методу [**Graphics:: RotateTransform**](/windows/desktop/api/Gdiplusgraphics/nf-gdiplusgraphics-graphics-rotatetransform) , указывает, что поворот будет следовать за масштабированием. Аналогичным образом, аргумент [* * * * матриксордераппенд *](/windows/desktop/api/Gdiplusenums/ne-gdiplusenums-matrixorder) * * *, передаваемый методу [**Graphics:: TranslateTransform**](/windows/desktop/api/Gdiplusgraphics/nf-gdiplusgraphics-graphics-translatetransform) , указывает, что перевод будет следовать за поворотом.


```
Rect rect(0, 0, 50, 50);
Pen pen(Color(255, 255, 0, 0), 0);
graphics.ScaleTransform(1.75f, 0.5f);
graphics.RotateTransform(28.0f, MatrixOrderAppend);
graphics.TranslateTransform(150.0f, 150.0f, MatrixOrderAppend);
graphics.DrawRectangle(&pen, rect);
```



В следующем примере выполняется вызов тех же методов, что и в предыдущем примере, но порядок вызовов обращен. Полученный порядок операций сначала преобразуется, затем поворачивается, затем масштабируется, что приводит к значительному результату, чем при первом масштабировании, затем поворачивается, а затем преобразуется:


```
Rect rect(0, 0, 50, 50);
Pen pen(Color(255, 255, 0, 0), 0);
graphics.TranslateTransform(150.0f, 150.0f);
graphics.RotateTransform(28.0f, MatrixOrderAppend);
graphics.ScaleTransform(1.75f, 0.5f, MatrixOrderAppend);
graphics.DrawRectangle(&pen, rect);
```



Один из способов изменения порядка отдельных преобразований в составных преобразованиях заключается в том, чтобы обратить порядок последовательности вызовов методов. Вторым способом управления порядком операций является изменение аргумента порядка матриц. Следующий пример аналогичен предыдущему, за исключением того, что [* * * * матриксордераппенд * *](/windows/desktop/api/Gdiplusenums/ne-gdiplusenums-matrixorder) * * был изменен на * * * * [матриксордерпрепенд * *](/windows/desktop/api/Gdiplusenums/ne-gdiplusenums-matrixorder)* *. Умножение матрицы выполняется в порядке SRT, где S, R и T являются матрицами для масштабирования, вращения и преобразования соответственно. Порядок составного преобразования сначала масштабируется, затем поворачивается, а затем преобразуется.


```
Rect rect(0, 0, 50, 50);
Pen pen(Color(255, 255, 0, 0), 0);
graphics.TranslateTransform(150.0f, 150.0f,MatrixOrderPrepend);
graphics.RotateTransform(28.0f, MatrixOrderPrepend);
graphics.ScaleTransform(1.75f, 0.5f, MatrixOrderPrepend);
graphics.DrawRectangle(&pen, rect);
```



Результатом предыдущего примера является тот же результат, что и в первом примере этого раздела. Это обусловлено тем, что мы отменяем порядок вызовов методов и порядок умножения матриц.

 

 



