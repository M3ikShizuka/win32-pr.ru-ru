---
title: Средства
description: В этом разделе описываются средства, которые можно использовать для подготовки приложения 64-bit. Windows 10 доступна для процессоров на базе x64 и ARM64.
ms.assetid: 457b7cc1-8517-4a36-9a0c-cf191ff3b374
keywords:
- 64-разрядное руководством по программированию для Windows, 64-разрядное программирование для Windows, средства
- средства 64-разрядное программирование для Windows
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d87fb315200ae32eb1e1441ed330be49aa02d669
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104411240"
---
# <a name="the-tools"></a>Средства

В этом разделе описываются средства, которые можно использовать для подготовки приложения 64-bit. Windows 10 доступна для процессоров на базе x64 и ARM64.

## <a name="include-files"></a>Включение файлов

Элементы API практически идентичны в пределах между 32 и 64-разрядными окнами. Файлы заголовков Windows были изменены так, чтобы их можно было использовать как для 32, так и для 64-разрядного кода. Новые 64-разрядные типы и макросы определяются в новом файле заголовка Басетсд. h, который находится в наборе файлов заголовков, включенных в Windows. h. Басетсд. h содержит новые определения типов данных, которые помогают сделать размер слова исходного кода независимым от него.

## <a name="new-data-types"></a>Новые типы данных

Файлы заголовков Windows содержат новые типы данных. Эти типы в основном предназначены для совместимости типов с 32-разрядными типами данных. Новые типы предоставляют точно такую же типизацию, что и существующие типы, в то же время обеспечивая поддержку 64-разрядных Windows. Дополнительные сведения см. [в разделе новые типы данных](the-new-data-types.md) или файл заголовка басетсд. h.

## <a name="predefined-macros"></a>Предустановленный макрос

Компилятор определяет следующие макросы для определения платформы.



| Макрос   | Значение                                                                                                     |
|---------|-------------------------------------------------------------------------------------------------------------|
| \_ПЛАТФОРМЕ | 64-разрядная платформа. Сюда входят x64 и ARM64.                                                        |
| \_Платформа | 32-разрядная платформа. Это значение также определяется в 64-разрядном компиляторе для обратной совместимости.<br/> |
| \_ПЛАТФОРМЕ | 16-разрядная платформа                                                                                           |



 

Следующие макросы относятся к архитектуре.



| Макрос      | Значение                |
|------------|------------------------|
| \_M \_ ia64  | Платформа Intel Itanium |
| \_M \_ IX86  | Платформа x86           |
| \_M \_ x64   | Платформа x64           |
| \_M \_ ARM64 | Платформа ARM64         |



 

Не используйте эти макросы, за исключением кода, зависящего от архитектуры. вместо этого используйте \_ Win64, \_ Win32 и \_ WIN16, когда это возможно.

## <a name="helper-functions"></a>Вспомогательные функции

Следующие встроенные функции (определенные в Басетсд. h) позволяют безопасно преобразовывать значения из одного типа в другой.

``` syntax
void            * Handle64ToHandle( const void * POINTER_64 h ) 
void * POINTER_64 HandleToHandle64( const void *h )
long              HandleToLong(     const void *h )
unsigned long     HandleToUlong(    const void *h )
void            * IntToPtr(         const int i )
void            * LongToHandle(     const long h )
void            * LongToPtr(        const long l )
void            * Ptr64ToPtr(       const void * POINTER_64 p )
int               PtrToInt(         const void *p )
long              PtrToLong(        const void *p )
void * POINTER_64 PtrToPtr64(       const void *p )
short             PtrToShort(       const void *p )
unsigned int      PtrToUint(        const void *p )
unsigned long     PtrToUlong(       const void *p )
unsigned short    PtrToUshort(      const void *p )
void            * UIntToPtr(        const unsigned int ui )
void            * ULongToPtr(       const unsigned long ul )
```

> [!WARNING]
> Знак **инттоптр** расширяет значение **int** , **уинттоптр** ноль — расширяет значение **неподписанного целого** числа, **лонгтоптр** знак **длинного** типа, а **улонгтоптр** нуля расширяет значение **без знака** .

 

## <a name="64-bit-compiler"></a>64-разрядный компилятор

64-разрядные компиляторы можно использовать для выявления усечения указателя, неправильного приведения типов и других проблем, связанных с 64.

При первом запуске компилятора, возможно, будет создано много усечений указателя или предупреждений о несоответствии типов, как показано ниже:

`warning C4311: 'type cast' : pointer truncation from 'unsigned char *' to 'unsigned long '`

Используйте эти предупреждения в качестве рекомендации, чтобы сделать код более надежным. Рекомендуется устранить все предупреждения, особенно предупреждения усечения указателей.

## <a name="64-bit-compiler-switches-and-warnings"></a>64-разрядные коммутаторы и предупреждения компилятора

Обратите внимание, что этот компилятор включает модель данных LLP64.

Существует параметр предупреждения, помогающий перенестися в LLP64. Параметр-Wp64-W3 включает следующие предупреждения.

-   C4305: предупреждение усечения. Например, "return": усечение из "без знака Int64" в "Long".
-   C4311: предупреждение усечения. Например, "приведение типа": усечение указателя из "int \* \_ ptr64" в "int".
-   C4312: преобразование в предупреждение о большем размере. Например, "приведение типов": преобразование "int" в "int \* \_ ptr64" большего размера.
-   C4318: передача нулевой длины. Например, передача нулевой константы в качестве длины функции **memset** .
-   C4319: оператор NOT. Например, "~": нулевое расширение "без знака Long" до "неподписанный \_ Int64" большего размера.
-   C4313: вызов семейства функций **printf** с конфликтующими спецификаторами и аргументами типа преобразования. Например, "printf": "% p" в строке формата конфликтует с аргументом 2 типа " \_ Int64". Другим примером является функция printf ("% x", значение указателя \_ ), что приводит к усечению верхних 32 бит. Правильный вызов — printf ("% p", значение указателя \_ ).
-   Предупреждение C4244: то же, что и у существующего предупреждения C4242. Например, return: преобразование из " \_ Int64" в "без знака int", возможна потери данных.

## <a name="64-bit-linker-and-libraries"></a>64-разрядный компоновщик и библиотеки

Для создания приложений используйте компоновщик и библиотеки, предоставляемые Windows SDK. Большинство 32-разрядных библиотек имеют соответствующую 64-разрядную версию, но некоторые устаревшие библиотеки доступны только в 32-разрядных версиях. Код, который вызывает эти библиотеки, не будет связываться при создании приложения для 64-разрядной версии Windows.

 

 





