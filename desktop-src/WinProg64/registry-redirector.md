---
title: Перенаправитель реестра
description: Перенаправитель реестра изолирует 32-разрядные и 64-разрядные приложения, предоставляя отдельные логические представления определенных частей реестра в эмуляторе WOW64.
ms.assetid: b3989f79-0439-485a-96c1-4f2227d48653
keywords:
- 64-разрядное руководством по программированию для Windows, 64-разрядное программирование для Windows, перенаправитель реестра
- перенаправление реестра 64-разрядное программирование для Windows
- перенаправление на 64-разрядное программирование для Windows
- WOW64 64-разрядное программирование Windows, перенаправитель реестра
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 04c11e68f307aa014adb7cae8415f1baba155678
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104411046"
---
# <a name="registry-redirector"></a>Перенаправитель реестра

Перенаправитель реестра изолирует 32-разрядные и 64-разрядные приложения, предоставляя отдельные логические представления определенных частей реестра в эмуляторе WOW64. Перенаправитель реестра перехватывает вызовы реестра 32-bit и 64-bit в соответствующие логические представления реестра и сопоставляет их с соответствующим физическим расположением реестра. Процесс перенаправления прозрачен для приложения. Поэтому 32-разрядное приложение может обращаться к данным реестра, как если бы оно выполнялось в 32-разрядной версии Windows, даже если данные хранятся в другом расположении в 64-разрядной версии Windows.

**Windows 10 на ARM:** Помимо 32-разрядного логического представления для приложений x86, Windows 10 в ARM включает в себя отдельное логическое представление для 32-разрядных приложений ARM.

Подмножество ключей в перенаправленных путях реестра является общим. 32-разрядные вызовы реестра для общих ключей не перенаправляются. Вместо этого одна физическая копия ключа сопоставляется с каждым логическим представлением реестра. Список перенаправленных ключей и общих ключей см. в разделе [разделы реестра, затрагиваемые WOW64](shared-registry-keys.md).

Windows **server 2008, Windows Vista, Windows server 2003 и Windows XP:** Чтобы обеспечить взаимодействие приложений с помощью COM и других механизмов, также *отражаются* подмножество перенаправленных разделов реестра. Процесс отражения реестра копирует разделы и значения реестра между двумя представлениями реестра, чтобы синхронизировать их. Отражение реестра удалено начиная с Windows 7 и Windows Server 2008 R2. Дополнительные сведения см. в разделе [отражение реестра](registry-reflection.md).

В следующем сценарии показано использование этих логических представлений.

-   32-разрядное приложение x86 проверяет наличие следующего раздела реестра: **hKey \_ Local \_ Machine \\ Software \\ Hello**. Если ключ не существует, приложение создает его со значением по умолчанию "Hello 32-bit x86 World"; в противном случае он считывает и отображает значение.
-   Одно и то же приложение изменяется для записи "Hello 64-bit World" вместо "Hello 32-разрядный мир x86" и повторной компиляции в качестве 64-разрядного приложения x64 или ARM64.
-   **Windows 10 на ARM:** Одно и то же приложение изменяется для записи "Hello 32-bit ARM" и повторной компиляции в виде приложения с 32-разрядной версией ARM.
-   Когда 32-разрядное приложение x86 запускается в 64-разрядной версии Windows, отображается сообщение "Hello 32-bit x86 World". При запуске 64-разрядного приложения отображается сообщение "Hello 64-bit World". **Windows 10 на ARM:** Когда 32-разрядное приложение ARM запускается в 64-разрядной ARM64 Windows, отображается сообщение "Hello 32-bit ARM". Все приложения вызывают те же функции реестра с одним и тем же предопределенным маркером и одним и тем же именем ключа. Разница заключается в том, что каждое приложение работает со своим логическим представлением реестра, и каждое представление сопоставляется с отдельным физическим расположением реестра, что обеспечивает неизменность всех версий строки.

Перенаправленные ключи сопоставляются с физическими расположениями в разделе **WOW6432Node**. Например, **Программа hKey \_ для \_ локального \\ компьютера** перенаправляется в **hKey \_ Local \_ Machine \\ Software \\ WOW6432Node**. Однако физическое расположение перенаправленных ключей должно считаться зарезервированным системой. Приложения не должны напрямую обращаться к физическому расположению ключа, так как это расположение может измениться. Дополнительные сведения см. [в разделе доступ к альтернативному представлению реестра](accessing-an-alternate-registry-view.md).

**Windows 10 на ARM:** Перенаправленные 32-разрядные ключи ARM сопоставляются с физическими расположениями в разделе WowAA32Node.

Чтобы помочь 32-разрядным приложениям, которые записывают данные **reg \_ SZ** или **reg \_ expand \_ SZ** , содержащие% ProgramFiles% или% COMMONPROGRAMFILES%, в реестр, WOW64 перехватывает эти операции записи и заменяет их на "% ProgramFiles (x86)%" и "% COMMONPROGRAMFILES (x86)%". Например, если каталог Program Files находится на диске C, то "% ProgramFiles (x86)%" разворачивается в "C: \\ Program Files (x86)". Замена выполняется только при соблюдении следующих условий.

-   Строка должна начинаться с% ProgramFiles% или% CommonProgramFiles%. Если строка начинается с пробела или любого символа, отличного от%, он не заменяется.
-   Вариант% ProgramFiles% или% COMMONPROGRAMFILES% должен быть в точности так, как показано, так как при сравнении строк учитывается регистр. Например, если строка начинается с% CommonProgramFiles% вместо% COMMONPROGRAMFILES%, она не заменяется.
-   Длина строки не может превышать \_ \* 2 + 15 символов. Если она превышает эту длину, она не заменяется.
-   Ключ не может быть открыт с помощью ключа \_ WOW64 \_ 64KEY. Этот флаг указывает, что операции с ключом должны выполняться в 64-разрядном представлении реестра, поэтому оно не заменяется. Дополнительные сведения см. [в разделе доступ к альтернативному представлению реестра](accessing-an-alternate-registry-view.md).

Windows **server 2008, Windows Vista, Windows server 2003 и Windows XP:** \_Флаг 64KEY для ключа WOW \_ 64 \_ не влияет на замену ключа. Этот флаг влияет на замену, начиная с Windows 7 и Windows Server 2008 R2.

Кроме того, REG \_ SZ или REG \_ expand \_ SZ ключи, содержащие System32, заменяются на SysWOW64. Строка должна начинаться с пути, указывающего на или в% WINDIR% \\ System32. При сравнении строк регистр не учитывается. Переменные среды развертываются до сопоставления с путем, поэтому все следующие пути будут заменены:% WINDIR% \\ System32,% systemroot% \\ system32 и C: \\ Windows \\ System32. Это исправление применяется только к ключам, которые были отражены до Windows 7.

Дополнительные сведения см. в следующих разделах:

-   [Отражение реестра](registry-reflection.md)
-   [Разделы реестра, относящиеся к WOW64](shared-registry-keys.md)
-   [Доступ к альтернативному представлению реестра](accessing-an-alternate-registry-view.md)
-   [Пример перенаправления реестра в эмуляторе WOW64](example-of-registry-reflection-and-redirection-on-wow64.md)
-   [Удаленный доступ к реестру в 64-разрядной версии Windows](remote-registry-access-in-64-bit-windows.md)

 

 




