---
description: Начинает шифрование полностью расшифрованного тома или возобновляет шифрование частично зашифрованного тома.
ms.assetid: bba8b800-309b-4268-8278-db69827bbdf6
title: Метод Encrypt класса Win32_EncryptableVolume
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- Win32_EncryptableVolume.Encrypt
api_type:
- COM
api_location:
- Root\CIMV2\Security\MicrosoftVolumeEncryption
ms.openlocfilehash: 463f13c250404e9a66095144166e74dbfae933ac
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104081480"
---
# <a name="encrypt-method-of-the-win32_encryptablevolume-class"></a>Метод Encrypt \_ класса Win32 енкриптаблеволуме

Метод **Encrypt** класса [**Win32 \_ енкриптаблеволуме**](win32-encryptablevolume.md) начинает шифрование полностью расшифрованного тома или возобновляет шифрование частично зашифрованного тома. Если шифрование приостановлено или выполняется его выполнение, этот метод ведет себя так же, как [**ресумеконверсион**](resumeconversion-win32-encryptablevolume.md). Если расшифровка приостановлена или выполняется ее выполнение, этот метод останавливает расшифровку и начинает шифрование.

> [!Note]  
> Если диск является аппаратно зашифрованным, этот метод не шифрует данные. Вместо этого он устанавливает для состояния полосы значение "снято с блокировки" из "всегда разблокировано". Если полоса заблокирована, разблокирована или доступна только для чтения, диск считается зашифрованным.

 

**Windows Vista:** Шифрование тома, отличного от текущего тома операционной системы, не поддерживается.

## <a name="syntax"></a>Синтаксис


```mof
uint32 Encrypt(
  [in, optional] uint32 EncryptionMethod,
  [in, optional] uint32 EncryptionFlags
);
```



## <a name="parameters"></a>Параметры

<dl> <dt>

*Енкриптионмесод* \[ в необязательное\]
</dt> <dd>

Тип: **UInt32**

Целое число без знака, указывающее алгоритм шифрования и размер ключа, используемые для шифрования тома. Если этот параметр больше нуля, а том частично или полностью зашифрован, *енкриптионмесод* должен соответствовать существующему методу шифрования тома. Если этот параметр больше нуля, а соответствующий параметр групповая политика включен с допустимым значением, *енкриптионмесод* должен соответствовать параметру групповая политика.

Список возможных значений Енкриптионмесод см. в описании метода [**жетенкриптионмесод**](getencryptionmethod-win32-encryptablevolume.md) .

Значение по умолчанию для Windows 7 или ниже: 1 (AES \_ 128 \_ с \_ диффузором).

Значение по умолчанию для Windows 8, Windows 8.1 или Windows 10, версия 1507:3 (AES \_ 128).

Значение по умолчанию для Windows 10, 1511 или более поздней версии: 6 (XTS \_ AES \_ 128).

</dd> <dt>

*Енкриптионфлагс* \[ в необязательное\]
</dt> <dd>

Тип: **UInt32**

Флаги, описывающие поведение шифрования.

**Windows 7, Windows server 2008 R2, Windows Vista Enterprise и Windows server 2008:** Этот параметр недоступен.

Сочетание 32 бит, в котором в настоящее время определены следующие биты.



| Значение                                                                                  | Значение                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|----------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <dl> <dt>0x00000001</dt> </dl>  | При запуске нового процесса шифрования Шифрование томов выполняется в режиме шифрования только для данных. Если шифрование приостановлено или остановлено, вызов метода **Encrypt** эффективно возобновляет преобразование, а значение этого бита игнорируется. Этот бит действует только в том случае, если методы **Encrypt** или [**енкриптафтерхардваретест**](encryptafterhardwaretest-win32-encryptablevolume.md) запускают шифрование из полностью расшифрованного состояния, выполняется расшифровка или приостановленное состояние расшифровки. Если этот бит равен нулю, то есть он не задан, при запуске нового процесса шифрования будет выполнено преобразование в полном режиме.<br/> |
| <dl> <dt>0x00000002</dt> </dl>  | Выполните очистку свободного места тома по требованию. Вызов метода **Encrypt** с этим набором битов разрешен только в том случае, если в настоящее время не выполняется преобразование или очистка тома и он находится в зашифрованном состоянии.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| <dl> <dt>0x00010000 </dt> </dl> | Выполнение запрошенной операции в синхронном режиме. Вызов блокируется до тех пор, пока запрошенная операция не будет завершена или была прервана. Этот флаг поддерживается только при использовании метода **Encrypt** . Этот флаг можно указать при вызове **шифрования** для возобновления остановки или прекращения шифрования или очистки, а также при выполнении шифрования или очистки. Это позволяет вызывающему объекту возобновить синхронное ожидание до завершения или прерывания процесса.<br/>                                                                                                                                                                                  |



 

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Тип: **UInt32**

При сбое этот метод возвращает один из следующих кодов или другой код ошибки.

Этот метод немедленно возвращает значение. Если том уже полностью зашифрован и другие ошибки не возвращаются, этот метод возвращает значение 0.



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Возвращаемый код и значение</th>
<th>Описание</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><dl> <dt><strong>S_OK</strong></dt> <dt>0 (0x0)</dt> </dl></td>
<td>Метод успешно выполнен.<br/></td>
</tr>
<tr class="even">
<td><dl> <dt><strong>E_INVALIDARG</strong></dt> <dt>2147942487 (0x80070057)</dt> </dl></td>
<td>Параметр <em>енкриптионмесод</em> предоставляется, но не находится в известном диапазоне или не соответствует текущему параметру групповая политика.<br/></td>
</tr>
<tr class="odd">
<td><dl> <dt><strong>FVE_E_CANNOT_ENCRYPT_NO_KEY</strong></dt> <dt>2150694958 (0x8031002E)</dt> </dl></td>
<td>Для тома не существует ключа шифрования. Отключите предохранители ключа с помощью метода <a href="disablekeyprotectors-win32-encryptablevolume.md"><strong>дисаблекэйпротекторс</strong></a> или используйте один из следующих методов, чтобы указать предохранители ключа для тома:<br/>
<ul>
<li><a href="protectkeywithexternalkey-win32-encryptablevolume.md"><strong>протекткэйвисекстерналкэй</strong></a></li>
<li><a href="protectkeywithnumericalpassword-win32-encryptablevolume.md"><strong>протекткэйвиснумерикалпассворд</strong></a></li>
<li><a href="protectkeywithtpm-win32-encryptablevolume.md"><strong>протекткэйвистпм</strong></a></li>
<li><a href="protectkeywithtpmandpin-win32-encryptablevolume.md"><strong>протекткэйвистпмандпин</strong></a></li>
<li><a href="protectkeywithtpmandpinandstartupkey-win32-encryptablevolume.md"><strong>протекткэйвистпмандпинандстартупкэй</strong></a></li>
<li><a href="protectkeywithtpmandstartupkey-win32-encryptablevolume.md"><strong>протекткэйвистпмандстартупкэй</strong></a></li>
</ul>
<strong>Windows Vista:</strong> Если для тома не существует ключа шифрования, вместо него возвращается ERROR_INVALID_OPERATION. Десятичное значение — 4317, а шестнадцатеричное значение — 0x10DD.<br/></td>
</tr>
<tr class="even">
<td><dl> <dt><strong>FVE_E_CANNOT_SET_FVEK_ENCRYPTED</strong></dt> <dt>2150694957 (0x8031002D)</dt> </dl></td>
<td>Предоставленный метод шифрования не соответствует ни частичному, ни полностью зашифрованному тому. Чтобы продолжить шифрование, оставьте параметр <em>енкриптионмесод</em> пустым или используйте нулевое значение.<br/></td>
</tr>
<tr class="odd">
<td><dl> <dt><strong>FVE_E_CLUSTERING_NOT_SUPPORTED</strong></dt> <dt>2150694942 (0x8031001E)</dt> </dl></td>
<td>Невозможно зашифровать том, так как этот компьютер настроен как часть кластера серверов.<br/></td>
</tr>
<tr class="even">
<td><dl> <dt><strong>FVE_E_LOCKED_VOLUME</strong></dt> <dt>2150694912 (0x80310000)</dt> </dl></td>
<td>Том заблокирован.<br/></td>
</tr>
<tr class="odd">
<td><dl> <dt><strong>FVE_E_POLICY_PASSWORD_REQUIRED</strong></dt> <dt>2150694956 (0x8031002C)</dt> </dl></td>
<td>Предохранители ключа для типа " &quot; числовой пароль" не &quot; указаны. Групповая политика требуется резервное копирование сведений о восстановлении в службы домен Active Directory. Чтобы добавить хотя бы один предохранитель ключа этого типа, используйте метод <a href="protectkeywithnumericalpassword-win32-encryptablevolume.md"><strong>протекткэйвиснумерикалпассворд</strong></a> .<br/></td>
</tr>
</tbody>
</table>



 

## <a name="remarks"></a>Комментарии

При использовании этого метода без второго параметра (в соответствии с определением Windows 7 и Windows Vista Enterprise) метод всегда начнет преобразование в полном режиме, чтобы обеспечить обратную совместимость. Таким образом, безопасность существующих приложений и сценариев не будет нарушена с добавлением второго необязательного параметра в Windows 8 и Windows Server 2012.

Можно вызвать [**жетконверсионстатус**](getconversionstatus-win32-encryptablevolume.md) , чтобы определить, выполняется ли шифрование, а также процент зашифрованного тома.

После полного шифрования тома и добавления и включения предохранителей ключа состояние защиты тома изменится на "вкл.".

Файлы MOF-файл (MOF) содержат определения для классов инструментарий управления Windows (WMI) (WMI). MOF-файлы не устанавливаются в составе Windows SDK. Они устанавливаются на сервере при добавлении связанной роли с помощью диспетчер сервера. Дополнительные сведения о файлах MOF см. в разделе [MOF-файл (MOF)](../wmisdk/managed-object-format--mof-.md).

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|---------------------------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows Vista Enterprise, \[ только для настольных приложений Windows Vista Ultimate\]<br/>                       |
| Минимальная версия сервера<br/> | \[Только для настольных приложений Windows Server 2008\]<br/>                                                    |
| Пространство имен<br/>                | Корневой \\ CIMV2 \\ безопасности \\ микрософтволуминкриптион<br/>                                             |
| MOF<br/>                      | <dl> <dt>Win32 \_ енкриптаблеволуме. mof</dt> </dl> |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**\_Енкриптаблеволуме Win32**](win32-encryptablevolume.md)
</dt> </dl>

 

 
