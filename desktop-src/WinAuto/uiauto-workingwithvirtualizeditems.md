---
title: Работа с виртуализированными элементами
description: В этом разделе описывается использование функций, предоставляемых шаблонами элементов управления ItemContainer и Виртуализедитем для поиска и получения сведений о виртуализированных элементах.
ms.assetid: e1898ba0-5ffa-4c61-b378-c7ef7c4a2c52
keywords:
- Клиенты, виртуализированные элементы модели автоматизации пользовательского интерфейса
- Клиенты, виртуализированные элементы
- Клиенты, шаблоны элементов управления
- Клиенты, шаблоны элементов управления Виртуализедитем
- Клиенты, шаблоны элементов управления ItemContainer
- Клиенты, шаблоны элементов управления Виртуализедитем модели автоматизации пользовательского интерфейса
- Клиенты, шаблоны элементов управления модели автоматизации пользовательского интерфейса
- Клиенты, шаблоны элементов управления ItemContainer модели автоматизации пользовательского интерфейса
- Модель автоматизации пользовательского интерфейса, виртуализированные элементы
- Модель автоматизации пользовательского интерфейса, шаблоны элементов управления
- Модель автоматизации пользовательского интерфейса, шаблоны элементов управления Виртуализедитем
- Модель автоматизации пользовательского интерфейса, шаблоны элементов управления ItemContainer
- Шаблоны элементов управления Виртуализедитем
- Шаблоны элементов управления ItemContainer
- шаблоны элементов управления, Виртуализедитем
- шаблоны элементов управления, ItemContainer
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0e2c0e84f91af6bcaadef5af373b73057fb4a137480255f3ee1af4456e45eaf1
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119570374"
---
# <a name="working-with-virtualized-items"></a>Работа с виртуализированными элементами

В этом разделе описывается использование функций, предоставляемых шаблонами элементов управления [ItemContainer](uiauto-implementingitemcontainer.md) и [виртуализедитем](uiauto-implementingvirtualizeditem.md) для поиска и получения сведений о виртуализированных элементах.

-   [Общие сведения о виртуализации](#overview-of-virtualization)
-   [Как элемент управления поддерживает виртуализацию](#how-a-control-supports-virtualization)
-   [Как клиенты находят и реализуют виртуализованные элементы](#how-clients-find-and-realize-virtualized-items)
-   [Пример](#example)
-   [Связанные темы](#related-topics)

## <a name="overview-of-virtualization"></a>Общие сведения о виртуализации

Элементы управления, содержащие большое количество дочерних элементов, могут использовать виртуализацию для эффективного управления элементами. При использовании виртуализации элемент управления сохраняет полную информацию в памяти только для подмножества элементов в любой момент времени. Как правило, подмножество включает только те элементы, которые в настоящее время видны пользователю. Полные сведения о оставшихся виртуализованных элементах хранятся в хранилище и загружаются в память, так как им требуется элемент управления, например, когда новые элементы становятся видимыми для пользователя.

Элементы управления, использующие виртуализацию, представляют проблему, поскольку только реализованные элементы полностью доступны в виде элементов модели автоматизации пользовательского интерфейса Майкрософт в дереве модели автоматизации пользовательского интерфейса. Виртуализированные элементы не существуют в дереве, поэтому сведения о них недоступны для клиентов. Чтобы получить сведения о виртуализированных элементах, клиентам требуется способ принудительной автоматизации пользовательского интерфейса для передачи запроса, чтобы реализовать элементы элемента управления. После реализации элементов Модель автоматизации пользовательского интерфейса может создавать для них элементы автоматизации пользовательского интерфейса. Модель автоматизации пользовательского интерфейса содержит два шаблона элементов управления, позволяющие клиентам работать с виртуализированными элементами: [ItemContainer](uiauto-implementingitemcontainer.md) и [виртуализедитем](uiauto-implementingvirtualizeditem.md).

## <a name="how-a-control-supports-virtualization"></a>Как элемент управления поддерживает виртуализацию

Любой элемент управления, который может содержать виртуализированные элементы, должен поддерживать шаблон элемента управления [ItemContainer](uiauto-implementingitemcontainer.md) . Кроме того, любой элемент, который может быть виртуализирован, должен поддерживать шаблон элемента управления [виртуализедитем](uiauto-implementingvirtualizeditem.md) . Функциональные возможности, предоставляемые шаблонами элементов управления ItemContainer и Виртуализедитем, доступны клиентам через интерфейсы [**иуиаутоматионитемконтаинерпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationitemcontainerpattern) и [**иуиаутоматионвиртуализедитемпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) .

## <a name="how-clients-find-and-realize-virtualized-items"></a>Как клиенты находят и реализуют виртуализованные элементы

Клиенты могут использовать метод [**иуиаутоматионитемконтаинерпаттерн:: финдитембипроперти**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) для поиска дочерних элементов в контейнере на основе значения конкретного свойства. Метод также может получить первый элемент в контейнере или элемент, следующий за указанным элементом. Если найден соответствующий дочерний элемент, **финдитембипроперти** Извлекает интерфейс [**иуиаутоматионелемент**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) для элемента. Однако если дочерний элемент является виртуализированным, то интерфейс **иуиаутоматионелемент** является заполнителем. Ошибка [**UIA \_ E \_ елементнотаваилабле**](uiauto-error-codes.md) возникает, когда клиент пытается использовать интерфейс **иуиаутоматионелемент** для получения значений свойств или вызова методов, которые еще недоступны. Свойства или методы, доступные через заполнитель, зависят от реализации элемента управления. Единственным требованием для заполнителя является поддержка интерфейса [**иуиаутоматионвиртуализедитемпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) .

Ошибка [**UIA \_ E \_ елементнотаваилабле**](uiauto-error-codes.md) — это указание клиенту на то, что элемент может быть виртуализирован. Клиент должен ответить путем получения интерфейса [**иуиаутоматионвиртуализедитемпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern) для элемента, а затем реализовать элемент, вызвав метод [**Иуиаутоматионвиртуализедитемпаттерн:: реализовать**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) . В случае этого интерфейс [**иуиаутоматионелемент**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) будет полностью функциональным для всех доступных свойств.

В зависимости от реализации элемента управления вызов [**иуиаутоматионвиртуализедитемпаттерн:: реализовать**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) может привести к тому, что элемент управления прокручивает элемент на представление. Однако клиент не должен полагаться на прокрутку элемента в представление или сделать видимым. Чтобы убедиться, что элемент является видимым, клиент может использовать метод [**иуиаутоматионскроллитемпаттерн:: скроллинтовиев**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationscrollitempattern-scrollintoview) .

## <a name="example"></a>Пример

Пример кода, демонстрирующий использование поддержки модели автоматизации пользовательского интерфейса для виртуализации, см. [в разделе Получение виртуализированного элемента](uiauto-howto-retrieve-virtualized-item.md).

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Общие сведения о шаблонах элементов управления модели автоматизации пользовательского интерфейса](uiauto-controlpatternsoverview.md)
</dt> </dl>

 

 




