---
title: Разработка пользовательских свойств, событий и шаблонов элементов управления
description: Конструкция пользовательского свойства, события или шаблона элемента управления должна быть полезна в самых разных реализациях элементов управления.
ms.assetid: e4b224a0-3958-4ae7-96cb-fe6dc16511a7
keywords:
- Модель автоматизации пользовательского интерфейса, пользовательские свойства
- Модель автоматизации пользовательского интерфейса, общие сведения о событиях
- Модель автоматизации пользовательского интерфейса, общие сведения о шаблонах элементов управления
- Модель автоматизации пользовательского интерфейса, Разработка пользовательских свойств
- Модель автоматизации пользовательского интерфейса, проектирование событий
- Модель автоматизации пользовательского интерфейса, Проектирование шаблонов элементов управления
- Модель автоматизации пользовательского интерфейса, Виневентс
- Пользовательские свойства, проектирование
- события, проектирование
- события, Виневентс
- шаблоны элементов управления, проектирование
- WinEvents
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: de5b95d7daa3570e8b4b9b1d61c7c5f5590c6456d83190195e57af66811f1672
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118324807"
---
# <a name="design-custom-properties-events-and-control-patterns"></a>Разработка пользовательских свойств, событий и шаблонов элементов управления

Конструкция пользовательского свойства, события или шаблона элемента управления должна быть полезна в самых разных реализациях элементов управления. Следует избегать использования проектов для управления или приложений, которые полезны только в ограниченных сценариях. Проект должен соответствовать примерам существующих свойств автоматизации пользовательского интерфейса Майкрософт, событий и шаблонов элементов управления, которые были тщательно указаны в соответствии с потребностями широкого спектра специальных возможностей и автоматизированных проверочных приложений.

Реализация спецификации для пользовательского свойства, события или шаблона элемента управления включает взаимодействие и соглашение между сторонами клиента и поставщика и требует, чтобы обе стороны реализовали спецификацию единообразно. Компаниям рекомендуется работать с отраслевыми организациями, такими как [Alliance Accessibility (AIA)](https://www.atia.org/) для разработки и публикации спецификации пользовательского свойства, события или шаблона элемента управления. Таким образом, можно обеспечить достижение согласия и взаимодействие с самыми широкими различными приложениями.

Этот раздел состоит из следующих подразделов.

-   [Когда следует использовать пользовательские свойства и события](#when-to-use-custom-properties-and-events)
-   [Разработка пользовательских свойств](#designing-custom-properties)
-   [Проектирование пользовательских событий](#designing-custom-events)
    -   [Пользовательские события автоматизации пользовательского интерфейса и Виневентс](#custom-ui-automation-events-and-winevents)
-   [Проектирование пользовательских шаблонов элементов управления](#designing-custom-control-patterns)
-   [Пользовательские типы элементов управления](#custom-control-types)
-   [Связанные темы](#related-topics)

## <a name="when-to-use-custom-properties-and-events"></a>Когда следует использовать пользовательские свойства и события

Перед созданием пользовательского свойства, события или шаблона элемента управления убедитесь, что модель автоматизации пользовательского интерфейса не предоставляет существующее решение. Например, создание пользовательского шаблона элемента управления "Click" не требуется, так как шаблон элемента управления " [вызов](uiauto-implementinginvoke.md) " уже описывает эту функциональность.

Если требуется выбрать настраиваемое свойство, событие или шаблон элемента управления, убедитесь, что он не является слишком ясным или универсальным. Например, шаблон элемента управления с именем "показывать" не полезен, поскольку видимость элемента управления может быть указана свойством доступности элемента, например [**UIA \_ Исекспандколлапсепаттернаваилаблепропертид**](uiauto-control-pattern-availability-propids.md) или [**UIA \_ исскроллитемпаттернаваилаблепропертид**](uiauto-control-pattern-availability-propids.md).

Перед реализацией пользовательского решения необходимо тщательно подтвердить его, а затем полностью разработать функциональность.

## <a name="designing-custom-properties"></a>Разработка пользовательских свойств

Модель автоматизации пользовательского интерфейса включает два основных типа свойств: свойства элементов автоматизации и свойства шаблона элемента управления. Свойства элементов автоматизации состоят из общего набора свойств, таких как Name, Акцелераторкэй и ClassName, которые предоставляются всеми элементами модели автоматизации пользовательского интерфейса независимо от типа элемента управления. Свойства шаблона элемента управления предоставляются элементом управления через определенный шаблон элемента управления. Каждый шаблон элемента управления имеет соответствующий набор свойств шаблона элемента управления, который должен предоставлять элемент управления. Например, элемент управления, поддерживающий шаблон элемента управления [Grid](uiauto-implementinggrid.md) , предоставляет свойства ColumnCount и ROWCOUNT.

Свойство настраиваемого элемента автоматизации или свойство шаблона элемента управления должно соответствовать следующим рекомендациям по проектированию:

-   Пользовательское свойство должно иметь один из следующих типов данных, указанных в перечислении [**уиаутоматионтипе**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype) . Другие типы данных для пользовательских свойств не поддерживаются.
    -   **\_Bool уиаутоматионтипе**
    -   **Уиаутоматионтипе \_ Double**
    -   **Уиаутоматионтипе, \_ элемент**
    -   **Уиаутоматионтипе \_ int**
    -   **\_Точка уиаутоматионтипе**
    -   **\_Строка уиаутоматионтипе**
-   Если пользовательское свойство содержит строковые данные ([**BSTR**](/previous-versions/windows/desktop/automat/bstr)), спецификация должна определить, может ли свойство быть локализуемое (то есть можно ли перевести строку на другой язык пользовательского интерфейса).
-   Пользовательское свойство не должно пересекаться с функциями или функциями существующих свойств.

## <a name="designing-custom-events"></a>Проектирование пользовательских событий

Приложения используют Уведомления о событиях модели автоматизации пользовательского интерфейса для реагирования на изменения и действия, связанные с элементами пользовательского интерфейса. Большинство свойств имеют связанные события изменения свойств, которые создает модель автоматизации пользовательского интерфейса при изменении значения свойства. Если вы представиме пользовательское свойство, следует рассмотреть возможность введения любых соответствующих пользовательских событий, которые также могут потребоваться.

Пользовательское событие должно соответствовать следующим рекомендациям по проектированию:

-   Пользовательское событие должно иметь состояние "без отслеживания состояния". Он не может быть связан с конкретным свойством или значением.
-   Пользовательское событие не должно перекрываться с определением или ролью любого существующего события.

### <a name="custom-ui-automation-events-and-winevents"></a>Пользовательские события автоматизации пользовательского интерфейса и Виневентс

[виневентс](winevents-infrastructure.md) — полезный механизм взаимодействия и обработки событий на платформе Microsoft Windows. Однако введение нового идентификатора WinEvent является рискованным, так как может привести к конфликтам с другими приложениями или операционной системой, в результате чего система станет нестабильной. Чтобы избежать конфликтов, корпорация Майкрософт определила несколько различных категорий Виневентс, и для каждой категории определен один или несколько диапазонов значений для использования в качестве идентификаторов WinEvent. Дополнительные сведения см. в разделе [распределение идентификаторов WinEvent](allocation-of-winevent-ids.md).

Пользовательские события автоматизации пользовательского интерфейса избегают конфликтов путем выделения идентификатора события внутри платформы автоматизации пользовательского интерфейса.

## <a name="designing-custom-control-patterns"></a>Проектирование пользовательских шаблонов элементов управления

Шаблон элемента управления — это интерфейс со свойствами, методами и событиями, определяющими дискретную часть функциональных возможностей, доступных в элементе автоматизации. Методы шаблона элемента управления позволяют клиентам автоматизации пользовательского интерфейса управлять определенным аспектом элемента управления. Свойства и события шаблона элемента управления предоставляют сведения о некоторых аспектах элемента управления и предоставляют сведения о состоянии элемента автоматизации, который реализует шаблон элемента управления.

Пользовательский шаблон элемента управления должен соответствовать следующим рекомендациям по проектированию:

-   Пользовательский шаблон элемента управления должен охватывать определенный сценарий. Например, шаблон элемента управления [ItemContainer](uiauto-implementingitemcontainer.md) предназначен для запроса к автономному объекту независимо от состояния виртуализации, но не выполняет перечисление или подсчет содержащихся объектов.
-   Пользовательский шаблон элемента управления не должен пересекаться с функциями существующих шаблонов элементов управления. Например, шаблоны элементов управления [Invoke](uiauto-implementinginvoke.md) и [ExpandCollapse](uiauto-implementingexpandcollapse.md) не следует объединять и представлять как новый шаблон элемента управления. Либо повторно используйте существующие шаблоны элементов управления, либо Определите уникальные сценарии с помощью новых шаблонов элементов управления.
-   Несколько шаблонов пользовательских элементов управления могут быть разработаны вместе для поддержки сложных сценариев. Например, шаблоны элементов управления [Selection](uiauto-implementingselection.md) и [SelectionItem](uiauto-implementingselectionitem.md) работают вместе для поддержки общих сценариев выбора объектов.

## <a name="custom-control-types"></a>Пользовательские типы элементов управления

Несмотря на то, что этот раздел посвящен регистрации пользовательских свойств автоматизации пользовательского интерфейса, событий и шаблонов элементов управления, можно также добавить новые типы элементов управления. В отличие от пользовательских свойств, событий и шаблонов элементов управления, Пользовательский тип элемента управления не может быть зарегистрирован программно во время выполнения, так как это просто потенциальное значение свойства ControlType модели автоматизации пользовательского интерфейса. Однако идентификатор типа пользовательского элемента управления можно определить, опубликовать и сделать доступным для использования другими клиентами и поставщиками. Дополнительные сведения о типах элементов управления см. в разделе [Общие сведения о типах элементов управления модели автоматизации пользовательского интерфейса](uiauto-controltypesoverview.md).

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

**Зрения**
</dt> <dt>

[Регистрация пользовательских свойств, событий и шаблонов элементов управления](uiauto-regcustompropseventpatterns.md)
</dt> <dt>

[Общие сведения о свойствах автоматизированного пользовательского интерфейса](uiauto-propertiesoverview.md)
</dt> <dt>

[Обзор событий автоматизации пользовательского интерфейса](uiauto-eventsoverview.md)
</dt> <dt>

[Общие сведения о шаблонах элементов управления модели автоматизации пользовательского интерфейса](uiauto-controlpatternsoverview.md)
</dt> </dl>

 

 