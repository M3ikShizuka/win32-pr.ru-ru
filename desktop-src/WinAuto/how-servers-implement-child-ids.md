---
title: Как серверы реализуют дочерние идентификаторы
description: Разработчики сервера могут назначить дочерние идентификаторы как для простых элементов, так и для объектов со специальными возможностями. Однако рекомендуемый подход заключается в поддержке стандартного интерфейса модели COM IEnumVARIANT в каждом доступном объекте, который имеет дочерние элементы.
ms.assetid: 236de46e-8fe0-4f53-b989-267c9ee87545
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0721c9660aa02fb16e9ec33495279cd90e872a37
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "103987682"
---
# <a name="how-servers-implement-child-ids"></a>Как серверы реализуют дочерние идентификаторы

Разработчики сервера могут назначить дочерние идентификаторы как для простых элементов, так и для объектов со специальными возможностями. Однако рекомендуемый подход заключается в поддержке стандартного интерфейса модели COM [IEnumVARIANT](/windows/win32/api/oaidl/nn-oaidl-ienumvariant) в каждом доступном объекте, который имеет дочерние элементы.

При реализации [IEnumVARIANT](/windows/win32/api/oaidl/nn-oaidl-ienumvariant)необходимо выполнить следующие действия.

-   Перечисление всех дочерних элементов, как простых, так и доступных объектов. Укажите дочерние идентификаторы для всех простых элементов и предоставьте [**IDispatch**](idispatch-interface.md) каждому доступному объекту.
-   Для объектов со специальными возможностями  задайте для элемента VT [**в качестве значения**](variant-structure.md) параметра VT \_ Dispatch. Элемент **пдиспвал** должен содержать указатель на интерфейс [**IDispatch**](idispatch-interface.md) . Обратите внимание, что **вариант** выделяется и освобождается клиентом.
-   Для простых элементов ИДЕНТИФИКАТОРом дочернего элемента является любое 32-разрядное положительное целое число. Обратите внимание, что ноль и отрицательные целые числа зарезервированы корпорацией Майкрософт Active Accessibility. Задайте для элемента **VT** структуры [**Variant**](variant-structure.md) значение VT \_ I4, а элемент **лвал** — идентификатор дочернего элемента.

Если [IEnumVARIANT](/windows/win32/api/oaidl/nn-oaidl-ienumvariant)не поддерживается, необходимо назначить дочерние идентификаторы и нумеровать дочерние объекты в каждом объекте последовательно, начиная с одного.

Рекомендуется, чтобы клиенты использовали функцию Microsoft Active Accessibility [**акцессиблечилдрен**](/windows/desktop/api/Oleacc/nf-oleacc-accessiblechildren) , а не напрямую вызывать интерфейс [IEnumVARIANT](/windows/win32/api/oaidl/nn-oaidl-ienumvariant) сервера.

 

 