---
title: Рекомендации по проектированию прокси-объектов
description: Проектирование объектов прокси и специальных возможностей зависит от структуры элементов пользовательского интерфейса сервера. Независимо от проекта элемент пользовательского интерфейса должен уведомлять свой прокси-объект до его уничтожения, чтобы объект прокси-сервера обрабатывал вызовы от клиентов соответствующим образом.
ms.assetid: 83a9ff66-2fe6-4589-a187-cdaf207b02b8
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e0cd96056f89e1efc18da3e299a76e92c85166efd7067e54f972a69eb8786d57
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118830075"
---
# <a name="design-considerations-for-proxy-objects"></a>Рекомендации по проектированию прокси-объектов

Проектирование объектов прокси и специальных возможностей зависит от структуры элементов пользовательского интерфейса сервера. Независимо от проекта элемент пользовательского интерфейса должен уведомлять свой прокси-объект до его уничтожения, чтобы объект прокси-сервера обрабатывал вызовы от клиентов соответствующим образом.

В следующем списке описаны две возможности проектирования:

-   Поместите код, реализующий интерфейс [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) , в тот же модуль, что и код, реализующий элемент пользовательского интерфейса, если код пользовательского интерфейса легко расширяем. В этом случае прокси-сервер «упрощен» в том смысле, что все они отслеживают жизненный цикл доступного объекта, перенаправляют вызовы к доступному объекту и возвращают результаты.
-   Поместите код, реализующий метод [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) , в тот же модуль, что и код, реализующий прокси-объект. В этом случае доступный объект использует внутренние функции для получения сведений об элементе пользовательского интерфейса.

## <a name="trackbar-controls"></a>Элементы управления TrackBar

При реализации элементов управления TrackBar используйте для **изменения стиля TrackBar \_ , чтобы** предоставить более значимую информацию. Этот стиль меняет масштаб, используемый методом [**IAccessible:: Get \_ акквалуе**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accvalue).

Для вертикальных линейки прокрутки без этого стиля метод [**IAccessible:: Get \_ акквалуе**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accvalue) возвращает ноль (0), если ползунок TrackBar находится в верхней части элемента управления; значения увеличиваются по мере прокрутки бегунка к концу. При **\_ обращении к TBS** , метод **IAccessible:: Get \_ акквалуе** возвращает 100 (100), когда бегунок линейки находится вверху; числа уменьшаются по мере перемещения ползунка TrackBar в нижнюю сторону.

Для горизонтальных значений TrackBar без этого стиля возвращается ноль (0), если ползунок TrackBar находится в левом конце элемента управления. значения увеличиваются при перемещении бегунка TrackBar вправо. При **\_ обращении к TBS** , метод [**IAccessible:: Get \_ акквалуе**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accvalue) возвращает 100 (100), когда ползунок TrackBar находится слева; значения уменьшаются по мере перемещения бегунка TrackBar вправо.

 

 




