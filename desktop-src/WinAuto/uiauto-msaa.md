---
title: Модель автоматизации пользовательского интерфейса и Active Accessibility
description: Microsoft Active Accessibility — это устаревший API, который появился в Windows 95 и был разработан для обеспечения доступа к Windows приложениям.
ms.assetid: 6fc92e67-b94b-4ba3-9f5d-42be6072f110
keywords:
- Модель автоматизации пользовательского интерфейса, Microsoft Active Accessibility
- Модель автоматизации пользовательского интерфейса, Специальные возможности
- Модель автоматизации пользовательского интерфейса, Active Accessibility
- Модель автоматизации пользовательского интерфейса, языки программирования
- Модель автоматизации пользовательского интерфейса, представления в виде дерева
- Модель автоматизации пользовательского интерфейса, Навигация
- Модель автоматизации пользовательского интерфейса, типы элементов управления
- специальные возможности
- Active Accessibility
- Microsoft Active Accessibility
- типы элементов управления, сведения
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 20a784a6537a3206f32c1299342a521de01d60fab2968294a067f8cc1f7e6dff
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118564385"
---
# <a name="ui-automation-and-active-accessibility"></a>Модель автоматизации пользовательского интерфейса и Active Accessibility

Microsoft Active Accessibility — это устаревший API, который появился в Windows 95 и был разработан для обеспечения доступа к Windows приложениям. автоматизация пользовательского интерфейса майкрософт — это новая модель специальных возможностей для Windows и предназначенная для удовлетворения потребностей программных продуктов и средств автоматизированного тестирования. Модель автоматизации пользовательского интерфейса предлагает множество улучшений по сравнению с Microsoft Active Accessibility. В этом разделе объясняются различия между двумя технологиями.

В этом разделе содержатся следующие подразделы.

-   [Языки программирования](#programming-languages)
-   [Серверы и клиенты](#servers-and-clients)
-   [Элементы пользовательского интерфейса](#ui-elements)
-   [Представления в виде дерева и навигация](#tree-views-and-navigation)
-   [Роли и типы элементов управления](#roles-and-control-types)
-   [Состояния и свойства](#states-and-properties)
-   [События](#events)
-   [Доступ к свойствам и объектам Active Accessibility из модели автоматизации пользовательского интерфейса](#accessing-active-accessibility-properties-and-objects-from-ui-automation)
-   [Связанные темы](#related-topics)

## <a name="programming-languages"></a>Языки программирования

Microsoft Active Accessibility основан на модели COM с поддержкой сдвоенных интерфейсов, поэтому она может быть программируемой в C/C++ и языках сценариев.

Когда была введена модель автоматизации пользовательского интерфейса, API клиента был ограничен управляемым кодом, а API поставщика включал как управляемые, так и неуправляемые реализации. в Windows 7 был введен новый API клиента на основе COM, облегчающий программирование клиентских приложений автоматизации пользовательского интерфейса на C/C++.

## <a name="servers-and-clients"></a>Серверы и клиенты

В Microsoft Active Accessibility серверы и клиенты обмениваются данными напрямую, в основном через серверную реализацию интерфейса [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) .

В модели автоматизации пользовательского интерфейса основная служба находится между сервером (поставщиком) и клиентом. Основная служба выполняет вызовы интерфейсов, реализованных поставщиками, и предоставляет дополнительные службы, такие как создание уникальных идентификаторов времени выполнения для элементов пользовательского интерфейса. Клиентские приложения получают доступ к этой основной службе путем создания объекта [**куиаутоматион**](/previous-versions/windows/desktop/legacy/ff384838(v=vs.85)) . Этот объект поддерживает набор клиентских интерфейсов, отделяющих от интерфейсов поставщика. Дополнительные сведения см. [в разделе Создание объекта куиаутоматион](uiauto-creatingcuiautomation.md).

Поставщики автоматизации пользовательского интерфейса могут предоставлять сведения клиентам Microsoft Active Accessibility, а серверы Майкрософт Active Accessibility могут предоставлять сведения клиентским приложениям автоматизации пользовательского интерфейса. Однако, поскольку Microsoft Active Accessibility не предоставляет столько сведений, как модель автоматизации пользовательского интерфейса, эти две модели несовместимы полностью.

## <a name="ui-elements"></a>Элементы пользовательского интерфейса

Microsoft Active Accessibility представляет элемент пользовательского интерфейса в виде интерфейса [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) , сопоставленного с дочерним идентификатором. Трудно сравнить два указателя **IAccessible** , чтобы определить, ссылаются ли они на один и тот же элемент.

В модели автоматизации пользовательского интерфейса каждый элемент представлен как объект, предоставляющий клиентам интерфейс [**иуиаутоматионелемент**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) . Элементы можно сравнивать по идентификаторам времени выполнения, которые извлекаются с помощью [**иуиаутоматионелемент:: жетрунтимеид**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getruntimeid).

## <a name="tree-views-and-navigation"></a>Представления в виде дерева и навигация

Элементы пользовательского интерфейса на экране можно рассматривать как древовидную структуру с рабочим столом в качестве корневого элемента, окна приложения как непосредственные дочерние элементы, а в приложениях — как дополнительные потомки.

В Microsoft Active Accessibility многие элементы пользовательского интерфейса, несущественные для конечных пользователей, представлены в древовидной структуре. Клиентские приложения должны проверять все элементы в дереве, чтобы определить, какие элементы являются осмысленными.

Клиентские приложения модели автоматизации пользовательского интерфейса видят пользовательский интерфейс через отфильтрованное представление. Представление содержит только элементы, которые предоставляют пользователю сведения или что пользователь может взаимодействовать с. Доступны стандартные представления, включающие только элементы управления и доступные только элементы содержимого, а клиентские приложения могут определять пользовательские представления. Модель автоматизации пользовательского интерфейса упрощает описание пользовательского интерфейса для пользователя и помогает пользователю взаимодействовать с приложениями.

В Microsoft Active Accessibility переход между элементами является пространственным, например, переходом к элементу, который находится слева на экране, логическое, например, переход к следующему элементу меню или следующему элементу в последовательности табуляции в диалоговом окне или иерархическим, например переход к первому дочернему элементу в контейнере или из дочернего элемента в его родительский элемент. Иерархическая навигация усложняется тем фактом, что дочерние элементы не всегда являются объектами, реализующими [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible).

В модели автоматизации пользовательского интерфейса все элементы пользовательского интерфейса являются COM-объектами, которые предоставляют интерфейс [**иуиаутоматионелемент**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) и поддерживают те же базовые функции. С точки зрения поставщика COM-объекты реализуют интерфейс, наследуемый от [**иравелементпровидерсимпле**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irawelementprovidersimple). Навигация в основном иерархическая; то есть от родителей к дочерним элементам и от одного уровня к другому. Однако переход между одноуровневыми элементами имеет логический элемент, так как он может следовать за порядком табуляции. Клиент может переходить от любой начальной точки с помощью любого фильтрованного представления дерева с помощью [**иуиаутоматионтривалкер**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtreewalker). Клиент также может переходить к определенным дочерним элементам или потомкам с помощью [**иуиаутоматионелемент:: FindFirst**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findfirst) и [**Иуиаутоматионелемент:: FindAll**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-findall). Например, можно легко получить все элементы в диалоговом окне, поддерживающем указанный шаблон элемента управления.

Навигация в модели автоматизации пользовательского интерфейса является более стабильной, чем в Microsoft Active Accessibility. Некоторые элементы, такие как раскрывающиеся списки и всплывающие окна, появляются дважды в дереве Microsoft Active Accessibility, а переход от этих элементов может привести к непредвиденным результатам. Несложно реализовать Active Accessibility Майкрософт надлежащим образом для элемента управления "Главная панель". Модель автоматизации пользовательского интерфейса обеспечивает перестановку и изменение расположения, чтобы элемент можно было поместить в любое место в дереве, несмотря на иерархию, накладываемую на владение Windows.

## <a name="roles-and-control-types"></a>Роли и типы элементов управления

Microsoft Active Accessibility использует свойство Аккроле ([**IAccessible:: Get \_ аккроле**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accrole)) для получения описания роли элемента в пользовательском интерфейсе, например [**\_ \_ ползунок системы роли**](object-roles.md) или элемент [**\_ \_ MenuItem в системе роли**](object-roles.md). Роль элемента — это основной ключ к его доступным функциональным возможностям. Взаимодействие с элементом управления достигается с помощью фиксированных методов, таких как [**IAccessible:: аккселект**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accselect) и [**IAccessible:: аккдодефаултактион**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accdodefaultaction). Взаимодействие между клиентским приложением и пользовательским интерфейсом ограничено тем, что можно сделать с помощью [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible).

В отличие от этого, модель автоматизации пользовательского интерфейса разделяет тип элемента управления элемента, который описан свойством [**иуиаутоматионелемент:: куррентконтролтипе**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentcontroltype) (или [**Иуиаутоматионелемент:: качедконтролтипе**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_cachedcontroltype)), от ожидаемой функциональности. Функциональность определяется шаблонами элементов управления, которые поддерживаются поставщиком через его реализацию специализированных интерфейсов. Шаблоны элементов управления можно комбинировать, чтобы описать полный набор функциональных возможностей, поддерживаемых определенным элементом пользовательского интерфейса. Некоторые поставщики должны поддерживать определенный шаблон элемента управления. Например, поставщик флажка должен поддерживать шаблон элемента управления [Toggle](uiauto-implementingtoggle.md) . Другие поставщики должны поддерживать один или несколько наборов шаблонов элементов управления. Например, кнопка должна поддерживать шаблон элемента управления Toggle или [Invoke](uiauto-implementinginvoke.md) . Другие не поддерживают шаблоны управления. Например, панель, которую нельзя переместить, изменить ее размер или закрепить, не имеет шаблонов элементов управления.

Модель автоматизации пользовательского интерфейса поддерживает пользовательские элементы управления, которые определяются константой [**UIA \_ кустомконтролтипеид**](uiauto-controltype-ids.md) и могут быть описаны свойством [**иуиаутоматионелемент:: куррентлокализедконтролтипе**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_currentlocalizedcontroltype) (или [**иуиаутоматионелемент:: CachedLocalizedControlType**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-get_cachedlocalizedcontroltype)).

Следующая таблица сопоставляет[роли объектов](object-roles.md) Microsoft Active Accessibility с типами элементов управления модели автоматизации пользовательского интерфейса.



| Роль Active Accessibility                                                   | Тип элемента управления модели автоматизации пользовательского интерфейса                                                                     |
|-----------------------------------------------------------------------------|------------------------------------------------------------------------------------------------|
| [**\_кнопка системы \_ роли**](object-roles.md)     | [Кнопка](uiauto-supportbuttoncontroltype.md)                                                  |
| [**\_клиент системы \_ роли**](object-roles.md)             | [Календарь](uiauto-supportcalendarcontroltype.md)                                              |
| [**\_чеккбуттон системы \_ ролей**](object-roles.md)   | [CheckBox](uiauto-supportcheckboxcontroltype.md)                                              |
| [**\_ \_ поле со списком для системы роли**](object-roles.md)         | [ComboBox](uiauto-supportcomboboxcontroltype.md)                                              |
| [**\_клиент системы \_ роли**](object-roles.md)             | См. раздел [пользовательские типы элементов управления](uiauto-designingcustompropseventpatterns.md). |
| [**\_список систем \_ ролей**](object-roles.md)                 | [DataGrid](uiauto-supportdatagridcontroltype.md)                                              |
| [**\_ListItem системы \_ роли**](object-roles.md)         | [DataItem](uiauto-supportdataitemcontroltype.md)                                              |
| [**\_документ системы \_ роли**](object-roles.md)         | [Document](uiauto-supportdocumentcontroltype.md)                                              |
| [**\_системный \_ текст роли**](object-roles.md)                 | [Правка](uiauto-supporteditcontroltype.md)                                                      |
| [**\_ \_ группирование системы ролей**](object-roles.md)         | [Группа](uiauto-supportgroupcontroltype.md)                                                    |
| [**\_список систем \_ ролей**](object-roles.md)                 | [Header](uiauto-supportheadercontroltype.md)                                                  |
| [**\_колумнхеадер системы \_ ролей**](object-roles.md) | [HeaderItem](uiauto-supportheaderitemcontroltype.md)                                          |
| [**\_ссылка на систему роли \_**](object-roles.md)                 | [Гиперссылка](uiauto-supporthyperlinkcontroltype.md)                                            |
| [**\_график системы \_ роли**](object-roles.md)           | [Изображение](uiauto-supportimagecontroltype.md)                                                    |
| [**\_список систем \_ ролей**](object-roles.md)                 | [Список](uiauto-supportlistcontroltype.md)                                                      |
| [**\_ListItem системы \_ роли**](object-roles.md)         | [ListItem](uiauto-supportlistitemcontroltype.md)                                              |
| [**\_менупопуп системы \_ ролей**](object-roles.md)       | [Меню](uiauto-supportmenucontroltype.md)                                                      |
| [**\_ \_ строка подменю системы ролей**](object-roles.md)           | [MenuBar](uiauto-supportmenubarcontroltype.md)                                                |
| [**\_ \_ пункт MenuItem системы роли**](object-roles.md)         | [MenuItem](uiauto-supportmenuitemcontroltype.md)                                              |
| [**\_область системы \_ роли**](object-roles.md)                 | [Панель](uiauto-supportpanecontroltype.md)                                                      |
| [**компонент \_ PROGRESSBAR системы ролей \_**](object-roles.md)   | [ProgressBar](uiauto-supportprogressbarcontroltype.md)                                        |
| [**\_переключатель системы \_ роли**](object-roles.md)   | [RadioButton](uiauto-supportradiobuttoncontroltype.md)                                        |
| [**\_ \_ полоса прокрутки системы роли**](object-roles.md)       | [Элемента](uiauto-supportscrollbarcontroltype.md)                                            |
| [**\_Разделитель системы \_ роли**](object-roles.md)       | [Двоеточи](uiauto-supportseparatorcontroltype.md)                                            |
| [**\_ \_ ползунок системы роли**](object-roles.md)             | [Slider](uiauto-supportslidercontroltype.md)                                                  |
| [**\_спинбуттон системы \_ ролей**](object-roles.md)     | [Spinner](uiauto-supportspinnercontroltype.md)                                                |
| [**\_SPLITBUTTON системы \_ ролей**](object-roles.md)   | [SplitButton](uiauto-supportsplitbuttoncontroltype.md)                                        |
| [**\_системный \_ StatusBar для роли**](object-roles.md)       | [StatusBar](uiauto-supportstatusbarcontroltype.md)                                            |
| [**\_пажетаблист системы \_ ролей**](object-roles.md)   | [TAB](uiauto-supporttabcontroltype.md)                                                        |
| [**\_пажетаб системы \_ ролей**](object-roles.md)           | [TabItem](uiauto-supporttabitemcontroltype.md)                                                |
| [**\_системная \_ Таблица ролей**](object-roles.md)               | [Таблица](uiauto-supporttablecontroltype.md)                                                    |
| [**\_статиктекст системы \_ ролей**](object-roles.md)     | [Text](uiauto-supporttextcontroltype.md)                                                      |
| [**\_индикатор системы \_ роли**](object-roles.md)       | [Типа](uiauto-supportthumbcontroltype.md)                                                    |
| [**\_заголовок системы \_ роли**](object-roles.md)         | [TitleBar](uiauto-supporttitlebarcontroltype.md)                                              |
| [**\_ \_ панель инструментов системы роли**](object-roles.md)           | [Панелей](uiauto-supporttoolbarcontroltype.md)                                                |
| [**\_ \_ всплывающая подсказка системы роли**](object-roles.md)           | [ToolTip](uiauto-supporttooltipcontroltype.md)                                                |
| [**\_Структура системы \_ роли**](object-roles.md)           | [Приклад](uiauto-supporttreecontroltype.md)                                                      |
| [**\_аутлинеитем системы \_ ролей**](object-roles.md)   | [TreeItem](uiauto-supporttreeitemcontroltype.md)                                              |
| [**\_окно системы \_ роли**](object-roles.md)             | [Окно](uiauto-supportwindowcontroltype.md)                                                  |



 

## <a name="states-and-properties"></a>Состояния и свойства

Элементы Microsoft Active Accessibility поддерживают общий набор свойств. Некоторые свойства, такие как Аккстате, должны описывать различные условия в зависимости от роли элемента. Серверы должны реализовывать все методы [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) , возвращающие свойство, даже те свойства, которые не относятся к элементу.

Модель автоматизации пользовательского интерфейса определяет дополнительные свойства, некоторые из которых соответствуют состояниям в Microsoft Active Accessibility. Некоторые свойства являются общими для всех элементов, но другие свойства относятся к типам элементов управления и шаблонам элементов управления. Поставщик автоматизации пользовательского интерфейса не должен реализовывать ненужные свойства, но может возвращать значение NULL для всех свойств, которые он не поддерживает. Основная служба автоматизации пользовательского интерфейса может получить некоторые свойства от поставщика окна по умолчанию, и они совместить со свойствами, явно реализованными поставщиком.

Кроме того, благодаря поддержке множества дополнительных свойств Модель автоматизации пользовательского интерфейса обеспечивает лучшую производительность за счет кэширования свойств.

В следующей таблице показано соответствие между некоторыми свойствами в двух моделях. Описание идентификаторов свойств модели автоматизации пользовательского интерфейса см. в разделе [идентификаторы свойств элементов автоматизации](uiauto-automation-element-propids.md).



| Метод доступа к свойству Active Accessibility                                               | Идентификатор свойства модели автоматизации пользовательского интерфейса                                                                                                                                                                                | Remarks                                                                                                                                                                                                                                                                                                                                     |
|--------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**получить \_ акккэйбоардшорткут**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_acckeyboardshortcut) | [**UIA \_ Акцесскэйпропертид**](uiauto-automation-element-propids.md) или [ **UIA \_ акцелераторкэйпропертид**](uiauto-automation-element-propids.md) | [**UIA \_ Акцесскэйпропертид**](uiauto-automation-element-propids.md) имеет приоритет, если оба они есть.                                                                                                                                                                                                         |
| [**получить \_ аккнаме**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accname)                         | [**UIA \_ намепропертид**](uiauto-automation-element-propids.md)                                                                                                                      |                                                                                                                                                                                                                                                                                                                                             |
| [**получить \_ аккроле**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accrole)                         | [**UIA \_ контролтипепропертид**](uiauto-automation-element-propids.md)                                                                                                        | См. предыдущую таблицу для сопоставления ролей с типами элементов управления.                                                                                                                                                                                                                                                                                  |
| [**получить \_ акквалуе**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accvalue)                       | [**UIA \_ Валуевалуепропертид**](uiauto-control-pattern-propids.md) или [ **UIA \_ ранжевалуевалуепропертид**](uiauto-control-pattern-propids.md)   | Допускается только для типов элементов управления, поддерживающих [**иуиаутоматионвалуепаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvaluepattern) или [**иуиаутоматионранжевалуепаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationrangevaluepattern). Значения диапазона нормализованы до 0-100, что соответствует поведению Microsoft Active Accessibility. Значения представлены в виде строк. |
| [**получить \_ акчелп**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_acchelp)                         | [**UIA \_ хелптекстпропертид**](uiauto-automation-element-propids.md)                                                                                                              |                                                                                                                                                                                                                                                                                                                                             |
| [**акклокатион**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-acclocation)                          | [**UIA \_ баундингректанглепропертид**](uiauto-automation-element-propids.md)                                                                                            |                                                                                                                                                                                                                                                                                                                                             |
| [**получить \_ аккдескриптион**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accdescription)           | Не поддерживается.                                                                                                                                                                                           | Аккдескриптион не имеет четкой спецификации в Microsoft Active Accessibility, что привело к тому, что серверы размещают в этом свойстве различные фрагменты информации.                                                                                                                                                                    |
| [**получить \_ акчелптопик**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_acchelptopic)               | Не поддерживается.                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                             |



 

В следующей таблице показаны идентификаторы свойств модели автоматизации пользовательского интерфейса, соответствующие [константам состояния объекта](object-state-constants.md)Microsoft Active Accessibility.



| Состояние Active Accessibility                                                                    | Свойство модели автоматизации пользовательского интерфейса                                                                                                                                                                                                                                                                                                                                                               | Вызывается ли изменение состояния WinEvent? |
|-----------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------|
| [**\_Система состояний \_ проверена**](object-state-constants.md)                 | [**UIA \_ Тогглетогглестатепропертид**](uiauto-control-pattern-propids.md) для флажка. [**UIA \_ Селектионитемисселектедпропертид**](uiauto-control-pattern-propids.md) для переключателя.                                                                                                                   | Д                               |
| [**\_Система состояний \_ свернута**](object-state-constants.md)             | [**UIA \_ Експандколлапсикспандколлапсестатепропертид**](uiauto-control-pattern-propids.md) (значение = [**ExpandCollapseState \_ свернуто**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-expandcollapsestate)).                                                                                                                         | Д                               |
| [**\_Система состояний \_ развернута**](object-state-constants.md)               | [**UIA \_ Експандколлапсикспандколлапсестатепропертид**](uiauto-control-pattern-propids.md) (значение = [**ExpandCollapseState \_ развернуто**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-expandcollapsestate) или [**ExpandCollapseState \_ партиаллекспандед**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-expandcollapsestate)). | Д                               |
| [**Система состояний с \_ \_ фокусом**](object-state-constants.md)             | [**UIA \_ Искэйбоардфокусаблепропертид**](uiauto-automation-element-propids.md).                                                                                                                                                                                                                                                                   | Нет                               |
| [**Система состояний, \_ \_ нацеленная на**](object-state-constants.md)                 | [**UIA \_ Хаскэйбоардфокуспропертид**](uiauto-automation-element-propids.md).                                                                                                                                                                                                                                                                         | Нет                               |
| [**\_хаспопуп системы \_ состояний**](object-state-constants.md)               | [**UIA \_ Експандколлапсикспандколлапсестатепропертид**](uiauto-control-pattern-propids.md) для пунктов меню.                                                                                                                                                                                                                           | Нет                               |
| [**\_Система состояний \_ невидима**](object-state-constants.md)             | [**UIA \_ Исоффскринпропертид**](uiauto-automation-element-propids.md) (value = true и [**иуиаутоматионелемент:: жеткликкаблепоинт**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getclickablepoint) завершается ошибкой).                                                                                                                                                         | Нет                               |
| [**\_системное состояние \_ связано**](object-state-constants.md)                   | [**UIA \_ Контролтипепропертид**](uiauto-automation-element-propids.md) (value = [**UIA \_ хиперлинкконтролтипеид**](uiauto-controltype-ids.md)).                                                                                                                                                                                | Нет                               |
| [**\_ \_ смешанная система состояний**](object-state-constants.md)                     | [**UIA \_ Тогглетогглестатепропертид**](uiauto-control-pattern-propids.md) (значение = [**тогглестате \_ неопределенное**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-togglestate).                                                                                                                                                                              | Нет                               |
| [**\_ \_ перемещаемая система состояний**](object-state-constants.md)               | [**UIA \_ Трансформканмовепропертид**](uiauto-control-pattern-propids.md).                                                                                                                                                                                                                                                                            | Нет                               |
| [**\_МНОГОвыборочная система состояний \_**](object-state-constants.md) | [**UIA \_ Селектионканселектмултиплепропертид**](uiauto-control-pattern-propids.md).                                                                                                                                                                                                                                                        | Нет                               |
| [**\_Система состояний \_**](object-state-constants.md)             | [**UIA \_ Исоффскринпропертид**](uiauto-automation-element-propids.md).                                                                                                                                                                                                                                                                                   | Нет                               |
| [**\_Система состояний \_ защищена**](object-state-constants.md)             | [**UIA \_ Испассвордпропертид**](uiauto-automation-element-propids.md).                                                                                                                                                                                                                                                                                     | Нет                               |
| [**Система состояний, \_ \_ только для чтения**](object-state-constants.md)               | [**UIA \_ Ранжевалуеисреадонлипропертид**](uiauto-control-pattern-propids.md) и [**UIA \_ валуеисреадонлипропертид**](uiauto-control-pattern-propids.md).                                                                                                                                                         | Нет                               |
| [**\_Выбор системы \_ состояния**](object-state-constants.md)           | [**UIA \_ Исселектионитемпаттернаваилаблепропертид**](uiauto-control-pattern-availability-propids.md) .                                                                                                                                                                                                                                | Нет                               |
| [**\_ \_ выбранная система состояний**](object-state-constants.md)               | [**UIA \_ Селектионитемисселектедпропертид**](uiauto-control-pattern-propids.md).                                                                                                                                                                                                                                                              | Нет                               |
| [**\_немалым системы \_ состояний**](object-state-constants.md)               | [**UIA \_ Трансформканресизепропертид**](uiauto-control-pattern-propids.md).                                                                                                                                                                                                                                                                        | Нет                               |
| [**\_Система состояний \_ недоступна**](object-state-constants.md)         | [**UIA \_ Исенабледпропертид**](uiauto-automation-element-propids.md).                                                                                                                                                                                                                                                                                       | Д                               |



 

Полный список идентификаторов свойств см. в разделе [идентификаторы свойств](uiauto-entry-propids.md).

## <a name="events"></a>События

в отличие от Microsoft Active Accessibility, механизм событий в модели автоматизации пользовательского интерфейса не зависит от Windows маршрутизации событий, которая тесно связана с дескрипторами окон и не требует от клиентского приложения настройки обработчиков. Подписки на события можно настроить для определенных частей дерева, а не только для конкретных событий. Поставщики также могут выполнять тонкую настройку событий, отслеживая события, для которых выполняется прослушивание.

Клиенты также легче извлекать элементы, вызывающие события, поскольку они передаются непосредственно в обратный вызов события. Свойства элемента выдаются автоматически, если был указан запрос кэша, когда клиент подписался на событие.

В следующей таблице показано соответствие [констант событий](event-constants.md) Microsoft Active Accessibility и идентификаторов событий автоматизации пользовательского интерфейса.



| WinEvent                                                                                   | Идентификатор события модели автоматизации пользовательского интерфейса                                                                                                                                                                                                                                                                                              |
|--------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**\_акцелераторчанже объекта \_ события**](event-constants.md) | [**UIA \_**](uiauto-automation-element-propids.md) Изменение свойства акцелераторкэйпропертид.                                                                                                                                                                                            |
| [**\_контентскроллед объекта \_ события**](event-constants.md)     | [**UIA \_**](uiauto-control-pattern-propids.md) Изменение свойства скроллвертикалскроллперцентпропертид или [**UIA \_ скроллхоризонталскроллперцентпропертид**](uiauto-control-pattern-propids.md) на связанных полосах прокрутки. |
| [**\_Создание объекта \_ события**](event-constants.md)                       | [**UIA \_ Структуречанжедевентид**](uiauto-event-ids.md).                                                                                                                                                                                                                               |
| [**\_дефактиончанже объекта \_ события**](event-constants.md)     | Эквивалент отсутствует.                                                                                                                                                                                                                                                                                                      |
| [**\_дескриптиончанже объекта \_ события**](event-constants.md) | Нет точного эквивалента; возможно, изменение свойства [**UIA \_ Хелптекстпропертид**](uiauto-automation-element-propids.md) или [**UIA \_ локализедконтролтипепропертид**](uiauto-automation-element-propids.md) .                                                    |
| [**\_ \_ уничтожение объекта события**](event-constants.md)                     | [**UIA \_ Структуречанжедевентид**](uiauto-event-ids.md).                                                                                                                                                                                                                               |
| [**\_фокус объекта \_ события**](event-constants.md)                         | [**UIA \_ Аутоматионфокусчанжедевентид**](uiauto-event-ids.md).                                                                                                                                                                                                                   |
| [**\_хелпчанже объекта \_ события**](event-constants.md)               | [**UIA \_ Изменение Хелптекстпропертид**](uiauto-automation-element-propids.md) .                                                                                                                                                                                                                 |
| [**\_Скрыть объект \_ события**](event-constants.md)                           | [**UIA \_ Структуречанжедевентид**](uiauto-event-ids.md).                                                                                                                                                                                                                               |
| [**\_локатиончанже объекта \_ события**](event-constants.md)       | [**UIA \_**](uiauto-automation-element-propids.md) Изменение свойства баундингректанглепропертид.                                                                                                                                                                                      |
| [**\_NAMECHANGE объекта \_ события**](event-constants.md)               | [**UIA \_**](uiauto-automation-element-propids.md) Изменение свойства намепропертид.                                                                                                                                                                                                                |
| [**\_парентчанже объекта \_ события**](event-constants.md)           | [**UIA \_ Структуречанжедевентид**](uiauto-event-ids.md).                                                                                                                                                                                                                               |
| [**\_ \_ изменение порядка объектов событий**](event-constants.md)                     | Не всегда используется в Microsoft Active Accessibility. Непосредственно соответствующее событие не определено в модели автоматизации пользовательского интерфейса.                                                                                                                                                                                               |
| [**\_Выбор объектов \_ событий**](event-constants.md)                 | [**UIA \_ SelectionItem \_ елементселектедевентид**](uiauto-event-ids.md).                                                                                                                                                                                                    |
| [**\_селектионадд объекта \_ события**](event-constants.md)           | [**UIA \_ SelectionItem \_ елементаддедтоселектионевентид**](uiauto-event-ids.md).                                                                                                                                                                                    |
| [**\_селектионремове объекта \_ события**](event-constants.md)     | [**UIA \_ SelectionItem \_ елементремоведфромселектионевентид**](uiauto-event-ids.md).                                                                                                                                                                            |
| [**\_селектионвисин объекта \_ события**](event-constants.md)     | Эквивалент отсутствует.                                                                                                                                                                                                                                                                                                      |
| [**\_Отображение объекта \_ события**](event-constants.md)                           | [**UIA \_ Структуречанжедевентид**](uiauto-event-ids.md).                                                                                                                                                                                                                               |
| [**\_STATECHANGE объекта \_ события**](event-constants.md)             | Различные события изменения свойств.                                                                                                                                                                                                                                                                                    |
| [**\_валуечанже объекта \_ события**](event-constants.md)             | [**UIA \_ Изменены Ранжевалуевалуепропертид**](uiauto-control-pattern-propids.md) и [**UIA \_ валуевалуепропертид**](uiauto-control-pattern-propids.md) .                                                                                                    |
| [**\_системное \_ оповещение о событиях**](event-constants.md)                         | Эквивалент отсутствует.                                                                                                                                                                                                                                                                                                      |
| [**\_каптуринд системы \_ событий**](event-constants.md)               | Эквивалент отсутствует.                                                                                                                                                                                                                                                                                                      |
| [**\_каптурестарт системы \_ событий**](event-constants.md)           | Эквивалент отсутствует.                                                                                                                                                                                                                                                                                                      |
| [**\_контексселпенд системы \_ событий**](event-constants.md)       | Эквивалент отсутствует.                                                                                                                                                                                                                                                                                                      |
| [**\_контексселпстарт системы \_ событий**](event-constants.md)   | Эквивалент отсутствует.                                                                                                                                                                                                                                                                                                      |
| [**\_диаложенд системы \_ событий**](event-constants.md)                 | [**UIA \_ Окно \_ виндовклоседевентид**](uiauto-event-ids.md).                                                                                                                                                                                                                        |
| [**\_диалогстарт системы \_ событий**](event-constants.md)             | [**UIA \_ Окно \_ виндовопенедевентид**](uiauto-event-ids.md).                                                                                                                                                                                                                        |
| [**\_драгдропенд системы \_ событий**](event-constants.md)             | Эквивалент отсутствует.                                                                                                                                                                                                                                                                                                      |
| [**\_драгдропстарт системы \_ событий**](event-constants.md)         | Эквивалент отсутствует.                                                                                                                                                                                                                                                                                                      |
| [**\_ \_ передний план системы событий**](event-constants.md)               | [**UIA \_ Аутоматионфокусчанжедевентид**](uiauto-event-ids.md).                                                                                                                                                                                                                   |
| [**\_менуенд системы \_ событий**](event-constants.md)                     | [**UIA \_ Менумодиндевентид**](uiauto-event-ids.md).                                                                                                                                                                                                                                         |
| [**\_менупопупенд системы \_ событий**](event-constants.md)           | [**UIA \_ Менуклоседевентид**](uiauto-event-ids.md).                                                                                                                                                                                                                                           |
| [**\_менупопупстарт системы \_ событий**](event-constants.md)       | [**UIA \_ Менуопенедевентид**](uiauto-event-ids.md).                                                                                                                                                                                                                                           |
| [**\_менустарт системы \_ событий**](event-constants.md)                 | [**UIA \_ Менумодестартевентид**](uiauto-event-ids.md).                                                                                                                                                                                                                                     |
| [**\_минимизинд системы \_ событий**](event-constants.md)             | [**UIA \_**](uiauto-control-pattern-propids.md) Изменение свойства виндоввиндоввисуалстатепропертид.                                                                                                                                                                             |
| [**\_минимизестарт системы \_ событий**](event-constants.md)         | [**UIA \_**](uiauto-control-pattern-propids.md) Изменение свойства виндоввиндоввисуалстатепропертид.                                                                                                                                                                             |
| [**\_мовесизинд системы \_ событий**](event-constants.md)             | [**UIA \_**](uiauto-automation-element-propids.md) Изменение свойства баундингректанглепропертид.                                                                                                                                                                                      |
| [**\_мовесизестарт системы \_ событий**](event-constants.md)         | [**UIA \_**](uiauto-automation-element-propids.md) Изменение свойства баундингректанглепропертид.                                                                                                                                                                                      |
| [**\_скроллинженд системы \_ событий**](event-constants.md)           | [**UIA \_**](uiauto-control-pattern-propids.md) Изменение свойства скроллвертикалскроллперцентпропертид или [**UIA \_ скроллхоризонталскроллперцентпропертид**](uiauto-control-pattern-propids.md) .                               |
| [**\_скроллингстарт системы \_ событий**](event-constants.md)       | [**UIA \_**](uiauto-control-pattern-propids.md) Изменение свойства скроллвертикалскроллперцентпропертид или [**UIA \_ скроллхоризонталскроллперцентпропертид**](uiauto-control-pattern-propids.md) .                               |
| [**\_системный \_ звук события**](event-constants.md)                         | Эквивалент отсутствует.                                                                                                                                                                                                                                                                                                      |
| [**\_свитченд системы \_ событий**](event-constants.md)                 | Нет эквивалента, но событие [**UIA \_ аутоматионфокусчанжедевентид**](uiauto-event-ids.md) сигнализирует, что новое приложение получило фокус.                                                                                                                                  |
| [**\_свитчстарт системы \_ событий**](event-constants.md)             | Эквивалент отсутствует.                                                                                                                                                                                                                                                                                                      |
| Эквивалент отсутствует.                                                                             | [**UIA \_**](uiauto-control-pattern-propids.md) Изменение свойства мултиплевиевкуррентвиевпропертид.                                                                                                                                                                             |
| Эквивалент отсутствует.                                                                             | [**UIA \_**](uiauto-control-pattern-propids.md) Изменение свойства скроллхоризонталлискроллаблепропертид.                                                                                                                                                                   |
| Эквивалент отсутствует.                                                                             | [**UIA \_**](uiauto-control-pattern-propids.md) Изменение свойства скроллвертикаллискроллаблепропертид.                                                                                                                                                                       |
| Эквивалент отсутствует.                                                                             | [**UIA \_**](uiauto-control-pattern-propids.md) Изменение свойства скроллхоризонталскроллперцентпропертид.                                                                                                                                                                 |
| Эквивалент отсутствует.                                                                             | [**UIA \_**](uiauto-control-pattern-propids.md) Изменение свойства скроллвертикалскроллперцентпропертид.                                                                                                                                                                     |
| Эквивалент отсутствует.                                                                             | [**UIA \_**](uiauto-control-pattern-propids.md) Изменение свойства скроллхоризонталвиевсизепропертид.                                                                                                                                                                           |
| Эквивалент отсутствует.                                                                             | [**UIA \_**](uiauto-control-pattern-propids.md) Изменение свойства скроллвертикалвиевсизепропертид.                                                                                                                                                                               |
| Эквивалент отсутствует.                                                                             | [**UIA \_**](uiauto-control-pattern-propids.md) Изменение свойства тогглетогглестатепропертид.                                                                                                                                                                                         |
| Эквивалент отсутствует.                                                                             | [**UIA \_**](uiauto-control-pattern-propids.md) Изменение свойства виндоввиндоввисуалстатепропертид                                                                                                                                                                              |
| Эквивалент отсутствует.                                                                             | [**UIA \_ Событие Асинкконтентлоадедевентид**](uiauto-event-ids.md) .                                                                                                                                                                                                                     |
| Эквивалент отсутствует.                                                                             | [**UIA \_ Событие Тултипопенедевентид**](uiauto-event-ids.md) .                                                                                                                                                                                                                               |



 

## <a name="accessing-active-accessibility-properties-and-objects-from-ui-automation"></a>Доступ к свойствам и объектам Active Accessibility из модели автоматизации пользовательского интерфейса

Ключевой функцией модели автоматизации пользовательского интерфейса, недоступной в Microsoft Active Accessibility, является возможность выборки нескольких свойств с одной операцией между процессами.

Существующие клиенты Microsoft Active Accessibility могут воспользоваться этой возможностью с помощью интерфейса [**иуиаутоматионлегацииакцессиблепаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationlegacyiaccessiblepattern) . Этот интерфейс представляет *шаблон элемента управления* , предоставляющий свойства и методы Microsoft Active Accessibility в элементах пользовательского интерфейса. При извлечении элементов приложение может запросить кэширование этого шаблона элемента управления и его свойств.

[**Иуиаутоматионлегацииакцессиблепаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationlegacyiaccessiblepattern) также позволяет клиентам получать свойства Active Accessibility Майкрософт из элементов, которые не имеют собственной поддержки [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible).

Изменения в свойствах [**иуиаутоматионлегацииакцессиблепаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationlegacyiaccessiblepattern) не вызывают события модели автоматизации пользовательского интерфейса.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Добавление функций автоматизации пользовательского интерфейса на серверы Active Accessibility](uiauto-usingiaccessibleex.md)
</dt> <dt>

[Общие сведения о дереве модели автоматизации пользовательского интерфейса](uiauto-treeoverview.md)
</dt> <dt>

[Общие сведения о свойствах автоматизированного пользовательского интерфейса](uiauto-propertiesoverview.md)
</dt> <dt>

[Общие сведения о типах элементов управления автоматизации пользовательского интерфейса](uiauto-controltypesoverview.md)
</dt> <dt>

[Обзор событий автоматизации пользовательского интерфейса](uiauto-eventsoverview.md)
</dt> <dt>

[Microsoft Active Accessibility](microsoft-active-accessibility.md)
</dt> </dl>

 

 
