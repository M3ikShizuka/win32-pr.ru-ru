---
title: Спецификация модели автоматизации пользовательского интерфейса
description: в этом разделе содержится обзор спецификации автоматизации пользовательского интерфейса майкрософт, которая образует базу Windows реализации автоматизации пользовательского интерфейса.
ms.assetid: 45160767-09b0-4fd1-bd73-bc5ac0e6f75e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0fc07b70128a401d48813ded68c31dfcfca5bb5a49d2ca46683e9a902af003ad
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118325104"
---
# <a name="ui-automation-specification"></a>Спецификация модели автоматизации пользовательского интерфейса

в этом разделе содержится обзор спецификации автоматизации пользовательского интерфейса майкрософт, которая образует базу Windows реализации автоматизации пользовательского интерфейса. Спецификация модели автоматизации пользовательского интерфейса может поддерживаться на разных платформах, кроме Microsoft Windows. Дополнительные сведения см. в разделе [Спецификация модели автоматизации пользовательского интерфейса](./uiauto-specandcommunitypromise.md) .

Этот раздел состоит из следующих подразделов.

-   [интродуктон](#introducton)
-   [Элементы модели автоматизации пользовательского интерфейса](#ui-automation-elements)
-   [Дерево модели автоматизации пользовательского интерфейса](#ui-automation-tree)
-   [Свойства модели автоматизации пользовательского интерфейса](#ui-automation-properties)
-   [Шаблоны модели автоматизации пользовательского интерфейса](#ui-automation-control-patterns)
-   [Типы элементов управления автоматизации пользовательского интерфейса](#ui-automation-control-types)
-   [События модели автоматизации пользовательского интерфейса](#ui-automation-events)
-   [Связанные темы](#related-topics)

## <a name="introducton"></a>интродуктон

спецификация автоматизации пользовательского интерфейса предоставляет гибкий программный доступ к элементам пользовательского интерфейса на рабочем столе Windows, позволяя программным продуктам, таким как средства чтения с экрана, предоставлять сведения о пользовательском интерфейсе пользователям и управлять пользовательским интерфейсом средствами, отличными от стандартных входных данных.

Модель автоматизации пользовательского интерфейса является более широкой областью, чем просто определение интерфейса. Консоль предоставляет следующие возможности:

-   Объектная модель и функции, которые упрощают клиентские приложения для получения событий, извлечения значений свойств и управления элементами пользовательского интерфейса.
-   Базовая инфраструктура для поиска и выборки через границы процесса.
-   Набор интерфейсов для поставщиков для выражения древовидной структуры, общих свойств и функциональных возможностей элементов пользовательского интерфейса.
-   Свойство "тип элемента управления", которое позволяет клиентам и поставщикам четко указывать общие свойства, функциональность и структуру объекта пользовательского интерфейса.

Модель автоматизации пользовательского интерфейса на Active Accessibility Майкрософт улучшает:

-   Включение эффективных необработанных клиентов, продолжая разрешать внутрипроцессный доступ.
-   Предоставление дополнительных сведений о пользовательском интерфейсе таким образом, чтобы клиенты были вне процесса.
-   Вместе с Active Accessibility Майкрософт, не наследуя ограничения. Дополнительные сведения см. в разделе [Сравнение Microsoft Active Accessibility и модели автоматизации пользовательского интерфейса](microsoft-active-accessibility-and-ui-automation-compared.md).
-   Предоставление альтернативы для [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) , который прост в реализации.

реализация спецификации модели автоматизации пользовательского интерфейса в Windows возможностях интерфейсов на основе модели объектов (COM) и управляемых интерфейсов.

## <a name="ui-automation-elements"></a>Элементы модели автоматизации пользовательского интерфейса

Модель автоматизации пользовательского интерфейса предоставляет каждому элементу пользовательского интерфейса доступ к клиентским приложениям в качестве *элемента автоматизации*. Поставщики предоставляют значения свойств для каждого элемента. Элементы представлены в виде древовидной структуры с рабочим столом в качестве корневого элемента.

Элементы автоматизации предоставляют общие свойства элементов пользовательского интерфейса, которые они представляют. Одним из этих свойств является тип элемента управления, описывающий его базовый вид и функциональность (например, кнопку или флажок).

## <a name="ui-automation-tree"></a>Дерево модели автоматизации пользовательского интерфейса

Дерево модели автоматизации пользовательского интерфейса представляет весь пользовательский интерфейс: корневой элемент — это текущий рабочий стол, а дочерние элементы — это окна приложений. Каждый из этих дочерних элементов может содержать элементы, представляющие меню, кнопки, панели инструментов и т. д. Эти элементы, в свою очередь, могут содержать элементы, такие как элементы списка, как показано на следующем рисунке.

![снимок экрана с деревом автоматизации пользовательского интерфейса](images/uiatree.gif)

Имейте в виду, что порядок одноуровневых элементов в дереве модели автоматизации пользовательского интерфейса весьма важен. Объекты, расположенные рядом друг с другом, также должны находиться рядом друг с другом в дереве модели автоматизации пользовательского интерфейса.

Поставщики автоматизации пользовательского интерфейса для определенного элемента управления поддерживают навигацию между дочерними элементами этого элемента управления. Однако поставщики не связаны с навигацией между поддеревьями элементов управления. Это управляется ядром автоматизации пользовательского интерфейса с использованием сведений из поставщиков окон по умолчанию.

Чтобы помочь клиентам более эффективно обрабатывать сведения о пользовательском интерфейсе, платформа поддерживает альтернативные представления дерева автоматизации: представление RAW, представление элемента управления и представление содержимого. Как показано в следующей таблице, тип фильтрации определяет представления, а клиент определяет область представления.



| Дерево автоматизации | Описание                                                                                                             |
|-----------------|-------------------------------------------------------------------------------------------------------------------------|
| Базовое представление        | Полное дерево объектов элементов автоматизации, для которых рабочий стол является корнем.                                          |
| Представление элемента управления    | Подмножество представления RAW, которое тесно сопоставляется с структурой пользовательского интерфейса по мере того, как пользователь воспринимает его.                                |
| Представление содержимого    | Подмножество представления элемента управления, которое содержит содержимое, наиболее соответствующее пользователю, например значения в раскрывающемся поле со списком. |



 

Дополнительные сведения см. в разделе [Общие сведения о дереве автоматизации пользовательского интерфейса](uiauto-treeoverview.md).

## <a name="ui-automation-properties"></a>Свойства модели автоматизации пользовательского интерфейса

Спецификация модели автоматизации пользовательского интерфейса определяет два типа свойств: свойства элементов автоматизации и свойства шаблона элемента управления. Свойства элементов автоматизации применяются к большинству элементов управления, предоставляя фундаментальные сведения об элементе, например его имя. Свойства шаблона элемента управления применяются к шаблонам элементов управления, которые описаны далее.

В отличие от Microsoft Active Accessibility, каждое свойство модели автоматизации пользовательского интерфейса определяется по идентификатору GUID и программному имени, что упрощает ввод новых свойств.

Дополнительные сведения см. в разделе [UI Automation Properties Overview](uiauto-propertiesoverview.md).

## <a name="ui-automation-control-patterns"></a>Шаблоны модели автоматизации пользовательского интерфейса

Шаблон элемента управления описывает определенный аспект функциональных возможностей элемента автоматизации. Например, простой элемент управления "нажатие кнопки", такой как кнопка или гиперссылка, должен поддерживать шаблон элемента управления Invoke для представления действия "щелчок".

Каждый шаблон элемента управления является каноническим представлением возможных функций и функций пользовательского интерфейса. Текущая реализация модели автоматизации пользовательского интерфейса определяет 22 шаблона элементов управления. API-интерфейс автоматизации Windows также может поддерживать пользовательские шаблоны элементов управления. В отличие от свойств роли или состояния Microsoft Active Accessibility, один элемент автоматизации может поддерживать несколько шаблонов элементов управления модели автоматизации пользовательского интерфейса.

Для получения дополнительной информации см. [UI Automation Control Patterns Overview](uiauto-controlpatternsoverview.md).

## <a name="ui-automation-control-types"></a>Типы элементов управления автоматизации пользовательского интерфейса

Тип элемента управления — это свойство элемента автоматизации, которое указывает хорошо известный элемент управления, представляемый элементом. В настоящее время модель автоматизации пользовательского интерфейса определяет типы элементов управления 38, включая кнопку, флажок, ComboBox, DataGrid, документ, гиперссылку, изображение, подсказку, дерево и окно.

Прежде чем можно будет присвоить элементу тип элемента управления, элемент должен удовлетворять определенным условиям, включая определенную древовидную структуру автоматизации, значения свойств, шаблоны элементов управления и события. Однако это не ограничено. Можно расширить элемент управления с помощью пользовательских шаблонов и свойств, а также с предопределенными элементами.

Общее число стандартных типов элементов управления значительно ниже, чем [роли объектов](object-roles.md)Майкрософт Active Accessibility, так как типы элементов управления модели автоматизации пользовательского интерфейса можно объединять для выражения большего набора функций, в то время как роли Майкрософт Active Accessibility не могут.

Для получения дополнительной информации см. [UI Automation Control Types Overview](uiauto-controltypesoverview.md).

## <a name="ui-automation-events"></a>События модели автоматизации пользовательского интерфейса

События модели автоматизации пользовательского интерфейса уведомляют приложения об изменениях и действиях, выполняемых с элементами автоматизации. Существует четыре различных типа событий автоматизации пользовательского интерфейса, которые не обязательно означают, что визуальное состояние пользовательского интерфейса изменилось. модель событий модели автоматизации пользовательского интерфейса не зависит от платформы [WinEvent](winevents-infrastructure.md) в Windows, хотя API-интерфейс автоматизации Windows делает события автоматизации пользовательского интерфейса взаимодействующими с Microsoft Active Accessibility framework.

Для получения дополнительной информации см. [UI Automation Events Overview](uiauto-eventsoverview.md).

## <a name="related-topics"></a>Связанные темы

[спецификация модели автоматизации пользовательского интерфейса](./uiauto-specandcommunitypromise.md), [обзор API-интерфейса Windows automation](windows-automation-api-overview.md)