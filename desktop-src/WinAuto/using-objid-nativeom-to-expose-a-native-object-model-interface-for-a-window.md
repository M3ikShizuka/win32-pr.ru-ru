---
title: Использование OBJID \_ нативеом для предоставления собственного интерфейса для окна
description: Этот метод позволяет клиентам получить пользовательский объект для окна. Серверы могут использовать его для предоставления указателя на пользовательский объект документа для окна.
ms.assetid: 91713fe5-f03f-464e-88ee-9d8d66d5b19d
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6c2c5c6ec194ca643475444feb5839c02d3fa890
ms.sourcegitcommit: 2e9db3c7d9a3dbea15196b03c883846fad6f32be
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/12/2019
ms.locfileid: "104412110"
---
# <a name="use-objid_nativeom-to-expose-a-native-interface-for-a-window"></a>Использование OBJID \_ нативеом для предоставления собственного интерфейса для окна

Этот метод позволяет клиентам получить пользовательский объект для окна. Серверы могут использовать его для предоставления указателя на пользовательский объект документа для окна.

**Предоставление собственного интерфейса объектной модели для окна (серверы)**

1.  Обработайте сообщение [**WM \_ GetObject**](wm-getobject.md) в процедуре окна. Если значение *lParam* — [**OBJID \_ нативеом**](object-identifiers.md), то возвращается указатель интерфейса на пользовательский объект с помощью [**функции lresultfromobject**](/windows/desktop/api/Oleacc/nf-oleacc-lresultfromobject).
2.  При необходимости освободите указатель интерфейса после вызова [**функции lresultfromobject**](/windows/desktop/api/Oleacc/nf-oleacc-lresultfromobject). Дополнительные сведения см. в разделе **функции lresultfromobject**.

Клиенты могут получить указатель на этот пользовательский объект.

**Получение указателя на пользовательский объект для окна (клиенты)**

-   Вызовите [**акцессиблеобжектфромвиндов**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow) и передайте [**OBJID \_ нативеом**](object-identifiers.md) в качестве второго параметра.

Обратите внимание на следующие вопросы для этого метода:

-   Этот метод аналогичен возврату указателя интерфейса [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) , за исключением того, что используется идентификатор объекта, и тот факт, что [**функции lresultfromobject**](/windows/desktop/api/Oleacc/nf-oleacc-lresultfromobject) возвращает пользовательский объект, а не **IAccessible**.
-   Разработчикам сервера может потребоваться опубликовать сведения, позволяющие клиентам уникальным образом определить **HWND** , чтобы они могли найти его перед вызовом [**акцессиблеобжектфромвиндов**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow) в дескрипторе окна.
-   Не реализуйте интерфейс [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) для возвращаемого пользовательского объекта. Если сделать это, ОЛЕАКК будет рассматривать его как стандартный **IAccessible** и может препятствовать использованию пользовательских интерфейсов.
-   Для использования в разных процессах необходимо зарегистрировать интерфейсы в возвращенном объекте с помощью модели COM.

Этот метод поддерживается несколькими компонентами Microsoft Office. Дополнительные сведения см. в разделе [**акцессиблеобжектфромвиндов**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow).

 

 




