---
title: Общие сведения о модели автоматизации пользовательского интерфейса
description: Автоматизация пользовательского интерфейса Майкрософт — это платформа специальных возможностей для Windows.
ms.assetid: 99610542-761c-432d-a4ac-4cd3812577a8
keywords:
- Автоматизация пользовательского интерфейса, сведения
- Модель автоматизации пользовательского интерфейса, Специальные возможности
- Модель автоматизации пользовательского интерфейса, компоненты
- Модель автоматизации пользовательского интерфейса, API поставщика
- Модель автоматизации пользовательского интерфейса, клиентский API
- Автоматизация пользовательского интерфейса, файлы заголовков
- Автоматизация пользовательского интерфейса, модель
- components
- специальные возможности
- API поставщика
- API клиента
- заголовочные файлы
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3664866280d570f9fa5f07acc6245ca2b4c1bff7
ms.sourcegitcommit: 9b5faa61c38b2d0c432b7f2dbee8c127b0e28a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2021
ms.locfileid: "122470061"
---
# <a name="ui-automation-overview"></a>Общие сведения о модели автоматизации пользовательского интерфейса

Автоматизация пользовательского интерфейса Майкрософт — это платформа специальных возможностей для Windows. Он обеспечивает программный доступ к большинству элементов пользовательского интерфейса на рабочем столе. Она позволяет продуктам с поддержкой специальных возможностей, таким как средства чтения с экрана, предоставлять сведения о пользовательском интерфейсе конечным пользователям и управлять пользовательским интерфейсом средствами, отличными от стандартных входных данных. Модель автоматизации пользовательского интерфейса также позволяет скриптам автоматических тестов взаимодействовать с пользовательским интерфейсом.

модель автоматизации пользовательского интерфейса впервые была доступна в Windows XP в составе платформа .NET Framework майкрософт. Хотя в этот момент также опубликован неуправляемый API C++, полезность функций клиента была ограничена из-за проблем совместимости. для Windows 7 API был переписан в объектной модели Component (COM).

> [!Note]  
> Хотя функции библиотеки, представленные в предыдущей версии модели автоматизации пользовательского интерфейса, по-прежнему документированы, их не следует использовать в новых приложениях.

 

клиентские приложения модели автоматизации пользовательского интерфейса могут быть написаны с гарантией того, что они будут работать на нескольких платформах управления Microsoft Windows. Ядро автоматизации пользовательского интерфейса маскирует все различия в платформах, которые лежат в основе различных частей пользовательского интерфейса. например, свойство **содержимого** кнопки Windows Presentation Foundation (WPF), свойство **Caption** кнопки Microsoft Win32 и свойство **ALT** изображения HTML сопоставлены с одним свойством, **именем** в представлении модели автоматизации пользовательского интерфейса.

модель автоматизации пользовательского интерфейса обеспечивает полную функциональность Windows XP, Windows Server 2003 и более поздних операционных систем.

Поставщики автоматизации пользовательского интерфейса — это компоненты, реализующие поддержку автоматизации пользовательского интерфейса для элементов управления и предлагающие некоторую поддержку клиентских приложений Microsoft Active Accessibility через встроенную службу моста.

> [!Note]  
> Модель автоматизации пользовательского интерфейса не обеспечивает обмен данными между процессами, запущенными разными пользователями, с помощью команды **запуска от имени** .

 

В этом разделе содержатся следующие подразделы.

-   [Компоненты модели автоматизации пользовательского интерфейса](#ui-automation-components)
-   [Файлы заголовков модели автоматизации пользовательского интерфейса](#ui-automation-header-files)
-   [Модель автоматизации пользовательского интерфейса](#ui-automation-model)
-   [Связанные темы](#related-topics)

## <a name="ui-automation-components"></a>Компоненты модели автоматизации пользовательского интерфейса

Модель автоматизации пользовательского интерфейса состоит из четырех основных компонентов, как показано в следующей таблице.




| Компонент | Описание | 
|-----------|-------------|
| API поставщика | Набор COM-интерфейсов, реализованных поставщиками автоматизации пользовательского интерфейса. Поставщики автоматизации пользовательского интерфейса — это объекты, предоставляющие сведения об элементах пользовательского интерфейса и реагирующие на программный ввод. | 
| API клиента | Набор COM-интерфейсов, которые позволяют клиентским приложениям получать сведения о пользовательском интерфейсе и передавать входные данные в элементы управления.<blockquote>[!Note]<br />Функции, описанные в нерекомендуемых <a href="uiauto-entry-cpfunctions.md">функциях шаблона элемента управления</a> и <a href="uiauto-entry-uianodefunctions.md">устаревших функциях узла</a> , являются устаревшими. Вместо этого клиентские приложения должны использовать интерфейсы COM модели автоматизации пользовательского интерфейса, описанные в <a href="uiauto-entry-uiautoclientinterfaces.md">интерфейсах элементов модели автоматизации пользовательского интерфейса для клиентов</a>.</blockquote><br /> | 
| UIAutomationCore.dll | Библиотека времени выполнения, которая иногда называется ядром автоматизации пользовательского интерфейса, которая управляет взаимодействием между поставщиками и клиентами. | 
| Oleacc.dll | Библиотека времени выполнения для Microsoft Active Accessibility и прокси-объектов. Библиотека также предоставляет прокси-объекты, используемые Microsoft Active Accessibility для прокси-сервера автоматизации пользовательского интерфейса для поддержки элементов управления Win32. | 




 

Существует два способа использования модели автоматизации пользовательского интерфейса: для создания поддержки пользовательских элементов управления с помощью API поставщика, а также для создания клиентских приложений, использующих ядро автоматизации пользовательского интерфейса для взаимодействия с, и получения сведений о элементах пользовательского интерфейса. В зависимости от ключевых целей вы должны обращаться к разным частям документации. Сведения о создании поддержки пользовательских элементов управления см. в разделе [руководств программиста по поставщику автоматизации пользовательского интерфейса](uiauto-providerportal.md). Если необходимо связаться со сведениями о элементах пользовательского интерфейса или получить информацию о них, см. статью в разделе [руководств по программированию клиента автоматизации пользовательского интерфейса](uiauto-clientportal.md).

## <a name="ui-automation-header-files"></a>Файлы заголовков модели автоматизации пользовательского интерфейса

интерфейс API модели автоматизации пользовательского интерфейса определен в нескольких разных файлах заголовков C/C++, которые входят в состав пакета SDK для Windows. Файлы заголовков модели автоматизации пользовательского интерфейса описаны в следующей таблице.



| Файл заголовка           | Описание                                                                                                                                                                                                                                                                      |
|-----------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| UIAutomationClient. h  | Определяет интерфейсы и связанные элементы программирования, используемые клиентами автоматизации пользовательского интерфейса.                                                                                                                                                                                           |
| Уиаутоматионкоре. h    | Определяет интерфейсы и связанные элементы программирования, используемые поставщиками автоматизации пользовательского интерфейса.                                                                                                                                                                                         |
| Уиаутоматионкореапи. h | Определяет общие константы, идентификаторы GUID, типы данных и структуры, используемые клиентами и поставщиками модели автоматизации пользовательского интерфейса. Он также содержит определения для устаревших функций узла и шаблона элемента управления.                                                                                    |
| UIAutomation. h        | Включает все остальные файлы заголовков модели автоматизации пользовательского интерфейса. Так как большинству приложений автоматизации пользовательского интерфейса требуются элементы из всех файлов заголовков модели автоматизации пользовательского интерфейса, лучше всего включить UIAutomation. h в проекты приложения автоматизации пользовательского интерфейса, а не включать каждый файл по отдельности. |



 

При разработке приложения, использующего API автоматизации пользовательского интерфейса, необходимо включить UIAutomation. h в проект. Если приложение поддерживает Microsoft Active Accessibility, включите файл заголовка Олеакк. h. Для приложений автоматизации пользовательского интерфейса, использующих идентификаторы GUID, также требуется файл заголовка Инитгуид. h. При необходимости Инитгуид. h должен быть добавлен перед UIAutomation. h.

## <a name="ui-automation-model"></a>Модель автоматизации пользовательского интерфейса

Модель автоматизации пользовательского интерфейса предоставляет каждому элементу пользовательского интерфейса доступ к клиентским приложениям как к объекту, представленному интерфейсом [**иуиаутоматионелемент**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) . Элементы содержатся в древовидной структуре с рабочим столом в качестве корневого элемента. Клиенты могут фильтровать базовое представление дерева как представление элемента управления или представление содержимого. эти стандартные представления структуры можно легко просмотреть с помощью приложения [проверки](inspect-objects.md) , которое входит в состав Windows SDK. Приложения также могут создавать настраиваемые представления.

Элемент модели автоматизации пользовательского интерфейса предоставляет свойства элемента управления или элемента пользовательского интерфейса, который он представляет. Одним из этих свойств является тип элемента управления, который определяет базовый внешний вид и функциональность элемента управления или элемента пользовательского интерфейса в виде одной распознаваемой сущности, например кнопки или флажка. Дополнительные сведения о типах элементов управления см. в разделе [Общие сведения о типах элементов управления модели автоматизации пользовательского интерфейса](uiauto-controltypesoverview.md).

Кроме того, элемент модели автоматизации пользовательского интерфейса предоставляет один или несколько шаблонов элементов управления. Шаблон элемента управления предоставляет набор свойств, относящихся к конкретному типу элемента управления. Шаблон элемента управления также предоставляет методы, позволяющие клиентским приложениям получать дополнительные сведения об элементе и предоставлять входные данные для элемента. Дополнительные сведения о шаблонах элементов управления см. в разделе [UI Automation Control Patterns Overview](uiauto-controlpatternsoverview.md).

> [!Note]  
> Между типами элементов управления и шаблонами элементов управления нет соответствия "один к одному". Шаблон элемента управления может поддерживаться несколькими типами элементов управления, и элемент управления может поддерживать несколько шаблонов элементов управления, каждый из которых представляет различные аспекты его поведения. Например, поле со списком имеет по крайней мере два шаблона элементов управления: один представляет его возможность разворачиваться и сворачиваться, а другой представляет механизм выбора. Однако элемент управления может демонстрировать только один тип элемента управления.

 

Модель автоматизации пользовательского интерфейса предоставляет сведения клиентским приложениям с помощью событий. В отличие от Виневентс, события модели автоматизации пользовательского интерфейса не основаны на механизме вещания. Клиенты автоматизации пользовательского интерфейса регистрируются для конкретных уведомлений о событиях и могут запрашивать, чтобы определенные свойства и данные шаблона элемента управления передавались в свои обработчики событий. Кроме того, событие модели автоматизации пользовательского интерфейса содержит ссылку на элемент, который его вызвал. Поставщики могут повысить производительность, вызывая события выборочно, в зависимости от того, являются ли клиенты прослушивающими. Дополнительные сведения о событиях см. в разделе [UI Automation Events Overview](uiauto-eventsoverview.md).

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

**Зрения**
</dt> <dt>

[Общие сведения о типах элементов управления автоматизации пользовательского интерфейса](uiauto-controltypesoverview.md)
</dt> <dt>

[Общие сведения о шаблонах элементов управления модели автоматизации пользовательского интерфейса](uiauto-controlpatternsoverview.md)
</dt> <dt>

[Обзор событий автоматизации пользовательского интерфейса](uiauto-eventsoverview.md)
</dt> </dl>

 

 





