---
title: Запрос виртуализированного элемента в представлении "элементы"
description: В этом разделе описывается использование службы автоматизации пользовательского интерфейса Майкрософт для получения сведений о пользовательском интерфейсе для виртуализированных элементов в представлении элементов Windows 7.
ms.assetid: a0bff8a1-47b1-4750-8086-e2e65a79099e
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a098635d6e1045c6ff4573de088d8455685014d3
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104411290"
---
# <a name="how-to-query-a-virtualized-item-in-items-view"></a>Запрос виртуализированного элемента в представлении "элементы"

В этом разделе описывается использование службы автоматизации пользовательского интерфейса Майкрософт для получения сведений о пользовательском интерфейсе для виртуализированных элементов в представлении элементов Windows 7. Этот раздел включает следующие подразделы:

> [!Note]  
> Этот раздел относится только к Windows 7. Имейте в виду, что функции специальных возможностей, описанные в этом разделе, могут измениться в будущих версиях Windows.

 

-   [Обзор](#overview)
-   [Древовидная структура представления элементов](#items-view-tree-structure)
-   [Виртуализация](#virtualization)
-   [Получение количества всех элементов](#obtaining-a-count-of-all-items)
-   [Получение индекса элемента по отношению ко всем элементам](#obtaining-an-item-index-with-respect-to-all-items)
-   [Получение ссылки на элемент Витуализед](#obtaining-a-reference-to-a-vitualized-item)
-   [Прокрутка виртуализированного элемента на экране](#scrolling-a-virtualized-item-on-screen)
-   [См. также](#related-topics)

## <a name="overview"></a>Обзор

Представление "элементы" — это компонент пользовательского интерфейса, который позволяет пользователям просматривать файлы и другие элементы и взаимодействовать с ними. В Windows 7 представление "элементы" заменяет элемент управления "представление списка" для представления элементов в представлении проводника по умолчанию. Представление "элементы" также используется в диалоговом окне общих элементов, в результатах поиска в меню "Пуск" и в других элементах пользовательского интерфейса Windows 7, использующих элемент управления браузера обозревателя. По сравнению с элементом управления "представление списка", для пользователей доступны следующие преимущества:

-   Представление элементов может представлять элементы более полезными, желательными и релевантными, позволяя пользователям быстрее находить и упорядочивать элементы.
-   В представлении "элементы" можно отображать большие наборы элементов из источников данных с разными характеристиками производительности, что позволяет пользователям просматривать всю коллекцию элементов в нескольких источниках и выполнять поиск по ним.

На следующем рисунке показано представление элементы в проводнике Windows.

![снимок экрана, отображающий проводник Windows с компонентом "Просмотр элементов"](images/itemsview.gif)

С точки зрения разработчика общая структура и функциональные возможности представления «элементы» аналогичны элементам управления «список». Основное отличие заключается в том, что представление элементов поддерживает виртуализацию, а элемент управления "представление списка" — нет. Кроме того, в представлении "элементы" используются два новых интерфейса автоматизации пользовательского интерфейса для обеспечения доступности виртуализированного содержимого, предоставленного представлением элементов. Эти интерфейсы описаны в следующих разделах этой статьи.

Общие сведения о виртуализации в модели автоматизации пользовательского интерфейса см. [в разделе Работа с виртуализированными элементами](uiauto-workingwithvirtualizeditems.md).

## <a name="items-view-tree-structure"></a>Древовидная структура представления элементов

В дереве модели автоматизации пользовательского интерфейса элемент автоматизации пользовательского интерфейса верхнего уровня представления Items имеет имя "Итемсвиев" и тип элемента управления "List". На предыдущем рисунке элемент модели автоматизации пользовательского интерфейса Итемсвиев выделено красным цветом. Ниже верхнего уровня Итемсвиев существуют различные элементы автоматизации пользовательского интерфейса, но в этом документе упоминается только два других элемента автоматизации пользовательского интерфейса: элементы группы и элементы списка.

Элементы группы — это элементы модели автоматизации пользовательского интерфейса, которые содержат все элементы группы. их тип элемента управления — Group, и их имена зависят от имени группы. На предыдущем рисунке первый элемент группы содержит заголовок "A-H (1)" и элемент списка "папка", а его имя — "A-H".

Элементы списка являются элементами модели автоматизации пользовательского интерфейса, представляющими конечные элементы в представлении. их тип элемента управления — "ListItem", а их имена различаются в зависимости от имени элемента. На предыдущем рисунке элементы списка являются конечными элементами, такими как "папка", "Музыка" и "Рисунок". Эти три элемента модели автоматизации пользовательского интерфейса называются элементом Итемсвиев, элементом Group и элементом ListItem в оставшейся части этого документа.

## <a name="virtualization"></a>Виртуализация

В представлении "элементы" используется виртуализация, что означает, что элементы за пределами видимой области представления не извлекаться из системы, а представление пользовательского интерфейса не создается. Эти элементы называются *виртуализированными элементами*. Поскольку они не создаются, виртуализированные элементы не имеют элементов автоматизации пользовательского интерфейса и поэтому не отображаются в дереве модели автоматизации ПОЛЬЗОВАТЕЛЬСКОГО интерфейса, когда клиент автоматизации пользовательского интерфейса перечисляет дерево. Кроме того, шаблоны элементов управления модели автоматизации пользовательского интерфейса работают только с видимыми элементами. Например, шаблон элемента управления [Selection](uiauto-implementingselection.md) возвращает только видимые выбранные элементы, когда клиент вызывает метод [**Иуиаутоматионселектионпаттерн:: жеткуррентселектион**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationselectionpattern-getcurrentselection) .

Представление "элементы" поддерживает возможность получения следующих сведений о виртуализированных элементах:

-   Общее число элементов, включая виртуализированные элементы.
-   Элементы модели автоматизации пользовательского интерфейса для виртуализированных элементов
-   Элементы модели автоматизации пользовательского интерфейса для выбранных виртуализированных элементов

## <a name="obtaining-a-count-of-all-items"></a>Получение количества всех элементов

Клиент может использовать элемент Итемсвиев, чтобы получить количество всех элементов, а также количество выбранных элементов. Элемент Итемсвиев предоставляет два способа получения этих счетчиков. Первый заключается в получении свойства Итемстатус элемента Итемсвиев, а второй — при получении пользовательских свойств из элемента Итемсвиев.

Свойство Итемстатус — это строка, указывающая количество общего числа элементов и число выбранных элементов, разделенных запятыми. Например: "3 элемента, выбран 1 элемент". Эта строка локализована и может быть передана непосредственно пользователю.

Пользовательские свойства элемента Итемсвиев включают одно свойство для счетчика элементов, а другое — для счетчика выбора. К ним относятся следующие:

-   \_GUID свойства ItemCount \_ (ABBF5C45-5CCC-47b7-BB4E-87CB87BBD162) — количество всех уникальных элементов в представлении. При группировании по многозначному свойству (MVP), чтобы один элемент мог встречаться несколько раз, каждый элемент учитывается только один раз.

    (Уиаутоматионтипе: [**уиаутоматионтипе \_ int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), программное имя: "ItemCount")

-   \_GUID свойства селектедитемкаунт \_ (92A053DA-2969-4021-BF27-514CFC2E4A69) — количество всех уникальных элементов, выбранных в представлении. При группировании по многозначному свойству (MVP), чтобы один элемент мог встречаться несколько раз, каждый элемент учитывается только один раз.

    (Уиаутоматионтипе: [**уиаутоматионтипе \_ int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), программное имя: "селектедитемкаунт")

Эти пользовательские свойства определяются в Шлгуид. h, который входит в состав пакета средств разработки программного обеспечения (SDK) для Windows, и эти свойства регистрируются с помощью метода [**иуиаутоматионрегистрар:: регистерпроперти**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iuiautomationregistrar-registerproperty) . Клиенты автоматизации пользовательского интерфейса используют **регистерпроперти** для получения идентификаторов свойств (пропертидс) для пользовательских свойств.

## <a name="obtaining-an-item-index-with-respect-to-all-items"></a>Получение индекса элемента по отношению ко всем элементам

Клиент может получить индекс элемента либо путем получения свойства Итемстатус элемента ListItem, либо путем получения пользовательского свойства элемента ListItem.

Свойство Итемстатус — это строка, содержащая индекс элемента по отношению к общему количеству элементов. Например: "элемент 1 из 3". Эта строка локализована и может быть передана непосредственно пользователю.

Следующее пользовательское свойство получает индекс элемента элемента ListItem:

-   \_GUID свойства итеминдекс \_ (92A053DA-2969-4021-BF27-514CFC2E4A69) — абсолютный индекс элемента, основанный на 1. При группировании по многозначному свойству (MVP), чтобы один элемент мог появиться дважды, каждый вид элемента получает отдельный индекс.

    (Уиаутоматионтипе: [**уиаутоматионтипе \_ int**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-uiautomationtype), программное имя: "итеминдекс")

Это пользовательское свойство определено в Шлгуид. h, которое включено в Windows SDK и регистрируется с помощью метода [**иуиаутоматионрегистрар:: регистерпроперти**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-iuiautomationregistrar-registerproperty) . Клиенты автоматизации пользовательского интерфейса используют **регистерпроперти** для получения идентификатора свойства (пропертидс) для настраиваемого свойства.

## <a name="obtaining-a-reference-to-a-vitualized-item"></a>Получение ссылки на элемент Витуализед

Элемент Итемсвиев реализует шаблон элемента управления [ItemContainer](uiauto-implementingitemcontainer.md) (интерфейс [**иитемконтаинерпровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iitemcontainerprovider) ), который позволяет клиенту получить элемент модели автоматизации пользовательского интерфейса для виртуализированного элемента (элемента, находящегося за пределами видимой области). Итемсвиев позволяет клиенту найти элемент ListItem, выполнив поиск по имени и свойствам выбора. попытка поиска по любому другому свойству завершится ошибкой.

Виртуальный элемент реализует только шаблон элемента управления [виртуализедитем](uiauto-implementingvirtualizeditem.md) (интерфейс [**ивиртуализедитемпровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivirtualizeditemprovider) ). Поскольку элемент, представленный виртуализированным элементом автоматизации пользовательского интерфейса, еще не существует, попытка получить любой другой шаблон элемента управления или свойство элемента завершится ошибкой.

Элементы ListItem и Group виртуализированы, но только элементы ListItem могут возвращаться из шаблона элемента управления [ItemContainer](uiauto-implementingitemcontainer.md) . Поскольку вызов метода [**иуиаутоматионитемконтаинерпаттерн:: финдитембипроперти**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) выполняется в ПОТОКЕ пользовательского интерфейса и блокируется, представление не будет отвечать, пока **финдитембипроперти** не вернет, а все другие вызовы метода в поставщике должны дождаться завершения **финдитембипроперти** . В некоторых случаях **финдитембипроперти** должен обработать весь набор данных перед возвратом, что может потребовать много ресурсов. Указание **значения NULL** в качестве начального элемента приводит к тому, что **финдитембипроперти** начинает поиск с первого элемента в представлении.

Итемсвиев поддерживает следующие свойства для [**финдитембипроперти**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty):

-   Name (UIA \_ намепропертид) — поиск первого элемента, имя которого полностью совпадает с указанной строкой. Поиск не учитывает регистр символов. Подстановочные знаки или частичное совпадение не поддерживаются. Если указано имя **null** , возвращается следующий элемент после начального элемента. Указание имен **null** позволяет клиенту автоматизации пользовательского интерфейса перечислять все элементы в представлении; Однако не рекомендуется перечислить все элементы, так как это приводит к реализации всех элементов в представлении.
-   SelectionItem \_ (UIA \_ селектионитемисселектедпропертид) — ищет первый элемент, свойство SelectionItem которого \_ соответствует указанному значению. Укажите **значение true** , чтобы найти первый выбранный элемент, или **false** , чтобы найти первый невыбранный элемент. Будьте внимательны при перечислении всех выбранных элементов, так как количество выбранных элементов может быть очень большим, особенно если пользователь выбрал все элементы.

## <a name="scrolling-a-virtualized-item-on-screen"></a>Прокрутка виртуализированного элемента на экране

После получения ссылки на элемент модели автоматизации пользовательского интерфейса для виртуализированного (экранного) элемента клиент может прокручивать элемент в представление с помощью метода [**иуиаутоматионвиртуализеитемпаттерн:: реализовать**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationvirtualizeditempattern-realize) шаблона элемента управления [виртуализедитем](uiauto-implementingvirtualizeditem.md) . После реализации элемента он становится видимым, и все свойства и шаблоны элементов управления, обычно связанные с элементом ListItem, доступны клиенту.

Только элементы ListItem, полученные методом [**иуиаутоматионитемконтаинерпаттерн:: финдитембипроперти**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationitemcontainerpattern-finditembyproperty) , предоставляют шаблон элемента управления [виртуализедитем](uiauto-implementingvirtualizeditem.md) . Когда экранный элемент прокручивается за пределы экрана, элемент становится недопустимым и клиент должен вызвать **финдитембипроперти** , чтобы получить ссылку на экран.

Также можно перемещать элементы в или из представления с помощью шаблона элемента управления [Scroll](uiauto-implementingscroll.md) (или с помощью полос прокрутки). Элементы и группы реализуются по мере того, как они прокручиваются в представление, и виртуализованы по мере прокрутки представления.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Работа с виртуализированными элементами](uiauto-workingwithvirtualizeditems.md)
</dt> </dl>

 

 




