---
title: Тип элемента управления DataGrid
description: В этом разделе содержатся сведения о поддержке автоматизации пользовательского интерфейса Майкрософт для типа элемента управления DataGrid.
ms.assetid: 2381b302-37d6-4159-bb7d-862ae41af695
keywords:
- Модель автоматизации пользовательского интерфейса, поддержка типа элемента управления DataGrid
- Модель автоматизации пользовательского интерфейса, тип элемента управления DataGrid
- Модель автоматизации пользовательского интерфейса, древовидная структура для типа элемента управления DataGrid
- Модель автоматизации пользовательского интерфейса, свойства для типа элемента управления DataGrid
- Модель автоматизации пользовательского интерфейса, шаблоны элементов управления для типа элемента управления DataGrid
- Модель автоматизации пользовательского интерфейса, события для типа элемента управления DataGrid
- Древовидные структуры, тип элемента управления DataGrid
- свойства, тип элемента управления DataGrid
- шаблоны элементов управления, тип элемента управления DataGrid
- события, тип элемента управления DataGrid
- Поддержка типа элемента управления DataGrid
- Тип элемента управления DataGrid
- типы элементов управления, древовидная структура для типа элемента управления DataGrid
- типы элементов управления, шаблоны элементов управления для типа элемента управления DataGrid
- типы элементов управления, поддержка DataGrid
- типы элементов управления, DataGrid
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7fa37093402fc3c4c195b4b68ecc74652af2d6a6
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127172648"
---
# <a name="datagrid-control-type"></a>Тип элемента управления DataGrid

В этом разделе содержатся сведения о поддержке автоматизации пользовательского интерфейса Майкрософт для типа элемента управления **DataGrid** .

Тип элемента управления **DataGrid** позволяет пользователю легко работать с элементами, содержащими данные или элементы автоматизации, представленные в столбцах или строках. Элементы управления DataGrid имеют строки элементов и столбцы сведений об этих элементах. элемент управления "представление списка" в Windows Vista Explorer является примером, поддерживающим тип элемента управления **DataGrid** .

В следующих разделах определяется необходимая древовидная структура модели автоматизации пользовательского интерфейса, свойства, шаблоны элементов управления и события для типа элемента управления **DataGrid** . Требования к автоматизации пользовательского интерфейса применяются ко всем элементам управления "Сетка данных", в которых платформа или платформа пользовательского интерфейса интегрирует поддержку автоматизации пользовательского интерфейса для типов элементов управления и шаблонов элементов управления.

В этом разделе содержатся следующие подразделы.

-   [Типичная древовидная структура](#typical-tree-structure)
-   [Соответствующие свойства](#relevant-properties)
-   [Обязательные шаблоны элементов управления](#required-control-patterns)
-   [Обязательные события](#required-events)
-   [Пример типа элемента управления DataGrid](#datagrid-control-type-example)
-   [Связанные темы](#related-topics)

## <a name="typical-tree-structure"></a>Типичная древовидная структура

В следующей таблице описывается типичный элемент управления и представление содержимого дерева модели автоматизации пользовательского интерфейса, относящиеся к элементам управления "Сетка данных", и показывается, что может содержаться в каждом представлении. Дополнительные сведения о дереве автоматизации пользовательского интерфейса см. в разделе [Общие сведения о дереве модели автоматизации пользовательского интерфейса](uiauto-treeoverview.md).




| Представление элемента управления | Представление содержимого | 
|--------------|--------------|
| <ul><li>DataGrid<ul><li>Заголовок {0, 1 или 2}<ul><li>HeaderItem (количество столбцов или строк)</li></ul></li><li>DataItem (0 или более; может быть структурирован в иерархии)</li></ul></li></ul> | <ul><li>DataGrid<ul><li>DataItem (0 или более; может быть структурирован в иерархии)</li></ul></li></ul> | 




 

## <a name="relevant-properties"></a>Соответствующие свойства

В следующей таблице перечислены свойства модели автоматизации пользовательского интерфейса, значения или определения которых особенно важны для типа элемента управления **DataGrid** . Дополнительные сведения о свойствах модели автоматизации пользовательского интерфейса см. в разделе [Получение свойств элементов модели автоматизации пользовательского интерфейса](uiauto-propertiesforclients.md).



| Свойство модели автоматизации пользовательского интерфейса                                                                                              | Значение        | Примечания                                                                                                                                                                                                                                                                                                        |
|---------------------------------------------------------------------------------------------------------------------|--------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**UIA \_ аутоматионидпропертид**](uiauto-automation-element-propids.md)                 | См. примечания.   | Значение этого свойства должно быть уникальным среди всех одноранговых элементов в необработанном представлении дерева модели автоматизации пользовательского интерфейса.                                                                                                                                                                                                 |
| [**UIA \_ баундингректанглепропертид**](uiauto-automation-element-propids.md)       | См. примечания.   | Внешний прямоугольник, содержащий весь элемент управления.                                                                                                                                                                                                                                                     |
| [**UIA \_ кликкаблепоинтпропертид**](uiauto-automation-element-propids.md)             | См. примечания.   | Поддерживается при наличии ограничивающего прямоугольника. Если не все точки внутри ограничивающего прямоугольника являются щелчками, а элемент выполняет специализированное тестирование нажатия, переопределите и предоставьте точку для щелчка.                                                                                                         |
| [**UIA \_ контролтипепропертид**](uiauto-automation-element-propids.md)                   | **DataGrid** |                                                                                                                                                                                                                                                                                                              |
| [**UIA \_ исконтентелементпропертид**](uiauto-automation-element-propids.md)         | TRUE         | Значение этого свойства всегда должно быть **true**. Это означает, что элемент управления "Сетка данных" всегда должен находиться в представлении содержимого дерева модели автоматизации пользовательского интерфейса.                                                                                                                                                      |
| [**UIA \_ исконтролелементпропертид**](uiauto-automation-element-propids.md)         | TRUE         | Значение этого свойства всегда должно быть **true**. Это означает, что элемент управления "Сетка данных" всегда должен включаться в представление элемента управления дерева модели автоматизации пользовательского интерфейса.                                                                                                                                                |
| [**UIA \_ искэйбоардфокусаблепропертид**](uiauto-automation-element-propids.md)   | См. примечания.   | Если элемент управления может получать фокус клавиатуры, он должен поддерживать это свойство.                                                                                                                                                                                                                                    |
| [**UIA \_ лабеледбипропертид**](uiauto-automation-element-propids.md)                       | См. примечания.   | Если имеется статическая текстовая метка, это свойство должно предоставлять ссылку на этот элемент управления.                                                                                                                                                                                                                      |
| [**UIA \_ локализедконтролтипепропертид**](uiauto-automation-element-propids.md) | См. примечания.   | Локализованная строка, соответствующая типу элемента управления **DataGrid** . Значение по умолчанию — "Сетка данных" для en-US или English (США).                                                                                                                                                                      |
| [**UIA \_ намепропертид**](uiauto-automation-element-propids.md)                                 | См. примечания.   | Элемент управления "Сетка данных" обычно получает значение для свойства " **имя** " из статической текстовой метки. Если статическая текстовая метка не существует, разработчик приложения должен присвоить значение свойству **Name** . Значение свойства **Name** никогда не должно быть текстовым содержимым элемента управления "поле ввода". |



 

## <a name="required-control-patterns"></a>Обязательные шаблоны элементов управления

В следующей таблице перечислены шаблоны элементов управления модели автоматизации пользовательского интерфейса, которые должны поддерживаться всеми элементами управления "Сетка данных". Дополнительные сведения о шаблонах элементов управления см. в разделе [UI Automation Control Patterns Overview](uiauto-controlpatternsoverview.md).



| Шаблон элемента управления                                         | Поддержка  | Примечания                                                                                                                                                                             |
|---------------------------------------------------------|----------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**IGridProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-igridprovider)           | Обязательно | Сам элемент управления "Сетка данных" всегда поддерживает шаблон элемента управления [Grid](uiauto-implementinggrid.md) , так как элементы, которые он содержит, имеют метаданные, которые располагаются в сетке. |
| [**IScrollProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iscrollprovider)       | Зависит  | Возможность прокрутки сетки данных зависит от содержимого и наличия полос прокрутки.                                                                                       |
| [**ISelectionProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iselectionprovider) | Зависит  | Возможность выбора сетки данных зависит от содержимого.                                                                                                                           |
| [**ITableProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itableprovider)         | Зависит  | Элемент управления "Сетка данных" с заголовком должен поддерживать шаблон элемента управления [Table](uiauto-implementingtable.md) .                                                                   |



 

Элементы данных в контейнерах DataGrid будут поддерживать как минимум следующие шаблоны:

-   Шаблон элемента управления [SelectionItem](uiauto-implementingselectionitem.md) (если сетка данных доступна для выбора)
-   Шаблон элемента управления [скроллитем](uiauto-implementingscrollitem.md) (если сетка данных доступна для прокрутки)
-   Шаблон элемента управления [GridItem](uiauto-implementinggriditem.md)
-   Шаблон элемента управления [TableItem](uiauto-implementingtableitem.md) (если сетка данных имеет заголовок)

## <a name="required-events"></a>Обязательные события

В следующей таблице перечислены события автоматизации пользовательского интерфейса, которые должны поддерживаться элементами управления "Сетка данных". Дополнительные сведения о событиях см. в разделе [UI Automation Events Overview](uiauto-eventsoverview.md).



| Событие автоматизации пользовательского интерфейса                                                                                                                                        | Примечания                                                                                                                                                    |
|------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**UIA \_ аутоматионфокусчанжедевентид**](uiauto-event-ids.md)                                                           |                                                                                                                                                          |
| [**UIA \_**](uiauto-automation-element-propids.md) Событие изменения свойства баундингректанглепропертид.                      |                                                                                                                                                          |
| [**UIA \_**](uiauto-automation-element-propids.md) Событие изменения свойства исенабледпропертид.                                      | Если элемент управления поддерживает свойство « [**включено**](uiauto-automation-element-propids.md) », оно должно поддерживать это событие.                                 |
| [**UIA \_**](uiauto-automation-element-propids.md) Событие изменения свойства исоффскринпропертид.                                  | Если элемент управления поддерживает свойство [**исоффскрин**](uiauto-automation-element-propids.md) , он должен поддерживать это событие.                               |
| [**UIA \_ лайаутинвалидатедевентид**](uiauto-event-ids.md)                                                                     |                                                                                                                                                          |
| [**UIA \_ структуречанжедевентид**](uiauto-event-ids.md)                                                                       |                                                                                                                                                          |
| [**UIA \_**](uiauto-control-pattern-propids.md) Событие изменения свойства мултиплевиевкуррентвиевпропертид.             | Если элемент управления поддерживает свойство Куррентвиев шаблона элемента управления [мултиплевиев](uiauto-implementingmultipleview.md) , он должен поддерживать это событие. |
| [**UIA \_**](uiauto-control-pattern-propids.md) Событие изменения свойства скроллхоризонталлискроллаблепропертид.   | Если элемент управления поддерживает шаблон элемента управления [Scroll](uiauto-implementingscroll.md) , он должен поддерживать это событие.                                         |
| [**UIA \_**](uiauto-control-pattern-propids.md) Событие изменения свойства скроллхоризонталскроллперцентпропертид. | Если элемент управления поддерживает шаблон элемента управления [Scroll](uiauto-implementingscroll.md) , он должен поддерживать это событие.                                         |
| [**UIA \_**](uiauto-control-pattern-propids.md) Событие изменения свойства скроллхоризонталвиевсизепропертид.           | Если элемент управления поддерживает шаблон элемента управления [Scroll](uiauto-implementingscroll.md) , он должен поддерживать это событие.                                         |
| [**UIA \_**](uiauto-control-pattern-propids.md) Событие изменения свойства скроллвертикалскроллперцентпропертид.     | Если элемент управления поддерживает шаблон элемента управления [Scroll](uiauto-implementingscroll.md) , он должен поддерживать это событие.                                         |
| [**UIA \_**](uiauto-control-pattern-propids.md) Событие изменения свойства скроллвертикаллискроллаблепропертид.       | Если элемент управления поддерживает шаблон элемента управления [Scroll](uiauto-implementingscroll.md) , он должен поддерживать это событие.                                         |
| [**UIA \_**](uiauto-control-pattern-propids.md) Событие изменения свойства скроллвертикалвиевсизепропертид.               | Если элемент управления поддерживает шаблон элемента управления [Scroll](uiauto-implementingscroll.md) , он должен поддерживать это событие.                                         |
| [**\_Выбор UIA \_ инвалидатедевентид**](uiauto-event-ids.md)                                                            |                                                                                                                                                          |



 

## <a name="datagrid-control-type-example"></a>Пример типа элемента управления DataGrid

На следующем рисунке показан элемент управления "список-представление", реализующий тип элемента управления **DataGrid** .

![снимок экрана элемента управления "представление списка" с типом элемента управления DataGrid](images/datagridxmpl.jpg)

Ниже показано представление элемента управления и представление содержимого дерева модели автоматизации пользовательского интерфейса, относящиеся к элементу управления "представление списка". Шаблоны элементов управления для каждого элемента автоматизации отображаются в круглых скобках.




| Дерево модели автоматизации пользовательского интерфейса — представление элемента управления | Дерево модели автоматизации пользовательского интерфейса — представление содержимого | 
|-----------------------------------|-----------------------------------|
| DataGrid (сортировка, таблица, выбор, сетка)<ul><li>Заголовок<ul><li>HeaderItem "Name" (Invoke)</li><li>HeaderItem "Date Modified" (Invoke)</li><li>HeaderItem "Size" (Invoke)</li></ul></li><li>Группа Contoso (TableItem, GridItem, SelectionItem, таблица *, сетка*)<ul><li>DataItem "Accounts Receivable.doc" (SelectionItem, Invoke, TableItem *, GridItem*)</li><li>DataItem "Accounts Payable.doc" (SelectionItem, Invoke, TableItem *, GridItem*)</li></ul></li></ul> | DataGrid (Table, Grid, Selection)<ul><li>Группа Contoso (TableItem, GridItem, SelectionItem, таблица *, сетка*)<ul><li>DataItem "Accounts Receivable.doc" (SelectionItem, Invoke, TableItem *, GridItem*)</li><li>DataItem "Accounts Payable.doc" (SelectionItem, Invoke, TableItem *, GridItem*)</li></ul></li></ul> | 




 

\*В предыдущем примере показана сетка данных, содержащая несколько уровней элементов управления. Элемент управления **Group** ("contoso") содержит два элемента управления **DataItem** ("учетные записи Receivable.doc" и "учетные записи Payable.doc"). Пара элементов **управления DataGrid** /  не зависит от пары на другом уровне. Элементы управления **DataItem** в **группе** также могут быть представлены как тип элемента управления [ListItem](uiauto-supportlistitemcontroltype.md) , что позволяет более четко представить их как выбираемые объекты, а не как простые элементы данных. Этот пример не включает дочерние элементы сгруппированных элементов данных. Еще один пример нескольких уровней элементов управления см. в разделе Тип элемента управления [DataItem](uiauto-supportdataitemcontroltype.md) .

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

**Основные понятия**
</dt> <dt>

[Общие сведения о типах элементов управления автоматизации пользовательского интерфейса](uiauto-controltypesoverview.md)
</dt> <dt>

[Общие сведения о модели автоматизации пользовательского интерфейса](uiauto-uiautomationoverview.md)
</dt> </dl>

 

 




