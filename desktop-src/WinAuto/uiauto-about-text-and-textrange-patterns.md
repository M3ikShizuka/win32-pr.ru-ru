---
title: О шаблонах элементов управления Text и TextRange
description: Текстовое содержимое элемента управления предоставляется с помощью шаблона элемента управления Text, который представляет содержимое текстового контейнера в виде текстового потока.
ms.assetid: acc2b513-9367-416a-b0d9-3c2bcc14a8a7
keywords:
- Автоматизация пользовательского интерфейса, поддержка текстового содержимого
- Модель автоматизации пользовательского интерфейса, общие сведения о шаблоне текста
- Модель автоматизации пользовательского интерфейса, общие сведения об элементах управления текстом
- Модель автоматизации пользовательского интерфейса, шаблон элемента управления Text
- Модель автоматизации пользовательского интерфейса, платформа текстовых служб (TSF)
- Модель автоматизации пользовательского интерфейса, TSF
- Модель автоматизации пользовательского интерфейса, производительность
- текстовые шаблоны, сведения
- текстовые шаблоны, платформа текстовых служб (TSF)
- элементы управления текстом, сведения
- текстовое содержимое, поддержка
- элементы управления "текст", "производительность"
- Шаблон элемента управления Text
- шаблоны элементов управления, текст
- Инфраструктура текстовых служб (TSF)
- TSF (платформа текстовых служб)
- производительность
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bb9ff1eb75227454e3e9df6035798a304096a958
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "105700925"
---
# <a name="about-the-text-and-textrange-control-patterns"></a>О шаблонах элементов управления Text и TextRange

Текстовое содержимое элемента управления предоставляется с помощью шаблона элемента управления [Text](uiauto-implementingtextandtextrange.md) , который представляет содержимое текстового контейнера в виде текстового потока. Шаблон элемента управления Text требует поддержки шаблона элемента управления TextRange для представления атрибутов формата и стиля. Шаблон элемента управления TextRange поддерживает шаблон элемента управления Text, представляющий смежные или несколько несвязных текстовых диапазонов (или диапазонов) в текстовом контейнере с коллекцией начальных и конечных конечных точек. Шаблон элемента управления TextRange поддерживает такие функции, как выбор, сравнение, извлечение и обход.

> [!Note]  
> Шаблон элемента управления [Text](uiauto-implementingtextandtextrange.md) не предоставляет средств для вставки или изменения текста. Однако, в зависимости от элемента управления, это можно сделать с помощью шаблона элемента управления [value](uiauto-implementingvalue.md) модели автоматизации пользовательского интерфейса (Майкрософт) или с помощью прямого ввода с клавиатуры. Существует также шаблон [**также TextEdit**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itexteditprovider) , который поддерживает программное изменение текста.

 

Функциональные возможности, описанные в этом разделе, важны для поставщиков вспомогательных технологий и их конечных пользователей. Специальные технологии могут использовать автоматизацию пользовательского интерфейса для сбора полных сведений о форматировании текста для пользователя и предоставления программных средств навигации и выбора текста по [**текстунит**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) (символ, слово, строка или абзац).

В этом разделе содержатся следующие подразделы.

-   [Модель автоматизации пользовательского интерфейса TextPattern и платформа текстовых служб](#ui-automation-textpattern-and-the-text-services-framework)
-   [Типы элементов управления](#control-types)
-   [Интерфейсы поставщика](#provider-interfaces)
-   [Клиентские интерфейсы](#client-interfaces)
-   [Производительность](#performance)
-   [Шаблон текста и виртуализированные внедренные объекты](#text-pattern-and-virtualized-embedded-objects)
-   [Использование пользовательского типа элемента управления с шаблоном элемента управления Text](#using-the-custom-control-type-with-the-text-control-pattern)
-   [Время существования текстового диапазона](#lifetime-of-a-text-range)
-   [См. также](#related-topics)

## <a name="ui-automation-textpattern-and-the-text-services-framework"></a>Модель автоматизации пользовательского интерфейса TextPattern и платформа текстовых служб

Платформа текстовых служб (TSF) — это простая и масштабируемая системная платформа, которая обеспечивает службы естественного языка и расширенный ввод текста на рабочем столе и в приложениях. Помимо предоставления интерфейсам для приложений доступа к хранилищу текста, оно также поддерживает метаданные для хранилища текста.

TSF предназначен для приложений, которым необходимо внедрять входные данные в сценарии с учетом контекста. Однако шаблон элемента управления [Text](uiauto-implementingtextandtextrange.md) является решением только для чтения, которое предназначено для обеспечения оптимизированного доступа к хранилищу текста для средств чтения с экрана и устройств Брайля.

Доступные технологии, которым требуется доступ только для чтения к хранилищу текста, могут использовать шаблон элемента управления Text, но при этом потребуется функциональность TSF для входных данных, учитывающих контекст.

Дополнительные сведения см. в разделе [Платформа текстовых служб](/windows/desktop/TSF/text-services-framework).

## <a name="control-types"></a>Типы элементов управления

Тип [элемента управления "](uiauto-supporteditcontroltype.md) поле ввода" и тип элемента управления " [документ](uiauto-supportdocumentcontroltype.md) " модели автоматизации пользовательского интерфейса должны поддерживать шаблон элемента управления [Text](uiauto-implementingtextandtextrange.md) . Для улучшения специальных возможностей корпорация Майкрософт рекомендует, чтобы типы элементов управления [ToolTip](uiauto-supporttooltipcontroltype.md) и Text также поддерживали шаблон элемента управления Text, но это не обязательно.

## <a name="provider-interfaces"></a>Интерфейсы поставщика

Поставщики автоматизации пользовательского интерфейса поддерживают шаблон элемента управления [Text](uiauto-implementingtextandtextrange.md) для элемента управления путем реализации интерфейсов [**итекстпровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) и [**итекстранжепровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) . Эти интерфейсы предоставляют подробные сведения об атрибутах для текста в элементе управления и предоставляют широкие возможности навигации.

Поставщику не требуется поддерживать все текстовые атрибуты, если в элементе управления отсутствует поддержка какого-либо конкретного атрибута.

Поставщик должен поддерживать методы [**итекстпровидер::-SELECT**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-getselection) и [**Итекстранжепровидер:: SELECT**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-select) , если элемент управления поддерживает выделение текста или размещение текстового курсора (или системного курсора) в области текста. Если элемент управления не поддерживает эту функцию, он не должен поддерживать ни один из этих методов. Однако элемент управления должен предоставлять тип выбора текста, который он поддерживает, путем реализации свойства [**итекстпровидер:: суппортедтекстселектион**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_supportedtextselection) .

Поставщик всегда должен поддерживать [**текстунит**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) константы, **\_ символы текстунит** и текстунит, а также все остальные, которые он может поддерживать. **\_**

> [!Note]  
> Поставщик может пропускать поддержку определенного [**текстунита**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit) , откладывая до следующей самой крупной единицы, поддерживаемой в следующем порядке: **текстунит- \_ символ**, **текстунит \_**, **текстунит \_ Word**, **текстунит \_ line**, **текстунит \_ абзац**, **текстунит \_ Page** и **текстунит \_ Document**.

 

## <a name="client-interfaces"></a>Клиентские интерфейсы

Клиентские приложения модели автоматизации пользовательского интерфейса используют интерфейсы [**иуиаутоматионтекстпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextpattern) и [**иуиаутоматионтекстранже**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange) для доступа к текстовому содержимому элемента управления "текст". Клиенты используют **иуиаутоматионтекстпаттерн** для выбора фрагментов текста, называемых *текстовыми диапазонами*, и для получения указателей на интерфейсы **иуиаутоматионтекстранже** для диапазонов. Интерфейс **иуиаутоматионтекстранже** позволяет клиентам управлять диапазоном текста и получать сведения о тексте в диапазоне, включая такие атрибуты, как имя шрифта, цвет переднего плана, стиль подчеркивания и т. д. Дополнительные сведения см. в разделе [идентификаторы атрибутов текста](uiauto-textattribute-ids.md).

## <a name="performance"></a>Производительность

Шаблон элемента управления **Text** полагается на вызовы между процессами для большей части его функциональности, поэтому он не предоставляет механизм кэширования для повышения производительности при обработке содержимого. Доступ к другим шаблонам элементов управления в службе автоматизации пользовательского интерфейса Майкрософт можно получить с помощью метода [**иуиаутоматионелемент:: жеткачедпаттерн**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationelement-getcachedpattern) .

Одним из способов повышения производительности является обеспечение того, что клиенты автоматизации пользовательского интерфейса пытаются получить блоки текста умеренного размера с помощью метода [**иуиаутоматионтекстранже:: GetText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext) . Например, использование **gettext** для извлечения одиночных символов повлечет за собой попадание между процессами для каждого символа, в то время как не задавая максимальную длину при вызове **gettext** , повлечет за собой однопроцессное попадание, но может иметь высокую задержку в зависимости от размера текстового диапазона.

## <a name="text-pattern-and-virtualized-embedded-objects"></a>Шаблон текста и виртуализированные внедренные объекты

Всякий раз, когда это возможно, реализация поставщика [**итекстпровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider) и [**итекстранжепровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider) должна поддерживать весь текст документа, включая текст за пределами окна просмотра. Для неотображаемого текста или внедренных объектов, которые являются виртуализированными, поставщики должны поддерживать [шаблон элемента управления виртуализедитем](uiauto-implementingvirtualizeditem.md) ([**ивиртуализедитемпровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivirtualizeditemprovider)).

Если документ является виртуализированным, а весь текстовый поток по-прежнему доступен, свойство [**итекстпровидер::D окументранже**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextprovider-get_documentrange) Извлекает текстовый диапазон, включающий весь документ. Однако вызов метода [**итекстранжепровидер**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-itextrangeprovider-getchildren) извлечет коллекцию виртуализированных объектов, представляющих все внедренные объекты в документе. Для взаимодействия с виртуализированным внедренным объектом клиенты должны вызвать метод [**ивиртуализедитемпровидер:: реализовать**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-ivirtualizeditemprovider-realize) , который делает элементы полностью доступными в качестве элементов модели автоматизации пользовательского интерфейса. Клиенты должны следовать аналогичной процедуре работы с элементами сетки во внедренной таблице, где часть таблицы находится вне экрана и виртуализирована.

## <a name="using-the-custom-control-type-with-the-text-control-pattern"></a>Использование пользовательского типа элемента управления с шаблоном элемента управления Text

Хотя шаблон элемента управления [Text](uiauto-implementingtextandtextrange.md) поддерживает множество атрибутов текста и внедренных объектов, невозможно определить заранее все возможные элементы документа и типы представления. Для элементов документа, которые не поддерживаются существующими атрибутами или типами стандартных элементов управления, поставщики могут использовать функции расширяемости, предоставляемые **настраиваемым** типом элемента управления модели автоматизации пользовательского интерфейса.

Для приложений и пользовательских интерфейсов, основанных на презентациях страниц, представление границы и макета «страницы» также может быть выражено как внедренный объект, имеющий пользовательский тип элемента управления (то есть `LocalizedControlType="page"` ). Таким образом, внедренный объект может размещать другие элементы страницы, которые не могут быть просто частью потока текста документа, например поля верхнего и нижнего колонтитула на каждой странице, как дочерние элементы внедренного объекта Page. Кроме того, каждый объект «Page» может поддерживать шаблон элемента управления [Text](uiauto-implementingtextandtextrange.md) независимо друг от друга, который хорошо подходит для приложений, таких как средства разработки для презентаций с показом слайдов или для настольных сред публикации на основе страниц.

## <a name="lifetime-of-a-text-range"></a>Время существования текстового диапазона

Если это возможно, поставщик должен гарантировать, что любые изменения текста, такие как удаления, вставки и перемещения, будут отражены в соответствующем текстовом диапазоне. Если обновление диапазона текста невозможно, поставщик должен вызвать событие [**UIA \_ Text \_ текстчанжедевентид**](uiauto-event-ids.md) , чтобы уведомить клиентов о том, что текстовый диапазон больше не действителен, а новый должен быть получен.

## <a name="related-topics"></a>См. также

<dl> <dt>

**Зрения**
</dt> <dt>

[Как модель автоматизации пользовательского интерфейса поддерживает внедренные объекты](uiauto-textpattern-and-embedded-objects-overview.md)
</dt> <dt>

[Общие сведения о шаблонах элементов управления модели автоматизации пользовательского интерфейса](uiauto-controlpatternsoverview.md)
</dt> <dt>

[Поддержка модели автоматизации пользовательского интерфейса для текстового содержимого](uiauto-ui-automation-textpattern-overview.md)
</dt> <dt>

[Работа с элементами управления на основе текста](uiauto-workingwithtextbasedcontrols.md)
</dt> <dt>

**Другие ресурсы**
</dt> <dt>

[инфраструктуры текстовых служб (TSF)](/windows/desktop/TSF/text-services-framework)
</dt> </dl>

 

 