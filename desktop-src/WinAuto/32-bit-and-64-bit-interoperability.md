---
title: 32-разрядное и 64-разрядное взаимодействие
description: Приложения с поддержкой специальных возможностей должны взаимодействовать через границы процесса для получения сведений о пользовательском интерфейсе от серверов Microsoft Active Accessibility и поставщиков автоматизации пользовательского интерфейса Майкрософт.
ms.assetid: 8b46daed-4fd9-430c-bb4d-24be9c8015b5
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e1c056c9fe2792734e9369fa311e69528ce226f7edf15b82440b63c12c52de66
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118327993"
---
# <a name="32-bit-and-64-bit-interoperability"></a>32-разрядное и 64-разрядное взаимодействие

Приложения с поддержкой специальных возможностей должны взаимодействовать через границы процесса для получения сведений о пользовательском интерфейсе от серверов Microsoft Active Accessibility и поставщиков автоматизации пользовательского интерфейса Майкрософт. в этом разделе описываются основные проблемы взаимодействия между процессами, которые необходимо учитывать при разработке приложений Windows специальных возможностей.

когда приложения используют API-интерфейс автоматизации Windows, компоненты времени выполнения Microsoft Active Accessibility и автоматизации пользовательского интерфейса автоматически обрабатывают все проблемы и сложности, связанные с выполнением межпроцессного взаимодействия (IPC), включая проблемы взаимодействия, связанные с тем, что один процесс имеет 32 бит, а второй — 64-бит. корпорация майкрософт распознает, что есть случаи, когда для взаимодействия с сервером Microsoft Active Accessibility или поставщиком автоматизации пользовательского интерфейса может потребоваться использовать некоторую форму IPC вместо API-интерфейса Windows Automation. в этих случаях для взаимодействия с другими процессами корпорация майкрософт рекомендует использовать DCOM-или Windows сообщения (со значениями, меньшими, чем у **\_ пользователя WM**). как и API Windows автоматизации, сообщения DCOM и Windows автоматически обрабатывали все связанные с IPC проблемы, включая 32-разр. в 64-разрядную совместимость.

если Windows API автоматизации, DCOM и Windows не являются вариантами, при реализации выбранного метода IPC учитывайте следующие моменты.

-   Общая память — при использовании общей памяти следует иметь в виду, что структура в 32-разрядном процессе может иметь разный размер и макет, чем та же структура в 64-разрядном процессе. Это особенно справедливо для структур, содержащих указатели или дескрипторы.
-   усечение указателя — несмотря на то, что 32-разрядное приложение может использовать тип данных **лонглонг** для хранения 64-разрядного значения, существуют экземпляры, в которых не существует Windows элемента API, который позволил бы 32-разрядному приложению получать 64-разрядное значение от 64-разрядного процесса, или отправлять 64-битное значение в 64-разрядный процесс. Например, функции [**жетвиндовлонгптр**](/windows/desktop/api/winuser/nf-winuser-getwindowlongptra) и [**SendMessage**](/windows/desktop/api/winuser/nf-winuser-sendmessage) усекаются все значения указателей, в результате чего 32-разрядное приложение имеет бесполезное значение.
-   Дескрипторы — так как дескрипторы kernel32 и User32 существенны только 32 в 32-разрядных и 64-разрядных процессах, они могут передаваться между процессами без проблем. однако некоторые элементы, Windows определяются как дескрипторы, на самом деле просто являются переинкапсулированными указателями (например, **хтриитем**). Эти "дескрипторы" будут обрезаны, если они передаются из 64-разрядного процесса в 32-разрядный процесс.
-   [WinEvent](winevents-infrastructure.md) Функции обработчика — для регистрации функции-обработчика в контексте с 32-разрядным серверным процессом функция-обработчик должна находиться в 32-разрядной библиотеке DLL. Аналогично, для регистрации функции-обработчика в контексте с 64-разрядным серверным процессом функция-обработчик должна находиться в 64-разрядной библиотеке DLL. Если приложение, поддерживающее вспомогательные технологии, пытается зарегистрировать функцию-обработчик в контексте на сервере с другой битовой глубиной, события все равно будут доставляться функции-обработчику, но они будут доставлены вне контекста. Дополнительные сведения см. в разделе Виневентс, [функции обработчика в контексте и вне контекста](in-context-and-out-of-context-hook-functions.md).

Дополнительные сведения о 32-разрядном и 64-разрядном взаимодействии см. в разделе [взаимодействие процессов](/windows/desktop/WinProg64/process-interoperability).

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Windows Общие сведения об API автоматизации](windows-automation-api-overview.md)
</dt> </dl>

 

 