---
title: Специальные возможности — Акцевент (доступное средство отслеживания событий)
description: Акцевент (доступное наблюдатель событий) позволяет разработчикам и тестерам проверять, что элементы пользовательского интерфейса приложения вызывают правильную автоматизацию пользовательского интерфейса Майкрософт, а также события Microsoft Active Accessibility при изменении пользовательского интерфейса.
ms.assetid: 0077da81-7a1f-4f8b-b519-ebefcc63d264
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bb2192bf6973444bf2bfc307ff4613d9d1c593d5a22f9800ecb61bc310b3a210
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118327810"
---
# <a name="accessibility-tools---accevent-accessible-event-watcher"></a>Специальные возможности — Акцевент (доступное средство отслеживания событий)

**Акцевент (доступное наблюдатель событий)** позволяет разработчикам и тестерам проверять, что элементы пользовательского интерфейса приложения вызывают правильную АВТОМАТИЗАЦИЮ пользовательского интерфейса Майкрософт, а также события Microsoft Active Accessibility при изменении пользовательского интерфейса. Изменения в пользовательском интерфейсе могут возникать при изменении фокуса или при вызове элемента пользовательского интерфейса, при его выборе или изменении состояния или свойства.

**акцевент** устанавливается вместе с пакетом SDK (Windows Software Development Kit). Он находится в \\ папке bin \\ < *Version* > \\ < > путь установки пакета SDK (Accevent.exe).

> [!NOTE]
> **Акцевент** — это устаревшее средство. вместо этого рекомендуется использовать [Аналитика специальных возможностей](https://accessibilityinsights.io/) .

## <a name="requirements"></a>Требования

**Акцевент** можно использовать для проверки специальных возможностей в системах без автоматизации пользовательского интерфейса, которая была первоначально написана для Microsoft Active Accessibility. Для изучения автоматизации пользовательского интерфейса в системе должна присутствовать модель автоматизации пользовательского интерфейса. Дополнительные сведения см. в разделе "требования" [модели автоматизации пользовательского интерфейса](entry-uiauto-win32.md).

**акцевент** устанавливается как часть общего набора средств в Windows SDK, он не распространяется в виде отдельной загрузки exe-файла. Windows SDK включает все средства, связанные со специальными возможностями, описанные в этом разделе. [получите Windows SDK.](https://developer.microsoft.com/) (Кроме того, если требуется предыдущая версия, можно загрузить архив SDK, связанный с этой страницей.)

Чтобы запустить **акцевент**, найдите AccEvent.exe в \\ папке bin \\ < *версии* > \\ < > и запустите ее (обычно запускать от имени администратора не требуется).

## <a name="the-accessible-event-watcher-window"></a>Окно "наблюдатель событий" доступно

При запуске **акцевент** отображается главное окно. В главном окне **акцевент** отображаются модель автоматизации пользовательского интерфейса или события Microsoft Active Accessibility, создаваемые приложениями, которые работают под управлением. Главное окно состоит из следующих основных частей:

- Заголовок окна. Отображает текущий режим работы и состояние.
- Строка меню. Предоставляет доступ к функциональным возможностям **акцевент** .
- Представление данных. Отображает сведения о каждом событии, включая идентификатор события и выбранные свойства элемента пользовательского интерфейса, вызвавшего событие.

**Акцевент** имеет только графический интерфейс пользователя; для этого средства отсутствуют аргументы командной строки, но можно использовать другие средства для обработки выходного журнала в виде текста.

На следующем рисунке показано главное окно **акцевент** .

![Пользовательский интерфейс для средства отслеживания событий доступности](images/accevent.png)

## <a name="accessible-event-watcher-tasks"></a>Доступные задачи наблюдателя событий

В этом разделе содержатся сведения о часто используемых задачах **акцевент** .

### <a name="configuring-the-operating-mode"></a>Настройка режима работы

Используйте меню **режим** , чтобы настроить режим работы **акцевент** и выбрать параметры, управляющие поведением средства. Можно выбрать следующие параметры.



| При выборе этого параметра | **Акцевент** делает это                                                                                                                                                                                                                           |
|------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Поверх остальных окон                | Отображается поверх любого другого пользовательского интерфейса на экране.                                                                                                                                                                                    |
| События UIA                   | Отображает сведения о событиях модели автоматизации пользовательского интерфейса.                                                                                                                                                                                             |
| Виневентс (в контексте)       | Отображает сведения о событиях Microsoft Active Accessibility (Виневентс), переданных в функции-ловушки, которые находятся в адресном пространстве сервера. Дополнительные сведения см. [в разделе функции-обработчики в контексте](in-context-hook-functions.md).         |
| Виневентс (вне контекста)   | Отображает сведения о событиях Microsoft Active Accessibility (Виневентс), переданных в функции-ловушки, которые находятся в адресном пространстве клиента. Дополнительные сведения см. в разделе [функции-обработчики, которые выходят за пределы контекста](out-of-context-hook-functions.md). |
| Показать Выделенный прямоугольник     | Выделяет прямоугольник вокруг элемента пользовательского интерфейса, вызвавшего выбранное событие.                                                                                                                                                                 |
| Отобразить подсказку о сведениях     | Отображает сведения о событиях в подсказке.                                                                                                                                                                                                        |
| "Настройки"                     | отображает диалоговое окно **Параметры событий UIA** или **Параметры WinEvent** .                                                                                                                                                                     |



 

### <a name="filtering-ui-automation-events"></a>Фильтрация событий автоматизации пользовательского интерфейса

чтобы настроить события и свойства модели автоматизации пользовательского интерфейса, отображаемые в окне **акцевент** , откройте меню **режим** , выберите пункт **события UIA**, а затем выберите **Параметры**. откроется диалоговое окно **Параметры событий UIA** . Это диалоговое окно также можно использовать для фильтрации событий.

диалоговое окно **Параметры событий UIA** содержит следующие панели:

- **Глобальные события**

    Установите флажок **фокусчанжедевент** , чтобы отобразить сведения о глобальных событиях изменения фокуса.

- **Тип события**

    Выберите интересующие вас события.

- **Область**

    Выберите элемент пользовательского интерфейса, который должен прослушиваться **акцевент** для событий.

- **Включить события из**

    Выберите **непосредственные дочерние** элементы, чтобы просмотреть события из непосредственных дочерних элементов элемента пользовательского интерфейса, выбранного на панели **область** . Если вы хотите просмотреть события из всех элементов-потомков, выберите **все потомки**.

- **Свойства отчета**

    Выберите свойства, которые должны отображаться после каждого события в главном окне. Если в меню **режим** выбран параметр **Показать подсказку сведений** , то выбранные свойства также отображаются в подсказке.

### <a name="filtering-active-accessibility-events"></a>Фильтрация событий Active Accessibility

чтобы настроить события и свойства Microsoft Active Accessibility, отображаемые в окне **акцевент** , откройте меню **режим** , выберите либо **виневентс (в контексте)** , либо **виневентс (вне контекста)**, а затем выберите **Параметры**. откроется диалоговое окно **Параметры WinEvent** . Это диалоговое окно также можно использовать для фильтрации событий.

диалоговое окно **Параметры WinEvent** содержит следующие панели:

- **Объекты**

    Выберите объекты, которые должны прослушиваться **акцевент** для событий. **Акцевент** может прослушивать события, исходящие от Windows, от курсора или от курсора. По умолчанию выбрано **окно** .

- **События**

    Выберите интересующие вас события. По умолчанию отображаются все события.

- **Сведения о событии**

    Выберите сведения, которые должны отображаться после имени каждого события в главном окне.

- **Свойства объекта**

    Выберите свойства, которые должны отображаться после каждого события в главном окне. Если в меню **режим** выбран параметр **Показать подсказку сведений** , то выбранные свойства также отображаются в подсказке. **Имя**, **роль** и **состояние** выбираются по умолчанию.

- **Фильтрация**

    Выберите один из переключателей в разделе "Фильтрация", чтобы отфильтровать события, вызванные окнами, указанными в поле **HWND** . Переключатель **не фильтр** выбран по умолчанию.

    - Выберите переключатель **исключить** , чтобы отобразить только события, вызванные объектами, отличными от указанных в окнах.
    - Установите переключатель **включить только** и укажите один или несколько дескрипторов окон, чтобы отображались только события, вызванные этими окнами.
    - Установите флажок **и потомки** , чтобы включить события, вызванные потомками указанных окон.

- **Параметры**

    Выберите любой из следующих параметров:

    

    | При выборе этого параметра                                  | **Акцевент** делает это                                                                                                                                                                                 |
    |---------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | Использовать Invoke                                                    | Использует [IDispatch:: Invoke](/windows/win32/api/oaidl/nf-oaidl-idispatch-invoke) для получения свойств объекта вместо использования методов [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) .                               |
    | Всегда получать объект (даже если свойства объекта не выбраны)     | Извлекает объект, связанный с событием, даже если в области свойств объекта не выбран ни один элемент.                                                                                        |
    | Отображать свойство по умолчанию (в дополнение к выбранным свойствам) | Отображает свойство по умолчанию (при наличии) для объекта, связанного с событием, а также элементы, выбранные в области свойства объекта.                                                      |
    | Отображение сведений о событиях из невидимых или скрытых окон       | Отображает выбранные элементы из области сведения о событии для всех объектов, включая невидимые или скрытые окна.                                                                       |
    | Отображение полных сведений о событиях из невидимых или скрытых окон  | Отображает выбранные элементы из области сведения о событии и выбранные (или используемые по умолчанию) элементы в области свойства объекта для всех объектов, включая невидимые или скрытые окна. |
    | DebugBreak при следующем событии                                      | Приводит к возникновению исключения точки останова в процессе, который является источником следующей WinEvent. Это сигнализирует отладчику об обработке исключения.                                                        |

### <a name="using-the-event-menu"></a>Использование меню "событие"

Используйте меню **событий** для выполнения следующих задач.

| При выборе этого параметра | **Акцевент** делает это                                    |
|------------------------------|-------------------------------------------------------|
| Начать прослушивание              | Запускает отображение сведений о событии в представлении данных. |
| Прерывать прослушивание               | Останавливает отображение сведений о событиях в представлении данных.  |
| Очистить журнал событий          | Очищает содержимое представления данных.                 |
| Выбрать все события            | Выбирает все события, перечисленные в представлении данных.           |
| Копировать выбранные события         | Копирует выбранные события в буфер обмена.          |

### <a name="saving-active-accessibility-events"></a>Сохранение событий Active Accessibility

Чтобы начать сохранение событий в текстовом файле, откройте меню **файл** и выберите команду **начать запись в файл**. **Акцевент** начинает записывать события в указанный файл, пока вы не выберете пункт " **отключить ведение журнала** " в меню " **файл** ". Этот текстовый файл может быть полезен для устранения неполадок и просмотра событий в дальнейшем.

## <a name="related-topics"></a>Связанные темы

- [Средство Accessible Event Watcher](accessible-event-watcher.md)
- [Средства тестирования](testing-tools.md)
- [Средство UI Accessibility Checker](ui-accessibility-checker.md)
- [Обзор событий автоматизации пользовательского интерфейса](uiauto-eventsoverview.md)
- [Средство UI Automation Verify](ui-automation-verify.md)
- [WinEvents](winevents-infrastructure.md)