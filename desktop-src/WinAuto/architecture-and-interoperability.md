---
title: Архитектура и взаимодействие
description: В этом разделе кратко описывается архитектура Microsoft Active Accessibility и Microsoft UI Automation, а также компоненты, которые позволяют взаимодействовать между приложениями на основе двух различных технологий.
ms.assetid: 7309819c-7c72-4bb3-ab9c-608a27c56d42
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a1b146fa2d628ff64d2dcf714a1f860bee28c2f0f816e057f6b411e8344462fa
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119053022"
---
# <a name="architecture-and-interoperability"></a>Архитектура и взаимодействие

В этом разделе кратко описывается архитектура Microsoft Active Accessibility и Microsoft UI Automation, а также компоненты, которые позволяют взаимодействовать между приложениями на основе двух различных технологий.

Дополнительные сведения о взаимодействии Microsoft Active Accessibility и автоматизации пользовательского интерфейса см. в разделе [Общая инфраструктура](common-infrastructure.md).

В этом разделе содержатся следующие подразделы.

-   [Архитектура Active Accessibility Майкрософт](#microsoft-active-accessibility-architecture)
-   [Архитектура модели автоматизации пользовательского интерфейса](#ui-automation-architecture)
-   [Взаимодействие Microsoft Active Accessibility и автоматизации пользовательского интерфейса](#microsoft-active-accessibility-and-ui-automation-interoperability)
-   [Интерфейс IAccessibleEx](#the-iaccessibleex-interface)
-   [Связанные темы](#related-topics)

## <a name="microsoft-active-accessibility-architecture"></a>Архитектура Active Accessibility Майкрософт

Microsoft Active Accessibility предоставляет основные сведения об элементах управления, таких как имя элемента управления, расположение на экране и тип элемента управления, а также сведения о состоянии, такие как видимость и состояние включения или отключения. Пользовательский интерфейс представлен как иерархия объектов со специальными возможностями; изменения и действия представлены в виде Виневентс.

Microsoft Active Accessibility состоит из следующих компонентов:

-   Доступный объект — логический элемент пользовательского интерфейса (например, кнопка), представленный интерфейсом модели компонента [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) (com) и целочисленным дочерним идентификатором (чилдид).
-   Виневентс — система событий, которая позволяет серверам уведомлять клиентов при изменении объекта со специальными возможностями. Дополнительные сведения см. в разделе [виневентс](winevents-infrastructure.md).
-   OLEACC.dll — библиотека динамических связей среды выполнения, которая предоставляет API Microsoft Active Accessibility и платформу специальных возможностей. ОЛЕАКК реализует прокси-объекты, предоставляющие сведения о специальных возможностях по умолчанию для стандартных элементов пользовательского интерфейса, включая пользовательские элементы управления, меню пользователей и общие элементы управления.

Для Microsoft Active Accessibility системный компонент инфраструктуры специальных возможностей (ОЛЕАКК) помогает организовать взаимодействие между вспомогательными технологиями (средства специальных возможностей) и приложениями, как показано на следующем рисунке.

![Иллюстрация взаимодействия средств специальных возможностей с приложениями](images/msaaarch.gif)

Приложения (серверы Microsoft Active Accessibility) предоставляют сведения о специальных возможностях в пользовательском интерфейсе для средств (клиентов Microsoft Active Accessibility), взаимодействующих с пользовательским интерфейсом от имени пользователей. Граница кода является программной и границей процесса.

## <a name="ui-automation-architecture"></a>Архитектура модели автоматизации пользовательского интерфейса

При использовании модели автоматизации ПОЛЬЗОВАТЕЛЬСКОГО интерфейса основной компонент модели автоматизации пользовательского интерфейса (UIAutomationCore.dll) загружается в процессы специальных возможностей и приложений. Основной компонент управляет межпроцессным обменом данными, предоставляет службы более высокого уровня, такие как поиск элементов по значениям свойств, и обеспечивает возможность многоуровневой выборки или кэширования свойств, что обеспечивает лучшую производительность по сравнению с реализацией Microsoft Active Accessibility.

Модель автоматизации пользовательского интерфейса включает прокси-объекты, предоставляющие сведения о стандартных элементах пользовательского интерфейса, таких как пользовательские элементы управления, меню пользователей и общие элементы управления. Он также включает учетные записи-посредники, позволяющие клиентам автоматизации пользовательского интерфейса получать сведения о пользовательском интерфейсе от серверов Microsoft Active Accessibility.

На следующем рисунке показаны связи между различными компонтентсами автоматизации пользовательского интерфейса, используемыми в средствах специальных возможностей (клиенты) и в приложениях (поставщики).

![Иллюстрация взаимодействия средств специальных возможностей с компонентами в приложениях](images/uiaarch.gif)

## <a name="microsoft-active-accessibility-and-ui-automation-interoperability"></a>Взаимодействие Microsoft Active Accessibility и автоматизации пользовательского интерфейса

Модель автоматизации пользовательского интерфейса для Microsoft Active Accessibility Bridge позволяет клиентам Microsoft Active Accessibility доступ к поставщикам автоматизации ПОЛЬЗОВАТЕЛЬСКОГО интерфейса путем преобразования объектной модели автоматизации пользовательского интерфейса в объектную модель Microsoft Active Accessibility. На следующем рисунке показана роль модели автоматизации пользовательского интерфейса Active Accessibility моста.

![Иллюстрация работы модели автоматизации пользовательского интерфейса с инструментами и приложениями специальных возможностей](images/uiatomsaabridge.gif)

Аналогично, прокси-сервер автоматизации Microsoft Active Accessibility в пользовательском интерфейсе преобразует серверные объектные модели на основе Microsoft Active Accessibility для клиентов автоматизации пользовательского интерфейса. На следующем рисунке показана роль прокси-сервера автоматизации Microsoft Active Accessibility в пользовательском интерфейсе.

![Иллюстрация работы прокси-сервера автоматизации пользовательского интерфейса со специальными средствами и приложениями](images/msaatouiaproxy.gif)

## <a name="the-iaccessibleex-interface"></a>Интерфейс IAccessibleEx

Интерфейс [**IAccessibleEx**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iaccessibleex) позволяет существующим приложениям или БИБЛИОТЕКАМ пользовательского интерфейса расширить свою модель объектов Microsoft Active Accessibility для поддержки автоматизации пользовательского интерфейса без необходимости перезаписи реализации с нуля. С помощью **IAccessibleEx** можно реализовать только дополнительные свойства автоматизации пользовательского интерфейса и шаблоны элементов управления, необходимые для полного описания пользовательского интерфейса и его функциональных возможностей.

Поскольку прокси-сервер автоматизации Microsoft Active Accessibility в пользовательском интерфейсе преобразует объектные модели серверов Microsoft Active Accessibility с поддержкой [**IAccessibleEx**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iaccessibleex)в качестве объектных моделей автоматизации пользовательского интерфейса, клиентам автоматизации пользовательского интерфейса не требуется выполнять никаких дополнительных действий. Интерфейс **IAccessibleEx** также может включать внутрипроцессный клиент Microsoft Active Accessibility взаимодействовать непосредственно с поставщиками автоматизации пользовательского интерфейса.

Дополнительные сведения см. в описании [интерфейса IAccessibleEx](iaccessibleex.md).

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Windows Общие сведения об API автоматизации](windows-automation-api-overview.md)
</dt> <dt>

[Интерфейс IAccessibleEx](iaccessibleex.md)
</dt> <dt>

[Вопросы безопасности для вспомогательных технологий](uiauto-securityoverview.md)
</dt> </dl>

 

 




