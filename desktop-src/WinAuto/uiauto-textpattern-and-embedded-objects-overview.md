---
title: Как модель автоматизации пользовательского интерфейса предоставляет внедренные объекты
description: В этом разделе описывается, как автоматизация пользовательского интерфейса Майкрософт предоставляет внедренные объекты или дочерние элементы в текстовом документе или контейнере.
ms.assetid: 5ecf5e94-5329-4abb-aedb-4e303688e5f7
keywords:
- Модель автоматизации пользовательского интерфейса, общие сведения о шаблоне текста
- Модель автоматизации пользовательского интерфейса, общие сведения об элементах управления текстом
- Модель автоматизации пользовательского интерфейса, шаблон элемента управления Text
- Модель автоматизации пользовательского интерфейса, общие сведения о внедренных объектах
- Модель автоматизации пользовательского интерфейса, предоставление внедренных объектов
- Автоматизация пользовательского интерфейса, сценарии для внедренных объектов
- текстовые шаблоны, сведения
- элементы управления текстом, сведения
- Шаблон элемента управления Text
- шаблоны элементов управления, текст
- внедренные объекты
- предоставление внедренных объектов
ms.topic: article
ms.date: 08/31/2019
ms.openlocfilehash: 2cb5a571d61353d2c8458b42fb65eac19eab0fb228f1e157539470075e392b8d
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119899362"
---
# <a name="how-ui-automation-exposes-embedded-objects"></a>Как модель автоматизации пользовательского интерфейса предоставляет внедренные объекты

В этом разделе описывается, как автоматизация пользовательского интерфейса Майкрософт использует шаблоны элементов управления Text и TextRange для предоставления внедренных объектов (дочерних и дочерних элементов) в текстовом документе или контейнере.

для автоматизации пользовательского интерфейса внедренный объект — это любой элемент с нетекстовыми границами, такими как изображение, гиперссылка, таблица или тип документа (Microsoft Excel электронная таблица, файл мультимедиа Microsoft Windows и т. д.).

> [!NOTE]
> Это отличается от определения OLE COM (см. [внедренные объекты](../com/embedded-objects.md)), где элемент создается в одном приложении и внедряется или связывается в другом приложении. Может ли объект быть отредактирован в исходном приложении в контексте модели автоматизации пользовательского интерфейса.

## <a name="embedded-objects-and-the-ui-automation-tree"></a>Внедренные объекты и дерево модели автоматизации пользовательского интерфейса

Внедренные объекты обрабатываются как отдельные элементы в представлении элемента управления дерева модели автоматизации пользовательского интерфейса. Они предоставляются как дочерние элементы контейнера текста, чтобы к ним можно было получить доступ через ту же объектную модель, что и другие элементы управления в модели автоматизации пользовательского интерфейса.

В следующей таблице перечислены примеры контейнеров и элементов, не являющихся контейнерами.

:::row:::
   :::column span="2":::

      **Элементы контейнера**

   :::column-end:::
   :::column span="":::

      **Элементы, не являющиеся контейнерами**

   :::column-end:::
:::row-end:::
:::row:::
   :::column span="":::

- Календарь
- Combobox
- DataGrid
- Документ
- Изменить
- Группа
- Заголовок
- HeaderItem
- Список
- Меню

   :::column-end:::
   :::column span="":::

- MenuBar
- Панель
- SplitButton
- Вкладка
- Таблица
- Панель инструментов
- Дерево
- TreeItem
- Окно

   :::column-end:::
   :::column span="":::

- Ссылка
- Флажки
- Кнопка

  :::column-end:::
:::row-end:::

На следующем рисунке показан контейнер текста (документ) с внедренной таблицей и изображением.

![Иллюстрация, показывающая документ с внедренной таблицей и изображением](images/embeddedtable.jpg)

На следующей схеме показано представление содержимого модели автоматизации пользовательского интерфейса для предыдущего документа.

![схема представления содержимого модели автоматизации пользовательского интерфейса для документа с внедренными объектами](images/contenttree.jpg)

### <a name="compatible-and-non-compatible-embedded-objects"></a>"Совместимые" и "несовместимые" внедренные объекты

Некоторые поставщики автоматизации пользовательского интерфейса используют одно и то же хранилище текста для каждого объекта TextPattern, который они содержат.  Объекты, поддерживающие то же хранилище текста, что и их контейнеры, называются "совместимыми" внедренными объектами. Эти объекты могут быть TextPattern самими объектами, и в этом случае их текстовые диапазоны сравнимы с текстовыми диапазонами, полученными из их контейнера. Это позволяет поставщикам предоставлять клиентские сведения об отдельных объектах TextPattern, как если бы они были одним, большим поставщиком текста.

Однако поставщики могут использовать различные хранилища текста для различных объектов TextPattern, внедренных в контейнер TextPattern. Объекты, не поддерживающие хранилище текста контейнера, называются несовместимыми внедренными объектами. Эти типы внедренных объектов могут и не быть объектами на основе TextPattern.  

В следующей таблице перечислены некоторые примеры совместимых и несовместимых внедренных объектов.

| Объекты  | Совместимые внедренные объекты | Несовместимые внедренные объекты |
| --- | --- | --- |
| Не TextPattern внедренные объекты | Кнопка в Microsoft Edge<br>Таблица данных в Microsoft Edge | В RichTextBlock в Microsoft XAML Framework<br>Изображения с Alt-Text в Microsoft Edge<br>ListView с ListItems в RichTextBlock в Microsoft XAML Framework |
| Внедренные объекты TextPattern | Элемент управления вводом типа "Text" в Microsoft Edge<br>Таблица в документе Word | элемент TextBox в Microsoft Word документе |

## <a name="exposing-embedded-objects"></a>Предоставление внедренных объектов

Шаблоны элементов управления [Text и TextRange](uiauto-implementingtextandtextrange.md) предоставляют свойства и методы, упрощающие навигацию и запросы к внедренным объектам.

Текстовое содержимое (или внутренний текст) текстового контейнера и внедренного объекта, например гиперссылки или ячейки таблицы, предоставляется в виде одного непрерывного текстового потока как в представлении элемента управления, так и в представлении содержимого дерева модели автоматизации пользовательского интерфейса. границы объектов игнорируются. Если клиент автоматизации пользовательского интерфейса извлекает текст для перебора, интерпретации или анализа каким-либо образом, текстовый диапазон должен проверяться на наличие особых случаев, таких как таблица с текстовым содержимым или другие внедренные объекты. Вызовите [**иуиаутоматионтекстранже:: Children**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren) , чтобы получить интерфейс [**иуиаутоматионелемент**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationelement) для каждого внедренного объекта, а затем вызовите [**иуиаутоматионтекстпаттерн:: ранжефромчилд**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild) , чтобы получить текстовый диапазон для каждого элемента. Это выполняется рекурсивно, пока не будет получено все текстовое содержимое.

> [!NOTE]
> Вырожденный (или свернутый) диапазон, где начальная конечная точка и конечная точка совпадают. Вырожденные диапазоны часто используются для обозначения позиции текстового курсора с помощью методов [итекстпровидер](/windows/win32/api/uiautomationcore/nn-uiautomationcore-itextprovider) - [SELECT](/windows/win32/api/uiautomationcore/nf-uiautomationcore-itextprovider-getselection) и [жеткаретранже](/windows/win32/api/uiautomationcore/nf-uiautomationcore-itextprovider2-getcaretrange) .

На следующей диаграмме показан поток текста с внедренными объектами и диапазонами их диапазонов.

![Схема, показывающая текстовый поток с внедренными объектами и диапазонами их диапазонов](images/rangespans.jpg)

## <a name="embedded-objects-and-textunit"></a>Внедренные объекты и Текстунит

Можно просмотреть объект [итекстпровидер](/windows/win32/api/uiautomationcore/nn-uiautomationcore-itextprovider) и заданный [текстунит](/windows/desktop/api/uiautomationcore/ne-uiautomationcore-textunit). Поставщики, содержащие внедренные объекты, могут просматриваться практически таким же образом, но внедренные объекты влияют на обход. Ниже приведены некоторые моменты, которые следует учитывать.

- Любой несовместимый внедренный объект представляется символом замены U + ФФФК в текстовом хранилище TextPattern элемента контейнера. Он также считается единицей символов и словом.
- Совместимые внедренные объекты могут состоять из нескольких символов и слов.
- Включающий элемент является самым нижним элементом, охватывающим весь текстовый диапазон.
- Дочерние элементы диапазона также являются дочерними элементами элемента контейнера, частично или полностью заключенного в диапазон.
- В идеале (особенно в случае элементов контейнера, например Table) граница слова не выходит за границы объекта. В следующем примере слово «Bar» не содержит текстовой позицией, которая находится за пределами `</td>` тега ( `<br \>` не является частью слова «Bar»).

```Xaml
<table style="width:100%">
  <tr>
    <th>Name</th>
    <th>Notes</th>
  </tr>
  <tr>
    <td>Eve Jackson</td>
    <td>Foo Bar</td>
  </tr>
</table>
<br/>
```

- В общем случае `<br \>` рассматривается как отдельное слово, которое не выходит за границы строки.
- Исключением из предыдущего правила является то, что единица текста слова содержит полные объекты внутри самого себя. Например, `<p>Hello <a href="#">link</a> here.</p>` , который включает встроенные контейнеры, содержит слова «Hello», «Link» и «here». Где "Link" содержит объект TextPattern как включающий элемент и объект ссылки в качестве дочернего элемента.
- В случае единиц символов объект является включающим элементом (такие текстовые единицы не должны иметь дочерние элементы).
- Объекты аннотации не должны быть представлены как внедренные объекты. Например, наличие других описателей автора в совместно созданном документе.
- Внедренные объекты занимают по крайней мере одну позицию курсора. Заметка — это просто метаданные.
- Каждая граница объекта (начало и конец) представляется разрывом формата в диапазоне документов TextPattern.
- Для HTML каждый HTML-тег не обязательно приводится к объекту автоматизации пользовательского интерфейса. Например, содержимое внутри <em></em> тегов выделения не должно быть представлено как элемент, а вместо текстового потока, где UIA_IsItalicAttributeId возвращает значение true.
- Начальная конечная точка является включающей и является предпочтительной конечной точкой, а конечная конечная точка — монопольной. Это полезно, когда диапазон вырожден, а начальная и конечная конечные точки принадлежат к одному и тому же положению для этого диапазона.

## <a name="comparing-embedded-objects"></a>Сравнение внедренных объектов

Вложенные объекты TextPattern, которые находятся в аналогичной дочерней связи и совместно используют одно и то же хранилище резервного текста, называются сравнимыми. В этом случае диапазоны из любого из объектов TextPattern можно сравнить с помощью [итекстранжепровидер:: Compare](/windows/win32/api/uiautomationcore/nf-uiautomationcore-itextrangeprovider-compare) и [Итекстранжепровидер:: компариндпоинтс](/windows/win32/api/uiautomationcore/nf-uiautomationcore-itextrangeprovider-compareendpoints). Оба значения приводят к допустимому числовому значению, задающему их относительное расположение.

НеTextPatternый объект, внедренный в объект TextPattern, сравним с TextPattern, если у объекта есть допустимый диапазон в TextPattern ([итекстпровидер:: ранжефромчилд](/windows/win32/api/uiautomationcore/nf-uiautomationcore-itextprovider-rangefromchild)), а содержимое за его пределами не является пустым и не является замещающим символом.

## <a name="embedded-textpattern-objects-and-the-document-textunit"></a>Внедренные объекты TextPattern и документ Текстунит

Для внедренных объектов TextPattern единица [документа](/windows/win32/api/uiautomationcore/ne-uiautomationcore-textunit) распознает только содержимое, содержащееся внутри этого элемента.

### <a name="word-textpattern-element-hierarchy"></a>Иерархия элементов Word TextPattern

- Элемент Document реализует TextPattern и [Document](/windows/win32/api/uiautomationcore/ne-uiautomationcore-textunit) возвращает весь диапазон документов Word.
- Отдельные страницы документа реализуют TextPattern, и [документ](/windows/win32/api/uiautomationcore/ne-uiautomationcore-textunit) возвращает содержимое этих отдельных страниц (даже несмотря на то, что страницы используют одно и то же хранилище текста вместе со всем документом TextPattern).

### <a name="webpage-and-text-input-controls-in-edge"></a>Элементы управления веб-страницы и ввода текста в границах

- Основной элемент области веб-страницы реализует TextPattern и предоставляет все содержимое веб-страницы.
- Отдельные элементы управления для ввода текста поддерживают TextPattern, где диапазон документов представляет текст, содержащийся в каждом поле ввода (даже если они используют одно и то же хранилище текста со всей веб-страницей).

## <a name="common-scenarios"></a>Распространенные сценарии

В этом разделе представлены примеры распространенных сценариев, в которых используются внедренные объекты: гиперссылки, изображения и таблицы. В следующих примерах левая фигурная скобка ({) представляет начальную конечную точку текстового диапазона, а правая фигурная скобка (}) — конечную конечную точку.

### <a name="hyperlink-example-1-a-text-range-that-contains-an-embedded-text-hyperlink"></a>Пример гиперссылки 1. текстовый диапазон, содержащий внедренную текстовую гиперссылку

Следующий текстовый диапазон содержит внедренную текстовую гиперссылку.

  {URL-адрес https://www.microsoft.com внедрен в текст}.

Вызов методов [**иуиаутоматионтекстранже:: GetText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext), [**жетенклосинжелемент**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement), [**Children**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren)и [**иуиаутоматионтекстпаттерн:: ранжефромчилд**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild) приводит к поведению, описанному в следующей таблице.

| Вызываемый метод                                                                                                                                                                                                                                                     | Результат                                                                                                                                                   |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**Иуиаутоматионтекстранже:: GetText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext)                                                                                                                                                                                  | Возвращает строку "URL-адрес https://www.microsoft.com внедрен в текст".                                                                               |
| [**Иуиаутоматионтекстранже:: Жетенклосинжелемент**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement)                                                                                                                                                          | Возвращает самый внутренний элемент модели автоматизации пользовательского интерфейса, охватывающий диапазон текста, в данном случае элемент автоматизации, представляющий самого поставщика текста. |
| [**Иуиаутоматионтекстранже:: дочерние элементы**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren)                                                                                                                                                                          | Возвращает элемент модели автоматизации пользовательского интерфейса, представляющий элемент управления HyperLink.                                                                                      |
| [**Иуиаутоматионтекстпаттерн:: ранжефромчилд**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild), где элемент автоматизации пользовательского интерфейса был возвращен предыдущим методом [**Иуиаутоматионтекстранже:: Children**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren) . | Возвращает диапазон, представляющий " https://www.microsoft.com ".                                                                                            |
### <a name="hyperlink-example-2-a-text-range-that-partially-spans-an-embedded-text-hyperlink"></a>Пример гиперссылки 2. текстовый диапазон, частично охватывающий внедренную текстовую гиперссылку

Следующий текстовый диапазон частично охватывает внедренную текстовую гиперссылку.

  URL-адрес https://{www} внедрен в текст.

Вызов методов [**иуиаутоматионтекстранже:: GetText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext), [**Жетенклосинжелемент**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement)и [**дочернего**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren) элемента приводит к поведению, описанному в следующей таблице.

| Вызываемый метод                                                                                            | Результат                                                                                                         |
|----------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------|
| [**Иуиаутоматионтекстранже:: GetText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext)                         | Возвращает строку "www".                                                                                      |
| [**Иуиаутоматионтекстранже:: Жетенклосинжелемент**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement) | Возвращает самый внутренний элемент модели автоматизации пользовательского интерфейса, охватывающий текстовый диапазон. в данном случае это элемент управления HyperLink. |
| [**Иуиаутоматионтекстранже:: дочерние элементы**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren)                 | Возвращает **значение NULL** , поскольку текстовый диапазон не охватывает всю строку URL-адреса.                                   |

### <a name="hyperlink-example-3-a-text-range-that-partially-spans-the-content-of-a-text-container"></a>Пример гиперссылки 3. текстовый диапазон, частично охватывающий содержимое текстового контейнера

Следующий текстовый диапазон частично охватывает содержимое текстового контейнера. Контейнер текста содержит внедренную текстовую гиперссылку, которая не является частью текстового диапазона.

  {URL-адрес} https://www.microsoft.com внедряется в текст.

Вызов методов [**иуиаутоматионтекстранже:: GetText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext), [**жетенклосинжелемент**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement)и [**Move**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-move) приводит к поведению, описанному в следующей таблице.

| Вызываемый метод                                                                                            | Результат                                                                                                                                                                                                                            |
|----------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**Иуиаутоматионтекстранже:: GetText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext)                         | Возвращает строку "URL-адрес".                                                                                                                                                                                                     |
| [**Иуиаутоматионтекстранже:: Жетенклосинжелемент**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement) | Возвращает самый внутренний элемент модели автоматизации пользовательского интерфейса, охватывающий диапазон текста, в данном случае элемент, представляющий сам поставщик текста.                                                                                     |
| [**Иуиаутоматионтекстранже:: Move**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-move)                               | Перемещает текстовый диапазон в «https://», поскольку текст гиперссылки состоит из отдельных слов. В этом случае гиперссылка не рассматривается как один объект.<br/> URL-адрес {http} внедряется в текст.<br/> |

### <a name="image-example-1-a-text-range-that-contains-an-embedded-image"></a>Пример изображения 1. текстовый диапазон, содержащий внедренное изображение

Следующий текстовый диапазон содержит внедренное изображение списка выбора.

 {Изображение ![Иллюстрация списка выбора](images/shuttle.jpg) внедрен в текст}.

Вызов методов [**иуиаутоматионтекстранже:: GetText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext), [**жетенклосинжелемент**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement), [**Children**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren)и [**иуиаутоматионтекстпаттерн:: ранжефромчилд**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild) приводит к поведению, описанному в следующей таблице.

| Вызываемый метод                                                                                                                                                                                                                                                    | Результат                                                                                                                                        |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------|
| [**Иуиаутоматионтекстранже:: GetText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext)                                                                                                                                                                                 | Возвращает строку "изображение внедрено в текст". Любой замещающий текст, связанный с изображением, не включается в текстовый поток.                |
| [**Иуиаутоматионтекстранже:: Жетенклосинжелемент**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement)                                                                                                                                                         | Возвращает самый внутренний элемент модели автоматизации пользовательского интерфейса, охватывающий диапазон текста, в данном случае элемент, представляющий сам поставщик текста. |
| [**Иуиаутоматионтекстранже:: дочерние элементы**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren)                                                                                                                                                                         | Возвращает элемент модели автоматизации пользовательского интерфейса, представляющий элемент управления изображения.                                                                               |
| [**Иуиаутоматионтекстпаттерн:: ранжефромчилд**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild) , где элемент автоматизации пользовательского интерфейса был возвращен предыдущим методом [**иуиаутоматионтекстранже:: дочернего**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getchildren) элемента. | Возвращает вырожденный диапазон.                                                                                                                 |

### <a name="image-example-2-a-text-range-that-partially-spans-the-content-of-a-text-container"></a>Пример изображения 2. текстовый диапазон, частично охватывающий содержимое текстового контейнера

Следующий текстовый диапазон частично охватывает содержимое текстового контейнера. Контейнер текста содержит внедренное изображение, которое не является частью текстового диапазона.

 {Изображение} ![Иллюстрация списка выбора](images/shuttle.jpg) внедряется в текст.

Вызов методов [**иуиаутоматионтекстранже:: GetText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext), [**жетенклосинжелемент**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement)и [**Move**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-move) приводит к поведению, описанному в следующей таблице.

| Вызываемый метод                                                                                                          | Результат                                                                                                                                                                                                                                                                          |
|------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**Иуиаутоматионтекстранже:: GetText**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-gettext)                                       | Возвращает строку "Изображение".                                                                                                                                                                                                                                                 |
| [**Иуиаутоматионтекстранже:: Жетенклосинжелемент**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement)               | Возвращает самый внутренний элемент модели автоматизации пользовательского интерфейса, охватывающий диапазон текста, в данном случае элемент, представляющий сам поставщик текста.                                                                                                                                   |
| [**Иуиаутоматионтекстранже:: Move**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-move) с параметрами (**текстунит \_ Word**, 2). | Перемещает текстовый диапазон к "is". Поскольку только внедренные текстовые объекты считаются частью текстового потока, изображение в этом примере не влияет на [**иуиаутоматионтекстранже:: Move**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-move) или его возвращаемое значение, в данном случае 2. |

### <a name="table"></a>Таблица

### <a name="table-example-1-gets-the-text-container-from-the-content-of-a-cell"></a>Пример таблицы 1. Получение текстового контейнера из содержимого ячейки

В следующей таблице возвращается текстовый контейнер из содержимого ячейки.

| Ячейка с изображением                                            | Ячейка с текстом |
|------------------------------------------------------------|----------------|
| ![Иллюстрация списка выбора](images/shuttle.jpg)           | X              |
| ![Иллюстрация пространства и области действия](images/space.jpg) | Д              |
| ![Иллюстрация микрообласти](images/microscope.jpg)     | Z              |

Вызов методов [**иуиаутоматионгридпаттерн::**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationgridpattern-getitem)иуиаутоматионтекстпаттерн: [**: ранжефромчилд**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild)и [**иуиаутоматионтекстранже:: GetEnclosingElement**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement) приводит к поведению, описанному в следующей таблице.

| Вызываемый метод                                                                                                                                                                                                                       | Результат                                                                                                                                                                                      |
|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**Иуиаутоматионгридпаттерн::-Item**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationgridpattern-getitem) с параметрами (0, 0).                                                                                                                        | Возвращает элемент модели автоматизации пользовательского интерфейса, представляющий содержимое ячейки таблицы, в данном случае элемент является элементом управления текстом.                                                               |
| [**иуиаутоматионтекстпаттерн:: ранжефромчилд**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild)                                                                                                                                  | Возвращает диапазон изображения ![Иллюстрация списка выбора](images/shuttle.jpg).                                                                                                            |
| [**Жетенклосинжелемент**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement) для объекта, возвращенного предыдущим методом [**Иуиаутоматионтекстпаттерн:: ранжефромчилд**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild) . | Возвращает элемент модели автоматизации пользовательского интерфейса, представляющий ячейку таблицы. В этом случае элемент — это элемент управления "текст", поддерживающий шаблон элемента управления [TableItem](uiauto-implementingtableitem.md) . |
| [**Иуиаутоматионтекстранже:: жетенклосинжелемент**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement) для объекта, возвращаемого предыдущим методом **жетенклосинжелемент** .                                                    | Возвращает элемент модели автоматизации пользовательского интерфейса, представляющий таблицу.                                                                                                                                   |
| [**Иуиаутоматионтекстранже:: жетенклосинжелемент**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextrange-getenclosingelement) для объекта, возвращаемого предыдущим методом **жетенклосинжелемент** .                                                    | Возвращает элемент модели автоматизации пользовательского интерфейса, представляющий самого поставщика текста.                                                                                                                 |

### <a name="table-example-2-gets-the-text-content-of-a-cell"></a>Пример таблицы 2. Получение текстового содержимого ячейки

Таблица в предыдущем примере получает текстовое содержимое ячейки.

Вызов методов [**иуиаутоматионгридпаттерн:: DataItem**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationgridpattern-getitem) и [**Иуиаутоматионтекстпаттерн:: ранжефромчилд**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild) приводит к поведению, описанным в следующей таблице.

| Вызываемый метод                                                                                                                                                                                                                                                          | Результат                                                                                                                     |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------|
| [**Иуиаутоматионгридпаттерн::-Item**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationgridpattern-getitem) с параметрами (1, 1).                                                                                                                                                            | Возвращает элемент модели автоматизации пользовательского интерфейса, представляющий содержимое ячейки таблицы. В этом случае элемент является элементом управления "текст". |
| [**Иуиаутоматионтекстпаттерн:: ранжефромчилд**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationtextpattern-rangefromchild) , где элемент автоматизации пользовательского интерфейса — это объект, возвращенный предыдущим методом [**иуиаутоматионгридпаттерн::**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomationgridpattern-getitem) GetObject. | Возвращает "Y".                                                                                                               |

При перемещении по документу по [**текстунит \_ строке**](/windows/desktop/api/UIAutomationCore/ne-uiautomationcore-textunit), если текстовый диапазон входит в внедренную таблицу, каждая строка текста в ячейке должна рассматриваться как линия.

## <a name="related-topics"></a>Связанные темы

### <a name="conceptual"></a>Основные понятия

- [О шаблонах элементов управления Text и TextRange](uiauto-about-text-and-textrange-patterns.md)
- [Атрибуты текста модели автоматизации пользовательского интерфейса](uiauto-textattributes.md)
- [Общие сведения о шаблонах элементов управления модели автоматизации пользовательского интерфейса](uiauto-controlpatternsoverview.md)
- [Поддержка модели автоматизации пользовательского интерфейса для текстового содержимого](uiauto-ui-automation-textpattern-overview.md)