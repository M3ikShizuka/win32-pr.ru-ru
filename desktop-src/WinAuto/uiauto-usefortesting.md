---
title: Использование Автоматизации Пользовательского Интерфейса для автоматизированного тестирования
description: В этом обзоре описывается, как можно использовать модель автоматизации пользовательского интерфейса Майкрософт в качестве платформы для программного доступа в сценариях автоматического тестирования.
ms.assetid: 192162f9-55bf-4111-9f15-c0d3b5af2ab7
keywords:
- Клиенты, автоматическое тестирование модели автоматизации пользовательского интерфейса
- Клиенты, автоматическое тестирование
- Клиенты, тестирование
- Клиенты, средства для автоматического тестирования
- Клиенты, средства автоматизации пользовательского интерфейса для автоматического тестирования
- Клиенты, тестирование модели автоматизации пользовательского интерфейса
- Автоматизация пользовательского интерфейса, автоматическое тестирование
- Автоматизация пользовательского интерфейса, тестирование
- Автоматизация пользовательского интерфейса, средства для автоматического тестирования
- автоматическое тестирование
- средства для автоматического тестирования
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 269ff32cae26f8bb8ea6bb5b55ac91f1e0486685
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104067982"
---
# <a name="using-ui-automation-for-automated-testing"></a>Использование Автоматизации Пользовательского Интерфейса для автоматизированного тестирования

В этом обзоре описывается, как можно использовать модель автоматизации пользовательского интерфейса Майкрософт в качестве платформы для программного доступа в сценариях автоматического тестирования.

Модель автоматизации пользовательского интерфейса предоставляет унифицированную объектную модели, позволяющую всем платформам пользовательского интерфейса предоставлять комплексные и широкие функциональные возможности в доступном и легко автоматизированном режиме.

Модель автоматизации пользовательского интерфейса была разработана в качестве последователя для Active Accessibility Майкрософт — платформы, разработанной для предоставления решения для обеспечения доступности элементов управления и приложений. Microsoft Active Accessibility не разрабатывалась с учетом автоматизации тестирования, хотя она составила эту роль из-за аналогичных требований к доступности и автоматизации. Модель автоматизации пользовательского интерфейса разработана специально для обеспечения надежной функциональности автоматического тестирования, а также предоставляет более качественные решения для специальных возможностей. Например, Microsoft Active Accessibility полагается на один интерфейс для предоставления сведений о пользовательском интерфейсе и для получения информации, необходимой для продуктов с поддержкой специальных возможностей; Модель автоматизации пользовательского интерфейса разделяет две модели.

Как поставщик, так и клиент должны реализовать автоматизацию пользовательского интерфейса, чтобы он был полезен в качестве средства автоматического тестирования. Поставщики автоматизации пользовательского интерфейса — это приложения, такие как Microsoft Word, Microsoft Excel и другие сторонние приложения или элементы управления, основанные на операционной системе Windows. Клиенты автоматизации пользовательского интерфейса включают скрипты автоматических тестов приложения и приложения специальных возможностей.

В этом разделе содержатся следующие подразделы.

-   [Модель автоматизации пользовательского интерфейса в поставщиках](#ui-automation-in-providers)
-   [Автоматизация пользовательского интерфейса в клиентах](#ui-automation-in-clients)
    -   [Программный доступ](#programmatic-access)
-   [Ключевые свойства для автоматизации тестирования](#key-properties-for-test-automation)
-   [Связанные инструменты и технологии](#related-tools-and-technologies)
-   [См. также](#related-topics)

## <a name="ui-automation-in-providers"></a>Модель автоматизации пользовательского интерфейса в поставщиках

Чтобы автоматизировать элемент пользовательского интерфейса, разработчик должен узнать, какие действия может выполнять конечный пользователь в объекте пользовательского интерфейса, используя стандартное взаимодействие с клавиатурой и мышью. После определения этих ключевых действий шаблоны элементов управления модели автоматизации пользовательского интерфейса, которые отражают функциональность и поведение элемента пользовательского интерфейса, должны быть реализованы в элементе управления. Например, взаимодействие пользователя с элементом управления "поле со списком" обычно включает развертывание и свертывание поля со списком для отображения или скрытия списка элементов, выбора элемента из списка или добавления нового значения с помощью клавиатуры.

В других моделях специальных возможностей разработчики должны собирать сведения непосредственно из отдельных кнопок, меню и других элементов управления. Каждый тип элемента управления имеет десятки дополнительных вариантов. Иными словами, хотя 10 разновидностей кнопки работают одинаково и выполняют одну и ту же функцию, все они должны рассматриваться как уникальные элементы управления. Нет способа узнать, что эти элементы управления функционально эквивалентны. Шаблоны элементов управления модели автоматизации пользовательского интерфейса были разработаны для представления этих общих поведений элементов управления. Для получения дополнительной информации см. [UI Automation Control Patterns Overview](uiauto-controlpatternsoverview.md).

Без единой модели шаблонов элементов управления, предоставляемых моделью автоматизации пользовательского интерфейса, средства тестирования и разработчики должны иметь зависящую от платформы информацию для предоставления свойств и поведения элементов управления в этой платформе. Поскольку несколько различных платформ пользовательского интерфейса могут одновременно присутствовать в операционных системах Windows, в том числе Microsoft Win32, Windows Forms и Windows Presentation Foundation (WPF), это может оказаться сложной задачей для тестирования нескольких приложений с помощью элементов управления, которые выглядят аналогичными. Например, в следующей таблице перечислены имена свойств конкретной платформы, необходимые для получения имени или текста, связанного с элементом управления "Кнопка", и показано эквивалентное свойство модели автоматизации пользовательского интерфейса.



| Тип элемента управления | Платформа пользовательского интерфейса | Свойство, зависящее от платформы | Свойство модели автоматизации пользовательского интерфейса |
|--------------|--------------|-----------------------------|------------------------|
| Кнопка       | WPF          | Содержимое                     | Name - свойство          |
| Кнопка       | Win32        | Заголовок                     | Name - свойство          |
| Образ        | HTML         | alt                         | Name - свойство          |



 

Поставщики автоматизации пользовательского интерфейса отвечают за сопоставление свойств, зависящих от платформы элементов управления, с эквивалентными свойствами модели автоматизации пользовательского интерфейса. Дополнительные сведения о реализации модели автоматизации пользовательского интерфейса в поставщике см. в разделе [руководством программиста поставщика автоматизации пользовательского интерфейса](uiauto-providerportal.md). Сведения о реализации шаблонов элементов управления см. в разделе [реализация шаблонов элементов управления модели автоматизации пользовательского интерфейса](uiauto-implementinguiautocontrolpatterns.md).

## <a name="ui-automation-in-clients"></a>Автоматизация пользовательского интерфейса в клиентах

Целью автоматизированных средств тестирования и сценариев является единообразная и повторяемая обработка пользовательского интерфейса. Например, это может затрагивать определенные элементы управления для модульного тестирования, а также записывать и выполнять скрипты тестирования, которые выполняют итерацию последовательности общих действий над группой элементов управления.

Сложность автоматизированных приложений — это сложность синхронизации теста с динамическим целевым объектом, например, элементом управления "список", например диспетчером задач Windows, который отображает список выполняющихся в данный момент приложений. Поскольку элементы в списке динамически обновляются вне элемента управления тестовым приложением, попытка повторить выбор определенного элемента в списке с любой согласованностью невозможна. Аналогичные проблемы могут возникнуть при попытке повторить простые изменения фокуса в пользовательском интерфейсе, который находится вне элемента управления тестовым приложением.

### <a name="programmatic-access"></a>Программный доступ

Программный доступ предоставляет возможность имитировать через код любое взаимодействие, обеспечиваемое традиционным вводом с помощью мыши и клавиатуры. Модель автоматизации пользовательского интерфейса обеспечивает программный доступ через пять компонентов:

-   Дерево модели автоматизации пользовательского интерфейса упрощает навигацию по структуре пользовательского интерфейса. Дерево строится на основе коллекции **HWND** s. Дополнительные сведения см. в разделе [Общие сведения о дереве автоматизации пользовательского интерфейса](uiauto-treeoverview.md).
-   Элементы автоматизации — это отдельные компоненты в пользовательском интерфейсе. Они часто могут быть более детализированными, чем **HWND**.
-   Свойства автоматизации предоставляют определенные сведения об элементах пользовательского интерфейса. Дополнительные сведения см. в разделе [UI Automation Properties Overview](uiauto-propertiesoverview.md).
-   Шаблоны элементов управления задают определенный аспект функциональности элемента управления; они могут состоять из свойств, методов, событий и сведений о структуре. Для получения дополнительной информации см. [UI Automation Control Patterns Overview](uiauto-controlpatternsoverview.md).
-   События автоматизации обеспечивают уведомления и информацию. Для получения дополнительной информации см. [UI Automation Events Overview](uiauto-eventsoverview.md).

## <a name="key-properties-for-test-automation"></a>Ключевые свойства для автоматизации тестирования

Возможность однозначной идентификации и последующего обнаружения любого элемента управления в пользовательском интерфейсе предоставляет базу для выполнения автоматических тестовых приложений в этом пользовательском интерфейсе. Свойства модели автоматизации пользовательского интерфейса, используемые клиентами и поставщиками для определения и поиска элементов управления, описаны в следующей таблице.



| Свойство     | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|--------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| AutomationId | Уникально отличает элемент автоматизации от его одноуровневых элементов. Не требуется поддержка свойства AutomationId. Если он доступен, свойство AutomationId элемента одинаково в любом экземпляре приложения, независимо от локального языка. Несмотря на то, что свойство AutomationId является уникальным среди элементов того же уровня, оно может быть уникальным для всего рабочего стола. Например, несколько экземпляров приложения или несколько представлений папок в проводнике Microsoft Windows могут содержать элементы с одинаковыми Аутоматионидпроперти, например "Системменубар". Клиенты не должны делать никаких предположений относительно Аутоматионидс, предоставляемых другими приложениями. AutomationId не гарантирует стабильной работы в разных выпусках или сборках приложения. |
| ControlType  | Определяет тип элемента управления, представленного элементом автоматизации. Из знания типа элемента управления могут быть получены важные сведения. Для получения дополнительной информации см. [UI Automation Control Types Overview](uiauto-controltypesoverview.md).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| Имя         | Текстовая строка, идентифицирующая или объясняющая назначение элемента автоматизации. Его следует использовать с осторожностью, так как он может быть локализован. Свойство Name не является уникальным идентификатором среди одноуровневых элементов. Для автоматизации тестирования клиенты должны использовать свойство AutomationId или свойство Рунтимеид.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| рунтимеид    | Массив целых чисел, представляющих идентификатор для элемента автоматизации. Идентификатор уникален на рабочем столе, но он гарантированно уникален только для пользовательского интерфейса рабочего стола, на котором он был создан. Идентификаторы можно использовать повторно с течением времени. Используйте [**иуиаутоматион:: компарилементс**](/windows/desktop/api/UIAutomationClient/nf-uiautomationclient-iuiautomation-compareelements) , чтобы определить, является ли элемент, который в настоящее время имеет определенный идентификатор среды выполнения, тем же элементом, который ранее имел этот идентификатор. Кроме того, может измениться формат свойства Рунтимеид. Он должен рассматриваться как непрозрачное значение и использоваться только для сравнения; Например, чтобы определить, находится ли элемент автоматизации в кэше.                                                                                                                       |



 

## <a name="related-tools-and-technologies"></a>Связанные инструменты и технологии

[Проверка](inspect-objects.md) (Inspect.exe) — это средство на основе Windows, которое можно использовать для сбора сведений об автоматизации пользовательского интерфейса для разработки и отладки поставщика и клиента. Проверка включена в пакет средств разработки программного обеспечения (SDK) для Windows.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Вопросы безопасности модели автоматизации пользовательского интерфейса](uiauto-securityoverview.md)
</dt> </dl>

 

 




