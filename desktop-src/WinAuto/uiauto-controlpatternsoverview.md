---
title: Общие сведения о шаблонах элементов управления модели автоматизации пользовательского интерфейса
description: Шаблон элемента управления — это реализация интерфейса, которая предоставляет определенный аспект функциональных возможностей элемента управления клиентским приложениям модели автоматизации пользовательского интерфейса Майкрософт.
ms.assetid: fdac2b9f-916a-495a-b187-c4d8086319ff
keywords:
- Модель автоматизации пользовательского интерфейса, общие сведения о шаблонах элементов управления
- Модель автоматизации пользовательского интерфейса, шаблоны динамических элементов управления
- шаблоны элементов управления, сведения
- шаблоны элементов управления, компоненты
- шаблоны элементов управления, клиенты
- шаблоны элементов управления, поставщики
- шаблоны элементов управления, Dynamic
- шаблоны элементов управления, интерфейсы
- интерфейсы, шаблоны элементов управления
- Клиенты, шаблоны элементов управления
- Шаблоны динамических элементов управления
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 51abcfd316f5ab892155cf248d5473bd4e387227
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127457755"
---
# <a name="ui-automation-control-patterns-overview"></a>Общие сведения о шаблонах элементов управления модели автоматизации пользовательского интерфейса

*Шаблон элемента управления* — это реализация интерфейса, которая предоставляет определенный аспект функциональных возможностей элемента управления клиентским приложениям модели автоматизации пользовательского интерфейса Майкрософт. Клиенты используют свойства и методы, предоставляемые с помощью шаблона элемента управления, для получения сведений о конкретной возможности элемента управления или для управления определенным аспектом поведения элемента управления. Например, элемент управления, представляющий табличный интерфейс, использует шаблон элемента управления [Grid](uiauto-implementinggrid.md) для представления числа строк и столбцов в таблице, а также для предоставления клиенту возможности извлечения элементов из таблицы.

Модель автоматизации пользовательского интерфейса использует шаблоны элементов управления для представления стандартных поведений элементов управления. Например, можно использовать шаблон элемента управления [Invoke](uiauto-implementinginvoke.md) для элементов управления, которые могут быть вызваны, например кнопки, и шаблон элемента управления [Scroll](uiauto-implementingscroll.md) для элементов управления с полосами прокрутки, такими как списки, представления списков или поля со списком. Поскольку каждый шаблон элемента управления представляет отдельную функциональность, шаблоны элементов управления можно комбинировать для описания полного набора функциональных возможностей, поддерживаемых определенным элементом управления.

> [!Note]  
> Агрегатный элемент управления создается с дочерними элементами управления, предоставляющими пользовательский интерфейс для функциональных возможностей, предоставляемых родительским элементом, и родитель должен реализовать все шаблоны элементов управления, которые обычно связаны с его дочерними элементами управления. В свою очередь те же шаблоны элементов управления не обязательно должны быть реализованы дочерними элементами управления.

 

Этот раздел состоит из следующих подразделов.

-   [Компоненты шаблонов элементов управления модели автоматизации пользовательского интерфейса](#ui-automation-control-pattern-components)
-   [Шаблоны элементов управления в поставщиках и клиентах](#control-patterns-in-providers-and-clients)
-   [Динамические шаблоны элементов управления](#dynamic-control-patterns)
-   [Шаблоны элементов управления и связанные интерфейсы](#control-patterns-and-related-interfaces)
-   [Связанные разделы](#related-topics)

## <a name="ui-automation-control-pattern-components"></a>Компоненты шаблонов элементов управления модели автоматизации пользовательского интерфейса

Шаблоны элементов управления поддерживают методы, свойства, события и связи, необходимые для определения дискретной части функциональности, доступной в элементе управления.

-   Методы позволяют клиентам автоматизации пользовательского интерфейса работать с элементом управления.
-   Свойства и события предоставляют сведения о функциональных возможностях и состоянии элемента управления.
-   Связь между элементом модели автоматизации пользовательского интерфейса и его родителем, дочерними элементами и элементами того же уровня описывает структуру элементов в дереве модели автоматизации пользовательского интерфейса.

Шаблоны элементов управления связаны с элементами управления, схожими с тем, как интерфейсы связаны с объектами модели COM. В модели COM можно запросить объект, чтобы узнать, какие интерфейсы он поддерживает, а затем использовать эти интерфейсы для доступа к функциональным возможностям. В модели автоматизации пользовательского интерфейса клиенты могут задавать, какие шаблоны элементов управления он поддерживает, а затем взаимодействовать с этим элементом управления через свойства, методы, события и структуры, предоставляемые поддерживаемыми шаблонами элементов управления.

## <a name="control-patterns-in-providers-and-clients"></a>Шаблоны элементов управления в поставщиках и клиентах

Поставщики автоматизации пользовательского интерфейса реализуют интерфейсы шаблонов элементов управления, чтобы предоставить соответствующее поведение для определенного фрагмента функциональности, поддерживаемого элементом управления. Эти интерфейсы не предоставляются напрямую клиентам, но используются ядром автоматизации пользовательского интерфейса для реализации другого набора клиентских интерфейсов. Например, поставщик предоставляет функции прокрутки для модели автоматизации пользовательского интерфейса через [**искроллпровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iscrollprovider), а модель автоматизации пользовательского интерфейса предоставляет функции клиентам через [**иуиаутоматионскроллпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationscrollpattern).

## <a name="dynamic-control-patterns"></a>Динамические шаблоны элементов управления

Некоторые элементы управления не всегда поддерживают один и тот же набор шаблонов элементов управления. Например, многострочный элемент управления "поле ввода" позволяет выполнять вертикальную прокрутку только в том случае, если она содержит больше строк текста, чем может быть отображена в видимой области. Прокрутка отключается при удалении достаточного объема текста, когда она становится ненужной. В этом примере [**иуиаутоматионскроллпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationscrollpattern) поддерживается динамически в зависимости от того, какой объем текста находится в поле ввода.

## <a name="control-patterns-and-related-interfaces"></a>Шаблоны элементов управления и связанные интерфейсы

В следующей таблице описаны шаблоны элементов управления модели автоматизации пользовательского интерфейса. В таблице также перечислены интерфейсы поставщика, используемые для реализации шаблонов элементов управления и интерфейсов клиента, используемых для доступа к ним.



| Имя                                                          | Интерфейс поставщика                                                      | Интерфейс клиента                                                                              | Описание                                                                                                                                                                                                                     |
|---------------------------------------------------------------|-------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [Комментарий](uiauto-implementingannotation.md)               | [**IAnnotationProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iannotationprovider)           | [**иуиаутоматионаннотатионпаттерн**](/windows/desktop/api/uiautomationclient/nn-uiautomationclient-iuiautomationannotationpattern)           | Используется для предоставления свойств заметки в документе, например комментариев на полях, подключенных к тексту документа.                                                                                           |
| [Dock](uiauto-implementingdock.md)                           | [**IDockProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idockprovider)                           | [**иуиаутоматиондоккпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationdockpattern)                           | Используется для элементов управления, которые могут быть закреплены в контейнере закрепления, например в панелях инструментов или палитрах инструментов.                                                                                                                            |
| [Перетаскивание](/windows/desktop/WinAuto/uiauto-implementingdrag)                       | [**IDragProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idragprovider)                           | [**иуиаутоматиондрагпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationdragpattern)                           | Используется для поддержки элементов управления с возможностью перетаскивания или элементов управления с перетаскиваемыми элементами.                                                                                                                                                           |
| [DropTarget](/windows/desktop/WinAuto/uiauto-implementingdroptarget)           | [**IDropTargetProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idroptargetprovider)               | [**иуиаутоматиондроптаржетпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationdroptargetpattern)               | Используется для поддержки элементов управления, которые могут быть целевыми объектами в операции перетаскивания.                                                                                                                                                   |
| [ExpandCollapse](uiauto-implementingexpandcollapse.md)       | [**IExpandCollapseProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iexpandcollapseprovider)       | [**иуиаутоматионекспандколлапсепаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationexpandcollapsepattern)       | Используется для элементов управления, которые могут быть развернуты или свернуты, например, для пунктов меню в приложении, таких как меню «файл».                                                                                                          |
| [Сетка](uiauto-implementinggrid.md)                           | [**IGridProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-igridprovider)                           | [**иуиаутоматионгридпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationgridpattern)                           | используется для элементов управления, поддерживающих функциональность сетки, таких как изменение размера и перемещение в указанную ячейку, например, представление крупных значков в Windows Explorer или простые таблицы в Microsoft Office Word.                               |
| [GridItem](uiauto-implementinggriditem.md)                   | [**IGridItemProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-igriditemprovider)                   | [**иуиаутоматионгридитемпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationgriditempattern)                   | Используется для элементов управления, имеющих ячейки в сетках. отдельные ячейки должны поддерживать шаблон GridItem, например, для каждой ячейки в подробном представлении Windows Explorer.                                                                   |
| [Invoke](uiauto-implementinginvoke.md)                       | [**IInvokeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iinvokeprovider)                       | [**иуиаутоматионинвокепаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationinvokepattern)                       | Используется для элементов управления, которые могут быть вызваны, таких как кнопки.                                                                                                                                                                         |
| [ItemContainer](uiauto-implementingitemcontainer.md)         | [**IItemContainerProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iitemcontainerprovider)         | [**иуиаутоматионитемконтаинерпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationitemcontainerpattern)         | Используется для элементов управления, которые могут содержать другие элементы.                                                                                                                                                                                 |
| [легацииакцессибле](uiauto-implementinglegacyiaccessible.md) | [**илегацииакцессиблепровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ilegacyiaccessibleprovider) | [**иуиаутоматионлегацииакцессиблепаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationlegacyiaccessiblepattern) | Используется для предоставления свойств и методов Microsoft Active Accessibility клиентам автоматизации пользовательского интерфейса.                                                                                                                                  |
| [MultipleView](uiauto-implementingmultipleview.md)           | [**IMultipleViewProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-imultipleviewprovider)           | [**иуиаутоматионмултиплевиевпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationmultipleviewpattern)           | Используется для элементов управления, которые могут переключаться между несколькими представлениями одного и того же набора сведений, данных или дочерних элементов, например элемента управления "представление списка", в котором данные доступны в представлениях эскизов, плиток, значков, списков или сведений. |
| [ObjectModel](uiauto-implementingobjectmodel.md)             | [**IObjectModelProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-iobjectmodelprovider)         | [**иуиаутоматионобжектмоделпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationobjectmodelpattern)             | Используется для предоставления указателя на модель базового объекта документа. Этот шаблон элемента управления позволяет клиенту переходить от элемента модели автоматизации пользовательского интерфейса к базовой объектной модели.                                          |
| [RangeValue](uiauto-implementingrangevalue.md)               | [**IRangeValueProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-irangevalueprovider)               | [**иуиаутоматионранжевалуепаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationrangevaluepattern)               | Используется для элементов управления, имеющих диапазон значений. Например, элемент управления "Счетчик", отображающий годы, может иметь диапазон 1900 – 2010, а элемент управления "Счетчик", отображающий месяцы, будет иметь диапазон от 1 до 12.                     |
| [Прокрутка](uiauto-implementingscroll.md)                       | [**IScrollProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iscrollprovider)                       | [**иуиаутоматионскроллпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationscrollpattern)                       | Используется для элементов управления, которые могут прокручиваться при наличии большего количества сведений, чем может быть отображено в видимой области элемента управления.                                                                                                     |
| [ScrollItem](uiauto-implementingscrollitem.md)               | [**IScrollItemProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iscrollitemprovider)               | [**иуиаутоматионскроллитемпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationscrollitempattern)               | Используется для элементов управления, имеющих отдельные элементы в списке, например элемент управления "список" в элементе управления "поле со списком".                                                                                                        |
| [Выбор](uiauto-implementingselection.md)                 | [**ISelectionProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iselectionprovider)                 | [**иуиаутоматионселектионпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationselectionpattern)                 | Используется для элементов управления контейнером выбора, например списков и полей со списком.                                                                                                                                                 |
| [SelectionItem](uiauto-implementingselectionitem.md)         | [**ISelectionItemProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iselectionitemprovider)         | [**иуиаутоматионселектионитемпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationselectionitempattern)         | Используется для отдельных элементов в элементах управления контейнера выделения, таких как списки и поля со списком.                                                                                                                                  |
| [Электронная таблица](uiauto-implementingspreadsheet.md)             | [**ISpreadsheetProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-ispreadsheetprovider)         | [**иуиаутоматионспреадшитпаттерн**](/windows/desktop/api/uiautomationclient/nn-uiautomationclient-iuiautomationspreadsheetpattern)         | Используется для предоставления содержимого электронной таблицы или другого документа сеточного типа. Элементы управления, реализующие шаблон элемента управления электронной таблицы, должны также реализовать шаблон элемента управления Grid.                                              |
| [SpreadsheetItem](uiauto-implementingspreadsheetitem.md)     | [**ISpreadsheetItemProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-ispreadsheetitemprovider) | [**иуиаутоматионспреадшититемпаттерн**](/windows/desktop/api/uiautomationclient/nn-uiautomationclient-iuiautomationspreadsheetitempattern) | Используется для предоставления свойств ячейки электронной таблицы или другого документа сеточного типа. Элементы управления, реализующие шаблон элемента управления Спреадшититем, должны также реализовать шаблон элемента управления GridItem.                          |
| [Стили](/windows/desktop/WinAuto/uiauto-implementingstyles)                   | [**IStylesProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-istylesprovider)                   | [**иуиаутоматионстилеспаттерн**](/windows/desktop/api/uiautomationclient/nn-uiautomationclient-iuiautomationstylespattern)                   | Используется для описания элемента пользовательского интерфейса с определенным стилем, заливкой, узором или формой.                                                                                                                                    |
| [SynchronizedInput](uiauto-implementingsynchronizedinput.md) | [**ISynchronizedInputProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-isynchronizedinputprovider) | [**иуиаутоматионсинчронизединпутпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationsynchronizedinputpattern) | Используется для элементов управления, которые принимают ввод с клавиатуры или мыши.                                                                                                                                                                          |
| [Таблица](uiauto-implementingtable.md)                         | [**ITableProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itableprovider)                         | [**иуиаутоматионтаблепаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtablepattern)                         | Используется для элементов управления, имеющих сведения о сетке и заголовке.                                                                                                                                                                      |
| [TableItem](uiauto-implementingtableitem.md)                 | [**ITableItemProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itableitemprovider)                 | [**иуиаутоматионтаблеитемпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtableitempattern)                 | Используется для элементов в таблице.                                                                                                                                                                                                      |
| [Text](uiauto-implementingtextandtextrange.md)               | [**ITextProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextprovider)                           | [**иуиаутоматионтекстпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextpattern)                           | Используется для элементов управления "Поле ввода" и документов, которые предоставляют текстовую информацию.                                                                                                                                                           |
| TextEdit                                                      | [**итекстедитпровидер**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itexteditprovider)               | [**иуиаутоматионтекстедитпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtexteditpattern)                   | Используется для элементов управления "поле ввода", которые изменяют текст программным способом, например элемент управления, выполняющий автоматическое исправление или обеспечивающий входную композицию.                                                                                     |
| [TextChild](textchild-control-pattern.md)                    | [**ITextChildProvider**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-itextchildprovider)            | [**иуиаутоматионтекстчилдпаттерн**](/windows/desktop/api/uiautomationclient/nn-uiautomationclient-iuiautomationtextchildpattern)             | Используется для доступа к ближайшему предку элемента, поддерживающему шаблон элемента управления Text.                                                                                                                                            |
| [TextRange](uiauto-implementingtextandtextrange.md)          | [**ITextRangeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itextrangeprovider)                 | [**иуиаутоматионтекстранже**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtextrange)                               | Используется для получения текстового содержимого, текстовых атрибутов и внедренных объектов из текстовых элементов управления, таких как элементы управления и документы редактирования.                                                                                        |
| [Переключение](uiauto-implementingtoggle.md)                       | [**IToggleProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itoggleprovider)                       | [**иуиаутоматионтогглепаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtogglepattern)                       | Используется для элементов управления, в которых можно переключать состояние, например флажки и пункты меню с флажками.                                                                                                                            |
| [Преобразование](uiauto-implementingtransform.md)                 | [**ITransformProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itransformprovider)                 | [**иуиаутоматионтрансформпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationtransformpattern)                 | Используется для элементов управления с возможностью изменения размера, перемещения и вращения. Обычно шаблон элемента управления Transform используется в конструкторах, формах, графических редакторах и графических приложениях.                                                 |
| [Значение](uiauto-implementingvalue.md)                         | [**IValueProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivalueprovider)                         | [**иуиаутоматионвалуепаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvaluepattern)                         | Используется для элементов управления, имеющих значение, не находящихся в указанном диапазоне, например средство выбора даты и времени.                                                                                                                |
| [VirtualizedItem](uiauto-implementingvirtualizeditem.md)     | [**IVirtualizedItemProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-ivirtualizeditemprovider)     | [**иуиаутоматионвиртуализедитемпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationvirtualizeditempattern)     | Используется для элементов управления, которые работают с элементами в виртуальном списке.                                                                                                                                                                       |
| [Окно](uiauto-implementingwindow.md)                       | [**IWindowProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iwindowprovider)                       | [**иуиаутоматионвиндовпаттерн**](/windows/desktop/api/UIAutomationClient/nn-uiautomationclient-iuiautomationwindowpattern)                       | Используется для Windows. Примеры — это окна приложений верхнего уровня, дочерние окна многодокументного интерфейса (MDI) и диалоговые окна.                                                                                                |



 

## <a name="related-topics"></a>Связанные разделы

<dl> <dt>

**Основные понятия**
</dt> <dt>

[Реализация шаблонов элементов управления модели автоматизации пользовательского интерфейса](uiauto-implementinguiautocontrolpatterns.md)
</dt> <dt>

[Сопоставление шаблона элемента управления для клиентов автоматизации пользовательского интерфейса](uiauto-controlpatternmapping.md)
</dt> </dl>

 

 