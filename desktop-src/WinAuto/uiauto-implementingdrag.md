---
title: Перетащите шаблон элемента управления
description: Содержит правила и соглашения по реализации шаблона элемента управления Drag с помощью Идрагпровидер, включая сведения о свойствах и методах. Шаблон элемента управления перетаскиванием используется для поддержки перетаскиваемых элементов управления или элементов управления с элементами, которые можно перетаскивать.
ms.assetid: 9853E9CB-D04B-4F67-8E9E-7F1F99BACEA7
keywords:
- Модель автоматизации пользовательского интерфейса, реализация шаблона элемента управления Drag
- Модель автоматизации пользовательского интерфейса, перетаскивание шаблона элемента управления
- Модель автоматизации пользовательского интерфейса, Идрагпровидер
- IDragProvider
- реализация шаблонов элементов управления для модели автоматизации пользовательского интерфейса
- Перетаскивание шаблонов элементов управления
- шаблоны элементов управления, Идрагпровидер
- шаблоны элементов управления, реализация перетаскивания UI Automation
- шаблоны элементов управления, перетащите
- интерфейсы, Идрагпровидер
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 548f0212eca37e1890596143f27e9af70e1fb19a
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104070225"
---
# <a name="drag-control-pattern"></a>Перетащите шаблон элемента управления

Содержит правила и соглашения по реализации шаблона элемента управления **Drag** с помощью [**идрагпровидер**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-idragprovider), включая сведения о свойствах и методах. Шаблон элемента управления **перетаскиванием** используется для поддержки перетаскиваемых элементов управления или элементов управления с элементами, которые можно перетаскивать.

## <a name="implementation-guidelines-and-conventions"></a>Правила и соглашения реализации

При реализации шаблона элемента управления **перетаскиванием** используйте следующие правила и соглашения:

-   Интерфейс [**идрагпровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idragprovider) поддерживает два разных стиля перетаскивания: исходный и конечный стили и стиль только для исходного кода. Необходимо выбрать стиль, который лучше подходит для сценариев перетаскивания:
    -   **Исходный или конечный стиль:** Каждая возможная цель перетаскивания представлена элементом, реализующим интерфейс [**идроптаржетпровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idroptargetprovider) . Во время операции перетаскивания события модели автоматизации пользовательского интерфейса Майкрософт берутся из элемента, который перетаскивается, и из элементов-приемников.
    -   **Стиль только для исходного кода:** Целевые объекты перетаскивания не представлены элементами модели автоматизации пользовательского интерфейса. Во время операции перетаскивания события берутся только из перетаскиваемого элемента.
-   [**Идрагпровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-idragprovider) — это интерфейс только для чтения, предназначенный для наблюдения за операциями перетаскивания. Его нельзя использовать для управления операцией перетаскивания. Операции перетаскивания можно автоматизировать, отправляя ввод мыши в элемент управления.
-   Требуется свойство [**идрагпровидер:: «не извлечено**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_isgrabbed) ».
-   Свойства [**идрагпровидер::D ропеффект**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffect) и [**Идрагпровидер::D ропеффектс**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffects) необходимы для реализации стиля только с исходным кодом и запрещены для реализации исходного и целевого стилей. В реализации в исходном и целевом стиле элементы Drop-Target можно запрашивать для своих эффектов перетаскивания.
-   Свойство [**идрагпровидер:: граббедитемс**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-getgrabbeditems) представляет собой перетаскивание нескольких элементов. Когда пользователь начинает операцию перетаскивания, необходимо создать новый элемент модели автоматизации пользовательского интерфейса, который будет служить элементом источника события. Этот новый элемент запускает все события, которые элемент источника мог бы запустить в исходном или целевом режиме или только исходный режим, в то время как ни один из элементов, которые в действительности не перемещаются, не запускает никаких событий. После завершения операции перетаскивания удалите элемент источника события.
-   Элемент должен вызывать события изменения свойств для свойств **дропеффект** ([**UIA \_ драгдропеффектпропертид**](uiauto-control-pattern-propids.md)) и **дропеффектс** ([**UIA \_ драгдропеффектспропертид**](uiauto-control-pattern-propids.md)) при их изменении. События изменения свойств для других свойств допускаются, но могут выводиться из обязательных событий **драгстарт** ([**UIA \_ Drag \_ драгстартевентид**](uiauto-event-ids.md)), **драгканцел** (UIA перетаскивания [**\_ \_ драгканцелевентид**](uiauto-event-ids.md)) и **драгкомплете** (драгкомплетивентид [**\_ перетаскивания \_**](uiauto-event-ids.md)).
-   

## <a name="required-members-for-idragprovider"></a>Обязательные члены для **идрагпровидер**

Для реализации интерфейса [**идрагпровидер**](/windows/desktop/api/uiautomationcore/nn-uiautomationcore-idragprovider) требуются следующие свойства и методы.



| Обязательные члены                                                                        | Тип члена | Примечания                                                                         |
|-----------------------------------------------------------------------------------------|-------------|-------------------------------------------------------------------------------|
| [**Извлечено**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_isgrabbed)                                     | Свойство    | Нет                                                                          |
| [**дропеффект**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffect)                                   | Свойство    | Требуется для реализации стиля, основанного только на источнике.                      |
| [**дропеффектс**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-get_dropeffects)                                 | Свойство    | Требуется, если для извлеченного элемента имеется несколько возможных эффектов перетаскивания. |
| [**жетграббедитемс**](/windows/desktop/api/UIAutomationCore/nf-uiautomationcore-idragprovider-getgrabbeditems)                         | Метод      | Требуется для операции перетаскивания с несколькими элементами.                                  |
| [**UIA \_ перетаскивания \_ драгстартевентид**](uiauto-event-ids.md)       | Событие       | Нет                                                                          |
| [**UIA \_ перетаскивания \_ драгканцелевентид**](uiauto-event-ids.md)     | Событие       | Нет                                                                          |
| [**UIA \_ перетаскивания \_ драгкомплетивентид**](uiauto-event-ids.md) | Событие       | Нет                                                                          |



 

## <a name="related-topics"></a>См. также

<dl> <dt>

[Типы элементов управления и поддерживаемые ими шаблоны элементов управления](uiauto-controlpatternmapping.md)
</dt> <dt>

[Шаблон элемента управления Дроптаржет](/windows/desktop/WinAuto/uiauto-implementingdroptarget)
</dt> <dt>

[Общие сведения о шаблонах элементов управления модели автоматизации пользовательского интерфейса](uiauto-controlpatternsoverview.md)
</dt> <dt>

[Общие сведения о дереве модели автоматизации пользовательского интерфейса](uiauto-treeoverview.md)
</dt> <dt>

[Поддержка модели автоматизации пользовательского интерфейса для перетаскивания](ui-automation-support-for-drag-and-drop.md)
</dt> </dl>

 

 