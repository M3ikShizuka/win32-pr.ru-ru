---
title: Как работает Active Accessibility
description: Microsoft Active Accessibility предназначен для поддержки специальных возможностей, называемых клиентами, взаимодействия со стандартными и настраиваемыми элементами пользовательского интерфейса других приложений и операционной системы.
ms.assetid: 29325f0a-c6ca-42b1-b85d-2671f7041034
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fdeffcebd96ffba804bfc24672bf867028e9b0c7
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/29/2020
ms.locfileid: "103890192"
---
# <a name="how-active-accessibility-works"></a>Как работает Active Accessibility

Microsoft Active Accessibility предназначен для поддержки специальных возможностей, называемых *клиентами*, взаимодействия со стандартными и настраиваемыми ЭЛЕМЕНТАМИ пользовательского интерфейса других приложений и операционной системы. Клиент Microsoft Active Accessibility — это любая программа, которая использует Microsoft Active Accessibility для доступа к элементам пользовательского интерфейса приложения, их обнаружения или управления ими. Клиенты включают специальные возможности, средства автоматизированного тестирования и некоторые обучающие приложения на основе компьютеров.

С помощью Active Accessibility Майкрософт клиентское приложение может:

-   Запрос сведений; Например, сведения об элементе пользовательского интерфейса в определенном месте.
-   Получение уведомлений об изменении информации; Например, когда элемент управления превращается в серый или изменяется при изменении текстовой строки.
-   Выполнение действий, влияющих на пользовательский интерфейс или содержимое документа; Например, нажмите кнопку "Отправить", раскрывающийся меню и выберите команду меню.

Приложения, которые взаимодействуют с и предоставляют сведения для клиентов, называются *серверами*. Сервер использует Active Accessibility Майкрософт для предоставления сведений о своих элементах пользовательского интерфейса клиентам. Любой элемент управления, модуль или приложение, использующее Microsoft Active Accessibility для предоставления сведений о пользовательском интерфейсе, считается сервером Microsoft Active Accessibility. Серверы взаимодействуют с клиентами, отправляя уведомления о событиях (например, вызов [**нотифивиневент**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent)) и реагируя на запросы клиентов на доступ к элементам пользовательского интерфейса (например, обработка сообщений [**WM \_ GetObject**](wm-getobject.md) , отправленных из [*олеакк*](uiauto-glossary.md)). Серверы предоставляют сведения через интерфейс [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) .

С помощью Microsoft Active Accessibility серверное приложение может:

-   Предоставьте сведения о пользовательских объектах пользовательского интерфейса и содержимом его клиентских окон.
-   Отправка уведомлений при изменении пользовательского интерфейса.

Например, чтобы позволить пользователю выбирать команды, которые являются командными на пользовательской панели инструментов текстового редактора, программа распознавания речи должна иметь информацию об этой панели инструментов. Поэтому обработчику слова необходимо сделать эту информацию доступной. Microsoft Active Accessibility предоставляет для текстового процессора средства для предоставления сведений о пользовательской панели инструментов и программе распознавания речи для получения этих сведений.

### <a name="client-applications-and-active-accessibility"></a>Клиентские приложения и Active Accessibility

Клиент Microsoft Active Accessibility должен получать уведомления при изменении пользовательского интерфейса сервера, чтобы он мог передать эту информацию пользователю. Чтобы гарантировать, что клиент уведомляется об изменениях пользовательского интерфейса, он использует механизм, именуемый событиями окна или Виневентс, для регистрации для получения уведомлений. Дополнительные сведения см. в разделе [виневентс](winevents-infrastructure.md).

Для получения сведений об определенном элементе пользовательского интерфейса и управлении им используются клиенты, использующие интерфейс модели COM (Майкрософт) компонента [**Active Accessibility.**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible)

Клиент может получить объект [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) для элемента пользовательского интерфейса следующими четырьмя способами:

-   Вызовите [**акцессиблеобжектфромвиндов**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromwindow) и передайте маркер окна элемента пользовательского интерфейса.
-   Вызовите [**акцессиблеобжектфромпоинт**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfrompoint) и передайте положение на экране, которое находится внутри ограничивающего прямоугольника элемента пользовательского интерфейса.
-   Установите обработчик WinEvent, получите уведомление и вызовите [**акцессиблеобжектфромевент**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent) , чтобы получить указатель интерфейса [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) для элемента пользовательского интерфейса, создавшего событие.
-   Вызовите метод [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) , такой как [**аккнавигате**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-accnavigate) или [**Get \_ аккпарент**](/windows/desktop/api/Oleacc/nf-oleacc-iaccessible-get_accparent) , чтобы перейти к другому объекту **IAccessible** .

 

 




