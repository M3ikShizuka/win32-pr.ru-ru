---
title: Обзор Виневентс и Active Accessibility
description: Microsoft Active Accessibility Servers вызывает Виневентс для уведомления клиентов об изменении объекта со специальными возможностями.
ms.assetid: a2d486ee-84ef-4c44-a832-dbc0dae81542
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b351b1ce7b6337c4ca0ac0827daff2978c6611af
ms.sourcegitcommit: 85688bbfbe5b121bc05ddf112d54c23a469dfbc0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/29/2020
ms.locfileid: "103987145"
---
# <a name="winevents-and-active-accessibility"></a>Виневентс и Active Accessibility

Microsoft Active Accessibility Servers вызывает *виневентс* для уведомления клиентов об изменении объекта со специальными возможностями. Существует множество условий, при которых сервер уведомляет клиента об изменении. Каждая [константа события](event-constants.md) , определенная корпорацией Майкрософт Active Accessibility, описывает условие, о котором уведомляется клиент. Например, Виневентс может дать сигнал:

- При создании или уничтожении объекта.
- Когда объект получает или теряет фокус.
- При изменении состояния или расположения объекта.
- При изменении любого свойства объекта.

Клиентские приложения не получают уведомления о событиях автоматически; они должны указывать, какие события они хотят получить, вызвав функцию [**сетвиневенсук**](/windows/desktop/api/Winuser/nf-winuser-setwineventhook) . При использовании **сетвиневенсук** клиент регистрируется для получения одного или нескольких событий и задает функцию-обработчик для обработки указанных событий. Клиенты могут использовать одну и ту же функцию-обработчик для обработки нескольких типов событий или могут использовать функции-обработчики несколько. Клиенты вызывают **сетвиневенсук** один раз для каждой функции-ловушки, которую необходимо зарегистрировать.

Функции-ловушки находятся в теле кода клиента, в библиотеке DLL, сопоставленной с процессом клиента, или в библиотеке DLL, сопоставленной с процессом сервера. Каждый из этих методов имеет свои преимущества и недостатки. Дополнительные сведения см. [в разделе функции-обработчики в контексте и вне контекста](in-context-and-out-of-context-hook-functions.md).

Чтобы уведомить клиентов о возникновении события, серверы вызывают [**нотифивиневент**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent). Система проверяет, установлены ли в клиентских приложениях функции-обработчики для события, и при необходимости вызывает соответствующие функции-обработчики.

При вызове функции-ловушки клиента он получает ряд параметров, описывающих событие, и объект, создавший событие. Чтобы получить доступ к объекту, создавшему событие, функция клиентского обработчика вызывает [**акцессиблеобжектфромевент**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent).

> [!NOTE]
> Если ни один клиент не зарегистрировался для получения Виневентс, влияние на производительность сервера для вызова [**нотифивиневент**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent) незначительно.
>
> Серверы вызывают [**нотифивиневент**](/windows/desktop/api/Winuser/nf-winuser-notifywinevent) для изменений только в собственных доступных объектах; они не вызывают **нотифивиневент** для изменений в предоставляемых системой элементах пользовательского интерфейса.

## <a name="event-driven-communication"></a>Связь Event-Driven

Клиенты должны зарегистрировать обработчик WinEvent, прежде чем они смогут получать уведомления WinEvent. Чтобы избежать ненужных обратных вызовов и повысить производительность, клиентам рекомендуется регистрировать только те события, которые они должны получить.

Внутри процедуры-ловушки клиент может вызвать [**акцессиблеобжектфромевент**](/windows/desktop/api/Oleacc/nf-oleacc-accessibleobjectfromevent) , чтобы получить объект [**IAccessible**](/windows/desktop/api/oleacc/nn-oleacc-iaccessible) для элемента, к которому применяется событие. С помощью этого объекта клиент может начать вызывать методы **IAccessible** для получения сведений или взаимодействия с элементом пользовательского интерфейса.

## <a name="related-topics"></a>См. также

[WinEvents](winevents-infrastructure.md)
