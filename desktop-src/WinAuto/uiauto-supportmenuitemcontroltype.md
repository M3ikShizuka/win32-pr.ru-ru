---
title: Тип элемента управления MenuItem
description: В этом разделе содержатся сведения о поддержке автоматизации пользовательского интерфейса Майкрософт для типа элемента управления MenuItem.
ms.assetid: a6a04489-8e28-44ff-a3b0-ecf19c24daab
keywords:
- Модель автоматизации пользовательского интерфейса, поддержка типа элемента управления MenuItem
- Модель автоматизации пользовательского интерфейса, тип элемента управления MenuItem
- Модель автоматизации пользовательского интерфейса, древовидная структура для типа элемента управления MenuItem
- Модель автоматизации пользовательского интерфейса, свойства для типа элемента управления MenuItem
- Модель автоматизации пользовательского интерфейса, шаблоны элементов управления для типа элемента управления MenuItem
- Модель автоматизации пользовательского интерфейса, события для типа элемента управления MenuItem
- Древовидные структуры, тип элемента управления MenuItem
- свойства, тип элемента управления MenuItem
- шаблоны элементов управления, тип элемента управления MenuItem
- события, тип элемента управления MenuItem
- Поддержка типа элемента управления MenuItem
- Тип элемента управления MenuItem
- типы элементов управления, древовидная структура для типа элемента управления MenuItem
- типы элементов управления, шаблоны элементов управления для типа элемента управления MenuItem
- типы элементов управления, поддержка MenuItem
- типы элементов управления, MenuItem
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4a48b94d7fc18cb9a8a6fe924fb73a250ab28708
ms.sourcegitcommit: 9b5faa61c38b2d0c432b7f2dbee8c127b0e28a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2021
ms.locfileid: "122482519"
---
# <a name="menuitem-control-type"></a>Тип элемента управления MenuItem

В этом разделе содержатся сведения о поддержке автоматизации пользовательского интерфейса Майкрософт для типа элемента управления **MenuItem** .

Элемент управления "Меню" позволяет иерархически организовать элементы, связанные с командами и обработчиками событий. в типичном Windowsном приложении строка меню содержит несколько пунктов меню (например, " **файл**", " **правка**" и " **окно**"), и каждый пункт меню отображает меню. Меню содержит набор пунктов меню (таких как **Создать**, **Открыть** и **Закрыть**), которые можно развернуть, чтобы отобразить дополнительные пункты меню или выполнить определенное действие, нажав соответствующий пункт.

В следующих разделах определяется необходимая древовидная структура модели автоматизации пользовательского интерфейса, свойства, шаблоны элементов управления и события для типа элемента управления **MenuItem** . Требования к автоматизации пользовательского интерфейса применяются ко всем элементам управления "пункт меню", в которых платформа или платформа пользовательского интерфейса интегрирует поддержку автоматизации пользовательского интерфейса для типов элементов управления и шаблонов элементов управления.

В этом разделе содержатся следующие подразделы.

-   [Типичная древовидная структура](#typical-tree-structure)
-   [Соответствующие свойства](#relevant-properties)
-   [Обязательные шаблоны элементов управления](#required-control-patterns)
-   [Обязательные события](#required-events)
-   [Проблемы прежних версий](#legacy-issues)
-   [Связанные темы](#related-topics)

## <a name="typical-tree-structure"></a>Типичная древовидная структура

В следующей таблице описывается типичный элемент управления и представление содержимого дерева модели автоматизации пользовательского интерфейса, которое относится к элементам управления "пункт меню" и описывает, что может содержаться в каждом представлении. Дополнительные сведения о дереве автоматизации пользовательского интерфейса см. в разделе [Общие сведения о дереве модели автоматизации пользовательского интерфейса](uiauto-treeoverview.md).




| Представление элемента управления | Представление содержимого | 
|--------------|--------------|
| <ul><li>MenuItem "Справка"<ul><li>Меню (подменю пункта меню «Справка»)<ul><li>MenuItem "Вызов справки"</li><li>MenuItem "О Блокноте"</li></ul></li></ul></li></ul> | <ul><li>MenuItem "Справка"<ul><li>MenuItem "Вызов справки"</li><li>MenuItem "О Блокноте"</li></ul></li></ul> | 




 

Представление элемента управления "пункт меню" имеет древовидную структуру модели автоматизации пользовательского интерфейса, показанную выше. Обратите внимание, что для лучшего иллюстрации структуры был добавлен пункт меню **справки** по строке меню.

Для представления содержимого **меню** отсутствует в дереве автоматизации пользовательского интерфейса, так как оно не передает пользователю значимую информацию.

## <a name="relevant-properties"></a>Соответствующие свойства

В следующей таблице перечислены свойства модели автоматизации пользовательского интерфейса, значения или определения которых особенно важны для типа элемента управления **MenuItem** . Дополнительные сведения о свойствах модели автоматизации пользовательского интерфейса см. в разделе [Получение свойств элементов модели автоматизации пользовательского интерфейса](uiauto-propertiesforclients.md).



| Свойство модели автоматизации пользовательского интерфейса                                                                                              | Значение        | Примечания                                                                                                                                                                                                                                                                                                                                                                    |
|---------------------------------------------------------------------------------------------------------------------|--------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**UIA \_ аутоматионидпропертид**](uiauto-automation-element-propids.md)                 | См. примечания.   | Значение этого свойства должно быть уникальным среди всех одноранговых элементов в необработанном представлении дерева модели автоматизации пользовательского интерфейса. Выделите свойство **AutomationId** для пункта меню, если известно, что элемент будет согласованным в разных экземплярах пользовательского интерфейса. Если элемент меню динамически заполняется и не является прогнозируемым, оставьте свойство **AutomationId** пустым. |
| [**UIA \_ баундингректанглепропертид**](uiauto-automation-element-propids.md)       | См. примечания.   | Внешний прямоугольник, содержащий весь элемент управления.                                                                                                                                                                                                                                                                                                                 |
| [**UIA \_ кликкаблепоинтпропертид**](uiauto-automation-element-propids.md)             | См. примечания.   | Поддерживается при наличии ограничивающего прямоугольника. Если не все точки внутри ограничивающего прямоугольника являются щелчками, а элемент выполняет специализированное тестирование нажатия, переопределите и предоставьте точку для щелчка.                                                                                                                                                                     |
| [**UIA \_ контролтипепропертид**](uiauto-automation-element-propids.md)                   | **MenuItem** |                                                                                                                                                                                                                                                                                                                                                                          |
| [**UIA \_ исконтентелементпропертид**](uiauto-automation-element-propids.md)         | TRUE         | Элемент управления «пункт меню» всегда включается в представление содержимого дерева модели автоматизации пользовательского интерфейса.                                                                                                                                                                                                                                                                                  |
| [**UIA \_ исконтролелементпропертид**](uiauto-automation-element-propids.md)         | TRUE         | Элемент управления "пункт меню" всегда включается в представление элемента управления дерева модели автоматизации пользовательского интерфейса.                                                                                                                                                                                                                                                                                  |
| [**UIA \_ искэйбоардфокусаблепропертид**](uiauto-automation-element-propids.md)   | См. примечания.   | Если элемент управления может получать фокус клавиатуры, он должен поддерживать это свойство.                                                                                                                                                                                                                                                                                                |
| [**UIA \_ локализедконтролтипепропертид**](uiauto-automation-element-propids.md) | См. примечания.   | Локализованная строка, соответствующая типу элемента управления **MenuItem** . Значение по умолчанию — "пункт меню" для en-US или English (США).                                                                                                                                                                                                                                  |
| [**UIA \_ намепропертид**](uiauto-automation-element-propids.md)                                 | См. примечания.   | Имя элемента управления "пункт меню" — это текст, который используется для подписи.                                                                                                                                                                                                                                                                                                          |



 

## <a name="required-control-patterns"></a>Обязательные шаблоны элементов управления

В следующей таблице перечислены шаблоны элементов управления модели автоматизации пользовательского интерфейса, которые должны поддерживаться элементами управления "пункт меню". Дополнительные сведения о шаблонах элементов управления см. в разделе [UI Automation Control Patterns Overview](uiauto-controlpatternsoverview.md).



| Шаблон элемента управления                                                   | Поддержка | Примечания                                                                                                                                                |
|-------------------------------------------------------------------|---------|------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**IExpandCollapseProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iexpandcollapseprovider) | Зависит | Если элемент управления можно развернуть или свернуть, реализуйте [**иекспандколлапсепровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iexpandcollapseprovider).                            |
| [**IInvokeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iinvokeprovider)                 | Зависит | Если элемент управления выполняет одно действие или команду, реализуйте [**IInvokeProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iinvokeprovider).                                     |
| [**ISelectionItemProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iselectionitemprovider)   | Зависит | Если элемент управления используется для выбора из списка вариантов между элементами меню, реализуйте [**иселектионитемпровидер**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-iselectionitemprovider). |
| [**IToggleProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itoggleprovider)                 | Зависит | Если элемент управления представляет параметр, который можно включить или отключить, реализуйте [**IToggleProvider**](/windows/desktop/api/UIAutomationCore/nn-uiautomationcore-itoggleprovider).                       |



 

## <a name="required-events"></a>Обязательные события

В следующей таблице перечислены события автоматизации пользовательского интерфейса, которые должны поддерживаться элементами управления "пункт меню". Дополнительные сведения о событиях см. в разделе [UI Automation Events Overview](uiauto-eventsoverview.md).



| Событие автоматизации пользовательского интерфейса                                                                                                                                                | Примечания                                                                                                                            |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------|
| [**UIA \_ аутоматионфокусчанжедевентид**](uiauto-event-ids.md)                                                                   |                                                                                                                                  |
| [**UIA \_**](uiauto-automation-element-propids.md) Событие изменения свойства баундингректанглепропертид.                              |                                                                                                                                  |
| [**UIA \_**](uiauto-control-pattern-propids.md) Событие изменения свойства експандколлапсикспандколлапсестатепропертид. | Если элемент управления поддерживает шаблон элемента управления [ExpandCollapse](uiauto-implementingexpandcollapse.md) , он должен поддерживать это событие. |
| [**UIA \_ Invoke \_ инвокедевентид**](uiauto-event-ids.md)                                                                                  | Если элемент управления поддерживает шаблон элемента управления [Invoke](uiauto-implementinginvoke.md) , он должен поддерживать это событие.                 |
| [**UIA \_**](uiauto-automation-element-propids.md) Событие изменения свойства исенабледпропертид.                                              | Если элемент управления поддерживает свойство « [**включено**](uiauto-automation-element-propids.md) », оно должно поддерживать это событие.         |
| [**UIA \_**](uiauto-automation-element-propids.md) Событие изменения свойства исоффскринпропертид.                                          | Если элемент управления поддерживает свойство [**исоффскрин**](uiauto-automation-element-propids.md) , он должен поддерживать это событие.       |
| [**UIA \_ SelectionItem \_ елементаддедтоселектионевентид**](uiauto-event-ids.md)                                    | Если элемент управления поддерживает шаблон элемента управления [SelectionItem](uiauto-implementingselectionitem.md) , он должен поддерживать это событие.   |
| [**UIA \_ SelectionItem \_ елементремоведфромселектионевентид**](uiauto-event-ids.md)                            | Если элемент управления поддерживает шаблон элемента управления [SelectionItem](uiauto-implementingselectionitem.md) , он должен поддерживать это событие.   |
| [**UIA \_ SelectionItem \_ елементселектедевентид**](uiauto-event-ids.md)                                                    | Если элемент управления поддерживает шаблон элемента управления [SelectionItem](uiauto-implementingselectionitem.md) , он должен поддерживать это событие.   |
| [**UIA \_ структуречанжедевентид**](uiauto-event-ids.md)                                                                               |                                                                                                                                  |
| [**UIA \_**](uiauto-control-pattern-propids.md) Событие изменения свойства тогглетогглестатепропертид.                                 | Если элемент управления поддерживает шаблон элемента управления [Toggle](uiauto-implementingtoggle.md) , он должен поддерживать это событие.                 |



 

## <a name="legacy-issues"></a>Проблемы прежних версий

Для пунктов меню Microsoft Win32 шаблон элемента управления [Toggle](uiauto-implementingtoggle.md) поддерживается только в том случае, если выбран пункт меню, и можно программно определить, требуется ли поддержка для шаблона элемента управления Toggle. Поскольку элемент меню Win32 не предоставляет возможность проверки, шаблон элемента управления Invoke поддерживается, если пункт меню не установлен. Шаблон элемента управления Invoke всегда поддерживается даже для пунктов меню, которые требуются только для поддержки шаблона элемента управления Toggle. Это значит, что клиенты не будут перепутаться, если элемент меню, поддерживающий шаблон элемента управления [Invoke](uiauto-implementinginvoke.md) (когда элемент меню был снят), больше не поддерживает этот шаблон, когда он становится установленным.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

**Зрения**
</dt> <dt>

[Общие сведения о типах элементов управления автоматизации пользовательского интерфейса](uiauto-controltypesoverview.md)
</dt> <dt>

[Общие сведения о модели автоматизации пользовательского интерфейса](uiauto-uiautomationoverview.md)
</dt> </dl>

 

 




