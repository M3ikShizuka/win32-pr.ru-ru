---
description: Поставщик свойств использует методы Ивбемпропертипровидер в качестве основного интерфейса для WMI. С помощью Ивбемпропертипровидер можно реализовать код для извлечения и изменения свойств класса и экземпляра.
ms.assetid: d08c2ca4-9f8a-4a27-80fc-688d7c56f5eb
ms.tgt_platform: multiple
title: Реализация основного интерфейса для поставщика свойств
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 942117547380000e0da7d22a5e933cba4b3ffced
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105712462"
---
# <a name="implementing-the-primary-interface-for-a-property-provider"></a>Реализация основного интерфейса для поставщика свойств

Поставщик свойств использует методы [**ивбемпропертипровидер**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbempropertyprovider) в качестве основного интерфейса для WMI. С помощью **ивбемпропертипровидер** можно реализовать код для извлечения и изменения свойств класса и экземпляра.

В следующей таблице перечислены методы [**ивбемпропертипровидер**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbempropertyprovider) , которые можно реализовать для поставщика свойств.



| Метод                                                   | Функция      |
|----------------------------------------------------------|--------------|
| [**GetProperty**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbempropertyprovider-getproperty) | Получения    |
| [**Putproperty изменил**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbempropertyprovider-putproperty) | Изменение |



 

> [!Note]  
> Поставщик свойств необходимо реализовать как внутрипроцессный поставщик. Инструментарий WMI инициализирует поставщики свойств, написанные как службы или исполняемые файлы, но никогда не будет [**вызывать их методы**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbempropertyprovider-getproperty) [**putproperty изменил**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbempropertyprovider-putproperty) и.

 

Если вы решили не поддерживать один из этих методов, поставщик может предоставить реализацию заглушки, которая возвращает **поставщик WBEM \_ E \_ \_ не \_** поддерживает.

Поставщик свойств определяет управляемый класс или экземпляр с помощью набора из трех квалификаторов: **пропертиконтекст**, **InstanceContext** и **классконтекст**. Инструментарий WMI передает строковые константы, описывающие эти три квалификатора поставщику свойств.

Поставщик свойств должен быть готов к обработке следующих типов квалификаторов контекста:

-   Квалификатор **InstanceContext** присоединяется к экземпляру и содержит сведения, которые применяются к каждому свойству в экземпляре.
-   Квалификатор **классконтекст** присоединяется к классу и содержит сведения, которые применяются к каждому экземпляру в классе. Например, в классе, используемом для хранения данных, предоставляемых поставщиком реестра, **классконтекст** может быть путем к разделу реестра, который содержит свойства, которые необходимо сообщить.
-   Квалификатор **пропертиконтекст** указывает зависящую от контекста информацию, относящуюся к свойству. Например, в классе, используемом для хранения данных, предоставляемых поставщиком реестра, **пропертиконтекст** указывает имя значения реестра, которое будет храниться в свойстве.

Эти квалификаторы могут работать вместе. Можно назначить значение **InstanceContext** и **пропертиконтекст** , чтобы сообщить поставщику о том, как обрабатывать определенные типы экземпляров. Например, можно пометить экземпляры, которые поставщик будет распознать как доступный для чтения, но получив только одно записываемое свойство.

Наиболее распространенный квалификатор — **пропертиконтекст**. Таким образом, WMI предоставляет квалификатор **динпропс** в качестве ярлыка. Инструментарий WMI считает, что каждое свойство в экземпляре, помеченном **динпропс** , также имеет квалификаторы **dynamic**, [**provider**](/windows/desktop/api/Provider/nl-provider-provider)и **пропертиконтекст** .

 

 



