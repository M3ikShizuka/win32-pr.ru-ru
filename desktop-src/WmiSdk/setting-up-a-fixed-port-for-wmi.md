---
description: Инструментарий WMI запускается как часть общего узла службы с портами, назначенными по протоколу DCOM по умолчанию. Однако службу WMI можно настроить для запуска в качестве единственного процесса на отдельном узле и указать фиксированный порт.
ms.assetid: 62908445-2a43-4a20-a998-e497c6ecf48e
ms.tgt_platform: multiple
title: Настройка фиксированного порта для WMI
ms.topic: article
ms.date: 05/31/2018
topic_type:
- kbArticle
api_name: ''
api_type: ''
api_location: ''
ms.openlocfilehash: 49c6d6b0bf42951766cfd813ccb4b5eed041600a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105712941"
---
# <a name="setting-up-a-fixed-port-for-wmi"></a>Настройка фиксированного порта для WMI

Инструментарий WMI запускается как часть общего узла службы с портами, назначенными по протоколу DCOM по умолчанию. Однако службу WMI можно настроить для запуска в качестве единственного процесса на отдельном узле и указать фиксированный порт.

Следующая процедура представляет собой автоматическую установку, позволяющую инструментарию WMI иметь фиксированный порт. Процедура использует программу командной строки [**Winmgmt**](winmgmt.md) .

**Настройка фиксированного порта для WMI**

1.  В командной строке введите команду **Winmgmt-стандалонехост** .
2.  Чтобы отключить службу WMI, введите команду **net останавливают "Инструментарий управления Windows (WMI)"** или используйте короткое имя команды **net останавливаться Winmgmt** .
3.  Снова запустите службу WMI на новом узле службы, введя **net start "Инструментарий управления Windows (WMI)"** или **net start Winmgmt** .
4.  Установите новый номер порта для службы WMI, введя **команду netsh firewall Add открытие портов TCP 24158 вмификседпорт**

Чтобы отменить любые изменения, внесенные в WMI, введите команду **Winmgmt/шаредхост**, а затем закройте и снова запустите службу Winmgmt.

## <a name="examples"></a>Примеры

Сценарий, который настраивает фиксированный порт для WMI, см. в следующем [примере кода](https://Gallery.TechNet.Microsoft.Com/Set-WmiSinglePortps1-20fa8389 )коллекции скриптов.

или пример кода PowerShell, который включает или отключает параметры порта WMI, см. пример [Set-вмисинглепорт](https://Gallery.TechNet.Microsoft.Com/Set-WmiSinglePortps1-20fa8389) в коллекции TechNet.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Подключение к инструментарию WMI на удаленном компьютере](connecting-to-wmi-on-a-remote-computer.md)
</dt> <dt>

[Устранение неполадок удаленных подключений WMI](connecting-to-wmi-remotely-starting-with-vista.md)
</dt> <dt>

[Размещение и безопасность поставщика](provider-hosting-and-security.md)
</dt> </dl>

 

 



