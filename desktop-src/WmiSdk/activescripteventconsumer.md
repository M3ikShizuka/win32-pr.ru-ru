---
description: Запускает предопределенный скрипт на произвольном языке скриптов при доставке события в него.
ms.assetid: 2c0aa216-4255-49ff-9bbd-d6c62b5b9139
ms.tgt_platform: multiple
title: Класс Активескриптевентконсумер
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- ActiveScriptEventConsumer
- ActiveScriptEventConsumer.CreatorSID
- ActiveScriptEventConsumer.KillTimeout
- ActiveScriptEventConsumer.MachineName
- ActiveScriptEventConsumer.MaximumQueueSize
- ActiveScriptEventConsumer.Name
- ActiveScriptEventConsumer.ScriptingEngine
- ActiveScriptEventConsumer.ScriptFileName
- ActiveScriptEventConsumer.ScriptText
api_type:
- DllExport
api_location:
- Scrcons.exe
ms.openlocfilehash: acf7ef4b4207f72cbaee61c0aaad8b2279419682bdddbeb4373c36c6868b8fce
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118557837"
---
# <a name="activescripteventconsumer-class"></a>Класс Активескриптевентконсумер

Класс **активескриптевентконсумер** запускает предопределенный скрипт на произвольном языке сценариев, когда в него доставляется событие. Этот класс является одним из стандартных потребителей событий, предоставляемых инструментарием WMI. Дополнительные сведения см. [в разделе Мониторинг и реагирование на события с помощью стандартных потребителей](monitoring-and-responding-to-events-with-standard-consumers.md).


```cmd
Mofcomp -n:root\<namespace> scrcons.mof
```



Можно настроить производительность всех экземпляров **активескриптевентконсумер** в системе, задав значения свойства [**timeout**](scriptingstandardconsumersetting.md) или **Максимумскриптс** в одном экземпляре **скриптингстандардконсумерсеттинг**.

## <a name="syntax"></a>Синтаксис

``` syntax
[AMENDMENT]
class ActiveScriptEventConsumer : __EventConsumer
{
  uint8  CreatorSID[] = {1,1,0,0,0,0,0,5,18,0,0,0};
  uint32 KillTimeout = 0;
  string MachineName;
  uint32 MaximumQueueSize;
  string Name;
  string ScriptingEngine;
  string ScriptFileName;
  string ScriptText;
};
```

## <a name="members"></a>Члены

Класс **активескриптевентконсумер** имеет следующие типы членов:

-   [Свойства](#properties)

### <a name="properties"></a>Элемент Property

Класс **активескриптевентконсумер** имеет следующие свойства.

<dl> <dt>

**креаторсид**
</dt> <dd> <dl> <dt>

Тип данных: массив **Uint8**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Массив, представляющий идентификатор безопасности (SID), который уникальным образом идентифицирует создателя потребителя событий активного скрипта. Это свойство наследуется от [**\_ \_ евентконсумер**](--eventconsumer.md).

</dd> <dt>

**киллтимеаут**
</dt> <dd> <dl> <dt>

Тип данных: **UInt32**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Число (в секундах), в течение которого разрешено выполнение скрипта. Если 0 (нуль), то есть значение по умолчанию, скрипт не будет завершен.

</dd> <dt>

**MachineName**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Имя компьютера, на который WMI отправляет события. По соглашению для потребителей Microsoft Standard, потребитель скриптов не может быть запущен удаленно. Сторонние потребители также могут использовать это свойство. Это свойство наследуется от [**\_ \_ евентконсумер**](--eventconsumer.md).

</dd> <dt>

**максимумкуеуесизе**
</dt> <dd> <dl> <dt>

Тип данных: **UInt32**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Максимальная очередь в байтах для потребителя событий активного скрипта. Это свойство наследуется от [**\_ \_ евентконсумер**](--eventconsumer.md).

</dd> <dt>

**Имя**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: чтение и запись
</dt> <dt>

Квалификаторы: [ **ключ**](standard-qualifiers.md)
</dt> </dl>

Уникальный идентификатор потребителя событий. При переименовании потребителя результатом будет два одинаковых потребителей с разными именами.

</dd> <dt>

**скриптфиленаме**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Имя файла, из которого считывается текст скрипта, предназначенное в качестве альтернативы указанию текста скрипта в свойстве **скрипттекст** . Это свойство должно иметь **значение NULL** , если свойство **Скрипттекст** не равно **null**.

> [!Note]  
> При указании **скриптфиленаме** важно защитить исполняемый файл, который вы запускаете. Если исполняемый файл не находится в безопасном месте или защищен с помощью строгого списка управления доступом (ACL), любой пользователь может заменить исполняемый файл другим. Дополнительные сведения об ACL см. [в разделе Создание дескриптора безопасности (SD) для нового объекта в C++](/windows/desktop/SecAuthZ/creating-a-security-descriptor-for-a-new-object-in-c--).

 

</dd> <dt>

**скриптинженгине**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Имя используемого обработчика скриптов, например "VBScript". Это свойство не может иметь **значение NULL**.

</dd> <dt>

**скрипттекст**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Текст скрипта, выраженный в языке, известном обработчику скриптов. Это свойство должно иметь **значение NULL** , если свойство **Скриптфиленаме** не равно **null**.

</dd> </dl>

## <a name="remarks"></a>Remarks

Этот класс является производным от абстрактного класса [**\_ \_ евентконсумер**](--eventconsumer.md) . Он находится в \\ пространстве имен корневой подписки.

Если текст скрипта указан в экземпляре потребителя события, он имеет доступ к экземпляру события в переменной среды скрипта **таржетевент**.

Скрипты выполняются в контексте безопасности LocalSystem. В качестве меры безопасности только администратор локальной системы или администратор домена может настроить потребитель сценариев. Права доступа не проверяются до времени выполнения. После настройки потребителя любой пользователь может запустить событие, вызывающее выполнение скрипта.

Сбой загрузки обработчика скриптов или синтаксического анализа и проверки сценария считается ошибкой. Коды возврата из скрипта и завершение скрипта с использованием времени ожидания также считаются ошибками.

Значение **скрипттекст** или **скриптфиленаме** должно быть не **null**. Если оба свойства имеют **значение NULL** или не **равны NULL**, создается ошибка.

Когда WMI запускается как служба, скрипты, запускаемые **активескриптевентконсумер** , не создают выходные данные экрана. Скрипты, использующие **MsgBox** , запускаются, но не отображают сведения на экране. Запуск службы WMI в качестве исполняемого файла не поддерживается, но Инструментарий WMI позволяет сценариям, использующим функцию **MsgBox** , отображать выходные данные или принимать вводимые пользователем данные. ни один из методов, предоставляемых объектом [WScript](/previous-versions//at5ydy31(v=vs.85)) , не может использоваться, так как **активескриптевентконсумер** не использует сервер сценариев (WSH) Windows.

## <a name="examples"></a>Примеры

[Процедура создания постоянной регистрации событий WMI для мониторинга файлов](https://Gallery.TechNet.Microsoft.Com/Create-Permenant-WMI-Event-f67ce5c2) в коллекции TechNet использует **активескриптевентконсумер** в составе сложного сценария для настройки постоянной регистрации событий WMI.

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|----------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows Vista<br/>                                                               |
| Минимальная версия сервера<br/> | Windows Server 2008<br/>                                                         |
| Пространство имен<br/>                | Корневая \\ Подписка<br/>                                                          |
| MOF<br/>                      | <dl> <dt>Скрконс. mof</dt> </dl> |
| DLL<br/>                      | <dl> <dt>Scrcons.exe</dt> </dl> |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[Классы стандартных потребителей](standard-consumer-classes.md)
</dt> <dt>

[Выполнение скрипта на основе события](running-a-script-based-on-an-event.md)
</dt> <dt>

[Получение событий в любое время](receiving-events-at-all-times.md)
</dt> <dt>

[Создание логического потребителя](creating-a-logical-consumer.md)
</dt> <dt>

[**\_\_евентконсумер**](--eventconsumer.md)
</dt> <dt>

[**скриптингстандардконсумерсеттинг**](scriptingstandardconsumersetting.md)
</dt> </dl>

 

