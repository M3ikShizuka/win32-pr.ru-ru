---
description: Поставщик — это объект модели COM, который выступает в качестве посредника между WMI и управляемым объектом.
ms.assetid: a4f537ba-9081-43b4-acff-4d206de3d9d7
ms.tgt_platform: multiple
title: Разработка поставщика WMI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9249c251f75f08f9e5142e70a507b0dced8f91df
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105711736"
---
# <a name="developing-a-wmi-provider"></a>Разработка поставщика WMI

Поставщик — это объект модели COM, который выступает в качестве посредника между WMI и управляемым объектом. Например, когда приложение или скрипт запрашивает данные диска с помощью WMI- [**класса \_ LogicalDisk Win32**](/windows/desktop/CIMWin32Prov/win32-logicaldisk) , данные получаются динамически через предварительно установленный [поставщик Win32](/windows/desktop/CIMWin32Prov/win32-provider).

Если требуется предоставить данные через инструментарий WMI для других приложений, можно создать неуправляемый поставщик кода, записав сервер COM или с помощью **мастеров WMI ATL** в Visual Studio. Поставщик управляемого кода можно написать с помощью инструментария WMI в платформа .NET Framework. В подразделах этого раздела описывается процесс записи неуправляемого поставщика COM.

> [!Note]  
> Чтобы гарантировать, что все определения классов WMI для управляемых объектов будут восстановлены в [*репозитории WMI*](gloss-w.md) в случае сбоя и перезапуска WMI, воспользуйтесь инструкцией препроцессора [**\# pragma автовосстановления**](pragma-autorecover.md) в MOF-файл (MOF-файл).

 

Поставщик состоит из классов, определенных в схеме [*MOF-файл (MOF)*](gloss-m.md) , и файла DLL, который выполняет функции поставщика. Например, MOF-файл, определяющий классы поставщика Win32, — это CIMWin32. mof, а библиотека DLL — CIMWin32.dll, они находятся в папке% WINDIR% \\ system32 \\ WBEM.

Схема MOF для поставщика может содержать несколько типов поставщиков. Например, [Поставщик журнала событий](/previous-versions/windows/desktop/eventlogprov/event-log-provider) имеет типы экземпляров, методов и поставщиков событий в одном MOF-файле с именем нтевт. mof. Рекомендуется собирать все классы и схему регистрации для связанных поставщиков в одном файле, а не создавать один файл для каждого класса.

Помимо использования предварительно установленных поставщиков, можно создать собственный поставщик для предоставления сведений об устройстве или работе программного обеспечения.

В следующей таблице перечислены основные задачи, которые создают поставщик.



| Задача                                                                                                                                                            | Описание                                                                                                                                      |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------|
| [Разработка классов MOF-файл (MOF)](designing-managed-object-format--mof--classes.md)                                                              | Разрабатывайте модель для сущностей, которыми вы хотите управлять с помощью WMI, и создайте файл MOF-файл (MOF) для описания схемы.<br/> |
| [Предоставление данных в WMI путем написания поставщика](supplying-data-to-wmi-by-writing-a-provider.md)                                                                  | Создайте самого базового поставщика, который связан с WMI.<br/>                                                                                |
| [Включение поставщика в приложение](incorporating-a-provider-in-an-application.md)                                                                    | Включите поставщик как компонент в приложение, если он не выполняется все время.<br/>                                         |
| [Регистрация поставщика](registering-a-provider.md)                                                                                                            | Зарегистрируйте поставщик с помощью COM и WMI.<br/>                                                                                               |
| [Инициализация поставщика](initializing-a-provider.md)                                                                                                          | Реализуйте интерфейсы [**ивбемпровидеринит**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinit) и [**ивбемпровидеринитсинк**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinitsink) .<br/>   |
| [Выполнение вызовов к WMI](making-calls-to-wmi.md)                                                                                                                  | Вызывайте интерфейсы WMI из поставщика.<br/>                                                                                                  |
| [Олицетворение клиента](impersonating-a-client.md)                                                                                                            | Настройка безопасности для доступа к клиентскому приложению.<br/>                                                                                          |
| [Обновление поставщика](updating-a-provider.md)                                                                                                                  | При необходимости Повысьте качество поставщика.<br/>                                                                                                       |
| [Выгрузка поставщика](unloading-a-provider.md)                                                                                                                | Удалите поставщик из памяти при завершении работы или при бездействии поставщика.<br/>                                                         |
| [Отладка поставщиков](debugging-providers.md) и [Конфигурация поставщика и устранение неполадок классов](provider-configuration-and-troubleshooting-classes.md) | Отладка поставщика с помощью средств, предоставляемых WMI.<br/>                                                                                 |
| [Получение и предоставление данных на 64-разрядном компьютере](getting-and-providing-data-on-a-64-bit-computer.md)                                                          | Оцените, нужен ли поставщик совместимости с 32-разрядным приложением, или поставщик 64-разрядной версии может предоставлять данные обоим клиентам.<br/>      |



 

В следующих разделах рассматриваются шаги, необходимые для записи различных типов поставщиков.

-   [Написание поставщика экземпляров](writing-an-instance-provider.md)
-   [Написание поставщика методов](writing-a-method-provider.md)
-   [Создание поставщика событий](writing-an-event-provider.md)
-   [Создание поставщика объектов событий](writing-an-event-consumer-provider.md)
-   [Написание поставщика класса](writing-a-class-provider.md)
-   [Создание поставщика свойств](writing-a-property-provider.md)
-   [Создание поставщика экземпляров в поставщике High-Performance](making-an-instance-provider-into-a-high-performance-provider.md)

 

