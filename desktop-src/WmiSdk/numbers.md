---
description: В MOF числа — это цифры, описывающие числовые значения. MOF предоставляет разнообразные типы данных, которые преобразуются в автоматизацию, а также позволяют использовать эти числа в разных форматах. В следующей таблице перечислены числовые значения, поддерживаемые MOF.
ms.assetid: 7a18ed36-9c12-42be-a4ee-0f6c0097b130
ms.tgt_platform: multiple
title: Числа (WMI)
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5f3441988bb91d4bb2f3742016f01cb69996e3dcb55081a6723d851ed74cc1cb
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118555152"
---
# <a name="numbers-wmi"></a>Числа (WMI)

В MOF числа — это цифры, описывающие числовые значения. MOF предоставляет разнообразные типы данных, которые преобразуются в автоматизацию, а также позволяют использовать эти числа в разных форматах. В следующей таблице перечислены числовые значения, поддерживаемые MOF.



| Тип данных  | Тип автоматизации | Описание                                                                                                                                                             |
|------------|-----------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **sint8**  | **VT \_ I2**      | 8-разрядное целое число со знаком.<br/>                                                                                                                                        |
| **sint16** | **VT \_ I2**      | 16-разрядное целое число со знаком.<br/>                                                                                                                                       |
| **sint32** | VT \_ I4          | 32-разрядное целое число со знаком.<br/>                                                                                                                                       |
| **sint64** | **VT \_ BSTR**    | 64-разрядное целое число со знаком в строковом формате. Этот тип соответствует шестнадцатеричному или десятичному формату в соответствии с правилами Американский национальный институт стандартов (ANSI) (ANSI) C.<br/> |
| **real32** | **VT \_ R4**      | 4-байтовое значение с плавающей запятой, которое соответствует институту стандартов электрических и электронных электроники, Inc. (IEEE).<br/>                                        |
| **real64** | **VT \_ R8**      | 8-байтовое значение с плавающей запятой, следующее за стандартом IEEE.<br/>                                                                                                  |
| **uint8**  | **VT \_ UI1**     | 8-разрядное целое число без знака.<br/>                                                                                                                                      |
| **uint16** | **VT \_ I4**      | 16-разрядное целое число без знака.<br/>                                                                                                                                     |
| **uint32** | **VT \_ I4**      | 32-разрядное целое число без знака.<br/>                                                                                                                                     |
| **uint64** | **VT \_ BSTR**    | 64-разрядное целое число без знака в форме строки. Этот тип следует шестнадцатеричному или десятичному формату в соответствии с правилами ANSI C.<br/>                                           |



 

Хотя при работе со службой автоматизации в коде MOF возникают некоторые изменения:

-   В качестве строк необходимо кодировать 64-разрядные целые числа.

    Автоматизация не поддерживает 64-разрядный целочисленный тип.

-   Типы автоматизации не всегда соответствуют типам данных, равным bit.

    Например, Автоматизация использует VT \_ I4 для возврата 16-разрядного значения без знака. Это несоответствие существует из-за проблем с расширением знака. Если автоматизация использовала VT \_ I2 вместо VT \_ I4, 65 536 будет выглядеть как значение 1, что приведет к проблемам с типами и диапазонами. Аналогичным образом, Автоматизация представляет тип **UInt32** как VT \_ I4, так как для него не существует целочисленного типа, содержащего **UInt32**.

-   Нет необходимости изменять представление для 8-разрядных чисел.

    Автоматизация поддерживает VT \_ UI1, 8-разрядный тип без знака.

MOF поддерживает длинные константы. Вы объявляете длинную константу, используя простую последовательность цифр с необязательным отрицательным знаком. Длинная константа не может превышать размер переменной, объявленной для ее хранения. Некоторые примеры длинных констант — 1000 и 12310.

MOF также поддерживает альтернативные числовые форматы. В следующей таблице перечислены специальные символы, которые необходимо использовать для описания шестнадцатеричных, двоичных и восьмеричных констант.



| Константа               | Специальный символ     | Пример                   |
|------------------------|-----------------------|---------------------------|
| Decimal<br/>     | Нет<br/>       | Val = 65<br/>       |
| Шестнадцатеричный<br/> | префикс 0x<br/>  | Val = 0x41 влево<br/>     |
| Восьмеричн<br/>       | Ведущие 0<br/>  | Val = 0101<br/>     |
| Двоичные данные<br/>      | Конец B<br/> | Val = 1000001B<br/> |



 

Константу с плавающей запятой можно использовать для представления экспоненциальной нотации, а также дробей, как показано далее:

``` syntax
3.14
-3.14
-1.2778E+02
```

WMI считает константы с плавающей запятой как типы **VT \_ R8** для автоматизации.

В следующем примере описываются объявления классов и экземпляров, демонстрирующие использование каждого из числовых типов данных для задания свойств.

``` syntax
Class NumericDataClass
 {
   [key] uint8 Duint8;
   SInt8       Dchar;
   UInt16      Dtword;
   Sint16      Dinst16;
   UInt32      Ddword;
   Sint32      Dinst1;
   Sint32      Dinst2;
   Sint32      Dinst3;
   Sint32      Dinst4;
   Sint32      Dinst5;
   Real32      Dfloat;
   Real64      Ddouble1;
   Real64      Ddouble2;
 };

instance of NumericDataClass
 {
   Duint8   =  122;
   Dchar    = -128;
   Dtword   =  30;
   Dinst16  = -1445;
   Ddword   =  6987777;
   Dinst1   = -455589;
   Dinst2   =  23;
   Dinst3   =  03;         // Base 8
   Dinst4   =  0xFe;       // Base 16
   Dinst5   =  11b;        // Base 2
   Dfloat   =  3.1478;
   Ddouble1 =  99987.3654;
   Ddouble2 =  2.3e-2;
 };
```

 

 




