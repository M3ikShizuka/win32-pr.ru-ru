---
description: Инструментарий WMI предоставляет унифицированный интерфейс для всех локальных или удаленных приложений или сценариев, которые получают данные управления из компьютерной системы, сети или предприятия.
ms.assetid: 41ba2a64-3322-48b8-a6ea-e468bfac06e2
ms.tgt_platform: multiple
title: Архитектура WMI
ms.topic: article
ms.date: 05/31/2018
topic_type:
- kbArticle
api_name: ''
api_type: ''
api_location: ''
ms.openlocfilehash: b90ee4f81c2afdfc222dd7d5d824f88bda122b73
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127342671"
---
# <a name="wmi-architecture"></a>Архитектура WMI

Инструментарий WMI предоставляет унифицированный интерфейс для всех локальных или удаленных приложений или сценариев, которые получают данные управления из компьютерной системы, сети или предприятия. Унифицированный интерфейс разработан таким образом, что клиентским приложениям и сценариям WMI не нужно вызывать широкий спектр программных интерфейсов (API) операционной системы. многие api не могут вызываться клиентами автоматизации, такими как скрипты или приложения Visual Basic. Другие API не выполняют вызовы к удаленным компьютерам.

Чтобы получить данные из WMI, напишите клиентский скрипт или приложение, обращающееся к [классам WMI](wmi-classes.md) , или предоставьте данные в WMI, записав [*поставщик WMI*](gloss-p.md). Дополнительные сведения см. [в разделе Использование WMI](using-wmi.md).

## <a name="objects-consumers-and-infrastructure-of-wmi"></a>Объекты, потребители и инфраструктура WMI

На следующей схеме показана связь между инфраструктурой WMI и поставщиками WMI и управляемыми объектами, а также показывается связь между инфраструктурой WMI и потребителями WMI.

![отношение между инфраструктурой WMI, поставщиками WMI и управляемыми объектами](images/wmi-architecture.png)

## <a name="wmi-components"></a>Компоненты WMI

В следующем списке описываются ключевые компоненты WMI.

-   Управляемые объекты и поставщики WMI

    Поставщик WMI — это COM-объект, который наблюдает за одним или несколькими [*управляемыми объектами*](gloss-m.md) для WMI. Управляемый объект — это логический или физический компонент предприятия, такой как жесткий диск, сетевой адаптер, система базы данных, операционная система, процесс или служба.

    Подобно драйверу, поставщик предоставляет инструментарий WMI с данными из управляемого объекта и обрабатывает сообщения от WMI управляемому объекту. Поставщики WMI состоят из DLL-файла и файла [*MOF-файл (MOF)*](gloss-m.md) , определяющего классы, для которых поставщик возвращает данные и выполняет операции. Поставщики, например приложения WMI C++, используют [API COM для WMI](com-api-for-wmi.md). Дополнительные сведения см. [в разделе Предоставление данных инструментарию WMI](providing-data-to-wmi.md).

    Примером поставщика является предварительно установленный [поставщик реестра](/previous-versions/windows/desktop/regprov/system-registry-provider), который обращается к данным в системном реестре. Поставщик реестра имеет один [*класс WMI*](gloss-w.md) [**стдрегпров**](/previous-versions/windows/desktop/regprov/stdregprov)с множеством методов, но не имеет свойств. Другие предварительно установленные поставщики, такие как [поставщик Win32](/windows/desktop/CIMWin32Prov/win32-provider), обычно имеют классы со многими свойствами, но с несколькими методами, такими как [**Win32 \_ Process**](/windows/desktop/CIMWin32Prov/win32-process) или [**Win32 \_ LogicalDisk**](/windows/desktop/CIMWin32Prov/win32-logicaldisk). DLL-файл поставщика реестра, Stdprov.dll, содержит код, который динамически возвращает данные при запросе клиентскими скриптами или приложениями.

    Файлы WMI MOF и DLL находятся в папке% WINDIR% \\ system32 \\ WBEM, а также в [инструментарии WMI Command-Line средства](wmi-command-line-tools.md), такие как [**Winmgmt.exe**](winmgmt.md) и [**Mofcomp.exe**](mofcomp.md). Классы поставщиков, такие как [**Win32 \_ LogicalDisk**](/windows/desktop/CIMWin32Prov/win32-logicaldisk), ОПРЕДЕЛЯЮТся в MOF-файлах, а затем компилируются в репозиторий WMI при запуске системы.

-   [Инфраструктура WMI](wmi-infrastructure.md)

    инфраструктура wmi — это компонент операционной системы Microsoft Windows, известный как служба WMI (winmgmt). В инфраструктуре WMI есть два компонента: ядро WMI и [*репозиторий WMI*](gloss-w.md).

    Репозиторий WMI упорядочен по [*пространствам имен*](gloss-n.md)WMI. Служба WMI создает некоторые пространства имен, такие как корневая папка \\ по умолчанию root \\ CIMV2 и корневая \\ Подписка при запуске системы, и предварительно устанавливает набор определений классов по умолчанию, включая [Классы Win32](/windows/desktop/CIMWin32Prov/win32-provider), [системные классы WMI](wmi-system-classes.md)и другие. Остальные пространства имен, обнаруженные в системе, создаются поставщиками для других частей операционной системы или продуктов. Дополнительные сведения и список поставщиков WMI, найденных в большинстве версий операционных систем, см. в разделе [поставщики WMI](wmi-providers.md).

    Служба WMI выступает в качестве посредника между поставщиками, приложениями управления и репозиторием WMI. В репозитории хранятся только статические данные об объектах, например классы, определенные поставщиками. Инструментарий WMI динамически получает данные от поставщика, когда клиент запрашивает его. Кроме того, можно настроить подписки на получение уведомлений о событиях от поставщика. Дополнительные сведения см. в разделе [наблюдение за событиями](monitoring-events.md).

-   Потребители WMI

    Потребитель WMI — это приложение управления или сценарий, взаимодействующий с инфраструктурой WMI. Приложение управления может запрашивать, перечислять данные, выполнять методы поставщиков или подписываться на события, вызывая [API COM для инструментария WMI](com-api-for-wmi.md) или [API скриптов для WMI](scripting-api-for-wmi.md). Единственными данными или действиями, доступными для управляемого объекта, например дискового накопителя или службы, являются те, которые предоставляет поставщик.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Использование инструментария WMI](using-wmi.md)
</dt> <dt>

[Поставщики WMI](wmi-providers.md)
</dt> <dt>

[Создание приложения или скрипта WMI](creating-a-wmi-application-or-script.md)
</dt> <dt>

[Задачи WMI для скриптов и приложений](wmi-tasks-for-scripts-and-applications.md)
</dt> <dt>

[Предоставление данных инструментарию WMI](providing-data-to-wmi.md)
</dt> <dt>

[Классы WMI](wmi-classes.md)
</dt> <dt>

[Мониторинг событий](monitoring-events.md)
</dt> <dt>

[Вызов метода](calling-a-method.md)
</dt> </dl>

 

 
