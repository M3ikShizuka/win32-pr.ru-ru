---
description: При написании высокопроизводительного поставщика, который наследует классы из Win32 \_ перфравдата, необходимо соблюдать определенные соглашения, чтобы инструментарий WMI мог передать данные в значения свойств.
ms.assetid: 04abb2f9-800f-497a-ac8f-8ef210746273
ms.tgt_platform: multiple
title: Поддержка класса Win32_PerfRawData
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e70c9899c88849c70265b019c1d73021c61cae4758c41f462349537bd2e806ab
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119050122"
---
# <a name="supporting-the-win32_perfrawdata-class"></a>Поддержка класса Win32 \_ перфравдата

При написании высокопроизводительного поставщика, который наследует классы из [**Win32 \_ перфравдата**](/windows/desktop/CIMWin32Prov/win32-perfrawdata), необходимо соблюдать определенные соглашения, чтобы инструментарий WMI мог передать данные в значения свойств.

> [!Note]  
> создание высокопроизводительного поставщика WMI для создания счетчиков производительности не рекомендуется в любой версии операционной системы Windows. Дополнительные сведения см. в разделе [Создание поставщика экземпляров в поставщике High-Performance](making-an-instance-provider-into-a-high-performance-provider.md)и [библиотеках производительности и WMI](performance-libraries-and-wmi.md).

 

В следующей процедуре описывается поддержка класса [**Win32 \_ перфравдата**](/windows/desktop/CIMWin32Prov/win32-perfrawdata) в высокопроизводительном поставщике.

**Поддержка \_ класса Win32 перфравдата**

1.  Создайте класс в корневом \\ пространстве имен CIMv2.

    Класс должен быть производным от [**Win32 \_ перфравдата**](/windows/desktop/CIMWin32Prov/win32-perfrawdata) и иметь квалификатор **HiPerf** со значением **true**. Можно также добавить классы данных производительности WDM (driver) в корневое \\ пространство имен WMI. Дополнительные сведения о создании собственного класса для WMI см. в разделе [Разработка классов MOF-файл (MOF)](designing-managed-object-format--mof--classes.md).

2.  В квалификаторе поставщика укажите для поставщика значение "преобразовать права NT5 \_ женерикперфпровидер \_ v1". 
3.  Укажите следующие квалификаторы уровня класса:

    -   **HiPerf**
    -   **Локаль**
    -   **перфдетаил**
    -   **Поставщик**

    Дополнительные сведения см. в разделе [**Квалификаторы класса для классов счетчиков производительности**](class-qualifiers-for-performance-counter-classes.md). Не определяйте квалификатор **женерикперфктр** , так как он зарезервирован для процесса ADAP, который передает данные библиотеки производительности в классы WMI.

4.  Заполните соответствующие свойства timestamp и Frequency, используемые для вычисления формул типа счетчика.

    Эти свойства наследуются от [**Win32 \_ перфравдата**](/windows/desktop/CIMWin32Prov/win32-perfrawdata) , и при написании высокопроизводительного поставщика необходимо заполнить их, чтобы класс отображался в системном мониторе.

5.  Включите в класс ключевое свойство с именем **Name** (это свойство не требуется для одноэлементных классов).

    Не следует использовать ключевое свойство, кроме **Name** , в классе.

6.  Создайте свойства с типом данных **DWORD** (**UInt32**) или **QWORD** (**UInt64**). Эти свойства становятся счетчиками производительности при передаче в библиотеки производительности.
7.  Укажите следующие квалификаторы уровня свойств для всех свойств в классе:

    -   **Отображаемое имя**
    -   **CounterType**
    -   **дефаултскале**
    -   **Описание**
    -   **перфдефаулт**
    -   **перфдетаил**

    Дополнительные сведения см. в разделе [**Квалификаторы свойств для классов счетчиков производительности**](property-qualifiers-for-performance-counter-classes.md). Кроме того, файл заголовка Винперф. h содержит значения, которые можно указать для **перфдетаил** и **CounterType**.

    Инструментарий WMI использует квалификаторы **DisplayName**, **locale** и **Description** для локализации. Необходимо добавить измененные квалификаторы в \_ пространство имен MS 409 (на английском языке), чтобы системный монитор мог правильно отображать данные класса. Это означает, что вы измените определение свойства, добавив квалификатор **Description** с пояснительным текстом и заполнив значение **DisplayName** . Кроме того, необходимо добавить измененные квалификаторы в любое другое пространство имен языкового стандарта, поддерживаемое вашим классом. Если пользователь запрашивает данные из языкового стандарта, для которого не предоставлены измененные квалификаторы, WMI по умолчанию принимает определения, указанные в \_ пространстве имен MS 409.

8.  Создайте базовое свойство для любого свойства, имеющего тип счетчика, ожидающего базового значения.

    Это свойство следует непосредственно за свойством и называется * PropertyName ***\_ base**. Например, для вычисления числа выборок в среднем свойству **авгдискбитесперреад** в классе [**\_ \_ \_ LogicalDisk Win32 перфравдата перфдиск**](./retrieving-raw-and-formatted-performance-data.md) требуется базовое свойство с именем **авгдискбитесперреад \_ base** . Чтобы определить, требуется ли для используемого типа счетчика базовое свойство, найдите тип счетчика по имени или десятичному значению в списке [типы счетчиков производительности WMI](wmi-performance-counter-types.md).

9.  Убедитесь, что поставщик отвечает [требованиям к производительности](supporting-the-win32-perfformatteddata-class.md).

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Создание поставщика экземпляров в поставщике High-Performance](making-an-instance-provider-into-a-high-performance-provider.md)
</dt> </dl>

 

 
