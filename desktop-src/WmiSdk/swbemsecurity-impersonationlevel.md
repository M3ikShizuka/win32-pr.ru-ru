---
description: Свойство Имперсонатионлевел — это целое число, определяющее уровень олицетворения COM, назначенный этому объекту.
ms.assetid: cf57620b-7827-4552-a969-d25e5eb13a89
ms.tgt_platform: multiple
title: Свбемсекурити. Имперсонатионлевел, свойство
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- SWbemSecurity.ImpersonationLevel
- ISWbemSecurity.ImpersonationLevel
api_type:
- COM
api_location:
- Wbemdisp.dll
ms.openlocfilehash: 3b996d5920aba91fddf880ee9ddf6bf8081fb39f
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127058330"
---
# <a name="swbemsecurityimpersonationlevel-property"></a>Свбемсекурити. Имперсонатионлевел, свойство

Свойство **имперсонатионлевел** — это целое число, определяющее уровень олицетворения COM, назначенный этому объекту. этот параметр определяет, могут ли процессы, принадлежащие инструментарий управления Windows (WMI) (WMI), обнаруживать или использовать учетные данные безопасности при вызове других процессов. Дополнительные сведения об уровнях олицетворения см. в разделе [Настройка \_ \_ безопасности процесса обработки клиентских приложений](setting-client-application-process-security.md).

Если уровень олицетворения не задан специально в моникере или при установке свойства **свбемсекурити. имперсонатионлевел** защищаемого объекта, WMI устанавливает для уровня олицетворения по умолчанию значение, указанное в [разделе реестра уровня олицетворения по умолчанию](setting-the-default-process-security-level-using-vbscript.md). Если этот параметр недостаточен, поставщик не будет обслуживать запрос, а вызов API WMI может завершиться с кодом ошибки **вбемерракцессдениед** (2147749891/0x80041003).

Описание этого синтаксиса см. в разделе [соглашения о документе для API скриптов](document-conventions-for-the-scripting-api.md).

Это свойство доступно для чтения и записи.

## <a name="syntax"></a>Синтаксис


```VB
SWbemSecurity.ImpersonationLevel As Integer
```



## <a name="property-value"></a>Значение свойства

## <a name="remarks"></a>Remarks

В качестве уровня олицетворения DCOM этому свойству может быть присвоено одно из следующих значений:



| Значение           | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|-----------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Анонимный**   | Скрывает учетные данные вызывающей стороны. Инструментарий WMI на самом деле не поддерживает этот уровень олицетворения. Если скрипт указывает Имперсонатионлевел = Anonymous, WMI автоматически обновит уровень олицетворения, чтобы он определялся. Тем не менее, это может быть вызвано небессмысленным упражнением, так как сценарии, использующие уровень Identify, скорее всего, завершатся ошибкой.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| **Указывается**    | Позволяет объектам запрашивать учетные данные вызывающей стороны. Вероятнее всего, скрипты, использующие этот уровень олицетворения, будут завершаться ошибкой. уровень Identify обычно позволяет не только проверять списки управления доступом. Вы не сможете выполнять сценарии на удаленных компьютерах с помощью команды Identify.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| **Impersonate** | Позволяет объектам использовать учетные данные вызывающей стороны. Рекомендуется использовать этот уровень олицетворения с помощью скриптов WMI. При этом сценарий WMI будет использовать ваши учетные данные пользователя. в результате он сможет выполнять любые задачи, которые вы можете выполнить.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| **Делегат**    | Позволяет объектам разрешающим другим объектам использовать учетные данные вызывающей стороны. Делегирование позволяет сценарию использовать ваши учетные данные на удаленном компьютере, а затем позволяет этому удаленному компьютеру использовать ваши учетные данные на другом удаленном компьютере. Хотя этот уровень олицетворения можно использовать в сценариях WMI, это необходимо сделать только при необходимости, так как это может представлять угрозу безопасности.<br/> Нельзя использовать уровень олицетворения делегирования, если все учетные записи пользователей и компьютеры, вовлеченные в транзакцию, не помечены как доверенные для делегирования в Active Directory. Это помогает снизить риски безопасности. Хотя удаленный компьютер может использовать ваши учетные данные, он может сделать это только в том случае, если он и другие компьютеры, вовлеченные в транзакцию, являются доверенными для делегирования.<br/> |



 

Как уже отмечалось, анонимное олицетворение скрывает учетные данные и позволяет удаленному объекту запрашивать учетные данные, но удаленный объект не может олицетворять контекст безопасности. (Иными словами, несмотря на то, что удаленный объект знает, что у вас есть, он не может полагаться на вас.) Сценарии WMI, обращающиеся к удаленным компьютерам с помощью одного из этих двух параметров, обычно завершаются ошибкой. На самом деле большинство сценариев, выполняемых на локальном компьютере с использованием одного из этих двух параметров, также завершатся ошибкой.

Олицетворение позволяет удаленной службе WMI использовать контекст безопасности для выполнения запрошенной операции. Удаленный запрос WMI, использующий параметр олицетворения, обычно выполняется успешно, если учетные данные имеют достаточные привилегии для выполнения требуемой операции. Иными словами, вы не можете использовать инструментарий WMI для выполнения действий (удаленно или иным образом), которые не имеют разрешения на выполнение вне инструментария WMI.

Установка параметра Имперсонатионлевел в значение Delegate позволяет удаленной службе WMI передавать ваши учетные данные другим объектам и обычно считается угрозой безопасности.

Можно задать уровень олицетворения объекта [**SwbemServices**](swbemservices.md), [**SWbemObject**](swbemobject.md), [**SWbemObjectSet**](swbemobjectset.md), [**Свбемобжектпас**](swbemobjectpath.md)и [**SwbemLocator**](swbemlocator.md) , задав для свойства **имперсонатионлевел** нужное значение. В следующем примере показано, как задать уровень олицетворения для объекта **SWbemObject** :


```VB
objinstance.Security_.ImpersonationLevel = _
    wbemImpersonationLevelImpersonate
```



Кроме того, можно указать уровни олицетворения как часть моникера. В следующем примере задается уровень проверки подлинности и уровень олицетворения, а также извлекается экземпляр [**\_ службы Win32**](/windows/desktop/CIMWin32Prov/win32-service).


```VB
Set objinst = GetObject("WinMgmts:{impersonationLevel=impersonate,"& _
                         "authenticationLevel=pktPrivacy}"& _
                         "!root/cimv2:Win32_service='ALERTER'")
```



## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows Vista<br/>                                                                |
| Минимальная версия сервера<br/> | Windows Server 2008<br/>                                                          |
| Библиотека типов<br/>             | <dl> <dt>Wbemdisp. tlb</dt> </dl> |
| DLL<br/>                      | <dl> <dt>Wbemdisp.dll</dt> </dl> |
| CLSID<br/>                    | \_СВБЕМСЕКУРИТИ CLSID<br/>                                                         |
| IID<br/>                      | IID \_ исвбемсекурити<br/>                                                          |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**свбемсекурити**](swbemsecurity.md)
</dt> <dt>

[Настройка \_ \_ безопасности процесса клиентского приложения](setting-client-application-process-security.md)
</dt> <dt>

[**вбемимперсонатионлевеленум**](/windows/desktop/api/Wbemdisp/ne-wbemdisp-wbemimpersonationlevelenum)
</dt> </dl>

 

