---
description: Служебная программа командной строки WMI (WMIC) предоставляет интерфейс командной строки для инструментария WMI.
ms.assetid: a0f5c1e2-9a4d-4c2b-b324-58ec01e67b6e
ms.tgt_platform: multiple
title: wmic
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 0bee63220bec5cae1c41480187c78211f46ed020
ms.sourcegitcommit: 61a4c522182aa1cacbf5669683d9570a3bf043b2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/26/2021
ms.locfileid: "122881076"
---
# <a name="wmic"></a>wmic

служебная программа командной строки WMI (WMIC) предоставляет интерфейс командной строки для инструментарий управления Windows (WMI) (WMI). WMIC совместим с существующими оболочками и командами служебной программы. Ниже приведен общий справочный раздел для WMIC. дополнительные сведения и рекомендации по использованию WMIC, включая дополнительные сведения о псевдонимах, глаголах, переключателях и командах, см. в разделе [использование инструментарий управления Windows (WMI) командной строки](/previous-versions/windows/it-pro/windows-server-2003/cc779482(v=ws.10)) и [WMIC-Take управление WMI](/previous-versions/windows/it-pro/windows-2000-server/bb742610(v=technet.10))с помощью командной строки.

## <a name="alias"></a>Псевдоним

Псевдоним — это понятное Переименование класса, свойства или метода, который упрощает использование и чтение WMI. Вы можете определить псевдонимы, доступные для WMIC, с помощью **/?** . Можно также определить псевдонимы для определенного класса, используя класс **&lt; className &gt; /?** . Дополнительные сведения см. в разделе [псевдонимы WMIC](/previous-versions/windows/it-pro/windows-server-2003/cc736307(v=ws.10)).

## <a name="switch"></a>Коммутатор

Переключатель — это параметр WMIC, который можно задать глобально или при необходимости. Список доступных параметров см. в разделе [Параметры WMIC](/previous-versions/windows/it-pro/windows-server-2003/cc787035(v=ws.10)).

## <a name="verbs"></a>Команды

Чтобы использовать глаголы в WMIC, введите имя псевдонима, а затем команду. Если псевдоним не поддерживает команду, вы получаете сообщение «поставщик не может выполнить операцию.» Дополнительные сведения см. в разделе [команды WMIC](/previous-versions/windows/it-pro/windows-server-2003/cc784966(v=ws.10)).

Большинство псевдонимов поддерживают следующие команды.

<dl> <dt>

<span id="ASSOC"></span><span id="assoc"></span>ЗАМЫКАЮЩ
</dt> <dd>

Возвращает результат запроса, в `Associators of (<wmi_object>)` котором *<WMI- \_ объект>* является путем к объектам, возвращаемым командами **пути** или **класса** . Результаты представляют собой экземпляры, связанные с объектом. Если параметр ASSOC используется с псевдонимом, возвращаются классы с классом, соответствующим псевдониму. По умолчанию выходные данные возвращаются в формате HTML.

Команда ASSOC имеет следующие параметры.



| Параметр                         | Описание                                                                                                       |
|--------------------------------|-------------------------------------------------------------------------------------------------------------------|
| /РЕСУЛТКЛАСС: &lt; className&gt; | Возвращенные конечные точки, связанные с исходным объектом, должны принадлежать к указанному классу или быть производным от него.      |
| /РЕСУЛТРОЛЕ: &lt; roleName&gt;   | Возвращенные конечные точки должны играть определенную роль в связях с исходным объектом.                              |
| /АССОККЛАСС: &lt; ассоккласс&gt; | Возвращенные конечные точки должны быть связаны с источником через указанный класс или один из его производных классов. |



 

Пример: **Assoc для ОС**

</dd> <dt>

<span id="CALL"></span><span id="call"></span>ОБРАЩЕНИЕ
</dt> <dd>

Выполняет метод.

Пример: **служба, где Caption = "Telnet", вызов STARTSERVICE**

> [!Note]  
> Чтобы определить методы, доступные для данного класса, используйте **/?**. Например, **служба, где Caption = "Telnet" Call/?** Перечисляет доступные функции для класса службы.

 

</dd> <dt>

<span id="CREATE"></span><span id="create"></span>СОЗДАНИЯ
</dt> <dd>

Создает новый экземпляр и задает значения свойств. CREATE не может использоваться для создания нового класса.

Пример: **имя среды Create = "Temp"; ВАРИАБЛЕВАЛУЕ = "создать"**

</dd> <dt>

<span id="DELETE"></span><span id="delete"></span>УДАЛЕН
</dt> <dd>

Удаляет текущий экземпляр или набор экземпляров. DELETE можно использовать для удаления класса.

Пример: **Process, где name = "CALC.EXE" Delete**

</dd> <dt>

<span id="GET"></span><span id="get"></span>ПОЛУЧИТЬ
</dt> <dd>

Получение значений конкретных свойств.

GET имеет следующие параметры.



| Параметр                               | Описание                                                                                                                                |
|--------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------|
| /VALUE                               | Выходные данные форматируются с каждым значением, перечисленным в отдельной строке, с именем свойства.                                           |
| /ALL                                 | Выходные данные форматируются в виде таблицы.                                                                                                            |
| Указанный<translation table> | Преобразовывать выходные данные с помощью таблицы перевода, именуемой командой. Таблицы преобразования Басикксмл и "with запятая" включены в WMIC. |
| /ЕВЕРИ: &lt; интервал&gt;              | Повторите команду каждые &lt; &gt; секунды.                                                                                         |
| Формат<format specifier>     | Задает ключевое слово или имя файла XSL для форматирования данных.                                                                                  |



 

Пример: **имя процесса Get**

</dd> <dt>

<span id="LIST"></span><span id="list"></span>ЧИСЛ
</dt> <dd>

Показывает данные. Команда LIST является командой по умолчанию.

СПИСОК содержит следующие модификаторам.



| Модификаторов   | Описание                                                  |
|----------|--------------------------------------------------------------|
| BRIEF    | Основной набор свойств.                                  |
| FULL     | Полный набор свойств. Это модификаторов по умолчанию для LIST. |
| INSTANCE | Только пути к экземплярам.                                         |
| Состояние   | Состояние объектов.                                       |
| SYSTEM   | Системные свойства.                                           |



 

СПИСОК содержит следующие параметры.



| Параметр                               | Описание                                                                                                                                |
|--------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------|
| Указанный<translation table> | Преобразовывать выходные данные с помощью таблицы перевода, именуемой командой. Таблицы преобразования Басикксмл и "with запятая" включены в WMIC. |
| /ЕВЕРИ: &lt; интервал&gt;              | Повторите команду каждые &lt; &gt; секунды.                                                                                         |
| Формат<format specifier>     | Задает ключевое слово или имя файла XSL для форматирования данных.                                                                                  |



 

Пример: **краткий список процессов**

</dd> <dt>

<span id="SET"></span><span id="set"></span>ПАРАМЕТР
</dt> <dd>

Присваивает значения свойствам. Пример: **имя набора окружения = "Temp"**, **ВАРИАБЛЕВАЛУЕ = "New"**

</dd> </dl>

## <a name="switches"></a>Коммутаторы

Глобальные коммутаторы используются для задания значений по умолчанию для среды WMIC. Чтобы просмотреть текущее значение условий, заданных этими коммутаторами, введите команду **context** .

<dl> <dt>

<span id="_NAMESPACE"></span><span id="_namespace"></span>/NAMESPACE
</dt> <dd>

Пространство имен, которое обычно используется псевдонимом. Значение по умолчанию — root \\ CIMV2.

Пример: **/namespace: \\ \\ root**

</dd> <dt>

<span id="_ROLE"></span><span id="_role"></span>/ROLE
</dt> <dd>

Пространство имен WMIC обычно ищет псевдонимы и другие сведения WMIC.

Пример: **/role: \\ \\ root**

</dd> <dt>

<span id="_NODE"></span><span id="_node"></span>/NODE
</dt> <dd>

Имена компьютеров, разделенные запятыми. Все команды синхронно выполняются для всех компьютеров, перечисленных в этом значении. Имена файлов должны иметь префикс &. Имена компьютеров в файле должны быть разделены запятыми или находиться в разных строках.

</dd> <dt>

<span id="_IMPLEVEL"></span><span id="_implevel"></span>/имплевел
</dt> <dd>

Уровень олицетворения.

Пример: **/имплевел: Anonymous**

</dd> <dt>

<span id="_AUTHLEVEL"></span><span id="_authlevel"></span>/ауслевел
</dt> <dd>

Уровень проверки подлинности.

Пример: **/ауслевел: PKT**

</dd> <dt>

<span id="_LOCALE"></span><span id="_locale"></span>/LOCALE
</dt> <dd>

Языкового стандарта.

Пример: **/locale: MS \_ 411**

</dd> <dt>

<span id="_PRIVILEGES"></span><span id="_privileges"></span>/привилежес
</dt> <dd>

Включение или отключение всех привилегий.

Пример: **/привилежес: enable** или **/привилежес: Disable**

</dd> <dt>

<span id="_TRACE"></span><span id="_trace"></span>/TRACE
</dt> <dd>

Отображает успешное или неуспешное выполнение всех функций, используемых для выполнения команд WMIC.

Пример: **/Trace: on** или **/Trace: Off**

</dd> <dt>

<span id="_RECORD"></span><span id="_record"></span>/рекорд
</dt> <dd>

Записывает все выходные данные в XML-файл. Выходные данные также отображаются в командной строке.

Пример: **/рекорд:** _MyOutput.xml_

</dd> <dt>

<span id="_INTERACTIVE"></span><span id="_interactive"></span>/интерактиве
</dt> <dd>

Как правило, выполняется подтверждение команд DELETE.

Пример: **/интерактиве: on** или **/интерактиве: Off**

</dd> <dt>

<span id="_FAILFAST_on_off_TimeoutInMilliseconds"></span><span id="_failfast_on_off_timeoutinmilliseconds"></span><span id="_FAILFAST_ON_OFF_TIMEOUTINMILLISECONDS"></span>/Фаилфаст **On** \|  \| *тимеаутинмиллисекондс*
</dt> <dd>

Если на компьютерах/NODE выполняется проверка связи перед отправкой команд WMIC. Если компьютер не отвечает, команды WMIC не отправляются.

Пример: "/ФАИЛФАСТ: ON" или "/ФАИЛФАСТ: OFF"

**/ФАИЛФАСТ WMIC: 1000**

</dd> <dt>

<span id="_USER"></span><span id="_user"></span>WMIC
</dt> <dd>

Имя пользователя, используемое WMIC при доступе к компьютерам/NODE или компьютерам, указанным в псевдонимах. Появится запрос на ввод пароля. Имя пользователя нельзя использовать с локальным компьютером.

Пример: **/User:**_jsmith_

</dd> <dt>

<span id="_PASSWORD"></span><span id="_password"></span>/PASSWORD
</dt> <dd>

Пароль, используемый WMIC при доступе к компьютерам/NODE. Пароль отображается в командной строке.

Пример: **/password:**_пароль_

</dd> <dt>

<span id="_OUTPUT"></span><span id="_output"></span>/OUTPUT
</dt> <dd>

Задает режим для всех перенаправлений вывода. Выходные данные не отображаются в командной строке, а место назначения удаляется перед началом вывода. Допустимые значения: STDOUT, CLIPBOARD или имя файла.

Пример: **/OUTPUT: Clipboard**

</dd> <dt>

<span id="_APPEND"></span><span id="_append"></span>/APPEND
</dt> <dd>

Задает режим для всех перенаправлений вывода. Выходные данные не отображаются в командной строке, а назначение не удаляется перед началом вывода, а выходные данные добавляются в конец текущего содержимого назначения. Допустимые значения: STDOUT, CLIPBOARD или имя файла.

Пример: **/append: Clipboard**

</dd> <dt>

<span id="_AGGREGATE"></span><span id="_aggregate"></span>/аггрегате
</dt> <dd>

Используется с параметром **List** и **Get/евери** . Если параметр AGGREGATE имеет значение ON, то LIST и GET выводят результаты, когда все компьютеры в/NODE либо отвечают, либо превышено время ожидания. Если параметр AGGREGATE имеет значение OFF, список и получение результатов отображаются сразу после получения.

Пример: **/аггрегате: Off** или **/аггрегате: on**

</dd> </dl>

## <a name="commands"></a>Команды

Следующие команды WMIC доступны в любое время. Дополнительные сведения см. в разделе [команды WMIC](/previous-versions/windows/it-pro/windows-server-2003/cc779647(v=ws.10)).

<dl> <dt>

<span id="CLASS"></span><span id="class"></span>СМ
</dt> <dd>

Переход из режима псевдонима по умолчанию WMIC для прямого доступа к классам в схеме WMI. Дополнительные сведения о доступных классах WMI см. в разделе [классы WMI](wmi-classes.md).

Пример: **WMIC/OUTPUT: c: \\ClassOutput.htm класс Win32 \_ саунддевице**

</dd> <dt>

<span id="PATH"></span><span id="path"></span>ПУТЬ
</dt> <dd>

Переход из режима псевдонима по умолчанию WMIC на доступ к экземплярам в схеме WMI напрямую.

Пример: **WMIC/OUTPUT: c: \\PathOutput.txt путь Win32 \_ саунддевице Get/value**

</dd> <dt>

<span id="CONTEXT"></span><span id="context"></span>ЛОКАЛЬНОГО
</dt> <dd>

Отображение текущих значений всех глобальных коммутаторов.

Пример: **контекст WMIC**

</dd> <dt>

<span id="QUIT"></span><span id="quit"></span>ХВАТИТ
</dt> <dd>

Выход из WMIC.

Пример: **WMIC Quit**

</dd> <dt>

<span id="EXIT"></span><span id="exit"></span>ВЫПОЛНЯЕТ
</dt> <dd>

Выход из WMIC.

Пример: **выход WMIC**

</dd> </dl>

## <a name="examples"></a>Примеры

В этом сценарии описывается изменение и обновление IP-адресов, подсетей, шлюза и параметров DNS [с помощью примера WMIC](https://Gallery.TechNet.Microsoft.Com/Batch-per-settare-487c1b3f) в коллекции TechNet.

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|--------------------------------|
| Минимальная версия клиента<br/> | Windows Vista<br/>       |
| Минимальная версия сервера<br/> | Windows Server 2008<br/> |



 

