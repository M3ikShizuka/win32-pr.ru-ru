---
description: Поставщик потребителей событий — это компонент постоянной архитектуры потребителей, который определяет, какой постоянный потребитель событий обрабатывает данное событие.
ms.assetid: c5a0d0ec-99af-4815-9ad2-e59db70e04ce
ms.tgt_platform: multiple
title: Создание поставщика объектов событий
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: a0c7aeeb9b44b37d887df49cf5049d5a9e59ad72
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105702463"
---
# <a name="writing-an-event-consumer-provider"></a>Создание поставщика объектов событий

Поставщик потребителей событий — это компонент постоянной архитектуры потребителей, который определяет, какой постоянный потребитель событий обрабатывает данное событие. Необходимо создать поставщик потребителей событий вместе с постоянными потребителями событий, чтобы правильно маршрутизировать события из WMI.

Поставщик объектов-получателей событий связывает поставщик событий со списком классов потребителей. Экземпляры этих классов потребителей затем получают события от этого поставщика. Инструментарий WMI определяет, в какой поставщик потребителей передаются события, на основе экземпляра [**\_ \_ евентконсумерпровидеррегистратион**](--eventconsumerproviderregistration.md) , который связывает экземпляр [**\_ \_ Win32Provider**](--win32provider.md) поставщика с логическим классом-получателем. Пользователи создают экземпляры класса-получателя в рамках постоянной подписки. Если поставщик событий не выполняется при возникновении события, Инструментарий WMI запускает поставщик, когда ему требуется доставка событий.

В следующей процедуре описывается реализация поставщика потребителей событий.

**Реализация поставщика потребителей событий**

1.  Разработка классов потребителей в MOF-файл (MOF) и их регистрация в WMI. Дополнительные сведения см. в разделе [Конструирование классов MOF-файл (MOF)](designing-managed-object-format--mof--classes.md).

    Поставщики классов регистрируются в WMI путем создания экземпляра [**\_ \_ Win32Provider**](--win32provider.md) и класса [**\_ \_ евентконсумерпровидеррегистратион**](--eventconsumerproviderregistration.md) . Дополнительные сведения см. в разделе [Регистрация поставщика потребителей событий](registering-an-event-consumer-provider.md).

2.  Реализуйте интерфейс [**ивбемпровидеринит**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinit) для поставщика.

    Инструментарий WMI использует [**ивбемпровидеринит**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinit) для загрузки и инициализации поставщика. Дополнительные сведения см. [в разделе Инициализация поставщика](initializing-a-provider.md).

    > [!Note]  
    > Поставщики потребителей событий настоятельно рекомендуется использовать модель многопоточности "both".

     

3.  Реализуйте интерфейс [**ивбемевентконсумерпровидер**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventconsumerprovider) для поставщика.

    Интерфейс [**ивбемевентконсумерпровидер**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventconsumerprovider) является основным интерфейсом для поставщика потребителей событий.

4.  Предоставьте одного или нескольких физических потребителей для получения сообщений о событиях из WMI.

    Физический потребитель — это COM-объект, представляющий постоянный потребитель событий. Все физические потребители должны реализовывать интерфейс [**ивбемунбаундобжектсинк**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemunboundobjectsink) . Дополнительные сведения см. [в разделе Реализация физического потребителя](implementing-a-physical-consumer.md).

 

 



