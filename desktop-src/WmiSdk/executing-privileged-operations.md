---
description: Привилегированные операции требуют привилегий безопасности, таких как Селоаддриверпривилеже (Вбемпривилежелоаддривер в константах API скриптов), права доступа, которые должны быть включены для учетной записи, загружая драйвер устройства.
ms.assetid: 11bb8723-f329-4083-8219-2256ce44a5e3
ms.tgt_platform: multiple
title: Выполнение привилегированных операций
ms.topic: article
ms.date: 05/31/2018
topic_type:
- kbArticle
api_name: ''
api_type: ''
api_location: ''
ms.openlocfilehash: 37abba9d774025825611e311f08414b50e660f65
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105702062"
---
# <a name="executing-privileged-operations"></a>Выполнение привилегированных операций

Привилегированные операции требуют привилегий безопасности, таких как **селоаддриверпривилеже** (**вбемпривилежелоаддривер** в [константах API скриптов](scripting-api-constants.md)), права доступа, которые должны быть включены для учетной записи, загружая драйвер устройства. Вы не можете добавить привилегии для администратора или пользователя с помощью инструментария WMI. Вы можете включить только те привилегии, которые у учетной записи уже есть. Список привилегий см. в разделе [**\_ константы прав**](privilege-constants.md).

По умолчанию локальный пользователь на компьютере может считывать статические данные из [*репозитория WMI*](gloss-w.md), записывать их в экземпляры, предоставляемые поставщиками, и выполнять методы поставщика, если только поставщик не применяет специальные требования безопасности. Только администраторы могут [подключаться к удаленному компьютеру](connecting-to-wmi-on-a-remote-computer.md), изменять дескрипторы безопасности или изменять данные статического репозитория WMI, такие как определение класса WMI. Для удаленного подключения разрешены все привилегии. Дополнительные сведения см. [в разделе Защита удаленного WMI-подключения](securing-a-remote-wmi-connection.md).

Константы привилегий для C++ отличаются от тех, которые используются в языках автоматизации, таких как Visual Basic. В скриптах должно использоваться значение константы, а не имя. Дополнительные сведения см. в статьях [выполнение привилегированных операций с помощью C++](executing-privileged-operations-using-c-.md) или [выполнение привилегированных операций с помощью VBScript](executing-privileged-operations-using-vbscript.md).

Распространенной причиной ошибок отказа в доступе при использовании инструментария WMI является отсутствие включенного права для операций, например получение всех экземпляров [**Win32 \_ нтевентлогфиле**](/previous-versions/windows/desktop/legacy/aa394225(v=vs.85)). Если не включить привилегию **сесекурити** , доступ к файлу журнала безопасности будет невозможен.

В следующем примере кода VBScript показано, как задать привилегию **сесекурити** в строке моникера. При использовании в моникере имя права в круглых скобках удаляет начальную букву "SE". Дополнительные сведения см. [в разделе Создание строки моникера](constructing-a-moniker-string.md).


```VB
strComputer = "."
Set objWMIService = GetObject("winmgmts:" _
    & "{impersonationLevel=impersonate,(Security)}!\\" _
    & strComputer & "\root\cimv2")
Set colFiles = objWMIService.ExecQuery _
    ("Select * from Win32_NTEventLogFile " _
    & "Where LogFileName='Security'")
For Each LogFile in colFiles
Wscript.Echo LogFile.NumberOfRecords
Next
```



## <a name="related-topics"></a>См. также

<dl> <dt>

[**Константы прав доступа**](privilege-constants.md)
</dt> </dl>

 

 
