---
description: Свойства в классах WMI описывают данные об управляемом объекте.
ms.assetid: 4046bfc7-9528-4737-ad61-bbb8419d0b51
ms.tgt_platform: multiple
title: Добавление свойства WMI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bba8944da155ca250edfed0c6e9160f555ba9551
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127568987"
---
# <a name="adding-a-wmi-property"></a>Добавление свойства WMI

Свойства в классах WMI описывают данные об управляемом объекте. Например, **Handle**, **ProcessID** и **пажефаултс** определяются как свойства класса [**\_ процесса Win32**](/windows/desktop/CIMWin32Prov/win32-process) и описывают аспекты процесса операционной системы. Дополнительные сведения см. [в разделе Написание поставщика свойств](writing-a-property-provider.md).

## <a name="defining-a-property-in-mof"></a>Определение свойства в MOF

Свойство WMI представляет аспект или состояние в объекте. Вместо создания методов, которые просто получают и задают значение, можно создать свойство. Например, свойство **NetEnabled** объекта [**Win32 \_ сетевого адаптера**](/windows/desktop/CIMWin32Prov/win32-networkadapter) показывает, включено или отключено состояние адаптера. Однако методы [**включения**](/windows/desktop/CIMWin32Prov/enable-method-in-class-win32-networkadapter) и [**отключения**](/windows/desktop/CIMWin32Prov/disable-method-in-class-win32-networkadapter) фактически выполняют действие по изменению состояния адаптера.

Свойство должно иметь тип данных. Тип данных **маркера** свойства [**\_ процесса Win32**](/windows/desktop/CIMWin32Prov/win32-process) — **String** , а тип данных **пажефаултс** — **UInt32**. Если свойство может иметь только два состояния, то для типа данных свойства обычно устанавливается **значение Boolean**.

Свойство также может быть массивом. Например, свойство идентификатора безопасности (**SID**) [**\_ доверенного лица Win32**](/previous-versions/windows/desktop/secrcw32prov/win32-trustee) представляет собой массив байтов (**Uint8**), который содержит идентификатор безопасности. Свойства могут содержать внедренные объекты, которые являются ссылками на один или несколько экземпляров другого класса WMI. Например, список управления доступом на уровне пользователей **(DACL)** и свойства системного списка управления доступом **(SACL)** для [**Win32 \_ SecurityDescriptor**](/previous-versions/windows/desktop/secrcw32prov/win32-securitydescriptor)являются массивами объектов [**\_ ACE Win32**](/previous-versions/windows/desktop/secrcw32prov/win32-ace) , описывающих группы и учетные записи, имеющие доступ. Свойство **Group** в **Win32 \_ SecurityDescriptor** содержит ссылку на один экземпляр **\_ доверенного лица Win32**. Дополнительные сведения см. [в разделе внедрение объектов в класс](embedded-objects.md).

Свойство может иметь несколько [*квалификаторов*](gloss-q.md). Эти [Квалификаторы](wmi-qualifiers.md) могут быть [*модель CIM (CIM)*](gloss-c.md) или квалификаторы WMI или могут быть специфичными для определенных типов классов, например квалификаторов класса [счетчика производительности](qualifiers-specific-to-wmi-performance-classes.md) . Квалификаторы задают определенный аспект свойства, например, если он доступен только для чтения или не может быть изменен без особых привилегий. Например, приложению, которое пытается выполнить запись в свойство **DACL** [**Win32 \_ SecurityDescriptor**](/previous-versions/windows/desktop/secrcw32prov/win32-securitydescriptor), требуются права **SeSecurityPrivilege** и **сересторепривилеже**. Дополнительные сведения см. [в разделе Добавление квалификатора](adding-a-qualifier.md).

Наконец, свойство должно иметь имя. Вы можете назвать свойство любым из границ стандартной практики программирования. Однако существует два основных исключения. Во-первых, вы не можете использовать любое ключевое слово MOF, например "class", в качестве имени свойства. Во-вторых, нельзя использовать ключевые слова WQL, например "Group", в качестве имени свойства. дополнительные сведения о ключевых словах mof и wql см. в разделе [типы данных mof](mof-data-types.md) и [wql (SQL для WMI)](wql-sql-for-wmi.md).

Для кода C++ и MOF-файл (MOF) можно объявить свойства класса одновременно с объявлением класса.

**Определение свойства**

-   Включите тип данных свойства, имя и необязательное значение по умолчанию и квалификатор между фигурными скобками в описании класса.

    ``` syntax
    class MyClass 
    {
        [key] string   strProp;
        sint32         dwProp1 = 21;
        uint32         dwProp2;
    };
    ```

    Класс MyClass в предыдущем примере имеет три свойства: строку символов, 32-разрядное целое число со знаком и 32-разрядное целое число без знака. Каждому свойству присваивается имя, не учитывающее регистр, и тип данных MOF.

    Квалификатор [**ключа**](key-qualifier.md) определяет строковое свойство в качестве ключевого свойства, уникально идентифицирующего экземпляр класса. Дополнительные сведения об квалификаторах см. [в разделе Добавление квалификатора](adding-a-qualifier.md).

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Создание класса](creating-a-class.md)
</dt> </dl>

 

 
