---
description: Иногда может потребоваться установка более новой версии поставщика на работающую систему.
ms.assetid: 44c4c16a-fd79-483a-81ef-a0f74a2cdf45
ms.tgt_platform: multiple
title: Обновление поставщика
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: aa8c40a3d50672115478ae62135774f5a1aad93373bd5b844402e89462b44fd0
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119757654"
---
# <a name="updating-a-provider"></a>Обновление поставщика

Иногда может потребоваться установка более новой версии поставщика на работающую систему. Если поставщик установлен в качестве библиотеки DLL, можно установить новый поставщик, не перезапуская службу, перезагрузить компьютер или иным образом повлиять на приложения, использующие WMI.

В следующей процедуре описывается обновление поставщика.

**Обновление поставщика**

1.  Создайте новый поставщик.

    1.  Скомпилируйте новый поставщик с другим именем DLL и другим **идентификатором CLSID**.

        Например, измените Myprov.dll на Myprov1.dll, а **CLSID \_ Мипропров** на **CLSID \_ мипров** 1.

    2.  Измените MOF-файл регистрации поставщика, чтобы использовать новый CLSID (CLSID \_ MyProv1), но с тем же именем поставщика ("мипров").

2.  Установите новый поставщик.

    1.  Скопируйте новую библиотеку DLL поставщика с новым именем рядом с прежней.
    2.  Самостоятельно Зарегистрируйте нового поставщика.

        Например, для регистрации нового поставщика используйте команду **regsvr32** **myprov1.dll** .

    3.  Скомпилируйте новый MOF-файл регистрации поставщика, тем самым перезаписывая старую регистрацию поставщика. До этой точки старый поставщик был полностью функциональным. Теперь новый поставщик работает полностью.

3.  При необходимости удалите старую версию поставщика.

    1.  Отмените регистрацию старой библиотеки DLL.

        Например, чтобы отменить регистрацию старой библиотеки DLL, используйте команду **regsvr32** **/umyprov.dll** .

    2.  Пометьте старую библиотеку DLL, которая будет удалена при перезагрузке, вызвав [**мовефиликс**](/windows/desktop/api/winbase/nf-winbase-movefileexa).

Для обновления поставщика, реализованного на локальном сервере, можно выполнить аналогичные действия.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Разработка поставщика WMI](developing-a-wmi-provider.md)
</dt> <dt>

[Настройка дескрипторов безопасности Намепаце](setting-namespace-security-descriptors.md)
</dt> <dt>

[Защита поставщика](securing-your-provider.md)
</dt> </dl>

 

 
