---
description: Чтобы создать поставщик свойств WMI, необходимо зарегистрировать \_ \_ экземпляр Win32Provider, представляющий поставщика, с помощью экземпляра \_ \_ пропертипровидеррегистратион.
ms.assetid: e7e30acc-ea41-41e2-9bb3-cd931e8d799e
ms.tgt_platform: multiple
title: Регистрация поставщика свойств
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d56d91e3c2a45b0ad0fe83cf6b2bc32ab4353a26
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "104263820"
---
# <a name="registering-a-property-provider"></a>Регистрация поставщика свойств

Чтобы создать [*поставщик свойств*](gloss-p.md) WMI, необходимо зарегистрировать экземпляр [**\_ \_ Win32Provider**](--win32provider.md) , представляющий поставщика, с помощью экземпляра [**\_ \_ пропертипровидеррегистратион**](--propertyproviderregistration.md). В качестве COM-объекта поставщик должен зарегистрироваться в операционной системе и инструментарии WMI. В следующей процедуре предполагается, что вы уже реализовали процесс регистрации, как описано в статье [Регистрация поставщика](registering-a-provider.md).

В следующей процедуре описывается регистрация поставщика свойств.

**Регистрация поставщика свойств**

1.  Создайте экземпляр класса [**\_ \_ Win32Provider**](--win32provider.md) , который описывает поставщик свойств.

    Класс [**\_ \_ Win32Provider**](--win32provider.md) принимает значения по умолчанию для других свойств, например значение **true** для **чистого** свойства. Дополнительные сведения см. в разделе [**\_ \_ Win32Provider**](--win32provider.md).

2.  Создайте экземпляр класса [**\_ \_ пропертипровидеррегистратион**](--propertyproviderregistration.md) , описывающий набор функций поставщика.

    Класс [**\_ \_ пропертипровидеррегистратион**](--propertyproviderregistration.md) наследует многие свойства от родительского класса [**\_ \_ обжектпровидеррегистратион**](--objectproviderregistration.md) , который предоставляет логические значения, которые указывают на поддержку определенных функций, и массив строк для указания поддержки запросов.

    Не забудьте пометить класс как как [**динамический**](dynamic-qualifier.md) , так и квалификатор [**поставщика**](/windows/desktop/api/Provider/nl-provider-provider) . **Динамический** квалификатор сигнализирует, что инструментарий WMI должен использовать динамический поставщик для получения экземпляров класса, содержащих Поддерживаемые свойства. Квалификатор **поставщика** указывает имя поставщика, который должен использовать WMI.

Инструментарий WMI вызывает Невкуери в поставщике событий, когда потребитель клиента регистрирует запрос фильтра событий, содержащий ссылки на события, поддерживаемые этим поставщиком событий. Поэтому поставщик событий, ответственный за события изменения экземпляра для класса Емаилкласс, можно настроить для создания уведомлений только для отправителя. Когда поставщик получает запрос, запрашивающий уведомления об изменениях свойства Subject, поставщик может приступить к формированию этих уведомлений. В этом сценарии Инструментарий WMI не требуется для отмены уведомлений, которые только изменяют получатель отчета.

В следующем примере кода MOF описываются экземпляры, которые можно использовать для регистрации поставщика свойств.

``` syntax
  instance of __Win32Provider as $P
  {
    Name    = "PropProvider" ;
    ClsId   = "{E30EC6A0-23CF-11d1-8FDE-0000F804AA5C}" ;
  };    

  instance of __PropertyProviderRegistration
  {
    Provider = $P;
    SupportsGet = TRUE;
    SupportsPut = FALSE;
  };
```

> [!Note]  
> Только администраторы могут регистрировать или удалять поставщик свойств, создавая экземпляр [**\_ \_ Win32Provider**](--win32provider.md) и [**\_ \_ пропертипровидеррегистратион**](--propertyproviderregistration.md).

 

 

 



