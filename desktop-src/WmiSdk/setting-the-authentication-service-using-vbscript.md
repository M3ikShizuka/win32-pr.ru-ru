---
description: при доступе к серверу инструментарий управления Windows (WMI) (WMI) с помощью скрипта можно выбрать между протоколами проверки подлинности NT LAN Manager (NTLM) или Kerberos.
ms.assetid: db2dc750-bfdd-4f6c-859b-e104814f0800
ms.tgt_platform: multiple
title: Настройка службы проверки подлинности с помощью VBScript
ms.topic: article
ms.date: 05/31/2018
topic_type:
- kbArticle
api_name: ''
api_type: ''
api_location: ''
ms.openlocfilehash: 837a69df251b5bbb6cc8bef5ac0b882349fde74646ac6ed33149978b8f69ad7c
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118315391"
---
# <a name="setting-the-authentication-service-using-vbscript"></a>Настройка службы проверки подлинности с помощью VBScript

при доступе к серверу инструментарий управления Windows (WMI) (WMI) с помощью скрипта можно выбрать между протоколами проверки подлинности NT LAN Manager (NTLM) или Kerberos. Указание Kerberos не требуется, кроме случаев использования делегирования. Дополнительные сведения см. в разделе [Подключение к третьим компьютерам-делегирование](connecting-to-a-3rd-computer-delegation.md).

Поскольку версии операционной системы отличаются от используемых ими служб проверки подлинности, рекомендуется не указывать значение для поля Authority при подключении к удаленной системе. Вместо этого разрешите операционной системе и распределенной версии модели объектов (DCOM) выбрать NTLM или Kerberos. Если указана служба проверки подлинности, для синтаксиса требуется имя участника на сервере, то есть имя целевого компьютера, а не контроллера домена.

Параметр Authority можно использовать только с подключениями к удаленным серверам WMI. Попытка соединения завершится неудачей, если вы попытаетесь установить уровни авторизации как часть моникера или с помощью вызова [**SWbemLocator. коннектсервер**](swbemlocator-connectserver.md) для локального соединения.

Выполните следующую процедуру, чтобы указать службу проверки подлинности, которую необходимо использовать в параметре *страусорити* метода [**SWbemLocator. коннектсервер**](swbemlocator-connectserver.md) или в соединении строки [моникера](constructing-a-moniker-string.md) .

**Указание проверки подлинности NTLM или Kerberos с помощью API скриптов для WMI**

1.  Если параметр *страусорити* начинается со строки "Kerberos:", WMI предполагает, что строка ссылается на имя участника Kerberos и используется проверка подлинности Kerberos. Если параметр *страусорити* начинается со строки "нтлмдомаин:", WMI использует проверку подлинности NTLM.
2.  Кроме того, можно использовать часть полномочия моникера для указания типа проверки подлинности, используемой для подключения к WMI. Чтобы использовать проверку подлинности Kerberos при использовании моникера, укажите строку "Authority = Kerberos:", за которой следует имя участника. Чтобы использовать проверку подлинности NTLM, включите строку "Authority = нтлмдомаин:", за которой следует имя домена NTLM.

    В следующем примере показан моникер, запрашивающий проверку подлинности Kerberos с помощью основного \\ сервера "MyDomain".

    ```VB
    winmgmts:{impersonationLevel=delegate, _
            authority=kerberos:mydomain\server} _
            !//myserver/root/default:__cimomidentification=@
    ```

    

    В следующем примере показан моникер, который запрашивает проверку подлинности NTLM с использованием домена mydomain.

    ```VB
    winmgmts:{impersonationLevel=impersonate, _
            authority=ntlmdomain:mydomain} _
            !//myserver/root/default:__cimomidentification=@
    ```

    

 

 



