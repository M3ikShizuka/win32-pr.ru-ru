---
description: как и другие поставщики экземпляров, вы регистрируете высокопроизводительный поставщик с помощью Microsoft Windows&\# 160; Инструментарий управления (WMI) путем создания экземпляра \_ \_ классов Win32Provider и \_ \_ инстанцепровидеррегистратион.
ms.assetid: 6ff3f8c6-71ca-4589-bca7-b864e24a473d
ms.tgt_platform: multiple
title: Регистрация поставщика High-Performance
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: f2ee52db95290810a046d23781dbccf666cd63a19b01bf9414b2e224b8137f8c
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118992574"
---
# <a name="registering-a-high-performance-provider"></a>Регистрация поставщика High-Performance

как и другие поставщики экземпляров, вы регистрируете высокопроизводительный поставщик с помощью Microsoft инструментарий управления Windows (WMI) (WMI), создавая экземпляр классов [**\_ \_ Win32Provider**](--win32provider.md) и [**\_ \_ инстанцепровидеррегистратион**](--instanceproviderregistration.md) . Экземпляр **\_ \_ Win32Provider** определяет физическую реализацию поставщика, а экземпляр **\_ \_ инстанцепровидеррегистратион** определяет набор функций поставщика. Дополнительные сведения см. [в разделе Регистрация поставщика](registering-a-provider.md).

Следующая процедура описывает, как зарегистрировать высокопроизводительный поставщик экземпляров.

**Регистрация поставщика высокопроизводительного экземпляра**

1.  Создайте экземпляр класса [**\_ \_ Win32Provider**](--win32provider.md) , описывающий поставщик.

    Не забудьте добавить свойство **клиентлоадаблеклсид** в экземпляр [**\_ \_ Win32Provider**](--win32provider.md) . Если поставщик и клиент находятся на одном компьютере, Инструментарий WMI загружает поставщик в процессе в клиенте с помощью **клиентлоадаблеклсид** в качестве идентификатора класса. Когда поставщик и клиент располагаются на разных компьютерах, Инструментарий WMI загружает внутрипроцессный поставщик в WMI. Инструментарий WMI также использует **клиентлоадаблеклсид** для поддержки операций обновления.

2.  Создайте экземпляр класса [**\_ \_ инстанцепровидеррегистратион**](--instanceproviderregistration.md) , описывающий набор функций поставщика.

    Не забудьте пометить класс как как [**динамический**](dynamic-qualifier.md) , так и квалификатор [**поставщика**](/windows/desktop/api/Provider/nl-provider-provider) . **Динамический** квалификатор сигнализирует, что инструментарий WMI должен использовать поставщик для получения экземпляров класса. Квалификатор **поставщика** указывает имя поставщика, который должен использовать WMI.

    Поставщик высокой производительности также должен поддерживать состояние для операций, операций перечисления или и того, и другого. Убедитесь, что в реализации используются свойства **суппортсжет** и **суппортсенумератион** .

В следующем примере кода показано, как реализовать классы [**\_ \_ Win32Provider**](--win32provider.md) и [**\_ \_ инстанцепровидеррегистратион**](--instanceproviderregistration.md) для высокопроизводительного поставщика.

``` syntax
instance of __Win32Provider as $P
{
    Name="TestProv";
    CLSID="{A41602A4-C038-11d1-AEB6-00C04FB68820}";
    ClientLoadableCLSID="{423B32C9-B033-4242-EFB6-55C044242821}";
};

instance of __InstanceProviderRegistration
{
    Provider = $P;
    SupportsGet = TRUE;
    SupportsEnumeration = TRUE;
};

[ dynamic, 
  provider("TestProv")
]

class TestClass
{
    [key] string KeyVal;
    
    string StrVal1;

    sint32 IntVal1;
    sint32 IntVal2;

    sint32 IntArray2[];
};
```

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Создание поставщика экземпляров в поставщике High-Performance](making-an-instance-provider-into-a-high-performance-provider.md)
</dt> </dl>

 

 



