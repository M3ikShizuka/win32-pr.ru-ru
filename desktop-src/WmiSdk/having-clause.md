---
description: Предложение HAVING используется для фильтрации событий, полученных в течение интервала группировки, указанного в предложении WITHIN.
ms.assetid: 787e31df-df6a-4fb0-a1c0-18bd60867e2f
ms.tgt_platform: multiple
title: HAVING, предложение
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 2662ea337c5664130eb9973c049431daedefe3c947c45eb397a950522fea6bcf
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118993164"
---
# <a name="having-clause"></a>HAVING, предложение

Предложение HAVING используется для фильтрации событий, полученных в течение интервала группировки, указанного в [предложении Within](within-clause.md). Например, можно создать инструкцию SELECT таким образом, чтобы она возвращала Nothing, если в течение последнего 30-секундного ИНТЕРВАЛа не было по крайней мере 5 событий.

Предложение WITHIN сразу же в [инструкции SELECT](select-statement-for-event-queries.md) после предложения [Group](group-clause.md) . Предложение HAVING работает со свойством **NumberOfEvents** класса System [**\_ \_ аггрегативент**](--aggregateevent.md) , для которого группа, созданная предложением Group, является членом. Предложение HAVING может использовать все стандартные операторы отношения.

Синтаксис выглядит следующим образом:

``` syntax
SELECT * FROM EventClass [WHERE property = value] 
  GROUP WITHIN interval [BY property_list]
  HAVING NumberOfEvents operator constant
```

Значение *EventClass* — это класс событий, членом которого является событие, а *value* — это значение свойства, для которого требуется уведомление. Интервал представляет собой целое число без знака, представляющее интервал группирования (в секундах) после получения первого события. Список свойств представляет собой список с разделителями-запятыми одного или нескольких свойств, включенных в класс событий. Оператор является любым реляционным оператором. Постоянное значение — это любое 32-разрядное целое число без знака, указывающее количество событий, используемых для фильтрации.

При использовании предложения HAVING предложения WHERE и BY являются необязательными.

Следующий запрос события требует, чтобы уведомления класса **емаилевент** были сгруппированы в одно событие 300 секунд после первого события, полученного WMI. Кроме того, запрос запрашивает экземпляр [**\_ \_ аггрегативент**](--aggregateevent.md) , только если Инструментарий WMI получит более пяти событий электронной почты за 300 секунд.


```sql
SELECT * FROM EmailEvent GROUP WITHIN 300 HAVING NumberOfEvents > 5
```



В следующем примере все события, полученные в течение 600 секунд (то есть 10 минут), группируются **TargetInstance**. **SourceName** , свойство. В этом примере агрегатные события доставляются только в том случае, если количество событий [**Win32 \_ нтложевент**](/previous-versions/windows/desktop/eventlogprov/win32-ntlogevent) , полученных из одного источника, превышает 25. Помните, что оператор ISA вызывает свойство **TargetInstance** класса System [**\_ \_ инстанцекреатионевент**](--instancecreationevent.md) для представления экземпляра класса **Win32 \_ нтложевент** .


```sql
SELECT * FROM __InstanceCreationEvent 
  WHERE TargetInstance ISA "Win32_NTLogEvent" 
  GROUP WITHIN 600 BY TargetInstance.SourceName
  HAVING NumberOfEvents > 25
```



 

 
