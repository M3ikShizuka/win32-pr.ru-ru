---
description: Регистрирует сведения о физической реализации поставщика в WMI. Поставщики, не устанавливающие свойство Хостингмодел, по умолчанию загружаются в процесс Wmiprvse.exe как Нетворксервицехосторселфхост.
ms.assetid: 41e0d938-00c6-4f4c-8027-8b8512398dee
ms.tgt_platform: multiple
title: Класс __Win32Provider
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- kbSyntax
api_name: ''
api_type: ''
api_location: ''
ms.openlocfilehash: dd7c848e9c792bcff3c0af58143d404bda744a982daeedbff01895242407a7aa
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119857694"
---
# <a name="__win32provider-class"></a>\_\_Класс Win32Provider

Системный класс **\_ \_ Win32Provider** регистрирует сведения о физической реализации поставщика в WMI. Поставщики, не устанавливающие свойство **хостингмодел** , по умолчанию загружаются в процесс Wmiprvse.exe как **нетворксервицехосторселфхост**.

Приведенный ниже синтаксис является упрощенной версией кода MOF и включает все унаследованные свойства. Свойства перечислены в алфавитном порядке, а не в MOF.

## <a name="syntax"></a>Синтаксис

``` syntax
class __Win32Provider : __Provider
{
  string   ClientLoadableCLSID;
  string   CLSID;
  sint32   Concurrency;
  string   DefaultMachineName;
  boolean  Enabled;
  string   HostingModel;
  sint32   ImpersonationLevel = 0;
  sint32   InitializationReentrancy;
  datetime InitializationTimeoutInterval;
  boolean  InitializeAsAdminFirst;
  string   Name;
  datetime OperationTimeoutInterval;
  boolean  PerLocaleInitialization = FALSE;
  boolean  PerUserInitialization = FALSE;
  boolean  Pure = TRUE;
  string   SecurityDescriptor;
  boolean  SupportsExplicitShutdown;
  boolean  SupportsExtendedStatus;
  boolean  SupportsQuotas;
  boolean  SupportsSendStatus;
  boolean  SupportsShutdown;
  boolean  SupportsThrottling;
  datetime UnloadTimeout;
  uint32   Version;
};
```

## <a name="members"></a>Члены

Класс **\_ \_ Win32Provider** имеет следующие типы членов:

-   [Свойства](#properties)

### <a name="properties"></a>Элемент Property

Класс **\_ \_ Win32Provider** имеет следующие свойства.

<dl> <dt>

**клиентлоадаблеклсид**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: чтение и запись
</dt> </dl>

Идентификатор класса, используемый WMI для определения необходимости загрузки высокопроизводительного поставщика в клиентский процесс или в процесс WMI. Если поставщик и клиент расположены на одном компьютере, WMI загружает поставщик в процессе в клиенте с помощью **клиентлоадаблеклсид** в качестве идентификатора класса. Когда поставщик и клиент расположены на разных компьютерах, Инструментарий WMI загружает поставщик в службу WMI. Инструментарий WMI также использует **клиентлоадаблеклсид** для поддержки операций обновления.

Дополнительные сведения см [. в разделе Регистрация поставщика High-Performance.](registering-a-high-performance-provider.md)

</dd> <dt>

**ЭТОМУ**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: чтение и запись
</dt> </dl>

Идентификатор **GUID** , представляющий идентификатор класса (**CLSID**) COM-объекта поставщика. Этот COM-объект должен содержать реализацию интерфейса [**ивбемпровидеринит**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinit) .

</dd> <dt>

**Параллелизм**
</dt> <dd> <dl> <dt>

Тип данных: **Sint32**
</dt> <dt>

Тип доступа: чтение и запись
</dt> </dl>

Не используется.

</dd> <dt>

**дефаултмачиненаме**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: чтение и запись
</dt> </dl>

Определяет компьютер, на котором будет запущен поставщик. Если поставщик запущен на локальном компьютере, он имеет **значение NULL**.

</dd> <dt>

**Включен**
</dt> <dd> <dl> <dt>

Тип данных: **логический**
</dt> <dt>

Тип доступа: чтение и запись
</dt> </dl>

Если **значение — true**, этот экземпляр включен и может использоваться для выполнения клиентских запросов.

</dd> <dt>

**хостингмодел**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: чтение и запись
</dt> </dl>

Это свойство состоит из значений из свойств **хостингграуп** и **хостингспеЦификатион** [**\_ поставщиков MSFT**](/previous-versions/windows/desktop/wmisystemprov/msft-providers) . Значение этого свойства указывает, как WMI загружает поставщик и учетную запись безопасности, под которой он выполняется. Дополнительные сведения о настройке свойства **хостингмодел** см. в разделе [Размещение поставщика и безопасность](provider-hosting-and-security.md) и [Регистрация поставщика](registering-a-provider.md).

</dd> <dt>

**ImpersonationLevel**
</dt> <dd> <dl> <dt>

Тип данных: **Sint32**
</dt> <dt>

Тип доступа: чтение и запись
</dt> </dl>

Зарезервировано. Значение по умолчанию равно нулю (0).

</dd> <dt>

**инитиализатионринтранци**
</dt> <dd> <dl> <dt>

Тип данных: **Sint32**
</dt> <dt>

Тип доступа: чтение и запись
</dt> </dl>

Набор флагов, предоставляющих сведения о сериализации. Значение по умолчанию равно нулю (0).

<dt>

0
</dt> <dd>

Все инициализации этого поставщика должны быть сериализованы.

</dd> <dt>

1
</dt> <dd>

Все инициализации этого поставщика в одном пространстве имен должны быть сериализованы.

</dd> <dt>

2
</dt> <dd>

Сериализация инициализации не требуется.

</dd> </dl>

</dd> <dt>

**инитиализатионтимеаутинтервал**
</dt> <dd> <dl> <dt>

Тип данных: **DateTime**
</dt> <dt>

Тип доступа: чтение и запись
</dt> </dl>

Не используется.

</dd> <dt>

**инитиализеасадминфирст**
</dt> <dd> <dl> <dt>

Тип данных: **логический**
</dt> <dt>

Тип доступа: чтение и запись
</dt> </dl>

Подлежит уточнению

</dd> <dt>

**Имя**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: чтение и запись
</dt> <dt>

Квалификаторы: [ **ключ**](standard-qualifiers.md)
</dt> </dl>

Имя поставщика.

</dd> <dt>

**оператионтимеаутинтервал**
</dt> <dd> <dl> <dt>

Тип данных: **DateTime**
</dt> <dt>

Тип доступа: чтение и запись
</dt> </dl>

Не используется.

</dd> <dt>

**перлокалеинитиализатион**
</dt> <dd> <dl> <dt>

Тип данных: **логический**
</dt> <dt>

Тип доступа: чтение и запись
</dt> </dl>

Если **значение — true**, поставщик инициализируется для каждого языкового стандарта, когда пользователь соединяется с одним и тем же пространством имен более одного раза, используя разные языковые стандарты. Значение по умолчанию — **FALSE**.

</dd> <dt>

**перусеринитиализатион**
</dt> <dd> <dl> <dt>

Тип данных: **логический**
</dt> <dt>

Тип доступа: чтение и запись
</dt> </dl>

Если **значение — true**, поставщик инициализируется один раз для каждого пользователя NT LAN Manager (NTLM), который выполняет запросы к поставщику. Если **значение равно false** (по умолчанию), поставщик инициализируется один раз для всех пользователей.

</dd> <dt>

**Чистый**
</dt> <dd> <dl> <dt>

Тип данных: **логический**
</dt> <dt>

Тип доступа: чтение и запись
</dt> </dl>

Если **значение — true**, поставщик соглашается подготовиться к выгрузке путем вызова метода [**IUnknown:: Release**](/windows/win32/api/unknwn/nf-unknwn-iunknown-release) для всех необработанных точек интерфейса, когда WMI вызывает метод **Release** своего основного интерфейса. Поставщики, которые должны оставаться клиентами инструментария WMI после того, как они не работают, так как поставщики должны задать для **чистого** значения **false**. Значение по умолчанию — **true**. Дополнительные сведения см. в подразделе «Примечания» этого раздела.

</dd> <dt>

**SecurityDescriptor**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: чтение и запись
</dt> </dl>

Дескриптор безопасности (SD) в языке определения дескрипторов безопасности (SDDL), определяющий набор пользователей, которые могут успешно вызывать [**ивбемдекаупледрегистрар: Register**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemdecoupledregistrar-register) для несвязанного поставщика. дополнительные сведения см. в разделе о [языке определения дескрипторов безопасности](/windows/desktop/SecAuthZ/security-descriptor-definition-language) в разделе "безопасность" Windows SDK. Этот дескриптор безопасности используется только для несвязанных поставщиков и не влияет на других поставщиков. Дополнительные сведения см. [в разделе Включение поставщика в приложение](incorporating-a-provider-in-an-application.md).

Инструментарий WMI выполняет проверки доступа для несвязанных поставщиков, использующих интерфейсы [**ивбемпровидеринит**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinit) и [**ивбемобжектсинк**](iwbemobjectsink.md) . Если дескриптор безопасности имеет **значение NULL**, то для запуска несвязанного поставщика могут использоваться только приложения или службы, работающие под учетными записями LocalSystem, NetworkService, LocalService.

В следующей строке показан несвязанный поставщик, который будет запускаться только встроенными администраторами». О:БАГ: ОШИБКА: (A;; 0 x1;;; Ба) "

Дополнительные сведения о настройке свойства **SecurityDescriptor** см. в разделе [обслуживание безопасности WMI](maintaining-wmi-security.md).

</dd> <dt>

**суппортсексплиЦитшутдовн**
</dt> <dd> <dl> <dt>

Тип данных: **логический**
</dt> <dt>

Тип доступа: чтение и запись
</dt> </dl>

Не используется.

</dd> <dt>

**суппортсекстендедстатус**
</dt> <dd> <dl> <dt>

Тип данных: **логический**
</dt> <dt>

Тип доступа: чтение и запись
</dt> </dl>

Не используется.

</dd> <dt>

**суппортскуотас**
</dt> <dd> <dl> <dt>

Тип данных: **логический**
</dt> <dt>

Тип доступа: чтение и запись
</dt> </dl>

Не используется.

</dd> <dt>

**суппортссендстатус**
</dt> <dd> <dl> <dt>

Тип данных: **логический**
</dt> <dt>

Тип доступа: чтение и запись
</dt> </dl>

Не используется.

</dd> <dt>

**суппортсшутдовн**
</dt> <dd> <dl> <dt>

Тип данных: **логический**
</dt> <dt>

Тип доступа: чтение и запись
</dt> </dl>

Не используется.

</dd> <dt>

**суппортссроттлинг**
</dt> <dd> <dl> <dt>

Тип данных: **логический**
</dt> <dt>

Тип доступа: чтение и запись
</dt> </dl>

Не используется.

</dd> <dt>

**унлоадтимеаут**
</dt> <dd> <dl> <dt>

Тип данных: **DateTime**
</dt> <dt>

Тип доступа: чтение и запись
</dt> </dl>

[Формат даты и времени](date-and-time-format.md) , указывающий, как долго WMI позволяет поставщику оставаться в состоянии простоя перед выгрузкой. Как правило, поставщики запрашивают, что инструментарий WMI ожидает не более пяти минут.

Для текущей версии инструментария WMI значение этого свойства игнорируется. Инструментарий WMI выгружает поставщик на основе значения времени ожидания во внутреннем классе \\ корневого пространства имен. Рекомендуется, чтобы поставщики установили **унлоадтимеаут**. Дополнительные сведения см. [в разделе выгрузка поставщика](unloading-a-provider.md).

</dd> <dt>

**Version**
</dt> <dd> <dl> <dt>

Тип данных: **UInt32**
</dt> <dt>

Тип доступа: чтение и запись
</dt> </dl>

Версия поставщика. Поддерживаемые версии: 1 и 2. Версия 2 повысит проверку достоверности для всех связанных регистраций свойств, в частности свойство [**имперсонатионлевел**](swbemsecurity-impersonationlevel.md) .

</dd> </dl>

## <a name="remarks"></a>Remarks

Класс **\_ \_ Win32Provider** является производным от [**\_ \_ provider**](--provider.md).

Большинство поставщиков могут принимать значения по умолчанию для свойства **инитиализатионринтранци** . Однако если поставщик может поддерживать одновременную инициализацию для отдельных пользователей, этому свойству можно присвоить значение 1 (одно). Если требуется сериализованная инициализация, **инитиализатионринтранци** остается равным 0 (нулю). В обоих экземплярах **перусеринитиализатион** имеет значение **true**.

Чистый поставщик или поставщик, устанавливающий для **чистого** свойства **значение true**, существует только для запросов служб из приложений и WMI. Большинство поставщиков являются чистыми поставщиками. Исключением является нечистый поставщик. Нечистые поставщики переходят на роль клиента после завершения обслуживания запросов.

Примером нечистого поставщика является поставщик push-уведомлений, который начинает выдавать запросы и отправляет запросы инструментария WMI после завершения инициализации. Поставщик услуг push-уведомлений не имеет обязанностей, за исключением обновления репозитория CIM данными во время инициализации. После обновления репозитория поставщик push-уведомлений может ожидать выгрузки или перехода к роли клиента. Поставщик push-уведомлений, который ожидает выгрузки, является чистым поставщиком. Поставщик push-уведомлений, участвующий в действиях клиента, не является чистым.

Инструментарий WMI должен иметь возможность отличить чистые поставщики от нечистых поставщиков, чтобы они могли определить, когда его можно будет обезопасить. Инструментарий WMI должен ожидать, пока все операции, затрагивающие нечистые поставщики, не закончится, прежде чем он сможет безопасно завершить работу.

## <a name="requirements"></a>Requirements (Требования)



| Требование | Значение |
|-------------------------------------|--------------------------------|
| Минимальная версия клиента<br/> | Windows Vista<br/>       |
| Минимальная версия сервера<br/> | Windows Server 2008<br/> |
| Пространство имен<br/>                | Все пространства имен WMI<br/>  |



## <a name="see-also"></a>См. также

<dl> <dt>

[**\_\_Поставщик**](/windows/desktop/WmiSdk/--provider)
</dt> <dt>

[Системные классы WMI](wmi-system-classes.md)
</dt> <dt>

[Регистрация поставщика](registering-a-provider.md)
</dt> </dl>

 

