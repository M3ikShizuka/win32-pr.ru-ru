---
description: Поставщик метода позволяет инструментарию WMI обращаться к методам класса. Например, класс, представляющий приложение, может иметь метод, который прерывает работу приложения.
ms.assetid: bce87e65-5cba-4eef-91da-a3e13c80b8a6
ms.tgt_platform: multiple
title: Написание поставщика методов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ea5121d4a9438744ad62b666e62d4ffa90c39428020d3e39c80a6de26e295959
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118311933"
---
# <a name="writing-a-method-provider"></a>Написание поставщика методов

Поставщик метода позволяет инструментарию WMI обращаться к методам класса. Например, класс, представляющий приложение, может иметь метод, который прерывает работу приложения.

Изменение порядка входных и выходных параметров метода при обновлении существующего поставщика методов может привести к сбою в приложениях, которые вызывают метод. Порядок входных или выходных параметров устанавливается значением квалификатора [**ID**](standard-wmi-qualifiers.md) для каждого параметра. Первый параметр имеет нулевое значение **идентификатора** . Добавьте новые входные параметры в конец существующих параметров вместо того, чтобы вставлять их в уже установленную последовательность.

В следующей процедуре описывается реализация поставщика методов.

**Реализация поставщика методов**

1.  Разработка и регистрация поставщика классов с помощью инструментария WMI.

    Поставщики классов регистрируются в WMI путем создания экземпляра [**\_ \_ Win32Provider**](--win32provider.md) и класса [**\_ \_ месодпровидеррегистратион**](--methodproviderregistration.md) . Дополнительные сведения см. [в разделе Регистрация поставщика методов](registering-a-method-provider.md).

2.  Реализуйте интерфейс [**ивбемпровидеринит**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinit) для поставщика.

    > [!Note]  
    > Поставщики методов настоятельно рекомендуется использовать модель многопоточности "both".

     

3.  Реализуйте метод [**IWbemServices:: ексекмесодасинк**](/windows/desktop/api/WbemCli/nf-wbemcli-iwbemservices-execmethodasync) для вашего поставщика.

    Интерфейс [**IWbemServices**](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemservices) является основным интерфейсом для поставщика метода. Дополнительные сведения см. [в разделе Реализация основного интерфейса для поставщика метода](implementing-the-primary-interface-for-a-method-provider.md).

4.  Добавьте дополнительный код, необходимый для поставщика.

    При проектировании поставщика вам, скорее всего, придется вызывать интерфейсы WMI. Дополнительные сведения см. в разделе [вызов метода](calling-a-method.md) и [обслуживание уровней безопасности в поставщике](impersonating-a-client.md).

    При получении сведений для клиента может потребоваться доступ к уровням безопасности для этого клиента. Дополнительные сведения см. в разделе [олицетворение клиента](impersonating-a-client.md).

5.  Замените имеющийся поставщик новым кодом.

    Вам не нужно выполнять этот шаг, если у вас нет уже существующего поставщика для копирования. Дополнительные сведения см. [в разделе Обновление поставщика](updating-a-provider.md).

 

 



