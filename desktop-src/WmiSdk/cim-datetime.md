---
description: Вы можете получить доступ ко всем модель CIM (CIM) датам и времени в WMI, используя один из двух форматов фиксированной длины, характерных для WMI и CIM. В скриптах используйте объект SWbemDateTime, чтобы преобразовать их в обычные даты и время.
ms.assetid: 15126802-82f9-4ab4-98d8-0a15184302e9
ms.tgt_platform: multiple
title: CIM_DATETIME
ms.topic: article
ms.date: 05/31/2018
topic_type:
- kbArticle
api_name: ''
api_type: ''
api_location: ''
ms.openlocfilehash: fee4356050ee340cbf9d1b066f012d32c7185dd2
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105712671"
---
# <a name="cim_datetime"></a>\_Дата и время CIM

Вы можете получить доступ ко всем [*модель CIM (CIM)*](gloss-c.md) датам и времени в WMI, используя один из двух форматов фиксированной длины, характерных для WMI и CIM. В скриптах используйте объект [**SWbemDateTime**](swbemdatetime.md) , чтобы преобразовать их в обычные даты и время.

В следующих разделах описывается использование форматов даты и времени WMI.

## <a name="format"></a>Формат

В следующей таблице перечислены два формата даты и времени, используемые WMI.



| Формат                                                                                                 | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|--------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [DATETIME](datetime.md)<br/> *yyyymmddHHMMSS. Ммммммсууу*<br/>                             | Формат, в котором хранятся значения [**DateTime**](datetime.md) CIM. Этот формат не зависит от языкового стандарта, поэтому можно написать сценарий, который выполняется на любом компьютере. Этот формат необходимо использовать для определения даты и времени в [*MOF-файл (MOF)*](gloss-m.md)или при записи в экземпляр с помощью [API COM для WMI](com-api-for-wmi.md) или [API скриптов для WMI](scripting-api-for-wmi.md). Дополнительные сведения см. в разделе [изменение свойства экземпляра](modifying-an-instance-property.md). |
| Формат допустим только в запросах язык запросов WMI (WQL).<br/> *гггг-мм-дд чч: мм: СС: МММ*<br/> | Этот формат можно использовать в скриптах, использующих методы [**SWbemDateTime**](swbemdatetime.md) . Дополнительные сведения см. в разделе [запросы WMI](querying-wmi.md) или [запросы с помощью WQL](querying-with-wql.md). Этот формат не зависит от языкового стандарта. Порядок года, месяца и дня зависит от региональных и языкового формата сеанса пользователя. Например, хотя по умолчанию для США английский задано значение "mm-дд-гггг чч: мм: СС: МММ", формат большинства других стран или регионов: "гггг-мм-дд чч: мм: СС: МММ".       |



 

В следующей таблице перечислены поля в форматах.



| Поле    | Описание                                                                                                                                                                                                                                     |
|----------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| *yyyy*   | Год из четырех цифр (0000 до 9999). Ваша реализация может ограничивать поддерживаемый диапазон. Например, реализация может поддерживать только годы с 1980 по 2099.                                                                         |
| *мм*     | Месяц из двух цифр (от 01 до 12).                                                                                                                                                                                                                |
| *dd*     | Двузначное число дней в месяце (от 01 до 31). Это значение должно соответствовать месяцу. Например, 31 февраля является недопустимым. Однако ваша реализация не должна проверять допустимые данные.                                            |
| *ФОРМАТЕ*     | Час дня, состоящих из двух цифр, в 24-часовом формате (от 00 до 23).                                                                                                                                                                              |
| *ММ*     | Двузначное число минут в час (от 00 до 59).                                                                                                                                                                                                   |
| *НН*     | Двузначное число секунд в минуте (от 00 до 59).                                                                                                                                                                                      |
| *мммммм* | Число микросекунд, состоящих из шести цифр, в секунду (000000 до 999999). Ваша реализация не должна поддерживать оценку с помощью этого поля. Однако это поле всегда должно присутствовать, чтобы сохранить природу строки фиксированной длины. |
| *mmm*    | 3-значное число миллисекунд в минуте (от 000 до 999).                                                                                                                                                                             |
| *s*      | Знак плюс (+) или знак минуса (-) для обозначения положительного или отрицательного смещения относительно универсального всемирного времени (UTC).                                                                                                                               |
| *ууу*    | 3-значное смещение, указывающее количество минут, в течение которых исходящий часовой пояс отклоняется от времени в формате UTC. Для инструментария WMI рекомендуется, но не требуется, преобразовывать значения времени в GMT (смещение в формате UTC, равное нулю).                                              |



 

Необходимо ввести все поля с указанной длиной, используя ведущие нули в качестве подходящих для типа. Тем не менее, используйте звездочки, чтобы указать неиспользуемые поля или как подстановочные значения. Можно использовать звездочку ( \* ) везде, за исключением предложения **WHERE** запроса. Например, Дата и время с неуказанным годом могут возникать в любом году. Если вы хотите оставить поле неопределенным, необходимо заменить все поле звездочками.

В следующих примерах описываются допустимые и недопустимые использования звездочек.

-   19980416 \* \* \* \* \* \* .000000 + \* \* \* (Юридическая информация)
-   1998-04-16 \* \* \* \* \* \* : \* \* \* (недопустимо)
-   199 \* 0416 \* \* \* \* \* \* .000000 + \* \* \* (недопустимо)
-   199 \* -04-16 \* \* \* \* \* \* : \* \* \* (недопустимо)

Если значение DateTime используется для представления определенного момента времени, то все его поля должны включать данные. Если он используется для представления диапазона времени, то только поля, необходимые для передачи длительности, должны содержать данные.

В следующем примере рассматривается «Апрель First»: Дата относительно некоторого неуказанного года, но по-прежнему определенная точка, если уровень детализации измерения — один день.

-   \*\*\*\*0401 \* \* \* \* \* \* . 000000 +\*\*\*
-   \*\*\*\*-04-01 \* \* \* \* \* \* : \* \* \* (недопустимо)

## <a name="setting-utc-offset-and-gmt"></a>Задание смещения UTC и GMT

В следующих примерах описывается, как можно определить время без часового пояса, поместив звездочки в поле ууу после знака плюс или минус:

-   19980401135809.000000 +\*\*\*
-   19980401135809,000000-\*\*\*
-   1998-04-01 13:58:09: \* \* \* (недопустимо)

Приложение интерпретирует ссылку даты и времени без зоны на локальный, абстрактный чронометер в работающей операционной системе. Например, переносные компьютеры могут иметь внутренние часы, параметры которых могут быть или не соответствовать географическим часовым поясам. Можно интерпретировать время без зоны, подставив часовой пояс текущего абстрактного источника, а не местного часового пояса.

Следует уделить особое внимание значению смещения в формате UTC с датами и временем в запросах. Как правило, сравнение эквивалентов, "больше чем" или "меньше чем" работает между двумя датами и временем, если даты и время используют одно и то же смещение в формате UTC. При работе с датами и временем, которые происходят с различными смещениями часовых поясов, сначала необходимо преобразовать даты и время в GMT.

Запросы, которые содержат относительные значения даты и времени с звездочками в одном или нескольких подполях, имеют смысл только для WMI при сравнении с эквивалентностью. Кроме того, Инструментарий WMI не позволяет использовать звездочки в качестве подстановочных знаков. Вместо этого инструментарий WMI сравнивает относительные значения даты и времени на символьной основе.

В следующих примерах описываются две даты, которые не рассматриваются в запросе WMI:

-   19980401135809.000000 +\*\*\*
-   19980401135809.000000 + 000

## <a name="converting-to-filetime-or-vt_date-format"></a>Преобразование в формат даты FILETIME или VT \_

Формат [**даты и времени**](datetime.md) CIM используется только в WMI. Можно преобразовать в формат WMI и формат даты FILETIME или VT \_ , вызвав методы объекта скрипта [**SWbemDateTime**](swbemdatetime.md) . Структура [](/windows/desktop/api/minwinbase/ns-minwinbase-filetime) **DateTime** FILETIME — это 64-разрядное значение, используемое в операционных системах Windows с 32-разрядной версией. \_Формат даты VT — это значение даты и времени автоматизации, используемое Visual Basic и ActiveX. В следующей таблице перечислены методы преобразования.



| Метод                                                         | Описание                                                                                           |
|----------------------------------------------------------------|-------------------------------------------------------------------------------------------------------|
| [**SWbemDateTime. функции getFileTime**](swbemdatetime-getfiletime.md) | Возвращает значение [**DateTime**](datetime.md) в формате [**fileTime**](/windows/desktop/api/minwinbase/ns-minwinbase-filetime) .                |
| [**SWbemDateTime. GetVarDate**](swbemdatetime-getvardate.md)   | Возвращает значение [**DateTime**](datetime.md) в \_ формате даты VT.                                         |
| [**SWbemDateTime. Сетфилетиме**](swbemdatetime-setvardate.md)  | Задает свойство [**DateTime**](datetime.md) , используя в качестве входных данных дату [**fileTime**](/windows/desktop/api/minwinbase/ns-minwinbase-filetime) . |
| [**SWbemDateTime. Сетвардате**](swbemdatetime-setvardate.md)   | Задает свойство [**DateTime**](datetime.md) , используя в \_ качестве входных данных дату VT.                          |



 

## <a name="related-topics"></a>См. также

<dl> <dt>

[Формат даты и времени](date-and-time-format.md)
</dt> <dt>

[Сведения об инструментарии WMI](about-wmi.md)
</dt> <dt>

[Задачи WMI: даты и время](wmi-tasks--dates-and-times.md)
</dt> <dt>

[Формат интервала](interval-format.md)
</dt> <dt>

[**SWbemObject. размещение\_**](swbemobject-put-.md)
</dt> <dt>

[**Свбемсервицесекс. размещение**](swbemservicesex-put.md)
</dt> <dt>

[**SWbemDateTime**](swbemdatetime.md)
</dt> <dt>

[**Ивбемклассобжект::P UT**](/windows/desktop/api/WbemCli/nf-wbemcli-iwbemclassobject-put)
</dt> <dt>

[**IWbemServices::P Уткласс**](/windows/desktop/api/WbemCli/nf-wbemcli-iwbemservices-putclass)
</dt> </dl>

 

