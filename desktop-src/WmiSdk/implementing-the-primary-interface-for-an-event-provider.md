---
description: Поставщик событий должен реализовывать интерфейс Ивбемевентпровидер для создания уведомлений о событиях.
ms.assetid: ae33c9f5-61f7-4488-a281-01d7f9c62c46
ms.tgt_platform: multiple
title: Реализация основного интерфейса для поставщика событий
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5621a2c6d0901a7925828149dd5c1480c2b11456
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "103998979"
---
# <a name="implementing-the-primary-interface-for-an-event-provider"></a>Реализация основного интерфейса для поставщика событий

Поставщик событий должен реализовывать интерфейс [**ивбемевентпровидер**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovider) для создания уведомлений о событиях. WMI вызывает метод [**ивбемевентпровидер::P ровидивентс**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventprovider-provideevents) поставщика и передает указатель на объект приемника, который является реализацией интерфейса [**ивбемобжектсинк**](iwbemobjectsink.md) . Когда поставщик событий готов к созданию уведомления, поставщик вызывает метод [**ивбемобжектсинк:: обозначают**](/windows/desktop/api/Wbemcli/nf-wbemcli-iwbemobjectsink-indicate) .

Поставщик событий должен располагать уведомления, созданные с помощью [**ивбемевентпровидер**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovider) , в объектах событий. Объекты событий следует реализовывать как записи в массиве интерфейсов [**ивбемклассобжект**](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemclassobject) , представленных параметром *ппобжаррай* метода [**обозначают**](/windows/desktop/api/Wbemcli/nf-wbemcli-iwbemobjectsink-indicate) . Так как **ивбемклассобжектс** являются COM-объектами, поставщик должен увеличить число ссылок для приемника, вызвав метод [**Ивбемобжектсинк:: AddRef**](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) . Поставщики событий, которые должны предоставлять множество уведомлений (например, события 400), должны создавать уникальный объект события для каждого уведомления путем порождения нового экземпляра или клонирования существующего. Инструментарий WMI никогда не удерживает объект события после завершения вызова **указания** и не имеет особых требований к **AddRef** выше и выше, чем Стандартный COM.

При реализации поставщика событий учитывайте следующие рекомендации.

-   Не следует вносить изменения в классы при обслуживании клиентского вызова.
-   Не вызывайте вызовы, связанные с событиями, такие как вызов, который изменяет фильтр событий.
-   Перед повторным запуском события обработайте запросы, которые возникают в службе управления Windows, например [**канцелкуери**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventproviderquerysink-cancelquery).

    Если не обработать запрос, то повторное срабатывание события может заблокировать событие после того, как оно будет принято.

-   Никогда не вызывайте [**ивбемобжектсинк:: SetStatus**](/windows/desktop/api/Wbemcli/nf-wbemcli-iwbemobjectsink-setstatus) из поставщика.

 

 
