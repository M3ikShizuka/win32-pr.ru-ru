---
description: Класс Смтпевентконсумер отправляет сообщение электронной почты с помощью протокола SMTP каждый раз, когда в него передается событие.
ms.assetid: 42178360-9e22-4cd1-9b72-5f6b0d7e6c9c
ms.tgt_platform: multiple
title: Класс Смтпевентконсумер
ms.topic: reference
ms.date: 05/31/2018
topic_type:
- APIRef
- kbSyntax
api_name:
- SMTPEventConsumer
- SMTPEventConsumer.CreatorSID
- SMTPEventConsumer.MachineName
- SMTPEventConsumer.MaximumQueueSize
- SMTPEventConsumer.BccLine
- SMTPEventConsumer.CcLine
- SMTPEventConsumer.FromLine
- SMTPEventConsumer.HeaderFields
- SMTPEventConsumer.Message
- SMTPEventConsumer.Name
- SMTPEventConsumer.ReplyToLine
- SMTPEventConsumer.SMTPServer
- SMTPEventConsumer.Subject
- SMTPEventConsumer.ToLine
api_type:
- DllExport
api_location:
- Smtpcons.dll
ms.openlocfilehash: 76c7fad3b5cb4bbf6c3c0c03689607ba64fbcc67
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104272570"
---
# <a name="smtpeventconsumer-class"></a>Класс Смтпевентконсумер

Класс **смтпевентконсумер** отправляет сообщение электронной почты с помощью протокола SMTP каждый раз, когда в него передается событие. SMTP-сервер должен существовать в сети. Класс Смтпевентконсумер не поддерживает вложения. Кодировка сообщения электронной почты должна быть US-ASCII.

Этот класс является одним из стандартных потребителей событий, предоставляемых инструментарием WMI. Пример использования **смтпевентконсумер** для создания потребителя см. в разделе [Отправка сообщения электронной почты на основе события](sending-e-mail-based-on-an-event.md). Дополнительные сведения см. [в разделе Мониторинг и реагирование на события с помощью стандартных потребителей](monitoring-and-responding-to-events-with-standard-consumers.md).

Следующий синтаксис упрощен из кода MOF-файл (MOF) и включает все его унаследованные свойства. Свойства и методы имеют алфавитный порядок, а не порядок MOF.

## <a name="syntax"></a>Синтаксис

``` syntax
[AMENDMENT]
class SMTPEventConsumer : __EventConsumer
{
  uint8  CreatorSID[];
  string MachineName;
  uint32 MaximumQueueSize;
  string BccLine;
  string CcLine;
  string FromLine;
  string HeaderFields[];
  string Message;
  string Name;
  string ReplyToLine;
  string SMTPServer;
  string Subject;
  string ToLine;
};
```

## <a name="members"></a>Члены

Класс **смтпевентконсумер** имеет следующие типы членов:

-   [Свойства](#properties)

### <a name="properties"></a>Свойства

Класс **смтпевентконсумер** имеет следующие свойства.

<dl> <dt>

**бкклине**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Список адресов, разделенных запятой или точкой с запятой, в формате стандартного строкового шаблона, в который сообщение отправляется в виде скрытой копии. Дополнительные сведения см. в подразделе «Примечания» этого раздела.

</dd> <dt>

**кклине**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Список адресов, разделенных запятой или точкой с запятой, в формате стандартного строкового шаблона, в который отправляется сообщение в виде копии. Дополнительные сведения см. в подразделе «Примечания» этого раздела.

</dd> <dt>

**креаторсид**
</dt> <dd> <dl> <dt>

Тип данных: массив **Uint8**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Идентификатор безопасности (SID), однозначно определяющий пользователя, который создает фильтр. WMI хранит идентификатор безопасности пользователя, создающего экземпляр [**\_ \_ евентконсумер**](--eventconsumer.md) , или идентификатор безопасности администратора в зависимости от операционной системы. Дополнительные сведения см. в статьях [Привязка фильтра событий к логическому потребителю](binding-an-event-filter-with-a-logical-consumer.md) и [мониторинг и реагирование на события с помощью стандартных потребителей](monitoring-and-responding-to-events-with-standard-consumers.md).

Это свойство наследуется от [**\_ \_ евентконсумер**](--eventconsumer.md).

</dd> <dt>

**фромлине**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Строка из строки сообщения электронной почты в формате стандартного строкового шаблона. Если **значение равно NULL**, строка From создается в виде "Winmgmt@*MachineName*".

</dd> <dt>

**хеадерфиелдс**
</dt> <dd> <dl> <dt>

Тип данных: массив **строк**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Массив полей заголовков, которые вставляются в сообщение электронной почты без интерпретации.

</dd> <dt>

**MachineName**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Имя компьютера, на который инструментарий управления Windows (WMI) (WMI) отправляет события.

Это свойство наследуется от [**\_ \_ евентконсумер**](--eventconsumer.md).

</dd> <dt>

**максимумкуеуесизе**
</dt> <dd> <dl> <dt>

Тип данных: **UInt32**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Максимальная очередь для конкретного потребителя в байтах.

Это свойство наследуется от [**\_ \_ евентконсумер**](--eventconsumer.md).

</dd> <dt>

**Message**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Стандартный строковый шаблон, содержащий текст сообщения электронной почты.

</dd> <dt>

**Name**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: только для чтения
</dt> <dt>

Квалификаторы: [ **ключ**](key-qualifier.md)
</dt> </dl>

Уникальный идентификатор потребителя событий.

</dd> <dt>

**реплитолине**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Строка ответа на сообщение электронной почты в формате стандартного строкового шаблона. Если **значение равно NULL**, строка ответа не используется.

</dd> <dt>

**SMTPServer**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Имя SMTP-сервера, через который отправляется сообщение электронной почты. Допустимые имена: IP-адрес, DNS или NetBIOS-имя. Это свойство не может иметь **значение NULL**.

</dd> <dt>

**Тема**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Стандартный строковый шаблон, содержащий тему сообщения электронной почты.

</dd> <dt>

**Поле ToLine**
</dt> <dd> <dl> <dt>

Тип данных: **строка**
</dt> <dt>

Тип доступа: только для чтения
</dt> </dl>

Список адресов, разделенных запятой или точкой с запятой, в формате стандартного строкового шаблона, определяющего место отправки сообщения. Дополнительные сведения см. в подразделе «Примечания» этого раздела.

</dd> </dl>

## <a name="remarks"></a>Комментарии

Класс смтпевентконсумер является производным от абстрактного класса [**\_ \_ евентконсумер**](--eventconsumer.md) .

Некоторые свойства **поле ToLine**, **кклине** или **бкклине** могут иметь **значение NULL**, но они не могут иметь **значение NULL**.

Получение кода возврата ошибки от службы SMTP считается сбоем.

## <a name="examples"></a>Примеры

Пример использования **смтпевентконсумер** для создания потребителя см. в разделе [Отправка сообщения электронной почты на основе события](sending-e-mail-based-on-an-event.md). Дополнительные сведения см. [в разделе Мониторинг и реагирование на события с помощью стандартных потребителей](monitoring-and-responding-to-events-with-standard-consumers.md).

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|-----------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows Vista<br/>                                                                |
| Минимальная версия сервера<br/> | Windows Server 2008<br/>                                                          |
| Пространство имен<br/>                | Корневая \\ Подписка<br/>                                                           |
| MOF<br/>                      | <dl> <dt>Смтпконс. mof</dt> </dl> |
| DLL<br/>                      | <dl> <dt>Smtpcons.dll</dt> </dl> |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**\_\_евентконсумер**](--eventconsumer.md)
</dt> <dt>

[Классы стандартных потребителей](standard-consumer-classes.md)
</dt> <dt>

[Отправка сообщения электронной почты на основе события](sending-e-mail-based-on-an-event.md)
</dt> <dt>

[Создание логического потребителя](creating-a-logical-consumer.md)
</dt> <dt>

[Получение событий в любое время](receiving-events-at-all-times.md)
</dt> </dl>

 

 




