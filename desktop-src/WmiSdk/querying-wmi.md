---
description: Одним из основных средств инструментарий управления Windows (WMI) (WMI) является возможность запрашивать в репозитории WMI сведения о классе и экземпляре.
ms.assetid: 0cceda42-fba0-4a08-90dd-43f022d0be41
ms.tgt_platform: multiple
title: Запрос WMI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fdae44d4c40e1127bfc4d3436d6230eafd52146a
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105692710"
---
# <a name="querying-wmi"></a>Запрос WMI

Одним из основных средств инструментарий управления Windows (WMI) (WMI) является возможность запрашивать в репозитории WMI сведения о классе и экземпляре. Например, можно запросить, чтобы инструментарий WMI возвращал все объекты, представляющие события завершения работы, из настольной системы. Можно также получить данные класса, экземпляра или схемы. В следующей таблице перечислены различные типы запросов, которые можно выполнить.



| Раздел                                                                | Описание                                                                                                                                                                                      |
|----------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [Вызов синхронного запроса](invoking-a-synchronous-query.md)     | Описывается, как поддерживать связь с WMI во время выполнения запроса. Синхронные запросы хорошо подходят для небольших запросов или запросов к локальной системе.<br/>                                  |
| [Вызов асинхронного запроса](invoking-an-asynchronous-query.md) | Описывает, как настроить отдельный процесс получения запросов. Асинхронные запросы более сложны и обеспечивают более низкий уровень безопасности, но обычно улучшают производительность системы.<br/> |



 

Помимо запроса к репозиторию WMI, можно также использовать [*язык запросов WMI (WQL)*](gloss-w.md) для маршрутизации событий уведомления в приложение. Дополнительные сведения см. [в разделе Получение WMI-события](receiving-a-wmi-event.md).

> [!Note]
>
> Чтобы правильно запрашивать Инструментарий WMI, необходимо иметь хорошее представление о WQL. Запрос, который является неправильным, слишком сложным или неприемлемым, может привести к тому, что обработчик запросов возвратит ошибку или непредвиденные результаты. Полный обзор WQL см. в разделе [запросы с помощью WQL](querying-with-wql.md).
>
> Существует ряд ограничений на количество ключевых слов **and** и **or** , которые могут использоваться в запросах WQL. Большое количество ключевых слов WQL, используемых в сложном запросе, может привести к тому, что WMI вернет код ошибки **\_ \_ \_ нарушения квоты WBEM E** как значение **HRESULT** . Ограничение ключевых слов WQL зависит от того, насколько сложным является запрос.
>
> При запросе значений свойств с типом данных **UInt64** или **sint64** в языке сценариев, например VBScript, Инструментарий WMI возвращает строковые значения. При сравнении этих значений могут возникать непредвиденные результаты, поскольку сравнение строк возвращает разные результаты, чем сравнение чисел. Например, значение "10000000000" меньше "9" при сравнении строк, а значение 9 меньше 10000000000 при сравнении чисел. Чтобы избежать путаницы, следует использовать метод [CDbl](/previous-versions//ftekwwt0(v=vs.85)) в VBScript при получении свойств типа **UInt64** или **sint64** из WMI.

 

> [!Note]  

 

Дополнительные сведения см. в разделе [Управление сведениями о классе и экземпляре](manipulating-class-and-instance-information.md).

 

