---
description: 'Существует два способа реализации поставщика класса: реализуйте интерфейс в качестве поставщика push-уведомлений или в качестве поставщика извлечения.'
ms.assetid: 2c6d3f73-e219-409b-9347-492035c1eb9f
ms.tgt_platform: multiple
title: Реализация основного интерфейса для поставщика класса
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d3ef1b31e1228b832e4d23945f3af0c4df223ddd3edebdd1ec6e34e0e0e8d449
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "120030444"
---
# <a name="implementing-the-primary-interface-for-a-class-provider"></a>Реализация основного интерфейса для поставщика класса

Существует два способа реализации поставщика класса: реализуйте интерфейс в качестве поставщика push-уведомлений или в качестве поставщика извлечения.

В этом разделе обсуждаются следующие разделы:

-   [Реализация основного интерфейса для поставщика класса push-уведомлений](#implementing-the-primary-interface-for-a-push-class-provider)
-   [Реализация основного интерфейса для поставщика опрашивающего класса](#implementing-the-primary-interface-for-a-pull-class-provider)

## <a name="implementing-the-primary-interface-for-a-push-class-provider"></a>Реализация основного интерфейса для поставщика класса push-уведомлений

В то время как все поставщики реализуют [**ивбемпровидеринит**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinit) для инициализации и по крайней мере один другой интерфейс в качестве основного интерфейса, поставщик push-уведомлений реализует только **ивбемпровидеринит**.

Убедитесь, что ваша реализация выполняет следующие задачи:

-   Извлекает соответствующие данные класса.
-   Помещает данные в репозиторий WMI.
-   Удаляет устаревшие данные.

После завершения процесса инициализации Инструментарий WMI обрабатывает все запросы приложений для классов, принадлежащих поставщику push-уведомлений, без какого-либо дополнительного взаимодействия с поставщиком. После этого поставщик push-уведомлений эффективно выступает в качестве клиента инструментария WMI, а не поставщика. Дополнительные сведения о реализации [**ивбемпровидеринит**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinit)см. [в разделе Инициализация поставщика](initializing-a-provider.md).

> [!Note]  
> При вызове инструментария WMI для создания, обновления или удаления данных в поставщике push-уведомлений установите параметр *лфлагс* , чтобы он включал флаг **\_ \_ \_ обновления владельца флага WBEM** во всех вызовах методов [**IWbemServices**](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemservices) .

 

## <a name="implementing-the-primary-interface-for-a-pull-class-provider"></a>Реализация основного интерфейса для поставщика опрашивающего класса

Поставщик опрашивающего класса должен реализовать [**IWbemServices**](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemservices) в качестве основного интерфейса. Интерфейс **IWbemServices** поддерживает получение данных, обновление данных, удаление данных, перечисление и обработку запросов. Однако, поскольку служба **IWbemServices** также используется приложениями и поставщиками для запроса служб WMI, **IWbemServices** содержит множество методов, не отсущественных для поставщика класса. Ваша реализация должна поддерживать извлечение и перечисление классов с помощью методов [**жетобжектасинк**](/windows/desktop/api/WbemCli/nf-wbemcli-iwbemservices-getobjectasync) и [**креатеклассенумасинк**](/windows/desktop/api/WbemCli/nf-wbemcli-iwbemservices-createclassenumasync) соответственно. В следующей таблице перечислены дополнительные асинхронные методы **IWbemServices** , которые можно реализовать для поставщика класса.



| Метод                                                     | Компонент      |
|------------------------------------------------------------|--------------|
| [**путинстанцеасинк**](/windows/desktop/api/WbemCli/nf-wbemcli-iwbemservices-putinstanceasync) | Изменение |
| [**делетеклассасинк**](/windows/desktop/api/WbemCli/nf-wbemcli-iwbemservices-deleteclassasync) | Удаление     |



 

> [!Note]  
> Поскольку обратный вызов приемника может не возвращаться на том же уровне проверки подлинности, что и клиент, рекомендуется использовать семисинчронаус вместо асинхронного взаимодействия. Дополнительные сведения см. [в разделе вызов метода](calling-a-method.md).

 

Поставщик класса должен предоставить реализацию заглушки, которая возвращает **\_ поставщик WBEM E, \_ \_ не \_ поддерживающий** все другие методы [**IWbemServices**](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemservices) , которые не поддерживают набор функций. В частности, Инструментарий WMI не поддерживает обработку запросов для поставщиков классов. Таким образом, поставщик класса должен возвращать **\_ поставщик WBEM E, \_ \_ не \_ поддерживающий** их реализацию [**IWbemServices:: ексеккуерясинк**](/windows/desktop/api/WbemCli/nf-wbemcli-iwbemservices-execqueryasync), присвоить свойству регистрации **куерисуппортлевелс** **значение NULL** или и то, и другое.

Интерфейсы, реализуемые поставщиком классов, очень похожи на интерфейсы для поставщика экземпляров и поставщика методов. Фактически, один поставщик может действовать как все три типа поставщика, реализовав все методы и зарегистрировав их правильно.

 

 



