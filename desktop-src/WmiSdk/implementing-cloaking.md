---
description: Маскировка — это расширение для олицетворения, позволяющее лучше контролировать, как COM олицетворяет клиента через прокси-сервер. Как и многие формы системы безопасности WMI, вы устанавливаете маскировку с помощью интерфейсов CoSetProxyBlanket и CoInitializeSecurity.
ms.assetid: e094aecc-e940-43aa-87c2-ea8cc86d1051
ms.tgt_platform: multiple
title: Реализация маскировки
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d8d32333250bc37d8ccbfdb17421fed635f0da77e6394229220b2b36a1ce57f1
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118318899"
---
# <a name="implementing-cloaking"></a>Реализация маскировки

Маскировка — это расширение для олицетворения, позволяющее лучше контролировать, как COM олицетворяет клиента через прокси-сервер. Как и многие формы системы безопасности WMI, вы устанавливаете маскировку с помощью интерфейсов [**CoSetProxyBlanket**](/windows/win32/api/combaseapi/nf-combaseapi-cosetproxyblanket) и [**CoInitializeSecurity**](/windows/win32/api/combaseapi/nf-combaseapi-coinitializesecurity) .

Модель COM предоставляет следующие формы маскировки:

-   Статический

    COM устанавливает удостоверение маркера потоком или маркером процесса при первом вызове прокси-сервера. Если вы используете статическую маскировку с помощью [**CoSetProxyBlanket**](/windows/win32/api/combaseapi/nf-combaseapi-cosetproxyblanket), вы задаете удостоверение прокси-сервера в течение жизненного цикла прокси-сервера.

-   Динамический

    COM повторно устанавливает удостоверение маркера из токена потока или процесса при каждом вызове прокси-сервера. Так как COM проверяет удостоверение при каждом вызове, динамическое Маскировка позволяет более точно контролировать удостоверение клиента. Однако динамическая маскировка менее эффективна, чем статическая маскировка.

При установке маскировки в сочетании с уровнем делегирования олицетворения сервер может распространять удостоверение клиента между серверами, даже если эти серверы являются удаленными. Если не включить маскировку, COM выполняет любой вызов с локального сервера на удаленном сервере в контексте фактического серверного процесса.

Маскировка позволяет WMI олицетворять клиента для доступа к локальным и удаленным сетевым ресурсам на нескольких компьютерах. Инструментарий WMI может передавать удостоверение клиента локальным и удаленным серверам, например другим удаленным экземплярам WMI. Эти удаленные серверы могут затем выполнять операции в исходном контексте клиента.

В следующей процедуре описывается совместное использование маскировки и делегирования.

**Совместное использование маскировки и делегирования**

1.  Задайте для службы проверки подлинности значение Kerberos.

    Kerberos — единственная служба проверки подлинности, поддерживающая удаленное маскировку и делегирование. Это означает, что маскировка и делегирование можно использовать только на удаленных серверах.

2.  Пометьте учетную запись входа сервера как доверенную для делегирования в службах Active Directory.
3.  Пометьте учетную запись входа клиента как "учетная запись важна и не может быть делегирована" в Active Directory Services.

Например, вызов поставщика представления, который может вернуть объекты из нескольких экземпляров инструментария WMI на нескольких компьютерах, может воспользоваться преимуществами делегирования и маскировки.

 

 
