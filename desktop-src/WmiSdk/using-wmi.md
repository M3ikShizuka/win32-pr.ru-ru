---
description: Стратегия использования инструментария WMI для получения данных клиентских скриптов и приложений или предоставления данных инструментарию WMI из приложения.
ms.assetid: d9a3741c-313f-4b63-8588-696a10d370f5
ms.tgt_platform: multiple
title: Использование инструментария WMI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 82d1556d321441c7e6a3191bf95e85db356e7ba9
ms.sourcegitcommit: 9b5faa61c38b2d0c432b7f2dbee8c127b0e28a7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/19/2021
ms.locfileid: "122475320"
---
# <a name="using-wmi"></a>Использование инструментария WMI

Инструментарий WMI можно использовать из клиентских приложений и скриптов. Она предоставляет инфраструктуру, которая упрощает обнаружение и выполнение задач управления. Кроме того, можно добавить в набор возможных задач управления, создав собственные поставщики WMI.

> [!Note]  
> версия инструментария WMI следующего поколения для написания приложений и скриптов доступна через инфраструктуру управления Windows (MI). Дополнительные сведения см. в разделе [поставщики и Клиенты MI](/previous-versions/windows/desktop/wmi_v2/mi-providers-and-clients-node-page).

 

В этом разделе рассматриваются следующие вопросы.

-   [Получение данных из WMI](#obtaining-data-from-wmi)
-   [Предоставление данных инструментарию WMI](#providing-data-to-wmi)
-   [Важные задачи для инструментария WMI](#important-tasks-for-wmi)

## <a name="obtaining-data-from-wmi"></a>Получение данных из WMI

Следующая процедура описывает получение данных из WMI с помощью написания сценария или приложения.

**Получение данных из WMI с помощью написания сценария или приложения**

1.  Выбор языка для использования. Дополнительные сведения о скриптах см. [в разделе Создание скрипта WMI](creating-a-wmi-script.md). Дополнительные сведения о C++ см. [в разделе Создание приложения WMI с помощью c++](creating-a-wmi-application-using-c-.md). Дополнительные сведения о C# или WMI .NET см. в разделе [Общие сведения о WMI .NET](/previous-versions/).

    Вы можете просматривать данные WMI или управлять ими на многих языках. В следующей таблице перечислены разделы, в которых описывается использование языков сценариев и приложений для получения данных.

    

    
| Язык приложения | Раздел | 
|----------------------|-------|
| сценарии, написанные на размещении сценариев Microsoft ActiveX, включая Visual Basic scripting Edition (VBScript) и Perl<br /> | <a href="scripting-api-for-wmi.md">API сценариев для инструментария WMI</a>.<br /> Начните с <a href="creating-a-wmi-script.md">создания сценария WMI</a>.<br /> Примеры кода сценариев см. в разделе <a href="wmi-tasks-for-scripts-and-applications.md">задачи WMI для сценариев и приложений</a> и репозиторий сценариев TechNet <a href="https://www.microsoft.com/technet/scriptcenter">скриптцентер</a> .<br /> | 
| Windows PowerShell<br /> | <a href="/powershell/scripting/getting-started/getting-started-with-windows-powershell?view=powershell-7">начало работы с Windows PowerShell</a><br /> Командлеты WMI PowerShell, такие как <a href="/previous-versions//dd315295(v=technet.10)">Get-WmiObject</a>.<br /> | 
| Visual Basic приложения<br /> | <a href="scripting-api-for-wmi.md">API сценариев для инструментария WMI</a>.<br /> | 
| ASP<br /> | <a href="scripting-api-for-wmi.md">API сценариев для инструментария WMI</a>.<br /> Начните с <a href="creating-active-server-pages-for-wmi.md">создания страниц Active Server для WMI</a>.<br /> | 
| приложения C++<br /> | <a href="com-api-for-wmi.md">COM API для WMI</a>.<br /> Начните с <a href="creating-a-wmi-application-using-c-.md">создания приложения WMI с помощью c++</a> и <a href="wmi-c---application-examples.md">примеров приложения WMI c++</a> (содержит примеры).<br /> | 
| платформа .NET Framework приложения, написанные на C#, Visual Basic .net или J #<br /> | Классы в пространстве имен <a href="/previous-versions//hh872326(v=vs.85)"><strong>Microsoft. Management. Infrastructure</strong></a> .<br /><blockquote>    [!Note]<br /><strong>System. Management</strong> является исходным пространством имен, которое охватывает управляемый код для инструментария WMI. Однако базовая технология <strong>System. Management</strong> обычно выполняется медленнее, чем, и не поддерживает масштабирование, а также <a href="/previous-versions//hh872326(v=vs.85)"><strong>Microsoft. Management. Infrastructure</strong></a>. Поэтому не рекомендуется использовать <strong>System. Management</strong> для новых проектов. (Дополнительные сведения о <strong>System. Management</strong>см. в разделе <a href="/previous-versions/bb404655(v=vs.90)">Общие сведения о WMI .NET</a>.)    </blockquote><br /> | 


    

     

2.  Убедитесь, что подключения к удаленным компьютерам работают.

    Дополнительные сведения см. в разделе [Подключение к WMI на удаленном компьютере](connecting-to-wmi-on-a-remote-computer.md).

3.  Для подключения к инструментарию WMI на удаленных компьютерах требуются правильные настройки безопасности, как описано в разделах [Поддержка безопасности WMI](maintaining-wmi-security.md). В следующей таблице перечислены разделы, в которых описывается настройка параметров безопасности с помощью языков сценариев и приложений.

    

    | Язык                                                      | Раздел                                                                                                                                                                                                                                                 |
    |---------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
    | сценарии на любом языке, Visual Basic приложениях<br/> | [Настройка уровня безопасности процесса по умолчанию с помощью VBScript](setting-the-default-process-security-level-using-vbscript.md)<br/>                                                                                                                 |
    | ASP<br/>                                | [Настройка IIS 5 и более поздних версий для сценариев ASP WMI](configuring-iis-5-for-wmi-asp-scripting.md)<br/>                                                                                                                                           |
    | C++<br/>                                                | [Настройка уровня безопасности процесса по умолчанию с помощью C++](setting-the-default-process-security-level-using-c-.md) и [Настройка параметров безопасности для IWbemServices и других прокси-серверов](setting-the-security-on-iwbemservices-and-other-proxies.md)<br/> |

    

     

4.  После подключения к инструментарию WMI можно получать данные с помощью запросов и перечислений.

    Дополнительные сведения см. в статьях [Управление сведениями о классе и экземпляре](manipulating-class-and-instance-information.md) и [запросы с помощью WQL](querying-with-wql.md).

5.  Данные реестра доступны через инструментарий WMI. Вы можете создавать новые ключи и значения или изменять существующие.

    Дополнительные сведения см. [в разделе изменение системного реестра](modifying-the-system-registry.md).

6.  Вы можете подписываться на уведомления о событиях через WMI, временно перезагружать систему или навсегда.

    Дополнительные сведения см. в разделе [мониторинг событий](monitoring-events.md) и [Получение события WMI](receiving-a-wmi-event.md).

7.  Данные счетчиков производительности для системы доступны через инструментарий WMI.

    Счетчики системной библиотеки производительности преобразуются в классы WMI. Дополнительные сведения см. в разделе [наблюдение за данными производительности](monitoring-performance-data.md).

8.  [Задачи WMI для сценариев и приложений](wmi-tasks-for-scripts-and-applications.md) . описывает выполнение многих административных задач с помощью инструментария WMI.

## <a name="providing-data-to-wmi"></a>Предоставление данных инструментарию WMI

Следующая процедура описывает, как передать данные в WMI, написав поставщик.

**Предоставление данных в WMI путем написания поставщика**

-   Выбор типа поставщика для записи.

    Нельзя написать поставщик WMI в VBScript. Однако для создания поставщика COM WMI можно использовать несколько других подходов:

    -   Использование мастера WMI ATL в Visual Studio.

        При таком подходе создается неуправляемый поставщик COM. Дополнительные сведения см. в разделе [Добавление поставщика экземпляров WMI](./writing-an-instance-provider.md) и [Добавление поставщика событий WMI](./writing-an-event-provider.md).

    -   Использование COM непосредственно в любой интегрированной среде разработки.

        При таком подходе создается неуправляемый поставщик COM.

    -   использование инструментария WMI в платформа .NET Framework для создания управляемого поставщика кода.

        При таком подходе создается управляемый поставщик кода. поставщики управляемого кода могут быть написаны на любом языке платформа .NET Framework, проще писать, чем поставщики COM wmi, и могут получать данные из классов на основе [*CIM*](gloss-c.md)wmi, таких как [классы Win32](/windows/desktop/CIMWin32Prov/win32-provider). однако у поставщика платформа .NET Framework WMI есть некоторые ограничения. Дополнительные сведения см. в разделе [Управление приложениями с помощью инструментария WMI](/previous-versions/dotnet/netframework-1.1/aa720264(v=vs.71)).

    -   Использовать [классы инфраструктуры поставщика](wmi-c-classes.md) не рекомендуется.

        платформа поставщика была заменена мастерами WMI ATL, напрямую использовать COM или поставщиками платформа .NET Framework. Создание поставщика COM WMI с классами инфраструктуры поставщика больше не рекомендуется. в следующей таблице перечислены разделы, в которых описывается использование поставщиков COM или платформа .NET Framework.

    

    | Поставщик                                                      | Раздел                                                                                                   |
    |---------------------------------------------------------------|---------------------------------------------------------------------------------------------------------|
    | Поставщик COM в том же процессе, что и WMI<br/>            | [Предоставление данных инструментарию WMI](providing-data-to-wmi.md)<br/>                                           |
    | Несвязанный поставщик COM<br/>                             | [Включение поставщика в приложение](incorporating-a-provider-in-an-application.md)<br/> |
    | поставщик платформа .NET Framework в C# или Visual Basic .net<br/> | [Управление приложениями с помощью инструментария WMI](/previous-versions/dotnet/netframework-1.1/aa720264(v=vs.71))<br/>            |

    

     

## <a name="important-tasks-for-wmi"></a>Важные задачи для инструментария WMI

Следующие разделы содержат сведения об использовании инструментария WMI для мониторинга и управления корпоративными компонентами.



| Раздел                                                                                                                                           | Описание                                                                                                                                                                                                                                                                                                                                                           |
|-------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [Задачи WMI для скриптов и приложений](wmi-tasks-for-scripts-and-applications.md)<br/>                                                 | Описывает, как найти правильный класс WMI и процедуры для использования в сценариях и приложениях, выполняющих общие задачи администрирования компьютера и сети, такие как добавление нового подключения к принтеру для удаленного компьютера или поиск всех установленных исправлений на компьютере.<br/>                                                                            |
| [Создание приложения или скрипта WMI](creating-a-wmi-application-or-script.md)<br/>                                                     | любой язык сценариев, например VBScript или Perl, который работает с ActiveX объектами, может получить доступ к данным WMI. приложения могут получать доступ к WMI в C++, используя [API COM для WMI](com-api-for-wmi.md) или в Visual Basic, используя[библиотеку типов](using-the-wmi-scripting-type-library.md) Wbemdisp. tlb и [API скриптов для WMI](scripting-api-for-wmi.md).<br/> |
| [Подключение к инструментарию WMI на удаленном компьютере](connecting-to-wmi-on-a-remote-computer.md)<br/>                                                 | Описывает, как сценарии, приложения и поставщики могут устанавливать подключения к инструментарию WMI на удаленных компьютерах для получения данных, управления оборудованием и программным обеспечением.<br/>                                                                                                                                                                                                   |
| [Подключение к инструментарию WMI на удаленном компьютере с помощью Windows PowerShell](connecting-to-wmi-on-a-remote-computer-by-using-powershell.md)<br/> | описывает использование Windows PowerShell для установки подключений к инструментарию WMI на удаленных компьютерах для получения данных или управления оборудованием и программным обеспечением.<br/>                                                                                                                                                                                                            |
| [Мониторинг событий](monitoring-events.md)<br/>                                                                                           | Описывает получение уведомлений о событиях путем создания временных или постоянных потребителей событий WMI.<br/>                                                                                                                                                                                                                                                           |
| [Предоставление данных инструментарию WMI](providing-data-to-wmi.md)<br/>                                                                                   | Инструментарий WMI предоставляет клиентским скриптам и приложениям динамические данные управления, получая их от поставщиков.<br/>                                                                                                                                                                                                                                                    |
| [Получение и предоставление данных на 64-разрядном компьютере](getting-and-providing-data-on-a-64-bit-computer.md)<br/>                               | Описывает, как получить доступ к поставщикам, не используемым по умолчанию, и рекомендации для модулей записи поставщика в 64-разрядных системах<br/>                                                                                                                                                                                                                                                    |



