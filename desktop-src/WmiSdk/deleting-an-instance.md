---
description: Удаление экземпляра — это наиболее распространенная команда удаления, которая, скорее всего, будет выполняться в инструментарии WMI.
ms.assetid: 95ba3e9c-1397-41fe-a080-c03a98aafd42
ms.tgt_platform: multiple
title: Удаление экземпляра
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: b2229889ec4bc21ad234eb1636f264977bb3e25e
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105702073"
---
# <a name="deleting-an-instance"></a>Удаление экземпляра

Удаление экземпляра — это наиболее распространенная команда удаления, которая, скорее всего, будет выполняться в инструментарии WMI. Как и при удалении класса, фактическая команда довольно проста. Однако Инструментарий WMI работает совершенно иначе в зависимости от типа удаляемого экземпляра. Если экземпляр является статическим, Инструментарий WMI просто удаляет экземпляр из репозитория WMI. Сведения об удалении классов и экземпляров из репозитория WMI см. в описании команды препроцессора [**pragma делетекласс**](pragma-deleteclass.md) .

Если экземпляр является динамическим, Инструментарий WMI должен вызвать [**IWbemServices::D елетеинстанцеасинк**](/windows/desktop/api/WbemCli/nf-wbemcli-iwbemservices-deleteinstanceasync) для поставщиков, ответственных за следующие классы:

-   Класс, которому принадлежит экземпляр.
-   Каждый родительский класс класса, владеющего экземпляром.
-   Каждый подкласс класса, владеющего экземпляром.

Успешность удаления зависит от самого верхнего неабстрактного класса для исходного экземпляра. Если поставщик любого самого верхнего неабстрактного класса успешно завершает удаление, операция завершается успешно. Дополнительные сведения см. в подразделе "Примечания" [**IWbemServices::D елетеинстанце**](/windows/desktop/api/WbemCli/nf-wbemcli-iwbemservices-deleteinstance).

[Интерфейс API COM для WMI](com-api-for-wmi.md) имеет различные методы для удаления экземпляра и удаления объекта.

В следующей процедуре описывается, как использовать C++ для удаления экземпляра базового класса или производного класса.

**Удаление экземпляра базового класса или производного класса с помощью C++**

-   Вызовите методы [**IWbemServices::D елетеинстанце**](/windows/desktop/api/WbemCli/nf-wbemcli-iwbemservices-deleteinstance) или [**IWbemServices::D елетеинстанцеасинк**](/windows/desktop/api/WbemCli/nf-wbemcli-iwbemservices-deleteinstanceasync) .

    Как видно из названия, [**делетеинстанцеасинк**](/windows/desktop/api/WbemCli/nf-wbemcli-iwbemservices-deleteinstanceasync) удаляет экземпляр асинхронно, в то время как [**DeleteInstance**](/windows/desktop/api/WbemCli/nf-wbemcli-iwbemservices-deleteinstance) удаляет экземпляр синхронно. Чтобы использовать **делетеинстанцеасинк**, необходимо также реализовать объект [**ивбемобжектсинк**](iwbemobjectsink.md) .

> [!Note]  
> Поскольку обратный вызов приемника может не возвращаться на том же уровне проверки подлинности, что и клиент, рекомендуется использовать семисинчронаус вместо асинхронного взаимодействия. Дополнительные сведения см. [в разделе вызов метода](calling-a-method.md).

 

[API скриптов для WMI](scripting-api-for-wmi.md) использует те же методы для удаления объекта класса или экземпляра.

В следующей процедуре описывается, как использовать VBScript для удаления экземпляра базового класса или производного класса.

**Удаление экземпляра базового класса или производного класса с помощью VBScript**

-   Вызовите методы [**SWbemObject. Delete \_**](swbemobject-delete-.md) или [**SWbemObject. DeleteAsync \_**](swbemobject-deleteasync-.md) .

    Как видно из названия, [**DELETE \_**](swbemobject-delete-.md) удаляет экземпляр синхронно, в то время как [**DeleteAsync \_**](swbemobject-deleteasync-.md) удаляет экземпляр асинхронно. Дополнительные сведения об асинхронном удалении экземпляра см. в разделе [вызов метода](calling-a-method.md).

    В следующем примере показано, как удалить экземпляр с помощью VBScript.

    ```VB
    Dim service

    Set service = GetObject("winmgmts:{impersonationLevel=impersonate}") 

    Set objwbemobject= service.get("")

    objwbemobject.Path_.Class = "MyNewClass" 
    objwbemobject.put_
    service.delete  "MyNewClass"
    ```

    

> [!Note]  
> Поскольку обратный вызов приемника может не возвращаться на том же уровне проверки подлинности, что и клиент, рекомендуется использовать семисинчронаус вместо асинхронного взаимодействия. Дополнительные сведения см. [в разделе вызов метода](calling-a-method.md).

 

 

 



