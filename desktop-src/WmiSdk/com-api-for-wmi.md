---
description: Для записи клиентских приложений управления или создания нового поставщика WMI можно использовать API-интерфейс модели COM компонента WMI.
ms.assetid: 5fa8f1b5-fd19-4d45-9b53-bc7089eecdb1
ms.tgt_platform: multiple
title: COM API для WMI
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: bfb585badeeeaae947906bbfc783baf355863e05
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105702671"
---
# <a name="com-api-for-wmi"></a>COM API для WMI

Для записи клиентских приложений управления или создания нового [*поставщика*](gloss-p.md)WMI можно использовать API-интерфейс модели COM компонента WMI. Справочник по COM API предоставляет сведения для опытных системных администраторов, а также для разработчиков, создающих приложения клиента и поставщика.

Дополнительные сведения о создании приложений управления WMI Enterprise см. в разделе [Создание приложения WMI с помощью C++](creating-a-wmi-application-using-c-.md). Дополнительные сведения о создании поставщика WMI см. [в разделе Предоставление данных инструментарию WMI](providing-data-to-wmi.md).

> [!Note]  
> Инструментарий WMI поддерживает разработку на языке C++ только с помощью Microsoft Visual C++ версий 6,0 и более поздних версий. Однако можно использовать и другие компиляторы, например, из Borland и Ватком.

 

Каждый из различных объектов WMI наследуется от интерфейса, который в конечном итоге наследуется от интерфейса [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown) . COM определяет, как объекты-исполнители (или интерфейсы) обработают задачи, такие как управление памятью, Управление параметрами и многопоточность. При условии соответствия модели COM API COM для WMI гарантирует, что он поддерживает функциональные возможности интерфейсов каждого объекта WMI.

Доступ к WMI осуществляется через следующие интерфейсы COM, зависящие от инструментария WMI.



| Интерфейс                                                                    | Описание                                                                                                                                                                                                                                                                                                |
|------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**иенумвбемклассобжект**](/windows/desktop/api/Wbemcli/nn-wbemcli-ienumwbemclassobject)                         | Перечислитель, который работает с объектами типа [**ивбемклассобжект**](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemclassobject). Он аналогичен стандартным перечислителям COM, таким как [**IEnumVARIANT**](/windows/win32/api/oaidl/nn-oaidl-ienumvariant).                                                                                                      |
| [**имофкомпилер**](/windows/desktop/api/Wbemcli/nn-wbemcli-imofcompiler)                                         | Интерфейс, реализованный Mofd.dll, предоставляет COM-интерфейс, который используется компилятором MOF и другими приложениями, которые компилируются в MOF-файлы.                                                                                                                                                       |
| [**иунсекуредапартмент**](/windows/desktop/api/Wbemcli/nn-wbemcli-iunsecuredapartment)                           | Используется для упрощения процесса выполнения асинхронных вызовов из клиентского процесса.                                                                                                                                                                                                                           |
| [**ивбембаккупресторе**](/windows/desktop/api/Wbemcli/nn-wbemcli-iwbembackuprestore)                             | Резервное копирование и восстановление содержимого репозитория WMI.                                                                                                                                                                                                                                                  |
| [**ивбемкаллресулт**](/windows/desktop/api/Wbemcli/nn-wbemcli-iwbemcallresult)                                   | Используется для вызовов [семисинчронаус](making-a-semisynchronous-call-with-c--.md) в интерфейсе [**IWbemServices**](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemservices) . При выполнении таких вызовов вызываемый метод **IWbemServices** возвращает немедленно, вместе с объектом [**ивбемкаллресулт**](/windows/desktop/api/Wbemcli/nn-wbemcli-iwbemcallresult) .                    |
| [**ивбемкаусалитяналисис**](iwbemcausalityaccess.md)                       | Отслеживает дочерние запросы, созданные из родительского запроса.                                                                                                                                                                                                                                            |
| [**ивбемклассобжект**](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemclassobject)                                 | Содержит и управляет определениями классов и экземплярами объектов класса. Разработчикам не требуется реализовывать этот интерфейс; Инструментарий WMI предоставляет свою реализацию.                                                                                                                                                 |
| [**ивбемконфигуререфрешер**](/windows/desktop/api/Wbemcli/nn-wbemcli-iwbemconfigurerefresher)                   | Используется клиентским кодом для добавления или удаления перечислителей, объектов и вложенных обновлений в обновитель.                                                                                                                                                                                                         |
| [**ивбемконтекст**](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemcontext)                                         | При необходимости используется для передачи дополнительных сведений о контексте поставщикам при отправке вызовов [**IWbemServices**](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemservices) в службу управления Windows.                                                                                                                                             |
| [**ивбемдекаупледбасицевентпровидер**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemdecoupledbasiceventprovider) | Регистрирует несвязанные поставщики с помощью WMI.                                                                                                                                                                                                                                                                    |
| [**ивбемдекаупледрегистрар**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemdecoupledregistrar)                   | Связывает разъединенные поставщики с WMI. Этот интерфейс позволяет поставщику, размещенному в процессе, определять время существования взаимодействия интерфейса и сосуществовать с другими поставщиками.                                                                                                                        |
| [**ивбемевентконсумерпровидер**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventconsumerprovider)             | Предоставляет основной интерфейс для поставщика потребителей событий. С помощью этого интерфейса и метода [**финдконсумер**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemeventconsumerprovider-findconsumer) поставщик потребителей событий может указывать, какие потребители событий должны получить данное событие.                                          |
| [**ивбемевентпровидер**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovider)                             | Используется для инициации взаимодействия с поставщиком событий.                                                                                                                                                                                                                                                     |
| [**ивбемевентпровидеркуерисинк**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventproviderquerysink)           | Дополнительно реализовано поставщиками событий, желающими узнать, какие виды фильтров запросов событий в настоящее время активны для оптимизации производительности.                                                                                                                                                                 |
| [**ивбемевентпровидерсекурити**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemeventprovidersecurity)             | Дополнительно реализовано поставщиками событий, желающими ограничить доступ пользователей к их событиям.                                                                                                                                                                                                             |
| [**ивбемевентсинк**](iwbemeventsink.md)                                     | Инициирует связь с поставщиком событий с помощью ограниченного набора запросов. Этот интерфейс расширяет [**ивбемобжектсинк**](iwbemobjectsink.md), предоставляя новые методы, работающие с безопасностью и производительностью.                                                                                          |
| [**ивбемхиперфпровидер**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemhiperfprovider)                           | Позволяет поставщикам предоставлять обновляемые объекты и перечислители.                                                                                                                                                                                                                                           |
| [**ивбемхиперфенум**](/windows/desktop/api/Wbemcli/nn-wbemcli-iwbemhiperfenum)                                   | Используется в операциях обновления для обеспечения быстрого доступа к перечислениям объектов экземпляров.                                                                                                                                                                                                                  |
| [**ивбемлокатор**](/windows/desktop/api/Wbemcli/nn-wbemcli-iwbemlocator)                                         | Получает указатель исходного пространства имен на интерфейс [**IWbemServices**](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemservices) для инструментария WMI на определенном компьютере узла.                                                                                                                                                                         |
| [**ивбемобжектакцесс**](/windows/desktop/api/Wbemcli/nn-wbemcli-iwbemobjectaccess)                               | Предоставляет доступ к методам и свойствам объекта. Объект [**ивбемобжектакцесс**](/windows/desktop/api/Wbemcli/nn-wbemcli-iwbemobjectaccess) — это контейнер для экземпляра, обновленного с помощью [*обновления*](gloss-r.md).                                                                                           |
| [**ивбемобжектсинк**](iwbemobjectsink.md)                                   | Используется для получения результатов [**IWbemServices**](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemservices) и определенных типов уведомлений о событиях.                                                                                                                                                                                       |
| [**ивбемобжекттекстсрк**](/windows/desktop/api/Wbemcli/nn-wbemcli-iwbemobjecttextsrc)                             | Используется для преобразования экземпляров [**ивбемклассобжект**](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemclassobject) в различные форматы текста и обратно.                                                                                                                                                                                               |
| [**ивбемпропертипровидер**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbempropertyprovider)                       | Поддерживает получение и обновление отдельных свойств в экземпляре класса WMI.                                                                                                                                                                                                                      |
| [**ивбемпровидеридентити**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemprovideridentity)                       | Реализуется поставщиком событий, если поставщик регистрируется с использованием нескольких **имен** (нескольких экземпляров [**\_ \_ Win32Provider**](--win32provider.md)) с одним и тем же значением [CLSID](../com/clsid.md) . Класс предоставляет механизм для различения именованного поставщика, который следует использовать. |
| [**ивбемпровидеринит**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinit)                               | Используется для инициализации поставщиков.                                                                                                                                                                                                                                                                              |
| [**ивбемпровидеринитсинк**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinitsink)                       | Реализуется WMI и вызывается поставщиками для сообщения о состоянии инициализации.                                                                                                                                                                                                                                |
| [**ивбемкуалифиерсет**](/windows/desktop/api/Wbemcli/nn-wbemcli-iwbemqualifierset)                               | Выступает в качестве контейнера для всего набора именованных квалификаторов для одного свойства или для всего объекта (класса или экземпляра).                                                                                                                                                                                   |
| [**ивбемкуери**](/windows/desktop/api/Wmiutils/nn-wmiutils-iwbemquery)                                             | Предоставляет точку входа, с помощью которой можно проанализировать запрос [*язык запросов WMI*](gloss-w.md) (WQL).                                                                                                                                                                        |
| [**ивбемрефрешер**](/windows/desktop/api/Wbemcli/nn-wbemcli-iwbemrefresher)                                     | Предоставляет точку входа, через которую можно обновлять обновляемые объекты, такие как перечислители или объекты обновления.                                                                                                                                                                                      |
| [**IWbemServices**](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemservices)                                       | Используется клиентами и поставщиками для доступа к службам WMI. Интерфейс реализуется только WMI и является основным интерфейсом WMI.                                                                                                                                                                           |
| [**ивбемстатускодетекст**](/windows/desktop/api/Wbemcli/nn-wbemcli-iwbemstatuscodetext)                           | Извлекает текстовые строковые описания кодов ошибок или имя подсистемы, в которой произошла ошибка.                                                                                                                                                                                                    |
| [**ивбемунбаундобжектсинк**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemunboundobjectsink)                     | Реализовано всеми логическими потребителями событий. Это простой интерфейс приемника, который принимает доставку объектов событий.                                                                                                                                                                                          |



 

> [!Note]  
> Многие функции COM WMI возвращают числовые коды ошибок, которые описаны как именованные константы. Эти константы определены в Вбемкли. h в папке include в WMI PSDK \\ . Дополнительные сведения см. в статье [коды возврата WMI](wmi-return-codes.md).

 

Дополнительные сведения о программировании COM см. в разделе [Разработка компонентов]( /previous-versions//ee663263(v=vs.85)).

-   Конструкторы интерфейсов и объектов.
-   Реализация [**IUnknown**](/windows/win32/api/unknwn/nn-unknwn-iunknown).
-   Управление памятью
-   Обработка подсчета ссылок.

## <a name="related-topics"></a>См. также

<dl> <dt>

[Справочник по инструментарию WMI](wmi-reference.md)
</dt> </dl>

 

 
