---
description: Поставщик экземпляров предоставляет экземпляры одного или нескольких заданных классов.
ms.assetid: d53c3399-cba8-4b5d-8da0-b5a23f94c0ae
ms.tgt_platform: multiple
title: Написание поставщика экземпляров
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 72bddfaa867624bd84cc975d32a8e7b747064d1d
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105702464"
---
# <a name="writing-an-instance-provider"></a>Написание поставщика экземпляров

Поставщик экземпляров предоставляет экземпляры одного или нескольких заданных классов. Например, поставщик экземпляров может предоставлять сведения о ЦП или оборудовании другого типа. Поскольку объекты, управляемые поставщиком экземпляров, обычно меняются на регулярной основе, все поставщики экземпляров считаются поставщиками опрашивающей связи. то есть поставщик, который динамически получает сведения об управляемом объекте всякий раз, когда инструментарий WMI выполняет запрос информации. Имя берется из идеи, что WMI "извлекает" информацию от поставщика от имени клиентского запроса. С помощью технологии Pull поставщик экземпляров может поддерживать получение, перечисление, изменение, удаление и обработку запросов конкретного экземпляра.

Высокопроизводительные поставщики могут повысить эффективность работы поставщика экземпляров или программно получить доступ к данным, отображаемым в системном мониторе. Дополнительные сведения см. в разделе [Создание поставщика экземпляров в поставщике High-Performance](making-an-instance-provider-into-a-high-performance-provider.md).

В следующей процедуре описывается написание поставщика экземпляров.

**Написание поставщика экземпляров**

1.  [Регистрация поставщика в WMI](registering-an-instance-provider.md).

    Поставщики экземпляров регистрируются в WMI путем создания экземпляра [**\_ \_ Win32Provider**](--win32provider.md) и класса [**\_ \_ инстанцепровидеррегистратион**](--instanceproviderregistration.md) .

2.  [Инициализируйте поставщик](initializing-a-provider.md).

    Инструментарий WMI использует [**ивбемпровидеринит**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemproviderinit) для загрузки и инициализации поставщика. Это задача, общая для всех поставщиков.

    > [!Note]  
    > Поставщики экземпляров настоятельно рекомендуется использовать модель многопоточности "both".

     

3.  [Реализуйте интерфейс IWbemServices для вашего поставщика](implementing-the-primary-interface-for-an-instance-provider.md).

    Интерфейс [**IWbemServices**](/windows/desktop/api/WbemCli/nn-wbemcli-iwbemservices) является основным интерфейсом для поставщика экземпляров.

4.  Добавьте дополнительный код, необходимый для поставщика.

    При проектировании поставщика вам, скорее всего, придется вызывать интерфейсы WMI. Дополнительные сведения см. [в разделе Выполнение вызовов к WMI](making-calls-to-wmi.md).

    При получении сведений для клиента может потребоваться доступ к уровням безопасности для этого клиента. Дополнительные сведения см. в разделе [олицетворение клиента](impersonating-a-client.md).

5.  При необходимости [реализуйте высокопроизводительный интерфейс](improving-the-efficiency-of-an-instance-provider.md).

    Высокопроизводительный интерфейс увеличивает скорость, с которой поставщик может реагировать на запросы из WMI.

6.  При необходимости [Реализуйте поддержку частичных обновлений экземпляров](supporting-partial-instance-operations.md).

    Как предполагает имя, обновление частичного экземпляра — это метод, который используется для обновления только части экземпляра. Дополнительные сведения о вызове частичного экземпляра из клиента см. в разделе [обновление части экземпляра](updating-part-of-an-instance.md) и [получение части экземпляра WMI](retrieving-part-of-an-instance.md).

7.  Замените имеющийся поставщик новым кодом.

    Вам не нужно выполнять этот шаг, если у вас нет уже существующего поставщика для копирования. Дополнительные сведения см. [в разделе Обновление поставщика](updating-a-provider.md).

 

 



