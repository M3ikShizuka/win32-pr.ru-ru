---
description: Описывает базовый синтаксис инструкции SELECT для запросов событий.
ms.assetid: 8882fdcb-3768-41e3-82ab-3006d903f3a0
ms.tgt_platform: multiple
title: Инструкция SELECT для запросов событий
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ab840072269d04987bf42939f1f566ee6b99afab
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "104272220"
---
# <a name="select-statement-for-event-queries"></a>Инструкция SELECT для запросов событий

Для запроса сведений о событиях можно использовать разнообразные инструкции SELECT. Инструкции могут быть основными операторами, или они могут быть более ограничивающими, чтобы сократить результирующий набор, возвращаемый запросом.

В следующем примере показана базовая инструкция SELECT, которая используется для запроса сведений о событии.


```sql
SELECT * FROM EventClass
```



Когда потребитель отправляет запрос, это запрос на получение уведомления обо всех событиях события, представленного объектом **EventClass**. Этот запрос содержит запрос на уведомление обо всех системных событиях и несистемных свойствах. Когда поставщик событий отправляет запрос, он регистрирует поддержку создания уведомлений при возникновении события, представленного методом **EventClass** .

Потребители могут задавать отдельные свойства вместо звездочки ( \* ) в инструкции SELECT.

В следующем примере показано, как запросить определенные свойства.


```sql
SELECT property_1, property_2, property_3 FROM MyEventClass
```



Однако возвращаются все свойства внедренного объекта, даже если запрос задает свойства внедренного объекта.

В следующем примере показаны два запроса, возвращающие одни и те же данные.


```sql
SELECT targetInstance FROM __InstanceCreationEvent within 2
    WHERE targetinstance isa "Win32_Process"
```




```sql
SELECT targetInstance.Name FROM __InstanceCreationEvent within 2
    WHERE targetinstance isa "Win32_Process"
```



Если системное свойство не относится к конкретному запросу, оно содержит **значение NULL**. Например, значение системного свойства **\_ \_ релпас** равно **null** для всех запросов событий.

Следующие системные свойства содержат **значения NULL** для запросов событий:

<dl> \_\_Имен  
\_\_Путь  
\_\_релпас  
\_\_Сервером  
</dl>

Дополнительные сведения см. в разделе [Справочник по системным свойствам WMI](wmi-system-properties.md).

Все запросы событий могут включать необязательное [предложение WHERE](where-clause.md), но предложения WHERE в основном используются потребителями для указания дополнительной фильтрации. Настоятельно рекомендуется, чтобы потребители всегда указали предложение WHERE. Затраты на сложный запрос минимальны по сравнению с затратами на доставку и обработку ненужных уведомлений.

В следующем примере показан запрос, запрашивающий уведомления обо всех событиях изменения экземпляра, которые влияют на гипотетический класс **емаилевент**.


```sql
SELECT * FROM EmailEvent
```



Если события, связанные с **емаилевент** , происходят часто, потребитель передается с событиями. Более эффективный запрос запрашивает события только в том случае, если определенные условия используют свойства указанного класса, например, если уровень важности имеет значение High.

В следующем примере показан запрос, который можно использовать, если **емаилимпортанце** является свойством класса **емаилевент**.


```sql
SELECT * FROM EmailEvent WHERE EmailImportance > 3
```



Обратите внимание, что инструментарий WMI может отклонять запрос по ряду причин. Например, запрос может быть слишком сложным или ресурсоемким для оценки. В этом случае Инструментарий WMI возвращает определенные коды ошибок, например **, \_ \_ Недопустимый \_ запрос WBEM E**.

Свойства внедренных объектов можно использовать в предложении WHERE.

В следующем примере показано, как запросить объекты, где свойство **TargetInstance** класса System [**\_ \_ инстанцемодификатионевент**](--instancemodificationevent.md) является внедренным объектом [**Win32 \_ LogicalDisk**](/windows/desktop/CIMWin32Prov/win32-logicaldisk) , а **Freespace** — свойством **Win32 \_ LogicalDisk**.


```sql
SELECT * FROM __InstanceModificationEvent WITHIN 600
    WHERE TargetInstance ISA "Win32_LogicalDisk" 
    AND   TargetInstance.FreeSpace < 1000000
```



## <a name="examples"></a>Примеры

[Событие создания монитора для определенного имени процесса](https://Gallery.TechNet.Microsoft.Com/52716121-f386-49de-86cd-46ca54d1714f) в образце VBScript на сайте TechNet использует инструкцию SELECT для отслеживания событий создания экземпляра WMI для \_ процесса Win32, фильтрации по определенному имени процесса.

 

 
