---
description: Язык запросов WMI (WQL) — это подмножество стандартных Американский национальный институт стандартов (ANSI) язык SQL (ANSI SQL) с незначительными семантическими изменениями для поддержки инструментария WMI.
ms.assetid: 7e04ba37-c0e0-4304-b162-8b911f233f38
ms.tgt_platform: multiple
title: Запросы с помощью WQL
ms.topic: article
ms.date: 05/31/2018
topic_type:
- kbArticle
api_name: ''
api_type: ''
api_location: ''
ms.openlocfilehash: 8e2d3f68f4d7384781110958070b33b67a78405f
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105692712"
---
# <a name="querying-with-wql"></a>Запросы с помощью WQL

Язык запросов WMI (WQL) — это подмножество стандартных Американский национальный институт стандартов (ANSI) язык SQL (ANSI SQL) с незначительными семантическими изменениями для поддержки инструментария WMI.

Полный список поддерживаемых ключевых слов WQL см. в разделе [WQL (SQL для WMI)](wql-sql-for-wmi.md). Использование ключевых слов SQL для имен объектов или свойств может привести к ограничению синтаксического анализа запроса. Следующие ключевые слова SQL ограничены: **null**, **true** и **false**.

> [!Note]  
> Существует ряд ограничений на количество ключевых слов AND и OR, которые могут использоваться в запросах WQL. Большое количество ключевых слов WQL, используемых в сложном запросе, может привести к тому, что WMI вернет код ошибки **\_ \_ \_ нарушения квоты WBEM E** как значение **HRESULT** . Ограничение ключевых слов WQL зависит от того, насколько сложным является запрос.

 

Запросы могут использовать предложение **WHERE** для расширения и настройки, хотя это необязательно. Предложение **WHERE** состоит из свойства или ключевого слова, оператора и константы. Все предложения **WHERE** должны указывать один из предопределенных операторов, которые включены в WQL. Дополнительные сведения о синтаксисе см. в разделе [предложение WHERE](where-clause.md). Дополнительные сведения о допустимых операторах WQL см. в разделе [Операторы WQL](wql-operators.md).

Как и в случае с другими строками SQL-запросов, запросы можно экранировать.

> [!Note]  
> WQL не поддерживает запросы или связи между пространствами имен. Нельзя выполнить запрос для всех экземпляров указанного класса, размещенных во всех пространствах имен на целевом компьютере.

 

WQL поддерживает следующие типы запросов:

-   Запросы данных

    Запросы данных используются для получения экземпляров классов и ассоциаций данных. Они являются наиболее часто используемым типом запроса в сценариях и приложениях WMI. Дополнительные сведения о синтаксисе запросов данных см. в разделе [запрос данных экземпляра класса](requesting-class-instance-data.md). Дополнительные сведения о связях см. [в разделе объявление класса ассоциации](declaring-an-association-class.md).

    > [!Note]  
    > WQL не поддерживает запросы типов данных массива.

     

    Следующий пример запроса данных запрашивает файл журнала событий с именем Application из всех экземпляров [**Win32 \_ нтложевент**](/previous-versions/windows/desktop/eventlogprov/win32-ntlogevent).

    ```VB
    strComputer = "." 
    Set objWMIService = GetObject("winmgmts:\\" _
        & strComputer & "\root\CIMV2") 
    Set colItems = objWMIService.ExecQuery( _
        "SELECT * FROM Win32_NTLogEvent " _
        & "WHERE Logfile = 'Application'",,48)
    ```

    

-   Запросы событий

    Потребители используют запросы событий для регистрации для получения уведомлений о событиях. Поставщики событий используют запросы событий для регистрации для поддержки одного или нескольких событий. Дополнительные сведения о запросах событий см. в разделе [Получение уведомлений о событиях](receiving-event-notifications.md).

    В следующем примере запрос события с помощью временного потребитель события запрашивает уведомление при создании нового экземпляра класса, производного от [**Win32 \_ нтложевент**](/previous-versions/windows/desktop/eventlogprov/win32-ntlogevent) .

    ```VB
    strComputer = "." 
    Set objWMIService = GetObject("winmgmts:\\" _
        & strComputer & "\root\CIMV2") 
    Set objEvents = objWMIService.ExecNotificationQuery _
    ("SELECT * FROM __InstanceModificationEvent WITHIN 10 WHERE " & _
        "TargetInstance ISA 'Win32_Service'" & _
        " AND TargetInstance._Class = 'win32_TerminalService'")

    i = TRUE
    Do While i = TRUE
        Set strReceivedEvent = objEvents.NextEvent

        'report an event
        Wscript.Echo "An event has occurred."
    Loop
    ```

    

-   Запросы схемы

    Запросы схемы используются для получения определений классов (а не экземпляров классов) и связей схем. Поставщики классов используют запросы схемы для указания классов, которые они поддерживают при регистрации. Дополнительные сведения о запросах схемы см. в разделе [Получение определений классов](retrieving-class-definitions.md).

    В следующем примере запроса схемы показан специальный синтаксис.

    ```sql
    SELECT * FROM meta_class WHERE __this ISA "Win32_BaseService"
    ```

    

## <a name="related-topics"></a>См. также

<dl> <dt>

[Формат даты и времени WMI](date-and-time-format.md)
</dt> </dl>

 

 
