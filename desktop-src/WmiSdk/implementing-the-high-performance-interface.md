---
description: Поскольку Инструментарий WMI загружает высокопроизводительный поставщик в интерфейс WMI или клиентское приложение, необходимо спроектировать высокопроизводительный поставщик в качестве внутрипроцессного сервера.
ms.assetid: c37e3652-8c76-4125-ba62-ae860858797e
ms.tgt_platform: multiple
title: Реализация интерфейса High-Performance
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3ea6e7f75e1031caacbb7379fba025baceb7b1a6
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/08/2021
ms.locfileid: "105693328"
---
# <a name="implementing-the-high-performance-interface"></a>Реализация интерфейса High-Performance

Поскольку Инструментарий WMI загружает высокопроизводительный поставщик в интерфейс WMI или клиентское приложение, необходимо спроектировать высокопроизводительный поставщик в качестве внутрипроцессного сервера. Кроме того, необходимо реализовать высокопроизводительные методы поставщика в интерфейсах [**ивбемхиперфпровидер**](/windows/desktop/api/Wbemprov/nn-wbemprov-iwbemhiperfprovider) и [**ивбемрефрешер**](/windows/desktop/api/Wbemcli/nn-wbemcli-iwbemrefresher) .

В качестве внутрипроцессного сервера следует реализовать высокопроизводительный поставщик. При реализации безопасности внутрипроцессного сервера следует помнить о том, как поставщик определяет свое расположение. При загрузке внутрипроцессного в WMI WMI создает экземпляр поставщика с помощью идентификатора CLSID. При загрузке в процесс клиентского приложения клиентское приложение создает экземпляр поставщика с помощью свойства **клиентлоадаблеклсид** . Присваивая различным значениям идентификаторы CLSID и **клиентлоадаблеклсид**, вы разрешаете поставщику определить, загружен ли он внутри процесса в WMI или в клиентское приложение. Если он находится в процессе WMI, поставщик должен выполнить все необходимое олицетворение клиента с помощью **клиентлоадаблеклсид**. При размещении в клиентском процессе поставщик наследует маркер доступа потока, для которого он вызывается. Дополнительные сведения о реализации внутрипроцессного сервера см. в [разделе com статьи](https://msdn.microsoft.com/library/aa139695.aspx) MSDN.

Как внутрипроцессный сервер, высокопроизводительный поставщик использует объект обновления, чтобы обеспечить актуальность данных для удаленного клиента. В следующей таблице перечислены методы, которые необходимо реализовать для высокопроизводительного поставщика.



| Метод                                                                                              | Функция                                           |
|-----------------------------------------------------------------------------------------------------|---------------------------------------------------|
| [**Ивбемхиперфпровидер:: Куеринстанцес**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemhiperfprovider-queryinstances)                   | Запросы                                           |
| [**Ивбемхиперфпровидер:: GetObject**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemhiperfprovider-getobjects)                           | Получение объектов                                  |
| [**Ивбемхиперфпровидер:: Креатерефрешер**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemhiperfprovider-createrefresher)                 | Создает Обновитель                               |
| [**Ивбемхиперфпровидер:: Креатерефрешаблеобжект**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemhiperfprovider-createrefreshableobject) | Создает обновляемый объект экземпляра             |
| [**Ивбемхиперфпровидер:: Креатерефрешаблинум**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemhiperfprovider-createrefreshableenum)     | Создает обновляемый перечислитель                  |
| [**Ивбемхиперфпровидер:: Стопрефрешинг**](/windows/desktop/api/Wbemprov/nf-wbemprov-iwbemhiperfprovider-stoprefreshing)                   | Останавливает обновление объекта перечислителя или экземпляра |
| [**Ивбемрефрешер:: Refresh**](/windows/desktop/api/Wbemcli/nf-wbemcli-iwbemrefresher-refresh)                                           | Создает Обновитель                               |



 

## <a name="related-topics"></a>См. также

<dl> <dt>

[Создание поставщика экземпляров в поставщике High-Performance](making-an-instance-provider-into-a-high-performance-provider.md)
</dt> </dl>

 

 



