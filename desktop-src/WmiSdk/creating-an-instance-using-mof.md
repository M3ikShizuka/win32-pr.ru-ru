---
description: Вы можете объявить базовый экземпляр класса в службе управления Windows с помощью MOF-файл (MOF). Можно также переопределить значения по умолчанию для экземпляра. Дополнительные сведения см. в разделе Установка значения свойства экземпляра.
ms.assetid: 12eda062-9614-455d-ae99-7706c685137b
ms.tgt_platform: multiple
title: Создание экземпляра с помощью MOF
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e5078c5fcddaab4e8437a33e8cb3210d515360fd
ms.sourcegitcommit: 831e8f3db78ab820e1710cede244553c70e50500
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/07/2021
ms.locfileid: "105702079"
---
# <a name="creating-an-instance-using-mof"></a>Создание экземпляра с помощью MOF

Вы можете объявить базовый экземпляр класса в службе управления Windows с помощью MOF-файл (MOF). Можно также переопределить значения по умолчанию для экземпляра. Дополнительные сведения см. в разделе [Установка значения свойства экземпляра](#setting-an-instance-property-value).

В следующей процедуре описывается объявление базового экземпляра класса с помощью MOF-кода.

**Объявление базового экземпляра класса с помощью MOF-кода**

1.  Используйте **экземпляр** ключевых слов, за которым следует имя класса, фигурные скобки и точку с запятой.

    В следующем примере кода показано, как объявить экземпляр класса.

    ```mof
    instance of ClassName
    {
    };
    ```

    

2.  По завершении вставьте MOF-код в репозиторий WMI с помощью компилятора MOF.

    Дополнительные сведения см. в разделе [Компиляция MOF-файлов](compiling-mof-files.md).

Экземпляр класса включает все свойства класса. Если класс является производным классом, то экземпляры включают свойства, относящиеся ко всем классам, находящихся выше в иерархии. Каждый класс, на основе которого создается экземпляр, имеет одно или несколько ключевых свойств. Нельзя создать экземпляр с более чем 256 ключами.

## <a name="setting-an-instance-property-value"></a>Установка значения свойства экземпляра

Так как WMI строго типизированные свойства, изменять типы свойств нельзя. Однако значения свойств можно задавать в экземплярах. Когда класс присваивает свойству значение по умолчанию, Инструментарий WMI присваивает каждому экземпляру значение по умолчанию. Это значение можно переопределить в объявлении экземпляра.

Следующая процедура описывает, как задать значение свойства или перезаписать значение по умолчанию с помощью MOF-кода.

**Установка значения свойства или перезапись значения по умолчанию с помощью MOF-кода**

1.  Поместите оператор присваивания между фигурными скобками объявления экземпляра.

    В следующем примере кода показано, как задать значение свойства.

    ``` syntax
    instance of ClassName
    {
        Prop = "value";
    };
    ```

    Инструментарию WMI не требуется задавать какое бы то ни было свойство во время создания экземпляра. Исключением является любое свойство, помеченное квалификатором [**ключа**](key-qualifier.md) . Так как инструментарий WMI использует ключевые свойства для уникальной идентификации экземпляров, необходимо задать все ключевые свойства в том виде, в котором они встречаются. В отличие от этого, не следует задавать системное свойство в объявлении экземпляра. Вместо этого при необходимости Инструментарий WMI присваивает соответствующие значения системному свойству.

2.  По завершении вставьте код MOF в репозиторий WMI, вызвав компилятор MOF.

    Дополнительные сведения см. в разделе [Компиляция MOF-файлов](compiling-mof-files.md).

В следующем примере кода показано, как экземпляр задает данные для свойств, определенных классом.

``` syntax
class MyClass 
{
    [key] string   strProp;
    sint32   dwProp1;
    uint32       dwProp2;
};

instance of MyClass 
{
    strProp = "hello";
    dwProp1 = -1;
    dwProp2 = 0xffffffff;
};
```

В предыдущем примере класс определяет три свойства: строку символов, 32-разрядное целое число со знаком и 32-разрядное целое число без знака. Экземпляр предоставляет значения данных для каждого из этих свойств.

 

 



