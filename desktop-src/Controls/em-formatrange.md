---
title: Сообщение EM_FORMATRANGE (RichEdit. h)
description: Форматирует диапазон текста в элементе управления расширенного редактирования для конкретного устройства.
ms.assetid: 6d1e562b-d741-4d4a-a395-554083cb0dbb
keywords:
- Элементы управления Windows для EM_FORMATRANGE сообщений
topic_type:
- apiref
api_name:
- EM_FORMATRANGE
api_location:
- Richedit.h
api_type:
- HeaderDef
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: f8f235fb054643623510ea23e73001aaeb070be3
ms.sourcegitcommit: a1494c819bc5200050696e66057f1020f5b142cb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2020
ms.locfileid: "103892065"
---
# <a name="em_formatrange-message"></a>\_Сообщение ФОРМАТРАНЖЕ EM

Форматирует диапазон текста в элементе управления расширенного редактирования для конкретного устройства.

## <a name="parameters"></a>Параметры

<dl> <dt>

*wParam* 
</dt> <dd>

Указывает, следует ли визуализировать текст. Если этот параметр не равен нулю, текст подготавливается к просмотру. В противном случае текст просто измеряется.

</dd> <dt>

*lParam* 
</dt> <dd>

Структура [**форматранже**](/windows/desktop/api/Richedit/ns-richedit-formatrange) , содержащая сведения об устройстве вывода, или **значение NULL** для высвобождения информации, кэшированной элементом управления.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Это сообщение возвращает индекс последнего символа, помещающийся в области, плюс 1.

## <a name="remarks"></a>Комментарии

Это сообщение обычно используется для форматирования содержимого элемента управления Rich Edit для выходного устройства, такого как принтер.

После использования этого сообщения для форматирования диапазона текста важно освободить кэшированные данные, отправив **EM \_ форматранже** еще раз, но с параметром *lParam* , имеющим значение **null**. в противном случае произойдет утечка памяти. Кроме того, после использования этого сообщения для одного устройства необходимо освободить кэшированные данные, прежде чем повторно использовать их для другого устройства.

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|---------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Только для \[ классических приложений Windows Vista\]<br/>                                        |
| Минимальная версия сервера<br/> | \[Только для настольных приложений Windows Server 2003\]<br/>                                  |
| Header<br/>                   | <dl> <dt>RichEdit. h</dt> </dl> |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

**Ссылки**
</dt> <dt>

[**EM \_ дисплайбанд**](em-displayband.md)
</dt> <dt>

**Зрения**
</dt> <dt>

[Печать элементов управления Rich Edit](printing-rich-edit-controls.md)
</dt> </dl>

 

 





