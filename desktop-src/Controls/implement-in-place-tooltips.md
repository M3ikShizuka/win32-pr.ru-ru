---
title: Реализация In-Place подсказок
description: Подсказки на месте используются для вывода текстовых строк для объектов, которые были обрезаны. Иллюстрация см. в разделе о элементах управления ToolTip.
ms.assetid: 2FE39B99-75F3-4978-B0B3-B769E2961F23
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 9dd3b01d30a20b52cbb80121cc8c1d793965acf0ea3cf4f2be1ce4553f4ccb98
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118671736"
---
# <a name="how-to-implement-in-place-tooltips"></a>Реализация In-Place подсказок

Подсказки на месте используются для вывода текстовых строк для объектов, которые были обрезаны. Иллюстрация см. в разделе [о элементах управления ToolTip](tooltip-controls.md).

Разность между обычными и встроенными подсказками размещается. По умолчанию при наведении указателя мыши на область с связанной с ней подсказкой подсказка отображается рядом с областью. Однако подсказки являются окнами, и их можно размещать в любом месте, вызвав [**SetWindowPos**](/windows/desktop/api/winuser/nf-winuser-setwindowpos). Создание подсказок на месте заключается в размещении окна подсказки, чтобы оно находилось в текстовой строке.

## <a name="what-you-need-to-know"></a>Это важно знать

### <a name="technologies"></a>Технологии

-   [Windows Элементы управления](window-controls.md)

### <a name="prerequisites"></a>Предварительные требования

-   C/C++
-   Windows Программирование пользовательского интерфейса

## <a name="instructions"></a>Instructions

### <a name="positioning-an-in-place-tooltip"></a>Размещение подсказки In-Place

При размещении подсказки на месте необходимо отследить три прямоугольника:

1.  Прямоугольник, который окружает весь текст метки.
2.  Прямоугольник, который окружает текст подсказки. Текст подсказки идентичен полному тексту метки, и обычно имеет тот же размер и шрифт. Поэтому два текстовых прямоугольника обычно имеют одинаковый размер.
3.  Прямоугольник окна подсказки. Этот прямоугольник немного больше, чем прямоугольник текста подсказки, который он заключает.


Три прямоугольника показаны на рисунке ниже. Скрытая часть текста метки обозначается серым фоном.

![на схеме показана длинная строка, половина которой имеет серый фон, то есть та же строка в более крупном прямоугольнике окна подсказки.](images/inplace.png)

Чтобы создать подсказку на месте, необходимо разместить прямоугольник текста подсказки таким образом, чтобы он накладывается на текстовую рамку метки. Процедура выровняйте два прямоугольника относительно проста:

1.  Определите прямоугольник текста метки.
2.  Поместите окно подсказки таким образом, чтобы прямоугольник текста подсказки накладывается на текстовую рамку метки.


На практике обычно достаточно Выровняйте верхний левый угол двух текстовых прямоугольников. Попытка изменить размер прямоугольника текста подсказки в точности соответствует текстовому прямоугольнику метки может вызвать проблемы с отображением всплывающей подсказки.

Проблема с этой простой схемой заключается в том, что невозможно разместить прямоугольник текста подсказки напрямую. Вместо этого необходимо разместить прямоугольник окна подсказки достаточно далеко над и слева от текстового прямоугольника метки, чтобы углы двух текстовых прямоугольников совпадали. Иными словами, необходимо знать смещение между прямоугольником окна подсказки и вложенным текстовым прямоугольником. Как правило, нет простого способа определить это смещение.

### <a name="implement-in-place-tooltips"></a>Реализация In-Place подсказок

В следующем фрагменте кода показано, как использовать сообщение [**ТТМ \_ аджустрект**](ttm-adjustrect.md) в обработчике ТТН, чтобы отобразить подсказку на месте. [ \_](ttn-show.md) Приложение указывает, что текст метки усекается путем задания для закрытой переменной *фмистрингистрункатед* значения **true**. Обработчик вызывает определяемую приложением функцию **жетмитемрект** для получения текстового прямоугольника метки. Этот прямоугольник передается элементу управления ToolTip с помощью **ТТМ \_ аджустрект**, который возвращает соответствующий прямоугольник окна. Затем вызывается [**SetWindowPos**](/windows/desktop/api/winuser/nf-winuser-setwindowpos) для позиционирования подсказки на метке.


```C++
case TTN_SHOW:
            
    if (fMyStringIsTruncated) 
    {
        RECT rc;
        
        GetMyItemRect(&rc);
        
        SendMessage(hwndToolTip, TTM_ADJUSTRECT, TRUE, (LPARAM)&rc);
        
        SetWindowPos(hwndToolTip, NULL, rc.left, rc.top, 0, 0, 
                     SWP_NOSIZE | SWP_NOZORDER | SWP_NOACTIVATE);
    }
```



В этом примере не изменяется размер подсказки, а только ее ее расположение. Два текстовых прямоугольника вычисляются по левому верхнему краю, но не обязательно с одинаковыми размерами. На практике разница обычно мала, и этот подход рекомендуется для большинства целей. Хотя вы можете, в принципе, использовать [**SetWindowPos**](/windows/desktop/api/winuser/nf-winuser-setwindowpos) для изменения размера, а также изменить расположение подсказки, это может привести к непредсказуемым последствиям.

## <a name="remarks"></a>Remarks

Стандартные элементы управления [версии 5,80](common-control-versions.md) упрощают использование подсказок на месте путем добавления нового сообщения, [**ТТМ \_ аджустрект**](ttm-adjustrect.md). Отправьте это сообщение с координатами текстового прямоугольника метки, на который должна накладываться всплывающая подсказка, и возвращает координаты соответствующего прямоугольника окна подсказок с соответствующим положением.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Использование элементов управления ToolTip](using-tooltip-contro.md)
</dt> </dl>

 

 