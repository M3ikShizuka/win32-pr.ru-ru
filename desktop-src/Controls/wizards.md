---
title: Создание мастеров
description: Мастер — это тип страницы свойств, предоставляющий простой и эффективный способ указания пользователей в процедуре.
ms.assetid: f8def159-0a68-4d7f-9840-c7b6b906ed08
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fedd35bd0454e0d78ddbe74d832543e58d0a8fc7
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127165251"
---
# <a name="how-to-create-wizards"></a>Создание мастеров

Мастер — это тип страницы свойств, предоставляющий простой и эффективный способ указания пользователей в процедуре.

Мастера — это один из ключевых клавиш для упрощения взаимодействия с пользователем. Они позволяют выполнять сложные операции, такие как Настройка приложения, и разбивать их на несколько простых шагов. В каждой точке процесса можно указать, что требуется, и отобразить элементы управления, позволяющие пользователю выбирать и вводить текст.

На самом деле, мастер представляет собой тип страницы свойств. Страница свойств, по сути, является контейнером для коллекции *страниц*, где каждая страница является отдельным диалоговым окном. В то время как обычные страницы свойств позволяют пользователю получить доступ к любой странице в любое время, мастера поочередно выдаются. Вместо вкладок для перехода вперед и назад используются кнопки. Порядок, в котором отображаются страницы, управляется приложением и может быть изменен в зависимости от введенных пользователем данных.

существует два основных стиля мастера: старый стиль Wizard97 и стиль Aero, появившийся в Windows Vista. Иллюстрации см. в разделе [сведения о страницах свойств](property-sheets.md). (Третий стиль, используя только КОМАНДНОМ PSH \_ Wizard (мастер или \_ Мастер командном PSH \_ ). представляет собой простую последовательность страниц свойств без заголовков или водяных знаков.)

> [!Note]  
> «Водяной знак» в контексте мастеров — это точечный рисунок, который отображается в левом поле некоторых страниц.

 

В обсуждении в большинстве случаев предполагается, что вы реализуете мастер для системы с общими элементами управления [версии 5,80](common-control-versions.md) или более поздней. При попытке использовать стиль Wizard97 с более ранними версиями стандартных элементов управления приложение может компилироваться, но оно будет отображаться неправильно. Обсуждение создания мастера, совместимого с Wizard97, в более ранних системах см. в разделе мастера с поддержкой обратной совместимости далее в этой статье.

## <a name="what-you-need-to-know"></a>Это важно знать

### <a name="technologies"></a>Технологии

-   [Windows Элементы управления](window-controls.md)

### <a name="prerequisites"></a>Предварительные требования

-   C/C++
-   Windows Программирование пользовательского интерфейса

## <a name="instructions"></a>Instructions

### <a name="wizard-implementation"></a>Реализация мастера

Реализация мастера аналогична реализации обычной страницы свойств. На самом базовом уровне важно установить один из следующих флагов или сочетания флагов в структуре [**пропшисеадер**](pss-propsheetheader.md) , определяющей страницу свойств.



| Flag                           | Стиль                                                                                                                                                 |
|--------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------|
| \_Мастер командном PSH                    | Простой мастер без заголовков или точечных рисунков.                                                                                                           |
| \_Мастер командном PSH \_ Lite              | Аналогичен \_ мастеру командном PSH с некоторыми незначительными различиями в внешнем представлении; например, разделитель над кнопками имеет полную ширину окна. |
| КОМАНДНОМ PSH \_ WIZARD97                  | Мастер Wizard97 с (необязательными) заголовками, точечными рисунками заголовка и водяными знаками.                                                                            |
| \_Мастер командном PSH \| командном PSH \_ аеровизард | Мастер Aero. Мастера Aero не используют водяные знаки или растровые изображения заголовков. Для них требуется модель с одним потоком апартамента (STA).                         |



 

Базовая процедура реализации мастера выглядит следующим образом:

1.  Создание шаблона диалогового окна для каждой страницы.
2.  Определите страницы, создав структуру [**пропшитпаже**](pss-propsheetpage.md) для каждой страницы. Эта структура определяет страницу и содержит указатели на шаблон диалогового окна и любые растровые изображения или другие ресурсы.
3.  Передайте структуру [**пропшитпаже**](pss-propsheetpage.md) , созданную на предыдущем шаге, в функцию [**креатепропертишитпаже**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) , чтобы создать маркер хпропшитпаже страницы.
4.  Определите мастер, создав для него структуру [**пропшисеадер**](pss-propsheetheader.md) .
5.  Передайте структуру [**пропшисеадер**](pss-propsheetheader.md) в функцию [**Страница свойств**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) , чтобы отобразить мастер.
6.  реализуйте процедуры диалоговых окон для каждой страницы, чтобы обрабатывать сообщения уведомления из элементов управления страницы и кнопки мастера, а также для обработки других Windows сообщений.

### <a name="create-the-dialog-box-templates"></a>Создание шаблонов диалоговых окон

Существует два основных типа страницы мастера: Наружная и внутренняя. Внешние страницы — это введение (приветствие) и страницы завершения. Все остальные являются внутренними страницами.

**Шаблоны диалоговых окон «наружная страница»**

Базовый макет страниц "Введение и завершение" является идентичным. На следующем рисунке показан пример страницы введения Wizard97 с заполнителем заполнителя.

![снимок экрана: страница мастера с изображением слева, текстом заголовка и текста, а также кнопками "назад", "Далее" и "Отмена" внизу](images/wiz97exterior.png)

Для Wizard97 наружных страниц шаблон диалогового окна представляет собой 317x193 единицы диалогового окна. Он заполняет все мастера, за исключением заголовка и полосы внизу, содержащей кнопки **назад**, **Далее** и **Отмена** . Левая часть шаблона, которая зарезервирована для битовой карты "водяного знака", не должна содержать элементов управления. Водяной знак указывается в структуре [**пропшисеадер**](pss-propsheetheader.md) мастера и автоматически добавляется на страницу. При проектировании шаблона ресурсов необходимо разрешить пространство.

При создании растрового изображения водяного знака Помните, что размер диалогового окна может увеличиваться, если, например, пользователь выбирает большой системный шрифт. Для разных языков также обычно применяются разные метрики шрифта. При увеличении страницы область, зарезервированная для водяного знака, становится пропорционально увеличенной. Однако нельзя изменить растровое изображение водяного знака, а также растянуть растровое изображение для заполнения большей области. Вместо этого точечный рисунок остается в исходном размере в левой верхней части зарезервированной области. Часть более большой зарезервированной области, которая не охватывает водяного знака, автоматически заполняется цветом верхнего левого пикселя растрового изображения.

Если для различных метрик шрифтов требуется использовать точечные рисунки разных размеров, то существуют два возможных решения.

-   Получите метрики шрифта перед созданием мастера и укажите соответствующий размер в битовом подложке.
-   При создании мастера не указывайте битовую карту водяного знака. Wizard97 оставляет область водяного знака пустыми. Затем нарисуйте точечный рисунок соответствующего размера в области, зарезервированной для водяного знака.

Элементы управления можно поместить в область справа от водяного знака, как в случае с обычным диалоговым окном. Цвет фона этой области определяется системой и не требует каких-либо действий с вашей стороны. В этой области обычно помещается два статических элемента управления. Верхний элемент содержит заголовок и использует крупный полужирный шрифт (12 пт шрифт Verdana для Wizard97). Другой, для пояснительного текста, использует стандартный шрифт диалогового окна.

Основное различие между страницами "Введение и завершение" — это кнопки мастера и текст в статических элементах управления. В обычных страницах обычно есть кнопка " **Далее** " и " **назад** ", для которой включена только кнопка " **Далее** ". На страницах завершения включена кнопка " **назад** ", а кнопка " **Далее** " заменяется кнопкой **"Готово"** .

> [!Note]  
> В мастерах Aero кнопка « **назад** » заменяется кнопкой со стрелкой в строке заголовка.

 

Вы можете изменить текст кнопки **Готово** , отправив мастеру сообщение [**ПСМ \_ сетфиништекст**](psm-setfinishtext.md) . По умолчанию кнопка **Готово** не включает сочетание клавиш. Чтобы определить сочетание клавиш, включите амперсанд в текстовую строку, которую вы передали в ПСМ \_ сетфиништекст. Например, "&Finish" определяет "F" в качестве сочетания клавиш.

**Шаблоны диалоговых окон внутренней страницы**

Внешний вид внутренних страниц немного отличается от внешнего вида страниц. На следующем рисунке показан пример внутренней страницы Wizard97 с битовым рисунком заполнителя заголовка.

![снимок экрана: страница мастера с текстом заголовка и подзаголовка, а также рисунок вверху, текст в середине и кнопки внизу](images/wiz97interior.png)

Область заголовка в верхней части страницы обрабатывается на странице свойств, поэтому она не включается в шаблон. Содержимое заголовка указывается в структуре [**пропшитпаже**](pss-propsheetpage.md) страницы и структуре [**пропшисеадер**](pss-propsheetheader.md) мастера. Так как внутренняя страница должна соответствовать заголовку и кнопкам, шаблон диалогового окна Wizard97 — это 317x143 единицы диалогового окна, немного меньше, чем шаблон для наружных страниц.

На следующем рисунке показан мастер Aero, созданный из того же шаблона.

![снимок экрана, отличающийся от предыдущего, с заполнением области заголовка сверху, только кнопками "Далее" и "Отмена" внизу](images/wizardaerointerior.png)

### <a name="define-the-wizard-pages"></a>Определение страниц мастера

После создания шаблонов диалоговых окон и связанных ресурсов, таких как точечные рисунки и таблицы строк, можно создать страницы свойств. Процедура аналогична процедуре для стандартных вкладок свойств. Сначала заполните соответствующие элементы структуры [**пропшитпаже**](pss-propsheetpage.md) . (Некоторые члены относятся только к мастерам.) Затем вызовите функцию [**креатепропертишитпаже**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) , чтобы создать обработчик хпропшитпаже страницы.

Следующие флаги, связанные с мастером, можно задать в элементе **dwFlags** структуры [**пропшитпаже**](pss-propsheetpage.md) .



| Flag                   | Описание                                                                                                                         |
|------------------------|-------------------------------------------------------------------------------------------------------------------------------------|
| PSP \_ хидехеадер        | Установите этот флаг для наружных страниц в Wizard97. Заголовок не отображается, и можно отобразить водяной знак.                                |
| PSP \_ усехеадертитле    | Установите этот флаг для внутренних страниц, чтобы разместить заголовок в области заголовка в Wizard97 или в верхней части клиентской области в мастере Aero. |
| PSP \_ усехеадерсубтитле | Установите этот флаг для внутренних страниц, чтобы разместить подзаголовок в области заголовка в Wizard97.                                                  |



 

Если вы установили PSP \_ усехеадертитле или PSP \_ усехеадерсубтитле, назначьте заголовок и подзаголовок членам **псзеадертитле** и **псзеадерсубтитле** соответственно. При присваивании текстовых строк членам структур [**пропшитпаже**](pss-propsheetpage.md) и [**пропшисеадер**](pss-propsheetheader.md) можно либо назначить указатель строки, либо использовать макрос **макеинтресаурце** для назначения значения из строкового ресурса. Строковый ресурс загружается из модуля, указанного в элементе **HINSTANCE** структуры **пропшисеадер** мастера.

При вызове [**креатепропертишитпаже**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) для создания страницы присвойте результат элементу массива дескрипторов хпропшитпаже. Этот массив используется при создании страницы свойств. Индекс массива для маркера страницы определяет порядок, в котором он отображается по умолчанию. После создания обработчика ХПРОПШИТПАЖЕ страницы можно повторно использовать ту же структуру [**пропшитпаже**](pss-propsheetpage.md) , чтобы создать следующую страницу путем назначения новых значений соответствующим элементам.

Альтернативным способом создания страниц является использование отдельных структур [**пропшитпаже**](pss-propsheetpage.md) для каждой страницы и создание массива структур. Этот массив используется вместо массива дескрипторов ХПРОПШИТПАЖЕ при создании страницы свойств. Использование отдельных структур **пропшитпаже** исключает необходимость вызова [**креатепропертишитпаже**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) , но использует больше памяти. В противном случае существенная разница между двумя подходами отсутствует.

В следующем примере определяется внутренняя страница Wizard97 путем присвоения значений структуре [**пропшитпаже**](pss-propsheetpage.md) . В этом примере заголовок страницы, подзаголовок и шаблон диалогового окна определяются по идентификаторам ресурсов. Затем вызывается функция [**креатепропертишитпаже**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) для создания маркера хпропшитпаже страницы. Так как это будет вторая страница, то дескриптор присваивается массиву дескрипторов *ахпсп* с индексом 1.


```C++
// g_hInstance is the global HINSTANCE of the application.
// IntPage1DlgProc is the dialog procedure for this page.
// ahpsp is an array of HPROPSHEETPAGE handles.

PROPSHEETPAGE psp = { sizeof(psp) };

psp.hInstance         = g_hInstance;
psp.dwFlags           = PSP_USEHEADERTITLE | PSP_USEHEADERSUBTITLE;
psp.lParam            = (LPARAM) &wizdata;
psp.pszHeaderTitle    = MAKEINTRESOURCE(IDS_TITLE1);
psp.pszHeaderSubTitle = MAKEINTRESOURCE(IDS_SUBTITLE1);
psp.pszTemplate       = MAKEINTRESOURCE(IDD_INTERIOR1);
psp.pfnDlgProc        = IntPage1DlgProc;

ahpsp[1] = CreatePropertySheetPage(&psp);
```



### <a name="custom-page-data"></a>Настраиваемые данные страницы

При создании страницы к ней можно присвоить пользовательские данные с помощью члена **lParam** структуры [**пропшитпаже**](pss-propsheetpage.md) , обычно путем присвоения ей указателя на определяемую пользователем структуру.

При первом выборе страницы процедура диалогового окна получает сообщение [**WM \_ инитдиалог**](/windows/desktop/dlgbox/wm-initdialog) . Значение *lParam* сообщения указывает на копию структуры [**пропшитпаже**](pss-propsheetpage.md) страницы, из которой можно получить пользовательские данные. Затем эти данные можно сохранить для использования в последующих сообщениях с помощью [**сетвиндовлонгптр**](/windows/desktop/api/winuser/nf-winuser-setwindowlongptra) с ГВЛ \_ USERDATA в качестве параметра индекса. Несколько страниц могут иметь указатель на одни и те же данные, и любые изменения данных, внесенные одной страницей, доступны другим страницам в процедурах диалоговых окон.

### <a name="define-the-wizard-property-sheet"></a>Определение страницы свойств мастера

Как и в случае с обычными страницами свойств, можно определить страницу свойств мастера, заполнив элементы структуры [**пропшисеадер**](pss-propsheetheader.md) . Эта структура позволяет указать страницы, составляющие мастер, и порядок, в котором они будут отображаться, а также несколько связанных параметров. Затем запустите мастер, вызвав функцию [**Страница свойств**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) .

В стиле Wizard97 элемент **псзкаптион** структуры [**пропшисеадер**](pss-propsheetheader.md) игнорируется. Вместо этого мастер отображает заголовок, указанный в шаблоне диалогового окна текущей страницы. Если в шаблоне отсутствует заголовок, отображается заголовок из предыдущей страницы. Таким же, чтобы отобразить один и тот же заголовок на всех страницах, укажите заголовок в шаблоне для вводной страницы.

В стиле мастера Aero заголовок диалогового окна берется из **псзкаптион**.

Если вы создали массив дескрипторов ХПРОПШИТПАЖЕ для страниц, назначьте массив элементу **фпаже** . Если вместо этого был создан массив структур [**пропшитпаже**](pss-propsheetpage.md) , назначьте массив элементу **ППСП** и установите \_ флаг командном PSH пропшитпаже в элементе **dwFlags** .

В следующем примере значения присваиваются *командном PSH*, структуре [**пропшисеадер**](pss-propsheetheader.md) и вызывается функция [**Страница свойств**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) для запуска мастера. В мастере Wizard97 имеется как водяной знак, так и рисунок заголовка, определяемые их идентификаторами ресурсов. Массив *ахпсп* содержит все дескрипторы хпропшитпаже и определяет порядок по умолчанию, в котором они отображаются.


```C++
// g_hInstance is the global HINSTANCE of the application.
// ahpsp is an array of HPROPSHEETPAGE handles.

PROPSHEETHEADER psh = { sizeof(psh) };

psh.hInstance      = g_hInstance;
psh.hwndParent     = NULL;
psh.phpage         = ahpsp;
psh.dwFlags        = PSH_WIZARD97 | PSH_WATERMARK | PSH_HEADER;
psh.pszbmWatermark = MAKEINTRESOURCE(IDB_WATERMARK);
psh.pszbmHeader    = MAKEINTRESOURCE(IDB_BANNER);
psh.nStartPage     = 0;
psh.nPages         = 4;

PropertySheet(&psh);
```



### <a name="the-dialog-box-procedure"></a>Процедура диалогового окна

каждой странице мастера требуется процедура диалогового окна для обработки Windows сообщений, особенно уведомлений из элементов управления и мастера. Три сообщения, которые должны быть способны обрабатывать почти все мастера: [**WM \_ инитдиалог**](/windows/desktop/dlgbox/wm-initdialog), [**WM \_ destroy**](/windows/desktop/winmsg/wm-destroy)и [**WM \_ Notify**](wm-notify.md).

Сообщение [**WM \_ Notify**](wm-notify.md) получается перед отображением страницы и нажатием кнопки мастера. Параметр *lParam* сообщения является указателем на структуру заголовков [**NMHDR**](/windows/desktop/api/richedit/ns-richedit-nmhdr) . Идентификатор уведомления содержится в элементе **кода** структуры. Ниже приведены четыре уведомления, которые должны быть обработаны большинством мастеров.



| Код                                | Описание                                 |
|-------------------------------------|---------------------------------------------|
| [PSN \_ сетактиве](psn-setactive.md) | Отправляется перед отображением страницы.          |
| [PSN \_ визбакк](psn-wizback.md)     | Посылается при нажатии кнопки " **назад** ".   |
| [PSN \_ визнекст](psn-wiznext.md)     | Посылается при нажатии кнопки " **Далее** ".   |
| [PSN \_ визфиниш](psn-wizfinish.md) | Отправляется при нажатии кнопки **"Готово"** . |



 

### <a name="handle-wm_initdialog-and-wm_destroy"></a>Handles WM \_ инитдиалог и WM \_ destroy

Когда страница собирается отображаться в первый раз, ее процедура диалогового окна получает сообщение [**WM \_ инитдиалог**](/windows/desktop/dlgbox/wm-initdialog) . Обработка этого сообщения позволяет мастеру выполнить необходимые задачи инициализации, такие как хранение пользовательских данных или установка шрифтов.

При удалении страницы свойств появляется сообщение [**WM \_ destroy**](/windows/desktop/winmsg/wm-destroy) . Мастер автоматически уничтожается системой, но обработка этого сообщения позволяет выполнить все необходимые действия по очистке.

### <a name="handle-psn_setactive"></a>Обработайте PSN \_ сетактиве

Код уведомления [PSN \_ сетактиве](psn-setactive.md) отправляется каждый раз, когда страница собирается сделать видимой. При первом посещении страницы PSN \_ сетактиве следует за сообщением [**WM \_ инитдиалог**](/windows/desktop/dlgbox/wm-initdialog) . Если страница впоследствии снова посещается, она получает только \_ уведомление PSN сетактиве. Это уведомление обычно обрабатывается для инициализации данных на странице и включения соответствующих кнопок.

По умолчанию в мастере отображаются кнопки **назад**, **Далее** и **Отмена** , для которых включены все кнопки. Чтобы отключить кнопку или отобразить **Окончание** , а не **Далее**, необходимо отправить сообщение [**ПСМ \_ сетвизбуттонс**](psm-setwizbuttons.md) . После отправки сообщения состояние кнопок сохраняется до тех пор, пока оно не будет изменено другим сообщением **ПСМ \_ сетвизбуттонс** , даже если выбрана новая страница. Как правило, все обработчики [ \_ сетактиве PSN](psn-setactive.md) отправляют это сообщение, чтобы убедиться, что каждая страница имеет правильное состояние кнопки.

Состояние кнопки можно изменить с помощью этого сообщения в любое время. Например, может потребоваться изначально отключить кнопку " **Далее** ". После того как пользователь указал все необходимые сведения, можно отправить другое сообщение [**ПСМ \_ сетвизбуттонс**](psm-setwizbuttons.md) , чтобы включить кнопку **Далее** и позволить пользователю перейти на следующую страницу.

В следующем фрагменте кода используется макрос [**пропшит \_ сетвизбуттонс**](/windows/desktop/api/Prsht/nf-prsht-propsheet_setwizbuttons) для включения кнопок " **назад** " и " **Далее** " на внутренней странице перед ее отображением.


```C++
case WM_NOTIFY :
    {
        LPNMHDR pnmh = (LPNMHDR)lParam;
        
        switch(pnmh->code)
        {
        
        ...
        
        case PSN_SETACTIVE :
        
            ...
            
            // This is an interior page.
            PropSheet_SetWizButtons(hwnd, PSWIZB_NEXT | PSWIZB_BACK);
            
            ...
        }
    ...
    
    }
```



### <a name="handle-psn_wiznext-psnwizback-and-psn_wizfinish"></a>Работа с PSN \_ визнекст, пснвизбакк и PSN \_ визфиниш

При нажатии кнопки " **Далее** " или " **назад** " вы получаете код уведомления [PSN \_ визнекст](psn-wiznext.md) или [PSN \_ визбакк](psn-wizback.md) . По умолчанию мастер автоматически переходит на следующую или предыдущую страницу в порядке, определенном при создании страницы свойств. Распространенной причиной для решения этих уведомлений является запрет пользователю переключать страницы или переопределять порядок страниц по умолчанию.

Чтобы запретить пользователю переключать страницы, обработайте уведомление кнопки, вызовите функцию [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) с параметром DWL \_ мсгресулт со значением – 1 и возвратите **значение true**. Пример:


```C++
case PSN_WIZNEXT :

        ...
        
        // Do not go to the next page yet.
        SetWindowLong(hwnd, DWL_MSGRESULT, -1);
        
        return TRUE;
        
        ...
```



Чтобы переопределить стандартный порядок и переходить на определенную страницу, вызовите [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) с параметром DWL \_ мсгресулт, установленным в поле Идентификатор ресурса диалогового окна страницы, и возвратите **значение true**. Пример:


```C++
case PSN_WIZNEXT :

        ...
        
        // Go straight to the completion page.
        SetWindowLong(hwnd, DWL_MSGRESULT, IDD_FINISH);
        
        return TRUE;
        
        ...
```



При нажатии кнопки **"Готово"** или **"Отмена** " вы получаете код уведомления [PSN \_ визфиниш](psn-wizfinish.md) или [PSN \_ Reset](psn-reset.md) соответственно. При нажатии любой из этих кнопок мастер автоматически уничтожается системой. Однако эти уведомления можно обрабатывайте, если необходимо выполнить задачи очистки до уничтожения мастера. Чтобы предотвратить уничтожение мастера при получении \_ уведомления PSN визфиниш, вызовите [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) с параметром DWL мсгресулт, \_ установленным в значение **true**, и возвратите **значение true**. Пример:


```C++
case PSN_WIZFINISH :

        ...
        
        // Not finished yet.
        SetWindowLong(hwnd, DWL_MSGRESULT, TRUE);
        
        return TRUE;
        
        ...
```



### <a name="backward-compatible-wizards"></a>Мастера с обратной совместимостью

В предыдущем разделе предполагается, что вы реализуете мастер для системы с общими элементами управления [версии 5](common-control-versions.md) или более поздней.

При написании мастера для систем с более ранними версиями стандартных элементов управления многие функции, описанные в предыдущем разделе, будут недоступны. Ряд элементов структур [**пропшисеадер**](pss-propsheetheader.md) и [**пропшитпаже**](pss-propsheetpage.md) , используемых стилем Wizard97, поддерживается только для стандартных элементов управления версии 5 и более поздних. Однако по-прежнему можно реализовать мастер *обратной совместимости* с внешним видом, похожим на стиль стиля Wizard97. Для этого необходимо явно реализовать следующее:

-   Добавьте рисунок водяного знака в шаблон диалогового окна для страниц "Введение и завершение".
-   Сделайте все шаблоны одинаковым размером. Для внутренних страниц не существует отдельной определенной системой области заголовка.
-   Явно создайте область заголовка внутренней страницы в шаблонах.
-   Не используйте изображение заголовка, так как оно может конфликтовать с заголовком или подзаголовок, если размер мастера изменяется.

Дополнительные сведения о мастерах с поддержкой обратной совместимости см. в статье [Мастер обратной совместимости 97](/previous-versions//ms737910(v=vs.85)).

## <a name="remarks"></a>Комментарии

полное описание проблем проектирования для Wizard97 см. в разделе [спецификация Wizard97](/previous-versions//ms738248(v=vs.85))в других Windows SDK. В этом документе приводятся рекомендации по таким принципам, как измерения для диалоговых окон, растровые измерения и цвета, а также размещение элементов управления.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Использование страниц свойств](using-property-sheets.md)
</dt> <dt>

[демонстрация Windows стандартных элементов управления (кппвиндовскоммонконтролс)](https://github.com/microsoftarchive/msdn-code-gallery-microsoft/tree/master/OneCodeTeam/Windows%20common%20controls%20demo%20(CppWindowsCommonControls)/%5BC++%5D-Windows%20common%20controls%20demo%20(CppWindowsCommonControls)/C++/CppWindowsCommonControls)
</dt> </dl>

 

 