---
title: Сообщение CB_ADDSTRING (Winuser. h)
description: Добавляет строку в список поля со списком. Если поле со списком не имеет \_ стиля сортировки CBS, строка добавляется в конец списка. В противном случае строка вставляется в список, а список сортируется.
ms.assetid: 201bcb7b-e7d1-41e6-8eb7-a5864b659a52
keywords:
- элементы управления Windows сообщений CB_ADDSTRING
topic_type:
- apiref
api_name:
- CB_ADDSTRING
api_location:
- Winuser.h
api_type:
- HeaderDef
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: dda16367ec24e869f6cb664e89751d7a13efec3c
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127173975"
---
# <a name="cb_addstring-message"></a>\_Сообщение ADDSTRING CB

Добавляет строку в список поля со списком. Если поле со списком не имеет стиля [**\_ сортировки CBS**](combo-box-styles.md) , строка добавляется в конец списка. В противном случае строка вставляется в список, а список сортируется.

## <a name="parameters"></a>Параметры

<dl> <dt>

*wParam* 
</dt> <dd>

Этот параметр не используется.

</dd> <dt>

*lParam* 
</dt> <dd>

Указатель **LPCTSTR** на добавляемую строку, заканчивающуюся нулем. Если создать поле со списком, используя стиль, рисуемый владельцем, но без [**стиля \_ хасстрингс CBS**](combo-box-styles.md) , значение параметра *lParam* сохраняется как данные элемента, а не как строка, на которую он мог бы в противном случае указать. Данные элемента можно получить или изменить, отправив сообщение [**CB \_ Жетитемдата**](cb-getitemdata.md) или [**CB \_ сетитемдата**](cb-setitemdata.md) .

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Возвращаемое значение — это Отсчитываемый от нуля индекс строки в списке поля со списком. Если возникает ошибка, возвращается значение CB \_ Err. Если недостаточно места для хранения новой строки, это будет \_ ЕРРСПАЦЕ CB.

## <a name="remarks"></a>Remarks

При создании поля со списком, рисуемого владельцем, с использованием стиля [**\_ сортировки CBS**](combo-box-styles.md) , но без стиля [**\_ хасстрингс**](combo-box-styles.md) , сообщение [**WM \_ компареитем**](wm-compareitem.md) отправляется владельцу поля со списком один или несколько раз, чтобы новый элемент можно было правильно поместить в список.

Чтобы вставить строку в определенное место в списке, используйте сообщение [**\_ инсертстринг CB**](cb-insertstring.md) .

Если поле со списком имеет стиль [**WS \_ HSCROLL**](/windows/desktop/winmsg/window-styles) и вы добавляете строку шире, чем поле со списком, отправьте [**сообщение \_ сесоризонталекстент фунтов**](lb-sethorizontalextent.md) , чтобы появилась горизонтальная полоса прокрутки.

**Comclt32.dll версии 5,0 или более поздней:** Если заданы [**\_ строчные**](combo-box-styles.md) или [**CBS \_**](combo-box-styles.md) в нижнем регистре, версия в Юникоде **\_ ADDSTRING** изменяет строку. Если используется глобальная память только для чтения, это приводит к сбою приложения.

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|----------------------------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows \[Только классические приложения Vista\]<br/>                                                           |
| Минимальная версия сервера<br/> | Windows Только для \[ настольных приложений сервера 2003\]<br/>                                                     |
| Заголовок<br/>                   | <dl> <dt>Winuser. h (включает Windows. h)</dt> </dl> |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

**Ссылки**
</dt> <dt>

[**\_Каталог CB**](cb-dir.md)
</dt> <dt>

[**\_ИНСЕРТСТРИНГ CB**](cb-insertstring.md)
</dt> <dt>

[**сесоризонталекстент балансировки нагрузки \_**](lb-sethorizontalextent.md)
</dt> <dt>

[**WM \_ компареитем**](wm-compareitem.md)
</dt> </dl>

 

