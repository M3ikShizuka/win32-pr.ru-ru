---
title: Сведения об элементах управления "Выбор даты и времени"
description: Элемент управления "Выбор даты и времени" (DTP) предоставляет простой и интуитивно понятный интерфейс для обмена данными о дате и времени с пользователем.
ms.assetid: 6749c3ae-2c52-4183-ac4e-68ca7ebf1e13
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 182381c40b636683255e95ba0680a1245ef0adf3
ms.sourcegitcommit: 0f7a8198bacd5493ab1e78a9583c7a3578794765
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/25/2021
ms.locfileid: "110424224"
---
# <a name="about-date-and-time-picker-controls"></a>Сведения об элементах управления "Выбор даты и времени"

*Элемент управления "Выбор даты и времени" (DTP)* предоставляет простой и интуитивно понятный интерфейс для обмена данными о дате и времени с пользователем. Например, с помощью элемента управления DTP можно попросить пользователя ввести дату, а затем легко получить выбор.

Рассматриваются следующие темы:

-   [Пользовательский интерфейс выбора даты и времени](#date-and-time-picker-user-interface)
-   [Стили и форматы элемента управления "Выбор даты и времени"](#date-and-time-picker-control-styles-and-formats)
    -   [Стандартные форматы](#preset-formats)
    -   [Пользовательские форматы](#custom-formats)
    -   [Строки форматирования](#format-strings)
    -   [Поля обратного вызова](#callback-fields)
-   [Сообщения об элементах управления средства выбора даты и времени](#date-and-time-picker-control-notification-messages)
-   [См. также](#related-topics)

> [!Note]
> Windows не поддерживает даты до 1601. Дополнительные сведения см. в разделе Структура [**fileTime**](/windows/desktop/api/minwinbase/ns-minwinbase-filetime) .
>
> Элемент управления основан на григорианском календаре, который появился в 1753. В нем не будут вычисляться даты, которые соответствуют юлианским календарям.

## <a name="date-and-time-picker-user-interface"></a>Пользовательский интерфейс выбора даты и времени

В клиентской области элемента управления "Выбор даты и времени" (DTP) отображаются сведения о дате или времени, а также и то, и другое, и действует как интерфейс, через который пользователи изменяют данные. Дату можно выбрать из календаря или с помощью элемента управления "вверх-вниз"; время можно изменить, введя поля в полях, определяемых [строками формата](#format-strings)элемента управления. При необходимости элемент управления отображает флажок. Если этот флажок установлен, можно получить значение элемента управления; в противном случае элемент управления считается неинициализированным.

На следующем рисунке показано окно, содержащее три элемента управления "Выбор даты". Первый элемент управления "Выбор даты" был создан с использованием стиля [**DTS \_ шовноне**](date-and-time-picker-control-styles.md) , второй — со стилем "невыполненный [**", \_**](date-and-time-picker-control-styles.md) а третий — без специальных стилей. В третьем элементе управления пользователь щелкнул стрелку вниз, чтобы отобразить календарь.

![снимок экрана окна, демонстрирующее три стиля элементов управления "Выбор даты"](images/dtpdatepick.png)

На следующем рисунке показаны окна с тремя элементами управления, которые содержат время.

Первый элемент управления был создан с использованием стиля [**DTS \_ TIMEFORMAT**](date-and-time-picker-control-styles.md) и показывает время в заданном по умолчанию времени, которое состоит из четырех полей. Пользователь может ввести допустимое значение в любое из этих полей или выбрать поле и изменить значение с помощью элемента управления "вверх/вниз" или клавиш со стрелками.

Второй элемент управления показывает пользовательский набор форматов с помощью [**DateTime \_ сетформат**](/windows/desktop/api/Commctrl/nf-commctrl-datetime_setformat). Как и в первом элементе управления, пользователь может изменить поля времени, введя или используя клавиши со стрелками. День недели можно изменить, выбрав дату в календаре, которая открывается, когда пользователь щелкает стрелку вниз.

Третий элемент управления показывает, как произвольный текст можно добавить в элемент управления. Пользователь может выбрать час (от 1 до 24), введя, с помощью клавиш со стрелками или с помощью элемента управления "вверх-вниз".

![снимок экрана окна, в котором показаны три элемента управления, которые содержат время](images/dtpdatetimepick.png)

Элемент управления DTP автоматически обновляет внутреннюю информацию на основе входных данных пользователя. Элемент управления распознает следующие элементы как допустимые входные данные.



| Входная Категория | Описание                                                                                                                                                                                                                                                                                                                                                                  |
|----------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Клавиши со стрелками     | Элемент управления принимает клавиши со стрелками для навигации по полям в элементе управления и изменения значений. Пользователь может нажать клавиши или для перемещения по элементу управления, если пользователь пытается перейти за последнее поле в заданном направлении, фокус клавиатуры «заключает» в поле на противоположной стороне элемента управления. Ключи и изменяют значения в текущем поле постепенно. |
| Конечная и домашняя   | Элемент управления принимает \_ виртуальные ключи VK End и VK \_ Home для изменения значения в текущем поле на его верхние и нижние пределы соответственно.                                                                                                                                                                                                                          |
| Функциональные ключи  | Ключ активирует режим редактирования. Ключ приводит к тому, что элемент управления отображает элемент управления "календарь с раскрывающимся списком" (для этого также можно нажать клавишу).                                                                                                                                                                                                                                          |
| Числа        | Элемент управления принимает числовые входные данные в сегментах, состоящий из двух символов. Если значение, вводимое пользователем, является недопустимым (например, если для параметра month задать значение 14), элемент управления отклоняет его и сбрасывает экран до предыдущего значения.                                                                                                                                                                |
| Плюс и минус | Элемент управления принимает \_ виртуальные ключи VK Add и VK \_ Subtract из цифровой клавиатуры для увеличения и уменьшения значения в текущем поле.                                                                                                                                                                                                                             |



 

Элементы управления DTP, не использующие стиль [**" \_ испадающий" DTS**](date-and-time-picker-control-styles.md) , отображают кнопку со стрелкой. Если пользователь нажимает эту кнопку, элемент управления "Календарь на месяц" становится недоступным. Пользователь может выбрать конкретную дату, щелкнув область календаря.

## <a name="date-and-time-picker-control-styles-and-formats"></a>Стили и форматы элемента управления "Выбор даты и времени"

Элементы управления "Выбор даты и времени" (DTP) имеют несколько [стилей элемента управления "Выбор даты и времени](date-and-time-picker-control-styles.md) ", которые определяют внешний вид и поведение элемента управления. Укажите стиль при создании элемента управления с помощью параметра *Двстиле* [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa). Чтобы извлечь или изменить стиль окна после создания элемента управления, используйте [**жетвиндовлонг**](/windows/desktop/api/winuser/nf-winuser-getwindowlonga) и [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga).

### <a name="preset-formats"></a>Стандартные форматы

Существует три стандартных формата, доступных для отображения даты и один для отображения времени. Задайте эти форматы, выбрав один из следующих стилей окна.



|   Формат                                                                                                    |   Описание                                                         |
|-------------------------------------------------------------------------------------------------------|------------------------------------------------------------|
| [**лонгдатеформат служб DTS \_**](date-and-time-picker-control-styles.md)                 | Отображение будет выглядеть следующим образом: "Пятница, 19 апреля, 1996".      |
| [**шортдатеформат служб DTS \_**](date-and-time-picker-control-styles.md)               | Отображение будет выглядеть следующим образом: "4/19/96".                     |
| [**шортдатецентуриформат служб DTS \_**](date-and-time-picker-control-styles.md) | **Версия 5,80**. Отображение будет выглядеть следующим образом: "4/19/1996". |
| [**TIMEFORMAT служб DTS \_**](date-and-time-picker-control-styles.md)                         | Отобразится следующий вид: "5:31:42 PM".                  |



 

### <a name="custom-formats"></a>Пользовательские форматы

Элемент управления DTP полагается на строку формата, чтобы определить, как она будет отображать поля данных. Если стандартные форматы недостаточны, можно создать пользовательский формат, определив собственную строку формата. Пользовательские форматы обеспечивают большую гибкость для приложения. Они позволяют указать порядок, в котором элемент управления будет отображать поля сведений. Можно включить основной текст, а также поля обратного вызова для запроса сведений от пользователя. После создания строки ее необходимо назначить элементу управления DTP с помощью сообщения [**DTM \_ сетформат**](dtm-setformat.md) .

### <a name="format-strings"></a>Строки формата

Строка формата DTP состоит из ряда элементов, представляющих определенный фрагмент данных, и определения его формата отображения. Элементы будут отображаться в том порядке, в котором они отображаются в строке формата.

Элементы формата даты и времени будут заменены фактическими датой и временем. Они определяются следующими группами символов.



| Элемент | Описание                                                                       |
|---------|-----------------------------------------------------------------------------------|
| "d"     | День (один или два цифры).                                                        |
| "dd"    | День, состоящих из двух цифр. Значения дня с одной цифрой предшествуют нулю.                |
| "ddd"   | Сокращение дня недели из трех символов.                                         |
| "dddd"  | Полное название дня недели.                                                            |
| "h"     | 1-или 2-значный час в 12-часовом формате.                                     |
| "hh"    | Час из двух цифр в 12-часовом формате. Однозначным значениям предшествует ноль. |
| "H"     | Час с 1 или 2 цифрами в 24-часовом формате.                                     |
| "HH"    | Час из двух цифр в 24-часовом формате. Однозначным значениям предшествует ноль. |
| "m"     | 1-или двузначное число минут.                                                     |
| "mm"    | Минута, состоящих из двух цифр. Однозначным значениям предшествует ноль.                 |
| "M"     | Номер месяца, состоящих из одного или двух цифр.                                               |
| "MM"    | Номер месяца из двух цифр. Однозначным значениям предшествует ноль.           |
| "MMM"   | Сокращение месяца из трех символов.                                           |
| "MMMM"  | Полное название месяца.                                                              |
| "t"     | Аббревиатура с одной буквы до полудня (т. е. отображается как «A»).              |
| "tt"    | Двузначное обозначение AM/PM (то есть AM отображается как «AM»).             |
| "yy"    | Последние две цифры года (то есть 1996 будут отображаться как "96").       |
| "yyyy"  | Полный год (то есть 1996 будет отображаться как "1996").                       |



 

Чтобы сделать эту информацию более удобочитаемой, можно добавить основной текст в строку формата, заключив ее в одинарные кавычки. Пробелы и знаки препинания не обязательно должны быть заключены в кавычки.

> [!Note]  
> Неформатировать символы, не разделенные одинарными кавычками, приведет к непредсказуемому отображению элемента управления DTP.

Например, чтобы отобразить текущую дату в формате "" сегодня: 04:22:31 вторник Мар 23, 1996 ", строка формата" "уже сегодня:" HH ": m": dddd МММ DD "," гггг ". Чтобы включить одинарную кавычку в текст основного текста, используйте две последовательные одинарные кавычки. Например, "" не забыть "МММ дд", "yyyy" выдает выходные данные, которые выглядят следующим образом: не забывайте 23 марта 1996. Не обязательно использовать кавычки с запятой, так что "' не забывайте" МММ дд, гггг "также является допустимым и создает те же выходные данные.

### <a name="callback-fields"></a>Поля обратного вызова

В дополнение к [строкам стандартного формата](#format-strings) и основному тексту можно также определить определенные части отображаемых данных как [поля обратного вызова](#callback-fields). Эти поля можно использовать для запроса сведений о пользователе. Чтобы объявить поле обратного вызова, включите один или несколько символов "X" (код ASCII 88) в любом месте строки формата. Можно создать поля обратного вызова, имеющие уникальный идентификатор, повторив символ "X". Таким словами, строка формата "XX dddd МММ дд", "yyy XXX" содержит два уникальных поля обратного вызова: "XX" и "XXX". Как и другие поля элемента управления DTP, поля обратного вызова отображаются в порядке слева направо в зависимости от их расположения в строке формата.

Когда элемент управления DTP анализирует строку формата и встречает поле обратного вызова, он отправляет коды уведомлений [ДТН \_ Format](dtn-format.md) и [ДТН \_ форматкуери](dtn-formatquery.md) . Элемент строки формата, соответствующий полю обратного вызова, включается в уведомления, чтобы позволить принимающему приложению определить, какое поле обратного вызова запрашивается. Владелец элемента управления должен ответить на эти уведомления, чтобы убедиться в правильности отображения пользовательских сведений.

## <a name="date-and-time-picker-control-notification-messages"></a>Сообщения об элементах управления средства выбора даты и времени

Элемент управления "Выбор даты и времени" (DTP) отправляет коды уведомлений при получении пользователем входных данных или процессов и реагирует на поля обратного вызова. Родительский элемент управления получает эти коды уведомлений в виде сообщений [**\_ уведомления WM**](wm-notify.md) .

С элементами управления DTP используются следующие коды уведомлений.



| Код уведомления                             | Описание                                                                                                                                                                                                       |
|-----------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [ДТН \_ крупный план](dtn-closeup.md)               | Указывает, что раскрывающийся календарь будет удален.                                                                                                                                               |
| [ДТН \_ датетимечанже](dtn-datetimechange.md) | Сигнализирует об изменении в элементе управления DTP.                                                                                                                                                                          |
| [\_раскрывающийся список ДТН](dtn-dropdown.md)             | Указывает, что будет отображен раскрывающийся календарь с месяцю.                                                                                                                                             |
| [\_Формат ДТН](dtn-format.md)                 | Запрашивает текст, отображаемый в части строки формата, описанной в качестве поля обратного вызова.                                                                                                                         |
| [ДТН \_ форматкуери](dtn-formatquery.md)       | Запрашивает сведения о максимально допустимом размере текста, отображаемого в поле обратного вызова.                                                                                                            |
| [ДТН \_ усерстринг](dtn-userstring.md)         | Сигнализирует об окончании операции редактирования пользователем в элементе управления. Это уведомление отправляется только элементами управления DTP, которые используют [**стиль \_ Аппканпарсе служб DTS**](date-and-time-picker-control-styles.md) . |
| [ДТН \_ вмкэйдовн](dtn-wmkeydown.md)           | Сигнализирует, что пользователь нажал на ключ в поле обратного вызова элемента управления DTP.                                                                                                                                   |



 

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[Справочник по элементу выбора даты и времени](date-and-time-picker-control-reference.md)
</dt> </dl>

 

 