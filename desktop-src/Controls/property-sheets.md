---
title: О страницах свойств
description: Страница свойств — это окно, позволяющее пользователю просматривать и изменять свойства элемента.
ms.assetid: 93676a64-7980-48cd-8615-23b14a118e1c
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 3256959b588e2109740033692c0c528889fc939f
ms.sourcegitcommit: 11f52354f570aacaf1ba2a266b2e507abd73352a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "105647897"
---
# <a name="about-property-sheets"></a>О страницах свойств

*Страница свойств* — это окно, позволяющее пользователю просматривать и изменять свойства элемента. Например, приложение электронной таблицы может использовать страницу свойств, чтобы разрешить пользователю задавать свойства шрифта и границы ячейки, а также просматривать и задавать свойства устройства, такие как диск, принтер или мышь.

В этом разделе рассматриваются следующие темы.

-   [Основные сведения о странице свойств](#property-sheet-basics)
-   [Диалоговые окна страницы свойств](#property-sheet-dialog-boxes)
-   [Страницы](#pages)
-   [Создание страницы свойств](#property-sheet-creation)
-   [Добавление и удаление страниц](#adding-and-removing-pages)
-   [Заголовок и метки страницы свойств](#property-sheet-title-and-page-labels)
-   [Активация страницы](#page-activation)
-   [Кнопка "Справка"](#help-button)
    -   [Удаление кнопки «Справка» в строке заголовка](#removing-the-caption-bar-help-button)
-   [Кнопки ОК, отмена и применить](#ok-cancel-and-apply-buttons)
-   [Мастеры](#wizards)

## <a name="property-sheet-basics"></a>Основные сведения о странице свойств

Чтобы реализовать вкладки свойств в приложении, включите в проект файл заголовка Пршт. h. Пршт. h содержит все идентификаторы, используемые со страницами свойств.

Страница свойств содержит одно или несколько перекрывающихся окон, которые называются страницами, каждая из которых содержит окна элементов управления для настройки группы связанных свойств. Например, страница может содержать элементы управления для установки свойств шрифта элемента, включая стиль типа, размер точки, цвет и т. д. Каждая страница содержит вкладку, которую пользователь может выбрать, чтобы отобразить страницу на передний план страницы свойств. Например, в приложении панели управления Date-Time отображается следующая страница свойств.

![снимок экрана: страница свойств с двумя вкладками, одна из которых показывает часы и месячный элемент управления "Календарь"](images/propsheet1.png)

Стандартная страница свойств с несколькими страницами с вкладками позволяет пользователю получить произвольный доступ ко всем свойствам. Если свойства больше подходят для задания последовательности, можно использовать [Мастер](#wizards).

## <a name="property-sheet-dialog-boxes"></a>Диалоговые окна страницы свойств

Страница свойств и содержащаяся в ней страницами фактически являются диалоговыми окнами. Страница свойств является системным диалоговым окном, которое управляет страницами и предоставляет общий контейнер для них. Диалоговое окно «страница свойств» может быть модальным или немодальным. Он включает рамку, строку заголовка и четыре кнопки: **ОК**, **Отмена**, **Применить** и (необязательно) **справку**. Процедуры диалоговых окон получают коды уведомлений в форме [**WM \_ Notify**](wm-notify.md) messages, когда пользователь нажимает кнопку.

> [!NOTE]  
> Не все сведения в этом разделе относятся к мастерам, которые имеют несколько различного внешнего вида и поведения. Например, мастеры имеют разные наборы кнопок и не имеют вкладок. Дополнительные сведения см. в разделе [Создание мастеров](wizards.md).

Каждая страница на странице свойств является определенным приложением немодальным диалоговым окном, которое управляет окнами управления, используемыми для просмотра и редактирования свойств элемента. Вы предоставляете шаблон диалогового окна, используемый для создания каждой страницы, а также процедуру диалогового окна, которая управляет элементами управления и задает свойства соответствующего элемента.

Страница свойств отправляет коды уведомлений в процедуру диалогового окна для страницы, когда она получает или теряет активацию, а также когда пользователь нажимает кнопку **ОК**, **Отмена**, **Применить** или **Справка** . Уведомления отправляются в виде сообщений [**\_ уведомления WM**](wm-notify.md) . Параметр *lParam* — это адрес структуры [**NMHDR**](/windows/desktop/api/richedit/ns-richedit-nmhdr) , которая включает в себя обработчик окна для диалогового окна страницы свойств.

Для некоторых кодов уведомлений требуется, чтобы страница возвращала **значение true** или **false** в ответ на сообщение [**\_ уведомления WM**](wm-notify.md) . Для этого на странице должна быть использована функция [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) , чтобы задать для диалогового окна "страница" значение **\_ Мсгресулт** ( **true** или **false**).

## <a name="pages"></a>Страницы

Страница свойств должна содержать по крайней мере одну страницу, но она не может содержать больше, чем значение **макспроппажес** , как определено в файлах заголовков Windows. Каждая страница содержит Отсчитываемый от нуля индекс, назначаемый странице свойств в соответствии с порядком добавления страницы в страницу свойств. Индексы используются в сообщениях, отправляемых на страницу свойств.

Страница свойств может содержать вложенное диалоговое окно. Если это так, необходимо включить стиль [**WS \_ ex \_ контролпарент**](/windows/desktop/winmsg/extended-window-styles) для диалогового окна верхнего уровня и вызвать функцию [**исдиалогмессаже**](/windows/desktop/api/winuser/nf-winuser-isdialogmessagea) с маркером родительского диалогового окна. Это гарантирует, что пользователь сможет использовать нажатия клавиш и клавиши навигации диалогового окна, чтобы переместить фокус на элементы управления во вложенном диалоговом окне.

Каждая страница имеет соответствующий значок и метку. Страница свойств создает вкладку для каждой страницы и отображает значок и метку на вкладке. Все страницы свойств должны использовать нежирный шрифт. Чтобы убедиться, что шрифт не является полужирным, укажите в шаблоне диалогового окна стиль **\_ 3DLOOK в DS** .

Процедура диалогового окна для страницы не должна вызывать функцию [**EndDialog**](/windows/desktop/api/winuser/nf-winuser-enddialog) . Это приведет к уничтожению всей страницы свойств, а не только странице.

Минимальный размер страницы свойств — 212 единиц диалогового окна по горизонтали и 114 единиц диалогового окна по вертикали. Если диалоговое окно страницы меньше этого размера, то страница будет увеличена до тех пор, пока не превысит минимальный размер. Файл заголовка Пршт. h содержит три набора рекомендуемых размеров для страниц свойств, как показано в следующей таблице.

|  Размер                |   Описание                                                   |
|----------------------|-----------------------------------------------------------------|
| **PROP \_ SM \_ кксдлг**  | Ширина (в диалоговых единицах) небольшой страницы свойств.         |
| **PROP \_ SM \_ цидлг**  | Высота (в единицах диалоговых окон) небольшой страницы свойств.        |
| **PROP \_ MED \_ кксдлг** | Ширина (в диалоговых единицах) страницы свойств среднего размера.  |
| **PROP \_ MED \_ цидлг** | Высота страницы свойств среднего размера в диалоговых единицах. |
| **PROP \_ LG \_ кксдлг**  | Ширина на единицах диалогового окна большой страницы свойств.         |
| **PROP \_ LG \_ цидлг**  | Высота на единицах диалогового окна большой страницы свойств.        |

Использование этих рекомендуемых размеров поможет обеспечить согласованность визуальных элементов приложения и других приложений Microsoft Windows.

В редакторе ресурсов Microsoft Visual Studio можно создать страницу соответствующего размера в диалоговом окне **Добавление ресурса** . Разверните узел диалогового окна и выберите **Идд ( \_ \_ крупный**), **Идд ( \_ \_ средний**) или **Идд ( \_ \_ малый**).

Лист свойств автоматически изменяется в соответствии с самой крупной страницей.

## <a name="property-sheet-creation"></a>Создание страницы свойств

Перед созданием страницы свойств необходимо определить одну или несколько страниц. Это включает в себя заполнение структуры [**пропшитпаже**](pss-propsheetpage.md) информацией о странице — ее значком, меткой, шаблоном диалогового окна, процедурой диалогового окна и т. д., а затем указание адреса структуры в вызове функции [**креатепропертишитпаже**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) . Функция возвращает маркер типа ХПРОПШИТПАЖЕ, который однозначно определяет страницу.

Чтобы создать страницу свойств, необходимо указать адрес структуры [**пропшисеадер**](pss-propsheetheader.md) в вызове функции [**Страница свойств**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) . Структура определяет значок и заголовок для страницы свойств, а также включает адрес массива дескрипторов ХПРОПШИТПАЖЕ, полученных с помощью [**креатепропертишитпаже**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea). Когда **Страница свойств** создает страницу свойств, она включает страницы, указанные в массиве. Страницы отображаются на странице свойств в том же порядке, в котором они содержатся в массиве.

Другим способом назначения страниц на страницу свойств является указание массива структур [**пропшитпаже**](pss-propsheetpage.md) вместо массива дескрипторов **хпропшитпаже** . В этом случае [**Страница свойств**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) создает дескрипторы для страниц перед их добавлением в страницу свойств.

При создании страницы процедура диалогового окна получает сообщение [**WM \_ инитдиалог**](/windows/desktop/dlgbox/wm-initdialog) . Параметр *lParam* сообщения является указателем на копию структуры [**пропшитпаже**](pss-propsheetpage.md) , которая определяется при создании страницы. В частности, при создании страницы член **lParam** структуры может использоваться для передачи сведений, определяемых приложением, в процедуру диалогового окна. За исключением члена **lParam** , эта структура должна рассматриваться как доступная только для чтения. Изменение любого, кроме **lParam** , приведет к непредсказуемым последствиям.

Когда система впоследствии передает копию структуры [**пропшитпаже**](pss-propsheetpage.md) страницы в приложение, она использует тот же указатель. Все изменения в структуре будут передаваться вместе с. Поскольку член **lParam** игнорируется системой, его можно изменить для отправки данных в другие части приложения. Например, можно использовать **lParam** для передачи информации в функцию обратного вызова [*пропшитпажепрок*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka) страницы.

[**Страница свойств**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) автоматически задает размер и начальное расположение страницы свойств. Расположение основано на положении окна-владельца, а размер — на самой крупной странице, указанной в массиве страниц при создании страницы свойств. Если нужно, чтобы страницы совпадали с шириной четырех кнопок в нижней части страницы свойств, установите ширину самой широкой страницы равным 190 единицам диалогового окна.

Размер страницы свойств вычисляются на основе свойств *Width* и *Height* шаблона диалогового окна в файле ресурсов. Дополнительные сведения см. в разделе [**ресурс диалога**](/windows/desktop/menurc/dialog-resource) или [**ресурс диаложекс**](/windows/desktop/menurc/dialogex-resource) . Однако обратите внимание, что в целях совместимости измерения вычисляются относительно шрифта MS Shell Dlg, а не шрифта, используемого страницей. При проектировании страницы, использующей другой шрифт, можно использовать одно из следующих предложений.

-   Настройте размеры шаблона диалогового окна, чтобы компенсировать разницу в размере между шрифтом MS Shell Dlg и шрифтом, используемым страницей в действительности. Например, если выбрать шрифт, который вдвое шире, чем MS Shell Dlg, задайте для свойства Width диалогового окна значение дважды в качестве обычного.
-   Используйте шаблон [**диаложекс**](/windows/desktop/menurc/dialogex-resource) и задайте стиль диалогового окна **DS \_ шеллфонт** . В этом случае диспетчер страниц свойств интерпретирует измерения диалогового окна относительно шрифта, используемого шаблоном диалогового окна.

## <a name="adding-and-removing-pages"></a>Добавление и удаление страниц

После создания страницы свойств приложение может добавить страницу в конец существующего набора страниц, отправив сообщение [**ПСМ \_ ADDPAGE**](psm-addpage.md) . Чтобы вставить страницу между существующими страницами, отправьте сообщение [**пропшит \_ инсертпаже**](/windows/desktop/api/Prsht/nf-prsht-propsheet_insertpage) . Обратите внимание, что размер страницы свойств не может быть изменен после ее создания. Все добавленные или вставленные страницы должны быть не больше самой большой страницы, находящегося в данный момент на странице свойств. Чтобы удалить страницу, отправьте сообщение [**ПСМ \_ REMOVEPAGE**](psm-removepage.md) .

При определении страницы можно указать адрес функции обратного вызова [*пропшитпажепрок*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka) , которую вызывает страница свойств при создании или удалении страницы. Использование *пропшитпажепрок* дает возможность выполнять операции инициализации и очистки для отдельных страниц.

> [!NOTE]  
> Количество сообщений и один вызов функции происходят, когда страница свойств манипулирует списком страниц. При выполнении этого действия попытка изменить список страниц приведет к непредсказуемым результатам. Не добавляйте, вставляйте или удаляйте страницы в реализации [*пропшитпажепрок*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka)или при обработке следующих уведомлений и сообщений Windows.
>
> -   [PSN \_ Применить](psn-apply.md)
> -   [PSN \_ киллактиве](psn-killactive.md)
> -   [\_Сброс PSN](psn-reset.md)
> -   [PSN \_ сетактиве](psn-setactive.md)
> -   [PSN \_ визбакк](psn-wizback.md)
> -   [PSN \_ визнекст](psn-wiznext.md)
> -   [**WM \_ инитдиалог**](/windows/desktop/dlgbox/wm-initdialog)
> -   [**WM \_ destroy**](/windows/desktop/winmsg/wm-destroy)

Если возникает необходимость изменить страницу свойств во время обработки одного из этих сообщений или во время выполнения [*пропшитпажепрок*](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka) , опубликуйте частное сообщение Windows. Приложение не будет получать это сообщение до тех пор, пока диспетчер страниц свойств не завершит свои задачи, после чего вы сможете изменить список страниц.

При удалении страницы свойств она автоматически удаляет все добавленные в нее страницы. Страницы уничтожаются в обратном порядке, указанном в массиве, используемом для создания страниц. Чтобы уничтожить страницу, созданную функцией [**креатепропертишитпаже**](/windows/desktop/api/Prsht/nf-prsht-createpropertysheetpagea) , но не добавленную на страницу свойств, используйте функцию [**дестройпропертишитпаже**](/windows/desktop/api/Prsht/nf-prsht-destroypropertysheetpage) .

## <a name="property-sheet-title-and-page-labels"></a>Заголовок и метки страницы свойств

Задается заголовок страницы свойств в структуре [**пропшисеадер**](pss-propsheetheader.md) , используемой для создания страницы свойств. Если элемент **dwFlags** включает значение **командном PSH \_ проптитле** , то на странице свойств добавляется суффикс "Properties" или префикс "свойства для" в зависимости от версии. Заголовок можно изменить после создания страницы свойств с помощью сообщения [**ПСМ \_ сеттитле**](psm-settitle.md) . В мастере Aero это сообщение можно использовать для динамического изменения заголовка внутренней страницы.

По умолчанию страница свойств использует строку имени, указанную в шаблоне диалогового окна, в качестве метки для страницы. Строку имени можно переопределить, включив значение **PSP \_ усетитле** в элемент **dwFlags** структуры [**пропшитпаже**](pss-propsheetpage.md) , определяющей страницу. Если задано **PSP \_ усетитле** , то элемент **псзтитле** должен содержать адрес строки метки для страницы.

## <a name="page-activation"></a>Активация страницы

Страница свойств может содержать только одну активную страницу за раз. Страница, на которой активирована активация, находится на переднем плане перекрывающихся стеков страниц. Пользователь активирует страницу, выбирая ее вкладку. приложение активирует страницу с помощью сообщения [**ПСМ \_ сеткурсел**](psm-setcursel.md) .

Страница свойств отправляет код уведомления [PSN \_ киллактиве](psn-killactive.md) на страницу, на которой будет потеряна активация. В ответ на страницу необходимо проверить все изменения, внесенные пользователем на странице. Если перед потерей активации страница требует дополнительных входных данных пользователя, используйте функцию [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) , чтобы установить для **значения \_ Мсгресулт** на странице значение **true**. Кроме того, на странице должно отобразиться окно сообщения с описанием проблемы и рекомендуемым действием. Задайте для параметра **DWL \_ Мсгресулт** **значение false** , если вы хотите потерять активацию.

Прежде чем страница, которая получает активацию, была видна, страница свойств отправляет на страницу код уведомления [PSN \_ сетактиве](psn-setactive.md) . Страница должна отвечать, инициализируя ее окна управления.

## <a name="help-button"></a>Кнопка "Справка"

Вкладки свойств могут отображать две кнопки справки: кнопку справки на странице свойств, которая отображается в нижней части фрейма, рядом с кнопками **ОК** / **Отмена** / **применения** и стандартная кнопка заголовка, предоставляющая контекстную справку.

Кнопка Справка страницы свойств является необязательной и может быть включена на странице по отдельности. Отображение кнопки Справка на странице свойств для одной или нескольких страниц:

-   Установите флаг **командном PSH \_ хашелп** в элементе **dwFlags** структуры [**пропшисеадер**](pss-propsheetheader.md) страницы свойств.
-   Для каждой страницы, на которой будет отображаться кнопка справки, установите флаг **PSP \_ хашелп** в элементе **dwFlags** структуры [**пропшитпаже**](pss-propsheetpage.md) страницы.

Когда пользователь нажимает кнопку "Справка", активная страница получает код уведомления [PSN \_ Help](psn-help.md) . Страница должна отвечать, отображая справочные сведения, как правило, путем вызова функции [**WinHelp**](/windows/desktop/api/winuser/nf-winuser-winhelpa) .

### <a name="removing-the-caption-bar-help-button"></a>Удаление кнопки «Справка» в строке заголовка

Кнопка Справка по строке заголовка отображается по умолчанию, так что контекстно-зависимая справка всегда доступна для кнопок ОК/Отмена/применить. Однако при необходимости эту кнопку можно удалить. Удаление кнопки справки в строке заголовка страницы свойств:

-   Для версий стандартных элементов управления до [версии 5,80](common-control-versions.md)необходимо реализовать [**функцию обратного вызова на странице свойств**](/windows/desktop/api/Prsht/nc-prsht-pfnpropsheetcallback).
-   Для стандартных элементов управления [версии 5,80](common-control-versions.md) и более поздних можно просто установить \_ флаг командном PSH Ноконтексселп в элементе **dwFlags** структуры [**пропшисеадер**](pss-propsheetheader.md) страницы свойств. Однако если требуется обратная совместимость с более ранними версиями элементов управления, необходимо реализовать функцию обратного вызова.

Для реализации функции обратного вызова страницы свойств, которая удаляет кнопку справки в строке заголовка:

-   Установите флаг **командном PSH \_ усекаллбакк** в элементе **dwFlags** структуры [**пропшисеадер**](pss-propsheetheader.md) страницы свойств.
-   Установите элемент **пфнкаллбакк** структуры [**пропшисеадер**](pss-propsheetheader.md) , чтобы он указывал на функцию обратного вызова.
-   Реализуйте функцию обратного вызова. Когда эта функция получает сообщение **о \_ создании пскб** , оно также получит указатель на шаблон диалогового окна страницы свойств. Удалите из этого шаблона стиль **\_ Контексселп для DS** .

В следующем примере показано, как реализовать такую функцию обратного вызова:

```cpp
int CALLBACK RemoveContextHelpProc(HWND hwnd, UINT message, LPARAM lParam)
{
    switch (message) 
    {
    case PSCB_PRECREATE:
        // Remove the DS_CONTEXTHELP style from the
        // dialog box template
        if (((LPDLGTEMPLATEEX)lParam)->signature ==    
           0xFFFF)
           {
            ((LPDLGTEMPLATEEX)lParam)->style 
            &= ~DS_CONTEXTHELP;
        }
        else {
            ((LPDLGTEMPLATE)lParam)->style 
            &= ~DS_CONTEXTHELP;
        }
        return TRUE;
    }
    return TRUE;
}
```

Если структура [**длгтемплатикс**](/windows/desktop/dlgbox/dlgtemplateex) не определена, включите следующее объявление:

```cpp
#include <pshpack1.h>

typedef struct DLGTEMPLATEEX
{
    WORD dlgVer;
    WORD signature;
    DWORD helpID;
    DWORD exStyle;
    DWORD style;
    WORD cDlgItems;
    short x;
    short y;
    short cx;
    short cy;
} DLGTEMPLATEEX, *LPDLGTEMPLATEEX;

#include <poppack.h>
```

## <a name="ok-cancel-and-apply-buttons"></a>Кнопки ОК, отмена и применить

Кнопки **ОК** и **Применить** похожи; как направить страницы свойств для проверки и применения изменений свойств, внесенных пользователем. Единственное отличие заключается в том, что нажатие кнопки **ОК** приводит к уничтожению страницы свойств после применения изменений.

Когда пользователь нажимает кнопку **ОК** или **Применить** , страница свойств отправляет на активную страницу уведомление [PSN \_ киллактиве](psn-killactive.md) , давая ему возможность проверить изменения, внесенные пользователем. Если изменения являются допустимыми, страница должна вызвать функцию [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) с параметром **DWL \_ мсгресулт** , установленным в значение **false**. Если изменения пользователя недопустимы, на странице необходимо установить **DWL \_ Мсгресулт** в **значение true** и отобразить диалоговое окно, информирующее пользователя о проблеме. Страница остается активной до тех пор, пока в ответ на сообщение киллактиве PSN будет задано **значение false** для **\_ мсгресулт DWL** \_ .

После того как страница ответит на уведомление [PSN \_ киллактиве](psn-killactive.md) , установив для **DWL \_ мсгресулт** **значение false**, страница свойств будет отсылать [PSN \_ Применить](psn-apply.md) уведомление к каждой странице. Когда страница получает это уведомление, она должна применить новые свойства к соответствующему элементу. Чтобы указать странице свойств, что изменения действительны для страницы, вызовите [**SetWindowLong**](/windows/desktop/api/winuser/nf-winuser-setwindowlonga) с **DWL \_ мсгресулт** , установленным в **пснрет \_ Error**. Если изменения для этой страницы недопустимы, возвращайте ошибку. Это предотвращает уничтожение страницы свойств и Возврат фокуса на страницу, получивший \_ уведомление о применении PSN, или на страницу, на которой был установлен фокус при нажатии кнопки **Применить** . Чтобы получить сообщение об ошибке и указать, какая страница будет получать фокус, установите для **\_ мсгресулт DWL** одно из следующих значений.

-   **Пснрет \_ НЕДОПУСТИМое**. Страница свойств не будет уничтожена, и на эту страницу будет возвращен фокус.
-   **Пснрет \_ Недопустимый \_ ночанжепаже**. Страница свойств не будет уничтожена, и фокус будет возвращен на страницу, на которую находил фокус при нажатии кнопки.

Приложение может использовать сообщение [**\_ Apply ПСМ**](psm-apply.md) для имитации выбора кнопки **Применить** .

Кнопка **Применить** изначально отключена, когда страница становится активной, что указывает на то, что нет изменений свойств для применения. Когда страница получает входные данные через один из элементов управления, указывая, что пользователь изменил свойство, страница должна отправить сообщение [**ПСМ \_ Changed**](psm-changed.md) на вкладку свойств. Сообщение приводит к включению кнопки **Применить** на странице свойств. Если пользователь в дальнейшем нажмет кнопку " **Применить** " или **"Отмена** ", страница должна повторно инициализировать свои элементы управления, а затем отправить [**ПСМ \_ неизмененное**](psm-unchanged.md) сообщение, чтобы снова отключить кнопку " **Применить** ".

Иногда кнопка **Применить** приводит к изменению страницы свойств, и это изменение нельзя отменить. В этом случае страница должна отправить сообщение [**ПСМ \_ канцелтоклосе**](psm-canceltoclose.md) на страницу свойств. Сообщение заставляет страницу свойств изменить текст кнопки **ОК** на «Close» (закрыть), что означает, что примененные изменения не могут быть отменены.

Иногда страница вносит изменения в конфигурацию системы, которая требует перезапуска Windows или перезагрузки системы, прежде чем изменение вступит в силу. После внесения такого изменения страница должна отправить сообщение [**ПСМ \_ Рестартвиндовс**](psm-restartwindows.md) или [**ПСМ \_ ребутсистем**](psm-rebootsystem.md) на страницу свойств. Эти сообщения приводят к тому, что функция [**Страница свойств**](/windows/desktop/api/Prsht/nf-prsht-propertysheeta) возвращает значение **ID \_ псрестартвиндовс** или **ID \_ псребутсистем** после уничтожения страницы свойств.

Когда пользователь нажимает кнопку **Отмена** , страница свойств отправляет на все страницы код уведомления о [ \_ сбросе PSN](psn-reset.md) , указывая, что страница свойств собирается быть уничтожена. Страница должна использовать уведомление для выполнения операций очистки.

## <a name="wizards"></a>Мастера

Мастер — это особый тип страницы свойств. Мастера предназначены для одновременного представления страниц в последовательности, управляемой приложением. Вместо того чтобы выбирать из группы страниц, щелкая вкладку, пользователи переходят вперед и назад по последовательности, по одной странице за раз, нажав кнопку кнопки. Например, на следующем снимке экрана показана страница приветствия в мастере добавления оборудования:

![снимок экрана со страницей приветствия мастера](images/wizard97.png)

На следующем снимке экрана показана первая страница мастера Aero, новый стиль, появившийся в Windows Vista.

![снимок экрана с первой страницей мастера Aero](images/wizardaero.png)

Подробное описание мастеров см. в разделе [Создание мастеров](wizards.md) .
