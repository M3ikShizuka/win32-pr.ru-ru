---
title: Структура PROPSHEETHEADER (Prsht.h)
description: Определяет фрейм и страницы вкладки свойств.
keywords:
- структура пропшисеадер Windows элементы управления
topic_type:
- apiref
api_name:
- PROPSHEETHEADER
api_location:
- Prsht.h
api_type:
- HeaderDef
ms.topic: reference
ms.date: 02/23/2021
ms.openlocfilehash: 719982c1e17ab74dc5c624352625d226f8f4bef90ae84dce4f2b85d5dc2713f2
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "120085124"
---
# <a name="propsheetheader--structure"></a>Структура ПРОПШИСЕАДЕР

Определяет фрейм и страницы вкладки свойств.

## <a name="syntax"></a>Синтаксис

```cpp
typedef struct {
    DWORD      dwSize;
    DWORD      dwFlags;
    HWND       hwndParent;
    HINSTANCE  hInstance;
    union {
        HICON   hIcon;
        LPCTSTR pszIcon;
    };
    LPCTSTR  pszCaption;
    UINT     nPages;
    union {
        UINT    nStartPage;
        LPCTSTR pStartPage;
    };
    union {
        LPCPROPSHEETPAGE ppsp;
        HPROPSHEETPAGE   *phpage;
    };
    PFNPROPSHEETCALLBACK pfnCallback;
    union {
        HBITMAP hbmWatermark;
        LPCTSTR pszbmWatermark;
    };
    HPALETTE  hplWatermark;
    union {
        HBITMAP hbmHeader;
        LPCSTR  pszbmHeader;
    };
} PROPSHEETHEADER, *LPPROPSHEETHEADER;
```

## <a name="members"></a>Члены

*двсизе* 

Тип: [DWORD](../winprog/windows-data-types.md)

Размер этой структуры в байтах. Диспетчер страниц свойств использует этот элемент для определения версии используемой структуры **пропшисеадер** . Дополнительные сведения см. в разделе «Примечания».

*dwFlags* 

Тип: [DWORD](../winprog/windows-data-types.md)

Флаги, указывающее, какие параметры использовать при создании страницы страницы свойств. Этот элемент может быть сочетанием следующих значений.

| Значение | Значение |
|-------|---------|
| PSH_DEFAULT (0x00000000) | Использует значение по умолчанию для всех членов структуры и создает обычную страницу свойств. Этот флаг имеет нулевое значение и не объединяется с другими флагами. |
| PSH_AEROWIZARD (0x00004000) | [Версия 6,00](common-control-versions.md) и более поздние версии. Создает страницу свойств мастера, которая использует стиль Aero. Также должен быть установлен флаг PSH_WIZARD. Необходимо использовать модель с одним потоком апартамента (STA). |
| PSH_HASHELP (0x00000200) | Разрешает отображение кнопок **справки** на страницах страницы свойств. При создании страницы необходимо также задать флаг PSP_HASHELP в структуре [пропшитпаже](pss-propsheetpage.md) страницы. Если какая-либо из первоначальных страниц свойств включает кнопку **справки** , PSH_HASHELP задается автоматически. Если ни одна из начальных страниц не включает кнопку " **Справка** ", необходимо явно задать PSH_HASHELP, если вы хотите использовать кнопки справки на страницах, которые могут быть добавлены позже. Этот флаг не поддерживается в сочетании с PSH_AEROWIZARD.|
| PSH_HEADER (0x00080000) | [Версия 5,80](common-control-versions.md) и более поздние версии. Указывает, что точечный рисунок заголовка будет использоваться с мастером Wizard97. Необходимо также задать флаг PSH_WIZARD97. Если установлен флаг PSH_USEHBMHEADER, то битовая карта заголовка получается из элемента *хбмхеадер* . В противном случае битовая карта заголовка получается из элемента *псзбмхеадер* . Этот флаг не поддерживается в сочетании с PSH_AEROWIZARD. |
| PSH_HEADERBITMAP (0x08000000) | [Версия 6,00](common-control-versions.md) и более поздние версии. Элемент *псзбмхеадер* задает точечный рисунок, отображаемый в области заголовка. Необходимо использовать в сочетании с PSH_AEROWIZARD. |
| PSH_MODELESS (0x00000400) | Заставляет функцию [Страница свойств](/windows/win32/api/prsht/nf-prsht-propertysheeta) создавать страницу свойств как немодальное диалоговое окно, а не как модальное диалоговое окно. Если этот флаг установлен, [Страница свойств](/windows/win32/api/prsht/nf-prsht-propertysheeta) возвращает сразу после создания диалогового окна, а возвращаемое значение из [Страница свойств](/windows/win32/api/prsht/nf-prsht-propertysheeta) — это обработчик окна для диалогового окна страницы свойств. Этот флаг не поддерживается в сочетании с PSH_AEROWIZARD. |
| PSH_NOAPPLYNOW (0x00000080) | Удаляет кнопку **Применить** . Этот флаг не поддерживается в сочетании с PSH_AEROWIZARD. |
| PSH_NOCONTEXTHELP (0x02000000) | [Версия 5,80](common-control-versions.md) и более поздние версии. Удаляет контекстно-зависимую кнопку справки ("?"), которая обычно находится на панели заголовка страниц свойств. Этот флаг является недопустимым для мастеров. Сведения о том, как удалить кнопку **Справка** в строке заголовка для более ранних версий стандартных элементов управления, см. в статье [о страницах свойств](property-sheets.md) . Этот флаг не поддерживается в сочетании с PSH_AEROWIZARD. |
| PSH_NOMARGIN (0x10000000) | [Версия 6,00](common-control-versions.md) или более поздняя. Указывает, что между страницей и рамкой не вставляются поля. Необходимо использовать в сочетании с PSH_AEROWIZARD. |
| PSH_PROPSHEETPAGE (0x00000008) | Использует элемент *ППСП* и игнорирует элемент *фпаже* при создании страниц для страницы свойств. |
| PSH_PROPTITLE (0x00000001) | Указывает, что *псзкаптион* — это имя объекта, для которого отображаются свойства. Windows выполняет корректировку заголовка, зависящую от версии и языка. Например, на английском языке фраза "свойства для" добавляется в начало непустого *псзкаптион* (и если *псзкаптион* создает пустой заголовок, заголовок — просто "Properties"). Если этот флаг опущен, то Псзкаптион используется без изменений.  |
| PSH_RESIZABLE (0x04000000) | Позволяет пользователю изменять размер мастера. Кнопки развертывания и сворачивания отображаются в рамке мастера, а размер рамки становится изменяемым. Чтобы использовать этот флаг, необходимо также задать PSH_AEROWIZARD. |
| PSH_RTLREADING (0x00000800) | Задает для страницы свойств или окна мастера порядок чтения справа налево, подходящий для таких языков, как иврит и арабский. Если этот флаг не указан, то Windows листа свойств по умолчанию имеет порядок чтения слева направо (LTR), а окна мастера соответствуют порядку чтения текущей страницы. |
| PSH_STRETCHWATERMARK (0x00040000) | Растягивает водяной знак в мастерах Wizard97-стилей. Этот флаг не поддерживается в сочетании с PSH_AEROWIZARD. Этот флаг стиля включается только для обеспечения обратной совместимости определенных приложений. Его использование не рекомендуется, и оно поддерживается только стандартными элементами управления версии 4,0 и 4,01. При использовании стандартных элементов управления версии 5,80 и более поздних этот флаг игнорируется. |
| PSH_USECALLBACK (0x00000100) | Вызывает функцию, указанную параметром *пфнкаллбакк* , при возникновении определенных событий. Дополнительные сведения см. в описании функции обратного вызова [пфнпропшиткаллбакк](/windows/win32/api/prsht/nc-prsht-pfnpropsheetcallback) . |
| PSH_USEHBMHEADER (0x00100000) | [Версия 5,80](common-control-versions.md). Получает битовую карту заголовка из элемента *хбмхеадер* , а не элемента *псзбмхеадер* . Необходимо также установить флаг PSH_AEROWIZARD или PSH_WIZARD97 вместе с флагом PSH_HEADER. |
| PSH_USEHBMWATERMARK (0x00010000) | [Версия 5,80](common-control-versions.md). Получает битовую карту водяного знака из члена *хбмватермарк* , а не элемента *псзбмватермарк* . Необходимо также задать PSH_WIZARD97 и PSH_WATERMARK. Этот флаг не поддерживается в сочетании с PSH_AEROWIZARD. |
| PSH_USEHICON (0x00000002) | Использует *Хикон* в качестве маленького значка в заголовке диалогового окна страницы свойств. |
| PSH_USEHPLWATERMARK (0x00020000) | [Версия 5,80](common-control-versions.md). Использует структуру **хпалетте** , на которую указывает элемент *хплватермарк* , а не палитру по умолчанию для рисования растрового изображения и/или растрового изображения водяного знака для мастера Wizard97. Необходимо также задать PSH_WIZARD97 и PSH_WATERMARK или PSH_HEADER. Этот флаг не поддерживается в сочетании с PSH_AEROWIZARD.  |
| PSH_USEICONID (0x00000004) | Использует *псзикон* в качестве имени ресурса значка для загрузки и использования в качестве маленького значка в заголовке диалогового окна страницы свойств. |
| PSH_USEPAGELANG (0x00200000) | [Версия 5,80](common-control-versions.md). Указывает, что язык для страницы свойств будет взят из ресурса первой страницы. Эта страница должна быть указана идентификатором ресурса. |
| PSH_USEPSTARTPAGE (0x00000040) | Использует элемент *пстартпаже* вместо члена *нстартпаже* при отображении начальной страницы вкладки свойств. |
| PSH_WATERMARK (0x00008000) | [Версия 5,80](common-control-versions.md). Указывает, что растровое изображение водяного знака будет использоваться с мастером Wizard97 на страницах, имеющих стиль PSP_HIDEHEADER. Необходимо также задать флаг PSH_WIZARD97. Битовая карта водяного знака получается от члена *псзбмватермарк* , если не задан параметр PSH_USEHBMWATERMARK. В этом случае битовая карта заголовка получается из элемента *хбмватермарк* . Этот флаг не поддерживается в сочетании с PSH_AEROWIZARD.  |
| PSH_WIZARD (0x00000020) | Создает страницу свойств мастера. При использовании PSH_AEROWIZARD необходимо также установить этот флаг. |
| PSH_WIZARD97 (0x01000000) | [Версия 5,80](common-control-versions.md). Создает страницу свойств в стиле Wizard97, которая поддерживает точечные рисунки в заголовке внутренних страниц и в левой части наружных страниц. Этот флаг не поддерживается в сочетании с PSH_AEROWIZARD. |
| PSH_WIZARDCONTEXTHELP (0x00001000) | Добавляет контекстно-зависимую кнопку **справки** ("?"), которая обычно отсутствует в заголовке мастера. Этот флаг является недопустимым для обычных страниц свойств. Этот флаг не поддерживается в сочетании с PSH_AEROWIZARD. |
| PSH_WIZARDHASFINISH (0x00000010)  | Всегда отображает кнопку **Готово** в мастере. Необходимо также задать либо PSH_WIZARD, PSH_WIZARD97, либо PSH_AEROWIZARD. |
| PSH_WIZARD_LITE (0x00400000) | [Версия 5,80](common-control-versions.md). Использует мастер-Lite. Этот стиль похож на внешний вид для PSH_WIZARD97, но реализуется примерно так же, как PSH_WIZARD. Существует несколько ограничений на форматирование страниц. Например, нет примененных границ, а стиль PSH_WIZARD_LITE не рисует растровые изображения водяного знака и заголовка так, как это Wizard97. Этот флаг не поддерживается в сочетании с PSH_AEROWIZARD. |

*хвндпарент* 

Тип: [HWND](../winprog/windows-data-types.md)

Обработчик для окна владельца вкладки свойств.

*hInstance* 

Тип: [HINSTANCE](../winprog/windows-data-types.md)

Обработчик экземпляра, из которого загружается значок, ресурс строки заголовка, имя начальной страницы, битовая карта заголовка или водяной знак. Если элемент *псзикон*, *псзкаптион*, *пстартпаже*, *псзбмхеадер* или *псзбмватермарк* определяет ресурс для загрузки, необходимо указать этот элемент.

*hIcon* 

Тип: [Хикон](../winprog/windows-data-types.md)

Маркер для значка, который будет использоваться в качестве маленького значка в заголовке диалогового окна страницы свойств. Этот элемент используется, если элемент *dwFlags* включает PSH_USEHICON. Этот член объявляется как объединение с *псзикон*.

*псзикон* 

Тип: [LPCTSTR](../winprog/windows-data-types.md)

Значок ресурса для использования в качестве маленького значка в заголовке диалогового окна страницы свойств. Этот элемент используется, если элемент *dwFlags* включает PSH_USEICONID. Этот элемент может указывать либо идентификатор ресурса значка, либо адрес строки, указывающей имя ресурса значка. В обоих случаях значок загружается из экземпляра, предоставленного элементом *HINSTANCE* . Этот член объявляется как объединение с *Хикон*.

*псзкаптион* 

Тип: [LPCTSTR](../winprog/windows-data-types.md)

Заголовок диалогового окна «Страница свойств». Этот элемент может указывать либо идентификатор строкового ресурса (загруженный из экземпляра, заданного элементом *HINSTANCE* ), либо адрес строки, указывающей заголовок. Если элемент *dwFlags* включает PSH_PROPTITLE, то строковые **свойства для** вставляются в начало заголовка. Это поле игнорируется для мастеров Wizard97. Для мастеров Aero для заголовка используется только строка, независимо от того, установлен ли флаг PSH_PROPTITLE.

*нпажес* 

Тип: [uint](../winprog/windows-data-types.md)

Число страниц страницы свойств, предоставленных в массиве *ППСП* или *фпаже* .

*нстартпаже* 

Тип: [uint](../winprog/windows-data-types.md)

Отсчитываемый от нуля индекс начальной страницы, отображаемой при создании диалогового окна страницы свойств. Этот элемент используется, если элемент *dwFlags* не включает флаг PSH_USEPSTARTPAGE. Этот член объявляется как объединение с *пстартпаже*.

*пстартпаже* 

Тип: [LPCTSTR](../winprog/windows-data-types.md)

Имя начальной страницы, отображаемой при создании диалогового окна «Страница свойств». Этот элемент используется, если элемент *dwFlags* включает флаг PSH_USESTARTPAGE. Этот элемент может указывать либо идентификатор строкового ресурса (загруженный из экземпляра, заданного элементом *HINSTANCE* ), либо адрес строки, указывающей имя. Имя начальной страницы сопоставляется с заголовками страниц. Этот член объявляется как объединение с *нстартпаже*.

*ппсп* 

Тип: **лпкпропшитпаже**

Указатель на массив структур [пропшитпаже](pss-propsheetpage.md) , определяющих страницы в таблице свойств. Если элемент *dwFlags* не содержит PSH_PROPSHEETPAGE, этот элемент игнорируется. Обратите внимание, что структура **пропшитпаже** имеет переменную размер. Приложения, которые анализируют массив, на который указывает *ППСП* , должны учитывать размер каждой страницы. Этот член объявляется как объединение с *фпаже*.

*фпаже* 

Тип: **хпропшитпаже \***

Указатель на массив дескрипторов для страниц таблицы свойств. Этот элемент используется, если элемент *dwFlags* не содержит PSH_PROPSHEETPAGE. Каждый маркер должен быть создан предыдущим вызовом функции [креатепропертишитпаже](/windows/win32/api/prsht/nf-prsht-createpropertysheetpagea) . Когда функция [Страница свойств](/windows/win32/api/prsht/nf-prsht-propertysheeta) возвращает, все дескрипторы хпропшитпаже в массиве *фпаже* будут уничтожены. Этот член объявляется как объединение с *ППСП*.

*пфнкаллбакк* 

Тип: **пфнпропшиткаллбакк**

Указатель на определяемую приложением функцию обратного вызова, которая вызывается при возникновении определенных событий. Дополнительные сведения о функции обратного вызова см. в описании функции обратного вызова [пфнпропшиткаллбакк](/windows/win32/api/prsht/nc-prsht-pfnpropsheetcallback) . Если элемент *dwFlags* не содержит PSH_USECALLBACK, этот элемент игнорируется.

*хбмватермарк* 

Тип: [хбитмап](../winprog/windows-data-types.md)

[Версия 5,80](common-control-versions.md) или более поздняя. Маркер для битовой карты водяного знака. Если элемент *dwFlags* не содержит PSH_USEHBMWATERMARK, этот элемент игнорируется.

*псзбмватермарк* 

Тип: [LPCTSTR](../winprog/windows-data-types.md)

[Версия 5,80](common-control-versions.md) или более поздняя. Ресурс точечного рисунка для использования в качестве водяного знака. Этот элемент может указывать либо идентификатор ресурса точечного рисунка, либо адрес строки, указывающей имя ресурса точечного рисунка. Если элемент *dwFlags* включает PSH_USEHBMWATERMARK, этот элемент игнорируется.

*хплватермарк*

Тип: [хпалетте](../winprog/windows-data-types.md)

[Версия 5,80](common-control-versions.md) или более поздняя. Структура **хпалетте** , используемая для рисования битовой карты и/или битовой карты заголовка. Если элемент *dwFlags* не содержит PSH_USEHPLWATERMARK, этот элемент игнорируется.

*хбмхеадер*

Тип: [хбитмап](../winprog/windows-data-types.md)

[Версия 5,80](common-control-versions.md) или более поздняя. Маркер для битовой карты заголовка. Если элемент *dwFlags* не содержит PSH_USEHBMHEADER, этот элемент игнорируется.

*псзбмхеадер*

Тип: [LPCSTR](../winprog/windows-data-types.md)

[Версия 5,80](common-control-versions.md) или более поздняя. Ресурс точечного рисунка для использования в качестве заголовка. Этот элемент может указывать либо идентификатор ресурса точечного рисунка, либо адрес строки, указывающей имя ресурса точечного рисунка. Если элемент *dwFlags* включает PSH_USEHBMHEADER, этот элемент игнорируется.

## <a name="remarks"></a>Remarks

Если пользователь выбирает параметр, например крупные шрифты, который увеличивает диалоговое окно, то водяной знак, закрашенный на страницах начало и конец, также увеличится. Размер и расположение исходного точечного рисунка останутся прежними. Дополнительная область будет заполнена цветом пикселя в левом верхнем углу точечного рисунка.

Стили PSH_WIZARD, PSH_WIZARD97 и PSH_WIZARD_LITE являются взаимно несовместимыми. Необходимо задать только один из этих флагов стиля. PSH_AEROWIZARD следует сочетать с PSH_WIZARD.

## <a name="requirements"></a>Requirements (Требования)

| Требование | Значение |
|-------------------------------------|------------------------------------------------------------------------------------|
| Минимальная версия клиента | Windows \[Только классические приложения Vista\]                                    |
| Минимальная версия сервера | Windows Только для \[ настольных приложений сервера 2003\]                              |
| Заголовок                   | Пршт. h |
| Имя в кодировке Юникод и ANSI                   | **Пропшисеадерв** (Юникод) и **пропшисеадера** (ANSI) |
