---
title: Общие сведения об элементах управления "поле ввода"
description: В этом разделе представлены элементы управления для форматированного редактирования.
ms.assetid: ab9dcdf4-a311-4159-8f37-e67e144f31f6
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d95f6dc1cc1f37bf604e6c0a891f92cd20bb7af6
ms.sourcegitcommit: ae73f4dd3cf5a3c6a1ea7d191ca32a5b01f6686b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/08/2020
ms.locfileid: "105654387"
---
# <a name="about-rich-edit-controls"></a>Общие сведения об элементах управления "поле ввода"

В этом разделе рассматриваются следующие темы.

-   [Версии расширенного редактирования](#versions-of-rich-edit)
    -   [Расширенное редактирование версии 1,0](#rich-edit-version-10)
    -   [Расширенное редактирование версии 2,0](#rich-edit-version-20)
    -   [Расширенное редактирование версии 3,0](#rich-edit-version-30)
    -   [Расширенное редактирование версии 4,1](#rich-edit-version-41)
-   [Неподдерживаемые функции элемента управления Edit](#unsupported-edit-control-functionality)
-   [Сочетания клавиш для расширенного редактирования](#rich-edit-shortcut-keys)
-   [См. также](#related-topics)

## <a name="versions-of-rich-edit"></a>Версии расширенного редактирования

Первоначальной спецификацией для элементов управления расширенного редактирования является Microsoft Rich Edit 1,0; Текущая спецификация — Microsoft Rich Edit 4,1. Каждая версия расширенного редактирования — это надмножество предыдущей версии, за исключением того, что только азиатские сборки Microsoft Rich Edit 1,0 имеют вертикальный текстовый параметр. Перед созданием элемента управления Rich Edit необходимо вызвать функцию [**LoadLibrary**](/windows/desktop/api/libloaderapi/nf-libloaderapi-loadlibrarya) , чтобы проверить, какая версия Microsoft Rich Edit установлена.

В следующей таблице показано, какая библиотека DLL соответствует версии расширенного редактирования. Обратите внимание, что имя файла не изменилось с версии 2,0 до версии 3,0. Это позволяет обновить версию 2,0 до версии 3,0 без разрушения существующего кода.



| Расширенная версия редактирования | DLL          | Класс окна    |
|-------------------|--------------|-----------------|
| 1.0               | Riched32.dll | \_класс RichEdit |
| 2.0               | Riched20.dll | \_класс RichEdit |
| 3.0               | Riched20.dll | \_класс RichEdit |
| 4.1               | Msftedit.dll | \_класс мсфтедит |



 

### <a name="rich-edit-version-10"></a>Расширенное редактирование версии 1,0

Microsoft Rich Editing 1,0 включает следующие функции.



|                                                                                    |                                                                                                                                                                                                                                                                                           |
|------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Ввод текста и выбор                                                           | В основном это стандартный (элемент управления системного ввода) и запись текста. Поддержка панели выбора (панель выбора представляет собой непомеченную область слева от каждого абзаца, который по щелчку мыши выделяет линию). Параметры переноса по словам и автоматического выбора слов. Выбор одного, двойного и тройного щелчка. |
| Редактирование в ANSI (однобайтовой кодировке (SBCS) и многобайтовой кодировке (MBCS)) | Однако редактирование в Юникоде отсутствует.                                                                                                                                                                                                                                                     |
| Базовый набор свойств форматирования символов и абзацев                             | См. раздел [**чарформат**](/windows/win32/api/richedit/ns-richedit-charformata) и [**Format**](/windows/desktop/api/Richedit/ns-richedit-paraformat).                                                                                                                                                                                                                |
| Свойства форматирования символов                                                    | Имя и размер шрифта, полужирный, курсив, сплошное подчеркивание, Зачеркнутый, защищенный, компоновка, смещение и цвет текста.                                                                                                                                                                                   |
| Свойства форматирования абзаца                                                    | Начальный отступ, отступ справа, последующее смещение строки, маркер, выравнивание (слева, по центру, справа) и вкладки.                                                                                                                                                                                    |
| Найти вперед                                                                       | Включает параметры, не учитывающие регистр, и слова match-ALL-Word.                                                                                                                                                                                                                                   |
| Интерфейс на основе сообщений                                                            | Почти является надмножеством набора сообщений системы управления редактированием и двумя интерфейсами, [**иричедитоле**](/windows/desktop/api/Richole/nn-richole-iricheditole) и [**иричедитолекаллбакк**](/windows/desktop/api/Richole/nn-richole-iricheditolecallback).                                                                                                              |
| Внедренные объекты                                                                   | Требуется совместная работа клиента на основе интерфейсов [**иричедитоле**](/windows/desktop/api/Richole/nn-richole-iricheditole) и [**иричедитолекаллбакк**](/windows/desktop/api/Richole/nn-richole-iricheditolecallback) .                                                                                                                                          |
| Поддержка меню правой кнопки                                                          | Использует интерфейс [**иричедитолекаллбакк**](/windows/desktop/api/Richole/nn-richole-iricheditolecallback) .                                                                                                                                                                                                                      |
| Редактирование при перетаскивании                                                              | Редактирование с поддержкой перетаскивания поддерживается.                                                                                                                                                                                                                                                       |
| Уведомления                                                                      | [**WM \_ КОМАНДные**](/windows/desktop/menurc/wm-command) сообщения, отправленные клиенту, и другие. Это надмножество общих уведомлений об управлении.                                                                                                                                                 |
| Однократная Отмена или повтор                                                             | Ведет себя аналогично элементу управления "изменение системы". Если выбрать **отменить** , Последнее действие будет отменено, а это действие станет новым действием **повторить** .                                                                                                                                          |
| Простой вертикальный текст                                                               | (Только для азиатских сборок).                                                                                                                                                                                                                                                                      |
| Поддержка редактора методов ввода (IME)                                                  | (Только для азиатских сборок).                                                                                                                                                                                                                                                                      |
| Редактирование WYSIWYG с использованием метрик принтера                                              | Эта функция необходима для Microsoft WordPad, в частности.                                                                                                                                                                                                                              |
| Вырезание, копирование, вставка, потоковая передача и потоковая передача                                                  | С обычным текстом **( \_ текстом CF**) или форматированным текстом (RTF) с объектами и без них.                                                                                                                                                                                                        |
| База кода C                                                                        | Код написан на языке C, который обеспечивает надежную и гибкую основу.                                                                                                                                                                                                                |
| Разные сборки для различных сценариев                                             | Microsoft Rich Editing 1,0 устраняет проблемы локализации с разными сборками.                                                                                                                                                                                                              |



 

### <a name="rich-edit-version-20"></a>Расширенное редактирование версии 2,0

Microsoft Rich Editing 2,0 включил несколько дополнительных функций, таких как поддержка Юникода и азиатских языков, многоуровневые операции отмены, интерфейсы модели COM и многочисленные улучшения пользовательского интерфейса.

Microsoft Rich Edit 2,0 включает в себя следующие функции в дополнение к функциям, предоставляемым [Microsoft Rich edit 1,0](#rich-edit-version-10).



|                                               |                                                                                                                                                                                                                                                                                                                                                                                      |
|-----------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Юникод                                       | Юникод упрощает обработку международного текста. Однако требуется обеспечить совместимость с существующими документами не в Юникоде, т. е. возможность преобразования в обычный и форматированный текст не в Юникоде.                                                                                                                                                             |
| Общая Многоязыковая поддержка                 | Общий алгоритм разбиения строк (расширение правил кинсоку), простое связывание шрифтов, переключение шрифтов клавиатуры.                                                                                                                                                                                                                                                                          |
| Поддержка восточно-азиатских языков                                 | В редакторов IME поддерживается уровень 2 (диалоговое окно) и 3 (встроенные).                                                                                                                                                                                                                                                                                                                            |
| Поддержка поиска и поиска                     | Поддерживается поиск в прямом и обратном направлении.                                                                                                                                                                                                                                                                                                                                         |
| Поддержка двунаправленного письма                         | Он входит в состав Microsoft Rich Edit 2,1                                                                                                                                                                                                                                                                                                                                          |
| Многоуровневые откаты                               | Расширяемая архитектура отмены позволяет клиенту участвовать в модели отмены на уровне приложения.                                                                                                                                                                                                                                                                                         |
| Поддержка мыши мажеллан                        | Это мышь с роликом для прокрутки.                                                                                                                                                                                                                                                                                                                                       |
| Поддержка двойных шрифтов                             | Клавиатура может автоматически переключать шрифты, если активный шрифт не подходит для текущей клавиатуры, например символы кандзи в Times New Roman.                                                                                                                                                                                                                            |
| Применяется смарт-шрифт                              | Запрос на изменение шрифта не применяет западных шрифтов к азиатским символам.                                                                                                                                                                                                                                                                                                                |
| Улучшенное отображение                              | Растровое изображение на экране используется, если в одной строке встречается несколько шрифтов. Это позволяет, например, отключать последнюю букву слова "круто".                                                                                                                                                                                                                           |
| Поддержка прозрачности                          | Также в режиме без окон.                                                                                                                                                                                                                                                                                                                                                             |
| Цвета выбора системы                       | Используется для выбора текста.                                                                                                                                                                                                                                                                                                                                                             |
| Автоматическое распознавание URL-адресов                     | Может проверять наличие нескольких форматов URL-адресов (например, http:)                                                                                                                                                                                                                                                                                                                           |
| Изменение совместимости пользовательского интерфейса Microsoft Word          | Выделение, семантика курсорной панели.                                                                                                                                                                                                                                                                                                                                                  |
| Word Standard потенциал                             | Знак конца абзаца (CR) также может поддерживать возврат каретки/перевод строки (CR/LF) (возврат каретки, перевод строки).                                                                                                                                                                                                                                                                       |
| Обычный текст, а также функциональные возможности расширенного текста | Односимвольный формат и формат одного абзаца.                                                                                                                                                                                                                                                                                                                                 |
| Однострочные и многострочные элементы управления            | Усечение в первом конце абзаца без переноса слов.                                                                                                                                                                                                                                                                                                                                  |
| Сочетания клавиш                              | Поддерживаются сочетания клавиш.                                                                                                                                                                                                                                                                                                                                                      |
| Стиль окна пароля                         | Элементы управления "изменение пароля" предоставляются через [**EM \_ Жетпассвордчар**](em-getpasswordchar.md) и [**EM \_ сетпассвордчар**](em-setpasswordchar.md).                                                                                                                                                                                                                                 |
| Масштабируемая архитектура                         | Для уменьшения размера экземпляра.                                                                                                                                                                                                                                                                                                                                                             |
| Операции и интерфейсы без окон           | Это обеспечивается через интерфейсы [**итекссост**](/windows/desktop/api/Textserv/nl-textserv-itexthost) и [**итекстсервицес**](/windows/desktop/api/Textserv/nl-textserv-itextservices) .                                                                                                                                                                                                                                                                   |
| Сдвоенные интерфейсы COM                           | Интерфейсы модели текстовых объектов (TOM).                                                                                                                                                                                                                                                                                                                                                  |
| CHARFORMAT2                                   | Добавлен вес шрифта, цвет фона, код локали, тип подчеркивания, надстрочный и подстрочный индекс (в дополнение к смещению), отключенный. Для переносе только RTF добавлен объем пространства между буквами, размер твипов, над которым будет раскернинг пар символов, анимированный текст, различные эффекты: тень или контур шрифта, все прописные, малые прописные, скрытые, выступающие, отпечатке и пересмотренные. |
| PARAFORMAT2                                   | Добавлен пробел до и после и пробелы в строке слова. Только для переносе RTF, добавлен вес и стиль заливки, Начало нумерации/стиль/вкладка, пространство границ, ширина и стороны, выравнивание или заливку вкладок, различные эффекты абзаца Word: абзац RTL, сохранение, сохранение-после разрыва страницы, не обрывать, без висячих прав, без раздельных расстановки.                                         |
| Дополнительные RTF переносе                        | Все свойства Word Форматфонт и Форматпараграф.                                                                                                                                                                                                                                                                                                                           |
| Стабильность и стабилизации кода              | Примеры: Проверка параметров и объектов, инварианты функций, условия повторного входа, объект стабилизации.                                                                                                                                                                                                                                                                             |
| Надежная инфраструктура тестирования                 | Включая сложные тесты регрессии.                                                                                                                                                                                                                                                                                                                                               |
| повышение производительности.                          | Меньший рабочий набор, Ускоренная загрузка и повторное отображение и т. д.                                                                                                                                                                                                                                                                                                                     |
| База кода C++                                 | Код написан на языке C++, который обеспечивает надежную основу для создания Microsoft Rich Edit 3,0.                                                                                                                                                                                                                                                                             |



 

За некоторыми исключениями Microsoft Rich Editing 2,0 использует те же функции, структуры и сообщения, что и Microsoft Rich Edit 1,0. Однако обратите внимание на следующие отличия.

-   Имя класса окна Microsoft Rich Edit 1,0 — **RichEdit**. Microsoft Rich Editing 2,0 содержит классы окон ANSI и Unicode **RichEdit20A** и **RichEdit20W** соответственно. Чтобы указать соответствующий класс расширенного окна редактирования, используйте \_ константу класса RichEdit, которую определяет файл RichEdit. h в зависимости от определения флага компиляции Юникода.
-   В Microsoft Rich Edit 2,0 при создании элемента управления Rich Edit в Юникоде (который предполагает текстовые сообщения в Юникоде) необходимо указать только данные в Юникоде в сообщениях окон, отправляемых в элемент управления. Аналогичным образом, если вы создаете элемент управления Rich Edit в формате ANSI, отправляйте только данные ANSI или двухбайтовые кодировки (DBCS). Функцию [**исвиндовуникоде**](/windows/desktop/api/winuser/nf-winuser-iswindowunicode) можно использовать, чтобы определить, использует ли форматируемый элемент управления "поле ввода" текстовые сообщения в Юникоде. Обратите внимание, что интерфейсы COM с богатыми возможностями редактирования используют текст в Юникоде, если не встречаются аргументы кодовой страницы.
-   Microsoft Rich Editing 1,0 использует сочетания символов CR/LF для маркеров абзаца. В Microsoft Rich Edit 2,0 используется только символ возврата каретки (" \\ r"). Microsoft Rich Editing 3,0 использует только символ возврата каретки, но может эмулировать Microsoft Rich Edit 1,0 в этом отношении.
-   В Microsoft Rich Editing 2,0 появились следующие новые сообщения. 

    | Сообщение                                           | Описание                                                             |
    |---------------------------------------------------|-------------------------------------------------------------------------|
    | [**EM \_ аутаурлдетект**](em-autourldetect.md)     | Включает или отключает автоматическое обнаружение URL-адресов.                            |
    | [**EM \_ канредо**](em-canredo.md)                 | Определяет, существуют ли какие либо действия в очереди повторов.             |
    | [**EM \_ жетимекомпмоде**](em-getimecompmode.md)   | Извлекает текущий режим редактора метода ввода (IME).                   |
    | [**EM \_ жетлангоптионс**](em-getlangoptions.md)   | Получает параметры для поддержки IME и восточно-азиатского языка.                   |
    | [**EM \_ жетредонаме**](em-getredoname.md)         | Возвращает имя типа следующего действия в очереди повтора.           |
    | [**EM \_ жеттекстмоде**](em-gettextmode.md)         | Получает текстовый режим или уровень отмены.                                  |
    | [**EM \_ жетундонаме**](em-getundoname.md)         | Возвращает имя типа следующего действия в очереди отмены.           |
    | [**\_Повтор EM**](em-redo.md)                       | Повторно выполняет следующее действие в очереди повтора.                               |
    | [**EM \_ сетлангоптионс**](em-setlangoptions.md)   | Задает параметры для поддержки IME и восточно-азиатского языка.                        |
    | [**EM \_ сеттекстмоде**](em-settextmode.md)         | Задает текстовый режим или уровень отмены.                                       |
    | [**EM \_ сетундолимит**](em-setundolimit.md)       | Задает максимальное число действий в очереди отмены.                   |
    | [**EM \_ стопграуптипинг**](em-stopgrouptyping.md) | Останавливает группировку последовательных действий ввода в текущее действие отмены. |

    

     

-   В Microsoft Rich Edit 2,0 появились следующие новые структуры. 

    | Структура                          | Описание                                      |
    |------------------------------------|--------------------------------------------------|
    | [**CHARFORMAT2**](/windows/desktop/api/Richedit/ns-richedit-charformat2a) | Содержит сведения о форматировании символов. |
    | [**PARAFORMAT2**](/windows/desktop/api/Richedit/ns-richedit-paraformat2) | Содержит сведения о форматировании абзацев. |

    

     

-   Следующие сообщения поддерживаются только в версиях Microsoft Rich Edit 1,0 для азиатских языков. Они не поддерживаются в более поздних версиях расширенного редактирования.

    [**EM \_ конвпоситион**](em-convposition.md)

    [**EM \_ жетимеколор**](em-getimecolor.md)

    [**EM \_ жетимеоптионс**](em-getimeoptions.md)

    [**\_знаки EM**](em-getpunctuation.md)

    [**EM \_ жетвордврапмоде**](em-getwordwrapmode.md)

    [**EM \_ сетимеколор**](em-setimecolor.md)

    [**EM \_ сетимеоптионс**](em-setimeoptions.md)

    [**EM \_ сетпунктуатион**](em-setpunctuation.md)

    [**EM \_ сетвордврапмоде**](em-setwordwrapmode.md)

### <a name="rich-edit-version-30"></a>Расширенное редактирование версии 3,0

Microsoft Rich Edit 3,0 — это единая, масштабируемая библиотека DLL, которая обеспечивает высокую производительность и совместимость с Word в небольших пакетах. Новые функции Microsoft Rich Edit 3,0 содержат более широкие возможности текста, масштабирования, привязки шрифтов, более мощную поддержку IME и расширенную поддержку сложных скриптов (двунаправленная, Индийская и тайская).

Microsoft Rich Edit 3,0 включает в себя следующие функции в дополнение к функциям, предоставляемым с помощью [расширенного редактирования версии 2,0](#rich-edit-version-20).



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td>Масштабирование</td>
<td>Коэффициент масштабирования задается соотношением.</td>
</tr>
<tr class="even">
<td>Нумерация абзацев (один уровень)</td>
<td>Числовые, верхние и нижние алфавитные или римские цифры.</td>
</tr>
<tr class="odd">
<td>Простые таблицы</td>
<td>Удаление и вставка строк возможны, но не изменяют размер и не упаковываются внутри ячеек. Если включено расширенное Оформление (см. <a href="em-gettypographyoptions.md"><strong>EM_GETTYPOGRAPHYOPTIONS</strong></a>), Microsoft Rich Edit 3,0 может выровнять столбцы по центру или по правому краю и включить десятичные знаки. Ячейки моделируются символами табуляции, поэтому текстовые вкладки и возвраты каретки заменяются пробелами.</td>
</tr>
<tr class="even">
<td>Стили обычных и заголовков</td>
<td>Встроенные в стандартный стиль и стили заголовков с 1 по 9 поддерживаются интерфейсами <a href="em-setparaformat.md"><strong>EM_SETPARAFORMAT</strong></a> и <a href="text-object-model.md">объектной модели текста</a> (Tom).</td>
</tr>
<tr class="odd">
<td>Другие типы подчеркивания</td>
<td>Добавлен Пунктирный штрих, тире, тире, точка и точка.</td>
</tr>
<tr class="even">
<td>Цвет подчеркивания</td>
<td>Подчеркнутый текст можно пометить одним из 15 вариантов документа для подчеркивания цветом.</td>
</tr>
<tr class="odd">
<td>Скрытый текст</td>
<td>Помечено атрибутом CHARFORMAT2. Удобно для переносе (запись в файл, который был считан в) сведения, которые обычно не должны отображаться.</td>
</tr>
<tr class="even">
<td>Дополнительные горячие клавиши по умолчанию</td>
<td>Эти горячие клавиши функционируют так же, как и в Word. Например, неработающие клавиши с неживыми диакритическими знаками (только клавиатуры США). Клавиша "число" — горячая клавиша (CTRL + L) — доступно несколько вариантов нумерации, начиная с маркера.</td>
</tr>
<tr class="odd">
<td>Хекстауникоде IME</td>
<td>Позволяет пользователю выполнять преобразование между шестнадцатеричными и Юникод с помощью горячих клавиш.</td>
</tr>
<tr class="even">
<td>Парные кавычки</td>
<td>Эта функция включается и отключается нажатием клавиш CTRL + ALT + "для клавиатур США.</td>
</tr>
<tr class="odd">
<td>Мягкие переносы</td>
<td>Для обычного текста используйте 0xAD. Для RTF используйте \- .</td>
</tr>
<tr class="even">
<td>Курсор с курсивом</td>
<td>Кроме того, при использовании URL-адресов курсор мыши принимает форму руки.</td>
</tr>
<tr class="odd">
<td>Расширенный типографский параметр</td>
<td>Microsoft Rich Editing 3,0 может использовать расширенный типографский режим для разбиения строк и вывода (см. <a href="em-gettypographyoptions.md"><strong>EM_GETTYPOGRAPHYOPTIONS</strong></a>). Этот элегантный вариант был добавлен в первую очередь для упрощения обработки сложных сценариев (двунаправленных, индийских и тайских). Кроме того, для простых сценариев возникает ряд усовершенствований. Примеры:
<ul>
<li>Табуляция, справа, десятичные знаки</li>
<li>Полностью выровненный текст</li>
<li>Усреднение по подчеркиванием, которое обеспечивает единообразное подчеркивание, даже если у смежного текста разный размер шрифта.</li>
</ul></td>
</tr>
<tr class="even">
<td> Поддержка сложных систем письма</td>
<td>Microsoft Rich Edit 3,0 поддерживает двунаправленный (текст с арабскими и (или) Ивритми, смешанными с другими сценариями), индийские (индийские сценарии, такие как блок) и тайский текст. Для поддержки этих сложных наборов символов используются дополнительные типографские и Uniscribe компоненты.</td>
</tr>
<tr class="odd">
<td>Привязка шрифта</td>
<td>Microsoft Rich Editing 3,0 автоматически выбирает подходящий шрифт для символов, которые четко не принадлежат к текущей метке набора символов. Это делается путем назначения наборов символов для выполнения текста и связывания шрифтов с этими кодировками. Дополнительные сведения см. в разделе <a href="using-rich-edit-controls.md">Привязка шрифта</a>.</td>
</tr>
<tr class="even">
<td>Параметры чтения и записи обычного текста, характерные для наборов символов</td>
<td>Это позволяет считывать файл с помощью одного набора символов и писать с другим набором символов.</td>
</tr>
<tr class="odd">
<td>RTF UTF-8</td>
<td>Это рекомендуется делать для операций вырезания, копирования и вставления. Этот формат файлов более компактен, чем обычный RTF, быстрее и совместим с Юникодом.</td>
</tr>
<tr class="even">
<td>Поддержка IME Microsoft Office 9 (IME98)</td>
<td>Эта более мощная возможность IME была разделена на независимый модуль. Доступны следующие функции:
<ul>
<li>Повторное преобразование в более ранних версиях пользователю требовалось сначала удалить последнюю строку, а затем ввести новую строку, чтобы получить правильный кандидат. Эта новая функция позволяет пользователю преобразовать окончательную строку обратно в режим композиции, тем самым позволяя легко выбрать другую строку-кандидат.<br/></li>
<li>Веб-канал документа эта функция предоставляет IME98 текст для текущего абзаца, что помогает IME98 выполнять более точное преобразование во время ввода.<br/></li>
<li>Операция мыши. Эта функция обеспечивает лучший контроль над окнами-кандидатом и пользовательским интерфейсом во время ввода.<br/></li>
<li>Позиции курсора. Эта функция предоставляет текущие сведения о курсоре и строке, которые IME98 использует для позиционирования окон пользовательского интерфейса (например, список кандидатов).<br/></li>
</ul></td>
</tr>
<tr class="odd">
<td>Поддержка активного диспетчера методов ввода (IMM)</td>
<td>Пользователи могут вызвать активный объект IMM, который позволяет пользователям вводить азиатские символы в системах США.</td>
</tr>
<tr class="even">
<td>Поддержка Хекстауникоде</td>
<td>Пользователи могут выполнять преобразование между шестнадцатеричной нотацией и Юникодом с помощью горячих клавиш.</td>
</tr>
<tr class="odd">
<td>Дополнительные RTF переносе</td>
<td>Текст RTF, который считывается из файла, будет записан без изменений.</td>
</tr>
<tr class="even">
<td>Улучшенный режим совместимости 1,0</td>
<td>Microsoft Rich Edit 3,0 может эмулировать поведение Microsoft Rich Edit 1,0. Например, можно изменить между многобайтовой и сопоставленной позицией Юникода (CP).</td>
</tr>
<tr class="odd">
<td>Повышенный контроль закрепления</td>
<td>Отображение может быть заморожено для нескольких вызовов API, а затем не зафиксировано для вывода обновлений.</td>
</tr>
<tr class="even">
<td>Увеличенный контроль отмены</td>
<td>Отмена может быть приостановлена и возобновлена (требование IME).</td>
</tr>
<tr class="odd">
<td>Увеличить или уменьшить размер шрифта</td>
<td>Увеличивает или уменьшает размер шрифта до одного из шести стандартных значений (12, 28, 36, 48, 72 и 80 точек).</td>
</tr>
</tbody>
</table>



 

### <a name="rich-edit-version-41"></a>Расширенное редактирование версии 4,1

Класс Window для Microsoft Rich Edit 4,1 является \_ классом мсфтедит. Новые возможности Microsoft Rich Edit 4,1 включают поддержку переносов, поворота страниц и поддержки платформы текстовых служб (TSF).

Microsoft Rich Edit 4,1 включает в себя следующие функции в дополнение к функциям, предоставляемым с помощью [расширенного редактирования версии 3,0](#rich-edit-version-30).



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="odd">
<td>Расстановка переносов</td>
<td>Расстановка переносов поддерживается следующими API: <a href="/windows/desktop/api/Richedit/nf-richedit-hyphenateproc"><em>хифенатепрок</em></a>, <a href="em-sethyphenateinfo.md"><strong>EM_SETHYPHENATEINFO</strong></a>и <a href="em-gethyphenateinfo.md"><strong>EM_GETHYPHENATEINFO</strong></a>.</td>
</tr>
<tr class="even">
<td>Поворот страницы</td>
<td>Макет с направлением сверху вниз и снизу вверх поддерживается с помощью <a href="em-setpagerotate.md"><strong>EM_SETPAGEROTATE</strong></a> и <a href="em-getpagerotate.md"><strong>EM_GETPAGEROTATE</strong></a>.</td>
</tr>
<tr class="odd">
<td>Поддержка платформы текстовых служб</td>
<td><ul>
<li>Чтобы включить TSF и некоторые функции TSF, используйте следующие стили в <a href="em-seteditstyle.md"><strong>EM_SETEDITSTYLE</strong></a>: SES_USECTF, SES_CTFALLOWEMBED, SES_CTFALLOWPROOFING и SES_CTFALLOWSMARTTAG.</li>
<li>Чтобы установить и получить смещение режима TSF, используйте <a href="em-setctfmodebias.md"><strong>EM_SETCTFMODEBIAS</strong></a> и <a href="em-getctfmodebias.md"><strong>EM_GETCTFMODEBIAS</strong></a>.</li>
<li>Чтобы установить и получить состояние клавиатуры TSF, используйте <a href="em-setctfopenstatus.md"><strong>EM_SETCTFOPENSTATUS</strong></a> и <a href="em-getctfopenstatus.md"><strong>EM_GETCTFOPENSTATUS</strong></a>.</li>
</ul></td>
</tr>
<tr class="even">
<td>Дополнительная поддержка IME</td>
<td><ul>
<li>Чтобы установить и получить смещение режима IME, используйте <a href="em-setimemodebias.md"><strong>EM_SETIMEMODEBIAS</strong></a> и <a href="em-getimemodebias.md"><strong>EM_GETIMEMODEBIAS</strong></a>.</li>
<li>Чтобы получить свойства и возможности редактора IME, используйте <a href="em-getimeproperty.md"><strong>EM_GETIMEPROPERTY</strong></a>.</li>
<li>Чтобы получить текст композиции редактора IME, используйте <a href="em-getimecomptext.md"><strong>EM_GETIMECOMPTEXT</strong></a>.</li>
<li>Чтобы определить, является ли языковой стандарт восточно-азиатским языком, используйте <a href="em-isime.md"><strong>EM_ISIME</strong></a>.</li>
</ul></td>
</tr>
<tr class="odd">
<td>Дополнительные параметры <a href="em-seteditstyle.md"><strong>EM_SETEDITSTYLE</strong></a></td>
<td>Помимо параметров TSF, существуют новые параметры, которые исключают редакторы IME, устанавливают направление двунаправленного текста, используют шрифты драфтмоде и многое другое.</td>
</tr>
<tr class="even">
<td>Дополнительные параметры <a href="em-setcharformat.md"><strong>EM_SETCHARFORMAT</strong></a></td>
<td>Новые флаги позволяют клиенту задавать шрифт и размеры шрифтов по умолчанию для данного кода языка или кодировки, устанавливать шрифт по умолчанию для элемента управления, чтобы не переключаться с клавиатуры для соответствия шрифту и т. д.</td>
</tr>
<tr class="odd">
<td>Запрещение ввода в текст ANSI</td>
<td>Использование <a href="/windows/win32/api/richedit/ne-richedit-textmode"><strong>TM_SINGLECODEPAGE</strong></a> в <a href="em-settextmode.md"><strong>EM_SETTEXTMODE</strong></a> не приводит к вводу форматированного элемента управления в Юникоде.</td>
</tr>
<tr class="even">
<td>Уведомление о неподдерживаемом ключевом слове RTF</td>
<td><a href="en-lowfirtf.md">EN_LOWFIRTF</a> предупреждает приложение при наличии неподдерживаемого ключевого слова RTF.</td>
</tr>
<tr class="odd">
<td>Поддержка дополнительных возможностей языка</td>
<td>К дополнительным языкам относятся армянский, Дивехи, телугу и другие.</td>
</tr>
<tr class="even">
<td>Улучшенная поддержка таблиц</td>
<td>К функциям относятся: перенос внутри ячеек, улучшенная обработка через RTF и Улучшенная навигация.</td>
</tr>
<tr class="odd">
<td>ES_VERTICAL</td>
<td>Поддерживается стиль окна <a href="rich-edit-control-styles.md"><strong>ES_VERTICAL</strong></a> .</td>
</tr>
<tr class="even">
<td>Поддержка <a href="/windows/desktop/inputdev/wm-unichar"><strong>WM_UNICHAR</strong></a></td>
<td>Для отправки или публикации символов Юникода в окнах ANSI используйте <a href="/windows/desktop/inputdev/wm-unichar"><strong>WM_UNICHAR</strong></a>. Он эквивалентен <a href="/windows/desktop/inputdev/wm-char"><strong>WM_CHAR</strong></a>, но использует (UTF)-32.</td>
</tr>
</tbody>
</table>



 

## <a name="unsupported-edit-control-functionality"></a>Неподдерживаемые функции элемента управления Edit

Элементы управления Rich Edit поддерживают большинство функций, но не все функции для элементов управления многострочного редактирования. В этом разделе перечислены управляющие сообщения и стили окон редактирования, которые *не* поддерживаются элементами управления Rich Edit.

Следующие сообщения обрабатываются элементами управления Edit, но *не* элементами управления Rich Edit.



| Неподдерживаемое сообщение                         | Комментарии                                                                                                                    |
|---------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------|
| [**EM \_ фмтлинес**](em-fmtlines.md)         | Не поддерживается.                                                                                                              |
| [**EM \_**](em-gethandle.md)       | Элементы управления Rich Edit не хранят текст как простой массив символов.                                                       |
| [**EM \_ жетиместатус**](em-getimestatus.md) | Не поддерживается.                                                                                                              |
| [**длинные \_ поля EM**](em-getmargins.md)     | Не поддерживается.                                                                                                              |
| [**EM \_ сесандле**](em-sethandle.md)       | Элементы управления Rich Edit не хранят текст как простой массив символов.                                                       |
| [**EM \_ сетиместатус**](em-setimestatus.md) | Не поддерживается.                                                                                                              |
| [**EM \_ сетмаргинс**](em-setmargins.md)     | Поддерживается в Microsoft Rich Edit 3,0.                                                                                       |
| [**EM \_ сетректнп**](em-setrectnp.md)       | Не поддерживается.                                                                                                              |
| [**EM \_ сеттабстопс**](em-settabstops.md)   | Вместо этого используется сообщение [**EM \_ сетпараформат**](em-setparaformat.md) . Поддерживается в Microsoft Rich Edit 3,0.<br/> |
| [**WM \_ ктлколор**](/windows/desktop/DevNotes/wm-ctlcolor-)    | Вместо этого используется сообщение [**EM \_ сетбкгндколор**](em-setbkgndcolor.md) .                                                  |
| [**WM, \_ Шрифт**](/windows/desktop/winmsg/wm-getfont)        | Вместо этого используется сообщение [**EM \_ жетчарформат**](em-getcharformat.md) .                                                  |



 

Следующие стили окон используются с многострочными элементами управления для редактирования, но не с широкими элементами управления редактированием: [**\_ строчные буквы ES**](edit-control-styles.md), [**\_ прописные буквы**](edit-control-styles.md)ES и [**ES \_ оемконверт**](edit-control-styles.md).

## <a name="rich-edit-shortcut-keys"></a>Сочетания клавиш для расширенного редактирования

Элементы управления Rich Edit поддерживают следующие сочетания клавиш.



| Ключи                      | Operations                                                                                                                               | Комментарии                                                                                                                                                                                                                       |
|---------------------------|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Shift + Backspace           | Создание ЛРМ/ЛРМ на двунаправленной клавиатуре                                                                                                    | Конкретное BiDi                                                                                                                                                                                                                  |
| CTRL+TAB                  | Вкладка                                                                                                                                      |                                                                                                                                                                                                                                |
| Ctrl + Clear                | Выбрать все                                                                                                                               |                                                                                                                                                                                                                                |
| Ctrl + номерная панель 5         | Выбрать все                                                                                                                               |                                                                                                                                                                                                                                |
| CTRL+A                    | Выбрать все                                                                                                                               |                                                                                                                                                                                                                                |
| Ctrl+E                    | Выравнивание по центру                                                                                                                         |                                                                                                                                                                                                                                |
| CTRL+J                    | Выравнивание по ширине                                                                                                                        |                                                                                                                                                                                                                                |
| CTRL+R                    | Выравнивание по правому краю                                                                                                                          |                                                                                                                                                                                                                                |
| Ctrl+L                    | Выравнивание по левому краю                                                                                                                           |                                                                                                                                                                                                                                |
| CTRL+C                    | Копировать                                                                                                                                     |                                                                                                                                                                                                                                |
| CTRL+V                    | Вставить                                                                                                                                    |                                                                                                                                                                                                                                |
| CTRL+X                    | Вырезать                                                                                                                                      |                                                                                                                                                                                                                                |
| CTRL+Z                    | Отменить                                                                                                                                     |                                                                                                                                                                                                                                |
| CTRL+Y                    | Повторить                                                                                                                                     |                                                                                                                                                                                                                                |
| CTRL + ' + ' (Ctrl + Shift + ' = ') | Надстрочный                                                                                                                              |                                                                                                                                                                                                                                |
| CTRL + ' = '                  | Подстрочный                                                                                                                                |                                                                                                                                                                                                                                |
| CTRL+1                    | Междустрочный зазор = 1 строка.                                                                                                                   |                                                                                                                                                                                                                                |
| Ctrl+2                    | Междустрочный зазор = 2 строки.                                                                                                                  |                                                                                                                                                                                                                                |
| Ctrl+5                    | Междустрочный зазор = 1,5 строк.                                                                                                                |                                                                                                                                                                                                                                |
| CTRL + ' (апостроф)       | Диакритические знаки                                                                                                                             | После нажатия клавиши короткой вырезанной клавиши нажмите соответствующую букву (например, a, e или u). Это относится только к английским, французским, немецким, итальянским и испанским клавиатурам.                                                         |
| Ctrl + \` (грависом)           | Знак ударения                                                                                                                             | См. раздел "Комментарии" в разделе CTRL + '.                                                                                                                                                                                                           |
| Ctrl + ~ (тильда)            | Знак тильды                                                                                                                             | См. раздел "Комментарии" в разделе CTRL + '.                                                                                                                                                                                                           |
| Ctrl +; заканчивается        | Акцент умляут                                                                                                                            | См. раздел "Комментарии" в разделе CTRL + '.                                                                                                                                                                                                           |
| Ctrl + Shift + 6              | Знак ударения (с циркумфлексом)                                                                                                                | См. раздел "Комментарии" в разделе CTRL + '.                                                                                                                                                                                                           |
| CTRL +, (запятая)            | Акцент с седилью                                                                                                                           | См. раздел "Комментарии" в разделе CTRL + '.                                                                                                                                                                                                           |
| Ctrl + Shift + ' (апостроф) | Активировать парные кавычки                                                                                                                    |                                                                                                                                                                                                                                |
| Отмена                 | Если текст защищен, звук не удаляется. В противном случае удалите предыдущий символ.                                                   |                                                                                                                                                                                                                                |
| Ctrl+Backspace            | Удалить предыдущее слово. При этом создается \_ код F16 VK.                                                                                     |                                                                                                                                                                                                                                |
| F16                       | То же, что и BACKSPACE.                                                                                                                       |                                                                                                                                                                                                                                |
| Ctrl+Insert               | Копировать                                                                                                                                     |                                                                                                                                                                                                                                |
| SHIFT+INSERT              | Вставить                                                                                                                                    |                                                                                                                                                                                                                                |
| Вставить                    | Overwrite                                                                                                                                | DBCS не перезаписывается.                                                                                                                                                                                                       |
| Ctrl+СТРЕЛКА ВЛЕВО           | Переместить курсор на одно слово влево.                                                                                                        | На двунаправленной клавиатуре это зависит от направления текста.                                                                                                                                                                   |
| Ctrl+СТРЕЛКА ВПРАВО          | Переместить курсор на одно слово вправо.                                                                                                       | См. раздел сочетания клавиш CTRL + стрелка влево.                                                                                                                                                                                                  |
| Ctrl + сдвиг влево           | Выравнивание по левому краю                                                                                                                           | В документах с двунаправленным письмом это порядок чтения слева направо.                                                                                                                                                                    |
| Ctrl + сдвиг вправо          | Выравнивание по правому краю                                                                                                                          | В документах с двунаправленным письмом это порядок чтения справа налево.                                                                                                                                                                    |
| Ctrl+СТРЕЛКА ВВЕРХ             | Перейти к строке выше.                                                                                                                  |                                                                                                                                                                                                                                |
| Ctrl+СТРЕЛКА ВНИЗ           | Перейти к строке ниже.                                                                                                                  |                                                                                                                                                                                                                                |
| CTRL+HOME                 | Перейти в начало документа.                                                                                                   |                                                                                                                                                                                                                                |
| CTRL+END                  | Переход к концу документа                                                                                                         |                                                                                                                                                                                                                                |
| Ctrl + Page Up              | Переместить на одну страницу вверх.                                                                                                                        | Если в Системедитмоде и однострочном элементе управления, ничего делать не нужно.                                                                                                                                                                      |
| Ctrl + Page Down            | Переместить одну страницу вниз.                                                                                                                      | См. раздел Ctrl + Page Up Comments.                                                                                                                                                                                                     |
| Ctrl+Delete               | Удаление следующего слова или выбранных символов.                                                                                             |                                                                                                                                                                                                                                |
| Shift+Delete              | Вырезание выделенных символов.                                                                                                             |                                                                                                                                                                                                                                |
| ESC                       | Прерывать перетаскивание.                                                                                                                          | При выполнении перетаскивания текста.                                                                                                                                                                                               |
| Alt + Esc                   | Изменение активного приложения.                                                                                                           |                                                                                                                                                                                                                                |
| ALT+X                     | Преобразует шестнадцатеричное значение Юникода перед точкой вставки в соответствующий символ Юникода.                             |                                                                                                                                                                                                                                |
| ALT + SHIFT + X               | Преобразует символ Юникода перед точкой вставки в соответствующее шестнадцатеричное значение Юникода.                             |                                                                                                                                                                                                                                |
| Alt + 0XXX (панель чисел)     | Вставляет значения Юникода, если XXX больше 255. Если значение XXX меньше 256, то АСЦИ диапазон текста вставляется на основе текущей клавиатуры. | Необходимо ввести десятичные значения.                                                                                                                                                                                                     |
| Alt + Shift + Ctrl + F12        | Шестнадцатеричное значение для Юникода.                                                                                                                          | В случае, если Alt + X уже используется для другого использования.                                                                                                                                                                                |
| Alt + Shift + Ctrl + F11        | Выбранный текст будет выведен в окно отладчика и сохранен в% Temp% \\DumpFontInfo.txt.                                               | Только для отладки (необходимо установить флаг = 8 в Win.ini)                                                                                                                                                                                 |
| CTRL+SHIFT+A              | Установите все прописные.                                                                                                                            |                                                                                                                                                                                                                                |
| CTRL+SHIFT+L              | Стиль маркера подправлять.                                                                                                                     |                                                                                                                                                                                                                                |
| Ctrl+Shift+СТРЕЛКА ВПРАВО    | Увеличение размера шрифта.                                                                                                                      | Размер шрифта изменяется на 1 точку в диапазоне 4PT-11pt; по 2points для 12pt-28pt; он изменяется из 28pt-> 36pt-> 48pt-> 72pt-> 80pt; он изменяется на 10 точек в диапазоне 80pt-1630pt; Максимальное значение — 1638. |
| Ctrl+Shift+СТРЕЛКА ВЛЕВО     | Уменьшить размер шрифта.                                                                                                                      | См. раздел сочетания клавиш Ctrl + Shift + стрелка вправо.                                                                                                                                                                                           |



 

## <a name="related-topics"></a>См. также

<dl> <dt>

**Зрения**
</dt> <dt>

[Использование элементов управления Rich Edit](using-rich-edit-controls.md)
</dt> <dt>

[Безоконное редактирование элементов управления](windowless-rich-edit-controls.md)
</dt> </dl>

