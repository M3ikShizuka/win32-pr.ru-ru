---
title: Об элементах управления анимацией
description: Элемент управления "анимация" — это окно, в котором отображается изображение Audio-Video с чередованием (AVI). Ролик AVI — это ряд кадров точечного рисунка, например фильм. Элементы управления "анимация" могут отображать только AVI, не содержащие звук.
ms.assetid: 6be69d1a-5b2c-41d5-b6d7-e86ddac2cb0d
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 57a2a579334fe266499884ccf40ad1154b3465ffd301c92643f248ff2664ed4a
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119921794"
---
# <a name="about-animation-controls"></a>Об элементах управления анимацией

*Элемент управления "анимация* " — это окно, в котором отображается изображение Audio-Video с чередованием (AVI). Ролик AVI — это ряд кадров точечного рисунка, например фильм. Элементы управления "анимация" могут отображать только AVI, не содержащие звук.

Одним из распространенных способов использования элемента управления анимации является указание активности системы во время длительной операции. Это возможно потому, что поток операций продолжит выполнение во время отображения AVI-клипа. например, диалоговое окно поиск в Windows Explorer отображает движущийся увеличительное стекло по мере того, как система осуществляет поиск файла.

> [!Note]  
> Если используется ComCtl32.dll версии 6, поток не поддерживается. Убедитесь, что приложение не блокирует пользовательский интерфейс, иначе анимация не будет выполняться.

 

Элемент управления "анимация" может отображать ролик AVI, исходящий из несжатого AVI-файла, или из AVI-файла, который был сжат с помощью кодирования длины выполнения (BI \_ RLE8). Можно добавить ролик AVI в приложение в виде AVI-ресурса, или клип может сопровождать ваше приложение как отдельный файл AVI.

> [!Note]  
> Файл AVI или Resource не должен иметь звуковой канал. Возможности элемента управления анимации очень ограничены и могут изменяться. Если требуется элемент управления для обеспечения возможности воспроизведения и записи мультимедийных файлов для приложения, можно использовать элемент управления МЦивнд. Дополнительные сведения см. в разделе [класс окна мЦивнд](/windows/desktop/Multimedia/mciwnd-window-class).

 

В этом разделе рассматриваются следующие темы.

-   [Создание элемента управления анимацией](#animation-control-creation)
-   [Об управляющих сообщениях анимации](#about-animation-control-messages)
-   [Обработка сообщений по умолчанию](#default-message-processing)

## <a name="animation-control-creation"></a>Создание элемента управления анимацией

Элемент управления "анимация" принадлежит классу окна " [**анимировать \_ класс**](common-control-window-classes.md) ". Элемент управления анимации создается с помощью функции [**CreateWindow**](/windows/desktop/api/winuser/nf-winuser-createwindowa) или [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) или макроса [**анимации \_ CREATE**](/windows/desktop/api/Commctrl/nf-commctrl-animate_create) . Макрос располагает анимированный элемент управления в левом верхнем углу родительского окна и, если не указан стиль [**\_ центра ACS**](animation-control-styles.md) , устанавливает ширину и высоту элемента управления на основе размеров кадра в ролике AVI. Если **указан \_ центр ACS** , команда **анимировать \_ CREATE** устанавливает ширину и высоту элемента управления равными нулю. Для задания расположения и размера элемента управления можно использовать функцию [**SetWindowPos**](/windows/desktop/api/winuser/nf-winuser-setwindowpos) .

При создании элемента управления "анимация" в диалоговом окне или в ресурсе диалогового окна элемент управления автоматически уничтожается, когда пользователь закрывает диалоговое окно. При создании элемента управления анимации в окне необходимо явным образом уничтожить элемент управления.

## <a name="about-animation-control-messages"></a>Об управляющих сообщениях анимации

Приложение отправляет сообщения в элемент управления "анимация", чтобы открывать, воспроизводить, прекращать и закрывать соответствующий ролик. Каждое сообщение содержит один или несколько макросов, которые можно использовать вместо отправки сообщения явным образом.

После создания элемента управления анимацией приложение отправляет сообщение [**ACM \_ Open**](acm-open.md) , чтобы открыть ролик AVI и загрузить его в память. В сообщении указывается путь к файлу AVI или имя ресурса AVI. Система загружает ресурс AVI из модуля, который создал элемент управления Animation.

Если элемент управления анимации имеет стиль [**\_ автозапуска ACS**](animation-control-styles.md) , элемент управления начинает воспроизводить ролик AVI сразу после открытия файла AVI или AVI. В противном случае приложение может использовать сообщение [**ACM \_ Play**](acm-play.md) для запуска клипа AVI. Приложение может прерывать работу клипа в любое время, отправляя сообщение об ошибке [**ACM \_**](acm-stop.md) . Последний кадр остается отображенным, когда элемент управления завершает воспроизведение AVI-клипа или **когда \_ отправляется ACM** .

Элемент управления "анимация" может отправить два кода уведомления в родительское окно: [АКН \_ Start](acn-start.md) and [АКН \_ останавливаться](acn-stop.md). Большинство приложений не обрабатывает ни одно уведомление.

Чтобы закрыть файл AVI или AVI и удалить его из памяти, приложение может использовать макрос [**анимации «анимировать» \_**](/windows/desktop/api/Commctrl/nf-commctrl-animate_close) , который отправляет [**ACM \_ Open**](acm-open.md) с именем файла или именем ресурса, установленным в **null**.

## <a name="default-message-processing"></a>Обработка сообщений по умолчанию

В этом разделе описываются сообщения окна, обрабатываемые процедурой окна для класса окна [**анимировать \_ класс**](common-control-window-classes.md) .



| Message                                    | Обработка выполнена                                                                                                                                                                                                                                                                        |
|--------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**\_Закрыть WM**](/windows/desktop/winmsg/wm-close)           | Освобождает файл AVI или AVI, связанный с элементом управления анимации.                                                                                                                                                                                                                   |
| [**WM \_ destroy**](/windows/desktop/winmsg/wm-destroy)       | Освобождает файл AVI или AVI, освобождает внутреннюю структуру данных, а затем вызывает функцию [**дефвиндовпрок**](/windows/desktop/api/winuser/nf-winuser-defwindowproca) .                                                                                                                                                |
| [**WM \_ ерасебкгнд**](/windows/desktop/winmsg/wm-erasebkgnd) | Стирает фон окна, используя текущий цвет фона для статических элементов управления.                                                                                                                                                                                                        |
| [**WM \_ нккреате**](/windows/desktop/winmsg/wm-nccreate)     | Выделяет и инициализирует внутреннюю структуру данных, а затем вызывает [**дефвиндовпрок**](/windows/desktop/api/winuser/nf-winuser-defwindowproca).                                                                                                                                                                              |
| [**WM \_ нчиттест**](/windows/desktop/inputdev/wm-nchittest) | Возвращает значение проверки попадания ХТТРАНСПАРЕНТ.                                                                                                                                                                                                                                                   |
| [**WM \_ Paint**](/windows/desktop/gdi/wm-paint)              | Рисует рамку AVI в элементе управления Animation.                                                                                                                                                                                                                                                |
| [**\_Размер WM**](/windows/desktop/winmsg/wm-size)             | Проверяет, имеет ли элемент управления [**стиль \_ центра ACS**](animation-control-styles.md) . Если элемент управления не имеет значение, он вызывает [**дефвиндовпрок**](/windows/desktop/api/winuser/nf-winuser-defwindowproca). В противном случае он выравнивает анимацию в элементе управления, делает элемент управления недействительным, а затем вызывает **дефвиндовпрок**. |



 

 

 