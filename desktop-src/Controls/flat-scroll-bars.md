---
title: Плоские полосы прокрутки
description: В Microsoft Internet Explorer 4,0 появилась новая визуальная технология, называемая плоскими полосами прокрутки.
ms.assetid: f7e00e71-bf12-4db9-bb84-6d413b967049
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 07fbbdb64aa9815cb56f5dc3bf55ffb17390db38
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "103793993"
---
# <a name="flat-scroll-bars"></a>Плоские полосы прокрутки

В Microsoft Internet Explorer 4,0 появилась новая визуальная технология, называемая плоскими полосами прокрутки. Функционально плоские полосы прокрутки ведут себя так же, как стандартные полосы прокрутки. Разница заключается в том, что их внешний вид можно изменить на более высокий, чем стандартные полосы прокрутки.

На следующем рисунке показано окно, содержащее плоскую полосу прокрутки.

![снимок экрана окна, содержащего плоскую полосу прокрутки](images/flatsb.jpg)

> [!Note]  
> Неструктурированные полосы прокрутки поддерживаются Comctl32.dll версиями 4,71 – 5,82. Comctl32.dll версии 6,00 и более поздних не поддерживают плоские полосы прокрутки.

 

## <a name="using-flat-scroll-bars"></a>Использование плоских полос прокрутки

В этом разделе описывается, как реализовать плоские полосы прокрутки в приложении.

### <a name="before-you-begin"></a>Перед началом

Чтобы использовать функции плоской полосы прокрутки, необходимо включить Коммктрл. h в исходные файлы и связать с Comctl32. lib.

### <a name="adding-flat-scroll-bars-to-a-window"></a>Добавление плоских полос прокрутки в окно

Чтобы добавить плоские полосы прокрутки в окно, вызовите [**инитиализефлатсб**](/windows/desktop/api/Commctrl/nf-commctrl-initializeflatsb), передав в окно маркер. Вместо использования стандартных функций полосы прокрутки для работы с полосами прокрутки необходимо использовать эквивалентную \_ функцию флатсб XXX. Существуют плоские функции полосы прокрутки для установки и получения данных прокрутки, диапазона и расположения. Если для окна не инициализированы плоские полосы прокрутки, API плоской полосы прокрутки будет откладываться на соответствующие стандартные функции, если они используются. Это позволяет включать и отключать плоские полосы прокрутки без написания условного кода.

Так как приложение может установить пользовательские метрики для плоских полос прокрутки, они не обновляются автоматически при изменении системных метрик. При изменении метрик полосы прокрутки системы сообщение [**WM \_ сеттингчанже**](/windows/desktop/winmsg/wm-settingchange) пересылается с параметром *wParam* , установленным в значение [**SPI \_ сетнонклиентметрикс**](/windows/desktop/api/winuser/nf-winuser-systemparametersinfoa). Чтобы обновить плоские полосы прокрутки до новых системных метрик, приложения должны выполнить обработку этого сообщения и явно изменить свойства, зависящие от метрики плоской полосы прокрутки.

Чтобы обновить свойства полосы прокрутки, используйте [**флатсб \_ сетскроллпроп**](/windows/desktop/api/Commctrl/nf-commctrl-flatsb_setscrollprop). Следующий фрагмент кода изменяет свойства, зависящие от метрики плоской полосы прокрутки, на текущие системные значения.


```
void FlatSB_UpdateMetrics(HWND hWnd)
{
FlatSB_SetScrollProp(hWnd, WSB_PROP_CXVSCROLL, GetSystemMetrics(SM_CXVSCROLL), FALSE);
FlatSB_SetScrollProp(hWnd, WSB_PROP_CXHSCROLL, GetSystemMetrics(SM_CXHSCROLL), FALSE);
FlatSB_SetScrollProp(hWnd, WSB_PROP_CYVSCROLL, GetSystemMetrics(SM_CYVSCROLL), FALSE);
FlatSB_SetScrollProp(hWnd, WSB_PROP_CYHSCROLL, GetSystemMetrics(SM_CYHSCROLL), FALSE);
FlatSB_SetScrollProp(hWnd, WSB_PROP_CXHTHUMB, GetSystemMetrics(SM_CXHTHUMB), FALSE);
FlatSB_SetScrollProp(hWnd, WSB_PROP_CYVTHUMB, GetSystemMetrics(SM_CYVTHUMB), TRUE);
}
```



### <a name="enhancing-flat-scroll-bars"></a>Улучшение плоских полос прокрутки

[**Флатсб \_ Сетскроллпроп**](/windows/desktop/api/Commctrl/nf-commctrl-flatsb_setscrollprop) позволяет изменять плоские полосы прокрутки для настройки вида окна. Для вертикальных полос прокрутки можно изменить ширину полосы и высоту стрелок направления. Для горизонтальных полос прокрутки можно изменить высоту линейки и ширину стрелок направления. Также можно изменить цвет фона как для горизонтальной, так и для вертикальной полос прокрутки.

[**Флатсб \_ Сетскроллпроп**](/windows/desktop/api/Commctrl/nf-commctrl-flatsb_setscrollprop) также позволяет настроить отображение плоских полос прокрутки. Изменив свойства WSB \_ prop \_ ВСТИЛЕ и WSB \_ prop \_ хстиле, можно задать тип полосы прокрутки, который будет использоваться. Доступны три стиля.



|                    |                                                                                                                                                                          |
|--------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| \_режим ENCARTA для шины \_ | Отображается стандартная плоская полоса прокрутки. Когда указатель мыши перемещается над кнопкой направления или бегунком, эта часть полосы прокрутки будет отображаться в трехмерном виде.             |
| \_плоский \_ режим системной шины    | Отображается стандартная плоская полоса прокрутки. Когда указатель мыши перемещается над кнопкой направления или бегунком, эта часть полосы прокрутки будет отображаться в инвертированных цветах. |
| \_обычный \_ режим системной шины | Отображается обычная, неплоская полоса прокрутки. Специальные визуальные эффекты не применяются.                                                                                    |



 

### <a name="removing-flat-scroll-bars"></a>Удаление плоских полос прокрутки

Если вы хотите удалить плоские полосы прокрутки из окна, вызовите функцию [**унинитиализефлатсб**](/windows/desktop/api/Commctrl/nf-commctrl-uninitializeflatsb) , передав маркер в окно. Эта функция удаляет плоские полосы прокрутки из окна во время выполнения. Вам не нужно вызывать эту функцию при уничтожении окна.

 

 