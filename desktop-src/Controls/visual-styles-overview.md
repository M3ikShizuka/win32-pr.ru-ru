---
title: Общие сведения о визуальных стилях
description: В этом разделе описываются стили оформления и определяются компоненты Windows, которые их поддерживают. Здесь также объясняются действия, которые необходимо выполнить для использования стилей оформления в приложениях.
ms.assetid: 5B5D7BB6-684F-478D-BF5F-B8D18BBCFF2E
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 5663730c752fbf16c4f229a031eafa0c65bb9dbb
ms.sourcegitcommit: a716ca2a6a22a400f02c6b31699cf4da83ee3619
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/04/2020
ms.locfileid: "104488559"
---
# <a name="visual-styles-overview"></a>Общие сведения о визуальных стилях

В этом разделе описываются стили оформления и определяются компоненты Windows, которые их поддерживают. Здесь также объясняются действия, которые необходимо выполнить для использования стилей оформления в приложениях. Этот раздел включает следующие подразделы:

-   [Темы и визуальные стили](#themes-and-visual-styles)
-   [Компоненты визуальных стилей](#visual-styles-components)
-   [Требования к приложениям для поддержки визуальных стилей](#application-requirements-for-supporting-visual-styles)
-   [См. также](#related-topics)

## <a name="themes-and-visual-styles"></a>Темы и визуальные стили

В состав Windows входит несколько функций, позволяющих пользователям настраивать пользовательский интерфейс в соответствии с индивидуальными потребностями и предпочтениями. Эти функции включают темы, появившиеся в Microsoft Plus!. для Windows 95. Тема — это Выбираемая пользователем коллекция параметров, включающая фоновый рисунок, курсоры, шрифты, звуки и значки. Ниже приведены некоторые характеристики тем.

-   Параметры темы указываются в файлах Theme, имеющих формат, аналогичный win.ini файлам.
-   Независимый поставщик программного обеспечения (ISV) может создать и распространить файл Theme с помощью продукта.
-   В версиях, предшествующих Windows Vista, файлы темы отображаются на вкладке тема панели управления. В Windows Vista и более поздних версиях темы отображаются на панели управления персонализацией.

Дополнительные сведения о файлах Theme см. в разделе [Формат файла темы](themesfileformat-overview.md).

Визуальный стиль — это спецификация, определяющая внешний вид стандартных элементов управления Windows. Визуальные стили связаны с темами; то есть файл Theme содержит раздел, в котором указывается визуальный стиль, применяемый при активной теме. Ниже приведены некоторые характеристики визуальных стилей.

-   Пользователи могут изменить визуальный стиль в любое время, выбрав другую тему.
-   Необходимо использовать API визуальных стилей, чтобы применить текущий активный визуальный стиль к пользовательским элементам управления или рисуемым владельцем приложения, если таковые имеются.
-   Сведения, определяющие визуальный стиль, хранятся в мсстилес-файле. Корпорация Майкрософт не поддерживает создание мсстилес файлов.


На следующем рисунке показано простое диалоговое окно с панелью задач на рабочем столе Windows 7, использующей тему Windows Aero без прозрачности. Так как приложение не настроено для использования стилей оформления, кнопки отображаются одинаково независимо от параметров темы.

![снимок экрана с диалоговым окном с кнопками, которые не используют прозрачность](images/tb-wostyles.png)

На следующем рисунке показано одно и то же диалоговое окно на том же рабочем столе, но на этот раз приложение настроено для работы с визуальными стилями. Обратите внимание на различные внешний вид кнопок в клиентской области. Кнопки выглядят иначе, поскольку система применяет визуальные стили, определенные в теме Aero.

![снимок экрана с диалоговым окном с кнопками, использующими прозрачность](images/tb-withstyles.png)

В следующем примере показано аналогичное диалоговое окно на рабочем столе Windows 8. В Windows 8 стили оформления всегда включены, поэтому приложения Windows 8 получают их «бесплатно».

![снимок экрана простого диалогового окна на рабочем столе Windows 8](images/tb-win8.png)

## <a name="visual-styles-components"></a>Компоненты визуальных стилей

Стили оформления поддерживаются следующими компонентами:

-   Версия 6 или более поздняя версия библиотеки общих элементов управления (ComCtl32.dll)
-   API визуальных стилей, реализованный в UxTheme.dll
-   Служба "темы"
-   Один или несколько файлов определения стиля оформления (. мсстилес)

API визуальных стилей зависит от системной службы, именуемой темами. Общая библиотека элементов управления запрашивает у службы "темы" получение сведений о стиле и, вплоть до Windows 7, использует службу для отрисовки элементов управления в текущем визуальном стиле.

В Windows 8 и более поздних версиях API визуальных стилей по-прежнему работает, если служба "темы" отключена. Это означает, что стандартные элементы управления и неклиентская область Windows по-прежнему будут иметь стили оформления, если служба "темы" отключена. Компоненты Windows 8, которые по-прежнему нуждаются в службе "темы", включают:

-   Изменение стиля оформления, обычно через страницу **персонализации** **параметров ПК**.
-   Оптимизация производительности, связанная с переключением пользователей, выходом из системы, завершением работы и обменом данными между пользовательскими сеансами.

API визуальных стилей получает сведения о стиле из файла мсстилес, связанного с текущей выбранной темой. Файл. мсстилес содержит набор метрик, шрифтов, цветов и точечных рисунков, определяющих визуальный стиль.

## <a name="application-requirements-for-supporting-visual-styles"></a>Требования к приложениям для поддержки визуальных стилей

Чтобы использовать стили оформления, приложение должно работать под управлением операционной системы, содержащей ComCtl32.dll версии 6 или более поздней. Если вы хотите, чтобы приложение использовало ComCtl32.dll версии 6, необходимо добавить манифест приложения или директиву компилятора, чтобы указать, что следует использовать версию 6, если она доступна. Сведения о создании манифеста приложения, позволяющего использовать стили оформления в приложении, см. в разделе [Включение визуальных стилей](cookbook-overview.md).

Для стандартных элементов управления никаких дополнительных действий не требуется, чтобы обеспечить отображение элементов управления в предпочитаемом визуальном стиле пользователя.

Если приложение содержит настраиваемые или рисуемые пользователем элементы управления, необходимо использовать API визуальных стилей для получения сведений о текущем активном визуальном стиле, а также для рисования элементов управления в этом стиле.

Для версий Windows, предшествовавших Windows 8, приложениям, как правило, необходимо предоставить два отдельных пути кода для рисования пользовательских и рисуемых пользователем элементов управления. Один путь к коду рисует элементы управления, когда тема, использующая стили оформления, активна, а другой путь к коду рисует элементы управления, когда активна классическая тема Windows или тема с высокой контрастностью. Однако в Windows 8 визуальные стили всегда включены, поэтому Разделяйте пути кода не нужны. Приложения, которые обрабатываются для Windows 8, получают высокую контрастность в "бесплатно". Дополнительные сведения см. в разделе [Поддержка тем высокая контрастность](supporting-high-contrast-themes.md).

Дополнительные сведения о см. в разделе [Использование стилей оформления с пользовательскими и Owner-Drawn элементами управления](using-visual-styles.md) и [справочником по визуальным стилям](uxctl-ref.md).

## <a name="related-topics"></a>См. также

<dl> <dt>

[Стили оформления](themes-overview.md)
</dt> </dl>

 

 




