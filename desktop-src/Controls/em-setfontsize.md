---
title: Сообщение EM_SETFONTSIZE (RichEdit. h)
description: Задает размер шрифта для выделенного текста в элементе управления Rich Edit.
ms.assetid: 18d91370-12c0-4e5f-a0e9-ffde02abc966
keywords:
- Элементы управления Windows для EM_SETFONTSIZE сообщений
topic_type:
- apiref
api_name:
- EM_SETFONTSIZE
api_location:
- Richedit.h
api_type:
- HeaderDef
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: 8eb75276acbb86cbd452a8ad97698f1cd7382bd2
ms.sourcegitcommit: a1494c819bc5200050696e66057f1020f5b142cb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2020
ms.locfileid: "104490722"
---
# <a name="em_setfontsize-message"></a>\_Сообщение СЕТФОНТСИЗЕ EM

Задает размер шрифта для выделенного текста в элементе управления Rich Edit.

## <a name="parameters"></a>Параметры

<dl> <dt>

*wParam* 
</dt> <dd>

Изменить размер выделенного текста в пунктах. Результат будет округлен в соответствии со значениями, приведенными в следующей таблице. Этот параметр должен находиться в диапазоне от-1637 до 1638. Итоговый размер шрифта будет в диапазоне от 1 до 1638.

</dd> <dt>

*lParam* 
</dt> <dd>

Этот параметр не используется; оно должно быть равно нулю.

</dd> </dl>

## <a name="return-value"></a>Возвращаемое значение

Если ошибка не возникла, возвращается значение **true**.

Если произошла ошибка, возвращается значение **false**.

## <a name="remarks"></a>Комментарии

Размер шрифта можно легко получить, отправив сообщение [**EM \_ жетчарформат**](em-getcharformat.md) .

Расширенное редактирование сначала добавляет параметр *wParam* к текущему размеру шрифта, а затем использует полученный размер и следующую таблицу для определения значения округления.



| Строки    | Значение округления |
|---------|----------------|
| <= 12 | 1              |
| 28      | 2              |
| 36      | 0              |
| 48      | 0              |
| 72      | 0              |
| 80      | 0              |
| > 80 | 10             |



 

Если итоговый размер шрифта не делится равномерно на величину округления, то размер шрифта округляется до числа, равномерно кратного значению округления. Поэтому, если размер шрифта меньше или равен 12, значение округления будет равно 1. Аналогично, если размер шрифта меньше или равен 28, то значение округления равно 2. Для значений, превышающих 28, размеры шрифтов округляются до следующей полосы. Таким образом, размер шрифта переходит к 36, 48, 72, 80. После 80 все округления выполняется с шагом в десять точек.

Размер шрифта округляется вверх или вниз в зависимости от знака параметра *wParam*. Если параметр *wParam* имеет положительное значение, округление всегда вверх. В противном случае округление всегда не работает. Таким образом, если текущий размер шрифта равен 10, а параметр *wParam* имеет значение 3, то итоговый размер шрифта будет равен 14 (10 + 3 = 13, что не делится на 2, поэтому размер округляется до 14). И наоборот, если текущий размер шрифта равен 14, а параметр *wParam* имеет значение-3, то итоговый размер шрифта будет равен 10 (14-3 = 11, который не делится на 2, поэтому размер округляется до 10).

Изменение применяется к каждой части выделения. Таким образом, если часть текста имеет значение 10 пт и некоторые до пунктов, после вызова с параметром *wParam* , равным 1, размеры шрифта становятся 11pt и 22pt соответственно.

Дополнительные примеры приведены в следующей таблице.



| Исходный размер шрифта | *wParam* | Итоговый размер шрифта |
|--------------------|----------|---------------------|
| 7                  | 1        | 8                   |
| 7                  | 3        | 10                  |
| 10                 | 3        | 14                  |
| 14                 | –3       | 10                  |
| 28                 | 1        | 36                  |
| 28                 | 3        | 36                  |
| 80                 | 1        | 90                  |
| 80                 | -1       | 72                  |



 

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|---------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Только для \[ классических приложений Windows Vista\]<br/>                                        |
| Минимальная версия сервера<br/> | \[Только для настольных приложений Windows Server 2003\]<br/>                                  |
| Распространяемые компоненты<br/>          | Расширенное редактирование 3,0<br/>                                                              |
| Header<br/>                   | <dl> <dt>RichEdit. h</dt> </dl> |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

**Ссылки**
</dt> <dt>

[**EM \_ жетчарформат**](em-getcharformat.md)
</dt> <dt>

[**CHARFORMAT2**](/windows/desktop/api/Richedit/ns-richedit-charformat2a)
</dt> <dt>

**Зрения**
</dt> <dt>

[Общие сведения об элементах управления "поле ввода"](about-rich-edit-controls.md)
</dt> </dl>

 

 





