---
title: Структура ПРОПШИТПАЖЕ (Пршт. h)
description: Определяет страницу в таблице свойств.
keywords:
- Элементы управления Windows структуры ПРОПШИТПАЖЕ
topic_type:
- apiref
api_name:
- PROPSHEETPAGE
api_location:
- Prsht.h
api_type:
- HeaderDef
ms.topic: reference
ms.date: 02/23/2021
ms.openlocfilehash: cdde3f27900c7599b33af706d8fac9f9e8127b6f
ms.sourcegitcommit: 11f52354f570aacaf1ba2a266b2e507abd73352a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/19/2021
ms.locfileid: "105720993"
---
# <a name="propsheetpage-structure"></a>Структура ПРОПШИТПАЖЕ

Определяет страницу в таблице свойств.

## <a name="syntax"></a>Синтаксис

```cpp
typedef struct {
    DWORD      dwSize;
    DWORD      dwFlags;
    HINSTANCE  hInstance;
    union {
        LPCSTR                 pszTemplate;
        PROPSHEETPAGE_RESOURCE pResource;
    };
    union {
        HICON  hIcon;
        LPCSTR pszIcon;
    };
    LPCSTR          pszTitle;
    DLGPROC         pfnDlgProc;
    LPARAM          lParam;
    LPFNPSPCALLBACK pfnCallback;
    UINT            *pcRefParent;
    LPCTSTR         pszHeaderTitle;
    LPCTSTR         pszHeaderSubTitle;
    HANDLE          hActCtx;
    union 
    {
        HBITMAP     hbmHeader;
        LPCSTR      pszbmHeader;
    }
} PROPSHEETPAGE, *LPPROPSHEETPAGE;
```

## <a name="members"></a>Члены

*двсизе* 

Тип: [DWORD](../winprog/windows-data-types.md)

Размер этой структуры в байтах.

*dwFlags* 

Тип: [DWORD](../winprog/windows-data-types.md)

Флаги, указывающее, какие параметры использовать при создании страницы страницы свойств. Этот элемент может быть сочетанием следующих значений.

| Значение | Значение |
|-------|---------|
| PSP_DEFAULT | Использует значение по умолчанию для всех элементов структуры. Этот флаг не поддерживается при использовании мастера стилей Aero ([PSH_AEROWIZARD](pss-propsheetheader.md)). |
| PSP_DLGINDIRECT | Создает страницу из шаблона диалогового окна в памяти, на который указывает элемент с *помощью элемента.* Функция [Страница свойств](/windows/win32/api/prsht/nf-prsht-propertysheeta) предполагает, что шаблон, наполагающийся в памяти, не защищен от записи. Шаблон только для чтения вызовет исключение в некоторых версиях Windows. |
| PSP_HASHELP | Включает кнопку **справки** на странице свойств, когда страница активна. Этот флаг не поддерживается при использовании мастера стилей Aero ([PSH_AEROWIZARD](pss-propsheetheader.md)). |
| PSP_HIDEHEADER | [Версия 5,80](common-control-versions.md) и более поздние версии. Заставляет страницу свойств мастера скрывать область заголовка при выборе страницы. Если водяной знак был предоставлен, он будет закрашен в левой части страницы. Этот флаг должен быть установлен для страниц приветствия и завершения и опущен для внутренних страниц. Этот флаг не поддерживается при использовании мастера стилей Aero ([PSH_AEROWIZARD](pss-propsheetheader.md)). |
| PSP_PREMATURE | [Версия 4,71](common-control-versions.md) или более поздняя. Указывает, что страница будет создана при создании страницы свойств. Если этот флаг не указан, страница не будет создана до первого выбора. Этот флаг не поддерживается при использовании мастера стилей Aero ([PSH_AEROWIZARD](pss-propsheetheader.md)). |
| PSP_RTLREADING | Изменяет направление отображения *псзтитле* . В обычных окнах отображается весь текст, включая *псзтитле*, слева направо (LTR). Для таких языков, как иврит или арабский, которые читаются справа налево, окно может быть зеркальным, а весь текст будет отображаться справа налево. Если задан параметр PSP_RTLREADING, *псзтитле* будет считывать RTL в нормальном родительском окне, а LTR — в зеркальном родительском окне. |
| PSP_USECALLBACK | Вызывает функцию, заданную элементом *пфнкаллбакк* при создании или уничтожении страницы вкладки свойств, определенной этой структурой. |
| PSP_USEFUSIONCONTEXT | [Версия 6,0](common-control-versions.md) и более поздние версии. Используйте контекст активации. Чтобы использовать контекст активации, необходимо установить этот флаг и назначить маркер контекста активации для *хакткткс*. См. примечания. |
| PSP_USEHEADERSUBTITLE | [Версия 5,80](common-control-versions.md) или более поздняя. Отображает строку, на которую указывает элемент *псзеадерсубтитле* , в качестве подзаголовка области заголовка страницы Wizard97. Чтобы использовать этот флаг, необходимо также задать флаг PSH_WIZARD97 в элементе *dwFlags* связанной структуры [пропшисеадер](pss-propsheetheader.md) . Флаг PSP_USEHEADERSUBTITLE игнорируется, если задан параметр PSP_HIDEHEADER. В мастерах стилей Aero заголовок отображается рядом с верхней частью клиентской области. |
| PSP_USEHEADERTITLE | [Версия 5,80](common-control-versions.md) или более поздняя. Отображает строку, на которую указывает элемент *псзеадертитле* , в качестве заголовка в заголовке внутренней страницы Wizard97. Необходимо также задать флаг PSH_WIZARD97 в элементе *dwFlags* связанной структуры [пропшисеадер](pss-propsheetheader.md) . Флаг PSP_USEHEADERTITLE игнорируется, если задан параметр PSP_HIDEHEADER. Этот флаг не поддерживается при использовании мастера стилей Aero ([PSH_AEROWIZARD](pss-propsheetheader.md)). |
| PSP_USEHICON | Использует *Хикон* в качестве маленького значка на вкладке для страницы. Этот флаг не поддерживается при использовании мастера стилей Aero ([PSH_AEROWIZARD](pss-propsheetheader.md)).  |
| PSP_USEICONID | Использует *псзикон* в качестве имени ресурса значка для загрузки и использования в качестве маленького значка на вкладке для страницы. Этот флаг не поддерживается при использовании мастера стилей Aero ([PSH_AEROWIZARD](pss-propsheetheader.md)). |
| PSP_USEREFPARENT | Поддерживает счетчик ссылок, заданный элементом *пкрефпарент* , на время существования страницы листа свойств, созданной из этой структуры. |
| PSP_USETITLE | Использует элемент *псзтитле* в качестве заголовка диалогового окна страницы свойств вместо заголовка, хранящегося в шаблоне диалогового окна. Этот флаг не поддерживается при использовании мастера стилей Aero ([PSH_AEROWIZARD](pss-propsheetheader.md)). |

*hInstance* 

Тип: [HINSTANCE](../winprog/windows-data-types.md)

Обработчик для экземпляра, из которого загружается ресурс со значком или строкой. Если элемент *псзикон*, *псзтитле*, *псзеадертитле* или *псзеадерсубтитле* определяет ресурс для загрузки, необходимо указать значение *HINSTANCE* .

*псзтемплате* 

Тип: [LPCSTR](../winprog/windows-data-types.md)

Шаблон диалогового окна, используемый для создания страницы. Этот элемент может указывать либо идентификатор ресурса шаблона, либо адрес строки, указывающей имя шаблона. Если установлен флаг PSP_DLGINDIRECT в элементе *dwFlags* , *псзтемплате* игнорируется. Этот член объявляется как Union с предварительным *исходным кодом*.

*исходный код* 

Тип: **лпкдлгтемплате**

Указатель на шаблон диалогового окна в памяти. Функция [Страница свойств](/windows/win32/api/prsht/nf-prsht-propertysheeta) предполагает, что шаблон не защищен от записи. Шаблон только для чтения вызовет исключение в некоторых версиях Windows. Чтобы использовать этот элемент, необходимо задать флаг PSP_DLGINDIRECT в элементе *dwFlags* . Этот член объявляется как объединение с *псзтемплате*.

*hIcon* 

Тип: [Хикон](../winprog/windows-data-types.md)

Обработчик значка, используемый в качестве значка на вкладке страницы. Если элемент *dwFlags* не содержит PSP_USEHICON, этот элемент игнорируется. Этот член объявляется как объединение с *псзикон*.

*псзикон* 

Тип: [LPCSTR](../winprog/windows-data-types.md)

Значок ресурса для использования в качестве значка на вкладке страницы. Этот элемент может указывать либо идентификатор ресурса значка, либо адрес строки, указывающей имя ресурса значка. Чтобы использовать этот элемент, необходимо задать флаг PSP_USEICONID в элементе *dwFlags* . Этот член объявляется как объединение с *Хикон*.

*псзтитле* 

Тип: [LPCSTR](../winprog/windows-data-types.md)

Заголовок диалогового окна «Страница свойств». Этот заголовок переопределяет заголовок, указанный в шаблоне диалогового окна. Этот элемент может указывать либо идентификатор строкового ресурса, либо адрес строки, указывающей заголовок. Чтобы использовать этот элемент, необходимо задать флаг PSP_USETITLE в элементе *dwFlags* .

*пфндлгпрок* 

Тип: **длгпрок**

Указатель на процедуру диалогового окна для страницы. Так как страницы создаются в виде немодальных диалоговых окон, процедура диалогового окна не должна вызывать функцию [EndDialog](/windows/win32/api/winuser/nf-winuser-enddialog) .

*lParam* 

Тип: [lParam](../winprog/windows-data-types.md) .

При создании страницы копия структуры **пропшитпаже** страницы передается в процедуру диалогового окна с [WM_INITDIALOG](/windows/win32/dlgbox/wm-initdialog) сообщением. Член *lParam* позволяет передавать сведения о приложении в процедуру диалогового окна. Не влияет на саму страницу.

*пфнкаллбакк* 

Тип: **лпфнпспкаллбакк**

Указатель на определяемую приложением функцию обратного вызова, которая вызывается при создании страницы и когда она собирается уничтожиться. Дополнительные сведения о функции обратного вызова см. в разделе [функция обратного вызова лпфнпспкаллбакка](/windows/win32/api/prsht/nc-prsht-lpfnpspcallbacka). Чтобы использовать этот элемент, необходимо задать флаг PSP_USECALLBACK в элементе *dwFlags* .

*пкрефпарент* 

Тип: [uint *](../winprog/windows-data-types.md)

Указатель на значение счетчика ссылок. Чтобы использовать этот элемент, необходимо задать флаг PSP_USEREFPARENT в элементе *dwFlags* .

> [!NOTE]
> При создании страницы свойств значение, на которое указывает *пкрефпарент* , увеличивается. Страницу свойств можно создать неявным образом, задав флаг PSH_PROPSHEETPAGE в элементе *dwFlags* элемента [пропшисеадер](pss-propsheetheader.md) и вызвав функцию [Страница свойств](/windows/win32/api/prsht/nf-prsht-propertysheeta) . Это можно сделать явным образом с помощью функции [креатепропертишитпаже](/windows/win32/api/prsht/nf-prsht-createpropertysheetpagea) . При удалении страницы листа свойств значение, на которое указывает элемент *пкрефпарент* , уменьшается. Это происходит автоматически при уничтожении страницы свойств. Можно явно удалить страницу страницы свойств с помощью функции [дестройпропертишитпаже](/windows/win32/api/prsht/nf-prsht-destroypropertysheetpage) .

*псзеадертитле* 

Тип: [LPCTSTR](../winprog/windows-data-types.md)

[Версия 5,80](common-control-versions.md) или более поздняя. Заголовок области заголовка. Чтобы использовать этот элемент в мастере Wizard97-Style, необходимо также выполнить следующие действия.

* Установите флаг PSP_USEHEADERTITLE в элементе *dwFlags* .
* Установите флаг PSH_WIZARD97 в элементе *dwFlags* структуры [пропшисеадер](pss-propsheetheader.md) страницы.
* Убедитесь, что флаг PSP_HIDEHEADER в элементе *dwFlags* не задан.

*псзеадерсубтитле* 

Тип: [LPCTSTR](../winprog/windows-data-types.md)

[Версия 5,80](common-control-versions.md) или более поздняя. Подзаголовок области заголовка. Чтобы использовать этот элемент, необходимо выполнить следующие действия.

* Установите флаг PSP_USEHEADERSUBTITLE в элементе *dwFlags* .
* Установите флаг PSH_WIZARD97 в элементе *dwFlags* структуры [пропшисеадер](pss-propsheetheader.md) страницы.
* Убедитесь, что флаг PSP_HIDEHEADER в элементе *dwFlags* не задан.

> [!NOTE]
> Этот элемент игнорируется при использовании мастера стилей Aero ([PSH_AEROWIZARD](pss-propsheetheader.md))

*хакткткс* 

Тип: [Handle](../winprog/windows-data-types.md)

[Версия 6,0](common-control-versions.md) или более поздняя. Маркер контекста активации. Присвойте этому элементу маркер, который возвращается при создании контекста активации с помощью [креатеакткткс](/windows/win32/api/winbase/nf-winbase-createactctxa). Система активирует этот контекст перед созданием диалогового окна. Этот элемент не требуется использовать, если используется глобальный манифест.

*хбмхеадер* 

Тип: [хбитмап](../winprog/windows-data-types.md)

Этот член объявляется как объединение с *псзбмхеадер*.

*псзбмхеадер*

Тип: [LPCSTR](../winprog/windows-data-types.md)

Этот член объявляется как объединение с *хбмхеадер*.

## <a name="remarks"></a>Комментарии

Comctl32.dll версии 6 и более поздних версий не являются распространяемыми. Чтобы использовать Comctl32.dll версии 6 или более поздней, укажите DLL-файл в манифесте. Дополнительные сведения о манифестах см. в разделе [Включение визуальных стилей](cookbook-overview.md).

## <a name="requirements"></a>Требования

| Требование | Значение |
|-------------------------------------|------------------------------------------------------------------------------------|
| Минимальная версия клиента | Только для \[ классических приложений Windows Vista\]                                    |
| Минимальная версия сервера | \[Только для настольных приложений Windows Server 2003\]                              |
| Header                   | Пршт. h |
| Имя в кодировке Юникод и ANSI                   | **Пропшисеадерв** (Юникод) и **пропшисеадера** (ANSI) |
