---
title: Scroll Bar
description: В этом разделе содержатся сведения об элементах программирования, используемых с полосами прокрутки.
ms.assetid: vs|controls|~\controls\scrollbars\scrollbars.htm
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 38cf549a37fd5d4a271f6e12642a9bfd45b65d79
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "103794106"
---
# <a name="scroll-bar"></a>Scroll Bar

В этом разделе содержатся сведения об элементах программирования, используемых с полосами прокрутки. В окне может отображаться объект данных, например документ или точечный рисунок, который больше, чем клиентская область окна. При использовании с *полосой прокрутки* пользователь может прокручивать объект данных в клиентской области, чтобы отобразить части объекта, выходящие за рамки окна.

### <a name="overviews"></a>Разделы общих сведений



| Раздел                                      | Содержимое                                                                                                                                                                                                                                                                                                                         |
|--------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [О панелях прокрутки](about-scroll-bars.md) | Полоса прокрутки состоит из затененной Шафт с кнопкой со стрелкой на каждой стороне и *полем прокрутки* (иногда называемым бегунком) между кнопками со стрелками.<br/>                                                                                                                                                                     |
| [Использование полос прокрутки](using-scroll-bars.md) | При создании перекрытого, всплывающего или дочернего окна можно добавить стандартные полосы прокрутки с помощью функции [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) и указать [**WS \_ HSCROLL**](/windows/desktop/winmsg/window-styles), [**WS \_ VSCROLL**](/windows/desktop/winmsg/window-styles)или оба стиля.<br/> |



 

### <a name="functions"></a>Функции



<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th>Раздел</th>
<th>Содержимое</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="/windows/desktop/api/Winuser/nf-winuser-enablescrollbar"><strong>енаблескроллбар</strong></a></td>
<td>Функция <a href="/windows/desktop/api/Winuser/nf-winuser-enablescrollbar"><strong>енаблескроллбар</strong></a> включает или отключает одну или обе стрелки полосы прокрутки. <br/></td>
</tr>
<tr class="even">
<td><a href="/windows/desktop/api/Winuser/nf-winuser-getscrollbarinfo"><strong>жетскроллбаринфо</strong></a></td>
<td>Функция <a href="/windows/desktop/api/Winuser/nf-winuser-getscrollbarinfo"><strong>жетскроллбаринфо</strong></a> получает сведения об указанной полосе прокрутки.<br/></td>
</tr>
<tr class="odd">
<td><a href="/windows/desktop/api/Winuser/nf-winuser-getscrollinfo"><strong>жетскроллинфо</strong></a></td>
<td>Функция <a href="/windows/desktop/api/Winuser/nf-winuser-getscrollinfo"><strong>жетскроллинфо</strong></a> получает параметры полосы прокрутки, включая минимальные и максимальные положения прокрутки, размер страницы и положение ползунка (Thumb).<br/></td>
</tr>
<tr class="even">
<td><a href="/windows/desktop/api/Winuser/nf-winuser-getscrollpos"><strong>жетскроллпос</strong></a></td>
<td>Функция <a href="/windows/desktop/api/Winuser/nf-winuser-getscrollpos"><strong>жетскроллпос</strong></a> извлекает текущее расположение бегунка (Thumb) в указанной полосе прокрутки. Текущая величина — это относительное значение, которое зависит от текущего диапазона прокрутки. Например, если диапазон прокрутки находится в диапазоне от 0 до 100, а поле прокрутки находится в середине линейки, текущее расположение равно 50.
<blockquote>
[!Note]<br />
Функция <a href="/windows/desktop/api/Winuser/nf-winuser-getscrollpos"><strong>жетскроллпос</strong></a> предоставляется для обеспечения обратной совместимости. Новые приложения должны использовать функцию <a href="/windows/desktop/api/Winuser/nf-winuser-getscrollinfo"><strong>жетскроллинфо</strong></a> .
</blockquote>
<br/> <br/></td>
</tr>
<tr class="odd">
<td><a href="/windows/desktop/api/Winuser/nf-winuser-getscrollrange"><strong>жетскроллранже</strong></a></td>
<td>Функция <a href="/windows/desktop/api/Winuser/nf-winuser-getscrollrange"><strong>жетскроллранже</strong></a> извлекает текущую минимальную и максимальную позиции полосы прокрутки (Thumb) для указанной полосы прокрутки.
<blockquote>
[!Note]<br />
Функция <a href="/windows/desktop/api/Winuser/nf-winuser-getscrollrange"><strong>жетскроллранже</strong></a> предоставляется только для обеспечения совместимости. Новые приложения должны использовать функцию <a href="/windows/desktop/api/Winuser/nf-winuser-getscrollinfo"><strong>жетскроллинфо</strong></a> .
</blockquote>
<br/> <br/></td>
</tr>
<tr class="even">
<td><a href="/windows/desktop/api/Winuser/nf-winuser-scrolldc"><strong>скроллдк</strong></a></td>
<td>Функция <a href="/windows/desktop/api/Winuser/nf-winuser-scrolldc"><strong>скроллдк</strong></a> прокручивает прямоугольник битов по горизонтали и вертикали. <br/></td>
</tr>
<tr class="odd">
<td><a href="/windows/desktop/api/Winuser/nf-winuser-scrollwindow"><strong>скроллвиндов</strong></a></td>
<td>Функция <a href="/windows/desktop/api/Winuser/nf-winuser-scrollwindow"><strong>скроллвиндов</strong></a> прокручивает содержимое клиентской области указанного окна.
<blockquote>
[!Note]<br />
Функция <a href="/windows/desktop/api/Winuser/nf-winuser-scrollwindow"><strong>скроллвиндов</strong></a> предоставляется для обеспечения обратной совместимости. Новые приложения должны использовать функцию <a href="/windows/desktop/api/Winuser/nf-winuser-scrollwindowex"><strong>скроллвиндовекс</strong></a> .
</blockquote>
<br/> <br/></td>
</tr>
<tr class="even">
<td><a href="/windows/desktop/api/Winuser/nf-winuser-scrollwindowex"><strong>скроллвиндовекс</strong></a></td>
<td>Функция <a href="/windows/desktop/api/Winuser/nf-winuser-scrollwindowex"><strong>скроллвиндовекс</strong></a> прокручивает содержимое клиентской области указанного окна. <br/></td>
</tr>
<tr class="odd">
<td><a href="/windows/desktop/api/Winuser/nf-winuser-setscrollinfo"><strong>сетскроллинфо</strong></a></td>
<td>Функция <a href="/windows/desktop/api/Winuser/nf-winuser-setscrollinfo"><strong>сетскроллинфо</strong></a> задает параметры полосы прокрутки, включая минимальные и максимальные положения прокрутки, размер страницы и положение ползунка (Thumb). При запросе функция также перерисовывает полосу прокрутки.<br/></td>
</tr>
<tr class="even">
<td><a href="/windows/desktop/api/Winuser/nf-winuser-setscrollpos"><strong>сетскроллпос</strong></a></td>
<td>Функция <a href="/windows/desktop/api/Winuser/nf-winuser-setscrollpos"><strong>сетскроллпос</strong></a> задает расположение ползунка (бегунка) в указанной полосе прокрутки и, при запросе, перерисовывает полосу прокрутки, чтобы отразить новую точку полосы прокрутки.
<blockquote>
[!Note]<br />
Функция <a href="/windows/desktop/api/Winuser/nf-winuser-setscrollpos"><strong>сетскроллпос</strong></a> предоставляется для обеспечения обратной совместимости. Новые приложения должны использовать функцию <a href="/windows/desktop/api/Winuser/nf-winuser-setscrollinfo"><strong>сетскроллинфо</strong></a> .
</blockquote>
<br/> <br/></td>
</tr>
<tr class="odd">
<td><a href="/windows/desktop/api/Winuser/nf-winuser-setscrollrange"><strong>сетскроллранже</strong></a></td>
<td>Функция <a href="/windows/desktop/api/Winuser/nf-winuser-setscrollrange"><strong>сетскроллранже</strong></a> устанавливает минимальные и максимальные позиции полосы прокрутки для указанной полосы прокрутки.
<blockquote>
[!Note]<br />
Функция <a href="/windows/desktop/api/Winuser/nf-winuser-setscrollrange"><strong>сетскроллранже</strong></a> предоставляется для обеспечения обратной совместимости. Новые приложения должны использовать функцию <a href="/windows/desktop/api/Winuser/nf-winuser-setscrollinfo"><strong>сетскроллинфо</strong></a> .
</blockquote>
<br/> <br/></td>
</tr>
<tr class="even">
<td><a href="/windows/desktop/api/Winuser/nf-winuser-showscrollbar"><strong>шовскроллбар</strong></a></td>
<td>Функция <a href="/windows/desktop/api/Winuser/nf-winuser-showscrollbar"><strong>шовскроллбар</strong></a> показывает или скрывает указанную полосу прокрутки. <br/></td>
</tr>
</tbody>
</table>



 

### <a name="messages"></a>Сообщения



| Раздел                                                 | Содержимое                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|-------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**\_стрелки включения \_ СБМ**](sbm-enable-arrows.md)      | Приложение отправляет сообщение [**\_ \_ со стрелками СБМ**](sbm-enable-arrows.md) , чтобы включить или отключить одну или обе стрелки элемента управления "полоса прокрутки".<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| [**СБМ \_ жетпос**](sbm-getpos.md)                     | Сообщение [**СБМ \_ жетпос**](sbm-getpos.md) отправляется для получения текущей позицией бегунка элемента управления "полоса прокрутки". Текущая величина — это относительное значение, которое зависит от текущего диапазона прокрутки. Например, если диапазон прокрутки находится в диапазоне от 0 до 100, а поле прокрутки находится в середине линейки, текущее расположение равно 50. <br/> Приложения не должны отсылать это сообщение напрямую. Вместо этого они должны использовать функцию [**жетскроллпос**](/windows/desktop/api/Winuser/nf-winuser-getscrollpos) . Окно получает это сообщение через функцию [*WindowProc*](/previous-versions/windows/desktop/legacy/ms633573(v=vs.85)) . Приложения, которые реализуют пользовательский элемент управления "полоса прокрутки", должны отвечать на эти сообщения, чтобы функция **жетскроллпос** работала правильно.<br/> |
| [**СБМ \_**](sbm-getrange.md)                 | Сообщение [**СБМ- \_ Range**](sbm-getrange.md) отправляется для получения минимального и максимального значений позиционирования для элемента управления "полоса прокрутки". <br/> Приложения не должны отсылать это сообщение напрямую. Вместо этого они должны использовать функцию [**жетскроллранже**](/windows/desktop/api/Winuser/nf-winuser-getscrollrange) . Окно получает это сообщение через функцию [*WindowProc*](/previous-versions/windows/desktop/legacy/ms633573(v=vs.85)) . Приложения, которые реализуют пользовательский элемент управления "полоса прокрутки", должны отвечать на эти сообщения, чтобы функция **жетскроллранже** работала правильно.<br/>                                                                                                                                                                                                              |
| [**СБМ \_ жетскроллбаринфо**](sbm-getscrollbarinfo.md) | Отправляется приложением для получения сведений об указанной полосе прокрутки.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| [**СБМ \_ жетскроллинфо**](sbm-getscrollinfo.md)       | Для получения параметров полосы прокрутки отправляется сообщение [**СБМ \_ жетскроллинфо**](sbm-getscrollinfo.md) . <br/> Приложения не должны отсылать это сообщение напрямую. Вместо этого они должны использовать функцию [**жетскроллинфо**](/windows/desktop/api/Winuser/nf-winuser-getscrollinfo) . Окно получает это сообщение через функцию [*WindowProc*](/previous-versions/windows/desktop/legacy/ms633573(v=vs.85)) . Приложения, которые реализуют пользовательский элемент управления "полоса прокрутки", должны отвечать на эти сообщения, чтобы функция **жетскроллинфо** работала правильно.<br/>                                                                                                                                                                                                                                           |
| [**СБМ \_ сетпос**](sbm-setpos.md)                     | Сообщение [**СБМ \_ сетпос**](sbm-setpos.md) отправляется, чтобы задать расположение ползунка (бегунка) и, при необходимости, перерисовать полосу прокрутки, чтобы отразить новую точку прокрутки. <br/> Приложения не должны отсылать это сообщение напрямую. Вместо этого они должны использовать функцию [**сетскроллпос**](/windows/desktop/api/Winuser/nf-winuser-setscrollpos) . Окно получает это сообщение через функцию [*WindowProc*](/previous-versions/windows/desktop/legacy/ms633573(v=vs.85)) . Приложения, которые реализуют пользовательский элемент управления "полоса прокрутки", должны отвечать на эти сообщения, чтобы функция **сетскроллпос** работала правильно.<br/>                                                                                                                                                                  |
| [**СБМ \_ SETRANGE**](sbm-setrange.md)                 | Сообщение [**СБМ \_ SETRANGE**](sbm-setrange.md) отправляется для установки минимального и максимального значений позиций для элемента управления "полоса прокрутки". <br/> Приложения не должны отсылать это сообщение напрямую. Вместо этого они должны использовать функцию [**сетскроллранже**](/windows/desktop/api/Winuser/nf-winuser-setscrollrange) . Окно получает это сообщение через функцию [*WindowProc*](/previous-versions/windows/desktop/legacy/ms633573(v=vs.85)) . Приложения, которые реализуют пользовательский элемент управления "полоса прокрутки", должны отвечать на эти сообщения, чтобы функция **сетскроллранже** работала правильно.<br/>                                                                                                                                                                                                                   |
| [**СБМ \_ сетранжередрав**](sbm-setrangeredraw.md)     | Приложение отправляет сообщение [**СБМ \_ сетранжередрав**](sbm-setrangeredraw.md) в элемент управления "полоса прокрутки", чтобы задать минимальное и максимальное значения расположения и перерисовать элемент управления.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| [**СБМ \_ сетскроллинфо**](sbm-setscrollinfo.md)       | Сообщение [**СБМ \_ сетскроллинфо**](sbm-setscrollinfo.md) отправляется для установки параметров полосы прокрутки. <br/> Приложения не должны отсылать это сообщение напрямую. Вместо этого они должны использовать функцию [**сетскроллинфо**](/windows/desktop/api/Winuser/nf-winuser-setscrollinfo) . Окно получает это сообщение через функцию [*WindowProc*](/previous-versions/windows/desktop/legacy/ms633573(v=vs.85)) . Приложения, которые реализуют пользовательский элемент управления "полоса прокрутки", должны отвечать на эти сообщения, чтобы функция **сетскроллинфо** работала правильно.<br/>                                                                                                                                                                                                                                            |



 

### <a name="notifications"></a>Уведомления



| Раздел                                                 | Содержимое                                                                                                                                                                                                                                                                                                                                                                                                                |
|-------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**WM \_ ктлколорскроллбар**](wm-ctlcolorscrollbar.md) | Сообщение [**WM \_ ктлколорскроллбар**](wm-ctlcolorscrollbar.md) отправляется в родительское окно элемента управления "полоса прокрутки", когда элемент управления собирается для рисования. При ответе на это сообщение родительское окно может использовать маркер контекста отображения, чтобы задать цвет фона для элемента управления полосы прокрутки. <br/> Окно получает это сообщение через функцию [*WindowProc*](/previous-versions/windows/desktop/legacy/ms633573(v=vs.85)) . <br/> |
| [**WM \_ HSCROLL**](wm-hscroll.md)                     | Сообщение [**WM \_ HSCROLL**](wm-hscroll.md) отправляется в окно при возникновении события прокрутки в стандартной горизонтальной полосе прокрутки окна. Это сообщение также отправляется владельцу горизонтальной полосы прокрутки при возникновении события прокрутки в элементе управления. <br/> Окно получает это сообщение через функцию [*WindowProc*](/previous-versions/windows/desktop/legacy/ms633573(v=vs.85)) . <br/>                                        |
| [**WM \_ VSCROLL**](wm-vscroll.md)                     | Сообщение [**WM \_ VSCROLL**](wm-vscroll.md) отправляется в окно при возникновении события прокрутки в стандартной вертикальной полосе прокрутки окна. Это сообщение также отправляется владельцу вертикальной полосы прокрутки, когда в элементе управления возникает событие прокрутки. <br/> Окно получает это сообщение через функцию [*WindowProc*](/previous-versions/windows/desktop/legacy/ms633573(v=vs.85)) . <br/>                                            |



 

### <a name="structures"></a>Структуры



| Раздел                                  | Содержимое                                                                                                                                                                                                                                                                                                                                                   |
|----------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [**скроллбаринфо**](/windows/win32/api/winuser/ns-winuser-scrollbarinfo) | Структура [**скроллбаринфо**](/windows/win32/api/winuser/ns-winuser-scrollbarinfo) содержит сведения о полосе прокрутки.<br/>                                                                                                                                                                                                                                                           |
| [**скроллинфо**](/windows/win32/api/winuser/ns-winuser-scrollinfo)       | Структура [**скроллинфо**](/windows/win32/api/winuser/ns-winuser-scrollinfo) содержит параметры полосы прокрутки, которые должны быть заданы функцией [**сетскроллинфо**](/windows/desktop/api/Winuser/nf-winuser-setscrollinfo) (или сообщением [**СБМ \_ Сетскроллинфо**](sbm-setscrollinfo.md) ) или извлечены функцией [**жетскроллинфо**](/windows/desktop/api/Winuser/nf-winuser-getscrollinfo) (или сообщением СБМ [**\_ жетскроллинфо**](sbm-getscrollinfo.md) ). <br/> |



 

### <a name="constants"></a>Константы



| Раздел                                                      | Содержимое                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [Стили элемента управления "полоса прокрутки"](scroll-bar-control-styles.md) | Чтобы создать элемент управления "полоса прокрутки" с помощью функции [**CreateWindow**](/windows/desktop/api/winuser/nf-winuser-createwindowa) или [**CreateWindowEx**](/windows/desktop/api/winuser/nf-winuser-createwindowexa) , укажите класс ScrollBar, соответствующие константы стиля окна и сочетание следующих стилей элемента управления "полоса прокрутки". Некоторые стили создают элемент управления "полоса прокрутки", который использует ширину или высоту по умолчанию. Однако при вызове **CreateWindow** или **CreateWindowEx** необходимо всегда указывать координаты x и y и другие измерения полосы прокрутки. <br/> |



 

 

