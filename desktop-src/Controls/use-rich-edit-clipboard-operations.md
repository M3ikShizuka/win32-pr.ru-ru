---
title: Использование многофункциональных операций редактирования буфера обмена
description: Приложение может вставить содержимое буфера обмена в форматируемый элемент управления с помощью наиболее доступного формата буфера обмена или конкретного формата буфера обмена.
ms.assetid: 1FEFFD95-839B-4A26-A26E-B8429D5FF4C0
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4a46432054956914b484c9faeeeda78f2a18e132
ms.sourcegitcommit: 5f33645661bf8c825a7a2e73950b1f4ea0f1cd82
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/21/2020
ms.locfileid: "103987932"
---
# <a name="how-to-use-rich-edit-clipboard-operations"></a>Использование многофункциональных операций редактирования буфера обмена

Приложение может вставить содержимое буфера обмена в форматируемый элемент управления с помощью наиболее доступного формата буфера обмена или конкретного формата буфера обмена. Кроме того, можно определить, может ли элемент управления с расширенным редактированием вставлять формат буфера обмена.

## <a name="what-you-need-to-know"></a>Что необходимо знать

### <a name="technologies"></a>Технологии

-   [Элементы управления Windows](window-controls.md)

### <a name="prerequisites"></a>Предварительные условия

-   C/C++
-   Программирование пользовательского интерфейса Windows

## <a name="instructions"></a>Инструкции

### <a name="use-a-rich-edit-clipboard-operation"></a>Использование операции редактирования буфера обмена с богатыми возможностями

Как и в случае с элементом управления "поле ввода", можно скопировать или вырезать содержимое текущего выделения, используя сообщение [**WM \_ Copy**](/windows/desktop/dataxchg/wm-copy) или [**WM \_ Cut**](/windows/desktop/dataxchg/wm-cut) . Аналогичным образом можно вставить содержимое буфера обмена в форматируемый элемент управления, используя сообщение [**\_ вставки WM**](/windows/desktop/dataxchg/wm-paste) . Элемент управления вставит первый доступный формат, который он распознает, и, вероятно, является наиболее описательным форматом.

Чтобы вставить конкретный формат буфера обмена, можно использовать сообщение [**EM \_ PASTESPECIAL**](em-pastespecial.md) . Это сообщение полезно для приложений с командой **Специальная вставка** , которая позволяет пользователю выбрать формат буфера обмена. Чтобы определить, распознается ли данный формат элементом управления, можно использовать сообщение [**EM \_ канпасте**](em-canpaste.md) .

Кроме того, можно использовать сообщение [**EM \_ канпасте**](em-canpaste.md) , чтобы определить, распознан ли любой доступный формат буфера обмена элементом управления Rich Edit. Это сообщение полезно при обработке сообщения [**WM \_ инитменупопуп**](/windows/desktop/menurc/wm-initmenupopup) . В зависимости от того, может ли элемент управления вставлять любой доступный формат, в приложении может быть включена или серая команда **вставки** .

Элементы управления Rich Edit регистрируют два формата буфера обмена:

-   Формат форматированного текста
-   Формат форматированного текста без объектов
-   Текст и объекты RichEdit

Приложение может зарегистрировать эти форматы с помощью функции [**регистерклипбоардформат**](/windows/desktop/api/winuser/nf-winuser-registerclipboardformata) , указав значения параметров "CF \_ RTF", "CF \_ РТФНУБЖС" и "CF ретекстобж" \_ .

## <a name="related-topics"></a>См. также

<dl> <dt>

[Использование элементов управления Rich Edit](using-rich-edit-controls.md)
</dt> <dt>

[Демонстрация стандартных элементов управления Windows (Кппвиндовскоммонконтролс)](https://github.com/microsoftarchive/msdn-code-gallery-microsoft/tree/master/OneCodeTeam/Windows%20common%20controls%20demo%20(CppWindowsCommonControls)/%5BC++%5D-Windows%20common%20controls%20demo%20(CppWindowsCommonControls)/C++/CppWindowsCommonControls)
</dt> </dl>

 

 