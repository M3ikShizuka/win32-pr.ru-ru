---
title: Создание образцов
description: Чтобы создать пример COM, необходимо настроить компьютерную среду для сборки приложений Microsoft Win32 C++.
ms.assetid: c62b8b4d-a9d2-4587-8bb6-7b2c30d1c00d
keywords:
- Создание образцов
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 593d3465d3ebcc32a6768dd8b2dffe1f0a653d07
ms.sourcegitcommit: c2a1c4314550ea9bd202d28adfcc7bfe6180932f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/11/2020
ms.locfileid: "105661683"
---
# <a name="how-to-build-samples"></a>Создание образцов

Чтобы создать пример COM, необходимо настроить компьютерную среду для сборки приложений Microsoft Win32 C++.

## <a name="preparing-a-computer-to-create-com-samples"></a>Подготовка компьютера к созданию примеров COM

Компьютерная среда должна быть настроена с помощью правильно установленного 32-разрядного компилятора C++, компоновщика и компилятора ресурсов, совместимых с Microsoft Visual C++ 4. x или более поздней версии и правильно установленной Windows SDK. Лучше установить Windows SDK последним. Windows SDK предоставляет файлы библиотеки include и lib, необходимые для функциональности COM, закодированной в примерах.

Для успешного выполнения примеров Ремклиен, Фресерве и Фреклиен требуются системные средства, доступные в операционных системах Windows: Windows Server 2003, Windows XP, Windows 2000 или Windows NT 4,0. Примеры Ремклиен, Фресерве и Фреклиен будут создаваться, но не будут работать в операционных системах Windows Me, Windows 98 или Windows 95, если только не распределенный COM (DCOM) и COM-объект, свободный поток, являются частью операционной системы. Эта поддержка доступна для операционных систем Windows Me, Windows 98 и Windows 95 в DCOM95 Add on. В настоящее время DCOM95 можно получить с помощью [скачивания из корпорации Майкрософт](https://www.microsoft.com/download/details.aspx?id=31661).

Каждый каталог примеров содержит необходимые исходные файлы для сборки и запуска примера. Родительский каталог примеров содержит файл Makeall.bat, который можно запустить из командной строки, чтобы сделать все примеры кода в ветви ниже. Дополнительные сведения см. в файле Makeall.bat. Если среда настроена на сборку приложений Win32 C++, можно просто запустить Makeall.bat из каталога, в котором он находится, чтобы создать все примеры кода в ветви ниже. Макеалл обеспечивает правильный порядок сборки, чтобы удовлетворялись все зависимости примера кода.

В главном каталоге также имеется файл makefile, который строит все примеры кода учебника с использованием параметров, аналогичных параметрам, поддерживаемым Makeall.bat. Дополнительные сведения см. в этом файле Makefile. В этом файле Makefile предполагается, что в составе Windows SDK установлена вся ветвь Code Samples. В настоящее время это расположение имеет путь, аналогичный *d: \\ мссдк \\ Samples \\ COM \\ тутсамп*, где D: представляет установочный диск. Если вы извлекли ветвь образца кода учебника (например, COM-приложение и его подкаталоги) в другое расположение за пределами Windows SDK (или если вы получили пример набора как отдельную загрузку с веб-сайта Майкрософт), используйте Makeall.bat для компиляции всех примеров в ветви. В общем случае рекомендуется Makeall.bat. Также предоставляется файл Logmall.bat. Он выполняется так же, как и пакетный файл Макеалл, за исключением того, что он записывает все выходные данные компиляции в файловые Errorlog.txt в главном каталоге Tutorial.

Два пакетных файла, Regall.bat и Unregall.bat, также предоставляются в основном каталоге для регистрации и отмены регистрации всех серверов COM в серии образцов кода руководства. Чтобы зарегистрировать все серверы, запустите файл Regall.bat из основного каталога. Чтобы отменить регистрацию всех серверов, выполните Unregall.bat таким же образом. Для этих пакетных файлов требуется предварительная сборка с примерами кода для регистрации, МАРШАЛИРОВАНИЯ, ДЛЛСЕРВЕ, ЛИКСЕРВЕ, ЛОКСЕРВЕ, АПТСЕРВЕ, ФРЕСЕРВЕ и сохранения. Если выполняется обычная сборка образцов кода, файлы Makefile сервера будут автоматически регистрировать серверы. В этом случае нет необходимости запускать пакетный файл Регалл.

Запустите пакетный файл Cleanall.bat, чтобы выполнить исчерпывающие Клеаналл из всех примеров учебника по COM.

> [!WARNING]
> Этот пакетный файл удаляет все файлы проектов Visual Studio и другие временные рабочие файлы, созданные Visual C++ в примерах. Все COM-серверы, встроенные в учебные примеры кода, отменяются из реестра. Все исполняемые exe-и DLL-файлы удаляются. Удаляются все файлы отладочных символов. Файлы, созданные в различных средах сборки, также удаляются.

 

Выполните команду "Макеалл Clean", чтобы ускорить выполнение, но более небольшое удаление всех примеров кода. Эта операция очистки не попытается быть такой же полной, как в Cleanall.bat. OBJ-файлы удаляются, но выходные двоичные данные сохраняются. Регистрация серверов COM в реестре не выполняется.

Этот пример серии создан как неотъемлемая часть Windows SDK, поэтому в этом руководстве предполагается, что среда с Windows SDK правильно установлена.

Однако выпуски Microsoft Visual C++ версии 4,0 и более поздних версий также могут предоставлять файлы библиотеки include и lib, необходимые для компиляции. В таких случаях установка Windows SDK может не потребоваться для компиляции образцов.

Дополнительные сведения и полный пример сведений о сборке см. в следующих статьях:

[Настройка среды](environment-setup.md)

[Файлы Makefile](makefiles.md)

[Использование Visual Studio](using-visual-studio.md)

[Извлечение примеров кода](extracting-the-code-samples.md)

[Соглашения о стиле написания кода](coding-style-conventions.md)

 

 




