---
title: Управление свойствами
description: Каждое свойство состоит из идентификатора свойства (уникального в пределах набора свойств), тега типа Variant (VT или VarType), представляющего тип значения, и самого значения.
ms.assetid: d220ecb4-b014-4ac9-a636-9a493187cc87
keywords:
- Структурированное хранилище Стрктд STG, использование, Управление свойствами
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 10dd78a1f8a8484090728dba6fe149840e940461
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "103890772"
---
# <a name="managing-properties"></a>Управление свойствами

Каждое свойство состоит из *идентификатора свойства* (уникального в пределах набора свойств), *тега типа Variant (VT или VarType)* , представляющего тип значения, и самого *значения* . Тег типа Variant описывает представление данных в значении. Кроме того, свойству также может быть присвоено *строковое имя* , которое можно использовать для идентификации свойства, вместо использования обязательного числового свойства (ID). Для создания свойств и управления ими COM определяет интерфейс [**ипропертистораже**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) .

Интерфейс [**ипропертистораже**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) включает методы для чтения и записи массивов свойств или имен свойств. Интерфейс включает методы [**commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) и [**revert**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-revert) , аналогичные методам [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) с тем же именем. Существуют служебные методы, позволяющие задать идентификатор класса (CLSID) набора свойств, задать время, связанное с набором, и получить статистику по набору свойств. Наконец, метод [**enum**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-enum) создает перечислитель и возвращает указатель на его интерфейс [**иенумстатпропстг**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) . Можно вызывать методы этого интерфейса для перечисления структур [**статпропстг**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropstg) в объекте, которые будут предоставлять сведения обо всех свойствах в текущем наборе свойств.

Ниже приведен пример представления свойств. Если конкретное свойство в наборе свойств содержит экспоненциальное имя животного, это имя можно сохранить как строку, завершающуюся нулем. Хранимая вместе с именем — это признак типа, указывающий, что значение является строкой, завершающейся нулем. Эти свойства могут иметь следующие характеристики.



| Идентификатор свойства | Идентификатор строки | Индикатор типа | Представленное значение              |
|-------------|-------------------|----------------|--------------------------------|
| 02          | Идентификатор процесса \_ анималнаме   | VT \_ LPWSTR     | Строка Юникода, заканчивающаяся нулем |
| 03          | Идентификатор процесса \_ легкаунт     | VT \_ I2         | WORD                           |



 

Любое приложение, которое распознает формат набора свойств, определяя его с помощью идентификатора формата (FMTID), может просматривать свойство с идентификатором PID \_ анималнаме, определять, что это строка с нулевым нулем, а также считывать и записывать значение. Несмотря на то, что приложение может вызывать [**ипропертистораже:: реадмултипле**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-readmultiple) для чтения любого или всех наборов свойств (сначала получил указатель), приложение должно знать, как интерпретировать набор свойств.

Значение свойства передается через интерфейсы свойств в качестве экземпляра типа [**пропвариант**](/windows/win32/api/propidlbase/ns-propidlbase-propvariant).

Важно различать эти хранимые (постоянные) свойства и свойства времени выполнения. Константы значений типа Variant имеют имена, начинающиеся с VT \_ . Однако набор допустимых Пропвариантс не полностью эквивалентен набору вариантов, используемых в автоматизации и элементах управления ActiveX.

Единственное различие между двумя структурами — это допустимый набор \_ тегов VT (типа Variant или VarType) в каждом из них. Если определенный тип свойства может использоваться как в VARIANT, так и в ПРОПВАРИАНТ, тег типа ( \_ значение VT) всегда имеет идентичное значение. Кроме того, для заданного \_ значения VT представление в памяти, используемое в вариантах и пропвариантс, идентично. В совокупности этот подход позволяет системе типов перехватывать запрещенные Теги типов, в то же время позволяя клиентам, которые получают знания, при необходимости реализовать приведение указателя.

Дополнительные сведения см. в следующем разделе, посвященном [вопросам хранения свойств](property-storage-considerations.md).

 

 