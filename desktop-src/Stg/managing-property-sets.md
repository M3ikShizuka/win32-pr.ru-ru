---
title: Управление наборами свойств
description: Набор постоянных свойств содержит связанные данные в виде свойств.
ms.assetid: 19ff2751-87f3-43d8-9307-ce2dd399f694
keywords:
- Управление наборами свойств
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: d8b6b81c466232d4fd325d53a3cfe67ebb1cbc60c757a6dfe135a021ab7892a9
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "117960888"
---
# <a name="managing-property-sets"></a>Управление наборами свойств

Набор постоянных свойств содержит связанные данные в виде свойств. Каждый набор свойств определяется с помощью FMTID и глобально уникального идентификатора (GUID), который позволяет приложениям получать доступ к набору свойств, чтобы идентифицировать набор свойств. С помощью этой идентификации приложение интерпретирует свойства, которые содержит набор.

Например, свойства форматирования символов в текстовом процессоре или атрибуты отрисовки элемента в программе рисования являются наборами свойств.

COM определяет интерфейс [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) для упрощения управления наборами свойств. С помощью методов этого интерфейса можно создать новый набор свойств или открыть или удалить существующий набор свойств. Кроме того, он предоставляет метод, который создает перечислитель и предоставляет указатель на его интерфейс [**иенумстатпропсетстг**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) . Вы можете вызывать методы этого интерфейса для перечисления структур [**статпропсетстг**](/windows/win32/api/propidlbase/nn-propidlbase-ienumstatpropsetstg) в объекте, которые будут предоставлять сведения обо всех наборах свойств объекта.

При создании или открытии экземпляра [**ипропертистораже**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage)аналогичен открытию объекта, который поддерживает [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) или [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream), поскольку необходимо указать режим хранения, в котором будет открыт интерфейс. Для **IStorage** они включают режим транзакции, режим чтения/записи и режим общего доступа.

При создании набора свойств с вызовом метода [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)укажите, является ли свойство простым или непростым. простой набор свойств содержит типы, которые можно полностью записать в потоке набора свойств, который должен быть ограничен размером, и не может превышать 256 кб в Windows NT 4,0 и более ранних версий или 1 мб в Windows 2000, Windows XP и Windows Server 2003. Тем не менее, если необходимо сохранить больший объем информации в наборе свойств, можно указать, что свойство является непростым. Это позволяет использовать один или несколько типов, указывающих только указатель на объект хранилища или поток. Эти типы представляют собой \_ поток VT, \_ ПОТОКОВЫЕ объекты VT, \_ хранилище VT и \_ \_ объект VT.

данные, хранящиеся в этих свойствах, не учитываются с ограничением на размер набора свойств 256 кб в Windows NT 4,0 или более ранней версии либо на ограничение в 1 мб в Windows 2000, Windows XP и Windows Server 2003. Однако данные о свойстве, такие как имя, применяются. Кроме того, если требуется обновление транзакций, набор свойств должен быть непростым. Конечно, есть определенный выигрыш в производительности при открытии этих типов, так как он требует открытия потока или объекта хранилища, на который имеется указатель.

Если приложение использует составные файлы, можно использовать реализацию этих интерфейсов, предоставляемую моделью COM, которая реализуется в объекте хранилища составных файлов COM.

Каждый набор свойств состоит в основном из логически подключенной группы свойств, как описано в разделе [Управление свойствами](managing-properties.md).

Дополнительные сведения о наборах свойств в COM см. в следующих статьях:

-   [Реализация наборов свойств в COM](property-set-implementations-in-com.md)
-   [Рекомендации по установке свойств](property-set-considerations.md)
-   [Рекомендации по реализации IPropertySetStorage](ipropertysetstorage-implementation-considerations.md)
-   [Хранение наборов свойств](storing-property-sets.md)
-   [Характеристики производительности](performance-characteristics.md)
-   [Реализация набора свойств сводных данных](implementing-the-summary-information-property-set.md)

 

 