---
title: Преимущества структурированного хранилища
description: COM предоставляет набор служб, которые совместно называют структурированным хранилищем.
ms.assetid: d05d2dbc-d1d2-4ef8-a773-5337e2746da3
keywords:
- Структурированное хранилище Стрктд STG, преимущества
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: e68b954fda33e18f654ccc0360f58ddb14e5d110
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "103773745"
---
# <a name="benefits-of-structured-storage"></a>Преимущества структурированного хранилища

COM предоставляет набор служб, которые совместно называют структурированным хранилищем. Преимущество этих служб заключается в снижении потерь производительности и издержек, связанных с хранением отдельных объектов в неструктурированном файле. Вместо неструктурированного файла COM хранит отдельные объекты в одном структурированном файле, состоящем из двух основных элементов: объектов хранилища и объектов потока. Вместе они работают как файловая система в файле.

Структурированное хранилище позволяет решить проблемы с производительностью, избавляя от необходимости полностью перезаписывать файл в хранилище при добавлении нового объекта в составной файл или при увеличении размера существующего объекта. Новые данные записываются в следующее доступное место в постоянном хранилище, а объект хранилища обновляет таблицу указателей, которую он поддерживает, чтобы отследить расположение объектов хранилища и объекты потока. В то же время структурированное хранилище позволяет конечным пользователям взаимодействовать с составным файлом и управлять им, как если бы он был отдельным файлом, а не вложенной иерархией отдельных объектов.

Структурированное хранилище также имеет и другие преимущества:

-   **Добавочный доступ**. Если пользователю требуется доступ к объекту в составном файле, пользователь может загрузить и сохранить только этот объект, а не весь файл.
-   **Множественное использование**. Несколько конечных пользователей или приложений могут одновременно считывать и записывать данные в один и тот же составной файл.
-   **Обработка транзакций**. Пользователи могут выполнять чтение или запись в составные файлы COM в режиме транзакций, где изменения, вносимые в файл, помещаются в буфер и затем могут быть зафиксированы в файле или отменены.
-   **Сохранение нехватки памяти**. Структурированное хранилище предоставляет средства для сохранения файлов в ситуациях нехватки памяти.

 

 




