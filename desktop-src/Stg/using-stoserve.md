---
title: Использование Стосерве
description: Стосерве — это библиотека DLL, которая в основном предназначена для COM-сервера.
ms.assetid: 32cb284a-de78-4953-9d8e-5bb87d6d5a97
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7e3a220f03e17892b02a94c1e76bafc4a869c0922973c7277589627d233175a3
ms.sourcegitcommit: e6600f550f79bddfe58bd4696ac50dd52cb03d7e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "120034754"
---
# <a name="using-stoserve"></a>Использование Стосерве

**Стосерве** — это библиотека DLL, которая в основном предназначена для COM-сервера. Хотя он может быть неявно загружен путем связывания со связанным с ним. LIB-файл обычно используется после явного вызова LoadLibrary, обычно из COM-функции [**кожетклассобжект**](/windows/win32/api/combaseapi/nf-combaseapi-cogetclassobject). **Стосерве** — это самостоятельная регистрация внутрипроцессного сервера.

Чтобы использовать **стосерве**, клиентской программе не нужно включать стосерве. H или ссылку на СТОСЕРВЕ. LIB. COM-клиент **стосерве** получает доступ исключительно через CLSID объекта и службы COM. Для **стосерве** этот CLSID является CLSID \_ дллпапер (ОПРЕДЕЛЕН в файле папгуидс. H в \\ каталоге с общим родителем Inc.) В примере кода [стоклиен](structured-storage-client-sample--stoclien-.md) показано, как клиент получает этот доступ.

Файл makefile, который создает этот пример, автоматически регистрирует сервер в реестре. Можно вручную инициировать самостоятельную регистрацию, выполнив следующую команду в командной строке в каталоге **стосерве** :

 **Регистрация** NMAKE

При этом предполагается, что среда компиляции настроена. Если нет, можно также напрямую вызвать команду REGISTER.EXE в командной строке, находясь в каталоге **стосерве** .

**..\\ регистрация \\register.exe** **stoserve.dll**

Для этих команд регистрации требуется предварительная сборка образца REGISTER в этой серии, а также предыдущие сборки STOSERVE.DLL.

В этой серии файлы Makefile используют служебную программу REGISTER.EXE из примера REGISTER. Последние выпуски пакета SDK платформы и Visual C++ включают служебную программу REGSVR32.EXE, которая может использоваться аналогичным образом для регистрации серверов обработки и упаковки библиотек DLL.

**Стосерве** использует многие служебные классы и службы, предоставляемые аппутил. Чтобы получить дополнительные сведения о АППУТИЛ, изучите исходный код библиотеки АППУТИЛ в каталоге одноуровневых АППУТИЛ и APPUTIL.HTM в главном каталоге Tutorial.

 

 