---
title: Создание и запуск примера Стоклиен
description: Стоклиен работает совместно со современным объектом на COM-сервере для обеспечения постоянного хранения чертежей в составных файлах COM.
ms.assetid: bf622104-10dd-4649-88f0-e2bfb15289b1
keywords:
- Создание и запуск примера Стоклиен
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 4d3d9526e81fc3fb2d6a0cfb03e8943ccf68688096588122da87861d8c88e531
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "119663464"
---
# <a name="create-and-run-stoclien-sample"></a>Создание и запуск примера Стоклиен

**Стоклиен** работает совместно со современным объектом на com-сервере для обеспечения постоянного хранения чертежей в составных файлах com. Дополнительные сведения об использовании потоков в составном файле, предоставляемом для **Состоклиени**, см. в разделе [**стосерве**](structured-storage-server-sample--stoserve-.md) Sample and STOSERVE.HTM. Конструкция собумаги и ее интерфейс Ипапер также рассматриваются в примере **стосерве** .

## <a name="code-tour"></a>Обзор кода

В этом обзоре кода рассматриваются следующие основные темы:

-   Как **кгуипапер** инкапсулирует поведение графического интерфейса пользователя в электронном документе **стоклиен**
-   Как **стоклиен** фиксирует и отображает интерактивное действие рисования
-   Как объект **кгуипапер** использует собумагу для записи данных о рисовании
-   Использование подключения Ипаперсинк в перерисовки
-   Как методы Кпапфиле **Load** и **Save** используют структурированное хранилище в составных файлах

Так как класс **кгуибалл** , используемый в примерах ФРЕКЛИЕН и конклиен, инкапсулирует поведение Bounce-шарика, **Стоклиен** использует класс **кгуипапер** C++ для инкапсуляции данных и графического пользовательского интерфейса электронного документа.

В следующей таблице перечислены файлы, относящиеся к примеру **стоклиен** .



| Файлы        | Описание                                                                                                                      |
|--------------|----------------------------------------------------------------------------------------------------------------------------------|
| STOCLIEN.TXT | Краткое описание образца.                                                                                                        |
| ФАЙЛЫ     | Универсальный файл makefile для создания примера кода.                                                                               |
| СТОКЛИЕН. Высоты   | Включаемый файл для приложения **стоклиен** . Содержит объявления классов, прототипы функций и идентификаторы ресурсов.   |
| СТОКЛИЕН. CPP | Основной файл реализации для STOCLIEN.EXE. Содержит реализацию WinMain и Кмаинвиндов, а также установку главного меню. |
| СТОКЛИЕН. RC  | Файл определения ресурса приложения.                                                                                        |
| СТОКЛИЕН. ICO | Ресурс значка приложения.                                                                                                   |
| СТОКЛИЕН. PAP | Файл рисунка бумаги по умолчанию для приложения.                                                                                |
| «. ВЫРАВНИВАНИ   | Изображение карандаша для курсора окна клиента.                                                                                     |
| Радиатор. Высоты       | Объявление класса для класса COM-объекта Копаперсинк.                                                                      |
| Радиатор. CPP     | Файл реализации класса COM-объекта Копаперсинк.                                                                        |
| ПАПФИЛЕ. Высоты    | Объявление класса для класса **кпапфиле** C++.                                                                            |
| ПАПФИЛЕ. CPP  | Файл реализации для класса **кпапфиле** C++.                                                                              |
| ГУИПАПЕР. Высоты   | Объявление класса для класса **кгуипапер** C++.                                                                           |
| ГУИПАПЕР. CPP | Файл реализации для класса **кгуипапер** C++.                                                                             |
| СТОКЛИЕН. DSP | Microsoft Visual Studio Project файл.                                                                                            |



 

## <a name="compound-files"></a>Составные файлы

**Стоклиен** использует собумагу для записи данных о рисовании. Он также использует собумагу для хранения данных в составном файле. Однако в типичном разделении ресурсов между клиентом и сервером COM **стоклиен** разделяет ответственность за хранение файлов. Это разделение рабочих ролей играет важную роль в приложениях COM, где клиент является контейнером, а сервер является внедренным объектом. В этом случае клиент отвечает за создание или открытие структурированного файла хранилища, в то время как объект Server отвечает за использование этого хранилища для собственных целей хранения данных. Это может затрагивать объект сервера, создающий подхранилища в хранилище, которое ему предоставлено. Обычно он включает объект Server, создающий объекты потока в хранилище. Использование потоков хранилища в документе подробно описано в примере **стоклиен** .

Интерфейс [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) используется объектами клиента и сервера для выполнения операций с файлами. используется реализация составных файлов архитектуры структурированного служба хранилища. Стандартные функции службы используются для операций с составными файлами. Например, функция [**стгкреатедокфиле**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatedocfile) изначально создает составной файл и передает указатель **IStorage** , который может использоваться для работы с файлом. Эта конкретная функция вызывается в **стоклиен**. Интерфейс **IStorage** , который он получает, передается в качестве параметра собумагам для использования. Объект совместной печати не создает и не открывает собственные составные файлы. он использует интерфейсы **IStorage** и [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) для работы с предоставленными им составными файлами.

Эти интерфейсы [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) и [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) не реализованы в **стоклиен** или **стосерве**. Они реализуются в библиотеках COM. При получении указателя на один из этих интерфейсов их методы по сути используются в качестве набора служб для работы с составным файлом.

 

 




