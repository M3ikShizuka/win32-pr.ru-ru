---
title: Константы ПРОПСЕТФЛАГ (Пропидл. h)
description: Определите характеристики набора свойств.
ms.assetid: 6f865c8f-bbca-4122-b076-14f2bc56f292
topic_type:
- apiref
api_name:
- PROPSETFLAG_DEFAULT
- PROPSETFLAG_NONSIMPLE
- PROPSETFLAG_ANSI
- PROPSETFLAG_UNBUFFERED
- PROPSETFLAG_CASE_SENSITIVE
api_location:
- Propidl.h
api_type:
- HeaderDef
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: e8f31d7b2659eeaa003c1a0d15103e94ad1a5c89
ms.sourcegitcommit: a1494c819bc5200050696e66057f1020f5b142cb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/12/2020
ms.locfileid: "103988707"
---
# <a name="propsetflag-constants"></a>Константы ПРОПСЕТФЛАГ

Константы ПРОПСЕТФЛАГ определяют характеристики набора свойств. Значения, перечисленные в следующей таблице, используются в параметре *грффлагс* методов [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) , функции [**стгкреатепропстг**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg) и функции [**стгопенпропстг**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg) .



| Константа/значение                                                                                                                                                                                                                                               | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span id="PROPSETFLAG_DEFAULT"></span><span id="propsetflag_default"></span><dl> <dt>**Пропсетфлаг \_ ПО УМОЛЧАНИю**</dt> <dt>0</dt> </dl>                       | Если параметр left не указан, то по умолчанию в набор свойств могут быть записаны только простые значения свойств. Использование простых значений свойств предотвращает транзакционные наборы свойств в составном файле и изолированных реализациях [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage). Для этой цели необходимо использовать значения свойств, отличных от e.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| <span id="PROPSETFLAG_NONSIMPLE"></span><span id="propsetflag_nonsimple"></span><dl> <dt>**Пропсетфлаг \_ Непростая**</dt> <dt>1</dt> </dl>                 | Если указано, непростые значения свойств могут быть записаны в набор свойств, а набор свойств сохраняется в объекте хранилища. Непростые значения свойств включают в себя объекты с VARTYPE хранилища VT \_ , VT \_ Stream, объект VT \_ , хранящийся \_ \_ потоковый объект VT \_ . Если этот флаг не указан, непростые типы не могут быть записаны в набор свойств. В составном файле и изолированных реализациях наборы свойств могут быть транзакционными, только если указано **пропсетфлаг \_ непростое** .<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| <span id="PROPSETFLAG_ANSI"></span><span id="propsetflag_ansi"></span><dl> <dt>**Пропсетфлаг \_ ANSI**</dt> <dt>2</dt> </dl>                                | Если задано значение, все строковые значения в наборе свойств, которые не являются явно заданными в Юникоде, т. е. Кроме VT \_ LPWSTR, хранятся в текущей системной кодовой странице ANSI. Дополнительные сведения см. в разделе [**жетакп**](/windows/desktop/api/winnls/nf-winnls-getacp). Использовать это значение не рекомендуется. Дополнительные сведения см. в подразделе "Примечания".<br/> Если это значение отсутствует, строковые значения в новом наборе свойств хранятся в Юникоде. Степень контроля, предоставляемая этим значением, необходима, чтобы клиенты, использующие интерфейсы, связанные со свойствами, могли взаимодействовать со стандартными наборами свойств, такими как сводные данные OLE2, которые могут существовать в кодовой странице ANSI.<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| <span id="PROPSETFLAG_UNBUFFERED"></span><span id="propsetflag_unbuffered"></span><dl> <dt>**Пропсетфлаг \_ Без БУФЕРИЗАЦИи**</dt> <dt>4</dt> </dl>              | Используется только с функциями [**стгкреатепропстг**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg) и [**стгопенпропстг**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg) ; то есть в изолированных реализациях интерфейсов набора свойств. Если этот параметр указан в этих функциях, изменения в наборе свойств не буферизуются. Вместо этого изменения всегда записываются непосредственно в набор свойств. Вызовы методов набора свойств [**ипропертистораже**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) изменятся. Однако по умолчанию изменения буферизованы во внутренний кэш набора свойств и затем записываются в свойство, заданное при вызове метода [**ипропертистораже:: Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) . <br/> Установка **пропсетфлаг без \_ буферизации** приводит к снижению производительности, так как внутренний буфер набора свойств автоматически очищается после каждого изменения набора свойств. Однако непосредственная запись изменений предотвратит проблемы координации. Например, если объект хранилища открыт в режиме транзакций, а набор свойств буферизован. Затем, если вызвать метод [**IStorage:: Commit**](/windows/desktop/api/Objidl/nf-objidl-istorage-commit) объекта хранилища, изменения набора свойств не будут выбраны как часть транзакции, так как они находятся в буфере, который еще не был сброшен. Необходимо вызвать метод [**ипропертистораже:: Commit**](/windows/desktop/api/Propidl/nf-propidl-ipropertystorage-commit) перед вызовом **IStorage:: Commit** для очистки буфера набора свойств перед фиксацией изменений в хранилище. В качестве альтернативы выполнению двух вызовов можно установить **пропсетфлаг без \_ буферизации** , чтобы изменения всегда записывались непосредственно в набор свойств и никогда не помещаются в буфер во внутреннем кэше набора свойств. Затем изменения будут отобраны при фиксации хранилища транзакций.<br/> |
| <span id="PROPSETFLAG_CASE_SENSITIVE"></span><span id="propsetflag_case_sensitive"></span><dl> <dt>**Пропсетфлаг \_ \_С учетом регистра**</dt> <dt>8</dt> </dl> | Если указано, в именах свойств учитывается регистр. Имена свойств с учетом регистра возможны только в формате сериализации набора свойств версии 1. Дополнительные сведения см. в разделе [Свойства Сериализация набора свойств](version-0-vs--version-1-property-set-serialization.md).<br/>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |



## <a name="remarks"></a>Комментарии

Эти значения можно установить и проверить с помощью побитовых операций, которые определяют, как создаются и открываются наборы свойств. Наборы свойств создаются с помощью метода [**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create) или функции [**стгкреатепропстг**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg) . Они открываются с помощью метода [**IPropertySetStorage:: Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open) или функции [**стгопенпропстг**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg) .

Рекомендуется создавать наборы свойств в Юникоде, не устанавливая флаг **\_ ANSI пропсетфлаг** в параметре *грффлагс* . Также рекомендуется избегать использования \_ значений VT LPSTR и использовать \_ вместо них значения VT LPWSTR. Если кодовая страница набора свойств — Unicode, \_ строковые значения VT LPSTR преобразуются в Юникод при сохранении и преобразуются обратно в многобайтовые строковые значения при извлечении. Если кодовая страница набора свойств не является Юникодом, имена свойств, строки VT \_ и непростые значения свойств преобразуются в многобайтовые строки при сохранении и преобразуются обратно в Юникод при извлечении, то все используют текущую системную кодовую страницу ANSI.

## <a name="requirements"></a>Требования



| Требование | Значение |
|-------------------------------------|--------------------------------------------------------------------------------------|
| Минимальная версия клиента<br/> | Windows 2000 Professional \[только классические приложения\]<br/>                           |
| Минимальная версия сервера<br/> | Windows 2000 Server \[только классические приложения\]<br/>                                 |
| Заголовок<br/>                   | <dl> <dt>Пропидл. h</dt> </dl> |



## <a name="see-also"></a>См. также раздел

<dl> <dt>

[**фмтидтопропстгнаме**](/windows/desktop/api/coml2api/nf-coml2api-fmtidtopropstgname)
</dt> <dt>

[**IPropertySetStorage:: Create**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-create)
</dt> <dt>

[**IPropertySetStorage:: Open**](/windows/desktop/api/Propidl/nf-propidl-ipropertysetstorage-open)
</dt> <dt>

[**пропстгнаметофмтид**](/windows/desktop/api/coml2api/nf-coml2api-propstgnametofmtid)
</dt> <dt>

[**стгкреатепропсетстг**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropsetstg)
</dt> <dt>

[**стгкреатепропстг**](/windows/desktop/api/coml2api/nf-coml2api-stgcreatepropstg)
</dt> <dt>

[**стгопенпропстг**](/windows/desktop/api/coml2api/nf-coml2api-stgopenpropstg)
</dt> </dl>

 

