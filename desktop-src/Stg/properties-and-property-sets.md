---
title: Свойства и наборы свойств
description: Хотя типы свойств времени выполнения, предлагаемые автоматизацией и элементами управления Microsoft ActiveX, являются важными, они не требуют непосредственного хранения информации с объектами, сохраняемыми в файловой системе.
ms.assetid: 350cfb84-2f8e-46e7-a70d-09beb14a8eee
keywords:
- Структурированное хранилище Стрктд STG, основы, свойства и наборы свойств
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 7fdafcbef0e92479aa628ab119b6d961abb74d82
ms.sourcegitcommit: 2d531328b6ed82d4ad971a45a5131b430c5866f7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/16/2019
ms.locfileid: "104411442"
---
# <a name="properties-and-property-sets"></a>Свойства и наборы свойств

Хотя типы свойств времени выполнения, предлагаемые автоматизацией и элементами управления Microsoft ActiveX, являются важными, они не требуют непосредственного хранения информации с объектами, сохраняемыми в файловой системе. Эти сущности могут включать файлы (структурированные, составные и т. д.), каталоги и Сводные каталоги. COM предоставляет как стандартный сериализованный формат для этих постоянных свойств, так и набор интерфейсов и функций, которые позволяют создавать наборы свойств и их свойства, а также управлять ими.

Постоянные свойства хранятся в виде наборов, а один или несколько наборов могут быть связаны с сущностью файловой системы. Эти постоянные наборы свойств предназначены для хранения данных, которые предназначены для представления в виде коллекции детализированных значений. Они не предназначены для использования в качестве базы данных большого размера. Они могут использоваться для хранения сводных данных об объекте в системе, к которым затем можно получить доступ любым другим объектом, который понимает, как интерпретировать этот набор свойств.

Предыдущие версии COM задаются очень мало по отношению к свойствам и их использованию, но определили сериализованный формат, который позволял разработчикам хранить свойства и наборы свойств в экземпляре [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) . Были также определены идентификаторы и семантику одного набора свойств, используемого для сводных сведений о документе. В этот момент требовалось создавать структуру и манипулировать ею непосредственно в виде потока данных. См. раздел [структурированное хранилище. формат набора свойств сериализованный](structured-storage-serialized-property-set-format.md).

Однако теперь COM определяет два основных интерфейса для управления наборами свойств:

-   [**ипропертистораже**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage)
-   [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage)

Больше не нужно напрямую работать с сериализованным форматом, когда эти интерфейсы реализуются на объекте, поддерживающем интерфейс [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage) (например, составные файлы). При записи свойств с помощью [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) и [**ипропертистораже**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) создаются данные, которые точно соответствуют формату набора свойств COM, как они просматриваются с помощью методов **IStorage** . Обратное также верно. свойства, записываемые в формат набора свойств COM с помощью **IStorage** , видимы через **IPropertySetStorage** и **ипропертистораже** (хотя вы не можете выполнять запись в [**IStream**](/windows/desktop/api/Objidl/nn-objidl-istream) и иметь свойства через **ипропертистораже** немедленно, или наоборот).

Интерфейс [**IPropertySetStorage**](/windows/desktop/api/Propidl/nn-propidl-ipropertysetstorage) определяет методы, которые создают наборы свойств и управляют ими. Интерфейс [**ипропертистораже**](/windows/desktop/api/Propidl/nn-propidl-ipropertystorage) напрямую управляет свойствами в наборе свойств. Вызывая методы этих интерфейсов, разработчик приложения может управлять тем, какие наборы свойств подходят для данной сущности файловой системы. Использование этих интерфейсов предоставляет одну настроенную для чтения и записи реализацию свойств, а не реализацию в каждом приложении, где может быть узким местом производительности, например инцессант поиска. Вы можете реализовать интерфейсы для повышения производительности, чтобы свойства могли быть прочитаны и записаны быстрее, например, более эффективным кэшированием. Более того, **ипропертистораже** и **IPropertySetStorage** позволяют управлять свойствами сущностей, которые не поддерживают [**IStorage**](/windows/desktop/api/Objidl/nn-objidl-istorage), хотя в целом большинство приложений этого не делает.

В этом разделе рассматриваются следующие вопросы.

-   [Набор свойств сводных данных](the-summary-information-property-set.md)
-   [Стандартные идентификаторы формата набора свойств](predefined-property-set-format-identifiers.md)
-   [Свойства Документсуммаринформатион и Пользователяопределенные задают](the-documentsummaryinformation-and-userdefined-property-sets.md)

## <a name="related-topics"></a>См. также

<dl> <dt>

[Реализация наборов свойств в COM](property-set-implementations-in-com.md)
</dt> <dt>

[Рекомендации по установке свойств](property-set-considerations.md)
</dt> <dt>

[Управление свойствами](managing-properties.md)
</dt> <dt>

[Управление наборами свойств](managing-property-sets.md)
</dt> <dt>

[Хранение наборов свойств](storing-property-sets.md)
</dt> <dt>

[Характеристики производительности](performance-characteristics.md)
</dt> </dl>

 

 




