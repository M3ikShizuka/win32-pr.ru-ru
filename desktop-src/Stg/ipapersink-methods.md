---
title: Методы Ипаперсинк
description: Собумага предоставляет интерфейс IConnectionPointContainer, чтобы клиенты могли подключаться к сопоставлению, чтобы получать уведомления об указанных событиях, происходящих в соотношении.
ms.assetid: 2466c721-b275-4dbc-a604-2d5e6a29d6a1
ms.topic: reference
ms.date: 05/31/2018
ms.openlocfilehash: ac8dee615b278c5214ad1efa3c10d22759620103
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104260966"
---
# <a name="ipapersink-methods"></a>Методы Ипаперсинк

Собумага предоставляет интерфейс [**IConnectionPointContainer**](/windows/win32/api/ocidl/nn-ocidl-iconnectionpointcontainer) , чтобы клиенты могли подключаться к сопоставлению, чтобы получать уведомления об указанных событиях, происходящих в соотношении. При предоставлении доступа к этому интерфейсу собумага превращается в подключаемый объект. Клиент может вызвать [**QueryInterface**](/windows/win32/api/unknwn/nf-unknwn-iunknown-queryinterface(q)) для этого интерфейса и использовать его для получения точек соединения объекта. Участие клиента в этой схеме рассматривается в соответствующем образце **стоклиен** .

В сущности, клиент реализует, что называется приемником в виде объекта приемника с интерфейсом приемника. Интерфейс приемника получает исходящие вызовы уведомлений о событиях из собумаги после того, как приемник правильно соединен клиентом с экземпляром собумаги. Клиент устанавливает соединение с помощью объекта точки соединения, который управляется собумагами. В одном подключаемом COM-объекте может быть несколько точек соединения. В образце **стосерве** собумага имеет только одну точку соединения, которая обрабатывает события бумажной бумаги.

Любое число клиентов может подключаться к одной точке соединения. \_Точка подключения коннпоинт паперсинк в сохранит группу соединений, которые могут динамически увеличиваться во время выполнения. Полные сведения о поддержке подключаемых объектов кобумага кодируются в файле CONNECT. H и ПОДКЛЮЧИТЕсь. CPP и не будет рассматриваться здесь. Эта конструкция очень похожа на то, что было в примере для сохранения кода.

Клиент **стоклиен** реализует соответствующие объекты приемника для точек подключения, которые он ожидает найти в содокументе. Из контекста собумаги важный объект приемника, который **стоклиен** реализует, предоставляет интерфейс **ипаперсинк** . Это исходящий интерфейс, используемый содокументом для уведомления **стоклиен** различных событий в содокументе.

Ниже приведена сводка методов в **ипаперсинк** из ипапер. H в \\ каталоге с общим родителем Inc.



| Метод   | Описание                                                   |
|----------|---------------------------------------------------------------|
| Заблокировано   | Клиент получает контроль над документом и блокирует его.           |
| Открыт | Клиент имеет непредусмотренный контроль над бумагой.               |
| Загружен   | Клиент загрузил бумажное содержимое из своего составного файла. |
| Сохранено    | Клиент сохранил содержимое бумаги в свой составной файл.    |
| инкстарт | Клиент запустил последовательность рисования цветной краски на бумаге.   |
| инкдрав  | Клиент помещает точки данных рукописного ввода на бумаге.     |
| инкстоп  | Клиент остановил свою последовательность рукописного рисования на бумаге.   |
| Удалены   | Клиент удаляет все рукописные данные из бумаги.              |
| Изменен  | Размер документа изменился клиентом.                               |



 

Эти методы в основном говорят сами за себя. Хотя приемник должен реализовывать все эти методы в некоторой манере, многие из них реализуются как заглушки и не используются в  / примерах стосерве **стоклиен** .

Важным методом, используемым в этих примерах, является загруженный метод. Когда клиент получает сообщение о загрузке нового документа из файла, ему требуется способ уведомления клиента о загрузке новых данных. Для этого сопечатка вызывает **ипаперсинк:: Loaded** в приемнике клиента. После этого клиент может вызвать [**ипапер:: Redraw**](ipaper--redraw.md) , чтобы запросить, что собумага воспроизводила новые данные клиенту. Перерисовка вызывает перерисовку загруженного рисунка на экране клиента. После завершения загрузки недавно загруженный документ автоматически отображается в окне, предоставленном клиентом.

Полные сведения о подключении этого метода Ипапер к **ипаперсинк** см. в разделе [**ипапер:: Redraw**](ipaper--redraw.md) .

Методы **Ипаперсинк** **инкстарт**, **инкдрав** и **инкстоп** используются для отправки отдельных пакетов рукописных данных обратно клиенту. При приеме клиент выводит их на экран так же, как и при первоначальной отправке их в собумагу. Приведенная выше логика достаточно велика, чтобы позволить нескольким клиентам прослушивать одну и ту же \_ точку подключения коннпоинт паперсинк. Если общий экземпляр совместной печати был общим для этих клиентов, все они могут отображать один и тот же рисунок путем подключения к этой точке подключения.

 

 