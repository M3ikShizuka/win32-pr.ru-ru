---
title: Отправка данных ASF в точку публикации
description: Отправка данных ASF в точку публикации
ms.assetid: 8f01beae-4270-4cf5-afff-3f7014cae90f
keywords:
- Windows Пакет SDK для формата мультимедиа, отправка данных ASF
- Windows Пакет SDK для формата мультимедиа, точки публикации
- Расширенный системный формат (ASF), отправка данных
- ASF (Расширенный системный формат), отправка данных
- Расширенный системный формат (ASF), точки публикации
- ASF (Расширенный системный формат), точки публикации
- точки публикации
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 71f70c1a49ea7ff6272d0eef9f1a51ff79ec216ed9af445c3078d59dd19841dd
ms.sourcegitcommit: e858bbe701567d4583c50a11326e42d7ea51804b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/11/2021
ms.locfileid: "118197543"
---
# <a name="sending-asf-data-to-a-publishing-point"></a>Отправка данных ASF в точку публикации

пакет SDK для Windows media Format можно использовать для отправки данных ASF в точку публикации на сервере мультимедиа Windows. Затем сервер передает данные из этой точки публикации. Этот сценарий полезен при записи или повторном кодировании содержимого на одном компьютере и необходимости распространения содержимого с другого компьютера (или нескольких компьютеров). это также полезно, если необходимо переместить содержимое с компьютера, находящегося в брандмауэре, на Windowsный сервер мультимедиа за пределами брандмауэра, так как для распространения push-уведомлений используется протокол HTTP.

> [!Note]  
> *Точка публикации* действует по сути как перенаправитель. Клиент указывает точку публикации в URL-адресе (например, mms://MyServer/MyPublishingPoint), и сервер преобразует это в запрос содержимого.

 

Чтобы отправить данные в точку публикации, присоедините объект приемника push-уведомлений к объекту модуля записи. Приемник push-уведомлений используется для открытия подключения к серверу и управления сеансом принудительной отправки. Объект модуля записи обрабатывает все остальные аспекты создания файла.

Выполните следующие действия:

1.  Создайте объект модуля записи, вызвав функцию [**вмкреатевритер**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-wmcreatewriter) , которая возвращает указатель [**ивмвритер**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmwriter) .
2.  Создайте объект приемника push-уведомлений, вызвав функцию [**вмкреатевритерпушсинк**](/previous-versions/windows/desktop/api/wmsdkidl/nf-wmsdkidl-wmcreatewriterpushsink) , которая возвращает указатель [**ивмвритерпушсинк**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmwriterpushsink) .
3.  Подключите сетевой приемник к модулю записи, вызвав [**ивмвритерадванцед:: аддсинк**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriteradvanced-addsink) в модуле записи, указав указатель на интерфейс **ивмвритерпушсинк** сетевого приемника.
4.  Подключение на сервер путем вызова [**ивмвритерпушсинк:: Подключение**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriterpushsink-connect).
5.  запись потока; Этот шаг включает настройку профиля для объекта модуля записи, отправку образцов в модуль записи и, возможно, другие задачи. Дополнительные сведения см. в разделе [запись файлов ASF](writing-asf-files.md). Дополнительные задачи могут включать в себя задание атрибутов метаданных (как описано в разделе [Работа с метаданными](working-with-metadata.md)) или задание динамического управления цифровыми правами (DRM) в потоке (как описано в разделе [Включение поддержки DRM](enabling-drm-support.md)). Эти задачи выполняются в точности так же, как и для записи файлов ASF.
6.  После завершения записи вызовите [**ивмвритерадванцед:: ремовесинк**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriteradvanced-removesink) в модуле записи, чтобы отсоединить объект приемника Push.
7.  Вызовите [**ивмвритерпушсинк:: EndSession**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmwriterpushsink-endsession) в приемнике push-уведомлений, чтобы завершить сеанс с сервером.

Эти шаги показаны в примере приложения Вмвнетврите.

> [!Note]  
> Если вы отправляете файл только для видео с очень низкими темпами, он может не начать играть на точке публикации в течение нескольких секунд. Это может произойти в различных случаях, например, когда один пакет содержит много мелких видеокадров и не имеет звукового сигнала, или если между первым пакетом и вторым пакетом в видеофайле с низким уровнем поразрядной скоростью существует длительный промежуток времени. Чтобы избежать этой проблемы, вставьте в файл тихий аудиопоток.

 

## <a name="authentication"></a>Аутентификация

Проверка подлинности на сервере автоматически обрабатывается объектом извещающего приемника. Однако приложению может потребоваться предоставить учетные данные. Это делается через интерфейс обратного вызова **ивмкредентиалкаллбакк** , как показано ниже.

1.  Реализуйте интерфейс [**ивмстатускаллбакк**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmstatuscallback) и [**ивмкредентиалкаллбакк**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmcredentialcallback) в приложении.
2.  Запросите объект приемника push-уведомлений для интерфейса [**ивмрегистеркаллбакк**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmregistercallback) .
3.  Вызовите [**ивмрегистеркаллбакк:: Advise**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmregistercallback-advise) с указателем на интерфейс **ивмстатускаллбакк** вашего приложения.
4.  Если приемнику push-уведомлений необходимо получить учетные данные из приложения, он запрашивает **ивмстатускаллбаккный** указатель для интерфейса **Ивмкредентиалкаллбакк** и вызывает [**ивмкредентиалкаллбакк:: аккуирекредентиалс**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmcredentialcallback-acquirecredentials). Сведения об этом методе см. в разделе [Проверка подлинности](authentication.md).
5.  По завершении вызовите [**ивмрегистеркаллбакк:: unadvise**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmregistercallback-unadvise) , чтобы не получать уведомления о событиях из приемника push-уведомлений.

## <a name="related-topics"></a>Связанные темы

<dl> <dt>

[**Отправка данных ASF по сети**](sending-asf-data-over-a-network.md)
</dt> <dt>

[**Работа с приемниками модуля записи**](working-with-writer-sinks.md)
</dt> <dt>

[**Объект приемника push-уведомлений**](writer-push-sink-object.md)
</dt> </dl>

 

 




