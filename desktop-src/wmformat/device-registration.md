---
title: Регистрация устройства
description: Регистрация устройства
ms.assetid: 64a6f366-1317-47b6-94a2-ca2ef14d1f88
keywords:
- Windows Media Format SDK, регистрация устройств
- Windows Media Format SDK, регистрация устройств
- Расширенный формат систем (ASF), регистрация устройств
- ASF (Расширенный системный формат), регистрация устройства
- Расширенный формат систем (ASF), регистрация устройств
- ASF (Расширенный системный формат), регистрация устройств
- Управление цифровыми правами (DRM), регистрация устройств
- DRM (Управление цифровыми правами), регистрация устройства
- Управление цифровыми правами (DRM), регистрация устройств
- DRM (Управление цифровыми правами), регистрация устройств
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: fcf4954d9b59abfb62f3a86127a387299d45cb4a
ms.sourcegitcommit: 48d1c892045445bcbd0f22bafa2fd3861ffaa6e7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/19/2020
ms.locfileid: "104069566"
---
# <a name="device-registration"></a>Регистрация устройства

Пакет SDK для формата Windows Media предоставляет доступ к базе данных регистрации устройств. Эта база данных защищена на клиентском компьютере и используется для регистрации устройств, поддерживающих Windows Media DRM 10 для сетевых устройств.

При добавлении устройства в сеть, к которой подключен клиентский компьютер, устройство пытается связаться с приложением передатчика Windows Media DRM 10 для сетевых устройств. После установления связи устройство отправляет сообщение с запросом на регистрацию.

При получении сообщения с запросом на регистрацию приложение должно выполнить следующие действия:

1.  Проанализируйте сообщение, вызвав метод [**ивмдрммессажепарсер::P арсерегистратионрекмсг**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmdrmmessageparser-parseregistrationreqmsg) . Этот метод извлекает сертификат устройства и серийный номер устройства, которые необходимы для обнаружения устройства.
2.  Вызовите метод [**ивмдевицерегистратион:: жетрегистереддевицебид**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmdeviceregistration-getregistereddevicebyid) , передав сертификат и серийный номер устройства, полученные на шаге 1. Если устройство найдено, оно уже зарегистрировано, и вы можете пропустить следующий шаг.
3.  Вызовите метод [**ивмдевицерегистратион:: RegisterDevice**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmdeviceregistration-registerdevice) , чтобы добавить устройство в базу данных регистрации устройств.

Вы можете получить доступ к сведениям о любом устройстве в базе данных регистрации, извлекая связанный с ним объект зарегистрированного устройства. Существует два способа получить зарегистрированный объект устройства. Если у вас есть сертификат и серийный номер устройства, можно вызвать метод [**ивмдевицерегистратион:: жетрегистереддевицебид**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmdeviceregistration-getregistereddevicebyid) . Если у вас нет сертификата и серийного номера устройства, можно перечислить все устройства в базе данных, вызвав [**ивмдевицерегистратион:: жетфирстрегистереддевице**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmdeviceregistration-getfirstregistereddevice) , а затем повторные вызовы [**Ивмдевицерегистратион:: жетнекстрегистереддевице**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmdeviceregistration-getnextregistereddevice) до тех пор, пока вызов не возвратит \_ значение false.

Прежде чем приложение сможет отправить данные на устройство, необходимо убедиться, что устройство утверждено, проверено и открыто.

Утверждение устройства должно затрагивать взаимодействие с пользователем. Когда устройство отправляет сообщение регистрации, оно может предложить пользователю решить, является ли устройство устройством, которое должно получить данные этого пользователя. Затем обновите базу данных регистрации устройств, вызвав метод [**ивмрегистереддевице:: reутверждать**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmregistereddevice-approve) , передав **true** или **false** соответствующим образом.

Проверка также называется обнаружением близлежащих устройств. Это процесс, с помощью которого внутренние объекты DRM из пакета SDK Windows Media Format определяют, достаточно ли для компьютера, на котором работает приложение, безопасно передавать носители. Близкость определяется временем, которое требуется для получения ответа на сообщение. Эта функция предназначена для предотвращения доступа неавторизованных пользователей к сети и получения защищенного носителя. Дополнительные сведения см. в разделе [выполнение обнаружения близлежащих](performing-proximity-detection.md)устройств.

Чтобы открыть устройство, вызовите [**ивмрегистереддевице:: Open**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmregistereddevice-open).

> [!Note]  
> DRM не поддерживает версию этого пакета SDK на базе x64.

 

## <a name="related-topics"></a>См. также

<dl> <dt>

[**ивмрегистереддевице**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmregistereddevice)
</dt> <dt>

[**Использование протокола Windows Media DRM 10 для сетевых устройств**](using-the-windows-media-drm-10-for-network-devices-protocol.md)
</dt> </dl>

 

 




