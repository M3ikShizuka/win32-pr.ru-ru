---
title: Настройка потоков
description: Настройка потоков
ms.assetid: d119362f-e23c-4985-aff5-8c084106df30
keywords:
- Windows Media Format SDK, потоки
- профили, потоки
- потоки, Настройка
- кодеки, Настройка потоков
- профили, интерфейс Ивмстреамконфиг
- потоки, интерфейс Ивмстреамконфиг
- ивмстреамконфиг
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: 6bc159fbd5390eb430e035db676685153d0cf174
ms.sourcegitcommit: 592c9bbd22ba69802dc353bcb5eb30699f9e9403
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/20/2020
ms.locfileid: "104487728"
---
# <a name="configuring-streams"></a>Настройка потоков

Единственное, что требуется в профиле, — это хотя бы один поток. Другие параметры предоставляют доступ к более продвинутым функциям, но с минимальным числом из одного потока можно создать файл ASF. Важно понимать, как настроить потоки перед созданием сложных профилей.

В целях профилей потоки можно разделить на два типа: те, которые сжимаются с помощью кодеков Windows Media и произвольных потоков, которые не обрабатываются ни с одним кодеком. Звуковые потоки и видеопотоки — это типы, использующие кодеки Windows Media. Конечно, потоки могут содержать звук или видео, сжатые с помощью стороннего кодека, но процесс настройки такого потока является особым случаем. Дополнительные сведения см. [в разделе Создание файлов ASF с помощью сторонних кодеков](to-create-asf-files-using-third-party-codecs.md).

В следующем списке приведена сводка процесса настройки потока.

1.  Получение объекта конфигурации потока для потока.
    -   При создании потока с помощью одного из кодеков Windows Media необходимо получить объект конфигурации потока в формате кодека, используя методы [**IWMCodecInfo3**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmcodecinfo3).
    -   Если поток является произвольным типом, получите пустой объект конфигурации потока с помощью [**ивмпрофиле:: креатеневстреам**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmprofile-createnewstream).
2.  Настройте поток в соответствии с вашими потребностями.
    -   Потокам всех типов должно быть присвоено имя, имя соединения и номер потока.
    -   Потоки, использующие кодеки Windows Media, следует изменять только в предопределенных способах из формата кодека. Для звуковых потоков необходимо изменить только параметры переменной скорости (VBR) для двух проходов. Для видеопотоков необходимо настроить нужные свойства фрейма.
    -   Произвольные потоки имеют различные требования к конфигурации по типу. Для всех требуется окно с побитовой скоростью и буфер.
3.  Добавьте поток в профиль, вызвав [**ивмпрофиле:: аддстреам**](/previous-versions/windows/desktop/api/Wmsdkidl/nf-wmsdkidl-iwmprofile-addstream).

Все потоки определяются с помощью объектов конфигурации потока. Основным интерфейсом для объекта конфигурации потока является [**ивмстреамконфиг**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmstreamconfig), который предоставляет методы для установки основных параметров потока, таких как номер потока, скорость работы с битах и т. д. **Ивмстреамконфиг** наследуется новыми интерфейсами, [**IWMStreamConfig2**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmstreamconfig2) и [**IWMStreamConfig3**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmstreamconfig3). Как и для всех пронумерованных редакций интерфейса, всегда следует получать самую последнюю версию с помощью метода **QueryInterface** .

Доступ к большинству параметров в потоке осуществляется через [**ивммедиапропс**](/previous-versions/windows/desktop/api/wmsdkidl/nn-wmsdkidl-iwmmediaprops). Эти параметры инкапсулируются в структуре [**\_ \_ типа мультимедиа WM**](/previous-versions/windows/desktop/api/wmsdkidl/ns-wmsdkidl-wm_media_type) . Для аудио и видео структура **\_ \_ типа мультимедиа WM** указывает на другую структуру с дополнительной информацией, относящейся к типу носителя. Эта дополнительная структура обычно [**вавеформатекс**](/previous-versions/windows/desktop/legacy/dd757720(v=vs.85)) для аудио и [**вмвидеоинфохеадер**](/previous-versions/windows/desktop/api/wmsdkidl/ns-wmsdkidl-wmvideoinfoheader) для видео. Кроме того, видеопотоки имеют третичную структуру **битмапинфохеадер**, которая описывает характеристики отдельного кадра видео. **Битмапинфохеадер** — это общая структура, которую можно найти в разделе Интерфейс графических устройств (GDI) пакета Platform SDK.

В следующих разделах описывается настройка потоков.



| Section                                                                                                          | Описание                                                                                                                                                     |
|------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [Общая конфигурация для всех потоков](configuration-common-to-all-streams.md)                                   | Описывает основную конфигурацию потока, общую для всех типов потоков.                                                                                        |
| [Получение сведений о конфигурации потока из кодеков](getting-stream-configuration-information-from-codecs.md) | Описывает, как получить сведения о конфигурации потока из кодеков, чтобы обеспечить правильную настройку потоков с помощью аудиокодеков Windows Media Audio и Video. |
| [Настройка звуковых потоков](configuring-audio-streams.md)                                                       | Описывает настройку звуковых потоков.                                                                                                                       |
| [Настройка потоков видео](configuring-video-streams.md)                                                       | Описание настройки потоков видео.                                                                                                                       |
| [Настройка потоков видео для поиска производительности](configuring-video-streams-for-seeking-performance.md)       | Описание настройки видеопотоков, для которых важно эффективное Поиск.                                                                              |
| [Настройка потоков снимка экрана](configuring-screen-capture-streams.md)                                     | Описание настройки видеопотоков для снимка экрана.                                                                                                    |
| [Настройка потоков изображений](configuring-image-streams.md)                                                       | Описывает настройку потоков изображений.                                                                                                                       |
| [Использование несжатых потоков аудио и видео](using-uncompressed-audio-and-video-streams.md)                     | Описание настройки несжатого аудио или видеопотока.                                                                                                  |
| [Настройка произвольных типов потоков](configuring-arbitrary-stream-types.md)                                     | Описывает настройку потоков для использования предопределенных произвольных типов потоков.                                                                                |
| [Настройка потоков с VBR](configuring-vbr-streams.md)                                                           | Описывает, как настроить потоки для использования кодирования с переменной скоростью (VBR).                                                                                     |
| [Настройка расширений модуля данных](configuring-data-unit-extensions.md)                                         | Описывает, как настроить поток таким образом, чтобы расширения модулей данных можно было прикреплять при написании файла.                                                      |
| [Повторное использование конфигураций потоков](reusing-stream-configurations.md)                                               | Описывает способы использования объектов конфигурации Stream из существующих профилей для создания новых профилей.                                               |



 

## <a name="related-topics"></a>См. также

<dl> <dt>

[**Входы, потоки и выходные данные**](inputs-streams-and-outputs.md)
</dt> <dt>

[**Работа с профилями**](working-with-profiles.md)
</dt> </dl>

 

 