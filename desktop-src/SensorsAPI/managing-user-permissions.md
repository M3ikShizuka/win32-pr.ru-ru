---
description: API датчика предоставляет метод, с помощью которого пользователь может запрашивать у пользователя разрешения на использование датчика или коллекции датчиков.
ms.assetid: c755edcf-18c1-43d5-9dfe-c073e1f96b5f
title: Управление разрешениями пользователей
ms.topic: article
ms.date: 05/31/2018
ms.openlocfilehash: ecb65fa5a9962be4850aa4711cafa03fb7658212
ms.sourcegitcommit: d75fc10b9f0825bbe5ce5045c90d4045e3c53243
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/13/2021
ms.locfileid: "127056920"
---
# <a name="managing-user-permissions"></a>Управление разрешениями пользователей

API датчика предоставляет метод, с помощью которого пользователь может запрашивать у пользователя разрешения на использование датчика или коллекции датчиков.

так как датчики могут раскрывать конфиденциальную информацию, Windows требует, чтобы пользователи включили датчики, прежде чем программа сможет получить доступ к любым данным.

Вы можете запросить разрешение, если вы хотите использовать датчики, для которых в текущем [**сенсорстате**](/windows/win32/api/sensorsapi/ne-sensorsapi-sensorstate) нет \_ доступа к состоянию датчика \_ \_ .

Чтобы запросить разрешения, вызовите метод [**исенсорманажер:: рекуестпермиссионс**](/windows/win32/api/sensorsapi/nf-sensorsapi-isensormanager-requestpermissions) . при вызове этого метода Windows открывает диалоговое окно **включение датчиков** , в котором пользователю предлагается включить запрошенные датчики. Это диалоговое окно предоставляет пользователю имена запрошенных датчиков. Пользователь может выбрать один из следующих вариантов:

-   **Включите эти датчики**.
-   **Не включайте эти датчики**.
-   **Откройте панель управления для получения дополнительных параметров**.

если пользователь выбрал **параметр не включать эти датчики**, Windows не будет снова отображать диалоговое окно " **включение датчиков** " для этих датчиков, даже если программа вызывает [**рекуестпермиссионс**](/windows/win32/api/sensorsapi/nf-sensorsapi-isensormanager-requestpermissions). если пользователь выбрал любой другой параметр, Windows разрешит отображение диалогового окна при запросе. Если ваш вызов **рекуестпермиссионс** содержит датчики, которые пользователь ранее выбрал для отключения, API датчика удалит эти датчики из списка датчиков, которые видит пользователь.

### <a name="modal-or-modeless-behavior"></a>Модальное или немодальное поведение

Метод [**рекуестпермиссионс**](/windows/win32/api/sensorsapi/nf-sensorsapi-isensormanager-requestpermissions) принимает **логический** аргумент, который определяет, отображается ли диалоговое окно **Включение датчиков** в виде модального или немодального окна. Этот параметр также влияет на то, является ли поведение возвращаемого кода диалогового окна синхронным или асинхронным.

При модальности диалоговое окно имеет эксклюзивный фокус между окнами приложения, пока пользователь не выберет параметр, а код возврата **HRESULT** из вызова [**рекуестпермиссионс**](/windows/win32/api/sensorsapi/nf-sensorsapi-isensormanager-requestpermissions) указывает на выбор пользователя. При немодальном режиме диалоговое окно не имеет монопольного фокуса и вызов **рекуестпермиссионс** возвращает немедленно. В этом случае код возврата указывает, был ли метод обработан удачно, но не может быть использован для определения выбора пользователя. Затем можно определить, какие датчики были включены, обрабатывая событие [**онстатечанжед**](/windows/win32/api/sensorsapi/nf-sensorsapi-isensorevents-onstatechanged) и проверив каждый датчик на \_ готовность датчика \_ .

Дополнительные сведения о кодах возврата см. на странице справочника по [**рекуестпермиссионс**](/windows/win32/api/sensorsapi/nf-sensorsapi-isensormanager-requestpermissions) .

### <a name="best-practice-avoid-multiple-modeless-calls-to-requestpermissions"></a>Рекомендации. Избегайте нескольких немодальных вызовов Рекуестпермиссионс

Повторяющиеся немодальные вызовы [**рекуестпермиссионс**](/windows/win32/api/sensorsapi/nf-sensorsapi-isensormanager-requestpermissions) будут отображать несколько экземпляров диалогового окна **Включение этих датчиков** и могут привести к переполнению экрана с помощью диалоговых окон, что приведет к плохому взаиморезультату с пользователем. Если вы считаете, что после первого вызова **рекуестпермиссионс** можно установить другие датчики расположения, что требует другого вызова **рекуестпермиссионс**, необходимо либо вызвать **рекуестпермиссионс** в модальном режиме, либо подождать, пока все датчики расположения не будут установлены для выполнения немодального вызова.

## <a name="related-topics"></a>Связанные разделы

<dl> <dt>

[Конфиденциальность и безопасность на платформе датчиков и расположений](privacy-and-security-in-the-sensor-and-location-platform.md)
</dt> <dt>

[Запрос разрешений пользователя](requesting-user-permissions.md)
</dt> </dl>

 

 
